* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page   1
* EL331.cbl
* Options: int("EL331.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL331.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL331.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL331.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL331 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:30:06.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.037.
     9
    10*AUTHOR.     LOGIC INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page   2
* EL331.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*         THIS PROGRAM UPDATES THE ONLINE INFORCE FILE USING
    27*       AN EXTRACT FILE FROM ECS CREDIT SYSTEM- AN AUDIT
    28*       REPORT IS PRODUCED SHOWING THE CHANGE IN STATUS OF
    29*       THE CERTIFICATE HAVING ASSOCIATED CLAIMS.
    30*
    31*         THE PROGRAM ALSO LOADS AND MAINTAINS THE COMMISSION
    32*       EXCEPTION FILE (ERCOMM).
    33*
    34**** NOTE FOLLOWING FILES MUST BE CLOSED TO RUN THIS PROG
    35*            ERCOMM, ELCERT, ERMAIL
    36*
    37*       INPUT FILES-             CLAIM MASTER
    38*                                ACCOUNT MASTER (IF SYSTEM D)
    39*                                DATE CARD FILE
    40*                                CERTIFICATE MASTER
    41*                                ECS CERTIFICATE MASTER
    42*                                DISK DATE
    43*                                MAIL DATA
    44*
    45*       OUTPUT-                  CERT LOAD CONTROL PAGE
    46*                                ERCOMM FILE (IF SYSTEM D)
    47*                                CERTIFICATE MASTER
    48*                                (FICH FILE)
    49*                                MAIL DATA
    50*
    51******************************************************************
    52*                   C H A N G E   L O G
    53*
    54* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    55*-----------------------------------------------------------------
    56*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    57* EFFECTIVE    NUMBER
    58*-----------------------------------------------------------------
    59* 062104    2004050700001  SMVA  ADD NEW FILE TO AUTOMATE ME BALANCING
    60* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
    61* 020906                   PEMA  INCREASE SIZE OF LOAN OFFICER
    62* 042607    2007032700002  PEMA  KEEP SPEC VA STUFF ON LINE
    63* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    64* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    65* 032612  CR2011110200001  PEMA  AHL CHANGES
    66* 042314  IR2013012200001  PEMA  Correct status on old certs.
    67* 042814  IR2014042400001  PEMA  Correct status on old certs.
    68******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page   3
* EL331.cbl
    70 ENVIRONMENT DIVISION.
    71
    72 INPUT-OUTPUT SECTION.
    73
    74 FILE-CONTROL.
    75
    76     SELECT PRNTR            ASSIGN TO SYS008.
    77
    78     SELECT DISK-DATE        ASSIGN TO SYS019.
    79
    80     SELECT FICH             ASSIGN TO SYS020.
    81
    82     SELECT ME50-EL331-BALANCE
    83                             ASSIGN TO SYS015
    84                             ORGANIZATION IS LINE SEQUENTIAL.
    85
    86     SELECT ECSCRT01         ASSIGN TO SYS010.
    87
    88     SELECT ELMSTR5          ASSIGN TO SYS011-3380-ELMSTR5
    89                             ORGANIZATION IS INDEXED
    90                             ACCESS IS DYNAMIC
    91                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
    92                             FILE STATUS IS CL-STATUS.
    93
    94     SELECT ELRETR5          ASSIGN TO SYS011-3380-ELRETR5
    95                             ORGANIZATION IS INDEXED
    96                             ACCESS IS DYNAMIC
    97                             RECORD KEY IS RL-CONTROL-BY-CERT-NO
    98                             FILE STATUS IS ELRETR5-FILE-STATUS.
    99
   100     SELECT ELCERTF          ASSIGN TO SYS012-3380-ELCERT
   101                             ORGANIZATION IS INDEXED
   102                             ACCESS IS DYNAMIC
   103                             RECORD KEY IS CM-CONTROL-PRIMARY
   104                             FILE STATUS IS CM-STATUS.
   105
   106     SELECT ERCOMM           ASSIGN TO SYS013-3380-ERCOMM
   107                             ORGANIZATION IS INDEXED
   108                             ACCESS IS DYNAMIC
   109                             RECORD KEY IS CE-CONTROL-PRIMARY
   110                             FILE STATUS IS CE-STATUS.
   111
   112     SELECT ERACCT           ASSIGN TO SYS014-3380-ERACCT
   113                             ORGANIZATION IS INDEXED
   114                             ACCESS IS DYNAMIC
   115                             RECORD KEY IS AM-CONTROL-PRIMARY
   116                             FILE STATUS IS AM-STATUSF.
   117
   118     SELECT ELREPT           ASSIGN TO SYS018-3380-ELREPT
   119                             ORGANIZATION IS INDEXED
   120                             ACCESS IS DYNAMIC
   121                             RECORD KEY IS RF-CONTROL-PRIMARY
   122                             FILE STATUS IS DTE-VSAM-FLAGS.
   123
   124     SELECT ERMEBL           ASSIGN SYS024-3380-ERMEBL
   125                             ORGANIZATION INDEXED
   126                             ACCESS DYNAMIC
   127                             RECORD KEY ME-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page   4
* EL331.cbl
   128                             FILE STATUS ERMEBL-FILE-STATUS.
   129
   130     SELECT ERMAIL           ASSIGN TO SYS021-3380-ERMAIL
   131                             ORGANIZATION IS INDEXED
   132                             ACCESS IS RANDOM
   133                             RECORD KEY IS MA-CONTROL-PRIMARY
   134                             FILE STATUS IS ERMAIL-FILE-STATUS.
   135
   136     SELECT ERCTBL           ASSIGN TO ERCTBLT
   137                             ORGANIZATION IS INDEXED
   138                             ACCESS IS RANDOM
   139                             RECORD KEY IS CT-CONTROL-PRIMARY
   140                             FILE STATUS IS ERCTBL-FILE-STATUS.
   141
   142     SELECT  DISPLAY-PRT     ASSIGN TO SYS022-UR-1403-S-SYS022.
   143
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page   5
* EL331.cbl
   145
   146 DATA DIVISION.
   147
   148 FILE SECTION.
   149
   150 FD  PRNTR
*                                      COPY ELCPRTFD.
   151******************************************************************04/15/98
   152*                                                                *ELCPRTFD
   153*                                                                *ELCPRTFD
   154*                            ELCPRTFD.                           *   LV003
   155*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   156*                            VMOD=2.006                          *ELCPRTFD
   157******************************************************************ELCPRTFD
   158     RECORDING MODE F                                             ELCPRTFD
   159     LABEL RECORDS OMITTED                                        ELCPRTFD
   160     BLOCK CONTAINS 0 RECORDS
   161     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   162 01  PRT.                                                         ELCPRTFD
   163     12  P-CTL               PIC  X.                                 CL**2
   164     12  P-DATA              PIC  X(132).                         ELCPRTFD
   165******************************************************************ELCPRTFD
   166
   167 FD  ME50-EL331-BALANCE
   168     RECORDING MODE IS F
   169     BLOCK CONTAINS 0 RECORDS.
   170 01  ME50-EL331-BALANCE-REC    PIC X(95).
   171
   173 FD  ECSCRT01
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page   6
* EL331.cbl
*                                      COPY ECSCRIFD.
   174******************************************************************07/10/97
   175*                                                                *ECSCRIFD
   176*                            ECSCRIFD                            *   LV001
   177*                            VMOD 2.005                          *ECSCRIFD
   178*                                                                *ECSCRIFD
   179*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   180*                                                                *ECSCRIFD
   181******************************************************************ECSCRIFD
   182     BLOCK CONTAINS 0 RECORDS
   183     RECORDING MODE F.                                            ECSCRIFD
   184                                                                  ECSCRIFD
   185 01  CERT-IN-RECORD.                                              ECSCRIFD
   186                                                                  ECSCRIFD
   187     12  FILLER                            PIC XXX.               ECSCRIFD
   188     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   189     12  FILLER                            PIC X(66).             ECSCRIFD
   190     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   191     12  FILLER                            PIC X(20).             ECSCRIFD
   192     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   193     12  FILLER                            PIC X(14).             ECSCRIFD
   194     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   195     12  FILLER                            PIC X(39).             ECSCRIFD
   196     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   197     12  FILLER                            PIC X(45).             ECSCRIFD
   198     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   199     12  FILLER                            PIC X(35).             ECSCRIFD
   200     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   201     12  FILLER                            PIC X(41).             ECSCRIFD
   202     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   203     12  FILLER                            PIC X(48).             ECSCRIFD
   204     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   205     12  FILLER                            PIC X(9).              ECSCRIFD
   206     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   207     12  FILLER                            PIC X(120).            ECSCRIFD
   208     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   209     12  FILLER                            PIC X(73).             ECSCRIFD
   210     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   211     12  FILLER                            PIC X(464).            ECSCRIFD
   212                                                                  ECSCRIFD
   213******************************************************************ECSCRIFD
   214
*  215             COPY ECSCRT01 REPLACING CERTIFICATE-MASTER
*  216                                  BY ECS-CERT-RECORD.
   217******************************************************************
   218*                                                                *
   219*                            ECSCRT01                            *
   220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   221*                            VMOD=2.016                          *
   222*                                                                *
   223*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   224*                                                                *
   225*   FILE TYPE = SEQUENTIAL
   226*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   227*                                                                *
   228*   KEY DATA =                         START=4, LEN=36           *
   229*                                                                *
   230*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page   7
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   231*                                                                *
   232******************************************************************
   233******************************************************************
   234*                   C H A N G E   L O G
   235*
   236* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   237*-----------------------------------------------------------------
   238*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   239* EFFECTIVE    NUMBER
   240*-----------------------------------------------------------------
   241* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   242* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   243* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   244* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   245* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   246* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   247* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   248* 032612  CR2011110200001  PEMA  AHL CHANGES
   249******************************************************************
   250
   251 01  CERTIFICATE-RECORD.
   252     12  CR-RECORD-ID                      PIC XX.
   253         88  VALID-CR-ID                      VALUE 'CR'.
   254
   255     12  CR-COMPANY-CD                     PIC X.
   256
   257     12  CR-FULL-CONTROL.
   258         16  CR-CONTROL-1.
   259             20  CR-ACCT-CONTROL.
   260                 24  CR-CARRIER            PIC X.
   261                 24  CR-GROUPING.
   262                     28  CR-GROUP-PREFIX   PIC XXX.
   263                     28  CR-GROUP-PRIME    PIC XXX.
   264                 24  CR-STATE              PIC XX.
   265                 24  CR-ACCOUNT.
   266                     28  CR-ACCT-PREFIX    PIC X(4).
   267                     28  CR-ACCT-PRIME     PIC X(6).
   268             20  CR-DT                     PIC 9(11)  COMP-3.
   269         16  CR-CERT-NO.
   270             20  CR-CERT.
   271                 24  CR-CERT-PREFIX        PIC X(3).
   272                 24  CR-CERT-PRIME         PIC X(7).
   273             20  CR-CERT-SFX               PIC X.
   274
   275     12  CR-INSUREDS-PROFILE.
   276         16  CR-NAME.
   277             20  CR-LNAME                  PIC X(15).
   278             20  CR-FNAME.
   279                 24  CR-1ST-INITIAL        PIC X.
   280                 24  FILLER                PIC X(9).
   281             20  CR-INIT                   PIC X.
   282         16  CR-AGE                        PIC 99.
   283         16  CR-SEX                        PIC X.
   284             88  CR-SEX-MALE                  VALUE 'M'.
   285             88  CR-SEX-FEMALE                VALUE 'F'.
   286         16  CR-SOC-SEC                    PIC X(11).
   287         16  CR-JOINT-NAME.
   288             20  CR-JT-LNAME               PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page   8
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   289             20  CR-JT-FNAME.
   290                 24  CR-JT-1ST-INIT        PIC X.
   291                 24  FILLER                PIC X(9).
   292             20  CR-JT-INIT                PIC X.
   293         16  CR-JOINT-AGE                  PIC 99.
   294
   295         16  cr-ahl-ah-claim-no            pic x(9).
   296         16  cr-ahl-ah-cert-seq            pic x(3).
   297         16  cr-hst-proc-lf                pic x.
   298         16  f                             pic x(7).
   299
   300     12  CR-LF-COVERAGE-DATA.
   301         16  CR-LFTYP                      PIC XX.
   302         16  CR-LF-TERM                    PIC S999       COMP-3.
   303         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   304         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   305         16  CR-LF-DEV-CODE                PIC XXX.
   306         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   307
   308         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   309         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   310         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   311         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   312
   313         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   314         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   315         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   316         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   317
   318         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   319         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   320
   321         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   322         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   323
   324         16  CR-LF-REFUND-TYPE             PIC X.
   325         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   326
   327         16  CR-LF-COMM-CHARGEBACK         PIC X.
   328             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   329
   330         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   331
   332         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   333         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   334         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   335
   336         16  cr-ahl-lf-claim-no            pic x(9).
   337         16  cr-ahl-lf-cert-seq            pic x(3).
   338         16  FILLER                        PIC XX.
   339
   340     12  CR-AH-COVERAGE-DATA.
   341         16  CR-AHTYP                      PIC XX.
   342         16  CR-AH-TERM                    PIC S999       COMP-3.
   343         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   344         16  CR-AH-DEV-CODE                PIC XXX.
   345         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   346
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page   9
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   347         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   348         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   349         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   350         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   351
   352         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   353         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   354
   355         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   356         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   357
   358         16  CR-AH-REFUND-TYPE             PIC X.
   359         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   360
   361         16  CR-AH-COMM-CHARGEBACK         PIC X.
   362             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   363
   364         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   365
   366         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   367         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   368         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   369
   370         16  FILLER                        PIC XX.
   371*        16  FILLER                        PIC X(8).
   372
   373     12  CR-LOAN-DATA.
   374         16  CR-LIVES                      PIC S9(7)      COMP-3.
   375         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   376                                           PIC S9(5)V99   COMP-3.
   377         16  CR-BILLED                     PIC S9(7)      COMP-3.
   378         16  CR-APR                        PIC S999V9(4)  COMP-3.
   379         16  CR-PMT-FREQ                   PIC 99.
   380         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   381         16  CR-RATING-CLASS               PIC XX.
   382         16  CR-POLICY-FORM-NO             PIC X(12).
   383         16  CR-GRPTYP                     PIC XX.
   384         16  CR-IND-GRP                    PIC X.
   385             88  CR-INDIVIDUAL                VALUE '1'.
   386             88  CR-GROUP                     VALUE '2'.
   387         16  CR-SKIP                       PIC 99.
   388             88  NO-MONTHS-SKIPPED            VALUE 00.
   389             88  SKIP-JULY                    VALUE 01.
   390             88  SKIP-AUGUST                  VALUE 02.
   391             88  SKIP-SEPTEMBER               VALUE 03.
   392             88  SKIP-JULY-AUG                VALUE 04.
   393             88  SKIP-AUG-SEPT                VALUE 05.
   394             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   395             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   396             88  SKIP-JUNE                    VALUE 08.
   397             88  SKIP-JUNE-JULY               VALUE 09.
   398             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   399             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   400         16  CR-RESIDENT-STATE             PIC XX.
   401         16  CR-RATE-CODE.
   402             20  CR-LF-CLASS-CD            PIC XX.
   403             20  CR-AH-CLASS-CD            PIC XX.
   404         16  CR-MORT.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  10
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   405             20  CR-TAB                    PIC X.
   406             20  CR-INT                    PIC 99.
   407             20  CR-GRP                    PIC X.
   408         16  CR-MEMBER-NO                  PIC X(12).
   409         16  CR-OLD-LOF                    PIC XXX.
   410*        16  CR-LOAN-OFFICER               PIC XXX.
   411         16  CR-REIN-TABLE                 PIC XXX.
   412         16  CR-REIN-SPEC                  PIC X.
   413         16  CR-LOAN-1ST-PMT-DT.
   414             20  CR-1ST-PMT-YR             PIC 99.
   415             20  CR-1ST-PMT-MO             PIC 99.
   416             20  CR-1ST-PMT-DA             PIC 99.
   417         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   418         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   419         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   420         16  CR-LAST-ADD-ON-DT             PIC XX.
   421
   422         16  CR-UNDERWRITING-CODE          PIC X.
   423             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   424
   425         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   426         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   427         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   428         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   429
   430     12  CR-STATUS-INFORMATION.
   431         16  CR-ENTRY-STATUS               PIC X.
   432             88  CR-NORMAL-ENTRY              VALUE '1'.
   433             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   434             88  CR-CONVERSION-ENTRY          VALUE '4'.
   435             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   436             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   437             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   438             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   439             88  CR-POLICY-IS-VOID            VALUE 'V'.
   440             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   441             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   442                                                    '5' '9' 'P'.
   443         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   444
   445         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   446         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   447         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   448
   449         16  CR-LF-STATUS-AT-DEATH         PIC X.
   450         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   451
   452         16  CR-LF-CURRENT-STATUS          PIC X.
   453             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   454             88  CR-LF-POLICY-PENDING         VALUE '2'.
   455             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   456             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   457             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   458             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   459             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   460             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   461             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   462             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  11
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   463             88  CR-LF-IS-DECLINED            VALUE 'D'.
   464             88  CR-LF-IS-VOID                VALUE 'V'.
   465             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   466                                                    '4' '5' '9'.
   467
   468         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   469
   470         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   471         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   472
   473         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   474         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   475
   476         16  CR-AH-CURRENT-STATUS          PIC X.
   477             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   478             88  CR-AH-POLICY-PENDING         VALUE '2'.
   479             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   480             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   481             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   482             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   483             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   484             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   485             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   486             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   487             88  CR-AH-IS-DECLINED            VALUE 'D'.
   488             88  CR-AH-IS-VOID                VALUE 'V'.
   489             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   490                                                    '4' '5' '9'.
   491         16  CR-LOAN-OFFICER               PIC X(5).
   492         16  CR-CANCEL-REASON              PIC X.
   493         16  cr-xycor-lf-cov-code          pic x(4).
   494         16  cr-xycor-ah-cov-code          pic x(4).
   495         16  FILLER                        PIC X(6).
   496
   497     12  CR-DEATH-CLAIM-DATA.
   498         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   499
   500         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   501         16  CR-DTH-RPT-DT.
   502             20  CR-DTH-RPT-YR             PIC 99.
   503             20  CR-DTH-RPT-MO             PIC 99.
   504             20  CR-DTH-RPT-DA             PIC 99.
   505         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   506
   507         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   508         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   509         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   510         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   511         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   512
   513         16  CR-DTH-AGE                    PIC 99.
   514         16  CR-DTH-PAY-CD                 PIC X.
   515         16  CR-DEATH-CAUSE                PIC X(6).
   516
   517         16  FILLER                        PIC X(16).
   518
   519     12  CR-DISAB-CLAIM-DATA.
   520         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  12
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   521
   522         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   523         16  CR-DIS-RPT-DT.
   524             20  CR-DIS-RPT-YR             PIC 99.
   525             20  CR-DIS-RPT-MO             PIC 99.
   526             20  CR-DIS-RPT-DA             PIC 99.
   527         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   528         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   529
   530         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   531         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   532         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   533         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   534         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   535
   536         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   537         16  CR-DIS-PAY-CD                 PIC X.
   538         16  FILLER                        PIC XX.
   539
   540         16  CR-DISAB-INCURRED-DETAIL.
   541             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   542**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   543                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   544                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   545                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   546
   547         16  CR-DISAB-CAUSE                PIC X(6).
   548         16  FILLER                        PIC X(14).
   549
   550     12  CR-REMIT-TO                       PIC 99.
   551
   552     12  CR-COMPENSATION-LEVELS.
   553         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   554             20  CR-COM-AGT.
   555                 24  CR-COM-AGT-PREFIX     PIC X(4).
   556                 24  CR-COM-AGT-PRIME      PIC X(6).
   557             20  CR-AGT-TYPE               PIC X.
   558             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   559             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   560
   561     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   562     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   563     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   564     12  CR-CLP-STATE                      PIC XX.
   565     12  CR-POST-CARD-IND                  PIC X.
   566     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   567     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   568     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   569     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   570     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   571     12  FILLER                            PIC X(07).
   572
   573     12  CR-CSR-CODE                       PIC XXX.
   574
   575     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   576     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   577
   578     12  CR-MICROFILM-NUMBERS.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  13
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   579*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   580         16  FILLER                        PIC X(5).
   581     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   582
   583     12  CR-USER-CODE                      PIC X.
   584     12  CR-USER-FUTURE                    PIC X(9).
   585
   586     12  CR-BENEFICIARY.
   587         16  CR-BANK-NO                    PIC X(10).
   588         16  FILLER                        PIC X(15).
   589
   590     12  CR-ENTRY-BATCH                    PIC X(6).
   591     12  CR-LF-EXIT-BATCH                  PIC X(6).
   592     12  CR-AH-EXIT-BATCH                  PIC X(6).
   593
   594     12  CR-NOTE-SW                        PIC X.
   595
   596     12  CR-ORIGIN-INDICATOR               PIC X.
   597         88  CR-ENTERED-MANUALLY              VALUE '1'.
   598         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   599
   600     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   601     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   602     12  FILLER                            PIC X(33).
   603
   604******************************************************************
   605
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  14
* EL331.cbl
   607 FD  ELCERTF.
*  608                                 COPY ELCCERT.
   609******************************************************************04/15/98
   610*                                                                *ELCCERT
   611*                            ELCCERT.                            *   LV002
   612*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   613*                            VMOD=2.013                          *   CL**2
   614*                                                                *ELCCERT
   615*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
   616*                                                                *ELCCERT
   617*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
   618*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
   619*                                                                *ELCCERT
   620*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
   621*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
   622*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
   623*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
   624*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
   625*                                                                *ELCCERT
   626*   LOG = YES                                                    *ELCCERT
   627*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
   628******************************************************************
   629*                   C H A N G E   L O G
   630*
   631* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   632*-----------------------------------------------------------------
   633*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   634* EFFECTIVE    NUMBER
   635*-----------------------------------------------------------------
   636* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   637* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   638* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   639* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   640* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   641* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   642* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   643* 032612  CR2011110200001  PEMA  AHL CHANGES
   644******************************************************************
   645                                                                  ELCCERT
   646 01  CERTIFICATE-MASTER.                                          ELCCERT
   647     12  CM-RECORD-ID                      PIC XX.                ELCCERT
   648         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
   649                                                                  ELCCERT
   650     12  CM-CONTROL-PRIMARY.                                      ELCCERT
   651         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
   652         16  CM-CARRIER                    PIC X.                 ELCCERT
   653         16  CM-GROUPING.                                         ELCCERT
   654             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
   655             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
   656         16  CM-STATE                      PIC XX.                ELCCERT
   657         16  CM-ACCOUNT.                                          ELCCERT
   658             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
   659             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
   660         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
   661         16  CM-CERT-NO.                                          ELCCERT
   662             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
   663             20  CM-CERT-SFX               PIC X.                 ELCCERT
   664                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  15
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   665     12  CM-CONTROL-BY-NAME.                                      ELCCERT
   666         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
   667         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
   668         16  CM-INSURED-INITIALS.                                 ELCCERT
   669             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
   670             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
   671                                                                  ELCCERT
   672     12  CM-CONTROL-BY-SSN.                                       ELCCERT
   673         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
   674         16  CM-SOC-SEC-NO.                                       ELCCERT
   675             20  CM-SSN-STATE              PIC XX.                ELCCERT
   676             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
   677             20  CM-SSN-LN3.                                      ELCCERT
   678                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
   679                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
   680                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
   681                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
   682                                                                  ELCCERT
   683     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
   684         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
   685         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
   686                                                                  ELCCERT
   687     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
   688         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
   689         16  CM-MEMBER-NO.                                        ELCCERT
   690             20  CM-MEMB-STATE             PIC XX.                ELCCERT
   691             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
   692             20  CM-MEMB-LN4.                                     ELCCERT
   693                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
   694                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
   695                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
   696                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
   697                                                                  ELCCERT
   698     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
   699         16  CM-INSURED-FIRST-NAME.                               ELCCERT
   700             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
   701             20  FILLER                    PIC X(9).              ELCCERT
   702         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
   703         16  CM-INSURED-SEX                PIC X.                 ELCCERT
   704             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
   705             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
   706         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
   707         16  CM-JOINT-INSURED-NAME.                               ELCCERT
   708             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
   709             20  CM-JT-FIRST-NAME.                                ELCCERT
   710                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
   711                 24  FILLER                PIC X(9).              ELCCERT
   712             20  CM-JT-INITIAL             PIC X.                 ELCCERT
   713                                                                  ELCCERT
   714     12  CM-LIFE-DATA.                                            ELCCERT
   715         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
   716         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
   717         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
   718         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
   719         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
   720         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
   721         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
   722         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  16
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   723         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
   724         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   725         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   726         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
   727         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
   728         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
   729         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
   730         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
   731         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
   732         16  FILLER                        PIC XX.                ELCCERT
   733                                                                  ELCCERT
   734     12  CM-AH-DATA.                                              ELCCERT
   735         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
   736         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
   737         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
   738         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
   739         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
   740         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   741         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   742         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   743         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
   744         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
   745         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
   746         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
   747             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
   748         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
   749         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
   750         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
   751         16  FILLER                        PIC X.                 ELCCERT
   752                                                                  ELCCERT
   753     12  CM-LOAN-INFORMATION.                                     ELCCERT
   754         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
   755         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   756                                           PIC S9(5)V99  COMP-3.
   757         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
   758         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
   759         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
   760         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
   761         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
   762         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
   763         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
   764         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
   765         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
   766         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
   767             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
   768             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
   769         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
   770             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
   771             20  CM-RATE-CODE              PIC X(4).              ELCCERT
   772             20  FILLER                    PIC XX.                ELCCERT
   773         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
   774             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
   775             20  FILLER                    PIC XXX.               ELCCERT
   776         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
   777         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
   778             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
   779         16  CM-POST-CARD-IND              PIC X.
   780         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  17
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   781         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
   782             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
   783             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
   784             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
   785         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
   786             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
   787             88  CM-GROUP                     VALUE 'G'.          ELCCERT
   788         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
   789             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
   790             88  SKIP-JULY                    VALUE '1'.          ELCCERT
   791             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
   792             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
   793             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
   794             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
   795             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
   796             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
   797             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
   798             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
   799             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
   800             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
   801         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
   802             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
   803             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
   804             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
   805             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
   806             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
   807         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
   808         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
   809         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
   810*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
   811         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
   812         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
   813         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
   814         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
   815         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
   816                                                                  ELCCERT
   817     12  CM-STATUS-DATA.                                          ELCCERT
   818         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
   819         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
   820                                                                  ELCCERT
   821         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
   822         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
   823         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
   824                                                                  ELCCERT
   825         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
   826         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
   827         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
   828                                                                  ELCCERT
   829         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
   830             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
   831                                                'M' '4' '5' '9'.  ELCCERT
   832             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
   833             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
   834             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
   835             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
   836             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
   837             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
   838             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  18
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   839             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
   840             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
   841             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
   842             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
   843             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
   844                                                                  ELCCERT
   845         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
   846         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
   847         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
   848                                                                  ELCCERT
   849         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
   850         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
   851         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
   852                                                                  ELCCERT
   853         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
   854             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
   855                                                'M' '4' '5' '9'.  ELCCERT
   856             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
   857             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
   858             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
   859             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
   860             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
   861             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
   862             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
   863             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
   864             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
   865             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
   866             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
   867             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
   868                                                                  ELCCERT
   869         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
   870             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
   871             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
   872             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
   873         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
   874                                                                  ELCCERT
   875         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
   876         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
   877         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
   878         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
   879                                                                  ELCCERT
   880     12  CM-NOTE-SW                        PIC X.                 ELCCERT
   881         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
   882         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
   883         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
   884         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
   885         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   886         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   887         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   888         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   889     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
   890         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
   891         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
   892     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
   893         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
   894         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
   895                                                                  ELCCERT
   896*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  19
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   897     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   898     12  FILLER                            PIC X.
   899                                                                  ELCCERT
   900*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
   901     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   902     12  FILLER                            PIC X.
   903*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
   904     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
   905                                                                  ELCCERT
   906     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
   907         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
   908         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
   909         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
   910         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
   911         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
   912     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
   913         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
   914         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
   915         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
   916         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
   917         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
   918         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
   919         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
   920         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
   921                                                                  ELCCERT
   922     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
   923         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
   924         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
   925                                                                  ELCCERT
   926     12  CM-USER-FIELD                     PIC X.                 ELCCERT
   927     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   928     12  CM-CLP-STATE                      PIC XX.
   929     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   930     12  CM-USER-RESERVED                  PIC XXX.
   931     12  FILLER REDEFINES CM-USER-RESERVED.
   932         16  CM-AH-CLASS-CD                PIC XX.
   933         16  F                             PIC X.
   934******************************************************************ELCCERT
   935
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  20
* EL331.cbl
   937 FD  ERCOMM.
   938
*  939                                 COPY ERCCOMM.
   940******************************************************************04/29/98
   941*                                                                *ERCCOMM
   942*                                                                *ERCCOMM
   943*                            ERCCOMM                             *   LV002
   944*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   945*                            VMOD=2.003                          *   CL**2
   946*                                                                *ERCCOMM
   947*        FILE DESCRIPTION = COMPENSATION RATES WHEN DIFFERENT    *ERCCOMM
   948*                             FROM THOSE IN ACCOUNT MASTER       *ERCCOMM
   949*                                                                *ERCCOMM
   950*        FILE TYPE= VSAM,KSDS                                    *ERCCOMM
   951*        RECORD SIZE = 250    RECFORM = FIXED                    *ERCCOMM
   952*                                                                *ERCCOMM
   953*        BASE CLUSTER = CRCOMM        RKP=2,LEN=33               *ERCCOMM
   954*                                                                *ERCCOMM
   955*        LOG = YES                                               *ERCCOMM
   956*        SERVREQ = DELETE,UPDATE,NEWREC                          *ERCCOMM
   957*                                                                *ERCCOMM
   958******************************************************************ERCCOMM
   959                                                                  ERCCOMM
   960 01  COMMISSION-EXCEPTIONS.                                       ERCCOMM
   961     12  CE-RECORD-ID                PIC  XX.                     ERCCOMM
   962         88  VALID-CE-ID         VALUE 'CE'.                      ERCCOMM
   963                                                                  ERCCOMM
   964     12  CE-CONTROL-PRIMARY.                                      ERCCOMM
   965         16  CE-COMPANY-CD           PIC  X.                      ERCCOMM
   966         16  CE-CARRIER              PIC  X.                      ERCCOMM
   967         16  CE-GROUPING             PIC  X(6).                   ERCCOMM
   968         16  CE-STATE                PIC  XX.                     ERCCOMM
   969         16  CE-ACCOUNT              PIC  X(10).                  ERCCOMM
   970         16  CE-CERT-EFF-DT          PIC  XX.                     ERCCOMM
   971         16  CE-CERT-NO.                                          ERCCOMM
   972             20  CE-CERT-PRIME       PIC  X(10).                  ERCCOMM
   973             20  CE-CERT-SFX         PIC  X.                      ERCCOMM
   974                                                                  ERCCOMM
   975     12  CE-CERT-EXPIRATION-DT       PIC  XX.                     ERCCOMM
   976                                                                  ERCCOMM
   977     12  CE-COMP-STRUCTURE.                                       ERCCOMM
   978         16  CE-DEFN-1.                                           ERCCOMM
   979             20  CE-AGT-COMMS       OCCURS 10 TIMES.              ERCCOMM
   980                 24  CE-AGENT-NO    PIC  X(10).                   ERCCOMM
   981                 24  CE-COMP-TYPE   PIC  X.                       ERCCOMM
   982                 24  CE-LF-COMP     PIC SV9(5)      COMP-3.       ERCCOMM
   983                 24  CE-AH-COMP     PIC SV9(5)      COMP-3.       ERCCOMM
   984         16  CE-DEFN-2              REDEFINES CE-DEFN-1.          ERCCOMM
   985             20  CE-COMP-TABLES     OCCURS 10 TIMES.              ERCCOMM
   986                 24  FILLER         PIC  X(11).                   ERCCOMM
   987                 24  CE-LF-COMPT    PIC  X(3).                    ERCCOMM
   988                 24  CE-AH-COMPT    PIC  X(3).                    ERCCOMM
   989                                                                  ERCCOMM
   990     12  FILLER                     PIC  X(43).                   ERCCOMM
   991******************************************************************ERCCOMM
   992
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  21
* EL331.cbl
   994 FD  ERACCT.
   995
*  996                                 COPY ERCACCT.
   997******************************************************************04/19/98
   998*                                                                *ERCACCT
   999*                                                                *ERCACCT
  1000*                            ERCACCT                             *   LV031
  1001*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  1002*                            VMOD=2.031                          *ERCACCT
  1003*                                                                *ERCACCT
  1004*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  1005*                                                                *ERCACCT
  1006*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  1007*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  1008*                                                                *ERCACCT
  1009*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  1010*                                                                *ERCACCT
  1011*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  1012*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  1013*                                                                *ERCACCT
  1014*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  1015*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  1016*                                                                *ERCACCT
  1017*   LOG = NO                                                     *ERCACCT
  1018*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  1019*                                                                *ERCACCT
  1020*                                                                *ERCACCT
  1021******************************************************************ERCACCT
  1022*                   C H A N G E   L O G
  1023*
  1024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1025*-----------------------------------------------------------------
  1026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1027* EFFECTIVE    NUMBER
  1028*-----------------------------------------------------------------
  1029* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1030* 092705    2005050300006  PEMA  ADD SPP LEASES
  1031* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1032* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1033* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1034* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1035* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1036******************************************************************
  1037                                                                  ERCACCT
  1038 01  ACCOUNT-MASTER.                                              ERCACCT
  1039     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  1040         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  1041                                                                  ERCACCT
  1042     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  1043         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  1044         16  AM-MSTR-CNTRL.                                       ERCACCT
  1045             20  AM-CONTROL-A.                                    ERCACCT
  1046                 24  AM-CARRIER            PIC X.                 ERCACCT
  1047                 24  AM-GROUPING.                                 ERCACCT
  1048                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  1049                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  1050                 24  AM-STATE              PIC XX.                ERCACCT
  1051                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  22
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1052                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  1053                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  1054             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  1055                                           PIC X(19).             ERCACCT
  1056             20  AM-CNTRL-B.                                      ERCACCT
  1057                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  1058                 24  FILLER                PIC X(4).              ERCACCT
  1059             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  1060                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  1061                                                                  ERCACCT
  1062     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  1063         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  1064         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  1065         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  1066         16  AM-VG-STATE                   PIC XX.                ERCACCT
  1067         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  1068         16  AM-VG-DATE.                                          ERCACCT
  1069             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  1070             20  FILLER                    PIC X(4).              ERCACCT
  1071         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  1072                                           PIC 9(11)      COMP-3. ERCACCT
  1073     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1074         16  FILLER                        PIC X(10).
  1075         16  AM-VG-KEY3.
  1076             20  AM-VG3-ACCOUNT            PIC X(10).
  1077             20  AM-VG3-EXP-DT             PIC XX.
  1078         16  FILLER                        PIC X(4).
  1079     12  AM-MAINT-INFORMATION.                                    ERCACCT
  1080         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  1081         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  1082         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  1083         16  FILLER                        PIC XX.                ERCACCT
  1084                                                                  ERCACCT
  1085     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  1086     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  1087                                                                  ERCACCT
  1088     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  1089         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  1090         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  1091                                                                  ERCACCT
  1092     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  1093     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  1094                                                                  ERCACCT
  1095     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  1096     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  1097                                                                  ERCACCT
  1098     12  AM-NAME                           PIC X(30).             ERCACCT
  1099     12  AM-PERSON                         PIC X(30).             ERCACCT
  1100     12  AM-ADDRS                          PIC X(30).             ERCACCT
  1101     12  AM-CITY.
  1102         16  AM-ADDR-CITY                  PIC X(28).
  1103         16  AM-ADDR-STATE                 PIC XX.
  1104     12  AM-ZIP.                                                  ERCACCT
  1105         16  AM-ZIP-PRIME.                                        ERCACCT
  1106             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  1107                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  1108             20  FILLER                    PIC X(4).              ERCACCT
  1109         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  23
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1110     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  1111         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  1112         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  1113         16  FILLER                        PIC XXX.               ERCACCT
  1114     12  AM-TEL-NO.                                               ERCACCT
  1115         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  1116         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  1117         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  1118     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  1119         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  1120         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  1121                                                                  ERCACCT
  1122     12  AM-COMM-STRUCTURE.                                       ERCACCT
  1123         16  AM-DEFN-1.                                           ERCACCT
  1124             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  1125                 24  AM-AGT.                                      ERCACCT
  1126                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  1127                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  1128                 24  AM-COM-TYP            PIC X.                 ERCACCT
  1129                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  1130                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  1131                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  1132                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  1133                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  1134                 24  AM-GL-CODES           PIC X.                 ERCACCT
  1135                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  1136                 24  FILLER                PIC X(01).             ERCACCT
  1137         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  1138             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  1139                 24  FILLER                PIC X(11).             ERCACCT
  1140                 24  AM-L-COMA             PIC XXX.               ERCACCT
  1141                 24  AM-J-COMA             PIC XXX.               ERCACCT
  1142                 24  AM-A-COMA             PIC XXX.               ERCACCT
  1143                 24  FILLER                PIC X(6).              ERCACCT
  1144                                                                  ERCACCT
  1145     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  1146         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  1147                                                                  ERCACCT
  1148     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  1149                                                                  ERCACCT
  1150     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  1151         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  1152         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  1153     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  1154         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  1155         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  1156     12  AM-GPCD                           PIC 99.                ERCACCT
  1157     12  AM-IG                             PIC X.                 ERCACCT
  1158         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  1159         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  1160     12  AM-STATUS                         PIC X.                 ERCACCT
  1161         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  1162         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  1163         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  1164         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1165         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1166         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1167     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  24
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1168     12  AM-ID-NO                          PIC X(11).             ERCACCT
  1169                                                                  ERCACCT
  1170     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  1171     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  1172     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  1173     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  1174     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  1175     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  1176     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  1177     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  1178     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  1179                                                                  ERCACCT
  1180     12  AM-USER-FIELDS.                                          ERCACCT
  1181         16  AM-FLD-1                      PIC XX.                ERCACCT
  1182         16  AM-FLD-2                      PIC XX.                ERCACCT
  1183         16  AM-FLD-3                      PIC XX.                ERCACCT
  1184         16  AM-FLD-4                      PIC XX.                ERCACCT
  1185         16  AM-FLD-5                      PIC XX.                ERCACCT
  1186                                                                  ERCACCT
  1187     12  AM-1ST-PROD-DATE.                                        ERCACCT
  1188         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  1189         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  1190         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  1191     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  1192     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  1193         16  AM-PUR-YR                     PIC XX.                ERCACCT
  1194         16  AM-PUR-MO                     PIC XX.                ERCACCT
  1195         16  AM-PUR-DA                     PIC XX.                ERCACCT
  1196     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  1197     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  1198     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  1199     12  AM-INACTIVE-DATE.                                        ERCACCT
  1200         16  AM-INA-MO                     PIC 99.                ERCACCT
  1201         16  AM-INA-DA                     PIC 99.                ERCACCT
  1202         16  AM-INA-YR                     PIC 99.                ERCACCT
  1203     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  1204                                                                  ERCACCT
  1205     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  1206     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  1207                                                                  ERCACCT
  1208     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  1209         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  1210         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  1211         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  1212         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  1213                                                                  ERCACCT
  1214     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  1215         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  1216         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  1217                                                                  ERCACCT
  1218     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  1219                                                                  ERCACCT
  1220     12  AM-OVER-SHORT.                                           ERCACCT
  1221         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  1222         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  1223                                                                  ERCACCT
  1224     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1225     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  25
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1226                                                                  ERCACCT
  1227     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  1228     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  1229                                                                  ERCACCT
  1230     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  1231     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  1232     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  1233     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  1234     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  1235     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  1236     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  1237     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  1238     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  1239     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  1240     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  1241     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  1242     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  1243     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  1244     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  1245     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  1246                                                                  ERCACCT
  1247     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  1248                                                                  ERCACCT
  1249     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  1250     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  1251                                                                  ERCACCT
  1252     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  1253     12  AM-EARN-METHODS.                                         ERCACCT
  1254         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  1255             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  1256             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  1257             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  1258             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  1259         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  1260             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  1261             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  1262             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  1263             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  1264         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  1265             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  1266             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  1267             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  1268             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  1269             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  1270             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  1271                                                                  ERCACCT
  1272     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  1273     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  1274     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  1275                                                                  ERCACCT
  1276     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  1277     12  AM-RET-P-E                        PIC X.                 ERCACCT
  1278     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  1279     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  1280     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  1281     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  1282         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  1283         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  26
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1284     12  AM-RETRO-EARNINGS.                                       ERCACCT
  1285         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  1286         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  1287         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  1288     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  1289         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  1290         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  1291     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  1292         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  1293         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  1294         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  1295     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  1296     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  1297                                                                  ERCACCT
  1298     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  1299         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  1300         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  1301         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  1302         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  1303         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  1304                                                                  ERCACCT
  1305     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  1306                                                                  ERCACCT
  1307     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  1308                                                                  ERCACCT
  1309     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  1310         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  1311                                                                  ERCACCT
  1312     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  1313         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  1314         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  1315                                                                  ERCACCT
  1316     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  1317         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  1318                                                                  ERCACCT
  1319     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  1320         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  1321         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  1322                                                                  ERCACCT
  1323     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  1324                                                                  ERCACCT
  1325     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  1326     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1327     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1328     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1329     12  AM-DCC-UEF-STATE                  PIC XX.
  1330     12  FILLER                            PIC XXX.
  1331     12  AM-REPORT-CODE-3                  PIC X(10).
  1332*    12  FILLER                            PIC X(22).             ERCACCT
  1333                                                                  ERCACCT
  1334     12  AM-RESERVE-DATE.                                         ERCACCT
  1335         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  1336         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  1337         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  1338                                                                  ERCACCT
  1339     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  1340     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  1341         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  27
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1342         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  1343         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  1344         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  1345                                                                  ERCACCT
  1346     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  1347         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  1348         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  1349         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  1350         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  1351                                                                  ERCACCT
  1352     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  1353         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  1354             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  1355             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  1356             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  1357             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  1358             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  1359             20  FILLER                    PIC XX.                ERCACCT
  1360         16  FILLER                        PIC X(80).             ERCACCT
  1361                                                                  ERCACCT
  1362     12  AM-TRANSFER-DATA.                                        ERCACCT
  1363         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  1364             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  1365             20  AM-TRNFROM-GROUPING.                             ERCACCT
  1366                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  1367                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  1368             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  1369             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  1370                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  1371                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  1372             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  1373         16  AM-TRANSFERRED-TO.                                   ERCACCT
  1374             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  1375             20  AM-TRNTO-GROUPING.                               ERCACCT
  1376                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  1377                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  1378             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  1379             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  1380                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  1381                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  1382             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  1383         16  FILLER                        PIC X(10).             ERCACCT
  1384                                                                  ERCACCT
  1385     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  1386                                                                  ERCACCT
  1387     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  1388         16  AM-DEFN-1-SAVED.                                     ERCACCT
  1389             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  1390                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  1391                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  1392                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1393                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1394                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1395                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  1396                 24  FILLER                PIC X.                 ERCACCT
  1397                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  1398                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  1399                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  28
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1400         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  1401             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  1402                 24  FILLER                PIC X(11).             ERCACCT
  1403                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  1404                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  1405                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  1406                 24  FILLER                PIC X(6).              ERCACCT
  1407                                                                  ERCACCT
  1408     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  1409         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  1410            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  1411            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  1412            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  1413                                                                  ERCACCT
  1414     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  1415     12  FILLER                            PIC X(120).            ERCACCT
  1416                                                                  ERCACCT
  1417     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  1418         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  1419         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  1420             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  1421             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  1422                                                          COMP-3. ERCACCT
  1423             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  1424                                                          COMP-3. ERCACCT
  1425         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  1426             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  1427             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  1428                                                          COMP-3. ERCACCT
  1429             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  1430                                                          COMP-3. ERCACCT
  1431                                                                  ERCACCT
  1432     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  1433         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  1434         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  1435         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  1436         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  1437             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  1438                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  1439                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  1440             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  1441                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  1442                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  1443             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  1444                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  1445                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  1446         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  1447             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  1448                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  1449                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  1450                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  1451             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  1452                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  1453                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  1454             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  1455                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  1456                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  1457                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  29
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1458     12  AM-COMMENTS.                                             ERCACCT
  1459         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  1460                                                                  ERCACCT
  1461     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  1462         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  1463         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  1464         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  1465         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  1466         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  1467             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  1468             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  1469             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  1470             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  1471         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  1472             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  1473             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  1474             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  1475         16  FILLER                        PIC X(102).            ERCACCT
  1476                                                                  ERCACCT
  1477     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  1478         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  1479             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  1480             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  1481             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  1482             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  1483             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  1484         16  FILLER                          PIC X(10).           ERCACCT
  1485******************************************************************ERCACCT
  1486
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  30
* EL331.cbl
  1488 FD  ELMSTR5.
  1489
* 1490                                 COPY ELCMSTR.
  1491******************************************************************04/15/98
  1492*                                                                *ELCMSTR
  1493*                            ELCMSTR.                            *   LV002
  1494*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1495*                            VMOD=2.012                          *   CL**2
  1496*                                                                *ELCMSTR
  1497*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  1498*                                                                *ELCMSTR
  1499*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  1500*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  1501*                                                                *ELCMSTR
  1502*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  1503*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  1504*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  1505*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  1506*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  1507*                                                 RKP=75,LEN=21  *ELCMSTR
  1508*                                                                *ELCMSTR
  1509*   **** NOTE ****                                               *ELCMSTR
  1510*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  1511*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  1512*                                                                *ELCMSTR
  1513*   LOG = YES                                                    *ELCMSTR
  1514*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  1515******************************************************************
  1516*                   C H A N G E   L O G
  1517*
  1518* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1519*-----------------------------------------------------------------
  1520*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1521* EFFECTIVE    NUMBER
  1522*-----------------------------------------------------------------
  1523* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1524* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1525* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1526******************************************************************ELCMSTR
  1527 01  CLAIM-MASTER.                                                ELCMSTR
  1528     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  1529         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  1530                                                                  ELCMSTR
  1531     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  1532         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  1533         16  CL-CARRIER              PIC X.                       ELCMSTR
  1534         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  1535         16  CL-CERT-NO.                                          ELCMSTR
  1536             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  1537             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  1538                                                                  ELCMSTR
  1539     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  1540         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  1541         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  1542         16  CL-INSURED-NAME.                                     ELCMSTR
  1543             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  1544             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  1545                                                                  ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  31
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1546     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
  1547         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
  1548         16  CL-SOC-SEC-NO.                                       ELCMSTR
  1549             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  1550             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  1551             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  1552                                                                  ELCMSTR
  1553     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  1554         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  1555         16  CL-CERT-NO-A4.                                       ELCMSTR
  1556             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  1557             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  1558                                                                  ELCMSTR
  1559     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  1560         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  1561         16  CL-CCN-A5.                                           ELCMSTR
  1562             20  CL-CCN.                                          ELCMSTR
  1563                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  1564                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  1565             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  1566                                                                  ELCMSTR
  1567     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  1568         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  1569         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  1570             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  1571             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  1572             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  1573         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  1574         16  FILLER                  PIC X(5).                    ELCMSTR
  1575                                                                  ELCMSTR
  1576     12  CL-PROCESSING-INFO.                                      ELCMSTR
  1577         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  1578         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  1579             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  1580             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  1581         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  1582*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  1583*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  1584*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  1585*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  1586*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  1587         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  1588             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  1589             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  1590             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  1591         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  1592         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  1593         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  1594         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  1595         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  1596         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  1597         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  1598         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  1599         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  1600         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  1601         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  1602             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  1603             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  32
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1604             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
  1605         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
  1606                                                                  ELCMSTR
  1607         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  1608             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  1609             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  1610                                                                  ELCMSTR
  1611         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  1612             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  1613             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  1614                                                                  ELCMSTR
  1615         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  1616         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  1617         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  1618                                                                  ELCMSTR
  1619         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  1620         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  1621         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  1622             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  1623             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  1624             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  1625             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  1626             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  1627             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  1628         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  1629         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  1630         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  1631             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  1632         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1633         16  FILLER                  PIC X.
  1634                                                                  ELCMSTR
  1635     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  1636         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  1637             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  1638             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  1639             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  1640         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  1641             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  1642             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  1643             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  1644             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  1645                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  1646                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  1647             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  1648                                                                  ELCMSTR
  1649     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  1650         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  1651             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  1652             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  1653         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  1654             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  1655             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  1656         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  1657         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  1658         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
  1659         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  1660         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  1661         16  CL-CRITICAL-PERIOD      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  33
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1662*        16  FILLER                  PIC XX.                      ELCMSTR
  1663         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  1664         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
  1665         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  1666         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  1667             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  1668             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  1669             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  1670             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  1671             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  1672             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  1673             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  1674             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  1675             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  1676         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  1677         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  1678         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  1679         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  1680         16  CL-DENIAL-TYPE          PIC X.
  1681             88  CL-TYPE-DENIAL          VALUE '1'.
  1682             88  CL-TYPE-RESCISSION      VALUE '2'.
  1683             88  CL-TYPE-REFORMATION     VALUE '3'.
  1684             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1685             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1686         16  CL-CRIT-PER-RECURRENT   PIC X.
  1687         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1688         16  CL-RTW-DT               PIC XX.
  1689                                                                  ELCMSTR
  1690     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  1691         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  1692             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  1693             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  1694             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  1695         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  1696         16  FILLER                  PIC XX.                      ELCMSTR
  1697         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  1698         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  1699             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1700                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  1701             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1702                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  1703             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  1704                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  1705             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  1706                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  1707             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  1708                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  1709             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1710                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  1711             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1712                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  1713                                                                  ELCMSTR
  1714     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  1715         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
  1716         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  1717                                                                  ELCMSTR
  1718     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  1719                                                                  ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  34
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1720     12  CL-PROCESS-ERRORS.                                       ELCMSTR
  1721         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  1722             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  1723         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  1724             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
  1725                                                                  ELCMSTR
  1726     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  1727                                                                  ELCMSTR
  1728     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  1729         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  1730         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  1731         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  1732         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  1733                                                                  ELCMSTR
  1734     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  1735         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  1736         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  1737         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  1738         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  1739                                                                  ELCMSTR
  1740     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  1741     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  1742     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  1743                                                                  ELCMSTR
  1744     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  1745     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  1746     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  1747     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  1748                                                                  ELCMSTR
  1749     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  1750     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1751         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1752         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1753         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1754     12  cl-insured-claim            pic x.
  1755         88  cl-claim-on-primary         value 'P'.
  1756         88  cl-claim-on-secondary       value 'S'.
  1757     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  35
* EL331.cbl
  1759 FD  ELRETR5.
  1760
* 1761                                 COPY ELCRETR.
  1762******************************************************************04/16/98
  1763*                                                                *ELCRETR
  1764*                                                                *ELCRETR
  1765*                            ELCRETR.                            *   LV002
  1766*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1767*                            VMOD=2.002                          *   CL**2
  1768*                                                                *ELCRETR
  1769*   FILE DESCRIPTION = CLAIM MASTER RETRIEVE FILE                *ELCRETR
  1770*                                                                *ELCRETR
  1771*   **** NOTE -- THIS FILE IS IDENTICAL TO CLAIM MASTER (ELMSTR) *ELCRETR
  1772*   ****      ANY CHANGES TO THIS COPYBOOK OR ELCMSTR MUST BE    *ELCRETR
  1773*   ****      DUPLICATED IN THE OTHER.                           *ELCRETR
  1774*                                                                *ELCRETR
  1775*   FILE TYPE = VSAM,KSDS                                        *ELCRETR
  1776*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCRETR
  1777*                                                                *ELCRETR
  1778*   BASE CLUSTER = ELRETR                         RKP=2,LEN=20   *ELCRETR
  1779*       ALTERNATE PATH1 = ELRETR2 (BY NAME)       RKP=22,LEN=29  *ELCRETR
  1780*       ALTERNATE PATH2 = ELRETR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCRETR
  1781*       ALTERNATE PATH3 = ELRETR5 (BY CERT NO)    RKP=63,LEN=12  *ELCRETR
  1782*       ALTERNATE PATH4 = ELRETR6 (BY CREDIT CARD NO)             ELCRETR
  1783*                                                 RKP=75,LEN=21  *ELCRETR
  1784*                                                                *ELCRETR
  1785*   LOG = YES                                                    *ELCRETR
  1786*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCRETR
  1787******************************************************************ELCRETR
  1788 01  RETRIEVE-MASTER.                                             ELCRETR
  1789     12  RL-RECORD-ID                PIC XX.                      ELCRETR
  1790         88  VALID-RL-ID         VALUE 'RL'.                      ELCRETR
  1791                                                                  ELCRETR
  1792     12  RL-CONTROL-PRIMARY.                                      ELCRETR
  1793         16  RL-COMPANY-CD           PIC X.                       ELCRETR
  1794         16  RL-CARRIER              PIC X.                       ELCRETR
  1795         16  RL-CLAIM-NO             PIC X(7).                    ELCRETR
  1796         16  RL-CERT-NO.                                          ELCRETR
  1797             20  RL-CERT-PRIME       PIC X(10).                   ELCRETR
  1798             20  RL-CERT-SFX         PIC X.                       ELCRETR
  1799                                                                  ELCRETR
  1800     12  RL-CONTROL-BY-NAME.                                      ELCRETR
  1801         16  RL-COMPANY-CD-A1        PIC X.                       ELCRETR
  1802         16  RL-INSURED-LAST-NAME    PIC X(15).                   ELCRETR
  1803         16  RL-INSURED-NAME.                                     ELCRETR
  1804             20  RL-INSURED-1ST-NAME PIC X(12).                   ELCRETR
  1805             20  RL-INSURED-MID-INIT PIC X.                       ELCRETR
  1806                                                                  ELCRETR
  1807     12  RL-CONTROL-BY-SSN.                                       ELCRETR
  1808         16  RL-COMPANY-CD-A2        PIC X.                       ELCRETR
  1809         16  RL-SOC-SEC-NO.                                       ELCRETR
  1810             20  RL-SSN-STATE        PIC XX.                      ELCRETR
  1811             20  RL-SSN-ACCOUNT      PIC X(6).                    ELCRETR
  1812             20  RL-SSN-LN3          PIC X(3).                    ELCRETR
  1813                                                                  ELCRETR
  1814     12  RL-CONTROL-BY-CERT-NO.                                   ELCRETR
  1815         16  RL-COMPANY-CD-A4        PIC X.                       ELCRETR
  1816         16  RL-CERT-NO-A4.                                       ELCRETR
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  36
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1817             20  RL-CERT-A4-PRIME    PIC X(10).                   ELCRETR
  1818             20  RL-CERT-A4-SFX      PIC X.                       ELCRETR
  1819                                                                  ELCRETR
  1820     12  RL-CONTROL-BY-CCN.                                       ELCRETR
  1821         16  RL-COMPANY-CD-A5        PIC X.                       ELCRETR
  1822         16  RL-CCN-A5.                                           ELCRETR
  1823             20  RL-CCN-NO.                                       ELCRETR
  1824                 24  RL-CCN-PREFIX-A5 PIC X(4).                   ELCRETR
  1825                 24  RL-CCN-PRIME-A5 PIC X(12).                   ELCRETR
  1826             20  RL-CCN-FILLER-A5    PIC X(4).                    ELCRETR
  1827                                                                  ELCRETR
  1828     12  RL-INSURED-PROFILE-DATA.                                 ELCRETR
  1829         16  RL-INSURED-BIRTH-DT     PIC XX.                      ELCRETR
  1830         16  RL-INSURED-SEX-CD       PIC X.                       ELCRETR
  1831             88  RL-INSURED-IS-MALE     VALUE 'M'.                ELCRETR
  1832             88  RL-INSURED-IS-FEMALE   VALUE 'F'.                ELCRETR
  1833             88  RL-INSURED-SEX-UNKNOWN VALUE ' '.                ELCRETR
  1834         16  RL-INSURED-OCC-CD       PIC X(6).                    ELCRETR
  1835         16  FILLER                  PIC X(5).                    ELCRETR
  1836                                                                  ELCRETR
  1837     12  RL-PROCESSING-INFO.                                      ELCRETR
  1838         16  RL-PROCESSOR-ID         PIC X(4).                    ELCRETR
  1839         16  RL-CLAIM-STATUS         PIC X.                       ELCRETR
  1840             88  RL-CLAIM-IS-OPEN       VALUE 'O'.                ELCRETR
  1841             88  RL-CLAIM-IS-CLOSED     VALUE 'C'.                ELCRETR
  1842         16  RL-CLAIM-TYPE           PIC X.                       ELCRETR
  1843*            88  RL-AH-CLAIM            VALUE 'A'.                ELCRETR
  1844*            88  RL-LIFE-CLAIM          VALUE 'L'.                ELCRETR
  1845*            88  RL-PROPERTY-CLAIM      VALUE 'P'.                ELCRETR
  1846*            88  RL-UNEMPLOYMENT-CLAIM  VALUE 'U'.                ELCRETR
  1847         16  RL-CLAIM-PREM-TYPE      PIC X.                       ELCRETR
  1848             88  RL-SINGLE-PREMIUM         VALUE '1'.             ELCRETR
  1849             88  RL-O-B-COVERAGE           VALUE '2'.             ELCRETR
  1850             88  RL-OPEN-END-COVERAGE      VALUE '3'.             ELCRETR
  1851         16  RL-INCURRED-DT          PIC XX.                      ELCRETR
  1852         16  RL-REPORTED-DT          PIC XX.                      ELCRETR
  1853         16  RL-FILE-ESTABLISH-DT    PIC XX.                      ELCRETR
  1854         16  RL-EST-END-OF-DISAB-DT  PIC XX.                      ELCRETR
  1855         16  RL-LAST-PMT-DT          PIC XX.                      ELCRETR
  1856         16  RL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCRETR
  1857         16  RL-PAID-THRU-DT         PIC XX.                      ELCRETR
  1858         16  RL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCRETR
  1859         16  RL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCRETR
  1860         16  RL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCRETR
  1861         16  RL-PMT-CALC-METHOD      PIC X.                       ELCRETR
  1862             88  RL-360-DAY-YR          VALUE '1'.                ELCRETR
  1863             88  RL-365-DAY-YR          VALUE '2'.                ELCRETR
  1864             88  RL-FULL-MONTHS         VALUE '3'.                ELCRETR
  1865         16  RL-CAUSE-CD             PIC X(6).                    ELCRETR
  1866                                                                  ELCRETR
  1867         16  RL-PRIME-CERT-NO.                                    ELCRETR
  1868             20  RL-PRIME-CERT-PRIME PIC X(10).                   ELCRETR
  1869             20  RL-PRIME-CERT-SFX   PIC X.                       ELCRETR
  1870                                                                  ELCRETR
  1871         16  RL-SYSTEM-IDENTIFIER    PIC XX.                      ELCRETR
  1872             88  RL-CREDIT-CLAIM        VALUE 'CR'.               ELCRETR
  1873             88  RL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCRETR
  1874                                                                  ELCRETR
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  37
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1875         16  RL-MICROFILM-NO         PIC X(10).                   ELCRETR
  1876         16  RL-PROG-FORM-TYPE       PIC X.                       ELCRETR
  1877         16  RL-LAST-ADD-ON-DT       PIC XX.                      ELCRETR
  1878                                                                  ELCRETR
  1879         16  RL-LAST-REOPEN-DT       PIC XX.                      ELCRETR
  1880         16  RL-LAST-CLOSE-DT        PIC XX.                      ELCRETR
  1881         16  RL-LAST-CLOSE-REASON    PIC X.                       ELCRETR
  1882             88  RL-FINAL-PAID          VALUE '1'.                ELCRETR
  1883             88  RL-CLAIM-DENIED        VALUE '2'.                ELCRETR
  1884             88  RL-AUTO-CLOSE          VALUE '3'.                ELCRETR
  1885             88  RL-MANUAL-CLOSE        VALUE '4'.                ELCRETR
  1886         16  RL-ASSOC-CERT-SEQU      PIC S99.                     ELCRETR
  1887         16  RL-ASSOC-CERT-TOTAL     PIC S99.                     ELCRETR
  1888         16  RL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCRETR
  1889             88  RL-PAYMENT-IN-PREP     VALUE 1 THRU 9.           ELCRETR
  1890         16  FILLER                  PIC X(5).                    ELCRETR
  1891                                                                  ELCRETR
  1892     12  RL-CERTIFICATE-DATA.                                     ELCRETR
  1893         16  RL-CERT-ORIGIN          PIC X.                       ELCRETR
  1894             88  RL-CERT-WAS-ONLINE     VALUE '1'.                ELCRETR
  1895             88  RL-CERT-WAS-CREATED    VALUE '2'.                ELCRETR
  1896             88  RL-COVERAGE-WAS-ADDED  VALUE '3'.                ELCRETR
  1897         16  RL-CERT-KEY-DATA.                                    ELCRETR
  1898             20  RL-CERT-CARRIER     PIC X.                       ELCRETR
  1899             20  RL-CERT-GROUPING    PIC X(6).                    ELCRETR
  1900             20  RL-CERT-STATE       PIC XX.                      ELCRETR
  1901             20  RL-CERT-ACCOUNT.                                 ELCRETR
  1902                 24  RL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCRETR
  1903                 24  RL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCRETR
  1904             20  RL-CERT-EFF-DT      PIC XX.                      ELCRETR
  1905                                                                  ELCRETR
  1906     12  RL-STATUS-CONTROLS.                                      ELCRETR
  1907         16  RL-PRIORITY-CD          PIC X.                       ELCRETR
  1908             88  RL-HIGHEST-PRIORITY    VALUE '9'.                ELCRETR
  1909         16  RL-SUPV-ATTN-CD         PIC X.                       ELCRETR
  1910             88  RL-SUPV-NOT-REQUIRED   VALUE ' ' 'N'.            ELCRETR
  1911             88  RL-SUPV-IS-REQUIRED    VALUE 'Y'.                ELCRETR
  1912         16  RL-PURGED-DT            PIC XX.                      ELCRETR
  1913         16  RL-RESTORED-DT          PIC XX.                      ELCRETR
  1914         16  RL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCRETR
  1915         16  RL-NEXT-RESEND-DT       PIC XX.                      ELCRETR
  1916         16  RL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCRETR
  1917         16  FILLER                  PIC XX.                      ELCRETR
  1918         16  RL-LAST-MAINT-DT        PIC XX.                      ELCRETR
  1919         16  RL-LAST-MAINT-USER      PIC X(4).                    ELCRETR
  1920         16  RL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCRETR
  1921         16  RL-LAST-MAINT-TYPE      PIC X.                       ELCRETR
  1922             88  RL-CLAIM-SET-UP           VALUE ' '.             ELCRETR
  1923             88  RL-PAYMENT-MADE           VALUE '1'.             ELCRETR
  1924             88  RL-LETTER-SENT            VALUE '2'.             ELCRETR
  1925             88  RL-MASTER-WAS-ALTERED     VALUE '3'.             ELCRETR
  1926             88  RL-MASTER-WAS-RESTORED    VALUE '4'.             ELCRETR
  1927             88  RL-INCURRED-DATE-CHANGED  VALUE '5'.             ELCRETR
  1928             88  RL-FILE-CONVERTED         VALUE '6'.             ELCRETR
  1929         16  RL-RELATED-CLAIM-NO     PIC X(7).                    ELCRETR
  1930         16  RL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCRETR
  1931         16  RL-BENEFICIARY          PIC X(10).                   ELCRETR
  1932         16  RL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCRETR
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  38
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1933         16  FILLER                  PIC X(6).                    ELCRETR
  1934                                                                  ELCRETR
  1935     12  RL-TRAILER-CONTROLS.                                     ELCRETR
  1936         16  RL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCRETR
  1937             88  RL-1ST-TRL-AVAIL       VALUE +4095.              ELCRETR
  1938             88  RL-LAST-TRL-AVAIL      VALUE +100.               ELCRETR
  1939             88  RL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCRETR
  1940         16  RL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCRETR
  1941         16  FILLER                  PIC XX.                      ELCRETR
  1942         16  RL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCRETR
  1943         16  RL-ADDRESS-TRAILER-CNT.                              ELCRETR
  1944             20  RL-INSURED-ADDR-CNT  PIC S9.                     ELCRETR
  1945                 88  RL-NO-INSURED-AVAILABLE VALUE ZERO.          ELCRETR
  1946             20  RL-ACCOUNT-ADDR-CNT  PIC S9.                     ELCRETR
  1947                 88  RL-ACCOUNT-IS-ONLINE    VALUE ZERO.          ELCRETR
  1948             20  RL-BENIF-ADDR-CNT    PIC S9.                     ELCRETR
  1949                 88  RL-BENEFICIARY-IS-ONLINE VALUE ZERO.         ELCRETR
  1950             20  RL-EMPLOYER-ADDR-CNT PIC S9.                     ELCRETR
  1951                 88  RL-NO-EMPLOY-AVAILABLE   VALUE ZERO.         ELCRETR
  1952             20  RL-DOCTOR-ADDR-CNT   PIC S9.                     ELCRETR
  1953                 88  RL-NO-DOCTOR-AVAILABLE   VALUE ZERO.         ELCRETR
  1954             20  RL-OTHER-1-ADDR-CNT  PIC S9.                     ELCRETR
  1955                 88  RL-NO-OTHER-1-ADDRESSES  VALUE ZERO.         ELCRETR
  1956             20  RL-OTHER-2-ADDR-CNT  PIC S9.                     ELCRETR
  1957                 88  RL-NO-OTHER-2-ADDRESSES  VALUE ZERO.         ELCRETR
  1958                                                                  ELCRETR
  1959     12  RL-CV-REFERENCE-NO.                                      ELCRETR
  1960         16  RL-CV-REFNO-PRIME       PIC X(18).                   ELCRETR
  1961         16  RL-CV-REFNO-SFX         PIC XX.                      ELCRETR
  1962                                                                  ELCRETR
  1963     12  RL-FILE-LOCATION            PIC X(4).                    ELCRETR
  1964                                                                  ELCRETR
  1965     12  RL-PROCESS-ERRORS.                                       ELCRETR
  1966         16  RL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCRETR
  1967             88  RL-NO-FATAL-ERRORS     VALUE ZERO.               ELCRETR
  1968         16  RL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCRETR
  1969             88  RL-NO-FORCABLE-ERRORS  VALUE ZERO.               ELCRETR
  1970                                                                  ELCRETR
  1971     12  RL-PRODUCT-CD               PIC X.                       ELCRETR
  1972                                                                  ELCRETR
  1973     12  RL-CURRENT-KEY-DATA.                                     ELCRETR
  1974         16  RL-CURRENT-CARRIER      PIC X.                       ELCRETR
  1975         16  RL-CURRENT-GROUPING     PIC X(6).                    ELCRETR
  1976         16  RL-CURRENT-STATE        PIC XX.                      ELCRETR
  1977         16  RL-CURRENT-ACCOUNT      PIC X(10).                   ELCRETR
  1978                                                                  ELCRETR
  1979     12  RL-ASSOCIATES               PIC X.                       ELCRETR
  1980         88  RL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCRETR
  1981         88  RL-ASSOC-INTERFACE         VALUE 'I'.                ELCRETR
  1982         88  RL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCRETR
  1983         88  RL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCRETR
  1984                                                                  ELCRETR
  1985     12  RL-ACTIVITY-CODE            PIC 99.                      ELCRETR
  1986     12  RL-ACTIVITY-MAINT-DT        PIC XX.                      ELCRETR
  1987     12  RL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCRETR
  1988                                                                  ELCRETR
  1989     12  RL-LAPSE-REPORT-CODE        PIC 9.                       ELCRETR
  1990     12  RL-LAG-REPORT-CODE          PIC 9.                       ELCRETR
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  39
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1991     12  RL-LOAN-TYPE                PIC XX.                      ELCRETR
  1992     12  RL-LEGAL-STATE              PIC XX.                      ELCRETR
  1993                                                                  ELCRETR
  1994     12  FILLER                      PIC X(5).                    ELCRETR
  1995
  1997 FD  DISK-DATE
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  40
* EL331.cbl
*                                      COPY ELCDTEFD.
  1998******************************************************************04/15/98
  1999*                                                                *ELCDTEFD
  2000*                                                                *ELCDTEFD
  2001*                            ELCDTEFD.                           *   LV002
  2002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2003*                            VMOD=2.007                          *   CL**2
  2004*                                                                *ELCDTEFD
  2005******************************************************************ELCDTEFD
  2006     BLOCK CONTAINS 0 RECORDS
  2007     RECORDING MODE F.                                            ELCDTEFD
  2008                                                                  ELCDTEFD
  2009 01  DATE-DISK.                                                   ELCDTEFD
  2010     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2011     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2012     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2013     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2014     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2015     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2016     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2017                                                                  ELCDTEFD
  2018 01  DATE-DISK-R.                                                 ELCDTEFD
  2019     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2020     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2021                                     PIC  X(32).                  ELCDTEFD
  2022                                                                  ELCDTEFD
  2023 01  DATE-DISK-T.                                                 ELCDTEFD
  2024     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2025     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2026                                     PIC  X(48).                  ELCDTEFD
  2027                                                                  ELCDTEFD
  2028 01  DATE-DISK-M.                                                 ELCDTEFD
  2029     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2030     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2031                                     PIC  X(48).                  ELCDTEFD
  2032                                                                  ELCDTEFD
  2033 01  DATE-DISK-P.                                                 ELCDTEFD
  2034     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2035     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2036     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2037     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2038         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2039                                     PIC  X.                      ELCDTEFD
  2040         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2041     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2042         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2043             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2044             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2045             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2046             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2047         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2048                                                                  ELCDTEFD
  2049 01  DATE-DISK-E.                                                 ELCDTEFD
  2050     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2051     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2052                                     PIC  X(4).                   ELCDTEFD
  2053                                                                  ELCDTEFD
  2054 01  DATE-DISK-C.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  41
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2055     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2056     12  DD-CARR1-SECPAY-SW          PIC  X.
  2057     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2058     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2059     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2060     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2061     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2062     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2063     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2064     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2065     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2066     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2067     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2068     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2069     12  DD-CARR2-SECPAY-SW          PIC  X.
  2070     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2071                                                                  ELCDTEFD
  2072 01  DATE-DISK-OPT.                                               ELCDTEFD
  2073     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2074     12  DD-TLR-DATA.                                             ELCDTEFD
  2075         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2076                                     PIC  X(03).                  ELCDTEFD
  2077     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2078         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2079                                     PIC  X(06).                  ELCDTEFD
  2080     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2081         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2082                                     PIC  X(07).                  ELCDTEFD
  2083         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2084     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2085                                     PIC  X(96).                  ELCDTEFD
  2086******************************************************************ELCDTEFD
  2087
  2089 FD  FICH
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  42
* EL331.cbl
*                                      COPY ELCFCHFD.
  2090******************************************************************04/15/98
  2091*                                                                *ELCFCHFD
  2092*                            ELCFCHFD.                           *   LV003
  2093*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2094*                            VMOD=2.004                          *   CL**3
  2095*                                                                *ELCFCHFD
  2096******************************************************************ELCFCHFD
  2097     BLOCK CONTAINS 0 RECORDS
  2098     RECORDING MODE F.                                            ELCFCHFD
  2099                                                                  ELCFCHFD
  2100 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2101******************************************************************ELCFCHFD
  2102
  2104 FD  ELREPT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  43
* EL331.cbl
*                                      COPY ELCRPTFD.
  2105******************************************************************04/16/98
  2106*                                                                *ELCRPTFD
  2107*                            ELCRPTFD.                           *   LV002
  2108*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2109*                            VMOD=2.001                          *ELCRPTFD
  2110*                                                                *ELCRPTFD
  2111* NOTE- USE ELCREPT AS COPY FOR 01 LEVEL                         *ELCRPTFD
  2112*                                                                *ELCRPTFD
  2113******************************************************************ELCRPTFD
  2114      LABEL RECORDS ARE STANDARD.                                 ELCRPTFD
  2115******************************************************************ELCRPTFD
* 2116                                 COPY ELCREPT.
  2117******************************************************************04/15/98
  2118*                                                                *ELCREPT
  2119*                                                                *ELCREPT
  2120*                            ELCREPT.                            *   LV002
  2121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2122*                            VMOD=2.002                          *   CL**2
  2123*                                                                *ELCREPT
  2124*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  2125*                                                                *ELCREPT
  2126*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  2127*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  2128*                                                                *ELCREPT
  2129*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  2130*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  2131*                                                                *ELCREPT
  2132*   LOG = NO                                                     *ELCREPT
  2133*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  2134******************************************************************ELCREPT
  2135 01  REPORT-SAVE-FILE.                                            ELCREPT
  2136     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  2137         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  2138                                                                  ELCREPT
  2139     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  2140         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  2141         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  2142             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  2143             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  2144         16  RF-REPORT-ID.                                        ELCREPT
  2145             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  2146                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  2147                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  2148             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  2149         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  2150     12  RF-REPORT-LINE-133.                                      ELCREPT
  2151         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
  2152         16  RF-DATA-133             PIC X(132).                  ELCREPT
  2153         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  2154             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  2155             20  FILLER              PIC X(52).                   ELCREPT
  2156         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  2157             20  FILLER              PIC X(53).                   ELCREPT
  2158             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  2159     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  2160         16  FILLER                  PIC X.                       ELCREPT
  2161         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  44
* EL331.cbl (/apps/prod/cid1p/copy/ELCREPT)
  2162         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  2163         16  FILLER                  PIC X(115).                  ELCREPT
  2164         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  2165******************************************************************ELCREPT
  2166
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  45
* EL331.cbl
  2168 FD  ERMEBL.
  2169
* 2170                                 COPY ERCMEBL.
  2171******************************************************************04/29/98
  2172*                                                                 ERCMEBL
  2173*                                                                 ERCMEBL
  2174*                            ERCMEBL                             *   LV004
  2175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  2176*                            VMOD 2.004                          *   CL**2
  2177*                                                                *ERCMEBL
  2178*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  2179*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  2180*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  2181*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  2182*                                                                *ERCMEBL
  2183*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  2184*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  2185*                                                                *ERCMEBL
  2186*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  2187*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  2188*                                                                *ERCMEBL
  2189******************************************************************ERCMEBL
  2190                                                                  ERCMEBL
  2191 01  MONTH-END-BALANCES.                                          ERCMEBL
  2192     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  2193     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  2194         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  2195         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  2196     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2197     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2198     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2199     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2200     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2201     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2202     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2203     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2204     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2205     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2206     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  2207     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  2208     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  2209     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2210     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  2211     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  2212     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2213     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2214     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2215     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  2216     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  2217     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2218     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  2219     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  2220     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2221     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2222     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2223     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2224     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2225     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  46
* EL331.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  2226     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2227     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  2228     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  2229     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2230     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  2231     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  2232     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2233     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2234     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2235     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2236     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  2237     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  2238     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2239     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2240     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2241     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2242     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  2243     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  2244     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2245     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2246     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2247     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  2248     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  2249     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  2250     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2251     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  2252     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  2253     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2254     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  2255     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  2256     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2257     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  2258     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2259     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  2260     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  2261     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2262     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  2263     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  2264     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  2265     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2266     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  2267     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2268     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  2269     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  2270     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  2271     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  2272     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  2273     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  2274     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  2275     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2276     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  2277     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  2278     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2279     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  2280     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2281     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  2282     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  2283     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  47
* EL331.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  2284     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2285     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2286     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2287     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  2288     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  2289     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2290     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  2291     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2292     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  2293     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  2294     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2295     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  2296     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2297     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  2298     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  2299     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2300     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  2301     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2302     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  2303     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  2304     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2305     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  2306     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2307     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  2308     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  2309     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2310     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  2311     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  2312     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  2313     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  2314     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  2315     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  2316     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  2317     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  2318     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  2319     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  2320     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2321     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2322     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2323     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2324     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2325     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  2326     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  2327     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2328     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2329     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2330     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2331     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2332     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2333     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  2334     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  2335     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2336     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  2337     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2338     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  2339     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  2340     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2341     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  48
* EL331.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  2342     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  2343     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2344     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  2345     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  2346     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2347     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  2348     12  FILLER                  PIC  X(88).                         CL**2
  2349******************************************************************ERCMEBL
  2350
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  49
* EL331.cbl
  2352 FD  ERMAIL.
  2353
* 2354                                 COPY ERCMAIL.
  2355******************************************************************
  2356*                                                                *
  2357*                                                                *
  2358*                            ERCMAIL                             *
  2359*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2360*                            VMOD=2.003                          *
  2361*                                                                *
  2362*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2363*                                                                *
  2364*   FILE TYPE = VSAM,KSDS                                        *
  2365*   RECORD SIZE = 374   RECFORM = FIX                            *
  2366*                                                                *
  2367*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2368*   ALTERNATE PATH    = NOT USED                                 *
  2369*                                                                *
  2370*   LOG = YES                                                    *
  2371*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2372******************************************************************
  2373*                   C H A N G E   L O G
  2374*
  2375* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2376*-----------------------------------------------------------------
  2377*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2378* EFFECTIVE    NUMBER
  2379*-----------------------------------------------------------------
  2380* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2381* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2382* 111108                   PEMA  ADD CRED BENE ADDR2
  2383******************************************************************
  2384
  2385 01  MAILING-DATA.
  2386     12  MA-RECORD-ID                      PIC XX.
  2387         88  VALID-MA-ID                       VALUE 'MA'.
  2388
  2389     12  MA-CONTROL-PRIMARY.
  2390         16  MA-COMPANY-CD                 PIC X.
  2391         16  MA-CARRIER                    PIC X.
  2392         16  MA-GROUPING.
  2393             20  MA-GROUPING-PREFIX        PIC XXX.
  2394             20  MA-GROUPING-PRIME         PIC XXX.
  2395         16  MA-STATE                      PIC XX.
  2396         16  MA-ACCOUNT.
  2397             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2398             20  MA-ACCOUNT-PRIME          PIC X(6).
  2399         16  MA-CERT-EFF-DT                PIC XX.
  2400         16  MA-CERT-NO.
  2401             20  MA-CERT-PRIME             PIC X(10).
  2402             20  MA-CERT-SFX               PIC X.
  2403
  2404     12  FILLER                            PIC XX.
  2405
  2406     12  MA-ACCESS-CONTROL.
  2407         16  MA-SOURCE-SYSTEM              PIC XX.
  2408             88  MA-FROM-CREDIT                VALUE 'CR'.
  2409             88  MA-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  50
* EL331.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  2410             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2411             88  MA-FROM-OTHER                 VALUE 'OT'.
  2412         16  MA-RECORD-ADD-DT              PIC XX.
  2413         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2414         16  MA-LAST-MAINT-DT              PIC XX.
  2415         16  MA-LAST-MAINT-BY              PIC XXXX.
  2416         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2417
  2418     12  MA-PROFILE-INFO.
  2419         16  MA-QUALIFY-CODE-1             PIC XX.
  2420         16  MA-QUALIFY-CODE-2             PIC XX.
  2421         16  MA-QUALIFY-CODE-3             PIC XX.
  2422         16  MA-QUALIFY-CODE-4             PIC XX.
  2423         16  MA-QUALIFY-CODE-5             PIC XX.
  2424
  2425         16  MA-INSURED-LAST-NAME          PIC X(15).
  2426         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2427         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2428         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2429         16  MA-INSURED-BIRTH-DT           PIC XX.
  2430         16  MA-INSURED-SEX                PIC X.
  2431             88  MA-SEX-MALE                   VALUE 'M'.
  2432             88  MA-SEX-FEMALE                 VALUE 'F'.
  2433         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2434
  2435         16  MA-ADDRESS-CORRECTED          PIC X.
  2436         16  MA-JOINT-BIRTH-DT             PIC XX.
  2437*        16  FILLER                        PIC X(12).
  2438
  2439         16  MA-ADDRESS-LINE-1             PIC X(30).
  2440         16  MA-ADDRESS-LINE-2             PIC X(30).
  2441         16  MA-CITY-STATE.
  2442             20  MA-CITY                   PIC X(28).
  2443             20  MA-ADDR-STATE             PIC XX.
  2444         16  MA-ZIP.
  2445             20  MA-ZIP-CODE.
  2446                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2447                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2448                 24  FILLER                PIC X(4).
  2449             20  MA-ZIP-PLUS4              PIC X(4).
  2450         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2451             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2452             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2453             20  FILLER                    PIC X(3).
  2454
  2455         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2456
  2457         16  FILLER                        PIC XXX.
  2458*        16  FILLER                        PIC X(10).
  2459
  2460
  2461     12  MA-CRED-BENE-INFO.
  2462         16  MA-CRED-BENE-NAME                 PIC X(25).
  2463         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2464         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2465         16  MA-CRED-BENE-CTYST.
  2466             20  MA-CRED-BENE-CITY             PIC X(28).
  2467             20  MA-CRED-BENE-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  51
* EL331.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  2468         16  MA-CRED-BENE-ZIP.
  2469             20  MA-CB-ZIP-CODE.
  2470                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  2471                     88  MA-CB-CANADIAN-POST-CODE
  2472                                           VALUE 'A' THRU 'Z'.
  2473                 24  FILLER                    PIC X(4).
  2474             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2475         16  MA-CB-CANADIAN-POSTAL-CODE
  2476                            REDEFINES MA-CRED-BENE-ZIP.
  2477             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2478             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2479             20  FILLER                        PIC X(3).
  2480     12  MA-POST-CARD-MAIL-DATA.
  2481         16  MA-MAIL-DATA OCCURS 7.
  2482             20  MA-MAIL-TYPE              PIC X.
  2483                 88  MA-12MO-MAILING           VALUE '1'.
  2484                 88  MA-EXP-MAILING            VALUE '2'.
  2485             20  MA-MAIL-STATUS            PIC X.
  2486                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2487                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2488                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2489             20  MA-MAIL-DATE              PIC XX.
  2490     12  FILLER                            PIC XX.
  2491     12  FILLER                            PIC XX.
  2492*    12  FILLER                            PIC X(30).
  2493******************************************************************
  2494
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  52
* EL331.cbl
  2496 FD  ERCTBL.
  2497
* 2498                                 COPY ERCCTBL.
  2499******************************************************************04/29/98
  2500*                                                                *ERCCTBL
  2501*                                                                *ERCCTBL
  2502*                            ERCCTBL                             *   LV002
  2503*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2504*                            VMOD=2.003                              CL**2
  2505*                                                                *ERCCTBL
  2506*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  2507*                                                                *ERCCTBL
  2508*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  2509*                                                                *ERCCTBL
  2510*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  2511*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  2512*                                                                *ERCCTBL
  2513*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  2514*       ALTERNATE PATH = NONE                                    *ERCCTBL
  2515*                                                                *ERCCTBL
  2516*   LOG = NO                                                     *ERCCTBL
  2517*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  2518*                                                                *ERCCTBL
  2519*                                                                *ERCCTBL
  2520******************************************************************ERCCTBL
  2521                                                                  ERCCTBL
  2522 01  COMM-TABLE-RECORD.                                           ERCCTBL
  2523     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  2524         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  2525                                                                  ERCCTBL
  2526     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  2527         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  2528         16  CT-TABLE                      PIC XXX.               ERCCTBL
  2529         16  CT-CNTRL-2.                                          ERCCTBL
  2530             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  2531             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  2532                                                                  ERCCTBL
  2533     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  2534         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  2535         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  2536         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  2537         16  FILLER                        PIC X(31).             ERCCTBL
  2538                                                                  ERCCTBL
  2539     12  CT-LIMITS.                                               ERCCTBL
  2540         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  2541                                                                  ERCCTBL
  2542         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  2543                                                                  ERCCTBL
  2544         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  2545                                                                  ERCCTBL
  2546     12  CT-RATES.                                                ERCCTBL
  2547         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  2548             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  2549             20  CT-RT-R   REDEFINES                              ERCCTBL
  2550                 CT-RT                     PIC XXX.               ERCCTBL
  2551                                                                  ERCCTBL
  2552     12  FILLER                            PIC  X(42).            ERCCTBL
  2553                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  53
* EL331.cbl
  2554******************************************************************ERCCTBL
  2555
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  54
* EL331.cbl
  2557 FD  DISPLAY-PRT
  2558     RECORDING MODE F
  2559     LABEL RECORDS ARE STANDARD
  2560     RECORD CONTAINS 133 CHARACTERS
  2561     BLOCK CONTAINS 0 RECORDS
  2562     DATA RECORD IS DISPLAY-REC.
  2563
  2564 01  DISPLAY-REC.
  2565     12  DISPLAY-CC              PIC X.
  2566     12  DISPLAY-INFO            PIC X(132).
  2567
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  55
* EL331.cbl
  2569 WORKING-STORAGE SECTION.
  2570 77  FILLER  PIC X(32) VALUE '********************************'.
  2571 77  FILLER  PIC X(32) VALUE '*    EL331  WORKING-STORAGE    *'.
  2572 77  FILLER  PIC X(32) VALUE '********** VMOD=2.037 **********'.
  2573
  2574 77  DIS-HEAD-SW             PIC X       VALUE 'Y'.
  2575 77  ERROR-COUNT             PIC 9(7)    VALUE ZEROS.
  2576 77  DIS-LINE-CNT            PIC 99      VALUE ZEROS.
  2577
  2578 77  NDX                         PIC S9(4) COMP     VALUE ZERO.
  2579 77  CINDX                       PIC S9(4) COMP     VALUE ZERO.
  2580
  2581 77  WS-ACT-END-SW               PIC X              VALUE SPACE.
  2582     88  NO-MORE-ACT-RECORDS         VALUE 'X'.
  2583     88  MORE-ACT-RECORDS            VALUE ' '.
  2584
  2585 77  WS-FIRST-TIME-SW            PIC X              VALUE '1'.
  2586     88  FIRST-TIME                  VALUE '1'.
  2587
  2588 77  WS-PRT-FULL-LINE-SW         PIC X              VALUE SPACE.
  2589     88  LINE-FULL                   VALUE 'X'.
  2590
  2591 77  WS-ONL-GE-SW                PIC X              VALUE SPACE.
  2592     88  ONL-KEY-EQUAL-OR-GREATER    VALUE 'X'.
  2593
  2594 77  WS-B-END-SW                 PIC X              VALUE SPACE.
  2595     88  END-O-FILE                  VALUE 'E'.
  2596
  2597 77  WS-CLM-END-SW               PIC X              VALUE SPACE.
  2598     88  NO-MORE-CLAIM-MATCH         VALUE 'X'.
  2599
  2600 77  WS-ONL-END-SW               PIC X              VALUE SPACE.
  2601     88  NO-MORE-ONL-RECORDS         VALUE 'X'.
  2602     88  MORE-ONL-RECORDS            VALUE ' '.
  2603
  2604 77  WS-ALL-END-SW               PIC X              VALUE SPACE.
  2605     88  NO-MORE-RECORDS             VALUE 'X'.
  2606
  2607 77  WS-ECS-END-SW               PIC X              VALUE SPACE.
  2608     88  NO-MORE-ECS-RECORDS         VALUE 'X'.
  2609     88  MORE-ECS-RECORDS            VALUE ' '.
  2610
  2611 77  ERROR-SW                    PIC X              VALUE SPACE.
  2612     88  ERROR-OCCURRED              VALUE 'E'.
  2613     88  NO-ERRORS                   VALUE ' '.
  2614
  2615 77  WS-O-MATCH-SW               PIC X              VALUE 'M'.
  2616     88  MATCHED-REC                 VALUE 'M'.
  2617     88  NO-MATCH-FOUND              VALUE ' '.
  2618
  2619 77  WS-IO-ERROR-SW              PIC X              VALUE SPACE.
  2620     88  IO-ERROR                    VALUE 'E'.
  2621     88  IO-ERROR-OCCURRED           VALUE 'E'.
  2622
  2623 77  NO-PREM-CT                  PIC 9(07)          VALUE ZEROS.
  2624 77  NO-PLAN-CODE-CT             PIC 9(07)          VALUE ZEROS.
  2625 77  WS-LINE-CNT                 PIC S999  COMP-3   VALUE ZEROS.
  2626 77  WS-PAGE-CNT                 PIC S999  COMP-3   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  56
* EL331.cbl
  2627 77  WS-MAX-LINES                PIC S999  COMP-3   VALUE +60.
  2628 77  X                           PIC X              VALUE SPACE.
  2629 77  WS-ZERO                     PIC S9    COMP-3   VALUE ZERO.
  2630 77  WS-RETURN-CODE              PIC S9(4) COMP     VALUE ZERO.
  2631 77  WS-LEVEL-INDEX              PIC S9(4) COMP     VALUE ZERO.
  2632
  2633 77  WS-ABEND-MESSAGE            PIC X(80)          VALUE SPACES.
  2634 77  WS-ABEND-FILE-STATUS        PIC XX             VALUE ZERO.
  2635
  2636 77  WS-CLAIM-SW                 PIC X              VALUE SPACE.
  2637     88  NO-ASSOCIATED-CLAIM         VALUE 'N'.
  2638     88  ASSOCIATED-CLAIM            VALUE 'A'.
  2639
  2640 77  WS-ERCOMM-SW                PIC X              VALUE SPACE.
  2641     88  ASSOCIATED-ERCOMM           VALUE '1'.
  2642 77  ws-cert-load-sw             pic x value spaces.
  2643     88  do-not-load                value 'Y'.
  2644
  2645 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2646     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2647
  2648 01  WS-ME50-BALANCE-REC.
  2649     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2650     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2651     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'EL331   '.
  2652     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2653     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2654     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2655     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2656     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2657     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2658
  2659 01  DISPLAY-HD-1.
  2660     12  FILLER      PIC X     VALUE SPACES.
  2661     12  FILLER      PIC X(51) VALUE SPACES.
  2662     12  FILLER      PIC X(23) VALUE 'PROCESSING ERROR REPORT'.
  2663     12  FILLER      PIC X(51) VALUE SPACES.
  2664     12  FILLER      PIC X(07) VALUE ' EL-331'.
  2665
  2666 01  DISPLAY-HD-2.
  2667     12  FILLER      PIC X     VALUE SPACES.
  2668     12  FILLER      PIC X     VALUE SPACES.
  2669     12  FILLER      PIC X(56) VALUE SPACES.
  2670     12  DIS-DATE    PIC X(8)  VALUE SPACES.
  2671     12  FILLER      PIC X(67) VALUE SPACES.
  2672
  2673 01  DISPLAY-LINE.
  2674     05  DISPLAY-LINE-05.
  2675        10  DIS-CC              PIC X.
  2676        10  DIS-LINE-REASON     PIC X(32).
  2677        10  DIS-LINE-REC        PIC X(100).
  2678
  2679     05  DISPLAY-LINE-ALT  REDEFINES  DISPLAY-LINE-05.
  2680        10  DIS-CC-ALT          PIC X.
  2681        10  DIS-FLD-1           PIC X(52).
  2682        10  DIS-FLD-2           PIC X(80).
  2683
  2684 01  WK-MEMB-ACCT.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  57
* EL331.cbl
  2685     12  WK-MEMB-ACCT-CHAR       PIC X   OCCURS 6.
  2686 01  WK-LAST-NAME.
  2687     12  WK-LAST-NAME-CHAR       PIC X   OCCURS 12.
  2688
  2689 01  WORK-AREA.
  2690     12  LST-NM-SUB              PIC S9(4) COMP  VALUE +0.
  2691     12  ACCT-SUB                PIC S9(4) COMP  VALUE +0.
  2692     12  BIN-CR-DT               PIC XX    VALUE SPACES.
  2693     12  ERROR-FLAG              PIC X           VALUE ' '.
  2694        88 NO-ERRORS                    VALUE ' '.
  2695        88 NON-ALPHA                    VALUE 'A'.
  2696        88 BLANK-NAME                   VALUE 'B'.
  2697
  2698 01  MONTH-END-DATA.
  2699     12  ME-START-DATE.
  2700         16  ME-START-MO         PIC 99.
  2701         16  FILLER              PIC X.
  2702         16  ME-START-DA         PIC 99.
  2703         16  FILLER              PIC X.
  2704         16  ME-START-YR         PIC 99.
  2705     12  ME-CNDS-DATE            PIC 9(6).
  2706     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2707         16  ME-CNDS-MO          PIC 99.
  2708         16  ME-CNDS-DA          PIC 99.
  2709         16  ME-CNDS-YR          PIC 99.
  2710     12  ME-START-TIME           PIC 9(6).
  2711     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2712         88  ME-DO-UPDATE        VALUE 'Y'.
  2713         88  ME-NO-UPDATE        VALUE 'N'.
  2714     12  ERMEBL-FILE-STATUS      PIC XX.
  2715     12  ERCTBL-FILE-STATUS      PIC XX.
  2716     12  MONTH-END-MOYR          PIC S9(5)    COMP-3.
  2717
  2718 01  DTE-INTERFACE-AREAS.
  2719     12  PGM-SUB                 PIC S9(4)    COMP VALUE +331.
  2720     12  ABEND-CODE              PIC XXXX          VALUE SPACE.
  2721     12  ABEND-OPTION            PIC X.
  2722     12  OLC-REPORT-NAME         PIC X(5)          VALUE 'EL331'.
  2723
  2724 01  WS-SAVE-AREAS.
  2725     12  FILLER   PIC X(27)  VALUE '---------------------------'.
  2726     12  FILLER   PIC X(27)  VALUE '---- EL331 SAVED AREAS ----'.
  2727     12  FILLER   PIC X(27)  VALUE '---------------------------'.
  2728
  2729     12  WS-ECS-READ       COMP-3     PIC S9(9)   VALUE ZEROS.
  2730     12  WS-ACT-READ       COMP-3     PIC S9(9)   VALUE ZEROS.
  2731     12  WS-ACCT-READS     COMP-3     PIC S9(9)   VALUE ZEROS.
  2732     12  WS-ACCT-MATCH     COMP-3     PIC S9(9)   VALUE ZEROS.
  2733     12  WS-EXCP-ADD       COMP-3     PIC S9(9)   VALUE ZEROS.
  2734     12  WS-EXCP-TBL       COMP-3     PIC S9(9)   VALUE ZEROS.
  2735     12  WS-EXCP-DEL       COMP-3     PIC S9(9)   VALUE ZEROS.
  2736     12  WS-MAIL-DEL       COMP-3     PIC S9(9)   VALUE ZEROS.
  2737     12  WS-MATCHED-ONL    COMP-3     PIC S9(9)   VALUE ZEROS.
  2738     12  WS-ONL-READ       COMP-3     PIC S9(9)   VALUE ZEROS.
  2739     12  WS-LOADED-ECS     COMP-3     PIC S9(9)   VALUE ZEROS.
  2740     12  WS-ONL-DELETED    COMP-3     PIC S9(9)   VALUE ZEROS.
  2741     12  WS-ONL-EXIST      COMP-3     PIC S9(9)   VALUE ZEROS.
  2742     12  WS-CLAIM-MATCH    COMP-3     PIC S9(9)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  58
* EL331.cbl
  2743     12  WS-INACTIVE-CERTS COMP-3     PIC S9(9)   VALUE ZEROS.
  2744     12  WS-EXPIRE-MOS     COMP-3     PIC S9(9)   VALUE ZEROS.
  2745     12  WS-WORK-TERM      COMP-3     PIC S9(3)   VALUE ZEROS.
  2746     12  WS-CURRENT-MOS           PIC S9(9) COMP-3  VALUE ZEROS.
  2747     12  WS-UPDATE-SW             PIC S9  COMP-3    VALUE ZERO.
  2748     12  WS-ONL-RECORD            PIC  X(450)       VALUE SPACES.
  2749     12  WS-BEFORE-CERT           PIC  X(450)       VALUE SPACES.
  2750     12  WS-LAST-CLAIM-MATCHED    PIC  X(450)       VALUE SPACES.
  2751     12  WS-CLM-CNT               PIC  S9(4)  COMP  VALUE ZEROS.
  2752     12  WS-CM-ORIG               PIC  X            VALUE SPACE.
  2753     12  WS-CL-ORIG               PIC  X            VALUE SPACE.
  2754     12  WS-CM-INSURED-ADDRESS-SW PIC  X            VALUE SPACE.
  2755     12  WS-CM-ENTRY-BATCH        PIC  X(6)         VALUE SPACES.
  2756     12  WS-CM-LF-EXIT-BATCH      PIC  X(6)         VALUE SPACES.
  2757     12  WS-CM-AH-EXIT-BATCH      PIC  X(6)         VALUE SPACES.
  2758     12  WS-CM-BENEFICIARY        PIC  X(25)        VALUE SPACES.
  2759     12  WS-LST-ADD-ON-DT         PIC  XX           VALUE SPACES.
  2760     12  WS-LN-NUMBER             PIC  X(8)         VALUE SPACES.
  2761     12  WS-LN-BALANCE            PIC S9(7)V99 COMP-3 VALUE ZERO.
  2762     12  WS-CLAIM-DEDUCT-WITHHELD PIC S9(5)V99 COMP-3 VALUE ZERO.
  2763     12  WS-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99 COMP-3 VALUE ZERO.
  2764     12  WS-LF-DEATH-EXIT-DT      PIC X(02)      VALUE LOW-VALUES.
  2765     12  WS-LF-CURRENT-STATUS     PIC X(01)      VALUE SPACE.
  2766     12  WS-LF-STATUS-AT-DEATH    PIC X(01)      VALUE SPACE.
  2767     12  WS-EOM-DT                PIC X(02)      VALUE LOW-VALUES.
  2768
  2769     12  WS-NAME-WORK.
  2770         16  WS-NAME-14           PIC X(14)          VALUE SPACE.
  2771         16  WS-NAME-15           PIC X              VALUE '|'.
  2772
  2773     12  WS-EFF-ACT-NAME.
  2774         16  WS-NAME-EFF-DT      PIC X(6)  VALUE SPACES.
  2775         16  WS-NAME-FILL        PIC XX    VALUE SPACES.
  2776         16  WS-NAME-ACCT        PIC X(7)  VALUE SPACES.
  2777
  2778     12  WS-HAN-ACCOUNT.
  2779         16  FILLER              PIC XXX   VALUE SPACES.
  2780         16  WS-HAN-ACCT-4-10    PIC X(7)  VALUE SPACES.
  2781
  2782     12  WS-HI-LAST-NAME.
  2783         16  FILLER              PIC X(8)  VALUE SPACES.
  2784         16  WS-HI-CERT-4-10     PIC X(7)  VALUE SPACES.
  2785
  2786     12  WS-CLAS-I-CALC-TYPE     PIC X              VALUE SPACE.
  2787     12  WS-CLAS-I-BEN           PIC XX             VALUE SPACES.
  2788
  2789     12  CL-STATUS.
  2790         16  CL-STAT-1           PIC X              VALUE ZERO.
  2791         16  CL-STAT-2           PIC X              VALUE ZERO.
  2792
  2793     12  ELRETR5-FILE-STATUS.
  2794         16  ELRETR5-STAT-1      PIC X              VALUE ZERO.
  2795         16  ELRETR5-STAT-2      PIC X              VALUE ZERO.
  2796
  2797     12  ERMAIL-FILE-STATUS.
  2798         16  CFS-STAT-1          PIC X              VALUE ZERO.
  2799         16  CFS-STAT-2          PIC X              VALUE ZERO.
  2800
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  59
* EL331.cbl
  2801     12  CM-STATUS.
  2802         16  CM-STAT-1           PIC X              VALUE ZERO.
  2803         16  CM-STAT-2           PIC X              VALUE ZERO.
  2804
  2805     12  CE-STATUS.
  2806         16  CE-STAT-1           PIC X              VALUE ZERO.
  2807         16  CE-STAT-2           PIC X              VALUE ZERO.
  2808
  2809     12  AM-STATUSF.
  2810         16  AM-STAT-1           PIC X              VALUE ZERO.
  2811         16  AM-STAT-2           PIC X              VALUE ZERO.
  2812
  2813     12  WS-CM-CONTROL-PRIMARY   PIC X(33)  VALUE LOW-VALUES.
  2814
  2815     12  WS-SAVED-ECS-KEY.
  2816         16  WS-SAVED-B-COMP     PIC X     VALUE LOW-VALUE.
  2817         16  WS-SAVED-B-CARR     PIC X     VALUE SPACE.
  2818         16  WS-SAVED-B-GRPG     PIC X(6)  VALUE SPACES.
  2819         16  WS-SAVED-B-STAT     PIC XX    VALUE SPACES.
  2820         16  WS-SAVED-B-ACCT     PIC X(10) VALUE SPACES.
  2821         16  WS-SAVED-B-DATE     PIC 9(11) COMP-3 VALUE ZEROS.
  2822         16  WS-SAVED-B-CERT     PIC X(11) VALUE SPACES.
  2823
  2824     12  WS-SAVED-ONL-KEY.
  2825         16  WS-SAVED-O-COMP     PIC X     VALUE LOW-VALUE.
  2826         16  WS-SAVED-O-CARR     PIC X     VALUE SPACE.
  2827         16  WS-SAVED-O-GRPG     PIC X(6)  VALUE SPACES.
  2828         16  WS-SAVED-O-STAT     PIC XX    VALUE SPACES.
  2829         16  WS-SAVED-O-ACCT     PIC X(10) VALUE SPACES.
  2830         16  WS-SAVED-O-DATE     PIC 9(11) COMP-3 VALUE ZEROS.
  2831         16  WS-SAVED-O-CERT     PIC X(11) VALUE SPACES.
  2832
  2833     12  WS-CLAIM-MATCH-KEY.
  2834         16  WS-CL-CARR          PIC X     VALUE SPACES.
  2835         16  WS-CL-GRPG          PIC X(6)  VALUE SPACES.
  2836         16  WS-CL-STAT          PIC XX    VALUE SPACES.
  2837         16  WS-CL-ACCT          PIC X(10) VALUE SPACES.
  2838         16  WS-CL-EFDT          PIC XX    VALUE LOW-VALUES.
  2839
  2840     12  WS-SEC-CLAIM-INDEX.
  2841         16  WS-S-CL-COMP        PIC X     VALUE LOW-VALUES.
  2842         16  WS-S-CL-PRIM        PIC X(10) VALUE SPACES.
  2843         16  WS-S-CL-SFX         PIC X     VALUE SPACE.
  2844
  2845     12  WS-CM-CANCEL-DATE.
  2846         16  WS-CM-CANC-MO       PIC XX   VALUE SPACES.
  2847         16  WS-CM-CANC-DA       PIC XX   VALUE SPACES.
  2848         16  WS-CM-CANC-YR       PIC XX   VALUE SPACES.
  2849
  2850     12  WS-CURRENT-DATE-MDY.
  2851         16  WS-CURR-MO          PIC XX   VALUE SPACES.
  2852         16  WS-CURR-DA          PIC XX   VALUE SPACES.
  2853         16  WS-CURR-YR          PIC XX   VALUE SPACES.
  2854
  2855     12  WS-CTBL-KEY.
  2856         16  WS-CTBL-COMP-CD     PIC X    VALUE LOW-VALUES.
  2857         16  WS-CTBL-TABLE       PIC XXX  VALUE SPACES.
  2858         16  WS-CTBL-BEN-TYPE    PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  60
* EL331.cbl
  2859         16  WS-CTBL-BEN-CODE    PIC XX   VALUE '  '.
  2860     12  WS-LAST-CTBL-KEY        PIC X(7) VALUE SPACES.
  2861
  2862 01  COMM-MATCH-AREA.
  2863     12  WS-L-COM                PIC SV9(5) COMP-3 VALUE +0.
  2864     12  WS-J-COM                PIC SV9(5) COMP-3 VALUE +0.
  2865     12  WS-A-COM                PIC SV9(5) COMP-3 VALUE +0.
  2866     12  WS-COMM-CK-AMT          PIC S9(9)V99 COMP-3 VALUE +0.
  2867     12  WS-CK-AGE               PIC S999    VALUE ZEROS.
  2868     12  WS-CK-TERM              PIC S99     VALUE ZEROS.
  2869
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  61
* EL331.cbl
* 2871                                 COPY ELCDATE.
  2872******************************************************************06/11/98
  2873*                                                                *ELCDATE
  2874*                                                                *ELCDATE
  2875*                            ELCDATE.                            *   LV023
  2876*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  2877*                            VMOD=2.003                           ELCDATE
  2878*                                                                *ELCDATE
  2879*                                                                *ELCDATE
  2880*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  2881*                 LENGTH = 200                                   *   CL*19
  2882******************************************************************ELCDATE
  2883                                                                  ELCDATE
  2884 01  DATE-CONVERSION-DATA.                                        ELCDATE
  2885     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  2886     12  DC-OPTION-CODE                PIC X.                        CL*15
  2887         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  2888         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  2889         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  2890         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  2891         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  2892         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  2893         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  2894         88  FIND-CENTURY               VALUE '7'.                   CL*22
  2895         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  2896         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  2897         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  2898         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  2899         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  2900         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  2901         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  2902         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  2903         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  2904         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  2905         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  2906         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  2907         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  2908         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  2909         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  2910         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  2911         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  2912         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  2913         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  2914         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  2915         88  THREE-CHARACTER-BIN                                  ELCDATE
  2916                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  2917         88  GREGORIAN-TO-BIN                                        CL**2
  2918                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  2919         88  BIN-TO-GREGORIAN                                        CL**2
  2920                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  2921         88  JULIAN-TO-BINARY                                        CL**2
  2922                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  2923     12  DC-ERROR-CODE                 PIC X.                        CL*15
  2924         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  2925         88  DATE-CONVERSION-ERROR                                ELCDATE
  2926                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  2927         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  2928         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  62
* EL331.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2929         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  2930         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  2931         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  2932         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  2933         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  2934         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  2935         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  2936         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  2937     12  DC-END-OF-MONTH               PIC X.                        CL*15
  2938         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  2939     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  2940         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  2941         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  2942         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  2943     12  FILLER                        PIC X.                        CL*15
  2944     12  DC-CONVERSION-DATES.                                        CL*15
  2945         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  2946         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  2947         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  2948         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  2949                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  2950             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  2951             20  SLASH1-1              PIC X.                        CL*15
  2952             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  2953             20  SLASH1-2              PIC X.                        CL*15
  2954             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  2955         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  2956         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  2957                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  2958             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  2959             20  SLASH2-1              PIC X.                        CL*15
  2960             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  2961             20  SLASH2-2              PIC X.                        CL*15
  2962             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  2963         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  2964         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  2965                     DC-GREG-DATE-1-YMD.                          ELCDATE
  2966             20  DC-YMD-YEAR           PIC 99.                       CL*15
  2967             20  DC-YMD-MONTH          PIC 99.                       CL*15
  2968             20  DC-YMD-DAY            PIC 99.                       CL*15
  2969         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  2970         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  2971                      DC-GREG-DATE-1-MDY.                         ELCDATE
  2972             20  DC-MDY-MONTH          PIC 99.                       CL*15
  2973             20  DC-MDY-DAY            PIC 99.                       CL*15
  2974             20  DC-MDY-YEAR           PIC 99.                       CL*15
  2975         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  2976             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  2977             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  2978             20  FILLER                PIC XX.                       CL*15
  2979             20  DC-ALPHA-CENTURY.                                   CL*15
  2980                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  2981             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  2982         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  2983         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  2984         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  2985         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  2986         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  63
* EL331.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2987                                       PIC 9(05).                    CL*20
  2988         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  2989             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  2990             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  2991         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  2992         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  2993         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  2994     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  2995         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  2996         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  2997             20  FILLER                PIC 9(3).                     CL*15
  2998             20  HOLD-CEN-1-CCYY.                                    CL*15
  2999                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  3000                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  3001             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  3002             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  3003         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  3004             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  3005             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  3006             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  3007                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  3008                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  3009             20  FILLER                PIC 9(3).                     CL*15
  3010         16  HOLD-CENTURY-1-X.                                       CL*15
  3011             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  3012             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  3013                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  3014                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  3015             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  3016             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  3017         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  3018             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  3019             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  3020             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  3021                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  3022                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  3023             20  FILLER                PIC XXX.                      CL*23
  3024         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  3025         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  3026         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  3027         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  3028             20  DC-JULIAN-1-CCYY.                                   CL*15
  3029                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  3030                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  3031             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  3032         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  3033         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  3034             20  DC-JULIAN-2-CCYY.                                   CL*15
  3035                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  3036                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  3037             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  3038         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  3039             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  3040             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  3041             20  DC-EDITA-DAY          PIC 99.                       CL*15
  3042             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  3043             20  DC-EDITA-CCYY.                                      CL*15
  3044                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  64
* EL331.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3045                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  3046         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  3047             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  3048             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  3049             20  DC-EDITB-DAY          PIC 99.                       CL*15
  3050             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  3051             20  DC-EDITB-CCYY.                                      CL*15
  3052                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  3053                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  3054         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  3055         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  3056                              DC-GREG-DATE-CYMD.                  ELCDATE
  3057             20  DC-CYMD-CEN           PIC 99.                       CL*15
  3058             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  3059             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  3060             20  DC-CYMD-DAY           PIC 99.                       CL*15
  3061         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  3062         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  3063                              DC-GREG-DATE-MDCY.                  ELCDATE
  3064             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  3065             20  DC-MDCY-DAY           PIC 99.                       CL*15
  3066             20  DC-MDCY-CEN           PIC 99.                       CL*15
  3067             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  3068    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  3069        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  3070    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  3071    12  FILLER                         PIC X(28).                    CL*26
  3072
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  65
* EL331.cbl
  3074 01  PRINTER-WORK-AREAS.
  3075     12  HEADING-1.
  3076         16  FILLER      PIC X(50) VALUE SPACE.
  3077         16  FILLER      PIC X(21) VALUE '  CERTIFICATE AUDIT  '.
  3078         16  FILLER      PIC X(60) VALUE SPACES.
  3079
  3080     12  HEADING-2.
  3081         16  FILLER      PIC X(47) VALUE SPACE.
  3082         16  HD-COMP-NM  PIC X(30) VALUE SPACE.
  3083         16  FILLER      PIC X(42) VALUE SPACES.
  3084         16  FILLER      PIC X(08) VALUE 'EL331  '.
  3085
  3086     12  HEADING-3.
  3087         16  FILLER      PIC X(50) VALUE SPACE.
  3088         16  FILLER      PIC X(3)  VALUE '** '.
  3089         16  HD-DATE-FULL PIC X(18).
  3090         16  FILLER      PIC X(3)  VALUE ' **'.
  3091         16  FILLER      PIC X(45)  VALUE SPACES.
  3092         16  HD-RUN-DATE PIC X(8).
  3093
  3094     12  HEADING-4.
  3095         16  FILLER      PIC X(119) VALUE SPACE.
  3096         16  FILLER      PIC X(4)   VALUE 'PAGE'.
  3097         16  HD-PAGE-NO  PIC ZZZ9.
  3098
  3099     12  HEADING-5.
  3100         16  FILLER      PIC X(44)  VALUE
  3101         ' *---------- CERTIFICATE CONTROLS ---------*'.
  3102         16  FILLER      PIC X(44)  VALUE
  3103         '  *------------ ASSOCIATED CLAIM -----------'.
  3104         16  FILLER      PIC X(45)  VALUE
  3105         '---* *------- EXCEPTION CONDITION ----------*'.
  3106
  3107     12  HEADING-6.
  3108         16  FILLER      PIC X(46)  VALUE
  3109             '   NUMBER   EFFECTIVE C GROUP  ST  ACCOUNT    '.
  3110         16  FILLER      PIC X(46)  VALUE
  3111             'NUMBER  TYPE STATUS LN KIND INCURRED PROCESSOR'.
  3112         16  FILLER      PIC X(41)  VALUE  SPACES.
  3113
  3114     12  DTL-1.
  3115         16  FILLER              PIC X              VALUE SPACE.
  3116         16  DTL-CERT-NO         PIC X(11).
  3117         16  FILLER              PIC X              VALUE SPACE.
  3118         16  DTL-EFFECTIVE-DT.
  3119             20  DTL-EFF-MO      PIC XX.
  3120             20  FILLER          PIC X              VALUE '/'.
  3121             20  DTL-EFF-DA      PIC XX.
  3122             20  FILLER          PIC X              VALUE '/'.
  3123             20  DTL-EFF-YR      PIC XX.
  3124         16  FILLER              PIC X              VALUE SPACE.
  3125         16  DTL-CARR            PIC X.
  3126         16  FILLER              PIC X             VALUE SPACE.
  3127         16  DTL-GRPG            PIC X(6).
  3128         16  FILLER              PIC X             VALUE SPACE.
  3129         16  DTL-STAT            PIC XX.
  3130         16  FILLER              PIC X             VALUE SPACE.
  3131         16  DTL-ACCT            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  66
* EL331.cbl
  3132         16  FILLER              PIC X             VALUE SPACE.
  3133         16  DTL-CL-NO           PIC X(7).
  3134         16  FILLER              PIC X             VALUE SPACE.
  3135         16  DTL-CL-TYPE         PIC XXXX.
  3136         16  FILLER              PIC X             VALUE SPACE.
  3137         16  DTL-CL-STATUS       PIC X(6).
  3138         16  FILLER              PIC X              VALUE SPACE.
  3139         16  DTL-CL-LN-KIND      PIC X(7).
  3140         16  FILLER              PIC X              VALUE SPACE.
  3141         16  DTL-CL-INCURRED     PIC X(8).
  3142         16  FILLER              PIC XXX            VALUE SPACE.
  3143         16  DTL-CL-PROCESSOR    PIC XXXX.
  3144         16  FILLER              PIC X(4)           VALUE SPACE.
  3145         16  DTL-EXC-MSG         PIC X(40).
  3146         16  FILLER              PIC XX             VALUE SPACE.
  3147
  3148     12  WS-EXC-MSG-CANCEL.
  3149         16  WS-EXC-MSG-DESC    PIC X(26)
  3150               VALUE ' XXXX COV CANCELLED AS OF '.
  3151         16  WS-EXC-MSG-CANCEL-DATE.
  3152             25  WS-EXC-C-MO    PIC XX.
  3153             25  FILLER         PIC X                VALUE '/'.
  3154             25  WS-EXC-C-DA    PIC XX.
  3155             25  FILLER         PIC X                VALUE '/'.
  3156             25  WS-EXC-C-YR    PIC XX.
  3157
  3158     12  WS-EXC-MSG-NO-NOTES.
  3159         16  WS-EXC-MSG-NO-DE    PIC X(21)
  3160               VALUE ' CERTIFICATE PENDING-'.
  3161         16  WS-EXC-MSG-NO-COPY  PIC X(15)
  3162               VALUE 'NOTES ATTACHED.'.
  3163
  3164     12  WS-EXC-MSG-CO-DELETE   PIC X(40)
  3165               VALUE ' COVERAGE DELETED - SEE CREDIT DEPT.    '.
  3166
  3167     12  WS-EXC-MSG-CE-DELETE.
  3168         16  WS-EXC-MSG-CE-DE    PIC X(21)
  3169               VALUE ' CERTIFICATE DELETED '.
  3170         16  WS-EXC-MSG-CE-COPY  PIC X(15)
  3171               VALUE SPACES.
  3172
  3173     12  WS-EXC-MSG-EE-EXPIRED.
  3174         16  WS-EXC-MSG-EE-DE    PIC X(21)
  3175               VALUE ' CERTIFICATE EXPIRED '.
  3176         16  WS-EXC-MSG-EE-COPY  PIC X(15)
  3177               VALUE SPACES.
  3178
  3179     12  WS-EXC-MSG-ADDED.
  3180         16  FILLER             PIC X(22) VALUE
  3181                     ' COVERAGE ADDED - AMT '.
  3182         16  WS-EXC-MSG-ADDED-AMT     PIC ZZZZZZ9.99.
  3183         16  FILLER             PIC X(6) VALUE ' TYPE-'.
  3184         16  WS-EXC-MSG-ADDED-TYPE    PIC XX.
  3185
  3186     12  WS-EXC-MSG-CHANGED-NEW.
  3187         16  FILLER            PIC X(22) VALUE
  3188                     ' COVERAGE CHANGED-NEW '.
  3189         16  WS-EXC-MSG-CHGD-AMT-NEW  PIC ZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  67
* EL331.cbl
  3190         16  FILLER            PIC X(6) VALUE ' TYPE-'.
  3191         16  WS-EXC-MSG-CHGD-TYPE-NEW PIC XX.
  3192
  3193     12  WS-EXC-MSG-CHANGED-OLD.
  3194         16  FILLER              PIC X(18) VALUE   SPACES.
  3195         16  FILLER              PIC X(04) VALUE
  3196                                       'OLD '.
  3197         16  WS-EXC-MSG-CHGD-AMT-OLD  PIC ZZZZZZ9.99.
  3198         16  FILLER                   PIC X(6) VALUE ' TYPE-'.
  3199         16  WS-EXC-MSG-CHGD-TYPE-OLD PIC XX.
  3200
  3201     12  WS-EXC-MSG-COPY.
  3202         16  FILLER              PIC X(20) VALUE
  3203                                       'CERT COPIED FROM ECS'.
  3204
  3205     12  FTG-1.
  3206         16  P-MATCHED-ONL       PIC ZZZ,ZZZ,ZZ9-.
  3207         16  FILLER              PIC X(35)
  3208                   VALUE  ' MATCHED / UPDATED (+)   '.
  3209
  3210     12  FTG-2.
  3211         16  P-LOADED-ECS        PIC ZZZ,ZZZ,ZZ9-.
  3212         16  FILLER              PIC X(35)
  3213                   VALUE  ' LOADED FROM OFFLINE (+) '.
  3214
  3215     12  FTG-3.
  3216         16  P-ONL-DELETED       PIC ZZZ,ZZZ,ZZ9-.
  3217         16  FILLER              PIC X(35)
  3218                   VALUE  ' ONLINE DELETED    (-)   '.
  3219         16  FILLER              PIC X(30)
  3220                   VALUE  ' CURRENT ELCERT RECORD COUNT--'.
  3221         16  P-ONL-EXIST         PIC ZZZ,ZZZ,ZZ9-.
  3222
  3223     12  FTG-4.
  3224         16  P-CLAIM-MATCH       PIC ZZZ,ZZZ,ZZ9-.
  3225         16  FILLER              PIC X(35)
  3226                   VALUE  ' HAVE ATTACHED CLAIMS    '.
  3227
  3228     12  FTG-5.
  3229         16  P-INACTIVE-CERTS    PIC ZZZ,ZZZ,ZZ9-.
  3230         16  FILLER              PIC X(35)
  3231                   VALUE  ' INACTIVE AND BYPASSED   '.
  3232
  3233     12  FTG-6.
  3234         16  P-ONL-READ          PIC ZZZ,ZZZ,ZZ9-.
  3235         16  FILLER              PIC X(35)
  3236                   VALUE  ' ONLINE CERTS READ       '.
  3237
  3238     12  FTG-7.
  3239         16  P-ECS-READ          PIC ZZZ,ZZZ,ZZ9-.
  3240         16  FILLER              PIC X(35)
  3241                   VALUE  ' OFFLINE CERTS READ      '.
  3242
  3243     12  FTG-8.
  3244         16  P-EXCP-ADD          PIC ZZZ,ZZZ,ZZ9-.
  3245         16  FILLER              PIC X(35)
  3246                   VALUE  ' COMP EXCEPTIONS ADDED'.
  3247
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  68
* EL331.cbl
  3248     12  FTG-9.
  3249         16  P-EXCP-DEL          PIC ZZZ,ZZZ,ZZ9-.
  3250         16  FILLER              PIC X(35)
  3251                   VALUE  ' COMP EXCEPTIONS DELETED'.
  3252
  3253     12  FTG-10.
  3254         16  P-EXCP-TBL          PIC ZZZ,ZZZ,ZZ9-.
  3255         16  FILLER              PIC X(35)
  3256                   VALUE  ' ACCTS WITH COMM TABLES '.
  3257
  3258     12  FTG-11.
  3259         16  P-MAIL-DEL          PIC ZZZ,ZZZ,ZZ9-.
  3260         16  FILLER              PIC X(35)
  3261                   VALUE  ' INSURED ADDRESS MAIL RECS DELETED '.
  3262
  3263     12  FTG-12.
  3264         16  P-ACCT-READS        PIC ZZZ,ZZZ,ZZ9-.
  3265         16  FILLER              PIC X(35)
  3266                   VALUE  ' ACCOUNT MASTER MATCH ATTEMPTS '.
  3267
  3268     12  FTG-13.
  3269         16  P-ACT-READ          PIC ZZZ,ZZZ,ZZ9-.
  3270         16  FILLER              PIC X(35)
  3271                   VALUE  ' ERACCT RECORDS READ '.
  3272
  3273     12  FTG-14.
  3274         16  P-ACCT-MATCH        PIC ZZZ,ZZZ,ZZ9-.
  3275         16  FILLER              PIC X(35)
  3276                   VALUE  ' CERTS MATCHED TO ACCOUNT MASTER '.
  3277
  3278
* 3279                                 COPY ELCDTECX.
  3280******************************************************************06/05/98
  3281*                                                                *ELCDTECX
  3282*                            ELCDTECX.                           *   LV005
  3283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3284*                            VMOD=2.015                          *ELCDTECX
  3285*                                                                *ELCDTECX
  3286*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  3287*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  3288*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  3289*                                                                *ELCDTECX
  3290******************************************************************ELCDTECX
  3291******************************************************************
  3292*                   C H A N G E   L O G
  3293*
  3294* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3295*-----------------------------------------------------------------
  3296*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3297* EFFECTIVE    NUMBER
  3298*-----------------------------------------------------------------
  3299* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  3300*                                  BENEFIT CODES FROM 300 TO 900
  3301* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  3302* 051304    2003080800002  SMVA  ADD REFUND METHOD
  3303******************************************************************
  3304 01  DATE-CARD.                                                   ELCDTECX
  3305     12  DATX-COD                    PIC  X(4).                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  69
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3306     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  3307     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  3308     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  3309     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  3310     12  EP-SW                       PIC  X.                      ELCDTECX
  3311         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  3312     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  3313         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  3314     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  3315     12  RUN-CENTURY.                                             ELCDTECX
  3316         16 RUN-CENTURY-N            PIC  99.                        CL**4
  3317     12  FILLER                      PIC  X.                         CL**4
  3318     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  3319     12  FILLER                      PIC  XXX.                    ELCDTECX
  3320     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  3321                                                                  ELCDTECX
  3322 01  FILLER                          PIC  X(7)                       CL**6
  3323                                          VALUE 'OPTIONS'.        ELCDTECX
  3324 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  3325     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  3326     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  3327     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  3328         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  3329         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  3330     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  3331     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  3332     12  FILLER                      PIC  X.                      ELCDTECX
  3333     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  3334     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  3335     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  3336     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  3337     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  3338     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  3339     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  3340     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  3341     12  FILLER                      PIC  X.                      ELCDTECX
  3342     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  3343     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  3344     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  3345     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  3346     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  3347     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  3348     12  FILLER                      PIC  X.                      ELCDTECX
  3349     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  3350     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  3351     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  3352     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  3353     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  3354     12  DTE-R78                     PIC  X.                      ELCDTECX
  3355     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  3356     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  3357     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  3358     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  3359     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  3360     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  3361     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  3362                                     PIC  X.                      ELCDTECX
  3363         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  70
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3364                                                 ' '.             ELCDTECX
  3365         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  3366         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  3367     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  3368         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  3369         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  3370     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  3371     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  3372                                     PIC  9.                         CL**4
  3373     12  DTE-SYSTEM.                                              ELCDTECX
  3374         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  3375         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  3376         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  3377         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  3378         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  3379         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  3380         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  3381         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  3382         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  3383         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  3384         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  3385         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  3386         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  3387         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  3388         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  3389         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  3390         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  3391         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  3392         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  3393         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  3394         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  3395         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  3396         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  3397         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  3398         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  3399         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  3400     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  3401         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  3402                                     PIC  X.                      ELCDTECX
  3403     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  3404                                                                  ELCDTECX
  3405 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  3406     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  3407     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  3408     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  3409*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  3410     12  FILLER                      PIC  X.                      ELCDTECX
  3411     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  3412     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  3413     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  3414     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  3415     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  3416     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  3417     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  3418                                                                  ELCDTECX
  3419     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  3420     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  3421     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  71
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3422     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  3423                                                                  ELCDTECX
  3424     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  3425     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  3426     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  3427     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  3428                                                                  ELCDTECX
  3429     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  3430     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  3431                                                                  ELCDTECX
  3432     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  3433     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  3434                                                                  ELCDTECX
  3435     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  3436                                                                  ELCDTECX
  3437 01  DATE-CARD-FACTORS.                                           ELCDTECX
  3438     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  3439     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  3440     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  3441     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  3442     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  3443     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  3444     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  3445                                                                  ELCDTECX
  3446 01  FILLER                          PIC  X(12)                   ELCDTECX
  3447                                          VALUE 'COMPANY NAME'.   ELCDTECX
  3448 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  3449     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  3450         16  CNT-ID                  PIC  X.                      ELCDTECX
  3451         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  3452                                                                  ELCDTECX
  3453 01  FILLER                          PIC  X(11)                   ELCDTECX
  3454                                          VALUE 'STATE NAMES'.    ELCDTECX
  3455 01  STATE-NAMES.                                                 ELCDTECX
  3456     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  3457         16  STATE-SUB               PIC  XX.                     ELCDTECX
  3458         16  STATE-PIC1.                                          ELCDTECX
  3459             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  3460             20  FILLER              PIC  XXX.                    ELCDTECX
  3461             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  3462             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  3463             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  3464             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  3465                                                                  ELCDTECX
  3466 01  FILLER                          PIC  X(13)                   ELCDTECX
  3467                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  3468 01  CARRIER-NAMES.                                               ELCDTECX
  3469     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  3470         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  3471         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  3472         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  3473         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3474         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3475         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3476*        16  FILLER                  PIC  X.                      ELCDTECX
  3477         16  CARRIER-SEC-PAY         PIC  X.
  3478             88  SEC-PAY-CARRIER          VALUE 'Y'.
  3479                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  72
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3480 01  FILLER                          PIC  X(9)                       CL**6
  3481                                          VALUE 'INS TYPES'.      ELCDTECX
  3482 01  CLAS-INS-TYPES.                                              ELCDTECX
  3483*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  3484     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  3485         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  3486         16  CLAS-I-AB3.                                          ELCDTECX
  3487             20  FILLER              PIC  X.                      ELCDTECX
  3488             20  CLAS-I-AB2.                                      ELCDTECX
  3489                 24  FILLER          PIC  X.                      ELCDTECX
  3490                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  3491         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  3492             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  3493             20  FILLER              PIC  X.                         CL**4
  3494         16  CLAS-I-AB10.                                         ELCDTECX
  3495             20  FILLER              PIC  X(9).                   ELCDTECX
  3496             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  3497         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  3498         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  3499         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  3500         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  3501             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  3502         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  3503         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  3504         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  3505         16  CLAS-I-BEN-CATEGORY     PIC  X.
  3506         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  3507         16  FILLER                  PIC  X(05).
  3508                                                                  ELCDTECX
  3509 01  FILLER                          PIC  X(16)                   ELCDTECX
  3510                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  3511 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  3512     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  3513                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  3514         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  3515         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  3516         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  3517         16  CLAS-MORT-DESC.                                      ELCDTECX
  3518             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  3519             20  FILLER              PIC  XX.                        CL**5
  3520             20  CLAS-YEAR           PIC  X(4).                      CL**6
  3521             20  FILLER              PIC  X.                         CL**5
  3522             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  3523             20  FILLER              PIC  X.                         CL**5
  3524             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  3525             20  FILLER              PIC  X.                         CL**5
  3526             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  3527             20  FILLER              PIC  X(5).                      CL**6
  3528                                                                  ELCDTECX
  3529 01  FILLER                          PIC  X(15)                   ELCDTECX
  3530                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  3531 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  3532     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  3533         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  3534         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  3535         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  3536         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  3537         16  FILLER                  PIC  X(4).                      CL**6
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  73
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3538                                                                  ELCDTECX
  3539 01  FILLER                          PIC  X(7)                       CL**6
  3540                                     VALUE 'INDEXES'.             ELCDTECX
  3541 01  CLAS-INDEX-TBL.                                              ELCDTECX
  3542     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  3543     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  3544     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  3545     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  3546     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  3547     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  3548     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  3549     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  3550     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  3551     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  3552     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  3553     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  3554     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  3555     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  3556     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  3557     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  3558     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  3559                                                                  ELCDTECX
  3560 01  CLAS-TYPE-MISC.                                              ELCDTECX
  3561     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  3562     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  3563     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  3564     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  3565     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  3566     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  3567     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  3568     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  3569     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  3570     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  3571     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  3572                                                                  ELCDTECX
  3573 01  FILLER                          PIC  X(13)                   ELCDTECX
  3574                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  3575 01  CLAS-MISC.                                                   ELCDTECX
  3576     12  DTE-FICH                    PIC  X.                      ELCDTECX
  3577         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  3578         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  3579         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  3580     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  3581     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  3582     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  3583     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  3584     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  3585     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  3586     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  3587     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  3588     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  3589     12  STATE-L                     PIC  XX.                     ELCDTECX
  3590     12  CLAS-CN                     PIC  99.                     ELCDTECX
  3591     12  CLAS-CO                     PIC  99.                     ELCDTECX
  3592     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  3593         16  DTE-F-1                 PIC  X.                      ELCDTECX
  3594         16  DTE-F-2                 PIC  X.                      ELCDTECX
  3595     12  DTE-ABEND-WORK.                                          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  74
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3596         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  3597         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  3598                                                                  ELCDTECX
  3599 01  FILLER                          PIC  X(12)                   ELCDTECX
  3600                                     VALUE 'WORKING DATE'.        ELCDTECX
  3601 01  WS-DATE-AND-TIME.                                            ELCDTECX
  3602     12  WS-ACCEPT-DATE.                                          ELCDTECX
  3603         16  WS-AD-YY                PIC  99.                     ELCDTECX
  3604         16  WS-AD-MM                PIC  99.                     ELCDTECX
  3605         16  WS-AD-DD                PIC  99.                     ELCDTECX
  3606     12  WS-CURRENT-DATE.                                         ELCDTECX
  3607         16  WS-CD-MM                PIC  99.                     ELCDTECX
  3608         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3609         16  WS-CD-DD                PIC  99.                     ELCDTECX
  3610         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3611         16  WS-CD-YY                PIC  99.                     ELCDTECX
  3612     12  WS-TIME-OF-DAY.                                          ELCDTECX
  3613         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  3614         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  3615                                                                  ELCDTECX
  3616 01  FILLER                          PIC  X(12)                   ELCDTECX
  3617                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  3618 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  3619     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  3620         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  3621         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  3622         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  3623                                                                  ELCDTECX
  3624 01  FILLER                          PIC  X(10)                   ELCDTECX
  3625                                     VALUE 'STATE TLRS'.          ELCDTECX
  3626 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  3627     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  3628         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  3629         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  3630                                                                  ELCDTECX
  3631 01  FILLER                          PIC  X(13)                   ELCDTECX
  3632                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  3633 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  3634     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  3635         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  3636                                                                  ELCDTECX
  3637 01  FILLER                          PIC  X(13)                   ELCDTECX
  3638                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  3639 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  3640     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  3641     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  3642     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  3643                                     PIC  X.                         CL**5
  3644     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  3645     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  3646     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  3647     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  3648     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  3649     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  3650     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  3651     12  FILLER                      PIC  X(75).                  ELCDTECX
  3652******************************************************************ELCDTECX
  3653*01  MISC-CARR-PCT-DATA.                                          00001521
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  75
* EL331.cbl
  3654*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3655*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3656*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3657*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3658*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3659*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3660******************************************************************ELCDTECX
  3661
* 3662                                 COPY ELCDTEVR.
  3663***************************************************************** 04/15/98
  3664*                                                                *ELCDTEVR
  3665*                                                                *ELCDTEVR
  3666*                            ELCDTEVR.                           *   LV003
  3667*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3668*                            VMOD=2.001                          *   CL**2
  3669*                                                                *ELCDTEVR
  3670*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  3671*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  3672*                                                                *ELCDTEVR
  3673******************************************************************ELCDTEVR
  3674 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  3675     05  WS-RUN-DATE.                                             ELCDTEVR
  3676         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3677         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  3678         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  3679             15  RUN-CC              PIC  99.                     ELCDTEVR
  3680             15  RUN-YR              PIC  99.                     ELCDTEVR
  3681         10  RUN-MO                  PIC  99.                     ELCDTEVR
  3682         10  RUN-DA                  PIC  99.                     ELCDTEVR
  3683     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  3684            WS-RUN-DATE              PIC 9(11).                      CL**2
  3685     05  WS-EP-DT.                                                ELCDTEVR
  3686         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3687         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  3688         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  3689             15  EP-CC               PIC  99.                     ELCDTEVR
  3690             15  EP-YR               PIC  99.                     ELCDTEVR
  3691         10  EP-MO                   PIC  99.                     ELCDTEVR
  3692         10  EP-DA                   PIC  99.                     ELCDTEVR
  3693     05  WS-EP-DT-N REDEFINES                                        CL**2
  3694            WS-EP-DT                 PIC 9(11).                      CL**2
  3695     05  WS-DTE-CONV-DT.                                             CL**4
  3696         10  FILLER                  PIC  9(03).                     CL**4
  3697         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  3698         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  3699             15  DTE-CONV-CC         PIC  99.                        CL**4
  3700             15  DTE-CONV-YR         PIC  99.                        CL**4
  3701         10  DTE-CONV-MO             PIC  99.                        CL**4
  3702         10  DTE-CONV-DA             PIC  99.                        CL**4
  3703     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  3704            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  3705 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  3706     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  3707         10  FILLER                            PIC 999.           ELCDTEVR
  3708         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  3709         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  3710             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  3711             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  76
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3712         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  3713         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  3714     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  3715            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  3716     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  3717         10  FILLER                            PIC 999.           ELCDTEVR
  3718         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  3719         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  3720         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  3721         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  3722     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  3723            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  3724 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  3725     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  3726         10  FILLER                            PIC 999.           ELCDTEVR
  3727         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  3728         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  3729             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  3730             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  3731         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  3732         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  3733     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  3734            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  3735     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  3736         10  FILLER                            PIC 999.           ELCDTEVR
  3737         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  3738         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  3739             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  3740             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  3741         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  3742         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  3743     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  3744            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  3745     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  3746         10  FILLER                            PIC 999.           ELCDTEVR
  3747         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  3748         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  3749             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  3750             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  3751         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  3752         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  3753     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  3754            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  3755 01  WS-RATE-RECORD.                                              ELCDTEVR
  3756         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  3757             10  FILLER                        PIC 999.           ELCDTEVR
  3758             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  3759             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  3760                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  3761                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  3762             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  3763             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  3764         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  3765                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  3766
* 3767                                 COPY ELCCRTVR.
  3768***************************************************************** 04/24/98
  3769*                                                                *ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  77
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3770*                                                                *ELCCRTVR
  3771*                            ELCCRTVR                            *   LV003
  3772*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3773*                            VMOD=2.001                          *ELCCRTVR
  3774*                                                                *ELCCRTVR
  3775*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  3776*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  3777*                                                                *ELCCRTVR
  3778******************************************************************ELCCRTVR
  3779                                                                  ELCCRTVR
  3780 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  3781     05  WS-CR-DT.                                                ELCCRTVR
  3782         10  FILLER                PIC 999.                       ELCCRTVR
  3783         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  3784         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  3785             15  CR-CC             PIC 99.                        ELCCRTVR
  3786             15  CR-YR             PIC 99.                        ELCCRTVR
  3787         10  CR-MO                 PIC 99.                        ELCCRTVR
  3788         10  CR-DA                 PIC 99.                        ELCCRTVR
  3789     05  WS-CR-DT-N REDEFINES                                        CL**2
  3790            WS-CR-DT               PIC 9(11).                        CL**2
  3791     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  3792         10  FILLER                    PIC 999.                   ELCCRTVR
  3793         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3794         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  3795             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3796             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3797         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3798         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3799     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  3800            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  3801     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  3802         10  FILLER                    PIC 999.                   ELCCRTVR
  3803         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3804         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  3805             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3806             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3807         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3808         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3809     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  3810            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  3811     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  3812         10  FILLER                    PIC 999.                   ELCCRTVR
  3813         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  3814         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  3815             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  3816             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  3817         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  3818         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  3819     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  3820            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  3821     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  3822         10  FILLER                    PIC 999.                   ELCCRTVR
  3823         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3824         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  3825             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  3826             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  3827         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  78
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3828         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  3829     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  3830            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  3831     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  3832         10  FILLER                    PIC 999.                   ELCCRTVR
  3833         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3834         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  3835             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  3836             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  3837         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  3838         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  3839     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3840            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3841     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  3842         10  FILLER                    PIC 999.                   ELCCRTVR
  3843         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3844         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  3845             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  3846             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  3847         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  3848         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  3849     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  3850            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  3851     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  3852         10  FILLER                    PIC 999.                   ELCCRTVR
  3853         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3854         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  3855             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  3856             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  3857         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  3858         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  3859     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  3860            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  3861     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  3862         10  FILLER                    PIC 999.                   ELCCRTVR
  3863         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3864         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  3865             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  3866             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  3867         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  3868         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  3869     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3870            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3871     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  3872         10  FILLER                    PIC 999.                   ELCCRTVR
  3873         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3874         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  3875             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  3876             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  3877         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  3878         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  3879     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  3880          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  3881     05  WS-CR-DTH-DT.                                            ELCCRTVR
  3882         10  FILLER                    PIC 999.                   ELCCRTVR
  3883         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  3884         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  3885             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  79
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3886             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  3887         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  3888         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  3889     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  3890            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  3891     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  3892         10  FILLER                    PIC 999.                   ELCCRTVR
  3893         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3894         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  3895             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  3896             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  3897         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  3898         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  3899     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  3900            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  3901     05  WS-CR-DIS-DT.                                            ELCCRTVR
  3902         10  FILLER                    PIC 999.                   ELCCRTVR
  3903         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  3904         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  3905             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  3906             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  3907         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  3908         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  3909     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  3910            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  3911     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  3912         10  FILLER                    PIC 999.                   ELCCRTVR
  3913         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3914         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  3915             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  3916             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  3917         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  3918         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  3919     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  3920            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  3921     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  3922         10  FILLER                    PIC 999.                   ELCCRTVR
  3923         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  3924         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  3925             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  3926             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  3927         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  3928         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  3929     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  3930            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  3931     05  COPY-NDX                      PIC 9.                        CL**6
  3932     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  3933         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  3934             15  FILLER                PIC 999.                   ELCCRTVR
  3935             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  3936             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  3937                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  3938                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  3939             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  3940             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  3941         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  3942                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  3943
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  80
* EL331.cbl
  3945 PROCEDURE DIVISION.
  3946
  3947 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  3948******************************************************************04/15/98
  3949*                                                                *ELCDTERX
  3950*                                                                *ELCDTERX
  3951*                            ELCDTERX.                           *   LV002
  3952*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3953*                            VMOD=2.007                          *ELCDTERX
  3954*                                                                *ELCDTERX
  3955*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  3956*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  3957*      = ELCDTEFD)                                               *ELCDTERX
  3958*                                                                *ELCDTERX
  3959******************************************************************ELCDTERX
  3960                                                                  ELCDTERX
  3961     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  3962                                                                  ELCDTERX
  3963     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  3964     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  3965     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  3966                                                                  ELCDTERX
  3967     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  3968                                                                  ELCDTERX
  3969******************************************************************ELCDTERX
  3970*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  3971*          WARNING MESSAGES.                                      ELCDTERX
  3972******************************************************************ELCDTERX
  3973     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  3974         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  3975                                                                  ELCDTERX
  3976     OPEN INPUT DISK-DATE.                                        ELCDTERX
  3977                                                                  ELCDTERX
  3978     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  3979                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  3980                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  3981                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  3982                   CLAX-ID           CLAS-MISC                    ELCDTERX
  3983                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  3984                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  3985                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  3986                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  3987                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  3988                                                                  ELCDTERX
  3989     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  3990                                                                  ELCDTERX
  3991     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  3992                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  3993                                                                  ELCDTERX
  3994     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  3995     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  3996     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  3997     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  3998                                                                  ELCDTERX
  3999     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  4000         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  4001     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  81
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4002         ADD +1                 TO CLAS-CN.                       ELCDTERX
  4003                                                                  ELCDTERX
  4004     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  4005         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  4006     ELSE                                                         ELCDTERX
  4007         ADD +1                 TO CLAS-CO.                       ELCDTERX
  4008                                                                  ELCDTERX
  4009 0005-READ--CARD.                                                 ELCDTERX
  4010     READ DISK-DATE                                               ELCDTERX
  4011         AT END CLOSE DISK-DATE                                   ELCDTERX
  4012             GO TO 0060-READ--TEST.                               ELCDTERX
  4013                                                                  ELCDTERX
  4014     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  4015                                                                  ELCDTERX
  4016     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  4017         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  4018         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  4019         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  4020         GO TO 0005-READ--CARD.                                   ELCDTERX
  4021                                                                  ELCDTERX
  4022     IF DD-ID = 'CLAD'                                            ELCDTERX
  4023         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  4024         GO TO 0005-READ--CARD.                                   ELCDTERX
  4025                                                                  ELCDTERX
  4026     IF DD-ID = 'CLAX'                                            ELCDTERX
  4027         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  4028         GO TO 0005-READ--CARD.                                   ELCDTERX
  4029                                                                  ELCDTERX
  4030     IF DD-ID = 'CLAF'                                            ELCDTERX
  4031         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  4032         GO TO 0005-READ--CARD.                                   ELCDTERX
  4033                                                                  ELCDTERX
  4034     IF DD-ID = 'CLAC'                                            ELCDTERX
  4035         GO TO 0010-READ--CLAC.                                   ELCDTERX
  4036                                                                  ELCDTERX
  4037     IF DD-ID = 'CARR'                                            ELCDTERX
  4038         GO TO 0015-READ--CARR.                                   ELCDTERX
  4039                                                                  ELCDTERX
  4040     IF DD-ID = 'STAT'                                            ELCDTERX
  4041         GO TO 0020-READ--STAT.                                   ELCDTERX
  4042                                                                  ELCDTERX
  4043     IF DD-ID = 'BUSC'                                            ELCDTERX
  4044         GO TO 0025-READ--BUSC.                                   ELCDTERX
  4045                                                                  ELCDTERX
  4046     IF DD-ID = 'MORT'                                            ELCDTERX
  4047         GO TO 0030-READ--MORT.                                   ELCDTERX
  4048                                                                  ELCDTERX
  4049     IF DD-ID = 'CLAI'                                            ELCDTERX
  4050         GO TO 0040-READ--CLAI.                                   ELCDTERX
  4051                                                                  ELCDTERX
  4052     IF DD-ID = 'COLC'                                            ELCDTERX
  4053         GO TO 0065-READ--COLC.                                   ELCDTERX
  4054                                                                  ELCDTERX
  4055     IF DD-IDX NUMERIC AND                                        ELCDTERX
  4056        DD-IDA = 'CL'                                             ELCDTERX
  4057         GO TO 0035-READ--CLXX.                                   ELCDTERX
  4058                                                                  ELCDTERX
  4059     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  82
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4060        DD-IDA = 'PO'                                             ELCDTERX
  4061         GO TO 0050-READ--POXX.                                   ELCDTERX
  4062                                                                  ELCDTERX
  4063     IF DD-ID = 'OPCA'                                            ELCDTERX
  4064         GO TO 0070-READ--OPCA.                                   ELCDTERX
  4065                                                                  ELCDTERX
  4066     IF DD-ID = 'OPST'                                            ELCDTERX
  4067         GO TO 0072-READ--OPST.                                   ELCDTERX
  4068                                                                  ELCDTERX
  4069     IF DD-ID = 'OPBS'                                            ELCDTERX
  4070         GO TO 0074-READ--OPBS.                                   ELCDTERX
  4071                                                                  ELCDTERX
  4072     IF DD-ID = 'OPMS'                                            ELCDTERX
  4073         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  4074                                                                  ELCDTERX
  4075     GO TO 0005-READ--CARD.                                       ELCDTERX
  4076                                                                  ELCDTERX
  4077 0010-READ--CLAC.                                                 ELCDTERX
  4078     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4079     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4080     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4081     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4082     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4083     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4084     GO TO 0005-READ--CARD.                                       ELCDTERX
  4085                                                                  ELCDTERX
  4086 0015-READ--CARR.                                                 ELCDTERX
  4087     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4088     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4089        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  4090        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4091        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  4092        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4093        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4094        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4095        MOVE DD-CARR1-SECPAY-SW
  4096                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4097     END-IF
  4098                                                                  ELCDTERX
  4099     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4100     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4101        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  4102        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4103        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  4104        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4105        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4106        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4107        MOVE DD-CARR2-SECPAY-SW
  4108                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4109     END-IF
  4110                                                                  ELCDTERX
  4111                                                                  ELCDTERX
  4112     GO TO 0005-READ--CARD.                                       ELCDTERX
  4113                                                                  ELCDTERX
  4114 0020-READ--STAT.                                                 ELCDTERX
  4115     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4116     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4117        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  83
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4118         GO TO 0005-READ--CARD.                                   ELCDTERX
  4119                                                                  ELCDTERX
  4120     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  4121     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  4122     GO TO 0020-READ--STAT.                                       ELCDTERX
  4123                                                                  ELCDTERX
  4124 0025-READ--BUSC.                                                 ELCDTERX
  4125     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4126     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4127        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  4128         GO TO 0005-READ--CARD.                                   ELCDTERX
  4129                                                                  ELCDTERX
  4130     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  4131     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  4132     GO TO 0025-READ--BUSC.                                       ELCDTERX
  4133                                                                  ELCDTERX
  4134 0030-READ--MORT.                                                 ELCDTERX
  4135     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4136     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4137        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  4138         GO TO 0005-READ--CARD.                                   ELCDTERX
  4139                                                                  ELCDTERX
  4140     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  4141     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  4142     GO TO 0030-READ--MORT.                                       ELCDTERX
  4143                                                                  ELCDTERX
  4144 0035-READ--CLXX.                                                 ELCDTERX
  4145     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  4146          GO TO 0005-READ--CARD.                                  ELCDTERX
  4147                                                                  ELCDTERX
  4148     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  4149         DISPLAY '***********************************************'ELCDTERX
  4150         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  4151         DISPLAY '***********************************************'ELCDTERX
  4152         GO TO 0055-READ--STOP.                                   ELCDTERX
  4153                                                                  ELCDTERX
  4154     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  4155        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  4156         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  4157                                                                  ELCDTERX
  4158     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  4159        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  4160         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  4161                                                                  ELCDTERX
  4162*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  4163     GO TO 0005-READ--CARD.                                       ELCDTERX
  4164                                                                  ELCDTERX
  4165 0040-READ--CLAI.                                                 ELCDTERX
  4166     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4167     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4168        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  4169         GO TO 0005-READ--CARD.                                   ELCDTERX
  4170                                                                  ELCDTERX
  4171     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  4172     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  4173     GO TO 0040-READ--CLAI.                                       ELCDTERX
  4174                                                                  ELCDTERX
  4175 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  84
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4176     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  4177     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  4178                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  4179     PERFORM ABEND-PGM.                                           ELCDTERX
  4180                                                                  ELCDTERX
  4181 0050-READ--POXX.                                                 ELCDTERX
  4182     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  4183         GO TO 0005-READ--CARD.                                   ELCDTERX
  4184                                                                  ELCDTERX
  4185     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  4186         DISPLAY '***********************************************'ELCDTERX
  4187         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  4188         DISPLAY '***********************************************'ELCDTERX
  4189         GO TO 0055-READ--STOP.                                   ELCDTERX
  4190                                                                  ELCDTERX
  4191     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  4192     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  4193     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  4194     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  4195                                                                  ELCDTERX
  4196     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  4197         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  4198     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  4199         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  4200                                                                  ELCDTERX
  4201     GO TO 0005-READ--CARD.                                       ELCDTERX
  4202                                                                  ELCDTERX
  4203 0055-READ--STOP.                                                 ELCDTERX
  4204     GOBACK.                                                      ELCDTERX
  4205                                                                  ELCDTERX
  4206 0060-READ--TEST.                                                 ELCDTERX
  4207     IF DATX-COD        = SPACE  OR                               ELCDTERX
  4208        CLAX-ID         = SPACE  OR                               ELCDTERX
  4209        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  4210         GO TO 0045-READ--DUMP.                                   ELCDTERX
  4211                                                                  ELCDTERX
  4212     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  4213     GO TO 0079-READ--EXIT.                                       ELCDTERX
  4214                                                                  ELCDTERX
  4215 0065-READ--COLC.                                                 ELCDTERX
  4216     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  4217     GO TO 0005-READ--CARD.                                       ELCDTERX
  4218                                                                  ELCDTERX
  4219 0070-READ--OPCA.                                                 ELCDTERX
  4220                                                                  ELCDTERX
  4221     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4222                                                                  ELCDTERX
  4223     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  4224             OR                                                   ELCDTERX
  4225         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  4226         GO TO 0005-READ--CARD.                                   ELCDTERX
  4227                                                                  ELCDTERX
  4228     ADD 1                       TO INDEXCA.                      ELCDTERX
  4229     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  4230                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  4231     GO TO 0070-READ--OPCA.                                       ELCDTERX
  4232                                                                  ELCDTERX
  4233 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  85
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4234                                                                  ELCDTERX
  4235     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4236                                                                  ELCDTERX
  4237     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  4238             OR                                                   ELCDTERX
  4239         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4240         GO TO 0005-READ--CARD.                                   ELCDTERX
  4241                                                                  ELCDTERX
  4242     ADD 1                       TO INDEXST.                      ELCDTERX
  4243     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  4244                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  4245     GO TO 0072-READ--OPST.                                       ELCDTERX
  4246                                                                  ELCDTERX
  4247 0074-READ--OPBS.                                                 ELCDTERX
  4248                                                                  ELCDTERX
  4249     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4250                                                                  ELCDTERX
  4251     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  4252             OR                                                   ELCDTERX
  4253         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4254         GO TO 0005-READ--CARD.                                   ELCDTERX
  4255                                                                  ELCDTERX
  4256     ADD 1                       TO INDEXBS.                      ELCDTERX
  4257     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  4258     GO TO 0074-READ--OPBS.                                       ELCDTERX
  4259                                                                  ELCDTERX
  4260 0079-READ--EXIT.                                                 ELCDTERX
  4261*    EXIT.                                                        ELCDTERX
  4262******************************************************************ELCDTERX
  4263
  4264     MOVE BIN-RUN-DATE           TO  WS-EOM-DT.
  4265
  4266     MOVE WS-TIME                TO ME-START-TIME.
  4267     MOVE WS-CURRENT-DATE        TO ME-START-DATE.
  4268     MOVE ME-START-MO            TO ME-CNDS-MO.
  4269     MOVE ME-START-DA            TO ME-CNDS-DA.
  4270     MOVE ME-START-YR            TO ME-CNDS-YR.
  4271
  4272     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  4273
  4274     IF DTE-CLIENT = 'CID'
  4275         MOVE 'CILG331'          TO  WS-ME50-BAL-JOB
  4276     ELSE
  4277       IF DTE-CLIENT = 'AHL'
  4278         MOVE 'AHLG331'          TO  WS-ME50-BAL-JOB
  4279       ELSE
  4280         MOVE 'CIDCLG331'        TO  WS-ME50-BAL-JOB
  4281       END-IF
  4282     END-IF.
  4283
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  86
* EL331.cbl
  4285
  4286 0000-MAINLINE.
  4287
  4288     PERFORM 7000-INITIALIZE    THRU 7000-EXIT.
  4289
  4290     PERFORM 2000-PROCESS-CERT  THRU 2000-EXIT
  4291         UNTIL NO-MORE-RECORDS OR
  4292               IO-ERROR-OCCURRED.
  4293
  4294     PERFORM 8000-FINALIZE THRU 8000-EXIT.
  4295
  4296     IF DTE-CLIENT EQUAL 'JAL' OR 'JAI'
  4297        DISPLAY ' CERTS WITHOUT PREM ...' NO-PREM-CT
  4298        DISPLAY ' CERTS WITHOUT PLANS ..' NO-PLAN-CODE-CT.
  4299
  4300 0000-EXIT.
  4301
  4302****************************************************************
  4303*     OPEN I/O (ERMEBL)   MONTH END BALANCE FILE ACCESSED      *
  4304*     THRU ME-CONTROL-PRIMARY.  STATISTICS FOR EL331 UPDATED   *
  4305*     IN MONTH-END RECORD EACH TIME RUN.                       *
  4306****************************************************************
  4307
  4308     OPEN I-O ERMEBL.
  4309
  4310     IF ERMEBL-FILE-STATUS NOT = ZERO AND '97'
  4311         MOVE 'N'                TO ME-UPDATE-FLAG.
  4312
  4313     MOVE DTE-CLIENT             TO ME-COMPANY.
  4314     MOVE MONTH-END-MOYR         TO ME-MOYR.
  4315
  4316     IF ME-DO-UPDATE
  4317         READ ERMEBL INVALID KEY
  4318         MOVE 'N'                TO ME-UPDATE-FLAG
  4319         CLOSE ERMEBL.
  4320
  4321     IF ME-DO-UPDATE
  4322         MOVE ME-START-TIME      TO ME-331-START
  4323         MOVE ME-CNDS-DATE       TO ME-331-RUN-DT
  4324         ACCEPT WS-TIME-OF-DAY   FROM  TIME
  4325         MOVE WS-TIME            TO ME-331-END
  4326         ADD 1                   TO ME-331-RUN-CT
  4327         MOVE 1                  TO ME-331-FLAG
  4328         REWRITE MONTH-END-BALANCES
  4329         CLOSE ERMEBL.
  4330
  4331     GOBACK.
  4332
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  87
* EL331.cbl
  4334******************************************************************
  4335*  PROCESSING FLOW BASED UPON CERT CONTROL COMPARISON:           *
  4336*                                                                *
  4337* 1) ECS (BATCH CERT CONTROL) GREATER  ONL (ONLINE CERT CONTROL) *
  4338*    2300-PROCESS-N-READ-ONL                                     *
  4339*        2330-FIND-ASSOCIATED-CLAIM                              *
  4340*                                                                *
  4341*            -NO CLAIMS  7320-BLD-ONL-PRT-LINE                   *
  4342*                        7350-BLD-CLM-INFO                       *
  4343*                        7370-PRINT-DETAIL                       *
  4344*                        2280-DELETE-ERMAIL                      *
  4345*                        2270-DELETE-ERCOMM                      *
  4346*                        DELETE ONLINE CERT MASTER               *
  4347*                                                                *
  4348*            -CLAIMS     REWRITE ONLINE CERT MASTER              *
  4349*                        7320-BLD-ONL-PRT-LINE                   *
  4350*                        7350-BLD-CLM-INFO                       *
  4351*                        7370-PRINT-DETAIL                       *
  4352*                                                                *
  4353* 2) ECS (BATCH CERT CONTROL) EQUAL  ONL (ONLINE CERT CONTROL)   *
  4354*    2500-PROCESS-MATCHING                                       *
  4355*        2330-FIND-ASSOCIATED-CLAIM                              *
  4356*                                                                *
  4357*            -NO CLAIMS  2600-REWRITE-CERT                       *
  4358*                        REBUILDS ONLINE CERT FROM BATCH CERT    *
  4359*                                                                *
  4360*            -CLAIMS     2510-BUILD-PRINT (REFLECTS ACTIVITY)    *
  4361*                        2600-REWRITE-CERT                       *
  4362*                        REBUILDS ONLINE CERT FROM BATCH CERT    *
  4363*                                                                *
  4364* 3) ONL (ONLINE CERT CONTROL) GREATER  ECS (BATCH CERT CONTROL) *
  4365*    2800-ADD-NEW-CERT                                           *
  4366*        2830-MOVE-DATA                                          *
  4367*        2820-BUILD-NEW-KEY                                      *
  4368*        2200-MATCH-ACCT                                         *
  4369*        WRITE ONLINE CERT MASTER                                *
  4370******************************************************************
  4371
  4372 2000-PROCESS-CERT.
  4373
  4374     PERFORM 2100-READ-ECS-RECORDS   THRU 2100-EXIT.
  4375
  4376     IF WS-SAVED-ECS-KEY GREATER WS-SAVED-ONL-KEY
  4377         MOVE SPACES             TO WS-ONL-GE-SW
  4378         PERFORM 2300-PROCESS-N-READ-ONL THRU 2300-EXIT
  4379         UNTIL ONL-KEY-EQUAL-OR-GREATER.
  4380
  4381     IF NO-MORE-ECS-RECORDS  AND  NO-MORE-ONL-RECORDS
  4382          MOVE  'X'              TO WS-ALL-END-SW
  4383          GO TO 2000-EXIT.
  4384
  4385     IF WS-SAVED-ONL-KEY EQUAL WS-SAVED-ECS-KEY
  4386        PERFORM 2500-PROCESS-MATCHING  THRU 2500-EXIT.
  4387
  4388     if (ws-saved-onl-key > ws-saved-ecs-key)
  4389        and (not do-not-load)
  4390        ADD +1                   TO WS-LOADED-ECS
  4391        perform 2800-add-new-cert thru 2800-exit
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  88
* EL331.cbl
  4392     end-if
  4393
  4394     .
  4395 2000-EXIT.
  4396      EXIT.
  4397
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  89
* EL331.cbl
  4399*****************************************************************
  4400*  2100-READ-ECS-RECORDS                                        *
  4401*****************************************************************
  4402*  READ BATCH CERTIFICATE MASTER RECORD AND CALCULATE AN EXPIRY *
  4403*  DATE BASED UPON ISSUE DATE, COVERAGE TERM, CERTIFICATE TYPE, *
  4404*  AND ANY CLAIM ACTIVITY. THIS COMPUTED DATE IS COMPARED WITH  *
  4405*  THE RUN DATE PROVIDED THRU THE DATE CARD LOAD TO DETERMINE   *
  4406*  IF THE CERTIFICATE WILL BE LOADED BACK TO ONLINE. BENEFIT    *
  4407*  TYPES OF UNEXPIRED CERTS ARE VALIDATED AGAINST THE BENEFIT   *
  4408*  TABLE.                                                       *
  4409*  EXPIRY DATE EQUAL :                                          *
  4410*      1) CLAIMS PAID (EFFECTIVE DATE + LONGEST TERM + 36)      *
  4411*      2) NO CLAIMS   (EFFECTIVE DATE + LONGEST TERM + 12)      *
  4412*      3) O.B. CERTS  (EFFECTIVE DATE + LONGEST TERM + 36)      *
  4413*****************************************************************
  4414
  4415 2100-READ-ECS-RECORDS.
  4416
  4417     IF NO-MORE-ECS-RECORDS
  4418         GO TO 2100-EXIT.
  4419
  4420     READ ECSCRT01  AT END
  4421         MOVE 'X'                TO WS-ECS-END-SW
  4422         MOVE HIGH-VALUES        TO WS-SAVED-ECS-KEY
  4423         GO TO 2100-EXIT.
  4424
  4425     ADD  1                      TO WS-ECS-READ.
  4426     move spaces                 to ws-cert-load-sw
  4427
  4428     IF  CR-LF-CANCEL-EXIT-DATE  NOT NUMERIC
  4429          MOVE ZEROS             TO CR-LF-CANCEL-EXIT-DATE.
  4430
  4431     IF  CR-AH-CANCEL-EXIT-DATE  NOT NUMERIC
  4432          MOVE ZEROS             TO CR-AH-CANCEL-EXIT-DATE.
  4433
  4434     IF  CR-LF-CLAIM-EXIT-DATE  NOT NUMERIC
  4435          MOVE ZEROS             TO CR-LF-CLAIM-EXIT-DATE.
  4436
  4437     IF  CR-AH-SETTLEMENT-EXIT-DATE  NOT NUMERIC
  4438          MOVE ZEROS             TO CR-AH-SETTLEMENT-EXIT-DATE.
  4439
* 4440     COPY ELCCRTM1.
  4441******************************************************************04/15/98
  4442*                                                                *ELCCRTM1
  4443*                                                                *ELCCRTM1
  4444*                            ELCCRTM1                            *   LV003
  4445*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4446*                            VMOD=2.001                          *ELCCRTM1
  4447*                                                                *ELCCRTM1
  4448*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4449*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4450*                                                                *ELCCRTM1
  4451******************************************************************ELCCRTM1
  4452     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4453     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4454     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4455     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4456     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  90
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  4457     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4458     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4459     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4460     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4461                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4462     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  4463                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4464     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4465     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4466     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4467     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4468     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4469     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4470           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4471                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4472     END-PERFORM.                                                 ELCCRTM1
  4473                                                                  ELCCRTM1
  4474
  4475     IF DTE-CLIENT EQUAL 'HAN'
  4476        IF CR-GROUPING NOT EQUAL '010184'
  4477           MOVE CR-LNAME            TO WS-EFF-ACT-NAME
  4478           MOVE CR-ACCOUNT          TO WS-HAN-ACCOUNT
  4479           IF WS-NAME-EFF-DT NUMERIC
  4480              MOVE WS-HAN-ACCT-4-10 TO WS-NAME-ACCT
  4481*             MOVE CR-ACCOUNT       TO WS-NAME-ACCT
  4482              MOVE SPACES           TO WS-NAME-FILL
  4483              MOVE WS-EFF-ACT-NAME  TO CR-LNAME.
  4484
  4485     IF DTE-CLIENT EQUAL 'HAN'
  4486        IF CR-GROUPING EQUAL '010184'
  4487           MOVE CR-LNAME            TO WS-HI-LAST-NAME
  4488           MOVE CR-CERT-PRIME       TO WS-HI-CERT-4-10
  4489           MOVE WS-HI-LAST-NAME     TO CR-LNAME.
  4490
  4491     IF CR-LF-TERM NOT EQUAL ZERO
  4492         MOVE CR-LF-TERM         TO WS-WORK-TERM.
  4493
  4494     IF (CR-AH-TERM NOT EQUAL ZERO) AND
  4495        ((CR-AH-TERM GREATER CR-LF-TERM) OR
  4496         (WS-WORK-TERM EQUAL ZERO))
  4497           MOVE CR-AH-TERM       TO WS-WORK-TERM.
  4498
  4499     IF (CR-DTH-DT NOT EQUAL ZERO)
  4500        or (CR-DIS-DT NOT EQUAL ZERO)
  4501            COMPUTE WS-EXPIRE-MOS EQUAL
  4502                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 36
  4503       ELSE
  4504            COMPUTE WS-EXPIRE-MOS EQUAL
  4505                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 12.
  4506
  4507     IF WS-WORK-TERM EQUAL +1
  4508            COMPUTE WS-EXPIRE-MOS EQUAL
  4509                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 36.
  4510
  4511     IF DTE-CLIENT = 'LAP'  OR  'RMC'
  4512            COMPUTE WS-EXPIRE-MOS EQUAL
  4513                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 36.
  4514
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  91
* EL331.cbl
  4515     IF DTE-CLIENT = 'CID'
  4516        IF (CR-ENTRY-BATCH (1:2) = 'BL' OR 'VA')
  4517           OR (CR-LF-EXIT-BATCH (1:2) = 'BL' OR 'VA')
  4518           OR (CR-AH-EXIT-BATCH (1:2) = 'BL' OR 'VA')
  4519           COMPUTE WS-EXPIRE-MOS =
  4520              (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 300
  4521        END-IF
  4522     END-IF
  4523
  4524     IF DTE-CLIENT = 'AHL'
  4525        COMPUTE WS-EXPIRE-MOS =
  4526           (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 300
  4527     END-IF
  4528
  4529     IF WS-EXPIRE-MOS < WS-CURRENT-MOS
  4530        IF (CR-ENTRY-CCYY = RUN-CCYY)
  4531           and (CR-ENTRY-MO = RUN-MO)
  4532           continue
  4533        ELSE
  4534           set do-not-load        to true
  4535        end-if
  4536     end-if
  4537
  4538     IF WS-EXPIRE-MOS LESS WS-CURRENT-MOS
  4539       IF DTE-CLIENT NOT = 'LGX' and 'CID' and 'DCC'
  4540           IF CR-ENTRY-CCYY = RUN-CCYY AND
  4541              CR-ENTRY-MO = RUN-MO
  4542               NEXT SENTENCE
  4543           ELSE
  4544               ADD 1 TO WS-INACTIVE-CERTS
  4545               GO TO 2100-READ-ECS-RECORDS.
  4546
  4547     PERFORM 2120-SAVE-ECS-KEY  THRU 2120-EXIT.
  4548
  4549     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  4550     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  4551
  4552 2100-LF-TYPE.
  4553
  4554     IF CR-LFTYP EQUAL ZERO
  4555         GO TO 2100-AH-TYPE.
  4556
  4557     IF CLAS-INDEXL GREATER CLAS-MAXL
  4558         DISPLAY LIFE-OVERRIDE-L6
  4559                 ' BENEFIT TYPE NOT FOUND IN TABLE EQUAL ',
  4560                 CR-LFTYP
  4561         MOVE 'BENEFIT TYPE NOT FOUND (SEE DISPLAY)'
  4562                                 TO WS-ABEND-MESSAGE
  4563         GO TO ABEND-PGM.
  4564
  4565     IF CR-LFTYP EQUAL CLAS-I-BEN (CLAS-INDEXL)
  4566         GO TO 2100-AH-TYPE.
  4567
  4568     ADD +1                      TO CLAS-INDEXL.
  4569     GO TO 2100-LF-TYPE.
  4570
  4571 2100-AH-TYPE.
  4572
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  92
* EL331.cbl
  4573     IF CR-AHTYP EQUAL ZERO
  4574        GO TO 2100-EXIT.
  4575
  4576     IF CLAS-INDEXA GREATER CLAS-MAXA
  4577         DISPLAY AH-OVERRIDE-L6
  4578                 ' BENEFIT TYPE NOT FOUND IN TABLE EQUAL ',
  4579                 CR-AHTYP
  4580         MOVE 'BENEFIT TYPE NOT FOUND (SEE DISPLAY)'
  4581                                 TO WS-ABEND-MESSAGE
  4582         GO TO ABEND-PGM.
  4583
  4584     IF CR-AHTYP EQUAL CLAS-I-BEN (CLAS-INDEXA)
  4585            GO TO 2100-EXIT.
  4586
  4587     ADD +1                      TO CLAS-INDEXA.
  4588     GO TO 2100-AH-TYPE.
  4589
  4590 2100-EXIT.
  4591      EXIT.
  4592
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  93
* EL331.cbl
  4594****************************************************
  4595*  2120-SAVE-ECS-KEY                               *
  4596****************************************************
  4597*  SAVE BATCH CERT MASTER KEY IN WS-SAVED-ECS-KEY  *
  4598****************************************************
  4599
  4600 2120-SAVE-ECS-KEY.
  4601
  4602     MOVE DTE-CLASIC-COMPANY-CD  TO WS-SAVED-B-COMP.
  4603     MOVE CR-CARRIER             TO WS-SAVED-B-CARR.
  4604     MOVE CR-GROUPING            TO WS-SAVED-B-GRPG.
  4605     MOVE CR-STATE               TO WS-SAVED-B-STAT.
  4606     MOVE CR-ACCOUNT             TO WS-SAVED-B-ACCT.
  4607     MOVE CR-CERT-NO             TO WS-SAVED-B-CERT.
  4608     MOVE CR-DT                  TO WS-SAVED-B-DATE
  4609                                    DC-GREG-DATE-CYMD.
  4610
  4611     MOVE 'L'                    TO DC-OPTION-CODE.
  4612     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  4613     MOVE DC-BIN-DATE-1          TO BIN-CR-DT.
  4614
  4615 2120-EXIT.
  4616      EXIT.
  4617
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  94
* EL331.cbl
  4619****************************************************
  4620*  2200-MATCH-ACCT                                 *
  4621****************************************************
  4622*  IF ONLINE BILLING OPTION IS USED RETRIEVE THE   *
  4623*  ACCOUNT MASTER FILE RECORD ASSOCIATED WITH THE  *
  4624*  CERTIFICATE BEING PROCESSED. IF A MATCH OCCURS, *
  4625*  THE COMPENSATION STRUCTURES BETWEEN THE TWO     *
  4626*  RECORDS ARE COMPARED, IF ANY DIFFERENCES ARE    *
  4627*  DETECTED A COMPENSATION EXCEPTION RECORD IS     *
  4628*  CREATED. THIS RECORD WILL CONTAIN THE ORIGINAL  *
  4629*  COMPENSATION STRUCTURE THE CERTIFICATE WAS      *
  4630*  ISSUED UNDER.                                   *
  4631****************************************************
  4632
  4633 2200-MATCH-ACCT.
  4634     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  4635        DTE-SYS-G-AR-USED     EQUAL '1'
  4636         NEXT SENTENCE
  4637     ELSE
  4638         GO TO 2200-EXIT.
  4639
  4640     IF NO-MORE-ACT-RECORDS
  4641         GO TO 2200-EXIT.
  4642
  4643     IF CR-ACCT-CONTROL GREATER AM-CONTROL-A
  4644        PERFORM 2260-READ-ACCT THRU 2260-EXIT
  4645        GO TO 2200-MATCH-ACCT.
  4646
  4647     IF CR-ACCT-CONTROL LESS AM-CONTROL-A
  4648        GO TO 2200-EXIT.
  4649
  4650     IF BIN-CR-DT LESS AM-EFFECTIVE-DT  OR
  4651        BIN-CR-DT NOT LESS AM-EXPIRATION-DT
  4652           PERFORM 2260-READ-ACCT THRU 2260-EXIT
  4653           GO TO 2200-MATCH-ACCT.
  4654
  4655****************************************************
  4656*  MATCHED  *  CHECK COMPENSATION STRUCTURE        *
  4657****************************************************
  4658
  4659     IF NOT CR-POLICY-IS-DECLINED  AND
  4660        NOT CR-POLICY-IS-VOID      AND
  4661        NOT CR-POLICY-IS-REIN-ONLY
  4662         ADD 1 TO WS-ACCT-MATCH
  4663         PERFORM 2210-MATCH-LEVELS THRU 2250-EXIT.
  4664
  4665 2200-EXIT.
  4666      EXIT.
  4667
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  95
* EL331.cbl
  4669****************************************************
  4670*  2210-MATCH-LEVELS.                              *
  4671****************************************************
  4672*  THE COMPENSATION STRUCTURES BETWEEN THE TWO     *
  4673*  RECORDS ARE COMPARED, IF ANY DIFFERENCES ARE    *
  4674*  DETECTED A COMPENSATION EXCEPTION RECORD        *
  4675*  IS CREATED. THIS RECORD WILL CONTAIN THE ORIG-  *
  4676*  INAL COMPENSATION STRUCTURE THE CERTIFICATE WAS *
  4677*  ISSUED UNDER.                                   *
  4678*                                                  *
  4679*  AM-COM-TYP =   O (OVERWRITE COMMISSION ON GROSS *
  4680*                  BUSINESS ONLY)                  *
  4681*                                                  *
  4682*  AM-COM-TYP =   P (OVERWRITE COMMISSION ON GROSS *
  4683*                  AND REINSURANCE BUSINESS)       *
  4684****************************************************
  4685
  4686 2210-MATCH-LEVELS.
  4687
  4688     MOVE 1                      TO NDX.
  4689     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  4690     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  4691     PERFORM 2100-LF-TYPE  THRU  2100-EXIT.
  4692
  4693 2220-GET-NEXT-LEVEL.
  4694
  4695     IF CR-AGT-TYPE (NDX)  =  AM-COM-TYP (NDX)
  4696         IF (AM-COM-TYP (NDX) NOT EQUAL 'O' AND 'P'
  4697              AND 'G' AND 'B')
  4698             GO TO 2230-GET-NEXT.
  4699
  4700     IF (AM-J-COM (NDX) NOT NUMERIC)   OR
  4701        (AM-L-COM (NDX) NOT NUMERIC)   OR
  4702        (AM-A-COM (NDX) NOT NUMERIC)
  4703          NEXT SENTENCE
  4704     ELSE
  4705          MOVE AM-L-COM (NDX)    TO  WS-L-COM
  4706          MOVE AM-J-COM (NDX)    TO  WS-J-COM
  4707          MOVE AM-A-COM (NDX)    TO  WS-A-COM
  4708          GO TO 2225-CHECK-NUMERIC.
  4709
  4710     IF CR-LFTYP = ZERO
  4711         GO TO 2224-CHECK-AH-TABLE.
  4712
  4713     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
  4714         GO TO 2221-JOINT-LIFE-COMM.
  4715
  4716     IF AM-L-COM (NDX) NUMERIC
  4717         MOVE AM-L-COM (NDX)    TO  WS-L-COM
  4718         GO TO 2224-CHECK-AH-TABLE.
  4719
  4720     MOVE AM-L-COMA (NDX)        TO  WS-CTBL-TABLE.
  4721     MOVE LIFE-OVERRIDE-L1       TO  WS-CTBL-BEN-TYPE.
  4722     MOVE CR-LFTYP               TO  WS-CTBL-BEN-CODE.
  4723     MOVE CR-LFAMT               TO  WS-COMM-CK-AMT.
  4724     MOVE CR-LF-TERM             TO  WS-CK-TERM.
  4725     MOVE CR-AGE                 TO  WS-CK-AGE.
  4726     PERFORM  2249-CTBL-PROCESS  THRU  2249-READ-CTBL-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  96
* EL331.cbl
  4727     MOVE CT-RT (CINDX)          TO  WS-L-COM.
  4728     GO TO 2224-CHECK-AH-TABLE.
  4729
  4730 2221-JOINT-LIFE-COMM.
  4731
  4732     IF AM-J-COM (NDX) NUMERIC
  4733         MOVE AM-J-COM (NDX)    TO  WS-J-COM
  4734         GO TO 2224-CHECK-AH-TABLE.
  4735
  4736     MOVE AM-J-COMA (NDX)        TO  WS-CTBL-TABLE.
  4737     MOVE LIFE-OVERRIDE-L1       TO  WS-CTBL-BEN-TYPE.
  4738     MOVE CR-LFTYP               TO  WS-CTBL-BEN-CODE.
  4739     MOVE CR-LFAMT               TO  WS-COMM-CK-AMT.
  4740     MOVE CR-LF-TERM             TO  WS-CK-TERM.
  4741     MOVE CR-AGE                 TO  WS-CK-AGE.
  4742     PERFORM  2249-CTBL-PROCESS  THRU  2249-READ-CTBL-EXIT.
  4743     MOVE CT-RT (CINDX)          TO  WS-J-COM.
  4744
  4745 2224-CHECK-AH-TABLE.
  4746
  4747     IF CR-AHTYP = ZERO
  4748         GO TO 2225-CHECK-NUMERIC.
  4749
  4750     IF AM-A-COM (NDX) NUMERIC
  4751         MOVE AM-A-COM (NDX)     TO  WS-A-COM
  4752         GO TO 2225-CHECK-NUMERIC.
  4753
  4754     MOVE AM-A-COMA (NDX)        TO  WS-CTBL-TABLE.
  4755     MOVE AH-OVERRIDE-L1         TO  WS-CTBL-BEN-TYPE.
  4756     MOVE CR-AHTYP               TO  WS-CTBL-BEN-CODE.
  4757     MOVE CR-AHAMT               TO  WS-COMM-CK-AMT.
  4758     MOVE CR-AH-TERM             TO  WS-CK-TERM.
  4759     MOVE CR-AGE                 TO  WS-CK-AGE.
  4760     PERFORM  2249-CTBL-PROCESS  THRU  2249-READ-CTBL-EXIT.
  4761     MOVE CT-RT (CINDX)          TO  WS-A-COM.
  4762
  4763 2225-CHECK-NUMERIC.
  4764
  4765     IF DTE-CLIENT EQUAL 'WDS'
  4766        IF CR-COM-AGT (NDX) EQUAL '0000000001'
  4767           GO TO 2230-GET-NEXT.
  4768
  4769     IF (CR-COM-AGT  (NDX) NOT EQUAL AM-AGT (NDX)) OR
  4770        (CR-AGT-TYPE (NDX) NOT EQUAL AM-COM-TYP (NDX))
  4771           GO TO 2235-NO-MATCH.
  4772
  4773     IF CR-LFTYP EQUAL ZERO
  4774         NEXT SENTENCE
  4775     ELSE
  4776         IF ((CLAS-I-JOINT (CLAS-INDEXL) EQUAL 'J') AND
  4777             (CR-LCOM-L  (NDX) NOT EQUAL WS-J-COM ))
  4778         OR
  4779            ((CLAS-I-JOINT (CLAS-INDEXL) NOT EQUAL 'J') AND
  4780             (CR-LCOM-L  (NDX) NOT EQUAL WS-L-COM ))
  4781                 GO TO 2235-NO-MATCH.
  4782
  4783     IF CR-AHTYP EQUAL ZERO
  4784         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  97
* EL331.cbl
  4785     ELSE
  4786         IF CR-LCOM-AH (NDX) NOT EQUAL WS-A-COM
  4787               GO TO 2235-NO-MATCH.
  4788
  4789 2230-GET-NEXT.
  4790
  4791     ADD 1                       TO NDX.
  4792
  4793     IF NDX GREATER 10
  4794        GO TO 2250-EXIT.
  4795
  4796     GO TO 2220-GET-NEXT-LEVEL.
  4797
  4798 2235-NO-MATCH.
  4799
  4800     MOVE SPACES                 TO COMMISSION-EXCEPTIONS.
  4801     MOVE 'CE'                   TO CE-RECORD-ID.
  4802     MOVE DTE-CLASIC-COMPANY-CD  TO CE-COMPANY-CD.
  4803     MOVE CR-CARRIER             TO CE-CARRIER.
  4804     MOVE CR-GROUPING            TO CE-GROUPING.
  4805     MOVE CR-STATE               TO CE-STATE.
  4806     MOVE CR-ACCOUNT             TO CE-ACCOUNT.
  4807
  4808     MOVE BIN-CR-DT              TO CE-CERT-EFF-DT.
  4809
  4810     MOVE CR-CERT-NO             TO CE-CERT-NO.
  4811     MOVE CR-COMPENSATION-LEVELS TO CE-COMP-STRUCTURE.
  4812
  4813     MOVE CR-LF-EXPIRE-DATE      TO DC-GREG-DATE-CYMD.
  4814
  4815     IF CR-LF-EXPIRE-DATE EQUAL ZERO
  4816          MOVE CR-AH-EXPIRE-DATE TO DC-GREG-DATE-CYMD.
  4817
  4818     MOVE 'L'                    TO DC-OPTION-CODE.
  4819     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  4820     MOVE DC-BIN-DATE-1          TO CE-CERT-EXPIRATION-DT.
  4821
  4822     WRITE COMMISSION-EXCEPTIONS.
  4823
  4824     IF CE-STATUS EQUAL '22'
  4825         GO TO 2245-SKIP-DUP.
  4826
  4827     IF CE-STAT-1  NOT EQUAL ZERO
  4828         MOVE CE-STATUS          TO  WS-ABEND-FILE-STATUS
  4829         MOVE 'ERROR OCCURED WRITE - ERCOMM'
  4830                                 TO  WS-ABEND-MESSAGE
  4831         GO TO ABEND-PGM.
  4832
  4833 2245-SKIP-DUP.
  4834
  4835     MOVE '1'                    TO CM-COMP-EXCP-SW.
  4836     ADD 1                       TO WS-EXCP-ADD.
  4837     GO TO 2250-EXIT.
  4838
  4839 2249-CTBL-PROCESS.
  4840
  4841     IF WS-CTBL-KEY = WS-LAST-CTBL-KEY
  4842         GO TO 2249-SEARCH-TABLE.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  98
* EL331.cbl
  4843
  4844     MOVE DTE-CLASIC-COMPANY-CD  TO  WS-CTBL-COMP-CD.
  4845
  4846 2249-READ-CTBL.
  4847
  4848     MOVE WS-CTBL-KEY            TO  CT-CONTROL-PRIMARY
  4849                                     WS-LAST-CTBL-KEY.
  4850
  4851     READ ERCTBL.
  4852
  4853     IF ERCTBL-FILE-STATUS     = '97'
  4854        MOVE '00' TO ERCTBL-FILE-STATUS.
  4855
  4856     IF ERCTBL-FILE-STATUS NOT = '00'
  4857        ADD  +1  TO  ERROR-COUNT
  4858***1**
  4859        MOVE 'ERCTBL-FILE-STATUS IS = ' TO DIS-LINE-REASON
  4860        MOVE ERCTBL-FILE-STATUS         TO DIS-LINE-REC
  4861        PERFORM 8600-DISPLAY-PRT THRU
  4862              8600-DISPLAY-EXIT
  4863***2**
  4864        MOVE 'WS-CTBL-KEY        IS = ' TO DIS-LINE-REASON
  4865        MOVE  WS-CTBL-KEY               TO DIS-LINE-REC
  4866        PERFORM 8600-DISPLAY-PRT THRU
  4867              8600-DISPLAY-EXIT
  4868***3**
  4869        MOVE 'CM-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4870        MOVE  CM-CONTROL-PRIMARY        TO DIS-LINE-REC
  4871        PERFORM 8600-DISPLAY-PRT THRU
  4872              8600-DISPLAY-EXIT
  4873***4**
  4874        MOVE 'CE-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4875        MOVE  CE-CONTROL-PRIMARY        TO DIS-LINE-REC
  4876        PERFORM 8600-DISPLAY-PRT THRU
  4877              8600-DISPLAY-EXIT
  4878***5**
  4879        MOVE 'AM-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4880        MOVE  AM-CONTROL-PRIMARY        TO DIS-LINE-REC
  4881        PERFORM 8600-DISPLAY-PRT THRU
  4882              8600-DISPLAY-EXIT
  4883***6**
  4884        MOVE 'CL-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4885        MOVE  CL-CONTROL-PRIMARY        TO DIS-LINE-REC
  4886        PERFORM 8600-DISPLAY-PRT THRU
  4887              8600-DISPLAY-EXIT
  4888***7**
  4889        MOVE  SPACES                    TO DIS-LINE-REASON
  4890        MOVE  SPACES                    TO DIS-LINE-REC
  4891        PERFORM 8600-DISPLAY-PRT THRU
  4892              8600-DISPLAY-EXIT
  4893
  4894         MOVE 'ERROR OCCURRED READ - ERCTBL'
  4895                                 TO  WS-ABEND-MESSAGE
  4896         MOVE ERCTBL-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  4897         DISPLAY 'WS-CTBL-KEY = ' WS-CTBL-KEY
  4898         GO TO 2100-READ-ECS-RECORDS.
  4899*        GO TO ABEND-PGM.
  4900
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page  99
* EL331.cbl
  4901 2249-SEARCH-TABLE.
  4902
  4903      MOVE +1                    TO  CINDX.
  4904
  4905      IF  WS-COMM-CK-AMT GREATER THAN CT-TBF (1)
  4906          ADD +9 TO CINDX
  4907          IF WS-COMM-CK-AMT GREATER THAN CT-TBF (2)
  4908              ADD +9 TO CINDX.
  4909
  4910      IF WS-CK-AGE GREATER THAN CT-AGE (1)
  4911          ADD +3 TO CINDX
  4912          IF WS-CK-AGE GREATER THAN CT-AGE (2)
  4913              ADD +3 TO CINDX.
  4914
  4915      IF WS-CK-TERM GREATER THAN CT-TRM (1)
  4916          ADD +1 TO CINDX
  4917          IF WS-CK-TERM GREATER THAN CT-TRM (2)
  4918              ADD +1 TO CINDX.
  4919
  4920      IF CT-RT (CINDX) NOT NUMERIC
  4921          MOVE WS-LAST-CTBL-KEY  TO  CT-CONTROL-PRIMARY
  4922          MOVE CT-RT-R (CINDX)   TO  WS-CTBL-TABLE
  4923          GO TO 2249-READ-CTBL.
  4924
  4925 2249-READ-CTBL-EXIT.
  4926      EXIT.
  4927
  4928 2250-EXIT.
  4929      EXIT.
  4930
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 100
* EL331.cbl
  4932****************************************************
  4933*  2260-READ-ACCT                                  *
  4934****************************************************
  4935*  READ ACCOUNT MASTER FILE RECORD MATCHING THE    *
  4936*  ECS CERTIFICATE RECORD BEING PROCESSED.         *
  4937****************************************************
  4938
  4939 2260-READ-ACCT.
  4940
  4941     IF NO-MORE-ACT-RECORDS
  4942         GO TO 2260-EXIT.
  4943
  4944     READ ERACCT NEXT RECORD.
  4945
  4946     ADD 1 TO WS-ACT-READ.
  4947
  4948***  DISPLAY '*** ERACCT READ: ' AM-CARRIER '-' AM-GROUPING '-'
  4949***      AM-STATE '-' AM-ACCOUNT ' EXP: ' AM-EXPIRE-DT ' EFF: '
  4950***      AM-EFFECTIVE-DT '-' AM-EFFECT-DT '  CERT: ' CR-CARRIER
  4951***      '-' CR-GROUPING '-' CR-STATE '-' CR-ACCOUNT ' EFF: '
  4952***      CR-DT.
  4953
  4954     IF AM-STAT-1 EQUAL '1'
  4955         MOVE 'X'   TO WS-ACT-END-SW
  4956         GO TO 2260-EXIT.
  4957
  4958     IF AM-STAT-1 NOT EQUAL ZERO
  4959         MOVE 'ERROR OCCURED READ  - ERACCT'
  4960                                TO  WS-ABEND-MESSAGE
  4961         MOVE AM-STATUSF        TO  WS-ABEND-FILE-STATUS
  4962         GO TO ABEND-PGM.
  4963
  4964     IF AM-COMPANY-CD NOT EQUAL DTE-CLASIC-COMPANY-CD
  4965         MOVE 'X'               TO WS-ACT-END-SW
  4966         GO TO 2260-EXIT.
  4967
  4968 2260-EXIT.
  4969      EXIT.
  4970
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 101
* EL331.cbl
  4972****************************************************
  4973*  2270-DELETE-ERCOMM                              *
  4974****************************************************
  4975*  DELETE COMPENSATION EXCEPTION RECORDS FOR CERT- *
  4976*  IFICATE MASTER RECORDS THAT HAVE EXPIRED.       *
  4977****************************************************
  4978
  4979 2270-DELETE-ERCOMM.
  4980
  4981     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  4982        DTE-SYS-G-AR-USED     EQUAL '1'
  4983          NEXT SENTENCE
  4984     ELSE
  4985        GO TO 2270-EXIT.
  4986
  4987     IF THIS-CERT-HAS-ERCOMM-ENTRY
  4988         MOVE CM-CONTROL-PRIMARY TO CE-CONTROL-PRIMARY
  4989     ELSE
  4990         GO TO 2270-EXIT.
  4991
  4992     READ ERCOMM.
  4993
  4994     IF CE-STATUS  EQUAL '23'
  4995         GO TO 2270-EXIT.
  4996
  4997     IF CE-STAT-1  NOT EQUAL ZERO
  4998        MOVE CE-STATUS           TO  WS-ABEND-FILE-STATUS
  4999        MOVE 'ERROR OCCURED READ - ERCOMM'
  5000                                 TO  WS-ABEND-MESSAGE
  5001        GO TO ABEND-PGM.
  5002
  5003     DELETE ERCOMM.
  5004
  5005     IF CE-STAT-1  NOT EQUAL ZERO
  5006        MOVE CE-STATUS           TO  WS-ABEND-FILE-STATUS
  5007        MOVE 'ERROR OCCURED DELETE - ERCOMM'
  5008                                 TO  WS-ABEND-MESSAGE
  5009        GO TO ABEND-PGM.
  5010
  5011     ADD 1                       TO WS-EXCP-DEL.
  5012
  5013 2270-EXIT.
  5014     EXIT.
  5015
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 102
* EL331.cbl
  5017*****************************************************
  5018*  2280-DELETE-ERMAIL                               *
  5019*****************************************************
  5020*  DELETE NAME AND ADDRESS RECORDS FOR CERTIFICATE  *
  5021*  MASTER RECORDS THAT HAVE EXPIRED.                *
  5022*****************************************************
  5023
  5024 2280-DELETE-ERMAIL.
  5025
  5026     IF INSURED-ADDR-PRESENT
  5027         MOVE CM-CONTROL-PRIMARY TO MA-CONTROL-PRIMARY
  5028     ELSE
  5029         GO TO 2280-EXIT.
  5030
  5031     READ ERMAIL.
  5032
  5033     IF ERMAIL-FILE-STATUS EQUAL '23'
  5034         GO TO 2280-EXIT.
  5035
  5036     IF CFS-STAT-1 NOT EQUAL ZERO
  5037        MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  5038        MOVE 'ERROR OCCURED READ - ERMAIL'
  5039                                 TO  WS-ABEND-MESSAGE
  5040        GO TO ABEND-PGM.
  5041
  5042     DELETE ERMAIL.
  5043
  5044     IF CFS-STAT-1 NOT EQUAL ZERO
  5045        MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  5046        MOVE 'ERROR OCCURED DELETE - ERMAIL'
  5047                                 TO  WS-ABEND-MESSAGE
  5048        GO TO ABEND-PGM.
  5049
  5050     ADD 1                       TO WS-MAIL-DEL.
  5051
  5052 2280-EXIT.
  5053     EXIT.
  5054
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 103
* EL331.cbl
  5056*****************************************************
  5057*  2300-PROCESS-N-READ-ONL.                         *
  5058*****************************************************
  5059*  THIS ROUTINE IS EXECUTED WHEN THE BATCH CERT     *
  5060*  MASTER CONTROL IS GREATER THAN THE ONLINE CERT   *
  5061*  MASTER CONTROL. THE ONLINE CERT MASTER WILL BE   *
  5062*  DELETED UNLESS IT IS AN OPEN-END CERT OR CLAIM   *
  5063*  PAYMENT ACTIVITY IS ASSOCIATED WITH THE CERT.    *
  5064*  DELETE ANY ASSOCIATED COMPENSATION EXCEPTION     *
  5065*  RECORDS(ERCOMM) AND NAME AND ADDRESS RECORDS     *
  5066*  (ERMAIL) ASSOCIATED WITH THE EXPIRED CERT MASTER *
  5067*  RECORD.                                          *
  5068*****************************************************
  5069
  5070 2300-PROCESS-N-READ-ONL.
  5071
  5072     MOVE ZEROS                  TO CM-STATUS.
  5073
  5074     IF DTE-CLIENT = 'MON'
  5075         GO TO 2300-PROCESS-N-READ-MON.
  5076
  5077*****COPY ELCCRTM2.
  5078
  5079     IF (NO-MATCH-FOUND)
  5080        IF (CERT-PEND-ISSUE-ERROR)
  5081            IF CM-NOTE-SW NOT EQUAL ' '
  5082                 MOVE WS-EXC-MSG-NO-NOTES   TO DTL-EXC-MSG
  5083                 MOVE WS-CURRENT-DATE       TO DC-GREG-DATE-1-EDIT
  5084                 MOVE '2'                   TO DC-OPTION-CODE
  5085                 PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5086                 MOVE DC-BIN-DATE-1         TO CM-LAST-MONTH-END
  5087                 PERFORM 4000-EXPIRE-DATE   THRU  4099-EXIT
  5088
  5089                 REWRITE CERTIFICATE-MASTER
  5090
  5091                 PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5092                 PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5093                 IF CM-STAT-1 NOT EQUAL ZERO
  5094                    MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5095                                    TO  WS-ABEND-MESSAGE
  5096                    MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5097                    GO TO ABEND-PGM
  5098                 ELSE
  5099                    GO TO 2301-READ-ONL-CERT.
  5100
  5101     IF (NO-MATCH-FOUND) AND
  5102        (NOT CM-OPEN-END)
  5103         PERFORM 2330-FIND-ASSOCIATED-CLAIM  THRU 2330-EXIT
  5104         IF (NO-ASSOCIATED-CLAIM) AND
  5105            (CM-CLAIM-ATTACHED-COUNT = 0)
  5106              MOVE SPACES                TO WS-EXC-MSG-CE-COPY
  5107              MOVE WS-EXC-MSG-CE-DELETE  TO DTL-EXC-MSG
  5108              PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5109              PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5110              PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5111              ADD +1                     TO WS-ONL-DELETED
  5112*             PERFORM 2280-DELETE-ERMAIL THRU 2280-EXIT
  5113              PERFORM 2270-DELETE-ERCOMM THRU 2270-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 104
* EL331.cbl
  5114
  5115              DELETE ELCERTF
  5116
  5117              IF CM-STAT-1 NOT EQUAL ZERO
  5118                 MOVE 'ERROR OCCURED DELETE  - ELCERT'
  5119                                 TO  WS-ABEND-MESSAGE
  5120                 MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5121                 GO TO ABEND-PGM
  5122              ELSE
  5123                 NEXT SENTENCE
  5124         ELSE
  5125             MOVE '- COPY RETAINED'     TO WS-EXC-MSG-EE-COPY
  5126             MOVE WS-EXC-MSG-EE-EXPIRED TO DTL-EXC-MSG
  5127             IF (CM-CREDIT-INTERFACE-SW-1 EQUAL '3') AND
  5128                (CM-CLAIM-INTERFACE-SW    EQUAL '2') AND
  5129                (CM-CLAIM-ATTACHED-COUNT  EQUAL WS-CLM-CNT)
  5130                  NEXT SENTENCE
  5131               ELSE
  5132                  MOVE WS-CLM-CNT TO CM-CLAIM-ATTACHED-COUNT
  5133                  MOVE WS-CURRENT-DATE   TO DC-GREG-DATE-1-EDIT
  5134                  MOVE '2'               TO DC-OPTION-CODE
  5135                  PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5136                  MOVE DC-BIN-DATE-1     TO CM-LAST-MONTH-END
  5137                  PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT
  5138                  REWRITE CERTIFICATE-MASTER
  5139                  PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5140                  PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5141                  PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5142                  IF CM-STAT-1 NOT EQUAL ZERO
  5143                     MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5144                                     TO  WS-ABEND-MESSAGE
  5145                     MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5146                     GO TO ABEND-PGM.
  5147
  5148     GO TO 2301-READ-ONL-CERT.
  5149
  5150 2300-PROCESS-N-READ-MON.
  5151
  5152*****COPY ELCCRTM2.
  5153
  5154     IF (NO-MATCH-FOUND)
  5155        IF (CERT-PEND-ISSUE-ERROR)
  5156            IF CM-NOTE-SW NOT EQUAL ' '
  5157                 MOVE WS-EXC-MSG-NO-NOTES   TO DTL-EXC-MSG
  5158                 MOVE WS-CURRENT-DATE       TO DC-GREG-DATE-1-EDIT
  5159                 MOVE '2'                   TO DC-OPTION-CODE
  5160                 PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5161                 MOVE DC-BIN-DATE-1         TO CM-LAST-MONTH-END
  5162                 PERFORM 4000-EXPIRE-DATE   THRU  4099-EXIT
  5163
  5164                 REWRITE CERTIFICATE-MASTER
  5165
  5166                 PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5167                 PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5168                 IF CM-STAT-1 NOT EQUAL ZERO
  5169                    MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5170                                    TO  WS-ABEND-MESSAGE
  5171                    MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 105
* EL331.cbl
  5172                    GO TO ABEND-PGM
  5173                 ELSE
  5174                    GO TO 2301-READ-ONL-CERT.
  5175
  5176     IF (NO-MATCH-FOUND) AND
  5177        (NOT CM-OPEN-END)
  5178         PERFORM 2330-FIND-ASSOCIATED-CLAIM  THRU 2330-EXIT
  5179         IF (NO-ASSOCIATED-CLAIM) AND
  5180            ((CM-CLAIM-ATTACHED-COUNT = 0) OR
  5181            (CM-GROUPING NOT NUMERIC))
  5182              MOVE SPACES                TO WS-EXC-MSG-CE-COPY
  5183              MOVE WS-EXC-MSG-CE-DELETE  TO DTL-EXC-MSG
  5184              PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5185              PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5186              PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5187              ADD +1                     TO WS-ONL-DELETED
  5188*             PERFORM 2280-DELETE-ERMAIL THRU 2280-EXIT
  5189              PERFORM 2270-DELETE-ERCOMM THRU 2270-EXIT
  5190
  5191              DELETE ELCERTF
  5192
  5193              IF CM-STAT-1 NOT EQUAL ZERO
  5194                 MOVE 'ERROR OCCURED DELETE  - ELCERT'
  5195                                 TO  WS-ABEND-MESSAGE
  5196                 MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5197                 GO TO ABEND-PGM
  5198              ELSE
  5199                 NEXT SENTENCE
  5200         ELSE
  5201             MOVE '- COPY RETAINED'     TO WS-EXC-MSG-EE-COPY
  5202             MOVE WS-EXC-MSG-EE-EXPIRED TO DTL-EXC-MSG
  5203             IF (CM-CREDIT-INTERFACE-SW-1 EQUAL '3') AND
  5204                (CM-CLAIM-INTERFACE-SW    EQUAL '2') AND
  5205                (CM-CLAIM-ATTACHED-COUNT  EQUAL WS-CLM-CNT)
  5206                  NEXT SENTENCE
  5207               ELSE
  5208                  MOVE WS-CLM-CNT TO CM-CLAIM-ATTACHED-COUNT
  5209                  MOVE WS-CURRENT-DATE   TO DC-GREG-DATE-1-EDIT
  5210                  MOVE '2'               TO DC-OPTION-CODE
  5211                  PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5212                  MOVE DC-BIN-DATE-1     TO CM-LAST-MONTH-END
  5213                  PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT
  5214                  REWRITE CERTIFICATE-MASTER
  5215                  PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5216                  PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5217                  PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5218                  IF CM-STAT-1 NOT EQUAL ZERO
  5219                     MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5220                                     TO  WS-ABEND-MESSAGE
  5221                     MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5222                     GO TO ABEND-PGM.
  5223
  5224 2301-READ-ONL-CERT.
  5225
  5226     READ ELCERTF  NEXT RECORD.
  5227
  5228     IF CM-STAT-1 EQUAL '1'
  5229         MOVE 'X'                TO WS-ONL-END-SW
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 106
* EL331.cbl
  5230                                    WS-ONL-GE-SW
  5231         MOVE HIGH-VALUES        TO WS-SAVED-ONL-KEY
  5232         MOVE SPACE              TO WS-O-MATCH-SW
  5233         GO TO 2300-EXIT.
  5234
  5235     IF CM-STAT-1 NOT EQUAL ZERO
  5236         MOVE 'ERROR OCCURED READ NEXT - ELCERT'
  5237                                 TO  WS-ABEND-MESSAGE
  5238         MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  5239         GO TO ABEND-PGM.
  5240
  5241     IF CM-COMPANY-CD NOT EQUAL DTE-CLASIC-COMPANY-CD
  5242         MOVE 'X'                TO WS-ONL-END-SW
  5243                                    WS-ONL-GE-SW
  5244         MOVE HIGH-VALUES        TO WS-SAVED-ONL-KEY
  5245         MOVE SPACE              TO WS-O-MATCH-SW
  5246         GO TO 2300-EXIT.
  5247
  5248     IF CM-OPEN-END
  5249         GO TO 2301-READ-ONL-CERT.
  5250
  5251     MOVE SPACE                  TO WS-O-MATCH-SW.
  5252
  5253 2302-PROC-ONL-CERT.
  5254     ADD 1                        TO WS-ONL-READ.
  5255
  5256
  5257     IF CM-ADDL-CLP NOT NUMERIC
  5258        MOVE ZEROS                TO CM-ADDL-CLP
  5259     END-IF
  5260     IF CM-LF-CLP NOT NUMERIC
  5261        MOVE ZEROS               TO CM-LF-CLP
  5262     END-IF
  5263     IF CM-AH-CLP NOT NUMERIC
  5264        MOVE ZEROS               TO CM-AH-CLP
  5265     END-IF
  5266     IF CM-DDF-IU-RATE-UP NOT NUMERIC
  5267        MOVE ZEROS               TO CM-DDF-IU-RATE-UP
  5268     END-IF
  5269
  5270     IF CM-NH-INT-ON-REFS NOT NUMERIC
  5271         MOVE ZEROS               TO CM-NH-INT-ON-REFS.
  5272
  5273*****COPY ELCCRTM2.
  5274
  5275     MOVE CERTIFICATE-MASTER      TO WS-ONL-RECORD.
  5276
  5277     MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLM-CNT.
  5278     MOVE CM-CLAIM-INTERFACE-SW   TO WS-CM-ORIG.
  5279     MOVE CM-LOAN-NUMBER          TO WS-LN-NUMBER.
  5280     MOVE CM-LOAN-BALANCE         TO WS-LN-BALANCE.
  5281     MOVE CM-BENEFICIARY          TO WS-CM-BENEFICIARY.
  5282     MOVE CM-LAST-ADD-ON-DT       TO WS-LST-ADD-ON-DT.
  5283     MOVE CM-ENTRY-BATCH          TO WS-CM-ENTRY-BATCH.
  5284     MOVE CM-LF-EXIT-BATCH        TO WS-CM-LF-EXIT-BATCH.
  5285     MOVE CM-AH-EXIT-BATCH        TO WS-CM-AH-EXIT-BATCH.
  5286     MOVE CM-COMP-EXCP-SW         TO WS-ERCOMM-SW.
  5287     MOVE CM-INSURED-ADDRESS-SW   TO WS-CM-INSURED-ADDRESS-SW.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 107
* EL331.cbl
  5288*    MOVE CM-CLAIM-DEDUCT-WITHHELD
  5289*                                 TO WS-CLAIM-DEDUCT-WITHHELD.
  5290*    MOVE CM-CANCEL-DEDUCT-WITHHELD
  5291*                                 TO WS-CANCEL-DEDUCT-WITHHELD.
  5292     MOVE CM-LF-DEATH-EXIT-DT     TO WS-LF-DEATH-EXIT-DT.
  5293     MOVE CM-LF-CURRENT-STATUS    TO WS-LF-CURRENT-STATUS.
  5294     MOVE CM-LF-STATUS-AT-DEATH   TO WS-LF-STATUS-AT-DEATH.
  5295     PERFORM 2370-SAVE-ONL-KEY    THRU 2370-EXIT.
  5296
  5297     IF WS-SAVED-ONL-KEY NOT LESS WS-SAVED-ECS-KEY
  5298         MOVE 'X'                 TO WS-ONL-GE-SW.
  5299
  5300 2300-EXIT.
  5301      EXIT.
  5302
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 108
* EL331.cbl
  5304*****************************************************
  5305*  2330-FIND-ASSOCIATED-CLAIM                       *
  5306*****************************************************
  5307*  THIS ROUTINE WILL BROWSE THE CLAIM MASTER FILE   *
  5308*  THRU THE CERTIFICATE ALTERNATE INDEX AND ACCUM-  *
  5309*  ULATE A COUNT OF CLAIMS ASSOCIATED WITH THE CURR-*
  5310*  ENT CLAIM MASTER. THE LAST CLAIM MASTER FOUND IS *
  5311*  SAVED IN CLAIM-MASTER.                           *
  5312*****************************************************
  5313
  5314 2330-FIND-ASSOCIATED-CLAIM.
  5315
  5316     MOVE 'N'                   TO WS-CLAIM-SW.
  5317
  5318     IF DTE-SYS-E-CLASIC-CLAIMS EQUAL ZERO OR 'N'
  5319         GO TO 2330-EXIT.
  5320
  5321********************************************************
  5322*  BUILD CL-CONTROL-BY-CERT-NO AND WS-SEC-CLAIM-INDEX  *
  5323*  FROM THE CURRENT ONLINE CERT MASTER RECORD.         *
  5324********************************************************
  5325
  5326     MOVE CM-COMPANY-CD         TO CL-COMPANY-CD-A4
  5327                                   WS-S-CL-COMP.
  5328     MOVE CM-CERT-PRIME         TO CL-CERT-A4-PRIME
  5329                                   WS-S-CL-PRIM.
  5330     MOVE CM-CERT-SFX           TO CL-CERT-A4-SFX
  5331                                   WS-S-CL-SFX.
  5332     MOVE CM-GROUPING           TO WS-CL-GRPG.
  5333     MOVE CM-STATE              TO WS-CL-STAT.
  5334     MOVE CM-ACCOUNT            TO WS-CL-ACCT.
  5335     MOVE CM-CARRIER            TO WS-CL-CARR.
  5336     MOVE CM-CERT-EFF-DT        TO WS-CL-EFDT.
  5337
  5338     MOVE ZERO                  TO  WS-CLM-CNT.
  5339
  5340     START ELMSTR5
  5341                KEY EQUAL CL-CONTROL-BY-CERT-NO.
  5342***
  5343     IF CL-STATUS EQUAL '23'
  5344         GO TO 2350-CHECK-ELRETR.
  5345
  5346     IF CL-STAT-1 EQUAL ZERO
  5347         MOVE SPACE              TO WS-CLM-END-SW
  5348         PERFORM 2335-READNEXT-CLAIM  THRU 2335-EXIT
  5349             UNTIL NO-MORE-CLAIM-MATCH
  5350     ELSE
  5351         MOVE 'ERROR OCCURED START - ELMSTR'
  5352                                 TO  WS-ABEND-MESSAGE
  5353         MOVE CL-STATUS          TO  WS-ABEND-FILE-STATUS
  5354         GO TO ABEND-PGM.
  5355
  5356     IF ASSOCIATED-CLAIM
  5357         MOVE WS-LAST-CLAIM-MATCHED TO CLAIM-MASTER.
  5358
  5359 2330-EXIT.
  5360      EXIT.
  5361
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 109
* EL331.cbl
  5363*****************************************************
  5364*  2335-READNEXT-CLAIM                              *
  5365*****************************************************
  5366*  READ CLAIM MASTER FILE AND CHECK KEYS FOR MATCH  *
  5367*****************************************************
  5368
  5369 2335-READNEXT-CLAIM.
  5370
  5371     READ ELMSTR5  NEXT  RECORD.
  5372
  5373     IF CL-STAT-1  EQUAL '1'
  5374         MOVE 'X'                TO WS-CLM-END-SW
  5375         GO TO 2335-EXIT.
  5376
  5377     IF CL-STAT-1  NOT  EQUAL '0'
  5378         MOVE 'ERROR OCCURED READNEXT - ELMSTR'
  5379                                 TO  WS-ABEND-MESSAGE
  5380         MOVE CL-STATUS          TO  WS-ABEND-FILE-STATUS
  5381         GO TO ABEND-PGM.
  5382
  5383     IF CL-CONTROL-BY-CERT-NO  NOT EQUAL WS-SEC-CLAIM-INDEX
  5384         MOVE  'X'               TO WS-CLM-END-SW
  5385     ELSE
  5386         IF CL-CERT-KEY-DATA EQUAL WS-CLAIM-MATCH-KEY
  5387             ADD +1              TO  WS-CLM-CNT
  5388             MOVE CLAIM-MASTER   TO WS-LAST-CLAIM-MATCHED
  5389             MOVE 'A'            TO WS-CLAIM-SW.
  5390
  5391 2335-EXIT.
  5392      EXIT.
  5393
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 110
* EL331.cbl
  5395
  5396********************************************************
  5397*  BUILD RL-CONTROL-BY-CERT-NO AND WS-SEC-CLAIM-INDEX  *
  5398*  FROM THE CURRENT ONLINE CERT MASTER RECORD.         *
  5399********************************************************
  5400
  5401 2350-CHECK-ELRETR.
  5402     MOVE CM-COMPANY-CD         TO RL-COMPANY-CD-A4
  5403                                   WS-S-CL-COMP.
  5404     MOVE CM-CERT-PRIME         TO RL-CERT-A4-PRIME
  5405                                   WS-S-CL-PRIM.
  5406     MOVE CM-CERT-SFX           TO RL-CERT-A4-SFX
  5407                                   WS-S-CL-SFX.
  5408     MOVE CM-GROUPING           TO WS-CL-GRPG.
  5409     MOVE CM-STATE              TO WS-CL-STAT.
  5410     MOVE CM-ACCOUNT            TO WS-CL-ACCT.
  5411     MOVE CM-CARRIER            TO WS-CL-CARR.
  5412     MOVE CM-CERT-EFF-DT        TO WS-CL-EFDT.
  5413
  5414     MOVE ZERO                  TO WS-CLM-CNT.
  5415
  5416     START ELRETR5
  5417                KEY EQUAL RL-CONTROL-BY-CERT-NO.
  5418
  5419     IF ELRETR5-FILE-STATUS = '23'
  5420         GO TO 2330-EXIT.
  5421
  5422     IF ELRETR5-FILE-STATUS = ZERO
  5423         MOVE SPACE              TO WS-CLM-END-SW
  5424         PERFORM 2355-READNEXT-CLAIM  THRU 2355-EXIT
  5425             UNTIL NO-MORE-CLAIM-MATCH
  5426     ELSE
  5427         MOVE 'ERROR OCCURRED START - ELRETR'
  5428                                  TO WS-ABEND-MESSAGE
  5429         MOVE ELRETR5-FILE-STATUS TO WS-ABEND-FILE-STATUS
  5430         GO TO ABEND-PGM.
  5431
  5432     IF ASSOCIATED-CLAIM
  5433         MOVE WS-LAST-CLAIM-MATCHED TO CLAIM-MASTER.
  5434
  5435     GO TO 2330-EXIT.
  5436
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 111
* EL331.cbl
  5438*****************************************************
  5439*  2355-READNEXT-CLAIM (ELRETR)                     *
  5440*****************************************************
  5441*  READ RETRIEVE FILE AND CHECK KEYS FOR MATCH      *
  5442*****************************************************
  5443
  5444 2355-READNEXT-CLAIM.
  5445
  5446     READ ELRETR5  NEXT  RECORD.
  5447
  5448     IF ELRETR5-STAT-1 = '1'
  5449         MOVE 'X'                TO WS-CLM-END-SW
  5450         GO TO 2355-EXIT.
  5451
  5452     IF ELRETR5-STAT-1 NOT = ZERO
  5453         MOVE 'ERROR OCCURRED READNEXT - ELMSTR'
  5454                                  TO WS-ABEND-MESSAGE
  5455         MOVE ELRETR5-FILE-STATUS TO WS-ABEND-FILE-STATUS
  5456         GO TO ABEND-PGM.
  5457
  5458     IF RL-CONTROL-BY-CERT-NO NOT = WS-SEC-CLAIM-INDEX
  5459         MOVE  'X'               TO WS-CLM-END-SW
  5460     ELSE
  5461         IF RL-CERT-KEY-DATA = WS-CLAIM-MATCH-KEY
  5462             ADD +1 TO WS-CLM-CNT
  5463             MOVE RETRIEVE-MASTER  TO WS-LAST-CLAIM-MATCHED
  5464             MOVE 'A'              TO WS-CLAIM-SW.
  5465
  5466 2355-EXIT.
  5467      EXIT.
  5468
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 112
* EL331.cbl
  5470***********************************************************
  5471*  2370-SAVE-ONL-KEY                                      *
  5472***********************************************************
  5473*  STORE ONLINE CERT MASTER KEY IN WS-CM-CONTROL-PRIMARY  *
  5474*  AND BUILD WS-SAVED-ONL-KEY FOR COMPARISON.             *
  5475***********************************************************
  5476
  5477 2370-SAVE-ONL-KEY.
  5478
  5479     MOVE CM-CONTROL-PRIMARY     TO WS-CM-CONTROL-PRIMARY.
  5480     MOVE DTE-CLASIC-COMPANY-CD  TO WS-SAVED-O-COMP.
  5481     MOVE CM-CARRIER             TO WS-SAVED-O-CARR.
  5482     MOVE CM-GROUPING            TO WS-SAVED-O-GRPG.
  5483     MOVE CM-STATE               TO WS-SAVED-O-STAT.
  5484     MOVE CM-ACCOUNT             TO WS-SAVED-O-ACCT.
  5485     MOVE CM-CERT-NO             TO WS-SAVED-O-CERT.
  5486
  5487     MOVE SPACES                 TO DC-OPTION-CODE.
  5488     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
  5489     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  5490     MOVE DC-GREG-DATE-CYMD      TO WS-SAVED-O-DATE.
  5491
  5492 2370-EXIT.
  5493      EXIT.
  5494
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 113
* EL331.cbl
  5496***********************************************************
  5497*  2500-PROCESS-MATCHING                                  *
  5498***********************************************************
  5499*  A MATCH HAS OCCURRED BETWEEN THE ONLINE AND BATCH      *
  5500*  CERT MASTER FILES. DETERMINE THE TYPE OF ACTIVITY IF   *
  5501*  ANY THAT HAS OCCURRED SINCE LAST MONTH-END AND REPORT  *
  5502*  IT.                                                    *
  5503***********************************************************
  5504
  5505 2500-PROCESS-MATCHING.
  5506     ADD 1                       TO WS-MATCHED-ONL.
  5507     MOVE 'M'                    TO WS-O-MATCH-SW.
  5508     MOVE SPACES                 TO WS-FIRST-TIME-SW.
  5509     MOVE SPACES                 TO WS-PRT-FULL-LINE-SW.
  5510
  5511*****************************************************************
  5512*****************************************************************
  5513*****    SPECIAL CODE FOR JAL AND JAI TO INFORM THEM OF     *****
  5514*****    ZERO CERTIFICATES COMING FROM THE BLAZER LOAN      *****
  5515*****    SYSTEM.                                            *****
  5516*****************************************************************
  5517*****************************************************************
  5518
  5519     IF DTE-CLIENT EQUAL 'JAL' OR 'JAI'
  5520        IF (CR-AHPRM + CR-LFPRM) LESS THAN +.05
  5521           ADD 1 TO NO-PREM-CT
  5522           DISPLAY 'NO PREMIUMS FOR CERT ' CR-FULL-CONTROL
  5523           IF ((CR-AHTYP EQUAL ZERO) AND (CR-LFTYP EQUAL ZERO))
  5524              DISPLAY 'NO PLAN CODES FOR CERT ' CR-FULL-CONTROL
  5525              ADD 1 TO NO-PLAN-CODE-CT
  5526              MOVE +1 TO CR-AHPRM CR-LFPRM
  5527           ELSE
  5528              IF CR-LFTYP EQUAL ZEROS
  5529                 MOVE +1 TO CR-AHPRM
  5530              ELSE
  5531                 IF CR-AHTYP EQUAL ZEROS
  5532                    MOVE +1 TO CR-LFPRM
  5533                 ELSE
  5534                    MOVE +1 TO CR-AHPRM CR-LFPRM.
  5535
  5536*****************************************************************
  5537*****************************************************************
  5538*****    SPECIAL CODE FOR JAL AND JAI TO INFORM THEM OF     *****
  5539*****    ZERO CERTIFICATES COMING FROM THE BLAZER LOAN      *****
  5540*****    SYSTEM.                                            *****
  5541*****************************************************************
  5542*****************************************************************
  5543
  5544*****************************************************************
  5545*  PREMIUM TOTAL LESS THAN (.05) EXIT ROUTINE (RE-ISSUED CERT)  *
  5546*****************************************************************
  5547
  5548*    IF (CR-AHPRM + CR-LFPRM) LESS +.05
  5549*        GO TO 2500-EXIT.
  5550
  5551*****************************************************************
  5552*  PROCESS OPTION (2) RE-ATTACHES CERT MASTER TO CLAIMS MASTER  *
  5553*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 114
* EL331.cbl
  5554
  5555     IF DTE-CLIENT = 'MON'
  5556         NEXT SENTENCE
  5557     ELSE
  5558         IF DTE-PRC-OPT NOT EQUAL '2'
  5559             IF NO-CLAIM-ATTACHED
  5560                 PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5561                 GO TO 2500-EXIT.
  5562
  5563     PERFORM 2330-FIND-ASSOCIATED-CLAIM  THRU 2330-EXIT.
  5564
  5565     IF NO-ASSOCIATED-CLAIM
  5566         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5567         GO TO 2500-EXIT.
  5568
  5569     ADD 1                       TO WS-CLAIM-MATCH.
  5570
  5571*********************************************************
  5572*****  LIFE COVERAGE CANCELLED BUT NOW REINSTATED   *****
  5573*********************************************************
  5574
  5575     IF CR-LF-STATUS-AT-CANCEL EQUAL SPACE AND
  5576        CM-LF-CANCEL-DT NOT EQUAL LOW-VALUE
  5577           MOVE 'POLICY REINSTATED AFTER CANCEL' TO DTL-EXC-MSG
  5578           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5579           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5580           GO TO 2500-EXIT.
  5581
  5582*********************************************************
  5583*****  AH COVERAGE CANCELLED BUT NOW REINSTATED     *****
  5584*********************************************************
  5585
  5586     IF CR-AH-STATUS-AT-CANCEL EQUAL SPACE AND
  5587        CM-AH-CANCEL-DT NOT EQUAL LOW-VALUE
  5588           MOVE 'POLICY REINSTATED AFTER CANCEL' TO DTL-EXC-MSG
  5589           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5590           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5591           GO TO 2500-EXIT.
  5592
  5593*************************************
  5594*****  LIFE COVERAGE CANCELLED  *****
  5595*************************************
  5596
  5597     IF CR-LF-STATUS-AT-CANCEL NOT EQUAL SPACE AND
  5598        CM-LF-CANCEL-DT EQUAL LOW-VALUE
  5599           MOVE ' LIFE COV CANCELLED AS OF '
  5600                                   TO WS-EXC-MSG-DESC
  5601           MOVE CR-LF-CNC-MO       TO WS-EXC-C-MO
  5602           MOVE CR-LF-CNC-DA       TO WS-EXC-C-DA
  5603           MOVE CR-LF-CNC-YR       TO WS-EXC-C-YR
  5604           MOVE WS-EXC-MSG-CANCEL  TO DTL-EXC-MSG
  5605           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5606           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5607           GO TO 2500-EXIT.
  5608
  5609*************************************
  5610*****  AH COVERAGE CANCELLED    *****
  5611*************************************
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 115
* EL331.cbl
  5612
  5613     IF CR-AH-STATUS-AT-CANCEL NOT EQUAL SPACE AND
  5614        CM-AH-CANCEL-DT EQUAL LOW-VALUE
  5615           MOVE ' A&H  COV CANCELLED AS OF '
  5616                                   TO WS-EXC-MSG-DESC
  5617           MOVE CR-AH-CNC-MO       TO WS-EXC-C-MO
  5618           MOVE CR-AH-CNC-DA       TO WS-EXC-C-DA
  5619           MOVE CR-AH-CNC-YR       TO WS-EXC-C-YR
  5620           MOVE WS-EXC-MSG-CANCEL  TO DTL-EXC-MSG
  5621           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5622           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5623           GO TO 2500-EXIT.
  5624
  5625*************************************
  5626*****  LIFE COVERAGE DELETED    *****
  5627*************************************
  5628
  5629     IF CR-LFTYP EQUAL ZEROS AND
  5630        CM-LF-BENEFIT-CD NOT EQUAL ZERO
  5631         MOVE WS-EXC-MSG-CO-DELETE TO DTL-EXC-MSG
  5632         PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5633         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5634         GO TO 2500-EXIT.
  5635
  5636*************************************
  5637*****  AH COVERAGE DELETED      *****
  5638*************************************
  5639
  5640     IF CR-AHTYP EQUAL ZEROS AND
  5641        CM-AH-BENEFIT-CD NOT EQUAL ZERO
  5642         MOVE WS-EXC-MSG-CO-DELETE TO DTL-EXC-MSG
  5643         PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5644         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5645         GO TO 2500-EXIT.
  5646
  5647*************************************
  5648*****  COVERAGE ADDED FOR LIFE  *****
  5649*************************************
  5650
  5651     IF CERT-WAS-CREATED-FOR-CLAIM
  5652         IF CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1
  5653            MOVE CR-LFTYP         TO WS-EXC-MSG-ADDED-TYPE
  5654            MOVE CR-LFAMT         TO WS-EXC-MSG-ADDED-AMT
  5655            MOVE WS-EXC-MSG-ADDED TO DTL-EXC-MSG
  5656            PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5657            PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5658            GO TO 2500-EXIT.
  5659
  5660*************************************
  5661*****  COVERAGE ADDED FOR AH   *****
  5662*************************************
  5663
  5664     IF CERT-WAS-CREATED-FOR-CLAIM
  5665         IF CL-CLAIM-TYPE EQUAL AH-OVERRIDE-L1
  5666            MOVE CR-AHTYP         TO WS-EXC-MSG-ADDED-TYPE
  5667            MOVE CR-AHAMT         TO WS-EXC-MSG-ADDED-AMT
  5668            MOVE WS-EXC-MSG-ADDED TO DTL-EXC-MSG
  5669            PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 116
* EL331.cbl
  5670            PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5671            GO TO 2500-EXIT.
  5672
  5673     IF (CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1) AND
  5674        (CR-LFTYP EQUAL CM-LF-BENEFIT-CD) AND
  5675        (CR-LFAMT EQUAL CM-LF-BENEFIT-AMT)
  5676          PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5677          GO TO 2500-EXIT.
  5678
  5679     IF (CL-CLAIM-TYPE EQUAL AH-OVERRIDE-L1) AND
  5680        (CR-AHTYP  EQUAL CM-AH-BENEFIT-CD) AND
  5681        (CR-AHAMT  EQUAL CM-AH-BENEFIT-AMT)
  5682          PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5683          GO TO 2500-EXIT.
  5684
  5685     IF CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1
  5686         MOVE CM-LF-BENEFIT-AMT      TO WS-EXC-MSG-CHGD-AMT-NEW
  5687         MOVE CM-LF-BENEFIT-CD       TO WS-EXC-MSG-CHGD-TYPE-NEW
  5688         MOVE WS-EXC-MSG-CHANGED-NEW TO DTL-EXC-MSG
  5689         PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5690         MOVE CR-LFTYP               TO WS-EXC-MSG-CHGD-TYPE-OLD
  5691         MOVE CR-LFAMT               TO WS-EXC-MSG-CHGD-AMT-OLD
  5692         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT.
  5693
  5694     IF CL-CLAIM-TYPE EQUAL AH-OVERRIDE-L1
  5695         MOVE CM-AH-BENEFIT-AMT      TO WS-EXC-MSG-CHGD-AMT-NEW
  5696         MOVE CM-AH-BENEFIT-CD       TO WS-EXC-MSG-CHGD-TYPE-NEW
  5697         MOVE WS-EXC-MSG-CHANGED-NEW TO DTL-EXC-MSG
  5698         PERFORM 2510-BUILD-PRINT THRU 2510-EXIT
  5699         MOVE CR-AHTYP               TO WS-EXC-MSG-CHGD-TYPE-OLD
  5700         MOVE CR-AHAMT               TO WS-EXC-MSG-CHGD-AMT-OLD
  5701         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT.
  5702
  5703***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  5704***                                                            ***
  5705***  We found a condition where the claim type was blank       ***
  5706***  and the on-line cert had a pending status and it should   ***
  5707***  not have so we decided to re-build the on-line cert       ***
  5708***  based on the off-line cert. BTW, do-not-load means that   ***
  5709***  the cert is old and it thinks there isnt an on-line equal ***
  5710***                                                            ***
  5711***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  5712
  5713     if (cl-claim-type = ' ')
  5714        and (do-not-load)
  5715        and ((cm-lf-current-status = '2')
  5716           or (cm-ah-current-status = '2'))
  5717        PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5718        GO TO 2500-EXIT
  5719     end-if
  5720
  5721     PERFORM 2530-PRINT-OLD THRU 2530-EXIT.
  5722
  5723 2500-EXIT.
  5724      EXIT.
  5725
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 117
* EL331.cbl
  5727 2510-BUILD-PRINT.
  5728     IF NOT LINE-FULL
  5729         PERFORM 7300-BLD-ECS-PRT-LINE  THRU 7300-EXIT
  5730         PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT.
  5731
  5732     PERFORM 7370-PRINT-DETAIL THRU 7370-EXIT.
  5733
  5734 2510-EXIT.
  5735      EXIT.
  5736
  5737 2530-PRINT-OLD.
  5738
  5739     MOVE SPACES                 TO DTL-1.
  5740     MOVE WS-EXC-MSG-CHANGED-OLD TO DTL-EXC-MSG.
  5741     MOVE DTL-1                  TO P-DATA.
  5742     MOVE ' '                    TO X.
  5743     ADD  1                      TO WS-LINE-CNT.
  5744     PERFORM 7600-PRT-RTN   THRU 7600-EXIT.
  5745
  5746 2530-EXIT.
  5747      EXIT.
  5748
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 118
* EL331.cbl
  5750***********************************************************
  5751*  2600-REWRITE-CERT                                      *
  5752***********************************************************
  5753*  REWRITE THE UPDATED ONLINE CERTIFICATE MASTER RECORD   *
  5754***********************************************************
  5755
  5756 2600-REWRITE-CERT.
  5757
  5758*****COPY ELCCRTM1.
  5759
  5760     MOVE CERTIFICATE-MASTER TO WS-BEFORE-CERT.
  5761
  5762     PERFORM 2830-MOVE-DATA  THRU 2830-EXIT.
  5763
  5764     IF MATCHED-REC
  5765         MOVE WS-LN-NUMBER        TO CM-LOAN-NUMBER
  5766         MOVE WS-LN-BALANCE       TO CM-LOAN-BALANCE
  5767         MOVE WS-CM-BENEFICIARY   TO CM-BENEFICIARY
  5768         MOVE WS-LST-ADD-ON-DT    TO CM-LAST-ADD-ON-DT
  5769         MOVE WS-CM-ENTRY-BATCH   TO CM-ENTRY-BATCH
  5770         MOVE WS-CM-LF-EXIT-BATCH TO CM-LF-EXIT-BATCH
  5771         MOVE WS-CM-AH-EXIT-BATCH TO CM-AH-EXIT-BATCH
  5772         MOVE WS-CLM-CNT          TO CM-CLAIM-ATTACHED-COUNT
  5773         MOVE WS-CM-INSURED-ADDRESS-SW
  5774                                  TO CM-INSURED-ADDRESS-SW
  5775*        MOVE WS-CLAIM-DEDUCT-WITHHELD
  5776*                                 TO CM-CLAIM-DEDUCT-WITHHELD
  5777*        MOVE WS-CANCEL-DEDUCT-WITHHELD
  5778*                                 TO CM-CANCEL-DEDUCT-WITHHELD
  5779         IF CM-CLAIM-ATTACHED-COUNT EQUAL ZERO
  5780               MOVE SPACE         TO CM-CLAIM-INTERFACE-SW
  5781           ELSE
  5782               MOVE '1'           TO CM-CLAIM-INTERFACE-SW.
  5783
  5784     IF MATCHED-REC
  5785         IF WS-LF-DEATH-EXIT-DT NOT LESS THAN WS-EOM-DT
  5786             MOVE WS-LF-DEATH-EXIT-DT
  5787                                  TO  CM-LF-DEATH-EXIT-DT
  5788             MOVE WS-LF-CURRENT-STATUS
  5789                                  TO  CM-LF-CURRENT-STATUS
  5790             MOVE WS-LF-STATUS-AT-DEATH
  5791                                  TO  CM-LF-STATUS-AT-DEATH.
  5792
  5793     IF ASSOCIATED-ERCOMM
  5794        MOVE ' '                  TO CM-COMP-EXCP-SW
  5795        PERFORM 2270-DELETE-ERCOMM THRU 2270-EXIT.
  5796
  5797     ADD 1 TO WS-ACCT-READS.
  5798     PERFORM 2200-MATCH-ACCT THRU 2200-EXIT.
  5799
  5800     PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT.
  5801
  5802     MOVE WS-CURRENT-DATE         TO DC-GREG-DATE-1-EDIT.
  5803     MOVE '2'                     TO DC-OPTION-CODE.
  5804     PERFORM 7100-DATE-RTN THRU 7100-EXIT.
  5805
  5806*****COPY ELCCRTM2.
  5807
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 119
* EL331.cbl
  5808     IF WS-BEFORE-CERT NOT EQUAL CERTIFICATE-MASTER
  5809        MOVE DC-BIN-DATE-1        TO CM-LAST-MONTH-END
  5810        REWRITE CERTIFICATE-MASTER.
  5811
  5812     IF CM-STAT-1 NOT EQUAL ZERO
  5813          MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  5814          MOVE 'ERROR OCCURED REWRITE - ELCERT'
  5815                                  TO  WS-ABEND-MESSAGE
  5816         GO TO ABEND-PGM.
  5817
  5818     MOVE ZERO                    TO  WS-UPDATE-SW.
  5819
  5820 2600-EXIT.
  5821      EXIT.
  5822
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 120
* EL331.cbl
  5824***********************************************************
  5825*  2800-ADD-NEW-CERT                                      *
  5826***********************************************************
  5827*  REWRITE THE UPDATED ONLINE CERTIFICATE MASTER RECORD   *
  5828***********************************************************
  5829
  5830 2800-ADD-NEW-CERT.
  5831
  5832     MOVE SPACES                 TO CERTIFICATE-MASTER.
  5833
  5834*****COPY ELCCRTM1.
  5835
  5836     PERFORM 2830-MOVE-DATA      THRU 2830-EXIT.
  5837     PERFORM 2820-BUILD-NEW-KEY  THRU 2820-EXIT.
  5838
  5839     ADD 1 TO WS-ACCT-READS.
  5840     PERFORM 2200-MATCH-ACCT THRU 2200-EXIT.
  5841
  5842     MOVE WS-CURRENT-DATE         TO DC-GREG-DATE-1-EDIT.
  5843     MOVE '2'                     TO DC-OPTION-CODE.
  5844     PERFORM 7100-DATE-RTN THRU 7100-EXIT.
  5845     MOVE DC-BIN-DATE-1           TO CM-LAST-MONTH-END
  5846     PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT.
  5847
  5848     WRITE CERTIFICATE-MASTER.
  5849
  5850     IF CM-STATUS EQUAL '22'
  5851         NEXT SENTENCE
  5852      ELSE
  5853       IF CM-STAT-1  NOT EQUAL ZERO
  5854         MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  5855         MOVE 'ERROR OCCURED WRITE - ELCERT'
  5856                                 TO  WS-ABEND-MESSAGE
  5857         GO TO ABEND-PGM.
  5858
  5859     MOVE  WS-ONL-RECORD         TO CERTIFICATE-MASTER.
  5860
  5861 2800-EXIT.
  5862      EXIT.
  5863
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 121
* EL331.cbl
  5865***********************************************************
  5866*  2820-BUILD-NEW-KEY                                     *
  5867***********************************************************
  5868*  BUILD PRIMARY AND ALL ALTERNATE KEY FIELDS IN ONLINE   *
  5869*  CERT MASTER FROM BATCH CERT MASTER.                    *
  5870***********************************************************
  5871
  5872 2820-BUILD-NEW-KEY.
  5873
  5874     MOVE DTE-CLASIC-COMPANY-CD  TO CM-COMPANY-CD
  5875                                    CM-COMPANY-CD-A1
  5876                                    CM-COMPANY-CD-A2
  5877                                    CM-COMPANY-CD-A4
  5878                                    CM-COMPANY-CD-A5.
  5879
  5880     MOVE CR-CARRIER             TO CM-CARRIER.
  5881     MOVE CR-GROUPING            TO CM-GROUPING.
  5882     MOVE CR-STATE               TO CM-STATE.
  5883     MOVE CR-ACCOUNT             TO CM-ACCOUNT.
  5884     MOVE CR-CERT-NO             TO CM-CERT-NO
  5885                                    CM-CERT-NO-A4.
  5886
  5887     MOVE BIN-CR-DT              TO CM-CERT-EFF-DT.
  5888
  5889     IF CR-LNAME EQUAL SPACES
  5890         MOVE CR-CERT-NO         TO CR-LNAME.
  5891
  5892     MOVE CR-INIT                TO CM-INSURED-INITIAL2.
  5893     MOVE CR-1ST-INITIAL         TO CM-INSURED-INITIAL1.
  5894     MOVE CR-LNAME               TO CM-INSURED-LAST-NAME.
  5895
  5896     IF CR-MEMBER-NO NOT = SPACES
  5897         MOVE CR-MEMBER-NO       TO CM-MEMBER-NO.
  5898
  5899     INSPECT CR-MEMBER-NO
  5900         REPLACING ALL ' ' BY '0'.
  5901
  5902     IF CR-MEMBER-NO = ZEROS
  5903       IF DTE-CLIENT = 'MON'
  5904           MOVE CR-LNAME            TO WK-LAST-NAME
  5905           MOVE SPACES              TO WK-MEMB-ACCT
  5906                                       ERROR-FLAG
  5907           MOVE 1                   TO ACCT-SUB
  5908           PERFORM 2825-FILL-ACCT THRU 2825-EXIT
  5909               VARYING LST-NM-SUB FROM 1 BY 1
  5910                 UNTIL LST-NM-SUB GREATER 12
  5911           MOVE WK-MEMB-ACCT        TO CM-MEMB-ACCOUNT
  5912           MOVE CR-YR               TO CM-INSURED-INITIALS-A5
  5913           MOVE CR-MO               TO CM-PART-LAST-NAME-A5
  5914        ELSE
  5915           MOVE CR-STATE            TO CM-MEMB-STATE
  5916           MOVE CR-ACCT-PRIME       TO CM-MEMB-ACCOUNT
  5917           MOVE CR-LNAME            TO CM-PART-LAST-NAME-A5
  5918           MOVE CM-INSURED-INITIALS TO CM-INSURED-INITIALS-A5.
  5919
  5920     IF CR-SOC-SEC NOT = SPACES
  5921         MOVE CR-SOC-SEC         TO CM-SOC-SEC-NO.
  5922
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 122
* EL331.cbl
  5923     INSPECT CR-SOC-SEC
  5924         REPLACING ALL ' ' BY '0'.
  5925
  5926     IF CR-SOC-SEC = ZEROS
  5927         MOVE CR-STATE           TO CM-SSN-STATE
  5928         MOVE CR-ACCT-PRIME      TO CM-SSN-ACCOUNT
  5929         MOVE CR-LNAME           TO CM-PART-LAST-NAME-A2
  5930         MOVE CM-INSURED-INITIALS TO CM-INSURED-INITIALS-A2.
  5931
  5932 2820-EXIT.
  5933      EXIT.
  5934
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 123
* EL331.cbl
  5936 2825-FILL-ACCT.
  5937     IF ACCT-SUB GREATER 6
  5938         MOVE 12            TO LST-NM-SUB
  5939         GO TO 2825-EXIT.
  5940     IF WK-LAST-NAME-CHAR (LST-NM-SUB) NUMERIC
  5941         MOVE 'A'           TO ERROR-FLAG
  5942         GO TO 2825-EXIT.
  5943     IF WK-LAST-NAME-CHAR (LST-NM-SUB) ALPHABETIC AND
  5944        WK-LAST-NAME-CHAR (LST-NM-SUB) NOT = SPACE
  5945         MOVE WK-LAST-NAME-CHAR (LST-NM-SUB)
  5946                            TO WK-MEMB-ACCT-CHAR (ACCT-SUB)
  5947         ADD 1 TO ACCT-SUB.
  5948
  5949 2825-EXIT.
  5950      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 124
* EL331.cbl
  5952***********************************************************
  5953*  2830-MOVE-DATA                                         *
  5954***********************************************************
  5955*                                                         *
  5956*  BUILD ONLINE CERT MASTER RECORD FROM THE BATCH CERT    *
  5957*  MASTER RECORD.                                         *
  5958*                                                         *
  5959***********************************************************
  5960****  STRAIGHT MOVES FROM BATCH CERT TO ONLINE CERT    ****
  5961***********************************************************
  5962
  5963 2830-MOVE-DATA.
  5964
  5965     MOVE 'CM'                   TO CM-RECORD-ID.
  5966     MOVE LOW-VALUES             TO CM-STATUS-DATA.
  5967     MOVE SPACE                  TO CM-CLAIM-INTERFACE-SW.
  5968     MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
  5969                                    CM-CREDIT-INTERFACE-SW-2.
  5970     MOVE ZERO                   TO CM-CLAIM-ATTACHED-COUNT
  5971                                    CM-LOAN-BALANCE
  5972                                    CM-LF-REMAINING-AMT.
  5973
  5974     MOVE CR-LFRFND              TO CM-LF-ITD-CANCEL-AMT.
  5975     MOVE CR-DTHAMT              TO CM-LF-ITD-DEATH-AMT.
  5976     MOVE CR-AHRFND              TO CM-AH-ITD-CANCEL-AMT.
  5977     MOVE CR-RATING-CLASS        TO CM-RATE-CLASS.
  5978     if dte-client = 'AHL'
  5979        move cr-lf-class-cd      to cm-lf-class-cd
  5980        move cr-ah-class-cd      to cm-ah-class-cd
  5981     end-if
  5982     MOVE CR-AH-DEV-CODE         TO CM-AH-DEV-CODE.
  5983     MOVE CR-LF-DEV-CODE         TO CM-LF-DEV-CODE.
  5984     MOVE CR-AH-DEV-PCT          TO CM-AH-DEV-PCT.
  5985     MOVE CR-LF-DEV-PCT          TO CM-LF-DEV-PCT.
  5986     MOVE CR-APR                 TO CM-LOAN-APR.
  5987     MOVE CR-PMT-EXTENSION-DAYS  TO CM-PMT-EXTENSION-DAYS
  5988     MOVE CR-PMT-FREQ            TO CM-PAY-FREQUENCY.
  5989     MOVE CR-LOAN-TERM           TO CM-LOAN-TERM
  5990     MOVE CR-LF-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
  5991     MOVE CR-LOAN-OFFICER        TO CM-LOAN-OFFICER.
  5992     MOVE CR-JOINT-NAME          TO CM-JOINT-INSURED-NAME.
  5993     MOVE CR-FNAME               TO CM-INSURED-FIRST-NAME.
  5994     MOVE CR-CLP-STATE           TO CM-CLP-STATE
  5995     if dte-client not = 'AHL'
  5996        MOVE CR-USER-FUTURE         TO CM-USER-RESERVED
  5997     end-if
  5998
  5999*    IF CR-CLAIM-DEDUCT-WITHHELD NUMERIC
  6000*        MOVE CR-CLAIM-DEDUCT-WITHHELD
  6001*                                 TO CM-CLAIM-DEDUCT-WITHHELD
  6002*    ELSE
  6003*        MOVE ZEROS               TO CM-CLAIM-DEDUCT-WITHHELD.
  6004*    IF CR-CANCEL-DEDUCT-WITHHELD NUMERIC
  6005*        MOVE CR-CANCEL-DEDUCT-WITHHELD
  6006*                                 TO CM-CANCEL-DEDUCT-WITHHELD
  6007*    ELSE
  6008*        MOVE ZEROS               TO CM-CANCEL-DEDUCT-WITHHELD.
  6009
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 125
* EL331.cbl
  6010     MOVE CR-CSR-CODE             TO CM-CSR-CODE.
  6011     MOVE CR-USER-CODE            TO CM-USER-FIELD.
  6012     MOVE CR-UNDERWRITING-CODE    TO CM-UNDERWRITING-CODE.
  6013
  6014     IF CR-ADDL-CLP NOT NUMERIC
  6015        MOVE ZEROS                TO CR-ADDL-CLP
  6016     END-IF
  6017     IF CR-LF-CLP NOT NUMERIC
  6018        MOVE ZEROS                TO CR-LF-CLP
  6019     END-IF
  6020     IF CR-AH-CLP NOT NUMERIC
  6021        MOVE ZEROS                TO CR-AH-CLP
  6022     END-IF
  6023     IF DTE-CLIENT = 'DCC'
  6024        MOVE CR-ADDL-CLP         TO CM-ADDL-CLP
  6025        MOVE CR-LF-CLP           TO CM-LF-CLP
  6026        MOVE CR-AH-CLP           TO CM-AH-CLP
  6027        MOVE CR-DDF-IU-RATE-UP   TO CM-DDF-IU-RATE-UP
  6028     END-IF
  6029
  6030     IF CR-NH-INT-ON-REF     NUMERIC
  6031         MOVE CR-NH-INT-ON-REF    TO CM-NH-INT-ON-REFS
  6032     ELSE
  6033         MOVE ZEROS               TO CM-NH-INT-ON-REFS.
  6034
  6035     IF DTE-CLIENT EQUAL 'FIA'
  6036         INSPECT CR-LNAME REPLACING ALL '0' BY ' '
  6037         INSPECT CR-LNAME REPLACING ALL '{' BY ' '.
  6038
  6039     IF CR-LNAME IS EQUAL TO SPACES
  6040         NEXT SENTENCE
  6041     ELSE
  6042         MOVE CR-LNAME          TO CM-INSURED-LAST-NAME.
  6043
  6044     IF CR-MEMBER-NO IS EQUAL TO SPACES
  6045         MOVE CR-STATE          TO CM-MEMB-STATE
  6046         MOVE CR-ACCT-PRIME     TO CM-MEMB-ACCOUNT
  6047         MOVE CR-LNAME          TO CM-PART-LAST-NAME-A5
  6048         MOVE CM-INSURED-INITIALS TO CM-INSURED-INITIALS-A5
  6049     ELSE
  6050         MOVE CR-MEMBER-NO      TO CM-MEMBER-NO.
  6051
  6052     IF CM-POLICY-FORM-NO EQUAL SPACES
  6053         MOVE CR-POLICY-FORM-NO  TO CM-POLICY-FORM-NO.
  6054
  6055     IF CR-IND-GRP EQUAL '1' OR 'I'
  6056         MOVE 'I'                TO CM-IND-GRP-TYPE
  6057      ELSE
  6058         MOVE 'G'                TO CM-IND-GRP-TYPE.
  6059
  6060     MOVE SPACE                  TO CM-PAYMENT-MODE.
  6061     MOVE WS-CM-ENTRY-BATCH      TO CM-ENTRY-BATCH.
  6062     MOVE CR-REIN-TABLE          TO CM-REIN-TABLE.
  6063     MOVE CR-REIN-SPEC           TO CM-SPECIAL-REIN-CODE.
  6064
  6065     MOVE SPACE                  TO CM-SKIP-CODE.
  6066     IF CR-SKIP = 01
  6067        MOVE '1'                 TO CM-SKIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 126
* EL331.cbl
  6068     IF CR-SKIP = 02
  6069        MOVE '2'                 TO CM-SKIP-CODE.
  6070     IF CR-SKIP = 03
  6071        MOVE '3'                 TO CM-SKIP-CODE.
  6072     IF CR-SKIP = 04
  6073        MOVE '4'                 TO CM-SKIP-CODE.
  6074     IF CR-SKIP = 05
  6075        MOVE '5'                 TO CM-SKIP-CODE.
  6076     IF CR-SKIP = 06
  6077        MOVE '6'                 TO CM-SKIP-CODE.
  6078     IF CR-SKIP = 07
  6079        MOVE '7'                 TO CM-SKIP-CODE.
  6080     IF CR-SKIP = 08
  6081        MOVE '8'                 TO CM-SKIP-CODE.
  6082     IF CR-SKIP = 09
  6083        MOVE '9'                 TO CM-SKIP-CODE.
  6084     IF CR-SKIP = 10
  6085        MOVE 'A'                 TO CM-SKIP-CODE.
  6086     IF CR-SKIP = 11
  6087        MOVE 'X'                 TO CM-SKIP-CODE.
  6088
  6089     MOVE ZERO                   TO CM-LIFE-COMM-PCT
  6090                                    CM-AH-COMM-PCT.
  6091
  6092     MOVE +1                     TO WS-LEVEL-INDEX.
  6093
  6094 2830-LOAD-COMM-PCTS.
  6095
  6096     IF (CR-AGT-TYPE (WS-LEVEL-INDEX) EQUAL 'C' OR 'D'
  6097                  OR 'F' OR 'S')
  6098         MOVE CR-LCOM-L (WS-LEVEL-INDEX)  TO CM-LIFE-COMM-PCT
  6099         MOVE CR-LCOM-AH (WS-LEVEL-INDEX) TO CM-AH-COMM-PCT
  6100         GO TO 2830-COMM-LOAD-END
  6101     ELSE
  6102         ADD +1 TO WS-LEVEL-INDEX
  6103         IF WS-LEVEL-INDEX GREATER +10
  6104             NEXT SENTENCE
  6105         ELSE
  6106              GO TO 2830-LOAD-COMM-PCTS.
  6107
  6108 2830-COMM-LOAD-END.
  6109
  6110**************************************
  6111*  PREMIUM TYPE (2) EQUAL O.B. COVERAGE *
  6112*  PREMIUM TYPE (3) EQUAL OPEN END   *
  6113**************************************
  6114***********************************************************
  6115****  MOVES FROM BATCH CERT TO ONLINE CERT ONLY FOR    ****
  6116****  SINGLE PREMIUM CERTS.                            ****
  6117***********************************************************
  6118
  6119     IF MATCHED-REC
  6120       AND CM-PREMIUM-TYPE EQUAL ('2' OR '3')
  6121          GO TO 2830-OB-ADJUST-END.
  6122
  6123     IF MATCHED-REC   AND
  6124       (CR-LFPRM + CR-AHPRM) LESS +.05
  6125          GO TO 2830-OB-ADJUST-END.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 127
* EL331.cbl
  6126
  6127     MOVE CR-AGE                 TO CM-INSURED-ISSUE-AGE.
  6128     MOVE CR-JOINT-AGE           TO CM-INSURED-JOINT-AGE
  6129     MOVE CR-SEX                 TO CM-INSURED-SEX.
  6130     MOVE CR-LFTYP               TO CM-LF-BENEFIT-CD.
  6131     MOVE CR-LF-TERM             TO CM-LF-ORIG-TERM.
  6132     MOVE CR-LFAMT               TO CM-LF-BENEFIT-AMT.
  6133     MOVE CR-LFAMT-ALT           TO CM-LF-ALT-BENEFIT-AMT.
  6134     MOVE CR-LFPRM               TO CM-LF-PREMIUM-AMT.
  6135     MOVE CR-LFPRM-ALT           TO CM-LF-ALT-PREMIUM-AMT.
  6136     MOVE CR-LF-NSP-PRM          TO CM-LF-NSP-PREMIUM-AMT.
  6137     MOVE CR-AH-NSP-PRM          TO CM-AH-NSP-PREMIUM-AMT.
  6138     MOVE CR-LFPRM-RATE          TO CM-LF-PREMIUM-RATE.
  6139     MOVE CR-LFPRM-RATE-ALT      TO CM-LF-ALT-PREMIUM-RATE.
  6140     MOVE CR-LF-CRIT-PERIOD      TO CM-LF-CRITICAL-PERIOD.
  6141     MOVE CR-AH-CRIT-PERIOD      TO CM-AH-CRITICAL-PERIOD.
  6142     MOVE CR-AHTYP               TO CM-AH-BENEFIT-CD.
  6143     MOVE CR-AH-TERM             TO CM-AH-ORIG-TERM.
  6144     MOVE CR-AHAMT               TO CM-AH-BENEFIT-AMT.
  6145     MOVE CR-AHPRM               TO CM-AH-PREMIUM-AMT.
  6146     MOVE CR-AHPRM-RATE          TO CM-AH-PREMIUM-RATE.
  6147     MOVE CR-DISAMT              TO CM-AH-ITD-AH-PMT.
  6148     MOVE '1'                    TO CM-PREMIUM-TYPE.
  6149
  6150     IF DTE-CLIENT NOT = 'DCC'
  6151        MOVE ZERO                TO CM-LIVES
  6152     END-IF
  6153     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  6154     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  6155
  6156 2830-LF-OB-ADJUST.
  6157
  6158******************************************************************
  6159****  SEARCH BENEFIT TABLE TO DETERMINE BENEFITS PREMIUM TYPE  ***
  6160******************************************************************
  6161
  6162     IF CM-LF-BENEFIT-CD EQUAL ZERO
  6163        GO TO 2830-AH-OB-ADJUST.
  6164
  6165     IF CLAS-INDEXL GREATER CLAS-MAXL
  6166         GO TO 2830-AH-OB-ADJUST.
  6167
  6168     IF CM-LF-BENEFIT-CD EQUAL CLAS-I-BEN (CLAS-INDEXL)
  6169         PERFORM  4100-REVIEW-LIFE     THRU 4100-LF-EXIT
  6170            GO TO 2830-AH-OB-ADJUST.
  6171
  6172     ADD +1                      TO CLAS-INDEXL.
  6173     GO TO 2830-LF-OB-ADJUST.
  6174
  6175 2830-AH-OB-ADJUST.
  6176
  6177******************************************************************
  6178****  SEARCH BENEFIT TABLE TO DETERMINE BENEFITS PREMIUM TYPE  ***
  6179******************************************************************
  6180
  6181     IF CM-AH-BENEFIT-CD EQUAL ZERO
  6182        GO TO 2830-OB-ADJUST-END.
  6183
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 128
* EL331.cbl
  6184     IF CLAS-INDEXA GREATER CLAS-MAXA
  6185         GO TO 2830-OB-ADJUST-END.
  6186
  6187     IF CM-AH-BENEFIT-CD EQUAL CLAS-I-BEN (CLAS-INDEXA)
  6188         PERFORM 4100-REVIEW-AH  THRU 4100-AH-EXIT
  6189            GO TO 2830-OB-ADJUST-END.
  6190
  6191     ADD +1                      TO CLAS-INDEXA.
  6192     GO TO 2830-AH-OB-ADJUST.
  6193
  6194 2830-OB-ADJUST-END.
  6195
  6196
  6197 2830-SUM-ADJUST-END.
  6198
  6199     IF CR-AH-LUMP-SUM-DISAB
  6200         MOVE CR-DTHAMT         TO CM-AH-ITD-LUMP-PMT
  6201     ELSE
  6202         MOVE ZEROS             TO CM-AH-ITD-LUMP-PMT.
  6203
  6204     MOVE 'L'                   TO DC-OPTION-CODE.
  6205     MOVE LOW-VALUE             TO CM-AH-PAID-THRU-DT.
  6206     MOVE CR-DIS-PTO-DT         TO DC-GREG-DATE-CYMD.
  6207
  6208     IF CR-DIS-PTO-DT NOT EQUAL ZERO
  6209         PERFORM 7100-DATE-RTN THRU 7100-EXIT
  6210         IF NO-CONVERSION-ERROR
  6211            MOVE DC-BIN-DATE-1  TO CM-AH-PAID-THRU-DT.
  6212
  6213     MOVE LOW-VALUE             TO CM-AH-CANCEL-DT
  6214                                   CM-LF-CANCEL-DT.
  6215
  6216     MOVE 'L'                   TO DC-OPTION-CODE.
  6217     MOVE CR-LF-CANC-DT         TO DC-GREG-DATE-CYMD.
  6218
  6219     IF CR-LF-CANC-DT NOT EQUAL ZERO
  6220         PERFORM 7100-DATE-RTN  THRU   7100-EXIT
  6221         IF NO-CONVERSION-ERROR
  6222            MOVE DC-BIN-DATE-1   TO CM-LF-CANCEL-DT.
  6223
  6224     MOVE 'L'                    TO DC-OPTION-CODE.
  6225     MOVE CR-AH-CANC-DT          TO DC-GREG-DATE-CYMD.
  6226
  6227     IF CR-AH-CANC-DT NOT EQUAL ZERO
  6228         PERFORM 7100-DATE-RTN  THRU   7100-EXIT
  6229         IF NO-CONVERSION-ERROR
  6230            MOVE DC-BIN-DATE-1   TO CM-AH-CANCEL-DT.
  6231
  6232     MOVE LOW-VALUE              TO CM-AH-SETTLEMENT-DT.
  6233
  6234     IF CR-AH-LUMP-SUM-DISAB   OR
  6235        CR-AH-STATUS-AT-CANCEL EQUAL 6
  6236          IF CR-DIS-DT NOT EQUAL ZERO
  6237             MOVE CR-DIS-DT      TO DC-GREG-DATE-CYMD
  6238             MOVE 'L'            TO DC-OPTION-CODE
  6239             PERFORM 7100-DATE-RTN  THRU   7100-EXIT
  6240              IF NO-CONVERSION-ERROR
  6241                  MOVE DC-BIN-DATE-1 TO CM-AH-SETTLEMENT-DT.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 129
* EL331.cbl
  6242
  6243     MOVE CR-ENTRY-STATUS        TO CM-ENTRY-STATUS.
  6244
  6245     MOVE CR-LF-CURRENT-STATUS   TO  CM-LF-CURRENT-STATUS.
  6246     MOVE CR-LF-STATUS-AT-DEATH  TO  CM-LF-STATUS-AT-DEATH.
  6247     MOVE CR-LF-STATUS-AT-CANCEL TO  CM-LF-STATUS-AT-CANCEL.
  6248
  6249     MOVE CR-AH-CURRENT-STATUS   TO CM-AH-CURRENT-STATUS.
  6250     MOVE CR-AH-STATUS-AT-SETTLEMENT
  6251                                 TO CM-AH-STATUS-AT-SETTLEMENT.
  6252     MOVE CR-AH-STATUS-AT-CANCEL TO CM-AH-STATUS-AT-CANCEL.
  6253
  6254     MOVE 'L'                    TO DC-OPTION-CODE.
  6255     MOVE LOW-VALUES             TO CM-LF-DEATH-DT.
  6256     MOVE CR-DTH-DT              TO DC-GREG-DATE-CYMD.
  6257     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6258     IF NO-CONVERSION-ERROR
  6259         MOVE DC-BIN-DATE-1      TO CM-LF-DEATH-DT
  6260     ELSE
  6261         MOVE LOW-VALUES         TO CM-LF-DEATH-DT.
  6262
  6263     IF CR-LF-EXPIRE-DATE NOT NUMERIC
  6264         MOVE ZERO               TO CR-LF-EXPIRE-DATE.
  6265
  6266     MOVE 'L'                    TO DC-OPTION-CODE.
  6267     MOVE CR-LF-EXPIRE-DATE      TO DC-GREG-DATE-CYMD.
  6268
  6269     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6270     IF NO-CONVERSION-ERROR
  6271         MOVE DC-BIN-DATE-1      TO CM-LF-LOAN-EXPIRE-DT
  6272     ELSE
  6273         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
  6274
  6275     IF CR-AH-EXPIRE-DATE NOT NUMERIC
  6276         MOVE ZERO               TO CR-AH-EXPIRE-DATE.
  6277
  6278     MOVE 'L'                    TO DC-OPTION-CODE.
  6279     MOVE CR-AH-EXPIRE-DATE      TO DC-GREG-DATE-CYMD
  6280     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6281     IF NO-CONVERSION-ERROR
  6282         MOVE DC-BIN-DATE-1      TO CM-AH-LOAN-EXPIRE-DT
  6283     ELSE
  6284         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
  6285
  6286     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  6287         MOVE ZERO               TO CR-LOAN-1ST-PMT-DT.
  6288
  6289     MOVE '3'                    TO DC-OPTION-CODE.
  6290     MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD.
  6291     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6292     IF NO-CONVERSION-ERROR
  6293         MOVE DC-BIN-DATE-1      TO CM-LOAN-1ST-PMT-DT
  6294     ELSE
  6295         MOVE LOW-VALUES         TO CM-LOAN-1ST-PMT-DT.
  6296
  6297     MOVE CR-LAST-ADD-ON-DT      TO CM-LAST-ADD-ON-DT.
  6298
  6299     MOVE 'L'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 130
* EL331.cbl
  6300     MOVE CR-ENTRY-DATE          TO DC-GREG-DATE-CYMD.
  6301     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6302     IF NO-CONVERSION-ERROR
  6303         MOVE DC-BIN-DATE-1      TO CM-ENTRY-DT
  6304     ELSE
  6305         MOVE LOW-VALUES         TO CM-ENTRY-DT.
  6306
  6307     IF CR-LF-CANCEL-EXIT-DATE NOT EQUAL ZEROS
  6308         MOVE CR-LF-CANCEL-EXIT-DATE TO DC-GREG-DATE-CYMD
  6309         MOVE  'L'                   TO DC-OPTION-CODE
  6310         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6311         IF NO-CONVERSION-ERROR
  6312             MOVE DC-BIN-DATE-1      TO CM-LF-CANCEL-EXIT-DT.
  6313
  6314     IF CR-AH-CANCEL-EXIT-DATE NOT EQUAL ZEROS
  6315         MOVE CR-AH-CANCEL-EXIT-DATE TO DC-GREG-DATE-CYMD
  6316         MOVE  'L'                   TO DC-OPTION-CODE
  6317         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6318         IF NO-CONVERSION-ERROR
  6319             MOVE DC-BIN-DATE-1      TO CM-AH-CANCEL-EXIT-DT.
  6320
  6321     IF CR-LF-CLAIM-EXIT-DATE NOT EQUAL ZEROS
  6322         MOVE CR-LF-CLAIM-EXIT-DATE  TO DC-GREG-DATE-CYMD
  6323         MOVE  'L'                  TO DC-OPTION-CODE
  6324         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6325         IF NO-CONVERSION-ERROR
  6326             MOVE DC-BIN-DATE-1     TO CM-LF-DEATH-EXIT-DT.
  6327
  6328     IF CR-AH-SETTLEMENT-EXIT-DATE NOT EQUAL ZEROS
  6329         MOVE CR-AH-SETTLEMENT-EXIT-DATE TO DC-GREG-DATE-CYMD
  6330         MOVE  'L'                  TO DC-OPTION-CODE
  6331         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6332         IF NO-CONVERSION-ERROR
  6333             MOVE DC-BIN-DATE-1     TO CM-AH-SETTLEMENT-EXIT-DT.
  6334
  6335 2830-EXIT.
  6336      EXIT.
  6337
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 131
* EL331.cbl
  6339 4000-EXPIRE-DATE.
  6340
  6341     IF CM-PREMIUM-TYPE  EQUAL '1'
  6342         GO TO 4099-EXIT.
  6343
  6344     IF CM-LF-ORIG-TERM  NOT NUMERIC
  6345         GO TO 4020-CHECK-AH.
  6346
  6347     IF CM-LF-ORIG-TERM  GREATER  +1
  6348         NEXT SENTENCE
  6349     ELSE
  6350         GO TO 4020-CHECK-AH.
  6351
  6352     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6353     MOVE CM-LF-ORIG-TERM        TO  DC-ELAPSED-MONTHS.
  6354     MOVE ZEROS                  TO  DC-ODD-DAYS-OVER.
  6355     MOVE ZEROS                  TO  DC-ELAPSED-DAYS.
  6356     MOVE '6'                    TO  DC-OPTION-CODE.
  6357
  6358     PERFORM 7100-DATE-RTN  THRU  7100-EXIT.
  6359
  6360     IF NO-CONVERSION-ERROR
  6361         MOVE DC-BIN-DATE-2      TO  CM-LF-LOAN-EXPIRE-DT
  6362     ELSE
  6363         MOVE LOW-VALUES         TO  CM-LF-LOAN-EXPIRE-DT.
  6364
  6365 4020-CHECK-AH.
  6366
  6367     IF CM-AH-ORIG-TERM  NOT NUMERIC
  6368         GO TO 4099-EXIT.
  6369
  6370     IF CM-AH-ORIG-TERM  GREATER  +1
  6371         NEXT SENTENCE
  6372     ELSE
  6373         GO TO 4099-EXIT.
  6374
  6375     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6376     MOVE CM-AH-ORIG-TERM        TO  DC-ELAPSED-MONTHS.
  6377     MOVE ZEROS                  TO  DC-ODD-DAYS-OVER.
  6378     MOVE ZEROS                  TO  DC-ELAPSED-DAYS.
  6379     MOVE '6'                    TO  DC-OPTION-CODE.
  6380
  6381     PERFORM 7100-DATE-RTN  THRU  7100-EXIT.
  6382
  6383     IF NO-CONVERSION-ERROR
  6384         MOVE DC-BIN-DATE-2      TO  CM-AH-LOAN-EXPIRE-DT
  6385     ELSE
  6386         MOVE LOW-VALUES         TO  CM-AH-LOAN-EXPIRE-DT.
  6387
  6388 4099-EXIT.
  6389     EXIT.
  6390******************************************************************
  6391****  SEARCH BENEFIT TABLE TO DETERMINE IF SUMMARY COVERAGE    ***
  6392******************************************************************
  6393
  6394 4100-REVIEW-LIFE.
  6395
  6396     IF CLAS-I-BAL (CLAS-INDEXL) EQUAL 'B'
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 132
* EL331.cbl
  6397        MOVE '2'                 TO CM-PREMIUM-TYPE
  6398        GO TO 4100-LF-EXIT.
  6399
  6400     IF ((CR-LFTYP NOT EQUAL ZERO) AND
  6401         (CLAS-I-BAL (CLAS-INDEXL) EQUAL 'Z'))
  6402         NEXT SENTENCE
  6403      ELSE
  6404         GO TO 4100-LF-EXIT.
  6405
  6406     IF CR-LIVES NOT NUMERIC
  6407         MOVE ZERO               TO CR-LIVES.
  6408     IF CR-SUM-CAN-CNT-ITD NOT NUMERIC
  6409         MOVE ZERO               TO CR-SUM-CAN-CNT-ITD.
  6410
  6411     COMPUTE CM-LIVES EQUAL
  6412           CR-LIVES - CR-SUM-CAN-CNT-ITD.
  6413
  6414 4100-LF-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 133
* EL331.cbl
  6416 4100-REVIEW-AH.
  6417     IF CLAS-I-BAL (CLAS-INDEXA) EQUAL 'B'
  6418        MOVE '2'             TO CM-PREMIUM-TYPE
  6419        GO TO 4100-AH-EXIT.
  6420
  6421     IF ((CR-AHTYP NOT EQUAL ZERO) AND
  6422         (CLAS-I-BAL (CLAS-INDEXA) EQUAL 'Z'))
  6423         NEXT SENTENCE
  6424      ELSE
  6425         GO TO 4100-AH-EXIT.
  6426
  6427     IF CR-LIVES NOT NUMERIC
  6428         MOVE ZERO               TO CR-LIVES.
  6429     IF CR-SUM-CAN-CNT-ITD NOT NUMERIC
  6430         MOVE ZERO               TO CR-SUM-CAN-CNT-ITD.
  6431
  6432     COMPUTE CM-LIVES EQUAL
  6433           CR-LIVES - CR-SUM-CAN-CNT-ITD.
  6434
  6435 4100-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 134
* EL331.cbl
  6438****************************************************************
  6439*  7000-INITIALIZE                                             *
  6440****************************************************************
  6441*                                                              *
  6442*  1) IF CLASIC CLAIMS SYSTEM PRESENT   OPEN INPUT (ELMSTR5)   *
  6443*     ALTERNATE PATH (5) OF CLAIM MASTER FILE ACCESSED THRU    *
  6444*     CL-CONTROL-BY-CERT-NO.                                   *
  6445*                                                              *
  6446*  1A) IF CLASIC CLAIMS SYSTEM PRESENT  OPEN INPUT (ELRETR5)   *
  6447*     ALTERNATE PATH (5) OF RETRIEVE MSTR FILE ACCESSED THRU   *
  6448*     RL-CONTROL-BY-CERT-NO.                                   *
  6449*                                                              *
  6450*  2) OPEN I/O (ELCERTF)   ONLINE CERTIFICATE MASTER FILE      *
  6451*     ACCESSED THRU CM-CONTROL-PRIMARY AND ISSUE START TO SET  *
  6452*     VSAM POINTER.                                            *
  6453*                                                              *
  6454*  3) OPEN I/O (ERMAIL)   CERTIFICATE MASTER NAME AND ADDRESS  *
  6455*     FILE ACCESSED THRU MA-CONTROL-PRIMARY.                   *
  6456*                                                              *
  6457*  4) OPEN INPUT (ECSCRT01)   BATCH CERTIFICATE MASTER FILE.   *
  6458*                                                              *
  6459*  5) OPEN OUTPUT (PRNTR)   PRINT FILE.                        *
  6460*                                                              *
  6461*  6) OPEN INPUT (ERACCT)   ACCOUNT MASTER FILE ACCESSED THRU  *
  6462*     AM-CONTROL-PRIMARY AND ISSUE START TO SET VSAM POINTER.  *
  6463*                                                              *
  6464*  7) OPEN I/O (ERCOMM)   CERTIFICATE MASTER COMMISSION STRUC- *
  6465*     TURE ACCESSED THRU CE-CONTROL-PRIMARY. THE COMMISSION    *
  6466*     STRUCTURE OF THE CERTIFICATE VARIES FROM THE COMMISSION  *
  6467*     STRUCTURE FOR THE ASSOCIATED ACCOUNT MASTER.             *
  6468*                                                              *
  6469****************************************************************
  6470
  6471 7000-INITIALIZE.
  6472
  6473     IF DTE-SYS-E-CLASIC-CLAIMS EQUAL 'Y'
  6474         OPEN INPUT  ELMSTR5
  6475         IF (CL-STAT-1  NOT EQUAL '0') AND
  6476            (CL-STATUS NOT EQUAL '97')
  6477             MOVE 'ERROR OCCURED OPEN - ELMSTR'
  6478                                 TO  WS-ABEND-MESSAGE
  6479             MOVE CL-STATUS      TO  WS-ABEND-FILE-STATUS
  6480             GO TO ABEND-PGM
  6481         END-IF
  6482         OPEN INPUT  ELRETR5
  6483         IF ELRETR5-FILE-STATUS NOT = '00' AND '97'
  6484             MOVE 'ERROR OCCURRED OPEN - ELRETR'
  6485                                      TO WS-ABEND-MESSAGE
  6486             MOVE ELRETR5-FILE-STATUS TO WS-ABEND-FILE-STATUS
  6487             GO TO ABEND-PGM.
  6488
  6489     OPEN I-O    ELCERTF.
  6490
  6491     IF (CM-STAT-1  NOT EQUAL '0') AND
  6492        (CM-STATUS NOT EQUAL '97')
  6493         MOVE 'ERROR OCCURED OPEN - ELCERT'
  6494                                TO  WS-ABEND-MESSAGE
  6495         MOVE CM-STATUS         TO  WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 135
* EL331.cbl
  6496         GO TO ABEND-PGM.
  6497
  6498     MOVE LOW-VALUE             TO CM-CONTROL-PRIMARY.
  6499     MOVE DTE-CLASIC-COMPANY-CD TO CM-COMPANY-CD.
  6500
  6501     START ELCERTF
  6502            KEY NOT LESS CM-CONTROL-PRIMARY.
  6503
  6504     IF CM-STAT-1  NOT EQUAL '0'
  6505         MOVE 'ERROR OCCURED START - ELCERT'
  6506                                 TO  WS-ABEND-MESSAGE
  6507         MOVE CM-STATUS      TO  WS-ABEND-FILE-STATUS
  6508         GO TO ABEND-PGM.
  6509
  6510     OPEN I-O ERMAIL.
  6511
  6512     IF (CFS-STAT-1  NOT EQUAL '0') AND
  6513        (ERMAIL-FILE-STATUS NOT EQUAL '97')
  6514         MOVE 'ERROR OCCURED OPEN - ERMAIL'
  6515                                  TO  WS-ABEND-MESSAGE
  6516         MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  6517         GO TO ABEND-PGM.
  6518
  6519     OPEN INPUT ECSCRT01
  6520                ERCTBL.
  6521
  6522     IF ERCTBL-FILE-STATUS NOT = '00' AND '97'
  6523         MOVE 'ERROR OCCURED OPEN - ERCTBL'
  6524                                  TO  WS-ABEND-MESSAGE
  6525         MOVE ERCTBL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  6526         GO TO ABEND-PGM.
  6527
  6528     OPEN OUTPUT PRNTR
  6529                 ME50-EL331-BALANCE
  6530                 DISPLAY-PRT.
  6531
  6532     MOVE 1  TO WS-PAGE-CNT.
  6533
  6534     MOVE WS-CURRENT-DATE TO DIS-DATE.
  6535
  6536     PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
  6537
  6538     MOVE LOW-VALUES TO WS-SAVED-ECS-KEY
  6539                        WS-SAVED-ONL-KEY
  6540                        WS-CLAIM-MATCH-KEY
  6541                        WS-SEC-CLAIM-INDEX.
  6542
  6543     MOVE WS-CURRENT-DATE TO HD-RUN-DATE.
  6544
  6545     MOVE WS-CD-MM        TO WS-CURR-MO.
  6546     MOVE WS-CD-DD        TO WS-CURR-DA.
  6547     MOVE WS-CD-YY        TO WS-CURR-YR.
  6548
  6549     COMPUTE WS-CURRENT-MOS EQUAL (RUN-CCYY * 12) + RUN-MO.
  6550
  6551     MOVE ALPH-DATE     TO HD-DATE-FULL.
  6552     MOVE COMPANY-NAME  TO HD-COMP-NM.
  6553
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 136
* EL331.cbl
  6554     PERFORM 7500-HEADING-RTN  THRU 7500-EXIT.
  6555
  6556     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  6557        DTE-SYS-G-AR-USED     EQUAL '1'
  6558          NEXT SENTENCE
  6559     ELSE
  6560         GO TO 7000-EXIT.
  6561
  6562     OPEN INPUT ERACCT.
  6563
  6564     IF (AM-STAT-1  NOT EQUAL '0') AND
  6565        (AM-STATUSF NOT EQUAL '97')
  6566         MOVE 'ERROR OCCURED OPEN - ERACCT'
  6567                             TO  WS-ABEND-MESSAGE
  6568         MOVE AM-STATUSF     TO  WS-ABEND-FILE-STATUS
  6569         GO TO ABEND-PGM.
  6570
  6571     MOVE LOW-VALUES            TO AM-CONTROL-PRIMARY.
  6572     MOVE DTE-CLASIC-COMPANY-CD TO AM-COMPANY-CD.
  6573     START ERACCT
  6574            KEY NOT LESS AM-CONTROL-PRIMARY.
  6575
  6576     IF AM-STAT-1  NOT EQUAL '0'
  6577         MOVE 'ERROR OCCURED START - ERACCT'
  6578                                 TO  WS-ABEND-MESSAGE
  6579         MOVE AM-STATUSF     TO  WS-ABEND-FILE-STATUS
  6580         GO TO ABEND-PGM.
  6581
  6582     OPEN I-O ERCOMM.
  6583
  6584     IF (CE-STAT-1  NOT EQUAL '0') AND
  6585        (CE-STATUS NOT EQUAL '97')
  6586         MOVE 'ERROR OCCURED OPEN - ERCOMM'
  6587                                 TO  WS-ABEND-MESSAGE
  6588         MOVE CE-STATUS          TO  WS-ABEND-FILE-STATUS
  6589         GO TO ABEND-PGM.
  6590
  6591 7000-EXIT.
  6592      EXIT.
  6593
  6594 7100-DATE-RTN.
  6595     CALL 'ELDATCX'  USING DATE-CONVERSION-DATA.
  6596
  6597     IF DC-ERROR-CODE NOT EQUAL SPACE
  6598         MOVE  ZEROS             TO DC-CONVERSION-DATES.
  6599
  6600 7100-EXIT.
  6601      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 137
* EL331.cbl
  6603 7300-BLD-ECS-PRT-LINE.
  6604     MOVE CR-CERT-NO             TO DTL-CERT-NO.
  6605     MOVE CR-YR                  TO DTL-EFF-YR.
  6606     MOVE CR-MO                  TO DTL-EFF-MO.
  6607     MOVE CR-DA                  TO DTL-EFF-DA.
  6608     MOVE CR-CARRIER             TO DTL-CARR.
  6609     MOVE CR-GROUPING            TO DTL-GRPG.
  6610     MOVE CR-STATE               TO DTL-STAT.
  6611     MOVE CR-ACCOUNT             TO DTL-ACCT.
  6612     MOVE 'X'                    TO WS-PRT-FULL-LINE-SW.
  6613
  6614 7300-EXIT.
  6615      EXIT.
  6616
  6617 7320-BLD-ONL-PRT-LINE.
  6618     MOVE CM-CERT-NO             TO DTL-CERT-NO.
  6619
  6620     MOVE ' '                    TO DC-OPTION-CODE.
  6621     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
  6622     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6623     MOVE DC-GREG-DATE-1-EDIT    TO DTL-EFFECTIVE-DT.
  6624     MOVE CM-CARRIER             TO DTL-CARR.
  6625     MOVE CM-GROUPING            TO DTL-GRPG.
  6626     MOVE CM-STATE               TO DTL-STAT.
  6627     MOVE CM-ACCOUNT             TO DTL-ACCT.
  6628
  6629 7320-EXIT.
  6630      EXIT.
  6631
  6632 7350-BLD-CLM-INFO.
  6633     IF NO-ASSOCIATED-CLAIM
  6634        MOVE SPACES              TO  DTL-CL-NO
  6635                                     DTL-CL-TYPE
  6636                                     DTL-CL-STATUS
  6637                                     DTL-CL-LN-KIND
  6638                                     DTL-CL-INCURRED
  6639                                     DTL-CL-PROCESSOR
  6640        GO TO 7350-EXIT.
  6641
  6642     MOVE SPACES                 TO  DTL-CL-TYPE
  6643                                     DTL-CL-STATUS
  6644                                     DTL-CL-LN-KIND.
  6645
  6646     MOVE CL-CLAIM-NO            TO DTL-CL-NO.
  6647
  6648     IF CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1
  6649         MOVE LIFE-OVERRIDE-L2   TO DTL-CL-TYPE
  6650      ELSE
  6651        IF CL-CLAIM-TYPE EQUAL AH-OVERRIDE-L1
  6652             MOVE AH-OVERRIDE-L2 TO DTL-CL-TYPE.
  6653
  6654     IF CLAIM-IS-OPEN
  6655        MOVE ' OPEN '            TO DTL-CL-STATUS
  6656      ELSE
  6657        IF CLAIM-IS-CLOSED
  6658            MOVE 'CLOSED'        TO DTL-CL-STATUS.
  6659
  6660     IF SINGLE-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 138
* EL331.cbl
  6661        MOVE 'SNG PRM'           TO DTL-CL-LN-KIND
  6662       ELSE
  6663        IF O-B-COVERAGE
  6664            MOVE '  O.B. '       TO DTL-CL-LN-KIND
  6665         ELSE
  6666          IF OPEN-END-COVERAGE
  6667              MOVE 'OPN END'     TO DTL-CL-LN-KIND.
  6668
  6669     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  6670     MOVE ' '                    TO DC-OPTION-CODE.
  6671     PERFORM 7100-DATE-RTN   THRU 7100-EXIT.
  6672     MOVE DC-GREG-DATE-1-EDIT    TO DTL-CL-INCURRED.
  6673     MOVE CL-PROCESSOR-ID        TO DTL-CL-PROCESSOR.
  6674
  6675 7350-EXIT.
  6676      EXIT.
  6677
  6678 7370-PRINT-DETAIL.
  6679     MOVE DTL-1                  TO P-DATA.
  6680     MOVE '0'                    TO X.
  6681     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6682     ADD  2                      TO WS-LINE-CNT.
  6683
  6684     IF WS-LINE-CNT GREATER WS-MAX-LINES
  6685          PERFORM 7500-HEADING-RTN  THRU 7500-EXIT.
  6686
  6687     MOVE SPACES                 TO DTL-1.
  6688
  6689 7370-EXIT.
  6690      EXIT.
  6691
  6692 7500-HEADING-RTN.
  6693     MOVE  WS-PAGE-CNT           TO HD-PAGE-NO.
  6694     MOVE '1'                    TO X.
  6695     MOVE HEADING-1              TO P-DATA.
  6696     PERFORM 7600-PRT-RTN   THRU 7600-EXIT.
  6697
  6698     MOVE SPACES                 TO X.
  6699     MOVE HEADING-2              TO P-DATA.
  6700     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6701
  6702     MOVE SPACES                 TO X.
  6703     MOVE HEADING-3              TO P-DATA.
  6704     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6705
  6706     MOVE SPACES                 TO X.
  6707     MOVE HEADING-4              TO P-DATA.
  6708     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6709
  6710     MOVE SPACES                 TO  X.
  6711     MOVE HEADING-5              TO P-DATA.
  6712     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6713
  6714     MOVE SPACES                 TO  X.
  6715     MOVE HEADING-6              TO P-DATA.
  6716     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6717
  6718     MOVE 16                     TO WS-LINE-CNT.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 139
* EL331.cbl
  6719     ADD 1 TO WS-PAGE-CNT.
  6720
  6721 7500-EXIT.
  6722      EXIT.
  6723
  6724 7600-PRT-RTN.
*                                      COPY ELCPRT2X.
  6725******************************************************************04/15/98
  6726*                                                                *ELCPRT2X
  6727*                                                                *ELCPRT2X
  6728*                            ELCPRT2X.                           *   LV002
  6729*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6730*                            VMOD=2.002                          *   CL**2
  6731*                                                                *ELCPRT2X
  6732*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
  6733*                                                                *ELCPRT2X
  6734*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
  6735*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
  6736*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
  6737*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
  6738*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
  6739*                                                                *ELCPRT2X
  6740*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
  6741*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
  6742******************************************************************ELCPRT2X
  6743                                                                  ELCPRT2X
  6744     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
  6745         FICH-OPEN   = SPACE                                      ELCPRT2X
  6746         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
  6747         OPEN OUTPUT FICH.                                        ELCPRT2X
  6748                                                                  ELCPRT2X
  6749     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
  6750         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
  6751             OPEN I-O ELREPT                                      ELCPRT2X
  6752             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
  6753                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
  6754                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
  6755                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
  6756                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
  6757                 GO TO ABEND-PGM                                  ELCPRT2X
  6758             ELSE                                                 ELCPRT2X
  6759                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
  6760                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  6761                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
  6762                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  6763                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
  6764                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
  6765                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
  6766                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  6767                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
  6768                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  6769                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
  6770                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
  6771                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
  6772                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  6773                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
  6774                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  6775                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 140
* EL331.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
  6776                                                                  ELCPRT2X
  6777     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
  6778        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
  6779         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
  6780         GO TO ABEND-PGM.                                         ELCPRT2X
  6781                                                                  ELCPRT2X
  6782     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
  6783         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
  6784         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
  6785             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
  6786                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
  6787                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
  6788                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
  6789                     INVALID KEY                                  ELCPRT2X
  6790                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
  6791                         CLOSE ELREPT                             ELCPRT2X
  6792                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
  6793                                                                  ELCPRT2X
  6794     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
  6795         MOVE X                      TO  P-CTL                    ELCPRT2X
  6796         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
  6797                                                                  ELCPRT2X
  6798     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
  6799       MOVE X                        TO  P-CTL                    ELCPRT2X
  6800       IF P-CTL = ' '                                             ELCPRT2X
  6801         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
  6802       ELSE                                                       ELCPRT2X
  6803         IF P-CTL = '0'                                           ELCPRT2X
  6804           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
  6805         ELSE                                                     ELCPRT2X
  6806           IF P-CTL = '-'                                         ELCPRT2X
  6807             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
  6808           ELSE                                                   ELCPRT2X
  6809             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
  6810                                                                  ELCPRT2X
  6811     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
  6812                                                                  ELCPRT2X
  6813 DTE-REPORT-DELETE.                                               ELCPRT2X
  6814     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
  6815         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
  6816         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
  6817                                                                  ELCPRT2X
  6818     READ ELREPT   NEXT RECORD                                    ELCPRT2X
  6819           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
  6820                                                                  ELCPRT2X
  6821     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
  6822        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
  6823         DELETE ELREPT RECORD                                     ELCPRT2X
  6824         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
  6825                                                                  ELCPRT2X
  6826 DTE-DELETE-EXIT.                                                 ELCPRT2X
  6827     EXIT.                                                        ELCPRT2X
  6828                                                                  ELCPRT2X
  6829 DTE-PRINT-EXIT.                                                  ELCPRT2X
  6830     EXIT.                                                        ELCPRT2X
  6831******************************************************************ELCPRT2X
  6832 7600-PRT-CLEAR.
  6833     MOVE SPACES                 TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 141
* EL331.cbl
  6834     MOVE SPACES                 TO DTL-1.
  6835
  6836 7600-EXIT.
  6837      EXIT.
  6838
  6839 8000-FINALIZE.
  6840
  6841     DISPLAY ' '.
  6842     DISPLAY '* * * * * * * * * * * * * * * * * *'.
  6843     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
  6844     DISPLAY '* * * * * * * * * * * * * * * * * *'.
  6845     DISPLAY ' '.
  6846
  6847     PERFORM 8600-DISPLAY-HD  THRU
  6848               8600-HD-EXIT.
  6849
  6850     MOVE ' DISPLAY ERROR COUNT = '    TO DIS-LINE-REASON
  6851     MOVE ERROR-COUNT                TO  DIS-LINE-REC
  6852     PERFORM 8600-DISPLAY-PRT THRU
  6853               8600-DISPLAY-EXIT.
  6854
  6855     CLOSE  DISPLAY-PRT.
  6856
  6857
  6858     MOVE ALL '*'                TO  P-DATA.
  6859     PERFORM  7600-PRT-RTN   THRU 7600-EXIT.
  6860
  6861     MOVE WS-MATCHED-ONL         TO  P-MATCHED-ONL.
  6862     MOVE WS-LOADED-ECS          TO  P-LOADED-ECS.
  6863     MOVE WS-ONL-DELETED         TO  P-ONL-DELETED.
  6864     MOVE WS-CLAIM-MATCH         TO  P-CLAIM-MATCH.
  6865     MOVE WS-INACTIVE-CERTS      TO  P-INACTIVE-CERTS.
  6866     MOVE WS-ECS-READ            TO  P-ECS-READ.
  6867
  6868     MOVE WS-ECS-READ            TO  WS-ME50-BAL-AMT-LOW.
  6869     MOVE WS-ECS-READ            TO  WS-ME50-BAL-AMT-HIGH.
  6870     MOVE WS-BAL50-DESCRIPTION   TO WS-ME50-BAL-DESCRIP.
  6871     WRITE ME50-EL331-BALANCE-REC FROM WS-ME50-BALANCE-REC.
  6872
  6873     MOVE WS-ONL-READ            TO  P-ONL-READ.
  6874     MOVE WS-EXCP-ADD            TO  P-EXCP-ADD.
  6875     MOVE WS-EXCP-DEL            TO  P-EXCP-DEL.
  6876     MOVE WS-EXCP-TBL            TO  P-EXCP-TBL.
  6877     MOVE WS-MAIL-DEL            TO  P-MAIL-DEL.
  6878     MOVE WS-ACCT-READS          TO  P-ACCT-READS.
  6879     MOVE WS-ACT-READ            TO  P-ACT-READ.
  6880     MOVE WS-ACCT-MATCH          TO  P-ACCT-MATCH.
  6881
  6882     COMPUTE WS-ONL-EXIST EQUAL
  6883             WS-ONL-READ - WS-ONL-DELETED + WS-LOADED-ECS.
  6884
  6885     MOVE  WS-ONL-EXIST          TO  P-ONL-EXIST.
  6886
  6887     MOVE '0'                    TO X.
  6888     MOVE FTG-1                  TO P-DATA.
  6889     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6890
  6891     MOVE '0'                    TO X.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 142
* EL331.cbl
  6892     MOVE FTG-2                  TO P-DATA.
  6893     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6894
  6895     MOVE '0'                    TO X.
  6896     MOVE FTG-3                  TO P-DATA.
  6897     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6898
  6899     MOVE '0'                    TO X.
  6900     MOVE FTG-4                  TO P-DATA.
  6901     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6902
  6903     MOVE '0'                    TO X.
  6904     MOVE FTG-5                  TO P-DATA.
  6905     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6906
  6907     MOVE '0'                    TO X.
  6908     MOVE FTG-6                  TO P-DATA.
  6909     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6910
  6911     MOVE '0'                     TO X.
  6912     MOVE FTG-7                   TO P-DATA.
  6913     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6914
  6915     MOVE '0'                    TO X.
  6916     MOVE FTG-8                  TO P-DATA.
  6917     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6918
  6919     MOVE '0'                    TO X.
  6920     MOVE FTG-9                  TO P-DATA.
  6921     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6922
  6923     MOVE '0'                    TO X.
  6924     MOVE FTG-10                 TO P-DATA.
  6925     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6926
  6927     MOVE '0'                    TO X.
  6928     MOVE FTG-11                 TO P-DATA.
  6929     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6930
  6931     MOVE '0'                    TO X.
  6932     MOVE FTG-12                 TO P-DATA.
  6933     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6934
  6935     MOVE '0'                    TO X.
  6936     MOVE FTG-13                 TO P-DATA.
  6937     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6938
  6939     MOVE '0'                    TO X.
  6940     MOVE FTG-14                 TO P-DATA.
  6941     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6942
  6943     IF DTE-SYS-E-CLASIC-CLAIMS EQUAL 'Y'
  6944         CLOSE ELMSTR5
  6945         IF CL-STAT-1 NOT EQUAL ZERO
  6946             MOVE 'ERROR OCCURED OPEN - ELMSTR'
  6947                                 TO  WS-ABEND-MESSAGE
  6948             MOVE CL-STATUS      TO  WS-ABEND-FILE-STATUS
  6949             GO TO ABEND-PGM
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 143
* EL331.cbl
  6950         END-IF
  6951         CLOSE ELRETR5
  6952         IF ELRETR5-FILE-STATUS NOT = ZERO
  6953             MOVE 'ERROR OCCURRED CLOSE - ELRETR'
  6954                                 TO  WS-ABEND-MESSAGE
  6955             MOVE ELRETR5-FILE-STATUS
  6956                                 TO  WS-ABEND-FILE-STATUS
  6957             GO TO ABEND-PGM.
  6958
  6959     CLOSE PRNTR
  6960           ME50-EL331-BALANCE
  6961           ECSCRT01
  6962           ELCERTF
  6963           ERCTBL.
  6964
  6965     IF CM-STAT-1  NOT EQUAL ZERO
  6966         MOVE 'ERROR OCCURED CLOSE - ELCERT'
  6967                                 TO  WS-ABEND-MESSAGE
  6968         MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  6969         GO TO ABEND-PGM.
  6970
  6971     CLOSE ERMAIL.
  6972
  6973     IF CFS-STAT-1 NOT EQUAL '0'
  6974         MOVE 'ERROR OCCURED CLOSE - ERMAIL'
  6975                                  TO  WS-ABEND-MESSAGE
  6976         MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  6977         GO TO ABEND-PGM.
  6978
  6979     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  6980        DTE-SYS-G-AR-USED     EQUAL '1'
  6981          NEXT SENTENCE
  6982     ELSE
  6983        GO TO 8000-CLOSE-OTHER.
  6984
  6985     CLOSE ERACCT.
  6986
  6987     IF AM-STAT-1  NOT EQUAL ZERO
  6988         MOVE 'ERROR OCCURED CLOSE - ERACCT'
  6989                             TO  WS-ABEND-MESSAGE
  6990         MOVE AM-STATUSF     TO  WS-ABEND-FILE-STATUS
  6991         GO TO ABEND-PGM.
  6992
  6993     CLOSE ERCOMM.
  6994
  6995     IF CE-STAT-1  NOT EQUAL ZERO
  6996         MOVE 'ERROR OCCURED CLOSE - ERCOMM'
  6997                             TO  WS-ABEND-MESSAGE
  6998         MOVE CE-STATUS      TO  WS-ABEND-FILE-STATUS
  6999         GO TO ABEND-PGM.
  7000
  7001 8000-CLOSE-OTHER.
*                               COPY ELCPRTCX.
  7002******************************************************************04/15/98
  7003*                                                                *ELCPRTCX
  7004*                                                                *ELCPRTCX
  7005*                            ELCPRTCX.                           *   LV003
  7006*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 144
* EL331.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
  7007*                            VMOD=2.003                          *   CL**3
  7008*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
  7009*                                                                *ELCPRTCX
  7010* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  7011******************************************************************ELCPRTCX
  7012                                                                  ELCPRTCX
  7013      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
  7014          CLOSE FICH.                                             ELCPRTCX
  7015                                                                  ELCPRTCX
  7016      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
  7017          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
  7018          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
  7019          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
  7020          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
  7021          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
  7022          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
  7023          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
  7024          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
  7025              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  7026              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  7027              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  7028                  UPON CONSOLE                                    ELCPRTCX
  7029              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  7030                  UPON CONSOLE                                    ELCPRTCX
  7031            ELSE                                                  ELCPRTCX
  7032              DISPLAY '***************************************'   ELCPRTCX
  7033              DISPLAY '***************************************'   ELCPRTCX
  7034              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
  7035              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
  7036              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
  7037              DISPLAY '**                                   **'   ELCPRTCX
  7038              DISPLAY '***************************************'   ELCPRTCX
  7039              DISPLAY '***************************************'   ELCPRTCX
  7040              CLOSE ELREPT.                                       ELCPRTCX
  7041                                                                  ELCPRTCX
  7042      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
  7043          DISPLAY '***************************************'       ELCPRTCX
  7044          DISPLAY '***************************************'       ELCPRTCX
  7045          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  7046          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
  7047          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
  7048          DISPLAY '**                                   **'       ELCPRTCX
  7049          DISPLAY '***************************************'       ELCPRTCX
  7050          DISPLAY '***************************************'       ELCPRTCX
  7051          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  7052                                                                  ELCPRTCX
  7053      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
  7054          DISPLAY '***************************************'       ELCPRTCX
  7055          DISPLAY '***************************************'       ELCPRTCX
  7056          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  7057          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
  7058          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
  7059          DISPLAY '**                                   **'       ELCPRTCX
  7060          DISPLAY '***************************************'       ELCPRTCX
  7061          DISPLAY '***************************************'       ELCPRTCX
  7062          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  7063                                                                  ELCPRTCX
  7064                                                                  ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 145
* EL331.cbl
  7065******************************************************************ELCPRTCX
  7066
  7067 8000-EXIT.
  7068      EXIT.
  7069
  7070 8600-DIS-PRINT SECTION.
  7071
  7072 8600-DISPLAY-PRT.
  7073
  7074     IF  DIS-HEAD-SW =  'Y'
  7075       MOVE 'N' TO  DIS-HEAD-SW
  7076         PERFORM 8600-DISPLAY-HD THRU
  7077             8600-HD-EXIT
  7078           GO TO 8600-DISPLAY-EXIT.
  7079
  7080     IF  DIS-LINE-CNT GREATER THAN 59
  7081         PERFORM 8600-DISPLAY-HD THRU
  7082             8600-HD-EXIT.
  7083
  7084     MOVE   SPACES TO DIS-CC.
  7085     ADD +1 TO DIS-LINE-CNT.
  7086     WRITE  DISPLAY-REC FROM DISPLAY-LINE.
  7087     MOVE   SPACES TO DISPLAY-REC.
  7088     MOVE   SPACES TO DISPLAY-LINE.
  7089
  7090
  7091 8600-DISPLAY-EXIT.
  7092     EXIT.
  7093
  7094 8600-DIS-HEAD SECTION.
  7095
  7096 8600-DISPLAY-HD.
  7097
  7098     MOVE '1' TO  DISPLAY-CC.
  7099     MOVE ZEROS TO DIS-LINE-CNT.
  7100     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
  7101     ADD  +1  TO DIS-LINE-CNT.
  7102     MOVE ' ' TO  DISPLAY-CC.
  7103     MOVE   SPACES TO DISPLAY-REC.
  7104*    WRITE  DISPLAY-REC.
  7105     ADD +1 TO DIS-LINE-CNT.
  7106     WRITE  DISPLAY-REC FROM DISPLAY-HD-2.
  7107     ADD +1 TO DIS-LINE-CNT.
  7108     MOVE   SPACES TO DISPLAY-REC.
  7109     WRITE  DISPLAY-REC.
  7110
  7111
  7112
  7113 8600-HD-EXIT.
  7114     EXIT.
  7115 9999-PROGRAM-END.
  7116
  7117     GOBACK.
  7118
  7120 ABEND-PGM SECTION.
* Micro Focus Server Express         V5.1 revision 000 28-Apr-14 09:12 Page 146
* EL331.cbl
*                         COPY ELCABEND.
  7121***************************************************************** 04/14/98
  7122*                                                               * ELCABEND
  7123*                            ELCABEND.                          *    LV003
  7124*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7125*                            VMOD 2.002                              CL**2
  7126*                                                               * ELCABEND
  7127*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  7128*            AND THEN ABENDS.                                   * ELCABEND
  7129*                                                               * ELCABEND
  7130*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  7131*                                                               * ELCABEND
  7132***************************************************************** ELCABEND
  7133*APS-010.                                                         ELCABEND
  7134     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  7135     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  7136                                                                  ELCABEND
  7137     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  7138         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  7139         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  7140                                 UPON CONSOLE.                    ELCABEND
  7141                                                                  ELCABEND
  7142     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  7143         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  7144         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  7145                                 UPON CONSOLE.                    ELCABEND
  7146                                                                  ELCABEND
  7147     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  7148     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  7149                                 UPON CONSOLE.                    ELCABEND
  7150                                                                  ELCABEND
  7151     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  7152     CALL 'ABORTME'.
  7153                                                                  ELCABEND
  7154 APS-EXIT.                                                        ELCABEND
  7155     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       63720     Code:       22150
