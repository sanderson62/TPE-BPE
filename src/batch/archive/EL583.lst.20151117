* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* EL583.cbl
* Options: int("EL583.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL583.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL583.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL583.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL583.
     5
     6
     7*AUTHOR.     SUZAN VUKOV.
     8******************************************************************
     9*REMARKS.
    10*        THIS PROGRAM CREATES A PRINTED CHECK LIST FOR CID.
    11*
    12*     INPUT:   CI.DD.LG.ELCHKQ
    13*     REPORT: - SORTED BY CONTROL NUMBER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* EL583.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 110101    2001100100006  SMVA  INITIAL IMPL FOR UNIKIX
    23*                              REWRITE OF MAINFRAME CULPRIT
    24* 010704                   SMVA  HANDLE ELCHKQ STATUS 23
    25* 050307    2007032100007  PEMA  ADD FLAG TO ID PMTS WITH INTEREST
    26* 111709    2009111700001  AJRA  ADD PARM TO LIMIT CARRIER
    27* 061814  CR2013092700001  PEMA  UPLOAD DLY G/L INT BAL DATA
    28* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    29* 082514  CR2013092700001  PEMA  move to new DB.
    30******************************************************************
    31
    32 ENVIRONMENT DIVISION.
    33
    34 INPUT-OUTPUT SECTION.
    35
    36 FILE-CONTROL.
    37     SELECT DISK-DATE        ASSIGN TO SYS019-FBA1-S-SYS019.
    38
    39     SELECT ELCHKQ           ASSIGN TO SYS027-FBA1-ELCHKQ
    40                             ORGANIZATION IS INDEXED
    41                             ACCESS IS DYNAMIC
    42                             RECORD KEY IS CQ-CONTROL-PRIMARY
    43                             FILE STATUS IS ELCHKQ-FILE-STATUS.
    44
    45     SELECT ELTRLR           ASSIGN TO ELTRLR
    46                             ORGANIZATION IS INDEXED
    47                             ACCESS IS DYNAMIC
    48                             RECORD KEY IS AT-CONTROL-PRIMARY
    49                             FILE STATUS IS ELTRLR-FILE-STATUS.
    50
    51     SELECT PRNTR            ASSIGN TO SYS008-UR-1403-S-SYS008.
    52
    53     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
    54
    55     SELECT ELREPT           ASSIGN TO SYS018-FBA1-ELREPT
    56                             ORGANIZATION IS INDEXED
    57                             ACCESS IS DYNAMIC
    58                             RECORD KEY IS RF-CONTROL-PRIMARY
    59                             FILE STATUS IS DTE-VSAM-FLAGS.
    60
    61 DATA DIVISION.
    62
    63 FILE SECTION.
    64
    65 FD  DISK-DATE
*   66                          COPY ELCDTEFD.
    67******************************************************************04/15/98
    68*                                                                *ELCDTEFD
    69*                                                                *ELCDTEFD
    70*                            ELCDTEFD.                           *   LV002
    71*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    72*                            VMOD=2.007                          *   CL**2
    73*                                                                *ELCDTEFD
    74******************************************************************ELCDTEFD
    75     BLOCK CONTAINS 0 RECORDS
    76     RECORDING MODE F.                                            ELCDTEFD
    77                                                                  ELCDTEFD
    78 01  DATE-DISK.                                                   ELCDTEFD
    79     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    80     12  FILLER                      PIC  X(14).                  ELCDTEFD
    81     12  DD-CR1                      PIC  9.                      ELCDTEFD
    82     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    83     12  DD-CR2                      PIC  9.                      ELCDTEFD
    84     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    85     12  FILLER                      PIC  X(20).                  ELCDTEFD
    86                                                                  ELCDTEFD
    87 01  DATE-DISK-R.                                                 ELCDTEFD
    88     12  FILLER                      PIC  X(4).                   ELCDTEFD
    89     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    90                                     PIC  X(32).                  ELCDTEFD
    91                                                                  ELCDTEFD
    92 01  DATE-DISK-T.                                                 ELCDTEFD
    93     12  FILLER                      PIC  X(4).                   ELCDTEFD
    94     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    95                                     PIC  X(48).                  ELCDTEFD
    96                                                                  ELCDTEFD
    97 01  DATE-DISK-M.                                                 ELCDTEFD
    98     12  FILLER                      PIC  X(4).                   ELCDTEFD
    99     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   100                                     PIC  X(48).                  ELCDTEFD
   101                                                                  ELCDTEFD
   102 01  DATE-DISK-P.                                                 ELCDTEFD
   103     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   104     12  DD-IDX                      PIC  99.                     ELCDTEFD
   105     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   106     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   107         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   108                                     PIC  X.                      ELCDTEFD
   109         16  FILLER                  PIC  X(46).                  ELCDTEFD
   110     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   111         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   112             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   113             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   114             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   115             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   116         16  FILLER                  PIC  X(16).                  ELCDTEFD
   117                                                                  ELCDTEFD
   118 01  DATE-DISK-E.                                                 ELCDTEFD
   119     12  FILLER                      PIC  X(4).                   ELCDTEFD
   120     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   121                                     PIC  X(4).                   ELCDTEFD
   122                                                                  ELCDTEFD
   123 01  DATE-DISK-C.                                                 ELCDTEFD
   124     12  FILLER                      PIC  X(7).                   ELCDTEFD
   125     12  DD-CARR1-SECPAY-SW          PIC  X.
   126     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   127     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   128     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   129     12  DD-CARR1                    PIC  X.                      ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   130     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   131     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   132     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   133     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   134     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   135     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   136     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   137     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   138     12  DD-CARR2-SECPAY-SW          PIC  X.
   139     12  FILLER                      PIC  X(7).                   ELCDTEFD
   140                                                                  ELCDTEFD
   141 01  DATE-DISK-OPT.                                               ELCDTEFD
   142     12  FILLER                      PIC  X(04).                  ELCDTEFD
   143     12  DD-TLR-DATA.                                             ELCDTEFD
   144         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   145                                     PIC  X(03).                  ELCDTEFD
   146     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   147         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   148                                     PIC  X(06).                  ELCDTEFD
   149     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   150         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   151                                     PIC  X(07).                  ELCDTEFD
   152         16  FILLER                  PIC  X(05).                  ELCDTEFD
   153     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   154                                     PIC  X(96).                  ELCDTEFD
   155******************************************************************ELCDTEFD
   156
   157 FD  ELCHKQ.
*  158                          COPY ELCCHKQ.
   159******************************************************************04/15/98
   160*                                                                *ELCCHKQ
   161*                                                                *ELCCHKQ
   162*                            ELCCHKQ.                            *   LV002
   163*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   164*                            VMOD=2.007                          *   CL**2
   165*                                                                *ELCCHKQ
   166*   FILE DESCRIPTION = CHECK QUE FILE                            *ELCCHKQ
   167*                                                                *ELCCHKQ
   168*   FILE TYPE = VSAM,KSDS                                        *ELCCHKQ
   169*   RECORD SIZE = 100  RECFORM = FIXED                           *ELCCHKQ
   170*                                                                *ELCCHKQ
   171*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *ELCCHKQ
   172*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *ELCCHKQ
   173*                                                                *ELCCHKQ
   174*   LOG = YES                                                    *ELCCHKQ
   175*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCHKQ
   176******************************************************************ELCCHKQ
   177 01  CHECK-QUE.                                                   ELCCHKQ
   178     12  CQ-RECORD-ID                PIC XX.                      ELCCHKQ
   179         88  VALID-CQ-ID         VALUE 'CQ'.                      ELCCHKQ
   180                                                                  ELCCHKQ
   181     12  CQ-CONTROL-PRIMARY.                                      ELCCHKQ
   182         16  CQ-COMPANY-CD           PIC X.                       ELCCHKQ
   183         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.        ELCCHKQ
   184         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.        ELCCHKQ
   185                                                                  ELCCHKQ
   186     12  CQ-CONTROL-BY-PAYEE.                                     ELCCHKQ
   187         16  CQ-CONTROL-BY-NUMBER.                                ELCCHKQ
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* EL583.cbl (/apps/prod/cid1p/copy/ELCCHKQ)
   188             20  CQ-COMPANY-CD-A1     PIC X.                      ELCCHKQ
   189             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.        ELCCHKQ
   190         16  CQ-PAYEE-CARRIER        PIC X.                       ELCCHKQ
   191         16  CQ-PAYEE-GROUPING       PIC X(6).                    ELCCHKQ
   192         16  CQ-PAYEE-STATE          PIC XX.                      ELCCHKQ
   193         16  CQ-PAYEE-BENE-ACCT      PIC X(10).                   ELCCHKQ
   194         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.        ELCCHKQ
   195                                                                  ELCCHKQ
   196     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.          ELCCHKQ
   197         16  CQ-DMD-COMPANY-CD-A2    PIC X.                       ELCCHKQ
   198         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.                       ELCCHKQ
   199         16  CQ-DMD-BENE-CODE-A2     PIC X(10).                   ELCCHKQ
   200         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).                    ELCCHKQ
   201         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.        ELCCHKQ
   202         16  FILLER                  PIC X(3).                    ELCCHKQ
   203                                                                  ELCCHKQ
   204     12  CQ-ENTRY-TYPE               PIC X.                       ELCCHKQ
   205             88  CHECK-ON-QUE           VALUE 'Q'.                ELCCHKQ
   206             88  ALIGNMENT-CHECK        VALUE 'A'.                ELCCHKQ
   207             88  SPOILED-CHECK          VALUE 'S'.                ELCCHKQ
   208             88  PAYMENT-ABORTED        VALUE 'X'.                ELCCHKQ
   209                                                                  ELCCHKQ
   210     12  CQ-CLAIM-MAST-CNTL.                                      ELCCHKQ
   211         16  CQ-CARRIER              PIC X.                       ELCCHKQ
   212         16  CQ-CLAIM-NO             PIC X(7).                    ELCCHKQ
   213         16  CQ-CERT-NO.                                          ELCCHKQ
   214             20  CQ-CERT-PRIME       PIC X(10).                   ELCCHKQ
   215             20  CQ-CERT-SFX         PIC X.                       ELCCHKQ
   216         16  CQ-CLAIM-TYPE           PIC X.                       ELCCHKQ
   217             88  CQ-LIFE-CLAIM          VALUE 'L'.                ELCCHKQ
   218             88  CQ-AH-CLAIM            VALUE 'A'.                ELCCHKQ
   219         16  CQ-CLAIM-SUB-TYPE       PIC X.                       ELCCHKQ
   220             88  CQ-FIXED-COVERAGE      VALUE '1'.                ELCCHKQ
   221             88  CQ-O-B-COVERAGE        VALUE '2'.                ELCCHKQ
   222             88  CQ-OPEN-END-COVERAGE   VALUE '3'.                ELCCHKQ
   223                                                                  ELCCHKQ
   224     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.        ELCCHKQ
   225     12  CQ-CHECK-NUMBER             PIC X(7).                    ELCCHKQ
   226     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.      ELCCHKQ
   227     12  CQ-PAYMENT-TYPE             PIC X.                       ELCCHKQ
   228             88  CQ-PARTIAL-PAYMENT        VALUE '1'.             ELCCHKQ
   229             88  CQ-FINAL-PAYMENT          VALUE '2'.             ELCCHKQ
   230             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.             ELCCHKQ
   231             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.             ELCCHKQ
   232             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.             ELCCHKQ
   233             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.             ELCCHKQ
   234             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.             ELCCHKQ
   235             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.             ELCCHKQ
   236     12  CQ-VOID-INDICATOR           PIC X.                       ELCCHKQ
   237             88  CHECK-IS-STOPPED          VALUE 'S'.             ELCCHKQ
   238             88  CHECK-IS-VOID             VALUE 'V'.             ELCCHKQ
   239     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.        ELCCHKQ
   240     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.        ELCCHKQ
   241     12  CQ-CHECK-BY-USER            PIC X(4).                    ELCCHKQ
   242     12  CQ-PRE-NUMBERING-SW         PIC X.                       ELCCHKQ
   243       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.           ELCCHKQ
   244       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.             ELCCHKQ
   245                                                                  ELCCHKQ
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* EL583.cbl (/apps/prod/cid1p/copy/ELCCHKQ)
   246     12  CQ-CHECK-WRITTEN-DT         PIC XX.                      ELCCHKQ
   247     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.        ELCCHKQ
   248     12  CQ-LEDGER-FLAG              PIC X(01).                   ELCCHKQ
   249     12  CQ-VOID-AFTER-LEDGER        PIC X(01).                   ELCCHKQ
   250     12  CQ-LAST-UPDATED-DT          PIC XX.                      ELCCHKQ
   251     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.      ELCCHKQ
   252     12  CQ-APPLIED-TO-RCON-DT       PIC XX.                      ELCCHKQ
   253                                                                  ELCCHKQ
   254     12  FILLER                      PIC X(04).                   ELCCHKQ
   255                                                                  ELCCHKQ
   256******************************************************************ELCCHKQ
   257
   258 FD  ELTRLR.
*  259                          COPY ELCTRLR.
   260******************************************************************04/16/98
   261*                                                                *ELCTRLR
   262*                            ELCTRLR.                            *   LV002
   263*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   264*                            VMOD=2.014                          *   CL**2
   265*                                                                *ELCTRLR
   266*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *ELCTRLR
   267*                                                                *ELCTRLR
   268*   FILE TYPE = VSAM,KSDS                                        *ELCTRLR
   269*   RECORD SIZE = 200    RECFORM = FIXED                         *ELCTRLR
   270*                                                                *ELCTRLR
   271*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *ELCTRLR
   272*       ALTERNATE INDEX = NONE                                   *ELCTRLR
   273*                                                                *ELCTRLR
   274*   LOG = YES                                                    *ELCTRLR
   275*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCTRLR
   276******************************************************************
   277*                   C H A N G E   L O G
   278*
   279* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   280*-----------------------------------------------------------------
   281*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   282* EFFECTIVE    NUMBER
   283*-----------------------------------------------------------------
   284* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   285* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
   286* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
   287* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
   288* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
   289* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
   290* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
   291* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
   292* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
   293* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
   294* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
   295* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
   296* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAILER
   297* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM IND
   298* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
   299* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   300* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
   301* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
   302* 040814    2014030500002  AJRA  ADD ICD CODES
   303* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   304******************************************************************ELCTRLR
   305 01  ACTIVITY-TRAILERS.                                           ELCTRLR
   306     12  AT-RECORD-ID                    PIC XX.                  ELCTRLR
   307         88  VALID-AT-ID                       VALUE 'AT'.        ELCTRLR
   308                                                                  ELCTRLR
   309     12  AT-CONTROL-PRIMARY.                                      ELCTRLR
   310         16  AT-COMPANY-CD               PIC X.                   ELCTRLR
   311         16  AT-CARRIER                  PIC X.                   ELCTRLR
   312         16  AT-CLAIM-NO                 PIC X(7).                ELCTRLR
   313         16  AT-CERT-NO.                                          ELCTRLR
   314             20  AT-CERT-PRIME           PIC X(10).               ELCTRLR
   315             20  AT-CERT-SFX             PIC X.                   ELCTRLR
   316         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.      ELCTRLR
   317             88  AT-1ST-TRL-AVAIL             VALUE +4095.        ELCTRLR
   318             88  AT-LAST-TRL-AVAIL            VALUE +100.         ELCTRLR
   319             88  AT-RESV-EXP-HIST-TRL         VALUE +0.           ELCTRLR
   320             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.   ELCTRLR
   321             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19. ELCTRLR
   322             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29. ELCTRLR
   323             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39. ELCTRLR
   324             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49. ELCTRLR
   325             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59. ELCTRLR
   326             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69. ELCTRLR
   327             88  AT-DIAGNOSIS-TRL             VALUE +90.          ELCTRLR
   328             88  AT-BENEFICIARY-TRL           VALUE +91.
   329             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
   330             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
   331             88  AT-VFY-CAUSAL-STATE          VALUE +94.
   332             88  AT-ERROR-MSGS-TRL            VALUE +95.
   333                                                                  ELCTRLR
   334     12  AT-TRAILER-TYPE                 PIC X.                   ELCTRLR
   335         88  RESERVE-EXPENSE-TR               VALUE '1'.          ELCTRLR
   336         88  PAYMENT-TR                       VALUE '2'.          ELCTRLR
   337         88  AUTO-PAY-TR                      VALUE '3'.          ELCTRLR
   338         88  CORRESPONDENCE-TR                VALUE '4'.          ELCTRLR
   339         88  ADDRESS-TR                       VALUE '5'.          ELCTRLR
   340         88  GENERAL-INFO-TR                  VALUE '6'.          ELCTRLR
   341         88  AUTO-PROMPT-TR                   VALUE '7'.          ELCTRLR
   342         88  DENIAL-TR                        VALUE '8'.          ELCTRLR
   343         88  INCURRED-CHG-TR                  VALUE '9'.          ELCTRLR
   344         88  FORM-CONTROL-TR                  VALUE 'A'.          ELCTRLR
   345                                                                  ELCTRLR
   346     12  AT-RECORDED-DT                  PIC XX.                  ELCTRLR
   347     12  AT-RECORDED-BY                  PIC X(4).                ELCTRLR
   348     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.    ELCTRLR
   349                                                                  ELCTRLR
   350     12  AT-TRAILER-BODY                 PIC X(165).              ELCTRLR
   351                                                                  ELCTRLR
   352     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.       ELCTRLR
   353         16  AT-RESERVE-CONTROLS.                                 ELCTRLR
   354             20  AT-MANUAL-SW            PIC X.                   ELCTRLR
   355                 88  AT-MANUAL-RESERVES-USED VALUE '1'.           ELCTRLR
   356             20  AT-FUTURE-SW            PIC X.                   ELCTRLR
   357                 88  AT-FUTURE-RESERVES-USED VALUE '1'.           ELCTRLR
   358             20  AT-PTC-SW               PIC X.                   ELCTRLR
   359                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.           ELCTRLR
   360             20  AT-IBNR-SW              PIC X.                   ELCTRLR
   361                 88  AT-IBNR-RESERVES-USED   VALUE '1'.           ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   362             20  AT-PTC-LF-SW            PIC X.                   ELCTRLR
   363                 88  AT-LF-PTC-USED          VALUE '1'.           ELCTRLR
   364             20  AT-CDT-ACCESS-METHOD    PIC X.                   ELCTRLR
   365                 88  AT-CDT-ROUND-NEAR       VALUE '1'.           ELCTRLR
   366                 88  AT-CDT-ROUND-HIGH       VALUE '2'.           ELCTRLR
   367                 88  AT-CDT-INTERPOLATED     VALUE '3'.           ELCTRLR
   368             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.  ELCTRLR
   369         16  AT-LAST-COMPUTED-DT         PIC XX.                  ELCTRLR
   370         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.  ELCTRLR
   371         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.  ELCTRLR
   372         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.  ELCTRLR
   373         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   374         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   375         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   376         16  AT-EXPENSE-CONTROLS.                                 ELCTRLR
   377             20  AT-EXPENSE-METHOD       PIC X.                   ELCTRLR
   378                 88  NO-EXPENSE-CALCULATED    VALUE '1'.          ELCTRLR
   379                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.          ELCTRLR
   380                 88  PERCENT-OF-PMT           VALUE '3'.          ELCTRLR
   381                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.          ELCTRLR
   382             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.  ELCTRLR
   383             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.  ELCTRLR
   384         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.  ELCTRLR
   385         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.  ELCTRLR
   386                                                                  ELCTRLR
   387         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.  ELCTRLR
   388         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.  ELCTRLR
   389                                                                  ELCTRLR
   390*        16  FILLER                      PIC X(53).               ELCTRLR
   391         16  FILLER                      PIC X(47).               ELCTRLR
   392                                                                  ELCTRLR
   393         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   394         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   395                                                                  ELCTRLR
   396         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.                ELCTRLR
   397             20  AT-OPEN-CLOSE-DATE      PIC XX.                  ELCTRLR
   398             20  AT-OPEN-CLOSE-TYPE      PIC X.                   ELCTRLR
   399*                    C = CLOSED                                   ELCTRLR
   400*                    O = OPEN                                     ELCTRLR
   401             20  AT-OPEN-CLOSE-REASON    PIC X(5).                ELCTRLR
   402*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE      ELCTRLR
   403                                                                  ELCTRLR
   404     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.               ELCTRLR
   405         16  AT-PAYMENT-TYPE             PIC X.                   ELCTRLR
   406             88  PARTIAL-PAYMENT                VALUE '1'.        ELCTRLR
   407             88  FINAL-PAYMENT                  VALUE '2'.        ELCTRLR
   408             88  LUMP-SUM-PAYMENT               VALUE '3'.        ELCTRLR
   409             88  ADDITIONAL-PAYMENT             VALUE '4'.        ELCTRLR
   410             88  CHARGEABLE-EXPENSE             VALUE '5'.        ELCTRLR
   411             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.        ELCTRLR
   412             88  VOIDED-PAYMENT                 VALUE '9'.        ELCTRLR
   413             88  TRANSFER                       VALUE 'T'.
   414             88  LIFE-INTEREST                  VALUE 'I'.
   415                                                                  ELCTRLR
   416         16  AT-CLAIM-TYPE               PIC X.                   ELCTRLR
   417             88  PAID-FOR-AH                    VALUE 'A'.        ELCTRLR
   418             88  PAID-FOR-LIFE                  VALUE 'L'.        ELCTRLR
   419             88  PAID-FOR-IUI                   VALUE 'I'.        ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   420             88  PAID-FOR-GAP                   VALUE 'G'.        ELCTRLR
   421             88  PAID-FOR-FAM                   VALUE 'F'.
   422         16  AT-CLAIM-PREM-TYPE          PIC X.                   ELCTRLR
   423             88  AT-SINGLE-PREMIUM              VALUE '1'.        ELCTRLR
   424             88  AT-O-B-COVERAGE                VALUE '2'.        ELCTRLR
   425             88  AT-OPEN-END-COVERAGE           VALUE '3'.        ELCTRLR
   426         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.    ELCTRLR
   427         16  AT-CHECK-NO                 PIC X(7).                ELCTRLR
   428         16  AT-PAID-FROM-DT             PIC XX.                  ELCTRLR
   429         16  AT-PAID-THRU-DT             PIC XX.                  ELCTRLR
   430         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.      ELCTRLR
   431         16  FILLER                      PIC X.                   ELCTRLR
   432         16  AT-PAYEES-NAME              PIC X(30).               ELCTRLR
   433         16  AT-PAYMENT-ORIGIN           PIC X.                   ELCTRLR
   434             88  ONLINE-MANUAL-PMT              VALUE '1'.        ELCTRLR
   435             88  ONLINE-AUTO-PMT                VALUE '2'.        ELCTRLR
   436             88  OFFLINE-PMT                    VALUE '3'.        ELCTRLR
   437         16  AT-CHECK-WRITTEN-DT         PIC XX.                  ELCTRLR
   438         16  AT-TO-BE-WRITTEN-DT         PIC XX.                  ELCTRLR
   439         16  AT-VOID-DATA.                                        ELCTRLR
   440             20  AT-VOID-DT              PIC XX.                  ELCTRLR
   441*00144       20  AT-VOID-REASON          PIC X(30).               ELCTRLR
   442             20  AT-VOID-REASON          PIC X(26).
   443         16  AT-PMT-APPROVED-BY          PIC X(04).
   444         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.    ELCTRLR
   445         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.    ELCTRLR
   446         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
   447                                         PIC S99V9(5)  COMP-3.
   448         16  AT-CREDIT-INTERFACE.                                 ELCTRLR
   449             20  AT-PMT-SELECT-DT        PIC XX.                  ELCTRLR
   450                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.       ELCTRLR
   451             20  AT-PMT-ACCEPT-DT        PIC XX.                  ELCTRLR
   452                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.       ELCTRLR
   453             20  AT-VOID-SELECT-DT       PIC XX.                  ELCTRLR
   454                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.       ELCTRLR
   455             20  AT-VOID-ACCEPT-DT       PIC XX.                  ELCTRLR
   456                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.       ELCTRLR
   457                                                                  ELCTRLR
   458         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.      ELCTRLR
   459                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.     ELCTRLR
   460                 88  CONVERSION-PAYMENT           VALUE +99999999.ELCTRLR
   461         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.      ELCTRLR
   462                                                                  ELCTRLR
   463         16  AT-FORCE-CONTROL            PIC X.                   ELCTRLR
   464             88  PAYMENT-WAS-FORCED           VALUE '1'.          ELCTRLR
   465         16  AT-PREV-LAST-PMT-DT         PIC XX.                  ELCTRLR
   466         16  AT-PREV-PAID-THRU-DT        PIC XX.                  ELCTRLR
   467         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.    ELCTRLR
   468         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.    ELCTRLR
   469         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.    ELCTRLR
   470         16  AT-BENEFIT-TYPE             PIC X.                   ELCTRLR
   471                                                                  ELCTRLR
   472         16  AT-EXPENSE-TYPE             PIC X.                   ELCTRLR
   473         16  AT-PAYMENT-APPROVAL-SW      PIC X.                   ELCTRLR
   474                                                                  ELCTRLR
   475         16  AT-PAYEE-TYPE-CD.                                    ELCTRLR
   476             20  AT-PAYEE-TYPE           PIC X.                   ELCTRLR
   477                 88  INSURED-PAID           VALUE 'I'.            ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   478                 88  BENEFICIARY-PAID       VALUE 'B'.            ELCTRLR
   479                 88  ACCOUNT-PAID           VALUE 'A'.            ELCTRLR
   480                 88  OTHER-1-PAID           VALUE 'O'.            ELCTRLR
   481                 88  OTHER-2-PAID           VALUE 'Q'.            ELCTRLR
   482                 88  DOCTOR-PAID            VALUE 'P'.            ELCTRLR
   483                 88  EMPLOYER-PAID          VALUE 'E'.            ELCTRLR
   484             20  AT-PAYEE-SEQ            PIC X.                   ELCTRLR
   485                                                                  ELCTRLR
   486         16  AT-CASH-PAYMENT             PIC X.                   ELCTRLR
   487         16  AT-GROUPED-PAYMENT          PIC X.                   ELCTRLR
   488         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.    ELCTRLR
   489         16  AT-APPROVAL-LEVEL-REQD      PIC X.                   ELCTRLR
   490         16  AT-APPROVED-LEVEL           PIC X.                   ELCTRLR
   491         16  AT-VOID-TYPE                PIC X.                   ELCTRLR
   492             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.            ELCTRLR
   493             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.            ELCTRLR
   494         16  AT-AIG-UNEMP-IND            PIC X.                   ELCTRLR
   495             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.            ELCTRLR
   496         16  AT-ASSOCIATES               PIC X.                   ELCTRLR
   497             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.        ELCTRLR
   498             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.        ELCTRLR
   499                                                                  ELCTRLR
   500         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.    ELCTRLR
   501         16  AT-CV-PMT-CODE              PIC X.                   ELCTRLR
   502             88  FULL-DEATH-PAYMENT         VALUE '1'.            ELCTRLR
   503             88  HALF-DEATH-PAYMENT         VALUE '2'.            ELCTRLR
   504             88  FULL-ADD-PAYMENT           VALUE '3'.            ELCTRLR
   505             88  HALF-ADD-PAYMENT           VALUE '4'.            ELCTRLR
   506             88  FULL-RIDER-PAYMENT         VALUE '5'.            ELCTRLR
   507             88  HALF-RIDER-PAYMENT         VALUE '6'.            ELCTRLR
   508             88  NON-CHG-EXP-PAYMENT        VALUE '7'.            ELCTRLR
   509             88  ADDL-PAYMENT               VALUE '8'.            ELCTRLR
   510                                                                  ELCTRLR
   511         16  AT-EOB-CODE1                PIC XXX.                 ELCTRLR
   512         16  AT-EOB-CODE2                PIC XXX.                 ELCTRLR
   513         16  AT-EOB-CODE3                PIC XXX.
   514         16  FILLER REDEFINES AT-EOB-CODE3.
   515             20  AT-PRINT-CLM-FORM       PIC X.
   516             20  AT-PRINT-SURVEY         PIC X.
   517             20  AT-SPECIAL-RELEASE      PIC X.
   518         16  AT-EOB-CODE4                PIC XXX.                 ELCTRLR
   519         16  FILLER REDEFINES AT-EOB-CODE4.
   520             20  AT-INT-PMT-SELECT-DT    PIC XX.
   521             20  FILLER                  PIC X.
   522         16  AT-EOB-CODE5                PIC XXX.                 ELCTRLR
   523         16  FILLER REDEFINES AT-EOB-CODE5.
   524             20  AT-PMT-PROOF-DT         PIC XX.
   525             20  FILLER                  PIC X.
   526                                                                  ELCTRLR
   527         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
   528             88  AT-PRINT-EOB            VALUE 'Y'.
   529                                                                  ELCTRLR
   530         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.                  ELCTRLR
   531         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).                ELCTRLR
   532                                                                  ELCTRLR
   533     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.              ELCTRLR
   534         16  AT-SCHEDULE-START-DT        PIC XX.                  ELCTRLR
   535         16  AT-SCHEDULE-END-DT          PIC XX.                  ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   536         16  AT-TERMINATED-DT            PIC XX.                  ELCTRLR
   537         16  AT-LAST-PMT-TYPE            PIC X.                   ELCTRLR
   538             88  LAST-PMT-IS-FINAL              VALUE 'F'.        ELCTRLR
   539             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.        ELCTRLR
   540         16  AT-FIRST-PMT-DATA.                                   ELCTRLR
   541             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.    ELCTRLR
   542             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.      ELCTRLR
   543             20  AT-1ST-PAY-THRU-DT      PIC XX.                  ELCTRLR
   544         16  AT-REGULAR-PMT-DATA.                                 ELCTRLR
   545             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.    ELCTRLR
   546             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.      ELCTRLR
   547             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.      ELCTRLR
   548         16  AT-AUTO-PAYEE-CD.                                    ELCTRLR
   549             20  AT-AUTO-PAYEE-TYPE      PIC X.                   ELCTRLR
   550                 88  INSURED-PAID-AUTO      VALUE 'I'.            ELCTRLR
   551                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.            ELCTRLR
   552                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.            ELCTRLR
   553                 88  OTHER-1-PAID-AUTO      VALUE 'O'.            ELCTRLR
   554                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.            ELCTRLR
   555             20  AT-AUTO-PAYEE-SEQ       PIC X.                   ELCTRLR
   556         16  AT-AUTO-PAY-DAY             PIC 99.                  ELCTRLR
   557         16  AT-AUTO-CASH                PIC X.                   ELCTRLR
   558             88  AT-CASH                      VALUE 'Y'.          ELCTRLR
   559             88  AT-NON-CASH                  VALUE 'N'.          ELCTRLR
   560*        16  FILLER                      PIC X(129).              ELCTRLR
   561         16  AT-AUTO-END-LETTER          PIC X(4).
   562         16  FILLER                      PIC X(125).
   563                                                                  ELCTRLR
   564         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   565         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   566                                                                  ELCTRLR
   567     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.        ELCTRLR
   568         16  AT-LETTER-SENT-DT           PIC XX.                  ELCTRLR
   569         16  AT-RECEIPT-FOLLOW-UP        PIC XX.                  ELCTRLR
   570         16  AT-AUTO-RE-SEND-DT          PIC XX.                  ELCTRLR
   571         16  AT-LETTER-ANSWERED-DT       PIC XX.                  ELCTRLR
   572         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.      ELCTRLR
   573         16  AT-LETTER-ORIGIN            PIC X.                   ELCTRLR
   574             88  ONLINE-CREATION              VALUE '1' '3'.
   575             88  OFFLINE-CREATION             VALUE '2' '4'.
   576             88  NAPER-ONLINE-CREATION        VALUE '3'.
   577             88  NAPER-OFFLINE-CREATION       VALUE '4'.
   578         16  AT-STD-LETTER-FORM          PIC X(4).                ELCTRLR
   579         16  AT-REASON-TEXT              PIC X(70).               ELCTRLR
   580         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.      ELCTRLR
   581         16  AT-ADDRESEE-TYPE            PIC X.                   ELCTRLR
   582              88  INSURED-ADDRESEE            VALUE 'I'.          ELCTRLR
   583              88  BENEFICIARY-ADDRESEE        VALUE 'B'.          ELCTRLR
   584              88  ACCOUNT-ADDRESEE            VALUE 'A'.          ELCTRLR
   585              88  PHYSICIAN-ADDRESEE          VALUE 'P'.          ELCTRLR
   586              88  EMPLOYER-ADDRESEE           VALUE 'E'.          ELCTRLR
   587              88  OTHER-ADDRESEE-1            VALUE 'O'.          ELCTRLR
   588              88  OTHER-ADDRESEE-2            VALUE 'Q'.          ELCTRLR
   589         16  AT-ADDRESSEE-NAME           PIC X(30).               ELCTRLR
   590         16  AT-INITIAL-PRINT-DATE       PIC XX.                  ELCTRLR
   591         16  AT-RESEND-PRINT-DATE        PIC XX.                  ELCTRLR
   592         16  AT-CORR-SOL-UNSOL           PIC X.                   ELCTRLR
   593         16  AT-LETTER-PURGED-DT         PIC XX.                  ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   594*                                                                 ELCTRLR
   595*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.          ELCTRLR
   596*                                                                 ELCTRLR
   597         16  AT-CSO-REDEFINITION.                                 00001862
   598             20  AT-RESEND-LETTER-FORM   PIC X(4).
   599             20  AT-AUTO-CLOSE-IND       PIC X(1).
   600             20  AT-LETTER-TO-BENE       PIC X(1).
   601             20  AT-STOP-LETTER-DT       PIC X(2).
   602             20  FILLER                  PIC X(19).
   603*             20  FILLER                  PIC X(27).               0000186
   604             20  AT-CSO-LETTER-STATUS    PIC X.                   00001864
   605                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.           00001865
   606                 88  AT-CSO-LETTER-PURGED    VALUE '2'.           00001866
   607                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.           00001867
   608             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.               00001868
   609             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.               00001869
   610*                                                                 ELCTRLR
   611*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED ELCTRLR
   612*                                                                 ELCTRLR
   613*        16  FILLER                      PIC X(26).               ELCTRLR
   614*                                                                 ELCTRLR
   615*        16  AT-DMD-BSR-CODE             PIC X.                   ELCTRLR
   616*            88  AT-AUTOMATED-BSR              VALUE 'A'.         ELCTRLR
   617*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.     ELCTRLR
   618*                                                                 ELCTRLR
   619*        16  AT-DMD-LETTER-STATUS        PIC X.                   ELCTRLR
   620*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.         ELCTRLR
   621*            88  AT-DMD-LETTER-PURGED          VALUE '2'.         ELCTRLR
   622*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.         ELCTRLR
   623*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.                  ELCTRLR
   624*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.                  ELCTRLR
   625                                                                  ELCTRLR
   626         16  AT-CORR-LAST-MAINT-DT       PIC XX.                  ELCTRLR
   627         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).                ELCTRLR
   628                                                                  ELCTRLR
   629     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.               ELCTRLR
   630         16  AT-ADDRESS-TYPE             PIC X.                   ELCTRLR
   631             88  INSURED-ADDRESS               VALUE 'I'.         ELCTRLR
   632             88  BENEFICIARY-ADDRESS           VALUE 'B'.         ELCTRLR
   633             88  ACCOUNT-ADDRESS               VALUE 'A'.         ELCTRLR
   634             88  PHYSICIAN-ADDRESS             VALUE 'P'.         ELCTRLR
   635             88  EMPLOYER-ADDRESS              VALUE 'E'.         ELCTRLR
   636             88  OTHER-ADDRESS-1               VALUE 'O'.         ELCTRLR
   637             88  OTHER-ADDRESS-2               VALUE 'Q'.         ELCTRLR
   638         16  AT-MAIL-TO-NAME             PIC X(30).               ELCTRLR
   639         16  AT-ADDRESS-LINE-1           PIC X(30).               ELCTRLR
   640         16  AT-ADDRESS-LINE-2           PIC X(30).               ELCTRLR
   641         16  AT-CITY-STATE.
   642             20  AT-CITY                 PIC X(28).
   643             20  AT-STATE                PIC XX.
   644         16  AT-ZIP.                                              ELCTRLR
   645             20  AT-ZIP-CODE.                                     ELCTRLR
   646                 24  AT-ZIP-1ST          PIC X.                   ELCTRLR
   647                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.ELCTRLR
   648                 24  FILLER              PIC X(4).                ELCTRLR
   649             20  AT-ZIP-PLUS4            PIC X(4).                ELCTRLR
   650         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.          ELCTRLR
   651             20  AT-CAN-POSTAL-1         PIC XXX.                 ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   652             20  AT-CAN-POSTAL-2         PIC XXX.                 ELCTRLR
   653             20  FILLER                  PIC XXX.                 ELCTRLR
   654         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.    ELCTRLR
   655*         16  FILLER                      PIC X(23).               ELCTRLR
   656         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
   657         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
   658         16  FILLER                      PIC X(13).
   659         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.                  ELCTRLR
   660         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).                ELCTRLR
   661                                                                  ELCTRLR
   662     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   663         16  AT-INFO-LINE-1              PIC X(60).               ELCTRLR
   664         16  FILLER REDEFINES AT-INFO-LINE-1.
   665             20  AT-NOTE-ERROR-NO OCCURS 15
   666                                         PIC X(4).
   667         16  AT-INFO-LINE-2              PIC X(60).               ELCTRLR
   668         16  FILLER REDEFINES AT-INFO-LINE-2.
   669             20  AT-ICD-CODE-1           PIC X(8).
   670             20  AT-ICD-CODE-2           PIC X(8).
   671             20  FILLER                  PIC X(44).
   672         16  AT-INFO-TRAILER-TYPE        PIC X.                   ELCTRLR
   673             88  AT-ERRORS-NOTE          VALUE 'E'.
   674             88  AT-PAYMENT-NOTE         VALUE 'P'.               ELCTRLR
   675             88  AT-CALL-NOTE            VALUE 'C'.               ELCTRLR
   676             88  AT-MAINT-NOTE           VALUE 'M'.               ELCTRLR
   677             88  AT-CERT-CHANGE          VALUE 'X'.               ELCTRLR
   678             88  AT-APPROVAL-NOTE        VALUE 'R'.
   679             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
   680             88  AT-CERT-CANCELLED       VALUE 'T'.
   681         16  AT-CALL-TYPE                PIC X.                   ELCTRLR
   682             88  AT-PHONE-CALL-IN        VALUE 'I'.               ELCTRLR
   683             88  AT-PHONE-CALL-OUT       VALUE 'O'.               ELCTRLR
   684         16  AT-NOTE-CONTINUATION        PIC X.                   ELCTRLR
   685             88  AT-CONTINUED-NOTE       VALUE 'X'.
   686         16  AT-EOB-CODES-EXIST          PIC X.
   687             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
   688         16  FILLER                      PIC X(35).               ELCTRLR
   689         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   690         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   691                                                                  ELCTRLR
   692     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.           ELCTRLR
   693         16  AT-PROMPT-LINE-1            PIC X(60).               ELCTRLR
   694         16  AT-PROMPT-LINE-2            PIC X(60).               ELCTRLR
   695         16  AT-PROMPT-START-DT          PIC XX.                  ELCTRLR
   696         16  AT-PROMPT-END-DT            PIC XX.                  ELCTRLR
   697         16  FILLER                      PIC X(35).               ELCTRLR
   698         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.                  ELCTRLR
   699         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).                ELCTRLR
   700                                                                  ELCTRLR
   701     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.           ELCTRLR
   702         16  AT-DENIAL-INFO-1            PIC X(60).               ELCTRLR
   703         16  AT-DENIAL-INFO-2            PIC X(60).               ELCTRLR
   704         16  AT-DENIAL-DT                PIC XX.                  ELCTRLR
   705         16  AT-RETRACTION-DT            PIC XX.                  ELCTRLR
   706         16  AT-DENIAL-REASON-CODE       PIC X(4).                ELCTRLR
   707*         16  FILLER                      PIC X(31).               ELCTRLR
   708         16  AT-DENIAL-PROOF-DT          PIC XX.
   709         16  FILLER                      PIC X(29).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   710         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.                  ELCTRLR
   711         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).                ELCTRLR
   712                                                                  ELCTRLR
   713     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   714         16  AT-OLD-INCURRED-DT          PIC XX.                  ELCTRLR
   715         16  AT-OLD-REPORTED-DT          PIC XX.                  ELCTRLR
   716         16  AT-OLD-ESTABLISHED-DT       PIC XX.                  ELCTRLR
   717         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3. ELCTRLR
   718         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.   ELCTRLR
   719         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3. ELCTRLR
   720         16  AT-OLD-PAID-THRU-DT         PIC XX.                  ELCTRLR
   721         16  AT-LAST-PMT-MADE-DT         PIC XX.                  ELCTRLR
   722         16  FILLER                      PIC X(26).               ELCTRLR
   723         16  AT-OLD-DIAG-CODE            PIC X(6).                ELCTRLR
   724         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.   ELCTRLR
   725         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3. ELCTRLR
   726         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3. ELCTRLR
   727         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3. ELCTRLR
   728         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3. ELCTRLR
   729         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3. ELCTRLR
   730         16  AT-OLD-DIAG-DESCRIP         PIC X(60).               ELCTRLR
   731         16  AT-OLD-ICD-CODE-1           PIC X(8).
   732         16  AT-OLD-ICD-CODE-2           PIC X(8).
   733         16  FILLER                      PIC X(9).                ELCTRLR
   734         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   735                                                                  ELCTRLR
   736     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   737         16  AT-FORM-SEND-ON-DT          PIC XX.                  ELCTRLR
   738         16  AT-FORM-FOLLOW-UP-DT        PIC XX.                  ELCTRLR
   739         16  AT-FORM-RE-SEND-DT          PIC XX.                  ELCTRLR
   740         16  AT-FORM-ANSWERED-DT         PIC XX.                  ELCTRLR
   741         16  AT-FORM-PRINTED-DT          PIC XX.                  ELCTRLR
   742         16  AT-FORM-REPRINT-DT          PIC XX.                  ELCTRLR
   743         16  AT-FORM-TYPE                PIC X.                   ELCTRLR
   744             88  INITIAL-FORM                  VALUE '1'.         ELCTRLR
   745             88  PROGRESS-FORM                 VALUE '2'.         ELCTRLR
   746         16  AT-INSTRUCT-LN-1            PIC X(28).               ELCTRLR
   747         16  AT-INSTRUCT-LN-2            PIC X(28).               ELCTRLR
   748         16  AT-INSTRUCT-LN-3            PIC X(28).               ELCTRLR
   749         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.     ELCTRLR
   750         16  AT-FORM-ADDRESS             PIC X.                   ELCTRLR
   751             88  FORM-TO-INSURED              VALUE 'I'.          ELCTRLR
   752             88  FORM-TO-ACCOUNT              VALUE 'A'.          ELCTRLR
   753             88  FORM-TO-OTHER-1              VALUE 'O'.          ELCTRLR
   754             88  FORM-TO-OTHER-2              VALUE 'Q'.          ELCTRLR
   755         16  AT-RELATED-1.                                        ELCTRLR
   756             20 AT-REL-CARR-1            PIC X.                   ELCTRLR
   757             20 AT-REL-CLAIM-1           PIC X(7).                ELCTRLR
   758             20 AT-REL-CERT-1            PIC X(11).               ELCTRLR
   759         16  AT-RELATED-2.                                        ELCTRLR
   760             20 AT-REL-CARR-2            PIC X.                   ELCTRLR
   761             20 AT-REL-CLAIM-2           PIC X(7).                ELCTRLR
   762             20 AT-REL-CERT-2            PIC X(11).               ELCTRLR
   763         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.                  ELCTRLR
   764         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.                  ELCTRLR
   765         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.                  ELCTRLR
   766         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.                  ELCTRLR
   767         16  AT-FORM-REM-PRINT-DT        PIC XX.                  ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   768         16  AT-STOP-FORM-DT             PIC X(2).
   769                                                                  ELCTRLR
   770         16  FILLER                      PIC X(09).               ELCTRLR
   771         16  AT-FORM-LAST-MAINT-DT       PIC XX.                  ELCTRLR
   772         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).                ELCTRLR
   773******************************************************************ELCTRLR
   774
   775 FD  PRNTR
*  776                          COPY ELCPRTFD.
   777******************************************************************04/15/98
   778*                                                                *ELCPRTFD
   779*                                                                *ELCPRTFD
   780*                            ELCPRTFD.                           *   LV003
   781*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   782*                            VMOD=2.006                          *ELCPRTFD
   783******************************************************************ELCPRTFD
   784     RECORDING MODE F                                             ELCPRTFD
   785     LABEL RECORDS OMITTED                                        ELCPRTFD
   786     BLOCK CONTAINS 0 RECORDS
   787     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   788 01  PRT.                                                         ELCPRTFD
   789     12  P-CTL               PIC  X.                                 CL**2
   790     12  P-DATA              PIC  X(132).                         ELCPRTFD
   791******************************************************************ELCPRTFD
   792
   793*********** OLD FICHE PROCESSING USED FOR SEQUENTIAL FILE ARCHIVE
   794*               IF DTE-PRT-OPT = 'B'
   795 FD  FICH
*  796                          COPY ELCFCHFD.
   797******************************************************************04/15/98
   798*                                                                *ELCFCHFD
   799*                            ELCFCHFD.                           *   LV003
   800*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   801*                            VMOD=2.004                          *   CL**3
   802*                                                                *ELCFCHFD
   803******************************************************************ELCFCHFD
   804     BLOCK CONTAINS 0 RECORDS
   805     RECORDING MODE F.                                            ELCFCHFD
   806                                                                  ELCFCHFD
   807 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   808******************************************************************ELCFCHFD
   809
   810
   811 FD  ELREPT
*  812                          COPY ELCRPTFD.
   813******************************************************************04/16/98
   814*                                                                *ELCRPTFD
   815*                            ELCRPTFD.                           *   LV002
   816*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   817*                            VMOD=2.001                          *ELCRPTFD
   818*                                                                *ELCRPTFD
   819* NOTE- USE ELCREPT AS COPY FOR 01 LEVEL                         *ELCRPTFD
   820*                                                                *ELCRPTFD
   821******************************************************************ELCRPTFD
   822      LABEL RECORDS ARE STANDARD.                                 ELCRPTFD
   823******************************************************************ELCRPTFD
*  824                          COPY ELCREPT.
   825******************************************************************04/15/98
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* EL583.cbl (/apps/prod/cid1p/copy/ELCREPT)
   826*                                                                *ELCREPT
   827*                                                                *ELCREPT
   828*                            ELCREPT.                            *   LV002
   829*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   830*                            VMOD=2.002                          *   CL**2
   831*                                                                *ELCREPT
   832*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
   833*                                                                *ELCREPT
   834*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
   835*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
   836*                                                                *ELCREPT
   837*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
   838*       ALTERNATE PATH  = NOT USED                               *ELCREPT
   839*                                                                *ELCREPT
   840*   LOG = NO                                                     *ELCREPT
   841*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
   842******************************************************************ELCREPT
   843 01  REPORT-SAVE-FILE.                                            ELCREPT
   844     12  RF-RECORD-ID                PIC XX.                      ELCREPT
   845         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
   846                                                                  ELCREPT
   847     12  RF-CONTROL-PRIMARY.                                      ELCREPT
   848         16  RF-COMPANY-CD           PIC X.                       ELCREPT
   849         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
   850             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
   851             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
   852         16  RF-REPORT-ID.                                        ELCREPT
   853             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
   854                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
   855                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
   856             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
   857         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
   858     12  RF-REPORT-LINE-133.                                      ELCREPT
   859         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
   860         16  RF-DATA-133             PIC X(132).                  ELCREPT
   861         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
   862             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
   863             20  FILLER              PIC X(52).                   ELCREPT
   864         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
   865             20  FILLER              PIC X(53).                   ELCREPT
   866             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
   867     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
   868         16  FILLER                  PIC X.                       ELCREPT
   869         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
   870         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
   871         16  FILLER                  PIC X(115).                  ELCREPT
   872         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
   873******************************************************************ELCREPT
   874
   875 WORKING-STORAGE SECTION.
   876
*  877 EXEC SQL
*  878    INCLUDE SQLCA
*  879 END-EXEC
   880 01 SQLCA.
   881     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   882     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   883     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* EL583.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   884     05  SQLERRM.
   885         49  SQLERRML    PIC S9(4) COMP-5.
   886         49  SQLERRMC    PIC X(70).
   887     05  SQLERRP         PIC X(8).
   888     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   889     05  SQLWARN.
   890         10  SQLWARN0    PIC X.
   891         10  SQLWARN1    PIC X.
   892         10  SQLWARN2    PIC X.
   893         10  SQLWARN3    PIC X.
   894         10  SQLWARN4    PIC X.
   895         10  SQLWARN5    PIC X.
   896         10  SQLWARN6    PIC X.
   897         10  SQLWARN7    PIC X.
   898     05  SQLEXT.
   899         10  SQLWARN8    PIC X.
   900         10  SQLWARN9    PIC X.
   901         10  SQLWARN10   PIC X.
   902         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   903     05  SQLSTATE    PIC X(5).
   904
   905 01  LCP-ABND-CODE                 PIC S999 COMP   VALUE +519.
   906
   907 77  FILLER  PIC X(32)   VALUE '********************************'.
   908 77  FILLER  PIC X(32)   VALUE '*     EL583  WORKING STORAGE   *'.
   909 77  FILLER  PIC X(32)   VALUE '********** V/M 2.008 ***********'.
   910 77  ws-clm-payments             pic s9(9)v99 comp-3 value +0.
   911
   912 01  P pointer.
   913 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   914 01  var-ptr pointer.
   915 01  env-var-len                 pic 9(4)  binary.
   916 01  rc                          pic 9(9)  binary.
   917
   918 01  WS-KIXSYS.
   919     05  WS-KIX-FIL1             PIC X(10).
   920     05  WS-KIX-APPS             PIC X(10).
   921     05  WS-KIX-ENV              PIC X(10).
   922     05  WS-KIX-MYENV            PIC X(10).
   923     05  WS-KIX-SYS              PIC X(10).
   924
   925 EXEC SQL BEGIN DECLARE SECTION END-EXEC
   926
   927 01  svr                         pic x(32).
   928 01  usr                         pic x(32).
   929 01  pass                        pic x(32).
   930 01  usr-pass                    pic x(64).
   931 01  ws-disp-code                pic s9(11).
   932
   933 01  ws-table-values.
   934     05  tbl-comp-id             pic x(5)   value spaces.
   935     05  tbl-batch-no            pic x(50)  value spaces.
   936     05  tbl-carrier             pic x      value spaces.
   937     05  tbl-date                pic x(10)  value spaces.
   938     05  tbl-source-rpt          pic x(8)   value 'EL585'.
   939     05  tbl-remits              pic x(10)  value spaces.
   940     05  tbl-charges             pic x(10)  value spaces.
   941     05  tbl-other               pic x(10)  value spaces.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* EL583.cbl
   942     05  tbl-clm-pmts            pic x(10)  value spaces.
   943     05  em-clm-pmts redefines tbl-clm-pmts
   944                                 pic zzzzzzz.99.
   945     05  tbl-clm-stop-pays       pic x(10)  value spaces.
   946     05  em-clm-stop-pays redefines tbl-clm-stop-pays
   947                                 pic zzzzzzz.99.
   948     05  tbl-clm-offline-pmts    pic x(10)  value spaces.
   949     05  em-clm-offline-pmts redefines tbl-clm-offline-pmts
   950                                 pic zzzzzzz.99.
   951
   952 EXEC SQL END DECLARE SECTION END-EXEC
   953
   954 01  FILLER                          COMP-3.
   955     05  WS-LINE-COUNT               PIC S9(03)    VALUE +0.
   956     05  WS-LINE-COUNT-MAX           PIC S9(03)    VALUE +45.
   957     05  WS-PAGE                     PIC S9(05)    VALUE +0.
   958     05  WS-CONTROL-TOTAL-CHECK-CNT  PIC S9(06)    VALUE +0.
   959     05  WS-GRAND-TOTAL-CHECK-CNT    PIC S9(06)    VALUE +0.
   960     05  WS-CONTROL-TOTAL-CHECK-AMT  PIC S9(08)V99 VALUE +0.
   961     05  WS-GRAND-TOTAL-CHECK-AMT    PIC S9(08)V99 VALUE +0.
   962     05  WS-RETURN-CODE              PIC S9(03)    VALUE +0.
   963     05  WS-ZERO                     PIC S9        VALUE +0.
   964
   965
   966 01  FILLER                          COMP SYNC.
   967     05  PGM-SUB                     PIC S9(04)    VALUE +583.
   968
   969 01  FILLER.
   970     05  ABEND-CODE                  PIC X(04).
   971     05  ABEND-OPTION                PIC X(01).
   972     05  OLC-REPORT-NAME             PIC X(05)     VALUE 'EL583'.
   973
   974     05  WS-HOLD-CONTROL-NUMBER      PIC S9(08) COMP VALUE ZEROS.
   975
   976     05  WS-CYCLE-DT-BINARY          PIC X(02)     VALUE SPACES.
   977
   978     05  WS-CYCLE-DT.
   979         10  WS-CYCLE-DT-CC          PIC 9(02)     VALUE ZEROS.
   980         10  WS-CYCLE-DT-YY          PIC 9(02)     VALUE ZEROS.
   981         10  WS-CYCLE-DT-MM          PIC 9(02)     VALUE ZEROS.
   982         10  WS-CYCLE-DT-DD          PIC 9(02)     VALUE ZEROS.
   983
   984     05  WS-EDITED-CYCLE-DT.
   985         10  WS-EDITED-CYCLE-DT-MM   PIC X(02)     VALUE SPACES.
   986         10  FILLER                  PIC X(01)     VALUE '/'.
   987         10  WS-EDITED-CYCLE-DT-DD   PIC X(02)     VALUE SPACES.
   988         10  FILLER                  PIC X(01)     VALUE '/'.
   989         10  WS-EDITED-CYCLE-DT-YY   PIC X(02)     VALUE SPACES.
   990
   991     05  WS-EOF-SW                   PIC X(01)     VALUE SPACE.
   992         88  END-OF-ELCHKQ                         VALUE '1'.
   993
   994     05  ELCHKQ-FILE-STATUS          PIC X(02)     VALUE ZERO.
   995     05  ELTRLR-FILE-STATUS          PIC XX        VALUE ZERO.
   996
   997     05  WS-FIRST-TIME-SW            PIC X(01)     VALUE 'Y'.
   998         88  FIRST-TIME-THROUGH                    VALUE 'Y'.
   999         88  NOT-FIRST-TIME                        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* EL583.cbl
  1000
  1001     05  WS-REPORT-DELETE-SW         PIC X(01)     VALUE 'B'.
  1002         88  BEGIN-REPORT-DELETE                   VALUE 'B'.
  1003         88  REPORT-DELETE-DONE                    VALUE 'D'.
  1004
  1005     05  WS-ABEND-MESSAGE            PIC X(80)     VALUE SPACES.
  1006
  1007     05  WS-ABEND-FILE-STATUS        PIC X(02)     VALUE ZERO.
  1008
  1009*    05  WS-FILE-ERROR-MESSAGE.
  1010*        10  FILLER                  PIC X(24)     VALUE
  1011*            'ERROR OCCURED OPENING - '.
  1012*        10  WS-FEM-FILE-NAME        PIC X(08).
  1013
  1014
  1015 01  WS-HEADING1.
  1016     05  FILLER                      PIC X(01)     VALUE '1'.
  1017     05  FILLER                      PIC X(32)     VALUE SPACES.
  1018     05  WS-H1-TITLE                 PIC X(14)     VALUE
  1019         'PRINTED CHECKS'.
  1020     05  FILLER                      PIC X(21)     VALUE SPACES.
  1021     05  WS-H1-REPORT-ID             PIC X(05)     VALUE 'EL583'.
  1022     05  FILLER                      PIC X(07)     VALUE SPACES.
  1023
  1024
  1025 01  WS-HEADING2.
  1026     05  FILLER                      PIC X(01)     VALUE SPACE.
  1027     05  FILLER                      PIC X(25)     VALUE SPACES.
  1028     05  WS-H2-COMPANY-NAME          PIC X(30)     VALUE SPACES.
  1029     05  FILLER                      PIC X(12)     VALUE SPACES.
  1030     05  WS-H2-DATE                  PIC X(08)     VALUE SPACES.
  1031     05  FILLER                      PIC X(04)     VALUE SPACES.
  1032
  1033
  1034 01  WS-HEADING3.
  1035     05  FILLER                      PIC X(01)     VALUE SPACE.
  1036     05  FILLER                      PIC X(26)     VALUE SPACES.
  1037     05  FILLER                      PIC X(12)     VALUE
  1038         'CYCLE DATE: '.
  1039     05  WS-H3-CYCLE-DT              PIC X(10)     VALUE SPACES.
  1040     05  FILLER                      PIC X(19)     VALUE SPACES.
  1041     05  FILLER                      PIC X(04)     VALUE 'PAGE'.
  1042     05  FILLER                      PIC X(02)     VALUE SPACES.
  1043     05  WS-H3-PAGE                  PIC ZZ,ZZ9.
  1044
  1045
  1046 01  WS-HEADING4.
  1047     05  FILLER                      PIC X(01)     VALUE '-'.
  1048     05  FILLER                      PIC X         VALUE ' '.
  1049     05  FILLER                      PIC X(10)     VALUE
  1050         'CONTROL   '.
  1051     05  FILLER                      PIC X(09)     VALUE
  1052         'CHECK    '.
  1053     05  FILLER                      PIC X(09)     VALUE
  1054         'CHECK    '.
  1055     05  FILLER                      PIC X(10)     VALUE
  1056         'PAYMENT   '.
  1057     05  FILLER                      PIC X(08)     VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* EL583.cbl
  1058         'CLAIM   '.
  1059     05  FILLER                      PIC X(08)     VALUE SPACES.
  1060     05  FILLER                      PIC X(12)     VALUE
  1061         'CERT        '.
  1062     05  FILLER                      PIC X(09)     VALUE
  1063         'PAYMENT  '.
  1064     05  FILLER                      PIC X(04)     VALUE
  1065         'USER'.
  1066
  1067
  1068 01  WS-HEADING5.
  1069     05  FILLER                      PIC X(01)     VALUE SPACE.
  1070     05  FILLER                      PIC X         VALUE ' '.
  1071     05  FILLER                      PIC X(10)     VALUE
  1072         'NUMBER    ' .
  1073     05  FILLER                      PIC X(09)     VALUE
  1074         'NUMBER   '.
  1075     05  FILLER                      PIC X(10)     VALUE
  1076         'DATE      '.
  1077     05  FILLER                      PIC X(09)     VALUE
  1078         'TYPE     '.
  1079     05  FILLER                      PIC X(08)     VALUE
  1080         'NUMBER  '.
  1081     05  FILLER                      PIC X(07)     VALUE
  1082         'CAR    '.
  1083     05  FILLER                      PIC X(13)     VALUE
  1084         'NUMBER       '.
  1085     05  FILLER                      PIC X(10)     VALUE
  1086         'AMOUNT    '.
  1087     05  FILLER                      PIC X(03)     VALUE
  1088         'ID '.
  1089
  1090
  1091 01  WS-DETAIL1.
  1092     05  FILLER                      PIC X(01)     VALUE SPACE.
  1093     05  WS-D1-INT-PMT-PRESENT       PIC X         VALUE SPACES.
  1094     05  WS-D1-CONTROL-NUMBER        PIC X(08)     VALUE SPACES.
  1095     05  FILLER                      PIC X(02)     VALUE SPACES.
  1096     05  WS-D1-CHECK-NUMBER          PIC X(07)     VALUE SPACES.
  1097     05  FILLER                      PIC X(01)     VALUE SPACES.
  1098     05  WS-D1-CHECK-DT              PIC X(08)     VALUE SPACES.
  1099     05  FILLER                      PIC X(02)     VALUE SPACES.
  1100     05  WS-D1-PAYMENT-TYPE          PIC X(07)     VALUE SPACES.
  1101     05  FILLER                      PIC X(02)     VALUE SPACES.
  1102     05  WS-D1-CLAIM-NUMBER          PIC X(07)     VALUE SPACES.
  1103     05  FILLER                      PIC X(03)     VALUE SPACES.
  1104     05  WS-D1-CARRIER               PIC X(01)     VALUE SPACE.
  1105     05  FILLER                      PIC X(03)     VALUE SPACES.
  1106     05  WS-D1-CERT-NUMBER           PIC X(10)     VALUE SPACES.
  1107     05  WS-D1-CHECK-AMT             PIC Z,ZZZ,ZZ9.99.
  1108     05  FILLER                      PIC X(02)     VALUE SPACES.
  1109     05  WS-D1-USER-ID               PIC X(04)     VALUE SPACES.
  1110
  1111
  1112 01  WS-TOTAL-LINE1.
  1113     05  FILLER                      PIC X(01)     VALUE '-'.
  1114     05  FILLER                      PIC X(12)     VALUE SPACES.
  1115     05  FILLER                      PIC X(13)     VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* EL583.cbl
  1116         'NO. CHECKS:  '.
  1117     05  WS-T1-CHECK-CNT             PIC ZZZ,ZZ9.
  1118     05  FILLER                      PIC X(12)     VALUE SPACES.
  1119     05  FILLER                      PIC X(16)     VALUE
  1120         'CONTROL TOTAL:  '.
  1121     05  WS-T1-TOTAL-CHECK-AMT       PIC $$Z,ZZZ,ZZ9.99.
  1122     05  FILLER                      PIC X(05)     VALUE SPACES.
  1123
  1124
  1125 01  WS-GRAND-TOTAL-LINE1.
  1126     05  FILLER                      PIC X(01)     VALUE '0'.
  1127     05  FILLER                      PIC X(25)     VALUE
  1128         'GRAND TOTAL NO. CHECKS:  '.
  1129     05  WS-GT1-CHECK-CNT            PIC ZZZ,ZZ9.
  1130     05  FILLER                      PIC X(14)     VALUE SPACES.
  1131     05  FILLER                      PIC X(14)     VALUE
  1132         'GRAND TOTAL:  '.
  1133     05  WS-GT1-TOTAL-CHECK-AMT      PIC $$Z,ZZZ,ZZ9.99.
  1134     05  FILLER                      PIC X(05)     VALUE SPACES.
  1135
  1136
  1137*              *************
  1138*              ELCDTECX: LAYOUT FOR DISK-DATE FILE
* 1139               COPY ELCDTECX.
  1140******************************************************************06/05/98
  1141*                                                                *ELCDTECX
  1142*                            ELCDTECX.                           *   LV005
  1143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1144*                            VMOD=2.015                          *ELCDTECX
  1145*                                                                *ELCDTECX
  1146*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1147*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1148*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1149*                                                                *ELCDTECX
  1150******************************************************************ELCDTECX
  1151******************************************************************
  1152*                   C H A N G E   L O G
  1153*
  1154* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1155*-----------------------------------------------------------------
  1156*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1157* EFFECTIVE    NUMBER
  1158*-----------------------------------------------------------------
  1159* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1160*                                  BENEFIT CODES FROM 300 TO 900
  1161* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1162* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1163* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1164******************************************************************
  1165 01  DATE-CARD.                                                   ELCDTECX
  1166     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1167     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1168     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1169     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1170     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1171     12  EP-SW                       PIC  X.                      ELCDTECX
  1172         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1173     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1174         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1175     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1176     12  RUN-CENTURY.                                             ELCDTECX
  1177         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1178     12  FILLER                      PIC  X.                         CL**4
  1179     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1180     12  FILLER                      PIC  XXX.                    ELCDTECX
  1181     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1182                                                                  ELCDTECX
  1183 01  FILLER                          PIC  X(7)                       CL**6
  1184                                          VALUE 'OPTIONS'.        ELCDTECX
  1185 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1186     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1187     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1188     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1189         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1190         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1191     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1192     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1193     12  FILLER                      PIC  X.                      ELCDTECX
  1194     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1195     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1196     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1197     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1198     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1199     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1200     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1201     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1202     12  FILLER                      PIC  X.                      ELCDTECX
  1203     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1204     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1205     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1206     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1207     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1208     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1209     12  FILLER                      PIC  X.                      ELCDTECX
  1210     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1211     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1212     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1213     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1214     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1215     12  DTE-R78                     PIC  X.                      ELCDTECX
  1216     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1217     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1218     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1219     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1220     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1221     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1222     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1223                                     PIC  X.                      ELCDTECX
  1224         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1225                                                 ' '.             ELCDTECX
  1226         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1227         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1228     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1229         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1230         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1231     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1232     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1233                                     PIC  9.                         CL**4
  1234     12  DTE-SYSTEM.                                              ELCDTECX
  1235         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1236         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1237         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1238         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1239         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1240         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1241         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1242         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1243         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1244         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1245         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1246         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1247         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1248         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1249         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1250         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1251         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1252         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1253         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1254         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1255         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1256         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1257         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1258         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1259         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1260         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1261     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1262         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1263                                     PIC  X.                      ELCDTECX
  1264     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1265                                                                  ELCDTECX
  1266 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1267     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1268     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1269     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1270*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1271     12  FILLER                      PIC  X.                      ELCDTECX
  1272     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1273     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1274     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1275     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1276     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1277     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1278     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1279                                                                  ELCDTECX
  1280     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1281     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1282     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1283     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1284                                                                  ELCDTECX
  1285     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1286     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1287     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1288     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1289                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1290     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1291     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1292                                                                  ELCDTECX
  1293     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1294     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1295                                                                  ELCDTECX
  1296     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1297                                                                  ELCDTECX
  1298 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1299     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1300     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1301     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1302     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1303     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1304     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1305     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1306                                                                  ELCDTECX
  1307 01  FILLER                          PIC  X(12)                   ELCDTECX
  1308                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1309 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1310     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1311         16  CNT-ID                  PIC  X.                      ELCDTECX
  1312         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1313                                                                  ELCDTECX
  1314 01  FILLER                          PIC  X(11)                   ELCDTECX
  1315                                          VALUE 'STATE NAMES'.    ELCDTECX
  1316 01  STATE-NAMES.                                                 ELCDTECX
  1317     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1318         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1319         16  STATE-PIC1.                                          ELCDTECX
  1320             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1321             20  FILLER              PIC  XXX.                    ELCDTECX
  1322             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1323             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1324             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1325             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1326                                                                  ELCDTECX
  1327 01  FILLER                          PIC  X(13)                   ELCDTECX
  1328                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1329 01  CARRIER-NAMES.                                               ELCDTECX
  1330     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1331         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1332         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1333         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1334         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1335         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1336         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1337*        16  FILLER                  PIC  X.                      ELCDTECX
  1338         16  CARRIER-SEC-PAY         PIC  X.
  1339             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1340                                                                  ELCDTECX
  1341 01  FILLER                          PIC  X(9)                       CL**6
  1342                                          VALUE 'INS TYPES'.      ELCDTECX
  1343 01  CLAS-INS-TYPES.                                              ELCDTECX
  1344*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1345     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1346         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1347         16  CLAS-I-AB3.                                          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1348             20  FILLER              PIC  X.                      ELCDTECX
  1349             20  CLAS-I-AB2.                                      ELCDTECX
  1350                 24  FILLER          PIC  X.                      ELCDTECX
  1351                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1352         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1353             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1354             20  FILLER              PIC  X.                         CL**4
  1355         16  CLAS-I-AB10.                                         ELCDTECX
  1356             20  FILLER              PIC  X(9).                   ELCDTECX
  1357             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1358         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1359         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1360         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1361         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1362             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1363         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1364         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1365         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1366         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1367         16  CLAS-I-REFUND-METHOD    PIC  X.
  1368         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1369         16  FILLER                  PIC  XXX.
  1370                                                                  ELCDTECX
  1371 01  FILLER                          PIC  X(16)                   ELCDTECX
  1372                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1373 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1374     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1375                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1376         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1377         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1378         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1379         16  CLAS-MORT-DESC.                                      ELCDTECX
  1380             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1381             20  FILLER              PIC  XX.                        CL**5
  1382             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1383             20  FILLER              PIC  X.                         CL**5
  1384             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1385             20  FILLER              PIC  X.                         CL**5
  1386             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1387             20  FILLER              PIC  X.                         CL**5
  1388             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1389             20  FILLER              PIC  X(5).                      CL**6
  1390                                                                  ELCDTECX
  1391 01  FILLER                          PIC  X(15)                   ELCDTECX
  1392                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1393 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1394     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1395         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1396         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1397         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1398         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1399         16  FILLER                  PIC  X(4).                      CL**6
  1400                                                                  ELCDTECX
  1401 01  FILLER                          PIC  X(7)                       CL**6
  1402                                     VALUE 'INDEXES'.             ELCDTECX
  1403 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1404     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1405     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1406     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1407     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1408     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1409     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1410     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1411     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1412     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1413     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1414     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1415     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1416     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1417     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1418     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1419     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1420     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1421                                                                  ELCDTECX
  1422 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1423     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1424     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1425     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1426     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1427     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1428     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1429     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1430     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1431     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1432     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1433     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1434                                                                  ELCDTECX
  1435 01  FILLER                          PIC  X(13)                   ELCDTECX
  1436                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1437 01  CLAS-MISC.                                                   ELCDTECX
  1438     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1439         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1440         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1441         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1442     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1443     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1444     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1445     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1446     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1447     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1448     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1449     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1450     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1451     12  STATE-L                     PIC  XX.                     ELCDTECX
  1452     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1453     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1454     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1455         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1456         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1457     12  DTE-ABEND-WORK.                                          ELCDTECX
  1458         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1459         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1460                                                                  ELCDTECX
  1461 01  FILLER                          PIC  X(12)                   ELCDTECX
  1462                                     VALUE 'WORKING DATE'.        ELCDTECX
  1463 01  WS-DATE-AND-TIME.                                            ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1464     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1465         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1466         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1467         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1468     12  WS-CURRENT-DATE.                                         ELCDTECX
  1469         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1470         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1471         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1472         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1473         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1474     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1475         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1476         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1477                                                                  ELCDTECX
  1478 01  FILLER                          PIC  X(12)                   ELCDTECX
  1479                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1480 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1481     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1482         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1483         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1484         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1485                                                                  ELCDTECX
  1486 01  FILLER                          PIC  X(10)                   ELCDTECX
  1487                                     VALUE 'STATE TLRS'.          ELCDTECX
  1488 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1489     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1490         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1491         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1492                                                                  ELCDTECX
  1493 01  FILLER                          PIC  X(13)                   ELCDTECX
  1494                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1495 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1496     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1497         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1498                                                                  ELCDTECX
  1499 01  FILLER                          PIC  X(13)                   ELCDTECX
  1500                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1501 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1502     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1503     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1504     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1505                                     PIC  X.                         CL**5
  1506     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1507     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1508     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1509     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1510     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1511     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1512     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1513     12  FILLER                      PIC  X(75).                  ELCDTECX
  1514******************************************************************ELCDTECX
  1515*01  MISC-CARR-PCT-DATA.                                          00001521
  1516*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1517*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1518*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1519*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1520*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1521*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* EL583.cbl
  1522******************************************************************ELCDTECX
  1523
  1524
* 1525               COPY ELCDTEVR.
  1526***************************************************************** 04/15/98
  1527*                                                                *ELCDTEVR
  1528*                                                                *ELCDTEVR
  1529*                            ELCDTEVR.                           *   LV003
  1530*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1531*                            VMOD=2.001                          *   CL**2
  1532*                                                                *ELCDTEVR
  1533*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1534*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1535*                                                                *ELCDTEVR
  1536******************************************************************ELCDTEVR
  1537 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1538     05  WS-RUN-DATE.                                             ELCDTEVR
  1539         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1540         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1541         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1542             15  RUN-CC              PIC  99.                     ELCDTEVR
  1543             15  RUN-YR              PIC  99.                     ELCDTEVR
  1544         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1545         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1546     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1547            WS-RUN-DATE              PIC 9(11).                      CL**2
  1548     05  WS-EP-DT.                                                ELCDTEVR
  1549         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1550         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1551         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1552             15  EP-CC               PIC  99.                     ELCDTEVR
  1553             15  EP-YR               PIC  99.                     ELCDTEVR
  1554         10  EP-MO                   PIC  99.                     ELCDTEVR
  1555         10  EP-DA                   PIC  99.                     ELCDTEVR
  1556     05  WS-EP-DT-N REDEFINES                                        CL**2
  1557            WS-EP-DT                 PIC 9(11).                      CL**2
  1558     05  WS-DTE-CONV-DT.                                             CL**4
  1559         10  FILLER                  PIC  9(03).                     CL**4
  1560         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1561         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1562             15  DTE-CONV-CC         PIC  99.                        CL**4
  1563             15  DTE-CONV-YR         PIC  99.                        CL**4
  1564         10  DTE-CONV-MO             PIC  99.                        CL**4
  1565         10  DTE-CONV-DA             PIC  99.                        CL**4
  1566     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1567            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1568 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1569     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1570         10  FILLER                            PIC 999.           ELCDTEVR
  1571         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1572         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1573             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1574             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1575         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1576         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1577     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1578            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1579     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1580         10  FILLER                            PIC 999.           ELCDTEVR
  1581         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1582         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1583         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1584         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1585     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1586            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1587 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1588     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1589         10  FILLER                            PIC 999.           ELCDTEVR
  1590         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1591         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1592             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1593             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1594         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1595         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1596     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1597            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1598     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1599         10  FILLER                            PIC 999.           ELCDTEVR
  1600         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1601         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1602             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1603             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1604         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1605         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1606     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1607            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1608     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1609         10  FILLER                            PIC 999.           ELCDTEVR
  1610         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1611         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1612             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1613             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1614         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1615         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1616     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1617            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1618 01  WS-RATE-RECORD.                                              ELCDTEVR
  1619         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1620             10  FILLER                        PIC 999.           ELCDTEVR
  1621             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1622             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1623                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1624                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1625             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1626             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1627         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1628                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1629
  1630*              *************
  1631*              ELCDATE: LAYOUT OF DATA PASSED TO DATE CONV RTN
* 1632               COPY ELCDATE.
  1633******************************************************************06/11/98
  1634*                                                                *ELCDATE
  1635*                                                                *ELCDATE
  1636*                            ELCDATE.                            *   LV023
  1637*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* EL583.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1638*                            VMOD=2.003                           ELCDATE
  1639*                                                                *ELCDATE
  1640*                                                                *ELCDATE
  1641*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1642*                 LENGTH = 200                                   *   CL*19
  1643******************************************************************ELCDATE
  1644                                                                  ELCDATE
  1645 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1646     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1647     12  DC-OPTION-CODE                PIC X.                        CL*15
  1648         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1649         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1650         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1651         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1652         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1653         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1654         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1655         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1656         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1657         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1658         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1659         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1660         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1661         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1662         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1663         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1664         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1665         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1666         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1667         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1668         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1669         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1670         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1671         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1672         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1673         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1674         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1675         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1676         88  THREE-CHARACTER-BIN                                  ELCDATE
  1677                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1678         88  GREGORIAN-TO-BIN                                        CL**2
  1679                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1680         88  BIN-TO-GREGORIAN                                        CL**2
  1681                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1682         88  JULIAN-TO-BINARY                                        CL**2
  1683                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1684     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1685         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1686         88  DATE-CONVERSION-ERROR                                ELCDATE
  1687                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1688         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1689         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1690         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1691         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1692         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1693         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1694         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1695         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* EL583.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1696         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1697         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1698     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1699         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1700     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1701         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1702         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1703         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1704     12  FILLER                        PIC X.                        CL*15
  1705     12  DC-CONVERSION-DATES.                                        CL*15
  1706         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1707         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1708         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1709         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1710                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1711             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1712             20  SLASH1-1              PIC X.                        CL*15
  1713             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1714             20  SLASH1-2              PIC X.                        CL*15
  1715             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1716         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1717         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1718                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1719             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1720             20  SLASH2-1              PIC X.                        CL*15
  1721             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1722             20  SLASH2-2              PIC X.                        CL*15
  1723             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1724         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1725         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1726                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1727             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1728             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1729             20  DC-YMD-DAY            PIC 99.                       CL*15
  1730         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1731         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1732                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1733             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1734             20  DC-MDY-DAY            PIC 99.                       CL*15
  1735             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1736         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1737             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1738             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1739             20  FILLER                PIC XX.                       CL*15
  1740             20  DC-ALPHA-CENTURY.                                   CL*15
  1741                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1742             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1743         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1744         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1745         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1746         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1747         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1748                                       PIC 9(05).                    CL*20
  1749         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1750             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1751             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1752         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1753         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* EL583.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1754         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1755     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1756         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1757         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1758             20  FILLER                PIC 9(3).                     CL*15
  1759             20  HOLD-CEN-1-CCYY.                                    CL*15
  1760                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1761                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1762             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1763             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1764         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1765             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1766             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1767             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1768                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1769                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1770             20  FILLER                PIC 9(3).                     CL*15
  1771         16  HOLD-CENTURY-1-X.                                       CL*15
  1772             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1773             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1774                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1775                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1776             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1777             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1778         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1779             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1780             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1781             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1782                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1783                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1784             20  FILLER                PIC XXX.                      CL*23
  1785         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1786         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1787         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1788         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1789             20  DC-JULIAN-1-CCYY.                                   CL*15
  1790                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1791                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1792             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1793         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1794         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1795             20  DC-JULIAN-2-CCYY.                                   CL*15
  1796                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1797                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1798             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1799         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1800             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1801             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1802             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1803             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1804             20  DC-EDITA-CCYY.                                      CL*15
  1805                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1806                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1807         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1808             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1809             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1810             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1811             20  SLASHB-2              PIC X VALUE '/'.              CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* EL583.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1812             20  DC-EDITB-CCYY.                                      CL*15
  1813                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1814                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1815         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1816         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1817                              DC-GREG-DATE-CYMD.                  ELCDATE
  1818             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1819             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1820             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1821             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1822         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1823         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1824                              DC-GREG-DATE-MDCY.                  ELCDATE
  1825             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1826             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1827             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1828             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1829    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1830        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1831    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1832    12  FILLER                         PIC X(28).                    CL*26
  1833
  1834
  1835 LINKAGE SECTION.
  1836
  1837 01  var  pic x(30).
  1838
  1839 01  PARM.
  1840     05  PARM-LENGTH        COMP     PIC S9(04)    VALUE ZEROS.
  1841     05  PARM-CYCLE-DATE             PIC X(08)     VALUE SPACES.
  1842     05  FILLER                      PIC X(01)     VALUE SPACES.
  1843     05  PARM-COMPANY-CD             PIC X(03)     VALUE SPACES.
  1844
  1845******************************************************************
  1846********************************
  1847 PROCEDURE DIVISION USING PARM.
  1848
  1849****************READ DISK-DATE FILE
  1850 0000-DATE-CARD-READ.
*                           COPY ELCDTERX.
  1851******************************************************************04/15/98
  1852*                                                                *ELCDTERX
  1853*                                                                *ELCDTERX
  1854*                            ELCDTERX.                           *   LV002
  1855*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1856*                            VMOD=2.007                          *ELCDTERX
  1857*                                                                *ELCDTERX
  1858*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1859*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1860*      = ELCDTEFD)                                               *ELCDTERX
  1861*                                                                *ELCDTERX
  1862******************************************************************ELCDTERX
  1863                                                                  ELCDTERX
  1864     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1865                                                                  ELCDTERX
  1866     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1867     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1868     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1869                                                                  ELCDTERX
  1870     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1871                                                                  ELCDTERX
  1872******************************************************************ELCDTERX
  1873*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1874*          WARNING MESSAGES.                                      ELCDTERX
  1875******************************************************************ELCDTERX
  1876     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1877         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1878                                                                  ELCDTERX
  1879     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1880                                                                  ELCDTERX
  1881     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1882                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1883                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1884                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1885                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1886                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1887                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1888                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1889                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1890                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1891                                                                  ELCDTERX
  1892     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1893                                                                  ELCDTERX
  1894     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1895                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1896                                                                  ELCDTERX
  1897     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1898     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1899     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1900     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1901                                                                  ELCDTERX
  1902     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1903         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1904     ELSE                                                         ELCDTERX
  1905         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1906                                                                  ELCDTERX
  1907     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1908         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1909     ELSE                                                         ELCDTERX
  1910         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1911                                                                  ELCDTERX
  1912 0005-READ--CARD.                                                 ELCDTERX
  1913     READ DISK-DATE                                               ELCDTERX
  1914         AT END CLOSE DISK-DATE                                   ELCDTERX
  1915             GO TO 0060-READ--TEST.                               ELCDTERX
  1916                                                                  ELCDTERX
  1917     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1918                                                                  ELCDTERX
  1919     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1920         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1921         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1922         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1923         GO TO 0005-READ--CARD.                                   ELCDTERX
  1924                                                                  ELCDTERX
  1925     IF DD-ID = 'CLAD'                                            ELCDTERX
  1926         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1927         GO TO 0005-READ--CARD.                                   ELCDTERX
  1928                                                                  ELCDTERX
  1929     IF DD-ID = 'CLAX'                                            ELCDTERX
  1930         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1931         GO TO 0005-READ--CARD.                                   ELCDTERX
  1932                                                                  ELCDTERX
  1933     IF DD-ID = 'CLAF'                                            ELCDTERX
  1934         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1935         GO TO 0005-READ--CARD.                                   ELCDTERX
  1936                                                                  ELCDTERX
  1937     IF DD-ID = 'CLAC'                                            ELCDTERX
  1938         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1939                                                                  ELCDTERX
  1940     IF DD-ID = 'CARR'                                            ELCDTERX
  1941         GO TO 0015-READ--CARR.                                   ELCDTERX
  1942                                                                  ELCDTERX
  1943     IF DD-ID = 'STAT'                                            ELCDTERX
  1944         GO TO 0020-READ--STAT.                                   ELCDTERX
  1945                                                                  ELCDTERX
  1946     IF DD-ID = 'BUSC'                                            ELCDTERX
  1947         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1948                                                                  ELCDTERX
  1949     IF DD-ID = 'MORT'                                            ELCDTERX
  1950         GO TO 0030-READ--MORT.                                   ELCDTERX
  1951                                                                  ELCDTERX
  1952     IF DD-ID = 'CLAI'                                            ELCDTERX
  1953         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1954                                                                  ELCDTERX
  1955     IF DD-ID = 'COLC'                                            ELCDTERX
  1956         GO TO 0065-READ--COLC.                                   ELCDTERX
  1957                                                                  ELCDTERX
  1958     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1959        DD-IDA = 'CL'                                             ELCDTERX
  1960         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1961                                                                  ELCDTERX
  1962     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1963        DD-IDA = 'PO'                                             ELCDTERX
  1964         GO TO 0050-READ--POXX.                                   ELCDTERX
  1965                                                                  ELCDTERX
  1966     IF DD-ID = 'OPCA'                                            ELCDTERX
  1967         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1968                                                                  ELCDTERX
  1969     IF DD-ID = 'OPST'                                            ELCDTERX
  1970         GO TO 0072-READ--OPST.                                   ELCDTERX
  1971                                                                  ELCDTERX
  1972     IF DD-ID = 'OPBS'                                            ELCDTERX
  1973         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1974                                                                  ELCDTERX
  1975     IF DD-ID = 'OPMS'                                            ELCDTERX
  1976         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1977                                                                  ELCDTERX
  1978     GO TO 0005-READ--CARD.                                       ELCDTERX
  1979                                                                  ELCDTERX
  1980 0010-READ--CLAC.                                                 ELCDTERX
  1981     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1982     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1983     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1984     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1985     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1986     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1987     GO TO 0005-READ--CARD.                                       ELCDTERX
  1988                                                                  ELCDTERX
  1989 0015-READ--CARR.                                                 ELCDTERX
  1990     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1991     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1992        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1993        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1994        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1995        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1996        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1997        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1998        MOVE DD-CARR1-SECPAY-SW
  1999                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2000     END-IF
  2001                                                                  ELCDTERX
  2002     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2003     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2004        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2005        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2006        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2007        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2008        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2009        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2010        MOVE DD-CARR2-SECPAY-SW
  2011                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2012     END-IF
  2013                                                                  ELCDTERX
  2014                                                                  ELCDTERX
  2015     GO TO 0005-READ--CARD.                                       ELCDTERX
  2016                                                                  ELCDTERX
  2017 0020-READ--STAT.                                                 ELCDTERX
  2018     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2019     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2020        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2021         GO TO 0005-READ--CARD.                                   ELCDTERX
  2022                                                                  ELCDTERX
  2023     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2024     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2025     GO TO 0020-READ--STAT.                                       ELCDTERX
  2026                                                                  ELCDTERX
  2027 0025-READ--BUSC.                                                 ELCDTERX
  2028     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2029     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2030        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2031         GO TO 0005-READ--CARD.                                   ELCDTERX
  2032                                                                  ELCDTERX
  2033     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2034     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2035     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2036                                                                  ELCDTERX
  2037 0030-READ--MORT.                                                 ELCDTERX
  2038     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2039     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2040        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2041         GO TO 0005-READ--CARD.                                   ELCDTERX
  2042                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2043     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2044     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2045     GO TO 0030-READ--MORT.                                       ELCDTERX
  2046                                                                  ELCDTERX
  2047 0035-READ--CLXX.                                                 ELCDTERX
  2048     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2049          GO TO 0005-READ--CARD.                                  ELCDTERX
  2050                                                                  ELCDTERX
  2051     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2052         DISPLAY '***********************************************'ELCDTERX
  2053         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2054         DISPLAY '***********************************************'ELCDTERX
  2055         GO TO 0055-READ--STOP.                                   ELCDTERX
  2056                                                                  ELCDTERX
  2057     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2058        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2059         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2060                                                                  ELCDTERX
  2061     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2062        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2063         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2064                                                                  ELCDTERX
  2065*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2066     GO TO 0005-READ--CARD.                                       ELCDTERX
  2067                                                                  ELCDTERX
  2068 0040-READ--CLAI.                                                 ELCDTERX
  2069     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2070     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2071        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2072         GO TO 0005-READ--CARD.                                   ELCDTERX
  2073                                                                  ELCDTERX
  2074     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2075     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2076     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2077                                                                  ELCDTERX
  2078 0045-READ--DUMP.                                                 ELCDTERX
  2079     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2080     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2081                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2082     PERFORM ABEND-PGM.                                           ELCDTERX
  2083                                                                  ELCDTERX
  2084 0050-READ--POXX.                                                 ELCDTERX
  2085     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2086         GO TO 0005-READ--CARD.                                   ELCDTERX
  2087                                                                  ELCDTERX
  2088     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2089         DISPLAY '***********************************************'ELCDTERX
  2090         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2091         DISPLAY '***********************************************'ELCDTERX
  2092         GO TO 0055-READ--STOP.                                   ELCDTERX
  2093                                                                  ELCDTERX
  2094     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2095     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2096     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2097     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2098                                                                  ELCDTERX
  2099     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2100         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2101     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2102         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2103                                                                  ELCDTERX
  2104     GO TO 0005-READ--CARD.                                       ELCDTERX
  2105                                                                  ELCDTERX
  2106 0055-READ--STOP.                                                 ELCDTERX
  2107     GOBACK.                                                      ELCDTERX
  2108                                                                  ELCDTERX
  2109 0060-READ--TEST.                                                 ELCDTERX
  2110     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2111        CLAX-ID         = SPACE  OR                               ELCDTERX
  2112        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2113         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2114                                                                  ELCDTERX
  2115     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2116     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2117                                                                  ELCDTERX
  2118 0065-READ--COLC.                                                 ELCDTERX
  2119     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2120     GO TO 0005-READ--CARD.                                       ELCDTERX
  2121                                                                  ELCDTERX
  2122 0070-READ--OPCA.                                                 ELCDTERX
  2123                                                                  ELCDTERX
  2124     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2125                                                                  ELCDTERX
  2126     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2127             OR                                                   ELCDTERX
  2128         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2129         GO TO 0005-READ--CARD.                                   ELCDTERX
  2130                                                                  ELCDTERX
  2131     ADD 1                       TO INDEXCA.                      ELCDTERX
  2132     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2133                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2134     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2135                                                                  ELCDTERX
  2136 0072-READ--OPST.                                                 ELCDTERX
  2137                                                                  ELCDTERX
  2138     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2139                                                                  ELCDTERX
  2140     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2141             OR                                                   ELCDTERX
  2142         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2143         GO TO 0005-READ--CARD.                                   ELCDTERX
  2144                                                                  ELCDTERX
  2145     ADD 1                       TO INDEXST.                      ELCDTERX
  2146     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2147                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2148     GO TO 0072-READ--OPST.                                       ELCDTERX
  2149                                                                  ELCDTERX
  2150 0074-READ--OPBS.                                                 ELCDTERX
  2151                                                                  ELCDTERX
  2152     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2153                                                                  ELCDTERX
  2154     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2155             OR                                                   ELCDTERX
  2156         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2157         GO TO 0005-READ--CARD.                                   ELCDTERX
  2158                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2159     ADD 1                       TO INDEXBS.                      ELCDTERX
  2160     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2161     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2162                                                                  ELCDTERX
  2163 0079-READ--EXIT.                                                 ELCDTERX
  2164*    EXIT.                                                        ELCDTERX
  2165******************************************************************ELCDTERX
  2166
  2167 1000-MAIN-LOGIC.
  2168
  2169     set P to address of KIXSYS
  2170     CALL "getenv" using by value P returning var-ptr
  2171     if var-ptr = null then
  2172        display ' kixsys not set '
  2173     else
  2174        set address of var to var-ptr
  2175        move 0 to env-var-len
  2176        inspect var tallying env-var-len
  2177          for characters before X'00'
  2178        unstring var (1:env-var-len) delimited by '/'
  2179           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2180              WS-KIX-SYS
  2181        end-unstring
  2182     end-if
  2183
  2184     display ' KIXSYS  ' ws-kix-myenv
  2185
  2186     PERFORM 1500-EDIT-CYCLE-DATE     THRU 1500-EXIT
  2187
  2188     PERFORM OPEN-FILES
  2189
  2190     MOVE COMPANY-NAME                TO WS-H2-COMPANY-NAME
  2191     MOVE WS-CURRENT-DATE             TO WS-H2-DATE
  2192     MOVE WS-EDITED-CYCLE-DT          TO WS-H3-CYCLE-DT
  2193     PERFORM 3500-PRINT-HEADINGS      THRU 3500-EXIT
  2194
  2195     MOVE DTE-CLASIC-COMPANY-CD       TO CQ-COMPANY-CD
  2196     START ELCHKQ KEY NOT < CQ-COMPANY-CD
  2197     END-START
  2198
  2199     EVALUATE TRUE
  2200     WHEN ELCHKQ-FILE-STATUS = '00'
  2201         PERFORM 2000-BUILD-REPORT-DETAIL THRU 2000-EXIT
  2202             UNTIL END-OF-ELCHKQ
  2203
  2204     WHEN ELCHKQ-FILE-STATUS = '23'
  2205         SET END-OF-ELCHKQ TO TRUE
  2206
  2207     WHEN OTHER
  2208        DISPLAY ' ELCHKQ START ' ELCHKQ-FILE-STATUS
  2209        PERFORM ABEND-PGM THRU APS-EXIT
  2210     END-EVALUATE
  2211
  2212
  2213     IF WS-GRAND-TOTAL-CHECK-CNT > +0
  2214         IF WS-CONTROL-TOTAL-CHECK-CNT > +0
  2215             PERFORM 3700-PRINT-CONTROL-TOTAL THRU 3700-EXIT
  2216         END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* EL583.cbl
  2217         PERFORM 3800-PRINT-GRAND-TOTAL       THRU 3800-EXIT
  2218
  2219     ELSE
  2220         MOVE '0NO CHECKS PRINTED FOR THE CURRENT CYCLE DATE'
  2221                                              TO PRT
  2222         PERFORM 3900-WRITE                   THRU 3900-EXIT
  2223     END-IF
  2224
  2225
  2226     PERFORM CLOSE-FILES THRU CLOSE-FILES-EXIT
  2227
  2228******************************************************************
  2229****                      ****                                ****
  2230****  If the parm has a company ID in it then we want to      ****
  2231****  interface to the daily G/L feed. This program           ****
  2232****  also runs without a parm so we will just bypass         ****
  2233****  the interface.                                          ****
  2234****                      ****                                ****
  2235******************************************************************
  2236
  2237     if (dte-client = 'DCC')
  2238        and (parm-company-cd = 'DCC' OR 'CSI' OR 'CCC')
  2239        perform 5000-build-sql-table
  2240                                 thru 5000-exit
  2241     end-if
  2242
  2243     GOBACK.
  2244
  2245 1500-EDIT-CYCLE-DATE.
  2246
  2247     IF PARM-LENGTH = 0
  2248         DISPLAY 'CYCLE DATE INPUT PARM MISSING '
  2249         PERFORM ABEND-PGM         THRU APS-EXIT
  2250     END-IF
  2251
  2252     MOVE PARM-CYCLE-DATE          TO DC-GREG-DATE-CYMD
  2253     MOVE 'L'                      TO DC-OPTION-CODE
  2254     PERFORM 8500-DATE-CONVERSION  THRU 8500-EXIT
  2255
  2256     IF NO-CONVERSION-ERROR
  2257         MOVE DC-BIN-DATE-1        TO WS-CYCLE-DT-BINARY
  2258         MOVE PARM-CYCLE-DATE      TO WS-CYCLE-DT
  2259         MOVE WS-CYCLE-DT-MM       TO WS-EDITED-CYCLE-DT-MM
  2260         MOVE WS-CYCLE-DT-DD       TO WS-EDITED-CYCLE-DT-DD
  2261         MOVE WS-CYCLE-DT-YY       TO WS-EDITED-CYCLE-DT-YY
  2262         move dc-greg-date-a-edit     to tbl-date
  2263     ELSE
  2264         DISPLAY 'INVALID CYCLE DATE ' PARM-CYCLE-DATE
  2265         PERFORM ABEND-PGM         THRU APS-EXIT
  2266     END-IF
  2267     .
  2268 1500-EXIT.
  2269     EXIT.
  2270
  2271
  2272 2000-BUILD-REPORT-DETAIL.
  2273
  2274     READ ELCHKQ NEXT RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* EL583.cbl
  2275         AT END SET END-OF-ELCHKQ         TO TRUE
  2276             GO TO 2000-EXIT
  2277     END-READ
  2278
  2279
  2280********* COMPANY CODE OF HEX '04' = CID
  2281     IF CQ-COMPANY-CD = DTE-CLASIC-COMPANY-CD
  2282         CONTINUE
  2283     ELSE
  2284         SET END-OF-ELCHKQ                TO TRUE
  2285         GO TO 2000-EXIT
  2286     END-IF
  2287
  2288
  2289     IF CQ-CHECK-WRITTEN-DT = WS-CYCLE-DT-BINARY
  2290         CONTINUE
  2291     ELSE
  2292         GO TO 2000-EXIT
  2293     END-IF
  2294
  2295     IF PARM-COMPANY-CD = 'DCC'
  2296        IF CQ-CARRIER = '1' OR '2'
  2297          CONTINUE
  2298        ELSE
  2299          GO TO 2000-EXIT
  2300        END-IF
  2301     END-IF
  2302     IF PARM-COMPANY-CD = 'CSI'
  2303        IF CQ-CARRIER = '3' OR '4'
  2304          CONTINUE
  2305        ELSE
  2306          GO TO 2000-EXIT
  2307        END-IF
  2308     END-IF
  2309     IF PARM-COMPANY-CD = 'CCC'
  2310        IF CQ-CARRIER = '5' OR '6' or '7'
  2311          CONTINUE
  2312     ELSE
  2313          GO TO 2000-EXIT
  2314        END-IF
  2315     END-IF
  2316
  2317     INITIALIZE WS-DETAIL1
  2318
  2319     MOVE CQ-CONTROL-NUMBER        TO WS-D1-CONTROL-NUMBER
  2320     MOVE CQ-CHECK-NUMBER          TO WS-D1-CHECK-NUMBER
  2321
  2322
  2323     MOVE CQ-CHECK-WRITTEN-DT      TO DC-BIN-DATE-1
  2324     MOVE SPACE                    TO DC-OPTION-CODE
  2325     PERFORM 8500-DATE-CONVERSION  THRU 8500-EXIT
  2326
  2327     IF NO-CONVERSION-ERROR
  2328         MOVE DC-GREG-DATE-1-EDIT  TO WS-D1-CHECK-DT
  2329     ELSE
  2330         DISPLAY 'CHECK DATE CONVERSION ERROR ' DC-ERROR-CODE
  2331         MOVE SPACES               TO WS-D1-CHECK-DT
  2332     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  42
* EL583.cbl
  2333
  2334
  2335     EVALUATE TRUE
  2336     WHEN  CQ-PARTIAL-PAYMENT
  2337           MOVE 'PARTIAL'          TO WS-D1-PAYMENT-TYPE
  2338
  2339     WHEN  CQ-FINAL-PAYMENT
  2340           MOVE 'FINAL'            TO WS-D1-PAYMENT-TYPE
  2341
  2342     WHEN  CQ-LUMP-SUM-PAYMENT
  2343           MOVE 'LUMPSUM'          TO WS-D1-PAYMENT-TYPE
  2344
  2345     WHEN  CQ-ADDITIONAL-PAYMENT
  2346           MOVE 'ADDL'             TO WS-D1-PAYMENT-TYPE
  2347
  2348     WHEN  OTHER
  2349           MOVE SPACES             TO WS-D1-PAYMENT-TYPE
  2350     END-EVALUATE
  2351
  2352
  2353     MOVE CQ-CLAIM-NO              TO WS-D1-CLAIM-NUMBER
  2354     MOVE CQ-CARRIER               TO WS-D1-CARRIER
  2355     MOVE CQ-CERT-NO               TO WS-D1-CERT-NUMBER
  2356     MOVE CQ-CHECK-AMOUNT          TO WS-D1-CHECK-AMT
  2357     MOVE CQ-CHECK-BY-USER         TO WS-D1-USER-ID
  2358
  2359
  2360     IF FIRST-TIME-THROUGH
  2361         MOVE CQ-CONTROL-NUMBER    TO WS-HOLD-CONTROL-NUMBER
  2362         MOVE '0'                  TO P-CTL
  2363         SET NOT-FIRST-TIME        TO TRUE
  2364     END-IF
  2365
  2366     IF CQ-LIFE-CLAIM
  2367        MOVE CQ-COMPANY-CD       TO AT-COMPANY-CD
  2368        MOVE CQ-CARRIER          TO AT-CARRIER
  2369        MOVE CQ-CLAIM-NO         TO AT-CLAIM-NO
  2370        MOVE CQ-CERT-NO          TO AT-CERT-NO
  2371        MOVE CQ-PMT-TRLR-SEQUENCE TO AT-SEQUENCE-NO
  2372        SUBTRACT +1              FROM AT-SEQUENCE-NO
  2373        READ ELTRLR
  2374        IF (ELTRLR-FILE-STATUS = '00')
  2375           AND (AT-TRAILER-TYPE = '2')
  2376           AND (AT-PAYMENT-TYPE = 'I')
  2377           AND (AT-VOID-DT = LOW-VALUES)
  2378           MOVE '*'              TO WS-D1-INT-PMT-PRESENT
  2379        END-IF
  2380     END-IF
  2381
  2382     PERFORM 3000-PRINT-DETAIL     THRU 3000-EXIT
  2383
  2384     .
  2385 2000-EXIT.
  2386     EXIT.
  2387
  2388 3000-PRINT-DETAIL.
  2389
  2390     IF CQ-CONTROL-NUMBER = WS-HOLD-CONTROL-NUMBER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  43
* EL583.cbl
  2391         CONTINUE
  2392     ELSE
  2393         PERFORM 3700-PRINT-CONTROL-TOTAL THRU 3700-EXIT
  2394         PERFORM 3500-PRINT-HEADINGS      THRU 3500-EXIT
  2395         MOVE +0                   TO WS-CONTROL-TOTAL-CHECK-CNT
  2396         MOVE +0                   TO WS-CONTROL-TOTAL-CHECK-AMT
  2397         MOVE CQ-CONTROL-NUMBER    TO WS-HOLD-CONTROL-NUMBER
  2398     END-IF
  2399
  2400     IF WS-LINE-COUNT = WS-LINE-COUNT-MAX
  2401         PERFORM 3500-PRINT-HEADINGS THRU 3500-EXIT
  2402     END-IF
  2403
  2404     MOVE WS-DETAIL1               TO PRT
  2405     PERFORM 3900-WRITE            THRU 3900-EXIT
  2406
  2407     ADD +1                        TO WS-CONTROL-TOTAL-CHECK-CNT
  2408     ADD +1                        TO WS-GRAND-TOTAL-CHECK-CNT
  2409     ADD CQ-CHECK-AMOUNT           TO WS-CONTROL-TOTAL-CHECK-AMT
  2410
  2411     compute ws-clm-payments = ws-clm-payments + cq-check-amount
  2412
  2413     ADD CQ-CHECK-AMOUNT           TO WS-GRAND-TOTAL-CHECK-AMT
  2414
  2415     .
  2416 3000-EXIT.
  2417     EXIT.
  2418
  2419 3500-PRINT-HEADINGS.
  2420
  2421     MOVE WS-HEADING1              TO PRT
  2422     PERFORM 3900-WRITE            THRU 3900-EXIT
  2423
  2424     MOVE WS-HEADING2              TO PRT
  2425     PERFORM 3900-WRITE            THRU 3900-EXIT
  2426
  2427     ADD +1                        TO WS-PAGE
  2428     MOVE WS-PAGE                  TO WS-H3-PAGE
  2429     MOVE WS-HEADING3              TO PRT
  2430     PERFORM 3900-WRITE            THRU 3900-EXIT
  2431
  2432     MOVE WS-HEADING4              TO PRT
  2433     PERFORM 3900-WRITE            THRU 3900-EXIT
  2434
  2435     MOVE WS-HEADING5              TO PRT
  2436     PERFORM 3900-WRITE            THRU 3900-EXIT
  2437
  2438     MOVE SPACES                   TO PRT
  2439     PERFORM 3900-WRITE            THRU 3900-EXIT
  2440
  2441     .
  2442 3500-EXIT.
  2443     EXIT.
  2444
  2445
  2446 3700-PRINT-CONTROL-TOTAL.
  2447
  2448     MOVE '0'                         TO P-CTL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  44
* EL583.cbl
  2449     MOVE SPACES                      TO P-DATA
  2450     PERFORM 3900-WRITE               THRU 3900-EXIT
  2451
  2452     MOVE WS-CONTROL-TOTAL-CHECK-CNT  TO WS-T1-CHECK-CNT
  2453     MOVE WS-CONTROL-TOTAL-CHECK-AMT  TO WS-T1-TOTAL-CHECK-AMT
  2454     MOVE WS-TOTAL-LINE1              TO PRT
  2455     PERFORM 3900-WRITE               THRU 3900-EXIT
  2456
  2457     .
  2458 3700-EXIT.
  2459     EXIT.
  2460
  2461
  2462 3800-PRINT-GRAND-TOTAL.
  2463
  2464     MOVE WS-GRAND-TOTAL-CHECK-CNT    TO WS-GT1-CHECK-CNT
  2465     MOVE WS-GRAND-TOTAL-CHECK-AMT    TO WS-GT1-TOTAL-CHECK-AMT
  2466     MOVE WS-GRAND-TOTAL-LINE1        TO PRT
  2467     PERFORM 3900-WRITE               THRU 3900-EXIT
  2468
  2469     MOVE '0    * - INDICATES INTEREST PAYMENT PRESENT '
  2470                                 TO WS-GRAND-TOTAL-LINE1
  2471     MOVE WS-GRAND-TOTAL-LINE1        TO PRT
  2472     PERFORM 3900-WRITE          THRU 3900-EXIT
  2473
  2474     .
  2475 3800-EXIT.
  2476     EXIT.
  2477
  2478
  2479 3900-WRITE.
  2480
  2481     EVALUATE TRUE
  2482     WHEN P-CTL = '1'
  2483         MOVE +1                     TO WS-LINE-COUNT
  2484
  2485     WHEN P-CTL = SPACE
  2486         ADD +1                      TO WS-LINE-COUNT
  2487
  2488     WHEN P-CTL = '0'
  2489         ADD +2                      TO WS-LINE-COUNT
  2490
  2491     WHEN OTHER
  2492         ADD +3                      TO WS-LINE-COUNT
  2493     END-EVALUATE
  2494
  2495
  2496     EVALUATE TRUE
  2497**************************** P = HARDCOPY ONLY
  2498     WHEN DTE-PRT-OPT = 'P'
  2499         WRITE PRT
  2500
  2501**************************** B = FICH (NOW USED FOR SEQUENTIAL
  2502*                                 FILE ARCHIVE) AND HARDCOPY
  2503     WHEN DTE-PRT-OPT = 'B'
  2504         PERFORM 4000-SEQ-FILE-ARCHIVE THRU 4000-EXIT
  2505         WRITE PRT
  2506
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  45
* EL583.cbl
  2507**************************** S = ONLINE REPORT FILE ONLY (ELREPT)
  2508     WHEN DTE-PRT-OPT = 'S'
  2509         PERFORM 4300-ONLINE-REPORT    THRU 4300-EXIT
  2510
  2511**************************** T = ONLINE REPORT FILE AND HARDCOPY
  2512     WHEN DTE-PRT-OPT = 'T'
  2513         PERFORM 4300-ONLINE-REPORT    THRU 4300-EXIT
  2514         WRITE PRT
  2515
  2516     WHEN OTHER
  2517         MOVE 'INVALID DTE-PRT-OPT'    TO WS-ABEND-MESSAGE
  2518         PERFORM ABEND-PGM             THRU APS-EXIT
  2519     END-EVALUATE
  2520
  2521     .
  2522 3900-EXIT.
  2523     EXIT.
  2524
  2525
  2526 4000-SEQ-FILE-ARCHIVE.
  2527******************************************************************
  2528* WHILE FICHE IS NO LONGER BEING PRODUCED, THE FICHE LOGIC IS
  2529* BEING USED TO CREATE A SEQUENTIAL FILE REPORT ARCHIVE WHEN
  2530* THE DTE-PRT-OPT IS SET TO 'B'
  2531******************************************************************
  2532     IF FICH-NO
  2533         GO TO 4000-EXIT
  2534     ELSE
  2535         IF FICH-OPEN = SPACE
  2536             MOVE 'X'                TO FICH-OPEN
  2537             OPEN OUTPUT FICH
  2538         END-IF
  2539     END-IF
  2540
  2541     MOVE SPACE                      TO P-CTL
  2542     WRITE FICH-REC                  FROM PRT
  2543
  2544     .
  2545 4000-EXIT.
  2546     EXIT.
  2547
  2548
  2549 4300-ONLINE-REPORT.
  2550
  2551     IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)
  2552         OPEN I-O ELREPT
  2553
  2554         IF DTE-F-1 NOT = ZERO AND
  2555             DTE-VSAM-FLAGS NOT = '97'
  2556             MOVE DTE-VSAM-FLAGS TO WS-ABEND-FILE-STATUS
  2557             MOVE 'ERROR OPENING ELREPT'
  2558                                 TO WS-ABEND-MESSAGE
  2559             PERFORM ABEND-PGM   THRU APS-EXIT
  2560         ELSE
  2561             MOVE '1'                   TO REPT-OPEN
  2562             MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD
  2563             MOVE '1'                   TO RF-RECORD-TYPE
  2564             MOVE OLC-REPORT-NAME       TO RF-REPORT-ID
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  46
* EL583.cbl
  2565             MOVE ZERO                  TO RF-LINE-NUMBER
  2566             START ELREPT KEY NOT LESS RF-CONTROL-PRIMARY
  2567             SET BEGIN-REPORT-DELETE    TO TRUE
  2568             PERFORM 4500-REPORT-DELETE THRU 4500-EXIT
  2569                 UNTIL REPORT-DELETE-DONE
  2570
  2571             MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD
  2572             MOVE '2'                   TO RF-RECORD-TYPE
  2573             MOVE OLC-REPORT-NAME       TO RF-REPORT-ID
  2574             MOVE ZERO                  TO RF-LINE-NUMBER
  2575             START ELREPT KEY NOT LESS RF-CONTROL-PRIMARY
  2576             SET BEGIN-REPORT-DELETE    TO TRUE
  2577             PERFORM 4500-REPORT-DELETE THRU 4500-EXIT
  2578                 UNTIL REPORT-DELETE-DONE
  2579
  2580             MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD
  2581             MOVE '1'                   TO RF-RECORD-TYPE
  2582             MOVE OLC-REPORT-NAME       TO RF-REPORT-ID
  2583             MOVE SPACES                TO RF-REPORT-LINE-133
  2584         END-IF
  2585     END-IF
  2586
  2587
  2588     IF DTE-ABEND-CD-1 = '81' AND
  2589        DTE-PRT-OPT = 'S'
  2590         MOVE +0302                     TO WS-RETURN-CODE
  2591         PERFORM ABEND-PGM              THRU APS-EXIT
  2592     END-IF
  2593
  2594
  2595     MOVE P-CTL                         TO RF-CTL-CHAR-133
  2596     MOVE P-DATA                        TO RF-DATA-133
  2597
  2598     IF DTE-ABEND-CD-1 = SPACES
  2599         ADD +1                         TO DTE-TOT-LINES
  2600         MOVE DTE-TOT-LINES             TO RF-LINE-NUMBER
  2601         WRITE REPORT-SAVE-FILE
  2602             INVALID KEY
  2603                 MOVE '88'              TO DTE-ABEND-CD-1
  2604                 CLOSE ELREPT
  2605                 MOVE SPACE             TO REPT-OPEN
  2606     END-IF
  2607
  2608     .
  2609 4300-EXIT.
  2610     EXIT.
  2611
  2612 4500-REPORT-DELETE.
  2613
  2614     IF DTE-F-1 NOT = ZERO
  2615         MOVE ZERO                          TO DTE-VSAM-FLAGS
  2616         SET REPORT-DELETE-DONE             TO TRUE
  2617         GO TO 4500-EXIT
  2618     END-IF
  2619
  2620     READ ELREPT NEXT RECORD
  2621         AT END
  2622             SET REPORT-DELETE-DONE         TO TRUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  47
* EL583.cbl
  2623             GO TO 4500-EXIT
  2624     END-READ
  2625
  2626     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND
  2627        OLC-REPORT-NAME = RF-REPORT-ID
  2628         DELETE ELREPT RECORD
  2629     END-IF
  2630
  2631     .
  2632 4500-EXIT.
  2633     EXIT.
  2634
  2635 5000-build-sql-table.
  2636
  2637     move 'NTSQLTST2_GLDailyBalancing'
  2638                                 to svr
  2639     move 'sa'                   to usr
  2640     move 'sql2008r2'            to pass
  2641
  2642     if ws-kix-myenv = 'cid1p'
  2643        move 'NTCSO2_GLDailyBalancing'
  2644                                 to svr
  2645        move 'sa'                to usr
  2646        move 'ntcso2'            to pass
  2647     end-if
  2648
  2649     display 'Begin connect to DB '
  2650     string
  2651         usr delimited space
  2652         "." delimited size
  2653         pass delimited space into usr-pass
  2654     end-string
  2655
  2656     display ' usr pass ' usr-pass
  2657
  2658     EXEC SQL
  2659        CONNECT TO :svr USER :usr-pass
  2660     END-EXEC
  2661
  2662     if sqlcode not = 0
  2663        display "Error: cannot connect "
  2664        display sqlcode
  2665        display sqlerrmc
  2666        goback
  2667     end-if
  2668
  2669     display " connect to DB successful "
  2670
  2671*    perform 5010-drop-table     thru 5010-exit
  2672*    perform 5020-truncate-table thru 5020-exit
  2673*    perform 5030-create-table   thru 5030-exit
  2674     perform 5040-insert-row     thru 5040-exit
  2675     perform 5050-finish-up      thru 5050-exit
  2676
  2677     .
  2678 5000-exit.
  2679     exit.
  2680
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  48
* EL583.cbl
  2681 5010-drop-table.
  2682
  2683     display 'Begin Drop table'
  2684     EXEC SQL
  2685         drop table DAILYGLINT
  2686     END-EXEC
  2687     if sqlcode not = 0
  2688        display "Error(anticipated) : cannot drop table "
  2689        display sqlcode
  2690        display sqlerrmc
  2691*       goback
  2692     end-if
  2693
  2694     display ' sql return code ' sqlcode
  2695     display ' sql err mess    ' sqlerrmc
  2696
  2697     .
  2698 5010-exit.
  2699     exit.
  2700
  2701 5020-truncate-table.
  2702
  2703     display '*** Begin Truncate table ***'
  2704     EXEC SQL
  2705         truncate table DAILYGLINT
  2706     END-EXEC
  2707     if sqlcode not = 0
  2708        display "Error : cannot truncate table "
  2709        display sqlcode
  2710        display sqlerrmc
  2711        goback
  2712     end-if
  2713
  2714     display ' sql return code ' sqlcode
  2715     display ' sql err mess    ' sqlerrmc
  2716     display '***  End  Truncate table ***'
  2717
  2718     .
  2719 5020-exit.
  2720     exit.
  2721
  2722 5030-create-table.
  2723
  2724     display ' Begin Create table'
  2725     EXEC SQL
  2726        create table DAILYGLINT (
  2727         compid char(5),
  2728         batchno char(50),
  2729         carrier char(1),
  2730         procdate datetime,
  2731         sourcerpt char(8),
  2732         dlyremits decimal(9,2),
  2733         dlycharges decimal(9,2),
  2734         dlyclmpmts decimal(9,2),
  2735         dlystoppays decimal(9,2),
  2736         dlyoffline decimal(9,2))
  2737     END-EXEC
  2738     if sqlcode not = 0
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  49
* EL583.cbl
  2739        display "Error: cannot create table "
  2740        move sqlcode             to ws-disp-code
  2741        display ' sql return code ' ws-disp-code
  2742        display ' sql err mess    ' sqlerrmc
  2743        goback
  2744     end-if
  2745
  2746     display " Create table successful "
  2747
  2748     .
  2749 5030-exit.
  2750     exit.
  2751
  2752 5040-insert-row.
  2753
  2754*    display ' Begin Insert row '
  2755
  2756     evaluate true
  2757        when parm-company-cd = 'DCC'
  2758           move 'LPAC'           to tbl-comp-id
  2759           move 'Batch 75 and 4 LPAC TPC Claims'
  2760                                 to tbl-batch-no
  2761        when parm-company-cd = 'CSI'
  2762           move 'CSO'            to tbl-comp-id
  2763           move 'Batch 76 CSI DCC Claims'
  2764                                 to tbl-batch-no
  2765        when other
  2766           move 'CCC'            to tbl-comp-id
  2767           move 'Batch 6 CCC DCC Claims'
  2768                                 to tbl-batch-no
  2769     end-evaluate
  2770
  2771*    move current-date           to tbl-date
  2772     move 'EL583'                to tbl-source-rpt
  2773     move '0000000.00'           to tbl-remits
  2774                                    tbl-charges
  2775                                    tbl-other
  2776                                    tbl-clm-stop-pays
  2777                                    tbl-clm-offline-pmts
  2778
  2779     move ws-clm-payments        to em-clm-pmts
  2780
  2781     EXEC SQL
  2782        insert into DAILYGLINT (
  2783         compid,
  2784         batchno,
  2785         carrier,
  2786         procdate,
  2787         sourcerpt,
  2788         dlyremits,
  2789         dlycharges,
  2790         dlyclmpmts,
  2791         dlystoppays,
  2792         dlyoffline)
  2793         values (
  2794            :tbl-comp-id,
  2795            :tbl-batch-no,
  2796            :tbl-carrier,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  50
* EL583.cbl
  2797            :tbl-date,
  2798            :tbl-source-rpt,
  2799            :tbl-remits,
  2800            :tbl-charges,
  2801            :tbl-clm-pmts,
  2802            :tbl-clm-stop-pays,
  2803            :tbl-clm-offline-pmts)
  2804     END-EXEC
  2805     if sqlcode not = 0
  2806        display "Error: cannot insert row "
  2807        display ' sql return code ' sqlcode
  2808        display ' sql err mess    ' sqlerrmc
  2809        goback
  2810     end-if
  2811
  2812     .
  2813 5040-exit.
  2814     exit.
  2815
  2816 5050-finish-up.
  2817
  2818     display ' Begin Commit '
  2819     EXEC SQL
  2820         commit transaction
  2821     END-EXEC
  2822     if sqlcode not = 0
  2823        display "Error: commit "
  2824        display ' sql return code ' sqlcode
  2825        display ' sql err mess    ' sqlerrmc
  2826        goback
  2827     end-if
  2828
  2829     display " Commit trans successful "
  2830
  2831     display ' Begin Disconnect '
  2832     EXEC SQL
  2833         commit work release
  2834     END-EXEC
  2835     if sqlcode not = 0
  2836        display "Error: commit release "
  2837        display ' sql return code ' sqlcode
  2838        display ' sql err mess    ' sqlerrmc
  2839     end-if
  2840
  2841     .
  2842 5050-exit.
  2843     exit.
  2844
  2845
  2846 8500-DATE-CONVERSION.
  2847
  2848     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2849
  2850     .
  2851 8500-EXIT.
  2852     EXIT.
  2853
  2854 OPEN-FILES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  51
* EL583.cbl
  2855
  2856     OPEN INPUT  ELCHKQ ELTRLR
  2857          OUTPUT PRNTR
  2858
  2859     IF ELCHKQ-FILE-STATUS  = '00' OR '97'
  2860        CONTINUE
  2861     ELSE
  2862        MOVE 'OPEN INPUT ERROR OCCURRED ON ELCHKQ' TO
  2863                                      WS-ABEND-MESSAGE
  2864        MOVE ELCHKQ-FILE-STATUS    TO WS-ABEND-FILE-STATUS
  2865        PERFORM ABEND-PGM          THRU APS-EXIT
  2866     END-IF
  2867
  2868     IF ELTRLR-FILE-STATUS  = '00' OR '97'
  2869        CONTINUE
  2870     ELSE
  2871        MOVE 'OPEN INPUT ERROR OCCURRED ON ELTRLR' TO
  2872                                      WS-ABEND-MESSAGE
  2873        MOVE ELTRLR-FILE-STATUS    TO WS-ABEND-FILE-STATUS
  2874        PERFORM ABEND-PGM          THRU APS-EXIT
  2875     END-IF
  2876
  2877     .
  2878 OPEN-FILES-EXIT.
  2879     EXIT.
  2880
  2881 CLOSE-FILES.
  2882
  2883 CFS-010.
*               COPY ELCPRTCX.
  2884******************************************************************04/15/98
  2885*                                                                *ELCPRTCX
  2886*                                                                *ELCPRTCX
  2887*                            ELCPRTCX.                           *   LV003
  2888*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2889*                            VMOD=2.003                          *   CL**3
  2890*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
  2891*                                                                *ELCPRTCX
  2892* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  2893******************************************************************ELCPRTCX
  2894                                                                  ELCPRTCX
  2895      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
  2896          CLOSE FICH.                                             ELCPRTCX
  2897                                                                  ELCPRTCX
  2898      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
  2899          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
  2900          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
  2901          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
  2902          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
  2903          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
  2904          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
  2905          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
  2906          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
  2907              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  2908              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  2909              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  2910                  UPON CONSOLE                                    ELCPRTCX
  2911              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  52
* EL583.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
  2912                  UPON CONSOLE                                    ELCPRTCX
  2913            ELSE                                                  ELCPRTCX
  2914              DISPLAY '***************************************'   ELCPRTCX
  2915              DISPLAY '***************************************'   ELCPRTCX
  2916              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
  2917              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
  2918              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
  2919              DISPLAY '**                                   **'   ELCPRTCX
  2920              DISPLAY '***************************************'   ELCPRTCX
  2921              DISPLAY '***************************************'   ELCPRTCX
  2922              CLOSE ELREPT.                                       ELCPRTCX
  2923                                                                  ELCPRTCX
  2924      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
  2925          DISPLAY '***************************************'       ELCPRTCX
  2926          DISPLAY '***************************************'       ELCPRTCX
  2927          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  2928          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
  2929          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
  2930          DISPLAY '**                                   **'       ELCPRTCX
  2931          DISPLAY '***************************************'       ELCPRTCX
  2932          DISPLAY '***************************************'       ELCPRTCX
  2933          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  2934                                                                  ELCPRTCX
  2935      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
  2936          DISPLAY '***************************************'       ELCPRTCX
  2937          DISPLAY '***************************************'       ELCPRTCX
  2938          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  2939          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
  2940          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
  2941          DISPLAY '**                                   **'       ELCPRTCX
  2942          DISPLAY '***************************************'       ELCPRTCX
  2943          DISPLAY '***************************************'       ELCPRTCX
  2944          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  2945                                                                  ELCPRTCX
  2946                                                                  ELCPRTCX
  2947******************************************************************ELCPRTCX
  2948
  2949     CLOSE ELCHKQ ELTRLR
  2950           PRNTR
  2951
  2952     .
  2953 CLOSE-FILES-EXIT.
  2954     EXIT.
  2955
  2956 ABEND-PGM.
*                 COPY ELCABEND.
  2957***************************************************************** 04/14/98
  2958*                                                               * ELCABEND
  2959*                            ELCABEND.                          *    LV003
  2960*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2961*                            VMOD 2.002                              CL**2
  2962*                                                               * ELCABEND
  2963*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2964*            AND THEN ABENDS.                                   * ELCABEND
  2965*                                                               * ELCABEND
  2966*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2967*                                                               * ELCABEND
  2968***************************************************************** ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  53
* EL583.cbl (/apps/prod/cid1p/copy/ELCABEND)
  2969*APS-010.                                                         ELCABEND
  2970     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2971     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2972                                                                  ELCABEND
  2973     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2974         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2975         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2976                                 UPON CONSOLE.                    ELCABEND
  2977                                                                  ELCABEND
  2978     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2979         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2980         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2981                                 UPON CONSOLE.                    ELCABEND
  2982                                                                  ELCABEND
  2983     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2984     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2985                                 UPON CONSOLE.                    ELCABEND
  2986                                                                  ELCABEND
  2987     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2988     CALL 'ABORTME'.
  2989                                                                  ELCABEND
  2990 APS-EXIT.                                                        ELCABEND
  2991     EXIT.                                                        ELCABEND
  2992
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116728     Code:       12733
