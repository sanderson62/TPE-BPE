* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* FNB165.cbl
* Options: int("FNB165.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB165.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB165.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB165.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*TITLE 'CID PAYMENTS AND ADJUSTMENTS INTERFACE'                   00010031
     2                                                                  00020030
     3 IDENTIFICATION DIVISION.                                         00030030
     4 PROGRAM-ID.    FNB165.                                           00040030
     5*AUTHOR         DAN DRYDEN.                                       00050030
     6*DATE-WRITTEN   MAY, 1998.                                        00060030
     7                                                                  00070030
     8***************************************************************** 00080030
     9*                         H I S T O R Y                         * 00090030
    10***************************************************************** 00100030
    11* NAME  DATE      DESCRIPTION                                   * 00110030
    12* ----  --------  --------------------------------------------- * 00120030
    13* DANA  01/01/99  CR#199801150013 - FREEDOM SYSTEM INSTALL      * 00130030
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* FNB165.cbl
    14* DANA  02/24/99  COMPILED FOR LOGIC Y2K COPYBOOK               * 00131038
    15* DANA  09/01/99  CR#1999072000004 - NEW FORMAT FOR SYS020      * 00132039
    16* DANA  02/16/01  CR#2001011600002 - REMOVE LOGIC ACCT MASTER   * 00133041
    17* DANA  06/22/01  CR#1999061000004 - REMOVE MSA CONVERSION FILE * 00134043
    18* SMVA  03/07/02  CR#2002021300008  ELIMINATE PLAN CODE TABLE
    19*                                 DEPENDENCIES
    20* PEMA 10/30/2002                  ADD PROCESSING FOR DCC
    21* PEMA 01/08/2003                  SEPARATE DCC FROM CID
    22* SMVA 06/05/2003 IR 2003060500003 CHECK FOR NULLS IN GL-ACCOUNT;
    23*                                  SKEWED REC LNGTH IN INTFCE FILE
    24* 122205    2005033100001  PEMA  ADD PROCESSING FOR CSI
    25* 101708    2008050500001  AJRA  ADD PROCESSING FOR CCC
    26* 022812    2011110200001  AJRA  ADD PROCESSING FOR AHL
    27* 081414    2014012300001  PEMA  ADD PROCESSING FOR CARRIER 7 DCC
    28***************************************************************** 00150030
    29                                                                  00160000
    30 ENVIRONMENT DIVISION.                                            00170000
    31 INPUT-OUTPUT SECTION.                                            00180000
    32 FILE-CONTROL.                                                    00190000
    33                                                                  00200000
    34     SELECT CID-PAYMENTS                                          00210000
    35         ASSIGN TO SYS010                                         00220000
    36         ORGANIZATION IS INDEXED                                  00230002
    37         ACCESS IS SEQUENTIAL                                     00240002
    38         RECORD KEY IS PY-CONTROL-PRIMARY                         00250002
    39         FILE STATUS IS SYS010-STATUS.                            00260000
    40                                                                  00270000
    41     SELECT WORK-FILE                                             00280000
    42         ASSIGN TO SYS011
    43         organization is line sequential.
    44
    45     SELECT CSI-WORK-FILE
    46         ASSIGN TO SYS012
    47         organization is line sequential.
    48
    49     SELECT CCC-WORK-FILE
    50         ASSIGN TO SYS013
    51         ORGANIZATION IS LINE SEQUENTIAL.
    52
    53     SELECT DISK-DATE        ASSIGN TO SYS019.
    54                                                                  00450000
    55 DATA DIVISION.                                                   00460000
    56 FILE SECTION.                                                    00470000
    57                                                                  00480000
    58 FD  CID-PAYMENTS.                                                00490017
*   59     COPY ERCPYAJ.                                                00500010
    60******************************************************************04/29/98
    61*                                                                *ERCPYAJ
    62*                            ERCPYAJ                             *   LV003
    63*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    64*                            VMOD=2.015                          *   CL**2
    65*                                                                *ERCPYAJ
    66*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *ERCPYAJ
    67*                                                                *ERCPYAJ
    68*                                                                *ERCPYAJ
    69*   FILE TYPE = VSAM,KSDS                                        *ERCPYAJ
    70*   RECORD SIZE = 200  RECFORM = FIXED                           *ERCPYAJ
    71*                                                                *ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* FNB165.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
    72*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *ERCPYAJ
    73*       ALTERNATE PATHS = NONE                                   *ERCPYAJ
    74*                                                                *ERCPYAJ
    75*   LOG = YES                                                    *ERCPYAJ
    76*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPYAJ
    77******************************************************************ERCPYAJ
    78******************************************************************
    79*                   C H A N G E   L O G
    80*
    81* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    82*-----------------------------------------------------------------
    83*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    84* EFFECTIVE    NUMBER
    85*-----------------------------------------------------------------
    86* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    87* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    88******************************************************************
    89                                                                  ERCPYAJ
    90 01  PENDING-PAY-ADJ.                                             ERCPYAJ
    91     12  PY-RECORD-ID                     PIC XX.                 ERCPYAJ
    92         88  VALID-PY-ID                        VALUE 'PY'.       ERCPYAJ
    93                                                                  ERCPYAJ
    94     12  PY-CONTROL-PRIMARY.                                      ERCPYAJ
    95         16  PY-COMPANY-CD                PIC X.                  ERCPYAJ
    96         16  PY-CARRIER                   PIC X.                  ERCPYAJ
    97         16  PY-GROUPING                  PIC X(6).               ERCPYAJ
    98         16  PY-FIN-RESP                  PIC X(10).              ERCPYAJ
    99         16  PY-ACCOUNT                   PIC X(10).              ERCPYAJ
   100         16  PY-PRODUCER REDEFINES PY-ACCOUNT                     ERCPYAJ
   101                                          PIC X(10).              ERCPYAJ
   102         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCPYAJ
   103         16  PY-RECORD-TYPE               PIC X.                  ERCPYAJ
   104             88  PY-REMIT-RECEIVED            VALUE 'R'.          ERCPYAJ
   105             88  PY-DEPOSIT                   VALUE 'D'.          ERCPYAJ
   106             88  PY-CHARGE-TO-AGENT           VALUE 'C'.          ERCPYAJ
   107             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.          ERCPYAJ
   108             88  PY-ADJ-DEPOSIT               VALUE 'T'.          ERCPYAJ
   109             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.          ERCPYAJ
   110             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.          ERCPYAJ
   111             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.          ERCPYAJ
   112             88  PY-ADD-TO-BALANCE            VALUE 'Z'.          ERCPYAJ
   113             88  PY-FICA-ENTRY                VALUE 'F'.          ERCPYAJ
   114             88  PY-REMIT-IND-GROUPING        VALUE 'G'.          ERCPYAJ
   115             88  PY-POLICY-FEE                VALUE 'W'.          ERCPYAJ
   116             88  PY-DUE-PREM-ADJ              VALUE 'P'.
   117                                                                  ERCPYAJ
   118     12  PY-PYMT-TYPE                     PIC X.                  ERCPYAJ
   119             88  PY-NEW-BUS-PYMT              VALUE 'B'.          ERCPYAJ
   120             88  PY-REINS-PYMT                VALUE 'R'.          ERCPYAJ
   121             88  PY-EXP-PYMT                  VALUE 'E'.          ERCPYAJ
   122                                                                  ERCPYAJ
   123     12  PY-BIL-INV                       PIC X(6).               ERCPYAJ
   124     12  PY-REF-NO                        PIC X(12).              ERCPYAJ
   125                                                                  ERCPYAJ
   126     12  PY-LAST-MAINT-DT                 PIC XX.                 ERCPYAJ
   127     12  PY-LAST-MAINT-BY                 PIC X(4).               ERCPYAJ
   128     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPYAJ
   129                                                                  ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* FNB165.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
   130     12  PY-PYADJ-RECORD.                                         ERCPYAJ
   131         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.   ERCPYAJ
   132         16  PY-ENTRY-COMMENT             PIC X(30).              ERCPYAJ
   133         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.               000
   134             20  PY-GL-ACCOUNT            PIC X(10).                   000
   135             20  PY-GL-STATE              PIC X(02).                   000
   136             20  PY-GL-CANC-SW            PIC X(01).                   000
   137                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.                   000
   138                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.                   000
   139             20  PY-GL-COMMENT            PIC X(10).                   000
   140             20  FILLER      REDEFINES PY-GL-COMMENT.                  000
   141                 24  PY-GL-CHECK-NO       PIC 9(06).                   000
   142                 24  FILLER               PIC X(04).                   000
   143             20  FILLER                   PIC X(07).                   ERC
   144         16  PY-SAVE-ACCOUNT              PIC X(10).              ERCPYAJ
   145         16  PY-SAVE-TYPE                 PIC X(01).              ERCPYAJ
   146                                                                  ERCPYAJ
   147         16  PY-LETTERS.                                          ERCPYAJ
   148             20  PY-LETTER OCCURS 3 TIMES                         ERCPYAJ
   149                           INDEXED BY PY-LET-NDX                  ERCPYAJ
   150                                          PIC X(04).              ERCPYAJ
   151                                                                  ERCPYAJ
   152         16  PY-ERCOMP-TYPE               PIC X.
   153             88  PY-ACCOUNT-TYPE              VALUE 'A'.
   154             88  PY-GA-TYPE                   VALUE 'G'.
   155             88  PY-BANK-TYPE                 VALUE 'B'.
   156         16  FILLER                       PIC X(05).
   157                                                                  ERCPYAJ
   158     12  PY-RECORD-STATUS.                                        ERCPYAJ
   159         16  PY-CREDIT-SELECT-DT          PIC XX.                 ERCPYAJ
   160         16  PY-CREDIT-ACCEPT-DT          PIC XX.                 ERCPYAJ
   161         16  PY-BILLED-DATE               PIC XX.                 ERCPYAJ
   162         16  PY-REPORTED-DT               PIC XX.                 ERCPYAJ
   163         16  PY-PMT-APPLIED               PIC X.                  ERCPYAJ
   164             88  PY-ACCOUNT-PMT               VALUE 'A'.          ERCPYAJ
   165             88  PY-GA-PMT                    VALUE 'G'.          ERCPYAJ
   166             88  PY-OVWRITE-PMT               VALUE 'O'.          ERCPYAJ
   167             88  PY-NON-AR-PMT                VALUE 'N'.          ERCPYAJ
   168         16  FILLER                       PIC X(5).               ERCPYAJ
   169         16  PY-INPUT-DT                  PIC XX.                 ERCPYAJ
   170         16  PY-CHECK-NUMBER              PIC X(6).               ERCPYAJ
   171         16  PY-VOID-SW                   PIC X.                  ERCPYAJ
   172             88  PY-CHECK-VOIDED              VALUE 'V'.          ERCPYAJ
   173         16  PY-CHECK-ORIGIN-SW           PIC X.                  ERCPYAJ
   174             88  PY-BILLING-CHECK             VALUE 'B'.          ERCPYAJ
   175             88  PY-REFUND-CHECK              VALUE 'R'.          ERCPYAJ
   176             88  PY-GA-CHECK                  VALUE 'G'.          ERCPYAJ
   177             88  PY-CHECK-WRITTEN             VALUE 'W'.          ERCPYAJ
   178             88  PY-CHECK-REVERSAL            VALUE 'V'.          ERCPYAJ
   179         16  PY-CHECK-WRITTEN-DT          PIC XX.                 ERCPYAJ
   180         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.         ERCPYAJ
   181         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.         ERCPYAJ
   182         16  PY-BILL-FLAG                 PIC X.                  ERCPYAJ
   183             88  PY-BILLED                    VALUE 'B'.          ERCPYAJ
   184         16  PY-AR-FLAG                   PIC X.                  ERCPYAJ
   185             88  PY-AR-CYCLE                  VALUE 'C'.          ERCPYAJ
   186             88  PY-AR-MONTH-END              VALUE 'M'.          ERCPYAJ
   187         16  PY-AR-DATE                   PIC XX.                 ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* FNB165.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
   188                                                                  ERCPYAJ
   189     12  PY-GL-CODES.                                             ERCPYAJ
   190         16  PY-GL-DB                     PIC X(14).              ERCPYAJ
   191         16  PY-GL-CR                     PIC X(14).              ERCPYAJ
   192         16  PY-GL-FLAG                   PIC X.                  ERCPYAJ
   193         16  PY-GL-DATE                   PIC XX.                 ERCPYAJ
   194                                                                  ERCPYAJ
   195     12  PY-CANCEL-FEE-FLAG               PIC X(2).               ERCPYAJ
   196     12  FILLER                           PIC X(3).               ERCPYAJ
   197******************************************************************ERCPYAJ
   198
   199                                                                  00510000
   200 FD  WORK-FILE
   201     LABEL RECORDS ARE STANDARD
   202     RECORDING MODE IS F
   203     BLOCK CONTAINS 0 RECORDS.
   204 01  WORK-RECORD.
*  205     COPY FNC022.
   206     05  FX-COMMON-SECTION.                                       00010001
   207         10  FX-SYSTEM             PIC X(10).                     00020001
   208         10  FX-SOURCE-CODE        PIC X(6).                      00030001
   209         10  FX-DIVISION           PIC X(2).                      00040001
   210         10  FX-TRAN-TYPE          PIC X(2).                      00050001
   211         10  FX-SUB-TYPE           PIC X(2).                      00060001
   212         10  FX-CLM-RES            PIC X(2).                      00070001
   213         10  FX-ANN-STMT           PIC X(3).                      00080001
   214         10  FX-PLAN-CODE          PIC X(6).                      00090001
   215         10  FX-FORM               PIC X(3).                      00091001
   216         10  FX-JOURNAL-DATE       PIC X(8).                      00092001
   217         10  FX-POSTING-DATE       PIC X(8).                      00093001
   218         10  FX-POLICY-NO          PIC X(10).                     00094001
   219         10  FX-CITY               PIC X(30).                     00095002
   220         10  FX-STATE              PIC X(2).                      00095102
   221         10  FX-ZIP-CODE           PIC X(9).                      00096001
   222         10  FX-LOC-CODE           PIC X.                         00096102
   223         10  FX-FY-REN             PIC X.                         00097001
   224         10  FX-AGENT-01           PIC X(9).                      00098001
   225         10  FX-AGENT-50           PIC X(9).                      00099001
   226         10  FX-COST-CENTER        PIC X(4).                      00100001
   227         10  FX-TAXABLE            PIC X.                         00110004
   228         10  FX-DISTR              PIC X(2).                      00120001
   229         10  FX-SOURCE-ACCT        PIC X(10).                     00130001
   230         10  FX-DESCRIPTION        PIC X(30).                     00140001
   231         10  FX-REFERENCE          PIC X(10).                     00150001
   232         10  FX-SUSPENSE           PIC X(15).                     00151002
   233         10  FX-AMOUNT             PIC S9(10)V99                  00160001
   234                                   SIGN IS TRAILING SEPARATE.     00170001
   235                                                                  00180001
   236     05  FX-CLAIM-SECTION.                                        00190001
   237         10  FX-CLAIM-NO           PIC X(10).                     00200001
   238         10  FX-CLAIM-TYPE         PIC X.                         00210001
   239         10  FX-DRAFT-NO           PIC X(10).                     00220001
   240         10  FX-DRAFT-STATUS       PIC X.                         00230001
   241         10  FX-TAX-ID             PIC X(10).                     00240001
   242         10  FILLER                PIC X(10).                     00250003
   243                                                                  00290001
   244
   245
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* FNB165.cbl
   246 FD  CSI-WORK-FILE
   247     LABEL RECORDS ARE STANDARD
   248     RECORDING MODE IS F
   249     BLOCK CONTAINS 0 RECORDS.
   250 01  CSI-WORK-RECORD             PIC X(250).
   251
   252 FD  CCC-WORK-FILE
   253     LABEL RECORDS ARE STANDARD
   254     RECORDING MODE IS F
   255     BLOCK CONTAINS 0 RECORDS.
   256 01  CCC-WORK-RECORD             PIC X(250).
   257
   258 FD  DISK-DATE
*  259     COPY ELCDTEFD.
   260******************************************************************04/15/98
   261*                                                                *ELCDTEFD
   262*                                                                *ELCDTEFD
   263*                            ELCDTEFD.                           *   LV002
   264*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   265*                            VMOD=2.007                          *   CL**2
   266*                                                                *ELCDTEFD
   267******************************************************************ELCDTEFD
   268     BLOCK CONTAINS 0 RECORDS
   269     RECORDING MODE F.                                            ELCDTEFD
   270                                                                  ELCDTEFD
   271 01  DATE-DISK.                                                   ELCDTEFD
   272     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   273     12  FILLER                      PIC  X(14).                  ELCDTEFD
   274     12  DD-CR1                      PIC  9.                      ELCDTEFD
   275     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   276     12  DD-CR2                      PIC  9.                      ELCDTEFD
   277     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   278     12  FILLER                      PIC  X(20).                  ELCDTEFD
   279                                                                  ELCDTEFD
   280 01  DATE-DISK-R.                                                 ELCDTEFD
   281     12  FILLER                      PIC  X(4).                   ELCDTEFD
   282     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   283                                     PIC  X(32).                  ELCDTEFD
   284                                                                  ELCDTEFD
   285 01  DATE-DISK-T.                                                 ELCDTEFD
   286     12  FILLER                      PIC  X(4).                   ELCDTEFD
   287     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   288                                     PIC  X(48).                  ELCDTEFD
   289                                                                  ELCDTEFD
   290 01  DATE-DISK-M.                                                 ELCDTEFD
   291     12  FILLER                      PIC  X(4).                   ELCDTEFD
   292     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   293                                     PIC  X(48).                  ELCDTEFD
   294                                                                  ELCDTEFD
   295 01  DATE-DISK-P.                                                 ELCDTEFD
   296     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   297     12  DD-IDX                      PIC  99.                     ELCDTEFD
   298     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   299     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   300         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   301                                     PIC  X.                      ELCDTEFD
   302         16  FILLER                  PIC  X(46).                  ELCDTEFD
   303     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   304         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   305             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   306             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   307             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   308             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   309         16  FILLER                  PIC  X(16).                  ELCDTEFD
   310                                                                  ELCDTEFD
   311 01  DATE-DISK-E.                                                 ELCDTEFD
   312     12  FILLER                      PIC  X(4).                   ELCDTEFD
   313     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   314                                     PIC  X(4).                   ELCDTEFD
   315                                                                  ELCDTEFD
   316 01  DATE-DISK-C.                                                 ELCDTEFD
   317     12  FILLER                      PIC  X(7).                   ELCDTEFD
   318     12  DD-CARR1-SECPAY-SW          PIC  X.
   319     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   320     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   321     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   322     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   323     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   324     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   325     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   326     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   327     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   328     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   329     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   330     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   331     12  DD-CARR2-SECPAY-SW          PIC  X.
   332     12  FILLER                      PIC  X(7).                   ELCDTEFD
   333                                                                  ELCDTEFD
   334 01  DATE-DISK-OPT.                                               ELCDTEFD
   335     12  FILLER                      PIC  X(04).                  ELCDTEFD
   336     12  DD-TLR-DATA.                                             ELCDTEFD
   337         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   338                                     PIC  X(03).                  ELCDTEFD
   339     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   340         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   341                                     PIC  X(06).                  ELCDTEFD
   342     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   343         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   344                                     PIC  X(07).                  ELCDTEFD
   345         16  FILLER                  PIC  X(05).                  ELCDTEFD
   346     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   347                                     PIC  X(96).                  ELCDTEFD
   348******************************************************************ELCDTEFD
   349
   350                                                                  00700000
   351 WORKING-STORAGE SECTION.                                         00710000
   352                                                                  00720000
   353 01  FILLER.                                                      00730000
   354     05  WS-ZERO                 PIC S9(3)  COMP-3  VALUE +0.
   355     05  WS-ABEND-MESSAGE        PIC X(80)  VALUE SPACES.
   356     05  PGM-SUB                 PIC S9(4) COMP VALUE +310.
   357     05  WS-RETURN-CODE          PIC S999  COMP-3 VALUE +0.
   358     05  DUMP                PIC X         VALUE ' '.             00740000
   359     05  FORCE-DUMP REDEFINES DUMP PIC S9 COMP-3.                 00750000
   360     05  SYS010-STATUS       PIC XX        VALUE '00'.            00780029
   361         88  EOF                           VALUE '10'.            00790000
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* FNB165.cbl
   362     05  WS-PREV-DATE        PIC XX.                              00800010
   363     05  WS-CURR-DATE        PIC XX.                              00810010
   364     05  WS-SUSPENSE.                                             00820026
   365         10  WS-FIN-RESP     PIC X(7).                            00830027
   366         10  WS-CID-ACCT     PIC X(8).                            00840027
   367                                                                  00850026
*  368 COPY ELCDATE.
   369******************************************************************06/11/98
   370*                                                                *ELCDATE
   371*                                                                *ELCDATE
   372*                            ELCDATE.                            *   LV023
   373*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   374*                            VMOD=2.003                           ELCDATE
   375*                                                                *ELCDATE
   376*                                                                *ELCDATE
   377*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   378*                 LENGTH = 200                                   *   CL*19
   379******************************************************************ELCDATE
   380                                                                  ELCDATE
   381 01  DATE-CONVERSION-DATA.                                        ELCDATE
   382     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   383     12  DC-OPTION-CODE                PIC X.                        CL*15
   384         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   385         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   386         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   387         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   388         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   389         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   390         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   391         88  FIND-CENTURY               VALUE '7'.                   CL*22
   392         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   393         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   394         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   395         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   396         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   397         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   398         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   399         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   400         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   401         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   402         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   403         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   404         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   405         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   406         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   407         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   408         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   409         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   410         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   411         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   412         88  THREE-CHARACTER-BIN                                  ELCDATE
   413                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   414         88  GREGORIAN-TO-BIN                                        CL**2
   415                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   416         88  BIN-TO-GREGORIAN                                        CL**2
   417                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   418         88  JULIAN-TO-BINARY                                        CL**2
   419                  VALUES '5' 'C' 'E' 'F'.                            CL*14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDATE)
   420     12  DC-ERROR-CODE                 PIC X.                        CL*15
   421         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   422         88  DATE-CONVERSION-ERROR                                ELCDATE
   423                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   424         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   425         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   426         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   427         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   428         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   429         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   430         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   431         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   432         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   433         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   434     12  DC-END-OF-MONTH               PIC X.                        CL*15
   435         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   436     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   437         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   438         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   439         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   440     12  FILLER                        PIC X.                        CL*15
   441     12  DC-CONVERSION-DATES.                                        CL*15
   442         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   443         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   444         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   445         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   446                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   447             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   448             20  SLASH1-1              PIC X.                        CL*15
   449             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   450             20  SLASH1-2              PIC X.                        CL*15
   451             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   452         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   453         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   454                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   455             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   456             20  SLASH2-1              PIC X.                        CL*15
   457             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   458             20  SLASH2-2              PIC X.                        CL*15
   459             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   460         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   461         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   462                     DC-GREG-DATE-1-YMD.                          ELCDATE
   463             20  DC-YMD-YEAR           PIC 99.                       CL*15
   464             20  DC-YMD-MONTH          PIC 99.                       CL*15
   465             20  DC-YMD-DAY            PIC 99.                       CL*15
   466         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   467         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   468                      DC-GREG-DATE-1-MDY.                         ELCDATE
   469             20  DC-MDY-MONTH          PIC 99.                       CL*15
   470             20  DC-MDY-DAY            PIC 99.                       CL*15
   471             20  DC-MDY-YEAR           PIC 99.                       CL*15
   472         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   473             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   474             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   475             20  FILLER                PIC XX.                       CL*15
   476             20  DC-ALPHA-CENTURY.                                   CL*15
   477                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDATE)
   478             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   479         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   480         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   481         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   482         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   483         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   484                                       PIC 9(05).                    CL*20
   485         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   486             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   487             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   488         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   489         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   490         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   491     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   492         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   493         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   494             20  FILLER                PIC 9(3).                     CL*15
   495             20  HOLD-CEN-1-CCYY.                                    CL*15
   496                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   497                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   498             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   499             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   500         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   501             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   502             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   503             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   504                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   505                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   506             20  FILLER                PIC 9(3).                     CL*15
   507         16  HOLD-CENTURY-1-X.                                       CL*15
   508             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   509             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   510                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   511                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   512             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   513             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   514         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   515             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   516             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   517             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   518                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   519                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   520             20  FILLER                PIC XXX.                      CL*23
   521         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   522         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   523         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   524         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   525             20  DC-JULIAN-1-CCYY.                                   CL*15
   526                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   527                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   528             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   529         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   530         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   531             20  DC-JULIAN-2-CCYY.                                   CL*15
   532                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   533                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   534             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   535         16  DC-GREG-DATE-A-EDIT.                                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDATE)
   536             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   537             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   538             20  DC-EDITA-DAY          PIC 99.                       CL*15
   539             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   540             20  DC-EDITA-CCYY.                                      CL*15
   541                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   542                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   543         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   544             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   545             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   546             20  DC-EDITB-DAY          PIC 99.                       CL*15
   547             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   548             20  DC-EDITB-CCYY.                                      CL*15
   549                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   550                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   551         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   552         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   553                              DC-GREG-DATE-CYMD.                  ELCDATE
   554             20  DC-CYMD-CEN           PIC 99.                       CL*15
   555             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   556             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   557             20  DC-CYMD-DAY           PIC 99.                       CL*15
   558         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   559         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   560                              DC-GREG-DATE-MDCY.                  ELCDATE
   561             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   562             20  DC-MDCY-DAY           PIC 99.                       CL*15
   563             20  DC-MDCY-CEN           PIC 99.                       CL*15
   564             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   565    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   566        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   567    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   568    12  FILLER                         PIC X(28).                    CL*26
   569
   570
   571 01  SYSTEM-DATE.
   572     05  SYS-MO         PIC 9(2).
   573     05  SYS-DA         PIC 9(2).
   574     05  SYS-CCYY       PIC 9(4).
   575
   576
   577* FUNCTION-DATE COPYBOOK
*  578                                      COPY ELCFUNDT.
   579***************************************************************** 12/03/98
   580*                                                               * ELCFUNDT
   581*                            ELCFUNDT.                          *    LV004
   582*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
   583*                            VMOD=2.001                         * ELCFUNDT
   584*                                                               * ELCFUNDT
   585*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
   586*                                                               * ELCFUNDT
   587***************************************************************** ELCFUNDT
   588                                                                  ELCFUNDT
   589                                                                  ELCFUNDT
   590 01  FUNCTION-DATE.                                                  CL**2
   591     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
   592     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
   593         10  WS-FN-CCYR            PIC 9(4).                         CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* FNB165.cbl (/apps/prod/cid1p/copy/ELCFUNDT)
   594         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
   595             15  WS-FN-CC          PIC 99.                           CL**3
   596             15  WS-FN-YR          PIC 99.                           CL**3
   597         10  WS-FN-MO              PIC 99.                           CL**3
   598         10  WS-FN-DA              PIC 99.                           CL**3
   599     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
   600     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
   601     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
   602     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
   603     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
   604         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
   605         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
   606         88  WS-NO-GMT                         VALUE ZERO.           CL**2
   607     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
   608     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
   609
   610
   611* STATE EDIT TABLE
*  612 COPY FNC018.
   613***************************************************************** 00020002
   614*                                                               * 00030002
   615*                     STATE CODE TABLE                          * 00040002
   616*                                                               * 00050002
   617*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     * 00060002
   618*            SEARCH VERB WILL NOT WORK PROPERLY !               * 00070002
   619*                                                               * 00080002
   620***************************************************************** 00090002
   621*                                                                 00100002
   622 01  STATE-VALUES.                                                00110002
   623     05  PIC X(24)  VALUE 'AKAKALASKA              '.             00120002
   624     05  PIC X(24)  VALUE 'ALALALABAMA             '.             00130002
   625     05  PIC X(24)  VALUE 'ARARARKANSAS            '.             00140002
   626     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.             00150002
   627     05  PIC X(24)  VALUE 'AZAZARIZONA             '.             00160002
   628     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.             00170002
   629     05  PIC X(24)  VALUE 'CDCNCANADA              '.             00180002
   630     05  PIC X(24)  VALUE 'CNCNCANADA              '.             00190002
   631     05  PIC X(24)  VALUE 'COCOCOLORADO            '.             00200002
   632     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.             00210002
   633     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.             00220002
   634     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.             00230002
   635     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.             00240002
   636     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.             00250002
   637     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.             00260002
   638     05  PIC X(24)  VALUE 'GUGUGUAM                '.             00270002
   639     05  PIC X(24)  VALUE 'HIHIHAWAII              '.             00280002
   640     05  PIC X(24)  VALUE 'IAIAIOWA                '.             00290002
   641     05  PIC X(24)  VALUE 'IDIDIDAHO               '.             00300002
   642     05  PIC X(24)  VALUE 'ILILILLINOIS            '.             00310002
   643     05  PIC X(24)  VALUE 'INININDIANA             '.             00320002
   644     05  PIC X(24)  VALUE 'KSKSKANSAS              '.             00330002
   645     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.             00340002
   646     05  PIC X(24)  VALUE 'LALALOUISIANA           '.             00350002
   647     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.             00360002
   648     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.             00370002
   649     05  PIC X(24)  VALUE 'MEMEMAINE               '.             00380002
   650     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.             00390002
   651     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.             00400002
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* FNB165.cbl (/apps/prod/cid1p/copy/FNC018)
   652     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.             00410002
   653     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.             00420002
   654     05  PIC X(24)  VALUE 'MTMTMONTANA             '.             00430002
   655     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.             00440002
   656     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.             00450002
   657     05  PIC X(24)  VALUE 'NENENEBRASKA            '.             00460002
   658     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.             00470002
   659     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.             00480002
   660     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.             00490002
   661     05  PIC X(24)  VALUE 'NVNVNEVADA              '.             00500002
   662     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.             00510002
   663     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.             00520002
   664     05  PIC X(24)  VALUE 'OHOHOHIO                '.             00530002
   665     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.             00540002
   666     05  PIC X(24)  VALUE 'OROROREGON              '.             00550002
   667     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.             00560002
   668     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.             00570002
   669     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.             00580002
   670     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.             00590002
   671     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.             00600002
   672     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.             00610002
   673     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.             00620002
   674     05  PIC X(24)  VALUE 'TXTXTEXAS               '.             00630002
   675     05  PIC X(24)  VALUE 'UTUTUTAH                '.             00640002
   676     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.             00650002
   677     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.             00660002
   678     05  PIC X(24)  VALUE 'VTVTVERMONT             '.             00670002
   679     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.             00680002
   680     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.             00690002
   681     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.             00700002
   682     05  PIC X(24)  VALUE 'WYWYWYOMING             '.             00710002
   683                                                                  00720002
   684 01  FILLER REDEFINES STATE-VALUES.                               00730002
   685     05  STATE-TABLE                                              00740002
   686             OCCURS 60 TIMES                                      00750002
   687             ASCENDING KEY IS ST-STATE                            00760002
   688             INDEXED BY ST-INDEX.                                 00770002
   689         10  ST-STATE          PIC XX.                            00780002
   690         10  ST-ALT-STATE      PIC XX.                            00790002
   691         10  ST-NAME           PIC X(20).                         00800002
   692                                                                  00810002
   694
*  695     COPY ELCDTECX.
   696******************************************************************06/05/98
   697*                                                                *ELCDTECX
   698*                            ELCDTECX.                           *   LV005
   699*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   700*                            VMOD=2.015                          *ELCDTECX
   701*                                                                *ELCDTECX
   702*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   703*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   704*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   705*                                                                *ELCDTECX
   706******************************************************************ELCDTECX
   707******************************************************************
   708*                   C H A N G E   L O G
   709*
   710* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   711*-----------------------------------------------------------------
   712*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   713* EFFECTIVE    NUMBER
   714*-----------------------------------------------------------------
   715* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   716*                                  BENEFIT CODES FROM 300 TO 900
   717* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   718* 051304    2003080800002  SMVA  ADD REFUND METHOD
   719* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   720******************************************************************
   721 01  DATE-CARD.                                                   ELCDTECX
   722     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   723     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   724     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   725     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   726     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   727     12  EP-SW                       PIC  X.                      ELCDTECX
   728         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   729     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   730         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   731     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   732     12  RUN-CENTURY.                                             ELCDTECX
   733         16 RUN-CENTURY-N            PIC  99.                        CL**4
   734     12  FILLER                      PIC  X.                         CL**4
   735     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   736     12  FILLER                      PIC  XXX.                    ELCDTECX
   737     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   738                                                                  ELCDTECX
   739 01  FILLER                          PIC  X(7)                       CL**6
   740                                          VALUE 'OPTIONS'.        ELCDTECX
   741 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   742     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   743     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   744     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   745         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   746         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   747     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   748     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   749     12  FILLER                      PIC  X.                      ELCDTECX
   750     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   751     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   752     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   753     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   754     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   755     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   756     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   757     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   758     12  FILLER                      PIC  X.                      ELCDTECX
   759     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   760     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   761     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   762     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   763     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   764     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   765     12  FILLER                      PIC  X.                      ELCDTECX
   766     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   767     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   768     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   769     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   770     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   771     12  DTE-R78                     PIC  X.                      ELCDTECX
   772     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   773     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   774     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   775     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   776     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   777     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   778     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   779                                     PIC  X.                      ELCDTECX
   780         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   781                                                 ' '.             ELCDTECX
   782         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   783         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   784     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   785         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   786         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   787     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   788     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   789                                     PIC  9.                         CL**4
   790     12  DTE-SYSTEM.                                              ELCDTECX
   791         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   792         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   793         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   794         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   795         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   796         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   797         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   798         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   799         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   800         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   801         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   802         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   803         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   804         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   805         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   806         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   807         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   808         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   809         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   810         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   811         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   812         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   813         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   814         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   815         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   816         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   817     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   818         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   819                                     PIC  X.                      ELCDTECX
   820     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   821                                                                  ELCDTECX
   822 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   823     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   824     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   825     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   826*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   827     12  FILLER                      PIC  X.                      ELCDTECX
   828     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   829     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   830     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   831     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   832     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   833     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   834     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   835                                                                  ELCDTECX
   836     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   837     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   838     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   839     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   840                                                                  ELCDTECX
   841     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   842     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   843     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   844     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   845                                                                  ELCDTECX
   846     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   847     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   848                                                                  ELCDTECX
   849     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   850     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   851                                                                  ELCDTECX
   852     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   853                                                                  ELCDTECX
   854 01  DATE-CARD-FACTORS.                                           ELCDTECX
   855     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   856     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   857     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   858     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   859     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   860     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   861     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   862                                                                  ELCDTECX
   863 01  FILLER                          PIC  X(12)                   ELCDTECX
   864                                          VALUE 'COMPANY NAME'.   ELCDTECX
   865 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   866     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   867         16  CNT-ID                  PIC  X.                      ELCDTECX
   868         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   869                                                                  ELCDTECX
   870 01  FILLER                          PIC  X(11)                   ELCDTECX
   871                                          VALUE 'STATE NAMES'.    ELCDTECX
   872 01  STATE-NAMES.                                                 ELCDTECX
   873     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   874         16  STATE-SUB               PIC  XX.                     ELCDTECX
   875         16  STATE-PIC1.                                          ELCDTECX
   876             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   877             20  FILLER              PIC  XXX.                    ELCDTECX
   878             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   879             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   880             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   881             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   882                                                                  ELCDTECX
   883 01  FILLER                          PIC  X(13)                   ELCDTECX
   884                                          VALUE 'CARRIER NAMES'.  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   885 01  CARRIER-NAMES.                                               ELCDTECX
   886     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   887         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   888         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   889         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   890         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   891         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   892         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   893*        16  FILLER                  PIC  X.                      ELCDTECX
   894         16  CARRIER-SEC-PAY         PIC  X.
   895             88  SEC-PAY-CARRIER          VALUE 'Y'.
   896                                                                  ELCDTECX
   897 01  FILLER                          PIC  X(9)                       CL**6
   898                                          VALUE 'INS TYPES'.      ELCDTECX
   899 01  CLAS-INS-TYPES.                                              ELCDTECX
   900*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   901     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   902         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   903         16  CLAS-I-AB3.                                          ELCDTECX
   904             20  FILLER              PIC  X.                      ELCDTECX
   905             20  CLAS-I-AB2.                                      ELCDTECX
   906                 24  FILLER          PIC  X.                      ELCDTECX
   907                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   908         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   909             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   910             20  FILLER              PIC  X.                         CL**4
   911         16  CLAS-I-AB10.                                         ELCDTECX
   912             20  FILLER              PIC  X(9).                   ELCDTECX
   913             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   914         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   915         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   916         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   917         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   918             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   919         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   920         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   921         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   922         16  CLAS-I-BEN-CATEGORY     PIC  X.
   923         16  CLAS-I-REFUND-METHOD    PIC  X.
   924         16  CLAS-I-MAX-BENEFITS     PIC 99.
   925         16  FILLER                  PIC  XXX.
   926                                                                  ELCDTECX
   927 01  FILLER                          PIC  X(16)                   ELCDTECX
   928                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   929 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   930     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   931                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   932         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   933         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   934         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   935         16  CLAS-MORT-DESC.                                      ELCDTECX
   936             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   937             20  FILLER              PIC  XX.                        CL**5
   938             20  CLAS-YEAR           PIC  X(4).                      CL**6
   939             20  FILLER              PIC  X.                         CL**5
   940             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   941             20  FILLER              PIC  X.                         CL**5
   942             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   943             20  FILLER              PIC  X.                         CL**5
   944             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   945             20  FILLER              PIC  X(5).                      CL**6
   946                                                                  ELCDTECX
   947 01  FILLER                          PIC  X(15)                   ELCDTECX
   948                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   949 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   950     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   951         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   952         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   953         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   954         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   955         16  FILLER                  PIC  X(4).                      CL**6
   956                                                                  ELCDTECX
   957 01  FILLER                          PIC  X(7)                       CL**6
   958                                     VALUE 'INDEXES'.             ELCDTECX
   959 01  CLAS-INDEX-TBL.                                              ELCDTECX
   960     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   961     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   962     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   963     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   964     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   965     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   966     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   967     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   968     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   969     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   970     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   971     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   972     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   973     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   974     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   975     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   976     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   977                                                                  ELCDTECX
   978 01  CLAS-TYPE-MISC.                                              ELCDTECX
   979     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   980     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   981     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   982     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   983     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   984     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   985     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   986     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   987     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   988     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   989     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   990                                                                  ELCDTECX
   991 01  FILLER                          PIC  X(13)                   ELCDTECX
   992                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   993 01  CLAS-MISC.                                                   ELCDTECX
   994     12  DTE-FICH                    PIC  X.                      ELCDTECX
   995         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   996         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   997         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   998     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   999     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1000     12  DTE-PGM-OPT                 PIC  9.                         CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1001     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1002     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1003     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1004     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1005     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1006     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1007     12  STATE-L                     PIC  XX.                     ELCDTECX
  1008     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1009     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1010     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1011         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1012         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1013     12  DTE-ABEND-WORK.                                          ELCDTECX
  1014         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1015         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1016                                                                  ELCDTECX
  1017 01  FILLER                          PIC  X(12)                   ELCDTECX
  1018                                     VALUE 'WORKING DATE'.        ELCDTECX
  1019 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1020     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1021         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1022         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1023         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1024     12  WS-CURRENT-DATE.                                         ELCDTECX
  1025         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1026         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1027         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1028         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1029         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1030     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1031         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1032         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1033                                                                  ELCDTECX
  1034 01  FILLER                          PIC  X(12)                   ELCDTECX
  1035                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1036 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1037     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1038         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1039         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1040         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1041                                                                  ELCDTECX
  1042 01  FILLER                          PIC  X(10)                   ELCDTECX
  1043                                     VALUE 'STATE TLRS'.          ELCDTECX
  1044 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1045     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1046         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1047         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1048                                                                  ELCDTECX
  1049 01  FILLER                          PIC  X(13)                   ELCDTECX
  1050                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1051 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1052     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1053         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1054                                                                  ELCDTECX
  1055 01  FILLER                          PIC  X(13)                   ELCDTECX
  1056                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1057 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1058     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1059     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1060     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1061                                     PIC  X.                         CL**5
  1062     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1063     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1064     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1065     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1066     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1067     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1068     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1069     12  FILLER                      PIC  X(75).                  ELCDTECX
  1070******************************************************************ELCDTECX
  1071*01  MISC-CARR-PCT-DATA.                                          00001521
  1072*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1073*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1074*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1075*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1076*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1077*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1078******************************************************************ELCDTECX
* 1079     COPY ELCDTEVR.
  1080***************************************************************** 04/15/98
  1081*                                                                *ELCDTEVR
  1082*                                                                *ELCDTEVR
  1083*                            ELCDTEVR.                           *   LV003
  1084*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1085*                            VMOD=2.001                          *   CL**2
  1086*                                                                *ELCDTEVR
  1087*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1088*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1089*                                                                *ELCDTEVR
  1090******************************************************************ELCDTEVR
  1091 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1092     05  WS-RUN-DATE.                                             ELCDTEVR
  1093         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1094         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1095         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1096             15  RUN-CC              PIC  99.                     ELCDTEVR
  1097             15  RUN-YR              PIC  99.                     ELCDTEVR
  1098         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1099         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1100     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1101            WS-RUN-DATE              PIC 9(11).                      CL**2
  1102     05  WS-EP-DT.                                                ELCDTEVR
  1103         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1104         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1105         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1106             15  EP-CC               PIC  99.                     ELCDTEVR
  1107             15  EP-YR               PIC  99.                     ELCDTEVR
  1108         10  EP-MO                   PIC  99.                     ELCDTEVR
  1109         10  EP-DA                   PIC  99.                     ELCDTEVR
  1110     05  WS-EP-DT-N REDEFINES                                        CL**2
  1111            WS-EP-DT                 PIC 9(11).                      CL**2
  1112     05  WS-DTE-CONV-DT.                                             CL**4
  1113         10  FILLER                  PIC  9(03).                     CL**4
  1114         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1115         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1116             15  DTE-CONV-CC         PIC  99.                        CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1117             15  DTE-CONV-YR         PIC  99.                        CL**4
  1118         10  DTE-CONV-MO             PIC  99.                        CL**4
  1119         10  DTE-CONV-DA             PIC  99.                        CL**4
  1120     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1121            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1122 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1123     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1124         10  FILLER                            PIC 999.           ELCDTEVR
  1125         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1126         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1127             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1128             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1129         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1130         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1131     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1132            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1133     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1134         10  FILLER                            PIC 999.           ELCDTEVR
  1135         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1136         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1137         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1138         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1139     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1140            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1141 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1142     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1143         10  FILLER                            PIC 999.           ELCDTEVR
  1144         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1145         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1146             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1147             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1148         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1149         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1150     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1151            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1152     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1153         10  FILLER                            PIC 999.           ELCDTEVR
  1154         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1155         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1156             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1157             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1158         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1159         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1160     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1161            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1162     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1163         10  FILLER                            PIC 999.           ELCDTEVR
  1164         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1165         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1166             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1167             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1168         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1169         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1170     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1171            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1172 01  WS-RATE-RECORD.                                              ELCDTEVR
  1173         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1174             10  FILLER                        PIC 999.           ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1175             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1176             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1177                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1178                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1179             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1180             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1181         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1182                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1183
  1184 LINKAGE SECTION.                                                 00950032
  1185                                                                  00960032
  1186 01  PARM.                                                        00970032
  1187     05  PARM-LENGTH      PIC S9(4)  COMP.                        00980032
  1188     05  PARM-PREV-DATE   PIC X(8).                               00990032
  1189     05  FILLER           PIC X.                                  01000032
  1190     05  PARM-CURR-DATE   PIC X(8).                               01010032
  1191                                                                  01020032
  1192                                                                  01030032
  1193                                                                  01040032
  1194*                                                                 01070032
  1195 PROCEDURE DIVISION USING PARM.                                   01080032
  1196*                                                                 01090000
  1197*************************************************************
* 1198                                 COPY ELCDTERX.
  1199******************************************************************04/15/98
  1200*                                                                *ELCDTERX
  1201*                                                                *ELCDTERX
  1202*                            ELCDTERX.                           *   LV002
  1203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1204*                            VMOD=2.007                          *ELCDTERX
  1205*                                                                *ELCDTERX
  1206*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1207*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1208*      = ELCDTEFD)                                               *ELCDTERX
  1209*                                                                *ELCDTERX
  1210******************************************************************ELCDTERX
  1211                                                                  ELCDTERX
  1212     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1213                                                                  ELCDTERX
  1214     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1215     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1216     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1217                                                                  ELCDTERX
  1218     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1219                                                                  ELCDTERX
  1220******************************************************************ELCDTERX
  1221*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1222*          WARNING MESSAGES.                                      ELCDTERX
  1223******************************************************************ELCDTERX
  1224     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1225         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1226                                                                  ELCDTERX
  1227     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1228                                                                  ELCDTERX
  1229     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1230                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1231                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1232                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1233                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1234                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1235                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1236                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1237                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1238                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1239                                                                  ELCDTERX
  1240     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1241                                                                  ELCDTERX
  1242     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1243                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1244                                                                  ELCDTERX
  1245     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1246     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1247     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1248     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1249                                                                  ELCDTERX
  1250     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1251         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1252     ELSE                                                         ELCDTERX
  1253         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1254                                                                  ELCDTERX
  1255     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1256         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1257     ELSE                                                         ELCDTERX
  1258         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1259                                                                  ELCDTERX
  1260 0005-READ--CARD.                                                 ELCDTERX
  1261     READ DISK-DATE                                               ELCDTERX
  1262         AT END CLOSE DISK-DATE                                   ELCDTERX
  1263             GO TO 0060-READ--TEST.                               ELCDTERX
  1264                                                                  ELCDTERX
  1265     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1266                                                                  ELCDTERX
  1267     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1268         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1269         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1270         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1271         GO TO 0005-READ--CARD.                                   ELCDTERX
  1272                                                                  ELCDTERX
  1273     IF DD-ID = 'CLAD'                                            ELCDTERX
  1274         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1275         GO TO 0005-READ--CARD.                                   ELCDTERX
  1276                                                                  ELCDTERX
  1277     IF DD-ID = 'CLAX'                                            ELCDTERX
  1278         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1279         GO TO 0005-READ--CARD.                                   ELCDTERX
  1280                                                                  ELCDTERX
  1281     IF DD-ID = 'CLAF'                                            ELCDTERX
  1282         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1283         GO TO 0005-READ--CARD.                                   ELCDTERX
  1284                                                                  ELCDTERX
  1285     IF DD-ID = 'CLAC'                                            ELCDTERX
  1286         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1287                                                                  ELCDTERX
  1288     IF DD-ID = 'CARR'                                            ELCDTERX
  1289         GO TO 0015-READ--CARR.                                   ELCDTERX
  1290                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1291     IF DD-ID = 'STAT'                                            ELCDTERX
  1292         GO TO 0020-READ--STAT.                                   ELCDTERX
  1293                                                                  ELCDTERX
  1294     IF DD-ID = 'BUSC'                                            ELCDTERX
  1295         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1296                                                                  ELCDTERX
  1297     IF DD-ID = 'MORT'                                            ELCDTERX
  1298         GO TO 0030-READ--MORT.                                   ELCDTERX
  1299                                                                  ELCDTERX
  1300     IF DD-ID = 'CLAI'                                            ELCDTERX
  1301         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1302                                                                  ELCDTERX
  1303     IF DD-ID = 'COLC'                                            ELCDTERX
  1304         GO TO 0065-READ--COLC.                                   ELCDTERX
  1305                                                                  ELCDTERX
  1306     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1307        DD-IDA = 'CL'                                             ELCDTERX
  1308         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1309                                                                  ELCDTERX
  1310     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1311        DD-IDA = 'PO'                                             ELCDTERX
  1312         GO TO 0050-READ--POXX.                                   ELCDTERX
  1313                                                                  ELCDTERX
  1314     IF DD-ID = 'OPCA'                                            ELCDTERX
  1315         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1316                                                                  ELCDTERX
  1317     IF DD-ID = 'OPST'                                            ELCDTERX
  1318         GO TO 0072-READ--OPST.                                   ELCDTERX
  1319                                                                  ELCDTERX
  1320     IF DD-ID = 'OPBS'                                            ELCDTERX
  1321         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1322                                                                  ELCDTERX
  1323     IF DD-ID = 'OPMS'                                            ELCDTERX
  1324         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1325                                                                  ELCDTERX
  1326     GO TO 0005-READ--CARD.                                       ELCDTERX
  1327                                                                  ELCDTERX
  1328 0010-READ--CLAC.                                                 ELCDTERX
  1329     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1330     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1331     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1332     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1333     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1334     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1335     GO TO 0005-READ--CARD.                                       ELCDTERX
  1336                                                                  ELCDTERX
  1337 0015-READ--CARR.                                                 ELCDTERX
  1338     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1339     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1340        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1341        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1342        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1343        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1344        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1345        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1346        MOVE DD-CARR1-SECPAY-SW
  1347                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1348     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1349                                                                  ELCDTERX
  1350     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1351     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1352        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1353        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1354        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1355        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1356        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1357        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1358        MOVE DD-CARR2-SECPAY-SW
  1359                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1360     END-IF
  1361                                                                  ELCDTERX
  1362                                                                  ELCDTERX
  1363     GO TO 0005-READ--CARD.                                       ELCDTERX
  1364                                                                  ELCDTERX
  1365 0020-READ--STAT.                                                 ELCDTERX
  1366     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1367     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1368        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1369         GO TO 0005-READ--CARD.                                   ELCDTERX
  1370                                                                  ELCDTERX
  1371     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1372     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1373     GO TO 0020-READ--STAT.                                       ELCDTERX
  1374                                                                  ELCDTERX
  1375 0025-READ--BUSC.                                                 ELCDTERX
  1376     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1377     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1378        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1379         GO TO 0005-READ--CARD.                                   ELCDTERX
  1380                                                                  ELCDTERX
  1381     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1382     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1383     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1384                                                                  ELCDTERX
  1385 0030-READ--MORT.                                                 ELCDTERX
  1386     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1387     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1388        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1389         GO TO 0005-READ--CARD.                                   ELCDTERX
  1390                                                                  ELCDTERX
  1391     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1392     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1393     GO TO 0030-READ--MORT.                                       ELCDTERX
  1394                                                                  ELCDTERX
  1395 0035-READ--CLXX.                                                 ELCDTERX
  1396     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1397          GO TO 0005-READ--CARD.                                  ELCDTERX
  1398                                                                  ELCDTERX
  1399     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1400         DISPLAY '***********************************************'ELCDTERX
  1401         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1402         DISPLAY '***********************************************'ELCDTERX
  1403         GO TO 0055-READ--STOP.                                   ELCDTERX
  1404                                                                  ELCDTERX
  1405     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1406        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1407         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1408                                                                  ELCDTERX
  1409     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1410        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1411         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1412                                                                  ELCDTERX
  1413*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1414     GO TO 0005-READ--CARD.                                       ELCDTERX
  1415                                                                  ELCDTERX
  1416 0040-READ--CLAI.                                                 ELCDTERX
  1417     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1418     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1419        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1420         GO TO 0005-READ--CARD.                                   ELCDTERX
  1421                                                                  ELCDTERX
  1422     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1423     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1424     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1425                                                                  ELCDTERX
  1426 0045-READ--DUMP.                                                 ELCDTERX
  1427     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1428     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1429                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1430     PERFORM ABEND-PGM.                                           ELCDTERX
  1431                                                                  ELCDTERX
  1432 0050-READ--POXX.                                                 ELCDTERX
  1433     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1434         GO TO 0005-READ--CARD.                                   ELCDTERX
  1435                                                                  ELCDTERX
  1436     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1437         DISPLAY '***********************************************'ELCDTERX
  1438         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1439         DISPLAY '***********************************************'ELCDTERX
  1440         GO TO 0055-READ--STOP.                                   ELCDTERX
  1441                                                                  ELCDTERX
  1442     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1443     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1444     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1445     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1446                                                                  ELCDTERX
  1447     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1448         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1449     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1450         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1451                                                                  ELCDTERX
  1452     GO TO 0005-READ--CARD.                                       ELCDTERX
  1453                                                                  ELCDTERX
  1454 0055-READ--STOP.                                                 ELCDTERX
  1455     GOBACK.                                                      ELCDTERX
  1456                                                                  ELCDTERX
  1457 0060-READ--TEST.                                                 ELCDTERX
  1458     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1459        CLAX-ID         = SPACE  OR                               ELCDTERX
  1460        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1461         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1462                                                                  ELCDTERX
  1463     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1464     GO TO 0079-READ--EXIT.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* FNB165.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1465                                                                  ELCDTERX
  1466 0065-READ--COLC.                                                 ELCDTERX
  1467     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1468     GO TO 0005-READ--CARD.                                       ELCDTERX
  1469                                                                  ELCDTERX
  1470 0070-READ--OPCA.                                                 ELCDTERX
  1471                                                                  ELCDTERX
  1472     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1473                                                                  ELCDTERX
  1474     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1475             OR                                                   ELCDTERX
  1476         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1477         GO TO 0005-READ--CARD.                                   ELCDTERX
  1478                                                                  ELCDTERX
  1479     ADD 1                       TO INDEXCA.                      ELCDTERX
  1480     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1481                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1482     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1483                                                                  ELCDTERX
  1484 0072-READ--OPST.                                                 ELCDTERX
  1485                                                                  ELCDTERX
  1486     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1487                                                                  ELCDTERX
  1488     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1489             OR                                                   ELCDTERX
  1490         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1491         GO TO 0005-READ--CARD.                                   ELCDTERX
  1492                                                                  ELCDTERX
  1493     ADD 1                       TO INDEXST.                      ELCDTERX
  1494     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1495                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1496     GO TO 0072-READ--OPST.                                       ELCDTERX
  1497                                                                  ELCDTERX
  1498 0074-READ--OPBS.                                                 ELCDTERX
  1499                                                                  ELCDTERX
  1500     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1501                                                                  ELCDTERX
  1502     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1503             OR                                                   ELCDTERX
  1504         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1505         GO TO 0005-READ--CARD.                                   ELCDTERX
  1506                                                                  ELCDTERX
  1507     ADD 1                       TO INDEXBS.                      ELCDTERX
  1508     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1509     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1510                                                                  ELCDTERX
  1511 0079-READ--EXIT.                                                 ELCDTERX
  1512*    EXIT.                                                        ELCDTERX
  1513******************************************************************ELCDTERX
  1514*************************************************************
  1515     PERFORM 0000-HOUSEKEEPING THRU 0000-EXIT                     01100000
  1516                                                                  01110000
  1517     PERFORM 1000-PROCESS      THRU 1000-EXIT
  1518         UNTIL EOF.                                               01120000
  1519                                                                  01130000
  1520     CLOSE WORK-FILE CID-PAYMENTS
  1521
  1522     IF DTE-CLIENT = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* FNB165.cbl
  1523        CLOSE CSI-WORK-FILE
  1524              CCC-WORK-FILE
  1525     END-IF
  1526
  1527     GOBACK.                                                      01140000
  1528                                                                  01150000
  1529                                                                  01160000
  1530 1000-PROCESS.                                                    01190000
  1531*                                                                 01200000
  1532     READ CID-PAYMENTS                                            01210000
  1533         AT END GO TO 1000-EXIT.                                  01220000
  1534
  1535     IF PY-COMPANY-CD < DTE-CLASIC-COMPANY-CD
  1536        GO TO 1000-EXIT
  1537     ELSE
  1538        IF PY-COMPANY-CD > DTE-CLASIC-COMPANY-CD
  1539           SET EOF               TO TRUE
  1540           GO TO 1000-EXIT
  1541        END-IF
  1542     END-IF
  1543
  1544     IF (PY-RECORD-ID = 'PY')          AND                        01240010
  1545*       (PY-CARRIER = '6' OR '9')      AND                        01250010
  1546        (PY-RECORD-TYPE = 'R' OR 'C')                             01260010
  1547          CONTINUE                                                01270010
  1548     ELSE                                                         01280010
  1549          GO TO 1000-EXIT.                                        01290010
  1550                                                                  01300010
  1551     IF (PY-INPUT-DT > WS-PREV-DATE)                              01310011
  1552       AND (PY-INPUT-DT NOT > WS-CURR-DATE)                       01320011
  1553         CONTINUE                                                 01330002
  1554     ELSE                                                         01340002
  1555         GO TO 1000-EXIT.                                         01350002
  1556                                                                  01360002
  1557*    DISPLAY ' PY CARRIER = ' PY-CARRIER
  1558*    MOVE '3'                    TO PY-CARRIER
  1559
  1560     MOVE SPACES      TO WORK-RECORD                              01370015
  1561                                                                  01380011
  1562     MOVE '10'                   TO FX-TRAN-TYPE
  1563     MOVE '98'                   TO FX-SUB-TYPE
  1564
  1565
  1566     EVALUATE TRUE
  1567        WHEN DTE-CLIENT = 'AHL'
  1568           MOVE 'AHL PYADJ'      TO FX-SYSTEM
  1569           MOVE 'CRLOGC'         TO FX-SOURCE-CODE
  1570           MOVE '02'             TO FX-DIVISION
  1571        WHEN DTE-CLIENT = 'CID'
  1572           MOVE 'CID PYADJ'      TO FX-SYSTEM
  1573           MOVE 'CRLOGC'         TO FX-SOURCE-CODE
  1574           MOVE '02'             TO FX-DIVISION
  1575        WHEN (DTE-CLIENT = 'DCC')
  1576             AND (PY-CARRIER = '3' OR '4')
  1577           MOVE 'CSIDCCPYAJ'     TO FX-SYSTEM
  1578           MOVE 'LOGIC '         TO FX-SOURCE-CODE
  1579           MOVE '11'             TO FX-DIVISION
  1580        WHEN (DTE-CLIENT = 'DCC') AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* FNB165.cbl
  1581             (PY-CARRIER = '5' OR '6' or '7')
  1582           MOVE 'CCCDCCPYAJ'     TO FX-SYSTEM
  1583           MOVE 'LOGIC '         TO FX-SOURCE-CODE
  1584           MOVE '50'             TO FX-DIVISION
  1585        WHEN DTE-CLIENT = 'DCC'
  1586           MOVE 'LPAC PYADJ'     TO FX-SYSTEM
  1587           MOVE 'LOGIC '         TO FX-SOURCE-CODE
  1588           MOVE '11'             TO FX-DIVISION
  1589     END-EVALUATE
  1590
  1591
  1592
  1593
  1594
  1595*    IF DTE-CLIENT = 'CID'
  1596*       MOVE 'CID PYADJ'         TO FX-SYSTEM
  1597*       MOVE 'CRLOGC'            TO FX-SOURCE-CODE
  1598*       MOVE '02'                TO FX-DIVISION
  1599*    ELSE
  1600*       IF DTE-CLIENT = 'DCC'
  1601*          MOVE 'LPAC PYADJ'     TO FX-SYSTEM
  1602*          MOVE 'LOGIC '         TO FX-SOURCE-CODE
  1603*          MOVE '11'             TO FX-DIVISION
  1604*       END-IF
  1605*    END-IF
  1606
  1607     IF PY-RECORD-TYPE = 'C'                                      01440025
  1608        MULTIPLY PY-ENTRY-AMT BY -1 GIVING FX-AMOUNT              01450025
  1609     ELSE                                                         01460025
  1610        MOVE PY-ENTRY-AMT TO FX-AMOUNT                            01470025
  1611     END-IF                                                       01480025
  1612                                                                  01490018
  1613     MOVE ' '              TO FX-CLM-RES                          01500025
  1614     MOVE ' '              TO FX-ANN-STMT                         01510025
  1615     MOVE ' '              TO FX-PLAN-CODE                        01520025
  1616     MOVE PARM-CURR-DATE   TO FX-POSTING-DATE                     01530032
  1617     MOVE ' '              TO FX-POLICY-NO                        01540025
  1618                                                                  01550029
  1619     MOVE ' '              TO FX-STATE                            01580025
  1620     MOVE 'Y'              TO FX-LOC-CODE                         01590030
  1621     MOVE ' '              TO FX-ZIP-CODE                         01600025
  1622
  1623     IF DTE-CLIENT = 'CID' OR 'AHL'
  1624        MOVE 'S'                 TO FX-FY-REN
  1625     ELSE
  1626        MOVE ' '                 TO FX-FY-REN
  1627     END-IF
  1628
  1629     MOVE ' '               TO FX-AGENT-01
  1630     MOVE ' '               TO FX-DISTR
  1631                                                                  01640016
  1632     IF PY-GL-ACCOUNT = LOW-VALUES
  1633         MOVE SPACES        TO FX-SOURCE-ACCT
  1634     ELSE
  1635         MOVE PY-GL-ACCOUNT TO FX-SOURCE-ACCT
  1636     END-IF
  1637     MOVE PY-CARRIER        TO FX-DESCRIPTION(27:1)
  1638     MOVE PY-GROUPING(4:3)  TO FX-DESCRIPTION(28:3)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* FNB165.cbl
  1639     MOVE ' '               TO FX-REFERENCE
  1640     MOVE PY-FIN-RESP(4:7)  TO WS-FIN-RESP
  1641
  1642     MOVE PY-ACCOUNT(3:8)   TO WS-CID-ACCT
  1643     IF WS-CID-ACCT = LOW-VALUE
  1644        MOVE SPACES         TO WS-CID-ACCT
  1645     END-IF
  1646
  1647     MOVE WS-SUSPENSE       TO FX-SUSPENSE
  1648     MOVE PY-FIN-RESP       TO FX-SUSPENSE
  1649     IF PY-ACCOUNT = LOW-VALUES
  1650        MOVE SPACES         TO FX-REFERENCE
  1651     ELSE
  1652        MOVE PY-ACCOUNT     TO FX-REFERENCE
  1653     END-IF
  1654
  1655**** THE PLAN CODE TABLE IS NO LONGER ACCESSED WITHIN THE CID
  1656**** LOGIC SYSTEM; THEREFORE THE FOLLOWING CALL IS NOT REQUIRED
  1657**** THIS CALL NEVER CAME BACK WITH ANYTHING - NO PLAN CODE KEY   01800026
  1658*    CALL 'FNB160' USING WORK-RECORD
  1659
  1660**** SEARCH PULLED FROM FNB160
  1661     IF FX-STATE NOT= SPACES
  1662         SEARCH ALL STATE-TABLE
  1663             AT END DISPLAY 'INVALID STATE CODE: ' FX-STATE
  1664             WHEN ST-STATE (ST-INDEX) = FX-STATE
  1665             MOVE ST-ALT-STATE (ST-INDEX) TO FX-STATE
  1666         END-SEARCH
  1667     END-IF
  1668
  1669     MOVE SYSTEM-DATE              TO FX-JOURNAL-DATE
  1670
  1671**** THE '*' IN POSITION 250 ENSURES A 250 BYTE RECORD IS PASSED
  1672**** TO FREEDOM - PREVENTS TRUNCATION OF BLANK FIELDS
  1673     MOVE '*'                      TO WORK-RECORD(250:1)
  1674
  1675     IF (DTE-CLIENT = 'DCC')
  1676        AND (PY-CARRIER = '3' OR '4')
  1677        WRITE CSI-WORK-RECORD    FROM WORK-RECORD
  1678     ELSE
  1679       IF (DTE-CLIENT = 'DCC') AND
  1680          (PY-CARRIER = '5' OR '6' or '7')
  1681            WRITE CCC-WORK-RECORD FROM WORK-RECORD
  1682       ELSE
  1683        WRITE WORK-RECORD
  1684       END-IF
  1685     END-IF
  1686
  1687     .
  1688 1000-EXIT.                                                       01840000
  1689     EXIT.                                                        01850000
  1690                                                                  01860029
  1691                                                                  01870029
  1692 0000-HOUSEKEEPING.                                               02260008
  1693                                                                  02270008
  1694     MOVE PARM-PREV-DATE(1:2) TO DC-GREG-DATE-1-MDY(1:2)          02280032
  1695     MOVE PARM-PREV-DATE(3:2) TO DC-GREG-DATE-1-MDY(3:2)          02290032
  1696     MOVE PARM-PREV-DATE(7:2) TO DC-GREG-DATE-1-MDY(5:2)          02300032
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* FNB165.cbl
  1697     MOVE '4' TO DC-OPTION-CODE                                   02310032
  1698     CALL 'ELDATCX' USING DATE-CONVERSION-DATA                    02320012
  1699     IF DC-ERROR-CODE = ' '                                       02330010
  1700         MOVE DC-BIN-DATE-1 TO WS-PREV-DATE                       02340010
  1701     ELSE                                                         02350010
  1702         DISPLAY 'PARAMETER PREVIOUS DATE IS INVALID: '           02360033
  1703                  PARM-PREV-DATE                                  02370033
  1704         ADD +1 TO FORCE-DUMP.                                    02380010
  1705                                                                  02390010
  1706     MOVE PARM-CURR-DATE(1:2) TO DC-GREG-DATE-1-MDY(1:2)          02400032
  1707     MOVE PARM-CURR-DATE(3:2) TO DC-GREG-DATE-1-MDY(3:2)          02410032
  1708     MOVE PARM-CURR-DATE(7:2) TO DC-GREG-DATE-1-MDY(5:2)          02420032
  1709     MOVE '4' TO DC-OPTION-CODE                                   02430032
  1710     CALL 'ELDATCX' USING DATE-CONVERSION-DATA                    02440032
  1711     IF DC-ERROR-CODE = ' '                                       02450032
  1712         MOVE DC-BIN-DATE-1 TO WS-CURR-DATE                       02460032
  1713     ELSE                                                         02470032
  1714         DISPLAY 'PARAMETER CURRENT DATE IS INVALID: '            02480033
  1715                  PARM-CURR-DATE                                  02490033
  1716         ADD +1 TO FORCE-DUMP.                                    02500032
  1717                                                                  02510032
  1718     IF WS-PREV-DATE > WS-CURR-DATE                               02520010
  1719         DISPLAY 'INVALID PARAMETER: PREVIOUS DATE > CURRENT DATE'02530033
  1720         DISPLAY 'PREVIOUS DATE = ' PARM-PREV-DATE                02540033
  1721         DISPLAY ' CURRENT DATE = ' PARM-CURR-DATE                02550033
  1722         ADD +1 TO FORCE-DUMP.                                    02560010
  1723                                                                  02570015
  1724     MOVE FUNCTION CURRENT-DATE
  1725                                 TO FUNCTION-DATE
  1726     MOVE WS-FN-MO               TO SYS-MO
  1727     MOVE WS-FN-DA               TO SYS-DA
  1728     MOVE WS-FN-CCYR             TO SYS-CCYY
  1729
  1730     OPEN  INPUT CID-PAYMENTS                                     02720016
  1731          OUTPUT WORK-FILE.                                       02730016
  1732                                                                  02740010
  1733     IF DTE-CLIENT = 'DCC'
  1734        OPEN OUTPUT CSI-WORK-FILE
  1735                    CCC-WORK-FILE
  1736     END-IF
  1737
  1738     .
  1739 0000-EXIT.                                                       02750010
  1740     EXIT.                                                        02760010
  1741 ABEND-PGM SECTION.                                               00026280
  1742     DISPLAY 'REACHED ABEND PGM '
  1743     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    00026290
  1744 ABEND-EXIT.                                                      00026300
  1745                                                                  02770009
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       50268     Code:        4923
