* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page   1
* EL517.cbl
* Options: int("EL517.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL517.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL517.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL517.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL517 .
     5*              PROGRAM CONVERTED BY
     6*              COBOL CONVERSION AID PO 5785-ABJ
     7*              CONVERSION DATE 06/08/94 08:12:06.
     8*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     9*                            VMOD=2.040.
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page   2
* EL517.cbl
    14*DATE-COMPILED.
    15
    16*SECURITY.   *****************************************************
    17*            *                                                   *
    18*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    19*            *                                                   *
    20*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    21*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    22*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    23*            *                                                   *
    24*            *****************************************************
    25
    26*REMARKS.
    27*          THIS PROGRAM IS THE BATCH EDIT ROUTINE
    28*          FOR THE ON-LINE CREDIT SYSTEM PENDING BUSINESS
    29******************************************************************
    30*                   C H A N G E   L O G
    31*
    32* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    33*-----------------------------------------------------------------
    34*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    35* EFFECTIVE    NUMBER
    36*-----------------------------------------------------------------
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38* 062904    2001061800003  PEMA  ADD CLM TYPE I AND G
    39* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    40*                                IS OPEN OR CNC DT < PD THRU
    41*                                ALSO ADD ALTERNATE KEY CLAUSE
    42* 111204    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    43* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    44* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    45* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    46* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
    47* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFUND
    48* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    49* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    50* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    51* 061412  CR2011022800001  AJRA  NAPERSOFT
    52* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    53* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    54* 101112  CR2011022800001  AJRA  FIX CERT PEND CANCEL ERROR MSG
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    57******************************************************************
    58
    59 ENVIRONMENT DIVISION.
    60
    61 INPUT-OUTPUT SECTION.
    62
    63 FILE-CONTROL.
    64
    65     SELECT DISK-DATE        ASSIGN TO SYS019-UT-3380-S-SYS019.
    66
    67     SELECT ELCNTL           ASSIGN TO SYS021-3380-ELCNTL
    68                             ORGANIZATION IS INDEXED
    69                             ACCESS IS DYNAMIC
    70                             RECORD KEY IS CF-CONTROL-PRIMARY
    71                             FILE STATUS IS ELCNTL-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page   3
* EL517.cbl
    72
    73     SELECT ERPNDB           ASSIGN TO SYS022-3380-ERPNDB
    74                             ORGANIZATION IS INDEXED
    75                             ACCESS IS SEQUENTIAL
    76                             RECORD KEY IS PB-CONTROL-PRIMARY
    77                             ALTERNATE RECORD KEY IS
    78                                 PB-CONTROL-BY-ACCOUNT
    79                             FILE STATUS IS ERPNDB-FILE-STATUS.
    80
    81     SELECT ERREIN           ASSIGN TO SYS022-3380-ERREIN
    82                             ORGANIZATION IS INDEXED
    83                             ACCESS IS DYNAMIC
    84                             RECORD KEY IS RE-CONTROL-PRIMARY
    85                             FILE STATUS IS ERREIN-FILE-STATUS.
    86
    87     SELECT ELCERT
*                                  COPY ELCCERTS.
    88******************************************************************04/15/98
    89*                                                                *ELCCERTS
    90*                            ELCCERTS.                           *   LV002
    91*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    92*                            VMOD=2.001                          *ELCCERTS
    93*                                                                *ELCCERTS
    94*           SELECT STATEMENT FOR THE CERTIFICATE MASTER          *ELCCERTS
    95*                                                                *ELCCERTS
    96*  NO  CID  MODS  TO  COPYBOOK  ELCCERTS                         *ELCCERTS
    97******************************************************************ELCCERTS
    98                                                                  ELCCERTS
    99         ASSIGN TO SYS022-3380-ELCERT                             ELCCERTS
   100         ORGANIZATION IS INDEXED                                  ELCCERTS
   101         ACCESS IS DYNAMIC                                        ELCCERTS
   102         RECORD KEY IS CM-CONTROL-PRIMARY                         ELCCERTS
   103         FILE STATUS IS ELCERT-FILE-STATUS.                       ELCCERTS
   104                                                                  ELCCERTS
   105
   106     SELECT ELMSTR           ASSIGN TO SYS023-3380-ELMSTR5
   107                             ORGANIZATION IS INDEXED
   108                             ACCESS IS DYNAMIC
   109                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
   110                             FILE STATUS IS ELMSTR-FILE-STATUS.
   111
   112     SELECT ERCTBL           ASSIGN TO SYS022-3380-ERCTBL
   113                             ORGANIZATION IS INDEXED
   114                             ACCESS IS DYNAMIC
   115                             RECORD KEY IS CT-CONTROL-PRIMARY
   116                             FILE STATUS IS ERCTBL-FILE-STATUS.
   117
   118     SELECT ERACCT           ASSIGN TO SYS022-3380-ERACCT2
   119                             ORGANIZATION IS INDEXED
   120                             ACCESS IS DYNAMIC
   121                             RECORD KEY IS AM-CONTROL-BY-VAR-GRP
   122                             FILE STATUS IS ERACCT-FILE-STATUS.
   123
   124     SELECT ELCERR           ASSIGN TO SYS022-3380-ELERRS
   125                             ORGANIZATION IS INDEXED
   126                             ACCESS IS DYNAMIC
   127                             RECORD KEY IS EM-CONTROL-PRIMARY
   128                             FILE STATUS IS ELCERR-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page   4
* EL517.cbl
   129
   130     SELECT ERPNDM           ASSIGN TO SYS022-3380-ERPNDM
   131                             ORGANIZATION IS INDEXED
   132                             ACCESS IS DYNAMIC
   133                             RECORD KEY IS PM-CONTROL-PRIMARY
   134                             FILE STATUS IS ERPNDM-FILE-STATUS.
   135
   136     SELECT ERMAIL           ASSIGN TO SYS022-3380-ERMAIL
   137                             ORGANIZATION IS INDEXED
   138                             ACCESS IS DYNAMIC
   139                             RECORD KEY IS MA-CONTROL-PRIMARY
   140                             FILE STATUS IS ERMAIL-FILE-STATUS.
   141
   142     SELECT ERPLAN           ASSIGN TO SYS022-3380-ERPLAN
   143                             ORGANIZATION IS INDEXED
   144                             ACCESS IS DYNAMIC
   145                             RECORD KEY IS PL-CONTROL-PRIMARY
   146                             FILE STATUS IS ERPLAN-FILE-STATUS.
   147
   148     SELECT ERFORM           ASSIGN TO SYS022-3380-ERFORM
   149                             ORGANIZATION IS INDEXED
   150                             ACCESS IS DYNAMIC
   151                             RECORD KEY IS FO-CONTROL-PRIMARY
   152                             FILE STATUS IS ERFORM-FILE-STATUS.
   153
   154     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
   155
   156     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
   157
   158     SELECT ELREPT           ASSIGN TO SYS010-3380-ELREPT
   159                             ORGANIZATION IS INDEXED
   160                             ACCESS IS DYNAMIC
   161                             RECORD KEY IS RF-CONTROL-PRIMARY
   162                             FILE STATUS IS DTE-VSAM-FLAGS.
   163
   164     SELECT ERRESS           ASSIGN TO SYS021-3380-ERRESS
   165                             ORGANIZATION IS INDEXED
   166                             ACCESS IS DYNAMIC
   167                             RECORD KEY IS ERRESS-PRIMARY-KEY
   168                             FILE STATUS IS ERRESS-FILE-STATUS.
   169
   170     SELECT ERRESC           ASSIGN TO SYS021-3380-ERRESC
   171                             ORGANIZATION IS INDEXED
   172                             ACCESS IS DYNAMIC
   173                             RECORD KEY IS ERRESC-RECORD-KEY
   174                             FILE STATUS IS ERRESC-FILE-STATUS.
   175
   176     SELECT ERCOMP           ASSIGN TO             ERCOMP
   177                             ORGANIZATION IS INDEXED
   178                             ACCESS IS DYNAMIC
   179                             RECORD KEY IS CO-CONTROL-PRIMARY
   180                             FILE STATUS IS ERCOMP-FILE-STATUS.
   181
   182     SELECT ERLOFC           ASSIGN TO             ERLOFC
   183                             ORGANIZATION IS INDEXED
   184                             ACCESS IS DYNAMIC
   185                             RECORD KEY IS LO-CONTROL-PRIMARY
   186                             FILE STATUS IS ERLOFC-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page   5
* EL517.cbl
   187
   188     SELECT ERBXRF           ASSIGN TO             ERBXRF
   189                             ORGANIZATION IS INDEXED
   190                             ACCESS IS DYNAMIC
   191                             RECORD KEY IS BK-CONTROL-PRIMARY
   192                             FILE STATUS IS ERBXRF-FILE-STATUS.
   193
   194     SELECT ERAGTC           ASSIGN TO             ERAGTC
   195                             ORGANIZATION IS INDEXED
   196                             ACCESS IS DYNAMIC
   197                             RECORD KEY IS AG-CONTROL-PRIMARY
   198                             FILE STATUS IS ERAGTC-FILE-STATUS.
   199
   200     SELECT ELCRTT           ASSIGN TO             ELCRTT
   201                             ORGANIZATION IS INDEXED
   202                             ACCESS IS DYNAMIC
   203                             RECORD KEY IS CS-CONTROL-PRIMARY
   204                             FILE STATUS IS ELCRTT-FILE-STATUS.
   205
   206     SELECT ERPDEF           ASSIGN TO ERPDEF
   207                             ACCESS IS DYNAMIC
   208                             ORGANIZATION IS INDEXED
   209                             FILE STATUS IS ERPDEF-FILE-STATUS
   210                             RECORD KEY IS PD-CONTROL-PRIMARY.
   211
   212     SELECT ELSTAT           ASSIGN TO ELSTAT
   213                             ACCESS IS DYNAMIC
   214                             ORGANIZATION IS INDEXED
   215                             FILE STATUS IS ELSTAT-FILE-STATUS
   216                             RECORD KEY IS SF-CONTROL-PRIMARY.
   217
   218     SELECT ELCRTO           ASSIGN TO ELCRTO
   219                             ACCESS IS DYNAMIC
   220                             ORGANIZATION IS INDEXED
   221                             FILE STATUS IS ELCRTO-FILE-STATUS
   222                             RECORD KEY IS OC-CONTROL-PRIMARY.
   223
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page   6
* EL517.cbl
   225 DATA DIVISION.
   226
   227 FILE SECTION.
   228
   229 FD  DISK-DATE
*                                      COPY ELCDTEFD.
   230******************************************************************04/15/98
   231*                                                                *ELCDTEFD
   232*                                                                *ELCDTEFD
   233*                            ELCDTEFD.                           *   LV002
   234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   235*                            VMOD=2.007                          *   CL**2
   236*                                                                *ELCDTEFD
   237******************************************************************ELCDTEFD
   238     BLOCK CONTAINS 0 RECORDS
   239     RECORDING MODE F.                                            ELCDTEFD
   240                                                                  ELCDTEFD
   241 01  DATE-DISK.                                                   ELCDTEFD
   242     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   243     12  FILLER                      PIC  X(14).                  ELCDTEFD
   244     12  DD-CR1                      PIC  9.                      ELCDTEFD
   245     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   246     12  DD-CR2                      PIC  9.                      ELCDTEFD
   247     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   248     12  FILLER                      PIC  X(20).                  ELCDTEFD
   249                                                                  ELCDTEFD
   250 01  DATE-DISK-R.                                                 ELCDTEFD
   251     12  FILLER                      PIC  X(4).                   ELCDTEFD
   252     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   253                                     PIC  X(32).                  ELCDTEFD
   254                                                                  ELCDTEFD
   255 01  DATE-DISK-T.                                                 ELCDTEFD
   256     12  FILLER                      PIC  X(4).                   ELCDTEFD
   257     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   258                                     PIC  X(48).                  ELCDTEFD
   259                                                                  ELCDTEFD
   260 01  DATE-DISK-M.                                                 ELCDTEFD
   261     12  FILLER                      PIC  X(4).                   ELCDTEFD
   262     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   263                                     PIC  X(48).                  ELCDTEFD
   264                                                                  ELCDTEFD
   265 01  DATE-DISK-P.                                                 ELCDTEFD
   266     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   267     12  DD-IDX                      PIC  99.                     ELCDTEFD
   268     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   269     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   270         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   271                                     PIC  X.                      ELCDTEFD
   272         16  FILLER                  PIC  X(46).                  ELCDTEFD
   273     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   274         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   275             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   276             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   277             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   278             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   279         16  FILLER                  PIC  X(16).                  ELCDTEFD
   280                                                                  ELCDTEFD
   281 01  DATE-DISK-E.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page   7
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   282     12  FILLER                      PIC  X(4).                   ELCDTEFD
   283     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   284                                     PIC  X(4).                   ELCDTEFD
   285                                                                  ELCDTEFD
   286 01  DATE-DISK-C.                                                 ELCDTEFD
   287     12  FILLER                      PIC  X(7).                   ELCDTEFD
   288     12  DD-CARR1-SECPAY-SW          PIC  X.
   289     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   290     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   291     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   292     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   293     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   294     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   295     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   296     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   297     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   298     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   299     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   300     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   301     12  DD-CARR2-SECPAY-SW          PIC  X.
   302     12  FILLER                      PIC  X(7).                   ELCDTEFD
   303                                                                  ELCDTEFD
   304 01  DATE-DISK-OPT.                                               ELCDTEFD
   305     12  FILLER                      PIC  X(04).                  ELCDTEFD
   306     12  DD-TLR-DATA.                                             ELCDTEFD
   307         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   308                                     PIC  X(03).                  ELCDTEFD
   309     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   310         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   311                                     PIC  X(06).                  ELCDTEFD
   312     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   313         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   314                                     PIC  X(07).                  ELCDTEFD
   315         16  FILLER                  PIC  X(05).                  ELCDTEFD
   316     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   317                                     PIC  X(96).                  ELCDTEFD
   318******************************************************************ELCDTEFD
   319
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page   8
* EL517.cbl
   321 FD  ELCNTL.
*  322                                 COPY ELCCNTL.
   323******************************************************************
   324*                                                                *
   325*                                                                *
   326*                            ELCCNTL.                            *
   327*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   328*                            VMOD=2.059                          *
   329*                                                                *
   330*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   331*                                                                *
   332*   FILE TYPE = VSAM,KSDS                                        *
   333*   RECORD SIZE = 750  RECFORM = FIXED                           *
   334*                                                                *
   335*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   336*       ALTERNATE INDEX = NONE                                   *
   337*                                                                *
   338*   LOG = YES                                                    *
   339*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   340******************************************************************
   341*                   C H A N G E   L O G
   342*
   343* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   344*-----------------------------------------------------------------
   345*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   346* EFFECTIVE    NUMBER
   347*-----------------------------------------------------------------
   348* 082503                   PEMA  ADD BENEFIT GROUP
   349* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   350* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   351* 092705    2005050300006  PEMA  ADD SPP LEASES
   352* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   353* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   354* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FOR AK
   355* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH CLAIM
   356* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   357* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   358* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   359* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   360* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   361******************************************************************
   362*
   363 01  CONTROL-FILE.
   364     12  CF-RECORD-ID                       PIC XX.
   365         88  VALID-CF-ID                        VALUE 'CF'.
   366
   367     12  CF-CONTROL-PRIMARY.
   368         16  CF-COMPANY-ID                  PIC XXX.
   369         16  CF-RECORD-TYPE                 PIC X.
   370             88  CF-COMPANY-MASTER              VALUE '1'.
   371             88  CF-PROCESSOR-MASTER            VALUE '2'.
   372             88  CF-STATE-MASTER                VALUE '3'.
   373             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   374             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   375             88  CF-CARRIER-MASTER              VALUE '6'.
   376             88  CF-MORTALITY-MASTER            VALUE '7'.
   377             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   378             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page   9
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   379             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   380             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   381             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   382             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   383             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   384             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   385             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   386             88  CF-REMINDERS-MASTER            VALUE 'R'.
   387             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   388         16  CF-ACCESS-CD-GENL              PIC X(4).
   389         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   390             20  CF-PROCESSOR               PIC X(4).
   391         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   392             20  CF-STATE-CODE              PIC XX.
   393             20  FILLER                     PIC XX.
   394         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   395             20  FILLER                     PIC XX.
   396             20  CF-HI-BEN-IN-REC           PIC XX.
   397         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   398             20  FILLER                     PIC XXX.
   399             20  CF-CARRIER-CNTL            PIC X.
   400         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   401             20  FILLER                     PIC XX.
   402             20  CF-HI-TYPE-IN-REC          PIC 99.
   403         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   404             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   405                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   406             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   407             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   408         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   409             20  FILLER                     PIC X.
   410             20  CF-CUSTOM-REPORT-NO        PIC 999.
   411         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   412             20  FILLER                     PIC XX.
   413             20  CF-MORTGAGE-PLAN           PIC XX.
   414         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   415
   416     12  CF-LAST-MAINT-DT                   PIC XX.
   417     12  CF-LAST-MAINT-BY                   PIC X(4).
   418     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   419
   420     12  CF-RECORD-BODY                     PIC X(728).
   421
   422
   423****************************************************************
   424*             COMPANY MASTER RECORD                            *
   425****************************************************************
   426
   427     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   428         16  CF-COMPANY-ADDRESS.
   429             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   430             20  CF-CL-IN-CARE-OF           PIC X(30).
   431             20  CF-CL-ADDR-LINE-1          PIC X(30).
   432             20  CF-CL-ADDR-LINE-2          PIC X(30).
   433             20  CF-CL-CITY-STATE           PIC X(30).
   434             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   435             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   436         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  10
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   437         16  CF-COMPANY-PASSWORD            PIC X(8).
   438         16  CF-SECURITY-OPTION             PIC X.
   439             88  ALL-SECURITY                   VALUE '1'.
   440             88  COMPANY-VERIFY                 VALUE '2'.
   441             88  PROCESSOR-VERIFY               VALUE '3'.
   442             88  NO-SECURITY                    VALUE '4'.
   443             88  ALL-BUT-TERM                   VALUE '5'.
   444         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   445             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   446         16  CF-LGX-INTERFACE-CNTL          PIC X.
   447             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   448         16  CF-INFORCE-LOCATION            PIC X.
   449             88  CERTS-ARE-ONLINE               VALUE '1'.
   450             88  CERTS-ARE-OFFLINE              VALUE '2'.
   451             88  NO-CERTS-AVAILABLE             VALUE '3'.
   452         16  CF-LOWER-CASE-LETTERS          PIC X.
   453         16  CF-CERT-ACCESS-CONTROL         PIC X.
   454             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   455             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   456             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   457             88  CF-ACCNT-CNTL                  VALUE '3'.
   458             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   459
   460         16  CF-FORMS-PRINTER-ID            PIC X(4).
   461         16  CF-CHECK-PRINTER-ID            PIC X(4).
   462
   463         16  CF-LGX-CREDIT-USER             PIC X.
   464             88  CO-IS-NOT-USER                 VALUE 'N'.
   465             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   466
   467         16 CF-CREDIT-CALC-CODES.
   468             20  CF-CR-REM-TERM-CALC PIC X.
   469               88  CR-EARN-AFTER-15TH           VALUE '1'.
   470               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   471               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   472               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   473               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   474               88  CR-EARN-AFTER-14TH           VALUE '6'.
   475               88  CR-EARN-AFTER-16TH           VALUE '7'.
   476             20  CF-CR-R78-METHOD           PIC X.
   477               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   478               88  DONT-USE-PLUS-ONE            VALUE '1'.
   479
   480         16  CF-CLAIM-CONTROL-COUNTS.
   481             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   482                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   483
   484             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   485                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   486
   487             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   488                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   489
   490             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   491                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   492
   493         16  CF-CURRENT-MONTH-END           PIC XX.
   494
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  11
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   495         16  CF-CO-CALC-QUOTE-TOLERANCE.
   496             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   497             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   498             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   499             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   500                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   501                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   502             20  CF-CO-PREM-REJECT-SW       PIC X.
   503                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   504                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   505             20  CF-CO-REF-REJECT-SW        PIC X.
   506                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   507                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   508
   509         16  CF-CO-REPORTING-DT             PIC XX.
   510         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   511         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   512           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   513           88  CF-CO-MONTH-END                  VALUE '1'.
   514
   515         16  CF-LGX-CLAIM-USER              PIC X.
   516             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   517             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   518
   519         16  CF-CREDIT-EDIT-CONTROLS.
   520             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   521             20  CF-MIN-AGE                 PIC 99.
   522             20  CF-DEFAULT-AGE             PIC 99.
   523             20  CF-MIN-TERM                PIC S999      COMP-3.
   524             20  CF-MAX-TERM                PIC S999      COMP-3.
   525             20  CF-DEFAULT-SEX             PIC X.
   526             20  CF-JOINT-AGE-INPUT         PIC X.
   527                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   528             20  CF-BIRTH-DATE-INPUT        PIC X.
   529                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   530             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   531                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   532                 88  CF-ZERO-CARRIER            VALUE '1'.
   533                 88  CF-ZERO-GROUPING           VALUE '2'.
   534                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   535             20  CF-EDIT-SW                 PIC X.
   536                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   537             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   538             20  CF-CR-PR-METHOD            PIC X.
   539               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   540               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   541             20  FILLER                     PIC X.
   542
   543         16  CF-CREDIT-MISC-CONTROLS.
   544             20  CF-REIN-TABLE-SW           PIC X.
   545                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   546             20  CF-COMP-TABLE-SW           PIC X.
   547                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   548             20  CF-EXPERIENCE-RETENTION-AGE
   549                                            PIC S9        COMP-3.
   550             20  CF-CONVERSION-DT           PIC XX.
   551             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   552             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  12
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   553                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   554                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   555
   556             20  CF-CR-CHECK-NO-CONTROL.
   557                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   558                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   559                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   560                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   561                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   562                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   563
   564                 24  CF-CR-CHECK-COUNT       REDEFINES
   565                     CF-CR-CHECK-COUNTER      PIC X(4).
   566
   567                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   568                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   569
   570                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   571                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   572                 24  CF-MAIL-PROCESSING       PIC X.
   573                     88  MAIL-PROCESSING          VALUE 'Y'.
   574
   575         16  CF-MISC-SYSTEM-CONTROL.
   576             20  CF-SYSTEM-C                 PIC X.
   577                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   578             20  CF-SYSTEM-D                 PIC X.
   579                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   580             20  CF-SOC-SEC-NO-SW            PIC X.
   581                 88  SOC-SEC-NO-USED             VALUE '1'.
   582             20  CF-MEMBER-NO-SW             PIC X.
   583                 88  MEMBER-NO-USED              VALUE '1'.
   584             20  CF-TAX-ID-NUMBER            PIC X(11).
   585             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   586             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   587                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   588                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   589                 88  CF-ALL-APPROVED             VALUE 'Y'.
   590                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   591             20  CF-SYSTEM-E                 PIC X.
   592                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   593
   594         16  CF-LGX-LIFE-USER               PIC X.
   595             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   596             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   597
   598         16  CF-CR-MONTH-END-DT             PIC XX.
   599
   600         16  CF-FILE-MAINT-DATES.
   601             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   602                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   603             20  CF-LAST-BATCH       REDEFINES
   604                 CF-LAST-BATCH-NO               PIC X(4).
   605             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   606             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   607             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   608             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   609             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   610             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  13
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   611             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   612             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   613             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   614             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   615
   616         16  CF-NEXT-COMPANY-ID             PIC XXX.
   617         16  FILLER                         PIC X.
   618
   619         16  CF-ALT-MORT-CODE               PIC X(4).
   620         16  CF-MEMBER-CAPTION              PIC X(10).
   621
   622         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   623             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   624             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   625             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   626             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   627             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   628
   629         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   630
   631         16  CF-LIFE-OVERRIDE-L1            PIC X.
   632         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   633         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   634         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   635
   636         16  CF-AH-OVERRIDE-L1              PIC X.
   637         16  CF-AH-OVERRIDE-L2              PIC XX.
   638         16  CF-AH-OVERRIDE-L6              PIC X(6).
   639         16  CF-AH-OVERRIDE-L12             PIC X(12).
   640
   641         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   642         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   643
   644         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   645         16  CF-AR-LAST-EL860-DT            PIC XX.
   646         16  CF-MP-MONTH-END-DT             PIC XX.
   647
   648         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   649         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   650             88  CF-CLAIM-PAID-TO               VALUE '1'.
   651
   652         16  CF-AR-MONTH-END-DT             PIC XX.
   653
   654         16  CF-CRDTCRD-USER                PIC X.
   655             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   656             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   657
   658         16  CF-CC-MONTH-END-DT             PIC XX.
   659
   660         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   661
   662         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   663             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   664             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   665             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   666         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   667         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   668         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  14
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   669         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   670             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   671             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   672         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   673         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   674         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   675             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   676         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   677
   678         16  CF-CL-ZIP-CODE.
   679             20  CF-CL-ZIP-PRIME.
   680                 24  CF-CL-ZIP-1ST          PIC X.
   681                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   682                 24  FILLER                 PIC X(4).
   683             20  CF-CL-ZIP-PLUS4            PIC X(4).
   684         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   685             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   686             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   687             20  FILLER                     PIC XXX.
   688
   689         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   690         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   691         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   692         16  CF-CO-OPTION-START-DATE        PIC XX.
   693         16  CF-REM-TRM-CALC-OPTION         PIC X.
   694           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   695                                                      '3' '4'.
   696           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   697           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   698           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   699           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   700           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   701           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   702
   703         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   704
   705         16  CF-PAYMENT-APPROVAL-LEVELS.
   706             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   707             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   708             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   709             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   710             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   711             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   712
   713         16  CF-END-USER-REPORTING-USER     PIC X.
   714             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   715             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   716
   717         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   718             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   719             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   720
   721         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   722
   723         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   724         16  FILLER                         PIC X.
   725
   726         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  15
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   727             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   728             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   729             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   730
   731         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   732
   733         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   734             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   735             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   736
   737         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   738             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   739             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   740
   741         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   742
   743         16  CF-CO-ACH-ID-CODE              PIC  X.
   744             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   745             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   746             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   747         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   748         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   749         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   750         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   751         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   752         16  CF-CO-ACH-RECV-NO              PIC X(08).
   753         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   754         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   755         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   756                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   757         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   758                 CF-CO-ACH-TRACE-NO         PIC X(4).
   759
   760         16  CF-CO-OVER-SHORT.
   761             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   762             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   763
   764*         16  FILLER                         PIC X(102).
   765         16  CF-PAYMENT-APPROVAL-LEVELS-2.
   766             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   767             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   768
   769         16  CF-AH-APPROVAL-DAYS.
   770             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   771             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   772             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   773             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   774
   775         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
   776
   777         16  CF-APPROV-LEV-5.
   778             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
   779             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
   780             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
   781
   782         16  FILLER                         PIC X(68).
   783****************************************************************
   784*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  16
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   785****************************************************************
   786
   787     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   788         16  CF-PROCESSOR-NAME              PIC X(30).
   789         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   790         16  CF-PROCESSOR-TITLE             PIC X(26).
   791         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   792                 88  MESSAGE-YES                VALUE 'Y'.
   793                 88  MESSAGE-NO                 VALUE ' ' 'N'.
   794
   795*****************************************************
   796****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   797****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   798****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   799****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   800*****************************************************
   801
   802         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   803             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   804             20  CF-APPLICATION-FORCE       PIC X.
   805             20  CF-INDIVIDUAL-APP.
   806                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   807                     28  CF-BROWSE-APP      PIC X.
   808                     28  CF-UPDATE-APP      PIC X.
   809
   810         16  CF-CURRENT-TERM-ON             PIC X(4).
   811         16  CF-PROCESSOR-LIMITS-CLAIMS.
   812             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   813             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   814             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   815             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   816             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   817             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   818             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   819         16  CF-PROCESSOR-CARRIER           PIC X.
   820             88  NO-CARRIER-SECURITY            VALUE ' '.
   821         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   822             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   823         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
   824             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   825         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   826             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   827
   828         16  CF-PROC-SYS-ACCESS-SW.
   829             20  CF-PROC-CREDIT-CLAIMS-SW.
   830                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   831                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   832                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   833                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   834             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   835                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   836                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   837             20  CF-PROC-LIFE-GNRLDGR-SW.
   838                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   839                     88  ACCESS-TO-LIFE             VALUE 'Y'.
   840                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   841                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
   842             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  17
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   843                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   844                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   845         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   846             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   847             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   848         16  CF-PROCESSOR-PRINTER               PIC X(4).
   849
   850         16  CF-APPROVAL-LEVEL                  PIC X.
   851             88  APPROVAL-LEVEL-1                   VALUE '1'.
   852             88  APPROVAL-LEVEL-2                   VALUE '2'.
   853             88  APPROVAL-LEVEL-3                   VALUE '3'.
   854             88  APPROVAL-LEVEL-4                   VALUE '4'.
   855             88  APPROVAL-LEVEL-5                   VALUE '5'.
   856
   857         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   858
   859         16  CF-LANGUAGE-TYPE                   PIC X.
   860             88  CF-LANG-IS-ENG                     VALUE 'E'.
   861             88  CF-LANG-IS-FR                      VALUE 'F'.
   862
   863         16  CF-CSR-IND                         PIC X.
   864         16  FILLER                             PIC X(239).
   865
   866****************************************************************
   867*             PROCESSOR/REMINDERS RECORD                       *
   868****************************************************************
   869
   870     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   871         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   872             20  CF-START-REMIND-DT         PIC XX.
   873             20  CF-END-REMIND-DT           PIC XX.
   874             20  CF-REMINDER-TEXT           PIC X(50).
   875         16  FILLER                         PIC X(296).
   876
   877
   878****************************************************************
   879*             STATE MASTER RECORD                              *
   880****************************************************************
   881
   882     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   883         16  CF-STATE-ABBREVIATION          PIC XX.
   884         16  CF-STATE-NAME                  PIC X(25).
   885         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   886         16  CF-ST-CALC-QUOTE-TOLERANCE.
   887             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   888             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   889             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   890             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   891                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   892                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   893             20  CF-ST-PREM-REJECT-SW       PIC X.
   894                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   895                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   896             20  CF-ST-REF-REJECT-SW        PIC X.
   897                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
   898                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   899         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
   900         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  18
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   901         16  CF-ST-REFUND-RULES.
   902             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   903             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   904             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   905         16  CF-ST-FST-PMT-EXTENSION.
   906             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   907             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
   908                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   909                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   910                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
   911                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
   912         16  CF-ST-STATE-CALL.
   913             20  CF-ST-CALL-UNEARNED        PIC X.
   914             20  CF-ST-CALL-RPT-CNTL        PIC X.
   915             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   916         16  CF-REPLACEMENT-LAW-SW          PIC X.
   917             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   918             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   919         16  CF-REPLACEMENT-LETTER          PIC X(4).
   920         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   921         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   922         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
   923         16  CF-ST-SPLIT-PAYMENT            PIC X.
   924         16  FILLER                         PIC X.
   925         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   926             20  CF-ST-BENEFIT-CD           PIC XX.
   927             20  CF-ST-BENEFIT-KIND         PIC X.
   928                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   929                 88  CF-ST-AH-KIND              VALUE 'A'.
   930             20  CF-ST-REM-TERM-CALC        PIC X.
   931                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   932                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   933                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   934                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   935                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   936                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   937                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   938                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   939
   940             20  CF-ST-REFUND-CALC          PIC X.
   941                 88  ST-REFUND-NOT-USED         VALUE SPACE.
   942                 88  ST-REFD-BY-R78             VALUE '1'.
   943                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
   944                 88  ST-REFD-AS-CALIF           VALUE '3'.
   945                 88  ST-REFD-AS-TEXAS           VALUE '4'.
   946                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
   947                 88  ST-REFD-ANTICIPATION       VALUE '6'.
   948                 88  ST-REFD-UTAH               VALUE '7'.
   949                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
   950                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
   951                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
   952
   953             20  CF-ST-EARNING-CALC         PIC X.
   954                 88  ST-EARNING-NOT-USED        VALUE SPACE.
   955                 88  ST-EARN-BY-R78             VALUE '1'.
   956                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
   957                 88  ST-EARN-AS-CALIF           VALUE '3'.
   958                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  19
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   959                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
   960                 88  ST-EARN-ANTICIPATION       VALUE '6'.
   961                 88  ST-EARN-MEAN               VALUE '8'.
   962                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
   963
   964             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
   965                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
   966                 88  ST-OVRD-BY-R78             VALUE '1'.
   967                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
   968                 88  ST-OVRD-AS-CALIF           VALUE '3'.
   969                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
   970                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
   971                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
   972                 88  ST-OVRD-MEAN               VALUE '8'.
   973                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
   974             20  FILLER                     PIC X.
   975
   976         16  CF-ST-COMMISSION-CAPS.
   977             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
   978             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
   979             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
   980             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
   981         16  CF-COMM-CAP-LIMIT-TO           PIC X.
   982                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
   983
   984         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
   985
   986         16  CF-ST-STATUTORY-INTEREST.
   987             20  CF-ST-STAT-DATE-FROM       PIC X.
   988                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
   989                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
   990             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
   991             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
   992             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
   993             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
   994             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
   995
   996         16  CF-ST-OVER-SHORT.
   997             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
   998             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
   999
  1000         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1001
  1002         16  CF-ST-RT-CALC                  PIC X.
  1003
  1004         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1005         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1006         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1007         16  CF-ST-RF-LR-CALC               PIC X.
  1008         16  CF-ST-RF-LL-CALC               PIC X.
  1009         16  CF-ST-RF-LN-CALC               PIC X.
  1010         16  CF-ST-RF-AH-CALC               PIC X.
  1011         16  CF-ST-RF-CP-CALC               PIC X.
  1012*        16  FILLER                         PIC X(206).
  1013*CIDMOD         16  FILLER                         PIC X(192).
  1014         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1015             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1016         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  20
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1017         16  CF-ST-VFY-2ND-BENE             PIC X.
  1018         16  CF-ST-CAUSAL-STATE             PIC X.
  1019         16  FILLER                         PIC X(185).
  1020
  1021****************************************************************
  1022*             BENEFIT MASTER RECORD                            *
  1023****************************************************************
  1024
  1025     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1026         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1027             20  CF-BENEFIT-CODE            PIC XX.
  1028             20  CF-BENEFIT-NUMERIC  REDEFINES
  1029                 CF-BENEFIT-CODE            PIC XX.
  1030             20  CF-BENEFIT-ALPHA           PIC XXX.
  1031             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1032             20  CF-BENEFIT-COMMENT         PIC X(10).
  1033
  1034             20  CF-LF-COVERAGE-TYPE        PIC X.
  1035                 88  CF-REDUCING                VALUE 'R'.
  1036                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1037
  1038             20  CF-SPECIAL-CALC-CD         PIC X.
  1039                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1040                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1041                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1042                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1043                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1044                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1045                 88  CF-FARM-PLAN               VALUE 'F'.
  1046                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1047                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1048                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1049                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1050                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1051                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1052                 88  CF-PRUDENTIAL              VALUE 'P'.
  1053                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1054                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1055                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1056                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1057                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1058                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1059
  1060             20  CF-JOINT-INDICATOR         PIC X.
  1061                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1062
  1063*            20  FILLER                     PIC X(12).
  1064             20  FILLER                     PIC X(11).
  1065             20  CF-BENEFIT-CATEGORY        PIC X.
  1066             20  CF-LOAN-TYPE               PIC X(8).
  1067
  1068             20  CF-CO-REM-TERM-CALC        PIC X.
  1069                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1070                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1071                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1072                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1073                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1074
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  21
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1075             20  CF-CO-EARNINGS-CALC        PIC X.
  1076                 88  CO-EARN-BY-R78             VALUE '1'.
  1077                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1078                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1079                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1080                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1081                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1082                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1083                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1084
  1085             20  CF-CO-REFUND-CALC          PIC X.
  1086                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1087                 88  CO-REFD-BY-R78             VALUE '1'.
  1088                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1089                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1090                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1091                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1092                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1093                 88  CO-REFD-MEAN               VALUE '8'.
  1094                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1095                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1096                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1097
  1098             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1099                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1100                 88  CO-OVRD-BY-R78             VALUE '1'.
  1101                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1102                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1103                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1104                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1105                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1106                 88  CO-OVRD-MEAN               VALUE '8'.
  1107                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1108
  1109             20  CF-CO-BEN-I-G-CD           PIC X.
  1110                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1111                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1112                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1113
  1114         16  FILLER                         PIC X(304).
  1115
  1116
  1117****************************************************************
  1118*             CARRIER MASTER RECORD                            *
  1119****************************************************************
  1120
  1121     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1122         16  CF-ADDRESS-DATA.
  1123             20  CF-MAIL-TO-NAME            PIC X(30).
  1124             20  CF-IN-CARE-OF              PIC X(30).
  1125             20  CF-ADDRESS-LINE-1          PIC X(30).
  1126             20  CF-ADDRESS-LINE-2          PIC X(30).
  1127             20  CF-CITY-STATE              PIC X(30).
  1128             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1129             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1130
  1131         16  CF-CLAIM-NO-CONTROL.
  1132             20  CF-CLAIM-NO-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  22
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1133                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1134                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1135                 88  CLAIM-NO-SEQ               VALUE '3'.
  1136                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1137             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1138                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1139                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1140                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1141
  1142         16  CF-CHECK-NO-CONTROL.
  1143             20  CF-CHECK-NO-METHOD         PIC X.
  1144                 88  CHECK-NO-MANUAL            VALUE '1'.
  1145                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1146                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1147                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1148             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1149                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1150
  1151         16  CF-DOMICILE-STATE              PIC XX.
  1152
  1153         16  CF-EXPENSE-CONTROLS.
  1154             20  CF-EXPENSE-METHOD          PIC X.
  1155                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1156                 88  DOLLARS-PER-PMT            VALUE '2'.
  1157                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1158                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1159             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1160             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1161
  1162         16  CF-CORRESPONDENCE-CONTROL.
  1163             20  CF-LETTER-RESEND-OPT       PIC X.
  1164                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1165                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1166             20  FILLER                     PIC X(4).
  1167
  1168         16  CF-RESERVE-CONTROLS.
  1169             20  CF-MANUAL-SW               PIC X.
  1170                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1171             20  CF-FUTURE-SW               PIC X.
  1172                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1173             20  CF-PTC-SW                  PIC X.
  1174                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1175             20  CF-IBNR-SW                 PIC X.
  1176                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1177             20  CF-PTC-LF-SW               PIC X.
  1178                 88  CF-LF-PTC-USED             VALUE '1'.
  1179             20  CF-CDT-ACCESS-METHOD       PIC X.
  1180                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1181                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1182                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1183             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1184
  1185         16  CF-CLAIM-CALC-METHOD           PIC X.
  1186             88  360-PLUS-MONTHS                VALUE '1'.
  1187             88  365-PLUS-MONTHS                VALUE '2'.
  1188             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1189             88  360-DAILY                      VALUE '4'.
  1190             88  365-DAILY                      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  23
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1191
  1192         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1193         16  FILLER                         PIC X(11).
  1194
  1195         16  CF-LIMIT-AMOUNTS.
  1196             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1197             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1198             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1199             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1200             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1201             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1202             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1203             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1204             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1205             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1206
  1207         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1208         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1209         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1210
  1211         16  CF-ZIP-CODE.
  1212             20  CF-ZIP-PRIME.
  1213                 24  CF-ZIP-1ST             PIC X.
  1214                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1215                 24  FILLER                 PIC X(4).
  1216             20  CF-ZIP-PLUS4               PIC X(4).
  1217         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1218             20  CF-CAN-POSTAL-1            PIC XXX.
  1219             20  CF-CAN-POSTAL-2            PIC XXX.
  1220             20  FILLER                     PIC XXX.
  1221
  1222         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1223         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1224         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1225
  1226         16  CF-RATING-SWITCH               PIC X.
  1227             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1228             88  CF-NO-RATING                   VALUE 'N'.
  1229
  1230         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1231
  1232         16  CF-CARRIER-OVER-SHORT.
  1233             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1234             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1235
  1236         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1237         16  CF-SECPAY-SWITCH               PIC X.
  1238             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1239             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1240         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1241         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1242         16  FILLER                         PIC X(444).
  1243*        16  FILLER                         PIC X(452).
  1244
  1245
  1246****************************************************************
  1247*             MORTALITY MASTER RECORD                          *
  1248****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  24
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1249
  1250     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1251         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1252                                INDEXED BY CF-MORT-NDX.
  1253             20  CF-MORT-TABLE              PIC X(5).
  1254             20  CF-MORT-TABLE-TYPE         PIC X.
  1255                 88  CF-MORT-JOINT              VALUE 'J'.
  1256                 88  CF-MORT-SINGLE             VALUE 'S'.
  1257                 88  CF-MORT-COMBINED           VALUE 'C'.
  1258                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1259                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1260             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1261             20  CF-MORT-AGE-METHOD         PIC XX.
  1262                 88  CF-AGE-LAST                VALUE 'AL'.
  1263                 88  CF-AGE-NEAR                VALUE 'AN'.
  1264             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1265             20  CF-MORT-ADJUSTMENT-DIRECTION
  1266                                            PIC X.
  1267                 88  CF-MINUS                   VALUE '-'.
  1268                 88  CF-PLUS                    VALUE '+'.
  1269             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1270             20  CF-MORT-JOINT-CODE         PIC X.
  1271                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1272             20  CF-MORT-PC-Q               PIC X.
  1273                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1274             20  CF-MORT-TABLE-CODE         PIC X(4).
  1275             20  CF-MORT-COMMENTS           PIC X(15).
  1276             20  FILLER                     PIC X(14).
  1277
  1278         16  FILLER                         PIC X(251).
  1279
  1280
  1281****************************************************************
  1282*             BUSSINESS TYPE MASTER RECORD                     *
  1283****************************************************************
  1284
  1285     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1286* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1287* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1288* AND RECORD 05 IS TYPES 81-99
  1289         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1290             20  CF-BUSINESS-TITLE          PIC  X(19).
  1291             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1292                                            PIC S9V9(4) COMP-3.
  1293             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1294             20  FILLER                     PIC  X.
  1295         16  FILLER                         PIC  X(248).
  1296
  1297
  1298****************************************************************
  1299*             TERMINAL MASTER RECORD                           *
  1300****************************************************************
  1301
  1302     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1303
  1304         16  CF-COMPANY-TERMINALS.
  1305             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1306                                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  25
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1307         16  FILLER               PIC X(248).
  1308
  1309
  1310****************************************************************
  1311*             LIFE EDIT MASTER RECORD                          *
  1312****************************************************************
  1313
  1314     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1315         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1316             20  CF-LIFE-CODE-IN            PIC XX.
  1317             20  CF-LIFE-CODE-OUT           PIC XX.
  1318         16  FILLER                         PIC X(248).
  1319
  1320
  1321****************************************************************
  1322*             AH EDIT MASTER RECORD                            *
  1323****************************************************************
  1324
  1325     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1326         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1327             20  CF-AH-CODE-IN              PIC XXX.
  1328             20  CF-AH-CODE-OUT             PIC XX.
  1329         16  FILLER                         PIC X(248).
  1330
  1331
  1332****************************************************************
  1333*             CREDIBILITY TABLES                               *
  1334****************************************************************
  1335
  1336     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1337         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1338                             INDEXED BY CF-CRDB-NDX.
  1339             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1340             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1341             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1342         16  FILLER                         PIC  X(332).
  1343
  1344
  1345****************************************************************
  1346*             REPORT CUSTOMIZATION RECORD                      *
  1347****************************************************************
  1348
  1349     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1350         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1351             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1352             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1353             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1354**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1355****       A T-TRANSFER.                                   ****
  1356             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1357
  1358         16  FILLER                         PIC XX.
  1359
  1360         16  CF-CARRIER-CNTL-OPT.
  1361             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1362                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1363                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1364             20  CF-CARRIER-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  26
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1365                                            PIC X.
  1366         16  CF-GROUP-CNTL-OPT.
  1367             20  CF-GROUP-OPT-SEQ           PIC 9.
  1368                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1369                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1370             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1371                                            PIC X(6).
  1372         16  CF-STATE-CNTL-OPT.
  1373             20  CF-STATE-OPT-SEQ           PIC 9.
  1374                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1375                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1376             20  CF-STATE-SELECT OCCURS 3 TIMES
  1377                                            PIC XX.
  1378         16  CF-ACCOUNT-CNTL-OPT.
  1379             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1380                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1381                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1382             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1383                                            PIC X(10).
  1384         16  CF-BUS-TYP-CNTL-OPT.
  1385             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1386                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1387                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1388             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1389                                            PIC XX.
  1390         16  CF-LF-TYP-CNTL-OPT.
  1391             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1392                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1393                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1394             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1395                                            PIC XX.
  1396         16  CF-AH-TYP-CNTL-OPT.
  1397             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1398                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1399                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1400             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1401                                            PIC XX.
  1402         16  CF-REPTCD1-CNTL-OPT.
  1403             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1404                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1405                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1406             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1407                                            PIC X(10).
  1408         16  CF-REPTCD2-CNTL-OPT.
  1409             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1410                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1411                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1412             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1413                                            PIC X(10).
  1414         16  CF-USER1-CNTL-OPT.
  1415             20  CF-USER1-OPT-SEQ           PIC 9.
  1416                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1417                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1418             20  CF-USER1-SELECT OCCURS 3 TIMES
  1419                                            PIC X(10).
  1420         16  CF-USER2-CNTL-OPT.
  1421             20  CF-USER2-OPT-SEQ           PIC 9.
  1422                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  27
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1423                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1424             20  CF-USER2-SELECT OCCURS 3 TIMES
  1425                                            PIC X(10).
  1426         16  CF-USER3-CNTL-OPT.
  1427             20  CF-USER3-OPT-SEQ           PIC 9.
  1428                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1429                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1430             20  CF-USER3-SELECT OCCURS 3 TIMES
  1431                                            PIC X(10).
  1432         16  CF-USER4-CNTL-OPT.
  1433             20  CF-USER4-OPT-SEQ           PIC 9.
  1434                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1435                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1436             20  CF-USER4-SELECT OCCURS 3 TIMES
  1437                                            PIC X(10).
  1438         16  CF-USER5-CNTL-OPT.
  1439             20  CF-USER5-OPT-SEQ           PIC 9.
  1440                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1441                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1442             20  CF-USER5-SELECT OCCURS 3 TIMES
  1443                                            PIC X(10).
  1444         16  CF-REINS-CNTL-OPT.
  1445             20  CF-REINS-OPT-SEQ           PIC 9.
  1446                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1447                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1448             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1449                 24  CF-REINS-PRIME         PIC XXX.
  1450                 24  CF-REINS-SUB           PIC XXX.
  1451
  1452         16  CF-AGENT-CNTL-OPT.
  1453             20  CF-AGENT-OPT-SEQ           PIC 9.
  1454                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1455                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1456             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1457                                            PIC X(10).
  1458
  1459         16  FILLER                         PIC X(43).
  1460
  1461         16  CF-LOSS-RATIO-SELECT.
  1462             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1463             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1464         16  CF-ENTRY-DATE-SELECT.
  1465             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1466             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1467         16  CF-EFFECTIVE-DATE-SELECT.
  1468             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1469             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1470
  1471         16  CF-EXCEPTION-LIST-IND          PIC X.
  1472             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1473
  1474         16  FILLER                         PIC X(318).
  1475
  1476****************************************************************
  1477*                  EXCEPTION REPORTING RECORD                  *
  1478****************************************************************
  1479
  1480     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  28
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1481         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1482             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1483
  1484         16  CF-COMBINED-LIFE-AH-OPT.
  1485             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1486             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1487             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1488             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1489
  1490         16  CF-LIFE-OPT.
  1491             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1492             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1493             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1494             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1495             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1496             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1497             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1498             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1499             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1500             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1501
  1502         16  CF-AH-OPT.
  1503             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1504             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1505             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1506             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1507             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1508             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1509             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1510             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1511             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1512             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1513
  1514         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1515             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1516             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1517             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1518
  1519         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1520
  1521         16  FILLER                         PIC X(673).
  1522
  1523
  1524****************************************************************
  1525*             MORTGAGE SYSTEM PLAN RECORD                      *
  1526****************************************************************
  1527
  1528     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1529         16  CF-PLAN-TYPE                   PIC X.
  1530             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1531             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1532             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1533         16  CF-PLAN-ABBREV                 PIC XXX.
  1534         16  CF-PLAN-DESCRIPT               PIC X(10).
  1535         16  CF-PLAN-NOTES                  PIC X(20).
  1536         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1537         16  CF-PLAN-UNDERWRITING.
  1538             20  CF-PLAN-TERM-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  29
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1539                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1540                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1541             20  CF-PLAN-AGE-DATA.
  1542                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1543                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1544                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1545             20  CF-PLAN-BENEFIT-DATA.
  1546                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1547                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1548                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1549                                            PIC S9(7)V99  COMP-3.
  1550         16  CF-PLAN-POLICY-FORMS.
  1551             20  CF-POLICY-FORM             PIC X(12).
  1552             20  CF-MASTER-APPLICATION      PIC X(12).
  1553             20  CF-MASTER-POLICY           PIC X(12).
  1554         16  CF-PLAN-RATING.
  1555             20  CF-RATE-CODE               PIC X(5).
  1556             20  CF-SEX-RATING              PIC X.
  1557                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1558                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1559             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1560             20  CF-SUB-STD-TYPE            PIC X.
  1561                 88  CF-PCT-OF-PREM            VALUE '1'.
  1562                 88  CF-PCT-OF-BENE            VALUE '2'.
  1563         16  CF-PLAN-PREM-TOLERANCES.
  1564             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1565             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1566         16  CF-PLAN-PYMT-TOLERANCES.
  1567             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1568             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1569         16  CF-PLAN-MISC-DATA.
  1570             20  FILLER                     PIC X.
  1571             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1572             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1573         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1574         16  CF-PLAN-IND-GRP                PIC X.
  1575             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1576                                                     '1'.
  1577             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1578                                                     '2'.
  1579         16  CF-MIB-SEARCH-SW               PIC X.
  1580             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1581             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1582             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1583             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1584         16  CF-ALPHA-SEARCH-SW             PIC X.
  1585             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1586             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1587             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1588             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1589             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1590             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1591             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1592             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1593             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1594             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1595                                                     'A' 'B' 'C'
  1596                                                     'X' 'Y' 'Z'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  30
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1597         16  CF-EFF-DT-RULE-SW              PIC X.
  1598             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1599             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1600             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1601             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1602             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1603         16  FILLER                         PIC X(4).
  1604         16  CF-HEALTH-QUESTIONS            PIC X.
  1605             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1606         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1607         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1608         16  CF-PLAN-SNGL-JNT               PIC X.
  1609             88  CF-COMBINED-PLAN              VALUE 'C'.
  1610             88  CF-JNT-PLAN                   VALUE 'J'.
  1611             88  CF-SNGL-PLAN                  VALUE 'S'.
  1612         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1613         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1614         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1615         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1616         16  CF-RERATE-CNTL                 PIC  X.
  1617             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1618             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1619             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1620             88  CF-AUTO-RECALC                 VALUE '4'.
  1621         16  CF-BENEFIT-TYPE                PIC  X.
  1622             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1623             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1624         16  CF-POLICY-FEE                  PIC S999V99
  1625                                                    COMP-3.
  1626         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1627         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1628         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1629         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1630         16  FILLER                         PIC  X(32).
  1631         16  CF-TERMINATION-FORM            PIC  X(04).
  1632         16  FILLER                         PIC  X(08).
  1633         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1634                                                       COMP-3.
  1635         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1636         16  CF-ISSUE-LETTER                PIC  X(4).
  1637         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1638         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1639             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1640             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1641         16  CF-MP-REFUND-CALC              PIC X.
  1642             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1643             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1644             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1645             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1646             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1647             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1648             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1649             88  CF-MP-REFD-MEAN                VALUE '8'.
  1650         16  CF-ALT-RATE-CODE               PIC  X(5).
  1651
  1652
  1653         16  FILLER                         PIC X(498).
  1654****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  31
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1655*             MORTGAGE COMPANY MASTER RECORD                   *
  1656****************************************************************
  1657
  1658     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1659         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1660         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1661             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1662             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1663             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1664             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1665             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1666
  1667         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1668         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1669         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1670         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1671         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1672
  1673         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1674             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1675         16  CF-MP-RECON-USE-IND            PIC X(1).
  1676             88  CF-MP-USE-RECON             VALUE 'Y'.
  1677         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1678             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1679         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1680             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1681             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1682         16  FILLER                         PIC X(1).
  1683         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1684             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1685         16  CF-MORTG-MIB-VERSION           PIC X.
  1686             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1687             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1688             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1689         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1690             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1691                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1692             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1693                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1694             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1695                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1696             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1697                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1698             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1699                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1700             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1701                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1702         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1703         16  FILLER                         PIC X(7).
  1704         16  CF-MORTG-DESTINATION-SYMBOL.
  1705             20  CF-MORTG-MIB-COMM          PIC X(5).
  1706             20  CF-MORTG-MIB-TERM          PIC X(5).
  1707         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1708             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1709         16  FILLER                         PIC X(03).
  1710         16  CF-MP-CHECK-NO-CONTROL.
  1711             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1712                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  32
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1713                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1714                                                ' ' LOW-VALUES.
  1715                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1716                                               VALUE '3'.
  1717         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1718         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1719         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1720             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1721                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1722             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1723                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1724             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1725                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1726             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1727                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1728             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1729                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1730             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1731                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1732         16  CF-MORTG-BILLING-AREA.
  1733             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1734                                            PIC X.
  1735         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1736         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  1737         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1738         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1739             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1740             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1741         16  FILLER                         PIC X.
  1742         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1743             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  1744             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1745         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1746         16  FILLER                         PIC X(8).
  1747         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1748         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1749         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1750         16  CF-ACH-COMPANY-ID.
  1751             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1752                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1753                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1754                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1755             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1756         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1757             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1758         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1759             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  1760             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1761         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1762         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1763         16  FILLER                         PIC X(536).
  1764
  1765****************************************************************
  1766*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1767****************************************************************
  1768
  1769     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1770         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  33
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1771             20  CF-FEMALE-HEIGHT.
  1772                 24  CF-FEMALE-FT           PIC 99.
  1773                 24  CF-FEMALE-IN           PIC 99.
  1774             20  CF-FEMALE-MIN-WT           PIC 999.
  1775             20  CF-FEMALE-MAX-WT           PIC 999.
  1776         16  FILLER                         PIC X(428).
  1777
  1778     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1779         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1780             20  CF-MALE-HEIGHT.
  1781                 24  CF-MALE-FT             PIC 99.
  1782                 24  CF-MALE-IN             PIC 99.
  1783             20  CF-MALE-MIN-WT             PIC 999.
  1784             20  CF-MALE-MAX-WT             PIC 999.
  1785         16  FILLER                         PIC X(428).
  1786******************************************************************
  1787*             AUTOMATIC ACTIVITY RECORD                          *
  1788******************************************************************
  1789     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1790         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1791             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1792             20  CF-SYS-LETTER-ID           PIC X(04).
  1793             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1794             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  1795             20  CF-SYS-RESET-SW            PIC X(01).
  1796             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1797             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1798
  1799         16  FILLER                         PIC X(50).
  1800
  1801         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  1802             20  CF-USER-ACTIVE-SW          PIC X(01).
  1803             20  CF-USER-LETTER-ID          PIC X(04).
  1804             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1805             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1806             20  CF-USER-RESET-SW           PIC X(01).
  1807             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1808             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1809             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1810
  1811         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  34
* EL517.cbl
  1813 FD  ERPNDB.
* 1814                                  COPY ERCPNDB.
  1815******************************************************************
  1816*                                                                *
  1817*                                                                *
  1818*                            ERCPNDB.                            *
  1819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1820*                            VMOD=2.025                          *
  1821*                                                                *
  1822*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1823*                                                                *
  1824******************************************************************
  1825*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1826*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1827******************************************************************
  1828*                                                                *
  1829*                                                                *
  1830*   FILE TYPE = VSAM,KSDS                                        *
  1831*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1832*                                                                *
  1833*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1834*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1835*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1836*                                                 RKP=13,LEN=36  *
  1837*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1838*                                      AND CHG-SEQ.)             *
  1839*                                                RKP=49,LEN=11   *
  1840*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1841*                                      AND CHG-SEQ.)             *
  1842*                                                RKP=60,LEN=15   *
  1843*                                                                *
  1844*   LOG = NO                                                     *
  1845*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1846******************************************************************
  1847******************************************************************
  1848*                   C H A N G E   L O G
  1849*
  1850* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1851*-----------------------------------------------------------------
  1852*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1853* EFFECTIVE    NUMBER
  1854*-----------------------------------------------------------------
  1855* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1856* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1857* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1858* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1859* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1860* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1861* 032306                   PEMA  ADD BOW LOAN NUMBER
  1862* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1863* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1864* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1865* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1866* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1867* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  1868* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1869* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1870******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  35
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1871
  1872 01  PENDING-BUSINESS.
  1873     12  PB-RECORD-ID                     PIC XX.
  1874         88  VALID-PB-ID                        VALUE 'PB'.
  1875
  1876     12  PB-CONTROL-PRIMARY.
  1877         16  PB-COMPANY-CD                PIC X.
  1878         16  PB-ENTRY-BATCH               PIC X(6).
  1879         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1880         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1881
  1882     12  PB-CONTROL-BY-ACCOUNT.
  1883         16  PB-COMPANY-CD-A1             PIC X.
  1884         16  PB-CARRIER                   PIC X.
  1885         16  PB-GROUPING.
  1886             20  PB-GROUPING-PREFIX       PIC XXX.
  1887             20  PB-GROUPING-PRIME        PIC XXX.
  1888         16  PB-STATE                     PIC XX.
  1889         16  PB-ACCOUNT.
  1890             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1891             20  PB-ACCOUNT-PRIME         PIC X(6).
  1892         16  PB-CERT-EFF-DT               PIC XX.
  1893         16  PB-CERT-NO.
  1894             20  PB-CERT-PRIME            PIC X(10).
  1895             20  PB-CERT-SFX              PIC X.
  1896         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1897
  1898         16  PB-RECORD-TYPE               PIC X.
  1899             88  PB-MAILING-DATA                VALUE '0'.
  1900             88  PB-ISSUE                       VALUE '1'.
  1901             88  PB-CANCELLATION                VALUE '2'.
  1902             88  PB-BATCH-TRAILER               VALUE '9'.
  1903
  1904     12  PB-CONTROL-BY-ORIG-BATCH.
  1905         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1906         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1907         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1908         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1909
  1910     12  PB-CONTROL-BY-CSR.
  1911         16  PB-CSR-COMPANY-CD            PIC X.
  1912         16  PB-CSR-ID                    PIC X(4).
  1913         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1914         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1915         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1916******************************************************************
  1917*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1918******************************************************************
  1919
  1920     12  PB-LAST-MAINT-DT                 PIC XX.
  1921     12  PB-LAST-MAINT-BY                 PIC X(4).
  1922     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1923
  1924     12  PB-RECORD-BODY                   PIC X(375).
  1925
  1926     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1927         16  PB-CERT-ORIGIN               PIC X.
  1928             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  36
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1929         16  PB-I-NAME.
  1930             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1931             20  PB-I-INSURED-FIRST-NAME.
  1932                 24  PB-I-INSURED-1ST-INIT PIC X.
  1933                 24  FILLER                PIC X(9).
  1934             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1935         16  PB-I-AGE                     PIC S99   COMP-3.
  1936         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1937         16  PB-I-BIRTHDAY                PIC XX.
  1938         16  PB-I-INSURED-SEX             PIC X.
  1939             88  PB-SEX-MALE     VALUE 'M'.
  1940             88  PB-SEX-FEMALE   VALUE 'F'.
  1941
  1942         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1943         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1944         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1945         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1946         16  PB-I-SKIP-CODE               PIC X.
  1947             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1948             88  PB-SKIP-JULY              VALUE '1'.
  1949             88  PB-SKIP-AUGUST            VALUE '2'.
  1950             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1951             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1952             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1953             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1954             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1955             88  PB-SKIP-JUNE              VALUE '8'.
  1956             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1957             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1958             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1959         16  PB-I-TERM-TYPE               PIC X.
  1960             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1961             88  PB-PAID-WEEKLY            VALUE 'W'.
  1962             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1963             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1964             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1965         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1966         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1967         16  PB-I-DATA-ENTRY-SW           PIC X.
  1968             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1969             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1970             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1971             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1972         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1973         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1974*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1975         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1976         16  FILLER                       PIC X.
  1977
  1978         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1979             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1980             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1981                                                   '90' THRU '99'.
  1982         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1983                                          PIC XX.
  1984         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1985         16  PB-I-AMOUNT-FINANCED REDEFINES
  1986                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  37
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1987         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1988         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1989                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1990         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1991         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1992         16  PB-I-CLP-AMOUNT REDEFINES
  1993                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1994         16  PB-I-LF-CALC-FLAG            PIC X.
  1995             88 PB-COMP-LF-PREM               VALUE '?'.
  1996         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1997         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1998         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1999         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2000         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2001         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2002         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2003         16  PB-I-LF-ABBR                 PIC XXX.
  2004         16  PB-I-LF-INPUT-CD             PIC XX.
  2005
  2006         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2007             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2008             88  PB-INVALID-AH               VALUE '  ' '00'
  2009                                                   '90' THRU '99'.
  2010         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2011         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2012         16  PB-I-AH-CALC-FLAG            PIC X.
  2013             88 PB-COMP-AH-PREM                  VALUE '?'.
  2014         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2015         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2016         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2017         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2018         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2019         16  PB-I-AH-ABBR                 PIC XXX.
  2020         16  PB-I-AH-INPUT-CD             PIC XXX.
  2021
  2022         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2023         16  PB-I-REIN-TABLE              PIC XXX.
  2024         16  PB-I-BUSINESS-TYPE           PIC 99.
  2025         16  PB-I-INDV-GRP-CD             PIC X.
  2026         16  PB-I-MORT-CODE.
  2027             20  PB-I-TABLE               PIC X.
  2028             20  PB-I-INTEREST            PIC XX.
  2029             20  PB-I-MORT-TYP            PIC X.
  2030         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2031         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2032         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2033         16  PB-I-INDV-GRP-OVRD           PIC X.
  2034         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2035         16  PB-I-SIG-SW                  PIC X.
  2036             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2037         16  PB-I-RATE-CLASS              PIC XX.
  2038         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2039         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2040         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2041         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2042         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2043         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2044         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  38
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2045         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2046         16  PB-I-OB-FLAG                 PIC X.
  2047             88  PB-I-OB                      VALUE 'B'.
  2048             88  PB-I-SUMMARY                 VALUE 'Z'.
  2049         16  PB-I-ENTRY-STATUS            PIC X.
  2050             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2051                                              'M' '5' '9' '2'.
  2052             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2053             88  PB-I-POLICY-PENDING          VALUE '2'.
  2054             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2055             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2056             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2057             88  PB-I-REIN-ONLY               VALUE '9'.
  2058             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2059             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2060             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2061             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2062         16  PB-I-INT-CODE                PIC X.
  2063             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2064             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2065         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2066         16  PB-I-SOC-SEC-NO              PIC X(11).
  2067         16  PB-I-MEMBER-NO               PIC X(12).
  2068         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2069*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2070         16  PB-I-OLD-LOF                 PIC XXX.
  2071         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2072         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2073         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2074         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2075         16  PB-I-LIFE-INDICATOR          PIC X.
  2076             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2077         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2078         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2079                                          PIC S9(5)V99    COMP-3.
  2080         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2081             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2082             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2083         16  PB-I-1ST-PMT-DT              PIC XX.
  2084         16  PB-I-JOINT-INSURED.
  2085             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2086             20 PB-I-JOINT-FIRST-NAME.
  2087                24  PB-I-JOINT-FIRST-INIT PIC X.
  2088                24  FILLER                PIC X(9).
  2089             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2090*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2091         16  PB-I-BENEFICIARY-NAME.
  2092             20  PB-I-BANK-NUMBER         PIC X(10).
  2093             20  FILLER                   PIC X(15).
  2094         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2095         16  PB-I-REFERENCE               PIC X(12).
  2096         16  FILLER REDEFINES PB-I-REFERENCE.
  2097             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2098             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2099             20  PB-I-CLP-STATE           PIC XX.
  2100         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2101             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2102             88  PB-I-POLICY-DECLINED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  39
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2103             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2104         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2105         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2106         16  PB-I-RESIDENT-STATE          PIC XX.
  2107         16  PB-I-RATE-CODE               PIC X(4).
  2108         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2109         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2110         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2111         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2112         16  PB-I-BANK-NOCHRGB            PIC 99.
  2113         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2114         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2115
  2116     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2117         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2118             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2119         16  PB-C-CANCEL-ORIGIN           PIC X.
  2120             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2121         16  PB-C-LF-CANCEL-DT            PIC XX.
  2122         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2123         16  PB-C-LF-CALC-REQ             PIC X.
  2124             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2125         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2126         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2127         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2128             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2129         16  PB-C-AH-CANCEL-DT            PIC XX.
  2130         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2131         16  PB-C-AH-CALC-REQ             PIC X.
  2132             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2133         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2134         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2135         16  PB-C-LAST-NAME               PIC X(15).
  2136         16  PB-C-REFUND-SW               PIC X.
  2137             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2138             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2139         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2140         16  PB-C-PAYEE-CODE              PIC X(6).
  2141         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2142         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2143         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2144         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2145         16  PB-C-REFERENCE               PIC X(12).
  2146         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2147         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2148         16  PB-C-POST-CARD-IND           PIC X.
  2149         16  PB-C-CANCEL-REASON           PIC X.
  2150         16  PB-C-REF-INTERFACE-SW        PIC X.
  2151         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2152         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2153         16  FILLER                       PIC X(01).
  2154*        16  FILLER                       PIC X(18).
  2155         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2156*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2157         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2158         16  PB-CANCELED-CERT-DATA.
  2159             20  PB-CI-INSURED-NAME.
  2160                 24  PB-CI-LAST-NAME      PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  40
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2161                 24  PB-CI-INITIALS       PIC XX.
  2162             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2163             20  PB-CI-INSURED-SEX        PIC X.
  2164             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2165             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2166             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2167             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2168             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2169             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2170             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2171             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2172             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2173             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2174             20  PB-CI-RATE-CLASS         PIC XX.
  2175             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2176             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2177             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2178             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2179             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2180             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2181             20  PB-CI-LF-ABBR            PIC X(3).
  2182             20  PB-CI-AH-ABBR            PIC X(3).
  2183             20  PB-CI-OB-FLAG            PIC X.
  2184                 88  PB-CI-OB                VALUE 'B'.
  2185             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2186                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2187                                           'M' '4' '5' '9' '2'.
  2188                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2189                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2190                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2191                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2192                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2193                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2194                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2195                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2196                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2197                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2198                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2199                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2200             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2201                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2202                                           'M' '4' '5' '9' '2'.
  2203                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2204                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2205                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2206                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2207                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2208                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2209                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2210                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2211                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2212                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2213                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2214                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2215             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2216             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2217             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2218             20  PB-CI-MEMBER-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  41
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2219             20  PB-CI-INT-CODE           PIC X.
  2220                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2221                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2222             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2223             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2224             20  PB-CI-COMP-EXCP-SW       PIC X.
  2225                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2226                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2227             20  PB-CI-ENTRY-STATUS       PIC X.
  2228             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2229             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2230             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2231             20  PB-CI-DEATH-DT           PIC XX.
  2232             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2233             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2234             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2235             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2236             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2237             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2238             20  PB-CI-ENTRY-DT              PIC XX.
  2239             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2240             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2241             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2242             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2243             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2244             20  PB-CI-OLD-LOF               PIC XXX.
  2245*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2246             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2247             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2248             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2249             20  PB-CI-INDV-GRP-CD           PIC X.
  2250             20  PB-CI-BENEFICIARY-NAME.
  2251                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2252                 24  FILLER                  PIC X(15).
  2253             20  PB-CI-NOTE-SW               PIC X.
  2254             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2255             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2256             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2257             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2258             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2259             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2260             20  PB-CI-FIRST-NAME            PIC X(10).
  2261             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2262
  2263         16  FILLER                       PIC X(13).
  2264*032306  16  FILLER                       PIC X(27).
  2265*        16  FILLER                       PIC X(46).
  2266
  2267     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2268         16  FILLER                       PIC X(10).
  2269         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2270         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2271         16  PB-M-INSURED-MID-INIT        PIC X.
  2272         16  PB-M-INSURED-AGE             PIC 99.
  2273         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2274         16  PB-M-INSURED-SEX             PIC X.
  2275         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2276         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  42
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2277         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2278         16  PB-M-INSURED-CITY-STATE.
  2279             20  PB-M-INSURED-CITY        PIC X(28).
  2280             20  PB-M-INSURED-STATE       PIC XX.
  2281         16  PB-M-INSURED-ZIP-CODE.
  2282             20  PB-M-INSURED-ZIP-PRIME.
  2283                 24  PB-M-INSURED-ZIP-1   PIC X.
  2284                     88  PB-M-CANADIAN-POST-CODE
  2285                                             VALUE 'A' THRU 'Z'.
  2286                 24  FILLER               PIC X(4).
  2287             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2288         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2289                                        PB-M-INSURED-ZIP-CODE.
  2290             20  PM-M-INS-CAN-POST1       PIC XXX.
  2291             20  PM-M-INS-CAN-POST2       PIC XXX.
  2292             20  FILLER                   PIC XXX.
  2293         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2294         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2295         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2296         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2297         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2298         16  PB-M-CRED-BENE-CITYST.
  2299             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2300             20  PB-M-CRED-BENE-STATE     PIC XX.
  2301
  2302         16  FILLER                       PIC X(92).
  2303
  2304     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2305         16  FILLER                       PIC X(10).
  2306         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2307         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2308         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2309         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2310         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2311         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2312         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2313         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2314         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2315         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2316         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2317         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2318         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2319         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2320         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2321         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2322         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2323         16  PB-ACCOUNT-NAME              PIC X(30).
  2324         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2325         16  PB-REFERENCE                 PIC X(12).
  2326         16  PB-B-RECEIVED-DT             PIC XX.
  2327         16  FILLER                       PIC X(234).
  2328
  2329     12  PB-RECORD-STATUS.
  2330         16  PB-CREDIT-SELECT-DT          PIC XX.
  2331         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2332         16  PB-BILLED-DT                 PIC XX.
  2333         16  PB-BILLING-STATUS            PIC X.
  2334             88  PB-ENTRY-REVERSED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  43
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2335             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2336             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2337         16  PB-RECORD-BILL               PIC X.
  2338             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2339             88  PB-RECORD-RETURNED           VALUE 'R'.
  2340             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2341             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2342             88  PB-OVERRIDE-AH               VALUE 'A'.
  2343             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2344         16  PB-BATCH-ENTRY               PIC X.
  2345             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2346             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2347             88  PB-REISSUED-CERT             VALUE 'E'.
  2348             88  PB-MONTHLY-CERT              VALUE 'M'.
  2349             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2350             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2351             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2352         16  PB-FORCE-CODE                PIC X.
  2353             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2354             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2355             88  PB-CANCEL-FORCE              VALUE '8'.
  2356             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2357             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2358             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2359             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2360             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2361             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2362             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2363         16  PB-FATAL-FLAG                PIC X.
  2364             88  PB-FATAL-ERRORS              VALUE 'X'.
  2365         16  PB-FORCE-ER-CD               PIC X.
  2366             88  PB-FORCE-ERRORS              VALUE 'F'.
  2367             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2368         16  PB-WARN-ER-CD                PIC X.
  2369             88  PB-WARNING-ERRORS            VALUE 'W'.
  2370         16  FILLER                       PIC X.
  2371         16  PB-OUT-BAL-CD                PIC X.
  2372             88  PB-OUT-OF-BAL                VALUE 'O'.
  2373         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2374         16  PB-AH-OVERRIDE-L1            PIC X.
  2375         16  PB-INPUT-DT                  PIC XX.
  2376         16  PB-INPUT-BY                  PIC X(4).
  2377         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2378         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2379         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2380         16  PB-LF-EARNING-METHOD         PIC X.
  2381         16  PB-AH-EARNING-METHOD         PIC X.
  2382         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2383         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2384         16  PB-REIN-CD                   PIC XXX.
  2385         16  PB-LF-REFUND-TYPE            PIC X.
  2386         16  PB-AH-REFUND-TYPE            PIC X.
  2387         16  PB-ACCT-EFF-DT               PIC XX.
  2388         16  PB-ACCT-EXP-DT               PIC XX.
  2389         16  PB-COMPANY-ID                PIC X(3).
  2390         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2391         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2392         16  PB-SV-CARRIER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  44
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2393         16  PB-SV-GROUPING               PIC X(6).
  2394         16  PB-SV-STATE                  PIC XX.
  2395         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2396         16  PB-GA-BILLING-INFO.
  2397             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2398                                          PIC XX.
  2399         16  PB-SV-REMIT-TO  REDEFINES
  2400             PB-GA-BILLING-INFO           PIC X(10).
  2401         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2402         16  PB-I-LOAN-OFFICER            PIC X(5).
  2403         16  PB-I-VIN                     PIC X(17).
  2404
  2405         16  FILLER                       PIC X(04).
  2406         16  IMNET-BYPASS-SW              PIC X.
  2407
  2408******************************************************************
  2409*                COMMON EDIT ERRORS                              *
  2410******************************************************************
  2411
  2412     12  PB-COMMON-ERRORS.
  2413         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2414                                           PIC S9(4)     COMP.
  2415
  2416******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  45
* EL517.cbl
  2418 FD  ERREIN.
* 2419                                  COPY ERCREIN.
  2420******************************************************************07/27/93
  2421*                                                                *ERCREIN
  2422*                            ERCREIN                             *   LV009
  2423*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2424*                            VMOD=2.010                          *   CL**9
  2425*                                                                *ERCREIN
  2426*   ONLINE CREDIT SYSTEM                                         *ERCREIN
  2427*                                                                *ERCREIN
  2428*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
  2429*                                                                *ERCREIN
  2430*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
  2431*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
  2432*                                                                *ERCREIN
  2433*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
  2434*       ALTERNATE PATH = NONE                                    *ERCREIN
  2435*                                                                *ERCREIN
  2436*   LOG = NO                                                     *ERCREIN
  2437*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
  2438*                                                                *ERCREIN
  2439******************************************************************ERCREIN
  2440*                   C H A N G E   L O G
  2441*
  2442* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2443*-----------------------------------------------------------------
  2444*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2445* EFFECTIVE    NUMBER
  2446*-----------------------------------------------------------------
  2447* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  2448* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  2449******************************************************************
  2450 01  REINSURANCE-RECORD.                                          ERCREIN
  2451     12  RE-RECORD-ID                      PIC XX.                ERCREIN
  2452         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
  2453                                                                  ERCREIN
  2454     12  RE-CONTROL-PRIMARY.                                      ERCREIN
  2455         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
  2456         16  RE-KEY.                                              ERCREIN
  2457             20  RE-CODE                   PIC X.                 ERCREIN
  2458                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
  2459                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
  2460             20  RE-TABLE                  PIC XXX.               ERCREIN
  2461             20  FILLER                    PIC XXX.               ERCREIN
  2462         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
  2463             20  FILLER                    PIC X.                 ERCREIN
  2464             20  RE-COMPANY.                                      ERCREIN
  2465                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
  2466                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
  2467                                                                  ERCREIN
  2468     12  RE-MAINT-INFORMATION.                                    ERCREIN
  2469         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
  2470         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
  2471         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
  2472         16  FILLER                        PIC X(10).             ERCREIN
  2473                                                                  ERCREIN
  2474     12  RE-TABLE-DATA.                                           ERCREIN
  2475         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  46
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2476                                                                  ERCREIN
  2477         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
  2478             20  RE-REI-COMP-NO.                                  ERCREIN
  2479                 24  RE-REI-COMP           PIC XXX.               ERCREIN
  2480                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
  2481             20  RE-LF-QC                  PIC X.                 ERCREIN
  2482             20  RE-AH-QC                  PIC X.                 ERCREIN
  2483             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2484             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2485             20  RE-LFAGE-LO               PIC 99.                ERCREIN
  2486             20  RE-LFAGE-HI               PIC 99.                ERCREIN
  2487             20  RE-AHAGE-LO               PIC 99.                ERCREIN
  2488             20  RE-AHAGE-HI               PIC 99.                ERCREIN
  2489             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
  2490             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
  2491             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
  2492             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
  2493             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2494             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2495             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
  2496             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
  2497             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
  2498             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
  2499             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2500             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2501             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2502             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2503             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2504             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2505             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2506             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2507             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
  2508             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
  2509             20  RE-INTERACTIVE            PIC X.                 ERCREIN
  2510             20  RE-REMAINING              PIC X.                 ERCREIN
  2511             20  RE-LF-RUNOFF-SW           PIC X.                      000
  2512             20  RE-AH-RUNOFF-SW           PIC X.                      000
  2513             20  FILLER                    PIC X(19).                  000
  2514                                                                  ERCREIN
  2515         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
  2516         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
  2517         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
  2518         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
  2519             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
  2520                                                                  ERCREIN
  2521         16  FILLER                        PIC X(27).             ERCREIN
  2522                                                                  ERCREIN
  2523     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
  2524         16  RE-NAME                       PIC X(30).             ERCREIN
  2525         16  RE-LF-PE                      PIC X.                 ERCREIN
  2526         16  RE-AH-PE                      PIC X.                 ERCREIN
  2527         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2528         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2529         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2530         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2531         16  RE-PRT-ST                     PIC X.                 ERCREIN
  2532         16  RE-PRT-OW                     PIC X.                 ERCREIN
  2533         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  47
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2534         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
  2535         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
  2536         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
  2537         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
  2538         16  RE-LF-COMM                    PIC X.                 ERCREIN
  2539         16  RE-AH-COMM                    PIC X.                 ERCREIN
  2540         16  RE-LF-TAX                     PIC X.                 ERCREIN
  2541         16  RE-AH-TAX                     PIC X.                 ERCREIN
  2542         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
  2543         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2544         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2545                                                                  ERCREIN
  2546         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
  2547             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
  2548                                                                  ERCREIN
  2549         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
  2550             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
  2551                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2552                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2553                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2554                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2555             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
  2556                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
  2557                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
  2558                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2559                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
  2560                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2561                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2562                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2563                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2564             20  FILLER                    PIC XXX.               ERCREIN
  2565             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2566                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2567                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2568                                                                  ERCREIN
  2569         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
  2570             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
  2571                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2572                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2573                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2574                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2575             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
  2576                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
  2577                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
  2578                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2579                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
  2580                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2581                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2582                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2583                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2584             20  FILLER                    PIC XXX.               ERCREIN
  2585             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2586                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2587                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2588                                                                  ERCREIN
  2589         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
  2590                                                                  ERCREIN
  2591         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  48
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2592                                                                  ERCREIN
  2593         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2594         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2595         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2596         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2597         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2598         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2599         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
  2600         16  RE-MORT-SW                    PIC X.                 ERCREIN
  2601         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
  2602             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
  2603             88  RE-CEDED                          VALUE 'C'.        CL**2
  2604             88  RE-ASSUMED                        VALUE 'A'.        CL**2
  2605             88  RE-PHANTOM                        VALUE 'P'.        CL**2
  2606                                                                  ERCREIN
  2607         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
  2608             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
  2609         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
  2610             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
  2611         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
  2612             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
  2613         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
  2614             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  2615         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  2616             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  2617                                                                     CL**3
  2618         16  RE-PRT-CRSV                   PIC X.                    CL**5
  2619                                                                     CL**5
  2620         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  2621                                                                     CL**8
  2622         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  2623                                                                     CL**8
  2624         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  2625                                                                     CL**9
  2626         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  2627             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  2628             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  2629
  2630         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  2631             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  2632                                                                     CL**9
  2633         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  2634         16  FILLER                        PIC X(2281).              CL**9
  2635                                                                  ERCREIN
  2636         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  2637                                                                  ERCREIN
  2638******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  49
* EL517.cbl
  2640 FD  ELCERT.
* 2641                                  COPY ELCCERT.
  2642******************************************************************04/15/98
  2643*                                                                *ELCCERT
  2644*                            ELCCERT.                            *   LV002
  2645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2646*                            VMOD=2.013                          *   CL**2
  2647*                                                                *ELCCERT
  2648*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
  2649*                                                                *ELCCERT
  2650*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
  2651*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
  2652*                                                                *ELCCERT
  2653*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
  2654*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
  2655*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
  2656*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
  2657*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
  2658*                                                                *ELCCERT
  2659*   LOG = YES                                                    *ELCCERT
  2660*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
  2661******************************************************************
  2662*                   C H A N G E   L O G
  2663*
  2664* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2665*-----------------------------------------------------------------
  2666*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2667* EFFECTIVE    NUMBER
  2668*-----------------------------------------------------------------
  2669* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2670* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2671* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2672* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2673* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2674* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2675* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2676* 032612  CR2011110200001  PEMA  AHL CHANGES
  2677******************************************************************
  2678                                                                  ELCCERT
  2679 01  CERTIFICATE-MASTER.                                          ELCCERT
  2680     12  CM-RECORD-ID                      PIC XX.                ELCCERT
  2681         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
  2682                                                                  ELCCERT
  2683     12  CM-CONTROL-PRIMARY.                                      ELCCERT
  2684         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
  2685         16  CM-CARRIER                    PIC X.                 ELCCERT
  2686         16  CM-GROUPING.                                         ELCCERT
  2687             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
  2688             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
  2689         16  CM-STATE                      PIC XX.                ELCCERT
  2690         16  CM-ACCOUNT.                                          ELCCERT
  2691             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
  2692             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
  2693         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
  2694         16  CM-CERT-NO.                                          ELCCERT
  2695             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
  2696             20  CM-CERT-SFX               PIC X.                 ELCCERT
  2697                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  50
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2698     12  CM-CONTROL-BY-NAME.                                      ELCCERT
  2699         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
  2700         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
  2701         16  CM-INSURED-INITIALS.                                 ELCCERT
  2702             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
  2703             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
  2704                                                                  ELCCERT
  2705     12  CM-CONTROL-BY-SSN.                                       ELCCERT
  2706         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
  2707         16  CM-SOC-SEC-NO.                                       ELCCERT
  2708             20  CM-SSN-STATE              PIC XX.                ELCCERT
  2709             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
  2710             20  CM-SSN-LN3.                                      ELCCERT
  2711                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
  2712                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
  2713                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
  2714                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
  2715                                                                  ELCCERT
  2716     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
  2717         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
  2718         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
  2719                                                                  ELCCERT
  2720     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
  2721         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
  2722         16  CM-MEMBER-NO.                                        ELCCERT
  2723             20  CM-MEMB-STATE             PIC XX.                ELCCERT
  2724             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
  2725             20  CM-MEMB-LN4.                                     ELCCERT
  2726                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
  2727                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
  2728                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
  2729                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
  2730                                                                  ELCCERT
  2731     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
  2732         16  CM-INSURED-FIRST-NAME.                               ELCCERT
  2733             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
  2734             20  FILLER                    PIC X(9).              ELCCERT
  2735         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
  2736         16  CM-INSURED-SEX                PIC X.                 ELCCERT
  2737             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
  2738             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
  2739         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
  2740         16  CM-JOINT-INSURED-NAME.                               ELCCERT
  2741             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
  2742             20  CM-JT-FIRST-NAME.                                ELCCERT
  2743                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
  2744                 24  FILLER                PIC X(9).              ELCCERT
  2745             20  CM-JT-INITIAL             PIC X.                 ELCCERT
  2746                                                                  ELCCERT
  2747     12  CM-LIFE-DATA.                                            ELCCERT
  2748         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
  2749         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2750         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2751         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
  2752         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
  2753         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2754         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
  2755         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  51
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2756         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
  2757         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2758         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2759         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2760         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2761         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2762         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2763         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2764         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
  2765         16  FILLER                        PIC XX.                ELCCERT
  2766                                                                  ELCCERT
  2767     12  CM-AH-DATA.                                              ELCCERT
  2768         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
  2769         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2770         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2771         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
  2772         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2773         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2774         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2775         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2776         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2777         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
  2778         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
  2779         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
  2780             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
  2781         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2782         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2783         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
  2784         16  FILLER                        PIC X.                 ELCCERT
  2785                                                                  ELCCERT
  2786     12  CM-LOAN-INFORMATION.                                     ELCCERT
  2787         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
  2788         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2789                                           PIC S9(5)V99  COMP-3.
  2790         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
  2791         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
  2792         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
  2793         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
  2794         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
  2795         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
  2796         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
  2797         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
  2798         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
  2799         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
  2800             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
  2801             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
  2802         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
  2803             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
  2804             20  CM-RATE-CODE              PIC X(4).              ELCCERT
  2805             20  FILLER                    PIC XX.                ELCCERT
  2806         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
  2807             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
  2808             20  FILLER                    PIC XXX.               ELCCERT
  2809         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
  2810         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
  2811             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
  2812         16  CM-POST-CARD-IND              PIC X.
  2813         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  52
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2814         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
  2815             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
  2816             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
  2817             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
  2818         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
  2819             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
  2820             88  CM-GROUP                     VALUE 'G'.          ELCCERT
  2821         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
  2822             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
  2823             88  SKIP-JULY                    VALUE '1'.          ELCCERT
  2824             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
  2825             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
  2826             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
  2827             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
  2828             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
  2829             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
  2830             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
  2831             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
  2832             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
  2833             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
  2834         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
  2835             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
  2836             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
  2837             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
  2838             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
  2839             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
  2840         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
  2841         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
  2842         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
  2843*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
  2844         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
  2845         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
  2846         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2847         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2848         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
  2849                                                                  ELCCERT
  2850     12  CM-STATUS-DATA.                                          ELCCERT
  2851         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
  2852         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
  2853                                                                  ELCCERT
  2854         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2855         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
  2856         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2857                                                                  ELCCERT
  2858         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
  2859         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
  2860         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
  2861                                                                  ELCCERT
  2862         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
  2863             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2864                                                'M' '4' '5' '9'.  ELCCERT
  2865             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2866             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
  2867             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2868             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2869             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2870             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2871             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  53
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2872             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2873             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2874             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2875             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
  2876             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
  2877                                                                  ELCCERT
  2878         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2879         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
  2880         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2881                                                                  ELCCERT
  2882         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
  2883         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
  2884         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
  2885                                                                  ELCCERT
  2886         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
  2887             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2888                                                'M' '4' '5' '9'.  ELCCERT
  2889             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2890             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
  2891             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2892             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2893             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2894             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2895             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
  2896             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2897             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2898             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2899             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
  2900             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
  2901                                                                  ELCCERT
  2902         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
  2903             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
  2904             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
  2905             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
  2906         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
  2907                                                                  ELCCERT
  2908         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
  2909         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
  2910         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
  2911         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
  2912                                                                  ELCCERT
  2913     12  CM-NOTE-SW                        PIC X.                 ELCCERT
  2914         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
  2915         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
  2916         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
  2917         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
  2918         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2919         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2920         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2921         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2922     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
  2923         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
  2924         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
  2925     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
  2926         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
  2927         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
  2928                                                                  ELCCERT
  2929*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  54
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2930     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2931     12  FILLER                            PIC X.
  2932                                                                  ELCCERT
  2933*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2934     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2935     12  FILLER                            PIC X.
  2936*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2937     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
  2938                                                                  ELCCERT
  2939     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
  2940         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
  2941         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
  2942         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
  2943         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
  2944         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
  2945     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
  2946         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
  2947         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
  2948         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
  2949         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
  2950         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
  2951         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
  2952         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
  2953         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
  2954                                                                  ELCCERT
  2955     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
  2956         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
  2957         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
  2958                                                                  ELCCERT
  2959     12  CM-USER-FIELD                     PIC X.                 ELCCERT
  2960     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2961     12  CM-CLP-STATE                      PIC XX.
  2962     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2963     12  CM-USER-RESERVED                  PIC XXX.
  2964     12  FILLER REDEFINES CM-USER-RESERVED.
  2965         16  CM-AH-CLASS-CD                PIC XX.
  2966         16  F                             PIC X.
  2967******************************************************************ELCCERT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  55
* EL517.cbl
  2969 FD  ELMSTR.
* 2970                                  COPY ELCMSTR.
  2971******************************************************************04/15/98
  2972*                                                                *ELCMSTR
  2973*                            ELCMSTR.                            *   LV002
  2974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2975*                            VMOD=2.012                          *   CL**2
  2976*                                                                *ELCMSTR
  2977*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  2978*                                                                *ELCMSTR
  2979*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  2980*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  2981*                                                                *ELCMSTR
  2982*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  2983*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  2984*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  2985*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  2986*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  2987*                                                 RKP=75,LEN=21  *ELCMSTR
  2988*                                                                *ELCMSTR
  2989*   **** NOTE ****                                               *ELCMSTR
  2990*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  2991*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  2992*                                                                *ELCMSTR
  2993*   LOG = YES                                                    *ELCMSTR
  2994*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  2995******************************************************************
  2996*                   C H A N G E   L O G
  2997*
  2998* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2999*-----------------------------------------------------------------
  3000*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3001* EFFECTIVE    NUMBER
  3002*-----------------------------------------------------------------
  3003* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3004* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3005* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3006******************************************************************ELCMSTR
  3007 01  CLAIM-MASTER.                                                ELCMSTR
  3008     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  3009         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  3010                                                                  ELCMSTR
  3011     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  3012         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  3013         16  CL-CARRIER              PIC X.                       ELCMSTR
  3014         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  3015         16  CL-CERT-NO.                                          ELCMSTR
  3016             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  3017             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  3018                                                                  ELCMSTR
  3019     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  3020         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  3021         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  3022         16  CL-INSURED-NAME.                                     ELCMSTR
  3023             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  3024             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  3025                                                                  ELCMSTR
  3026     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  56
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3027         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
  3028         16  CL-SOC-SEC-NO.                                       ELCMSTR
  3029             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  3030             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  3031             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  3032                                                                  ELCMSTR
  3033     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  3034         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  3035         16  CL-CERT-NO-A4.                                       ELCMSTR
  3036             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  3037             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  3038                                                                  ELCMSTR
  3039     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  3040         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  3041         16  CL-CCN-A5.                                           ELCMSTR
  3042             20  CL-CCN.                                          ELCMSTR
  3043                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  3044                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  3045             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  3046                                                                  ELCMSTR
  3047     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  3048         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  3049         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  3050             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  3051             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  3052             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  3053         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  3054         16  FILLER                  PIC X(5).                    ELCMSTR
  3055                                                                  ELCMSTR
  3056     12  CL-PROCESSING-INFO.                                      ELCMSTR
  3057         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  3058         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  3059             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  3060             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  3061         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  3062*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  3063*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  3064*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  3065*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  3066*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  3067         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  3068             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  3069             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  3070             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  3071         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  3072         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  3073         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  3074         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  3075         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  3076         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  3077         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  3078         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  3079         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  3080         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  3081         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  3082             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  3083             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
  3084             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  57
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3085         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
  3086                                                                  ELCMSTR
  3087         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  3088             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  3089             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  3090                                                                  ELCMSTR
  3091         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  3092             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  3093             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  3094                                                                  ELCMSTR
  3095         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  3096         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  3097         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  3098                                                                  ELCMSTR
  3099         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  3100         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  3101         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  3102             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  3103             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  3104             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  3105             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  3106             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  3107             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  3108         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  3109         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  3110         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  3111             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  3112         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3113         16  FILLER                  PIC X.
  3114                                                                  ELCMSTR
  3115     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  3116         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  3117             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  3118             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  3119             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  3120         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  3121             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  3122             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  3123             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  3124             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  3125                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  3126                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  3127             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  3128                                                                  ELCMSTR
  3129     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  3130         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  3131             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  3132             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  3133         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  3134             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  3135             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  3136         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  3137         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  3138         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
  3139         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  3140         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  3141         16  CL-CRITICAL-PERIOD      PIC 99.
  3142*        16  FILLER                  PIC XX.                      ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  58
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3143         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  3144         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
  3145         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  3146         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  3147             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  3148             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  3149             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  3150             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  3151             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  3152             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  3153             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  3154             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  3155             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  3156         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  3157         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  3158         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  3159         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  3160         16  CL-DENIAL-TYPE          PIC X.
  3161             88  CL-TYPE-DENIAL          VALUE '1'.
  3162             88  CL-TYPE-RESCISSION      VALUE '2'.
  3163             88  CL-TYPE-REFORMATION     VALUE '3'.
  3164             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3165             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3166         16  CL-CRIT-PER-RECURRENT   PIC X.
  3167         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3168         16  CL-RTW-DT               PIC XX.
  3169                                                                  ELCMSTR
  3170     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  3171         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  3172             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  3173             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  3174             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  3175         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  3176         16  FILLER                  PIC XX.                      ELCMSTR
  3177         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  3178         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  3179             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3180                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  3181             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3182                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  3183             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  3184                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  3185             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  3186                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  3187             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  3188                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  3189             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3190                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  3191             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3192                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  3193                                                                  ELCMSTR
  3194     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  3195         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
  3196         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  3197                                                                  ELCMSTR
  3198     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  3199                                                                  ELCMSTR
  3200     12  CL-PROCESS-ERRORS.                                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  59
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3201         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  3202             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  3203         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  3204             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
  3205                                                                  ELCMSTR
  3206     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  3207                                                                  ELCMSTR
  3208     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  3209         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  3210         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  3211         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  3212         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  3213                                                                  ELCMSTR
  3214     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  3215         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  3216         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  3217         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  3218         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  3219                                                                  ELCMSTR
  3220     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  3221     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  3222     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  3223                                                                  ELCMSTR
  3224     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  3225     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  3226     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  3227     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  3228                                                                  ELCMSTR
  3229     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  3230     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3231         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3232         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3233         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3234     12  cl-insured-claim            pic x.
  3235         88  cl-claim-on-primary         value 'P'.
  3236         88  cl-claim-on-secondary       value 'S'.
  3237     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  60
* EL517.cbl
  3239 FD  ERCTBL.
* 3240                                 COPY ERCCTBL.
  3241******************************************************************04/29/98
  3242*                                                                *ERCCTBL
  3243*                                                                *ERCCTBL
  3244*                            ERCCTBL                             *   LV002
  3245*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3246*                            VMOD=2.003                              CL**2
  3247*                                                                *ERCCTBL
  3248*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  3249*                                                                *ERCCTBL
  3250*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  3251*                                                                *ERCCTBL
  3252*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  3253*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  3254*                                                                *ERCCTBL
  3255*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  3256*       ALTERNATE PATH = NONE                                    *ERCCTBL
  3257*                                                                *ERCCTBL
  3258*   LOG = NO                                                     *ERCCTBL
  3259*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  3260*                                                                *ERCCTBL
  3261*                                                                *ERCCTBL
  3262******************************************************************ERCCTBL
  3263                                                                  ERCCTBL
  3264 01  COMM-TABLE-RECORD.                                           ERCCTBL
  3265     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  3266         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  3267                                                                  ERCCTBL
  3268     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  3269         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  3270         16  CT-TABLE                      PIC XXX.               ERCCTBL
  3271         16  CT-CNTRL-2.                                          ERCCTBL
  3272             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  3273             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  3274                                                                  ERCCTBL
  3275     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  3276         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  3277         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  3278         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  3279         16  FILLER                        PIC X(31).             ERCCTBL
  3280                                                                  ERCCTBL
  3281     12  CT-LIMITS.                                               ERCCTBL
  3282         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  3283                                                                  ERCCTBL
  3284         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  3285                                                                  ERCCTBL
  3286         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  3287                                                                  ERCCTBL
  3288     12  CT-RATES.                                                ERCCTBL
  3289         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  3290             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  3291             20  CT-RT-R   REDEFINES                              ERCCTBL
  3292                 CT-RT                     PIC XXX.               ERCCTBL
  3293                                                                  ERCCTBL
  3294     12  FILLER                            PIC  X(42).            ERCCTBL
  3295                                                                  ERCCTBL
  3296******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  61
* EL517.cbl
  3297
  3298 FD  ERACCT.
* 3299                                 COPY ERCACCT.
  3300******************************************************************04/19/98
  3301*                                                                *ERCACCT
  3302*                                                                *ERCACCT
  3303*                            ERCACCT                             *   LV031
  3304*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  3305*                            VMOD=2.031                          *ERCACCT
  3306*                                                                *ERCACCT
  3307*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  3308*                                                                *ERCACCT
  3309*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  3310*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  3311*                                                                *ERCACCT
  3312*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  3313*                                                                *ERCACCT
  3314*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  3315*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  3316*                                                                *ERCACCT
  3317*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  3318*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  3319*                                                                *ERCACCT
  3320*   LOG = NO                                                     *ERCACCT
  3321*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  3322*                                                                *ERCACCT
  3323*                                                                *ERCACCT
  3324******************************************************************ERCACCT
  3325*                   C H A N G E   L O G
  3326*
  3327* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3328*-----------------------------------------------------------------
  3329*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3330* EFFECTIVE    NUMBER
  3331*-----------------------------------------------------------------
  3332* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3333* 092705    2005050300006  PEMA  ADD SPP LEASES
  3334* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3335* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3336* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3337* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3338* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3339******************************************************************
  3340                                                                  ERCACCT
  3341 01  ACCOUNT-MASTER.                                              ERCACCT
  3342     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  3343         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  3344                                                                  ERCACCT
  3345     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  3346         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  3347         16  AM-MSTR-CNTRL.                                       ERCACCT
  3348             20  AM-CONTROL-A.                                    ERCACCT
  3349                 24  AM-CARRIER            PIC X.                 ERCACCT
  3350                 24  AM-GROUPING.                                 ERCACCT
  3351                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  3352                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  3353                 24  AM-STATE              PIC XX.                ERCACCT
  3354                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  62
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3355                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  3356                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  3357             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  3358                                           PIC X(19).             ERCACCT
  3359             20  AM-CNTRL-B.                                      ERCACCT
  3360                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  3361                 24  FILLER                PIC X(4).              ERCACCT
  3362             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  3363                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  3364                                                                  ERCACCT
  3365     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  3366         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  3367         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  3368         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  3369         16  AM-VG-STATE                   PIC XX.                ERCACCT
  3370         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  3371         16  AM-VG-DATE.                                          ERCACCT
  3372             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  3373             20  FILLER                    PIC X(4).              ERCACCT
  3374         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  3375                                           PIC 9(11)      COMP-3. ERCACCT
  3376     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3377         16  FILLER                        PIC X(10).
  3378         16  AM-VG-KEY3.
  3379             20  AM-VG3-ACCOUNT            PIC X(10).
  3380             20  AM-VG3-EXP-DT             PIC XX.
  3381         16  FILLER                        PIC X(4).
  3382     12  AM-MAINT-INFORMATION.                                    ERCACCT
  3383         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  3384         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  3385         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  3386         16  FILLER                        PIC XX.                ERCACCT
  3387                                                                  ERCACCT
  3388     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  3389     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  3390                                                                  ERCACCT
  3391     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  3392         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  3393         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  3394                                                                  ERCACCT
  3395     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  3396     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  3397                                                                  ERCACCT
  3398     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  3399     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  3400                                                                  ERCACCT
  3401     12  AM-NAME                           PIC X(30).             ERCACCT
  3402     12  AM-PERSON                         PIC X(30).             ERCACCT
  3403     12  AM-ADDRS                          PIC X(30).             ERCACCT
  3404     12  AM-CITY.
  3405         16  AM-ADDR-CITY                  PIC X(28).
  3406         16  AM-ADDR-STATE                 PIC XX.
  3407     12  AM-ZIP.                                                  ERCACCT
  3408         16  AM-ZIP-PRIME.                                        ERCACCT
  3409             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  3410                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  3411             20  FILLER                    PIC X(4).              ERCACCT
  3412         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  63
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3413     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  3414         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  3415         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  3416         16  FILLER                        PIC XXX.               ERCACCT
  3417     12  AM-TEL-NO.                                               ERCACCT
  3418         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  3419         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  3420         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  3421     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  3422         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  3423         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  3424                                                                  ERCACCT
  3425     12  AM-COMM-STRUCTURE.                                       ERCACCT
  3426         16  AM-DEFN-1.                                           ERCACCT
  3427             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  3428                 24  AM-AGT.                                      ERCACCT
  3429                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  3430                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  3431                 24  AM-COM-TYP            PIC X.                 ERCACCT
  3432                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  3433                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  3434                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  3435                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  3436                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  3437                 24  AM-GL-CODES           PIC X.                 ERCACCT
  3438                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  3439                 24  FILLER                PIC X(01).             ERCACCT
  3440         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  3441             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  3442                 24  FILLER                PIC X(11).             ERCACCT
  3443                 24  AM-L-COMA             PIC XXX.               ERCACCT
  3444                 24  AM-J-COMA             PIC XXX.               ERCACCT
  3445                 24  AM-A-COMA             PIC XXX.               ERCACCT
  3446                 24  FILLER                PIC X(6).              ERCACCT
  3447                                                                  ERCACCT
  3448     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  3449         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  3450                                                                  ERCACCT
  3451     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  3452                                                                  ERCACCT
  3453     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  3454         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  3455         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  3456     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  3457         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  3458         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  3459     12  AM-GPCD                           PIC 99.                ERCACCT
  3460     12  AM-IG                             PIC X.                 ERCACCT
  3461         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  3462         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  3463     12  AM-STATUS                         PIC X.                 ERCACCT
  3464         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  3465         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  3466         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  3467         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3468         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3469         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3470     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  64
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3471     12  AM-ID-NO                          PIC X(11).             ERCACCT
  3472                                                                  ERCACCT
  3473     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  3474     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  3475     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  3476     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3477     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3478     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3479     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3480     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3481     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3482                                                                  ERCACCT
  3483     12  AM-USER-FIELDS.                                          ERCACCT
  3484         16  AM-FLD-1                      PIC XX.                ERCACCT
  3485         16  AM-FLD-2                      PIC XX.                ERCACCT
  3486         16  AM-FLD-3                      PIC XX.                ERCACCT
  3487         16  AM-FLD-4                      PIC XX.                ERCACCT
  3488         16  AM-FLD-5                      PIC XX.                ERCACCT
  3489                                                                  ERCACCT
  3490     12  AM-1ST-PROD-DATE.                                        ERCACCT
  3491         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  3492         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  3493         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  3494     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  3495     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  3496         16  AM-PUR-YR                     PIC XX.                ERCACCT
  3497         16  AM-PUR-MO                     PIC XX.                ERCACCT
  3498         16  AM-PUR-DA                     PIC XX.                ERCACCT
  3499     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3500     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3501     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  3502     12  AM-INACTIVE-DATE.                                        ERCACCT
  3503         16  AM-INA-MO                     PIC 99.                ERCACCT
  3504         16  AM-INA-DA                     PIC 99.                ERCACCT
  3505         16  AM-INA-YR                     PIC 99.                ERCACCT
  3506     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  3507                                                                  ERCACCT
  3508     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3509     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3510                                                                  ERCACCT
  3511     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  3512         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  3513         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  3514         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  3515         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  3516                                                                  ERCACCT
  3517     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  3518         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  3519         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  3520                                                                  ERCACCT
  3521     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  3522                                                                  ERCACCT
  3523     12  AM-OVER-SHORT.                                           ERCACCT
  3524         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  3525         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  3526                                                                  ERCACCT
  3527     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3528     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  65
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3529                                                                  ERCACCT
  3530     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  3531     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  3532                                                                  ERCACCT
  3533     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  3534     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  3535     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  3536     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  3537     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  3538     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  3539     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  3540     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  3541     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3542     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  3543     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  3544     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  3545     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3546     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3547     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3548     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  3549                                                                  ERCACCT
  3550     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  3551                                                                  ERCACCT
  3552     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  3553     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  3554                                                                  ERCACCT
  3555     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  3556     12  AM-EARN-METHODS.                                         ERCACCT
  3557         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  3558             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  3559             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  3560             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  3561             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3562         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  3563             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  3564             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  3565             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  3566             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3567         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  3568             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  3569             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  3570             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  3571             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  3572             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  3573             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  3574                                                                  ERCACCT
  3575     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  3576     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  3577     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  3578                                                                  ERCACCT
  3579     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  3580     12  AM-RET-P-E                        PIC X.                 ERCACCT
  3581     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  3582     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  3583     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  3584     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  3585         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  3586         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  66
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3587     12  AM-RETRO-EARNINGS.                                       ERCACCT
  3588         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  3589         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  3590         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  3591     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  3592         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  3593         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  3594     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  3595         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  3596         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  3597         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  3598     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  3599     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  3600                                                                  ERCACCT
  3601     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  3602         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  3603         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  3604         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  3605         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  3606         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  3607                                                                  ERCACCT
  3608     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3609                                                                  ERCACCT
  3610     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3611                                                                  ERCACCT
  3612     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  3613         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  3614                                                                  ERCACCT
  3615     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  3616         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  3617         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  3618                                                                  ERCACCT
  3619     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  3620         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  3621                                                                  ERCACCT
  3622     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  3623         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  3624         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  3625                                                                  ERCACCT
  3626     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  3627                                                                  ERCACCT
  3628     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  3629     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3630     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3631     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3632     12  AM-DCC-UEF-STATE                  PIC XX.
  3633     12  FILLER                            PIC XXX.
  3634     12  AM-REPORT-CODE-3                  PIC X(10).
  3635*    12  FILLER                            PIC X(22).             ERCACCT
  3636                                                                  ERCACCT
  3637     12  AM-RESERVE-DATE.                                         ERCACCT
  3638         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  3639         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  3640         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  3641                                                                  ERCACCT
  3642     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  3643     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  3644         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  67
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3645         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  3646         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  3647         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  3648                                                                  ERCACCT
  3649     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  3650         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  3651         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  3652         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  3653         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  3654                                                                  ERCACCT
  3655     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  3656         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  3657             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  3658             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  3659             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  3660             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  3661             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  3662             20  FILLER                    PIC XX.                ERCACCT
  3663         16  FILLER                        PIC X(80).             ERCACCT
  3664                                                                  ERCACCT
  3665     12  AM-TRANSFER-DATA.                                        ERCACCT
  3666         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  3667             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  3668             20  AM-TRNFROM-GROUPING.                             ERCACCT
  3669                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  3670                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  3671             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  3672             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  3673                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  3674                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  3675             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  3676         16  AM-TRANSFERRED-TO.                                   ERCACCT
  3677             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  3678             20  AM-TRNTO-GROUPING.                               ERCACCT
  3679                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  3680                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  3681             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  3682             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  3683                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  3684                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  3685             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  3686         16  FILLER                        PIC X(10).             ERCACCT
  3687                                                                  ERCACCT
  3688     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  3689                                                                  ERCACCT
  3690     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  3691         16  AM-DEFN-1-SAVED.                                     ERCACCT
  3692             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  3693                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  3694                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  3695                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3696                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3697                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3698                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  3699                 24  FILLER                PIC X.                 ERCACCT
  3700                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  3701                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  3702                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  68
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3703         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  3704             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  3705                 24  FILLER                PIC X(11).             ERCACCT
  3706                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  3707                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  3708                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  3709                 24  FILLER                PIC X(6).              ERCACCT
  3710                                                                  ERCACCT
  3711     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  3712         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  3713            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  3714            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  3715            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  3716                                                                  ERCACCT
  3717     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  3718     12  FILLER                            PIC X(120).            ERCACCT
  3719                                                                  ERCACCT
  3720     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  3721         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  3722         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  3723             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  3724             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3725                                                          COMP-3. ERCACCT
  3726             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3727                                                          COMP-3. ERCACCT
  3728         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  3729             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  3730             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3731                                                          COMP-3. ERCACCT
  3732             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3733                                                          COMP-3. ERCACCT
  3734                                                                  ERCACCT
  3735     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  3736         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  3737         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  3738         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  3739         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  3740             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  3741                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  3742                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  3743             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  3744                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  3745                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  3746             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  3747                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  3748                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  3749         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  3750             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  3751                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  3752                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  3753                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  3754             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  3755                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  3756                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  3757             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  3758                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  3759                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  3760                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  69
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3761     12  AM-COMMENTS.                                             ERCACCT
  3762         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  3763                                                                  ERCACCT
  3764     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  3765         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  3766         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  3767         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  3768         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  3769         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  3770             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  3771             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  3772             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  3773             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  3774         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  3775             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  3776             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  3777             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  3778         16  FILLER                        PIC X(102).            ERCACCT
  3779                                                                  ERCACCT
  3780     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  3781         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  3782             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  3783             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  3784             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  3785             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  3786             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  3787         16  FILLER                          PIC X(10).           ERCACCT
  3788******************************************************************ERCACCT
  3789
  3790 FD  ELCERR.
* 3791                                 COPY ELCERRS.
  3792******************************************************************04/15/98
  3793*                                                                *ELCERRS
  3794*                                                                *ELCERRS
  3795*                            ELCERRS.                            *   LV002
  3796*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3797*                            VMOD 2.002                          *   CL**2
  3798*                                                                *ELCERRS
  3799*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *ELCERRS
  3800*                                                                *ELCERRS
  3801*   FILE TYPE = VSAM,KSDS                                        *ELCERRS
  3802*   RECORD SIZE = 72    RECFORM = FIX                            *ELCERRS
  3803*                                                                *ELCERRS
  3804*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *ELCERRS
  3805*       ALTERNATE PATH  = NOT USED                               *ELCERRS
  3806*                                                                *ELCERRS
  3807*   LOG = NO                                                     *ELCERRS
  3808*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCERRS
  3809******************************************************************ELCERRS
  3810 01  ERROR-MESSAGE-FILE.                                          ELCERRS
  3811     12  EM-RECORD-ID                PIC XX.                      ELCERRS
  3812         88  VALID-EM-ID                VALUE 'EM'.               ELCERRS
  3813                                                                  ELCERRS
  3814     12  EM-CONTROL-PRIMARY.                                      ELCERRS
  3815         16  EM-MESSAGE-NUMBER       PIC 9(4).                    ELCERRS
  3816                                                                  ELCERRS
  3817     12  EM-ERROR-TEXT.                                           ELCERRS
  3818         16  EM-ERROR-TEXT-PREFIX    PIC X(6).                    ELCERRS
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  70
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRS)
  3819         16  FILLER                  PIC X(59).                   ELCERRS
  3820                                                                  ELCERRS
  3821     12  EM-ERROR-SEVERITY           PIC X.                       ELCERRS
  3822         88  ERROR-IS-NOTE              VALUE 'N'.                ELCERRS
  3823         88  ERROR-IS-WARNING           VALUE 'W'.                ELCERRS
  3824         88  ERROR-IS-FORCABLE          VALUE 'F'.                ELCERRS
  3825         88  ERROR-IS-FATAL             VALUE 'X'.                ELCERRS
  3826                                                                  ELCERRS
  3827******************************************************************ELCERRS
  3828
  3829 FD  ERPNDM.
* 3830                                 COPY ERCPNDM.
  3831******************************************************************
  3832*                                                                *
  3833*                                                                *
  3834*                            ERCPNDM                             *
  3835*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3836*                            VMOD=2.003                          *
  3837*                                                                *
  3838*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  3839*                                                                *
  3840*   FILE TYPE = VSAM,KSDS                                        *
  3841*   RECORD SIZE = 374   RECFORM = FIX                            *
  3842*                                                                *
  3843*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  3844*   ALTERNATE PATH    = NOT USED                                 *
  3845*                                                                *
  3846*   LOG = YES                                                    *
  3847*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3848******************************************************************
  3849*                   C H A N G E   L O G
  3850*
  3851* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3852*-----------------------------------------------------------------
  3853*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3854* EFFECTIVE    NUMBER
  3855*-----------------------------------------------------------------
  3856* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3857* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  3858* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3859******************************************************************
  3860
  3861 01  PENDING-MAILING-DATA.
  3862     12  PM-RECORD-ID                      PIC XX.
  3863         88  VALID-MA-ID                       VALUE 'PM'.
  3864
  3865     12  PM-CONTROL-PRIMARY.
  3866         16  PM-COMPANY-CD                 PIC X.
  3867         16  PM-ENTRY-BATCH                PIC X(6).
  3868         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  3869         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  3870
  3871     12  FILLER                            PIC X(14).
  3872
  3873     12  PM-ACCESS-CONTROL.
  3874         16  PM-SOURCE-SYSTEM              PIC XX.
  3875             88  PM-FROM-CREDIT                VALUE 'CR'.
  3876             88  PM-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  71
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3877             88  PM-FROM-WARRANTY              VALUE 'WA'.
  3878             88  PM-FROM-OTHER                 VALUE 'OT'.
  3879         16  PM-RECORD-ADD-DT              PIC XX.
  3880         16  PM-RECORD-ADDED-BY            PIC XXXX.
  3881         16  PM-LAST-MAINT-DT              PIC XX.
  3882         16  PM-LAST-MAINT-BY              PIC XXXX.
  3883         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3884
  3885     12  PM-PROFILE-INFO.
  3886         16  PM-QUALIFY-CODE-1             PIC XX.
  3887         16  PM-QUALIFY-CODE-2             PIC XX.
  3888         16  PM-QUALIFY-CODE-3             PIC XX.
  3889         16  PM-QUALIFY-CODE-4             PIC XX.
  3890         16  PM-QUALIFY-CODE-5             PIC XX.
  3891
  3892         16  PM-INSURED-LAST-NAME          PIC X(15).
  3893         16  PM-INSURED-FIRST-NAME         PIC X(10).
  3894         16  PM-INSURED-MIDDLE-INIT        PIC X.
  3895         16  PM-INSURED-ISSUE-AGE          PIC 99.
  3896         16  PM-INSURED-BIRTH-DT           PIC XX.
  3897         16  PM-INSURED-SEX                PIC X.
  3898             88  PM-SEX-MALE                   VALUE 'M'.
  3899             88  PM-SEX-FEMALE                 VALUE 'F'.
  3900         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  3901
  3902         16  PM-ADDRESS-CORRECTED          PIC X.
  3903         16  PM-JOINT-BIRTH-DT             PIC XX.
  3904*        16  FILLER                        PIC X(12).
  3905
  3906         16  PM-ADDRESS-LINE-1             PIC X(30).
  3907         16  PM-ADDRESS-LINE-2             PIC X(30).
  3908         16  PM-CITY-STATE.
  3909             20  PM-CITY                   PIC X(28).
  3910             20  PM-STATE                  PIC XX.
  3911         16  PM-ZIP.
  3912             20  PM-ZIP-CODE.
  3913                 24  PM-ZIP-1              PIC X.
  3914                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3915                 24  FILLER                PIC X(4).
  3916             20  PM-ZIP-PLUS4              PIC X(4).
  3917         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  3918             20  PM-CAN-POST1              PIC XXX.
  3919             20  PM-CAN-POST2              PIC XXX.
  3920             20  FILLER                    PIC XXX.
  3921
  3922         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  3923
  3924         16  FILLER                        PIC X(03).
  3925
  3926     12  PM-CRED-BENE-INFO.
  3927         16  PM-CRED-BENE-NAME             PIC X(25).
  3928         16  PM-CRED-BENE-ADDR             PIC X(30).
  3929         16  PM-CRED-BENE-ADDR2            PIC X(30).
  3930         16  PM-CRED-BENE-CTYST.
  3931             20  PM-CRED-BENE-CITY         PIC X(28).
  3932             20  PM-CRED-BENE-STATE        PIC XX.
  3933         16  PM-CRED-BENE-ZIP.
  3934             20  PM-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  72
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3935                 24  PM-CB-ZIP-1           PIC X.
  3936                     88  PM-CB-CANADIAN-POST-CODE
  3937                                  VALUE 'A' THRU 'Z'.
  3938                 24  FILLER                PIC X(4).
  3939             20  PM-CB-ZIP-PLUS4           PIC X(4).
  3940         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  3941             20  PM-CB-CAN-POST1           PIC XXX.
  3942             20  PM-CB-CAN-POST2           PIC XXX.
  3943             20  FILLER                    PIC XXX.
  3944     12  PM-POST-CARD-MAIL-DATA.
  3945         16  PM-MAIL-DATA OCCURS 7.
  3946             20  PM-MAIL-TYPE              PIC X.
  3947                 88  PM-12MO-MAILING           VALUE '1'.
  3948                 88  PM-EXP-MAILING            VALUE '2'.
  3949             20  PM-MAIL-STATUS            PIC X.
  3950                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  3951                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  3952                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  3953             20  PM-MAIL-DATE              PIC XX.
  3954     12  FILLER                            PIC XX.
  3955     12  FILLER                            PIC X(12).
  3956*    12  FILLER                            PIC X(30).
  3957
  3958******************************************************************
  3959
  3960 FD  ERMAIL.
* 3961                                 COPY ERCMAIL.
  3962******************************************************************
  3963*                                                                *
  3964*                                                                *
  3965*                            ERCMAIL                             *
  3966*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3967*                            VMOD=2.003                          *
  3968*                                                                *
  3969*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3970*                                                                *
  3971*   FILE TYPE = VSAM,KSDS                                        *
  3972*   RECORD SIZE = 374   RECFORM = FIX                            *
  3973*                                                                *
  3974*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3975*   ALTERNATE PATH    = NOT USED                                 *
  3976*                                                                *
  3977*   LOG = YES                                                    *
  3978*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3979******************************************************************
  3980*                   C H A N G E   L O G
  3981*
  3982* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3983*-----------------------------------------------------------------
  3984*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3985* EFFECTIVE    NUMBER
  3986*-----------------------------------------------------------------
  3987* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3988* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3989* 111108                   PEMA  ADD CRED BENE ADDR2
  3990******************************************************************
  3991
  3992 01  MAILING-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  73
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  3993     12  MA-RECORD-ID                      PIC XX.
  3994         88  VALID-MA-ID                       VALUE 'MA'.
  3995
  3996     12  MA-CONTROL-PRIMARY.
  3997         16  MA-COMPANY-CD                 PIC X.
  3998         16  MA-CARRIER                    PIC X.
  3999         16  MA-GROUPING.
  4000             20  MA-GROUPING-PREFIX        PIC XXX.
  4001             20  MA-GROUPING-PRIME         PIC XXX.
  4002         16  MA-STATE                      PIC XX.
  4003         16  MA-ACCOUNT.
  4004             20  MA-ACCOUNT-PREFIX         PIC X(4).
  4005             20  MA-ACCOUNT-PRIME          PIC X(6).
  4006         16  MA-CERT-EFF-DT                PIC XX.
  4007         16  MA-CERT-NO.
  4008             20  MA-CERT-PRIME             PIC X(10).
  4009             20  MA-CERT-SFX               PIC X.
  4010
  4011     12  FILLER                            PIC XX.
  4012
  4013     12  MA-ACCESS-CONTROL.
  4014         16  MA-SOURCE-SYSTEM              PIC XX.
  4015             88  MA-FROM-CREDIT                VALUE 'CR'.
  4016             88  MA-FROM-VSI                   VALUE 'VS'.
  4017             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4018             88  MA-FROM-OTHER                 VALUE 'OT'.
  4019         16  MA-RECORD-ADD-DT              PIC XX.
  4020         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4021         16  MA-LAST-MAINT-DT              PIC XX.
  4022         16  MA-LAST-MAINT-BY              PIC XXXX.
  4023         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4024
  4025     12  MA-PROFILE-INFO.
  4026         16  MA-QUALIFY-CODE-1             PIC XX.
  4027         16  MA-QUALIFY-CODE-2             PIC XX.
  4028         16  MA-QUALIFY-CODE-3             PIC XX.
  4029         16  MA-QUALIFY-CODE-4             PIC XX.
  4030         16  MA-QUALIFY-CODE-5             PIC XX.
  4031
  4032         16  MA-INSURED-LAST-NAME          PIC X(15).
  4033         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4034         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4035         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4036         16  MA-INSURED-BIRTH-DT           PIC XX.
  4037         16  MA-INSURED-SEX                PIC X.
  4038             88  MA-SEX-MALE                   VALUE 'M'.
  4039             88  MA-SEX-FEMALE                 VALUE 'F'.
  4040         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4041
  4042         16  MA-ADDRESS-CORRECTED          PIC X.
  4043         16  MA-JOINT-BIRTH-DT             PIC XX.
  4044*        16  FILLER                        PIC X(12).
  4045
  4046         16  MA-ADDRESS-LINE-1             PIC X(30).
  4047         16  MA-ADDRESS-LINE-2             PIC X(30).
  4048         16  MA-CITY-STATE.
  4049             20  MA-CITY                   PIC X(28).
  4050             20  MA-ADDR-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  74
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  4051         16  MA-ZIP.
  4052             20  MA-ZIP-CODE.
  4053                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4054                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4055                 24  FILLER                PIC X(4).
  4056             20  MA-ZIP-PLUS4              PIC X(4).
  4057         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4058             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4059             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4060             20  FILLER                    PIC X(3).
  4061
  4062         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4063
  4064         16  FILLER                        PIC XXX.
  4065*        16  FILLER                        PIC X(10).
  4066
  4067
  4068     12  MA-CRED-BENE-INFO.
  4069         16  MA-CRED-BENE-NAME                 PIC X(25).
  4070         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4071         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4072         16  MA-CRED-BENE-CTYST.
  4073             20  MA-CRED-BENE-CITY             PIC X(28).
  4074             20  MA-CRED-BENE-STATE            PIC XX.
  4075         16  MA-CRED-BENE-ZIP.
  4076             20  MA-CB-ZIP-CODE.
  4077                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  4078                     88  MA-CB-CANADIAN-POST-CODE
  4079                                           VALUE 'A' THRU 'Z'.
  4080                 24  FILLER                    PIC X(4).
  4081             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4082         16  MA-CB-CANADIAN-POSTAL-CODE
  4083                            REDEFINES MA-CRED-BENE-ZIP.
  4084             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4085             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4086             20  FILLER                        PIC X(3).
  4087     12  MA-POST-CARD-MAIL-DATA.
  4088         16  MA-MAIL-DATA OCCURS 7.
  4089             20  MA-MAIL-TYPE              PIC X.
  4090                 88  MA-12MO-MAILING           VALUE '1'.
  4091                 88  MA-EXP-MAILING            VALUE '2'.
  4092             20  MA-MAIL-STATUS            PIC X.
  4093                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4094                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4095                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4096             20  MA-MAIL-DATE              PIC XX.
  4097     12  FILLER                            PIC XX.
  4098     12  FILLER                            PIC XX.
  4099*    12  FILLER                            PIC X(30).
  4100******************************************************************
  4101
  4102 FD  ERPLAN.
* 4103                                 COPY ERCPLAN.
  4104******************************************************************04/29/98
  4105*                                                                *ERCPLAN
  4106*                                                                *ERCPLAN
  4107*                            ERCPLAN                             *   LV003
  4108*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  75
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4109*                            VMOD=2.003                          *   CL**2
  4110*                                                                *ERCPLAN
  4111*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
  4112*                                                                *ERCPLAN
  4113*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
  4114*   PLAN MASTER                                                  *ERCPLAN
  4115*                                                                *ERCPLAN
  4116*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
  4117*                                                                *ERCPLAN
  4118*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
  4119*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
  4120*                                                                *ERCPLAN
  4121*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
  4122*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
  4123*                                                                *ERCPLAN
  4124*   LOG = NO                                                     *ERCPLAN
  4125*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
  4126*                                                                *ERCPLAN
  4127*                                                                *ERCPLAN
  4128******************************************************************ERCPLAN
  4129                                                                  ERCPLAN
  4130 01  PLAN-MASTER.                                                 ERCPLAN
  4131     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
  4132         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
  4133                                                                  ERCPLAN
  4134     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
  4135         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
  4136         16  PL-MSTR-CNTRL.                                       ERCPLAN
  4137             20  PL-CONTROL-A.                                    ERCPLAN
  4138                 24  PL-CARRIER            PIC X.                 ERCPLAN
  4139                 24  PL-GROUPING           PIC X(6).              ERCPLAN
  4140                 24  PL-STATE              PIC XX.                ERCPLAN
  4141                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
  4142             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
  4143             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
  4144             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
  4145                                                                  ERCPLAN
  4146     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
  4147         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
  4148         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
  4149         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
  4150         16  PL-VG-STATE                   PIC XX.                ERCPLAN
  4151         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
  4152         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
  4153         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
  4154         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
  4155                                                                  ERCPLAN
  4156     12  PL-MAINT-INFORMATION.                                    ERCPLAN
  4157         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
  4158         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
  4159         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
  4160         16  FILLER                        PIC XX.                ERCPLAN
  4161                                                                  ERCPLAN
  4162     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
  4163         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
  4164         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
  4165             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
  4166             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  76
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4167             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
  4168             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
  4169                                                                  ERCPLAN
  4170     12  FILLER                            PIC X(30).             ERCPLAN
  4171                                                                  ERCPLAN
  4172     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
  4173         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
  4174         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
  4175         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
  4176     12  FILLER                            PIC X(24).             ERCPLAN
  4177     12  PL-TOLERANCES.                                           ERCPLAN
  4178         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
  4179         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
  4180         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
  4181         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
  4182         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4183         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4184     12  PL-OVER-SHORT.                                           ERCPLAN
  4185         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
  4186         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
  4187     12  FILLER                            PIC X(24).             ERCPLAN
  4188     12  PLAN-MISC.                                               ERCPLAN
  4189         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
  4190         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4191         16  PL-IG                         PIC X.                 ERCPLAN
  4192         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
  4193         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
  4194         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
  4195         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
  4196         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
  4197         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
  4198         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
  4199         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4200                                                                  ERCPLAN
  4201         16  FILLER                        PIC X(99).             ERCPLAN
  4202******************************************************************ERCPLAN
  4203 FD  ERFORM.
* 4204                                 COPY ERCFORM.
  4205******************************************************************04/29/98
  4206*                                                                *ERCFORM
  4207*                                                                *ERCFORM
  4208*                            ERCFORM.                            *   LV002
  4209*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4210*                            VMOD=2.003                          *   CL**2
  4211*                                                                *ERCFORM
  4212*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *ERCFORM
  4213*                                                                *ERCFORM
  4214*    FILE TYPE = VSAM,KSDS                                       *ERCFORM
  4215*    RECORD SIZE = 500  RECFORM = FIXED                          *ERCFORM
  4216*                                                                *ERCFORM
  4217*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *ERCFORM
  4218*                                                                *ERCFORM
  4219*    LOG = YES                                                   *ERCFORM
  4220*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCFORM
  4221******************************************************************ERCFORM
  4222 01  FORM-MASTER.                                                 ERCFORM
  4223    12  FO-RECORD-ID                 PIC X(02).                   ERCFORM
  4224        88  VALID-FO-ID                  VALUE 'FO'.              ERCFORM
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  77
* EL517.cbl (/apps/prod/cid1p/copy/ERCFORM)
  4225                                                                  ERCFORM
  4226    12  FO-CONTROL-PRIMARY.                                       ERCFORM
  4227        16  FO-COMPANY-CD            PIC X(01).                   ERCFORM
  4228        16  FO-STATE                 PIC X(02).                   ERCFORM
  4229        16  FO-FORM-ID               PIC X(12).                   ERCFORM
  4230        16  FO-FORM-EXP-DT           PIC X(02).                   ERCFORM
  4231                                                                  ERCFORM
  4232    12  FO-POLICY-FORM-DATA.                                      ERCFORM
  4233        16  FO-IND-GRP-CD            PIC X(01).                   ERCFORM
  4234        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.      ERCFORM
  4235        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4236        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4237        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4238        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4239        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4240        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4241        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.      ERCFORM
  4242        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.      ERCFORM
  4243        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).                   ERCFORM
  4244        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4245        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4246        16  FO-DIS-DEF-TYPE          PIC 9(02).                   ERCFORM
  4247        16  FO-DISMEMBERMENT-CD      PIC X(01).                   ERCFORM
  4248        16  FO-APP-CERT-USE-CD       PIC X(01).                   ERCFORM
  4249                                                                  ERCFORM
  4250    12  FILLER                       PIC X(29).                   ERCFORM
  4251                                                                  ERCFORM
  4252    12  FO-FORM-PLAN-TABLE.                                       ERCFORM
  4253        16  FO-FORM-PLANS     OCCURS 40 TIMES.                    ERCFORM
  4254            20  FO-PLAN-TYPE         PIC X(01).                   ERCFORM
  4255            20  FO-PLAN-ID           PIC X(02).                   ERCFORM
  4256            20  FO-PLAN-TERM         PIC 9(03).                   ERCFORM
  4257            20  FO-PLAN-REFUND-METHOD                             ERCFORM
  4258                                     PIC X.                       ERCFORM
  4259                                                                  ERCFORM
  4260    12  FILLER                       PIC X(30).                   ERCFORM
  4261                                                                  ERCFORM
  4262    12  FO-COMMENTS-AREA.                                         ERCFORM
  4263        16  FO-COMMENT-LINE-1        PIC X(78).                   ERCFORM
  4264                                                                  ERCFORM
  4265    12  FILLER                       PIC X(20).                   ERCFORM
  4266                                                                  ERCFORM
  4267    12  FO-MAINT-INFORMATION.                                     ERCFORM
  4268        16  FO-LAST-MAINT-DT         PIC X(02).                   ERCFORM
  4269        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.      ERCFORM
  4270        16  FO-LAST-MAINT-BY         PIC X(04).                   ERCFORM
  4271
  4272 FD  PRINT-FILE
* 4273                                 COPY ELCPRTFD.
  4274******************************************************************04/15/98
  4275*                                                                *ELCPRTFD
  4276*                                                                *ELCPRTFD
  4277*                            ELCPRTFD.                           *   LV003
  4278*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4279*                            VMOD=2.006                          *ELCPRTFD
  4280******************************************************************ELCPRTFD
  4281     RECORDING MODE F                                             ELCPRTFD
  4282     LABEL RECORDS OMITTED                                        ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  78
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
  4283     BLOCK CONTAINS 0 RECORDS
  4284     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  4285 01  PRT.                                                         ELCPRTFD
  4286     12  P-CTL               PIC  X.                                 CL**2
  4287     12  P-DATA              PIC  X(132).                         ELCPRTFD
  4288******************************************************************ELCPRTFD
  4289 FD  FICH
* 4290                                 COPY ELCFCHFD.
  4291******************************************************************04/15/98
  4292*                                                                *ELCFCHFD
  4293*                            ELCFCHFD.                           *   LV003
  4294*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4295*                            VMOD=2.004                          *   CL**3
  4296*                                                                *ELCFCHFD
  4297******************************************************************ELCFCHFD
  4298     BLOCK CONTAINS 0 RECORDS
  4299     RECORDING MODE F.                                            ELCFCHFD
  4300                                                                  ELCFCHFD
  4301 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  4302******************************************************************ELCFCHFD
  4303
  4304 FD  ELREPT.
* 4305                                 COPY ELCREPT.
  4306******************************************************************04/15/98
  4307*                                                                *ELCREPT
  4308*                                                                *ELCREPT
  4309*                            ELCREPT.                            *   LV002
  4310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4311*                            VMOD=2.002                          *   CL**2
  4312*                                                                *ELCREPT
  4313*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  4314*                                                                *ELCREPT
  4315*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  4316*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  4317*                                                                *ELCREPT
  4318*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  4319*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  4320*                                                                *ELCREPT
  4321*   LOG = NO                                                     *ELCREPT
  4322*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  4323******************************************************************ELCREPT
  4324 01  REPORT-SAVE-FILE.                                            ELCREPT
  4325     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  4326         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  4327                                                                  ELCREPT
  4328     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  4329         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  4330         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  4331             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  4332             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  4333         16  RF-REPORT-ID.                                        ELCREPT
  4334             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  4335                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  4336                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  4337             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  4338         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  4339     12  RF-REPORT-LINE-133.                                      ELCREPT
  4340         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  79
* EL517.cbl (/apps/prod/cid1p/copy/ELCREPT)
  4341         16  RF-DATA-133             PIC X(132).                  ELCREPT
  4342         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  4343             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  4344             20  FILLER              PIC X(52).                   ELCREPT
  4345         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  4346             20  FILLER              PIC X(53).                   ELCREPT
  4347             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  4348     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  4349         16  FILLER                  PIC X.                       ELCREPT
  4350         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
  4351         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  4352         16  FILLER                  PIC X(115).                  ELCREPT
  4353         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  4354******************************************************************ELCREPT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  80
* EL517.cbl
  4356
  4357 FD  ERRESS.
* 4358                                 COPY ERCRESS.
  4359******************************************************************04/29/98
  4360*                                                                *ERCRESS
  4361*                            ERCRESS                             *   LV002
  4362*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4363*                            VMOD=2.002                          *   CL**2
  4364*                                                                *ERCRESS
  4365*   CREDIT RESIDENT STATE TAXES MASTER                          * ERCRESS
  4366*                                                                *ERCRESS
  4367*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *ERCRESS
  4368*   VSAM RESIDENT STATE TAX MASTER                              * ERCRESS
  4369*                                                                *ERCRESS
  4370*   FILE DESCRIPTION = ER.TEST.ERRESS                           * ERCRESS
  4371*                                                                *ERCRESS
  4372*   FILE TYPE = VSAM,KSDS                                        *ERCRESS
  4373*   RECORD SIZE = 0047 RECFORM = FIXED                           *ERCRESS
  4374*                                                                *ERCRESS
  4375*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *ERCRESS
  4376*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *ERCRESS
  4377*                                                                *ERCRESS
  4378*   LOG = NO                                                     *ERCRESS
  4379*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESS
  4380*                                                                *ERCRESS
  4381*                                                                *ERCRESS
  4382******************************************************************ERCRESS
  4383                                                                  ERCRESS
  4384 01  RESIDENT-STATE-TAX-MASTER.                                   ERCRESS
  4385                                                                  ERCRESS
  4386     10  ERRESS-PRIMARY-KEY.                                      ERCRESS
  4387         15  RES-COMPANY-CD        PIC X.                         ERCRESS
  4388         15  RES-RESIDENT-STATE    PIC XX.                        ERCRESS
  4389         15  RES-COVERAGE-CATEGORY PIC X.                         ERCRESS
  4390         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.               ERCRESS
  4391*                                      YYYYMMDD                   ERCRESS
  4392*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C                   ERCRESS
  4393                                                                  ERCRESS
  4394     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.                      ERCRESS
  4395                                                                  ERCRESS
  4396         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4397         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4398         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4399         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4400                                                                  ERCRESS
  4401     10 RES-RECALC-SW              PIC   X.                       ERCRESS
  4402         88 RECALC                VALUE 'Y'.                      ERCRESS
  4403         88 NO-RECALC             VALUE 'N'.                      ERCRESS
  4404     10  RES-MAINT-BY              PIC X(4).                      ERCRESS
  4405     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.            ERCRESS
  4406     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.            ERCRESS
  4407*                                      YYYYMMDD                   ERCRESS
  4408
  4409 FD  ERRESC.
* 4410                                 COPY ERCRESC.
  4411******************************************************************04/29/98
  4412*                                                                *ERCRESC
  4413*                            ERCRESC                             *   LV002
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  81
* EL517.cbl (/apps/prod/cid1p/copy/ERCRESC)
  4414*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4415*                            VMOD=2.003                          *   CL**2
  4416*                                                                *ERCRESC
  4417*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  4418*                                                                *ERCRESC
  4419*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  4420*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  4421*                                                                *ERCRESC
  4422*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  4423*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  4424*                                                                *ERCRESC
  4425*   LOG = NO                                                     *ERCRESC
  4426*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  4427*                                                                *ERCRESC
  4428******************************************************************ERCRESC
  4429                                                                  ERCRESC
  4430 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  4431                                                                  ERCRESC
  4432     10  ERRESC-RECORD-KEY.                                       ERCRESC
  4433         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  4434         15  RESC-CARRIER              PIC   X.                   ERCRESC
  4435         15  RESC-GROUP                PIC   X(6).                ERCRESC
  4436         15  RESC-STATE                PIC   XX.                  ERCRESC
  4437         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  4438         15  RESC-AGENT                PIC   X(10).               ERCRESC
  4439         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  4440         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  4441*                                           YYYYMMDD              ERCRESC
  4442     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  4443                                                                  ERCRESC
  4444     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  4445         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  4446             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  4447             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  4448             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  4449                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  4450                                                                  ERCRESC
  4451     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  4452     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  4453     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  4454*                                          YYYYMMDD               ERCRESC
  4455
  4456 FD  ERCOMP.
* 4457                                 COPY ERCCOMP.
  4458******************************************************************
  4459*                                                                *
  4460*                                                                *
  4461*                            ERCCOMP                             *
  4462*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4463*                            VMOD=2.019                          *
  4464*                                                                *
  4465*   ONLINE CREDIT SYSTEM                                         *
  4466*                                                                *
  4467*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4468*                                                                *
  4469*   FILE TYPE = VSAM,KSDS                                        *
  4470*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4471*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  82
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4472*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4473*       ALTERNATE PATH = NONE                                    *
  4474*                                                                *
  4475*   LOG = NO                                                     *
  4476*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4477*                                                                *
  4478******************************************************************
  4479*                   C H A N G E   L O G
  4480*
  4481* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4482*-----------------------------------------------------------------
  4483*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4484* EFFECTIVE    NUMBER
  4485*-----------------------------------------------------------------
  4486* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4487* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4488* 092205    2005050300006  PEMA  ADD LEASE FEE
  4489* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4490* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4491* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4492* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4493* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4494* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4495******************************************************************
  4496
  4497 01  COMPENSATION-MASTER.
  4498     12  CO-RECORD-ID                          PIC XX.
  4499         88  VALID-CO-ID                          VALUE 'CO'.
  4500
  4501     12  CO-CONTROL-PRIMARY.
  4502         16  CO-COMPANY-CD                     PIC X.
  4503         16  CO-CONTROL.
  4504             20  CO-CTL-1.
  4505                 24  CO-CARR-GROUP.
  4506                     28  CO-CARRIER            PIC X.
  4507                     28  CO-GROUPING.
  4508                         32  CO-GROUP-PREFIX   PIC XXX.
  4509                         32  CO-GROUP-PRIME    PIC XXX.
  4510                 24  CO-RESP-NO.
  4511                     28  CO-RESP-PREFIX        PIC X(4).
  4512                     28  CO-RESP-PRIME         PIC X(6).
  4513             20  CO-CTL-2.
  4514                 24  CO-ACCOUNT.
  4515                     28  CO-ACCT-PREFIX        PIC X(4).
  4516                     28  CO-ACCT-PRIME         PIC X(6).
  4517         16  CO-TYPE                           PIC X.
  4518             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4519             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4520             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4521
  4522     12  CO-MAINT-INFORMATION.
  4523         16  CO-LAST-MAINT-DT                  PIC XX.
  4524         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4525         16  CO-LAST-MAINT-USER                PIC X(4).
  4526     12  FILLER                                PIC XX.
  4527     12  CO-STMT-TYPE                          PIC XXX.
  4528     12  CO-COMP-TYPE                          PIC X.
  4529         88  CO-COMP-IS-SPPDD                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  83
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4530     12  CO-STMT-OWNER                         PIC X(4).
  4531     12  CO-BALANCE-CONTROL                    PIC X.
  4532         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4533         88  CO-NO-BALANCE                        VALUE 'N'.
  4534
  4535     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4536         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4537         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4538         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4539
  4540     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4541         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4542         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4543
  4544     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4545     12  CO-GA-DIRECT-DEP                      PIC X.
  4546     12  CO-FUTURE-SPACE                       PIC X.
  4547         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4548
  4549     12  CO-ACCT-NAME                          PIC X(30).
  4550     12  CO-MAIL-NAME                          PIC X(30).
  4551     12  CO-ADDR-1                             PIC X(30).
  4552     12  CO-ADDR-2                             PIC X(30).
  4553     12  CO-ADDR-3.
  4554         16  CO-ADDR-CITY                      PIC X(27).
  4555         16  CO-ADDR-STATE                     PIC XX.
  4556     12  CO-CSO-1099                           PIC X.
  4557     12  CO-ZIP.
  4558         16  CO-ZIP-PRIME.
  4559             20  CO-ZIP-PRI-1ST                PIC X.
  4560                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4561             20  FILLER                        PIC X(4).
  4562         16  CO-ZIP-PLUS4                      PIC X(4).
  4563     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4564         16  CO-CAN-POSTAL-1                   PIC XXX.
  4565         16  CO-CAN-POSTAL-2                   PIC XXX.
  4566         16  FILLER                            PIC XXX.
  4567     12  CO-SOC-SEC                            PIC X(13).
  4568     12  CO-TELEPHONE.
  4569         16  CO-AREA-CODE                      PIC XXX.
  4570         16  CO-PREFIX                         PIC XXX.
  4571         16  CO-PHONE                          PIC X(4).
  4572
  4573     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4574
  4575     12  CO-AR-BAL-LEVEL                       PIC X.
  4576         88  CO-AR-REF-LVL                        VALUE '1'.
  4577         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4578         88  CO-AR-BILL-LVL                       VALUE '2'.
  4579         88  CO-AR-AGT-LVL                        VALUE '3'.
  4580         88  CO-AR-FR-LVL                         VALUE '4'.
  4581
  4582     12  CO-AR-NORMAL-PRINT                    PIC X.
  4583         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4584         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4585
  4586     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4587
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  84
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4588     12  CO-AR-REPORTING                       PIC X.
  4589         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4590         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4591
  4592     12  CO-AR-PULL-CHECK                      PIC X.
  4593         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4594         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4595
  4596     12  CO-AR-BALANCE-PRINT                   PIC X.
  4597         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4598
  4599     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4600         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4601         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4602         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4603
  4604     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4605
  4606     12  CO-USER-CODE                          PIC X.
  4607     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4608
  4609******************************************************************
  4610*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4611*    THE LAST MONTH END RUN.
  4612******************************************************************
  4613
  4614     12  CO-LAST-ACTIVITY-DATE.
  4615         16  CO-ACT-YEAR                       PIC 99.
  4616         16  CO-ACT-MONTH                      PIC 99.
  4617         16  CO-ACT-DAY                        PIC 99.
  4618
  4619     12  CO-LAST-STMT-DT.
  4620         16  CO-LAST-STMT-YEAR                 PIC 99.
  4621         16  CO-LAST-STMT-MONTH                PIC 99.
  4622         16  CO-LAST-STMT-DAY                  PIC 99.
  4623
  4624     12  CO-MO-END-TOTALS.
  4625         16  CO-MONTHLY-TOTALS.
  4626             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4627             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4628             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4629             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4630             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4631
  4632         16  CO-AGING-TOTALS.
  4633             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4634             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4635             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4636             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4637
  4638         16  CO-YTD-TOTALS.
  4639             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4640             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4641
  4642         16  CO-OVER-UNDER-TOTALS.
  4643             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4644             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4645
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  85
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4646     12  CO-MISCELLANEOUS-TOTALS.
  4647         16  CO-FICA-TOTALS.
  4648             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4649             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4650
  4651         16  CO-CLAIM-TOTALS.
  4652             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4653             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4654
  4655******************************************************************
  4656*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4657*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4658******************************************************************
  4659
  4660     12  CO-CURRENT-TOTALS.
  4661         16  CO-CURRENT-LAST-STMT-DT.
  4662             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4663             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4664             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4665
  4666         16  CO-CURRENT-MONTHLY-TOTALS.
  4667             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4668             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4669             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4670             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4671             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4672
  4673         16  CO-CURRENT-AGING-TOTALS.
  4674             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4675             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4676             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4677             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4678
  4679         16  CO-CURRENT-YTD-TOTALS.
  4680             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4681             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4682
  4683     12  CO-PAID-COMM-TOTALS.
  4684         16  CO-YTD-PAID-COMMS.
  4685             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4686             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4687
  4688     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4689         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4690         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4691
  4692     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4693         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4694         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4695         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4696         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4697         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4698         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4699         88  CO-FINAL-LETTER                  VALUE 'F'.
  4700         88  CO-RECONCILING                   VALUE 'R'.
  4701         88  CO-PHONE-CALL                    VALUE 'P'.
  4702         88  CO-LEGAL                         VALUE 'L'.
  4703         88  CO-COLLECTION-AGENCY             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  86
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4704         88  CO-WRITE-OFF                     VALUE 'W'.
  4705         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4706
  4707     12  CO-CSR-CODE                       PIC X(4).
  4708
  4709     12  CO-GA-STATUS-INFO.
  4710         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4711         16  CO-GA-TERMINATION-DT          PIC XX.
  4712         16  CO-GA-STATUS-CODE             PIC X.
  4713             88  CO-GA-ACTIVE                 VALUE 'A'.
  4714             88  CO-GA-INACTIVE               VALUE 'I'.
  4715             88  CO-GA-PENDING                VALUE 'P'.
  4716         16  CO-GA-COMMENTS.
  4717             20  CO-GA-COMMENT-1           PIC X(40).
  4718             20  CO-GA-COMMENT-2           PIC X(40).
  4719             20  CO-GA-COMMENT-3           PIC X(40).
  4720             20  CO-GA-COMMENT-4           PIC X(40).
  4721
  4722     12  CO-RPTCD2                         PIC X(10).
  4723     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4724         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4725         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4726
  4727     12  CO-TYPE-AGENT                     PIC X(01).
  4728         88  CO-CORPORATION                   VALUE 'C'.
  4729         88  CO-PARTNERSHIP                   VALUE 'P'.
  4730         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4731         88  CO-TRUST                         VALUE 'T'.
  4732         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4733
  4734     12  CO-FAXNO.
  4735         16  CO-FAX-AREA-CODE                  PIC XXX.
  4736         16  CO-FAX-PREFIX                     PIC XXX.
  4737         16  CO-FAX-PHONE                      PIC X(4).
  4738
  4739     12  CO-BANK-INFORMATION.
  4740         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4741         16  CO-BANK-TRANSIT-NON REDEFINES
  4742             CO-BANK-TRANSIT-NO                PIC 9(8).
  4743
  4744         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4745     12  CO-MISC-DEDUCT-INFO REDEFINES
  4746                  CO-BANK-INFORMATION.
  4747         16  CO-MD-GL-ACCT                     PIC X(10).
  4748         16  CO-MD-DIV                         PIC XX.
  4749         16  CO-MD-CENTER                      PIC X(4).
  4750         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4751         16  CO-CREATE-AP-CHECK                PIC X.
  4752         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4753         16  FILLER                            PIC XXX.
  4754     12  CO-ACH-STATUS                         PIC X.
  4755         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4756         88  CO-ACH-PENDING                        VALUE 'P'.
  4757
  4758     12  CO-BILL-SW                            PIC X.
  4759     12  CO-CONTROL-NAME                       PIC X(30).
  4760     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4761     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  87
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4762     12  CO-CLP-STATE                          PIC XX.
  4763     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4764     12  CO-SPP-REFUND-EDIT                    PIC X.
  4765
  4766******************************************************************
  4767
  4768 FD  ERLOFC.
* 4769                                 COPY ERCLOFC.
  4770******************************************************************12/04/92
  4771*                                                                *ERCLOFC
  4772*                                                                *ERCLOFC
  4773*                            ERCLOFC                             *   LV002
  4774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4775*                            VMOD=2.003                          *   CL**2
  4776*                                                                *ERCLOFC
  4777*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *ERCLOFC
  4778*                                                                *ERCLOFC
  4779*   FILE TYPE = VSAM,KSDS                                        *ERCLOFC
  4780*   RECORD SIZE = 670   RECFORM = FIX                            *ERCLOFC
  4781*                                                                *ERCLOFC
  4782*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *ERCLOFC
  4783*                                                                *ERCLOFC
  4784*   LOG = YES                                                    *ERCLOFC
  4785*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCLOFC
  4786*                                                                *ERCLOFC
  4787******************************************************************ERCLOFC
  4788                                                                  ERCLOFC
  4789 01  LOAN-OFFICER-MASTER.                                         ERCLOFC
  4790     12  LO-RECORD-ID                PIC XX.                      ERCLOFC
  4791         88  VALID-LO-ID                VALUE 'LO'.               ERCLOFC
  4792                                                                  ERCLOFC
  4793     12  LO-CONTROL-PRIMARY.                                      ERCLOFC
  4794         16  LO-COMPANY-CD           PIC X.                       ERCLOFC
  4795         16  LO-CARRIER              PIC X.                       ERCLOFC
  4796         16  LO-GROUPING.                                         ERCLOFC
  4797             20  LO-GROUPING-PREFIX  PIC XXX.                     ERCLOFC
  4798             20  LO-GROUPING-PRIME   PIC XXX.                     ERCLOFC
  4799         16  LO-STATE                PIC XX.                      ERCLOFC
  4800         16  LO-ACCOUNT.                                          ERCLOFC
  4801             20  LO-ACCOUNT-PREFIX   PIC X(4).                    ERCLOFC
  4802             20  LO-ACCOUNT-PRIME    PIC X(6).                    ERCLOFC
  4803         16  LO-OFFICER-CODE         PIC X(5).
  4804                                                                  ERCLOFC
  4805     12  LO-OFFICER-NAME             PIC X(30).                   ERCLOFC
  4806                                                                  ERCLOFC
  4807     12  LO-LAST-MAINT-DT            PIC XX.                      ERCLOFC
  4808     12  LO-LAST-USER                PIC X(4).                    ERCLOFC
  4809     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.            ERCLOFC
  4810                                                                  ERCLOFC
  4811     12  LO-COMP-CONTROL             PIC X.                       ERCLOFC
  4812             88  LO-SHOW-COMP           VALUE 'Y'.                ERCLOFC
  4813             88  LO-SUPPRESS-COMP       VALUE 'N'.                ERCLOFC
  4814     12  LO-DETAIL-CONTROL           PIC X.                       ERCLOFC
  4815             88  LO-PRINT-DETAIL        VALUE 'D'.                ERCLOFC
  4816             88  LO-PRINT-SUMMARY       VALUE 'S'.                ERCLOFC
  4817                                                                  ERCLOFC
  4818     12  LO-SV-CARRIER               PIC X.                       ERCLOFC
  4819     12  LO-SV-GROUPING              PIC X(6).                    ERCLOFC
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  88
* EL517.cbl (/apps/prod/cid1p/copy/ERCLOFC)
  4820     12  LO-SV-STATE                 PIC XX.                      ERCLOFC
  4821                                                                  ERCLOFC
  4822     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.               CL**2
  4823     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.            CL**2
  4824                                                                  ERCLOFC
  4825     12  LO-OFFICER-INFO.                                         ERCLOFC
  4826         16  FILLER OCCURS 12 TIMES.                              ERCLOFC
  4827             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.            ERCLOFC
  4828             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.            ERCLOFC
  4829             20  LO-LF-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4830             20  LO-LF-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4831             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4832             20  LO-AH-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4833             20  LO-AH-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4834             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4835     12  FILLER                      PIC X(198).
  4836******************************************************************ERCLOFC
  4837
  4838 FD  ERBXRF.
* 4839                                 COPY ERCBXRF.
  4840******************************************************************04/29/98
  4841*                                                                *ERCBXRF
  4842*                                                                *ERCBXRF
  4843*                            ERCBXRF                             *   LV002
  4844*                                                                *ERCBXRF
  4845*   ONLINE CREDIT SYSTEM                                         *ERCBXRF
  4846*                                                                *ERCBXRF
  4847*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *ERCBXRF
  4848*                                                                *ERCBXRF
  4849*   FILE TYPE = VSAM,KSDS                                        *ERCBXRF
  4850*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE                ERCBXRF
  4851*                                                                *ERCBXRF
  4852*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *ERCBXRF
  4853*       ALTERNATE PATH = NONE                                    *ERCBXRF
  4854*                                                                *ERCBXRF
  4855*   LOG = NO                                                     *ERCBXRF
  4856*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCBXRF
  4857*                                                                *ERCBXRF
  4858******************************************************************ERCBXRF
  4859                                                                  ERCBXRF
  4860 01  BANK-CROSS-REFERENCE.                                        ERCBXRF
  4861     12  BK-RECORD-ID                PIC XX.                      ERCBXRF
  4862         88  VALID-BK-ID             VALUE 'BK'.                  ERCBXRF
  4863                                                                  ERCBXRF
  4864     12  BK-CONTROL-PRIMARY.                                      ERCBXRF
  4865         16  BK-COMPANY-CD           PIC X.                       ERCBXRF
  4866         16  BK-CARRIER              PIC X.                       ERCBXRF
  4867         16  BK-GROUPING             PIC X(6).                    ERCBXRF
  4868         16  BK-BANK-NO              PIC X(10).                   ERCBXRF
  4869                                                                  ERCBXRF
  4870     12  BK-MAINT-INFORMATION.                                    ERCBXRF
  4871         16  BK-LAST-MAINT-DT        PIC XX.                      ERCBXRF
  4872         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.           ERCBXRF
  4873         16  BK-LAST-MAINT-USER      PIC X(4).                    ERCBXRF
  4874         16  FILLER                  PIC X(9).                    ERCBXRF
  4875                                                                  ERCBXRF
  4876     12  FILLER                      PIC X(37).                   ERCBXRF
  4877                                                                  ERCBXRF
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  89
* EL517.cbl (/apps/prod/cid1p/copy/ERCBXRF)
  4878     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.             ERCBXRF
  4879                                                                  ERCBXRF
  4880     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES                  ERCBXRF
  4881                            DEPENDING ON BK-BANK-POINTER-CNT.     ERCBXRF
  4882         16  BK-AM-ACCOUNT           PIC X(10).                   ERCBXRF
  4883         16  BK-AM-EXP-DT            PIC XX.                      ERCBXRF
  4884         16  BK-AM-EFF-DT            PIC XX.                      ERCBXRF
  4885         16  BK-AM-STATE             PIC XX.                      ERCBXRF
  4886         16  FILLER                  PIC X(20).                   ERCBXRF
  4887                                                                  ERCBXRF
  4888******************************************************************ERCBXRF
  4889
  4890 FD  ERAGTC.
* 4891                                 COPY ERCAGTC.
  4892******************************************************************
  4893*                                                                *
  4894*                                                                *
  4895*                            ERCAGTC                             *
  4896*                            VMOD=2.001                          *
  4897*                                                                *
  4898*   ONLINE CREDIT SYSTEM                                         *
  4899*                                                                *
  4900*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  4901*                                                                *
  4902*   FILE TYPE = VSAM,KSDS                                        *
  4903*   RECORD SIZE = 450   RECFORM = FIXED                          *
  4904*                                                                *
  4905*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  4906*       ALTERNATE PATH = NONE                                    *
  4907*                                                                *
  4908*   LOG = NO                                                     *
  4909*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4910*                                                                *
  4911******************************************************************
  4912*                   C H A N G E   L O G
  4913*
  4914* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4915*-----------------------------------------------------------------
  4916*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4917* EFFECTIVE    NUMBER
  4918*-----------------------------------------------------------------
  4919* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  4920* 111004                         NEW FILE AND COPYBOOK
  4921* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  4922******************************************************************
  4923
  4924 01  AGENT-COMMISSIONS.
  4925     12  AG-RECORD-ID                          PIC XX.
  4926         88  VALID-CO-ID                          VALUE 'AG'.
  4927
  4928     12  AG-CONTROL-PRIMARY.
  4929         16  AG-COMPANY-CD                     PIC X.
  4930         16  AG-CONTROL.
  4931             20  AG-CTL-1.
  4932                 24  AG-CARR-GROUP.
  4933                     28  AG-CARRIER            PIC X.
  4934                     28  AG-GROUPING           PIC X(6).
  4935                 24  AG-BANK                   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  90
* EL517.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  4936             20  AG-CTL-2.
  4937                 24  AG-EXP-DT                 PIC XX.
  4938         16  AG-TYPE                           PIC X.
  4939             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  4940             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  4941
  4942     12  AG-MAINT-INFORMATION.
  4943         16  AG-LAST-MAINT-DT                  PIC XX.
  4944         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4945         16  AG-LAST-MAINT-USER                PIC X(4).
  4946         16  FILLER                            PIC X(10).
  4947
  4948     12  AG-EFF-DT                             PIC XX.
  4949     12  AG-COMM-STRUCTURE.
  4950         16  AG-AGT-COMMS OCCURS 10.
  4951             20  AG-AGT                PIC X(10).
  4952             20  AG-COM-TYP            PIC X.
  4953             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  4954             20  AG-RECALC-LV-INDIC    PIC X.
  4955             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  4956             20  AG-LRCALC-LV-INDIC    PIC X.
  4957             20  FILLER                PIC X(05).
  4958
  4959     12  FILLER                  PIC X(145).
  4960******************************************************************
  4961
  4962 FD  ELCRTT.
* 4963                                 COPY ELCCRTT.
  4964******************************************************************
  4965*                                                                *ELCCRTT
  4966*                            ELCCRTT.                            *
  4967*                                                                *ELCCRTT
  4968*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  4969*                                                                *ELCCRTT
  4970*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  4971*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  4972*                                                                *ELCCRTT
  4973*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  4974*                                                                *ELCCRTT
  4975*   LOG = YES                                                    *ELCCRTT
  4976*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  4977******************************************************************
  4978*                   C H A N G E   L O G
  4979*
  4980* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4981*-----------------------------------------------------------------
  4982*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4983* EFFECTIVE    NUMBER
  4984*-----------------------------------------------------------------
  4985* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4986* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  4987* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  4988* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4989* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4990******************************************************************
  4991                                                                  ELCCRTT
  4992 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  4993     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  91
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  4994         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  4995                                                                  ELCCRTT
  4996     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  4997         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  4998         16  CS-CARRIER                    PIC X.                 ELCCRTT
  4999         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  5000         16  CS-STATE                      PIC XX.                ELCCRTT
  5001         16  CS-ACCOUNT                    PIC X(10).
  5002         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  5003         16  CS-CERT-NO.                                          ELCCRTT
  5004             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  5005             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  5006         16  CS-TRAILER-TYPE               PIC X.
  5007             88  COMM-TRLR           VALUE 'A'.
  5008             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5009             88  CERT-DATA-TRLR      VALUE 'C'.
  5010                                                                  ELCCRTT
  5011     12  CS-DATA-AREA                      PIC X(516).
  5012
  5013     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5014         16  CS-BANK-COMMISSION-AREA.
  5015             20  CS-BANK-COMMS       OCCURS 10.
  5016                 24  CS-AGT                PIC X(10).
  5017                 24  CS-COM-TYP            PIC X.
  5018                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5019                 24  CS-RECALC-LV-INDIC    PIC X.
  5020                 24  FILLER                PIC X(10).
  5021
  5022         16  FILLER                        PIC X(256).
  5023
  5024     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5025****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5026****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5027         16  CS-MB-CLAIM-DATA OCCURS 2.
  5028             20  FILLER OCCURS 10.
  5029                 24  CS-CLAIM-TYPE         PIC X.
  5030                     88  CS-AH-CLM           VALUE 'A'.
  5031                     88  CS-IU-CLM           VALUE 'I'.
  5032                     88  CS-GP-CLM           VALUE 'G'.
  5033                     88  CS-LF-CLM           VALUE 'L'.
  5034                     88  CS-PR-CLM           VALUE 'P'.
  5035                 24  CS-BANK               PIC S999 COMP-3.
  5036                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5037                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5038                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5039         16  FILLER                        PIC X(216).
  5040
  5041     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5042         16  CS-VIN-NUMBER                 PIC X(17).
  5043         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5044         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5045         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5046         16  FILLER                        PIC X(496).
  5047
  5048******************************************************************ELCCRTT
  5049
  5050 FD  ERPDEF.
  5051
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  92
* EL517.cbl
* 5052                                 COPY ERCPDEF.
  5053******************************************************************
  5054*                                                                *
  5055*                                                                *
  5056*                            ERCPDEF.                            *
  5057*                                                                *
  5058*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5059*                                                                *
  5060*    FILE TYPE = VSAM,KSDS                                       *
  5061*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5062*                                                                *
  5063*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5064*                                                                *
  5065*    LOG = YES                                                   *
  5066*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5067******************************************************************
  5068 01  PRODUCT-MASTER.
  5069    12  PD-RECORD-ID                 PIC X(02).
  5070        88  VALID-PD-ID                  VALUE 'PD'.
  5071
  5072    12  PD-CONTROL-PRIMARY.
  5073        16  PD-COMPANY-CD            PIC X.
  5074        16  PD-STATE                 PIC XX.
  5075        16  PD-PRODUCT-CD            PIC XXX.
  5076        16  PD-FILLER                PIC X(7).
  5077        16  PD-BEN-TYPE              PIC X.
  5078        16  PD-BEN-CODE              PIC XX.
  5079        16  PD-PROD-EXP-DT           PIC XX.
  5080
  5081    12  FILLER                       PIC X(50).
  5082
  5083    12  PD-PRODUCT-DATA OCCURS 8.
  5084        16  PD-PROD-CODE             PIC X.
  5085            88  PD-PROD-LIFE           VALUE 'L'.
  5086            88  PD-PROD-PROP           VALUE 'P'.
  5087            88  PD-PROD-AH             VALUE 'A'.
  5088            88  PD-PROD-IU             VALUE 'I'.
  5089            88  PD-PROD-GAP            VALUE 'G'.
  5090        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5091        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5092        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5093        16  PD-MAX-TERM              PIC S999        COMP-3.
  5094        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5095        16  FILLER                   PIC X.
  5096        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5097        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5098        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5099        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5100        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5101        16  PD-REC-CRIT-PERIOD       PIC X.
  5102        16  PD-RTW-MOS               PIC 99.
  5103        16  FILLER                   PIC X(5).
  5104
  5105    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5106
  5107    12  PD-TERM-LIMITS OCCURS 15.
  5108        16  PD-LOW-TERM              PIC S999        COMP-3.
  5109        16  PD-HI-TERM               PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  93
* EL517.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  5110
  5111*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5112    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5113        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5114        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5115
  5116    12  PD-EARN-FACTORS.
  5117        16  FILLER OCCURS 15.
  5118            20  FILLER OCCURS 15.
  5119                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5120
  5121    12  PD-PRODUCT-DESC              PIC X(80).
  5122    12  PD-TRUNCATED                 PIC X.
  5123    12  FILLER                       PIC X(59).
  5124
  5125    12  PD-MAINT-INFORMATION.
  5126        16  PD-LAST-MAINT-DT         PIC X(02).
  5127        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5128        16  PD-LAST-MAINT-BY         PIC X(04).
  5129
  5130 FD  ELSTAT.
  5131
* 5132                                 COPY ELCSTATE.
  5133******************************************************************
  5134*                                                                *
  5135*                                                                *
  5136*                            ELCSTATE.                           *
  5137*                                                                *
  5138*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  5139*                                                                *
  5140*   FILE TYPE = VSAM,KSDS                                        *
  5141*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5142*                                                                *
  5143*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  5144*       ALTERNATE INDEX = NONE                                   *
  5145*                                                                *
  5146*   LOG = YES                                                    *
  5147*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5148******************************************************************
  5149*                   C H A N G E   L O G
  5150*
  5151* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5152*-----------------------------------------------------------------
  5153*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5154* EFFECTIVE    NUMBER
  5155*-----------------------------------------------------------------
  5156* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  5157******************************************************************
  5158*
  5159 01  STATE-FILE.
  5160     12  SF-RECORD-ID                       PIC XX.
  5161         88  VALID-CF-ID                        VALUE 'SF'.
  5162
  5163     12  SF-CONTROL-PRIMARY.
  5164         16  SF-COMPANY-ID                  PIC XXX.
  5165         16  SF-CARRIER-CODE                PIC X.
  5166         16  SF-GROUPING                    PIC X(6).
  5167         16  SF-STATE-CODE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  94
* EL517.cbl (/apps/prod/cid1p/copy/ELCSTATE)
  5168         16  SF-EXPIRE-DATE                 PIC 9(8).
  5169
  5170****************************************************************
  5171*             STATE CONTROLS
  5172****************************************************************
  5173
  5174     12  SF-LAST-MAINT-DT                   PIC XX.
  5175     12  SF-LAST-MAINT-BY                   PIC X(4).
  5176     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5177
  5178     12  SF-STATE-RT-CONTROLS.
  5179         16  SF-ST-RT-CALC                  PIC X.
  5180
  5181     12  SF-ST-TAX-CONTROLS.
  5182         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5183         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5184         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5185
  5186     12  SF-ST-REFUND-OPTIONS.
  5187         16  SF-ST-RF-LR-CALC               PIC X.
  5188         16  SF-ST-RF-LL-CALC               PIC X.
  5189         16  SF-ST-RF-LN-CALC               PIC X.
  5190         16  SF-ST-RF-AH-CALC               PIC X.
  5191         16  SF-ST-RF-CP-CALC               PIC X.
  5192
  5193     12  SF-ST-UNEARN-PREM-OPTIONS.
  5194         16  SF-ST-LUEP-R78                 PIC X.
  5195         16  SF-ST-LUEP-PRO                 PIC X.
  5196         16  SF-ST-LUEP-ST                  PIC X.
  5197         16  SF-ST-LUEP-DOM                 PIC X.
  5198         16  SF-ST-AUEP-R78                 PIC X.
  5199         16  SF-ST-AUEP-PRO                 PIC X.
  5200         16  SF-ST-AUEP-ST                  PIC X.
  5201         16  SF-ST-AUEP-DOM                 PIC X.
  5202         16  SF-ST-CUEP-R78                 PIC X.
  5203         16  SF-ST-CUEP-PRO                 PIC X.
  5204         16  SF-ST-CUEP-ST                  PIC X.
  5205         16  SF-ST-CUEP-DOM                 PIC X.
  5206
  5207     12  SF-ST-EARN-PREM-OPTIONS.
  5208         16  SF-ST-LEP-R78                  PIC X.
  5209         16  SF-ST-LEP-PRO                  PIC X.
  5210         16  SF-ST-LEP-ST                   PIC X.
  5211         16  SF-ST-LEP-DOM                  PIC X.
  5212         16  SF-ST-AEP-R78                  PIC X.
  5213         16  SF-ST-AEP-PRO                  PIC X.
  5214         16  SF-ST-AEP-ST                   PIC X.
  5215         16  SF-ST-AEP-DOM                  PIC X.
  5216         16  SF-ST-CEP-R78                  PIC X.
  5217         16  SF-ST-CEP-PRO                  PIC X.
  5218         16  SF-ST-CEP-ST                   PIC X.
  5219         16  SF-ST-CEP-DOM                  PIC X.
  5220
  5221     12  SF-FOR-FUTURE-USE                  PIC X(179).
  5222
  5223 FD  ELCRTO.
  5224
* 5225                                 COPY ELCCRTO.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  95
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5226******************************************************************
  5227*                                                                *
  5228*                            ELCCRTO.                            *
  5229*                                                                *
  5230*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5231*                                                                *
  5232*   FILE TYPE = VSAM,KSDS                                        *
  5233*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5234*                                                                *
  5235*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5236*                                                                *
  5237*   LOG = YES                                                    *
  5238*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5239******************************************************************
  5240*                   C H A N G E   L O G
  5241*
  5242* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5243*-----------------------------------------------------------------
  5244*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5245* EFFECTIVE    NUMBER
  5246*-----------------------------------------------------------------
  5247* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5248* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5249* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5250* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5251* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5252******************************************************************
  5253
  5254 01  ORIGINAL-CERTIFICATE.
  5255     12  OC-RECORD-ID                      PIC XX.
  5256         88  VALID-OC-ID                      VALUE 'OC'.
  5257
  5258     12  OC-CONTROL-PRIMARY.
  5259         16  OC-COMPANY-CD                 PIC X.
  5260         16  OC-CARRIER                    PIC X.
  5261         16  OC-GROUPING                   PIC X(6).
  5262         16  OC-STATE                      PIC XX.
  5263         16  OC-ACCOUNT                    PIC X(10).
  5264         16  OC-CERT-EFF-DT                PIC XX.
  5265         16  OC-CERT-NO.
  5266             20  OC-CERT-PRIME             PIC X(10).
  5267             20  OC-CERT-SFX               PIC X.
  5268         16  OC-RECORD-TYPE                PIC X.
  5269         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5270
  5271     12  OC-LAST-MAINT-DT                  PIC XX.
  5272     12  OC-LAST-MAINT-BY                  PIC X(4).
  5273     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5274
  5275     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5276     12  FILLER                            PIC X(49).
  5277
  5278     12  OC-ORIG-REC.
  5279         16  OC-INS-LAST-NAME              PIC X(15).
  5280         16  OC-INS-FIRST-NAME             PIC X(10).
  5281         16  OC-INS-MIDDLE-INIT            PIC X.
  5282         16  OC-INS-AGE                    PIC S999     COMP-3.
  5283         16  OC-JNT-LAST-NAME              PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  96
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5284         16  OC-JNT-FIRST-NAME             PIC X(10).
  5285         16  OC-JNT-MIDDLE-INIT            PIC X.
  5286         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5287         16  OC-LF-BENCD                   PIC XX.
  5288         16  OC-LF-TERM                    PIC S999      COMP-3.
  5289         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5290         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5291         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5292         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5293         16  OC-LF-EXP-DT                  PIC XX.
  5294         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5295         16  OC-LF-CANCEL-DT               PIC XX.
  5296         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5297         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5298         16  OC-AH-BENCD                   PIC XX.
  5299         16  OC-AH-TERM                    PIC S999      COMP-3.
  5300         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5301         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5302         16  OC-AH-EXP-DT                  PIC XX.
  5303         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5304         16  OC-AH-CP                      PIC 99.
  5305         16  OC-AH-CANCEL-DT               PIC XX.
  5306         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5307         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5308         16  OC-CRED-BENE-NAME             PIC X(25).
  5309         16  OC-1ST-PMT-DT                 PIC XX.
  5310         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5311         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5312         16  OC-ISSUE-TRAN-IND             PIC X.
  5313         16  OC-CANCEL-TRAN-IND            PIC X.
  5314         16  FILLER                        PIC X(211).
  5315
  5316     12  FILLER                            PIC X(50).
  5317
  5318******************************************************************
  5319
  5320 WORKING-STORAGE SECTION.
  5321 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  5322 77  FILLER   PIC X(32) VALUE '********************************'.
  5323 77  FILLER   PIC X(32) VALUE '**   EL517 WORKING STORAGE    **'.
  5324 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.040 *********'.
  5325
  5326 77  ELCNTL-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5327 77  ERPLAN-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5328 77  ERACCT-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5329 77  ERFORM-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5330
  5331 77  WS-ZERO                PIC S9        COMP-3   VALUE ZERO.
  5332 77  WS-RETURN-CODE         PIC S9(4)     COMP     VALUE ZERO.
  5333 77  WS-ABEND-MESSAGE       PIC X(80)              VALUE SPACES.
  5334 77  WS-ABEND-FILE-STATUS   PIC XX                 VALUE ZERO.
  5335 77  PGM-SUB                PIC S9(4)     COMP     VALUE +517.
  5336 77  SUB-X                  PIC S9(4)     COMP     VALUE   +0.
  5337 77  X                      PIC X                  VALUE ' '.
  5338 77  OLC-REPORT-NAME        PIC X(6)               VALUE 'EL517 '.
  5339
  5340 01  TRAN-CT                PIC 9(5)               VALUE 0.
  5341 01  TRAN-CX REDEFINES TRAN-CT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  97
* EL517.cbl
  5342     12  FILLER             PIC XX.
  5343     12  TCX                PIC 999.
  5344 01  SEQ-NO                 PIC 9999               VALUE 0.
  5345 01  RPND                   PIC 9(5)               VALUE 0.
  5346 01  WPND                   PIC 9(5)               VALUE 0.
  5347 01  RREI                   PIC 9(5)               VALUE 0.
  5348 01  RCTB                   PIC 9(5)               VALUE 0.
  5349 01  RACC                   PIC 9(5)               VALUE 0.
  5350 01  RCER                   PIC 9(5)               VALUE 0.
  5351 01  RCNT                   PIC 9(5)               VALUE 0.
  5352 01  WCER                   PIC 9(5)               VALUE 0.
  5353 01  ERPNDM-OPEN            PIC X                  VALUE SPACES.
  5354 01  ERMAIL-OPEN            PIC X                  VALUE SPACES.
  5355 01  ELMSTR-OPEN            PIC X                  VALUE SPACES.
  5356 01  ELCRTT-OPEN            PIC X                  VALUE SPACES.
  5357 01  ELCRTO-OPEN            PIC X                  VALUE SPACES.
  5358 01  WS-AH-CLAIM-RESCINDED  PIC X                  VALUE 'N'.
  5359 01  EMSG.
  5360     12  WS-FILE-ERROR-MESSAGE.
  5361         16  FILLER              PIC X(24)   VALUE
  5362             'ERROR OCCURED OPENING - '.
  5363         16  WS-FEM-FILE-NAME    PIC X(8).
  5364
  5365 01  CMSG.
  5366     12  WS-FILE-ERROR-MESSAGE.
  5367         16  FILLER              PIC X(24)   VALUE
  5368             'ERROR OCCURED CLOSING - '.
  5369         16  WS-CEM-FILE-NAME    PIC X(8).
  5370
  5371 01  RMSG.
  5372     12  WS-FILE-ERROR-MESSAGE.
  5373         16  FILLER              PIC X(24)   VALUE
  5374             'ERROR OCCURED READING - '.
  5375         16  WS-REM-FILE-NAME    PIC X(8).
  5376
  5377 01  HDG1.
  5378     12  FILLER                  PIC X(50)       VALUE ' '.
  5379     12  FILLER                  PIC X(28)       VALUE
  5380                   'PENDING BUSINESS FILE EDIT '.
  5381     12  ER-ONLY                 PIC X(47)       VALUE
  5382          'NEW ITEMS AND FATAL ERRORS ONLY'.
  5383     12  FILLER                  PIC X(7)        VALUE 'EL517A'.
  5384
  5385 01  HDG2.
  5386     12  FILLER              PIC X(52)              VALUE SPACE.
  5387     12  H2-COMP             PIC X(30).
  5388     12  FILLER              PIC X(42)              VALUE SPACE.
  5389     12  H2-DATE             PIC X(8).
  5390
  5391 01  HDG3.
  5392     12  FILLER              PIC X(54)              VALUE SPACE.
  5393     12  H3-DATE             PIC X(18).
  5394     12  FILLER              PIC X(49)              VALUE SPACE.
  5395
  5396 01  SUM1.
  5397     12  FILLER              PIC XX                 VALUE ' '.
  5398     12  SUM-TOT             PIC ZZ,ZZZ.
  5399     12  FILLER              PIC X(3)               VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  98
* EL517.cbl
  5400     12  FILLER              PIC X(30)              VALUE
  5401          'ITEMS EDITED'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page  99
* EL517.cbl
  5403
  5404 01  WX-AREA.
  5405     12  PH-COBOL            PIC X.
  5406     12  HOLD-ELCNTL         PIC X(750) OCCURS 11 TIMES.
  5407
  5408 01  STATUS-SWITCH.
  5409     12  ELCNTL-FILE-STATUS       PIC XX VALUE SPACES.
  5410     12  ERPNDB-FILE-STATUS       PIC XX VALUE SPACES.
  5411     12  ERREIN-FILE-STATUS       PIC XX VALUE SPACES.
  5412     12  ELCERT-FILE-STATUS       PIC XX VALUE SPACES.
  5413     12  ELMSTR-FILE-STATUS       PIC XX VALUE SPACES.
  5414     12  ERMAIL-FILE-STATUS       PIC XX VALUE SPACES.
  5415     12  ERPLAN-FILE-STATUS       PIC XX VALUE SPACES.
  5416     12  ERFORM-FILE-STATUS       PIC XX VALUE SPACES.
  5417     12  ERPNDM-FILE-STATUS       PIC XX VALUE SPACES.
  5418     12  ERCTBL-FILE-STATUS       PIC XX VALUE SPACES.
  5419     12  ERACCT-FILE-STATUS.
  5420         16  ERACCT-FILE-STAT-1   PIC X  VALUE ' '.
  5421         16  ERACCT-FILE-STAT-2   PIC X  VALUE ' '.
  5422     12  ELCERR-FILE-STATUS       PIC XX VALUE SPACES.
  5423     12  ERRESS-FILE-STATUS       PIC XX VALUE SPACES.
  5424     12  ERRESC-FILE-STATUS       PIC XX VALUE SPACES.
  5425     12  ERCOMP-FILE-STATUS       PIC XX VALUE SPACES.
  5426     12  ERLOFC-FILE-STATUS       PIC XX VALUE SPACES.
  5427     12  ERBXRF-FILE-STATUS       PIC XX VALUE SPACES.
  5428     12  ERAGTC-FILE-STATUS       PIC XX VALUE SPACES.
  5429     12  ELCRTT-FILE-STATUS       PIC XX VALUE SPACES.
  5430     12  ERPDEF-FILE-STATUS       PIC XX VALUE SPACES.
  5431     12  ELSTAT-FILE-STATUS       PIC XX VALUE SPACES.
  5432     12  ELCRTO-FILE-STATUS       PIC XX VALUE SPACES.
  5433
  5434     12  EMI-WARNING-CTR          PIC S999  COMP-3  VALUE +0.
  5435     12  EMI-FORCABLE-CTR         PIC S999  COMP-3  VALUE +0.
  5436     12  EMI-FATAL-CTR            PIC S999  COMP-3  VALUE +0.
  5437     12  WS-SW-1                  PIC X  VALUE ' '.
  5438     12  WS-SW-2                  PIC X  VALUE ' '.
  5439
  5440     12  WS-COMPUTED-TOTALS      COMP-3.
  5441         16  WS-LF-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5442         16  WS-LF-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5443         16  WS-AH-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5444         16  WS-AH-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5445         16  WS-LF-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5446         16  WS-LF-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5447         16  WS-AH-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5448         16  WS-AH-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5449         16  WS-ISSUE-CNT        PIC 9(5)      VALUE ZEROS COMP-3.
  5450         16  WS-CANCEL-CNT       PIC 9(5)      VALUE ZEROS COMP-3.
  5451     12  WS-LGX-CLAIM-USER       PIC X         VALUE SPACES.
  5452         88  CO-HAS-CLAIMS                     VALUE '2'.
  5453
  5454     12  EIBDATE                 PIC S9(7)     COMP-3.
  5455
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 100
* EL517.cbl
  5457
  5458* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
* 5459     COPY ELC50W1.
  5460******************************************************************04/19/98
  5461*                                                                *ELC50W1
  5462*                                                                *ELC50W1
  5463*                             ELC50W1                            *   LV005
  5464*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  5465*                            VMOD=2.004                          *   CL**5
  5466*                                                                *ELC50W1
  5467*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *ELC50W1
  5468*                                                                *ELC50W1
  5469*                                                                *ELC50W1
  5470******************************************************************ELC50W1
  5471                                                                  ELC50W1
  5472     12  WK-WORK-AREA.                                            ELC50W1
  5473         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.          ELC50W1
  5474         16  WK-LAST-CARRIER          PIC X   VALUE ' '.          ELC50W1
  5475         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.          ELC50W1
  5476         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.          ELC50W1
  5477         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5478         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5479         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5480         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5481         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5482         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5483         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.          ELC50W1
  5484         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.          ELC50W1
  5485         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.          ELC50W1
  5486         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.          ELC50W1
  5487         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE. ELC50W1
  5488         16  WK-CREDIT-EDIT-CONTROLS.                             ELC50W1
  5489             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.       ELC50W1
  5490             20  WK-MIN-AGE           PIC 99  VALUE 00.           ELC50W1
  5491             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.           ELC50W1
  5492             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5493             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5494             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.           ELC50W1
  5495         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.     ELC50W1
  5496         16  WK-SAVE-REIN-DATA.                                   ELC50W1
  5497             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.      ELC50W1
  5498             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.      ELC50W1
  5499             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.      ELC50W1
  5500         16  WK-ENTRY-SW              PIC X    VALUE ' '.         ELC50W1
  5501             88  ENTRY-FROM-EL6311       VALUE '6'.               ELC50W1
  5502         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.         ELC50W1
  5503         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.      ELC50W1
  5504     12  WK-RECORD-ADDRESSES.                                     ELC50W1
  5505         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5506         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5507         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5508         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5509         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5510         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5511         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5512         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5513     12  WK-OVER-SHORT-AREA.                                      ELC50W1
  5514         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.   CL**2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 101
* EL517.cbl (/apps/prod/cid1p/copy/ELC50W1)
  5515         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.   CL**2
  5516         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  5517             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  5518         16  FILLER                   PIC X(5) VALUE SPACES.         CL**3
  5519
  5520         16  WK-CONV-GREG.
  5521             24  WCG-CENT             PIC XX.
  5522             24  WCG-REST             PIC X(4).
  5523         16  WORK-GREGORIAN-DATE.
  5524             24  WK-GREG-CENT         PIC XX.
  5525             24  WK-GREG-DATE-YYMMDD.
  5526                 28  WK-GREG-YYMM     PIC X(4).
  5527                 28  WK-GREG-DD       PIC XX.
  5528
  5529         16  WORK-SELECT-DATE.
  5530             24  WK-SELECT-CENT           PIC XX.
  5531             24  WK-SELECT-DATE-YYMMDD.
  5532                 28  WK-SELECT-GREG-YYMM  PIC X(4).
  5533                 28  FILLER               PIC XX.
  5534
  5535         16  WK-FORM-NO.
  5536             24  WK-FORM-BANK-ID       PIC X(5).
  5537             24  WK-FORM-UNDRWRTR      PIC X(1).
  5538             24  WK-FORM-MASTER-POL-NO PIC X(6).
  5539
  5540         16  WK-MEMBER-NO.
  5541             24  WK-MEMBER-1-6        PIC X(6).
  5542             24  WK-MEMBER-7-12       PIC X(6).
  5543
  5544         16  WK-FULL-CERT-NO.
  5545             24  WK-CERT-POS-1-2      PIC X(2).
  5546             24  WK-CERT-POS-3        PIC X(1).
  5547             24  WK-CERT-POS-4        PIC X(1).
  5548             24  WK-CERT-POS-5-6      PIC X(2).
  5549             24  WK-CERT-POS-7        PIC X(1).
  5550             24  WK-CERT-POS-8-11     PIC X(4).
  5551
  5552         16  WK-VALID-RATE-CODE      PIC X VALUE ' '.
  5553             88  VALID-RATE-CODE     VALUE 'Y'.
  5554             88  FOUND-TO-BE-INVALID VALUE 'N'.
  5555
  5556     12  WK-BATCH-NO.
  5557         16  WK-BATCH-PREFIX          PIC XXX       VALUE SPACES.
  5558         16  FILLER                   PIC XXX       VALUE SPACES.
  5559
* 5560                                  COPY ELCEDITC.
  5561******************************************************************04/15/98
  5562*                                                                *ELCEDITC
  5563*                                                                *ELCEDITC
  5564*                            ELCEDITC                            *   LV002
  5565*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5566*                            VMOD=2.012                          *   CL**2
  5567*                                                                *ELCEDITC
  5568*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *ELCEDITC
  5569*                     EL6313, EL050 AND EL517.                   *ELCEDITC
  5570*                                                                *ELCEDITC
  5571******************************************************************ELCEDITC
  5572******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 102
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5573*                   C H A N G E   L O G
  5574*
  5575* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5576*-----------------------------------------------------------------
  5577*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5578* EFFECTIVE    NUMBER
  5579*-----------------------------------------------------------------
  5580* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5581******************************************************************
  5582                                                                  ELCEDITC
  5583     12  EDIT-CRITERIA-DATA.                                      ELCEDITC
  5584         16  EC-CO-MONTH-END-DT       PIC XX.                     ELCEDITC
  5585         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5586         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
  5587         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5588         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5589         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.       ELCEDITC
  5590         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.       ELCEDITC
  5591         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5592         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5593         16  EC-CO-REM-TERM-CALC      PIC X.                      ELCEDITC
  5594               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.     ELCEDITC
  5595               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.     ELCEDITC
  5596               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.     ELCEDITC
  5597               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.     ELCEDITC
  5598                                                                  ELCEDITC
  5599         16  EC-BR-LF-EARNINGS-CALC    PIC X.                     ELCEDITC
  5600               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5601               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5602               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5603               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.    ELCEDITC
  5604               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.    ELCEDITC
  5605               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5606               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5607               88  EC-BR-LF-EARN-MEAN               VALUE '8'.    ELCEDITC
  5608               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.    ELCEDITC
  5609               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5610                                                                  ELCEDITC
  5611         16  EC-BR-AH-EARNINGS-CALC    PIC X.                     ELCEDITC
  5612               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5613               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5614               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5615               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.    ELCEDITC
  5616               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5617               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5618               88  EC-BR-AH-EARN-MEAN               VALUE '8'.    ELCEDITC
  5619               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5620                                                                  ELCEDITC
  5621         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5622                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5623                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5624                                                                  ELCEDITC
  5625         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5626                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5627                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.  ELCEDITC
  5628                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.  ELCEDITC
  5629                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.  ELCEDITC
  5630                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.  ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 103
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5631                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.  ELCEDITC
  5632                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5633                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.  ELCEDITC
  5634                                                                  ELCEDITC
  5635         16  EC-BR-LF-COVERAGE-TYPE    PIC X.                     ELCEDITC
  5636               88  EC-BR-REDUCING                   VALUE 'R'.    ELCEDITC
  5637               88  EC-BR-LEVEL                      VALUE 'L' 'P'.ELCEDITC
  5638                                                                  ELCEDITC
  5639         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).                  ELCEDITC
  5640         16  EC-BR-LF-DESC             PIC X(10).                 ELCEDITC
  5641         16  EC-BR-AH-DESC             PIC X(10).                 ELCEDITC
  5642         16  EC-BR-LF-COMMENT          PIC X(10).                 ELCEDITC
  5643         16  EC-BR-AH-COMMENT          PIC X(10).                 ELCEDITC
  5644                                                                  ELCEDITC
  5645         16  EC-BR-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5646               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5647               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5648               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5649               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5650                                                                  ELCEDITC
  5651         16  EC-BR-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5652               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5653               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5654               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5655               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5656                                                                  ELCEDITC
  5657         16  EC-BR-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5658                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5659                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5660                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5661                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5662                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5663                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5664                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5665                                                                  ELCEDITC
  5666         16  EC-BR-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5667                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5668                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5669                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5670                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5671                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5672                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5673                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5674                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5675                                                                  ELCEDITC
  5676         16  EC-BR-LF-BEN-I-G-CD       PIC X.                     ELCEDITC
  5677                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5678                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5679                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5680                                                                  ELCEDITC
  5681         16  EC-BR-AH-BEN-I-G-CD       PIC X.                     ELCEDITC
  5682                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5683                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5684                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5685                                                                  ELCEDITC
  5686         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5687         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5688         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 104
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5689         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5690                                                                  ELCEDITC
  5691         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.       ELCEDITC
  5692         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.                      ELCEDITC
  5693                 88  EC-ST-EXT-NO-CHG               VALUE ' '.    ELCEDITC
  5694                 88  EC-ST-EXT-CHG-LF               VALUE '1'.    ELCEDITC
  5695                 88  EC-ST-EXT-CHG-AH               VALUE '2'.    ELCEDITC
  5696                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.    ELCEDITC
  5697                                                                  ELCEDITC
  5698         16  EC-ST-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5699               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5700               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5701               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5702               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5703               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5704                                                                  ELCEDITC
  5705         16  EC-ST-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5706               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5707               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5708               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5709               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5710               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5711                                                                  ELCEDITC
  5712         16  EC-ST-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5713                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5714                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5715                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5716                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5717                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5718                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5719                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5720                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5721                                                                  ELCEDITC
  5722         16  EC-ST-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5723                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5724                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5725                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5726                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5727                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5728                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5729                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5730                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5731                                                                  ELCEDITC
  5732         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5733         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5734         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5735         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5736         16  EC-AM-EXPIRATION-DT       PIC XX.                    ELCEDITC
  5737         16  EC-AM-EFFECTIVE-DT        PIC XX.                    ELCEDITC
  5738         16  EC-AM-CLASS-CD            PIC XX.                    ELCEDITC
  5739         16  EC-AM-LF-DEVIATION        PIC XXX.                   ELCEDITC
  5740         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5741         16  EC-AM-AH-DEVIATION        PIC XXX.                   ELCEDITC
  5742         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5743         16  EC-AM-PHONE-NO            PIC X(10).                 ELCEDITC
  5744                                                                  ELCEDITC
  5745         16  EC-AM-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5746                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 105
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5747                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5748                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5749                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5750                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5751                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5752                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5753                                                                  ELCEDITC
  5754         16  EC-AM-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5755                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5756                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5757                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5758                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.    ELCEDITC
  5759                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5760                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5761                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5762                                                                  ELCEDITC
  5763         16  EC-AM-BEN-I-G-CD          PIC X.                     ELCEDITC
  5764                 88  WK-AM-I-G-NOT-USED             VALUE ' '.    ELCEDITC
  5765                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.    ELCEDITC
  5766                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.    ELCEDITC
  5767                                                                  ELCEDITC
  5768         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5769         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5770         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5771         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5772         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5773         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5774         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5775         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5776         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5777                                                                  ELCEDITC
  5778         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5779         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5780         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5781         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5782         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5783         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5784         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5785         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5786         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5787         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5788         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5789         16  EC-RT-LF-NSP-ST           PIC XX.                    ELCEDITC
  5790         16  EC-RT-AH-NSP-ST           PIC XX.                    ELCEDITC
  5791         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5792         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5793                                                                  ELCEDITC
  5794         16  EC-CM-LF-PRIOR-STATUS     PIC X.                     ELCEDITC
  5795             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5796                                             'M' '5' '9' '2'.     ELCEDITC
  5797             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5798             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5799             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5800             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5801             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5802             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5803             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5804             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 106
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5805             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5806             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5807                                                                  ELCEDITC
  5808         16  EC-CM-AH-PRIOR-STATUS     PIC X.                     ELCEDITC
  5809             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5810                                             'M' '5' '9' '2'.     ELCEDITC
  5811             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5812             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5813             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5814             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5815             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5816             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5817             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5818             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
  5819             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5820             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5821                                                                  ELCEDITC
  5822         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5823         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5824         16  EC-CM-LF-CANCEL-DT        PIC XX.                    ELCEDITC
  5825         16  EC-CM-AH-CANCEL-DT        PIC XX.                    ELCEDITC
  5826         16  EC-CM-DEATH-DT            PIC XX.                    ELCEDITC
  5827                                                                  ELCEDITC
  5828*DMD CUSTOM CODING FIELDS BELOW                                   ELCEDITC
  5829*POPULATED BY CF-RATING-SWITCH AT EL050 TIME                      ELCEDITC
  5830         16  EC-BR-DMD-RATING-SW       PIC X.                     ELCEDITC
  5831                 88  EC-DMD-AH-RATING            VALUE 'Y'.       ELCEDITC
  5832                 88  EC-DMD-LF-RATING            VALUE 'Y'.       ELCEDITC
  5833                 88  NO-DMD-RATING               VALUE 'N'.       ELCEDITC
  5834                                                                  ELCEDITC
  5835         16  EC-NEW-CERT               PIC X(11).                 ELCEDITC
  5836         16  EC-NEW-STATE              PIC XX.                    ELCEDITC
  5837         16  FILLER                    PIC X.                     ELCEDITC
  5838*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.                 ELCEDITC
  5839         16  OVER-SHORT-EDIT-FIELDS.                              ELCEDITC
  5840             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5841             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5842             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5843             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5844             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5845             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5846             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5847             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5848             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5849         16  FILLER                    PIC X(71).                 ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 107
* EL517.cbl
* 5851                                  COPY ELC50WS.
  5852*****************************************************************
  5853*                                                               *
  5854*                            ELC50WS.                           *
  5855*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5856*                            VMOD=2.061.                        *
  5857*                                                               *
  5858*   THIS IS THE WORKING STORAGE FOR EL050                       *
  5859*                                   EL517                       *
  5860*****************************************************************
  5861******************************************************************
  5862*                   C H A N G E   L O G
  5863*
  5864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5865*-----------------------------------------------------------------
  5866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5867* EFFECTIVE    NUMBER
  5868*-----------------------------------------------------------------
  5869* 123102                   PEMA  ADD DCC PROCESSING
  5870* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
  5871* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
  5872* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5873* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5874* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  5875* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  5876* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  5877* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
  5878* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  5879* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  5880* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
  5881* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  5882* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  5883* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  5884* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  5885* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
  5886* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5887* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
  5888* 030309  CR2009021700001  PEMA  ADD ER-2883
  5889* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
  5890* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5891* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  5892* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  5893* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
  5894* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  5895* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  5896* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  5897* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5898* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  5899* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  5900* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  5901* 061412  CR2011022800001  AJRA  NAPERSOFT
  5902* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5903* 012213  CR2013011600001  PEMA  ADD ERROR 3058
  5904* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  5905*-----------------------------------------------------------------
  5906
  5907 01  WORK-AREAS.
  5908
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 108
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  5909*****************************************************************
  5910*        WORKING STORAGE AREA FOR CLIENT-MON                    *
  5911*****************************************************************
  5912
  5913     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
  5914     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
  5915     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
  5916     12  WS-NAME-EDIT-WORK-AREA.
  5917         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
  5918         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
  5919             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
  5920         16  WS-WORK-NAME.
  5921             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
  5922             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
  5923             20  FILLER           PIC X(10)     VALUE SPACES.
  5924         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
  5925             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
  5926
  5927*****************************************************************
  5928*        END OF WORKING STORAGE FOR CLIENT-MON                  *
  5929*****************************************************************
  5930
  5931     12  WS-ERRESC-KEY.
  5932         16 WS-ERRESC-SEARCH-KEY.
  5933             20  WS-ERRESC-COMPANY-CD PIC  X.
  5934             20  WS-ERRESC-CARRIER    PIC  X.
  5935             20  WS-ERRESC-GROUP      PIC X(6).
  5936             20  WS-ERRESC-STATE      PIC XX.
  5937             20  WS-ERRESC-ACCOUNT    PIC X(10).
  5938         16 WS-ERRESC-RESIDUAL-KEY.
  5939             20  WS-ERRESC-AGENT      PIC X(10).
  5940             20  WS-ERRESC-RES-STATE  PIC XX.
  5941             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  5942*                                          YYYYMMDD
  5943     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  5944     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
  5945
  5946*RESIDENT STATE TAX MASTER(ERRESS)
  5947*
  5948     12  WS-ERRESS-KEY.
  5949         16  WS-ERRESS-COMPANY-CD      PIC  X.
  5950         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
  5951         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
  5952         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
  5953*                                          YYYYMMDD
  5954
  5955     12  WS-CONTRACT-DATE              PIC 9(8).
  5956*                                          YYYYMMDD
  5957     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
  5958     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
  5959         16 WS-YEAR-YY                 PIC   9999.
  5960         16 FILLER                     PIC 9(4).
  5961*                                          YYYYMMDD
  5962     12  WS-SAVE-ERRESS-KEY            PIC X(9).
  5963     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
  5964     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
  5965     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
  5966
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 109
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  5967     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
  5968         88  DPRB-1ST-TIME                      VALUE ' '.
  5969
  5970*****************************************************************
  5971*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
  5972*****************************************************************
  5973
  5974     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
  5975     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
  5976     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
  5977     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
  5978     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
  5979     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
  5980     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
  5981     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
  5982     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
  5983     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
  5984         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
  5985         88 NO-AH-COVERAGE           VALUE '  ' '00'.
  5986     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
  5987         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
  5988         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
  5989     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
  5990
  5991     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
  5992     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
  5993
  5994     12  WS-R78-METHOD            PIC X         VALUE SPACES.
  5995     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
  5996     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  5997     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  5998     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  5999     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  6000     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  6001     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  6002     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  6003     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  6004     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  6005     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  6006     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
  6007     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
  6008     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
  6009     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
  6010     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6011     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6012     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6013     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6014     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6015     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6016     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6017     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6018     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6019     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6020     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  6021     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6022     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  6023     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6024     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 110
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6025     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6026     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  6027     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6028     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
  6029     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
  6030     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
  6031     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
  6032     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
  6033     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
  6034     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
  6035     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
  6036     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
  6037     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
  6038     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
  6039     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
  6040     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
  6041     12  WS-IG-OVRD               PIC X         VALUE SPACES.
  6042     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
  6043     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
  6044     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
  6045     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
  6046     12  WS-2671-SW               PIC X         VALUE SPACE.
  6047     12  WS-2672-SW               PIC X         VALUE SPACE.
  6048     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
  6049         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
  6050     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
  6051         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
  6052     12  W-BROWSE-SW              PIC X         VALUE SPACE.
  6053
  6054     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
  6055         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
  6056         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
  6057         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
  6058         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
  6059
  6060     12  WS-CREDIT-EDIT-CONTROLS.
  6061         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
  6062         16  WS-MIN-AGE           PIC 99                VALUE  0.
  6063         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
  6064         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6065         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6066         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
  6067
  6068     12  WS-AGE-FIELDS.
  6069         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
  6070         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
  6071         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
  6072         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
  6073
  6074     12  WS-SAVE-ALLOWABLE-BENEFIT.
  6075         16  WS-SAVE-BENEFIT-CODE       PIC XX.
  6076         16  WS-SAVE-BENEFIT-TYPE       PIC X.
  6077         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
  6078         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
  6079         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
  6080         16  FILLER                      PIC XX.
  6081
  6082     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 111
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6083     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
  6084     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
  6085     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
  6086     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
  6087     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
  6088     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
  6089     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
  6090     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6091     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6092
  6093     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
  6094     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
  6095     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6096     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
  6097     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
  6098     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
  6099     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
  6100     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
  6101         88  WS-REDUCING              VALUE 'R'.
  6102         88  WS-LEVEL                 VALUE 'L' 'P'.
  6103     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
  6104
  6105     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
  6106     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
  6107     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6108     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
  6109     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
  6110     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
  6111     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
  6112     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
  6113     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
  6114
  6115     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
  6116     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
  6117     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
  6118     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6119     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
  6120     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6121     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
  6122     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
  6123     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
  6124     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
  6125     12  WS-ACCT-SIG-SW.
  6126         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
  6127         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
  6128     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6129     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6130     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
  6131     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
  6132     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
  6133     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6134     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
  6135     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6136     12  WS-INITIALS.
  6137         16  WS-INIT-1            PIC X         VALUE SPACES.
  6138         16  WS-INIT-2            PIC X         VALUE SPACES.
  6139
  6140     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 112
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6141     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
  6142     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
  6143     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
  6144     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
  6145*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
  6146     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
  6147     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
  6148     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
  6149     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6150     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6151     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
  6152     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
  6153     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
  6154     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
  6155     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
  6156     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
  6157     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
  6158     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
  6159     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6160     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6161     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
  6162     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6163     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6164     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6165     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6166     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6167     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6168******** FLA
  6169     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6170     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6171     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6172     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6173     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6174********
  6175     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
  6176     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
  6177     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
  6178     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
  6179     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
  6180     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
  6181     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
  6182     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
  6183     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
  6184     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
  6185
  6186     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
  6187         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
  6188                                         '0' THRU '9'.
  6189
  6190     12  NUMBER-OF-MONTHS.
  6191         16  SK-MO OCCURS 12 TIMES PIC X.
  6192
  6193     12  WS-WORK-DATE.
  6194         16  WS-YEAR            PIC 99    VALUE 00.
  6195         16  WS-MONTH           PIC 99    VALUE 00.
  6196         16  WS-DAY             PIC 99    VALUE 00.
  6197
  6198     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 113
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6199     12  WS-WORK-CRIT-DEV       REDEFINES
  6200         WS-WORK-LF-CRIT-PER    PIC X(03).
  6201
  6202     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
  6203     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
  6204
  6205     12  WS-WORK-DATE-FROM.
  6206         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
  6207         16  FILLER             PIC X  VALUE SPACE.
  6208         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
  6209         16  FILLER             PIC X         VALUE SPACE.
  6210         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
  6211
  6212     12  WS-WORK-DATE-THRU.
  6213         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
  6214         16  FILLER             PIC X         VALUE SPACE.
  6215         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
  6216         16  FILLER             PIC X         VALUE SPACE.
  6217         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
  6218
  6219     12  WS-LF-INPUT-CD.
  6220         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
  6221         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
  6222
  6223     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
  6224     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
  6225         16  WS-AH-INPUT-CD-1   PIC X.
  6226         16  WS-AH-INPUT-CD-2-3 PIC XX.
  6227
  6228     12  WS-SWITCHES.
  6229         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
  6230         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
  6231             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
  6232         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
  6233             88  BANK-ACCT-FOUND          VALUE 'Y'.
  6234         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
  6235             88  AGENT-MASTER-FOUND       VALUE 'Y'.
  6236         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
  6237             88  BXRF-MASTER-FOUND        VALUE 'Y'.
  6238         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
  6239             88  COMP-MASTER-FOUND        VALUE 'Y'.
  6240         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
  6241             88  LOFC-MASTER-FOUND        VALUE 'Y'.
  6242         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
  6243             88  PDEF-MASTER-FOUND        VALUE 'Y'.
  6244         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
  6245             88  STAT-MASTER-FOUND        VALUE 'Y'.
  6246         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
  6247             88  PLAN-MASTER-FOUND        VALUE 'Y'.
  6248         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
  6249             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
  6250         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
  6251             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
  6252         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
  6253             88  FORM-MASTER-FOUND        VALUE 'Y'.
  6254         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
  6255             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
  6256         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 114
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6257             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
  6258         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
  6259             88  PROCESS-FORM-EDITS       VALUE 'Y'.
  6260         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
  6261             88  NO-BENEFIT-FOUND         VALUE 'N'.
  6262         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
  6263             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
  6264         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
  6265             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
  6266         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6267             88  AH-BENEFIT-FOUND         VALUE ' '.
  6268             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
  6269         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6270             88  LF-BENEFIT-FOUND         VALUE ' '.
  6271             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
  6272         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
  6273             88  NO-STATE-RECORD          VALUE '1'.
  6274         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
  6275             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
  6276         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
  6277             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
  6278         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
  6279             88  CERT-WAS-FOUND           VALUE ' '.
  6280             88  CERT-WAS-NOT-FOUND       VALUE '1'.
  6281         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
  6282             88  BROWSE-STARTED           VALUE 'Y'.
  6283         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
  6284             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
  6285         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
  6286             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
  6287         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
  6288             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
  6289         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
  6290             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
  6291         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
  6292             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
  6293         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
  6294             88  APP-CERT-USED            VALUE 'Y' 'A'.
  6295         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
  6296             88  CTBL-TABLE-FOUND         VALUE 'Y'.
  6297             88  FIRST-TIME-THROUGH       VALUE '1'.
  6298             88  CTBL-NOT-FOUND           VALUE '2'.
  6299
  6300         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
  6301             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
  6302
  6303         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
  6304             88  DLO-ERROR-FOUND          VALUE 'Y'.
  6305
  6306********FLA
  6307     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
  6308     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
  6309********
  6310     12  RC-SW-1                  PIC X           VALUE '0'.
  6311     12  RC-SW-2                  PIC X           VALUE '0'.
  6312     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
  6313     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
  6314     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 115
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6315     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
  6316     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
  6317     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
  6318     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
  6319     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
  6320     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
  6321     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
  6322     12  LIT-SPACES               PIC X           VALUE SPACES.
  6323     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
  6324     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
  6325     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
  6326     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
  6327     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6328     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6329     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
  6330         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
  6331         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
  6332     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
  6333         88  SKIP-ADDR-EDIT         VALUE 'Y'.
  6334
  6335 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
  6336     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
  6337     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
  6338 01  WS-CRI-SSN-WORK-AREA.
  6339     05  WS-CRI-SOC-SEC-NO.
  6340         10  WS-SS-REPT-CD       PIC X(5).
  6341         10  WS-SS-LAST-NAME     PIC X(5).
  6342         10  WS-SS-INITIAL       PIC X.
  6343
  6344     05  WS-CRI-REPORT-CODE.
  6345         10  FILLER              PIC X(5).
  6346         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
  6347
  6348     05  WS-CRI-LAST-NAME.
  6349         10  WS-CRI-NAME-MOVE    PIC X(5).
  6350         10  FILLER              PIC X(10).
  6351
  6352 01  WS-NUM-TABLE                PIC X(26)  VALUE
  6353     '12345678012345070923456789'.
  6354 01  FILLER REDEFINES WS-NUM-TABLE.
  6355     05  WS-NUM OCCURS 26        PIC 9.
  6356 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
  6357 01  V1                          PIC S999 COMP-3.
  6358 01  V2                          PIC S999 COMP-3.
  6359 01  V3                          PIC S999 COMP-3.
  6360 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
  6361 01  FILLER REDEFINES WS-WORK-VIN.
  6362     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
  6363 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
  6364 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
  6365 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
  6366 01  WS-HEX-WORK.
  6367     05  FILLER                  PIC X  VALUE LOW-VALUES.
  6368     05  WS-HEX-BYTE             PIC X.
  6369 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
  6370 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
  6371
  6372 01  WS-WORK-HIN-ROW-B.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 116
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6373     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
  6374
  6375 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
  6376 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
  6377     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
  6378 01  WS-ROW-D-TABLE.
  6379     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
  6380
  6381 01  WS-HIN-TABLE-B.
  6382     05  F                       PIC XX VALUE 'A2'.
  6383     05  F                       PIC XX VALUE 'B3'.
  6384     05  F                       PIC XX VALUE 'C4'.
  6385     05  F                       PIC XX VALUE 'D5'.
  6386     05  F                       PIC XX VALUE 'E6'.
  6387     05  F                       PIC XX VALUE 'F7'.
  6388     05  F                       PIC XX VALUE 'G8'.
  6389     05  F                       PIC XX VALUE 'H9'.
  6390     05  F                       PIC XX VALUE 'I1'.
  6391     05  F                       PIC XX VALUE 'J2'.
  6392     05  F                       PIC XX VALUE 'K3'.
  6393     05  F                       PIC XX VALUE 'L4'.
  6394     05  F                       PIC XX VALUE 'M5'.
  6395     05  F                       PIC XX VALUE 'N6'.
  6396     05  F                       PIC XX VALUE 'O0'.
  6397     05  F                       PIC XX VALUE 'P7'.
  6398     05  F                       PIC XX VALUE 'Q0'.
  6399     05  F                       PIC XX VALUE 'R8'.
  6400     05  F                       PIC XX VALUE 'S9'.
  6401     05  F                       PIC XX VALUE 'T2'.
  6402     05  F                       PIC XX VALUE 'U3'.
  6403     05  F                       PIC XX VALUE 'V4'.
  6404     05  F                       PIC XX VALUE 'W5'.
  6405     05  F                       PIC XX VALUE 'X6'.
  6406     05  F                       PIC XX VALUE 'Y7'.
  6407     05  F                       PIC XX VALUE 'Z8'.
  6408 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
  6409     05  WS-VAL-IN               PIC X.
  6410     05  WS-VAL-OUT              PIC 9.
  6411 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
  6412
  6413 01  WS-COMPARE-BINARY-DATES.
  6414     05  WS-971231                PIC XX VALUE X'92FF'.
  6415     05  WS-931231                PIC XX VALUE X'8CFF'.
  6416     05  WS-791231                PIC XX VALUE X'77FF'.
  6417     05  WS-771001                PIC XX VALUE X'74A1'.
  6418     05  WS-820301                PIC XX VALUE X'7B41'.
  6419     05  WS-831031                PIC XX VALUE X'7DBF'.
  6420     05  WS-831231                PIC XX VALUE X'7DFF'.
  6421     05  WS-810831                PIC XX VALUE X'7A7F'.
  6422     05  WS-830901                PIC XX VALUE X'7D81'.
  6423
  6424 01  FILE-ACCESS-IDS.
  6425     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
  6426     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
  6427     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
  6428     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
  6429     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
  6430     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 117
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6431     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
  6432     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
  6433     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
  6434     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
  6435     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
  6436     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
  6437     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
  6438     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
  6439     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
  6440     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
  6441     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
  6442
  6443 01  DD-IU-SW                    PIC X   VALUE ' '.
  6444     88  DD-IU-PRESENT                 VALUE 'Y'.
  6445
  6446 01  ACCESS-KEYS.
  6447     12  ELMSTR-KEY.
  6448         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
  6449         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
  6450     12  W-CLAIM-KEY.
  6451         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
  6452         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
  6453
  6454     12  ELCNTL-KEY.
  6455         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
  6456         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
  6457         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
  6458         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
  6459
  6460     12  ELCERT-KEY.
  6461         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
  6462         16  CERT-CARRIER         PIC X       VALUE SPACE.
  6463         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
  6464         16  CERT-STATE           PIC XX      VALUE SPACES.
  6465         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
  6466         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
  6467         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
  6468
  6469     12  ELCERT2-KEY.
  6470         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
  6471         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
  6472
  6473     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
  6474
  6475     12  ELCERT-SAVE.
  6476         16  FILLER                      PIC XX    VALUE SPACES.
  6477
  6478         16  WCS-CONTROL-PRIMARY.
  6479             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
  6480             20  WCS-CARRIER             PIC X     VALUE SPACE.
  6481             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
  6482             20  WCS-STATE               PIC XX    VALUE SPACES.
  6483             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
  6484             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
  6485             20  WCS-CERT-NO.
  6486                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
  6487                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
  6488
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 118
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6489         16  CS-CONTROL-BY-NAME.
  6490             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
  6491             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
  6492             20  CS-INSURED-INITIALS.
  6493                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
  6494                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
  6495
  6496         16  CS-CONTROL-BY-SSN.
  6497             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
  6498             20  CS-SOC-SEC-NO.
  6499                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
  6500                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
  6501                 24  CS-SSN-LN3.
  6502                     28 CS-INSURED-INITIALS-A2   PIC XX
  6503                                     VALUE SPACES.
  6504                     28 CS-PART-LAST-NAME-A2     PIC X
  6505                                     VALUE SPACE.
  6506
  6507         16  CS-CONTROL-BY-CERT-NO.
  6508             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
  6509             20  CS-CERT-NO-A4           PIC X(11)
  6510                                     VALUE SPACES.
  6511
  6512         16  CS-CONTROL-BY-MEMB.
  6513             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
  6514             20  CS-MEMBER-NO.
  6515                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
  6516                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
  6517                 24  CS-MEMB-LN4.
  6518                     28 CS-INSURED-INITIALS-A5   PIC XX
  6519                                      VALUE SPACES.
  6520                     28 CS-PART-LAST-NAME-A5     PIC XX
  6521                                      VALUE SPACES.
  6522
  6523         16  FILLER              PIC X(360) VALUE SPACES.
  6524
  6525     12  ERACCT-KEY.
  6526         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
  6527         16  ACCT-CARRIER         PIC X     VALUE SPACES.
  6528         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
  6529         16  ACCT-STATE           PIC X(02) VALUE SPACES.
  6530         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
  6531         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
  6532
  6533     12  ERCOMP-KEY.
  6534         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
  6535         16  COMP-CARRIER         PIC X     VALUE SPACES.
  6536         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
  6537         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
  6538         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
  6539         16  COMP-TYPE            PIC X     VALUE SPACES.
  6540
  6541     12  ERLOFC-KEY.
  6542         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6543         16  LOFC-CARRIER         PIC X     VALUE SPACES.
  6544         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
  6545         16  LOFC-STATE           PIC XX    VALUE SPACES.
  6546         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 119
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6547         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
  6548
  6549     12  WS-ELCRTT-KEY.
  6550         16  WS-ELCRTT-PRIMARY       PIC X(33).
  6551         16  WS-ELCRTT-REC-TYPE      PIC X(1).
  6552
  6553     12  ERBXRF-KEY.
  6554         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
  6555         16  BXRF-CARRIER         PIC X     VALUE SPACES.
  6556         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
  6557         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
  6558
  6559     12  ERAGTC-KEY.
  6560         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6561         16  AGTC-CARRIER         PIC X     VALUE SPACES.
  6562         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
  6563         16  AGTC-BANK            PIC X(10) VALUE SPACES.
  6564         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
  6565         16  AGTC-TYPE            PIC X     VALUE SPACES.
  6566
  6567     12  ERPLAN-KEY.
  6568         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6569         16  PLAN-CARRIER         PIC X     VALUE SPACES.
  6570         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
  6571         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
  6572         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
  6573         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
  6574         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
  6575         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
  6576
  6577     12  ERFORM-KEY.
  6578         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6579         16  FORM-STATE           PIC X(2)  VALUE SPACES.
  6580         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
  6581         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
  6582
  6583     12  ERREIN-KEY.
  6584         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
  6585         16  REIN-TYPE            PIC X     VALUE SPACES.
  6586         16  REIN-TABLE-CO.
  6587             20  REIN-CODE-1      PIC X     VALUE SPACE.
  6588             20  REIN-CODE-2      PIC X     VALUE SPACE.
  6589             20  REIN-CODE-3      PIC X     VALUE SPACE.
  6590         16  FILLER               PIC X(3)  VALUE SPACES.
  6591
  6592     12  ERCTBL-KEY.
  6593         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6594         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
  6595         16  CTBL-CNTRL-2.
  6596             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
  6597             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
  6598
  6599     12  ELCRTO-KEY.
  6600         16  ELCRTO-COMPANY-CD       PIC X.
  6601         16  ELCRTO-CARRIER          PIC X.
  6602         16  ELCRTO-GROUPING         PIC X(6).
  6603         16  ELCRTO-STATE            PIC XX.
  6604         16  ELCRTO-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 120
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6605         16  ELCRTO-CERT-EFF-DT      PIC XX.
  6606         16  ELCRTO-CERT-NO.
  6607             20  ELCRTO-CERT-PRIME   PIC X(10).
  6608             20  ELCRTO-CERT-SFX     PIC X.
  6609         16  ELCRTO-RECORD-TYPE      PIC X.
  6610         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
  6611
  6612
  6613     12  WS-ACCESS.
  6614         16  FILLER               PIC XX    VALUE SPACES.
  6615         16  WS-BEN-CD            PIC XX    VALUE SPACES.
  6616
  6617     12  WS-CARR-ACCESS.
  6618         16  FILLER               PIC X(3)  VALUE SPACES.
  6619         16  WS-CARR              PIC X     VALUE SPACE.
  6620*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
  6621*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
  6622     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
  6623         88  WS-DMD-LF-RATING   VALUE 'Y'.
  6624         88  WS-DMD-AH-RATING   VALUE 'Y'.
  6625         88  WS-DMD-NO-RATING   VALUE 'N'.
  6626
  6627
  6628     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
  6629         88  WS-LF-CASH            VALUE 'MJ' 'MS'
  6630                                         'NJ' 'NL'
  6631                                         'PJ' 'PL'
  6632                                         'SJ' 'SL'.
  6633     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
  6634         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
  6635                                         'NI' 'NJ' 'NL' 'NU'
  6636                                         'PJ' 'PL' 'PI' 'PU'
  6637                                         'SI' 'SJ' 'SL' 'SU'
  6638                                         'MX' 'MY' 'MZ'.
  6639
  6640 01  ERPDEF-KEY-SAVE             PIC X(18).
  6641 01  ERPDEF-KEY.
  6642     12  ERPDEF-COMPANY-CD       PIC X.
  6643     12  ERPDEF-STATE            PIC XX.
  6644     12  ERPDEF-PROD-CD          PIC XXX.
  6645     12  F                       PIC X(7).
  6646     12  ERPDEF-BEN-TYPE         PIC X.
  6647     12  ERPDEF-BEN-CODE         PIC XX.
  6648     12  ERPDEF-EXP-DT           PIC XX.
  6649
  6650 01  ELSTAT-KEY-SAVE             PIC X(20).
  6651 01  ELSTAT-KEY.
  6652     12  ELSTAT-COMPANY-ID       PIC XXX.
  6653     12  ELSTAT-CARRIER          PIC X.
  6654     12  ELSTAT-GROUP            PIC X(6).
  6655     12  ELSTAT-STATE            PIC XX.
  6656     12  ELSTAT-EXP-DT           PIC 9(8).
  6657
  6658 01  WS-ERROR-VALUES.
  6659     12  ER-1570                     PIC S9(4)   VALUE +1570.
  6660     12  ER-1571                     PIC S9(4)   VALUE +1571.
  6661     12  ER-1575                     PIC S9(4)   VALUE +1575.
  6662     12  ER-1891                     PIC S9(4)   VALUE +1891.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 121
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6663     12  ER-1892                     PIC S9(4)   VALUE +1892.
  6664     12  ER-1893                     PIC S9(4)   VALUE +1893.
  6665     12  ER-1894                     PIC S9(4)   VALUE +1894.
  6666     12  ER-1895                     PIC S9(4)   VALUE +1895.
  6667     12  ER-1896                     PIC S9(4)   VALUE +1896.
  6668     12  ER-1897                     PIC S9(4)   VALUE +1897.
  6669     12  ER-1898                     PIC S9(4)   VALUE +1898.
  6670     12  ER-1899                     PIC S9(4)   VALUE +1899.
  6671     12  ER-1900                     PIC S9(4)   VALUE +1900.
  6672     12  ER-1901                     PIC S9(4)   VALUE +1901.
  6673     12  ER-1902                     PIC S9(4)   VALUE +1902.
  6674     12  ER-1903                     PIC S9(4)   VALUE +1903.
  6675     12  ER-1904                     PIC S9(4)   VALUE +1904.
  6676     12  ER-1905                     PIC S9(4)   VALUE +1905.
  6677     12  ER-1906                     PIC S9(4)   VALUE +1906.
  6678     12  ER-1907                     PIC S9(4)   VALUE +1907.
  6679     12  ER-1909                     PIC S9(4)   VALUE +1909.
  6680     12  ER-1910                     PIC S9(4)   VALUE +1910.
  6681     12  ER-1911                     PIC S9(4)   VALUE +1911.
  6682     12  ER-1912                     PIC S9(4)   VALUE +1912.
  6683     12  ER-1913                     PIC S9(4)   VALUE +1913.
  6684     12  ER-1914                     PIC S9(4)   VALUE +1914.
  6685     12  ER-1915                     PIC S9(4)   VALUE +1915.
  6686     12  ER-1916                     PIC S9(4)   VALUE +1916.
  6687     12  ER-1917                     PIC S9(4)   VALUE +1917.
  6688     12  ER-1918                     PIC S9(4)   VALUE +1918.
  6689     12  ER-1919                     PIC S9(4)   VALUE +1919.
  6690     12  ER-1920                     PIC S9(4)   VALUE +1920.
  6691     12  ER-1921                     PIC S9(4)   VALUE +1921.
  6692     12  ER-1922                     PIC S9(4)   VALUE +1922.
  6693     12  ER-1923                     PIC S9(4)   VALUE +1923.
  6694     12  ER-1924                     PIC S9(4)   VALUE +1924.
  6695     12  ER-1925                     PIC S9(4)   VALUE +1925.
  6696     12  ER-1926                     PIC S9(4)   VALUE +1926.
  6697     12  ER-1927                     PIC S9(4)   VALUE +1927.
  6698     12  ER-2393                     PIC S9(4)   VALUE +2393.
  6699     12  ER-2600                     PIC S9(4)   VALUE +2600.
  6700     12  ER-2601                     PIC S9(4)   VALUE +2601.
  6701     12  ER-2602                     PIC S9(4)   VALUE +2602.
  6702     12  ER-2603                     PIC S9(4)   VALUE +2603.
  6703     12  ER-2604                     PIC S9(4)   VALUE +2604.
  6704     12  ER-2605                     PIC S9(4)   VALUE +2605.
  6705     12  ER-2606                     PIC S9(4)   VALUE +2606.
  6706     12  ER-2607                     PIC S9(4)   VALUE +2607.
  6707     12  ER-2608                     PIC S9(4)   VALUE +2608.
  6708     12  ER-2609                     PIC S9(4)   VALUE +2609.
  6709     12  ER-2610                     PIC S9(4)   VALUE +2610.
  6710     12  ER-2611                     PIC S9(4)   VALUE +2611.
  6711     12  ER-2612                     PIC S9(4)   VALUE +2612.
  6712     12  ER-2613                     PIC S9(4)   VALUE +2613.
  6713     12  ER-2614                     PIC S9(4)   VALUE +2614.
  6714     12  ER-2615                     PIC S9(4)   VALUE +2615.
  6715     12  ER-2616                     PIC S9(4)   VALUE +2616.
  6716     12  ER-2617                     PIC S9(4)   VALUE +2617.
  6717     12  ER-2618                     PIC S9(4)   VALUE +2618.
  6718     12  ER-2619                     PIC S9(4)   VALUE +2619.
  6719     12  ER-2620                     PIC S9(4)   VALUE +2620.
  6720     12  ER-2621                     PIC S9(4)   VALUE +2621.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 122
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6721     12  ER-2622                     PIC S9(4)   VALUE +2622.
  6722     12  ER-2623                     PIC S9(4)   VALUE +2623.
  6723     12  ER-2624                     PIC S9(4)   VALUE +2624.
  6724     12  ER-2625                     PIC S9(4)   VALUE +2625.
  6725     12  ER-2626                     PIC S9(4)   VALUE +2626.
  6726     12  ER-2627                     PIC S9(4)   VALUE +2627.
  6727     12  ER-2628                     PIC S9(4)   VALUE +2628.
  6728     12  ER-2629                     PIC S9(4)   VALUE +2629.
  6729     12  ER-2630                     PIC S9(4)   VALUE +2630.
  6730     12  ER-2631                     PIC S9(4)   VALUE +2631.
  6731     12  ER-2632                     PIC S9(4)   VALUE +2632.
  6732     12  ER-2633                     PIC S9(4)   VALUE +2633.
  6733     12  ER-2634                     PIC S9(4)   VALUE +2634.
  6734     12  ER-2635                     PIC S9(4)   VALUE +2635.
  6735     12  ER-2636                     PIC S9(4)   VALUE +2636.
  6736     12  ER-2637                     PIC S9(4)   VALUE +2637.
  6737     12  ER-2638                     PIC S9(4)   VALUE +2638.
  6738     12  ER-2639                     PIC S9(4)   VALUE +2639.
  6739     12  ER-2640                     PIC S9(4)   VALUE +2640.
  6740     12  ER-2641                     PIC S9(4)   VALUE +2641.
  6741     12  ER-2642                     PIC S9(4)   VALUE +2642.
  6742     12  ER-2643                     PIC S9(4)   VALUE +2643.
  6743     12  ER-2644                     PIC S9(4)   VALUE +2644.
  6744     12  ER-2645                     PIC S9(4)   VALUE +2645.
  6745     12  ER-2646                     PIC S9(4)   VALUE +2646.
  6746     12  ER-2647                     PIC S9(4)   VALUE +2647.
  6747     12  ER-2648                     PIC S9(4)   VALUE +2648.
  6748     12  ER-2649                     PIC S9(4)   VALUE +2649.
  6749     12  ER-2650                     PIC S9(4)   VALUE +2650.
  6750     12  ER-2651                     PIC S9(4)   VALUE +2651.
  6751     12  ER-2652                     PIC S9(4)   VALUE +2652.
  6752     12  ER-2653                     PIC S9(4)   VALUE +2653.
  6753     12  ER-2654                     PIC S9(4)   VALUE +2654.
  6754     12  ER-2655                     PIC S9(4)   VALUE +2655.
  6755     12  ER-2656                     PIC S9(4)   VALUE +2656.
  6756     12  ER-2657                     PIC S9(4)   VALUE +2657.
  6757     12  ER-2658                     PIC S9(4)   VALUE +2658.
  6758     12  ER-2659                     PIC S9(4)   VALUE +2659.
  6759     12  ER-2660                     PIC S9(4)   VALUE +2660.
  6760     12  ER-2661                     PIC S9(4)   VALUE +2661.
  6761     12  ER-2662                     PIC S9(4)   VALUE +2662.
  6762     12  ER-2663                     PIC S9(4)   VALUE +2663.
  6763     12  ER-2664                     PIC S9(4)   VALUE +2664.
  6764     12  ER-2665                     PIC S9(4)   VALUE +2665.
  6765     12  ER-2666                     PIC S9(4)   VALUE +2666.
  6766     12  ER-2667                     PIC S9(4)   VALUE +2667.
  6767     12  ER-2668                     PIC S9(4)   VALUE +2668.
  6768     12  ER-2669                     PIC S9(4)   VALUE +2669.
  6769     12  ER-2670                     PIC S9(4)   VALUE +2670.
  6770     12  ER-2671                     PIC S9(4)   VALUE +2671.
  6771     12  ER-2672                     PIC S9(4)   VALUE +2672.
  6772     12  ER-2673                     PIC S9(4)   VALUE +2673.
  6773     12  ER-2674                     PIC S9(4)   VALUE +2674.
  6774     12  ER-2675                     PIC S9(4)   VALUE +2675.
  6775     12  ER-2676                     PIC S9(4)   VALUE +2676.
  6776     12  ER-2677                     PIC S9(4)   VALUE +2677.
  6777     12  ER-2678                     PIC S9(4)   VALUE +2678.
  6778     12  ER-2679                     PIC S9(4)   VALUE +2679.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 123
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6779     12  ER-2680                     PIC S9(4)   VALUE +2680.
  6780     12  ER-2681                     PIC S9(4)   VALUE +2681.
  6781     12  ER-2682                     PIC S9(4)   VALUE +2682.
  6782     12  ER-2683                     PIC S9(4)   VALUE +2683.
  6783     12  ER-2684                     PIC S9(4)   VALUE +2684.
  6784     12  ER-2685                     PIC S9(4)   VALUE +2685.
  6785     12  ER-2686                     PIC S9(4)   VALUE +2686.
  6786     12  ER-2687                     PIC S9(4)   VALUE +2687.
  6787     12  ER-2688                     PIC S9(4)   VALUE +2688.
  6788     12  ER-2689                     PIC S9(4)   VALUE +2689.
  6789     12  ER-2690                     PIC S9(4)   VALUE +2690.
  6790     12  ER-2691                     PIC S9(4)   VALUE +2691.
  6791     12  ER-2692                     PIC S9(4)   VALUE +2692.
  6792     12  ER-2693                     PIC S9(4)   VALUE +2693.
  6793     12  ER-2694                     PIC S9(4)   VALUE +2694.
  6794     12  ER-2695                     PIC S9(4)   VALUE +2695.
  6795     12  ER-2696                     PIC S9(4)   VALUE +2696.
  6796     12  ER-2697                     PIC S9(4)   VALUE +2697.
  6797     12  ER-2698                     PIC S9(4)   VALUE +2698.
  6798     12  ER-2699                     PIC S9(4)   VALUE +2699.
  6799     12  ER-2700                     PIC S9(4)   VALUE +2700.
  6800     12  ER-2701                     PIC S9(4)   VALUE +2701.
  6801     12  ER-2702                     PIC S9(4)   VALUE +2702.
  6802     12  ER-2703                     PIC S9(4)   VALUE +2703.
  6803     12  ER-2704                     PIC S9(4)   VALUE +2704.
  6804     12  ER-2707                     PIC S9(4)   VALUE +2707.
  6805     12  ER-2720                     PIC S9(4)   VALUE +2720.
  6806     12  ER-2709                     PIC S9(4)   VALUE +2709.
  6807     12  ER-2717                     PIC S9(4)   VALUE +2717.
  6808     12  ER-2718                     PIC S9(4)   VALUE +2718.
  6809     12  ER-2719                     PIC S9(4)   VALUE +2719.
  6810     12  ER-2721                     PIC S9(4)   VALUE +2721.
  6811     12  ER-2722                     PIC S9(4)   VALUE +2722.
  6812     12  ER-2723                     PIC S9(4)   VALUE +2723.
  6813     12  ER-2724                     PIC S9(4)   VALUE +2724.
  6814     12  ER-2725                     PIC S9(4)   VALUE +2725.
  6815     12  ER-2726                     PIC S9(4)   VALUE +2726.
  6816     12  ER-2727                     PIC S9(4)   VALUE +2727.
  6817     12  ER-2728                     PIC S9(4)   VALUE +2728.
  6818     12  ER-2729                     PIC S9(4)   VALUE +2729.
  6819     12  ER-2730                     PIC S9(4)   VALUE +2730.
  6820     12  ER-2731                     PIC S9(4)   VALUE +2731.
  6821     12  ER-2732                     PIC S9(4)   VALUE +2732.
  6822     12  ER-2733                     PIC S9(4)   VALUE +2733.
  6823     12  ER-2734                     PIC S9(4)   VALUE +2734.
  6824     12  ER-2735                     PIC S9(4)   VALUE +2735.
  6825     12  ER-2736                     PIC S9(4)   VALUE +2736.
  6826     12  ER-2737                     PIC S9(4)   VALUE +2737.
  6827     12  ER-2738                     PIC S9(4)   VALUE +2738.
  6828     12  ER-2739                     PIC S9(4)   VALUE +2739.
  6829     12  ER-2740                     PIC S9(4)   VALUE +2740.
  6830     12  ER-2741                     PIC S9(4)   VALUE +2741.
  6831     12  ER-2742                     PIC S9(4)   VALUE +2742.
  6832     12  ER-2743                     PIC S9(4)   VALUE +2743.
  6833     12  ER-2744                     PIC S9(4)   VALUE +2744.
  6834     12  ER-2745                     PIC S9(4)   VALUE +2745.
  6835     12  ER-2746                     PIC S9(4)   VALUE +2746.
  6836     12  ER-2747                     PIC S9(4)   VALUE +2747.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 124
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6837     12  ER-2748                     PIC S9(4)   VALUE +2748.
  6838     12  ER-2749                     PIC S9(4)   VALUE +2749.
  6839     12  ER-2750                     PIC S9(4)   VALUE +2750.
  6840     12  ER-2751                     PIC S9(4)   VALUE +2751.
  6841     12  ER-2752                     PIC S9(4)   VALUE +2752.
  6842     12  ER-2753                     PIC S9(4)   VALUE +2753.
  6843     12  ER-2754                     PIC S9(4)   VALUE +2754.
  6844     12  ER-2755                     PIC S9(4)   VALUE +2755.
  6845     12  ER-2756                     PIC S9(4)   VALUE +2756.
  6846     12  ER-2757                     PIC S9(4)   VALUE +2757.
  6847     12  ER-2758                     PIC S9(4)   VALUE +2758.
  6848     12  ER-2759                     PIC S9(4)   VALUE +2759.
  6849     12  ER-2760                     PIC S9(4)   VALUE +2760.
  6850     12  ER-2761                     PIC S9(4)   VALUE +2761.
  6851     12  ER-2762                     PIC S9(4)   VALUE +2762.
  6852     12  ER-2763                     PIC S9(4)   VALUE +2763.
  6853     12  ER-2764                     PIC S9(4)   VALUE +2764.
  6854     12  ER-2765                     PIC S9(4)   VALUE +2765.
  6855     12  ER-2766                     PIC S9(4)   VALUE +2766.
  6856     12  ER-2767                     PIC S9(4)   VALUE +2767.
  6857     12  ER-2768                     PIC S9(4)   VALUE +2768.
  6858     12  ER-2769                     PIC S9(4)   VALUE +2769.
  6859     12  ER-2770                     PIC S9(4)   VALUE +2770.
  6860     12  ER-2771                     PIC S9(4)   VALUE +2771.
  6861     12  ER-2772                     PIC S9(4)   VALUE +2772.
  6862     12  ER-2773                     PIC S9(4)   VALUE +2773.
  6863     12  ER-2774                     PIC S9(4)   VALUE +2774.
  6864     12  ER-2775                     PIC S9(4)   VALUE +2775.
  6865     12  ER-2776                     PIC S9(4)   VALUE +2776.
  6866     12  ER-2777                     PIC S9(4)   VALUE +2777.
  6867     12  ER-2778                     PIC S9(4)   VALUE +2778.
  6868     12  ER-2779                     PIC S9(4)   VALUE +2779.
  6869     12  ER-2780                     PIC S9(4)   VALUE +2780.
  6870     12  ER-2781                     PIC S9(4)   VALUE +2781.
  6871     12  ER-2782                     PIC S9(4)   VALUE +2782.
  6872     12  ER-2783                     PIC S9(4)   VALUE +2783.
  6873     12  ER-2786                     PIC S9(4)   VALUE +2786.
  6874     12  ER-2787                     PIC S9(4)   VALUE +2787.
  6875     12  ER-2788                     PIC S9(4)   VALUE +2788.
  6876     12  ER-2789                     PIC S9(4)   VALUE +2789.
  6877     12  ER-2792                     PIC S9(4)   VALUE +2792.
  6878     12  ER-2793                     PIC S9(4)   VALUE +2793.
  6879     12  ER-2794                     PIC S9(4)   VALUE +2794.
  6880     12  ER-2795                     PIC S9(4)   VALUE +2795.
  6881     12  ER-2796                     PIC S9(4)   VALUE +2796.
  6882     12  ER-2798                     PIC S9(4)   VALUE +2798.
  6883     12  ER-2799                     PIC S9(4)   VALUE +2799.
  6884     12  ER-2869                     PIC S9(4)   VALUE +2869.
  6885     12  ER-2879                     PIC S9(4)   VALUE +2879.
  6886     12  ER-2881                     PIC S9(4)   VALUE +2881.
  6887     12  ER-2883                     PIC S9(4)   VALUE +2883.
  6888     12  ER-2882                     PIC S9(4)   VALUE +2882.
  6889     12  ER-2884                     PIC S9(4)   VALUE +2884.
  6890     12  ER-2885                     PIC S9(4)   VALUE +2885.
  6891     12  ER-2886                     PIC S9(4)   VALUE +2886.
  6892     12  ER-2887                     PIC S9(4)   VALUE +2887.
  6893     12  ER-2888                     PIC S9(4)   VALUE +2888.
  6894     12  ER-2889                     PIC S9(4)   VALUE +2889.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 125
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6895     12  ER-2890                     PIC S9(4)   VALUE +2890.
  6896     12  ER-2891                     PIC S9(4)   VALUE +2891.
  6897     12  ER-2892                     PIC S9(4)   VALUE +2892.
  6898     12  ER-2963                     PIC S9(4)   VALUE +2963.
  6899     12  ER-2964                     PIC S9(4)   VALUE +2964.
  6900     12  ER-2965                     PIC S9(4)   VALUE +2965.
  6901     12  ER-2969                     PIC S9(4)   VALUE +2969.
  6902     12  ER-3006                     PIC S9(4)   VALUE +3006.
  6903     12  ER-3049                     PIC S9(4)   VALUE +3049.
  6904     12  ER-3050                     PIC S9(4)   VALUE +3050.
  6905     12  ER-3052                     PIC S9(4)   VALUE +3052.
  6906     12  ER-3054                     PIC S9(4)   VALUE +3054.
  6907     12  ER-3057                     PIC S9(4)   VALUE +3057.
  6908     12  ER-3058                     PIC S9(4)   VALUE +3058.
  6909     12  ER-3780                     PIC S9(4)   VALUE +3780.
  6910     12  ER-3781                     PIC S9(4)   VALUE +3781.
  6911     12  ER-3782                     PIC S9(4)   VALUE +3782.
  6912     12  ER-3789                     PIC S9(4)   VALUE +3789.
  6913     12  ER-3790                     PIC S9(4)   VALUE +3790.
  6914     12  ER-3825                     PIC S9(4)   VALUE +3825.
  6915     12  ER-3826                     PIC S9(4)   VALUE +3826.
  6916     12  ER-3843                     PIC S9(4)   VALUE +3843.
  6917     12  ER-7812                     PIC S9(4)   VALUE +7812.
  6918     12  ER-7813                     PIC S9(4)   VALUE +7813.
  6919     12  ER-7814                     PIC S9(4)   VALUE +7814.
  6920     12  ER-7815                     PIC S9(4)   VALUE +7815.
  6921     12  ER-7816                     PIC S9(4)   VALUE +7816.
  6922     12  ER-7817                     PIC S9(4)   VALUE +7817.
  6923     12  ER-7818                     PIC S9(4)   VALUE +7818.
  6924     12  ER-7819                     PIC S9(4)   VALUE +7819.
  6925     12  ER-7820                     PIC S9(4)   VALUE +7820.
  6926     12  ER-7823                     PIC S9(4)   VALUE +7823.
  6927     12  ER-7825                     PIC S9(4)   VALUE +7825.
  6928     12  ER-8002                     PIC S9(4)   VALUE +8002.
  6929     12  ER-8030                     PIC S9(4)   VALUE +8030.
  6930     12  ER-8036                     PIC S9(4)   VALUE +8036.
  6931     12  ER-8037                     PIC S9(4)   VALUE +8037.
  6932     12  ER-8038                     PIC S9(4)   VALUE +8038.
  6933     12  ER-8039                     PIC S9(4)   VALUE +8039.
  6934     12  ER-8040                     PIC S9(4)   VALUE +8040.
  6935     12  ER-8041                     PIC S9(4)   VALUE +8041.
  6936     12  ER-8042                     PIC S9(4)   VALUE +8042.
  6937     12  ER-8043                     PIC S9(4)   VALUE +8043.
  6938     12  ER-8044                     PIC S9(4)   VALUE +8044.
  6939     12  ER-8045                     PIC S9(4)   VALUE +8045.
  6940     12  ER-8046                     PIC S9(4)   VALUE +8046.
  6941     12  ER-8050                     PIC S9(4)   VALUE +8050.
  6942     12  ER-8067                     PIC S9(4)   VALUE +8067.
  6943     12  ER-8068                     PIC S9(4)   VALUE +8068.
  6944     12  ER-8069                     PIC S9(4)   VALUE +8069.
  6945     12  ER-8070                     PIC S9(4)   VALUE +8070.
  6946     12  ER-8071                     PIC S9(4)   VALUE +8071.
  6947     12  ER-8072                     PIC S9(4)   VALUE +8072.
  6948     12  ER-8074                     PIC S9(4)   VALUE +8074.
  6949     12  ER-8075                     PIC S9(4)   VALUE +8075.
  6950     12  ER-8076                     PIC S9(4)   VALUE +8076.
  6951     12  ER-8077                     PIC S9(4)   VALUE +8077.
  6952     12  ER-8078                     PIC S9(4)   VALUE +8078.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 126
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6953     12  ER-8079                     PIC S9(4)   VALUE +8079.
  6954     12  ER-8080                     PIC S9(4)   VALUE +8080.
  6955     12  ER-8081                     PIC S9(4)   VALUE +8081.
  6956     12  ER-8082                     PIC S9(4)   VALUE +8082.
  6957     12  ER-8083                     PIC S9(4)   VALUE +8083.
  6958     12  ER-8084                     PIC S9(4)   VALUE +8084.
  6959     12  ER-8085                     PIC S9(4)   VALUE +8085.
  6960     12  ER-8086                     PIC S9(4)   VALUE +8086.
  6961     12  ER-8087                     PIC S9(4)   VALUE +8087.
  6962     12  ER-8088                     PIC S9(4)   VALUE +8088.
  6963     12  ER-8089                     PIC S9(4)   VALUE +8089.
  6964     12  ER-8090                     PIC S9(4)   VALUE +8090.
  6965     12  ER-8091                     PIC S9(4)   VALUE +8091.
  6966     12  ER-8092                     PIC S9(4)   VALUE +8092.
  6967     12  ER-8093                     PIC S9(4)   VALUE +8093.
  6968     12  ER-8094                     PIC S9(4)   VALUE +8094.
  6969     12  ER-8095                     PIC S9(4)   VALUE +8095.
  6970     12  ER-8096                     PIC S9(4)   VALUE +8096.
  6971     12  ER-8097                     PIC S9(4)   VALUE +8097.
  6972     12  ER-8098                     PIC S9(4)   VALUE +8098.
  6973     12  ER-8099                     PIC S9(4)   VALUE +8099.
  6974     12  ER-8109                     PIC S9(4)   VALUE +8109.
  6975     12  ER-8110                     PIC S9(4)   VALUE +8110.
  6976     12  ER-8111                     PIC S9(4)   VALUE +8111.
  6977     12  ER-8112                     PIC S9(4)   VALUE +8112.
  6978     12  ER-8113                     PIC S9(4)   VALUE +8113.
  6979     12  ER-8114                     PIC S9(4)   VALUE +8114.
  6980     12  ER-8116                     PIC S9(4)   VALUE +8116.
  6981     12  ER-8148                     PIC S9(4)   VALUE +8148.
  6982     12  ER-8152                     PIC S9(4)   VALUE +8152.
  6983     12  ER-8300                     PIC S9(4)   VALUE +8300.
  6984     12  ER-8301                     PIC S9(4)   VALUE +8301.
  6985     12  ER-8302                     PIC S9(4)   VALUE +8302.
  6986     12  ER-8303                     PIC S9(4)   VALUE +8303.
  6987     12  ER-8304                     PIC S9(4)   VALUE +8304.
  6988     12  ER-8310                     PIC S9(4)   VALUE +8310.
  6989     12  ER-8311                     PIC S9(4)   VALUE +8311.
  6990     12  ER-8312                     PIC S9(4)   VALUE +8312.
  6991     12  ER-8313                     PIC S9(4)   VALUE +8313.
  6992     12  ER-8314                     PIC S9(4)   VALUE +8314.
  6993     12  ER-8315                     PIC S9(4)   VALUE +8315.
  6994     12  ER-8316                     PIC S9(4)   VALUE +8316.
  6995     12  ER-8317                     PIC S9(4)   VALUE +8317.
  6996     12  ER-9236                     PIC S9(4)   VALUE +9236.
  6997     12  ER-9501                     PIC S9(4)   VALUE +9501.
  6998     12  ER-9503                     PIC S9(4)   VALUE +9503.
  6999     12  ER-9263                     PIC S9(4)   VALUE +9263.
  7000     12  ER-9999                     PIC S9(4)   VALUE +9999.
  7001******************************************************************
  7002***************   END OF ELC50WS     ****************************
  7003******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 127
* EL517.cbl
  7005 01  HOLD-WORK     PIC X(2000)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 128
* EL517.cbl
  7007*DLB001
  7008 01  WS-DLB-MASTER-POLICY-FORM.
  7009     12  DMPF-PROCESS-TYPE         PIC X.
  7010         88  DMPF-OPEN-FILES                   VALUE 'O'.
  7011         88  DMPF-REG-PROCESS                  VALUE 'P'.
  7012         88  DMPF-CLOSE-FILES                  VALUE 'C'.
  7013     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  7014     12  DMPF-RETURN-CODE          PIC XX.
  7015         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7016         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  7017         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  7018         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  7019         88  DMPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7020         88  DMPF-OPEN-ERROR                   VALUE 'Z2'.
  7021         88  DMPF-CLOSE-ERROR                  VALUE 'Z3'.
  7022
  7023*DLB002
  7024 01  WS-DLB-INTERNAL-POLICY-FORM.
  7025     12  DIPF-PROCESS-TYPE         PIC X.
  7026         88  DIPF-OPEN-FILES                   VALUE 'O'.
  7027         88  DIPF-REG-PROCESS                  VALUE 'P'.
  7028         88  DIPF-CLOSE-FILES                  VALUE 'C'.
  7029     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  7030     12  DIPF-RETURN-CODE          PIC XX.
  7031         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7032         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  7033         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  7034         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  7035         88  DIPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7036         88  DIPF-OPEN-ERROR                   VALUE 'Z2'.
  7037         88  DIPF-CLOSE-ERROR                  VALUE 'Z3'.
  7038
  7039*DLB003
  7040 01  WS-DLB-VALID-BANK-ID.
  7041     12  DVBI-PROCESS-TYPE         PIC X.
  7042         88  DVBI-OPEN-FILES                   VALUE 'O'.
  7043         88  DVBI-REG-PROCESS                  VALUE 'P'.
  7044         88  DVBI-CLOSE-FILES                  VALUE 'C'.
  7045     12  DVBI-BANK-ID              PIC X(5).
  7046     12  DVBI-BANK-ID-TYPE         PIC X.
  7047         88  DVBI-BILLING-BANK                 VALUE 'B'.
  7048         88  DVBI-PLAN-BANK                    VALUE 'P'.
  7049         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  7050         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  7051         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  7052     12  DVBI-RETURN-CODE          PIC XX.
  7053         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  7054         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  7055         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  7056         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  7057         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  7058         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  7059         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  7060         88  DVBI-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7061         88  DVBI-OPEN-ERROR                   VALUE 'Z2'.
  7062         88  DVBI-CLOSE-ERROR                  VALUE 'Z3'.
  7063
  7064*DLB007
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 129
* EL517.cbl
  7065 01  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  7066     12  DCUA-PROCESS-TYPE         PIC X.
  7067         88  DCUA-OPEN-FILES                   VALUE 'O'.
  7068         88  DCUA-REG-PROCESS                  VALUE 'P'.
  7069         88  DCUA-CLOSE-FILES                  VALUE 'C'.
  7070     12  DCUA-RES-STATE            PIC XX.
  7071     12  DCUA-BEN-TYPE             PIC XX.
  7072     12  DCUA-SYS-IDENT            PIC X.
  7073         88  DCUA-CLAIM                        VALUE 'C'.
  7074         88  DCUA-PREMIUM                      VALUE 'P'.
  7075     12  DCUA-COVERAGE-RULE        PIC X.
  7076     12  DCUA-CLIENT-ID            PIC X(10).
  7077     12  DCUA-EFF-DATE             PIC X(8).
  7078     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  7079     12  DCUA-RETURN-CODE          PIC XX.
  7080         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7081         88  DCUA-OPEN-ERROR                   VALUE 'Z2'.
  7082         88  DCUA-CLOSE-ERROR                  VALUE 'Z3'.
  7083     12  DCUA-CERT-NUMBER          PIC X(11).
  7084     12  DCUA-UNDRWRTR-CODE        PIC XX.
  7085     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  7086
  7087*DLB011
  7088 01  WS-DLB-PREM-RATES-BEN-TYPE.
  7089     12  DPRB-PROCESS-TYPE         PIC X.
  7090         88  DPRB-OPEN-FILES                   VALUE 'O'.
  7091         88  DPRB-REG-PROCESS                  VALUE 'P'.
  7092         88  DPRB-CLOSE-FILES                  VALUE 'C'.
  7093     12  DPRB-RATE-CODE            PIC X(4).
  7094     12  DPRB-COVERAGE-CATEG       PIC X.
  7095     12  DPRB-RETURN-CODE          PIC XX.
  7096         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7097         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  7098         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  7099         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  7100         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  7101         88  DPRB-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7102         88  DPRB-OPEN-ERROR                   VALUE 'Z2'.
  7103         88  DPRB-CLOSE-ERROR                  VALUE 'Z3'.
  7104     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  7105     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  7106     12  DPRB-BEN-TYPE             PIC XX.
  7107
  7108*DLB017
  7109 01  WS-DLB-VALID-RATE-CODE.
  7110     12  DVRC-PROCESS-TYPE         PIC X.
  7111         88  DVRC-OPEN-FILES                   VALUE 'O'.
  7112         88  DVRC-REG-PROCESS                  VALUE 'P'.
  7113         88  DVRC-CLOSE-FILES                  VALUE 'C'.
  7114     12  DVRC-RATE-CODE            PIC X(4).
  7115     12  DVRC-RETURN-CODE          PIC XX.
  7116         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7117         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  7118         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  7119         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  7120         88  DVRC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7121         88  DVRC-OPEN-ERROR                   VALUE 'Z2'.
  7122         88  DVRC-CLOSE-ERROR                  VALUE 'Z3'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 130
* EL517.cbl
  7123
  7124*DLB019
  7125 01  WS-DLB-ORIG-COV-CAT.
  7126     12  DOCC-PROCESS-TYPE         PIC X.
  7127         88  DOCC-OPEN-FILES                   VALUE 'O'.
  7128         88  DOCC-REG-PROCESS                  VALUE 'P'.
  7129         88  DOCC-CLOSE-FILES                  VALUE 'C'.
  7130     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  7131     12  DOCC-RETURN-CODE          PIC XX.
  7132     12  DOCC-ORIG-COV-CAT         PIC X.
  7133     12  DOCC-UNDERWRITER          PIC XX.
  7134     12  DOCC-UNDW-GROUP-CODE      PIC X.
  7135     12  DOCC-CREDIT-IND           PIC X.
  7136     12  DOCC-PRODUCT-CD           PIC XX.
  7137     12  DOCC-TERM                 PIC XXX.
  7138
  7139*DLB021
  7140 01  WS-DLB-VALID-LOAN-OFFICER.
  7141     12  DVLO-LOAN-OFFICER         PIC X(3).
  7142     12  THIS REDEFINES DVLO-LOAN-OFFICER.
  7143         16  DVLO-BILL-TYPE        PIC X.
  7144         16  DVLO-BILL-SOURCE      PIC X.
  7145         16  DVLO-BATCH-TYPE       PIC X.
  7146     12  DVLO-RETURN-CODE          PIC XX.
  7147         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  7148         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  7149         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  7150         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  7151         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  7152         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  7153
  7154*DLB022
  7155 01  WS-DLB-VALID-STATE-CODE.
  7156     12  DVSC-PROCESS-TYPE         PIC X.
  7157         88  DVSC-OPEN-FILES                   VALUE 'O'.
  7158         88  DVSC-REG-PROCESS                  VALUE 'P'.
  7159         88  DVSC-CLOSE-FILES                  VALUE 'C'.
  7160     12  DVSC-STATE-CODE           PIC XX.
  7161     12  DVSC-RETURN-CODE          PIC XX.
  7162         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7163         88  DVSC-NO-STATE-INPUT               VALUE '01'.
  7164         88  DVSC-STATE-NOT-FOUND              VALUE '02'.
  7165         88  DVSC-STATE-INACTIVE               VALUE '03'.
  7166         88  DVSC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7167         88  DVSC-OPEN-ERROR                   VALUE 'Z2'.
  7168         88  DVSC-CLOSE-ERROR                  VALUE 'Z3'.
  7169
  7170*DLB023
  7171 01  WS-DLB-VALID-CODE-VALUES.
  7172     12  DVCV-PROCESS-TYPE         PIC X.
  7173         88  DVCV-OPEN-FILES                   VALUE 'O'.
  7174         88  DVCV-REG-PROCESS                  VALUE 'P'.
  7175         88  DVCV-CLOSE-FILES                  VALUE 'C'.
  7176     12  DVCV-SYSTEM-ID            PIC XX.
  7177         88  DVCV-CLAIMS                       VALUE 'CL'.
  7178         88  DVCV-CREDIT                       VALUE 'CR'.
  7179     12  DVCV-RECORD-TYPE          PIC XX.
  7180         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 131
* EL517.cbl
  7181         88  DVCV-EOB-CODE                     VALUE 'EO'.
  7182         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  7183         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  7184         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  7185         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  7186         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  7187         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  7188     12  DVCV-RECORD-KEY           PIC X(6).
  7189     12  DVCV-RETURN-CODE          PIC XX.
  7190         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  7191         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  7192         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  7193         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  7194         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  7195         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  7196         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  7197         88  DVCV-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7198         88  DVCV-OPEN-ERROR                   VALUE 'Z2'.
  7199         88  DVCV-CLOSE-ERROR                  VALUE 'Z3'.
  7200     12  DVCV-CODE-DESC            PIC X(60).
  7201     12  DVCV-GEN-DESC-1           PIC X(20).
  7202     12  DVCV-GEN-DESC-2           PIC X(20).
  7203     12  DVCV-GEN-DESC-3           PIC X(20).
  7204
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 132
* EL517.cbl
  7206
  7207 01  PARMLIST.
  7208     02  ELCNTL-POINTER            PIC S9(4)  COMP VALUE +0.
  7209     02  ERACCT-POINTER            PIC S9(4)  COMP VALUE +0.
  7210     02  ERCTBL-POINTER            PIC S9(4)  COMP VALUE +0.
  7211**9/17/98: COMMENT OUT ERPLAN-POINTER.  NO LONGER USED BY LOGIC.
  7212**
  7213**   02  ERPLAN-POINTER            PIC S9(4)  COMP VALUE +0.
  7214     02  ERFORM-POINTER            PIC S9(4)  COMP VALUE +0.
  7215
  7216 01  PLAN-RECORDS.
  7217     12  LINK-LIFE-PLAN-RECORD    PIC X(420) VALUE SPACES.
  7218     12  LINK-AH-PLAN-RECORD      PIC X(420) VALUE SPACES.
  7219
* 7220                                  COPY ELCDATE.
  7221******************************************************************06/11/98
  7222*                                                                *ELCDATE
  7223*                                                                *ELCDATE
  7224*                            ELCDATE.                            *   LV023
  7225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  7226*                            VMOD=2.003                           ELCDATE
  7227*                                                                *ELCDATE
  7228*                                                                *ELCDATE
  7229*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  7230*                 LENGTH = 200                                   *   CL*19
  7231******************************************************************ELCDATE
  7232                                                                  ELCDATE
  7233 01  DATE-CONVERSION-DATA.                                        ELCDATE
  7234     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  7235     12  DC-OPTION-CODE                PIC X.                        CL*15
  7236         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  7237         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  7238         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  7239         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  7240         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  7241         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  7242         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  7243         88  FIND-CENTURY               VALUE '7'.                   CL*22
  7244         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  7245         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  7246         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  7247         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  7248         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  7249         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  7250         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  7251         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  7252         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  7253         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  7254         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  7255         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  7256         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  7257         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  7258         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  7259         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  7260         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  7261         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  7262         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  7263         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 133
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7264         88  THREE-CHARACTER-BIN                                  ELCDATE
  7265                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  7266         88  GREGORIAN-TO-BIN                                        CL**2
  7267                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  7268         88  BIN-TO-GREGORIAN                                        CL**2
  7269                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  7270         88  JULIAN-TO-BINARY                                        CL**2
  7271                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  7272     12  DC-ERROR-CODE                 PIC X.                        CL*15
  7273         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  7274         88  DATE-CONVERSION-ERROR                                ELCDATE
  7275                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  7276         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  7277         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  7278         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  7279         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  7280         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  7281         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  7282         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  7283         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  7284         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  7285         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  7286     12  DC-END-OF-MONTH               PIC X.                        CL*15
  7287         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  7288     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  7289         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  7290         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  7291         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  7292     12  FILLER                        PIC X.                        CL*15
  7293     12  DC-CONVERSION-DATES.                                        CL*15
  7294         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  7295         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  7296         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  7297         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  7298                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  7299             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  7300             20  SLASH1-1              PIC X.                        CL*15
  7301             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  7302             20  SLASH1-2              PIC X.                        CL*15
  7303             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  7304         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  7305         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  7306                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  7307             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  7308             20  SLASH2-1              PIC X.                        CL*15
  7309             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  7310             20  SLASH2-2              PIC X.                        CL*15
  7311             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  7312         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  7313         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  7314                     DC-GREG-DATE-1-YMD.                          ELCDATE
  7315             20  DC-YMD-YEAR           PIC 99.                       CL*15
  7316             20  DC-YMD-MONTH          PIC 99.                       CL*15
  7317             20  DC-YMD-DAY            PIC 99.                       CL*15
  7318         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  7319         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  7320                      DC-GREG-DATE-1-MDY.                         ELCDATE
  7321             20  DC-MDY-MONTH          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 134
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7322             20  DC-MDY-DAY            PIC 99.                       CL*15
  7323             20  DC-MDY-YEAR           PIC 99.                       CL*15
  7324         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  7325             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  7326             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  7327             20  FILLER                PIC XX.                       CL*15
  7328             20  DC-ALPHA-CENTURY.                                   CL*15
  7329                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  7330             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  7331         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  7332         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  7333         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  7334         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  7335         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  7336                                       PIC 9(05).                    CL*20
  7337         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  7338             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  7339             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  7340         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  7341         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  7342         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  7343     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  7344         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  7345         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  7346             20  FILLER                PIC 9(3).                     CL*15
  7347             20  HOLD-CEN-1-CCYY.                                    CL*15
  7348                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  7349                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  7350             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  7351             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  7352         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  7353             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  7354             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  7355             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  7356                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  7357                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  7358             20  FILLER                PIC 9(3).                     CL*15
  7359         16  HOLD-CENTURY-1-X.                                       CL*15
  7360             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  7361             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  7362                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  7363                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  7364             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  7365             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  7366         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  7367             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  7368             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  7369             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  7370                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  7371                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  7372             20  FILLER                PIC XXX.                      CL*23
  7373         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  7374         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  7375         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  7376         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  7377             20  DC-JULIAN-1-CCYY.                                   CL*15
  7378                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  7379                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 135
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7380             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  7381         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  7382         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  7383             20  DC-JULIAN-2-CCYY.                                   CL*15
  7384                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  7385                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  7386             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  7387         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  7388             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  7389             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  7390             20  DC-EDITA-DAY          PIC 99.                       CL*15
  7391             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  7392             20  DC-EDITA-CCYY.                                      CL*15
  7393                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  7394                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  7395         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  7396             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  7397             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  7398             20  DC-EDITB-DAY          PIC 99.                       CL*15
  7399             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  7400             20  DC-EDITB-CCYY.                                      CL*15
  7401                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  7402                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  7403         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  7404         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  7405                              DC-GREG-DATE-CYMD.                  ELCDATE
  7406             20  DC-CYMD-CEN           PIC 99.                       CL*15
  7407             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  7408             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  7409             20  DC-CYMD-DAY           PIC 99.                       CL*15
  7410         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  7411         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  7412                              DC-GREG-DATE-MDCY.                  ELCDATE
  7413             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  7414             20  DC-MDCY-DAY           PIC 99.                       CL*15
  7415             20  DC-MDCY-CEN           PIC 99.                       CL*15
  7416             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  7417    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  7418        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  7419    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  7420    12  FILLER                         PIC X(28).                    CL*26
  7421
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 136
* EL517.cbl
* 7423                                  COPY ELCCALC.
  7424******************************************************************04/15/98
  7425*                                                                *ELCCALC
  7426*                           ELCCALC.                            *    LV003
  7427*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7428*                            VMOD=2.025                          *   CL**3
  7429*                                                                *   CL**2
  7430*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  7431*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  7432*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  7433*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  7434*                                                                *   CL**2
  7435*  PASSED TO ELRTRM                                              *   CL**2
  7436*  -----------------                                             *   CL**2
  7437*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  7438*  ORIGINAL TERM                                                 *   CL**2
  7439*  BEGINNING DATE                                                *   CL**2
  7440*  ENDING DATE                                                   *   CL**2
  7441*  COMPANY I.D.                                                  *   CL**2
  7442*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  7443*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  7444*  FREE LOOK DAYS                                                *   CL**2
  7445*                                                                *   CL**2
  7446*  RETURNED FROM ELRTRM                                          *   CL**2
  7447*  ---------------------                                         *   CL**2
  7448*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  7449*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  7450*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  7451*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  7452*----------------------------------------------------------------*   CL**2
  7453*  PASSED TO ELRAMT                                              *   CL**2
  7454*  ----------------                                              *   CL**2
  7455*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  7456*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7457*  ORIGINAL AMOUNT                                               *   CL**2
  7458*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  7459*  A.P.R. - NET PAY ONLY                                         *   CL**2
  7460*  METHOD                                                            CL**2
  7461*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  7462*  COMPANY I.D.                                                  *   CL**2
  7463*  BENEFIT TYPE                                                  *   CL**2
  7464*                                                                *   CL**2
  7465*  RETURNED FROM ELRAMT                                          *   CL**2
  7466*  --------------------                                          *   CL**2
  7467*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  7468*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  7469*  REMAINING AMOUNT FACTOR                                           CL**2
  7470*----------------------------------------------------------------*   CL**2
  7471*  PASSED TO ELRESV                                              *   CL**2
  7472*  -----------------                                             *   CL**2
  7473*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  7474*  VALUATION DATE                                                *   CL**2
  7475*  PAID THRU DATE                                                *   CL**2
  7476*  BENEFIT                                                       *   CL**2
  7477*  INCURRED DATE                                                 *   CL**2
  7478*  REPORTED DATE                                                 *   CL**2
  7479*  ISSUE AGE                                                     *   CL**2
  7480*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 137
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7481*  CDT PERCENT                                                   *   CL**2
  7482*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  7483* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  7484* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  7485* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  7486*                                                                *   CL**2
  7487*  RETURNED FROM ELRESV                                          *   CL**2
  7488*  --------------------                                          *   CL**2
  7489*  CDT TABLE USED                                                *   CL**2
  7490*  CDT FACTOR USED                                               *   CL**2
  7491*  PAY TO CURRENT RESERVE                                        *   CL**2
  7492*  I.B.N.R. - A/H ONLY                                           *   CL**2
  7493*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  7494*----------------------------------------------------------------*   CL**2
  7495*  PASSED TO ELRATE                                              *   CL**2
  7496*  ----------------                                              *   CL**2
  7497*  CERT ISSUE DATE                                               *   CL**2
  7498*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7499*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7500*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  7501*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7502*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7503*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7504*  DEVIATION CODE                                                *   CL**2
  7505*  ISSUE AGE                                                     *   CL**2
  7506*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7507*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7508*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  7509*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7510*  A.P.R.                                                        *   CL**2
  7511*  METHOD                                                            CL**2
  7512*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7513*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7514*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7515*  BENEFIT CODE                                                  *   CL**2
  7516*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7517*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  7518*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  7519*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  7520*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  7521*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  7522*                                                                *   CL**2
  7523*  RETURNED FROM ELRATE                                          *   CL**2
  7524*  --------------------                                          *   CL**2
  7525*  CALCULATED PREMIUM                                            *   CL**2
  7526*  PREMIUM RATE                                                  *   CL**2
  7527*  MORTALITY CODE                                                *   CL**2
  7528*  MAX ATTAINED AGE                                              *   CL**2
  7529*  MAX AGE                                                       *   CL**2
  7530*  MAX TERM                                                      *   CL**2
  7531*  MAX MONTHLY BENEFIT                                           *   CL**2
  7532*  MAX TOTAL BENIFIT                                             *   CL**2
  7533*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  7534*----------------------------------------------------------------*   CL**2
  7535*  PASSED TO ELRFND                                              *   CL**2
  7536*  ----------------                                              *   CL**2
  7537*  CERT ISSUE DATE                                               *   CL**2
  7538*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 138
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7539*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7540*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7541*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7542*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7543*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7544*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7545*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7546*  DEVIATION CODE                                                *   CL**2
  7547*  ISSUE AGE                                                     *   CL**2
  7548*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7549*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7550*  PROCESS TYPE (CANCEL)                                         *   CL**2
  7551*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7552*  A.P.R.                                                        *   CL**2
  7553*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  7554*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  7555*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7556*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7557*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7558*  BENEFIT CODE                                                  *   CL**2
  7559*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7560*                                                                *   CL**2
  7561*  RETURNED FROM ELRFND                                          *   CL**2
  7562*  --------------------                                          *   CL**2
  7563*  CALCULATED REFUND                                             *   CL**2
  7564*----------------------------------------------------------------*   CL**2
  7565*  PASSED TO ELEARN                                              *   CL**2
  7566*  ----------------                                              *   CL**2
  7567*  CERT ISSUE DATE                                               *   CL**2
  7568*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7569*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7570*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7571*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7572*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7573*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7574*  DEVIATION CODE                                                *   CL**2
  7575*  ISSUE AGE                                                     *   CL**2
  7576*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7577*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7578*  A.P.R.                                                        *   CL**2
  7579*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  7580*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7581*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7582*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7583*  BENEFIT CODE                                                  *   CL**2
  7584*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7585*                                                                *   CL**2
  7586*  RETURNED FROM ELEARN                                          *   CL**2
  7587*  --------------------                                          *   CL**2
  7588*  INDICATED  EARNINGS                                           *   CL**2
  7589*----------------------------------------------------------------*   CL**2
  7590*                 LENGTH = 450                                   *   CL**2
  7591*                                                                *   CL**2
  7592******************************************************************   CL**2
  7593******************************************************************
  7594*                   C H A N G E   L O G
  7595*
  7596* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 139
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7597*-----------------------------------------------------------------
  7598*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7599* EFFECTIVE    NUMBER
  7600*-----------------------------------------------------------------
  7601* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  7602* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7603* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  7604* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  7605* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  7606* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7607* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  7608* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  7609* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7610******************************************************************
  7611                                                                     CL**2
  7612 01  CALCULATION-PASS-AREA.                                          CL**2
  7613     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  7614                                     COMP.                           CL**2
  7615                                                                     CL**2
  7616     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  7617       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  7618       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  7619                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  7620       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  7621       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  7622       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  7623       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  7624       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  7625       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  7626       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  7627       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  7628       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  7629       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  7630       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  7631       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  7632       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  7633       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  7634       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  7635       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  7636       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  7637                                                                     CL**2
  7638     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  7639       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  7640***********************  INPUT AREAS ****************************    CL**2
  7641                                                                     CL**2
  7642     12  CP-CALCULATION-AREA.                                        CL**2
  7643         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  7644         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  7645         16  CP-VALUATION-DT       PIC XX.                           CL**2
  7646         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  7647         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  7648           88  CP-AH                               VALUE 'A' 'D'     CL**2
  7649                                                   'I' 'U'.          CL**2
  7650           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  7651           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  7652         16  CP-INCURRED-DT        PIC XX.                           CL**2
  7653         16  CP-REPORTED-DT        PIC XX.                           CL**2
  7654         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 140
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7655         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  7656         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  7657                                     COMP-3.                         CL**2
  7658         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  7659                                     COMP-3.                         CL**2
  7660         16  CP-CDT-METHOD         PIC X.                            CL**2
  7661           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  7662           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  7663           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  7664         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  7665           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  7666           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  7667         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  7668                                     COMP-3.                         CL**2
  7669         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  7670                                     COMP-3.                         CL**2
  7671         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  7672                                     COMP-3.                         CL**2
  7673         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  7674                                     COMP-3.                         CL**2
  7675         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7676                                     COMP-3.                         CL**2
  7677         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  7678                                     COMP-3.                         CL**2
  7679         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  7680                                     COMP-3.                         CL**2
  7681         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  7682           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  7683           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  7684           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  7685           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  7686           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  7687           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  7688           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  7689         16  CP-EARNING-METHOD     PIC X.                            CL**2
  7690           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  7691           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  7692           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7693           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7694           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7695           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7696           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  7697           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7698           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  7699           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7700           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  7701           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  7702           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  7703           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  7704         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  7705           88  CP-CLAIM                            VALUE '1'.        CL**2
  7706           88  CP-CANCEL                           VALUE '2'.        CL**2
  7707           88  CP-ISSUE                            VALUE '3'.        CL**2
  7708         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  7709           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  7710           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  7711           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  7712           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 141
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7713           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  7714           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  7715           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  7716           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  7717           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  7718           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  7719           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  7720           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  7721           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  7722           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  7723           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  7724           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  7725           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  7726           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  7727                                                     'W' 'X'.        CL**2
  7728           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  7729           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  7730           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  7731           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  7732           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  7733           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  7734           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  7735           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  7736           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  7737           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  7738           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  7739           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  7740           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  7741                                                                     CL**2
  7742         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  7743                                     COMP-3.                         CL**2
  7744         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  7745         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  7746         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  7747         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  7748         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  7749           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  7750               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  7751         16  CP-R78-OPTION         PIC X.                            CL**2
  7752           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  7753           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  7754                                                                     CL**2
  7755         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  7756         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  7757         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  7758         16  CP-RATE-FILE          PIC X.                            CL**2
  7759         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  7760                                     COMP-3.                         CL**2
  7761                                                                     CL**2
  7762         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  7763         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  7764                                                                     CL**2
  7765         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  7766                                     COMP-3.
  7767         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  7768                                   PIC S9(5)V99 COMP-3.
  7769         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  7770                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 142
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7771         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7772                                     COMP-3.                         CL**2
  7773         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  7774                                     COMP-3.
  7775         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  7776                                  PIC S9(7)V99 COMP-3.
  7777                                                                     CL**2
  7778         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  7779         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  7780         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  7781           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  7782           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  7783           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  7784           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  7785         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  7786         16  CP-CARRIER            PIC X.                            CL**2
  7787         16  CP-REIN-FLAG          PIC X.                            CL**2
  7788         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  7789           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  7790                      '2' '3' '4' '5'.                               CL**2
  7791           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  7792           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  7793           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  7794           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  7795           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  7796           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  7797           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  7798           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  7799         16  CP-SIG-SWITCH         PIC X.                            CL**2
  7800         16  CP-RATING-METHOD      PIC X.                            CL**2
  7801           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  7802           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  7803           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7804           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7805           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7806           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7807           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  7808           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7809           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7810         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  7811                                     COMP-3.                         CL**2
  7812         16  CP-BEN-CATEGORY       PIC X.
  7813         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7814         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  7815                                   PIC S99V9(5) COMP-3.
  7816         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7817         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  7818                                   PIC S99V9(5) COMP-3.
  7819         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  7820         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  7821         16  CP-EXPIRE-DT          PIC XX.
  7822         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  7823         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  7824         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  7825         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  7826         16  CP-DDF-SPEC-CALC      PIC X.
  7827             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  7828             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 143
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7829         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  7830         16  CP-CANCEL-REASON      PIC X.
  7831         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  7832         16  CP-PMT-MODE           PIC X.
  7833         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  7834         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  7835         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  7836         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  7837         16  FILLER                PIC X.
  7838                                                                     CL**2
  7839***************    OUTPUT FROM ELRESV   ************************     CL**2
  7840                                                                     CL**2
  7841         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  7842                                                                     CL**2
  7843         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  7844                                     COMP-3.                         CL**2
  7845         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  7846                                     COMP-3.                         CL**2
  7847         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  7848                                     COMP-3.                         CL**2
  7849         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  7850                                     COMP-3.                         CL**2
  7851         16  FILLER                PIC X(09).                        CL**2
  7852***************    OUTPUT FROM ELRTRM   *************************    CL**2
  7853                                                                     CL**2
  7854         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  7855                                     COMP-3.                         CL**2
  7856         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  7857                                     COMP-3.                         CL**2
  7858         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  7859                                     COMP-3.                         CL**2
  7860         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  7861                                     COMP-3.                         CL**2
  7862         16  FILLER                PIC X(12).                        CL**2
  7863                                                                     CL**2
  7864***************    OUTPUT FROM ELRAMT   *************************    CL**2
  7865                                                                     CL**2
  7866         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  7867                                     COMP-3.                         CL**2
  7868         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  7869                                     COMP-3.                         CL**2
  7870         16  FILLER                PIC X(12).                        CL**2
  7871                                                                     CL**2
  7872***************    OUTPUT FROM ELRATE   *************************    CL**2
  7873                                                                     CL**2
  7874         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  7875                                     COMP-3.                         CL**2
  7876         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  7877                                     COMP-3.                         CL**2
  7878         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  7879         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  7880             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  7881         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  7882                                     COMP-3.                         CL**2
  7883         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  7884         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  7885         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  7886                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 144
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7887         16  FILLER                PIC X(07).                        CL**2
  7888                                                                     CL**2
  7889***************    OUTPUT FROM ELRFND   *************************    CL**2
  7890                                                                     CL**2
  7891         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  7892                                     COMP-3.                         CL**2
  7893         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  7894           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  7895           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  7896           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  7897           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  7898           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7899           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  7900           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  7901           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  7902           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7903           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  7904           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  7905           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  7906           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  7907           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  7908         16  FILLER                PIC X(12).                        CL**2
  7909                                                                     CL**2
  7910***************    OUTPUT FROM ELEARN   *************************    CL**2
  7911                                                                     CL**2
  7912         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  7913                                     COMP-3.                         CL**2
  7914         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  7915                                     COMP-3.                         CL**2
  7916         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  7917                                     COMP-3.                         CL**2
  7918         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  7919                                     COMP-3.                         CL**2
  7920         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  7921                                     COMP-3.                         CL**2
  7922         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  7923                                     COMP-3.                         CL**2
  7924         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  7925           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  7926           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  7927           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  7928           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  7929           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7930           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  7931           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  7932           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  7933           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7934         16  FILLER                PIC X(12).                        CL**2
  7935                                                                     CL**2
  7936***************    OUTPUT FROM ELPMNT   *************************    CL**2
  7937                                                                     CL**2
  7938         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  7939                                     COMP-3.                         CL**2
  7940         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  7941                                     COMP-3.                         CL**2
  7942         16  FILLER                PIC X(12).                        CL**2
  7943                                                                     CL**2
  7944***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 145
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7945         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  7946                                     COMP-3.                         CL**2
  7947         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  7948                                     COMP-3.                         CL**2
  7949         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  7950                                     COMP-3.                         CL**2
  7951         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  7952                                     COMP-3.                         CL**2
  7953         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7954                                     COMP-3.                         CL**2
  7955         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7956                                     COMP-3.                         CL**2
  7957         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  7958             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  7959             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  7960             88  IO-ERROR                         VALUE 'E'.         CL**2
  7961                                                                     CL**2
  7962         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  7963                                                                     CL**2
  7964         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  7965                                                                     CL**2
  7966         16  CP-RESERVE-REMAINING-TERM                               CL**2
  7967                                   PIC S9(4)V9    VALUE ZERO         CL**2
  7968                                     COMP-3.                         CL**2
  7969                                                                     CL**2
  7970         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  7971                                                                     CL**2
  7972         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  7973                                     COMP-3.                         CL**2
  7974                                                                     CL**2
  7975         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  7976                                     COMP-3.                         CL**2
  7977                                                                     CL**2
  7978         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  7979                                     COMP-3.                         CL**2
  7980                                                                     CL**2
  7981         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  7982                                     COMP-3.                         CL**2
  7983                                                                     CL**2
  7984         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  7985                                     COMP-3.                         CL**2
  7986                                                                     CL**2
  7987         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  7988                                     COMP-3.                         CL**2
  7989                                                                     CL**2
  7990         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  7991                                     COMP-3.                         CL**2
  7992                                                                     CL**2
  7993         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  7994             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  7995                                                                     CL**2
  7996         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  7997                                     COMP-3.                         CL**2
  7998         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  7999                                     COMP-3.
  8000         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  8001         16  FILLER                PIC X(15).                        CL**2
  8002******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 146
* EL517.cbl
  8003
* 8004                                  COPY ELCDTECX.
  8005******************************************************************06/05/98
  8006*                                                                *ELCDTECX
  8007*                            ELCDTECX.                           *   LV005
  8008*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8009*                            VMOD=2.015                          *ELCDTECX
  8010*                                                                *ELCDTECX
  8011*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  8012*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  8013*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  8014*                                                                *ELCDTECX
  8015******************************************************************ELCDTECX
  8016******************************************************************
  8017*                   C H A N G E   L O G
  8018*
  8019* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8020*-----------------------------------------------------------------
  8021*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8022* EFFECTIVE    NUMBER
  8023*-----------------------------------------------------------------
  8024* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  8025*                                  BENEFIT CODES FROM 300 TO 900
  8026* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  8027* 051304    2003080800002  SMVA  ADD REFUND METHOD
  8028******************************************************************
  8029 01  DATE-CARD.                                                   ELCDTECX
  8030     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  8031     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  8032     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  8033     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  8034     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  8035     12  EP-SW                       PIC  X.                      ELCDTECX
  8036         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  8037     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  8038         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  8039     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  8040     12  RUN-CENTURY.                                             ELCDTECX
  8041         16 RUN-CENTURY-N            PIC  99.                        CL**4
  8042     12  FILLER                      PIC  X.                         CL**4
  8043     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  8044     12  FILLER                      PIC  XXX.                    ELCDTECX
  8045     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  8046                                                                  ELCDTECX
  8047 01  FILLER                          PIC  X(7)                       CL**6
  8048                                          VALUE 'OPTIONS'.        ELCDTECX
  8049 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  8050     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  8051     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  8052     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  8053         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  8054         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  8055     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  8056     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  8057     12  FILLER                      PIC  X.                      ELCDTECX
  8058     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  8059     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  8060     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 147
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8061     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  8062     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  8063     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  8064     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  8065     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  8066     12  FILLER                      PIC  X.                      ELCDTECX
  8067     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  8068     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  8069     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  8070     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  8071     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  8072     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  8073     12  FILLER                      PIC  X.                      ELCDTECX
  8074     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  8075     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  8076     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  8077     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  8078     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  8079     12  DTE-R78                     PIC  X.                      ELCDTECX
  8080     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  8081     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  8082     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  8083     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  8084     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  8085     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  8086     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  8087                                     PIC  X.                      ELCDTECX
  8088         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  8089                                                 ' '.             ELCDTECX
  8090         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  8091         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  8092     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  8093         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  8094         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  8095     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  8096     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  8097                                     PIC  9.                         CL**4
  8098     12  DTE-SYSTEM.                                              ELCDTECX
  8099         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  8100         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  8101         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  8102         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  8103         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  8104         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  8105         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  8106         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  8107         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  8108         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  8109         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  8110         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  8111         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  8112         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  8113         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  8114         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  8115         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  8116         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  8117         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  8118         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 148
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8119         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  8120         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  8121         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  8122         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  8123         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  8124         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  8125     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  8126         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  8127                                     PIC  X.                      ELCDTECX
  8128     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  8129                                                                  ELCDTECX
  8130 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  8131     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  8132     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  8133     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  8134*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  8135     12  FILLER                      PIC  X.                      ELCDTECX
  8136     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  8137     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  8138     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  8139     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  8140     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  8141     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  8142     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  8143                                                                  ELCDTECX
  8144     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  8145     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  8146     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  8147     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  8148                                                                  ELCDTECX
  8149     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  8150     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  8151     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  8152     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  8153                                                                  ELCDTECX
  8154     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  8155     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  8156                                                                  ELCDTECX
  8157     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  8158     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  8159                                                                  ELCDTECX
  8160     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  8161                                                                  ELCDTECX
  8162 01  DATE-CARD-FACTORS.                                           ELCDTECX
  8163     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  8164     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  8165     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  8166     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  8167     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  8168     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  8169     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  8170                                                                  ELCDTECX
  8171 01  FILLER                          PIC  X(12)                   ELCDTECX
  8172                                          VALUE 'COMPANY NAME'.   ELCDTECX
  8173 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  8174     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  8175         16  CNT-ID                  PIC  X.                      ELCDTECX
  8176         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 149
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8177                                                                  ELCDTECX
  8178 01  FILLER                          PIC  X(11)                   ELCDTECX
  8179                                          VALUE 'STATE NAMES'.    ELCDTECX
  8180 01  STATE-NAMES.                                                 ELCDTECX
  8181     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  8182         16  STATE-SUB               PIC  XX.                     ELCDTECX
  8183         16  STATE-PIC1.                                          ELCDTECX
  8184             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  8185             20  FILLER              PIC  XXX.                    ELCDTECX
  8186             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  8187             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  8188             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  8189             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  8190                                                                  ELCDTECX
  8191 01  FILLER                          PIC  X(13)                   ELCDTECX
  8192                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  8193 01  CARRIER-NAMES.                                               ELCDTECX
  8194     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  8195         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  8196         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  8197         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  8198         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8199         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8200         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8201*        16  FILLER                  PIC  X.                      ELCDTECX
  8202         16  CARRIER-SEC-PAY         PIC  X.
  8203             88  SEC-PAY-CARRIER          VALUE 'Y'.
  8204                                                                  ELCDTECX
  8205 01  FILLER                          PIC  X(9)                       CL**6
  8206                                          VALUE 'INS TYPES'.      ELCDTECX
  8207 01  CLAS-INS-TYPES.                                              ELCDTECX
  8208*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  8209     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  8210         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  8211         16  CLAS-I-AB3.                                          ELCDTECX
  8212             20  FILLER              PIC  X.                      ELCDTECX
  8213             20  CLAS-I-AB2.                                      ELCDTECX
  8214                 24  FILLER          PIC  X.                      ELCDTECX
  8215                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  8216         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  8217             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  8218             20  FILLER              PIC  X.                         CL**4
  8219         16  CLAS-I-AB10.                                         ELCDTECX
  8220             20  FILLER              PIC  X(9).                   ELCDTECX
  8221             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  8222         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  8223         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  8224         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  8225         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  8226             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  8227         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  8228         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  8229         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  8230         16  CLAS-I-BEN-CATEGORY     PIC  X.
  8231         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  8232         16  FILLER                  PIC  X(05).
  8233                                                                  ELCDTECX
  8234 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 150
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8235                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  8236 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  8237     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  8238                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  8239         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  8240         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  8241         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  8242         16  CLAS-MORT-DESC.                                      ELCDTECX
  8243             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  8244             20  FILLER              PIC  XX.                        CL**5
  8245             20  CLAS-YEAR           PIC  X(4).                      CL**6
  8246             20  FILLER              PIC  X.                         CL**5
  8247             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  8248             20  FILLER              PIC  X.                         CL**5
  8249             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  8250             20  FILLER              PIC  X.                         CL**5
  8251             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  8252             20  FILLER              PIC  X(5).                      CL**6
  8253                                                                  ELCDTECX
  8254 01  FILLER                          PIC  X(15)                   ELCDTECX
  8255                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  8256 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  8257     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  8258         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  8259         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  8260         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  8261         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  8262         16  FILLER                  PIC  X(4).                      CL**6
  8263                                                                  ELCDTECX
  8264 01  FILLER                          PIC  X(7)                       CL**6
  8265                                     VALUE 'INDEXES'.             ELCDTECX
  8266 01  CLAS-INDEX-TBL.                                              ELCDTECX
  8267     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  8268     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  8269     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  8270     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  8271     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  8272     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  8273     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  8274     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  8275     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  8276     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  8277     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  8278     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  8279     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  8280     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  8281     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  8282     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  8283     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  8284                                                                  ELCDTECX
  8285 01  CLAS-TYPE-MISC.                                              ELCDTECX
  8286     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  8287     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  8288     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  8289     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  8290     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  8291     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  8292     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 151
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8293     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  8294     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  8295     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  8296     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  8297                                                                  ELCDTECX
  8298 01  FILLER                          PIC  X(13)                   ELCDTECX
  8299                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  8300 01  CLAS-MISC.                                                   ELCDTECX
  8301     12  DTE-FICH                    PIC  X.                      ELCDTECX
  8302         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  8303         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  8304         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  8305     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  8306     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  8307     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  8308     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  8309     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  8310     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  8311     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  8312     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  8313     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  8314     12  STATE-L                     PIC  XX.                     ELCDTECX
  8315     12  CLAS-CN                     PIC  99.                     ELCDTECX
  8316     12  CLAS-CO                     PIC  99.                     ELCDTECX
  8317     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  8318         16  DTE-F-1                 PIC  X.                      ELCDTECX
  8319         16  DTE-F-2                 PIC  X.                      ELCDTECX
  8320     12  DTE-ABEND-WORK.                                          ELCDTECX
  8321         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  8322         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  8323                                                                  ELCDTECX
  8324 01  FILLER                          PIC  X(12)                   ELCDTECX
  8325                                     VALUE 'WORKING DATE'.        ELCDTECX
  8326 01  WS-DATE-AND-TIME.                                            ELCDTECX
  8327     12  WS-ACCEPT-DATE.                                          ELCDTECX
  8328         16  WS-AD-YY                PIC  99.                     ELCDTECX
  8329         16  WS-AD-MM                PIC  99.                     ELCDTECX
  8330         16  WS-AD-DD                PIC  99.                     ELCDTECX
  8331     12  WS-CURRENT-DATE.                                         ELCDTECX
  8332         16  WS-CD-MM                PIC  99.                     ELCDTECX
  8333         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8334         16  WS-CD-DD                PIC  99.                     ELCDTECX
  8335         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8336         16  WS-CD-YY                PIC  99.                     ELCDTECX
  8337     12  WS-TIME-OF-DAY.                                          ELCDTECX
  8338         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  8339         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  8340                                                                  ELCDTECX
  8341 01  FILLER                          PIC  X(12)                   ELCDTECX
  8342                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  8343 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  8344     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  8345         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  8346         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  8347         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  8348                                                                  ELCDTECX
  8349 01  FILLER                          PIC  X(10)                   ELCDTECX
  8350                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 152
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8351 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  8352     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  8353         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  8354         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  8355                                                                  ELCDTECX
  8356 01  FILLER                          PIC  X(13)                   ELCDTECX
  8357                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  8358 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  8359     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  8360         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  8361                                                                  ELCDTECX
  8362 01  FILLER                          PIC  X(13)                   ELCDTECX
  8363                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  8364 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  8365     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  8366     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  8367     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  8368                                     PIC  X.                         CL**5
  8369     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  8370     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  8371     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  8372     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  8373     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  8374     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  8375     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  8376     12  FILLER                      PIC  X(75).                  ELCDTECX
  8377******************************************************************ELCDTECX
  8378*01  MISC-CARR-PCT-DATA.                                          00001521
  8379*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8380*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8381*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8382*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8383*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8384*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8385******************************************************************ELCDTECX
  8386
* 8387                                  COPY ELCDTEVR.
  8388***************************************************************** 04/15/98
  8389*                                                                *ELCDTEVR
  8390*                                                                *ELCDTEVR
  8391*                            ELCDTEVR.                           *   LV003
  8392*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8393*                            VMOD=2.001                          *   CL**2
  8394*                                                                *ELCDTEVR
  8395*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  8396*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  8397*                                                                *ELCDTEVR
  8398******************************************************************ELCDTEVR
  8399 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  8400     05  WS-RUN-DATE.                                             ELCDTEVR
  8401         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8402         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  8403         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  8404             15  RUN-CC              PIC  99.                     ELCDTEVR
  8405             15  RUN-YR              PIC  99.                     ELCDTEVR
  8406         10  RUN-MO                  PIC  99.                     ELCDTEVR
  8407         10  RUN-DA                  PIC  99.                     ELCDTEVR
  8408     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 153
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8409            WS-RUN-DATE              PIC 9(11).                      CL**2
  8410     05  WS-EP-DT.                                                ELCDTEVR
  8411         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8412         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  8413         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  8414             15  EP-CC               PIC  99.                     ELCDTEVR
  8415             15  EP-YR               PIC  99.                     ELCDTEVR
  8416         10  EP-MO                   PIC  99.                     ELCDTEVR
  8417         10  EP-DA                   PIC  99.                     ELCDTEVR
  8418     05  WS-EP-DT-N REDEFINES                                        CL**2
  8419            WS-EP-DT                 PIC 9(11).                      CL**2
  8420     05  WS-DTE-CONV-DT.                                             CL**4
  8421         10  FILLER                  PIC  9(03).                     CL**4
  8422         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  8423         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  8424             15  DTE-CONV-CC         PIC  99.                        CL**4
  8425             15  DTE-CONV-YR         PIC  99.                        CL**4
  8426         10  DTE-CONV-MO             PIC  99.                        CL**4
  8427         10  DTE-CONV-DA             PIC  99.                        CL**4
  8428     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  8429            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  8430 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  8431     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  8432         10  FILLER                            PIC 999.           ELCDTEVR
  8433         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  8434         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  8435             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  8436             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  8437         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  8438         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  8439     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  8440            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  8441     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  8442         10  FILLER                            PIC 999.           ELCDTEVR
  8443         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  8444         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  8445         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  8446         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  8447     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  8448            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  8449 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  8450     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  8451         10  FILLER                            PIC 999.           ELCDTEVR
  8452         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  8453         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  8454             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  8455             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  8456         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  8457         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  8458     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  8459            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  8460     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  8461         10  FILLER                            PIC 999.           ELCDTEVR
  8462         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  8463         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  8464             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  8465             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  8466         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 154
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8467         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  8468     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  8469            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  8470     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  8471         10  FILLER                            PIC 999.           ELCDTEVR
  8472         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  8473         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  8474             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  8475             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  8476         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  8477         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  8478     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  8479            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  8480 01  WS-RATE-RECORD.                                              ELCDTEVR
  8481         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  8482             10  FILLER                        PIC 999.           ELCDTEVR
  8483             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  8484             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  8485                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  8486                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  8487             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  8488             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  8489         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  8490                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  8491
* 8492                                  COPY ELCREINV.
  8493******************************************************************04/18/98
  8494*                                                                *ELCREINV
  8495*                                                                *ELCREINV
  8496*                            ELCREINV                            *   LV003
  8497*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8498*                            VMOD=2.001                          *ELCREINV
  8499*                                                                *ELCREINV
  8500*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  8501*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  8502*                                                                *ELCREINV
  8503******************************************************************ELCREINV
  8504                                                                  ELCREINV
  8505 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  8506     05  WS-RE-LO-DATE.                                              CL**3
  8507         10 FILLER                     PIC 999.                      CL**3
  8508         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  8509         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  8510            15 RE-LO-CC                PIC 99.                       CL**3
  8511            15 RE-LO-YR                PIC 99.                       CL**3
  8512         10 RE-LO-MO                   PIC 99.                       CL**3
  8513         10 RE-LO-DA                   PIC 99.                       CL**3
  8514     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  8515            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  8516     05  WS-RE-HI-DATE.                                              CL**3
  8517         10 FILLER                     PIC 999.                      CL**3
  8518         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  8519         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  8520            15 RE-HI-CC                PIC 99.                       CL**3
  8521            15 RE-HI-YR                PIC 99.                       CL**3
  8522         10 RE-HI-MO                   PIC 99.                       CL**3
  8523         10 RE-HI-DA                   PIC 99.                       CL**3
  8524     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 155
* EL517.cbl (/apps/prod/cid1p/copy/ELCREINV)
  8525            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  8526     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  8527         10 FILLER                     PIC 999.                   ELCREINV
  8528         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  8529         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  8530            15 RE-CLM-CC               PIC 99.                    ELCREINV
  8531            15 RE-CLM-YR               PIC 99.                    ELCREINV
  8532         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  8533         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  8534     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  8535            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  8536     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  8537         10  FILLER                    PIC 999.                   ELCREINV
  8538         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  8539         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  8540             15  RE-EARN-CC            PIC 99.                    ELCREINV
  8541             15  RE-EARN-YR            PIC 99.                    ELCREINV
  8542         10  RE-EARN-MO                PIC 99.                    ELCREINV
  8543         10  RE-EARN-DA                PIC 99.                    ELCREINV
  8544     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  8545            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  8546     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  8547         10  FILLER                    PIC 999.                   ELCREINV
  8548         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  8549         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  8550             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  8551             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  8552         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  8553         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  8554     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  8555            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  8556
* 8557                                  COPY ELCACCTV.
  8558******************************************************************04/14/98
  8559*                                                                *ELCACCTV
  8560*                            ELCACCTV                            *   LV002
  8561*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8562*                            VMOD=2.001                          *ELCACCTV
  8563*                                                                *ELCACCTV
  8564*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  8565*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  8566*                                                                *ELCACCTV
  8567*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  8568*                                                                *ELCACCTV
  8569******************************************************************ELCACCTV
  8570                                                                  ELCACCTV
  8571 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  8572                                                                  ELCACCTV
  8573     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  8574         10  FILLER            PIC 999.                           ELCACCTV
  8575         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  8576         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  8577             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  8578             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  8579         10  AM-EXP-MO         PIC 99.                               CL**5
  8580         10  AM-EXP-DA         PIC 99.                               CL**5
  8581     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  8582            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 156
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8583     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  8584         10  FILLER                    PIC 999.                   ELCACCTV
  8585         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  8586         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  8587             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  8588             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  8589         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  8590         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  8591     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  8592            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  8593     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  8594         10  FILLER                    PIC 999.                   ELCACCTV
  8595         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  8596         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  8597             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  8598             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  8599         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  8600         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  8601     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  8602            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  8603     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  8604         10 FILLER                     PIC 999.                   ELCACCTV
  8605         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  8606         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  8607            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  8608            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  8609         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  8610         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  8611     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  8612            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  8613     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  8614         10 FILLER                     PIC 999.                   ELCACCTV
  8615         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  8616         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  8617            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  8618            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  8619         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  8620         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  8621     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  8622            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  8623     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  8624         10  FILLER                    PIC 999.                   ELCACCTV
  8625         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  8626         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  8627             15  AM-AN-CC              PIC 99.                    ELCACCTV
  8628             15  AM-AN-YR              PIC 99.                    ELCACCTV
  8629         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  8630         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  8631     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  8632            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  8633     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  8634         10  FILLER                    PIC 999.                   ELCACCTV
  8635         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  8636         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  8637             15  AM-HI-CC              PIC 99.                    ELCACCTV
  8638             15  AM-HI-YR              PIC 99.                    ELCACCTV
  8639         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  8640         10  AM-HI-DA                  PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 157
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8641     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  8642            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  8643     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  8644         10  FILLER                    PIC 999.                   ELCACCTV
  8645         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  8646         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  8647             15  AM-LO-CC              PIC 99.                    ELCACCTV
  8648             15  AM-LO-YR              PIC 99.                    ELCACCTV
  8649         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  8650         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  8651     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  8652            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  8653     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  8654         10  FILLER                    PIC 999.                   ELCACCTV
  8655         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  8656         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  8657             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  8658             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  8659         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  8660         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  8661     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  8662            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 158
* EL517.cbl
* 8664                                  COPY ELCDIFRD.
  8665******************************************************************04/15/98
  8666*                                                                *ELCDIFRD
  8667*                                                                *ELCDIFRD
  8668*                            ELCDIFRD.                           *   LV003
  8669*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8670*                            VMOD=2.004                          *   CL**3
  8671*                                                                *ELCDIFRD
  8672*   WORKING STORAGE FOR REFUND DIFFERENCES                       *ELCDIFRD
  8673*                                                                *ELCDIFRD
  8674******************************************************************ELCDIFRD
  8675*                                                                 ELCDIFRD
  8676  01  WS-DIFFERENCE-CALCULATION.                                  ELCDIFRD
  8677        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8678        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8679        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8680        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8681        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8682        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8683        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8684        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8685        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8686        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8687        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 159
* EL517.cbl
* 8689                                  COPY ELCERRWS.
  8690******************************************************************04/15/98
  8691*                                                                *ELCERRWS
  8692*                                                                *ELCERRWS
  8693*                            ELCERRWS                            *   LV002
  8694*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8695*                            VMOD=2.005                          *   CL**2
  8696*                                                                *ELCERRWS
  8697*                                                                *ELCERRWS
  8698*    WORKING STORAGE FOR ERROR MESSAGES ROUTINE ELCERRPD         *ELCERRWS
  8699*                                                                *ELCERRWS
  8700******************************************************************ELCERRWS
  8701                                                                  ELCERRWS
  8702 01  W-ERROR-WORK.                                                ELCERRWS
  8703     12  E-CLIENT-ID             PIC X(03)   VALUE SPACES.        ELCERRWS
  8704     12  CLIENT-ABL              PIC X(03)   VALUE 'ABL'.         ELCERRWS
  8705     12  CLIENT-AIG              PIC X(03)   VALUE 'AIG'.         ELCERRWS
  8706     12  CLIENT-AUK              PIC X(03)   VALUE 'AUK'.         ELCERRWS
  8707     12  CLIENT-CIG              PIC X(03)   VALUE 'CIG'.         ELCERRWS
  8708     12  CLIENT-CUK              PIC X(03)   VALUE 'CUK'.         ELCERRWS
  8709     12  CLIENT-LAP              PIC X(03)   VALUE 'LAP'.         ELCERRWS
  8710     12  CLIENT-NCB              PIC X(03)   VALUE 'NCB'.         ELCERRWS
  8711     12  CLIENT-TIC              PIC X(03)   VALUE 'TIC'.         ELCERRWS
  8712     12  CLIENT-TMS              PIC X(03)   VALUE 'TMS'.         ELCERRWS
  8713     12  CLIENT-LBL              PIC X(03)   VALUE 'LBL'.         ELCERRWS
  8714     12  CLIENT-HAN              PIC X(03)   VALUE 'HAN'.         ELCERRWS
  8715     12  CLIENT-JHL              PIC X(03)   VALUE 'JHL'.         ELCERRWS
  8716     12  CLIENT-HER              PIC X(03)   VALUE 'HER'.         ELCERRWS
  8717     12  CLIENT-NCX              PIC X(03)   VALUE 'NCX'.         ELCERRWS
  8718     12  CLIENT-DCC              PIC X(03)   VALUE 'DCC'.
  8719     12  CLIENT-CID              PIC X(03)   VALUE 'CID'.
  8720                                                                  ELCERRWS
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 160
* EL517.cbl
  8722
  8723 PROCEDURE DIVISION.
  8724
  8725 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  8726******************************************************************04/15/98
  8727*                                                                *ELCDTERX
  8728*                                                                *ELCDTERX
  8729*                            ELCDTERX.                           *   LV002
  8730*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8731*                            VMOD=2.007                          *ELCDTERX
  8732*                                                                *ELCDTERX
  8733*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  8734*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  8735*      = ELCDTEFD)                                               *ELCDTERX
  8736*                                                                *ELCDTERX
  8737******************************************************************ELCDTERX
  8738                                                                  ELCDTERX
  8739     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  8740                                                                  ELCDTERX
  8741     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  8742     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  8743     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  8744                                                                  ELCDTERX
  8745     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  8746                                                                  ELCDTERX
  8747******************************************************************ELCDTERX
  8748*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  8749*          WARNING MESSAGES.                                      ELCDTERX
  8750******************************************************************ELCDTERX
  8751     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  8752         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  8753                                                                  ELCDTERX
  8754     OPEN INPUT DISK-DATE.                                        ELCDTERX
  8755                                                                  ELCDTERX
  8756     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  8757                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  8758                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  8759                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  8760                   CLAX-ID           CLAS-MISC                    ELCDTERX
  8761                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  8762                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  8763                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  8764                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  8765                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  8766                                                                  ELCDTERX
  8767     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  8768                                                                  ELCDTERX
  8769     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  8770                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  8771                                                                  ELCDTERX
  8772     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  8773     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  8774     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  8775     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  8776                                                                  ELCDTERX
  8777     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  8778         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 161
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8779     ELSE                                                         ELCDTERX
  8780         ADD +1                 TO CLAS-CN.                       ELCDTERX
  8781                                                                  ELCDTERX
  8782     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  8783         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  8784     ELSE                                                         ELCDTERX
  8785         ADD +1                 TO CLAS-CO.                       ELCDTERX
  8786                                                                  ELCDTERX
  8787 0005-READ--CARD.                                                 ELCDTERX
  8788     READ DISK-DATE                                               ELCDTERX
  8789         AT END CLOSE DISK-DATE                                   ELCDTERX
  8790             GO TO 0060-READ--TEST.                               ELCDTERX
  8791                                                                  ELCDTERX
  8792     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  8793                                                                  ELCDTERX
  8794     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  8795         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  8796         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  8797         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  8798         GO TO 0005-READ--CARD.                                   ELCDTERX
  8799                                                                  ELCDTERX
  8800     IF DD-ID = 'CLAD'                                            ELCDTERX
  8801         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  8802         GO TO 0005-READ--CARD.                                   ELCDTERX
  8803                                                                  ELCDTERX
  8804     IF DD-ID = 'CLAX'                                            ELCDTERX
  8805         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  8806         GO TO 0005-READ--CARD.                                   ELCDTERX
  8807                                                                  ELCDTERX
  8808     IF DD-ID = 'CLAF'                                            ELCDTERX
  8809         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  8810         GO TO 0005-READ--CARD.                                   ELCDTERX
  8811                                                                  ELCDTERX
  8812     IF DD-ID = 'CLAC'                                            ELCDTERX
  8813         GO TO 0010-READ--CLAC.                                   ELCDTERX
  8814                                                                  ELCDTERX
  8815     IF DD-ID = 'CARR'                                            ELCDTERX
  8816         GO TO 0015-READ--CARR.                                   ELCDTERX
  8817                                                                  ELCDTERX
  8818     IF DD-ID = 'STAT'                                            ELCDTERX
  8819         GO TO 0020-READ--STAT.                                   ELCDTERX
  8820                                                                  ELCDTERX
  8821     IF DD-ID = 'BUSC'                                            ELCDTERX
  8822         GO TO 0025-READ--BUSC.                                   ELCDTERX
  8823                                                                  ELCDTERX
  8824     IF DD-ID = 'MORT'                                            ELCDTERX
  8825         GO TO 0030-READ--MORT.                                   ELCDTERX
  8826                                                                  ELCDTERX
  8827     IF DD-ID = 'CLAI'                                            ELCDTERX
  8828         GO TO 0040-READ--CLAI.                                   ELCDTERX
  8829                                                                  ELCDTERX
  8830     IF DD-ID = 'COLC'                                            ELCDTERX
  8831         GO TO 0065-READ--COLC.                                   ELCDTERX
  8832                                                                  ELCDTERX
  8833     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8834        DD-IDA = 'CL'                                             ELCDTERX
  8835         GO TO 0035-READ--CLXX.                                   ELCDTERX
  8836                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 162
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8837     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8838        DD-IDA = 'PO'                                             ELCDTERX
  8839         GO TO 0050-READ--POXX.                                   ELCDTERX
  8840                                                                  ELCDTERX
  8841     IF DD-ID = 'OPCA'                                            ELCDTERX
  8842         GO TO 0070-READ--OPCA.                                   ELCDTERX
  8843                                                                  ELCDTERX
  8844     IF DD-ID = 'OPST'                                            ELCDTERX
  8845         GO TO 0072-READ--OPST.                                   ELCDTERX
  8846                                                                  ELCDTERX
  8847     IF DD-ID = 'OPBS'                                            ELCDTERX
  8848         GO TO 0074-READ--OPBS.                                   ELCDTERX
  8849                                                                  ELCDTERX
  8850     IF DD-ID = 'OPMS'                                            ELCDTERX
  8851         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  8852                                                                  ELCDTERX
  8853     GO TO 0005-READ--CARD.                                       ELCDTERX
  8854                                                                  ELCDTERX
  8855 0010-READ--CLAC.                                                 ELCDTERX
  8856     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8857     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8858     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8859     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8860     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8861     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8862     GO TO 0005-READ--CARD.                                       ELCDTERX
  8863                                                                  ELCDTERX
  8864 0015-READ--CARR.                                                 ELCDTERX
  8865     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8866     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8867        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  8868        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8869        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  8870        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8871        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8872        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8873        MOVE DD-CARR1-SECPAY-SW
  8874                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8875     END-IF
  8876                                                                  ELCDTERX
  8877     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8878     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8879        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  8880        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8881        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  8882        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8883        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8884        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8885        MOVE DD-CARR2-SECPAY-SW
  8886                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8887     END-IF
  8888                                                                  ELCDTERX
  8889                                                                  ELCDTERX
  8890     GO TO 0005-READ--CARD.                                       ELCDTERX
  8891                                                                  ELCDTERX
  8892 0020-READ--STAT.                                                 ELCDTERX
  8893     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8894     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 163
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8895        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8896         GO TO 0005-READ--CARD.                                   ELCDTERX
  8897                                                                  ELCDTERX
  8898     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  8899     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  8900     GO TO 0020-READ--STAT.                                       ELCDTERX
  8901                                                                  ELCDTERX
  8902 0025-READ--BUSC.                                                 ELCDTERX
  8903     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8904     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  8905        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8906         GO TO 0005-READ--CARD.                                   ELCDTERX
  8907                                                                  ELCDTERX
  8908     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  8909     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  8910     GO TO 0025-READ--BUSC.                                       ELCDTERX
  8911                                                                  ELCDTERX
  8912 0030-READ--MORT.                                                 ELCDTERX
  8913     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8914     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8915        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  8916         GO TO 0005-READ--CARD.                                   ELCDTERX
  8917                                                                  ELCDTERX
  8918     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  8919     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  8920     GO TO 0030-READ--MORT.                                       ELCDTERX
  8921                                                                  ELCDTERX
  8922 0035-READ--CLXX.                                                 ELCDTERX
  8923     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  8924          GO TO 0005-READ--CARD.                                  ELCDTERX
  8925                                                                  ELCDTERX
  8926     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  8927         DISPLAY '***********************************************'ELCDTERX
  8928         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  8929         DISPLAY '***********************************************'ELCDTERX
  8930         GO TO 0055-READ--STOP.                                   ELCDTERX
  8931                                                                  ELCDTERX
  8932     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  8933        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  8934         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  8935                                                                  ELCDTERX
  8936     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  8937        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  8938         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  8939                                                                  ELCDTERX
  8940*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  8941     GO TO 0005-READ--CARD.                                       ELCDTERX
  8942                                                                  ELCDTERX
  8943 0040-READ--CLAI.                                                 ELCDTERX
  8944     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8945     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8946        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  8947         GO TO 0005-READ--CARD.                                   ELCDTERX
  8948                                                                  ELCDTERX
  8949     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  8950     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  8951     GO TO 0040-READ--CLAI.                                       ELCDTERX
  8952                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 164
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8953 0045-READ--DUMP.                                                 ELCDTERX
  8954     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  8955     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  8956                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  8957     PERFORM ABEND-PGM.                                           ELCDTERX
  8958                                                                  ELCDTERX
  8959 0050-READ--POXX.                                                 ELCDTERX
  8960     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  8961         GO TO 0005-READ--CARD.                                   ELCDTERX
  8962                                                                  ELCDTERX
  8963     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  8964         DISPLAY '***********************************************'ELCDTERX
  8965         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  8966         DISPLAY '***********************************************'ELCDTERX
  8967         GO TO 0055-READ--STOP.                                   ELCDTERX
  8968                                                                  ELCDTERX
  8969     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  8970     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  8971     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  8972     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  8973                                                                  ELCDTERX
  8974     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  8975         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  8976     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  8977         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  8978                                                                  ELCDTERX
  8979     GO TO 0005-READ--CARD.                                       ELCDTERX
  8980                                                                  ELCDTERX
  8981 0055-READ--STOP.                                                 ELCDTERX
  8982     GOBACK.                                                      ELCDTERX
  8983                                                                  ELCDTERX
  8984 0060-READ--TEST.                                                 ELCDTERX
  8985     IF DATX-COD        = SPACE  OR                               ELCDTERX
  8986        CLAX-ID         = SPACE  OR                               ELCDTERX
  8987        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  8988         GO TO 0045-READ--DUMP.                                   ELCDTERX
  8989                                                                  ELCDTERX
  8990     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  8991     GO TO 0079-READ--EXIT.                                       ELCDTERX
  8992                                                                  ELCDTERX
  8993 0065-READ--COLC.                                                 ELCDTERX
  8994     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  8995     GO TO 0005-READ--CARD.                                       ELCDTERX
  8996                                                                  ELCDTERX
  8997 0070-READ--OPCA.                                                 ELCDTERX
  8998                                                                  ELCDTERX
  8999     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9000                                                                  ELCDTERX
  9001     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  9002             OR                                                   ELCDTERX
  9003         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  9004         GO TO 0005-READ--CARD.                                   ELCDTERX
  9005                                                                  ELCDTERX
  9006     ADD 1                       TO INDEXCA.                      ELCDTERX
  9007     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  9008                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  9009     GO TO 0070-READ--OPCA.                                       ELCDTERX
  9010                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 165
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  9011 0072-READ--OPST.                                                 ELCDTERX
  9012                                                                  ELCDTERX
  9013     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9014                                                                  ELCDTERX
  9015     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  9016             OR                                                   ELCDTERX
  9017         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9018         GO TO 0005-READ--CARD.                                   ELCDTERX
  9019                                                                  ELCDTERX
  9020     ADD 1                       TO INDEXST.                      ELCDTERX
  9021     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  9022                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  9023     GO TO 0072-READ--OPST.                                       ELCDTERX
  9024                                                                  ELCDTERX
  9025 0074-READ--OPBS.                                                 ELCDTERX
  9026                                                                  ELCDTERX
  9027     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9028                                                                  ELCDTERX
  9029     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  9030             OR                                                   ELCDTERX
  9031         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9032         GO TO 0005-READ--CARD.                                   ELCDTERX
  9033                                                                  ELCDTERX
  9034     ADD 1                       TO INDEXBS.                      ELCDTERX
  9035     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  9036     GO TO 0074-READ--OPBS.                                       ELCDTERX
  9037                                                                  ELCDTERX
  9038 0079-READ--EXIT.                                                 ELCDTERX
  9039*    EXIT.                                                        ELCDTERX
  9040******************************************************************ELCDTERX
  9041
  9042     MOVE DTE-CLIENT TO E-CLIENT-ID.
  9043
  9044     MOVE WS-CD-YY               TO DC-MDY-YEAR.
  9045     MOVE WS-CD-DD               TO DC-MDY-DAY.
  9046     MOVE WS-CD-MM               TO DC-MDY-MONTH.
  9047
  9048     MOVE 4                      TO DC-OPTION-CODE.
  9049     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9050     MOVE DC-JULIAN-DATE         TO EIBDATE.
  9051     MOVE LOW-VALUES             TO WK-RECORD-ADDRESSES.
  9052     MOVE WORK-AREAS             TO HOLD-WORK.
  9053
  9054     IF DTE-PRC-OPT = '2'
  9055         MOVE 'FULL FILE EDIT' TO ER-ONLY.
  9056
  9057     OPEN INPUT ELCNTL.
  9058     IF ELCNTL-FILE-STATUS   = '00' OR '97'
  9059         NEXT SENTENCE
  9060       ELSE
  9061         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9062         MOVE 'ELCNTL'           TO WS-FEM-FILE-NAME
  9063         MOVE EMSG               TO WS-ABEND-MESSAGE
  9064         GO TO ABEND-PGM.
  9065
  9066     OPEN  I-O ERPNDB.
  9067     IF ERPNDB-FILE-STATUS   = '00' OR '97'
  9068         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 166
* EL517.cbl
  9069       ELSE
  9070         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9071         MOVE 'ERPNDB'           TO WS-FEM-FILE-NAME
  9072         MOVE EMSG               TO WS-ABEND-MESSAGE
  9073         GO TO ABEND-PGM.
  9074
  9075     MOVE LOW-VALUES            TO PB-CONTROL-PRIMARY.
  9076     MOVE DTE-CLASIC-COMPANY-CD TO PB-COMPANY-CD.
  9077
  9078     START ERPNDB KEY NOT LESS THAN PB-CONTROL-PRIMARY.
  9079
  9080     IF ERPNDB-FILE-STATUS NOT = '00'
  9081         GO TO 9999-DONE.
  9082
  9083     OPEN INPUT ERREIN.
  9084     IF ERREIN-FILE-STATUS   = '00' OR '97'
  9085         NEXT SENTENCE
  9086       ELSE
  9087         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9088         MOVE 'ERREIN'           TO WS-FEM-FILE-NAME
  9089         MOVE EMSG               TO WS-ABEND-MESSAGE
  9090         GO TO ABEND-PGM.
  9091
  9092     IF DTE-CLIENT = 'DCC'
  9093        OPEN INPUT ERPDEF ELSTAT
  9094        IF ERPDEF-FILE-STATUS   = '00' OR '97'
  9095           CONTINUE
  9096        ELSE
  9097           MOVE ERPDEF-FILE-STATUS
  9098                                 TO WS-ABEND-FILE-STATUS
  9099           MOVE 'ERPDEF'         TO WS-FEM-FILE-NAME
  9100           MOVE EMSG             TO WS-ABEND-MESSAGE
  9101           GO TO ABEND-PGM
  9102        END-IF
  9103        IF ELSTAT-FILE-STATUS   = '00' OR '97'
  9104           CONTINUE
  9105        ELSE
  9106           MOVE ELSTAT-FILE-STATUS
  9107                                 TO WS-ABEND-FILE-STATUS
  9108           MOVE 'ELSTAT'         TO WS-FEM-FILE-NAME
  9109           MOVE EMSG             TO WS-ABEND-MESSAGE
  9110           GO TO ABEND-PGM
  9111        END-IF
  9112     END-IF
  9113
  9114     OPEN I-O   ELCERT.
  9115******************************************************************
  9116*                                                                *
  9117*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  9118*    REVIEW AND CORRRECTION SUB-SYSTEM.                          *
  9119*                                                                *
  9120*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  9121*                                                                *
  9122*               EL631 - EL6311 - EL6312 - EL6313                 *
  9123*                                                                *
  9124******************************************************************
  9125
  9126     IF ELCERT-FILE-STATUS  = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 167
* EL517.cbl
  9127         NEXT SENTENCE
  9128       ELSE
  9129         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9130         MOVE 'ELCERT'              TO WS-FEM-FILE-NAME
  9131         MOVE EMSG                  TO WS-ABEND-MESSAGE
  9132         GO TO ABEND-PGM.
  9133
  9134     OPEN INPUT ERCTBL.
  9135     IF ERCTBL-FILE-STATUS   = '00' OR '97'
  9136         NEXT SENTENCE
  9137       ELSE
  9138         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9139         MOVE 'ERCTBL'           TO WS-FEM-FILE-NAME
  9140         MOVE EMSG               TO WS-ABEND-MESSAGE
  9141         GO TO ABEND-PGM.
  9142
  9143     OPEN INPUT ERACCT.
  9144     IF ERACCT-FILE-STATUS   = '00' OR '97'
  9145         NEXT SENTENCE
  9146       ELSE
  9147         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9148         MOVE 'ERACCT'           TO WS-FEM-FILE-NAME
  9149         MOVE EMSG               TO WS-ABEND-MESSAGE
  9150         GO TO ABEND-PGM.
  9151
  9152     OPEN INPUT ERCOMP.
  9153     IF ERCOMP-FILE-STATUS   = '00' OR '97'
  9154         NEXT SENTENCE
  9155       ELSE
  9156         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9157         MOVE 'ERCOMP'           TO WS-FEM-FILE-NAME
  9158         MOVE EMSG               TO WS-ABEND-MESSAGE
  9159         GO TO ABEND-PGM.
  9160
  9161     OPEN INPUT ERLOFC
  9162     IF ERLOFC-FILE-STATUS   = '00' OR '97'
  9163        CONTINUE
  9164     ELSE
  9165        MOVE ERLOFC-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9166        MOVE 'ERLOFC'            TO WS-FEM-FILE-NAME
  9167        MOVE EMSG                TO WS-ABEND-MESSAGE
  9168        GO TO ABEND-PGM
  9169     END-IF
  9170
  9171     OPEN INPUT ERBXRF.
  9172     IF ERBXRF-FILE-STATUS   = '00' OR '97'
  9173         NEXT SENTENCE
  9174       ELSE
  9175         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9176         MOVE 'ERBXRF'           TO WS-FEM-FILE-NAME
  9177         MOVE EMSG               TO WS-ABEND-MESSAGE
  9178         GO TO ABEND-PGM.
  9179
  9180     OPEN INPUT ERAGTC.
  9181     IF ERAGTC-FILE-STATUS   = '00' OR '97'
  9182         NEXT SENTENCE
  9183       ELSE
  9184         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 168
* EL517.cbl
  9185         MOVE 'ERAGTC'           TO WS-FEM-FILE-NAME
  9186         MOVE EMSG               TO WS-ABEND-MESSAGE
  9187         GO TO ABEND-PGM.
  9188
  9189     OPEN INPUT ERPLAN.
  9190     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  9191        NEXT SENTENCE
  9192     ELSE
  9193        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9194        MOVE 'ERPLAN '           TO WS-FEM-FILE-NAME
  9195        MOVE EMSG                TO WS-ABEND-MESSAGE
  9196        GO TO ABEND-PGM.
  9197
  9198     OPEN INPUT ERFORM.
  9199     IF ERFORM-FILE-STATUS  = '00' OR '97' OR '9+'
  9200        OR '9%'
  9201        NEXT SENTENCE
  9202     ELSE
  9203        MOVE ERFORM-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9204        MOVE 'ERFORM '           TO WS-FEM-FILE-NAME
  9205        MOVE EMSG                TO WS-ABEND-MESSAGE
  9206        GO TO ABEND-PGM.
  9207
  9208     OPEN INPUT ELCERR.
  9209     IF ELCERR-FILE-STATUS   = '00' OR '97'
  9210         NEXT SENTENCE
  9211       ELSE
  9212         MOVE ELCERR-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9213         MOVE 'ELCERR'           TO WS-FEM-FILE-NAME
  9214         MOVE EMSG               TO WS-ABEND-MESSAGE
  9215         GO TO ABEND-PGM.
  9216
  9217     MOVE 'R'                     TO CP-RATE-FILE.
  9218     MOVE 'O'                     TO CP-IO-FUNCTION.
  9219     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9220
  9221     IF IO-ERROR
  9222        MOVE SPACE                TO WS-ABEND-FILE-STATUS
  9223        MOVE 'ELRATE'             TO WS-FEM-FILE-NAME
  9224        MOVE EMSG                 TO WS-ABEND-MESSAGE
  9225        GO TO ABEND-PGM.
  9226
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 169
* EL517.cbl
  9228*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  9229*
  9230     IF DTE-CLIENT NOT = 'DMD'
  9231         GO TO 0100-READ-PENDING.
  9232
  9233     OPEN INPUT ERRESS ERRESC.
  9234
  9235     IF ERRESS-FILE-STATUS   = '00' OR '97'
  9236         NEXT SENTENCE
  9237     ELSE
  9238         MOVE ERRESS-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9239         MOVE 'ERRESS'           TO WS-FEM-FILE-NAME
  9240         MOVE EMSG               TO WS-ABEND-MESSAGE
  9241         GO TO ABEND-PGM.
  9242
  9243     IF ERRESC-FILE-STATUS   = '00' OR '97'
  9244         NEXT SENTENCE
  9245     ELSE
  9246         MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9247         MOVE 'ERRESC'           TO WS-FEM-FILE-NAME
  9248         MOVE EMSG               TO WS-ABEND-MESSAGE
  9249         GO TO ABEND-PGM.
  9250
  9251     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
  9252     MOVE 'O'                    TO DMPF-PROCESS-TYPE.
  9253     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
  9254     IF DMPF-RETURN-CODE EQUAL 'Z2'
  9255         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9256         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
  9257         MOVE EMSG               TO WS-ABEND-MESSAGE
  9258         GO TO ABEND-PGM.
  9259
  9260     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
  9261     MOVE 'O'                    TO DIPF-PROCESS-TYPE.
  9262     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
  9263     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9264         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9265         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
  9266         MOVE EMSG               TO WS-ABEND-MESSAGE
  9267         GO TO ABEND-PGM.
  9268
  9269     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
  9270     MOVE 'O'                    TO DVBI-PROCESS-TYPE.
  9271     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
  9272     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9273         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9274         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
  9275         MOVE EMSG               TO WS-ABEND-MESSAGE
  9276         GO TO ABEND-PGM.
  9277
  9278     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9279     MOVE 'O'                    TO DCUA-PROCESS-TYPE.
  9280     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9281     IF DCUA-RETURN-CODE EQUAL 'Z2'
  9282         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9283         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
  9284         MOVE EMSG               TO WS-ABEND-MESSAGE
  9285         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 170
* EL517.cbl
  9286
  9287     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
  9288     MOVE 'O'                    TO DPRB-PROCESS-TYPE.
  9289     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
  9290     IF DPRB-RETURN-CODE EQUAL 'Z2'
  9291         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9292         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
  9293         MOVE EMSG               TO WS-ABEND-MESSAGE
  9294         GO TO ABEND-PGM.
  9295
  9296     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
  9297     MOVE 'O'                    TO DVRC-PROCESS-TYPE.
  9298     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
  9299     IF DVRC-RETURN-CODE EQUAL 'Z2'
  9300         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9301         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
  9302         MOVE EMSG               TO WS-ABEND-MESSAGE
  9303         GO TO ABEND-PGM.
  9304
  9305     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
  9306     MOVE 'O'                    TO DVSC-PROCESS-TYPE.
  9307     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
  9308     IF DVSC-RETURN-CODE EQUAL 'Z2'
  9309         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9310         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
  9311         MOVE EMSG               TO WS-ABEND-MESSAGE
  9312         GO TO ABEND-PGM.
  9313
  9314*
  9315*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  9316*
  9317 0100-READ-PENDING.
  9318
  9319     MOVE HOLD-WORK TO WORK-AREAS.
  9320
  9321     MOVE ZEROS                  TO EMI-WARNING-CTR
  9322                                    EMI-FORCABLE-CTR
  9323                                    EMI-FATAL-CTR.
  9324 0101-READ-PENDING.
  9325     READ ERPNDB.
  9326     ADD 1 TO RPND.
  9327
  9328     IF DTE-CLASIC-COMPANY-CD NOT = PB-COMPANY-CD-A1
  9329         GO TO 9999-DONE.
  9330
  9331     IF ERPNDB-FILE-STATUS NOT = '00'
  9332         GO TO 9999-DONE.
  9333
  9334     MOVE LIFE-OVERRIDE-L1       TO PB-LIFE-OVERRIDE-L1.
  9335     MOVE AH-OVERRIDE-L1         TO PB-AH-OVERRIDE-L1.
  9336     MOVE PB-ENTRY-BATCH         TO WK-BATCH-NO.
  9337
  9338     IF PB-BATCH-TRAILER
  9339         GO TO 9999-REWRITE-RECORD.
  9340
  9341     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  9342        GO TO 0100-READ-PENDING.
  9343
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 171
* EL517.cbl
  9344     IF PB-BILLED-DT NOT EQUAL LOW-VALUES
  9345        PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9346        GO TO 0100-READ-PENDING.
  9347
  9348     IF WK-BATCH-PREFIX = '#CL'
  9349        GO TO 0100-READ-PENDING.
  9350
  9351     IF DTE-PRC-OPT = '2'
  9352         NEXT SENTENCE
  9353     ELSE
  9354         IF NOT PB-FATAL-ERRORS
  9355             PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9356             GO TO 0100-READ-PENDING.
  9357
  9358     ADD 1 TO TRAN-CT.
  9359
  9361 0000-PROCEDURE-DIV.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 172
* EL517.cbl
*                           COPY ELC50PD.
  9362******************************************************************04/22/98
  9363*                                                                *ELC50PD
  9364*                            ELC50PD                             *   LV012
  9365*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
  9366*                            VMOD=2.188                          *   CL**7
  9367*                                                                *ELC50PD
  9368******************************************************************
  9369*                   C H A N G E   L O G
  9370*
  9371* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9372*-----------------------------------------------------------------
  9373*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9374* EFFECTIVE    NUMBER
  9375*-----------------------------------------------------------------
  9376* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  9377* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  9378* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  9379*                             2709 AND 2718
  9380* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  9381* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  9382* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  9383* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  9384* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  9385*                                IS OPEN OR CNC DT < PD THRU
  9386* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  9387* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  9388* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  9389* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  9390* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  9391* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  9392* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  9393* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
  9394* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  9395* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  9396* 020906                   PEMA  EXPAND LOAN OFFICER
  9397* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  9398* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  9399* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  9400* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  9401* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  9402* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  9403* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  9404* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  9405* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  9406* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  9407* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  9408* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  9409* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  9410* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  9411* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  9412* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  9413* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  9414* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  9415* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  9416* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST PMT
  9417* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUMS
  9418* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 173
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9419* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  9420* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  9421* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  9422*                                UPDATE VIN ON CERT TRAILER
  9423* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  9424* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISAB ONLY
  9425* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  9426* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  9427* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9428* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  9429* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONLY
  9430* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  9431* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  9432* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  9433* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  9434* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  9435* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  9436* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  9437* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  9438* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  9439* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  9440* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  9441* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  9442* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  9443* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  9444* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  9445* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  9446* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9447* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  9448* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  9449* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  9450* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  9451* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  9452* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  9453* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  9454* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  9455* 032912  CR2011110200001  PEMA  AHL CHANGES
  9456* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  9457* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  9458* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  9459* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  9460* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  9461* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  9462* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  9463* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  9464* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  9465* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  9466* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  9467* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  9468* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  9469* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  9470* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  9471******************************************************************ELC50PD
  9472************* PROCEDURE DIVISION FOR EL050 & EL517 ***************ELC50PD
  9473******************************************************************ELC50PD
  9474                                                                  ELC50PD
  9475     INITIALIZE  WS-CRI-SSN-WORK-AREA.                            ELC50PD
  9476                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 174
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9477     MOVE SPACES                 TO PB-FATAL-FLAG                 ELC50PD
  9478                                    PB-FORCE-ER-CD                ELC50PD
  9479                                    PB-WARN-ER-CD                 ELC50PD
  9480                                    PB-OUT-BAL-CD.                ELC50PD
  9481                                                                  ELC50PD
  9482     MOVE SPACE                  TO WS-IG-OVRD-AH                 ELC50PD
  9483                                    WS-IG-OVRD-LF                 ELC50PD
  9484                                    WS-IG-OVRD-AM                 ELC50PD
  9485                                    WS-IG-OVRD                    ELC50PD
  9486                                    WS-IG-OVRD-AH-PL              ELC50PD
  9487                                    WS-IG-OVRD-LF-PL              ELC50PD
  9488                                    WS-IG-OVRD-AH-BEN             ELC50PD
  9489                                    WS-IG-OVRD-LF-BEN.            ELC50PD
  9490                                                                  ELC50PD
  9491******************************************************************ELC50PD
  9492*************       INITIALIZE COMMON ERRORS       ***************ELC50PD
  9493******************************************************************ELC50PD
  9494                                                                  ELC50PD
  9495     MOVE +0                     TO PB-NO-OF-ERRORS.              ELC50PD
  9496     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.             ELC50PD
  9497                                                                  ELC50PD
  9498******************************************************************ELC50PD
  9499                                                                  ELC50PD
  9500     MOVE EIBDATE                TO DC-JULIAN-DATE.               ELC50PD
  9501     SET JULIAN-TO-BIN           TO TRUE.                         ELC50PD
  9502*    MOVE 5                      TO DC-OPTION-CODE.               ELC50PD
  9503     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
  9504     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.            ELC50PD
  9505                                                                  ELC50PD
  9506     MOVE ZERO                   TO  SUB4.                        ELC50PD
  9507                                                                  ELC50PD
  9508 0040-INITIALIZE-GA-BILL-DT.                                      ELC50PD
  9509                                                                  ELC50PD
  9510     ADD +1                      TO  SUB4.                        ELC50PD
  9511                                                                  ELC50PD
  9512     IF  SUB4 GREATER THAN +5                                     ELC50PD
  9513         GO TO 0050-CHECK-CNTL-FOUND.                             ELC50PD
  9514                                                                  ELC50PD
  9515     IF  PB-GA-BILL-DT (SUB4) = SPACES                            ELC50PD
  9516         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).        ELC50PD
  9517                                                                  ELC50PD
  9518     GO TO 0040-INITIALIZE-GA-BILL-DT.                            ELC50PD
  9519                                                                  ELC50PD
  9520 0050-CHECK-CNTL-FOUND.                                           ELC50PD
  9521                                                                  ELC50PD
  9522     IF WK-CNTL-RECORD-FOUND-SW = 'Y'                             ELC50PD
  9523        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC      ELC50PD
  9524                                         WS-AH-REM-TERM-CALC      ELC50PD
  9525                                         EC-CO-REM-TERM-CALC      ELC50PD
  9526        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD            ELC50PD
  9527        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP          ELC50PD
  9528        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM          ELC50PD
  9529                                         WS-TOL-AH-CLAIM          ELC50PD
  9530        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM           ELC50PD
  9531                                         WS-TOL-AH-PREM           ELC50PD
  9532                                         EC-CO-TOL-PREM           ELC50PD
  9533        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND         ELC50PD
  9534                                         WS-TOL-AH-REFUND         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 175
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9535                                         EC-CO-TOL-REFUND         ELC50PD
  9536        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT     ELC50PD
  9537                                         WS-AH-REFUND-OVS-AMT     ELC50PD
  9538                                         EC-CO-OVR-SHT-AMT        ELC50PD
  9539        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT       ELC50PD
  9540                                         WS-TOL-AH-PREM-PCT       ELC50PD
  9541                                         EC-CO-TOL-PREM-PCT       ELC50PD
  9542        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT     ELC50PD
  9543                                         WS-TOL-AH-REFUND-PCT     ELC50PD
  9544                                         EC-CO-TOL-REFUND-PCT     ELC50PD
  9545        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT     ELC50PD
  9546                                         WS-AH-REFUND-OVS-PCT     ELC50PD
  9547                                         EC-CO-OVR-SHT-PCT        ELC50PD
  9548        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW         ELC50PD
  9549        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW        ELC50PD
  9550        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS  ELC50PD
  9551        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM        ELC50PD
  9552        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM           ELC50PD
  9553        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM           ELC50PD
  9554        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE            ELC50PD
  9555        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR           ELC50PD
  9556        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG       ELC50PD
  9557        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG        ELC50PD
  9558        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION   ELC50PD
  9559        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END     ELC50PD
  9560                                         EC-CO-MONTH-END-DT       ELC50PD
  9561        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT        ELC50PD
  9562          GO TO 0100-READ-ACCT.                                   ELC50PD
  9563                                                                  ELC50PD
  9564     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
  9565     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
  9566     MOVE '1'                    TO CNTL-REC-TYPE.                ELC50PD
  9567     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
  9568                                                                  ELC50PD
  9569     MOVE '1' TO RC-SW-1.                                         ELC50PD
  9570     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
  9571     IF NOT CF-COMPANY-MASTER                                     ELC50PD
  9572         MOVE ZEROS             TO WK-CO-TOL-PREM                 ELC50PD
  9573                                   WK-CO-TOL-CLAIM                ELC50PD
  9574                                   WK-CO-TOL-REFUND               ELC50PD
  9575                                   WK-REFUND-OVS-AMT              ELC50PD
  9576                                   WK-REFUND-OVS-PCT              ELC50PD
  9577                                   WK-CO-TOL-PREM-PCT             ELC50PD
  9578                                   WK-CO-TOL-REFUND-PCT           ELC50PD
  9579                                   WK-DEFAULT-APR                 ELC50PD
  9580                                   WK-CO-MAX-CAP                  ELC50PD
  9581        MOVE SPACES             TO WK-CR-REM-TERM-CALC            ELC50PD
  9582                                   WK-CR-R78-METHOD               ELC50PD
  9583                                   WK-CO-REF-REJECT-SW            ELC50PD
  9584                                   WK-CO-PREM-REJECT-SW           ELC50PD
  9585                                   WK-REM-TRM-CALC-OPTION         ELC50PD
  9586                                   WK-BIRTH-DATE-INPUT            ELC50PD
  9587                                   WK-JOINT-AGE-INPUT             ELC50PD
  9588        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT              ELC50PD
  9589        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS        ELC50PD
  9590        INITIALIZE    WK-CREDIT-EDIT-CONTROLS                     ELC50PD
  9591        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW        ELC50PD
  9592          GO TO 0099-COMPANY-NOT-FOUND.                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 176
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9593                                                                  ELC50PD
  9594     IF CF-CO-TOL-PREM-PCT NOT NUMERIC                            ELC50PD
  9595        MOVE +0                    TO CF-CO-TOL-PREM-PCT.         ELC50PD
  9596     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC                          ELC50PD
  9597        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.       ELC50PD
  9598     IF CF-CO-TOL-CAP NOT NUMERIC                                 ELC50PD
  9599        MOVE +0                    TO CF-CO-TOL-CAP.              ELC50PD
  9600     IF CF-DEFAULT-APR NOT NUMERIC                                ELC50PD
  9601        MOVE +0                    TO CF-DEFAULT-APR.             ELC50PD
  9602                                                                  ELC50PD
  9603     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.        ELC50PD
  9604     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.           ELC50PD
  9605     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.              ELC50PD
  9606     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.            ELC50PD
  9607     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.             ELC50PD
  9608     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.           ELC50PD
  9609     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.       ELC50PD
  9610     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.         ELC50PD
  9611     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.        ELC50PD
  9612     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.       ELC50PD
  9613     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.    ELC50PD
  9614     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.             ELC50PD
  9615                                                                  ELC50PD
  9616     IF CF-CO-OVR-SHT-AMT NUMERIC AND                             ELC50PD
  9617          CF-CO-OVR-SHT-AMT > +0                                  ELC50PD
  9618        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.            ELC50PD
  9619                                                                  ELC50PD
  9620     IF CF-CO-OVR-SHT-PCT NUMERIC AND                             ELC50PD
  9621          CF-CO-OVR-SHT-PCT > +0                                  ELC50PD
  9622        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.            ELC50PD
  9623                                                                  ELC50PD
  9624     IF CF-VALID-REM-TRM-OPTION                                   ELC50PD
  9625         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION    ELC50PD
  9626     ELSE                                                         ELC50PD
  9627         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.     ELC50PD
  9628                                                                  ELC50PD
  9629     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.        ELC50PD
  9630     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.         ELC50PD
  9631     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.          ELC50PD
  9632     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.    ELC50PD
  9633                                                                  ELC50PD
  9634     GO TO 0050-CHECK-CNTL-FOUND.                                 ELC50PD
  9635                                                                  ELC50PD
  9636 0099-COMPANY-NOT-FOUND.                                          ELC50PD
  9637                                                                  ELC50PD
  9638     MOVE ER-2616                TO WS-ERROR.                     ELC50PD
  9639     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
  9640                                                                  ELC50PD
  9641 0100-READ-ACCT.                                                  ELC50PD
  9642                                                                  ELC50PD
  9643     MOVE SPACES                 TO DATE-RANGE-SW.                ELC50PD
  9644                                                                  ELC50PD
  9645     IF WK-ACCT-ADDR = ZEROS                                      ELC50PD
  9646        GO TO 0102-ACCT-GETMAIN.                                  ELC50PD
  9647                                                                  ELC50PD
  9648     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.               ELC50PD
  9649     SET ERACCT-FILE-ADDRESSED   TO TRUE.                         ELC50PD
  9650     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 177
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9651                                                                  ELC50PD
  9652     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9653        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9654        GO TO 0105-READ-ACCT
  9655     END-IF
  9656                                                                  ELC50PD
  9657     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9658        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9659           GO TO 0105-READ-ACCT.                                  ELC50PD
  9660                                                                  ELC50PD
  9661     IF PB-STATE NOT = SPACES                                     ELC50PD
  9662        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9663           GO TO 0105-READ-ACCT.                                  ELC50PD
  9664                                                                  ELC50PD
  9665     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9666        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9667           GO TO 0105-READ-ACCT.                                  ELC50PD
  9668                                                                  ELC50PD
  9669     MOVE 'X'                 TO DATE-RANGE-SW.                   ELC50PD
  9670                                                                  ELC50PD
  9671     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9672        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9673        GO TO 0105-READ-ACCT.                                     ELC50PD
  9674                                                                  ELC50PD
  9675     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9676        GO TO 0105-READ-ACCT.                                     ELC50PD
  9677                                                                  ELC50PD
  9678     GO TO 0180-ACCOUNT-FOUND.                                    ELC50PD
  9679                                                                  ELC50PD
  9680 0102-ACCT-GETMAIN.                                               ELC50PD
  9681     PERFORM 8560-GETMAIN THRU 8560-EXIT.                         ELC50PD
  9682     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.                 ELC50PD
  9683                                                                  ELC50PD
  9684 0105-READ-ACCT.                                                  ELC50PD
  9685     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.                 ELC50PD
  9686     MOVE PB-CARRIER             TO ACCT-CARRIER.                 ELC50PD
  9687     MOVE PB-GROUPING            TO ACCT-GROUPING.                ELC50PD
  9688     MOVE PB-STATE               TO ACCT-STATE.                   ELC50PD
  9689     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.                 ELC50PD
  9690     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.                  ELC50PD
  9691                                                                  ELC50PD
  9692     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.            ELC50PD
  9693                                                                  ELC50PD
  9694     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.         ELC50PD
  9695                                                                  ELC50PD
  9696 0110-FIND-ACCT-TOLERANCES-LOOP.                                  ELC50PD
  9697
  9698     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.             ELC50PD
  9699                                                                  ELC50PD
  9700     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9701        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9702        GO TO 0199-ACCT-NOT-FOUND
  9703     END-IF
  9704     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9705        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9706           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9707                                                                  ELC50PD
  9708     IF PB-STATE NOT = SPACES                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 178
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9709        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9710           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9711                                                                  ELC50PD
  9712     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9713        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9714           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9715                                                                  ELC50PD
  9716     MOVE 'X'                    TO DATE-RANGE-SW.                ELC50PD
  9717                                                                  ELC50PD
  9718     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9719        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9720        GO TO 0199-ACCT-NOT-FOUND.                                ELC50PD
  9721                                                                  ELC50PD
  9722     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9723        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.                     ELC50PD
  9724                                                                  ELC50PD
  9725 0180-ACCOUNT-FOUND.                                              ELC50PD
  9726
  9727     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9728     MOVE AM-CARRIER             TO PB-SV-CARRIER.                ELC50PD
  9729     MOVE AM-STATE               TO PB-SV-STATE.                  ELC50PD
  9730     MOVE AM-GROUPING            TO PB-SV-GROUPING.               ELC50PD
  9731                                                                  ELC50PD
  9732     IF AM-CANCEL-FEE  NOT NUMERIC                                ELC50PD
  9733        MOVE ZEROS TO AM-CANCEL-FEE.                              ELC50PD
  9734                                                                  ELC50PD
  9735     IF AM-MAX-MON-BEN NOT NUMERIC                                ELC50PD
  9736        MOVE ZEROS TO AM-MAX-MON-BEN.                             ELC50PD
  9737                                                                  ELC50PD
  9738     IF AM-MAX-TOT-BEN NOT NUMERIC                                ELC50PD
  9739        MOVE ZEROS TO AM-MAX-TOT-BEN.                             ELC50PD
  9740                                                                  ELC50PD
  9741     IF AM-CLP-TOL-PCT NOT NUMERIC
  9742        MOVE +0                  TO AM-CLP-TOL-PCT
  9743     END-IF
  9744     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9745        MOVE +0                  TO AM-SPP-LEASE-COMM
  9746     END-IF
  9747     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9748        MOVE ER-2611             TO   WS-ERROR                    ELC50PD
  9749        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9750                                                                  ELC50PD
  9751     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9752        MOVE ER-2621             TO   WS-ERROR                    ELC50PD
  9753        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9754                                                                  ELC50PD
  9755     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)                      ELC50PD
  9756        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)               ELC50PD
  9757        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)                    ELC50PD
  9758        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)                      ELC50PD
  9759         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.            ELC50PD
  9760                                                                  ELC50PD
  9761     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.         ELC50PD
  9762     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.           ELC50PD
  9763     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.         ELC50PD
  9764     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.           ELC50PD
  9765     IF AM-CLP-TOL-PCT NOT = ZEROS
  9766        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 179
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9767     END-IF
  9768     IF AM-SPP-LEASE-COMM NOT = ZEROS
  9769        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  9770     END-IF
  9771
  9772
  9773
  9774
  9775*    IF PB-COMPANY-ID = 'DCC'
  9776*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  9777*                                   WS-ADMIN-FEES
  9778*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  9779*          (SUB5 > +10)
  9780*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9781*             AND (AM-A-COM (SUB5) NUMERIC)
  9782*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9783*                + (AM-A-COM (SUB5) * 1000)
  9784*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  9785*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  9786*                + (AM-A-COM (SUB5) * 1000)
  9787*             END-IF
  9788*             IF AM-COM-TYP (SUB5) = 'N'
  9789*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  9790*                + (AM-A-COM (SUB5) * 1000)
  9791*             END-IF
  9792*          END-IF
  9793*       END-PERFORM
  9794*    END-IF
  9795
  9796     IF (PB-COMPANY-ID = 'DCC')
  9797        AND (PB-ISSUE)
  9798        MOVE +0                  TO WS-ACCT-ADDL-CLP
  9799        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9800           (SUB5 > +10)
  9801           MOVE +0 TO WS-WK-RATE
  9802           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9803              IF (AM-A-COM (SUB5) NUMERIC)
  9804                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9805                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9806              ELSE
  9807                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  9808                 IF PB-ISSUE
  9809                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9810                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9811                 ELSE
  9812                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9813                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  9814                 END-IF
  9815                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  9816                 MOVE ZEROS             TO WS-SUB1
  9817                                           WS-COMMISSION
  9818                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  9819                 MOVE '0530'               TO CTBL-SW
  9820                 MOVE ' '                  TO WS-CTBL-READ-SW
  9821                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9822                 IF FIRST-TIME-THROUGH
  9823                    MOVE 'AA'              TO CTBL-BEN-CODE
  9824                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 180
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9825                 END-IF
  9826                 IF CTBL-TABLE-FOUND
  9827                    IF PB-ISSUE
  9828                       COMPUTE WS-COMM-CK-AMT =
  9829                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9830                    ELSE
  9831                       COMPUTE WS-COMM-CK-AMT =
  9832                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9833                    END-IF
  9834                    PERFORM 8800-GET-COMP-RATE
  9835                              THRU 8800-EXIT
  9836                 END-IF
  9837              END-IF
  9838              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9839                + (WS-WK-RATE * 1000)
  9840           END-IF
  9841        END-PERFORM
  9842     END-IF
  9843
  9844     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
  9845         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.           ELC50PD
  9846                                                                  ELC50PD
  9847     IF PB-COMPANY-ID EQUAL 'NCL'                                 ELC50PD
  9848         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  9849     END-IF
  9850                                                                  ELC50PD
  9851     GO TO 0200-READ-CERT.                                        ELC50PD
  9852                                                                  ELC50PD
  9853 0199-ACCT-NOT-FOUND.                                             ELC50PD
  9854                                                                  ELC50PD
  9855     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9856                                                                  ELC50PD
  9857     IF DATE-RANGE-SW NOT = SPACES                                ELC50PD
  9858        MOVE ER-2601             TO WS-ERROR                      ELC50PD
  9859        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9860     ELSE                                                         ELC50PD
  9861        MOVE ER-2619             TO WS-ERROR                      ELC50PD
  9862        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9863                                                                  ELC50PD
  9864     GO TO 9990-RETURN.                                           ELC50PD
  9865                                                                  ELC50PD
  9866 0200-READ-CERT.                                                  ELC50PD
  9867                                                                  ELC50PD
  9868     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.                 ELC50PD
  9869     MOVE PB-SV-CARRIER          TO CERT-CARRIER.                 ELC50PD
  9870     MOVE PB-SV-GROUPING         TO CERT-GROUPING.                ELC50PD
  9871     MOVE PB-SV-STATE            TO CERT-STATE.                   ELC50PD
  9872     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.                 ELC50PD
  9873     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.                  ELC50PD
  9874     MOVE PB-CERT-NO             TO CERT-CERT-NO.                 ELC50PD
  9875                                                                  ELC50PD
  9876     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.                ELC50PD
  9877                                                                  ELC50PD
  9878     IF CERT-WAS-NOT-FOUND                                        ELC50PD
  9879        GO TO 0299-CERT-NOT-FOUND.                                ELC50PD
  9880                                                                  ELC50PD
  9881     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION            ELC50PD
  9882        MOVE ER-2759             TO WS-ERROR                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 181
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9883        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9884        GO TO 0298-UNLOCK-RETURN.                                 ELC50PD
  9885                                                                  ELC50PD
  9886     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION                   ELC50PD
  9887         MOVE ER-2758            TO WS-ERROR                      ELC50PD
  9888         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
  9889         GO TO 0298-UNLOCK-RETURN.                                ELC50PD
  9890                                                                  ELC50PD
  9891     IF PB-ISSUE                                                  ELC50PD
  9892        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')           ELC50PD
  9893           IF CERT-WAS-CREATED-FOR-CLAIM                          ELC50PD
  9894              NEXT SENTENCE                                       ELC50PD
  9895            ELSE                                                  ELC50PD
  9896              MOVE ER-2626       TO WS-ERROR                      ELC50PD
  9897              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
  9898              GO TO 0298-UNLOCK-RETURN.                           ELC50PD
  9899                                                                  ELC50PD
  9900     IF NOT PB-CANCELLATION                                       ELC50PD
  9901        GO TO 0300-CONTINUE-EDIT.                                 ELC50PD
  9902                                                                  ELC50PD
  9903     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.             ELC50PD
  9904     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.              ELC50PD
  9905     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  9906     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.           ELC50PD
  9907     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.           ELC50PD
  9908     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.            ELC50PD
  9909                                                                  ELC50PD
  9910     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.               ELC50PD
  9911     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.         ELC50PD
  9912     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.        ELC50PD
  9913     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.        ELC50PD
  9914     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.    ELC50PD
  9915     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.    ELC50PD
  9916     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.           ELC50PD
  9917     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.           ELC50PD
  9918     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.       ELC50PD
  9919                                                                  ELC50PD
  9920     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.               ELC50PD
  9921     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.         ELC50PD
  9922     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.        ELC50PD
  9923     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.        ELC50PD
  9924     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.           ELC50PD
  9925     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.           ELC50PD
  9926     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.       ELC50PD
  9927                                                                  ELC50PD
  9928     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.            ELC50PD
  9929     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.               ELC50PD
  9930                                                                  ELC50PD
  9931     MOVE CM-CREDIT-INTERFACE-SW-1                                ELC50PD
  9932                                  TO PB-CI-CREDIT-INTERFACE-SW-1. ELC50PD
  9933     MOVE CM-CREDIT-INTERFACE-SW-2                                ELC50PD
  9934                                  TO PB-CI-CREDIT-INTERFACE-SW-2. ELC50PD
  9935                                                                  ELC50PD
  9936     IF CM-O-B-COVERAGE                                           ELC50PD
  9937         MOVE 'B'                 TO PB-CI-OB-FLAG.               ELC50PD
  9938                                                                  ELC50PD
  9939     IF CM-LIVES NOT NUMERIC                                      ELC50PD
  9940         MOVE ZERO                TO CM-LIVES.                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 182
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9941                                                                  ELC50PD
  9942     IF CM-BILLED NOT NUMERIC                                     ELC50PD
  9943         MOVE ZERO                TO CM-BILLED.                   ELC50PD
  9944                                                                  ELC50PD
  9945     IF CM-CREDIT-INTERFACE-SW-2 = SPACE                          ELC50PD
  9946         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS      ELC50PD
  9947         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS      ELC50PD
  9948         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT    ELC50PD
  9949         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT    ELC50PD
  9950         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT         ELC50PD
  9951         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.        ELC50PD
  9952         MOVE CM-LIVES             TO PB-CI-LIVES                 ELC50PD
  9953*The next line causes a problem with my change  I dont think it is needed
  9954*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.     ELC50PD
  9955                                                                  ELC50PD
  9956     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.      ELC50PD
  9957     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.      ELC50PD
  9958     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.      ELC50PD
  9959     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.      ELC50PD
  9960     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.         ELC50PD
  9961     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.         ELC50PD
  9962                                                                  ELC50PD
  9963     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.             ELC50PD
  9964     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.             ELC50PD
  9965     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.     ELC50PD
  9966     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.      ELC50PD
  9967                                                                  ELC50PD
  9968     IF CM-LIFE-COMM-PCT NUMERIC                                  ELC50PD
  9969         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION         ELC50PD
  9970     ELSE                                                         ELC50PD
  9971         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.        ELC50PD
  9972                                                                  ELC50PD
  9973     IF CM-AH-COMM-PCT NUMERIC                                    ELC50PD
  9974         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION           ELC50PD
  9975     ELSE                                                         ELC50PD
  9976         MOVE ZEROS              TO PB-CI-AH-COMMISSION.          ELC50PD
  9977                                                                  ELC50PD
  9978     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.         ELC50PD
  9979                                                                  ELC50PD
  9980     IF CM-LOAN-APR       NOT NUMERIC                             ELC50PD
  9981           MOVE ZERO               TO CM-LOAN-APR.                ELC50PD
  9982                                                                  ELC50PD
  9983     IF CM-PAY-FREQUENCY  NOT NUMERIC                             ELC50PD
  9984           MOVE ZERO               TO CM-PAY-FREQUENCY.           ELC50PD
  9985                                                                  ELC50PD
  9986     IF CM-LOAN-TERM      NOT NUMERIC                             ELC50PD
  9987           MOVE ZERO               TO CM-LOAN-TERM.               ELC50PD
  9988                                                                  ELC50PD
  9989     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC                          ELC50PD
  9990           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.         ELC50PD
  9991                                                                  ELC50PD
  9992     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC                        ELC50PD
  9993           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.      ELC50PD
  9994                                                                  ELC50PD
  9995     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.        ELC50PD
  9996     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.             ELC50PD
  9997     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.            ELC50PD
  9998     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 183
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9999     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.       ELC50PD
 10000     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.         ELC50PD
 10001     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.         ELC50PD
 10002     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.      ELC50PD
 10003     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.             ELC50PD
 10004     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.          ELC50PD
 10005     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.         ELC50PD
 10006     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD           ELC50PD
 10007                                                                  ELC50PD
 10008     IF CM-STATE = CM-SSN-STATE                                   ELC50PD
 10009         MOVE SPACES               TO PB-CI-SOC-SEC-NO.           ELC50PD
 10010                                                                  ELC50PD
 10011     IF CM-STATE NOT = CM-MEMB-STATE                              ELC50PD
 10012         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.            ELC50PD
 10013                                                                  ELC50PD
 10014     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.         ELC50PD
 10015                                                                  ELC50PD
 10016     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
 10017        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
 10018        IF CM-ADDL-CLP NOT NUMERIC
 10019           MOVE +0               TO CM-ADDL-CLP
 10020        END-IF
 10021        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
 10022        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10023           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
 10024        END-IF
 10025     END-IF
 10026
 10027     IF PB-COMPANY-ID = 'DCC'
 10028        MOVE +0                  TO WS-ADMIN-FEES
 10029                                    WS-CSO-ADMIN-FEE
 10030                                    WS-COMM-AND-MFEE
 10031                                    WS-1ST-YR-ALLOW
 10032        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
 10033           (SUB5 > +10)
 10034           MOVE +0 TO WS-WK-RATE
 10035           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
 10036              IF (AM-A-COM (SUB5) NUMERIC)
 10037                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
 10038                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
 10039              ELSE
 10040                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
 10041                 IF PB-ISSUE
 10042                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10043                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10044                 ELSE
 10045                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10046                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
 10047                 END-IF
 10048                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10049                 MOVE ZEROS             TO WS-SUB1
 10050                                           WS-COMMISSION
 10051                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
 10052                 MOVE '0530'               TO CTBL-SW
 10053                 MOVE ' '                  TO WS-CTBL-READ-SW
 10054                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10055                 IF FIRST-TIME-THROUGH
 10056                    MOVE 'AA'              TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 184
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10057                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10058                 END-IF
 10059                 IF CTBL-TABLE-FOUND
 10060                    IF PB-ISSUE
 10061                       COMPUTE WS-COMM-CK-AMT =
 10062                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
 10063                    ELSE
 10064                       COMPUTE WS-COMM-CK-AMT =
 10065                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
 10066                    END-IF
 10067                    PERFORM 8800-GET-COMP-RATE
 10068                              THRU 8800-EXIT
 10069                 END-IF
 10070              END-IF
 10071              IF AM-COM-TYP (SUB5) = 'I'
 10072                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 10073                   + (WS-WK-RATE * 1000)
 10074              END-IF
 10075              IF AM-COM-TYP (SUB5) = 'N'
 10076                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
 10077                   + (WS-WK-RATE * 1000)
 10078              END-IF
 10079              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
 10080                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
 10081                   + (WS-WK-RATE * 1000)
 10082              END-IF
 10083              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
 10084                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 10085                   + (WS-WK-RATE * 1000)
 10086              END-IF
 10087           END-IF
 10088        END-PERFORM
 10089     END-IF
 10090
 10091     GO TO 0300-CONTINUE-EDIT.                                    ELC50PD
 10092                                                                  ELC50PD
 10093 0298-UNLOCK-RETURN.                                              ELC50PD
 10094      PERFORM 9250-UNLOCK-RETURN                                  ELC50PD
 10095      GO TO 9990-RETURN.                                          ELC50PD
 10096                                                                  ELC50PD
 10097 0299-CERT-NOT-FOUND.                                             ELC50PD
 10098                                                                  ELC50PD
 10099     MOVE '1'                     TO CERT-STATUS-SW.              ELC50PD
 10100                                                                  ELC50PD
 10101     IF PB-COMPANY-ID = 'UCL'                                     ELC50PD
 10102         IF WS-ERROR = ER-2799                                    ELC50PD
 10103             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 10104                                                                  ELC50PD
 10105     IF NOT PB-CANCELLATION                                       ELC50PD
 10106         GO TO 0300-CONTINUE-EDIT.                                ELC50PD
 10107                                                                  ELC50PD
 10108     MOVE ER-2726                  TO  WS-ERROR.                  ELC50PD
 10109     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.                ELC50PD
 10110     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.        ELC50PD
 10111     MOVE ZEROS                  TO PB-CI-INSURED-AGE             ELC50PD
 10112                                    PB-CI-LF-TERM                 ELC50PD
 10113                                    PB-C-LF-REM-TERM              ELC50PD
 10114                                    PB-CI-AH-TERM                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 185
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10115                                    PB-C-AH-REM-TERM              ELC50PD
 10116                                    PB-CI-LF-BENEFIT-CD           ELC50PD
 10117                                    PB-CI-LF-BENEFIT-AMT          ELC50PD
 10118                                    PB-CI-LF-ALT-BENEFIT-AMT      ELC50PD
 10119                                    PB-CI-LF-PREMIUM-AMT          ELC50PD
 10120                                    PB-CI-LF-ALT-PREMIUM-AMT      ELC50PD
 10121                                    PB-CI-AH-BENEFIT-CD           ELC50PD
 10122                                    PB-CI-AH-BENEFIT-AMT          ELC50PD
 10123                                    PB-CI-AH-PREMIUM-AMT          ELC50PD
 10124                                    PB-CI-PAY-FREQUENCY           ELC50PD
 10125                                    PB-CI-LOAN-APR                ELC50PD
 10126                                    PB-CI-LOAN-TERM               ELC50PD
 10127                                    PB-CI-LIFE-COMMISSION         ELC50PD
 10128                                    PB-CI-AH-COMMISSION           ELC50PD
 10129                                    PB-CI-CURR-SEQ                ELC50PD
 10130                                    PB-CI-AH-CANCEL-AMT           ELC50PD
 10131                                    PB-CI-LF-CANCEL-AMT           ELC50PD
 10132                                    PB-CI-RATE-DEV-PCT-LF         ELC50PD
 10133                                    PB-CI-RATE-DEV-PCT-AH         ELC50PD
 10134                                    PB-CI-EXTENTION-DAYS          ELC50PD
 10135                                    PB-CI-TERM-IN-DAYS            ELC50PD
 10136                                    PB-CI-LIVES                   ELC50PD
 10137                                    PB-CI-LF-CRIT-PER             ELC50PD
 10138                                    PB-CI-AH-CRIT-PER
 10139                                    PB-CI-ADDL-CLP
 10140                                    PB-CI-DDF-IU-RATE-UP.
 10141                                                                  ELC50PD
 10142     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT         ELC50PD
 10143                                    PB-CI-AH-SETTLEMENT-DT        ELC50PD
 10144                                    PB-CI-DEATH-DT                ELC50PD
 10145                                    PB-CI-LF-PRIOR-CANCEL-DT      ELC50PD
 10146                                    PB-CI-AH-PRIOR-CANCEL-DT      ELC50PD
 10147                                    PB-CI-ENTRY-DT                ELC50PD
 10148                                    PB-CI-LF-EXPIRE-DT            ELC50PD
 10149                                    PB-CI-AH-EXPIRE-DT            ELC50PD
 10150                                    PB-CI-LOAN-1ST-PMT-DT.        ELC50PD
 10151                                                                  ELC50PD
 10152     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 10153        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT               ELC50PD
 10154        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.              ELC50PD
 10155                                                                  ELC50PD
 10156     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 10157                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 186
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10159                                                                  ELC50PD
 10160 0300-CONTINUE-EDIT.                                              ELC50PD
 10161                                                                  ELC50PD
 10162     IF PB-ISSUE                                                  ELC50PD
 10163        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10164            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.       ELC50PD
 10165                                                                  ELC50PD
 10166     IF PB-ISSUE                                                  ELC50PD
 10167        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10168            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.       ELC50PD
 10169                                                                  ELC50PD
 10170     IF PB-ISSUE                                                  ELC50PD
 10171       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR                     ELC50PD
 10172          (AM-NO-AH-ONLY)                                         ELC50PD
 10173           IF PB-I-AH-BENEFIT-CD NOT = ZEROS                      ELC50PD
 10174               IF PB-I-LIFE-BENEFIT-CD = ZEROS                    ELC50PD
 10175                   MOVE ER-2679 TO WS-ERROR                       ELC50PD
 10176                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 10177                                                                  ELC50PD
 10178     IF PB-ISSUE                                                  ELC50PD
 10179        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD            ELC50PD
 10180        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD            ELC50PD
 10181        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT              ELC50PD
 10182     ELSE                                                         ELC50PD
 10183        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD            ELC50PD
 10184        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD            ELC50PD
 10185        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.             ELC50PD
 10186                                                                  ELC50PD
 10187     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10188                                    PLAN-MASTER-LIFE-SW           ELC50PD
 10189                                    FORM-MASTER-SW                ELC50PD
 10190                                    WS-APP-CERT-SW.               ELC50PD
 10191                                                                  ELC50PD
 10192     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM             ELC50PD
 10193                                    WS-PL-TOL-LF-REFUND           ELC50PD
 10194                                    WS-PL-REF-OVS-AMT             ELC50PD
 10195                                    WS-PL-TOL-LF-PREM-PCT         ELC50PD
 10196                                    WS-PL-TOL-LF-REFUND-PCT       ELC50PD
 10197                                    WS-PL-REF-OVS-PCT             ELC50PD
 10198                                    WS-PL-TOL-LF-CLAIM.           ELC50PD
 10199                                                                  ELC50PD
 10200     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10201       IF PB-ISSUE                                                ELC50PD
 10202         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS          ELC50PD
 10203             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT           ELC50PD
 10204             IF FORM-MASTER-FOUND                                 ELC50PD
 10205                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.       ELC50PD
 10206                                                                  ELC50PD
 10207     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10208        GO TO 0310-FIND-AH-BENEFIT-RECORD.                        ELC50PD
 10209                                                                  ELC50PD
 10210********************** MON CODE **********************            ELC50PD
 10211     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 10212     IF PB-ISSUE                                                  ELC50PD
 10213     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26') ELC50PD
 10214        AND (PB-I-LOAN-APR NOT NUMERIC OR                         ELC50PD
 10215             PB-I-LOAN-APR = ZERO)                                ELC50PD
 10216               MOVE 14.0         TO PB-I-LOAN-APR.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 187
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10217******************************************************            ELC50PD
 10218                                                                  ELC50PD
 10219     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10220       IF PB-ISSUE                                                ELC50PD
 10221           IF FORM-MASTER-FOUND                                   ELC50PD
 10222             IF FO-DISMEMBERMENT-CD = 'Y'  AND                    ELC50PD
 10223                AM-DISMBR-COVERAGE                                ELC50PD
 10224                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD         ELC50PD
 10225                 IF WS-LF-INPUT-CD-1 NOT = 'B'                    ELC50PD
 10226                   MOVE '8'            TO  WS-LF-INPUT-CD-1       ELC50PD
 10227                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD       ELC50PD
 10228                                           PB-I-LIFE-BENEFIT-CD.  ELC50PD
 10229                                                                  ELC50PD
 10230     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10231                                                                  ELC50PD
 10232     IF WK-LIFE-BEN-ADDR NOT = ZEROS                              ELC50PD
 10233         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 10234         SET ELCNTL-FILE-ADDRESSED   TO TRUE                      ELC50PD
 10235         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10236         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT          ELC50PD
 10237         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10238           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10239             GO TO 0301-LIFE-BENEFIT-SEARCH                       ELC50PD
 10240         ELSE                                                     ELC50PD
 10241             NEXT SENTENCE                                        ELC50PD
 10242     ELSE                                                         ELC50PD
 10243         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10244                                                                  ELC50PD
 10245     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10246     MOVE '4'                    TO CNTL-REC-TYPE.                ELC50PD
 10247     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10248     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10249                                                                  ELC50PD
 10250     MOVE '1' TO RC-SW-2.                                         ELC50PD
 10251     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10252                                                                  ELC50PD
 10253     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10254        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10255         GO TO 0305-BENEFIT-NOT-FOUND.                            ELC50PD
 10256                                                                  ELC50PD
 10257     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.             ELC50PD
 10258                                                                  ELC50PD
 10259 0301-LIFE-BENEFIT-SEARCH.                                        ELC50PD
 10260                                                                  ELC50PD
 10261     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10262                                                                  ELC50PD
 10263     IF NO-BENEFIT-FOUND                                          ELC50PD
 10264        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10265                                                                  ELC50PD
 10266     IF WS-BEN-CD = '99'                                          ELC50PD
 10267        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10268                                                                  ELC50PD
 10269     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10270         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10271             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10272                                                                  ELC50PD
 10273     MOVE +1                     TO SUB5.                         ELC50PD
 10274     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 188
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10275                                                                  ELC50PD
 10276* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10277* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10278     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10279         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10280                                                                  ELC50PD
 10281 0302-EDIT-ACCT-LF-BENEFITS.                                      ELC50PD
 10282                                                                  ELC50PD
 10283     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1          ELC50PD
 10284        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)                 ELC50PD
 10285           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10286                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10287           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10288                                                                  ELC50PD
 10289     IF SUB5 LESS THAN +20                                        ELC50PD
 10290        ADD +1                   TO SUB5                          ELC50PD
 10291        GO TO 0302-EDIT-ACCT-LF-BENEFITS.                         ELC50PD
 10292                                                                  ELC50PD
 10293     MOVE +1                     TO SUB5.                         ELC50PD
 10294                                                                  ELC50PD
 10295     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10296        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10297                                                                  ELC50PD
 10298 0303-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10299                                                                  ELC50PD
 10300     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1      ELC50PD
 10301        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)             ELC50PD
 10302           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10303                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10304           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10305                                                                  ELC50PD
 10306     IF SUB5 LESS THAN +30                                        ELC50PD
 10307        ADD +1                   TO SUB5                          ELC50PD
 10308        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10309                                                                  ELC50PD
 10310     MOVE +1                     TO SUB5.                         ELC50PD
 10311                                                                  ELC50PD
 10312 03XX-EDIT-FOR-NINETY-LF.                                         ELC50PD
 10313                                                                  ELC50PD
 10314***************************************************************   ELC50PD
 10315*                                                             *   ELC50PD
 10316*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10317*                                                             *   ELC50PD
 10318*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10319*      92 = ALL GROUP REDUCING BENEFITS                       *   ELC50PD
 10320*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *   ELC50PD
 10321*      94 = ALL GROUP LEVEL BENEFITS                          *   ELC50PD
 10322*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10323*           BENEFIT CONTROLS.                                 *   ELC50PD
 10324*      99 = ALL BENEFITS                                      *   ELC50PD
 10325*                                                             *   ELC50PD
 10326***************************************************************   ELC50PD
 10327                                                                  ELC50PD
 10328     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10329                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10330                                                                  ELC50PD
 10331     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10332       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 189
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10333        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10334        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10335                                                                  ELC50PD
 10336     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')                       ELC50PD
 10337       AND                                                        ELC50PD
 10338        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10339        IF CF-REDUCING (SUB3)                                     ELC50PD
 10340           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10341              OR                                                  ELC50PD
 10342           ((AM-IG = '1') AND                                     ELC50PD
 10343           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10344              OR                                                  ELC50PD
 10345           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10346           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10347           (AM-IG NOT = '2'))                                     ELC50PD
 10348              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10349                                                                  ELC50PD
 10350     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')                       ELC50PD
 10351       AND                                                        ELC50PD
 10352        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10353        IF CF-REDUCING (SUB3)                                     ELC50PD
 10354           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10355              OR                                                  ELC50PD
 10356           ((AM-IG = '2') AND                                     ELC50PD
 10357           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10358              OR                                                  ELC50PD
 10359           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10360           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10361           (AM-IG NOT = '1'))                                     ELC50PD
 10362              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10363                                                                  ELC50PD
 10364     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')                       ELC50PD
 10365       AND                                                        ELC50PD
 10366        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10367        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10368           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10369              OR                                                  ELC50PD
 10370           ((AM-IG = '1') AND                                     ELC50PD
 10371           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10372              OR                                                  ELC50PD
 10373           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10374           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10375            (AM-IG NOT = '2'))                                    ELC50PD
 10376              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10377                                                                  ELC50PD
 10378     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')                       ELC50PD
 10379       AND                                                        ELC50PD
 10380        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10381        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10382           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10383              OR                                                  ELC50PD
 10384           ((AM-IG = '2') AND                                     ELC50PD
 10385           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10386              OR                                                  ELC50PD
 10387           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10388           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10389           (AM-IG NOT = '1'))                                     ELC50PD
 10390              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 190
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10391                                                                  ELC50PD
 10392     IF SUB5 LESS THAN +20                                        ELC50PD
 10393        ADD +1                   TO SUB5                          ELC50PD
 10394        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10395                                                                  ELC50PD
 10396     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10397                                                                  ELC50PD
 10398     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10399        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.                       ELC50PD
 10400                                                                  ELC50PD
 10401     MOVE +1                     TO SUB5.                         ELC50PD
 10402                                                                  ELC50PD
 10403 03XX-EDIT-DMD-EXTRA-NINETY-LF.                                   ELC50PD
 10404                                                                  ELC50PD
 10405     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10406                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10407                                                                  ELC50PD
 10408     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10409       AND                                                        ELC50PD
 10410        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10411        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10412                                                                  ELC50PD
 10413     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')                   ELC50PD
 10414       AND                                                        ELC50PD
 10415        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10416        IF CF-REDUCING (SUB3)                                     ELC50PD
 10417           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10418              OR                                                  ELC50PD
 10419           ((AM-IG = '1') AND                                     ELC50PD
 10420           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10421              OR                                                  ELC50PD
 10422           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10423           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10424           (AM-IG NOT = '2'))                                     ELC50PD
 10425              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10426                                                                  ELC50PD
 10427     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')                   ELC50PD
 10428       AND                                                        ELC50PD
 10429        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10430        IF CF-REDUCING (SUB3)                                     ELC50PD
 10431           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10432              OR                                                  ELC50PD
 10433           ((AM-IG = '2') AND                                     ELC50PD
 10434           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10435              OR                                                  ELC50PD
 10436           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10437           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10438           (AM-IG NOT = '1'))                                     ELC50PD
 10439              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10440                                                                  ELC50PD
 10441     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')                   ELC50PD
 10442       AND                                                        ELC50PD
 10443        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10444        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10445           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10446              OR                                                  ELC50PD
 10447           ((AM-IG = '1') AND                                     ELC50PD
 10448           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 191
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10449              OR                                                  ELC50PD
 10450           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10451           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10452            (AM-IG NOT = '2'))                                    ELC50PD
 10453              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10454                                                                  ELC50PD
 10455     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')                   ELC50PD
 10456       AND                                                        ELC50PD
 10457        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10458        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10459           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10460              OR                                                  ELC50PD
 10461           ((AM-IG = '2') AND                                     ELC50PD
 10462           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10463              OR                                                  ELC50PD
 10464           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10465           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10466           (AM-IG NOT = '1'))                                     ELC50PD
 10467              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10468                                                                  ELC50PD
 10469     IF SUB5 LESS THAN +30                                        ELC50PD
 10470        ADD +1                   TO SUB5                          ELC50PD
 10471        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.                      ELC50PD
 10472                                                                  ELC50PD
 10473     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10474                                                                  ELC50PD
 10475 03XX-EDIT-FOR-NINETY-LF-CONT.                                    ELC50PD
 10476                                                                  ELC50PD
 10477     MOVE +99                    TO SUB5.                         ELC50PD
 10478                                                                  ELC50PD
 10479     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10480        IF PB-ISSUE                                               ELC50PD
 10481           MOVE ER-1924          TO  WS-ERROR                     ELC50PD
 10482           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10483                                                                  ELC50PD
 10484     GO TO 0304-LIFE-BENEFIT-FOUND.                               ELC50PD
 10485                                                                  ELC50PD
 10486 03XX-GET-LIFE-ERPLAN.                                            ELC50PD
 10487                                                                  ELC50PD
 10488     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10489        GO TO 03XX-ERPLAN-LIFE-GETMAIN.                           ELC50PD
 10490                                                                  ELC50PD
 10491     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10492     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10493     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10494     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 10495     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10496                                    PLAN-MASTER-LIFE-SW.          ELC50PD
 10497     GO TO XXXX-CHECK-LF-PLAN-KEY.                                ELC50PD
 10498                                                                  ELC50PD
 10499 03XX-ERPLAN-LIFE-GETMAIN.                                        ELC50PD
 10500                                                                  ELC50PD
 10501     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10502     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10503                                                                  ELC50PD
 10504 03XX-ERPLAN-LIFE-READ.                                           ELC50PD
 10505                                                                  ELC50PD
 10506     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 192
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10507     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10508     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10509     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10510     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10511     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.            ELC50PD
 10512     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10513     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10514                                 TO PLAN-REVISION-NO.             ELC50PD
 10515                                                                  ELC50PD
 10516     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10517     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.          ELC50PD
 10518                                                                  ELC50PD
 10519     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10520       IF NOT LF-PLAN-MASTER-FOUND                                ELC50PD
 10521         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10522            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10523             MOVE  ER-1921         TO  WS-ERROR                   ELC50PD
 10524             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10525             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10526                                                                  ELC50PD
 10527     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 10528        GO TO 0304-LIFE-BENEFIT-FOUND.                            ELC50PD
 10529                                                                  ELC50PD
 10530 XXXX-CHECK-LF-PLAN-KEY.                                          ELC50PD
 10531                                                                  ELC50PD
 10532     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10533        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10534        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10535        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10536        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10537        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR        ELC50PD
 10538        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10539        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10540        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10541          GO TO 03XX-ERPLAN-LIFE-READ.                            ELC50PD
 10542                                                                  ELC50PD
 10543     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.          ELC50PD
 10544                                                                  ELC50PD
 10545     IF  PB-CANCELLATION                                          ELC50PD
 10546         GO TO  0303-LF-ACCT-BEN-FOUND.                           ELC50PD
 10547                                                                  ELC50PD
 10548     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10549        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND        ELC50PD
 10550           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)       ELC50PD
 10551           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO        ELC50PD
 10552              MOVE ER-2644             TO WS-ERROR                ELC50PD
 10553              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10554           ELSE                                                   ELC50PD
 10555              NEXT SENTENCE                                       ELC50PD
 10556        ELSE                                                      ELC50PD
 10557           IF PB-COMPANY-ID NOT = 'NCL'                           ELC50PD
 10558              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS          ELC50PD
 10559                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.    ELC50PD
 10560                                                                  ELC50PD
 10561 0303-LF-ACCT-BEN-FOUND.                                          ELC50PD
 10562                                                                  ELC50PD
 10563     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.             ELC50PD
 10564                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 193
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10565     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10566        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.         ELC50PD
 10567                                                                  ELC50PD
 10568     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10569        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10570        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.           ELC50PD
 10571                                                                  ELC50PD
 10572     IF PL-TOL-PREM-AMT GREATER THAN +0                           ELC50PD
 10573        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.            ELC50PD
 10574                                                                  ELC50PD
 10575     IF PL-TOL-REF-AMT GREATER THAN +0                            ELC50PD
 10576        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.          ELC50PD
 10577                                                                  ELC50PD
 10578     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10579        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.        ELC50PD
 10580                                                                  ELC50PD
 10581     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10582        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.      ELC50PD
 10583                                                                  ELC50PD
 10584     IF PL-TOL-CLM-AMT GREATER THAN +0                            ELC50PD
 10585        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.           ELC50PD
 10586                                                                  ELC50PD
 10587     IF PL-OVER-SHORT-AMT NUMERIC  AND                            ELC50PD
 10588                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10589        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.            ELC50PD
 10590                                                                  ELC50PD
 10591     IF PL-OVER-SHORT-PCT NUMERIC  AND                            ELC50PD
 10592                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10593        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.            ELC50PD
 10594                                                                  ELC50PD
 10595     IF PL-SALES-TAX NUMERIC AND                                  ELC50PD
 10596                          PL-SALES-TAX > +0                       ELC50PD
 10597         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.              ELC50PD
 10598                                                                  ELC50PD
 10599     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10600        MOVE PL-IG               TO WS-IG-OVRD-LF-PL              ELC50PD
 10601                                    WS-IG-OVRD-AM.                ELC50PD
 10602                                                                  ELC50PD
 10603 0304-LIFE-BENEFIT-FOUND.                                         ELC50PD
 10604                                                                  ELC50PD
 10605     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.     ELC50PD
 10606                                                                  ELC50PD
 10607     IF PB-ISSUE                                                  ELC50PD
 10608        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR             ELC50PD
 10609     ELSE                                                         ELC50PD
 10610        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.           ELC50PD
 10611                                                                  ELC50PD
 10612     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.     ELC50PD
 10613     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.   ELC50PD
 10614     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.   ELC50PD
 10615     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.       ELC50PD
 10616     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC      ELC50PD
 10617                                         WS-LF-REFUND-CALC.       ELC50PD
 10618                                                                  ELC50PD
 10619     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10620        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.    ELC50PD
 10621                                                                  ELC50PD
 10622     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 194
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10623        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.  ELC50PD
 10624
 10625     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
 10626                                                                  ELC50PD
 10627     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.  ELC50PD
 10628     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.ELC50PD
 10629     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.     ELC50PD
 10630     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.  ELC50PD
 10631     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.    ELC50PD
 10632     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10633                                                                  ELC50PD
 10634     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10635        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10636         NEXT SENTENCE                                            ELC50PD
 10637     ELSE                                                         ELC50PD
 10638         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10639            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'              ELC50PD
 10640               MOVE WS-SAVE-BENEFIT-REM-TERM                      ELC50PD
 10641                                      TO WS-AM-LF-BENE-REM-TERM   ELC50PD
 10642                                         EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10643                                                                  ELC50PD
 10644     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.        ELC50PD
 10645     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.           ELC50PD
 10646                                                                  ELC50PD
 10647     GO TO 0310-FIND-AH-BENEFIT-RECORD.                           ELC50PD
 10648                                                                  ELC50PD
 10649 0305-BENEFIT-NOT-FOUND.                                          ELC50PD
 10650                                                                  ELC50PD
 10651     MOVE '1'                    TO LF-BENEFIT-ERROR.             ELC50PD
 10652     MOVE ER-2604                TO WS-ERROR.                     ELC50PD
 10653     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 10654                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 195
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10656                                                                  ELC50PD
 10657 0310-FIND-AH-BENEFIT-RECORD.                                     ELC50PD
 10658                                                                  ELC50PD
 10659     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10660                                    PLAN-MASTER-AH-SW.            ELC50PD
 10661                                                                  ELC50PD
 10662     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM             ELC50PD
 10663                                    WS-PL-TOL-AH-REFUND           ELC50PD
 10664                                    WS-AH-PL-REF-OVS-AMT          ELC50PD
 10665                                    WS-PL-TOL-AH-PREM-PCT         ELC50PD
 10666                                    WS-PL-TOL-AH-REFUND-PCT       ELC50PD
 10667                                    WS-AH-PL-REF-OVS-PCT          ELC50PD
 10668                                    WS-PL-TOL-AH-CLAIM.           ELC50PD
 10669     MOVE ' '                    TO WS-AH-DCC-TRUNC
 10670                                                                  ELC50PD
 10671                                                                  ELC50PD
 10672     if pb-issue
 10673        IF PB-I-AH-INPUT-CD EQUAL ZEROS
 10674           MOVE SPACES              TO PB-I-AH-INPUT-CD
 10675        end-if
 10676        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
 10677           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
 10678           GO TO 0399-BENEFIT-NOT-FOUND
 10679        end-if
 10680     end-if
 10681                                                                  ELC50PD
 10682     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10683        GO TO 0400-FIND-CARRIER.                                  ELC50PD
 10684                                                                  ELC50PD
 10685     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10686                                                                  ELC50PD
 10687     IF WK-AH-BEN-ADDR NOT = ZEROS                                ELC50PD
 10688         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 10689         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 10690         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10691         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10692           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10693             GO TO 0311-AH-BENEFIT-SEARCH                         ELC50PD
 10694         ELSE                                                     ELC50PD
 10695             NEXT SENTENCE                                        ELC50PD
 10696     ELSE                                                         ELC50PD
 10697         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10698                                                                  ELC50PD
 10699     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10700     MOVE '5'                    TO CNTL-REC-TYPE.                ELC50PD
 10701     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10702     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10703                                                                  ELC50PD
 10704     MOVE '2' TO RC-SW-2.                                         ELC50PD
 10705     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10706                                                                  ELC50PD
 10707     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10708        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10709          GO TO 0399-BENEFIT-NOT-FOUND.                           ELC50PD
 10710                                                                  ELC50PD
 10711     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.               ELC50PD
 10712                                                                  ELC50PD
 10713 0311-AH-BENEFIT-SEARCH.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 196
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10714                                                                  ELC50PD
 10715     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10716                                                                  ELC50PD
 10717     IF NO-BENEFIT-FOUND                                          ELC50PD
 10718         GO TO 0399-BENEFIT-NOT-FOUND.                            ELC50PD
 10719                                                                  ELC50PD
 10720     IF WS-BEN-CD = '99'                                          ELC50PD
 10721        GO TO 0399-BENEFIT-NOT-FOUND.                             ELC50PD
 10722                                                                  ELC50PD
 10723     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 10724         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10725             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10726                                                                  ELC50PD
 10727     MOVE +1                     TO SUB5.                         ELC50PD
 10728     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10729                                                                  ELC50PD
 10730* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10731* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10732     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10733         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10734                                                                  ELC50PD
 10735 0312-EDIT-ACCT-AH-BENEFITS.                                      ELC50PD
 10736                                                                  ELC50PD
 10737     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1                ELC50PD
 10738        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)                     ELC50PD
 10739           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10740                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10741           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10742                                                                  ELC50PD
 10743     IF SUB5 LESS THAN +20                                        ELC50PD
 10744        ADD +1                   TO SUB5                          ELC50PD
 10745        GO TO 0312-EDIT-ACCT-AH-BENEFITS.                         ELC50PD
 10746                                                                  ELC50PD
 10747     MOVE +1                     TO SUB5.                         ELC50PD
 10748                                                                  ELC50PD
 10749     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10750        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10751                                                                  ELC50PD
 10752 0313-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10753                                                                  ELC50PD
 10754     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1            ELC50PD
 10755        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)                 ELC50PD
 10756           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10757                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10758           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10759                                                                  ELC50PD
 10760     IF SUB5 LESS THAN +30                                        ELC50PD
 10761        ADD +1                   TO SUB5                          ELC50PD
 10762        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10763                                                                  ELC50PD
 10764     MOVE +1                     TO SUB5.                         ELC50PD
 10765                                                                  ELC50PD
 10766 03XX-EDIT-FOR-NINETY-AH.                                         ELC50PD
 10767                                                                  ELC50PD
 10768***************************************************************   ELC50PD
 10769*                                                             *   ELC50PD
 10770*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10771*                                                             *   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 197
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10772*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10773*      92 = ALL GROUP REDUCING BENEFITS.                      *   ELC50PD
 10774*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10775*           BENEFIT CONTROLS.                                 *   ELC50PD
 10776*      99 = ALL BENEFITS.                                     *   ELC50PD
 10777*                                                             *   ELC50PD
 10778***************************************************************   ELC50PD
 10779                                                                  ELC50PD
 10780     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10781                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10782                                                                  ELC50PD
 10783     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10784       AND                                                        ELC50PD
 10785        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10786        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10787                                                                  ELC50PD
 10788     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'                         ELC50PD
 10789       AND                                                        ELC50PD
 10790        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10791           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10792              OR                                                  ELC50PD
 10793           ((AM-IG = '1') AND                                     ELC50PD
 10794           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10795              OR                                                  ELC50PD
 10796           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10797           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10798           (AM-IG NOT = '2'))                                     ELC50PD
 10799              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10800                                                                  ELC50PD
 10801     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'                         ELC50PD
 10802       AND                                                        ELC50PD
 10803        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10804           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10805              OR                                                  ELC50PD
 10806           ((AM-IG = '2') AND                                     ELC50PD
 10807           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10808              OR                                                  ELC50PD
 10809           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10810           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10811           (AM-IG NOT = '1'))                                     ELC50PD
 10812              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10813                                                                  ELC50PD
 10814     IF SUB5 LESS THAN +20                                        ELC50PD
 10815        ADD +1                   TO SUB5                          ELC50PD
 10816        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10817                                                                  ELC50PD
 10818     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10819        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.                       ELC50PD
 10820                                                                  ELC50PD
 10821     MOVE +1                    TO SUB5.                          ELC50PD
 10822                                                                  ELC50PD
 10823 03XX-EDIT-DMD-EXTRA-NINETY-AH.                                   ELC50PD
 10824                                                                  ELC50PD
 10825     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10826                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10827                                                                  ELC50PD
 10828     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10829       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 198
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10830        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10831        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10832                                                                  ELC50PD
 10833     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'                     ELC50PD
 10834       AND                                                        ELC50PD
 10835        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10836           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10837              OR                                                  ELC50PD
 10838           ((AM-IG = '1') AND                                     ELC50PD
 10839           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10840              OR                                                  ELC50PD
 10841           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10842           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10843           (AM-IG NOT = '2'))                                     ELC50PD
 10844              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10845                                                                  ELC50PD
 10846     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'                     ELC50PD
 10847       AND                                                        ELC50PD
 10848        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10849           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10850              OR                                                  ELC50PD
 10851           ((AM-IG = '2') AND                                     ELC50PD
 10852           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10853              OR                                                  ELC50PD
 10854           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10855           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10856           (AM-IG NOT = '1'))                                     ELC50PD
 10857              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10858                                                                  ELC50PD
 10859     IF SUB5 LESS THAN +30                                        ELC50PD
 10860        ADD +1                   TO SUB5                          ELC50PD
 10861        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.                      ELC50PD
 10862                                                                  ELC50PD
 10863 03XX-EDIT-FOR-NINETY-AH-CONT.                                    ELC50PD
 10864                                                                  ELC50PD
 10865     MOVE +99                    TO SUB5.                         ELC50PD
 10866                                                                  ELC50PD
 10867     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10868                                                                  ELC50PD
 10869     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10870        IF PB-ISSUE                                               ELC50PD
 10871           MOVE ER-1925          TO  WS-ERROR                     ELC50PD
 10872           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10873                                                                  ELC50PD
 10874     GO TO 0314-A-H-BENEFIT-FOUND.                                ELC50PD
 10875                                                                  ELC50PD
 10876 03XX-GET-AH-ERPLAN.                                              ELC50PD
 10877                                                                  ELC50PD
 10878     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10879         GO TO 03XX-ERPLAN-AH-GETMAIN.                            ELC50PD
 10880                                                                  ELC50PD
 10881     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10882     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10883     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10884     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 10885     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10886                                    PLAN-MASTER-AH-SW.            ELC50PD
 10887*****GO TO XXXX-CHECK-AH-PLAN-KEY.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 199
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10888     GO TO 03XX-ERPLAN-AH-READ.                                   ELC50PD
 10889                                                                  ELC50PD
 10890 03XX-ERPLAN-AH-GETMAIN.                                          ELC50PD
 10891                                                                  ELC50PD
 10892     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10893     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10894                                                                  ELC50PD
 10895 03XX-ERPLAN-AH-READ.                                             ELC50PD
 10896                                                                  ELC50PD
 10897     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10898     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10899     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10900     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10901     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10902     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.            ELC50PD
 10903     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10904     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10905                                 TO PLAN-REVISION-NO.             ELC50PD
 10906                                                                  ELC50PD
 10907     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10908     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.            ELC50PD
 10909                                                                  ELC50PD
 10910     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10911       IF NOT AH-PLAN-MASTER-FOUND                                ELC50PD
 10912         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10913            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10914             MOVE  ER-1922         TO  WS-ERROR                   ELC50PD
 10915             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10916             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10917                                                                  ELC50PD
 10918     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 10919        GO TO 0314-A-H-BENEFIT-FOUND.                             ELC50PD
 10920                                                                  ELC50PD
 10921 XXXX-CHECK-AH-PLAN-KEY.                                          ELC50PD
 10922                                                                  ELC50PD
 10923     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10924        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10925        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10926        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10927        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10928        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR          ELC50PD
 10929        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10930        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10931        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10932          GO TO 03XX-ERPLAN-AH-READ.                              ELC50PD
 10933                                                                  ELC50PD
 10934     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.            ELC50PD
 10935                                                                  ELC50PD
 10936     IF  PB-CANCELLATION                                          ELC50PD
 10937         GO TO  0313-AH-ACCT-BEN-FOUND.                           ELC50PD
 10938                                                                  ELC50PD
 10939     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10940       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND         ELC50PD
 10941          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)        ELC50PD
 10942          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO         ELC50PD
 10943             MOVE ER-2644             TO WS-ERROR                 ELC50PD
 10944             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 10945          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 200
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10946             NEXT SENTENCE                                        ELC50PD
 10947       ELSE                                                       ELC50PD
 10948          IF PB-COMPANY-ID NOT = 'NCL'                            ELC50PD
 10949             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS           ELC50PD
 10950                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.     ELC50PD
 10951                                                                  ELC50PD
 10952 0313-AH-ACCT-BEN-FOUND.                                          ELC50PD
 10953                                                                  ELC50PD
 10954     MOVE PL-REVISION-NO         TO WS-AH-REVISION.               ELC50PD
 10955                                                                  ELC50PD
 10956     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10957        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.         ELC50PD
 10958                                                                  ELC50PD
 10959     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10960        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10961        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.           ELC50PD
 10962                                                                  ELC50PD
 10963     IF PL-TOL-PREM-AMT NOT EQUAL +0                              ELC50PD
 10964        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.            ELC50PD
 10965                                                                  ELC50PD
 10966     IF PL-TOL-REF-AMT NOT EQUAL +0                               ELC50PD
 10967        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.          ELC50PD
 10968                                                                  ELC50PD
 10969     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10970        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.        ELC50PD
 10971                                                                  ELC50PD
 10972     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10973        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.      ELC50PD
 10974                                                                  ELC50PD
 10975     IF PL-TOL-CLM-AMT NOT EQUAL +0                               ELC50PD
 10976        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.           ELC50PD
 10977                                                                  ELC50PD
 10978     IF PL-OVER-SHORT-AMT NUMERIC AND                             ELC50PD
 10979                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10980        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.         ELC50PD
 10981                                                                  ELC50PD
 10982     IF PL-OVER-SHORT-PCT NUMERIC AND                             ELC50PD
 10983                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10984        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.           ELC50PD
 10985                                                                  ELC50PD
 10986     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10987        MOVE PL-IG               TO WS-IG-OVRD-AH-PL              ELC50PD
 10988        IF WS-IG-OVRD-AM EQUAL SPACES                             ELC50PD
 10989            MOVE PL-IG           TO WS-IG-OVRD-AM.                ELC50PD
 10990                                                                  ELC50PD
 10991 0314-A-H-BENEFIT-FOUND.                                          ELC50PD
 10992                                                                  ELC50PD
 10993     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.     ELC50PD
 10994                                                                  ELC50PD
 10995     IF PB-ISSUE                                                  ELC50PD
 10996        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR             ELC50PD
 10997       ELSE                                                       ELC50PD
 10998        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.           ELC50PD
 10999                                                                  ELC50PD
 11000     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.   ELC50PD
 11001     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.   ELC50PD
 11002     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.       ELC50PD
 11003     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 201
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11004                                         WS-AH-REFUND-CALC.       ELC50PD
 11005                                                                  ELC50PD
 11006     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 11007        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.    ELC50PD
 11008                                                                  ELC50PD
 11009     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 11010        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.  ELC50PD
 11011
 11012     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
 11013                                                                  ELC50PD
 11014     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.  ELC50PD
 11015     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.ELC50PD
 11016     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.     ELC50PD
 11017     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.  ELC50PD
 11018     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.    ELC50PD
 11019     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11020                                                                  ELC50PD
 11021     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 11022        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 11023         NEXT SENTENCE                                            ELC50PD
 11024     ELSE                                                         ELC50PD
 11025         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 11026            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'             ELC50PD
 11027                MOVE WS-SAVE-BENEFIT-REM-TERM                     ELC50PD
 11028                                      TO WS-AM-AH-BENE-REM-TERM   ELC50PD
 11029                                         EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11030                                                                  ELC50PD
 11031     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.        ELC50PD
 11032     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.           ELC50PD
 11033                                                                  ELC50PD
 11034     GO TO 0400-FIND-CARRIER.                                     ELC50PD
 11035                                                                  ELC50PD
 11036 0399-BENEFIT-NOT-FOUND.                                          ELC50PD
 11037                                                                  ELC50PD
 11038     MOVE '1'                    TO AH-BENEFIT-ERROR.             ELC50PD
 11039     MOVE ER-2605                TO WS-ERROR.                     ELC50PD
 11040     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11041                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 202
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11043                                                                  ELC50PD
 11044 0400-FIND-CARRIER.                                               ELC50PD
 11045                                                                  ELC50PD
 11046     MOVE PB-SV-CARRIER          TO WS-CARR.                      ELC50PD
 11047                                                                  ELC50PD
 11048     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11049     MOVE ZEROS                  TO CNTL-SEQ-NO.                  ELC50PD
 11050     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  ELC50PD
 11051     MOVE '6'                    TO CNTL-REC-TYPE.                ELC50PD
 11052                                                                  ELC50PD
 11053*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD                   ELC50PD
 11054     MOVE SPACE                  TO WS-DMD-RATING-SW              ELC50PD
 11055                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11056                                                                  ELC50PD
 11057     MOVE '2'                    TO RC-SW-1.                      ELC50PD
 11058     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
 11059                                                                  ELC50PD
 11060     IF NOT CF-CARRIER-MASTER                                     ELC50PD
 11061        GO TO 0400-CARRIER-NOT-FOUND.                             ELC50PD
 11062                                                                  ELC50PD
 11063 0400-BUILD-CARR-TOL.                                             ELC50PD
 11064                                                                  ELC50PD
 11065     IF CF-CR-TOL-PREM NUMERIC AND                                ELC50PD
 11066        CF-CR-TOL-PREM GREATER THAN +0                            ELC50PD
 11067        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11068                                    WS-TOL-AH-PREM.               ELC50PD
 11069                                                                  ELC50PD
 11070     IF CF-CR-TOL-REFUND NUMERIC AND                              ELC50PD
 11071        CF-CR-TOL-REFUND GREATER THAN +0                          ELC50PD
 11072        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND              ELC50PD
 11073                                    WS-TOL-AH-REFUND.             ELC50PD
 11074                                                                  ELC50PD
 11075     IF CF-CR-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11076        CF-CR-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11077        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11078                                    WS-AH-REFUND-OVS-AMT.         ELC50PD
 11079                                                                  ELC50PD
 11080     IF CF-CR-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11081        CF-CR-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11082        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11083                                    WS-AH-REFUND-OVS-PCT.         ELC50PD
 11084                                                                  ELC50PD
 11085     IF CF-CR-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11086        CF-CR-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11087        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT            ELC50PD
 11088                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11089                                                                  ELC50PD
 11090     IF CF-CR-TOL-REFUND-PCT NUMERIC AND                          ELC50PD
 11091        CF-CR-TOL-REFUND-PCT GREATER THAN +0                      ELC50PD
 11092        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT         ELC50PD
 11093                                     WS-TOL-AH-REFUND-PCT.        ELC50PD
 11094                                                                  ELC50PD
 11095     IF CF-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 11096         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW              ELC50PD
 11097                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11098                                                                  ELC50PD
 11099     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
 11100     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 203
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11101        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
 11102     END-IF
 11103     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
 11104        MOVE +0                  TO CF-CARRIER-LEASE-COMM
 11105     END-IF
 11106     IF WS-TOL-CLP-PCT = ZEROS
 11107        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
 11108     END-IF
 11109
 11110     IF WS-SPP-LEASE-COMM = ZEROS
 11111        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
 11112     END-IF
 11113
 11114     GO TO 0400-FIND-ERPDEF.
 11115                                                                  ELC50PD
 11116 0400-CARRIER-NOT-FOUND.                                          ELC50PD
 11117                                                                  ELC50PD
 11118     MOVE ER-2602                TO WS-ERROR.                     ELC50PD
 11119     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11120                                                                  ELC50PD
 11121 0400-FIND-ERPDEF.
 11122
 11123     IF PB-COMPANY-ID = 'DCC'
 11124        AND AM-DCC-PRODUCT-CODE = 'DDF'
 11125        CONTINUE
 11126     ELSE
 11127        GO TO 0400-FIND-ERCOMP
 11128     END-IF
 11129
 11130     MOVE ' '                    TO PDEF-MASTER-SW
 11131     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
 11132     MOVE PB-STATE               TO ERPDEF-STATE
 11133     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
 11134     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 11135     IF PB-ISSUE
 11136        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
 11137     ELSE
 11138        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 11139     END-IF
 11140     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
 11141     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 11142     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
 11143     IF PDEF-MASTER-FOUND
 11144        MOVE 'N'                 TO PDEF-MASTER-SW
 11145        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11146        IF PDEF-MASTER-FOUND
 11147           IF (ERPDEF-KEY-SAVE (1:16) =
 11148                        PD-CONTROL-PRIMARY (1:16))
 11149              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11150              CONTINUE
 11151           ELSE
 11152              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11153              IF (ERPDEF-KEY-SAVE (1:16) =
 11154                        PD-CONTROL-PRIMARY (1:16))
 11155                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11156                 CONTINUE
 11157              ELSE
 11158                 MOVE 'N'        TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 204
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11159              END-IF
 11160           END-IF
 11161        END-IF
 11162        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 11163     END-IF
 11164     IF PDEF-MASTER-FOUND
 11165        IF PD-TRUNCATED = 'Y'
 11166           MOVE 'T'              TO WS-AH-DCC-TRUNC
 11167        END-IF
 11168     END-IF
 11169
 11170     .
 11171 0400-FIND-ERCOMP.
 11172
 11173     IF PB-COMPANY-ID = 'DCC'
 11174        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11175           (WS-SUB1 > +10)
 11176           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
 11177                 OR 'A' OR 'N'
 11178              MOVE PB-COMPANY-CD TO COMP-COMP-CD
 11179              MOVE PB-CARRIER    TO COMP-CARRIER
 11180              MOVE PB-GROUPING   TO COMP-GROUPING
 11181              MOVE LOW-VALUES    TO COMP-ACCOUNT
 11182              MOVE AM-AGT (WS-SUB1)
 11183                                 TO COMP-FIN-RESP
 11184              MOVE 'G'           TO COMP-TYPE
 11185              PERFORM 8582-READ-COMPENSATION-MASTER
 11186                                 THRU 8582-EXIT
 11187              IF COMP-MASTER-FOUND
 11188                 IF CO-GA-INACTIVE
 11189                    MOVE ER-2763 TO WS-ERROR
 11190                    PERFORM 9900-ERROR-FORMAT
 11191                                 THRU 9900-EXIT
 11192                    MOVE +11     TO WS-SUB1
 11193                 END-IF
 11194                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11195                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11196                    MOVE ER-2788 TO WS-ERROR
 11197                    PERFORM 9900-ERROR-FORMAT
 11198                                 THRU 9900-EXIT
 11199                    MOVE +11     TO WS-SUB1
 11200                 END-IF
 11201              END-IF
 11202           END-IF
 11203        END-PERFORM
 11204     END-IF
 11205
 11206     IF PB-COMPANY-ID = 'DCC'
 11207        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
 11208           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
 11209                                    WS-CLP-STATE
 11210        ELSE
 11211           MOVE SPACES           TO PB-I-CLP-STATE
 11212                                    WS-CLP-STATE
 11213        END-IF
 11214     END-IF
 11215
 11216     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 205
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11217        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
 11218        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 11219        CONTINUE
 11220     ELSE
 11221        GO TO 0400-FIND-STATE-RECORD
 11222     END-IF
 11223
 11224     MOVE SPACES                 TO WS-CLP-STATE
 11225     MOVE +0                     TO WS-BANK-FEE
 11226                                    WS-BANK-LFEE
 11227                                    WS-BANK-NOCHRGB
 11228
 11229     MOVE LOW-VALUES             TO COMP-FIN-RESP
 11230
 11231     IF (PB-ISSUE)
 11232        AND (PB-I-BANK-NUMBER NOT =
 11233            SPACES AND ZEROS AND LOW-VALUES)
 11234        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
 11235     ELSE
 11236        IF (PB-CANCELLATION)
 11237           AND (PB-CI-BANK-NUMBER NOT =
 11238                SPACES AND ZEROS AND LOW-VALUES)
 11239           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
 11240        END-IF
 11241     END-IF
 11242
 11243     IF COMP-FIN-RESP NOT = LOW-VALUES
 11244        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
 11245        MOVE PB-CARRIER          TO COMP-CARRIER
 11246        MOVE PB-GROUPING         TO COMP-GROUPING
 11247        MOVE LOW-VALUES          TO COMP-ACCOUNT
 11248        MOVE 'B'                 TO COMP-TYPE
 11249        PERFORM 8582-READ-COMPENSATION-MASTER
 11250                                 THRU 8582-EXIT
 11251        IF COMP-MASTER-FOUND
 11252           IF CO-MAX-BANK-FEE NOT NUMERIC
 11253              MOVE +0            TO CO-MAX-BANK-FEE
 11254           END-IF
 11255           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
 11256              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
 11257           END-IF
 11258           IF CO-GA-INACTIVE
 11259              MOVE ER-2763       TO WS-ERROR
 11260              PERFORM 9900-ERROR-FORMAT
 11261                                 THRU 9900-EXIT
 11262           END-IF
 11263           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11264              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11265              MOVE ER-2788 TO WS-ERROR
 11266              PERFORM 9900-ERROR-FORMAT
 11267                                 THRU 9900-EXIT
 11268              MOVE +11     TO WS-SUB1
 11269           END-IF
 11270           IF WS-AH-BEN-CATEGORY = 'G'
 11271              MOVE CO-MAX-BANK-FEE
 11272                                 TO WS-BANK-FEE
 11273                                    PB-I-BANK-FEE
 11274           ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 206
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11275              MOVE CO-MAX-BANK-FEE-LEASE
 11276                                 TO WS-BANK-LFEE
 11277                                    PB-I-BANK-FEE
 11278           END-IF
 11279           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
 11280              AND (WS-AH-REFUND-CALC = 'G'))
 11281                        OR
 11282              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
 11283              AND (WS-AH-REFUND-CALC NOT = 'G'))
 11284              CONTINUE
 11285           ELSE
 11286              MOVE ER-2789 TO WS-ERROR
 11287              PERFORM 9900-ERROR-FORMAT
 11288                                 THRU 9900-EXIT
 11289           END-IF
 11290           MOVE CO-CLP-STATE     TO WS-CLP-STATE
 11291                                    PB-I-CLP-STATE
 11292           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
 11293           MOVE CO-CARRIER       TO BXRF-CARRIER
 11294           MOVE CO-GROUPING      TO BXRF-GROUPING
 11295           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
 11296           MOVE BXRF-MAX-REC-LENGTH
 11297                                 TO BXRF-REC-LENGTH
 11298           PERFORM 8584-READ-BANK-CROSS-REF
 11299                                 THRU 8584-EXIT
 11300           IF BXRF-MASTER-FOUND
 11301              MOVE ' '           TO BANK-ACCT-SW
 11302              MOVE BK-BANK-POINTER-CNT
 11303                                 TO BK-BANK-POINTER-CNT
 11304              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11305                 (WS-SUB1 > BK-BANK-POINTER-CNT)
 11306                 OR (BANK-ACCT-FOUND)
 11307                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
 11308                    AND (BK-AM-EXP-DT (WS-SUB1)
 11309                                 > PB-CERT-EFF-DT)
 11310                    AND (BK-AM-EFF-DT (WS-SUB1)
 11311                                 NOT > PB-CERT-EFF-DT)
 11312                    SET BANK-ACCT-FOUND TO TRUE
 11313                 END-IF
 11314              END-PERFORM
 11315              IF NOT BANK-ACCT-FOUND
 11316                 MOVE ZEROS      TO WS-BANK-FEE
 11317                                    WS-BANK-LFEE
 11318                 MOVE ER-2869    TO WS-ERROR
 11319                 PERFORM 9900-ERROR-FORMAT
 11320                                 THRU 9900-EXIT
 11321              ELSE
 11322                 PERFORM 5000-PROCESS-REPS
 11323                                 THRU 5000-EXIT
 11324                 IF AGENT-MASTER-FOUND
 11325                    MOVE +0      TO WS-BANK-FEE
 11326                                    WS-BANK-LFEE
 11327*                   MOVE AG-SPP-FEES (1)
 11328*                                TO PB-I-BANK-FEE
 11329*                                   WS-BANK-FEE
 11330                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11331                       (WS-SUB1 > +10)
 11332                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 207
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11333                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
 11334                       END-IF
 11335                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
 11336                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
 11337                       END-IF
 11338                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
 11339                          AG-SPP-FEES (WS-SUB1)
 11340                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
 11341                          AG-SPP-LFEES (WS-SUB1)
 11342                    END-PERFORM
 11343                    IF WS-AH-BEN-CATEGORY = 'G'
 11344                       MOVE WS-BANK-FEE
 11345                                 TO PB-I-BANK-FEE
 11346                    ELSE
 11347                       MOVE WS-BANK-LFEE
 11348                                 TO PB-I-BANK-FEE
 11349                    END-IF
 11350                 END-IF
 11351              END-IF
 11352           END-IF
 11353        ELSE
 11354           MOVE ER-2879          TO WS-ERROR
 11355           PERFORM 9900-ERROR-FORMAT
 11356                                 THRU 9900-EXIT
 11357        END-IF
 11358     ELSE
 11359        MOVE ER-2879             TO WS-ERROR
 11360        PERFORM 9900-ERROR-FORMAT
 11361                                 THRU 9900-EXIT
 11362     END-IF
 11363
 11364     IF WS-AH-BEN-CATEGORY = 'G'
 11365        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11366        + WS-BANK-FEE
 11367     ELSE
 11368        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11369        + WS-BANK-LFEE
 11370     END-IF
 11371
 11372     .
 11373 0400-FIND-STATE-RECORD.                                          ELC50PD
 11374                                                                  ELC50PD
 11375     IF WK-STATE-ADDR NOT = ZEROS                                 ELC50PD
 11376         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP                ELC50PD
 11377         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 11378         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 11379         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT           CL**2
 11380         IF PB-SV-STATE = CF-STATE-CODE                           ELC50PD
 11381             GO TO 0405-CONTINUE-EDIT                             ELC50PD
 11382         ELSE                                                     ELC50PD
 11383             NEXT SENTENCE                                        ELC50PD
 11384     ELSE                                                         ELC50PD
 11385         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 11386                                                                  ELC50PD
 11387     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11388     MOVE PB-SV-STATE            TO CNTL-ACCESS.                  ELC50PD
 11389     MOVE '3'                    TO CNTL-REC-TYPE.                ELC50PD
 11390     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 208
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11391                                                                  ELC50PD
 11392     MOVE '3'                    TO RC-SW-2.                      ELC50PD
 11393     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 11394                                                                  ELC50PD
 11395     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR                    ELC50PD
 11396        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR                     ELC50PD
 11397        PB-SV-STATE   NOT = CF-STATE-CODE)                        ELC50PD
 11398        MOVE ZEROS               TO WS-TOL-LF-CLAIM               ELC50PD
 11399                                    WS-TOL-AH-CLAIM               ELC50PD
 11400                                    WS-MINIMUM-REFUND             ELC50PD
 11401                                    WS-TOL-LF-PREM                ELC50PD
 11402                                    WS-TOL-AH-PREM                ELC50PD
 11403                                    WS-TOL-LF-REFUND              ELC50PD
 11404                                    WS-TOL-AH-REFUND              ELC50PD
 11405                                    EC-ST-TOL-PREM-PCT            ELC50PD
 11406                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11407                                    WS-TOL-AH-PREM-PCT            ELC50PD
 11408                                    EC-ST-TOL-REFUND-PCT          ELC50PD
 11409                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11410                                    WS-TOL-AH-REFUND-PCT          ELC50PD
 11411                                    EC-ST-TOL-PREM                ELC50PD
 11412                                    EC-ST-TOL-REFUND              ELC50PD
 11413                                    EC-ST-FST-PMT-DAYS-MAX        ELC50PD
 11414                                    WS-FREE-LOOK-PERIOD           ELC50PD
 11415                                    WS-ST-LF-PREM-TAX
 11416                                    WS-ST-AH-PREM-TAX-I
 11417                                    WS-ST-AH-PREM-TAX-G
 11418                                    WS-BANK-FEE
 11419                                    WS-BANK-LFEE
 11420                                    WS-TOL-CLP-PCT
 11421                                    WS-SPP-LEASE-COMM
 11422        MOVE SPACES              TO WS-STATE-ABBREVIATION         ELC50PD
 11423                                    EC-ST-FST-PMT-DAYS-CHG        ELC50PD
 11424                                    WS-LF-REM-TERM-CALC           ELC50PD
 11425                                    WS-LF-REFUND-CALC             ELC50PD
 11426                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11427                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11428                                    WS-AH-REM-TERM-CALC           ELC50PD
 11429                                    WS-AH-REFUND-CALC
 11430                                    WS-LF-BEN-CATEGORY
 11431                                    WS-AH-BEN-CATEGORY
 11432                                    WS-CLP-STATE
 11433                                    WS-ST-REFUND-CLAIM-FLAG
 11434                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11435                                    EC-ST-AH-REFUND-CALC          ELC50PD
 11436          GO TO 0499-STATE-NOT-FOUND.                             ELC50PD
 11437                                                                  ELC50PD
 11438     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.                ELC50PD
 11439                                                                  ELC50PD
 11440 0405-CONTINUE-EDIT.                                              ELC50PD
 11441
 11442     if pb-company-id = 'AHL'
 11443        continue
 11444     else
 11445        IF PB-CERT-PRIME NOT NUMERIC
 11446           MOVE ER-2722          TO WS-ERROR
 11447           PERFORM 9900-ERROR-FORMAT
 11448                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 209
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11449        end-if
 11450     END-IF
 11451
 11452*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11453*       MOVE +0                  TO SUB3
 11454*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
 11455*       IF SUB3 > +0
 11456*          MOVE ER-2722          TO WS-ERROR
 11457*          PERFORM 9900-ERROR-FORMAT
 11458*                                THRU 9900-EXIT
 11459*       END-IF
 11460*    END-IF
 11461
 11462
 11463*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11464*       IF PB-CERT-PRIME NOT NUMERIC
 11465*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
 11466*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
 11467*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
 11468*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
 11469*
 11470*          MOVE ER-2722          TO WS-ERROR
 11471*          PERFORM 9900-ERROR-FORMAT
 11472*                                THRU 9900-EXIT
 11473*       END-IF
 11474*    END-IF
 11475
 11476     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.        ELC50PD
 11477                                                                  ELC50PD
 11478     IF CF-ST-TOL-CLAIM NOT = ZEROS                               ELC50PD
 11479        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM               ELC50PD
 11480                                    WS-TOL-AH-CLAIM.              ELC50PD
 11481                                                                  ELC50PD
 11482     IF CF-ST-REFUND-MIN NOT NUMERIC                              ELC50PD
 11483        MOVE ZEROS               TO CF-ST-REFUND-MIN.             ELC50PD
 11484                                                                  ELC50PD
 11485     IF CF-ST-REFUND-MIN NOT = ZEROS                              ELC50PD
 11486        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.            ELC50PD
 11487                                                                  ELC50PD
 11488     IF CF-ST-TOL-PREM  NOT = ZEROS                               ELC50PD
 11489        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11490                                    WS-TOL-AH-PREM                ELC50PD
 11491        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.           ELC50PD
 11492                                                                  ELC50PD
 11493     IF CF-ST-TOL-REFUND NOT = ZEROS                              ELC50PD
 11494        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND              ELC50PD
 11495                                    WS-TOL-AH-REFUND              ELC50PD
 11496        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.             ELC50PD
 11497                                                                  ELC50PD
 11498     IF CF-ST-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11499        CF-ST-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11500        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11501                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11502                                    EC-ST-OVR-SHT-AMT.            ELC50PD
 11503                                                                  ELC50PD
 11504     IF CF-ST-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11505        CF-ST-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11506        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 210
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11507                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11508                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11509                                                                  ELC50PD
 11510     IF CF-ST-TOL-REF-PCT NUMERIC AND                             ELC50PD
 11511        CF-ST-TOL-REF-PCT GREATER THAN +0                         ELC50PD
 11512        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT          ELC50PD
 11513                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11514                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11515                                                                  ELC50PD
 11516     IF CF-ST-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11517        CF-ST-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11518        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11519                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11520                                    EC-ST-OVR-SHT-PCT.            ELC50PD
 11521                                                                  ELC50PD
 11522     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.               ELC50PD
 11523     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.             ELC50PD
 11524                                                                  ELC50PD
 11525     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC                        ELC50PD
 11526          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11527                                                                  ELC50PD
 11528     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11529     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.       ELC50PD
 11530
 11531     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.          ELC50PD
 11532                                                                  ELC50PD
 11533     IF CF-ST-LF-PREM-TAX NUMERIC
 11534        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11535     END-IF
 11536     IF CF-ST-AH-PREM-TAX-I NUMERIC
 11537        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11538     END-IF
 11539     IF CF-ST-AH-PREM-TAX-G NUMERIC
 11540        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11541     END-IF
 11542
 11543     IF CF-ST-REF-AH-DEATH-IND > SPACES
 11544         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 11545     END-IF.
 11546
 11547     IF WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 11548        GO TO 0410-CHECK-AH.                                      ELC50PD
 11549                                                                  ELC50PD
 11550     IF CF-ST-RT-CALC NOT = SPACES
 11551        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11552                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11553     END-IF
 11554
 11555     IF WS-LF-COVERAGE-TYPE = 'R'
 11556        IF WS-LF-EARNINGS-CALC = '5'
 11557           IF CF-ST-RF-LN-CALC > '0'
 11558              MOVE CF-ST-RF-LN-CALC
 11559                                 TO WS-LF-REFUND-CALC
 11560                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11561           END-IF
 11562        ELSE
 11563           IF CF-ST-RF-LR-CALC > '0'
 11564              MOVE CF-ST-RF-LR-CALC
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 211
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11565                                 TO WS-LF-REFUND-CALC
 11566                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11567           END-IF
 11568        END-IF
 11569     ELSE
 11570        IF CF-ST-RF-LL-CALC > '0'
 11571           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 11572                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11573        END-IF
 11574     END-IF
 11575
 11576     IF CF-ST-RT-CALC NOT = SPACES
 11577        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11578                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11579     END-IF
 11580
 11581     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11582     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.               ELC50PD
 11583                                                                  ELC50PD
 11584     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11585                                                                  ELC50PD
 11586     IF NO-BENEFIT-FOUND                                          ELC50PD
 11587        GO TO 0410-CHECK-AH.                                      ELC50PD
 11588                                                                  ELC50PD
 11589     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11590        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 11591                                 TO EC-ST-LF-REM-TERM-CALC
 11592                                    WS-LF-REM-TERM-CALC           ELC50PD
 11593     END-IF
 11594                                                                  ELC50PD
 11595     IF CF-ST-REFUND-CALC (SUB3) > '0'                            ELC50PD
 11596        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11597                                 TO WS-LF-REFUND-CALC             ELC50PD
 11598                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11599     END-IF
 11600*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.  ELC50PD
 11601                                                                  ELC50PD
 11602     .                                                            ELC50PD
 11603 0410-CHECK-AH.                                                   ELC50PD
 11604                                                                  ELC50PD
 11605     IF WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 11606        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11607                                                                  ELC50PD
 11608     IF CF-ST-RT-CALC NOT = SPACES
 11609        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 11610                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11611     END-IF
 11612
 11613     IF WS-AH-SPECIAL-CALC-CD = 'C'
 11614        IF CF-ST-RF-CP-CALC > '0'
 11615           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 11616                                    EC-ST-AH-REFUND-CALC
 11617        END-IF
 11618     ELSE
 11619        IF CF-ST-RF-AH-CALC > '0'
 11620           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 11621                                    EC-ST-AH-REFUND-CALC
 11622        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 212
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11623     END-IF
 11624     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11625     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE                ELC50PD
 11626                                                                  ELC50PD
 11627     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11628                                                                  ELC50PD
 11629     IF NO-BENEFIT-FOUND                                          ELC50PD
 11630        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11631                                                                  ELC50PD
 11632     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11633        MOVE CF-ST-REM-TERM-CALC (SUB3)                           ELC50PD
 11634                                 TO WS-AH-REM-TERM-CALC           ELC50PD
 11635                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11636     END-IF
 11637                                                                  ELC50PD
 11638     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'                   ELC50PD
 11639        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11640                                 TO WS-AH-REFUND-CALC             ELC50PD
 11641                                    EC-ST-AH-REFUND-CALC
 11642     END-IF
 11643                                                                  ELC50PD
 11644*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.  ELC50PD
 11645                                                                  ELC50PD
 11646     GO TO 0500-SET-ACCOUNT.                                      ELC50PD
 11647                                                                  ELC50PD
 11648 0499-STATE-NOT-FOUND.                                            ELC50PD
 11649                                                                  ELC50PD
 11650     MOVE ER-2603                TO WS-ERROR.                     ELC50PD
 11651     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11652                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 213
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11654                                                                  ELC50PD
 11655 0500-SET-ACCOUNT.                                                ELC50PD
 11656
 11657*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 11658
 11659     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11660        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 11661        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 11662        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 11663        MOVE '3'                 TO CNTL-REC-TYPE
 11664        MOVE +0                  TO CNTL-SEQ-NO
 11665
 11666        MOVE '3'                 TO RC-SW-2
 11667        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 11668
 11669        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 11670           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 11671           WS-CLP-STATE  NOT = CF-STATE-CODE)
 11672           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 11673                                    WS-ST-AH-PREM-TAX-I
 11674                                    WS-ST-AH-PREM-TAX-G
 11675        ELSE
 11676           IF CF-ST-LF-PREM-TAX NUMERIC
 11677              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11678           END-IF
 11679           IF CF-ST-AH-PREM-TAX-I NUMERIC
 11680              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11681           END-IF
 11682           IF CF-ST-AH-PREM-TAX-G NUMERIC
 11683              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11684           END-IF
 11685        END-IF
 11686        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 11687     END-IF
 11688
 11689*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 11690*  FOR DCC ONLY
 11691
 11692     IF PB-COMPANY-ID = 'DCC'
 11693
 11694     MOVE ' '                    TO STAT-MASTER-SW
 11695     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 11696     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 11697     MOVE PB-GROUPING            TO ELSTAT-GROUP
 11698     MOVE PB-STATE               TO ELSTAT-STATE
 11699     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11700        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 11701     END-IF
 11702
 11703     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11704     SET BIN-TO-GREG             TO TRUE
 11705     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 11706     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 11707     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 11708
 11709     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 11710     IF STAT-MASTER-FOUND
 11711        MOVE 'N'                 TO STAT-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 214
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11712        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11713        IF STAT-MASTER-FOUND
 11714           IF (ELSTAT-KEY-SAVE (1:12) =
 11715                        SF-CONTROL-PRIMARY (1:12))
 11716              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11717                 MOVE 'F'        TO STAT-MASTER-SW
 11718              ELSE
 11719                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11720                 IF (STAT-MASTER-FOUND)
 11721                    AND (ELSTAT-KEY-SAVE (1:12) =
 11722                        SF-CONTROL-PRIMARY (1:12))
 11723                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11724                    MOVE 'F'     TO STAT-MASTER-SW
 11725                 END-IF
 11726              END-IF
 11727           END-IF
 11728        END-IF
 11729     END-IF
 11730
 11731     IF STAT-MASTER-SW = 'F'
 11732        IF SF-ST-LF-PREM-TAX NUMERIC
 11733           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11734        END-IF
 11735        IF SF-ST-AH-PREM-TAX-I NUMERIC
 11736           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11737        END-IF
 11738        IF SF-ST-AH-PREM-TAX-G NUMERIC
 11739           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11740        END-IF
 11741     END-IF
 11742
 11743     END-IF
 11744
 11745     IF (PB-COMPANY-ID = 'DCC')
 11746        AND (PB-ISSUE)
 11747        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11748        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 11749        AND (AM-GPCD = 06)
 11750        MOVE 'Y'                 TO WS-GOOD-HIN
 11751        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11752           MOVE PB-I-VIN         TO WS-WORK-VIN
 11753           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11754              (V1 > 16)
 11755              IF WS-WORK-VIN (V1:1) NUMERIC
 11756                 MOVE WS-WORK-VIN-N (V1)
 11757                                 TO WS-ROW-B-VAL (V1)
 11758              ELSE
 11759                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 11760                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 11761                    OR (V2 > 26)
 11762                 END-PERFORM
 11763                 IF V2 < 27
 11764                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 11765                 ELSE
 11766                    MOVE 'N'     TO WS-GOOD-HIN
 11767                 END-IF
 11768              END-IF
 11769              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 215
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11770                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 11771              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 11772                 WS-ROW-D-VAL (V1)
 11773           END-PERFORM
 11774           MOVE ZEROS            TO WS-VIN-REMAINDER
 11775           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 11776             REMAINDER WS-VIN-REMAINDER
 11777           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 11778              CONTINUE
 11779           ELSE
 11780              MOVE 'N'           TO WS-GOOD-HIN
 11781           END-IF
 11782        ELSE
 11783           MOVE 'N'              TO WS-GOOD-HIN
 11784        END-IF
 11785        IF WS-GOOD-HIN NOT = 'Y'
 11786           MOVE ER-3826           TO WS-ERROR
 11787           PERFORM 9900-ERROR-FORMAT
 11788                                 THRU 9900-EXIT
 11789        END-IF
 11790     END-IF
 11791
 11792     IF (PB-COMPANY-ID = 'DCC')
 11793        AND (PB-ISSUE)
 11794        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11795        AND (AM-GPCD NOT = 06)
 11796        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11797          MOVE PB-I-VIN          TO WS-WORK-VIN
 11798          MOVE +8                TO V2
 11799          MOVE ZEROS             TO WS-VIN-TOTAL
 11800          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11801           (V1 > 17)
 11802             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 11803                MOVE ER-3825     TO WS-ERROR
 11804                PERFORM 9900-ERROR-FORMAT
 11805                                 THRU 9900-EXIT
 11806             ELSE
 11807                IF V1 = 8
 11808                   MOVE 10       TO V2
 11809                END-IF
 11810                IF V1 = 9
 11811                   MOVE 0        TO V2
 11812                END-IF
 11813                IF V1 = 10
 11814                   MOVE 9        TO V2
 11815                END-IF
 11816                IF WS-WORK-VIN (V1:1) NUMERIC
 11817                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11818                    + (WS-WORK-VIN-N (V1) * V2)
 11819                ELSE
 11820                   MOVE WS-WORK-VIN (V1:1)
 11821                                 TO WS-HEX-BYTE
 11822                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 11823                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11824                    + (WS-NUM (V3) * V2)
 11825                END-IF
 11826                COMPUTE V2 = V2 - 1
 11827             END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 216
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11828          END-PERFORM
 11829          MOVE ZEROS TO WS-VIN-REMAINDER
 11830          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 11831             REMAINDER WS-VIN-REMAINDER
 11832          IF ((WS-WORK-VIN (9:1) = 'X')
 11833             AND (WS-VIN-REMAINDER = 10))
 11834                     OR
 11835             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 11836             CONTINUE
 11837          ELSE
 11838             MOVE ER-3826        TO WS-ERROR
 11839             PERFORM 9900-ERROR-FORMAT
 11840                                 THRU 9900-EXIT
 11841          END-IF
 11842        ELSE
 11843          MOVE ER-3826           TO WS-ERROR
 11844          PERFORM 9900-ERROR-FORMAT
 11845                                 THRU 9900-EXIT
 11846        END-IF
 11847     END-IF
 11848
 11849
 11850
 11851******************************************************************ELC50PD
 11852******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM       ELC50PD
 11853******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND    ELC50PD
 11854******* METHODS.                                                  ELC50PD
 11855******************************************************************ELC50PD
 11856     IF PB-COMPANY-ID EQUAL TO 'NCL'                              ELC50PD
 11857        IF PB-CANCELLATION                                        ELC50PD
 11858           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)       ELC50PD
 11859              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))    ELC50PD
 11860                PERFORM 3350-GET-ERFORM THRU 3350-EXIT            ELC50PD
 11861                IF FORM-MASTER-FOUND                              ELC50PD
 11862                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.   ELC50PD
 11863******************************************************************ELC50PD
 11864                                                                  ELC50PD
 11865     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.               ELC50PD
 11866     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.               ELC50PD
 11867                                                                  ELC50PD
 11868     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.          ELC50PD
 11869     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.           ELC50PD
 11870     MOVE AM-STATUS              TO WS-ACCT-STATUS.               ELC50PD
 11871     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.          ELC50PD
 11872                                                                  ELC50PD
 11873                                                                  ELC50PD
 11874     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.        ELC50PD
 11875     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.               ELC50PD
 11876     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.          ELC50PD
 11877                                                                  ELC50PD
 11878     IF AM-LF-OB-RATE NOT NUMERIC                                 ELC50PD
 11879         MOVE ZERO               TO AM-LF-OB-RATE.                ELC50PD
 11880                                                                  ELC50PD
 11881     IF AM-LF-OB-RATE-JNT NOT NUMERIC                             ELC50PD
 11882         MOVE ZERO               TO AM-LF-OB-RATE-JNT.            ELC50PD
 11883                                                                  ELC50PD
 11884     IF AM-AH-OB-RATE NOT NUMERIC                                 ELC50PD
 11885         MOVE ZERO               TO AM-AH-OB-RATE.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 217
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11886                                                                  ELC50PD
 11887     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 11888         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT              ELC50PD
 11889     ELSE                                                         ELC50PD
 11890         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.             ELC50PD
 11891                                                                  ELC50PD
 11892     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.             ELC50PD
 11893                                                                  ELC50PD
 11894     IF WS-IG-OVRD-AM  EQUAL SPACE                                ELC50PD
 11895         MOVE AM-IG              TO WS-IG-OVRD-AM.                ELC50PD
 11896                                                                  ELC50PD
 11897     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE                          ELC50PD
 11898         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH              ELC50PD
 11899                                       WS-IG-OVRD                 ELC50PD
 11900     ELSE                                                         ELC50PD
 11901         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE                     ELC50PD
 11902             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH              ELC50PD
 11903                                       WS-IG-OVRD                 ELC50PD
 11904         ELSE                                                     ELC50PD
 11905             MOVE AM-IG             TO WS-IG-OVRD-AH              ELC50PD
 11906                                       WS-IG-OVRD.                ELC50PD
 11907                                                                  ELC50PD
 11908     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE                          ELC50PD
 11909         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF              ELC50PD
 11910                                       WS-IG-OVRD                 ELC50PD
 11911     ELSE                                                         ELC50PD
 11912         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE                     ELC50PD
 11913             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF              ELC50PD
 11914                                       WS-IG-OVRD                 ELC50PD
 11915         ELSE                                                     ELC50PD
 11916             MOVE AM-IG             TO WS-IG-OVRD-LF              ELC50PD
 11917                                       WS-IG-OVRD.                ELC50PD
 11918                                                                  ELC50PD
 11919     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11920     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11921     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11922     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.         ELC50PD
 11923     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 11924                                                                  ELC50PD
 11925     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.               ELC50PD
 11926     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.               ELC50PD
 11927     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.           ELC50PD
 11928     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.         ELC50PD
 11929                                                                  ELC50PD
 11930     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.           ELC50PD
 11931     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.         ELC50PD
 11932     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.             ELC50PD
 11933     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.           ELC50PD
 11934     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.          ELC50PD
 11935     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.                ELC50PD
 11936     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.                ELC50PD
 11937                                                                  ELC50PD
 11938     IF WS-ACCT-AH-DEV-PCT > +0                                   ELC50PD
 11939        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT       ELC50PD
 11940     ELSE                                                         ELC50PD
 11941        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.      ELC50PD
 11942                                                                  ELC50PD
 11943     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 218
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11944        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.      ELC50PD
 11945     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
 11946        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.      ELC50PD
 11947                                                                  ELC50PD
 11948        IF AM-EARN-METHOD-L = 'S'                                 ELC50PD
 11949            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11950                                        WS-LF-REFUND-CALC.        ELC50PD
 11951                                                                  ELC50PD
 11952        IF AM-EARN-METHOD-R = 'S'                                 ELC50PD
 11953            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11954                                        WS-LF-REFUND-CALC.        ELC50PD
 11955                                                                  ELC50PD
 11956     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11957         IF AM-EARN-METHOD-R = 'R'                                ELC50PD
 11958            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11959                                    WS-LF-REFUND-CALC.            ELC50PD
 11960     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11961         IF AM-EARN-METHOD-R = 'P'                                ELC50PD
 11962            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11963                                    WS-LF-REFUND-CALC.            ELC50PD
 11964     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11965         IF AM-EARN-METHOD-L = 'R'                                ELC50PD
 11966            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11967                                    WS-LF-REFUND-CALC.            ELC50PD
 11968     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11969         IF AM-EARN-METHOD-L = 'P'                                ELC50PD
 11970            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11971                                    WS-LF-REFUND-CALC.            ELC50PD
 11972     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11973         IF AM-EARN-METHOD-R = 'A'                                ELC50PD
 11974            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11975                                    WS-LF-REFUND-CALC.            ELC50PD
 11976     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11977         IF AM-EARN-METHOD-R = 'M'                                ELC50PD
 11978            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11979                                    WS-LF-REFUND-CALC.            ELC50PD
 11980     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11981         IF AM-EARN-METHOD-L = 'A'                                ELC50PD
 11982            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11983                                    WS-LF-REFUND-CALC.            ELC50PD
 11984     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11985         IF AM-EARN-METHOD-L = 'M'                                ELC50PD
 11986            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11987                                    WS-LF-REFUND-CALC.            ELC50PD
 11988                                                                  ELC50PD
 11989     IF AM-EARN-METHOD-A = 'R'                                    ELC50PD
 11990        MOVE '1'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11991                                    WS-AH-REFUND-CALC.            ELC50PD
 11992     IF AM-EARN-METHOD-A = 'P'                                    ELC50PD
 11993        MOVE '2'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11994                                    WS-AH-REFUND-CALC.            ELC50PD
 11995     IF AM-EARN-METHOD-A = 'C'                                    ELC50PD
 11996        MOVE '3'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11997                                    WS-AH-REFUND-CALC.            ELC50PD
 11998     IF AM-EARN-METHOD-A = 'A'                                    ELC50PD
 11999        MOVE '6'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12000                                    WS-AH-REFUND-CALC.            ELC50PD
 12001     IF AM-EARN-METHOD-A = 'M'                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 219
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12002        MOVE '8'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12003                                    WS-AH-REFUND-CALC.            ELC50PD
 12004     IF AM-EARN-METHOD-A = 'N'                                    ELC50PD
 12005        MOVE '5'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12006                                    WS-AH-REFUND-CALC.            ELC50PD
 12007     IF AM-EARN-METHOD-A = 'S'                                    ELC50PD
 12008        MOVE '9'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12009                                    WS-AH-REFUND-CALC.            ELC50PD
 12010                                                                  ELC50PD
 12011     IF AM-TOL-PREM NOT = ZEROS                                   ELC50PD
 12012        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM                ELC50PD
 12013                                    WS-TOL-AH-PREM.               ELC50PD
 12014                                                                  ELC50PD
 12015     IF AM-OVR-SHT-AMT NUMERIC AND                                ELC50PD
 12016                  AM-OVR-SHT-AMT > 0                              ELC50PD
 12017        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT          ELC50PD
 12018                                    EC-AM-LF-OVR-SHT-AMT          ELC50PD
 12019                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 12020                                    EC-AM-AH-OVR-SHT-AMT.         ELC50PD
 12021                                                                  ELC50PD
 12022     IF AM-OVR-SHT-PCT NUMERIC AND                                ELC50PD
 12023                    AM-OVR-SHT-PCT > 0                            ELC50PD
 12024        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT          ELC50PD
 12025                                    EC-AM-LF-OVR-SHT-PCT          ELC50PD
 12026                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 12027                                    EC-AM-AH-OVR-SHT-PCT.         ELC50PD
 12028                                                                  ELC50PD
 12029     IF AM-TOL-REF-PCT NUMERIC AND                                ELC50PD
 12030                  AM-TOL-REF-PCT > 0                              ELC50PD
 12031        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT          ELC50PD
 12032                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 12033                                                                  ELC50PD
 12034     IF AM-TOL-REF  NOT = ZEROS  AND                              ELC50PD
 12035                  AM-TOL-REF NUMERIC                              ELC50PD
 12036        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND              ELC50PD
 12037                                    EC-AM-LF-TOL-REFUND           ELC50PD
 12038                                    WS-TOL-AH-REFUND              ELC50PD
 12039                                    EC-AM-AH-TOL-REFUND.          ELC50PD
 12040                                                                  ELC50PD
 12041     IF AM-TOL-CLM  NOT = ZEROS                                   ELC50PD
 12042        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM               ELC50PD
 12043                                    WS-TOL-AH-CLAIM.              ELC50PD
 12044                                                                  ELC50PD
 12045     IF AM-CLP-TOL-PCT NOT NUMERIC
 12046        MOVE +0                  TO AM-CLP-TOL-PCT
 12047     END-IF
 12048
 12049     IF AM-SPP-LEASE-COMM NOT NUMERIC
 12050        MOVE +0                  TO AM-SPP-LEASE-COMM
 12051     END-IF
 12052
 12053     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0                        ELC50PD
 12054        MOVE WS-PL-TOL-LF-PREM-PCT                                ELC50PD
 12055                                 TO WS-TOL-LF-PREM-PCT.           ELC50PD
 12056                                                                  ELC50PD
 12057     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0                        ELC50PD
 12058        MOVE WS-PL-TOL-AH-PREM-PCT                                ELC50PD
 12059                                 TO WS-TOL-AH-PREM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 220
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12060                                                                  ELC50PD
 12061     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12062        MOVE WS-PL-TOL-LF-REFUND-PCT                              ELC50PD
 12063                                 TO WS-TOL-LF-REFUND-PCT.         ELC50PD
 12064                                                                  ELC50PD
 12065     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12066        MOVE WS-PL-TOL-AH-REFUND-PCT                              ELC50PD
 12067                                 TO WS-TOL-AH-REFUND-PCT.         ELC50PD
 12068                                                                  ELC50PD
 12069     IF WS-PL-REF-OVS-AMT > +0                                    ELC50PD
 12070        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.           ELC50PD
 12071                                                                  ELC50PD
 12072     IF WS-PL-REF-OVS-PCT > +0                                    ELC50PD
 12073        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT            ELC50PD
 12074                                                                  ELC50PD
 12075     IF WS-PL-TOL-LF-PREM NOT EQUAL +0                            ELC50PD
 12076        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.               ELC50PD
 12077     IF WS-PL-TOL-AH-PREM NOT EQUAL +0                            ELC50PD
 12078        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.               ELC50PD
 12079     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0                          ELC50PD
 12080        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.             ELC50PD
 12081     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0                          ELC50PD
 12082        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.             ELC50PD
 12083     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0                           ELC50PD
 12084        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.              ELC50PD
 12085     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0                           ELC50PD
 12086        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.              ELC50PD
 12087                                                                  ELC50PD
 12088     IF WS-AH-PL-REF-OVS-AMT > +0                                 ELC50PD
 12089        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.        ELC50PD
 12090                                                                  ELC50PD
 12091     IF WS-AH-PL-REF-OVS-PCT > +0                                 ELC50PD
 12092        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.        ELC50PD
 12093                                                                  ELC50PD
 12094     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.            ELC50PD
 12095     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.            ELC50PD
 12096                                                                  ELC50PD
 12097     IF PB-CANCELLATION                                           ELC50PD
 12098        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12099                                                                  ELC50PD
 12100     MOVE +1 TO SUB1.                                             ELC50PD
 12101     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.                ELC50PD
 12102     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.                ELC50PD
 12103                                                                  ELC50PD
 12104     IF CF-COMPANY-ID = 'DMD'                                     ELC50PD
 12105       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES                 ELC50PD
 12106         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD                 ELC50PD
 12107        ELSE                                                      ELC50PD
 12108         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.                ELC50PD
 12109                                                                  ELC50PD
 12110  0525-FIND-ACCT-COMM.                                            ELC50PD
 12111     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'              ELC50PD
 12112        NEXT SENTENCE                                             ELC50PD
 12113      ELSE                                                        ELC50PD
 12114         ADD +1 TO SUB1                                           ELC50PD
 12115         IF SUB1 LESS +11                                         ELC50PD
 12116            GO TO 0525-FIND-ACCT-COMM                             ELC50PD
 12117          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 221
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12118             GO TO 0560-EDIT-CONTINUE.                            ELC50PD
 12119                                                                  ELC50PD
 12120     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.              ELC50PD
 12121     MOVE ZERO                   TO PB-I-AH-COMMISSION            ELC50PD
 12122                                    PB-I-LIFE-COMMISSION.         ELC50PD
 12123***  IF PB-COMPANY-ID = 'CRI'                                        CL**9
 12124     IF PB-PREM-ACCTNG-ONLY                                          CL**9
 12125         GO TO 0560-EDIT-CONTINUE.                                   CL**9
 12126                                                                  ELC50PD
 12127     MOVE '0530' TO CTBL-SW.                                      ELC50PD
 12128     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12129                                                                  ELC50PD
 12130                                                                  ELC50PD
 12131 0530-GET-AH-COMP.                                                ELC50PD
 12132     IF NO-AH-COVERAGE  OR                                        ELC50PD
 12133        NO-AH-BENEFIT-MATCH                                       ELC50PD
 12134           GO TO 0540-NEXT-READ-STEP.                             ELC50PD
 12135                                                                  ELC50PD
 12136     IF AM-A-COM (SUB1) NUMERIC                                   ELC50PD
 12137        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12138         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION                 ELC50PD
 12139         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE                 ELC50PD
 12140         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT      ELC50PD
 12141         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION            ELC50PD
 12142     ELSE                                                         ELC50PD
 12143          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE                 ELC50PD
 12144          MOVE PB-I-AH-TERM      TO WS-WORK-TERM                  ELC50PD
 12145          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE                 ELC50PD
 12146          MOVE ZEROS             TO WS-SUB1                       ELC50PD
 12147                                    WS-COMMISSION                 ELC50PD
 12148          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT     ELC50PD
 12149          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE                    ELC50PD
 12150          IF WS-COMMISSION > ZEROS                                ELC50PD
 12151             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION            ELC50PD
 12152             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12153          END-IF                                                  ELC50PD
 12154          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT             ELC50PD
 12155          IF CTBL-TABLE-FOUND                                     ELC50PD
 12156             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *       ELC50PD
 12157                                        PB-I-AH-TERM              ELC50PD
 12158             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT            ELC50PD
 12159             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION         ELC50PD
 12160             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12161          ELSE                                                    ELC50PD
 12162             IF FIRST-TIME-THROUGH                                ELC50PD
 12163                 GO TO 0530-GET-AH-COMP                           ELC50PD
 12164             ELSE                                                 ELC50PD
 12165                 MOVE ER-2609                TO WS-ERROR          ELC50PD
 12166                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           CL**2
 12167                                                                  ELC50PD
 12168 0540-NEXT-READ-STEP.                                             ELC50PD
 12169     MOVE '0540' TO CTBL-SW.                                      ELC50PD
 12170     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12171                                                                  ELC50PD
 12172 0540-GET-LF-COMP.                                                ELC50PD
 12173     IF NO-LIFE-COVERAGE  OR                                      ELC50PD
 12174        NO-LF-BENEFIT-MATCH                                       ELC50PD
 12175           GO TO 0560-EDIT-CONTINUE.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 222
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12176                                                                  ELC50PD
 12177     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12178        IF AM-J-COM (SUB1) NUMERIC                                ELC50PD
 12179           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 12180           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12181           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12182           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12183           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12184        ELSE                                                      ELC50PD
 12185           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12186           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12187           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12188           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12189                                        WS-COMMISSION             ELC50PD
 12190           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12191           IF WS-COMMISSION > ZEROS                               ELC50PD
 12192              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12193              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12194           END-IF                                                 ELC50PD
 12195           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12196           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12197           IF CTBL-TABLE-FOUND                                    ELC50PD
 12198              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12199              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12200              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
 12201              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12202           ELSE                                                   ELC50PD
 12203              IF FIRST-TIME-THROUGH                               ELC50PD
 12204                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12205              ELSE                                                ELC50PD
 12206                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12207                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
 12208                  GO TO 0560-EDIT-CONTINUE.                          CL**2
 12209                                                                  ELC50PD
 12210     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'                        ELC50PD
 12211        IF AM-L-COM (SUB1) NUMERIC                                ELC50PD
 12212           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 12213           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12214           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12215           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12216           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12217        ELSE                                                      ELC50PD
 12218           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12219           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12220           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12221           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12222                                        WS-COMMISSION             ELC50PD
 12223           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12224           IF WS-COMMISSION IS GREATER THAN ZEROS                 ELC50PD
 12225              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12226              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12227           END-IF                                                 ELC50PD
 12228           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12229           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12230           IF CTBL-TABLE-FOUND                                    ELC50PD
 12231              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12232              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12233              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 223
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12234              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12235           ELSE                                                   ELC50PD
 12236              IF FIRST-TIME-THROUGH                               ELC50PD
 12237                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12238              ELSE                                                ELC50PD
 12239                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12240                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          CL**2
 12241                                                                  ELC50PD
 12242*    GO TO 0560-EDIT-CONTINUE.                                    ELC50PD
 12243                                                                  ELC50PD
 12244 0560-EDIT-CONTINUE.                                              ELC50PD
 12245
 12246     MOVE ZEROS                  TO WS-LF-PMF-COMM
 12247                                    WS-AH-PMF-COMM
 12248*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 12249*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 12250
 12251     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 12252        (SUB1 > +10)
 12253        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 12254           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 12255           MOVE '0530'           TO CTBL-SW
 12256           MOVE ' '              TO WS-CTBL-READ-SW
 12257           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 12258           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 12259           MOVE '0540'           TO CTBL-SW
 12260           MOVE ' '              TO WS-CTBL-READ-SW
 12261           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 12262        END-IF
 12263     END-PERFORM
 12264
 12265     GO TO 0564-EDIT-CONTINUE
 12266
 12267     .
 12268 0561-CHECK-AH.
 12269
 12270     IF (NO-AH-COVERAGE)
 12271        OR (NO-AH-BENEFIT-MATCH)
 12272        CONTINUE
 12273     ELSE
 12274        IF (AM-A-COM (SUB1) NUMERIC)
 12275           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12276           IF (AM-COM-TYP (SUB1) = 'A')
 12277              AND (WS-AH-PMF-COMM = ZEROS)
 12278              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 12279           END-IF
 12280           CONTINUE
 12281        ELSE
 12282           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 12283           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 12284           MOVE PB-AH-OVERRIDE-L1
 12285                                 TO CTBL-BEN-TYPE
 12286           MOVE ZEROS            TO WS-SUB1
 12287                                    WS-COMMISSION
 12288           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 12289           PERFORM 8300-READ-CTBL-TABLE
 12290                                 THRU 8300-EXIT
 12291           IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 224
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12292              IF (AM-COM-TYP (SUB1) = 'A')
 12293                 AND (WS-AH-PMF-COMM = ZEROS)
 12294                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 12295                                        PB-I-AH-TERM
 12296                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12297                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 12298              END-IF
 12299              CONTINUE
 12300           ELSE
 12301              IF FIRST-TIME-THROUGH
 12302                 GO TO 0561-CHECK-AH
 12303              ELSE
 12304                 MOVE ER-2609    TO WS-ERROR
 12305                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12306              END-IF
 12307           END-IF
 12308        END-IF
 12309     END-IF
 12310
 12311     .
 12312 0561-EXIT.
 12313     EXIT.
 12314
 12315 0563-CHECK-LF.
 12316
 12317     IF (NO-LIFE-COVERAGE)
 12318        OR (NO-LF-BENEFIT-MATCH)
 12319        CONTINUE
 12320     ELSE
 12321        IF WS-LF-JOINT-INDICATOR = 'J'
 12322           IF AM-J-COM (SUB1) NUMERIC
 12323              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12324              IF (AM-COM-TYP (SUB1) = 'A')
 12325                 AND (WS-LF-PMF-COMM = ZEROS)
 12326                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 12327              END-IF
 12328              CONTINUE
 12329           ELSE
 12330              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12331              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12332              MOVE PB-LIFE-OVERRIDE-L1
 12333                                 TO CTBL-BEN-TYPE
 12334              MOVE ZEROS         TO WS-SUB1
 12335                                    WS-COMMISSION
 12336              MOVE AM-J-COMA (SUB1)
 12337                                 TO CTBL-TABLE
 12338              PERFORM 8300-READ-CTBL-TABLE
 12339                                 THRU 8300-EXIT
 12340              IF CTBL-TABLE-FOUND
 12341                 IF (AM-COM-TYP (SUB1) = 'A')
 12342                    AND (WS-LF-PMF-COMM = ZEROS)
 12343                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 12344                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12345                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 12346                 END-IF
 12347                 CONTINUE
 12348              ELSE
 12349                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 225
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12350                    GO TO 0563-CHECK-LF
 12351                 ELSE
 12352                    MOVE ER-2609 TO WS-ERROR
 12353                    PERFORM 9900-ERROR-FORMAT
 12354                                 THRU 9900-EXIT
 12355*                   GO TO 0560-EDIT-CONTINUE
 12356                 END-IF
 12357              END-IF
 12358           END-IF
 12359        ELSE
 12360           IF AM-L-COM (SUB1) NUMERIC
 12361              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12362              IF (AM-COM-TYP (SUB1) = 'A')
 12363                 AND (WS-LF-PMF-COMM = ZEROS)
 12364                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 12365              END-IF
 12366              CONTINUE
 12367           ELSE
 12368              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12369              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12370              MOVE PB-LIFE-OVERRIDE-L1
 12371                                 TO CTBL-BEN-TYPE
 12372              MOVE ZEROS         TO WS-SUB1
 12373                                    WS-COMMISSION
 12374              MOVE AM-L-COMA (SUB1)
 12375                                 TO CTBL-TABLE
 12376              PERFORM 8300-READ-CTBL-TABLE
 12377                                 THRU 8300-EXIT
 12378              IF CTBL-TABLE-FOUND
 12379                 CONTINUE
 12380              ELSE
 12381                 IF FIRST-TIME-THROUGH
 12382                    GO TO 0563-CHECK-LF
 12383                 ELSE
 12384                    MOVE ER-2609 TO WS-ERROR
 12385                    PERFORM 9900-ERROR-FORMAT
 12386                                 THRU 9900-EXIT
 12387                 END-IF
 12388              END-IF
 12389           END-IF
 12390        END-IF
 12391     END-IF
 12392
 12393     .
 12394 0563-EXIT.
 12395     EXIT.
 12396
 12397 0564-EDIT-CONTINUE.
 12398                                                                  ELC50PD
 12399     IF  PB-COMPANY-ID EQUAL 'DMD'                                ELC50PD
 12400         IF PB-I-NUM-BILLED EQUAL ZEROS                           ELC50PD
 12401            MOVE ER-8148       TO WS-ERROR                        ELC50PD
 12402            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12403                                                                  ELC50PD
 12404*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE                     ELC50PD
 12405*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1                  ELC50PD
 12406*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2                  ELC50PD
 12407*         SET ELAPSED-BETWEEN-BIN TO TRUE                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 226
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12408*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 12409*         IF NO-CONVERSION-ERROR                                  ELC50PD
 12410*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12        ELC50PD
 12411*         ELSE                                                    ELC50PD
 12412*             IF PB-COMPANY-ID EQUAL 'HAN'                        ELC50PD
 12413*                 MOVE ZEROS     TO PB-I-AGE.                     ELC50PD
 12414
 12415     IF PB-I-BIRTHDAY > LOW-VALUES
 12416        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 12417        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12418        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12419        PERFORM 8500-DATE-CONVERT
 12420                                 THRU 8500-EXIT
 12421        IF NO-CONVERSION-ERROR
 12422           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12423           IF PB-I-AGE > ZEROS
 12424              IF WS-WORK-AGE NOT = PB-I-AGE
 12425                 MOVE ER-9501    TO WS-ERROR
 12426                 PERFORM 9900-ERROR-FORMAT
 12427                                 THRU 9900-EXIT
 12428              END-IF
 12429           ELSE
 12430              MOVE WS-WORK-AGE   TO PB-I-AGE
 12431           END-IF
 12432        END-IF
 12433     END-IF
 12434
 12435     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 12436                                   WS-INS-AGE-SET
 12437     IF PB-I-AGE = ZEROS                                          ELC50PD
 12438        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'                  ELC50PD
 12439           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 12440                                   WS-INS-AGE-SET
 12441           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.                      ELC50PD
 12442                                                                  ELC50PD
 12443     MOVE PB-I-AGE              TO WS-EDIT-AGE                    ELC50PD
 12444                                   WS-AH-EDIT-AGE.                ELC50PD
 12445                                                                  ELC50PD
 12446     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12447        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 12448        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12449        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12450        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12451        IF NO-CONVERSION-ERROR
 12452           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12453           IF PB-I-JOINT-AGE > 0
 12454              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 12455                 MOVE ER-9503    TO WS-ERROR
 12456                 PERFORM 9900-ERROR-FORMAT
 12457                                 THRU 9900-EXIT
 12458              END-IF
 12459           ELSE
 12460              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 12461           END-IF
 12462        ELSE
 12463           MOVE ZEROS            TO PB-I-JOINT-AGE
 12464        END-IF
 12465     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 227
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12466
 12467     IF PB-I-JOINT-AGE NOT NUMERIC                                ELC50PD
 12468        MOVE ZERO               TO PB-I-JOINT-AGE.                ELC50PD
 12469                                                                  ELC50PD
 12470     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 12471                                   WS-JNT-AGE-SET
 12472     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 12473        IF (WS-LF-JOINT-INDICATOR = 'J')  OR                      ELC50PD
 12474           (WS-AH-JOINT-INDICATOR = 'J')                          ELC50PD
 12475           IF PB-I-JOINT-AGE = ZEROS                              ELC50PD
 12476               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 12477                                          WS-JNT-AGE-SET
 12478               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 12479           END-IF
 12480        END-IF
 12481     END-IF
 12482                                                                  ELC50PD
 12483     MOVE ' ' TO PB-I-LIFE-INDICATOR
 12484     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12485        MOVE 'J'                TO PB-I-LIFE-INDICATOR            ELC50PD
 12486        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12487            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12488                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12489                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12490            ELSE                                                  ELC50PD
 12491                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12492                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE            ELC50PD
 12493                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12494                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12495                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12496                                                                  ELC50PD
 12497     IF WS-AH-JOINT-INDICATOR = 'J'                               ELC50PD
 12498        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12499            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12500                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12501                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12502            ELSE                                                  ELC50PD
 12503                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12504                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE         ELC50PD
 12505                                           WS-EDIT-AGE
 12506                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12507                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12508                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12509                                                                  ELC50PD
 12510******************************************************************ELC50PD
 12511*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS         ELC50PD
 12512******************************************************************ELC50PD
 12513                                                                  ELC50PD
 12514     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12515        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12516        NEXT SENTENCE                                             ELC50PD
 12517     ELSE                                                         ELC50PD
 12518        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR                      ELC50PD
 12519          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND               ELC50PD
 12520           (WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12521            WS-AH-JOINT-INDICATOR = 'J')  AND                     ELC50PD
 12522           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                      ELC50PD
 12523            MOVE ER-2627             TO WS-ERROR                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 228
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12524            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12525                                                                  ELC50PD
 12526     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12527        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12528         NEXT SENTENCE                                            ELC50PD
 12529     ELSE                                                         ELC50PD
 12530         IF WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12531            WS-AH-JOINT-INDICATOR = 'J'                           ELC50PD
 12532             IF PB-I-JOINT-INSURED = SPACES                       ELC50PD
 12533                 IF PB-COMPANY-ID NOT = 'JAL'                     ELC50PD
 12534                     MOVE ER-2696    TO WS-ERROR                  ELC50PD
 12535                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.    ELC50PD
 12536                                                                  ELC50PD
 12537     IF PB-COMPANY-ID NOT = 'BOA'                                 ELC50PD
 12538        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12539           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12540           IF (PB-I-JOINT-AGE NOT = ZEROS OR                      ELC50PD
 12541               PB-I-JOINT-INSURED NOT = SPACES)                   ELC50PD
 12542                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12543                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12544                                                                  ELC50PD
 12545     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 12546        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12547           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12548            IF PB-I-JOINT-AGE NOT = ZEROS                         ELC50PD
 12549                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12550                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12551                                                                  ELC50PD
 12552     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12553        IF PB-I-SIG-SW = 'J'                                      ELC50PD
 12554           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND                ELC50PD
 12555              WS-AH-JOINT-INDICATOR NOT = 'J'                     ELC50PD
 12556              MOVE ER-2675       TO WS-ERROR                      ELC50PD
 12557              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12558                                                                  ELC50PD
 12559     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12560        IF PB-I-SIG-SW = 'S'                                      ELC50PD
 12561           IF WS-LF-JOINT-INDICATOR = 'J'  OR                     ELC50PD
 12562              WS-AH-JOINT-INDICATOR = 'J'                         ELC50PD
 12563              MOVE ER-2676       TO WS-ERROR                      ELC50PD
 12564              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12565                                                                  ELC50PD
 12566     IF PB-COMPANY-ID = 'CVL'                                     ELC50PD
 12567         IF (WS-AH-JOINT-INDICATOR = 'J') AND                     ELC50PD
 12568            (WS-LF-JOINT-INDICATOR NOT = 'J')                     ELC50PD
 12569              MOVE ER-2783           TO WS-ERROR                  ELC50PD
 12570              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12571
 12572     IF (WS-LF-JOINT-INDICATOR = 'J')
 12573        AND (WS-AH-JOINT-INDICATOR = 'J')
 12574        AND (PB-I-LF-TERM > 120)
 12575        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 12576        MOVE ER-2783             TO WS-ERROR
 12577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12578     END-IF
 12579
 12580     MOVE SPACE                  TO PB-I-INDV-GRP-CD.             ELC50PD
 12581                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 229
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12582     IF PB-I-INDV-GRP-OVRD = 'I'                                  ELC50PD
 12583        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12585        MOVE 'I'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12586                                                                  ELC50PD
 12587     IF PB-I-INDV-GRP-OVRD = 'G'                                  ELC50PD
 12588        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12590        MOVE 'G'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12591                                                                  ELC50PD
 12592     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'                           ELC50PD
 12593        NEXT SENTENCE                                             ELC50PD
 12594     ELSE                                                         ELC50PD
 12595        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.             ELC50PD
 12596                                                                  ELC50PD
 12597     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD                           ELC50PD
 12598        IF WS-ERROR = ER-2666                                     ELC50PD
 12599           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)        ELC50PD
 12600           SUBTRACT +1           FROM PB-NO-OF-ERRORS.            ELC50PD
 12601
 12602     IF PB-COMPANY-ID = 'CID'
 12603        IF PB-STATE = 'UT' OR 'MO'
 12604           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 12605                 OR '76' OR '77')
 12606                      OR
 12607               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 12608                   OR '41' OR '42' OR '63' OR '64' OR '65'
 12609                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 12610                   OR '2K' OR '2L'))
 12611              AND PB-I-INDV-GRP-CD = 'I'
 12612              MOVE ER-2721             TO WS-ERROR
 12613              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12614           END-IF
 12615        END-IF
 12616     END-IF
 12617                                                                  ELC50PD
 12618     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 12619     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 12620        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 12621     ELSE
 12622        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 12623     END-IF
 12624
 12625*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 12626*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 12627     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW            ELC50PD
 12628                                    ACCOUNT-AH-CK-SW.             ELC50PD
 12629                                                                  ELC50PD
 12630     IF PB-REISSUED-CERT       OR                                 ELC50PD
 12631        PB-REIN-ONLY-CERT      OR                                 ELC50PD
 12632        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 12633        PB-POLICY-IS-VOIDED                                       ELC50PD
 12634*       OR PB-MONTHLY-CERT
 12635         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12636                                                                  ELC50PD
 12637     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12638        IF WS-EDIT-AGE           > +65
 12639           MOVE ER-2709          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 230
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12640           PERFORM 9900-ERROR-FORMAT
 12641                                 THRU 9900-EXIT
 12642        ELSE
 12643           IF WS-EDIT-AGE        > +55
 12644              MOVE ER-2718       TO WS-ERROR
 12645              PERFORM 9900-ERROR-FORMAT
 12646                                 THRU 9900-EXIT
 12647           END-IF
 12648        END-IF
 12649
 12650     IF PB-COMPANY-ID = 'DCC'
 12651        IF WS-EDIT-AGE           > +65
 12652           MOVE ER-2709          TO WS-ERROR
 12653           PERFORM 9900-ERROR-FORMAT
 12654                                 THRU 9900-EXIT
 12655        END-IF
 12656     END-IF
 12657     .
 12658
 12659 0565-LIFE-PLAN-LIMIT-EDITS.                                      ELC50PD
 12660                                                                  ELC50PD
 12661     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 12662        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 12663                                    EC-AM-LF-MAX-TOT-BEN
 12664        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12665                                                                  ELC50PD
 12666     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 12667                                                                  ELC50PD
 12668     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12669         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12670             GO TO 0580-AH-PLAN-LIMIT-EDITS.                      ELC50PD
 12671                                                                  ELC50PD
 12672     IF NO-LF-BENEFIT-MATCH          OR                           ELC50PD
 12673        WS-LF-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12674        WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12675        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12676                                                                  ELC50PD
 12677     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.           ELC50PD
 12678     MOVE +1                     TO SUB2.                         ELC50PD
 12679                                                                  ELC50PD
 12680     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12681        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
 12682           MOVE +5   TO SUB2                                      ELC50PD
 12683           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12684              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12685              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12686              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW                    ELC50PD
 12687              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12688                                                                  ELC50PD
 12689     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 12690                                                                  ELC50PD
 12691     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 12692                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 12693                                                                  ELC50PD
 12694 0568-CHECK-LIFE-ATT-AGE.                                         ELC50PD
 12695                                                                  ELC50PD
 12696
 12697     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 231
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12698        PL-ATT-AGE > +0
 12699        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 12700     END-IF
 12701
 12702
 12703
 12704*    IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12705*       PL-ATT-AGE > +0
 12706*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE          ELC50PD
 12707*       IF PB-I-BIRTHDAY > LOW-VALUES
 12708*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12709*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 12710*          MOVE ZERO             TO DC-ELAPSED-DAYS
 12711*          SET BIN-PLUS-ELAPSED  TO TRUE
 12712*          PERFORM 8500-DATE-CONVERT
 12713*                                THRU 8500-EXIT
 12714*          IF NO-CONVERSION-ERROR
 12715*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 12716*             MOVE ER-2669       TO WS-ERROR
 12717*             PERFORM 9900-ERROR-FORMAT
 12718*                                THRU 9900-EXIT
 12719*          END-IF
 12720*       ELSE
 12721*          IF WS-ATT-AGE >= PL-ATT-AGE
 12722*             MOVE ER-2669       TO WS-ERROR                      ELC50PD
 12723*             PERFORM 9900-ERROR-FORMAT
 12724*                                THRU 9900-EXIT
 12725*          END-IF
 12726*       END-IF
 12727*    END-IF
 12728
 12729     .
 12730 0570-CHECK-LIFE-LIMITS.                                          ELC50PD
 12731                                                                  ELC50PD
 12732     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12733        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12734           IF SUB2 GREATER THAN +4                                ELC50PD
 12735              MOVE ER-2637 TO WS-ERROR                            ELC50PD
 12736              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12737              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12738                                                                  ELC50PD
 12739     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12740        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12741            SUB2 GREATER THAN +8                                  ELC50PD
 12742             MOVE 'U'         TO PB-BATCH-ENTRY                   ELC50PD
 12743             MOVE ER-2637     TO WS-ERROR                         ELC50PD
 12744             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12745             GO TO 0575-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12746                                                                  ELC50PD
 12747     IF SUB2 > +8
 12748        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12749           AND (PB-I-SIG-SW = 'Y')
 12750           CONTINUE
 12751        ELSE
 12752           MOVE ER-2637          TO WS-ERROR
 12753           PERFORM 9900-ERROR-FORMAT
 12754                                 THRU 9900-EXIT
 12755        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 232
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12756        GO TO 0580-AH-PLAN-LIMIT-EDITS
 12757     END-IF
 12758
 12759     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.                ELC50PD
 12760     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.               ELC50PD
 12761     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.            ELC50PD
 12762                                                                  ELC50PD
 12763     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)               ELC50PD
 12764        ADD +1  TO SUB2                                           ELC50PD
 12765        GO TO 0570-CHECK-LIFE-LIMITS.                             ELC50PD
 12766                                                                  ELC50PD
 12767     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12768         GO TO 0570-CHECK-NCL-LIFE-LIMITS.                        ELC50PD
 12769                                                                  ELC50PD
 12770     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 12771        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 12772        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12773           AND (PB-I-SIG-SW = 'Y')
 12774           CONTINUE
 12775        ELSE
 12776           MOVE ER-2637          TO WS-ERROR
 12777           PERFORM 9900-ERROR-FORMAT
 12778                                 THRU 9900-EXIT
 12779        END-IF
 12780     END-IF
 12781
 12782     GO TO 0580-AH-PLAN-LIMIT-EDITS.                              ELC50PD
 12783                                                                  ELC50PD
 12784                                                                  ELC50PD
 12785 0570-CHECK-NCL-LIFE-LIMITS.                                      ELC50PD
 12786                                                                  ELC50PD
 12787     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND      ELC50PD
 12788        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)      ELC50PD
 12789         GO TO 0575-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12790                                                                  ELC50PD
 12791     IF APP-CERT-USED                                             ELC50PD
 12792         IF SUB2  LESS THAN  +5                                   ELC50PD
 12793             MOVE +5          TO SUB2                             ELC50PD
 12794             GO TO 0570-CHECK-LIFE-LIMITS.                        ELC50PD
 12795                                                                  ELC50PD
 12796     MOVE ER-2637             TO WS-ERROR.                        ELC50PD
 12797     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12798                                                                  ELC50PD
 12799     MOVE 'U'                 TO PB-BATCH-ENTRY.                  ELC50PD
 12800                                                                  ELC50PD
 12801 0575-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12802                                                                  ELC50PD
 12803     IF NOT APP-CERT-USED                                         ELC50PD
 12804         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12805                                                                  ELC50PD
 12806     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12807        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12808        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12809        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12810         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12811                                                                  ELC50PD
 12812     IF SUB2 GREATER THAN +4                                      ELC50PD
 12813         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 233
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12814            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12815            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12816            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12817             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12818             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12819             GO TO 0580-AH-PLAN-LIMIT-EDITS                       ELC50PD
 12820         ELSE                                                     ELC50PD
 12821             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12822                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12823                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12824                                                                  ELC50PD
 12825     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12826       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12827          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12828           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12829           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12830           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12831                                                                  ELC50PD
 12832                                                                  ELC50PD
 12833 0580-AH-PLAN-LIMIT-EDITS.                                        ELC50PD
 12834                                                                  ELC50PD
 12835     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12836        IF PB-I-AH-BENEFIT-AMT > +1250
 12837           MOVE ER-2702          TO WS-ERROR
 12838           PERFORM 9900-ERROR-FORMAT
 12839                                 THRU 9900-EXIT
 12840        END-IF
 12841     END-IF
 12842
 12843     IF (PB-COMPANY-ID = 'DCC')
 12844        AND (PB-MONTHLY-CERT)
 12845        IF PB-I-AH-BENEFIT-AMT > +3000
 12846           MOVE ER-2881          TO WS-ERROR
 12847           PERFORM 9900-ERROR-FORMAT
 12848                                 THRU 9900-EXIT
 12849        END-IF
 12850     END-IF
 12851
 12852     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 12853        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 12854        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12855                                                                  ELC50PD
 12856     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 12857                                                                  ELC50PD
 12858     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12859         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12860             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 12861                                                                  ELC50PD
 12862     IF NO-AH-BENEFIT-MATCH          OR                           ELC50PD
 12863        WS-AH-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12864        WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12865        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12866                                                                  ELC50PD
 12867     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.             ELC50PD
 12868     MOVE +1                     TO SUB2.                         ELC50PD
 12869                                                                  ELC50PD
 12870     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12871        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 234
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12872           MOVE +5 TO SUB2                                        ELC50PD
 12873           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12874              (PL-LM-MOA (SUB2) EQUAL +0) AND                     ELC50PD
 12875              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12876              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12877              MOVE 'NO ' TO ACCOUNT-AH-CK-SW                      ELC50PD
 12878              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12879                                                                  ELC50PD
 12880     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 12881                                                                  ELC50PD
 12882 0590-CHECK-AH-ATT-AGE.                                           ELC50PD
 12883                                                                  ELC50PD
 12884     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12885        PL-ATT-AGE GREATER THAN +0                                ELC50PD
 12886        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 12887     END-IF
 12888*       IF WS-ATT-AGE >= PL-ATT-AGE
 12889*          MOVE ER-3054          TO WS-ERROR                      ELC50PD
 12890*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 12891     .
 12892 0597-CHECK-AH-LIMITS.                                            ELC50PD
 12893                                                                  ELC50PD
 12894     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12895        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12896           IF SUB2 GREATER THAN +4                                ELC50PD
 12897              MOVE ER-2638       TO WS-ERROR                      ELC50PD
 12898              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12899              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12900                                                                  ELC50PD
 12901     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12902        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12903            SUB2 GREATER THAN +8                                  ELC50PD
 12904             MOVE 'U'            TO PB-BATCH-ENTRY                ELC50PD
 12905             MOVE ER-2638        TO WS-ERROR                      ELC50PD
 12906             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12907             GO TO 0599-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12908                                                                  ELC50PD
 12909     IF SUB2 > +8
 12910        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12911           AND (PB-I-SIG-SW = 'Y')
 12912           CONTINUE
 12913        ELSE
 12914           MOVE ER-2638          TO WS-ERROR
 12915           PERFORM 9900-ERROR-FORMAT
 12916                                 THRU 9900-EXIT
 12917        END-IF
 12918        GO TO 3000-CONTINUE-EDIT
 12919     END-IF
 12920                                                                  ELC50PD
 12921     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12922        IF WS-ERROR = ER-2638                                     ELC50PD
 12923           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12924                                                                  ELC50PD
 12925     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.             ELC50PD
 12926     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.            ELC50PD
 12927     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.         ELC50PD
 12928     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.         ELC50PD
 12929                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 235
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12930     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)            ELC50PD
 12931        ADD +1                   TO SUB2                          ELC50PD
 12932        GO TO 0597-CHECK-AH-LIMITS.                               ELC50PD
 12933                                                                  ELC50PD
 12934     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12935         GO TO 0597-CHECK-NCL-AH-LIMITS.                          ELC50PD
 12936                                                                  ELC50PD
 12937     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 12938        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 12939        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12940                                 > PL-LM-AMT (SUB2))
 12941        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12942           AND (PB-I-SIG-SW = 'Y')
 12943           CONTINUE
 12944        ELSE
 12945           MOVE ER-2638          TO WS-ERROR
 12946           PERFORM 9900-ERROR-FORMAT
 12947                                 THRU 9900-EXIT
 12948        END-IF
 12949     END-IF
 12950                                                                  ELC50PD
 12951     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 12952         IF  WS-ERROR    EQUAL    ER-2638                         ELC50PD
 12953             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2) ELC50PD
 12954                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT   ELC50PD
 12955                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)  ELC50PD
 12956                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS              ELC50PD
 12957                MOVE  ER-1910    TO  WS-ERROR                     ELC50PD
 12958                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 12959                                                                  ELC50PD
 12960     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12961        IF WS-ERROR = ER-2638                                     ELC50PD
 12962            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)      ELC50PD
 12963            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS                  ELC50PD
 12964            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12965                                                                  ELC50PD
 12966     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 12967                                                                  ELC50PD
 12968 0597-CHECK-NCL-AH-LIMITS.                                        ELC50PD
 12969                                                                  ELC50PD
 12970     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND     ELC50PD
 12971        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  ANDELC50PD
 12972        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                     ELC50PD
 12973                            NOT GREATER THAN PL-LM-AMT (SUB2))    ELC50PD
 12974         GO TO 0599-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12975                                                                  ELC50PD
 12976     IF APP-CERT-USED                                             ELC50PD
 12977         IF SUB2  LESS THAN  +5                                   ELC50PD
 12978             MOVE +5             TO SUB2                          ELC50PD
 12979             GO TO 0597-CHECK-AH-LIMITS.                          ELC50PD
 12980                                                                  ELC50PD
 12981     MOVE ER-2638                TO WS-ERROR.                     ELC50PD
 12982     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12983                                                                  ELC50PD
 12984     MOVE 'U'                    TO PB-BATCH-ENTRY.               ELC50PD
 12985                                                                  ELC50PD
 12986 0599-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12987                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 236
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12988     IF NOT APP-CERT-USED                                         ELC50PD
 12989         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12990                                                                  ELC50PD
 12991     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12992        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12993        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12994        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12995         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12996                                                                  ELC50PD
 12997     IF SUB2 GREATER THAN +4                                      ELC50PD
 12998         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
 12999            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 13000            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 13001            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 13002             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 13003             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13004             GO TO 3000-CONTINUE-EDIT                             ELC50PD
 13005         ELSE                                                     ELC50PD
 13006             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 13007                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 13008                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 13009                                                                  ELC50PD
 13010     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 13011       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 13012          NOT PB-I-POLICY-DECLINED                                ELC50PD
 13013           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 13014           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 13015           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 13016                                                                  ELC50PD
 13017******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 237
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13019                                                                  ELC50PD
 13020 3000-CONTINUE-EDIT.                                              ELC50PD
 13021                                                                  ELC50PD
 13022     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.            ELC50PD
 13023     MOVE AM-CSR-CODE            TO PB-CSR-ID.                    ELC50PD
 13024     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.           ELC50PD
 13025     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.          ELC50PD
 13026     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.      ELC50PD
 13027                                                                  ELC50PD
 13028     IF BROWSE-STARTED                                            ELC50PD
 13029        PERFORM 9990-RETURN THRU 9990-EXIT                        ELC50PD
 13030        MOVE SPACES              TO WS-BROWSE-STARTED-SW.         ELC50PD
 13031                                                                  ELC50PD
 13032     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT                  ELC50PD
 13033        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1                 ELC50PD
 13034        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2                 ELC50PD
 13035        SET ELAPSED-BETWEEN-BIN  TO TRUE                          ELC50PD
 13036*       MOVE 1                   TO DC-OPTION-CODE                ELC50PD
 13037        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13038        IF DATE-CONVERSION-ERROR                                  ELC50PD
 13039           MOVE ER-2622          TO WS-ERROR                      ELC50PD
 13040           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13041        ELSE                                                      ELC50PD
 13042           IF DC-ELAPSED-MONTHS   GREATER THAN +2                 ELC50PD
 13043              MOVE ER-2623       TO WS-ERROR                      ELC50PD
 13044              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13045           ELSE                                                   ELC50PD
 13046              MOVE ER-2622       TO WS-ERROR                      ELC50PD
 13047              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 13048                                                                  ELC50PD
 13049     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.                ELC50PD
 13050     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.                ELC50PD
 13051     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13052*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13053     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13054     IF DATE-CONVERSION-ERROR                                     ELC50PD
 13055        GO TO 3005-EDIT-CONTINUE                                  ELC50PD
 13056     ELSE                                                         ELC50PD
 13057        IF DC-ELAPSED-DAYS GREATER +180                           ELC50PD
 13058           MOVE ER-2613          TO WS-ERROR                      ELC50PD
 13059           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13060        ELSE                                                      ELC50PD
 13061           IF DC-ELAPSED-DAYS GREATER +90                         ELC50PD
 13062              MOVE ER-2612       TO WS-ERROR                      ELC50PD
 13063              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13064           ELSE                                                   ELC50PD
 13065             IF DC-ELAPSED-DAYS GREATER +60                       ELC50PD
 13066                MOVE ER-2614     TO WS-ERROR                      ELC50PD
 13067                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 13068                                                                  ELC50PD
 13069 3005-EDIT-CONTINUE.                                              ELC50PD
 13070                                                                  ELC50PD
 13071     IF PB-CANCELLATION                                           ELC50PD
 13072         GO TO 3700-EDIT-CANCEL.                                     CL**2
 13073                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 238
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13075******************************************************************ELC50PD
 13076*                  E D I T   I S S U E                           *ELC50PD
 13077******************************************************************ELC50PD
 13078                                                                  ELC50PD
 13079 3020-EDIT-ISSUE.                                                 ELC50PD
 13080                                                                  ELC50PD
 13081      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.           ELC50PD
 13082      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.      ELC50PD
 13083      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.        ELC50PD
 13084      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.        ELC50PD
 13085      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.                  ELC50PD
 13086                                                                  ELC50PD
 13087     IF PB-ISSUE-FORCE
 13088        OR PB-ISSUE-DATE-FORCED
 13089        OR PB-FORCE-OFF
 13090        OR PB-OVERCHARGE-FORCE
 13091        CONTINUE
 13092     ELSE
 13093        MOVE ER-2670             TO WS-ERROR
 13094        PERFORM 9900-ERROR-FORMAT
 13095                                 THRU 9900-EXIT
 13096     END-IF
 13097
 13098     .
 13099 3022-SET-POLICY-STATUS.                                          ELC50PD
 13100                                                                  ELC50PD
 13101     MOVE '2'                    TO PB-I-ENTRY-STATUS.            ELC50PD
 13102                                                                  ELC50PD
 13103     IF (PB-REISSUED-CERT)
 13104             OR
 13105        ((PB-COMPANY-ID NOT = 'DCC')
 13106         AND (PB-MONTHLY-CERT))
 13107         MOVE '5'                TO PB-I-ENTRY-STATUS
 13108         MOVE 'E'                TO PB-BATCH-ENTRY
 13109     END-IF
 13110
 13111     IF PB-COMPANY-ID = 'DCC'
 13112        IF PB-MONTHLY-CERT
 13113           MOVE 'M'              TO PB-I-ENTRY-STATUS
 13114        END-IF
 13115     END-IF
 13116     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 13117         MOVE 'D'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13118     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 13119         MOVE 'V'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13120     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 13121         MOVE 'U'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13122     IF PB-REIN-ONLY-CERT                                         ELC50PD
 13123         MOVE '9'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13124     IF PB-PREM-ACCTNG-ONLY                                       ELC50PD
 13125         MOVE 'P'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13126                                                                  ELC50PD
 13127     MOVE SPACE                  TO PB-I-OB-FLAG.                 ELC50PD
 13128                                                                  ELC50PD
 13129     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE                 ELC50PD
 13130         MOVE ER-2665            TO WS-ERROR                      ELC50PD
 13131         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13132         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 239
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13133                                                                  ELC50PD
 13134     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 13135        AND WS-AH-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13136           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13137                                                                  ELC50PD
 13138     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 13139        AND WS-LF-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13140           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13141                                                                  ELC50PD
 13142     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13143         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF     ELC50PD
 13144         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH     ELC50PD
 13145         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF       ELC50PD
 13146         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH       ELC50PD
 13147         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE         ELC50PD
 13148         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 13149         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 13150     END-IF
 13151                                                                  ELC50PD
 13152     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13153        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)                ELC50PD
 13154         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.            ELC50PD
 13155                                                                  ELC50PD
 13156     IF (ACCOUNT-MAST-FOUND)
 13157        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 13158        IF PB-REISSUED-CERT
 13159           CONTINUE
 13160        ELSE
 13161           MOVE ER-2608          TO WS-ERROR
 13162           PERFORM 9900-ERROR-FORMAT
 13163                                 THRU 9900-EXIT
 13164         END-IF
 13165     END-IF
 13166                                                                  ELC50PD
 13167     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 13168        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER           ELC50PD
 13169        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.       ELC50PD
 13170                                                                  ELC50PD
 13171**********   DMD CUSTOM CODE FOLLOWS  **********                  ELC50PD
 13172 3024-EDIT-DMD-FIELDS.                                            ELC50PD
 13173     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 13174        GO TO 3025-EDIT-REINSURANCE.                              ELC50PD
 13175                                                                  ELC50PD
 13176*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE          ELC50PD
 13177*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL      ELC50PD
 13178*** ERROR IF THEY ARE NOT EQUAL.                                  ELC50PD
 13179                                                                  ELC50PD
 13180     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.              ELC50PD
 13181     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13182     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13183     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.              CL**3
 13184**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.         CL**3
 13185                                                                  ELC50PD
 13186     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.              ELC50PD
 13187     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13188     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13189     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.           CL**3
 13190**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.           CL**3
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 240
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13191                                                                  ELC50PD
 13192     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM               ELC50PD
 13193        MOVE ER-8116               TO WS-ERROR                    ELC50PD
 13194        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13195                                                                  ELC50PD
 13196     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.             ELC50PD
 13197                                                                  ELC50PD
 13198     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER       ELC50PD
 13199                                      WK-FULL-CERT-NO.            ELC50PD
 13200     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.             ELC50PD
 13201                                                                  ELC50PD
 13202     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.             ELC50PD
 13203                                                                  ELC50PD
 13204     IF PB-VALID-LIFE                                             ELC50PD
 13205        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE               ELC50PD
 13206     ELSE                                                         ELC50PD
 13207        IF PB-VALID-AH                                            ELC50PD
 13208          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.              ELC50PD
 13209                                                                  ELC50PD
 13210                                                                  ELC50PD
 13211     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.         ELC50PD
 13212     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.              ELC50PD
 13213     MOVE SPACES                   TO DCUA-CERT-NUMBER            ELC50PD
 13214                                      DCUA-UNDRWRTR-CODE          ELC50PD
 13215                                      DCUA-UNDRWRTR-GROUP-CODE    ELC50PD
 13216                                      DCUA-RETURN-CODE.           ELC50PD
 13217                                                                  ELC50PD
 13218****************************************************************  ELC50PD
 13219*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***  ELC50PD
 13220***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***  ELC50PD
 13221***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***  ELC50PD
 13222***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***  ELC50PD
 13223***   TO THIS RECORD.                                        ***  ELC50PD
 13224****************************************************************  ELC50PD
 13225     MOVE ' '                      TO WS-DLO-ERROR-SW.            ELC50PD
 13226     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.                        ELC50PD
 13227     IF DCUA-SUCCESSFUL-PROCESS                                   ELC50PD
 13228        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13229                                                                  ELC50PD
 13230     IF DCUA-RETURN-CODE EQUAL '01'                               ELC50PD
 13231        MOVE ER-8110               TO WS-ERROR                    ELC50PD
 13232        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13233        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13234        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13235                                                                  ELC50PD
 13236     IF DCUA-RETURN-CODE EQUAL '02'                               ELC50PD
 13237        MOVE ER-8111               TO WS-ERROR                    ELC50PD
 13238        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13240        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13241                                                                  ELC50PD
 13242     IF DCUA-RETURN-CODE EQUAL '03'                               ELC50PD
 13243        MOVE ER-8074               TO WS-ERROR                    ELC50PD
 13244        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13245        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13246        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13247                                                                  ELC50PD
 13248     IF DCUA-RETURN-CODE EQUAL '04'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 241
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13249        MOVE ER-8075               TO WS-ERROR                    ELC50PD
 13250        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13251        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13252        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13253                                                                  ELC50PD
 13254     IF DCUA-RETURN-CODE EQUAL '05'                               ELC50PD
 13255        MOVE ER-8076               TO WS-ERROR                    ELC50PD
 13256        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13257        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13258        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13259                                                                  ELC50PD
 13260     IF DCUA-RETURN-CODE EQUAL '06'                               ELC50PD
 13261        MOVE ER-8077               TO WS-ERROR                    ELC50PD
 13262        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13264        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13265                                                                  ELC50PD
 13266     IF DCUA-RETURN-CODE EQUAL '07'                               ELC50PD
 13267        MOVE ER-8078               TO WS-ERROR                    ELC50PD
 13268        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13269        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13270        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13271                                                                  ELC50PD
 13272     IF DCUA-RETURN-CODE EQUAL 'E1'                               ELC50PD
 13273        MOVE ER-8079               TO WS-ERROR                    ELC50PD
 13274        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13276        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13277                                                                  ELC50PD
 13278     IF DCUA-RETURN-CODE EQUAL 'E2'                               ELC50PD
 13279        MOVE ER-8080               TO WS-ERROR                    ELC50PD
 13280        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13282        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13283                                                                  ELC50PD
 13284     IF DCUA-RETURN-CODE EQUAL 'E3'                               ELC50PD
 13285        MOVE ER-8098               TO WS-ERROR                    ELC50PD
 13286        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13287        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13288        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13289                                                                  ELC50PD
 13290     IF DCUA-RETURN-CODE EQUAL 'C1'                               ELC50PD
 13291        MOVE ER-8099               TO WS-ERROR                    ELC50PD
 13292        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13293        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13294        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13295                                                                  ELC50PD
 13296     IF DCUA-RETURN-CODE EQUAL 'U1'                               ELC50PD
 13297        MOVE ER-8109               TO WS-ERROR                    ELC50PD
 13298        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13299        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13300        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13301                                                                  ELC50PD
 13302     IF DCUA-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13303        MOVE ER-8112               TO WS-ERROR                    ELC50PD
 13304        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13305        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13306        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 242
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13307                                                                  ELC50PD
 13308     IF DCUA-RETURN-CODE EQUAL 'N2'                               ELC50PD
 13309        MOVE ER-8113               TO WS-ERROR                    ELC50PD
 13310        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13311        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13312        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13313                                                                  ELC50PD
 13314     IF DCUA-RETURN-CODE EQUAL 'N3'                               ELC50PD
 13315        MOVE ER-8114               TO WS-ERROR                    ELC50PD
 13316        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13317        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13318        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13319                                                                  ELC50PD
 13320     MOVE 'Y'                      TO WS-DLO-ERROR-SW.            ELC50PD
 13321     MOVE ER-8097                  TO WS-ERROR.                   ELC50PD
 13322     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.                  ELC50PD
 13323     GO TO 3024-EDIT-DL7-CONT.                                    ELC50PD
 13324                                                                  ELC50PD
 13325 3024-EDIT-DL7-CONT.                                              ELC50PD
 13326                                                                  ELC50PD
 13327     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.               ELC50PD
 13328     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.                ELC50PD
 13329     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE                          ELC50PD
 13330        NEXT SENTENCE                                             ELC50PD
 13331     ELSE                                                         ELC50PD
 13332        MOVE ER-9263               TO WS-ERROR                    ELC50PD
 13333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13334                                                                  ELC50PD
 13335******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS      ELC50PD
 13336******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...              ELC50PD
 13337     IF DCUA-CERT-NUMBER = PB-CERT-NO                             ELC50PD
 13338        NEXT SENTENCE                                             ELC50PD
 13339     ELSE                                                         ELC50PD
 13340        MOVE ER-8039               TO WS-ERROR                    ELC50PD
 13341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13342                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 243
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13344****************************************************************  ELC50PD
 13345*** VALIDATE STATE  : DLO022                                 ***  ELC50PD
 13346****************************************************************  ELC50PD
 13347     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.            ELC50PD
 13348     MOVE SPACES                   TO DVSC-RETURN-CODE.           ELC50PD
 13349                                                                  ELC50PD
 13350     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.                       ELC50PD
 13351     IF DVSC-SUCCESSFUL-EDIT                                      ELC50PD
 13352        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13353                                                                  ELC50PD
 13354     IF DVSC-RETURN-CODE EQUAL '01'                               ELC50PD
 13355        MOVE ER-8300               TO WS-ERROR                    ELC50PD
 13356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13357        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13358                                                                  ELC50PD
 13359     IF DVSC-RETURN-CODE EQUAL '02'                               ELC50PD
 13360        MOVE ER-8301               TO WS-ERROR                    ELC50PD
 13361        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13362        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13363                                                                  ELC50PD
 13364     IF DVSC-RETURN-CODE EQUAL '03'                               ELC50PD
 13365        MOVE ER-8302               TO WS-ERROR                    ELC50PD
 13366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13367        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13368                                                                  ELC50PD
 13369     IF DVSC-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13370        MOVE ER-8304               TO WS-ERROR                    ELC50PD
 13371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13372        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13373                                                                  ELC50PD
 13374     MOVE ER-8303                  TO WS-ERROR                    ELC50PD
 13375     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13376                                                                  ELC50PD
 13377 3024-EDIT-DL22-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 244
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13379****************************************************************  ELC50PD
 13380*** VALIDATE LOAN OFFICER : DLO021                           ***  ELC50PD
 13381****************************************************************  ELC50PD
 13382                                                                  ELC50PD
 13383     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.         ELC50PD
 13384     MOVE SPACES                    TO DVLO-RETURN-CODE.          ELC50PD
 13385     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.                       ELC50PD
 13386     IF DVLO-SUCCESSFUL-EDIT                                      ELC50PD
 13387        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13388                                                                  ELC50PD
 13389     IF DVLO-RETURN-CODE EQUAL '01'                               ELC50PD
 13390        MOVE ER-8081               TO WS-ERROR                    ELC50PD
 13391        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13392        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13393                                                                  ELC50PD
 13394     IF DVLO-RETURN-CODE EQUAL '02'                               ELC50PD
 13395        MOVE ER-8082               TO WS-ERROR                    ELC50PD
 13396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13397        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13398                                                                  ELC50PD
 13399     IF DVLO-RETURN-CODE EQUAL '03'                               ELC50PD
 13400        MOVE ER-8083               TO WS-ERROR                    ELC50PD
 13401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13402        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13403                                                                  ELC50PD
 13404     IF DVLO-RETURN-CODE EQUAL '04'                               ELC50PD
 13405        MOVE ER-8084               TO WS-ERROR                    ELC50PD
 13406        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13407        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13408                                                                  ELC50PD
 13409     IF DVLO-RETURN-CODE EQUAL '05'                               ELC50PD
 13410        MOVE ER-8085               TO WS-ERROR                    ELC50PD
 13411        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13412        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13413                                                                  ELC50PD
 13414     MOVE ER-7825                  TO WS-ERROR                    ELC50PD
 13415     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13416     GO TO 3024-EDIT-DL21-CONT.                                   ELC50PD
 13417                                                                  ELC50PD
 13418 3024-EDIT-DL21-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 245
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13420                                                                  ELC50PD
 13421****************************************************************  ELC50PD
 13422*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***  ELC50PD
 13423****************************************************************  ELC50PD
 13424                                                                  ELC50PD
 13425     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.                 ELC50PD
 13426     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.      ELC50PD
 13427     MOVE SPACES                 TO DIPF-RETURN-CODE.             ELC50PD
 13428     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.                       ELC50PD
 13429     IF DIPF-SUCCESSFUL-EDIT                                      ELC50PD
 13430        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13431                                                                  ELC50PD
 13432     IF DIPF-RETURN-CODE EQUAL '01'                               ELC50PD
 13433        MOVE ER-8086               TO WS-ERROR                    ELC50PD
 13434        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13435        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13436                                                                  ELC50PD
 13437     IF DIPF-RETURN-CODE EQUAL '02'                               ELC50PD
 13438        MOVE ER-8087               TO WS-ERROR                    ELC50PD
 13439        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13440        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13441                                                                  ELC50PD
 13442     IF DIPF-RETURN-CODE EQUAL '03'                               ELC50PD
 13443        MOVE ER-8088               TO WS-ERROR                    ELC50PD
 13444        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13445        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13446                                                                  ELC50PD
 13447     MOVE ER-8095                  TO WS-ERROR                    ELC50PD
 13448     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13449     GO TO 3024-EDIT-DL02-CONT.                                   ELC50PD
 13450                                                                  ELC50PD
 13451 3024-EDIT-DL02-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 246
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13453                                                                  ELC50PD
 13454****************************************************************  ELC50PD
 13455*** VALIDATE BANK ID : DLO003                                ***  ELC50PD
 13456****************************************************************  ELC50PD
 13457                                                                  ELC50PD
 13458     MOVE WK-GREG-CENT           TO WCG-CENT.                     ELC50PD
 13459     MOVE WK-GREG-YYMM           TO WCG-REST.                     ELC50PD
 13460     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG                         ELC50PD
 13461        MOVE ER-8040               TO WS-ERROR                    ELC50PD
 13462        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13463                                                                  ELC50PD
 13464     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.                  ELC50PD
 13465     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.                ELC50PD
 13466     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.           ELC50PD
 13467     MOVE SPACES                 TO  DVBI-RETURN-CODE.            ELC50PD
 13468     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.                  ELC50PD
 13469     IF DVBI-SUCCESSFUL-EDIT                                      ELC50PD
 13470        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13471                                                                  ELC50PD
 13472     IF DVBI-RETURN-CODE EQUAL '01'                               ELC50PD
 13473        MOVE ER-8089               TO WS-ERROR                    ELC50PD
 13474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13475        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13476                                                                  ELC50PD
 13477     IF DVBI-RETURN-CODE EQUAL '02'                               ELC50PD
 13478        MOVE ER-8090               TO WS-ERROR                    ELC50PD
 13479        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13480        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13481                                                                  ELC50PD
 13482     IF DVBI-RETURN-CODE EQUAL '03'                               ELC50PD
 13483        MOVE ER-8091               TO WS-ERROR                    ELC50PD
 13484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13485        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13486                                                                  ELC50PD
 13487     IF DVBI-RETURN-CODE EQUAL '04'                               ELC50PD
 13488        MOVE ER-8092               TO WS-ERROR                    ELC50PD
 13489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13490        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13491                                                                  ELC50PD
 13492     IF DVBI-RETURN-CODE EQUAL '05'                               ELC50PD
 13493        MOVE ER-8093               TO WS-ERROR                    ELC50PD
 13494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13495        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13496                                                                  ELC50PD
 13497     IF DVBI-RETURN-CODE EQUAL '06'                               ELC50PD
 13498        MOVE ER-8094               TO WS-ERROR                    ELC50PD
 13499        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13500        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13501                                                                  ELC50PD
 13502     MOVE ER-8096                  TO WS-ERROR                    ELC50PD
 13503     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13504     GO TO 3024-EDIT-DL03-CONT.                                   ELC50PD
 13505                                                                  ELC50PD
 13506 3024-EDIT-DL03-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 247
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13508                                                                  ELC50PD
 13509     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR               ELC50PD
 13510        NEXT SENTENCE                                             ELC50PD
 13511     ELSE                                                         ELC50PD
 13512        MOVE ER-8042               TO WS-ERROR                    ELC50PD
 13513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13514                                                                  ELC50PD
 13515     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.     ELC50PD
 13516     MOVE SPACES                 TO  DMPF-RETURN-CODE.            ELC50PD
 13517     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.                       ELC50PD
 13518                                                                  ELC50PD
 13519     IF DMPF-RETURN-CODE = '01'                                   ELC50PD
 13520        MOVE ER-8067               TO WS-ERROR                    ELC50PD
 13521        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13522        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13523                                                                  ELC50PD
 13524     IF DMPF-RETURN-CODE = '02'                                   ELC50PD
 13525        MOVE ER-8068               TO WS-ERROR                    ELC50PD
 13526        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13527        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13528                                                                  ELC50PD
 13529     IF DMPF-RETURN-CODE = '03'                                   ELC50PD
 13530        MOVE ER-8069               TO WS-ERROR                    ELC50PD
 13531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13532        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13533                                                                  ELC50PD
 13534     IF DMPF-RETURN-CODE = 'E1'                                   ELC50PD
 13535        MOVE ER-8070               TO WS-ERROR                    ELC50PD
 13536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13537        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13538                                                                  ELC50PD
 13539     IF DMPF-RETURN-CODE = 'N1'                                   ELC50PD
 13540        MOVE ER-8071               TO WS-ERROR                    ELC50PD
 13541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13542        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13543                                                                  ELC50PD
 13544     IF DMPF-RETURN-CODE NOT = 'OK'                               ELC50PD
 13545        MOVE ER-8072               TO WS-ERROR                    ELC50PD
 13546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13547                                                                  ELC50PD
 13548 3024-EDIT-DL01-CONT.                                             ELC50PD
 13549******************************************************************ELC50PD
 13550***  VALIDATES RATE CODES : DLO017                             ***ELC50PD
 13551******************************************************************ELC50PD
 13552                                                                  ELC50PD
 13553      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.            ELC50PD
 13554      MOVE SPACES                   TO DVRC-RETURN-CODE.          ELC50PD
 13555      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.                      ELC50PD
 13556      IF DVRC-SUCCESSFUL-EDIT                                     ELC50PD
 13557        MOVE 'Y'                   TO WK-VALID-RATE-CODE          ELC50PD
 13558        GO TO 3024-CHECK-VALID-RATE.                              ELC50PD
 13559                                                                  ELC50PD
 13560      MOVE 'N'                     TO WK-VALID-RATE-CODE.         ELC50PD
 13561                                                                  ELC50PD
 13562      IF DVRC-RETURN-CODE EQUAL '01'                              ELC50PD
 13563         MOVE ER-7817                   TO WS-ERROR               ELC50PD
 13564         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13565         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 248
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13566                                                                  ELC50PD
 13567      IF DVRC-RETURN-CODE EQUAL '02'                              ELC50PD
 13568         MOVE ER-7818                   TO WS-ERROR               ELC50PD
 13569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13570         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13571                                                                  ELC50PD
 13572      IF DVRC-RETURN-CODE EQUAL '03'                              ELC50PD
 13573         MOVE ER-7819                   TO WS-ERROR               ELC50PD
 13574         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13575         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13576                                                                  ELC50PD
 13577       MOVE ER-7820                     TO WS-ERROR.              ELC50PD
 13578       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13579       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13580                                                                  ELC50PD
 13581******************************************************************ELC50PD
 13582***  GET PREMIUM RATES : DLO011                                ***ELC50PD
 13583******************************************************************ELC50PD
 13584                                                                  ELC50PD
 13585 3024-CHECK-VALID-RATE.                                           ELC50PD
 13586                                                                  ELC50PD
 13587     IF VALID-RATE-CODE                                           ELC50PD
 13588        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE              ELC50PD
 13589        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG         ELC50PD
 13590        MOVE SPACES                TO DPRB-RETURN-CODE            ELC50PD
 13591        PERFORM 7740-CALL-DL11 THRU 7740-EXIT                     ELC50PD
 13592     ELSE                                                         ELC50PD
 13593         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13594                                                                  ELC50PD
 13595      IF DPRB-SUCCESSFUL-PROCESS                                  ELC50PD
 13596         IF PB-VALID-LIFE                                         ELC50PD
 13597             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE           ELC50PD
 13598             GO TO 3025-EDIT-REINSURANCE                          ELC50PD
 13599         ELSE                                                     ELC50PD
 13600             IF PB-VALID-AH                                       ELC50PD
 13601                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE           ELC50PD
 13602                 GO TO 3025-EDIT-REINSURANCE.                     ELC50PD
 13603                                                                  ELC50PD
 13604      IF DPRB-RETURN-CODE EQUAL '01'                              ELC50PD
 13605         MOVE ER-7812                   TO WS-ERROR               ELC50PD
 13606         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13607         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13608                                                                  ELC50PD
 13609      IF DPRB-RETURN-CODE EQUAL '02'                              ELC50PD
 13610         MOVE ER-7813                   TO WS-ERROR               ELC50PD
 13611         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13612         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13613                                                                  ELC50PD
 13614      IF DPRB-RETURN-CODE EQUAL '03'                              ELC50PD
 13615         MOVE ER-7814                   TO WS-ERROR               ELC50PD
 13616         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13617         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13618                                                                  ELC50PD
 13619      IF DPRB-RETURN-CODE EQUAL '04'                              ELC50PD
 13620         IF NOT DPRB-1ST-TIME                                     ELC50PD
 13621            MOVE ER-7815                   TO WS-ERROR            ELC50PD
 13622            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 13623            GO TO 3025-EDIT-REINSURANCE                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 249
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13624          ELSE                                                    ELC50PD
 13625         IF PB-VALID-LIFE                                         ELC50PD
 13626            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13627          ELSE                                                    ELC50PD
 13628            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13629         END-IF                                                   ELC50PD
 13630         MOVE SPACES                TO DOCC-RETURN-CODE           ELC50PD
 13631         MOVE 'X'                   TO DPRB-1ST-TIME-SW           ELC50PD
 13632         PERFORM 7755-CALL-DL19 THRU 7755-EXIT                    ELC50PD
 13633         IF DOCC-RETURN-CODE = 'OK'                               ELC50PD
 13634             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4          ELC50PD
 13635             GO TO 3024-CHECK-VALID-RATE                          ELC50PD
 13636           ELSE                                                   ELC50PD
 13637             MOVE ER-7823               TO WS-ERROR               ELC50PD
 13638             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT            ELC50PD
 13639             GO TO 3025-EDIT-REINSURANCE.                         ELC50PD
 13640                                                                  ELC50PD
 13641       MOVE ER-7816                     TO WS-ERROR.              ELC50PD
 13642       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13643       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13644                                                                  ELC50PD
 13645**********   DMD CUSTOM CODE ABOVE    **********                  ELC50PD
 13646                                                                  ELC50PD
 13647 3025-EDIT-REINSURANCE.                                           ELC50PD
 13648     IF PB-I-SPECIAL-REIN-CODE = SPACE                            ELC50PD
 13649         GO TO 3027-EDIT-CONTINUE.                                ELC50PD
 13650                                                                  ELC50PD
 13651     MOVE LOW-VALUES               TO ERREIN-KEY.                 ELC50PD
 13652     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.               ELC50PD
 13653     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1                 ELC50PD
 13654                                      REIN-CODE-2                 ELC50PD
 13655                                      REIN-CODE-3.                ELC50PD
 13656     MOVE 'A'                      TO REIN-TYPE.                  ELC50PD
 13657                                                                  ELC50PD
 13658     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.            ELC50PD
 13659                                                                  ELC50PD
 13660     MOVE '3026' TO REIN-SW.                                      ELC50PD
 13661     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13662                                                                  ELC50PD
 13663     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13664     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13665         GO TO 3026-NO-SPEC-TABLE.                                ELC50PD
 13666                                                                  ELC50PD
 13667     MOVE RE-TABLE              TO WK-REIN-TABLE.                 ELC50PD
 13668     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13669                                   WS-NSP-ST-CD-LF.               ELC50PD
 13670     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13671                                   WS-NSP-ST-CD-AH.               ELC50PD
 13672                                                                  ELC50PD
 13673     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13674                                                                  ELC50PD
 13675 3026-NO-SPEC-TABLE.                                              ELC50PD
 13676                                                                  ELC50PD
 13677     MOVE ER-2664                TO WS-ERROR.                     ELC50PD
 13678     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13679     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13680                                                                  ELC50PD
 13681 3027-EDIT-CONTINUE.                                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 250
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13682                                                                  ELC50PD
 13683     IF PB-I-REIN-TABLE = SPACES                                  ELC50PD
 13684       GO TO 3040-EDIT-CONTINUE.                                  ELC50PD
 13685                                                                  ELC50PD
 13686     IF PB-I-REIN-TABLE = WK-REIN-TABLE                           ELC50PD
 13687          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF               ELC50PD
 13688          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH               ELC50PD
 13689           GO TO 3040-EDIT-CONTINUE.                              ELC50PD
 13690                                                                  ELC50PD
 13691     MOVE LOW-VALUES            TO ERREIN-KEY.                    ELC50PD
 13692     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.                  ELC50PD
 13693     MOVE 'A'                   TO REIN-TYPE.                     ELC50PD
 13694     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.                 ELC50PD
 13695                                                                  ELC50PD
 13696     MOVE '3028'                TO REIN-SW.                       ELC50PD
 13697     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13698                                                                  ELC50PD
 13699     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13700     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13701         GO TO 3028-NO-REIN-TABLE.                                ELC50PD
 13702                                                                  ELC50PD
 13703     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.                 ELC50PD
 13704     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13705                                   WS-NSP-ST-CD-LF.               ELC50PD
 13706     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13707                                   WS-NSP-ST-CD-AH.               ELC50PD
 13708                                                                  ELC50PD
 13709     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13710                                                                  ELC50PD
 13711 3028-NO-REIN-TABLE.                                              ELC50PD
 13712                                                                  ELC50PD
 13713     MOVE ER-2615                TO WS-ERROR.                     ELC50PD
 13714     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13715     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13716                                                                  ELC50PD
 13717 3040-EDIT-CONTINUE.                                              ELC50PD
 13718                                                                  ELC50PD
 13719     IF PB-I-LF-PREM-CALC NOT NUMERIC                             ELC50PD
 13720         MOVE ZEROS              TO PB-I-LF-PREM-CALC.            ELC50PD
 13721                                                                  ELC50PD
 13722     IF PB-I-AH-PREM-CALC NOT NUMERIC                             ELC50PD
 13723         MOVE ZEROS              TO PB-I-AH-PREM-CALC.            ELC50PD
 13724                                                                  ELC50PD
 13725     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13726        AND (NOT PB-MONTHLY-CERT)
 13727        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')     ELC50PD
 13728            MOVE '001'           TO PB-I-LF-TERM                  ELC50PD
 13729            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13730                                                                  ELC50PD
 13731     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13732        AND (NOT PB-MONTHLY-CERT)
 13733        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')     ELC50PD
 13734            MOVE '001'           TO PB-I-AH-TERM                  ELC50PD
 13735            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13736                                                                  ELC50PD
 13737 3040-EDIT-1ST-PMT-DT.                                            ELC50PD
 13738
 13739     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 251
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13740     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 13741         MOVE ZEROS TO PB-I-EXTENTION-DAYS.                       ELC50PD
 13742                                                                  ELC50PD
 13743******************************************************************ELC50PD
 13744*                                                                *ELC50PD
 13745*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *ELC50PD
 13746*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *ELC50PD
 13747*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *ELC50PD
 13748*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *ELC50PD
 13749*                                                                *ELC50PD
 13750******************************************************************ELC50PD
 13751                                                                  ELC50PD
 13752     IF PB-EFF-DT-PROCESSING                                      ELC50PD
 13753        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13754                                    PB-I-LF-EXPIRE-DT             ELC50PD
 13755                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13756        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13757        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1                 ELC50PD
 13758        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13759        MOVE +1                  TO DC-ELAPSED-MONTHS             ELC50PD
 13760        SET BIN-PLUS-ELAPSED     TO TRUE                          ELC50PD
 13761*       MOVE 6                   TO DC-OPTION-CODE                ELC50PD
 13762        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13763        IF NO-CONVERSION-ERROR                                    ELC50PD
 13764           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.              ELC50PD
 13765                                                                  ELC50PD
 13766******************************************************************ELC50PD
 13767*                                                                *ELC50PD
 13768*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *ELC50PD
 13769*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *ELC50PD
 13770*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13771*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *ELC50PD
 13772*                                                                *ELC50PD
 13773******************************************************************ELC50PD
 13774                                                                  ELC50PD
 13775     IF PB-EXT-DAYS-PROCESSING                                    ELC50PD
 13776          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT          ELC50PD
 13777                                         PB-I-LF-EXPIRE-DT        ELC50PD
 13778                                         PB-I-AH-EXPIRE-DT        ELC50PD
 13779          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1            ELC50PD
 13780          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13781          MOVE +1                     TO DC-ELAPSED-MONTHS        ELC50PD
 13782          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS          ELC50PD
 13783          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13784*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 13785          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13786          IF NO-CONVERSION-ERROR                                  ELC50PD
 13787             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.         ELC50PD
 13788                                                                  ELC50PD
 13789******************************************************************ELC50PD
 13790*                                                                *ELC50PD
 13791*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *ELC50PD
 13792*        BASED ON THE OLDEST EXPIRE DATE.                        *ELC50PD
 13793*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13794*        (EXPIRE DATE - (TERM -1))  *  -1.                        ELC50PD
 13795*                                                                *ELC50PD
 13796******************************************************************ELC50PD
 13797                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 252
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13798     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13799        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT       ELC50PD
 13800           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13801              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13802              MOVE PB-I-AH-TERM      TO WS-TERM                   ELC50PD
 13803           ELSE                                                   ELC50PD
 13804              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13805              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13806        ELSE                                                      ELC50PD
 13807           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13808              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13809              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13810           ELSE                                                   ELC50PD
 13811              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13812              MOVE PB-I-AH-TERM      TO WS-TERM.                  ELC50PD
 13813                                                                  ELC50PD
 13814     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13815        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13816        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13817        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1                 ELC50PD
 13818        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13819                                    DC-ODD-DAYS-OVER              ELC50PD
 13820          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1          ELC50PD
 13821          SET BIN-PLUS-ELAPSED    TO TRUE                         ELC50PD
 13822*         MOVE 6                  TO DC-OPTION-CODE               ELC50PD
 13823          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13824          IF NO-CONVERSION-ERROR                                  ELC50PD
 13825             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.            ELC50PD
 13826                                                                  ELC50PD
 13827******************************************************************ELC50PD
 13828*                                                                *ELC50PD
 13829*            1ST PAYMENT DATE PROCESSING                         *ELC50PD
 13830*                                                                *ELC50PD
 13831******************************************************************ELC50PD
 13832                                                                  ELC50PD
 13833     IF PB-1ST-PMT-DT-PROCESSING                                  ELC50PD
 13834        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT             ELC50PD
 13835                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13836        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.          ELC50PD
 13837                                                                  ELC50PD
 13838     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT              ELC50PD
 13839         NEXT SENTENCE                                            ELC50PD
 13840     ELSE                                                         ELC50PD
 13841         MOVE ER-2680                 TO WS-ERROR                 ELC50PD
 13842         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13843         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 13844                                                                  ELC50PD
 13845     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 13846     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.                ELC50PD
 13847     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13848*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13849     MOVE ZEROS                  TO DC-ELAPSED-MONTHS             ELC50PD
 13850                                    DC-ELAPSED-DAYS               ELC50PD
 13851                                    DC-ODD-DAYS-OVER.             ELC50PD
 13852                                                                  ELC50PD
 13853     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13854                                                                  ELC50PD
 13855     IF DATE-CONVERSION-ERROR                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 253
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13856        GO TO 3060-ORIG-TERM-CHECK.                               ELC50PD
 13857                                                                  ELC50PD
 13858     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 13859
 13860     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13861        AND (WS-LF-COVERAGE-TYPE = 'L')
 13862        IF (DC-ELAPSED-MONTHS > 1)
 13863                      OR
 13864           ((DC-ELAPSED-MONTHS = 1)
 13865           AND (DC-ODD-DAYS-OVER > 0))
 13866           MOVE ER-2882          TO WS-ERROR
 13867           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13868        END-IF
 13869     END-IF
 13870
 13871     if dc-elapsed-months > 0
 13872        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 13873        + dc-odd-days-over
 13874     end-if
 13875
 13876     IF PB-EXT-DAYS-PROCESSING
 13877        CONTINUE
 13878     ELSE
 13879        IF DC-ELAPSED-MONTHS = +0
 13880           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 13881        ELSE
 13882           IF (WS-LF-EARNINGS-CALC = '4')
 13883              AND (DC-ELAPSED-MONTHS > ZERO)
 13884              AND (DC-ELAPSED-DAYS > ZERO)
 13885              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 13886           ELSE
 13887              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 13888                                 THRU 6499-EXIT
 13889              MOVE WS-ODD-DAYS-OVER
 13890                                 TO PB-I-EXTENTION-DAYS
 13891           END-IF
 13892        END-IF
 13893     END-IF
 13894
 13895******************************************************************ELC50PD
 13896*                                                                *ELC50PD
 13897*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *ELC50PD
 13898*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *ELC50PD
 13899*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *ELC50PD
 13900*            AND ANY ODD DAYS.                                   *ELC50PD
 13901*                                                                *ELC50PD
 13902******************************************************************ELC50PD
 13903                                                                  ELC50PD
 13904     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -                  ELC50PD
 13905                              (EC-ST-FST-PMT-DAYS-MAX + 32)       ELC50PD
 13906     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13907        IF DC-ELAPSED-DAYS > ZEROS
 13908           MOVE ER-2681          TO WS-ERROR
 13909           PERFORM 9900-ERROR-FORMAT
 13910                                 THRU 9900-EXIT
 13911        END-IF
 13912     END-IF
 13913                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 254
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13914     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13915        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX     ELC50PD
 13916           MOVE ER-2681          TO WS-ERROR                      ELC50PD
 13917           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 13918                                                                  ELC50PD
 13919     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13920        (PB-I-LF-TERM NOT = ZERO) AND                             ELC50PD
 13921         NOT NO-LIFE-COVERAGE                                     ELC50PD
 13922          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1                 ELC50PD
 13923          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1           ELC50PD
 13924          IF WS-LF-EARNINGS-CALC = '4'
 13925             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 13926             PB-I-PAY-FREQUENCY
 13927          END-IF
 13928          MOVE ZERO              TO DC-ELAPSED-DAYS               ELC50PD
 13929                                    DC-ODD-DAYS-OVER              ELC50PD
 13930          MOVE 1                 TO DC-END-OF-MONTH               ELC50PD
 13931          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13932*         MOVE 6                 TO DC-OPTION-CODE                ELC50PD
 13933          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13934          IF NO-CONVERSION-ERROR                                  ELC50PD
 13935             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT        ELC50PD
 13936             IF (WS-LF-EARNINGS-CALC = 'B') AND                   ELC50PD
 13937                (WS-LF-SPECIAL-CALC-CD = 'L')                     ELC50PD
 13938                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1         ELC50PD
 13939                  MOVE ZERO           TO DC-ELAPSED-DAYS          ELC50PD
 13940                  MOVE +1             TO DC-ELAPSED-MONTHS        ELC50PD
 13941                  SET BIN-PLUS-ELAPSED  TO TRUE                   ELC50PD
 13942*                 MOVE 6              TO DC-OPTION-CODE           ELC50PD
 13943                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT        ELC50PD
 13944                  IF NO-CONVERSION-ERROR                          ELC50PD
 13945                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.     ELC50PD
 13946                                                                  ELC50PD
 13947* okay, i had to move the new att age edit down here because the
 13948* expiration date could get recalculated and i need the exp date
 13949
 13950
 13951     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 13952        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 13953        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13954        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13955           AND ZEROS
 13956           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13957           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13958           SET ELAPSED-BETWEEN-BIN TO TRUE
 13959           PERFORM 8500-DATE-CONVERT
 13960                                 THRU 8500-EXIT
 13961           IF NO-CONVERSION-ERROR
 13962              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13963                 MOVE ER-2669       TO WS-ERROR
 13964*                PERFORM 9900-ERROR-FORMAT
 13965*                                THRU 9900-EXIT
 13966              END-IF
 13967           END-IF
 13968        ELSE
 13969           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13970           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 13971              MOVE ER-2669       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 255
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13972*             PERFORM 9900-ERROR-FORMAT
 13973*                                THRU 9900-EXIT
 13974           ELSE
 13975              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 13976                 MOVE ER-1570    TO WS-ERROR
 13977                 PERFORM 9900-ERROR-FORMAT
 13978                                 THRU 9900-EXIT
 13979              END-IF
 13980           END-IF
 13981        END-IF
 13982
 13983        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13984           AND ZEROS
 13985           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 13986           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13987           SET ELAPSED-BETWEEN-BIN TO TRUE
 13988           PERFORM 8500-DATE-CONVERT
 13989                                 THRU 8500-EXIT
 13990           IF NO-CONVERSION-ERROR
 13991              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13992                 MOVE ER-2669       TO WS-ERROR
 13993*                PERFORM 9900-ERROR-FORMAT
 13994*                                THRU 9900-EXIT
 13995              END-IF
 13996           END-IF
 13997        ELSE
 13998           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13999             (PB-I-LF-TERM / 12)
 14000           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 14001              MOVE ER-2669       TO WS-ERROR
 14002*             PERFORM 9900-ERROR-FORMAT
 14003*                                THRU 9900-EXIT
 14004           ELSE
 14005              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 14006                 MOVE ER-1571    TO WS-ERROR
 14007                 PERFORM 9900-ERROR-FORMAT
 14008                                 THRU 9900-EXIT
 14009              END-IF
 14010           END-IF
 14011        END-IF
 14012        IF WS-ERROR = ER-2669
 14013           PERFORM 9900-ERROR-FORMAT
 14014                                 THRU 9900-EXIT
 14015        END-IF
 14016
 14017     END-IF
 14018
 14019     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 14020        (PB-I-AH-TERM NOT = ZERO) AND                             ELC50PD
 14021         NOT NO-AH-COVERAGE                                       ELC50PD
 14022          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 14023             AND (PB-COMPANY-ID = 'DCC')
 14024             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 14025             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 14026          ELSE
 14027             IF WS-LF-EARNINGS-CALC = '4'
 14028                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 14029                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 256
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14030                PB-I-PAY-FREQUENCY
 14031             ELSE
 14032                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 14033                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 14034             END-IF
 14035          END-IF
 14036          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 14037                                         DC-ODD-DAYS-OVER         ELC50PD
 14038          MOVE 1                      TO DC-END-OF-MONTH          ELC50PD
 14039          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 14040*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 14041          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 14042          IF NO-CONVERSION-ERROR                                  ELC50PD
 14043             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.       ELC50PD
 14044
 14045     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 14046        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 14047        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14048        IF PB-I-BIRTHDAY > LOW-VALUES
 14049           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14050           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14051           SET ELAPSED-BETWEEN-BIN TO TRUE
 14052           PERFORM 8500-DATE-CONVERT
 14053                                 THRU 8500-EXIT
 14054           IF NO-CONVERSION-ERROR
 14055              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14056                 MOVE ER-3054       TO WS-ERROR
 14057*                PERFORM 9900-ERROR-FORMAT
 14058*                                THRU 9900-EXIT
 14059              END-IF
 14060           END-IF
 14061        ELSE
 14062           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14063           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 14064              MOVE ER-3054       TO WS-ERROR
 14065*             PERFORM 9900-ERROR-FORMAT
 14066*                                THRU 9900-EXIT
 14067           END-IF
 14068        END-IF
 14069
 14070        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14071           AND ZEROS
 14072           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14073           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14074           SET ELAPSED-BETWEEN-BIN TO TRUE
 14075           PERFORM 8500-DATE-CONVERT
 14076                                 THRU 8500-EXIT
 14077           IF NO-CONVERSION-ERROR
 14078              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14079                 MOVE ER-3054       TO WS-ERROR
 14080*                PERFORM 9900-ERROR-FORMAT
 14081*                                THRU 9900-EXIT
 14082              END-IF
 14083           END-IF
 14084        ELSE
 14085           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14086             (PB-I-AH-TERM / 12)
 14087           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 257
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14088              MOVE ER-3054       TO WS-ERROR
 14089*             PERFORM 9900-ERROR-FORMAT
 14090*                                THRU 9900-EXIT
 14091           END-IF
 14092        END-IF
 14093        IF WS-ERROR = ER-3054
 14094           PERFORM 9900-ERROR-FORMAT
 14095                                 THRU 9900-EXIT
 14096        END-IF
 14097
 14098     END-IF
 14099
 14100     MOVE SPACE                       TO DC-END-OF-MONTH.         ELC50PD
 14101                                                                  ELC50PD
 14102     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14103        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14104                                                                     CL**6
 14105     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14106       AND                                                        ELC50PD
 14107        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14108        NEXT SENTENCE                                             ELC50PD
 14109     ELSE                                                            CL**6
 14110        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14111                                                                     CL**6
 14112     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT             ELC50PD
 14113        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14114        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2                 ELC50PD
 14115     ELSE                                                         ELC50PD
 14116        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14117        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.                ELC50PD
 14118                                                                  ELC50PD
 14119     SET ELAPSED-BETWEEN-BIN TO TRUE.                             ELC50PD
 14120*    MOVE '1'      TO DC-OPTION-CODE                              ELC50PD
 14121     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                     ELC50PD
 14122     IF (NO-CONVERSION-ERROR)
 14123        AND (DC-ELAPSED-MONTHS > +1)
 14124        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 14125        MOVE ER-2668   TO WS-ERROR                                ELC50PD
 14126        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14127                                                                  ELC50PD
 14128 3040-EDIT-EXTENSION-DAYS.                                        ELC50PD
 14129                                                                  ELC50PD
 14130     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 14131        AND (PB-COMPANY-ID NOT EQUAL 'CSL')                       ELC50PD
 14132         GO TO 3050-EDIT-TERM-IN-DAYS                             ELC50PD
 14133     ELSE                                                         ELC50PD
 14134         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.             ELC50PD
 14135                                                                  ELC50PD
 14136     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 14137         MOVE ZEROS             TO PB-I-EXTENTION-DAYS            ELC50PD
 14138     ELSE                                                         ELC50PD
 14139        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)         ELC50PD
 14140           AND (WS-LF-EARNINGS-CALC NOT = '4')                    ELC50PD
 14141           MOVE ER-2681         TO WS-ERROR                       ELC50PD
 14142           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14143                                                                  ELC50PD
 14144     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR                        ELC50PD
 14145        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 258
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14146        (PB-I-AH-EXPIRE-DT = LOW-VALUES)                          ELC50PD
 14147         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 14148                                                                  ELC50PD
 14149     GO TO 3060-ORIG-TERM-CHECK.                                  ELC50PD
 14150                                                                  ELC50PD
 14151 3050-EDIT-TERM-IN-DAYS.                                          ELC50PD
 14152                                                                  ELC50PD
 14153     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.          ELC50PD
 14154                                                                  ELC50PD
 14155     IF PB-I-TERM-IN-DAYS NOT NUMERIC                             ELC50PD
 14156         MOVE ZEROS              TO PB-I-TERM-IN-DAYS             ELC50PD
 14157     ELSE                                                         ELC50PD
 14158         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO               ELC50PD
 14159            MOVE ER-2682         TO WS-ERROR                      ELC50PD
 14160            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14161                                                                  ELC50PD
 14162     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM        ELC50PD
 14163                                       REMAINDER WS-WORK-TERM.    ELC50PD
 14164     IF WS-WORK-TERM GREATER THAN ZERO                            ELC50PD
 14165         ADD +1 TO PB-I-LF-TERM.                                  ELC50PD
 14166                                                                  ELC50PD
 14167     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14168         MOVE ER-2684            TO WS-ERROR                      ELC50PD
 14169         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14170                                                                  ELC50PD
 14171                                                                  ELC50PD
 14172 3060-ORIG-TERM-CHECK.                                            ELC50PD
 14173                                                                  ELC50PD
 14174******************************************************************ELC50PD
 14175*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS                ELC50PD
 14176******************************************************************ELC50PD
 14177                                                                  ELC50PD
 14178     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14179        NEXT SENTENCE                                             ELC50PD
 14180     ELSE                                                         ELC50PD
 14181        IF NOT NO-LIFE-COVERAGE                                   ELC50PD
 14182           IF PB-I-LF-TERM NUMERIC                                ELC50PD
 14183              AND (PB-I-LF-TERM GREATER THAN ZERO)                ELC50PD
 14184              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)     ELC50PD
 14185              AND (PB-I-LF-TERM NOT GREATER THAN +360)            ELC50PD
 14186                  NEXT SENTENCE                                   ELC50PD
 14187           ELSE                                                   ELC50PD
 14188              MOVE ER-2647       TO WS-ERROR                      ELC50PD
 14189              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14190                                                                  ELC50PD
 14191     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14192         IF PB-I-AH-TERM NUMERIC                                  ELC50PD
 14193            AND (PB-I-AH-TERM GREATER THAN ZERO)                  ELC50PD
 14194            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)       ELC50PD
 14195            AND (PB-I-AH-TERM NOT GREATER THAN +360)              ELC50PD
 14196             NEXT SENTENCE                                        ELC50PD
 14197          ELSE                                                    ELC50PD
 14198              MOVE ER-2658       TO WS-ERROR                      ELC50PD
 14199              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14200                                                                  ELC50PD
 14201     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14202        GO TO 3070-LOAN-TERM-CHECK.                                  CL**6
 14203                                                                     CL**6
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 259
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14204     IF POLICY-HAS-AH                                             ELC50PD
 14205       AND                                                        ELC50PD
 14206        POLICY-HAS-LIFE                                           ELC50PD
 14207       AND                                                        ELC50PD
 14208        PB-I-LF-TERM NUMERIC                                      ELC50PD
 14209       AND                                                        ELC50PD
 14210        PB-I-AH-TERM NUMERIC                                      ELC50PD
 14211        NEXT SENTENCE                                             ELC50PD
 14212     ELSE                                                         ELC50PD
 14213        GO TO 3070-LOAN-TERM-CHECK.                               ELC50PD
 14214                                                                  ELC50PD
 14215     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).   ELC50PD
 14216     IF WS-TEX-FACT-2 LESS THAN +0                                ELC50PD
 14217        MULTIPLY +1 BY WS-TEX-FACT-2.                             ELC50PD
 14218                                                                  ELC50PD
 14219     IF WS-TEX-FACT-2 GREATER THAN +1                             ELC50PD
 14220        MOVE ER-2668             TO WS-ERROR                      ELC50PD
 14221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14222                                                                  ELC50PD
 14223 3070-LOAN-TERM-CHECK.                                            ELC50PD
 14224                                                                  ELC50PD
 14225     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14226         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14227            GO TO 3125-EDIT-PMT-FREQ.                             ELC50PD
 14228
 14229*    IF PB-COMPANY-ID NOT = 'DCC'
 14230*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 14231*          AND 'V' AND 'W' AND 'X'
 14232*          GO TO 3125-EDIT-PMT-FREQ
 14233*       END-IF
 14234*    ELSE
 14235*       IF WS-AH-DCC-TRUNC = 'T'
 14236*          CONTINUE
 14237*       ELSE
 14238*          GO TO 3125-EDIT-PMT-FREQ
 14239*       END-IF
 14240*    END-IF
 14241
 14242
 14243
 14244     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14245                    OR
 14246        ((PB-COMPANY-ID = 'DCC')
 14247        AND (WS-AH-DCC-TRUNC = 'T'))
 14248        CONTINUE
 14249     ELSE
 14250        GO TO 3125-EDIT-PMT-FREQ
 14251     END-IF
 14252
 14253     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 14254         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 14255                                                                  ELC50PD
 14256     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND          ELC50PD
 14257        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND          ELC50PD
 14258*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND          ELC50PD
 14259        PB-I-LOAN-TERM NOT GREATER THAN +360                      ELC50PD
 14260         NEXT SENTENCE                                            ELC50PD
 14261     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 260
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14262         MOVE ER-2648            TO WS-ERROR                      ELC50PD
 14263         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14264                                                                  ELC50PD
 14265     if  PB-I-LOAN-TERM > WS-MAX-TERM
 14266        MOVE ER-3058             TO WS-ERROR
 14267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14268     end-if
 14269                                                                  ELC50PD
 14270     IF WS-STATE-ABBREVIATION = 'NC'
 14271        IF PB-I-LOAN-TERM > +59
 14272           CONTINUE
 14273        ELSE
 14274           MOVE ER-2792          TO WS-ERROR
 14275           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50
 14276        END-IF
 14277     END-IF
 14278                                                                  ELC50PD
 14279     .
 14280 3125-EDIT-PMT-FREQ.                                              ELC50PD
 14281
 14282     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14283         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14284            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14285
 14286     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14287                    OR
 14288        ((PB-COMPANY-ID = 'DCC')
 14289        AND (WS-AH-DCC-TRUNC = 'T'))
 14290                    OR
 14291         (PB-COMPANY-ID = 'AHL')
 14292        CONTINUE
 14293     ELSE
 14294        IF (PB-I-LOAN-TERM > ZEROS)
 14295           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 14296           MOVE ER-1575          TO WS-ERROR
 14297           PERFORM 9900-ERROR-FORMAT
 14298                                 THRU 9900-EXIT
 14299        END-IF
 14300     END-IF
 14301
 14302     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 14303         IF PB-I-PAY-FREQUENCY  NOT = ZEROS                       ELC50PD
 14304            MOVE ER-2653         TO WS-ERROR                      ELC50PD
 14305            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14306            GO TO 3127-EDIT-LOAN-OFFICER                          ELC50PD
 14307         ELSE                                                     ELC50PD
 14308            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14309                                                                  ELC50PD
 14310     IF PB-I-PAY-FREQUENCY = ZERO OR 1                            ELC50PD
 14311         MOVE ER-2655            TO WS-ERROR                      ELC50PD
 14312         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14313         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14314                                                                  ELC50PD
 14315     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM              ELC50PD
 14316         MOVE ER-2654            TO WS-ERROR                      ELC50PD
 14317         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14318         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14319                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 261
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14320     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY                    ELC50PD
 14321         GIVING WS-TEX-FACT-2                                     ELC50PD
 14322             REMAINDER WS-TEX-FACT-3.                             ELC50PD
 14323                                                                  ELC50PD
 14324*    IF WS-TEX-FACT-3 NOT = ZERO                                  ELC50PD
 14325*       MOVE ER-2654             TO WS-ERROR                      ELC50PD
 14326*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14327                                                                  ELC50PD
 14328                                                                  ELC50PD
 14329 3127-EDIT-LOAN-OFFICER.                                          ELC50PD
 14330                                                                  ELC50PD
 14331     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 14332        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 14333           MOVE ER-2690          TO WS-ERROR
 14334           PERFORM 9900-ERROR-FORMAT
 14335                                 THRU 9900-EXIT
 14336        ELSE
 14337           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 14338           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 14339           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 14340           MOVE PB-SV-STATE      TO LOFC-STATE
 14341           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 14342           MOVE PB-I-LOAN-OFFICER
 14343                                 TO LOFC-CODE
 14344           PERFORM 8586-READ-LOAN-OFFICER
 14345                                 THRU 8586-EXIT
 14346           IF (NOT LOFC-MASTER-FOUND)
 14347              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 14348              MOVE ER-3006       TO WS-ERROR
 14349              PERFORM 9900-ERROR-FORMAT
 14350                                 THRU 9900-EXIT
 14351           END-IF
 14352        END-IF
 14353     END-IF
 14354
 14355     .
 14356 3129-EDIT-APR.                                                   ELC50PD
 14357                                                                  ELC50PD
 14358     IF (WS-LF-BENEFIT-CD = ZERO)
 14359        OR (NO-LF-BENEFIT-MATCH)
 14360        IF PB-COMPANY-ID NOT = 'DCC'
 14361           GO TO 3130-EDIT-AGE
 14362*       ELSE
 14363*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14364*             GO TO 3130-EDIT-AGE
 14365*          END-IF
 14366        END-IF
 14367     END-IF
 14368                                                                  ELC50PD
 14369     IF (WS-STATE-ABBREVIATION = 'OH')                            ELC50PD
 14370         AND (PB-I-RATE-CLASS NOT = 'L ')
 14371         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14372         AND (PB-CERT-EFF-DT GREATER WS-831031)                   ELC50PD
 14373         GO TO 3129-APR-CONT.                                     ELC50PD
 14374                                                                  ELC50PD
 14375     IF (WS-STATE-ABBREVIATION = 'RI')                            ELC50PD
 14376         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14377         AND (PB-CERT-EFF-DT GREATER WS-831231)                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 262
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14378         GO TO 3129-APR-CONT.                                     ELC50PD
 14379                                                                  ELC50PD
 14380     IF (WS-STATE-ABBREVIATION = 'UT')                            ELC50PD
 14381         AND (PB-I-LF-TERM GREATER THAN 62)                       ELC50PD
 14382         AND (PB-CERT-EFF-DT GREATER WS-810831)                   ELC50PD
 14383         AND (PB-CERT-EFF-DT LESS WS-830901)                      ELC50PD
 14384         GO TO 3129-APR-CONT.                                     ELC50PD
 14385                                                                  ELC50PD
 14386     IF PB-COMPANY-ID = 'LAP'                                     ELC50PD
 14387        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'                 ELC50PD
 14388           IF PB-I-LOAN-APR GREATER THAN ZEROS                    ELC50PD
 14389              MOVE ER-2656         TO WS-ERROR                    ELC50PD
 14390              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14391              GO TO 3130-EDIT-AGE.                                ELC50PD
 14392                                                                  ELC50PD
 14393     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14394        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14395        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 14396        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14397        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 14398        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 14399         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14400                                                                  ELC50PD
 14401 3129-APR-CONT.                                                   ELC50PD
 14402     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR                         ELC50PD
 14403         (WS-LF-SPECIAL-CALC-CD = 'M'))                           ELC50PD
 14404         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14405                                                                  ELC50PD
 14406     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 14407         WS-AH-BENEFIT-CD (1:1) = 'S')
 14408        AND (PB-COMPANY-ID = 'DCC')
 14409        AND (PB-I-LOAN-APR = ZERO)
 14410        MOVE ER-2657             TO WS-ERROR
 14411        PERFORM 9900-ERROR-FORMAT
 14412                                 THRU 9900-EXIT
 14413        GO TO 3130-EDIT-AGE
 14414     END-IF
 14415
 14416     IF PB-I-LOAN-APR = ZERO
 14417        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 14418     END-IF
 14419                                                                  ELC50PD
 14420     IF PB-I-LOAN-APR = ZERO                                      ELC50PD
 14421        MOVE ER-2656             TO WS-ERROR                      ELC50PD
 14422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 14423        GO TO 3130-EDIT-AGE.                                      ELC50PD
 14424                                                                  ELC50PD
 14425*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 14426     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000            ELC50PD
 14427        MOVE ER-2657             TO WS-ERROR                      ELC50PD
 14428        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14429                                                                  ELC50PD
 14430 3130-EDIT-AGE.                                                   ELC50PD
 14431                                                                  ELC50PD
 14432******************************************************************ELC50PD
 14433*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *ELC50PD
 14434******************************************************************ELC50PD
 14435                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 263
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14436     IF NOT NO-LIFE-COVERAGE                                      ELC50PD
 14437        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14438           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99     ELC50PD
 14439               MOVE ER-2628             TO WS-ERROR               ELC50PD
 14440               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14441                                                                  ELC50PD
 14442     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14443        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14444           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99  ELC50PD
 14445               MOVE ER-2628         TO WS-ERROR                   ELC50PD
 14446               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14447                                                                  ELC50PD
 14448 3133-SEX-CODE.                                                   ELC50PD
 14449     IF PB-I-INSURED-SEX = SPACE OR ZERO                          ELC50PD
 14450         IF WS-DEFAULT-SEX = 'M'                                  ELC50PD
 14451             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX              ELC50PD
 14452          ELSE                                                    ELC50PD
 14453             IF WS-DEFAULT-SEX = 'F'                              ELC50PD
 14454             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.             ELC50PD
 14455                                                                  ELC50PD
 14456     IF PB-I-INSURED-SEX = '1'                                    ELC50PD
 14457         MOVE 'M' TO PB-I-INSURED-SEX.                            ELC50PD
 14458                                                                  ELC50PD
 14459     IF PB-I-INSURED-SEX = '2'                                    ELC50PD
 14460         MOVE 'F' TO PB-I-INSURED-SEX.                            ELC50PD
 14461                                                                  ELC50PD
 14462 3134-SIG-SW-EDIT.                                                ELC50PD
 14463     IF PB-I-SIG-SW = SPACE                                       ELC50PD
 14464         MOVE 'N'                TO  PB-I-SIG-SW.                 ELC50PD
 14465                                                                  ELC50PD
 14466     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 14467         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '         ELC50PD
 14468             NEXT SENTENCE                                        ELC50PD
 14469         ELSE                                                     ELC50PD
 14470             MOVE ER-1923        TO  WS-ERROR                     ELC50PD
 14471             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14472     ELSE                                                         ELC50PD
 14473     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14474         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '                ELC50PD
 14475             NEXT SENTENCE                                        ELC50PD
 14476         ELSE                                                     ELC50PD
 14477             MOVE ER-2606        TO  WS-ERROR                     ELC50PD
 14478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14479     ELSE                                                         ELC50PD
 14480     IF PB-COMPANY-ID = 'TMS'                                     ELC50PD
 14481         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'                       ELC50PD
 14482             NEXT SENTENCE                                        ELC50PD
 14483         ELSE                                                     ELC50PD
 14484             MOVE ER-2689        TO  WS-ERROR                     ELC50PD
 14485             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14486     ELSE                                                         ELC50PD
 14487         IF PB-I-SIG-SW = 'Y' OR 'N'                              ELC50PD
 14488             NEXT SENTENCE                                        ELC50PD
 14489         ELSE                                                     ELC50PD
 14490             MOVE ER-2651        TO  WS-ERROR                     ELC50PD
 14491             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14492                                                                  ELC50PD
 14493     IF PB-COMPANY-ID = 'FLA'                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 264
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14494         IF (WS-EDIT-AGE GREATER 54  OR                           ELC50PD
 14495             WS-AH-EDIT-AGE GREATER 54)  AND                      ELC50PD
 14496            PB-I-SIG-SW = 'N'                                     ELC50PD
 14497            MOVE ER-2651         TO  WS-ERROR                     ELC50PD
 14498            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14499                                                                  ELC50PD
 14500 3135-NAME-EDIT.                                                  ELC50PD
 14501                                                                  ELC50PD
 14502     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 14503        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 14504        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 14505           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 14506                                 TO PB-I-JOINT-FIRST-NAME
 14507        END-PERFORM
 14508     END-IF
 14509
 14510     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 14511        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 14512        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 14513           MOVE PB-I-JOINT-LAST-NAME (2:14)
 14514                                 TO PB-I-JOINT-LAST-NAME
 14515        END-PERFORM
 14516     END-IF
 14517
 14518     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 14519        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 14520        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 14521           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 14522                                 TO PB-I-INSURED-FIRST-NAME
 14523        END-PERFORM
 14524     END-IF
 14525
 14526     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 14527        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 14528        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 14529           MOVE PB-I-INSURED-LAST-NAME (2:14)
 14530                                 TO PB-I-INSURED-LAST-NAME
 14531        END-PERFORM
 14532     END-IF
 14533
 14534     IF PB-I-INSURED-LAST-NAME = SPACES                           ELC50PD
 14535       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14536       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14537           MOVE ER-2660    TO WS-ERROR                            ELC50PD
 14538           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14539                                                                  ELC50PD
 14540 3136-EDIT-SEX.                                                   ELC50PD
 14541                                                                  ELC50PD
 14542******************************************************************ELC50PD
 14543*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *ELC50PD
 14544******************************************************************ELC50PD
 14545                                                                  ELC50PD
 14546     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 14547        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 14548        NEXT SENTENCE                                             ELC50PD
 14549     ELSE                                                         ELC50PD
 14550        IF PB-I-INSURED-SEX = 'M' OR 'F'                          ELC50PD
 14551           NEXT SENTENCE                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 265
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14552        ELSE                                                      ELC50PD
 14553           MOVE ER-2629            TO WS-ERROR                    ELC50PD
 14554           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14555                                                                  ELC50PD
 14556 3137-EDIT-EFF-DATE.                                              ELC50PD
 14557                                                                  ELC50PD
 14558     IF PB-REISSUED-CERT       OR                                 ELC50PD
 14559        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14560        PB-POLICY-IS-VOIDED                                       ELC50PD
 14561         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14562                                                                  ELC50PD
 14563     MOVE SPACE                  TO WS-2671-SW                    ELC50PD
 14564                                    WS-2672-SW.                   ELC50PD
 14565                                                                  ELC50PD
 14566     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')             ELC50PD
 14567         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END      ELC50PD
 14568             MOVE ER-2703        TO WS-ERROR                      ELC50PD
 14569             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14570             GO TO 3139-EDIT-COVERAGE-CODES.                      ELC50PD
 14571                                                                  ELC50PD
 14572     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END         ELC50PD
 14573         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14574                                                                  ELC50PD
 14575     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 14576     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.                ELC50PD
 14577*    MOVE '1'                    TO DC-OPTION-CODE.               ELC50PD
 14578     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 14579     MOVE +0                     TO DC-ELAPSED-MONTHS             ELC50PD
 14580                                    DC-ELAPSED-DAYS.              ELC50PD
 14581     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 14582                                                                  ELC50PD
 14583     IF DATE-CONVERSION-ERROR                                     ELC50PD
 14584         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14585                                                                  ELC50PD
 14586     IF DC-ELAPSED-DAYS GREATER +180                              ELC50PD
 14587         MOVE ER-2672            TO WS-ERROR                      ELC50PD
 14588         MOVE 'Y'                TO WS-2672-SW                    ELC50PD
 14589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14590     END-IF
 14591                                                                  ELC50PD
 14592     IF WS-ERROR = ER-2671  AND                                   ELC50PD
 14593        PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 14594        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)          ELC50PD
 14595        MOVE SPACE               TO WS-2671-SW                    ELC50PD
 14596        SUBTRACT +1            FROM PB-NO-OF-ERRORS.              ELC50PD
 14597                                                                  ELC50PD
 14598     IF PB-ISSUE-DATE-FORCED  AND                                 ELC50PD
 14599      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))      ELC50PD
 14600         SUBTRACT +1           FROM PB-NO-OF-ERRORS               ELC50PD
 14601         MOVE ER-2673            TO WS-ERROR                      ELC50PD
 14602         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14603         MOVE SPACE              TO WS-2671-SW                    ELC50PD
 14604                                    WS-2672-SW.                   ELC50PD
 14605                                                                  ELC50PD
 14606     IF DC-ELAPSED-MONTHS IS GREATER THAN +9                      ELC50PD
 14607         IF PB-ISSUE-DATE-FORCED                                  ELC50PD
 14608             MOVE ER-2600          TO  WS-ERROR                   ELC50PD
 14609             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 266
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14610         ELSE                                                     ELC50PD
 14611             MOVE ER-2692          TO  WS-ERROR                   ELC50PD
 14612             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14613                                                                  ELC50PD
 14614                                                                  ELC50PD
 14615 3139-EDIT-COVERAGE-CODES.                                        ELC50PD
 14616                                                                  ELC50PD
 14617     if pb-company-id not = 'AHL'
 14618        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 14619           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 14620           MOVE ER-2787          TO WS-ERROR
 14621           PERFORM 9900-ERROR-FORMAT
 14622                                 THRU 9900-EXIT
 14623        END-IF
 14624     end-if
 14625
 14626     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 14627        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 14628                                 > 250000.00
 14629           MOVE ER-2719          TO WS-ERROR
 14630           PERFORM 9900-ERROR-FORMAT
 14631                                 THRU 9900-EXIT
 14632        END-IF
 14633     END-IF
 14634
 14635     IF PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14636        PB-POLICY-IS-VOIDED                                       ELC50PD
 14637         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14638                                                                  ELC50PD
 14639     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND             ELC50PD
 14640        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)                  ELC50PD
 14641         MOVE ER-2630                TO WS-ERROR                  ELC50PD
 14642         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14643                                                                  ELC50PD
 14644     IF PB-I-LF-BENEFIT-CD = ZERO  AND                            ELC50PD
 14645        PB-I-LF-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14646        PB-I-LF-PREMIUM-AMT = ZERO                                ELC50PD
 14647         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14648                                                                  ELC50PD
 14649     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14650        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14651        PB-I-LF-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14652         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14653                                                                  ELC50PD
 14654     IF (PB-I-LF-BENEFIT-CD = ZERO)
 14655        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14656        MOVE ER-2631             TO WS-ERROR
 14657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14658     END-IF
 14659                                                                  ELC50PD
 14660                                                                  ELC50PD
 14661******************************************************************ELC50PD
 14662*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS        ELC50PD
 14663******************************************************************ELC50PD
 14664                                                                  ELC50PD
 14665     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14666        NEXT SENTENCE                                             ELC50PD
 14667     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 267
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14668        IF PB-I-LF-BENEFIT-AMT = ZERO                             ELC50PD
 14669           MOVE ER-2632             TO WS-ERROR                   ELC50PD
 14670           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14671                                                                  ELC50PD
 14672                                                                  ELC50PD
 14673******************************************************************ELC50PD
 14674*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14675******************************************************************ELC50PD
 14676                                                                  ELC50PD
 14677     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14678        CONTINUE                                                  ELC50PD
 14679     ELSE                                                         ELC50PD
 14680        IF PB-I-LF-PREMIUM-AMT = ZERO                             ELC50PD
 14681           IF (NOT PB-COMP-LF-PREM)
 14682              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14683              MOVE ER-2633       TO WS-ERROR
 14684              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14685           END-IF
 14686        END-IF
 14687     END-IF
 14688
 14689     .                                                            ELC50PD
 14690 3140-CHECK-AH-FOR-ZERO.                                          ELC50PD
 14691                                                                  ELC50PD
 14692     IF PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14693        PB-I-AH-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14694        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14695         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14696                                                                  ELC50PD
 14697     IF PB-COMPANY-ID = 'CSL'  AND                                ELC50PD
 14698        PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14699        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14700        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14701         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14702                                                                  ELC50PD
 14703     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14704        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14705        PB-I-AH-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14706         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14707                                                                  ELC50PD
 14708     IF PB-I-AH-BENEFIT-CD = ZERO                                 ELC50PD
 14709         MOVE ER-2634            TO WS-ERROR                      ELC50PD
 14710         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14711                                                                  ELC50PD
 14712******************************************************************ELC50PD
 14713*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14714******************************************************************ELC50PD
 14715                                                                  ELC50PD
 14716     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14717        NEXT SENTENCE                                             ELC50PD
 14718     ELSE                                                         ELC50PD
 14719        IF PB-I-AH-BENEFIT-AMT = ZERO                             ELC50PD
 14720           MOVE ER-2635             TO WS-ERROR                   ELC50PD
 14721           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14722                                                                  ELC50PD
 14723******************************************************************ELC50PD
 14724*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14725******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 268
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14726                                                                  ELC50PD
 14727     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14728        NEXT SENTENCE                                             ELC50PD
 14729     ELSE                                                         ELC50PD
 14730        IF PB-I-AH-PREMIUM-AMT = ZERO                             ELC50PD
 14731            IF NOT PB-COMP-AH-PREM                                ELC50PD
 14732                MOVE ER-2636    TO WS-ERROR                       ELC50PD
 14733                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14734                                                                  ELC50PD
 14735                                                                  ELC50PD
 14736 3140-EDIT-MAX-AMT-SIZES.                                         ELC50PD
 14737* CUSTOM CODE FOR CLIENT    'DMD'                                 ELC50PD
 14738     MOVE ZEROS                   TO WS-RES-STATE-TAX             ELC50PD
 14739                                     WS-RES-MUNI-TAX              ELC50PD
 14740                                     PB-I-STATE-TAX               ELC50PD
 14741                                     PB-I-MUNI-TAX.               ELC50PD
 14742                                                                  ELC50PD
 14743     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.         ELC50PD
 14744                                                                  ELC50PD
 14745     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14746        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14747                                                                  ELC50PD
 14748     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14749        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14750                                                                  ELC50PD
 14751     IF WS-LF-EARNINGS-CALC EQUAL '5'                             ELC50PD
 14752        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14753                                                                  ELC50PD
 14754     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'     ELC50PD
 14755                             OR 'RIC')                            ELC50PD
 14756        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14757                                                                  ELC50PD
 14758     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'                        ELC50PD
 14759        IF PB-I-LOAN-APR GREATER THAN ZEROS                       ELC50PD
 14760            GO TO 3150-RATE-OUTSTAND-BAL                          ELC50PD
 14761        ELSE                                                      ELC50PD
 14762           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'                ELC50PD
 14763               GO TO 3150-RATE-OUTSTAND-BAL.                      ELC50PD
 14764                                                                  ELC50PD
 14765     IF NOT PB-NO-MONTHS-SKIPPED                                  ELC50PD
 14766        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14767                                                                  ELC50PD
 14768     IF PB-I-LF-TERM NOT = PB-I-AH-TERM                           ELC50PD
 14769        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14770                                                                  ELC50PD
 14771     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)                          ELC50PD
 14772        IF PB-I-AH-BENEFIT-AMT NOT = ZERO                         ELC50PD
 14773           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -   ELC50PD
 14774             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                 ELC50PD
 14775           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA            ELC50PD
 14776           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM        ELC50PD
 14777              MOVE ER-2693     TO WS-ERROR                        ELC50PD
 14778              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14779              GO TO 3150-RATE-OUTSTAND-BAL                        ELC50PD
 14780           ELSE                                                   ELC50PD
 14781              GO TO 3150-RATE-OUTSTAND-BAL.                       ELC50PD
 14782                                                                  ELC50PD
 14783 3150-RATE-OUTSTAND-BAL.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 269
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14784                                                                  ELC50PD
 14785* DMD RATING TEST                                                 ELC50PD
 14786     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 14787         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14788         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14789         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 14790         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14791         MOVE 'B'                     TO PB-I-OB-FLAG             ELC50PD
 14792         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 14793                                                                  ELC50PD
 14794     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 14795         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14796             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'                 ELC50PD
 14797                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14798                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14799                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14800                                                                  ELC50PD
 14801     IF  PB-COMPANY-ID   EQUAL    'CDL'                           ELC50PD
 14802         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14803             IF WS-STATE-ABBREVIATION EQUAL 'NC'                  ELC50PD
 14804                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14805                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14806                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14807                                                                  ELC50PD
 14808     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14809        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14810            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14811              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)ELC50PD
 14812                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT  ELC50PD
 14813                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14814                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14815                 MOVE  ER-1910           TO  WS-ERROR             ELC50PD
 14816                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 14817                                                                  ELC50PD
 14818     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14819        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14820            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)  ELC50PD
 14821               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT    ELC50PD
 14822               MOVE  ER-1910           TO  WS-ERROR               ELC50PD
 14823               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 14824                                                                  ELC50PD
 14825     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14826        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14827            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14828                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)      ELC50PD
 14829                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14830                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14831                 MOVE  +0       TO  WS-ERROR.                     ELC50PD
 14832                                                                  ELC50PD
 14833     IF WS-ERROR = ER-2693                                        ELC50PD
 14834        IF PB-COMPANY-ID = 'JAL' AND                              ELC50PD
 14835           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'      ELC50PD
 14836           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14837           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14838                                                                  ELC50PD
 14839     IF WS-ERROR = ER-2693                                        ELC50PD
 14840        IF PB-COMPANY-ID = 'NCL'  AND                             ELC50PD
 14841           PB-I-AH-BENEFIT-CD = 'OA'                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 270
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14842           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14843           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14844                                                                  ELC50PD
 14845     IF WS-ERROR = ER-2693                                        ELC50PD
 14846        IF PB-COMPANY-ID = 'CNL' AND                              ELC50PD
 14847           PB-I-LF-BENEFIT-CD = '71' OR '72'                      ELC50PD
 14848           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14849           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14850                                                                  ELC50PD
 14851     IF WS-ERROR = ER-2693                                        ELC50PD
 14852        IF PB-COMPANY-ID = 'HER'                                  ELC50PD
 14853           IF WS-LEVEL                                            ELC50PD
 14854              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14855              SUBTRACT +1    FROM PB-NO-OF-ERRORS.                ELC50PD
 14856                                                                  ELC50PD
 14857     IF ((LF-BENEFIT-FOUND) AND                                   ELC50PD
 14858         (NOT NO-LIFE-COVERAGE)  AND                              ELC50PD
 14859         (WS-LF-SPECIAL-CALC-CD = 'O'))                           ELC50PD
 14860       OR   ((AH-BENEFIT-FOUND) AND                               ELC50PD
 14861             (NOT NO-AH-COVERAGE)    AND                          ELC50PD
 14862             (WS-AH-SPECIAL-CALC-CD = 'O'))                       ELC50PD
 14863         NEXT SENTENCE                                            ELC50PD
 14864     ELSE                                                         ELC50PD
 14865         GO TO 3215-EDIT-RATES.                                   ELC50PD
 14866                                                                  ELC50PD
 14867     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 14868        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14869           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14870           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14871           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14872                                                                  ELC50PD
 14873     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 14874        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14875           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14876           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14877           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14878                                                                  ELC50PD
 14879     MOVE 'B'                    TO PB-I-OB-FLAG.                 ELC50PD
 14880                                                                  ELC50PD
 14881     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14882         NEXT SENTENCE                                            ELC50PD
 14883     ELSE                                                         ELC50PD
 14884         IF NOT NO-LIFE-COVERAGE                                  ELC50PD
 14885             IF WS-ACCT-LF-OB-RT = ZERO                           ELC50PD
 14886                MOVE ER-2641    TO WS-ERROR                       ELC50PD
 14887                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14888                                                                  ELC50PD
 14889     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14890       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE               ELC50PD
 14891         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14892         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14893         IF WS-ERROR = ER-2675                                    ELC50PD
 14894            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14895            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14896            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14897         ELSE                                                     ELC50PD
 14898            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14899            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 271
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14900                                                                  ELC50PD
 14901                                                                  ELC50PD
 14902     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14903         NEXT SENTENCE                                            ELC50PD
 14904     ELSE                                                         ELC50PD
 14905       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14906            NEXT SENTENCE
 14907       ELSE
 14908         IF NOT NO-AH-COVERAGE                                    ELC50PD
 14909             IF WS-ACCT-AH-OB-RT = ZERO                           ELC50PD
 14910                MOVE ER-2642    TO WS-ERROR                       ELC50PD
 14911                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14912                                                                  ELC50PD
 14913     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14914       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                 ELC50PD
 14915         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC        ELC50PD
 14916         IF WS-ERROR = ER-2676                                    ELC50PD
 14917            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14918            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14919            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14920         ELSE                                                     ELC50PD
 14921            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14922            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14923                                                                  ELC50PD
 14924     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14925         COMPUTE PB-I-LF-PREM-CALC ROUNDED =                      ELC50PD
 14926            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000       ELC50PD
 14927     ELSE                                                         ELC50PD
 14928         IF PB-I-LF-PREM-CALC = ZEROS                             ELC50PD
 14929             COMPUTE PB-I-LF-PREM-CALC ROUNDED =                  ELC50PD
 14930                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.  ELC50PD
 14931                                                                  ELC50PD
 14932     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14933         COMPUTE PB-I-AH-PREM-CALC ROUNDED =                      ELC50PD
 14934            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000       ELC50PD
 14935     ELSE                                                         ELC50PD
 14936         IF PB-I-AH-PREM-CALC = ZEROS                             ELC50PD
 14937             COMPUTE PB-I-AH-PREM-CALC ROUNDED =                  ELC50PD
 14938                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.  ELC50PD
 14939                                                                  ELC50PD
 14940     MOVE ZEROS TO PB-I-MORT-CODE.                                ELC50PD
 14941                                                                  ELC50PD
 14942     GO TO 3260-EDIT-CONTINUE.                                    ELC50PD
 14943                                                                  ELC50PD
 14944                                                                  ELC50PD
 14945 3215-EDIT-RATES.                                                 ELC50PD
 14946     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 14947         NEXT SENTENCE                                            ELC50PD
 14948     ELSE                                                         ELC50PD
 14949         GO TO 3999-END-EDIT.                                     ELC50PD
 14950                                                                  ELC50PD
 14951 3220-CHECK-LF-RATES.                                             ELC50PD
 14952                                                                  ELC50PD
 14953     IF PB-COMPANY-ID = 'DCC'
 14954        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14955        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14956        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14957           AND (NOT WS-LF-CASH))
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 272
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14958                           OR
 14959           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14960           AND (NOT WS-AH-CASH)))
 14961                       AND
 14962           (PB-I-ENTRY-STATUS NOT = '5')
 14963           MOVE 'M'              TO PB-BATCH-ENTRY
 14964                                    PB-I-ENTRY-STATUS
 14965        END-IF
 14966     END-IF
 14967
 14968
 14969
 14970     MOVE ZEROS                  TO PB-I-LF-PREM-CALC             ELC50PD
 14971                                    PB-I-AH-PREM-CALC             ELC50PD
 14972                                    PB-I-LF-ALT-PREM-CALC         ELC50PD
 14973                                    PB-I-LF-ALT-RATE              ELC50PD
 14974                                    PB-I-LF-REI-RATE              ELC50PD
 14975                                    PB-I-LF-ALT-REI-RATE          ELC50PD
 14976                                    PB-I-AH-REI-RATE
 14977                                    PB-I-TOT-FEES-CALC.
 14978                                                                  ELC50PD
 14979     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 14980        NEXT SENTENCE                                             ELC50PD
 14981     ELSE                                                         ELC50PD
 14982        MOVE ZEROS               TO PB-I-LF-RATE                  ELC50PD
 14983                                    PB-I-AH-RATE.                 ELC50PD
 14984                                                                  ELC50PD
 14985     IF PB-I-TOT-FEES NOT NUMERIC
 14986        MOVE ZEROS               TO PB-I-TOT-FEES
 14987     END-IF
 14988
 14989     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 14990         MOVE ZERO               TO PB-I-LIVES.                   ELC50PD
 14991                                                                  ELC50PD
 14992     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 14993         MOVE ZERO               TO PB-I-NUM-BILLED.              ELC50PD
 14994                                                                  ELC50PD
 14995     IF PB-I-LF-PREM-TAX NOT NUMERIC                              ELC50PD
 14996        MOVE +0                  TO PB-I-LF-PREM-TAX              ELC50PD
 14997     END-IF
 14998                                                                  ELC50PD
 14999     IF PB-I-AH-PREM-TAX NOT NUMERIC                              ELC50PD
 15000        MOVE +0                  TO PB-I-AH-PREM-TAX              ELC50PD
 15001     END-IF
 15002                                                                  ELC50PD
 15003     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR                         ELC50PD
 15004        PB-I-PAY-FREQUENCY = ZEROS                                ELC50PD
 15005            MOVE 12 TO CP-PAY-FREQUENCY                           ELC50PD
 15006     ELSE                                                         ELC50PD
 15007            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.          ELC50PD
 15008                                                                  ELC50PD
 15009     IF PB-I-STATE-TAX NOT NUMERIC                                ELC50PD
 15010         MOVE ZEROS               TO PB-I-STATE-TAX.              ELC50PD
 15011                                                                  ELC50PD
 15012     IF PB-I-MUNI-TAX NOT NUMERIC                                 ELC50PD
 15013         MOVE ZEROS               TO PB-I-MUNI-TAX.               ELC50PD
 15014                                                                  ELC50PD
 15015     MOVE SPACES                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 273
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15016     IF PB-COMPANY-ID  = 'CSL'  AND                               ELC50PD
 15017        PB-I-LF-TERM NOT = ZERO                                   ELC50PD
 15018        COMPUTE WS-PAYMENT-AMT =                                  ELC50PD
 15019             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM                   ELC50PD
 15020        COMPUTE WS-CSL-AMT1 =                                     ELC50PD
 15021             PB-I-LF-TERM * AM-MAX-MON-BEN                        ELC50PD
 15022        COMPUTE WS-CSL-AMT2 =                                     ELC50PD
 15023             WS-PAYMENT-AMT * PB-I-LF-TERM                        ELC50PD
 15024        IF CP-PAY-FREQUENCY NOT = 12                              ELC50PD
 15025           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT          ELC50PD
 15026           MOVE '8' TO WS-CSL-CALC-CD                             ELC50PD
 15027        ELSE                                                      ELC50PD
 15028           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND      ELC50PD
 15029              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN    ELC50PD
 15030               AM-MAX-TOT-BEN                                     ELC50PD
 15031               MOVE '6' TO WS-CSL-CALC-CD                         ELC50PD
 15032           ELSE                                                   ELC50PD
 15033              IF (WS-CSL-AMT1  GREATER THAN                       ELC50PD
 15034                 AM-MAX-TOT-BEN) AND                              ELC50PD
 15035                 (WS-CSL-AMT2  GREATER THAN                       ELC50PD
 15036                 AM-MAX-TOT-BEN)                                  ELC50PD
 15037                 MOVE '7' TO WS-CSL-CALC-CD                       ELC50PD
 15038              ELSE                                                ELC50PD
 15039                 MOVE '5' TO WS-CSL-CALC-CD.                      ELC50PD
 15040                                                                  ELC50PD
 15041     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND               ELC50PD
 15042         NEXT SENTENCE                                            ELC50PD
 15043     ELSE                                                         ELC50PD
 15044         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15045                                                                  ELC50PD
 15046*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****        ELC50PD
 15047                                                                  ELC50PD
 15048     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15049        IF (PB-I-LF-CRIT-PER    EQUAL +0)                         ELC50PD
 15050              OR                                                  ELC50PD
 15051           (PB-I-PAYMENT-AMOUNT EQUAL +0)                         ELC50PD
 15052           MOVE ER-2618          TO WS-ERROR                      ELC50PD
 15053           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15054           GO TO 3300-CHECK-AH-RATES.                             ELC50PD
 15055                                                                  ELC50PD
 15056     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15057           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL                   ELC50PD
 15058                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.        ELC50PD
 15059                                                                  ELC50PD
 15060     IF WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15061         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15062         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15063         MOVE 'Z000'              TO PB-I-MORT-CODE               ELC50PD
 15064         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC            ELC50PD
 15065         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15066                                                                  ELC50PD
 15067     IF WS-LF-SPECIAL-CALC-CD = 'Z'                               ELC50PD
 15068        IF PB-I-LIVES = ZERO                                      ELC50PD
 15069           MOVE ER-2688          TO WS-ERROR                      ELC50PD
 15070           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 15071                                                                  ELC50PD
 15072     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15073                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 274
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15074     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15075     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 15076     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 15077     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 15078     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15079     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15080     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 15081     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15082     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15083     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 15084                                                                  ELC50PD
 15085******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15086     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15087         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15088            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15089             IF PB-CERT-EFF-DT GREATER  WS-931231                 ELC50PD
 15090                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15091*******                                                           ELC50PD
 15092                                                                  ELC50PD
 15093     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15094     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15095     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 15096     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 15097     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15098     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15099                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15100     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15101         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15102                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15103     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 15104     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 15105     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 15106     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15107     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15108     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15109     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15110     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 15111     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15112                                    CP-REMAINING-TERM             ELC50PD
 15113                                    CP-LOAN-TERM.                 ELC50PD
 15114                                                                  ELC50PD
 15115     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
 15116         NEXT SENTENCE                                            ELC50PD
 15117     ELSE                                                         ELC50PD
 15118         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 15119             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15120                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 15121                                                                  ELC50PD
 15122     IF PB-COMPANY-ID EQUAL 'CSL'                                 ELC50PD
 15123        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD) ELC50PD
 15124           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -    ELC50PD
 15125                                         PB-I-LF-PREMIUM-AMT.     ELC50PD
 15126                                                                  ELC50PD
 15127     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15128         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15129            CP-EARN-AS-NET-PAY                                    ELC50PD
 15130             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15131                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 275
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15132                                                                  ELC50PD
 15133     IF (CP-TRUNCATED-LIFE)                                       ELC50PD
 15134        or ((pb-company-id = 'AHL')
 15135           and (pb-i-loan-term > pb-i-lf-term))
 15136        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 15137                                                                  ELC50PD
 15138     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15139        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15140                                                                  ELC50PD
 15141     IF CP-TERM-IS-DAYS                                           ELC50PD
 15142         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 15143     ELSE                                                         ELC50PD
 15144         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15145
 15146     IF PB-COMPANY-ID = 'DCC'
 15147        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15148        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15149        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15150        IF WS-LF-BEN-CATEGORY = 'D'
 15151           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 15152           MOVE PB-I-LIFE-COMMISSION
 15153                                 TO CP-DCC-ACT-COMM
 15154           MOVE WS-LF-BEN-CATEGORY
 15155                                 TO CP-BEN-CATEGORY
 15156        END-IF
 15157        IF (CP-BENEFIT-CD (1:1) = 'P')
 15158           AND (PB-I-LOAN-TERM NOT = ZEROS)
 15159           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 15160           add pb-i-ah-premium-amt to cp-original-premium
 15161        END-IF
 15162     END-IF
 15163
 15164     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15165         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT       ELC50PD
 15166         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15167         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.        ELC50PD
 15168                                                                  ELC50PD
 15169     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15170        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.           ELC50PD
 15171                                                                  ELC50PD
 15172     IF (CP-SPECIAL-CALC-CD = 'H')
 15173        OR (PB-COMPANY-ID = 'DCC')
 15174         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 15175                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 15176         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 15177                                                                  ELC50PD
 15178
 15179     IF (PB-COMPANY-ID = 'CID')
 15180        AND (WS-LF-EARNINGS-CALC = 'B')
 15181        AND (CP-STATE-STD-ABBRV = 'MN')
 15182        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15183                                 TO CP-ALTERNATE-BENEFIT
 15184        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 15185     END-IF
 15186
 15187     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 15188     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15189     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 276
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15190                                                                  ELC50PD
 15191     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15192        MOVE ER-2641            TO WS-ERROR                       ELC50PD
 15193        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 15194        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15195                                                                  ELC50PD
 15196     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15197        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15198           IF NOT ACCOUNT-LIFE-CHECKED                            ELC50PD
 15199              MOVE ER-2607      TO WS-ERROR                       ELC50PD
 15200              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 15201                                                                  ELC50PD
 15202
 15203******************************************************************ELC50PD
 15204*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *ELC50PD
 15205*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15206******************************************************************ELC50PD
 15207                                                                  ELC50PD
 15208* CALC LIFE AGE AT EXPIRATION.                                    00031342
 15209                                                                  00031343
 15210     COMPUTE WS-AGE-AT-EXPIRE =                                   00031344
 15211          ((PB-I-LF-TERM / 12) + PB-I-AGE).                       00031345
 15212                                                                  00031346
 15213*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15214*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15215*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15216*        MOVE ER-2709        TO WS-ERROR                          00031349
 15217*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15218*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15219                                                                  00031352
 15220*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031347
 15221*        MOVE 'X'            TO PB-FATAL-FLAG                     00031348
 15222*        MOVE ER-2718        TO WS-ERROR                          00031349
 15223*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15224*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15225                                                                  00031352
 15226* CALC A & H AGE AT EXPIRATION.                                   00031353
 15227                                                                  00031354
 15228     COMPUTE WS-AGE-AT-EXPIRE =                                   00031355
 15229          ((PB-I-AH-TERM / 12) + PB-I-AGE).                       00031356
 15230                                                                  00031357
 15231*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15232*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15233*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15234*        MOVE ER-2709        TO WS-ERROR                          00031349
 15235*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15236*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15237                                                                  00031352
 15238*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031358
 15239*        MOVE 'X'            TO PB-FATAL-FLAG                     00031359
 15240*        MOVE ER-2718        TO WS-ERROR                          00031360
 15241*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031361
 15242*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031362
 15243
 15244     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED              ELC50PD
 15245        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15246                                                                  ELC50PD
 15247     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 277
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15248        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15249                                                                  ELC50PD
 15250     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15251        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15252                                                                  ELC50PD
 15253     IF CP-ERROR-AMT-OUTSIDE-LIMIT                                ELC50PD
 15254         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS             ELC50PD
 15255         MOVE ER-2639        TO WS-ERROR                          ELC50PD
 15256         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15257                                                                  ELC50PD
 15258                                                                  00031363
 15259******************************************************************ELC50PD
 15260*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15261******************************************************************ELC50PD
 15262                                                                  ELC50PD
 15263 PREMIUM-EDITING-IS-BYPASSED.
 15264
 15265     IF (CP-R-MAX-ATT-AGE NUMERIC)
 15266        AND (CP-R-MAX-ATT-AGE > +0)
 15267        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 15268        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15269           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 15270           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15271           MOVE '1'              TO DC-OPTION-CODE
 15272           PERFORM 8500-DATE-CONVERT
 15273                                 THRU 8500-EXIT
 15274           IF NO-CONVERSION-ERROR
 15275              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15276                 MOVE ER-2661       TO WS-ERROR
 15277*                PERFORM 9900-ERROR-FORMAT
 15278*                                THRU 9900-EXIT
 15279              END-IF
 15280           END-IF
 15281        ELSE
 15282           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 15283           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15284              MOVE ER-2661       TO WS-ERROR
 15285*             PERFORM 9900-ERROR-FORMAT
 15286*                                THRU 9900-EXIT
 15287           ELSE
 15288              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15289                 MOVE ER-1570    TO WS-ERROR
 15290                 PERFORM 9900-ERROR-FORMAT
 15291                                 THRU 9900-EXIT
 15292              END-IF
 15293           END-IF
 15294        END-IF
 15295
 15296        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15297           MOVE PB-I-JOINT-BIRTHDAY
 15298                                 TO DC-BIN-DATE-1
 15299           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15300           MOVE '1'              TO DC-OPTION-CODE
 15301           PERFORM 8500-DATE-CONVERT
 15302                                 THRU 8500-EXIT
 15303           IF NO-CONVERSION-ERROR
 15304              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15305                 MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 278
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15306*                PERFORM 9900-ERROR-FORMAT
 15307*                                THRU 9900-EXIT
 15308              END-IF
 15309           ELSE
 15310              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 15311           END-IF
 15312        ELSE
 15313           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 15314             (PB-I-LF-TERM / 12)
 15315           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15316              MOVE ER-2661       TO WS-ERROR
 15317*             PERFORM 9900-ERROR-FORMAT
 15318*                                THRU 9900-EXIT
 15319           ELSE
 15320              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15321                 MOVE ER-1571    TO WS-ERROR
 15322                 PERFORM 9900-ERROR-FORMAT
 15323                                 THRU 9900-EXIT
 15324              END-IF
 15325           END-IF
 15326        END-IF
 15327        IF WS-ERROR = ER-2661
 15328           PERFORM 9900-ERROR-FORMAT
 15329                                 THRU 9900-EXIT
 15330        END-IF
 15331     END-IF
 15332
 15333*    IF CP-ERROR-ATT-OUTSIDE-LIMIT                                ELC50PD
 15334*       MOVE ER-2661             TO WS-ERROR                      ELC50PD
 15335*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15336                                                                  ELC50PD
 15337     IF CP-ERROR-AGE-OUTSIDE-LIMIT                                ELC50PD
 15338        MOVE ER-2662             TO WS-ERROR                      ELC50PD
 15339        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15340                                                                  ELC50PD
 15341     IF CP-ERROR-TERM-OUTSIDE-LIMIT                               ELC50PD
 15342        MOVE ER-2677             TO WS-ERROR                      ELC50PD
 15343        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15344                                                                  ELC50PD
 15345     IF CP-ERROR-LOAN-TERM                                        ELC50PD
 15346        MOVE ER-2648             TO WS-ERROR                      ELC50PD
 15347        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15348                                                                  ELC50PD
 15349 3221-CHECK-ERROR-RATE-OPEN.                                      ELC50PD
 15350                                                                  ELC50PD
 15351     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 15352         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 15353                                                                  ELC50PD
 15354     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 15355        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE                ELC50PD
 15356     END-IF
 15357
 15358     .
 15359 3221-CONTINUE.                                                   ELC50PD
 15360     MOVE ZEROS                  TO WS-DCC-LF-RATE
 15361                                    WS-DCC-AH-RATE
 15362
 15363     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 279
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15364        IF WS-LF-BEN-CATEGORY = 'D'
 15365           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 15366              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 15367        END-IF
 15368     END-IF
 15369
 15370     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.            ELC50PD
 15371
 15372*   X'A4FF' = 12/31/2009
 15373     IF (PB-COMPANY-ID = 'CID')
 15374        AND (WS-LF-EARNINGS-CALC = 'B')
 15375        AND (CP-STATE-STD-ABBRV = 'MN')
 15376        AND (PB-CERT-EFF-DT > X'A4FF')
 15377        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 15378     END-IF
 15379
 15380     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.           ELC50PD
 15381                                                                  ELC50PD
 15382     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.                ELC50PD
 15383     IF (PB-COMPANY-ID = 'DCC')
 15384        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15385        AND (PB-I-POLICY-IS-MONTHLY)
 15386        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 15387        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 15388     END-IF
 15389     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.         ELC50PD
 15390     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.             ELC50PD
 15391     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.            ELC50PD
 15392     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15393
 15394     IF (PB-COMPANY-ID = 'DCC')
 15395        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 15396        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 15397        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 15398        MOVE ER-2786             TO WS-ERROR
 15399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15400     END-IF
 15401                                                                  ELC50PD
 15402     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.               ELC50PD
 15403                                                                  ELC50PD
 15404******************************************************************ELC50PD
 15405*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15406******************************************************************ELC50PD
 15407     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15408        GO TO 3225-CHECK-ALT-LIFE-RATE.                           ELC50PD
 15409                                                                  ELC50PD
 15410     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15411        GO TO 3225-CHECK-ALT-LIFE-RATE                            ELC50PD
 15412     ELSE                                                         ELC50PD
 15413       IF PB-I-LF-RATE = ZERO                                     ELC50PD
 15414          MOVE ER-2641          TO WS-ERROR                       ELC50PD
 15415          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15416                                                                  ELC50PD
 15417 3225-CHECK-ALT-LIFE-RATE.                                        ELC50PD
 15418                                                                  ELC50PD
 15419     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15420        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15421        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 280
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15422         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.                     ELC50PD
 15423                                                                  ELC50PD
 15424     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 15425         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 15426             AND PB-COMPANY-ID NOT = 'DCC')
 15427                   OR
 15428
 15429              (PB-I-LF-ALT-PREMIUM-AMT > +0
 15430              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 15431              AND PB-COMPANY-ID NOT = 'DCC')
 15432             MOVE ER-2720        TO  WS-ERROR                     ELC50PD
 15433             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 15434             GO TO 3225-RATING-CONT                               ELC50PD
 15435         ELSE                                                     ELC50PD
 15436             GO TO 3225-RATING-CONT.                              ELC50PD
 15437
 15438     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 15439        AND (AM-GPCD = 01 OR 06 OR 15)
 15440        MOVE ER-2798             TO WS-ERROR
 15441        PERFORM 9900-ERROR-FORMAT
 15442                                 THRU 9900-EXIT
 15443*       GO TO 3225-RATING-CONT
 15444     END-IF
 15445
 15446     IF (PB-COMPANY-ID = 'CID')
 15447        AND (WS-LF-EARNINGS-CALC = 'B')
 15448        AND (CP-STATE-STD-ABBRV = 'MN')
 15449        AND (PB-CERT-EFF-DT > X'A4FF')
 15450        GO TO 3225-RATING-CONT
 15451     END-IF
 15452
 15453     IF PB-COMPANY-ID = 'DCC'
 15454        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15455           AND (PB-I-POLICY-IS-MONTHLY)
 15456           GO TO 3225-RATING-CONT
 15457        END-IF
 15458     END-IF
 15459
 15460     IF PB-COMPANY-ID EQUAL 'WDS' AND                             ELC50PD
 15461        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND            ELC50PD
 15462        CP-EARN-AS-REG-BALLOON                                    ELC50PD
 15463        NEXT SENTENCE                                             ELC50PD
 15464     ELSE                                                         ELC50PD
 15465        MOVE '2'                 TO CP-EARNING-METHOD.            ELC50PD
 15466                                                                  ELC50PD
 15467 3225-SET-ALT-LIFE-RATE-LOOKUP.                                   ELC50PD
 15468                                                                  ELC50PD
 15469     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15470                                                                  ELC50PD
 15471     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15472        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15473        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15474         NEXT SENTENCE                                            ELC50PD
 15475     ELSE                                                         ELC50PD
 15476         MOVE SPACE              TO CP-SPECIAL-CALC-CD.           ELC50PD
 15477                                                                  ELC50PD
 15478     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15479     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 281
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15480     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15481                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15482     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15483         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15484                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15485
 15486     IF PB-COMPANY-ID = 'DCC'
 15487        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15488     END-IF
 15489
 15490     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15491     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15492     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15493                                    CP-REMAINING-TERM             ELC50PD
 15494                                    CP-LOAN-TERM.                 ELC50PD
 15495     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15496        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15497                                    CP-REMAINING-TERM             ELC50PD
 15498                                    CP-LOAN-TERM.                 ELC50PD
 15499                                                                  ELC50PD
 15500     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15501     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15502                                                                  ELC50PD
 15503     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15504         MOVE ER-2641            TO WS-ERROR                      ELC50PD
 15505         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15506         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15507                                                                  ELC50PD
 15508     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.             ELC50PD
 15509     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.        ELC50PD
 15510                                                                  ELC50PD
 15511     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN      ELC50PD
 15512         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15513                                                                  ELC50PD
 15514     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 15515                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 15516                                                                  ELC50PD
 15517     IF ACCOUNT-LIFE-CHECKED  OR                                  ELC50PD
 15518        PB-POLICY-IS-VOIDED   OR                                  ELC50PD
 15519        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')                    ELC50PD
 15520        GO TO 3225-CONTINUE.                                      ELC50PD
 15521                                                                  ELC50PD
 15522     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15523        GO TO 3225-CONTINUE.                                      ELC50PD
 15524                                                                  ELC50PD
 15525     IF WS-LF-BENEFIT-AMT  GREATER THAN                           ELC50PD
 15526                             EC-RT-LF-MAX-TOT-BEN                 ELC50PD
 15527        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS               ELC50PD
 15528        MOVE ER-2639       TO WS-ERROR                            ELC50PD
 15529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15530                                                                  ELC50PD
 15531 3225-CONTINUE.                                                   ELC50PD
 15532     IF PB-I-LF-ALT-RATE = ZERO                                   ELC50PD
 15533         MOVE ER-2659            TO WS-ERROR                      ELC50PD
 15534         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15535                                                                  ELC50PD
 15536     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR                         ELC50PD
 15537        PB-I-LF-ALT-PREMIUM-AMT = ZERO                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 282
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15538        MOVE ER-2698             TO WS-ERROR                      ELC50PD
 15539        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15540                                                                  ELC50PD
 15541 3225-RATING-CONT.                                                ELC50PD
 15542                                                                  ELC50PD
 15543     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15544         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15545         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15546         IF (PB-COMPANY-ID = 'DCC')
 15547            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15548            CONTINUE
 15549         ELSE
 15550            MOVE ER-2687         TO WS-ERROR
 15551            PERFORM 9900-ERROR-FORMAT
 15552                                 THRU 9900-EXIT
 15553         END-IF
 15554         GO TO 3290-EDIT-LF-REIN-RATE
 15555     END-IF
 15556                                                                  ELC50PD
 15557* DMD RATING TEST                                                 ELC50PD
 15558     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15559         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15560         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15561         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 15562         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15563         GO TO 3290-EDIT-LF-REIN-RATE.                            ELC50PD
 15564                                                                  ELC50PD
 15565 3230-CLIENT-MORT-CD-SPECIALS.                                    ELC50PD
 15566                                                                  ELC50PD
 15567     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.                   ELC50PD
 15568     SET BIN-TO-GREG          TO TRUE.                            ELC50PD
 15569*    MOVE ' '                 TO DC-OPTION-CODE.                  ELC50PD
 15570     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15571     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.                    ELC50PD
 15572                                                                  ELC50PD
 15573 C-POS-3230-MORT-CD.                                              ELC50PD
 15574     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15575        PB-SV-CARRIER = '2'                                       ELC50PD
 15576         NEXT SENTENCE                                            ELC50PD
 15577     ELSE                                                         ELC50PD
 15578         GO TO C-POS-3240-MORT-CD.                                ELC50PD
 15579                                                                  ELC50PD
 15580     IF PB-SV-GROUPING = '030'                                    ELC50PD
 15581        AND PB-CERT-EFF-DT GREATER THAN WS-791231                 ELC50PD
 15582         MOVE '2350' TO PB-I-MORT-CODE                            ELC50PD
 15583      ELSE                                                        ELC50PD
 15584         MOVE '3300' TO PB-I-MORT-CODE.                           ELC50PD
 15585                                                                  ELC50PD
 15586                                                                  ELC50PD
 15587 C-POS-3240-MORT-CD.                                              ELC50PD
 15588     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15589        PB-SV-CARRIER = '1'                                       ELC50PD
 15590         NEXT SENTENCE                                            ELC50PD
 15591     ELSE                                                         ELC50PD
 15592         GO TO 3230-CONTINUE.                                     ELC50PD
 15593                                                                  ELC50PD
 15594     IF PB-SV-STATE = '45' OR '47'                                ELC50PD
 15595        OR PB-CERT-EFF-DT LESS THAN WS-771001                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 283
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15596         MOVE '5200' TO PB-I-MORT-CODE                            ELC50PD
 15597     ELSE                                                         ELC50PD
 15598         MOVE '8300' TO PB-I-MORT-CODE.                           ELC50PD
 15599                                                                  ELC50PD
 15600 3230-CONTINUE.                                                   ELC50PD
 15601
 15602     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'                       00033064
 15603        GO TO 3240-CONTINUE                                       00033065
 15604     END-IF
 15605
 15606     IF PB-CERT-EFF-DT > WS-971231
 15607        GO TO 3240-CONTINUE                                       00033065
 15608     END-IF
 15609
 15610     IF LF-BENEFIT-FOUND AND                                      00033066
 15611        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'                     00033067
 15612         MOVE 'F250'       TO PB-I-MORT-CODE                      00033068
 15613     ELSE                                                         00033069
 15614         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'                      00033070
 15615             MOVE '7250'   TO PB-I-MORT-CODE                      00033071
 15616         ELSE                                                     00033072
 15617             MOVE '4251'   TO PB-I-MORT-CODE                      00033073
 15618         END-IF
 15619     END-IF
 15620                                                                  00033074
 15621     .
 15622 3240-CONTINUE.                                                   ELC50PD
 15623
 15624     IF PB-COMPANY-ID NOT = 'GNL'                                 ELC50PD
 15625         GO TO 3256-CONTINUE.                                     ELC50PD
 15626                                                                  ELC50PD
 15627     IF PB-CERT-EFF-DT  LESS THAN WS-820301                       ELC50PD
 15628         MOVE 'A300' TO PB-I-MORT-CODE                            ELC50PD
 15629     ELSE                                                         ELC50PD
 15630         MOVE '8350' TO PB-I-MORT-CODE.                           ELC50PD
 15631                                                                  ELC50PD
 15632 3256-CONTINUE.                                                   ELC50PD
 15633     IF PB-COMPANY-ID NOT = 'ABL'                                 ELC50PD
 15634         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 15635                                                                  ELC50PD
 15636     IF PB-I-LF-TERM GREATER THAN 59                              ELC50PD
 15637         MOVE 'F550' TO PB-I-MORT-CODE                            ELC50PD
 15638     ELSE                                                         ELC50PD
 15639         MOVE 'E550' TO PB-I-MORT-CODE.                           ELC50PD
 15640                                                                  ELC50PD
 15641 3260-EDIT-CONTINUE.                                              ELC50PD
 15642     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.                       ELC50PD
 15643                                                                  ELC50PD
 15644 3290-EDIT-LF-REIN-RATE.                                          ELC50PD
 15645     IF LF-REIN-NSP-NOT-USED                                      ELC50PD
 15646         GO TO 3290-RATING-CONT.                                  ELC50PD
 15647                                                                  ELC50PD
 15648     IF PB-COMPANY-ID = 'DCC'
 15649        GO TO 3290-RATING-CONT.
 15650
 15651     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.         ELC50PD
 15652     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 15653     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 284
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15654     MOVE '3'                   TO CP-PROCESS-TYPE.               ELC50PD
 15655     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 15656                                                                  ELC50PD
 15657******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15658     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15659         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15660            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15661             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1                 ELC50PD
 15662*            MOVE SPACE          TO DC-OPTION-CODE                ELC50PD
 15663             SET BIN-TO-GREG     TO TRUE                          ELC50PD
 15664             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT             ELC50PD
 15665***  Y2K PROJ 7744                                                   CL*11
 15666             IF DC-GREG-DATE-CYMD GREATER 19931231                   CL*10
 15667                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15668***  Y2K PROJ 7744                                                   CL*11
 15669*******                                                           ELC50PD
 15670                                                                  ELC50PD
 15671     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 15672     MOVE PB-SV-STATE           TO CP-STATE.                      ELC50PD
 15673     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.                 ELC50PD
 15674     MOVE ZERO                  TO CP-DEVIATION-CODE              ELC50PD
 15675                                   CP-RATE-DEV-PCT.               ELC50PD
 15676     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                 ELC50PD
 15677     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT            ELC50PD
 15678                                   CP-RATING-BENEFIT-AMT.         ELC50PD
 15679                                                                  ELC50PD
 15680************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA     ELC50PD
 15681     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15682         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15683            CP-EARN-AS-NET-PAY                                    ELC50PD
 15684             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15685                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15686************                                                      ELC50PD
 15687                                                                  ELC50PD
 15688     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15689         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15690                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15691     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.           ELC50PD
 15692     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.                  ELC50PD
 15693     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.                ELC50PD
 15694     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.                 ELC50PD
 15695     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.                 ELC50PD
 15696     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.                   ELC50PD
 15697     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.            ELC50PD
 15698     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM               ELC50PD
 15699                                   CP-REMAINING-TERM              ELC50PD
 15700                                   CP-LOAN-TERM.                  ELC50PD
 15701     IF CP-TRUNCATED-LIFE                                         ELC50PD
 15702        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.                  ELC50PD
 15703                                                                  ELC50PD
 15704     IF CP-TERM-IS-DAYS                                           ELC50PD
 15705         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS         ELC50PD
 15706     ELSE                                                         ELC50PD
 15707         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15708                                                                  ELC50PD
 15709
 15710     IF PB-COMPANY-ID = 'DCC'
 15711        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 285
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15712     END-IF
 15713
 15714     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 15715          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 15716                                                                  ELC50PD
 15717     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.                         ELC50PD
 15718                                                                  ELC50PD
 15719     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15720     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15721                                                                  ELC50PD
 15722     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15723        IF PB-I-OB                                                ELC50PD
 15724           MOVE ER-2625      TO WS-ERROR                          ELC50PD
 15725           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15726           GO TO 3299-EDIT-CONTINUE                               ELC50PD
 15727        ELSE                                                      ELC50PD
 15728           MOVE ER-2643      TO WS-ERROR                          ELC50PD
 15729           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15730           GO TO 3299-EDIT-CONTINUE.                              ELC50PD
 15731                                                                  ELC50PD
 15732     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.                 ELC50PD
 15733                                                                  ELC50PD
 15734     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.                ELC50PD
 15735     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.                  ELC50PD
 15736                                                                  ELC50PD
 15737     IF PB-I-LF-REI-RATE = ZERO                                   ELC50PD
 15738         MOVE ER-2643        TO WS-ERROR                          ELC50PD
 15739         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15740                                                                  ELC50PD
 15741 3290-CHECK-ALT-REIN-RATE.                                        ELC50PD
 15742                                                                  ELC50PD
 15743     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 15744        GO TO 3290-RATING-CONT.                                   ELC50PD
 15745                                                                  ELC50PD
 15746     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15747     MOVE '2'                    TO CP-EARNING-METHOD.            ELC50PD
 15748     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15749     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15750     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15751     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15752                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15753     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15754         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15755                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15756
 15757     IF PB-COMPANY-ID = 'DCC'
 15758        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15759     END-IF
 15760
 15761     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15762     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15763     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15764                                    CP-REMAINING-TERM             ELC50PD
 15765                                    CP-LOAN-TERM.                 ELC50PD
 15766     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15767        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15768                                    CP-REMAINING-TERM             ELC50PD
 15769                                    CP-LOAN-TERM.                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 286
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15770                                                                  ELC50PD
 15771     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15772     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15773                                                                  ELC50PD
 15774     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.         ELC50PD
 15775                                                                  ELC50PD
 15776     IF PB-I-LF-ALT-REI-RATE = ZERO                               ELC50PD
 15777         MOVE ER-2643            TO WS-ERROR                      ELC50PD
 15778         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15779                                                                  ELC50PD
 15780 3290-RATING-CONT.                                                ELC50PD
 15781                                                                  ELC50PD
 15782     IF PB-I-OB                                                   ELC50PD
 15783*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15784        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15785                                                                  ELC50PD
 15786 3299-EDIT-CONTINUE.                                              ELC50PD
 15787                                                                  ELC50PD
 15788     IF  PB-I-MORT-CODE GREATER THAN SPACES                       ELC50PD
 15789         NEXT SENTENCE                                            ELC50PD
 15790     ELSE                                                         ELC50PD
 15791         MOVE ER-2620           TO WS-ERROR                       ELC50PD
 15792         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15793                                                                  ELC50PD
 15794 3300-CHECK-AH-RATES.                                             ELC50PD
 15795     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND                 ELC50PD
 15796         NEXT SENTENCE                                            ELC50PD
 15797     ELSE                                                         ELC50PD
 15798         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 15799                                                                  ELC50PD
 15800     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR                        ELC50PD
 15801        ((CF-COMPANY-ID = 'DMD') AND                              ELC50PD
 15802                (NO-DMD-RATING))                                  ELC50PD
 15803         IF (PB-COMPANY-ID = 'DCC')
 15804            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15805            CONTINUE
 15806         ELSE
 15807            MOVE ER-2687         TO WS-ERROR
 15808            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15809         END-IF
 15810         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 15811         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 15812     END-IF
 15813                                                                  ELC50PD
 15814     IF PB-I-OB                                                   ELC50PD
 15815        GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15816                                                                  ELC50PD
 15817     IF WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15818         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15819         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15820         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC            ELC50PD
 15821         GO TO 3999-END-EDIT.                                     ELC50PD
 15822                                                                  ELC50PD
 15823*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****        ELC50PD
 15824                                                                  ELC50PD
 15825     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15826        IF PB-I-AH-CRIT-PER = ZERO
 15827           IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 287
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15828              AND AM-DCC-PRODUCT-CODE = 'DDF'
 15829              CONTINUE
 15830           ELSE
 15831              MOVE ER-2618       TO WS-ERROR
 15832              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15833              GO TO 3999-END-EDIT
 15834           END-IF
 15835        END-IF
 15836     END-IF
 15837
 15838     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15839     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15840     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15841     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15842     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15843     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15844     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15845     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.            ELC50PD
 15846     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.              ELC50PD
 15847*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15848     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 15849     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15850     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15851     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15852                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15853     IF PB-COMPANY-ID = 'CID'
 15854               OR
 15855        CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15856         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 15857                                         PB-I-AH-TERM.            ELC50PD
 15858     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 15859        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 15860           AND (PB-I-POLICY-IS-MONTHLY)
 15861           MOVE PB-I-LF-BENEFIT-AMT
 15862                                 TO CP-NET-BENEFIT-AMT
 15863           move pb-i-ah-premium-amt to cp-original-premium
 15864           add pb-i-lf-premium-amt to cp-original-premium
 15865        END-IF
 15866     END-IF
 15867
 15868     MOVE SPACES                 TO CP-BEN-CATEGORY
 15869
 15870     IF PB-COMPANY-ID = 'DCC'
 15871        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 15872        EVALUATE TRUE
 15873           WHEN (WS-AH-BEN-CATEGORY = 'G')
 15874              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15875              MOVE PB-I-LF-BENEFIT-AMT
 15876                                 TO CP-RATING-BENEFIT-AMT
 15877              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 15878           WHEN WS-AH-BEN-CATEGORY = 'G'
 15879              MOVE PB-I-UNPAID-CASH-PRICE
 15880                                 TO CP-RATING-BENEFIT-AMT
 15881           WHEN WS-AH-BEN-CATEGORY = 'D'
 15882              MOVE WS-AH-PMF-COMM
 15883                                 TO CP-DCC-PMF-COMM
 15884              MOVE PB-I-AH-COMMISSION
 15885                                 TO CP-DCC-ACT-COMM
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 288
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15886        END-EVALUATE
 15887     END-IF
 15888
 15889     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 15890     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15891     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15892     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15893     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15894     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.           ELC50PD
 15895     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15896                                    CP-REMAINING-TERM             ELC50PD
 15897                                    WS-WORK-TERM.                 ELC50PD
 15898     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.          ELC50PD
 15899                                                                  ELC50PD
 15900     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 15901     SET BIN-TO-GREG             TO TRUE.                         ELC50PD
 15902*    MOVE ' '                    TO DC-OPTION-CODE.               ELC50PD
 15903     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15904     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.                 ELC50PD
 15905                                                                  ELC50PD
 15906     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.           ELC50PD
 15907     IF NOT VALID-SKIP-CODE                                       ELC50PD
 15908         MOVE ER-2683            TO WS-ERROR                      ELC50PD
 15909         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15910         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15911                                                                  ELC50PD
 15912     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 15913         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15914                                                                  ELC50PD
 15915     MOVE SPACE TO NUMBER-OF-MONTHS.                              ELC50PD
 15916                                                                  ELC50PD
 15917     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'                        ELC50PD
 15918         MOVE 'S'                TO SK-MO (6).                    ELC50PD
 15919     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'          ELC50PD
 15920         MOVE 'S'                TO SK-MO (7).                    ELC50PD
 15921     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'   ELC50PD
 15922         MOVE 'S'                TO SK-MO (8).                    ELC50PD
 15923     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'                 ELC50PD
 15924         MOVE 'S'                TO SK-MO (9).                    ELC50PD
 15925     IF PB-I-SKIP-CODE = 'A'                                      ELC50PD
 15926         MOVE 'S'                TO SK-MO (10).                   ELC50PD
 15927                                                                  ELC50PD
 15928     MOVE 1                      TO SUB2.                         ELC50PD
 15929     MOVE PB-I-AH-TERM           TO SUB3.                         ELC50PD
 15930     MOVE WS-MONTH               TO SUB1.                         ELC50PD
 15931     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.       ELC50PD
 15932     GO TO 3320-RATE-CONTINUE.                                    ELC50PD
 15933                                                                  ELC50PD
 15934 3310-GET-SKIP-MO.                                                ELC50PD
 15935     IF SUB1 = 13                                                 ELC50PD
 15936         MOVE 1                  TO SUB1.                         ELC50PD
 15937                                                                  ELC50PD
 15938     IF SK-MO (SUB1) = 'S'                                        ELC50PD
 15939         SUBTRACT 1 FROM WS-WORK-TERM.                            ELC50PD
 15940                                                                  ELC50PD
 15941     ADD 1 TO SUB2                                                ELC50PD
 15942              SUB1.                                               ELC50PD
 15943                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 289
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15944 3320-RATE-CONTINUE.                                              ELC50PD
 15945                                                                  ELC50PD
 15946     IF WS-WORK-TERM = ZERO                                       ELC50PD
 15947         MOVE 1                  TO WS-WORK-TERM.                 ELC50PD
 15948                                                                  ELC50PD
 15949     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM              ELC50PD
 15950                                    CP-LOAN-TERM.                 ELC50PD
 15951                                                                  ELC50PD
 15952     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15953         NEXT SENTENCE                                            ELC50PD
 15954     ELSE                                                         ELC50PD
 15955         MOVE ZERO               TO PB-I-AH-RATE                  ELC50PD
 15956                                    PB-I-AH-REI-RATE.             ELC50PD
 15957                                                                  ELC50PD
 15958                                                                  ELC50PD
 15959     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15960        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15961                                                                  ELC50PD
 15962     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15963         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN              ELC50PD
 15964         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN              ELC50PD
 15965         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15966         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.               ELC50PD
 15967                                                                  ELC50PD
 15968     IF PB-COMPANY-ID = 'DCC'
 15969        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15970           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15971              PB-I-RATE-DEV-PCT-LF
 15972        END-IF
 15973        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15974                                 TO CP-ALTERNATE-BENEFIT
 15975        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15976        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15977        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15978     END-IF
 15979
 15980     IF (PB-COMPANY-ID = 'CID')
 15981        AND (WS-LF-EARNINGS-CALC = 'B')
 15982        AND (CP-STATE-STD-ABBRV = 'MN')
 15983        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 15984     ELSE
 15985        MOVE ' '                 TO CP-AH-BALLOON-SW
 15986     END-IF
 15987
 15988     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 15989     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15990     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15991                                                                  ELC50PD
 15992     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15993        IF PB-I-OB                                                ELC50PD
 15994           MOVE ER-2624          TO WS-ERROR                      ELC50PD
 15995           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15996           GO TO 3340-CALCULATE-PREMIUM-AMT                       ELC50PD
 15997        ELSE                                                      ELC50PD
 15998          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 15999              NEXT SENTENCE
 16000          ELSE
 16001           MOVE ER-2642          TO WS-ERROR                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 290
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16002           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 16003           GO TO 3340-CALCULATE-PREMIUM-AMT.                      ELC50PD
 16004                                                                  ELC50PD
 16005     IF PB-COMPANY-ID EQUAL 'CSL' AND                             ELC50PD
 16006        CP-ERROR-DIV-BY-ZERO                                      ELC50PD
 16007           MOVE ER-3782          TO WS-ERROR                      ELC50PD
 16008           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16009                                                                  ELC50PD
 16010     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 16011        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 16012           IF NOT ACCOUNT-AH-CHECKED                              ELC50PD
 16013              MOVE ER-2607          TO WS-ERROR                   ELC50PD
 16014              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 16015                                                                  ELC50PD
 16016     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16017        NEXT SENTENCE                                             ELC50PD
 16018     ELSE                                                         ELC50PD
 16019       IF CP-ERROR-AMT-OUTSIDE-LIMIT                              ELC50PD
 16020          MOVE ER-2640           TO WS-ERROR                      ELC50PD
 16021          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 16022                                                                  ELC50PD
 16023     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16024         IF WS-ERROR = ER-2640                                    ELC50PD
 16025             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16026
 16027     IF ACCOUNT-AH-CHECKED
 16028        CONTINUE
 16029     ELSE
 16030        IF (CP-R-MAX-ATT-AGE NUMERIC)
 16031           AND (CP-R-MAX-ATT-AGE > +0)
 16032           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 16033           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 16034              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 16035              MOVE PB-I-AH-EXPIRE-DT
 16036                                 TO DC-BIN-DATE-2
 16037              MOVE '1'           TO DC-OPTION-CODE
 16038              PERFORM 8500-DATE-CONVERT
 16039                                 THRU 8500-EXIT
 16040              IF NO-CONVERSION-ERROR
 16041                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16042                    MOVE ER-2661       TO WS-ERROR
 16043*                   PERFORM 9900-ERROR-FORMAT
 16044*                                THRU 9900-EXIT
 16045                 END-IF
 16046              END-IF
 16047           ELSE
 16048              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 16049              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16050                 MOVE ER-2661    TO WS-ERROR
 16051*                PERFORM 9900-ERROR-FORMAT
 16052*                                THRU 9900-EXIT
 16053              ELSE
 16054                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16055                    MOVE ER-1570 TO WS-ERROR
 16056                    PERFORM 9900-ERROR-FORMAT
 16057                                 THRU 9900-EXIT
 16058                 END-IF
 16059              END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 291
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16060           END-IF
 16061
 16062           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 16063              MOVE PB-I-JOINT-BIRTHDAY
 16064                                    TO DC-BIN-DATE-1
 16065              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 16066              MOVE '1'              TO DC-OPTION-CODE
 16067              PERFORM 8500-DATE-CONVERT
 16068                                    THRU 8500-EXIT
 16069              IF NO-CONVERSION-ERROR
 16070                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16071                    MOVE ER-2661       TO WS-ERROR
 16072*                   PERFORM 9900-ERROR-FORMAT
 16073*                                   THRU 9900-EXIT
 16074                 END-IF
 16075              END-IF
 16076           ELSE
 16077              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 16078                (PB-I-AH-TERM / 12)
 16079              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16080                 MOVE ER-2661       TO WS-ERROR
 16081*                PERFORM 9900-ERROR-FORMAT
 16082*                                   THRU 9900-EXIT
 16083              ELSE
 16084                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16085                    MOVE ER-1571 TO WS-ERROR
 16086                    PERFORM 9900-ERROR-FORMAT
 16087                                 THRU 9900-EXIT
 16088                 END-IF
 16089              END-IF
 16090           END-IF
 16091           IF WS-ERROR = ER-2661
 16092              PERFORM 9900-ERROR-FORMAT
 16093                                    THRU 9900-EXIT
 16094           END-IF
 16095        END-IF
 16096     END-IF
 16097
 16098*    IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16099*       NEXT SENTENCE                                             ELC50PD
 16100*    ELSE                                                         ELC50PD
 16101*       IF CP-ERROR-ATT-OUTSIDE-LIMIT                             ELC50PD
 16102*          MOVE ER-2661          TO WS-ERROR                      ELC50PD
 16103*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16104                                                                  ELC50PD
 16105     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16106        NEXT SENTENCE                                             ELC50PD
 16107     ELSE                                                         ELC50PD
 16108        IF CP-ERROR-AGE-OUTSIDE-LIMIT                             ELC50PD
 16109           MOVE ER-2663          TO WS-ERROR                      ELC50PD
 16110           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16111                                                                  ELC50PD
 16112     IF ACCOUNT-AH-CHECKED OR                                     ELC50PD
 16113        (WS-AH-SPECIAL-CALC-CD = 'Z') OR                          ELC50PD
 16114         PB-POLICY-IS-VOIDED                                      ELC50PD
 16115        NEXT SENTENCE                                             ELC50PD
 16116     ELSE                                                         ELC50PD
 16117        IF CP-ERROR-TOT-OUTSIDE-LIMIT                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 292
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16118           MOVE ER-2667            TO WS-ERROR                    ELC50PD
 16119           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16120                                                                  ELC50PD
 16121     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16122         IF WS-ERROR = ER-2667                                    ELC50PD
 16123             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16124                                                                  ELC50PD
 16125     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16126        NEXT SENTENCE                                             ELC50PD
 16127     ELSE                                                         ELC50PD
 16128        IF CP-ERROR-TERM-OUTSIDE-LIMIT                            ELC50PD
 16129           MOVE ER-2678            TO WS-ERROR                    ELC50PD
 16130           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16131                                                                  ELC50PD
 16132     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 16133         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 16134                                                                  ELC50PD
 16135 3321-CONTINUE.                                                   ELC50PD
 16136     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.                 ELC50PD
 16137     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.            ELC50PD
 16138
 16139     IF (PB-COMPANY-ID = 'DCC')
 16140        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16141        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 16142                                    PB-I-LF-ALT-PREM-CALC
 16143        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 16144        IF WS-AH-BEN-CATEGORY = 'G'
 16145           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16146           + PB-I-ADDL-CLP)
 16147           * (1 + WS-TOL-CLP-PCT)
 16148*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 16149        ELSE
 16150           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16151           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 16152*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 16153        END-IF
 16154        MOVE WS-TOL-LF-HIGH-PREM-AMT
 16155                                 TO PB-I-AH-PREM-CALC
 16156        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 16157           MOVE ER-8152          TO WS-ERROR
 16158           PERFORM 9900-ERROR-FORMAT
 16159                                 THRU 9900-EXIT
 16160        ELSE
 16161           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 16162                 PB-I-ADDL-CLP)
 16163              MOVE ER-8148       TO WS-ERROR
 16164              PERFORM 9900-ERROR-FORMAT
 16165                                 THRU 9900-EXIT
 16166           END-IF
 16167        END-IF
 16168     END-IF
 16169     IF (PB-COMPANY-ID = 'DCC')
 16170        AND (PB-I-POLICY-IS-MONTHLY)
 16171        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16172        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 16173        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 16174           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 16175        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 293
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16176     END-IF
 16177
 16178     IF (PB-COMPANY-ID = 'DCC')
 16179        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 16180        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 16181        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 16182        MOVE ER-2786             TO WS-ERROR
 16183        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16184     END-IF
 16185
 16186     MOVE +0                     TO PB-I-AH-CLP
 16187     IF PB-COMPANY-ID = 'DCC'
 16188        IF WS-AH-BEN-CATEGORY = 'D'
 16189           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 16190              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 16191        ELSE
 16192           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 16193              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 16194           END-IF
 16195        END-IF
 16196     END-IF
 16197
 16198     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.           ELC50PD
 16199                                                                  ELC50PD
 16200     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC                           ELC50PD
 16201         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16202                                                                  ELC50PD
 16203     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC                           ELC50PD
 16204         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.          ELC50PD
 16205                                                                  ELC50PD
 16206     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16207         IF PB-I-NO-OF-PAYMENTS = ZERO  OR                        ELC50PD
 16208            PB-I-PAYMENT-AMOUNT = ZERO                            ELC50PD
 16209             NEXT SENTENCE                                        ELC50PD
 16210         ELSE                                                     ELC50PD
 16211             COMPUTE PB-I-AH-PREM-CALC =                          ELC50PD
 16212                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *    ELC50PD
 16213                 (CP-PREMIUM-RATE / 100)                          ELC50PD
 16214             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO                   ELC50PD
 16215                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *  ELC50PD
 16216                                             PB-I-RATE-DEV-PCT-AH.ELC50PD
 16217                                                                  ELC50PD
 16218     IF PB-I-AH-RATE  = ZERO                                      ELC50PD
 16219       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16220           NEXT SENTENCE
 16221       ELSE
 16222         MOVE ER-2642            TO WS-ERROR                      ELC50PD
 16223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16224                                                                  ELC50PD
 16225     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.                ELC50PD
 16226     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.         ELC50PD
 16227     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.             ELC50PD
 16228     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.            ELC50PD
 16229     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.         ELC50PD
 16230     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.         ELC50PD
 16231                                                                  ELC50PD
 16232     IF (PB-COMPANY-ID = 'DCC')
 16233        AND (WS-AH-BEN-CATEGORY = 'G')
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 294
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16234        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16235        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 16236        IF CP-DEVIATION-CODE NOT = '000'
 16237           MOVE '000'            TO CP-DEVIATION-CODE
 16238           PERFORM 7000-GET-RATE THRU 7000-EXIT
 16239           IF NO-CP-ERROR
 16240              COMPUTE PB-I-DDF-IU-RATE-UP =
 16241              PB-I-AH-CLP - CP-CALC-PREMIUM
 16242           ELSE
 16243              MOVE ER-3057        TO WS-ERROR
 16244              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16245           END-IF
 16246        END-IF
 16247     END-IF
 16248
 16249     .
 16250 3335-EDIT-AH-REIN-NSP-RATE.                                      ELC50PD
 16251     IF AH-REIN-NSP-NOT-USED                                      ELC50PD
 16252         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16253                                                                  ELC50PD
 16254     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.                       ELC50PD
 16255     IF PB-COMPANY-ID = 'DCC'
 16256         GO TO 3340-CALCULATE-PREMIUM-AMT.
 16257
 16258     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 16259     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 16260     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 16261     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16262     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16263     MOVE ZERO                   TO CP-DEVIATION-CODE             ELC50PD
 16264                                    CP-RATE-DEV-PCT.              ELC50PD
 16265*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 16266     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 16267     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16268     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16269     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16270                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16271     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16272         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 16273                                         PB-I-AH-TERM.            ELC50PD
 16274     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 16275     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16276     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16277     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16278     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16279     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16280                                    CP-REMAINING-TERM             ELC50PD
 16281                                    WS-WORK-TERM.                 ELC50PD
 16282     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.           ELC50PD
 16283
 16284     IF PB-COMPANY-ID = 'DCC'
 16285        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16286     END-IF
 16287
 16288     IF  PB-COMPANY-ID = 'TIC'                                    ELC50PD
 16289         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'             ELC50PD
 16290            MOVE ZERO TO CP-CLASS-CODE.                           ELC50PD
 16291                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 295
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16292     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 16293          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 16294                                                                  ELC50PD
 16295     MOVE ZERO               TO CP-DEVIATION-CODE.                ELC50PD
 16296                                                                  ELC50PD
 16297     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.                         ELC50PD
 16298                                                                  ELC50PD
 16299     MOVE ZERO               TO PB-I-AH-REI-RATE.                 ELC50PD
 16300                                                                  ELC50PD
 16301     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16302     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16303                                                                  ELC50PD
 16304     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16305         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16306         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 16307         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16308                                                                  ELC50PD
 16309     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.                 ELC50PD
 16310                                                                  ELC50PD
 16311     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.                ELC50PD
 16312     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.                  ELC50PD
 16313                                                                  ELC50PD
 16314     IF PB-I-AH-REI-RATE = ZERO                                   ELC50PD
 16315         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16316         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16317                                                                  ELC50PD
 16318                                                                  ELC50PD
 16319 3340-CALCULATE-PREMIUM-AMT.                                      ELC50PD
 16320                                                                  ELC50PD
 16321     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 16322         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR                      ELC50PD
 16323             WS-AH-SPECIAL-CALC-CD = 'O')                         ELC50PD
 16324             GO TO 3999-END-EDIT.                                 ELC50PD
 16325                                                                  ELC50PD
 16326     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR       ELC50PD
 16327                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR       ELC50PD
 16328                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'          ELC50PD
 16329                         OR 'AHL'
 16330         NEXT SENTENCE                                            ELC50PD
 16331     ELSE                                                         ELC50PD
 16332         IF WS-STATE-ABBREVIATION = 'CT'                          ELC50PD
 16333             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND ELC50PD
 16334                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)       ELC50PD
 16335                 COMPUTE PB-I-LF-PREM-CALC =                      ELC50PD
 16336                                     PB-I-LF-PREM-CALC * .90      ELC50PD
 16337                 COMPUTE PB-I-LF-ALT-PREM-CALC =                  ELC50PD
 16338                                     PB-I-LF-ALT-PREM-CALC * .90  ELC50PD
 16339                 COMPUTE PB-I-AH-PREM-CALC =                      ELC50PD
 16340                                     PB-I-AH-PREM-CALC * .90.     ELC50PD
 16341                                                                  ELC50PD
 16342     IF PB-COMP-LF-PREM                                           ELC50PD
 16343        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT       ELC50PD
 16344        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.  ELC50PD
 16345                                                                  ELC50PD
 16346     IF PB-COMP-AH-PREM                                           ELC50PD
 16347        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.      ELC50PD
 16348                                                                  ELC50PD
 16349 3340-CHECK-DCC-TOT-FEES.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 296
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16350
 16351     IF (PB-COMPANY-ID = 'DCC')
 16352        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 16353        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16354        AND (PB-I-POLICY-IS-MONTHLY)
 16355        CONTINUE
 16356     ELSE
 16357        GO TO 3340-EDIT-LF-AH-TOL
 16358     END-IF
 16359
 16360     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 16361     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 16362
 16363     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16364        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16365           PB-I-RATE-DEV-PCT-LF
 16366     END-IF
 16367     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 16368        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 16369           PB-I-RATE-DEV-PCT-AH
 16370     END-IF
 16371     MOVE 'N'                    TO CP-BEN-CATEGORY
 16372
 16373     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 16374                                                                  ELC50PD
 16375     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 16376     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 16377     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 16378     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 16379     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 16380     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 16381     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 16382     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16383     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 16384     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 16385                                                                  ELC50PD
 16386     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16387     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16388     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 16389     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 16390     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16391     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16392                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16393     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16394         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 16395                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 16396     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 16397     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 16398     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 16399     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16400     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16401     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16402     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16403     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 16404     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16405                                    CP-REMAINING-TERM             ELC50PD
 16406                                    CP-LOAN-TERM.                 ELC50PD
 16407     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 297
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16408         NEXT SENTENCE                                            ELC50PD
 16409     ELSE                                                         ELC50PD
 16410         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 16411             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 16412                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 16413                                                                  ELC50PD
 16414     IF CP-TRUNCATED-LIFE                                         ELC50PD
 16415        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 16416                                                                  ELC50PD
 16417     IF CP-TERM-IS-DAYS                                           ELC50PD
 16418         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 16419     ELSE                                                         ELC50PD
 16420         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 16421                                                                  ELC50PD
 16422
 16423     IF PB-COMPANY-ID = 'DCC'
 16424        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16425     END-IF
 16426
 16427     IF CP-SPECIAL-CALC-CD = 'H'                                  ELC50PD
 16428         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 16429                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 16430         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 16431
 16432     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 16433     MOVE 'R'                    TO CP-RATE-FILE
 16434     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 16435
 16436     IF NOT CP-ERROR-RATE-NOT-FOUND
 16437        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 16438        IF (CP-DCC-LF-RATE NOT = ZEROS)
 16439           AND (CP-BENEFIT-CD (1:1) = 'S')
 16440           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 16441                                    PB-I-LF-PREMIUM-AMT
 16442        END-IF
 16443     ELSE
 16444        MOVE +0                  TO PB-I-TOT-FEES-CALC
 16445     END-IF
 16446
 16447     .
 16448 3340-EDIT-LF-AH-TOL.                                             ELC50PD
 16449                                                                  ELC50PD
 16450***    UNSIGN-WRK1    =    LIFE DIFFERENCE                        ELC50PD
 16451***    UNSIGN-WRK2    =    AH   DIFFERENCE                        ELC50PD
 16452***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE                   ELC50PD
 16453***                                                               ELC50PD
 16454     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT            ELC50PD
 16455         PB-I-AH-PREMIUM-AMT                                      ELC50PD
 16456          GIVING WS-CALC-WORK.                                    ELC50PD
 16457                                                                  ELC50PD
 16458     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM                     ELC50PD
 16459        AND WS-CALC-WORK NOT = ZERO                               ELC50PD
 16460         MOVE ER-2649            TO WS-ERROR                      ELC50PD
 16461         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16462                                                                  ELC50PD
 16463     SUBTRACT PB-I-LF-PREM-CALC                                      CL**2
 16464             FROM PB-I-LF-PREMIUM-AMT                             ELC50PD
 16465                 GIVING WS-UNSIGN-WRK1.                              CL**2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 298
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16466                                                                     CL**2
 16467     SUBTRACT PB-I-LF-ALT-PREM-CALC                                  CL**2
 16468             FROM PB-I-LF-ALT-PREMIUM-AMT                         ELC50PD
 16469                 GIVING WS-UNSIGN-WRK4.                              CL**2
 16470                                                                     CL**2
 16471     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1                         CL**2
 16472                                + WS-UNSIGN-WRK4.                    CL**2
 16473                                                                     CL**2
 16474     SUBTRACT PB-I-AH-PREM-CALC                                      CL**2
 16475             FROM PB-I-AH-PREMIUM-AMT                             ELC50PD
 16476                 GIVING WS-UNSIGN-WRK2.                           ELC50PD
 16477                                                                  ELC50PD
 16478******************************************************************ELC50PD
 16479*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *ELC50PD
 16480******************************************************************ELC50PD
 16481                                                                  ELC50PD
 16482     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 16483         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 16484                                                                  ELC50PD
 16485     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 16486         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 16487                                                                  ELC50PD
 16488     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2                               CL**2
 16489             GIVING WS-UNSIGN-WRK3.                               ELC50PD
 16490                                                                  ELC50PD
 16491 3342-CONTINUE.                                                   ELC50PD
 16492                                                                  ELC50PD
 16493     IF (PB-I-LF-RATE = ZERO  AND                                 ELC50PD
 16494         PB-I-AH-RATE = ZERO)                                     ELC50PD
 16495         IF WS-LF-SPECIAL-CALC-CD = 'O' OR                        ELC50PD
 16496            WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 16497              NEXT SENTENCE                                       ELC50PD
 16498         ELSE                                                     ELC50PD
 16499             GO TO 3345-EDIT-CONTINUE.                            ELC50PD
 16500                                                                  ELC50PD
 16501     IF  PB-RECORD-BILL   =  'B' OR  'L'                          ELC50PD
 16502         NEXT SENTENCE                                            ELC50PD
 16503     ELSE                                                         ELC50PD
 16504     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'                        ELC50PD
 16505        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM             ELC50PD
 16506           IF (PB-REISSUED-CERT         OR                        ELC50PD
 16507               PB-POLICY-IS-DECLINED    OR                        ELC50PD
 16508               PB-POLICY-IS-VOIDED)                               ELC50PD
 16509              NEXT SENTENCE                                       ELC50PD
 16510           ELSE                                                   ELC50PD
 16511              IF WS-PREM-REJECT-SW = SPACE                        ELC50PD
 16512                 MOVE ER-2652    TO WS-ERROR                      ELC50PD
 16513                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16514                 GO TO 3344-CHECK-AH                              ELC50PD
 16515              ELSE                                                ELC50PD
 16516                 MOVE ER-2650    TO WS-ERROR                      ELC50PD
 16517                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16518                 GO TO 3344-CHECK-AH.                             ELC50PD
 16519                                                                  ELC50PD
 16520***                                                               ELC50PD
 16521***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES                ELC50PD
 16522***                                                               ELC50PD
 16523                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 299
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16524     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16525         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =                        ELC50PD
 16526            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16527             (1 + WS-TOL-LF-PREM-PCT)                             ELC50PD
 16528         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =                        ELC50PD
 16529            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16530             (1 - WS-TOL-LF-PREM-PCT)                             ELC50PD
 16531     ELSE                                                         ELC50PD
 16532         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 16533         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16534                                                                  ELC50PD
 16535***                                                               ELC50PD
 16536***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES                 ELC50PD
 16537***                                                               ELC50PD
 16538                                                                  ELC50PD
 16539     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL                        ELC50PD
 16540         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +              ELC50PD
 16541          WS-TOL-LF-PREM.                                         ELC50PD
 16542                                                                  ELC50PD
 16543     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL                         ELC50PD
 16544         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -            ELC50PD
 16545          WS-TOL-LF-PREM.                                         ELC50PD
 16546                                                                  ELC50PD
 16547     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16548        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.       ELC50PD
 16549                                                                  ELC50PD
 16550     IF PB-REISSUED-CERT
 16551        or PB-POLICY-IS-DECLINED
 16552        or PB-POLICY-IS-VOIDED
 16553        continue
 16554     ELSE
 16555        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16556              > WS-TOL-LF-HIGH-PREM-AMT)
 16557           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16558              < WS-TOL-LF-LOW-PREM-AMT))
 16559                      or
 16560           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16561              > WS-TOL-LF-HIGH-PREM-PCT)
 16562           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16563              < WS-TOL-LF-LOW-PREM-PCT))
 16564           IF WS-PREM-REJECT-SW = SPACE
 16565              MOVE ER-2652       TO WS-ERROR
 16566              PERFORM 9900-ERROR-FORMAT
 16567                                 THRU 9900-EXIT
 16568           ELSE
 16569              MOVE ER-2650       TO WS-ERROR
 16570              PERFORM 9900-ERROR-FORMAT
 16571                                 THRU 9900-EXIT
 16572           end-if
 16573        end-if
 16574     end-if
 16575                                                                  ELC50PD
 16576*    IF  WS-ERROR  =  ER-2650  OR  ER-2652                        ELC50PD
 16577*        IF  PB-RECORD-BILL   =  'B' OR  'L'                      ELC50PD
 16578*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16579*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16580                                                                  ELC50PD
 16581     IF WS-ERROR  =  ER-2650  OR  ER-2652
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 300
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16582        IF (PB-RECORD-BILL   =  'B' OR  'L')
 16583                      OR
 16584           ((PB-COMPANY-ID = 'DCC')
 16585           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 16586           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 16587           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 16588        END-IF
 16589     END-IF
 16590                                                                  ELC50PD
 16591     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16592        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16593           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16594              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16595                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16596                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16597                 NEXT SENTENCE                                    ELC50PD
 16598              ELSE                                                ELC50PD
 16599                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16600                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16601                                                                  ELC50PD
 16602 3344-CVL-TOLERANCE-CHECK.                                        ELC50PD
 16603                                                                  ELC50PD
 16604      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'                    ELC50PD
 16605          GO TO 3344-CHECK-AH.                                    ELC50PD
 16606                                                                  ELC50PD
 16607      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS              ELC50PD
 16608          GO TO 3344-CHECK-AH.                                    ELC50PD
 16609                                                                  ELC50PD
 16610      MOVE ZERO                  TO  WS-UNSIGN-WRK5               ELC50PD
 16611                                     WS-UNSIGN-WRK6.              ELC50PD
 16612                                                                  ELC50PD
 16613      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO               ELC50PD
 16614          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5                 ELC50PD
 16615                                 + PB-I-LF-PREMIUM-AMT            ELC50PD
 16616                                 - PB-I-LF-PREM-CALC.             ELC50PD
 16617                                                                  ELC50PD
 16618      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO           ELC50PD
 16619          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6                 ELC50PD
 16620                                 + PB-I-LF-ALT-PREMIUM-AMT        ELC50PD
 16621                                 - PB-I-LF-ALT-PREM-CALC.         ELC50PD
 16622                                                                  ELC50PD
 16623      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO                    ELC50PD
 16624          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16625              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16626                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16627                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16628              ELSE                                                ELC50PD
 16629                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16630                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16631                                                                  ELC50PD
 16632      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO                    ELC50PD
 16633          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16634              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16635                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16636                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16637              ELSE                                                ELC50PD
 16638                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16639                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 301
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16640                                                                  ELC50PD
 16641 3344-CHECK-AH.                                                   ELC50PD
 16642                                                                  ELC50PD
 16643****************************************************************  ELC50PD
 16644***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES                  ELC50PD
 16645***                                                               ELC50PD
 16646                                                                  ELC50PD
 16647     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16648         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *    ELC50PD
 16649             (1 + WS-TOL-AH-PREM-PCT)                             ELC50PD
 16650         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *    ELC50PD
 16651             (1 - WS-TOL-AH-PREM-PCT)                             ELC50PD
 16652     ELSE                                                         ELC50PD
 16653         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 16654         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16655                                                                  ELC50PD
 16656***                                                               ELC50PD
 16657***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES                   ELC50PD
 16658***                                                               ELC50PD
 16659                                                                  ELC50PD
 16660     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL                        ELC50PD
 16661         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.                      ELC50PD
 16662                                                                  ELC50PD
 16663     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL                         ELC50PD
 16664         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.                      ELC50PD
 16665                                                                  ELC50PD
 16666     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16667        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.       ELC50PD
 16668                                                                  ELC50PD
 16669     IF (PB-REISSUED-CERT)
 16670        OR (PB-POLICY-IS-DECLINED)
 16671        OR (PB-POLICY-IS-VOIDED)
 16672        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 16673        CONTINUE
 16674     ELSE
 16675        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 16676              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 16677                          or
 16678           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 16679              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 16680           IF WS-PREM-REJECT-SW = SPACE
 16681              MOVE ER-3052       TO WS-ERROR
 16682              PERFORM 9900-ERROR-FORMAT
 16683                                 THRU 9900-EXIT
 16684           ELSE
 16685              MOVE ER-3050       TO WS-ERROR
 16686              PERFORM 9900-ERROR-FORMAT
 16687                                 THRU 9900-EXIT
 16688           END-IF
 16689        END-IF
 16690     END-IF
 16691
 16692     if (pb-company-id = 'DCC')
 16693        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 16694        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 16695        and (pb-i-policy-is-monthly)
 16696        compute ws-tol-ah-high-prem-amt =
 16697           pb-i-tot-fees-calc + ws-tol-ah-prem
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 302
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16698        compute ws-tol-ah-low-prem-amt =
 16699           pb-i-tot-fees-calc - ws-tol-ah-prem
 16700        if ws-tol-ah-prem-pct > zeros
 16701           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 16702              (1 + ws-tol-ah-prem-pct)
 16703           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 16704              (1 - ws-tol-ah-prem-pct)
 16705        else
 16706           move +9999999.99      to ws-tol-ah-high-prem-pct
 16707           move +0               to ws-tol-ah-low-prem-pct
 16708        end-if
 16709        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 16710            or
 16711           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 16712                          or
 16713           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 16714           or
 16715           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 16716            move er-3049         to ws-error
 16717           perform 9900-error-format
 16718                                 thru 9900-exit
 16719
 16720        end-if
 16721     end-if
 16722
 16723     IF  WS-ERROR  =  ER-3050   OR   ER-3052                      ELC50PD
 16724         IF  PB-RECORD-BILL   =  'B' OR 'A'                       ELC50PD
 16725             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16726             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16727                                                                  ELC50PD
 16728     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16729        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16730           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16731              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16732                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16733                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16734                 NEXT SENTENCE                                    ELC50PD
 16735              ELSE                                                ELC50PD
 16736                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16737                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16738                                                                  ELC50PD
 16739     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR              ELC50PD
 16740        (WS-COMP-MAX-CAP EQUAL +0)                                ELC50PD
 16741           GO TO 3345-EDIT-CONTINUE.                              ELC50PD
 16742                                                                  ELC50PD
 16743     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)  ELC50PD
 16744        GREATER THAN WS-COMP-MAX-CAP                              ELC50PD
 16745           MOVE ER-2646          TO  WS-ERROR                     ELC50PD
 16746           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16747                                                                  ELC50PD
 16748 3345-EDIT-CONTINUE.                                              ELC50PD
 16749                                                                  ELC50PD
 16750*    IF PB-COMPANY-ID    EQUAL    'NCL'                           ELC50PD
 16751*       IF PB-ENTRY-BATCH   NUMERIC                               ELC50PD
 16752*          IF PB-ISSUE                                            ELC50PD
 16753*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO         ELC50PD
 16754*          ELSE                                                   ELC50PD
 16755*              IF PB-CANCELLATION                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 303
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16756*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.      ELC50PD
 16757                                                                  ELC50PD
 16758*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 16759*        IF  PB-I-MICROFILM-NO     NUMERIC    AND                 ELC50PD
 16760*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS                  ELC50PD
 16761*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO     ELC50PD
 16762*        ELSE                                                     ELC50PD
 16763*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 16764*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.         ELC50PD
 16765                                                                  ELC50PD
 16766     IF PB-I-POLICY-ACCEPTED                                      ELC50PD
 16767        IF PB-POLICY-IS-DECLINED  OR                              ELC50PD
 16768           PB-REISSUED-CERT  OR                                   ELC50PD
 16769           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16770           PB-POLICY-IS-VOIDED                                    ELC50PD
 16771            MOVE  ER-1891         TO  WS-ERROR                    ELC50PD
 16772            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16773        ELSE                                                      ELC50PD
 16774            MOVE SPACE            TO  PB-BATCH-ENTRY              ELC50PD
 16775            MOVE '2'              TO  PB-I-ENTRY-STATUS.          ELC50PD
 16776                                                                  ELC50PD
 16777     IF PB-I-POLICY-DECLINED                                      ELC50PD
 16778        IF PB-REISSUED-CERT  OR                                   ELC50PD
 16779           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16780           PB-POLICY-IS-VOIDED                                    ELC50PD
 16781            MOVE  ER-1906         TO  WS-ERROR                    ELC50PD
 16782            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16783        ELSE                                                      ELC50PD
 16784            MOVE  'D'             TO  PB-BATCH-ENTRY              ELC50PD
 16785                                      PB-I-ENTRY-STATUS.          ELC50PD
 16786                                                                  ELC50PD
 16787     IF PB-I-NEEDS-UNDERWRITING                                   ELC50PD
 16788        IF PB-POLICY-IS-DECLINED OR                               ELC50PD
 16789           PB-REISSUED-CERT  OR                                   ELC50PD
 16790           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16791           PB-POLICY-IS-VOIDED                                    ELC50PD
 16792            MOVE  ER-1907         TO  WS-ERROR                    ELC50PD
 16793            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16794        ELSE                                                      ELC50PD
 16795            MOVE 'U'              TO  PB-BATCH-ENTRY              ELC50PD
 16796                                      PB-I-ENTRY-STATUS.          ELC50PD
 16797                                                                  ELC50PD
 16798     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 16799        MOVE  ER-1901             TO  WS-ERROR                    ELC50PD
 16800        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16801
 16802     IF PB-COMPANY-ID = 'DCC'
 16803        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 16804        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 16805        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16806           AND (NOT WS-LF-CASH))
 16807                           OR
 16808           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16809           AND (NOT WS-AH-CASH)))
 16810                       AND
 16811           (PB-I-ENTRY-STATUS NOT = '5')
 16812           MOVE 'M'              TO PB-BATCH-ENTRY
 16813                                    PB-I-ENTRY-STATUS
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 304
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16814        END-IF
 16815     END-IF
 16816
 16817     IF  PB-COMPANY-ID NOT = 'NCL'                                ELC50PD
 16818         GO TO 3999-END-EDIT.                                     ELC50PD
 16819                                                                  ELC50PD
 16820     IF PB-REISSUED-CERT  OR                                      ELC50PD
 16821        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 16822        PB-POLICY-IS-VOIDED  OR                                   ELC50PD
 16823        PB-I-OB                                                   ELC50PD
 16824         GO TO 3999-END-EDIT.                                     ELC50PD
 16825                                                                  ELC50PD
 16826     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS                   ELC50PD
 16827         MOVE  ER-2644            TO  WS-ERROR                    ELC50PD
 16828         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 16829         GO TO 3999-END-EDIT.                                     ELC50PD
 16830                                                                  ELC50PD
 16831     MOVE 'N'                     TO  FORM-MASTER-SW.             ELC50PD
 16832     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.                   ELC50PD
 16833                                                                  ELC50PD
 16834     IF NOT FORM-MASTER-FOUND                                     ELC50PD
 16835         GO TO 3999-END-EDIT.                                     ELC50PD
 16836                                                                  ELC50PD
 16837     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW         ELC50PD
 16838                                      FORM-MASTER-AH-SW.          ELC50PD
 16839                                                                  ELC50PD
 16840     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES            ELC50PD
 16841         MOVE  +1                 TO SUB6                         ELC50PD
 16842         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.      ELC50PD
 16843                                                                  ELC50PD
 16844     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES               ELC50PD
 16845         MOVE  +1                 TO SUB6                         ELC50PD
 16846         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.      ELC50PD
 16847                                                                  ELC50PD
 16848     IF LF-FORM-MASTER-FOUND  OR                                  ELC50PD
 16849        AH-FORM-MASTER-FOUND                                      ELC50PD
 16850         GO TO 3360-CHECK-FORM-LIMITS                             ELC50PD
 16851     ELSE                                                         ELC50PD
 16852         GO TO 3999-END-EDIT.                                     ELC50PD
 16853                                                                  ELC50PD
 16854******************************************************************ELC50PD
 16855*                  3350-GET-ERFORM                               *ELC50PD
 16856*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *ELC50PD
 16857*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *ELC50PD
 16858******************************************************************ELC50PD
 16859                                                                  ELC50PD
 16860 3350-GET-ERFORM.                                                 ELC50PD
 16861                                                                  ELC50PD
 16862     IF  WK-FORM-ADDR      EQUAL    ZEROS                         ELC50PD
 16863         GO TO  3350-ERFORM-GETMAIN.                              ELC50PD
 16864                                                                  ELC50PD
 16865     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.             ELC50PD
 16866     SET ERFORM-FILE-ADDRESSED    TO  TRUE.                       ELC50PD
 16867     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 16868     MOVE 'Y'                     TO FORM-MASTER-SW.              ELC50PD
 16869                                                                  ELC50PD
 16870     IF PB-CANCELLATION                                           ELC50PD
 16871         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 305
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16872            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16873            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID               ELC50PD
 16874              GO TO 3350-EXIT                                     ELC50PD
 16875         ELSE                                                     ELC50PD
 16876             NEXT SENTENCE                                        ELC50PD
 16877     ELSE                                                         ELC50PD
 16878         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16879            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16880            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID               ELC50PD
 16881              GO TO 3350-EXIT.                                    ELC50PD
 16882                                                                  ELC50PD
 16883 3350-ERFORM-GETMAIN.                                             ELC50PD
 16884                                                                  ELC50PD
 16885     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.           ELC50PD
 16886     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.               ELC50PD
 16887                                                                  ELC50PD
 16888 3350-ERFORM-READ.                                                ELC50PD
 16889                                                                  ELC50PD
 16890     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.            ELC50PD
 16891     MOVE  PB-SV-STATE            TO  FORM-STATE.                 ELC50PD
 16892     IF PB-CANCELLATION                                           ELC50PD
 16893         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID            ELC50PD
 16894     ELSE                                                         ELC50PD
 16895         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.           ELC50PD
 16896     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.           ELC50PD
 16897                                                                  ELC50PD
 16898     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.             ELC50PD
 16899                                                                  ELC50PD
 16900     IF FORM-MASTER-FOUND                                         ELC50PD
 16901       IF PB-CANCELLATION                                         ELC50PD
 16902          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16903             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16904             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID              ELC50PD
 16905              GO  TO 3350-EXIT                                    ELC50PD
 16906          ELSE                                                    ELC50PD
 16907              NEXT SENTENCE                                       ELC50PD
 16908       ELSE                                                       ELC50PD
 16909          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16910             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16911             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID              ELC50PD
 16912              GO  TO 3350-EXIT.                                   ELC50PD
 16913                                                                  ELC50PD
 16914     MOVE  'N'                    TO  FORM-MASTER-SW.             ELC50PD
 16915     MOVE  ER-1895                TO  WS-ERROR.                   ELC50PD
 16916     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.                 ELC50PD
 16917                                                                  ELC50PD
 16918 3350-EXIT.                                                       ELC50PD
 16919      EXIT.                                                       ELC50PD
 16920                                                                  ELC50PD
 16921******************************************************************ELC50PD
 16922*                  3355-EDIT-FORM-LF-BENEFITS                    *ELC50PD
 16923*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *ELC50PD
 16924*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16925******************************************************************ELC50PD
 16926                                                                  ELC50PD
 16927 3355-EDIT-FORM-LF-BENEFITS.                                      ELC50PD
 16928                                                                  ELC50PD
 16929     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 306
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16930        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)                 ELC50PD
 16931         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW         ELC50PD
 16932         GO TO   3355-EXIT.                                       ELC50PD
 16933                                                                  ELC50PD
 16934     IF  SUB6    LESS THAN   +40                                  ELC50PD
 16935         ADD  +1      TO  SUB6                                    ELC50PD
 16936         GO TO  3355-EDIT-FORM-LF-BENEFITS.                       ELC50PD
 16937                                                                  ELC50PD
 16938     MOVE  ER-1896         TO  WS-ERROR.                          ELC50PD
 16939     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16940                                                                  ELC50PD
 16941 3355-EXIT.                                                       ELC50PD
 16942      EXIT.                                                       ELC50PD
 16943                                                                  ELC50PD
 16944******************************************************************ELC50PD
 16945*                  3356-EDIT-FORM-AH-BENEFITS                    *ELC50PD
 16946*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *ELC50PD
 16947*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16948******************************************************************ELC50PD
 16949                                                                  ELC50PD
 16950 3356-EDIT-FORM-AH-BENEFITS.                                      ELC50PD
 16951                                                                  ELC50PD
 16952     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND            ELC50PD
 16953        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)                   ELC50PD
 16954         MOVE  'Y'                TO  FORM-MASTER-AH-SW           ELC50PD
 16955         GO TO  3356-EXIT.                                        ELC50PD
 16956                                                                  ELC50PD
 16957      IF  SUB6    LESS THAN     +40                               ELC50PD
 16958          ADD  +1      TO  SUB6                                   ELC50PD
 16959          GO TO  3356-EDIT-FORM-AH-BENEFITS.                      ELC50PD
 16960                                                                  ELC50PD
 16961     MOVE  ER-1897         TO  WS-ERROR.                          ELC50PD
 16962     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16963                                                                  ELC50PD
 16964 3356-EXIT.                                                       ELC50PD
 16965      EXIT.                                                       ELC50PD
 16966                                                                  ELC50PD
 16967******************************************************************ELC50PD
 16968*                  3357-BENEFIT-SEARCH                           *ELC50PD
 16969*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *ELC50PD
 16970*   CANCELLATIONS ONLY.                                          *ELC50PD
 16971******************************************************************ELC50PD
 16972 3357-BENEFIT-SEARCH.                                             ELC50PD
 16973     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 16974         MOVE +1                          TO SUB6                 ELC50PD
 16975         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.         ELC50PD
 16976                                                                  ELC50PD
 16977     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 16978         MOVE +1                          TO SUB6                 ELC50PD
 16979         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.         ELC50PD
 16980                                                                  ELC50PD
 16981 3357-EXIT.                                                       ELC50PD
 16982     EXIT.                                                        ELC50PD
 16983                                                                  ELC50PD
 16984******************************************************************ELC50PD
 16985*                  3358-BENEFIT-LIFE-SEARCH                      *ELC50PD
 16986*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 16987*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 307
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16988*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 16989******************************************************************ELC50PD
 16990 3358-BENEFIT-LIFE-SEARCH.                                        ELC50PD
 16991     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)      ELC50PD
 16992       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)         ELC50PD
 16993         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 16994           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 16995              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 16996                     IS GREATER THAN SPACES                       ELC50PD
 16997                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 16998                                          WS-LF-REFUND-CALC       ELC50PD
 16999                 GO TO 3358-EXIT.                                 ELC50PD
 17000                                                                  ELC50PD
 17001     IF SUB6 LESS THAN +40                                        ELC50PD
 17002         ADD +1                 TO SUB6                           ELC50PD
 17003         GO TO 3358-BENEFIT-LIFE-SEARCH.                          ELC50PD
 17004                                                                  ELC50PD
 17005 3358-EXIT.                                                       ELC50PD
 17006     EXIT.                                                        ELC50PD
 17007******************************************************************ELC50PD
 17008*                  3359-BENEFIT-AH-SEARCH                        *ELC50PD
 17009*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 17010*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 17011*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 17012******************************************************************ELC50PD
 17013 3359-BENEFIT-AH-SEARCH.                                          ELC50PD
 17014     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)       ELC50PD
 17015       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)        ELC50PD
 17016         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 17017           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 17018              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 17019                      IS GREATER THAN SPACES                      ELC50PD
 17020                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 17021                                          WS-AH-REFUND-CALC       ELC50PD
 17022                 GO TO 3359-EXIT.                                 ELC50PD
 17023                                                                  ELC50PD
 17024     IF SUB6 LESS THAN +40                                        ELC50PD
 17025         ADD +1                 TO SUB6                           ELC50PD
 17026         GO TO 3359-BENEFIT-AH-SEARCH.                            ELC50PD
 17027                                                                  ELC50PD
 17028 3359-EXIT.                                                       ELC50PD
 17029     EXIT.                                                        ELC50PD
 17030                                                                  ELC50PD
 17031******************************************************************ELC50PD
 17032*                  3360-CHECK-FORM-LIMITS                        *ELC50PD
 17033*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17034*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17035******************************************************************ELC50PD
 17036                                                                  ELC50PD
 17037 3360-CHECK-FORM-LIMITS.                                          ELC50PD
 17038                                                                  ELC50PD
 17039     IF FO-IND-GRP-CD = 'I'  OR  'G'                              ELC50PD
 17040         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.             ELC50PD
 17041                                                                  ELC50PD
 17042     IF NOT LF-FORM-MASTER-FOUND                                  ELC50PD
 17043         GO TO 3360-CHECK-FORM-AH-LIMITS.                         ELC50PD
 17044                                                                  ELC50PD
 17045 3360-CHECK-FORM-LF-MIN-ISS-AGE.                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 308
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17046                                                                  ELC50PD
 17047     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR              ELC50PD
 17048       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND       ELC50PD
 17049        WS-LF-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17050        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17051         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17052            MOVE  ER-1911          TO  WS-ERROR                   ELC50PD
 17053            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17054         ELSE                                                     ELC50PD
 17055            MOVE  ER-1892          TO  WS-ERROR                   ELC50PD
 17056            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17057                                                                  ELC50PD
 17058 3360-CHECK-FORM-LF-ATT-AGE.                                      ELC50PD
 17059                                                                  ELC50PD
 17060     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 17061                                                                  ELC50PD
 17062     IF  FO-MAX-ATT-AGE     NUMERIC  AND                          ELC50PD
 17063         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17064         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE          ELC50PD
 17065            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17066                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17067                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17068            ELSE                                                  ELC50PD
 17069                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17070                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17071                                                                  ELC50PD
 17072 3360-CHECK-FORM-LF-MAX-ISS-AGE.                                  ELC50PD
 17073                                                                  ELC50PD
 17074     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND                      ELC50PD
 17075         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS               ELC50PD
 17076         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE       ELC50PD
 17077            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17078                MOVE  ER-1914      TO  WS-ERROR                   ELC50PD
 17079                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT      ELC50PD
 17080            ELSE                                                  ELC50PD
 17081                MOVE  ER-1899      TO  WS-ERROR                   ELC50PD
 17082                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.     ELC50PD
 17083                                                                  ELC50PD
 17084 3360-CHECK-FORM-LF-TERM-BAMT.                                    ELC50PD
 17085                                                                  ELC50PD
 17086     IF  FO-LF-MAX-TERM   NUMERIC   AND                           ELC50PD
 17087         FO-LF-MAX-TERM   GREATER THAN   ZEROS                    ELC50PD
 17088         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM          ELC50PD
 17089           IF  PB-COMPANY-ID = 'NCL'                              ELC50PD
 17090               MOVE  ER-1916       TO  WS-ERROR                   ELC50PD
 17091               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17092           ELSE                                                   ELC50PD
 17093               MOVE  ER-1902       TO  WS-ERROR                   ELC50PD
 17094               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17095                                                                  ELC50PD
 17096     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +        ELC50PD
 17097                                    PB-I-LF-ALT-BENEFIT-AMT.      ELC50PD
 17098                                                                  ELC50PD
 17099     IF  FO-MAX-LF-AMT   NUMERIC   AND                            ELC50PD
 17100         FO-MAX-LF-AMT   GREATER THAN   ZEROS                     ELC50PD
 17101         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT      ELC50PD
 17102             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17103                 MOVE  ER-1918     TO  WS-ERROR                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 309
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17104                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17105             ELSE                                                 ELC50PD
 17106                 MOVE  ER-1904     TO  WS-ERROR                   ELC50PD
 17107                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17108                                                                  ELC50PD
 17109******************************************************************ELC50PD
 17110*                  3360-CHECK-FORM-AH-LIMITS                     *ELC50PD
 17111*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17112*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17113******************************************************************ELC50PD
 17114                                                                  ELC50PD
 17115 3360-CHECK-FORM-AH-LIMITS.                                       ELC50PD
 17116                                                                  ELC50PD
 17117     IF NOT AH-FORM-MASTER-FOUND                                  ELC50PD
 17118         GO TO 3999-END-EDIT.                                     ELC50PD
 17119                                                                  ELC50PD
 17120 3360-CHECK-FORM-AH-MIN-ISS-AGE.                                  ELC50PD
 17121                                                                  ELC50PD
 17122     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR              ELC50PD
 17123       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND       ELC50PD
 17124        WS-AH-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17125        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17126         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17127            MOVE  ER-1912          TO  WS-ERROR                   ELC50PD
 17128            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17129         ELSE                                                     ELC50PD
 17130            MOVE  ER-1893          TO  WS-ERROR                   ELC50PD
 17131            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17132                                                                  ELC50PD
 17133 3360-CHECK-FORM-AH-ATT-AGE.                                      ELC50PD
 17134                                                                  ELC50PD
 17135     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 17136                                                                  ELC50PD
 17137     IF  FO-MAX-ATT-AGE     NUMERIC     AND                       ELC50PD
 17138         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17139         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE            ELC50PD
 17140            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17141                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17142                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 17143            ELSE                                                  ELC50PD
 17144                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17145                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 17146                                                                  ELC50PD
 17147 3360-CHECK-FORM-AH-MAX-ISS-AGE.                                  ELC50PD
 17148                                                                  ELC50PD
 17149     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND                     ELC50PD
 17150         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0                  ELC50PD
 17151         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE    ELC50PD
 17152            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17153                MOVE  ER-1915      TO  WS-ERROR                   ELC50PD
 17154                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17155            ELSE                                                  ELC50PD
 17156                MOVE  ER-1900      TO  WS-ERROR                   ELC50PD
 17157                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17158                                                                  ELC50PD
 17159 3360-CHECK-FORM-AH-TERM-BAMT.                                    ELC50PD
 17160                                                                  ELC50PD
 17161     IF  FO-AH-MAX-TERM    NUMERIC   AND                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 310
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17162         FO-AH-MAX-TERM    GREATER THAN  +0                       ELC50PD
 17163         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM      ELC50PD
 17164             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17165                 MOVE  ER-1917     TO  WS-ERROR                   ELC50PD
 17166                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT     ELC50PD
 17167             ELSE                                                 ELC50PD
 17168                  MOVE  ER-1903    TO  WS-ERROR                   ELC50PD
 17169                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.   ELC50PD
 17170                                                                  ELC50PD
 17171     IF  FO-MAX-AH-AMT    NUMERIC   AND                           ELC50PD
 17172         FO-MAX-AH-AMT    GREATER THAN  +0                        ELC50PD
 17173         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT   ELC50PD
 17174             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17175                 MOVE  ER-1919     TO  WS-ERROR                   ELC50PD
 17176                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17177             ELSE                                                 ELC50PD
 17178                 MOVE  ER-1905     TO  WS-ERROR                   ELC50PD
 17179                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17180                                                                  ELC50PD
 17181     GO TO 3999-END-EDIT.                                         ELC50PD
 17182                                                                  ELC50PD
 17183******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 311
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17185******************************************************************ELC50PD
 17186*                  E D I T   C A N C E L                         *ELC50PD
 17187******************************************************************ELC50PD
 17188                                                                  ELC50PD
 17189 3700-EDIT-CANCEL.                                                ELC50PD
 17190     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 17191         MOVE ZEROS                   TO WS-RES-STATE-TAX         ELC50PD
 17192                                         WS-RES-MUNI-TAX          ELC50PD
 17193                                         PB-CI-STATE-TAX          ELC50PD
 17194                                         PB-CI-MUNI-TAX           ELC50PD
 17195         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.     ELC50PD
 17196                                                                  ELC50PD
 17197*    IF PB-COMPANY-ID  EQUAL  'NCL'                               ELC50PD
 17198*       IF PB-ENTRY-BATCH  NUMERIC                                ELC50PD
 17199*          IF PB-CANCELLATION                                     ELC50PD
 17200*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO      ELC50PD
 17201*          ELSE                                                   ELC50PD
 17202*             IF PB-ISSUE                                         ELC50PD
 17203*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.     ELC50PD
 17204                                                                  ELC50PD
 17205     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 17206        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 17207     END-IF
 17208
 17209*    IF PB-C-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 17210*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.           ELC50PD
 17211                                                                  ELC50PD
 17212     IF CM-ENTRY-STATUS = 'V'                                     ELC50PD
 17213        MOVE ER-2780             TO WS-ERROR                      ELC50PD
 17214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17215        GO TO 3999-END-EDIT.                                      ELC50PD
 17216                                                                  ELC50PD
 17217     IF CM-ENTRY-STATUS = 'D'                                     ELC50PD
 17218        MOVE ER-2781             TO WS-ERROR                      ELC50PD
 17219        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17220        GO TO 3999-END-EDIT.                                      ELC50PD
 17221                                                                  ELC50PD
 17222     IF CM-ENTRY-STATUS = 'U'                                     ELC50PD
 17223        MOVE ER-2782             TO WS-ERROR                      ELC50PD
 17224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17225                                                                  ELC50PD
 17226***************************************************************   ELC50PD
 17227*                                                             *   ELC50PD
 17228*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *   ELC50PD
 17229*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *   ELC50PD
 17230*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *   ELC50PD
 17231*   OF ANOTHER COVERAGE.                                      *   ELC50PD
 17232*                                                             *   ELC50PD
 17233***************************************************************   ELC50PD
 17234                                                                  ELC50PD
 17235     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17236                                    PB-C-AH-CANCEL-VOID-SW.       ELC50PD
 17237                                                                  ELC50PD
 17238     IF PB-C-LF-CANCEL-AMT = ZERO                                 ELC50PD
 17239        NEXT SENTENCE                                             ELC50PD
 17240     ELSE                                                         ELC50PD
 17241        IF (PB-C-LF-CANCEL-AMT NEGATIVE)                          ELC50PD
 17242           AND                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 312
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17243           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)    ELC50PD
 17244               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17245               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17246               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17247                                                                  ELC50PD
 17248     IF PB-C-AH-CANCEL-AMT = ZERO                                 ELC50PD
 17249        NEXT SENTENCE                                             ELC50PD
 17250     ELSE                                                         ELC50PD
 17251        IF (PB-C-AH-CANCEL-AMT NEGATIVE)                          ELC50PD
 17252           AND                                                    ELC50PD
 17253           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)      ELC50PD
 17254               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW        ELC50PD
 17255               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17256               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17257                                                                  ELC50PD
 17258     IF WS-LF-EARNINGS-CALC = '4'                                 ELC50PD
 17259        MOVE '4'                   TO WS-LF-REFUND-CALC.          ELC50PD
 17260                                                                  ELC50PD
 17261     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.          ELC50PD
 17262     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.     ELC50PD
 17263     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.     ELC50PD
 17264     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.     ELC50PD
 17265     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.          ELC50PD
 17266     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.          ELC50PD
 17267                                                                  ELC50PD
 17268     MOVE ZERO                     TO PB-C-LF-REF-CALC            ELC50PD
 17269                                      PB-C-AH-REF-CALC.           ELC50PD
 17270     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.                 ELC50PD
 17271                                                                  ELC50PD
 17272******************************************************************ELC50PD
 17273*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *ELC50PD
 17274*             TO VALIDATE COVERAGE.                              *ELC50PD
 17275******************************************************************ELC50PD
 17276                                                                  ELC50PD
 17277     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND                        ELC50PD
 17278        PB-C-LF-CANCEL-AMT = ZEROS                                ELC50PD
 17279          MOVE 'N'                 TO WS-LF-CANCEL-SW             ELC50PD
 17280      ELSE                                                        ELC50PD
 17281          MOVE 'Y'                 TO WS-LF-CANCEL-SW.            ELC50PD
 17282                                                                  ELC50PD
 17283     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND                        ELC50PD
 17284        PB-C-AH-CANCEL-AMT = ZEROS                                ELC50PD
 17285          MOVE 'N'                 TO WS-AH-CANCEL-SW             ELC50PD
 17286      ELSE                                                        ELC50PD
 17287          MOVE 'Y'                 TO WS-AH-CANCEL-SW.            ELC50PD
 17288                                                                  ELC50PD
 17289     EVALUATE TRUE                                                ELC50PD
 17290         WHEN PB-CANCEL-FORCE             OR                      ELC50PD
 17291              PB-CANCEL-DATE-FORCED       OR                      ELC50PD
 17292              PB-FORCE-OFF                                        ELC50PD
 17293                  IF PB-COMPANY-ID = 'ACE'                        ELC50PD
 17294                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE     ELC50PD
 17295                  END-IF                                          ELC50PD
 17296         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR                   ELC50PD
 17297               PB-ALL-CANCEL-FORCED-NO-FEE)  AND                  ELC50PD
 17298              (PB-COMPANY-ID = 'ACE' )                            ELC50PD
 17299                  MOVE ZEROES TO PB-CI-CANCEL-FEE                 ELC50PD
 17300         WHEN OTHER                                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 313
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17301              IF PB-COMPANY-ID = 'ACE'                            ELC50PD
 17302                 MOVE ER-2794              TO WS-ERROR            ELC50PD
 17303              ELSE                                                ELC50PD
 17304                 MOVE ER-2749              TO WS-ERROR            ELC50PD
 17305              END-IF                                              ELC50PD
 17306              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 17307     END-EVALUATE.                                                ELC50PD
 17308                                                                  ELC50PD
 17309                                                                  ELC50PD
 17310*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 17311*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS              ELC50PD
 17312*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 17313*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT          ELC50PD
 17314*        ELSE                                                     ELC50PD
 17315*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.    ELC50PD
 17316                                                                  ELC50PD
 17317     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 17318     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 17319        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 17320     ELSE
 17321        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 17322     END-IF
 17323     .
 17324 3705-EDIT-CANCEL-DT.                                             ELC50PD
 17325                                                                  ELC50PD
 17326     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17327        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17328         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17329         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17330                                 TO DC-BIN-DATE-2                 ELC50PD
 17331         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17332*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17333         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17334         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17335            NEXT SENTENCE                                         ELC50PD
 17336          ELSE                                                    ELC50PD
 17337             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17338                IF PB-CANCEL-DATE-FORCED  OR                      ELC50PD
 17339                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17340                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17341                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17342                 ELSE                                             ELC50PD
 17343                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17344                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17345                                                                  ELC50PD
 17346     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17347        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17348         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17349         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17350                                 TO DC-BIN-DATE-2                 ELC50PD
 17351         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17352*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17353         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17354         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17355            NEXT SENTENCE                                         ELC50PD
 17356          ELSE                                                    ELC50PD
 17357             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17358                IF PB-CANCEL-DATE-FORCED OR                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 314
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17359                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17360                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17361                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17362                 ELSE                                             ELC50PD
 17363                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17364                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17365                                                                  ELC50PD
 17366     IF WS-ERROR = ER-2752                                        ELC50PD
 17367        AND (PB-COMPANY-ID = 'ABL'                                ELC50PD
 17368         OR  PB-COMPANY-ID = 'FGL'                                ELC50PD
 17369         OR  PB-COMPANY-ID = 'IST'                                ELC50PD
 17370         OR  PB-COMPANY-ID = 'JHL'                                ELC50PD
 17371         OR  PB-COMPANY-ID = 'LAP'                                ELC50PD
 17372         OR  PB-COMPANY-ID = 'LBL'                                ELC50PD
 17373         OR  PB-COMPANY-ID = 'NCB'                                ELC50PD
 17374         OR  PB-COMPANY-ID = 'NLI'                                ELC50PD
 17375         OR  PB-COMPANY-ID = 'OFI'                                ELC50PD
 17376         OR  PB-COMPANY-ID = 'PLI'                                ELC50PD
 17377         OR  PB-COMPANY-ID = 'TAO'                                ELC50PD
 17378         OR  PB-COMPANY-ID = 'TIC'                                ELC50PD
 17379         OR  PB-COMPANY-ID = 'HER'                                ELC50PD
 17380         OR  WS-LF-SPECIAL-CALC-CD = 'Z'                          ELC50PD
 17381         OR  WS-AH-SPECIAL-CALC-CD = 'Z')                         ELC50PD
 17382            SUBTRACT +1          FROM PB-NO-OF-ERRORS             ELC50PD
 17383            MOVE ER-2762     TO WS-ERROR                          ELC50PD
 17384            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17385                                                                  ELC50PD
 17386     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17387        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17388        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17389             MOVE ER-2733         TO WS-ERROR                     ELC50PD
 17390             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17391                                                                  ELC50PD
 17392     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17393        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17394        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17395              MOVE ER-2733        TO WS-ERROR                     ELC50PD
 17396              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17397                                                                  ELC50PD
 17398     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND                ELC50PD
 17399        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)                     ELC50PD
 17400        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND            ELC50PD
 17401           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)                 ELC50PD
 17402            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT         ELC50PD
 17403              IF PB-COMPANY-ID NOT = 'LAP'                        ELC50PD
 17404               MOVE ER-2704            TO WS-ERROR                ELC50PD
 17405               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.        ELC50PD
 17406                                                                  ELC50PD
 17407     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 17408         GO TO 3999-END-EDIT.                                     ELC50PD
 17409                                                                  ELC50PD
 17410     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17411        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 17412           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17413            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17414            MOVE PB-C-LF-CANCEL-DT                                ELC50PD
 17415                                 TO DC-BIN-DATE-2                 ELC50PD
 17416            SET ELAPSED-BETWEEN-BIN TO TRUE                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 315
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17417*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17418            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17419            IF DATE-CONVERSION-ERROR                              ELC50PD
 17420               NEXT SENTENCE                                      ELC50PD
 17421             ELSE                                                 ELC50PD
 17422                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17423                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.      ELC50PD
 17424                                                                  ELC50PD
 17425     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17426        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 17427           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17428            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17429            MOVE PB-C-AH-CANCEL-DT                                ELC50PD
 17430                                 TO DC-BIN-DATE-2                 ELC50PD
 17431            MOVE +0              TO DC-ELAPSED-DAYS               ELC50PD
 17432                                    DC-ELAPSED-MONTHS             ELC50PD
 17433            SET ELAPSED-BETWEEN-BIN  TO TRUE                      ELC50PD
 17434*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17435            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17436            IF DATE-CONVERSION-ERROR                              ELC50PD
 17437               NEXT SENTENCE                                      ELC50PD
 17438             ELSE                                                 ELC50PD
 17439                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17440                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.      ELC50PD
 17441                                                                  ELC50PD
 17442     MOVE +0                     TO DC-ELAPSED-DAYS               ELC50PD
 17443                                    DC-ELAPSED-MONTHS.            ELC50PD
 17444                                                                  ELC50PD
 17445     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR                         ELC50PD
 17446        (WS-AH-SPECIAL-CALC-CD = 'Z')                             ELC50PD
 17447          MOVE 'Z'                TO PB-CI-OB-FLAG                ELC50PD
 17448          MOVE ER-2767            TO WS-ERROR                     ELC50PD
 17449          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 17450          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC             ELC50PD
 17451          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC             ELC50PD
 17452          GO TO 3775-OVER-REF-CHK                                 ELC50PD
 17453        ELSE                                                      ELC50PD
 17454          MOVE ZEROS              TO PB-CI-LIVES                  ELC50PD
 17455                                     PB-C-LIVES                   ELC50PD
 17456          IF PB-CI-OB-FLAG NOT = 'B'                              ELC50PD
 17457             MOVE SPACE           TO PB-CI-OB-FLAG.               ELC50PD
 17458                                                                  ELC50PD
 17459     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 17460         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS          ELC50PD
 17461     ELSE                                                         ELC50PD
 17462         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.           ELC50PD
 17463                                                                  ELC50PD
 17464     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)         ELC50PD
 17465        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')     ELC50PD
 17466            MOVE ER-2760         TO WS-ERROR                      ELC50PD
 17467            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17468                                                                  ELC50PD
 17469     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17470        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17471         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17472            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17473               MOVE ER-2774       TO WS-ERROR                     ELC50PD
 17474               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 316
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17475                                                                  ELC50PD
 17476     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17477        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17478         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17479            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17480               MOVE ER-2775       TO WS-ERROR                     ELC50PD
 17481               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17482                                                                  ELC50PD
 17483     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17484        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17485         IF PB-C-LF-CANCEL-DT = LOW-VALUES                        ELC50PD
 17486            MOVE ER-2776         TO WS-ERROR                      ELC50PD
 17487            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17488                                                                  ELC50PD
 17489     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17490        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17491         IF PB-C-AH-CANCEL-DT = LOW-VALUES                        ELC50PD
 17492            MOVE ER-2777         TO WS-ERROR                      ELC50PD
 17493            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17494
 17495     IF LF-COVERAGE-CANCELLED
 17496        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 17497        if pb-ci-lf-expire-dt = low-values or spaces
 17498           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17499           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 17500           MOVE PB-CI-EXTENTION-DAYS
 17501                                 TO DC-ELAPSED-DAYS
 17502           SET BIN-PLUS-ELAPSED  TO TRUE
 17503           PERFORM 8500-DATE-CONVERT
 17504                                 THRU 8500-EXIT
 17505           IF DATE-CONVERSION-ERROR
 17506              move low-values    to dc-bin-date-2
 17507           end-if
 17508        else
 17509           move pb-ci-lf-expire-dt
 17510                                 to dc-bin-date-2
 17511        end-if
 17512        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 17513           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17514                             OR  'FIA'
 17515              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 17516           ELSE
 17517              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17518              MOVE ER-2731       TO WS-ERROR
 17519              PERFORM 9900-ERROR-FORMAT
 17520                                 THRU 9900-EXIT
 17521           end-if
 17522        end-if
 17523     end-if
 17524
 17525*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17526*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17527*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17528*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17529*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17530*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17531*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17532*        IF DATE-CONVERSION-ERROR                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 317
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17533*           NEXT SENTENCE                                         ELC50PD
 17534*         ELSE                                                    ELC50PD
 17535*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17536*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17537*                            OR  'FIA'                            ELC50PD
 17538*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT       ELC50PD
 17539*              ELSE                                               ELC50PD
 17540*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW      ELC50PD
 17541*               MOVE ER-2731       TO WS-ERROR                    ELC50PD
 17542*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17543     .
 17544 3705-EDIT-AH-CANCEL-DT.                                          ELC50PD
 17545
 17546     IF AH-COVERAGE-CANCELLED
 17547        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 17548        if pb-ci-AH-expire-dt = low-values or spaces
 17549           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17550           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 17551           MOVE PB-CI-EXTENTION-DAYS
 17552                                 TO DC-ELAPSED-DAYS
 17553           SET BIN-PLUS-ELAPSED  TO TRUE
 17554           PERFORM 8500-DATE-CONVERT
 17555                                 THRU 8500-EXIT
 17556           IF DATE-CONVERSION-ERROR
 17557              move low-values    to dc-bin-date-2
 17558           end-if
 17559        else
 17560           move pb-ci-ah-expire-dt
 17561                                 to dc-bin-date-2
 17562        end-if
 17563        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 17564           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17565                             OR  'FIA'
 17566              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 17567           ELSE
 17568              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17569              MOVE ER-2771       TO WS-ERROR
 17570              PERFORM 9900-ERROR-FORMAT
 17571                                 THRU 9900-EXIT
 17572           end-if
 17573        end-if
 17574     end-if
 17575
 17576*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17577*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17578*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17579*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17580*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17581**       MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17582*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17583*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17584*        IF DATE-CONVERSION-ERROR                                 ELC50PD
 17585*           NEXT SENTENCE                                         ELC50PD
 17586*         ELSE                                                    ELC50PD
 17587*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17588*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17589*                             OR 'FIA'                            ELC50PD
 17590*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 318
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17591*             ELSE                                                ELC50PD
 17592*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW       ELC50PD
 17593*              MOVE ER-2771       TO WS-ERROR                     ELC50PD
 17594*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17595     .
 17596 3705-EDIT-CONTINUED.                                             ELC50PD
 17597                                                                  ELC50PD
 17598*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17599*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17600*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT  ELC50PD
 17601*            MOVE ER-2727         TO WS-ERROR                     ELC50PD
 17602*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17603*                                                                 ELC50PD
 17604*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17605*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17606*        IF PB-COMPANY-ID = 'ACE'                                 ELC50PD
 17607*           MOVE ER-2727        TO WS-ERROR                       ELC50PD
 17608*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 17609*        ELSE                                                     ELC50PD
 17610*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DTELC50PD
 17611*              MOVE ER-2727     TO WS-ERROR                       ELC50PD
 17612*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17613                                                                  ELC50PD
 17614     IF PB-COMPANY-ID = 'ACE'                                     ELC50PD
 17615       IF AH-COVERAGE-CANCELLED                                   ELC50PD
 17616         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                 ELC50PD
 17617           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT   ELC50PD
 17618              MOVE ER-2732      TO WS-ERROR                       ELC50PD
 17619              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17620                                                                  ELC50PD
 17621     IF PB-COMPANY-ID      EQUAL   'HER'                          ELC50PD
 17622        IF WS-ERROR        EQUAL   ER-2727                        ELC50PD
 17623            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS          ELC50PD
 17624            MOVE  ER-2725          TO  WS-ERROR                   ELC50PD
 17625            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17626                                                                  ELC50PD
 17627     IF PB-C-CLAIM-CREATED-CANCEL                                 ELC50PD
 17628            MOVE ER-2748         TO WS-ERROR                      ELC50PD
 17629            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17630                                                                  ELC50PD
 17631     IF PB-C-LAST-NAME NOT = SPACES                               ELC50PD
 17632         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME                  ELC50PD
 17633            MOVE ER-2747         TO WS-ERROR                      ELC50PD
 17634            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17635                                                                  ELC50PD
 17636 3710-EDIT-LUMP-SUM-PRIOR.                                        ELC50PD
 17637                                                                  ELC50PD
 17638     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17639         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17640             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT    ELC50PD
 17641                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17642                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17643                                                                  ELC50PD
 17644     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17645         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17646             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT    ELC50PD
 17647                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17648                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 319
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17649                                                                  ELC50PD
 17650 3710-EDIT-PRIOR-DEATH.                                           ELC50PD
 17651                                                                  ELC50PD
 17652*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17653*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17654*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17655*           (NOT PB-CI-OB)                                        ELC50PD
 17656*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT           ELC50PD
 17657*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT    ELC50PD
 17658*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17659*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17660*                                                                 ELC50PD
 17661*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17662*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17663*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17664*           (NOT PB-CI-OB)                                        ELC50PD
 17665*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT           ELC50PD
 17666*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT    ELC50PD
 17667*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17668*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17669                                                                  ELC50PD
 17670     IF PB-CI-DEATH-DT NOT = LOW-VALUES                           ELC50PD
 17671         IF (PB-C-LF-CANCEL-AMT = ZERO) AND                       ELC50PD
 17672            (NOT PB-COMP-LF-CANCEL)                               ELC50PD
 17673             NEXT SENTENCE                                        ELC50PD
 17674         ELSE                                                     ELC50PD
 17675           IF PB-C-LF-CANCEL-VOIDED                               ELC50PD
 17676              NEXT SENTENCE                                       ELC50PD
 17677           ELSE                                                   ELC50PD
 17678              MOVE ER-2753      TO WS-ERROR                       ELC50PD
 17679              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17680                                                                  ELC50PD
 17681     IF CANCEL-FUTURE-DT                                          ELC50PD
 17682         GO TO 3999-END-EDIT.                                     ELC50PD
 17683                                                                  ELC50PD
 17684 3715-GET-REMAIN-TERM-LF.                                         ELC50PD
 17685                                                                  ELC50PD
 17686     IF NO-LF-BENEFIT-MATCH  OR                                   ELC50PD
 17687        WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 17688        GO TO 3730-GET-AH-REMAIN-TERM.                            ELC50PD
 17689                                                                  ELC50PD
 17690     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 17691     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17692     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17693     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17694     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17695     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17696     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 17697     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17698     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17699     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17700     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17701     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17702
 17703     IF (PB-COMPANY-ID = 'CID')
 17704        AND (CP-STATE-STD-ABBRV = 'WI')
 17705        MOVE '7'                 TO CP-REM-TERM-METHOD
 17706        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 320
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17707     ELSE
 17708        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17709        MOVE WS-REM-TRM-CALC-OPTION
 17710                                 TO CP-REM-TRM-CALC-OPTION
 17711     END-IF
 17712
 17713**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 17714     IF (PB-COMPANY-ID = 'CID')
 17715        AND (CP-STATE-STD-ABBRV = 'MO')
 17716        AND (PB-CERT-EFF-DT >= X'9B41')
 17717        AND (PB-CERT-EFF-DT <= X'A2FB')
 17718        MOVE '7'                 TO CP-REM-TERM-METHOD
 17719        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17720     END-IF
 17721
 17722     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17723                                    CP-LOAN-TERM.                 ELC50PD
 17724     IF CP-TRUNCATED-LIFE                                         ELC50PD
 17725        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.                 ELC50PD
 17726                                                                  ELC50PD
 17727     IF CP-TERM-IS-DAYS                                           ELC50PD
 17728         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS        ELC50PD
 17729     ELSE                                                         ELC50PD
 17730         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17731                                                                  ELC50PD
 17732     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.                ELC50PD
 17733                                                                  ELC50PD
 17734     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17735                                                                  ELC50PD
 17736     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17737        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17738        NEXT SENTENCE                                             ELC50PD
 17739      ELSE                                                        ELC50PD
 17740          GO TO 3730-GET-AH-REMAIN-TERM.                          ELC50PD
 17741                                                                  ELC50PD
 17742 3720-GET-LF-REFUND.                                              ELC50PD
 17743                                                                  ELC50PD
 17744     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 17745        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 17746        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 17747                                                                  ELC50PD
 17748     IF PB-COMPANY-ID EQUAL 'BOA'                                 ELC50PD
 17749         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17750         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17751         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17752                                                                  ELC50PD
 17753     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR                          ELC50PD
 17754        (WS-AH-SPECIAL-CALC-CD = 'M')                             ELC50PD
 17755         MOVE ER-2767            TO WS-ERROR                      ELC50PD
 17756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 17757         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17758         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17759         GO TO 3780-UPDATE-CANCEL-CERT.                           ELC50PD
 17760                                                                  ELC50PD
 17761     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 17762                                                                     CL**2
 17763     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 17764     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 321
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17765     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17766     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 17767     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 17768     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 17769
 17770     IF (PB-COMPANY-ID = 'DCC')
 17771        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17772
 17773        IF PDEF-MASTER-FOUND
 17774           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17775              (V1 > +8)
 17776              OR (PD-PROD-CODE (V1) = 'L')
 17777           END-PERFORM
 17778           IF V1 < +9
 17779              MOVE PD-MAX-AMT (V1)
 17780                           TO CP-R-MAX-TOT-BEN
 17781                              EC-AM-LF-MAX-TOT-BEN
 17782           END-IF
 17783        ELSE
 17784
 17785        MOVE ' '                 TO PDEF-MASTER-SW
 17786        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17787        MOVE PB-STATE            TO ERPDEF-STATE
 17788        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17789        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17790        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17791        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17792        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17793        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17794        IF PDEF-MASTER-FOUND
 17795           MOVE 'N'              TO PDEF-MASTER-SW
 17796           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17797           IF PDEF-MASTER-FOUND
 17798              IF (ERPDEF-KEY-SAVE (1:16) =
 17799                           PD-CONTROL-PRIMARY (1:16))
 17800                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17801                 CONTINUE
 17802              ELSE
 17803                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17804                 IF (ERPDEF-KEY-SAVE (1:16) =
 17805                           PD-CONTROL-PRIMARY (1:16))
 17806                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17807                    CONTINUE
 17808                 ELSE
 17809                    MOVE 'N'     TO PDEF-MASTER-SW
 17810                 END-IF
 17811              END-IF
 17812              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 17813
 17814              IF PDEF-MASTER-FOUND
 17815                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17816                    (V1 > +8)
 17817                    OR (PD-PROD-CODE (V1) = 'L')
 17818                 END-PERFORM
 17819                 IF V1 < +9
 17820                    MOVE PD-MAX-AMT (V1)
 17821                                 TO CP-R-MAX-TOT-BEN
 17822                                    EC-AM-LF-MAX-TOT-BEN
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 322
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17823                 END-IF
 17824              END-IF
 17825           END-IF
 17826           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17827        END-IF
 17828        END-IF
 17829     END-IF
 17830
 17831     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.               ELC50PD
 17832                                                                  ELC50PD
 17833     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.         ELC50PD
 17834                                                                  ELC50PD
 17835     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM                CL**2
 17836                                    PB-C-LF-REM-TERM.                CL**2
 17837                                                                     CL**2
 17838     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17839     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17840                                                                  ELC50PD
 17841     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17842        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17843           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK       ELC50PD
 17844           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT   ELC50PD
 17845                    + PB-CI-LF-ALT-PREMIUM-AMT)                   ELC50PD
 17846                    - CM-LF-ITD-DEATH-AMT                         ELC50PD
 17847           IF PB-C-LF-REF-CALC LESS THAN +0                       ELC50PD
 17848              MOVE +0            TO PB-C-LF-REF-CALC              ELC50PD
 17849              GO TO 3730-GET-AH-REMAIN-TERM                       ELC50PD
 17850           ELSE                                                   ELC50PD
 17851              GO TO 3730-GET-AH-REMAIN-TERM.                      ELC50PD
 17852                                                                  ELC50PD
 17853     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17854                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17855                            OR '9' OR 'G'
 17856        MOVE PB-C-LF-REFUND-OVERRIDE                              ELC50PD
 17857                                 TO CP-EARNING-METHOD.            ELC50PD
 17858                                                                  ELC50PD
 17859     if pb-company-id = 'AHL'
 17860        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 17861        if cp-class-code = spaces
 17862           move zeros            to cp-class-code
 17863        end-if
 17864     ELSE
 17865        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17866     END-IF
 17867
 17868*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17869     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17870     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17871                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17872     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17873         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17874                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17875     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17876     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
 17877     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 17878     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.            ELC50PD
 17879     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.              ELC50PD
 17880     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 323
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17881     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17882     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 17883         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 17884                                                                  ELC50PD
 17885****   N O T E   ****
 17886*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 17887*      THE OH HARD CODING IN ELCRFNDP
 17888
 17889     IF PB-COMPANY-ID = 'CID'
 17890        IF CP-STATE-STD-ABBRV = 'OH'
 17891           MOVE WS-LF-EARNINGS-CALC
 17892                                 TO CP-EARNING-METHOD
 17893        END-IF
 17894     END-IF
 17895
 17896****   N O T E   ****
 17897
 17898     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 17899         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 17900            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 17901                MOVE WS-DEFAULT-APR                               ELC50PD
 17902                                 TO  CP-LOAN-APR                  ELC50PD
 17903                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 17904                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17905            ELSE                                                  ELC50PD
 17906                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 17907                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17908
 17909     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 17910
 17911     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17912                                                                  ELC50PD
 17913     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 17914         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.           ELC50PD
 17915                                                                  ELC50PD
 17916     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17917        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17918        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17919        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17920                                                                  ELC50PD
 17921     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17922        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17923        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17924                                                                  ELC50PD
 17925     IF PB-COMPANY-ID = 'DCC'
 17926        AND PB-CI-ENTRY-STATUS = 'M'
 17927        MOVE +0                  TO PB-C-LF-REF-CALC
 17928     ELSE
 17929        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 17930     END-IF
 17931                                                                  ELC50PD
 17932     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 17933         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17934                                                                  ELC50PD
 17935*    IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 17936*       ADD +1                   TO PB-C-LF-REM-TERM              ELC50PD
 17937*                                   CP-REMAINING-TERM             ELC50PD
 17938*                                   CP-ORIGINAL-TERM.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 324
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17939                                                                  ELC50PD
 17940     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 17941     MOVE '2'                    TO CP-EARNING-METHOD             ELC50PD
 17942                                    CP-RATING-METHOD.             ELC50PD
 17943
 17944     IF PB-COMPANY-ID = 'CID'
 17945        IF (CP-STATE-STD-ABBRV = 'MN')
 17946           AND (PB-CERT-EFF-DT > X'A4FF')
 17947           AND (WS-LF-EARNINGS-CALC = 'B')
 17948           MOVE '5'              TO CP-EARNING-METHOD
 17949           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 17950        END-IF
 17951     END-IF
 17952
 17953     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT       ELC50PD
 17954                                        CP-REMAINING-BENEFIT      ELC50PD
 17955                                        CP-RATING-BENEFIT-AMT.    ELC50PD
 17956     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17957         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17958                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17959     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.      ELC50PD
 17960     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 17961                                                                  ELC50PD
 17962     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17963                                                                  ELC50PD
 17964     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17965        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17966        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17968                                                                  ELC50PD
 17969     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17970        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17971        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17972                                                                  ELC50PD
 17973     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.             ELC50PD
 17974                                                                  ELC50PD
 17975******************************************************************ELC50PD
 17976                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 325
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17978 3730-GET-AH-REMAIN-TERM.                                         ELC50PD
 17979     IF NO-AH-BENEFIT-MATCH  OR                                   ELC50PD
 17980        WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 17981         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 17982                                                                  ELC50PD
 17983     IF PB-CI-AH-LUMP-SUM-DISAB                                   ELC50PD
 17984         IF  PB-C-AH-CANCEL-AMT = ZERO                            ELC50PD
 17985            IF NOT PB-COMP-AH-CANCEL                              ELC50PD
 17986             GO TO 3770-CHECK-REFUNDS.                            ELC50PD
 17987                                                                  ELC50PD
 17988     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 17989     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17990     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17991     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17992     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17993     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17994     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 17995     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17996     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17997     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17998     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17999     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 18000
 18001     IF (PB-COMPANY-ID = 'CID')
 18002        AND (CP-STATE-STD-ABBRV = 'WI')
 18003        MOVE '7'                 TO CP-REM-TERM-METHOD
 18004        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18005     ELSE
 18006        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 18007        MOVE WS-REM-TRM-CALC-OPTION
 18008                                 TO CP-REM-TRM-CALC-OPTION
 18009     END-IF
 18010
 18011     IF (PB-COMPANY-ID = 'CID')
 18012        AND (CP-STATE-STD-ABBRV = 'MO')
 18013        AND (PB-CERT-EFF-DT >= X'9B41')
 18014        AND (PB-CERT-EFF-DT <= X'A2FB')
 18015        MOVE '7'                 TO CP-REM-TERM-METHOD
 18016        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18017     END-IF
 18018
 18019     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 18020                                    CP-LOAN-TERM.                 ELC50PD
 18021     IF NOT CP-TERM-IS-DAYS                                       ELC50PD
 18022         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 18023                                                                  ELC50PD
 18024     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.                 ELC50PD
 18025                                                                  ELC50PD
 18026     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 18027                                                                  ELC50PD
 18028     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 18029        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 18030        NEXT SENTENCE                                             ELC50PD
 18031      ELSE                                                        ELC50PD
 18032         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18033                                                                  ELC50PD
 18034 3740-GET-AH-REFUND.                                              ELC50PD
 18035                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 326
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18036     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 18037        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 18038        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18039                                                                  ELC50PD
 18040     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 18041         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 18042         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18043                                                                  ELC50PD
 18044     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1                 ELC50PD
 18045*    MOVE ' '                    TO DC-OPTION-CODE                ELC50PD
 18046     SET BIN-TO-GREG             TO TRUE                          ELC50PD
 18047     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 18048     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM             ELC50PD
 18049                                    PB-C-AH-REM-TERM.             ELC50PD
 18050     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 18051     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 18052                                                                  ELC50PD
 18053     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 18054        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 18055           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK       ELC50PD
 18056           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT   ELC50PD
 18057                    - CM-AH-ITD-AH-PMT)                           ELC50PD
 18058           IF PB-C-AH-REF-CALC LESS THAN +0                       ELC50PD
 18059              MOVE +0            TO PB-C-AH-REF-CALC              ELC50PD
 18060              GO TO 3770-CHECK-REFUNDS                            ELC50PD
 18061           ELSE                                                   ELC50PD
 18062              GO TO 3770-CHECK-REFUNDS.                           ELC50PD
 18063                                                                  ELC50PD
 18064     IF PB-COMPANY-ID = 'DCC'
 18065        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18066            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 18067           MOVE 'S'              TO CP-EARNING-METHOD
 18068        END-IF
 18069     END-IF
 18070
 18071     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 18072                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 18073                            OR '9' OR 'G' OR 'S'
 18074        MOVE PB-C-AH-REFUND-OVERRIDE                              ELC50PD
 18075                                 TO CP-EARNING-METHOD.            ELC50PD
 18076                                                                  ELC50PD
 18077     if pb-company-id = 'AHL'
 18078        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 18079        if cp-class-code = spaces
 18080           move zeros            to cp-class-code
 18081        end-if
 18082     ELSE
 18083        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 18084     END-IF
 18085*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 18086     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 18087     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 18088                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 18089     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 18090         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *   ELC50PD
 18091                                         PB-CI-AH-TERM.           ELC50PD
 18092     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 18093     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 327
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18094     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 18095     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.            ELC50PD
 18096     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.              ELC50PD
 18097     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 18098                                                                  ELC50PD
 18099     IF CP-STATE-STD-ABBRV = 'OH'                                 ELC50PD
 18100        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'     ELC50PD
 18101                                AND 'CID' AND 'DCC' AND 'AHL')
 18102           IF (CP-ORIGINAL-TERM GREATER 60) AND                   ELC50PD
 18103              (DC-GREG-DATE-CYMD GREATER 19831101) AND               CL**4
 18104              (PB-CI-LF-BENEFIT-CD NOT = ZERO)                    ELC50PD
 18105              MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18106           END-IF
 18107        END-IF
 18108        IF PB-COMPANY-ID = 'CID'
 18109           IF NO-LIFE-COVERAGE
 18110              IF CP-CRITICAL-PERIOD
 18111                 MOVE '2'       TO CP-EARNING-METHOD
 18112              ELSE
 18113                 MOVE '6'       TO CP-EARNING-METHOD
 18114              END-IF
 18115           ELSE
 18116              IF WS-LF-COVERAGE-TYPE = 'L'
 18117                 MOVE '2'       TO CP-EARNING-METHOD
 18118              ELSE
 18119                 IF (PB-CI-LF-TERM > +60) OR                      ELC50PD
 18120                    (WS-LF-EARNINGS-CALC = '5')
 18121                    IF CP-CRITICAL-PERIOD
 18122                       MOVE '2'  TO CP-EARNING-METHOD
 18123                    ELSE
 18124                       MOVE '6'  TO CP-EARNING-METHOD
 18125                    END-IF
 18126                 ELSE
 18127                    MOVE '1'     TO CP-EARNING-METHOD
 18128                 END-IF
 18129              END-IF
 18130           END-IF
 18131        END-IF
 18132     END-IF
 18133                                                                  ELC50PD
 18134*    IF CP-STATE-STD-ABBRV = 'VA'                                 ELC50PD
 18135*       IF DC-GREG-DATE-CYMD GREATER 19921231                        CL**4
 18136*          IF CP-ORIGINAL-TERM GREATER 61                         ELC50PD
 18137*             MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18138*          ELSE                                                   ELC50PD
 18139*             MOVE '1' TO CP-EARNING-METHOD.                      ELC50PD
 18140                                                                  ELC50PD
 18141     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 18142         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 18143                                                                  ELC50PD
 18144     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 18145         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 18146            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 18147                MOVE WS-DEFAULT-APR                               ELC50PD
 18148                                 TO  CP-LOAN-APR                  ELC50PD
 18149                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 18150                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 18151            ELSE                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 328
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18152                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 18153                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 18154
 18155     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 18156
 18157
 18158     IF PB-COMPANY-ID = 'DCC'
 18159        AND CP-CANCEL-REASON = 'R'
 18160        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18161        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 18162     END-IF
 18163
 18164     IF PB-COMPANY-ID = 'DCC'
 18165        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18166        AND (CP-EARNING-METHOD = 'D')
 18167        AND (CP-CANCEL-REASON NOT = 'R')
 18168        CONTINUE
 18169     ELSE
 18170        GO TO 3750-CONTINUE
 18171     END-IF
 18172
 18173     MOVE ' '                    TO DD-IU-SW
 18174     IF NOT PDEF-MASTER-FOUND
 18175        MOVE ' '                 TO PDEF-MASTER-SW
 18176        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 18177        MOVE PB-STATE            TO ERPDEF-STATE
 18178        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 18179        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 18180        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 18181        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 18182        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 18183        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 18184        IF PDEF-MASTER-FOUND
 18185           MOVE 'N'              TO PDEF-MASTER-SW
 18186           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18187           IF PDEF-MASTER-FOUND
 18188              IF (ERPDEF-KEY-SAVE (1:16) =
 18189                           PD-CONTROL-PRIMARY (1:16))
 18190                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18191                 CONTINUE
 18192              ELSE
 18193                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18194                 IF (ERPDEF-KEY-SAVE (1:16) =
 18195                           PD-CONTROL-PRIMARY (1:16))
 18196                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18197                    CONTINUE
 18198                 ELSE
 18199                    MOVE ER-2740 TO WS-ERROR
 18200                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18201                    GO TO 3770-CHECK-REFUNDS
 18202                 END-IF
 18203              END-IF
 18204           END-IF
 18205           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 18206        END-IF
 18207     END-IF
 18208
 18209     IF PDEF-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 329
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18210        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 18211           (V1 > +8)
 18212           OR (PD-PROD-CODE (V1) = 'I')
 18213        END-PERFORM
 18214        IF V1 < +9
 18215           SET DD-IU-PRESENT        TO TRUE
 18216        END-IF
 18217        IF WS-AH-DCC-TRUNC = 'T'
 18218           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 18219        ELSE
 18220           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 18221        END-IF
 18222        EVALUATE TRUE
 18223           WHEN WS-TERM > +168
 18224              MOVE 15               TO V1
 18225           WHEN WS-TERM > +156
 18226              MOVE 14               TO V1
 18227           WHEN WS-TERM > +144
 18228              MOVE 13               TO V1
 18229           WHEN WS-TERM > +132
 18230              MOVE 12               TO V1
 18231           WHEN WS-TERM > +120
 18232              MOVE 11               TO V1
 18233           WHEN WS-TERM > +108
 18234              MOVE 10               TO V1
 18235           WHEN WS-TERM > +96
 18236              MOVE 9                TO V1
 18237           WHEN WS-TERM > +84
 18238              MOVE 8                TO V1
 18239           WHEN WS-TERM > +72
 18240              MOVE 7                TO V1
 18241           WHEN WS-TERM > +60
 18242              MOVE 6                TO V1
 18243           WHEN WS-TERM > +48
 18244              MOVE 5                TO V1
 18245           WHEN WS-TERM > +36
 18246              MOVE 4                TO V1
 18247           WHEN WS-TERM > +24
 18248              MOVE 3                TO V1
 18249           WHEN WS-TERM > +12
 18250              MOVE 2                TO V1
 18251           WHEN OTHER
 18252              MOVE 1                TO V1
 18253        END-EVALUATE
 18254
 18255        EVALUATE TRUE
 18256*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 18257*             < +13)
 18258*             AND (DD-IU-PRESENT)
 18259*             MOVE 2                TO V2
 18260*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 18261*             MOVE 1                TO V2
 18262           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 18263              MOVE 2                TO V2
 18264           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 18265              MOVE 3                TO V2
 18266           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 18267              MOVE 4                TO V2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 330
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18268           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 18269              MOVE 5                TO V2
 18270           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 18271              MOVE 6                TO V2
 18272           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 18273              MOVE 7                TO V2
 18274           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 18275              MOVE 8                TO V2
 18276           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 18277              MOVE 9                TO V2
 18278           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 18279              MOVE 10               TO V2
 18280           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 18281              MOVE 11               TO V2
 18282           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 18283              MOVE 12               TO V2
 18284           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 18285              MOVE 13               TO V2
 18286           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 18287              MOVE 14               TO V2
 18288           WHEN OTHER
 18289              MOVE 15               TO V2
 18290        END-EVALUATE
 18291
 18292        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 18293                                 TO CP-DDF-LO-FACT
 18294        MOVE PD-UEP-FACTOR (V1 V2)
 18295                                 TO CP-DDF-HI-FACT
 18296
 18297        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 18298        MOVE CM-AH-CLP     TO CP-DDF-CLP
 18299
 18300        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 18301           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 18302        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 18303        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 18304
 18305        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 18306           + PD-1ST-YR-ADMIN-ALLOW
 18307
 18308        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18309*       IF PI-CLP-YN = 'Y'
 18310*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 18311*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 18312*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 18313*       END-IF
 18314
 18315        IF DD-IU-PRESENT
 18316           MOVE 'I'              TO CP-EARNING-METHOD
 18317        END-IF
 18318        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18319                                     CP-CLP-RATE-UP
 18320        IF CP-IU-RATE-UP NOT = ZEROS
 18321           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 18322              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 18323           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 18324              / (1 - WS-WORK-FACT)
 18325        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 331
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18326     END-IF
 18327
 18328     .
 18329 3750-CONTINUE.
 18330
 18331     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 18332                                                                  ELC50PD
 18333     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 18334         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.           ELC50PD
 18335                                                                  ELC50PD
 18336     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18337        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18338        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18339        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18340                                                                  ELC50PD
 18341     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18342        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18343        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18344
 18345     IF PB-COMPANY-ID = 'DCC'
 18346        AND PB-CI-ENTRY-STATUS = 'M'
 18347        MOVE +0                  TO PB-C-AH-REF-CALC
 18348     ELSE
 18349        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 18350     END-IF
 18351
 18352     IF PB-COMPANY-ID = 'DCC'
 18353        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18354        AND (CP-EARNING-METHOD = 'D' OR 'I')
 18355        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18356        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 18357        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 18358        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 18359        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 18360        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 18361        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 18362     END-IF
 18363
 18364     GO TO 3770-CHECK-REFUNDS.                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 332
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18366                                                                  ELC50PD
 18367 3770-CHECK-REFUNDS.                                              ELC50PD
 18368                                                                  ELC50PD
 18369     IF PB-CI-LF-CANCEL-AMT NOT = ZERO                            ELC50PD
 18370        IF PB-C-LF-CANCEL-VOID-SW = SPACE                         ELC50PD
 18371           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18372           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18373           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC     ELC50PD
 18374           IF PB-C-LF-REF-CALC LESS THAN ZERO                     ELC50PD
 18375              MOVE ZEROS         TO PB-C-LF-REF-CALC.             ELC50PD
 18376                                                                  ELC50PD
 18377     IF PB-CI-AH-CANCEL-AMT NOT = ZERO                            ELC50PD
 18378        IF PB-C-AH-CANCEL-VOID-SW = SPACE                         ELC50PD
 18379           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18380           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18381           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC     ELC50PD
 18382           IF PB-C-AH-REF-CALC LESS THAN ZERO                     ELC50PD
 18383              MOVE ZEROS         TO PB-C-AH-REF-CALC.             ELC50PD
 18384                                                                  ELC50PD
 18385     IF PB-COMP-LF-CANCEL                                         ELC50PD
 18386        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT            ELC50PD
 18387        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18388           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18389              MOVE +0            TO  PB-C-LF-CANCEL-AMT.          ELC50PD
 18390                                                                  ELC50PD
 18391     IF PB-COMP-AH-CANCEL                                         ELC50PD
 18392        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT            ELC50PD
 18393        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18394           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18395              MOVE +0            TO  PB-C-AH-CANCEL-AMT.          ELC50PD
 18396                                                                  ELC50PD
 18397     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT               CL**2
 18398             GIVING WS-UNSIGN-WRK1                                ELC50PD
 18399     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT               CL**2
 18400             GIVING WS-UNSIGN-WRK2.                               ELC50PD
 18401                                                                  ELC50PD
 18402     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18403         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 18404                                                                  ELC50PD
 18405     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 18406         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 18407                                                                  ELC50PD
 18408     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.        CL**2
 18409                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 333
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18411                                                                  ELC50PD
 18412 3772-CONTINUE.                                                   ELC50PD
 18413                                                                  ELC50PD
 18414**********************************                                ELC50PD
 18415*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE  ELC50PD
 18416*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE     ELC50PD
 18417*** DOUBLES THE TOLERANCE AMOUNT.                                 ELC50PD
 18418***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL. ELC50PD
 18419**********************************                                ELC50PD
 18420     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 18421     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND              ELC50PD
 18422         IF WS-REF-REJECT-SW = SPACE                              ELC50PD
 18423             MOVE ER-2754        TO WS-ERROR                      ELC50PD
 18424             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 18425           ELSE                                                   ELC50PD
 18426             MOVE ER-2736        TO WS-ERROR                      ELC50PD
 18427             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18428**********************************                                ELC50PD
 18429                                                                  ELC50PD
 18430 3773-CONTINUE.                                                   ELC50PD
 18431                                                                  ELC50PD
 18432     IF PB-C-LF-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18433        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18434           MOVE ER-2723          TO WS-ERROR                      ELC50PD
 18435           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18436                                                                  ELC50PD
 18437     IF PB-C-AH-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18438        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18439           MOVE ER-2724          TO WS-ERROR                      ELC50PD
 18440           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18441                                                                  ELC50PD
 18442     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18443         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *     ELC50PD
 18444             (1 + WS-LF-REFUND-OVS-PCT)                           ELC50PD
 18445     ELSE                                                         ELC50PD
 18446         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.     ELC50PD
 18447                                                                  ELC50PD
 18448     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS                ELC50PD
 18449         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *     ELC50PD
 18450             (1 - WS-TOL-LF-REFUND-PCT)                           ELC50PD
 18451     ELSE                                                         ELC50PD
 18452         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
 18453                                                                  ELC50PD
 18454     IF (PB-COMPANY-ID = 'DCC')
 18455        AND (PB-CI-ENTRY-STATUS = 'M')
 18456        AND (PB-C-LF-CANCEL-AMT > +0)
 18457        MOVE ER-3843             TO WS-ERROR
 18458        PERFORM 9900-ERROR-FORMAT
 18459                                 THRU 9900-EXIT
 18460     END-IF
 18461     EVALUATE TRUE                                                ELC50PD
 18462        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18463           CONTINUE                                               ELC50PD
 18464        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18465                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18466           CONTINUE                                               ELC50PD
 18467        WHEN WS-LF-REFUND-OVS-AMT = 0                             ELC50PD
 18468                 AND WS-TOL-LF-REFUND = 0                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 334
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18469           CONTINUE                                               ELC50PD
 18470        WHEN OTHER                                                ELC50PD
 18471           IF WS-TOL-LF-REFUND  = +0                              ELC50PD
 18472              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND           ELC50PD
 18473           END-IF                                                 ELC50PD
 18474           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18475                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <          ELC50PD
 18476                          (PB-C-LF-CANCEL-AMT))                   ELC50PD
 18477              CONTINUE                                            ELC50PD
 18478           ELSE                                                   ELC50PD
 18479              IF WS-LF-REFUND-OVS-AMT = +0                        ELC50PD
 18480                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT    ELC50PD
 18481              END-IF                                              ELC50PD
 18482              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18483                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >     ELC50PD
 18484                                       PB-C-LF-CANCEL-AMT)        ELC50PD
 18485                 CONTINUE                                         ELC50PD
 18486              ELSE                                                ELC50PD
 18487                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18488                   MOVE ER-2754   TO  WS-ERROR                    ELC50PD
 18489                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 18490                 ELSE                                             ELC50PD
 18491                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18492                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18493                 END-IF                                           ELC50PD
 18494              END-IF                                              ELC50PD
 18495           END-IF                                                 ELC50PD
 18496     END-EVALUATE.                                                ELC50PD
 18497                                                                  ELC50PD
 18498     EVALUATE TRUE                                                ELC50PD
 18499        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18500           CONTINUE                                               ELC50PD
 18501        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18502                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18503           CONTINUE                                               ELC50PD
 18504        WHEN OTHER                                                ELC50PD
 18505           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18506               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))     ELC50PD
 18507              CONTINUE                                            ELC50PD
 18508           ELSE                                                   ELC50PD
 18509              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18510               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))    ELC50PD
 18511                CONTINUE                                          ELC50PD
 18512              ELSE                                                ELC50PD
 18513                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18514                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18515                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18516                 ELSE                                             ELC50PD
 18517                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18518                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18519                 END-IF                                           ELC50PD
 18520              END-IF                                              ELC50PD
 18521           END-IF                                                 ELC50PD
 18522     END-EVALUATE.                                                ELC50PD
 18523                                                                  ELC50PD
 18524     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18525         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *     ELC50PD
 18526             (1 + WS-AH-REFUND-OVS-PCT)                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 335
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18527     ELSE                                                         ELC50PD
 18528         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.     ELC50PD
 18529                                                                  ELC50PD
 18530     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS                   ELC50PD
 18531         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *     ELC50PD
 18532             (1 - WS-TOL-AH-REFUND-PCT)                           ELC50PD
 18533     ELSE                                                         ELC50PD
 18534         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
 18535                                                                  ELC50PD
 18536     IF (PB-COMPANY-ID = 'DCC')
 18537        AND (PB-CI-ENTRY-STATUS = 'M')
 18538        AND (PB-C-AH-CANCEL-AMT > +0)
 18539        MOVE ER-3843             TO WS-ERROR
 18540        PERFORM 9900-ERROR-FORMAT
 18541                                 THRU 9900-EXIT
 18542     END-IF
 18543     EVALUATE TRUE                                                ELC50PD
 18544        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
 18545           CONTINUE                                               ELC50PD
 18546*       WHEN PB-C-AH-REF-CALC = +0 AND                            ELC50PD
 18547*                  PB-C-AH-CANCEL-AMT > +0                        ELC50PD
 18548        WHEN PB-C-AH-CANCEL-AMT = +0 AND                          ELC50PD
 18549                   PB-C-AH-REF-CALC > +0                          ELC50PD
 18550           CONTINUE                                               ELC50PD
 18551        WHEN WS-AH-REFUND-OVS-AMT = +0                            ELC50PD
 18552                AND WS-TOL-AH-REFUND = +0                         ELC50PD
 18553           CONTINUE                                               ELC50PD
 18554        WHEN OTHER                                                ELC50PD
 18555           IF WS-TOL-AH-REFUND = +0                               ELC50PD
 18556              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND           ELC50PD
 18557           END-IF                                                 ELC50PD
 18558           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND        ELC50PD
 18559               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <            ELC50PD
 18560                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18561              CONTINUE                                            ELC50PD
 18562           ELSE                                                   ELC50PD
 18563              IF WS-AH-REFUND-OVS-AMT = +0                        ELC50PD
 18564                 MOVE +9999999.99 TO                              ELC50PD
 18565                         WS-AH-REFUND-OVS-AMT                     ELC50PD
 18566              END-IF                                              ELC50PD
 18567              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18568                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >     ELC50PD
 18569                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18570                 CONTINUE                                         ELC50PD
 18571              ELSE                                                ELC50PD
 18572                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18573                    MOVE ER-2754   TO  WS-ERROR                   ELC50PD
 18574                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18575                 ELSE                                             ELC50PD
 18576                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18577                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18578                 END-IF                                           ELC50PD
 18579              END-IF                                              ELC50PD
 18580           END-IF                                                 ELC50PD
 18581     END-EVALUATE.                                                ELC50PD
 18582                                                                  ELC50PD
 18583     EVALUATE TRUE                                                ELC50PD
 18584        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 336
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18585           CONTINUE                                               ELC50PD
 18586*       WHEN PB-C-AH-REF-CALC > +0 AND                            ELC50PD
 18587*                  PB-C-AH-CANCEL-AMT = +0                        ELC50PD
 18588        WHEN PB-C-AH-CANCEL-AMT > +0 AND                          ELC50PD
 18589                   PB-C-AH-REF-CALC = +0                          ELC50PD
 18590           CONTINUE                                               ELC50PD
 18591        WHEN OTHER                                                ELC50PD
 18592           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND       ELC50PD
 18593               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))     ELC50PD
 18594              CONTINUE                                            ELC50PD
 18595           ELSE                                                   ELC50PD
 18596              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18597                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))   ELC50PD
 18598                 CONTINUE                                         ELC50PD
 18599              ELSE                                                ELC50PD
 18600                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18601                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18602                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18603                 ELSE                                             ELC50PD
 18604                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18605                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18606                 END-IF                                           ELC50PD
 18607              END-IF                                              ELC50PD
 18608           END-IF                                                 ELC50PD
 18609     END-EVALUATE.                                                ELC50PD
 18610                                                                  ELC50PD
 18611     IF (PB-C-LF-CANCEL-AMT = ZERO)
 18612        AND (PB-C-AH-CANCEL-AMT = ZERO)
 18613        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 18614           AND  PB-C-LF-REF-CALC < +1.00
 18615           AND  PB-C-AH-REF-CALC < +1.00
 18616           CONTINUE
 18617        ELSE
 18618           IF (PB-COMPANY-ID = 'DCC')
 18619              AND (PB-CI-ENTRY-STATUS = 'M')
 18620              CONTINUE
 18621           ELSE
 18622              MOVE ER-2741       TO WS-ERROR
 18623              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18624           END-IF
 18625        END-IF
 18626     END-IF
 18627                                                                  ELC50PD
 18628     IF (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18629        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18630        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED                      ELC50PD
 18631        AND PB-C-LF-REF-CALC NOT = ZERO)                          ELC50PD
 18632        OR                                                        ELC50PD
 18633        (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18634        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18635        AND PB-C-LF-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18636             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18637                AND PB-C-LF-REF-CALC LESS THAN +1.00              ELC50PD
 18638                NEXT SENTENCE                                     ELC50PD
 18639             ELSE                                                 ELC50PD
 18640                MOVE ER-2739        TO WS-ERROR                   ELC50PD
 18641                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18642                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 337
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18643     IF (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18644        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18645        AND NOT PB-CI-AH-LUMP-SUM-DISAB                           ELC50PD
 18646        AND PB-C-AH-REF-CALC NOT = ZERO)                          ELC50PD
 18647        OR                                                        ELC50PD
 18648        (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18649        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18650        AND PB-C-AH-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18651             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18652                AND PB-C-AH-REF-CALC LESS THAN +1.00              ELC50PD
 18653                NEXT SENTENCE                                     ELC50PD
 18654             ELSE                                                 ELC50PD
 18655                MOVE ER-2738        TO WS-ERROR                   ELC50PD
 18656                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18657                                                                  ELC50PD
 18658 3775-OVER-REF-CHK.                                               ELC50PD
 18659                                                                  ELC50PD
 18660     IF PB-CI-ENTRY-STATUS = '5'                                  ELC50PD
 18661        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18662                                                                  ELC50PD
 18663     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +              ELC50PD
 18664                              PB-CI-LF-ALT-PREMIUM-AMT.           ELC50PD
 18665                                                                  ELC50PD
 18666     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18667        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18668                                 PB-C-LF-REF-CALC                 ELC50PD
 18669      ELSE                                                        ELC50PD
 18670        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18671                                 PB-C-LF-CANCEL-AMT.              ELC50PD
 18672                                                                  ELC50PD
 18673     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18674        MOVE ER-2755             TO WS-ERROR                      ELC50PD
 18675        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18676                                                                  ELC50PD
 18677     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.               ELC50PD
 18678                                                                  ELC50PD
 18679     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 18680        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18681                                 PB-C-AH-REF-CALC                 ELC50PD
 18682      ELSE                                                        ELC50PD
 18683        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18684                                 PB-C-AH-CANCEL-AMT.              ELC50PD
 18685                                                                  ELC50PD
 18686     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18687        MOVE ER-2778             TO WS-ERROR                      ELC50PD
 18688        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18689                                                                  ELC50PD
 18690     IF PB-CI-OB-FLAG NOT = 'Z'                                   ELC50PD
 18691        NEXT SENTENCE                                             ELC50PD
 18692       ELSE                                                       ELC50PD
 18693         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                  ELC50PD
 18694            MOVE ER-2757           TO WS-ERROR                    ELC50PD
 18695            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 18696                                                                  ELC50PD
 18697 3780-UPDATE-CANCEL-CERT.                                         ELC50PD
 18698                                                                  ELC50PD
 18699     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'                         ELC50PD
 18700        MOVE ER-2728              TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 338
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18701        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18702                                                                  ELC50PD
 18703     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'                         ELC50PD
 18704         MOVE ER-2729              TO WS-ERROR                    ELC50PD
 18705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 18706                                                                  ELC50PD
 18707     IF PB-CI-LF-BENEFIT-CD = ZERO                                ELC50PD
 18708         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18709                                                                  ELC50PD
 18710     IF PB-C-LF-CANCEL-DT = LOW-VALUE                             ELC50PD
 18711         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18712                                                                  ELC50PD
 18713     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18714       AND                                                        ELC50PD
 18715        (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18716       AND                                                        ELC50PD
 18717        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18718       AND                                                        ELC50PD
 18719        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)       ELC50PD
 18720            NEXT SENTENCE                                         ELC50PD
 18721       ELSE                                                       ELC50PD
 18722        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18723          AND                                                     ELC50PD
 18724***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18725***       AND                                                     ELC50PD
 18726           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)     ELC50PD
 18727            IF PB-C-LF-CANCEL-VOID-SW = SPACE                     ELC50PD
 18728               MOVE ER-2730      TO WS-ERROR                      ELC50PD
 18729               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18730               GO TO 3999-END-EDIT                                ELC50PD
 18731            ELSE                                                  ELC50PD
 18732               GO TO 3999-END-EDIT                                ELC50PD
 18733        ELSE                                                      ELC50PD
 18734            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT       ELC50PD
 18735               MOVE ER-2765           TO WS-ERROR                 ELC50PD
 18736               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18737               GO TO 3785-CHECK-NH.
 18738*              GO TO 3999-END-EDIT.                               ELC50PD
 18739                                                                  ELC50PD
 18740 3780-UPDATE-CONT-1.                                              ELC50PD
 18741     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 18742                                                                  ELC50PD
 18743     IF PB-CI-AH-BENEFIT-CD = ZERO                                ELC50PD
 18744         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18745                                                                  ELC50PD
 18746     IF PB-C-AH-CANCEL-DT = LOW-VALUE                             ELC50PD
 18747         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18748
 18749     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 18750                                                                  ELC50PD
 18751     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18752       AND                                                        ELC50PD
 18753        (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18754       AND                                                        ELC50PD
 18755        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18756       AND                                                        ELC50PD
 18757        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)       ELC50PD
 18758            NEXT SENTENCE                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 339
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18759       ELSE                                                       ELC50PD
 18760        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18761          AND                                                     ELC50PD
 18762***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18763***       AND                                                     ELC50PD
 18764           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)     ELC50PD
 18765           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 18766            IF PB-C-AH-CANCEL-VOID-SW = SPACE                     ELC50PD
 18767               MOVE ER-2773      TO WS-ERROR                      ELC50PD
 18768               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18769               GO TO 3999-END-EDIT                                ELC50PD
 18770            ELSE                                                  ELC50PD
 18771               GO TO 3999-END-EDIT                                ELC50PD
 18772            END-IF
 18773           ELSE
 18774             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18775                MOVE ER-2890 TO WS-ERROR
 18776                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18777                GO TO 3999-END-EDIT
 18778             ELSE
 18779                GO TO 3785-CHECK-NH
 18780             END-IF
 18781           END-IF
 18782          ELSE                                                    ELC50PD
 18783            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT       ELC50PD
 18784              IF WS-AH-CLAIM-RESCINDED = 'Y'
 18785                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18786                   MOVE ER-2890 TO WS-ERROR
 18787                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18788                   GO TO 3999-END-EDIT
 18789                ELSE
 18790                   MOVE ER-2765 TO WS-ERROR
 18791                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18792                   GO TO 3785-CHECK-NH
 18793                END-IF
 18794              ELSE
 18795               MOVE ER-2765      TO WS-ERROR                      ELC50PD
 18796               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18797               GO TO 3785-CHECK-NH.
 18798*              GO TO 3999-END-EDIT.                               ELC50PD
 18799                                                                  ELC50PD
 18800 3780-UPDATE-CONT-2.                                              ELC50PD
 18801                                                                  ELC50PD
 18802     IF PB-C-LF-CANCEL-AMT NOT = ZERO                             ELC50PD
 18803        AND WS-LF-BENEFIT-CD = ZERO                               ELC50PD
 18804           MOVE ER-2743           TO WS-ERROR                     ELC50PD
 18805           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18806                                                                  ELC50PD
 18807     IF PB-C-AH-CANCEL-AMT NOT = ZERO                             ELC50PD
 18808        AND WS-AH-BENEFIT-CD = ZERO                               ELC50PD
 18809           MOVE ER-2744           TO WS-ERROR                     ELC50PD
 18810           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18811                                                                  ELC50PD
 18812     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR                         ELC50PD
 18813        (PB-C-AH-CANCEL-AMT NEGATIVE))                            ELC50PD
 18814        AND                                                       ELC50PD
 18815        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR                 ELC50PD
 18816         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 340
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18817           MOVE ER-2746           TO WS-ERROR                     ELC50PD
 18818           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18819                                                                  ELC50PD
 18820     IF (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18821       AND                                                        ELC50PD
 18822        (PB-C-LF-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18823             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18824             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18825                                                                  ELC50PD
 18826     IF (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18827       AND                                                        ELC50PD
 18828        (PB-C-AH-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18829             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18830             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18831                                                                  ELC50PD
 18832     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0                       ELC50PD
 18833         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 18834             OR 'CID' OR 'DCC' OR 'AHL'
 18835             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT      ELC50PD
 18836         ELSE                                                     ELC50PD
 18837             IF PB-COMPANY-ID = 'FIA' OR 'MTL'                       CL**2
 18838                 MOVE ER-2768    TO WS-ERROR                      ELC50PD
 18839                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 18840             ELSE                                                 ELC50PD
 18841                 MOVE ER-2756    TO WS-ERROR                      ELC50PD
 18842                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 18843                                                                  ELC50PD
 18844     IF CERT-PEND-ISSUE-RETURNED                                  ELC50PD
 18845        MOVE ER-2772             TO WS-ERROR                      ELC50PD
 18846        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18847
 18848 3785-CHECK-NH.
 18849
 18850     IF PB-STATE NOT = 'NH'
 18851        GO TO 3999-END-EDIT
 18852     END-IF
 18853
 18854     MOVE ER-2796                TO WS-ERROR
 18855     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 18856
 18857     IF (PB-C-REF-INTERFACE-SW = 'Y')
 18858        OR (CM-NH-INTERFACE-SW = 'Y')
 18859        MOVE ER-2793             TO WS-ERROR
 18860        PERFORM 9900-ERROR-FORMAT
 18861                                 THRU 9900-EXIT
 18862     END-IF
 18863
 18864     MOVE +0                     TO WS-PAYMENT-AMT
 18865     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 18866        GO TO 3999-END-EDIT
 18867     END-IF
 18868
 18869     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 18870        GO TO 3999-END-EDIT
 18871     END-IF
 18872
 18873     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 18874     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 341
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18875
 18876     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 18877        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 18878     END-IF
 18879     MOVE '1'                    TO DC-OPTION-CODE
 18880     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18881     IF NO-CONVERSION-ERROR
 18882        IF DC-ELAPSED-DAYS < +16
 18883           GO TO 3999-END-EDIT
 18884        END-IF
 18885     END-IF
 18886
 18887     MOVE +0                     TO DC-ELAPSED-DAYS
 18888     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 18889     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 18890     MOVE '1'                    TO DC-OPTION-CODE
 18891     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18892     IF NO-CONVERSION-ERROR
 18893        IF DC-ELAPSED-DAYS > +30
 18894           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 18895        ELSE
 18896           GO TO 3999-END-EDIT
 18897        END-IF
 18898     ELSE
 18899        GO TO 3999-END-EDIT
 18900     END-IF
 18901
 18902     COMPUTE WS-PAYMENT-AMT ROUNDED =
 18903        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 18904           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 18905
 18906     IF WS-PAYMENT-AMT < 600.00
 18907        GO TO 3999-END-EDIT
 18908     END-IF
 18909
 18910     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18911                                                                  ELC50PD
 18912     IF (ERMAIL-FOUND = ' ')
 18913         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 18914         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 18915        GO TO 3999-END-EDIT
 18916     END-IF
 18917
 18918     MOVE ER-2795                TO WS-ERROR
 18919     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18920                                                                  ELC50PD
 18921     GO TO 3999-END-EDIT.                                         ELC50PD
 18922******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 342
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18924 3990-FILES-NOT-OPEN.                                             ELC50PD
 18925                                                                  ELC50PD
 18926     MOVE ER-2617                TO WS-ERROR.                     ELC50PD
 18927     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 18928     GO TO 9990-RETURN.                                           ELC50PD
 18929                                                                  ELC50PD
 18930 3999-END-EDIT.                                                   ELC50PD
 18931
 18932                                                                  ELC50PD
 18933     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.                   ELC50PD
 18934                                                                  ELC50PD
 18935     IF PB-CANCELLATION AND CERT-WAS-FOUND                        ELC50PD
 18936         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT        ELC50PD
 18937         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18938             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18939             GO TO 9990-RETURN                                    ELC50PD
 18940          ELSE                                                    ELC50PD
 18941             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT             ELC50PD
 18942             GO TO 9990-RETURN.                                   ELC50PD
 18943                                                                  ELC50PD
 18944     IF PB-CANCELLATION                                           ELC50PD
 18945          GO TO 9990-RETURN.                                      ELC50PD
 18946                                                                  ELC50PD
 18947     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 18948        MOVE SPACES              TO CERTIFICATE-MASTER.           ELC50PD
 18949                                                                  ELC50PD
 18950     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.                 ELC50PD
 18951                                                                  ELC50PD
 18952     IF CERT-WAS-FOUND                                            ELC50PD
 18953         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18954             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18955          ELSE                                                    ELC50PD
 18956            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT              ELC50PD
 18957      ELSE                                                        ELC50PD
 18958         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.                  ELC50PD
 18959
 18960     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 18961        IF PB-COMPANY-ID = 'DCC' AND
 18962           (PB-CARRIER = '2' OR '4' OR '6')
 18963              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 18964        END-IF
 18965     END-IF.
 18966
 18967     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 18968         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 18969     END-IF.
 18970                                                                  ELC50PD
 18971     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18972     IF ((PB-COMPANY-ID = 'DCC')
 18973        AND (WS-NO-SECURE-PAY))
 18974                  OR
 18975        (WS-LF-SPECIAL-CALC-CD = 'O'
 18976        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18977        SET SKIP-ADDR-EDIT       TO TRUE
 18978     END-IF
 18979
 18980     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18981        AND (NOT SKIP-ADDR-EDIT)
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 343
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18982        MOVE ER-2963             TO WS-ERROR
 18983        PERFORM 9900-ERROR-FORMAT
 18984                                 THRU 9900-EXIT
 18985        GO TO 9990-RETURN
 18986     END-IF
 18987
 18988     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.                     ELC50PD
 18989
 18990     IF ERPNDM-FOUND NOT = 'X'
 18991        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18992           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 18993           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 18994           AND (NOT SKIP-ADDR-EDIT)
 18995           MOVE ER-2694          TO WS-ERROR
 18996           PERFORM 9900-ERROR-FORMAT
 18997                                 THRU 9900-EXIT
 18998        END-IF
 18999        MOVE ' '                 TO STATE-RECORD-ERROR
 19000        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19001        MOVE PM-STATE            TO CNTL-ACCESS
 19002        MOVE '3'                 TO CNTL-REC-TYPE
 19003        MOVE +0                  TO CNTL-SEQ-NO
 19004        MOVE '0'                 TO RC-SW-2
 19005        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19006        IF (NO-STATE-RECORD)
 19007           OR (CF-RECORD-TYPE NOT = '3')
 19008           OR (PM-STATE NOT = CF-STATE-CODE)
 19009           IF (PM-STATE = SPACES)
 19010              AND (SKIP-ADDR-EDIT)
 19011              CONTINUE
 19012           ELSE
 19013              MOVE ER-2963       TO WS-ERROR
 19014              PERFORM 9900-ERROR-FORMAT
 19015                                 THRU 9900-EXIT
 19016           END-IF
 19017        END-IF
 19018        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 19019           MOVE ER-2883          TO WS-ERROR
 19020           PERFORM 9900-ERROR-FORMAT
 19021                                 THRU 9900-EXIT
 19022        END-IF
 19023        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 19024           MOVE ' '                 TO STATE-RECORD-ERROR
 19025           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19026           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 19027           MOVE '3'                 TO CNTL-REC-TYPE
 19028           MOVE +0                  TO CNTL-SEQ-NO
 19029           MOVE '0'                 TO RC-SW-2
 19030           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19031           IF NO-STATE-RECORD
 19032              OR (CF-RECORD-TYPE NOT = '3')
 19033              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 19034              MOVE ER-2964          TO WS-ERROR
 19035              PERFORM 9900-ERROR-FORMAT
 19036                                    THRU 9900-EXIT
 19037           END-IF
 19038        END-IF
 19039     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 344
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19040        IF NOT SKIP-ADDR-EDIT
 19041           MOVE ER-2393          TO WS-ERROR
 19042           PERFORM 9900-ERROR-FORMAT
 19043                                 THRU 9900-EXIT
 19044        END-IF
 19045     END-IF
 19046                                                                  ELC50PD
 19047     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 19048                                                                  ELC50PD
 19049     IF (ERMAIL-FOUND = ' ' AND                                   ELC50PD
 19050        ERPNDM-FOUND = ' ')                                       ELC50PD
 19051        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND             ELC50PD
 19052           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 19053           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 19054          OR                                                      ELC50PD
 19055           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)       ELC50PD
 19056          OR                                                      ELC50PD
 19057           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND               ELC50PD
 19058           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)ELC50PD
 19059           GO TO 3999-UNLOCK-ERMAIL.                              ELC50PD
 19060                                                                  ELC50PD
 19061
 19062     IF ERPNDM-FOUND = 'X'                                        ELC50PD
 19063        GO TO 3999-UNLOCK-ERMAIL.                                 ELC50PD
 19064                                                                  ELC50PD
 19065     IF PM-INSURED-LAST-NAME      = SPACES
 19066        AND PM-INSURED-FIRST-NAME = SPACES
 19067        AND PM-ADDRESS-LINE-1     = SPACES
 19068        AND PM-ADDRESS-LINE-2     = SPACES
 19069        AND PM-CITY-STATE         = SPACES
 19070        AND PM-CRED-BENE-NAME     = SPACES
 19071        AND PM-CRED-BENE-ADDR     = SPACES
 19072        AND PM-CRED-BENE-CTYST    = SPACES
 19073        GO TO 3999-UNLOCK-ERMAIL
 19074     END-IF
 19075                                                                  ELC50PD
 19076     MOVE SPACES                 TO MAILING-DATA.                 ELC50PD
 19077                                                                  ELC50PD
 19078     MOVE 'MA'                   TO MA-RECORD-ID.                 ELC50PD
 19079     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.           ELC50PD
 19080     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.            ELC50PD
 19081     MOVE PB-SV-CARRIER          TO MA-CARRIER.                   ELC50PD
 19082     MOVE PB-SV-GROUPING         TO MA-GROUPING.                  ELC50PD
 19083     MOVE PB-SV-STATE            TO MA-STATE.                     ELC50PD
 19084     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 19085     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 19086                                                                  ELC50PD
 19087     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT              ELC50PD
 19088     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY              ELC50PD
 19089                                                                  ELC50PD
 19090     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19091        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT                ELC50PD
 19092     ELSE                                                         ELC50PD
 19093        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT              ELC50PD
 19094        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY            ELC50PD
 19095        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.                 ELC50PD
 19096                                                                  ELC50PD
 19097
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 345
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19098     GO TO 9990-RETURN.                                           ELC50PD
 19099                                                                  ELC50PD
 19100 3999-UNLOCK-ERMAIL.                                              ELC50PD
 19101     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19102        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.                ELC50PD
 19103                                                                  ELC50PD
 19104     GO TO 9990-RETURN.                                           ELC50PD
 19105******************************************************************ELC50PD
 19106                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 346
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19108 4000-UPDATE-CANCELLED-CERT.                                      ELC50PD
 19109     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 19110        GO TO 4299-EXIT.                                          ELC50PD
 19111                                                                  ELC50PD
 19112*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.         ELC50PD
 19113
 19114     IF PB-C-NH-INT-ON-REFS > ZEROS
 19115        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 19116     END-IF
 19117     IF PB-C-REF-INTERFACE-SW = 'Y'
 19118        MOVE PB-C-REF-INTERFACE-SW
 19119                                 TO CM-NH-INTERFACE-SW
 19120     END-IF
 19121
 19122     IF PB-C-POST-CARD-IND = 'Y'
 19123        MOVE +8                  TO SUB
 19124        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 19125        IF ERMAIL-FOUND = ' '
 19126           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 19127              (SUB > +7)
 19128              OR (MA-MAIL-STATUS (SUB) = '1')
 19129           END-PERFORM
 19130        END-IF
 19131        IF (SUB > +7)
 19132           OR (ERMAIL-FOUND = 'X')
 19133           MOVE ER-3789          TO WS-ERROR
 19134           PERFORM 9900-ERROR-FORMAT
 19135                                 THRU 9900-EXIT
 19136        END-IF
 19137     ELSE
 19138        MOVE 'N'                 TO PB-C-POST-CARD-IND
 19139     END-IF
 19140
 19141     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 19142                                                                  ELC50PD
 19143     IF PB-CI-OB-FLAG = 'Z'                                       ELC50PD
 19144        GO TO 4150-SUMMARY-CERT-CANCEL.                           ELC50PD
 19145                                                                  ELC50PD
 19146     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19147         PERFORM 4200-REVERSE-LF-CANCEL.                          ELC50PD
 19148     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19149         PERFORM 4200-REVERSE-AH-CANCEL.                          ELC50PD
 19150                                                                  ELC50PD
 19151 4100-APPLY-LF-CANCEL.                                            ELC50PD
 19152                                                                  ELC50PD
 19153     MOVE +0                     TO WS-SUB.                       ELC50PD
 19154                                                                  ELC50PD
 19155 4100-CHECK-LF-ERRORS.                                            ELC50PD
 19156                                                                  ELC50PD
 19157     ADD +1                       TO WS-SUB.                      ELC50PD
 19158                                                                  ELC50PD
 19159     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19160        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 19161           GO TO 4100-LF-CANCEL-CONT                              ELC50PD
 19162        ELSE                                                      ELC50PD
 19163           GO TO 4100-UPDATE-LF-COVERAGE.                         ELC50PD
 19164                                                                  ELC50PD
 19165     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 347
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19166                                   ER-2729 OR                     ELC50PD
 19167                                   ER-2730 OR                     ELC50PD
 19168                                   ER-2731 OR                     ELC50PD
 19169                                   ER-2732 OR                     ELC50PD
 19170                                   ER-2737 OR                     ELC50PD
 19171                                   ER-2740 OR                     ELC50PD
 19172                                   ER-2743 OR                     ELC50PD
 19173                                   ER-2749 OR                     ELC50PD
 19174                                   ER-2750 OR                     ELC50PD
 19175                                   ER-2755 OR                     ELC50PD
 19176                                   ER-2757 OR                     ELC50PD
 19177                                   ER-2760 OR                     ELC50PD
 19178                                   ER-2772 OR                     ELC50PD
 19179                                   ER-2774 OR                     ELC50PD
 19180                                   ER-2776 OR                     ELC50PD
 19181                                   ER-2794                        ELC50PD
 19182        GO TO 4100-UPDATE-LF-COVERAGE.                            ELC50PD
 19183                                                                  ELC50PD
 19184     GO TO 4100-CHECK-LF-ERRORS.                                  ELC50PD
 19185                                                                  ELC50PD
 19186 4100-UPDATE-LF-COVERAGE.                                         ELC50PD
 19187                                                                  ELC50PD
 19188     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT     ELC50PD
 19189     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT          ELC50PD
 19190     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 19191        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 19192     END-IF
 19193     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19194                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19195     IF CM-LF-CANCEL-DT = LOW-VALUE                               ELC50PD
 19196         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.    ELC50PD
 19197                                                                  ELC50PD
 19198     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19199         MOVE SPACES                  TO CM-LF-EXIT-BATCH         ELC50PD
 19200                                         CM-LF-STATUS-AT-CANCEL.  ELC50PD
 19201                                                                  ELC50PD
 19202     GO TO 4100-APPLY-AH-CANCEL.                                  ELC50PD
 19203                                                                  ELC50PD
 19204 4100-LF-CANCEL-CONT.                                             ELC50PD
 19205     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19206         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19207                                                                  ELC50PD
 19208     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19209         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19210                                                                  ELC50PD
 19211     IF PB-C-LF-CANCEL-AMT GREATER ZERO                           ELC50PD
 19212        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                   ELC50PD
 19213           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT        ELC50PD
 19214        ELSE                                                      ELC50PD
 19215           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.       ELC50PD
 19216                                                                  ELC50PD
 19217     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.            ELC50PD
 19218     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.       ELC50PD
 19219                                                                  ELC50PD
 19220     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19221         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.           ELC50PD
 19222                                                                  ELC50PD
 19223     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 348
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19224        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 19225         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL      ELC50PD
 19226         MOVE '8'                  TO CM-LF-CURRENT-STATUS.       ELC50PD
 19227                                                                  ELC50PD
 19228     IF PB-RECORD-RETURNED                                        ELC50PD
 19229        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19230      ELSE                                                        ELC50PD
 19231        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19232                                                                  ELC50PD
 19233 4100-APPLY-AH-CANCEL.                                            ELC50PD
 19234                                                                  ELC50PD
 19235     MOVE +0                      TO WS-SUB.                      ELC50PD
 19236                                                                  ELC50PD
 19237 4100-CHECK-AH-ERRORS.                                            ELC50PD
 19238                                                                  ELC50PD
 19239     ADD +1                       TO WS-SUB.                      ELC50PD
 19240                                                                  ELC50PD
 19241     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19242        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 19243           GO TO 4100-AH-CANCEL-CONT                              ELC50PD
 19244        ELSE                                                      ELC50PD
 19245           GO TO 4100-UPDATE-AH-COVERAGE.                         ELC50PD
 19246                                                                  ELC50PD
 19247     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19248                                   ER-2729 OR                     ELC50PD
 19249                                   ER-2732 OR                     ELC50PD
 19250                                   ER-2737 OR                     ELC50PD
 19251                                   ER-2740 OR                     ELC50PD
 19252                                   ER-2744 OR                     ELC50PD
 19253                                   ER-2749 OR                     ELC50PD
 19254                                   ER-2750 OR                     ELC50PD
 19255                                   ER-2755 OR                     ELC50PD
 19256                                   ER-2757 OR                     ELC50PD
 19257                                   ER-2760 OR                     ELC50PD
 19258                                   ER-2771 OR                     ELC50PD
 19259                                   ER-2772 OR                     ELC50PD
 19260                                   ER-2773 OR                     ELC50PD
 19261                                   ER-2775 OR                     ELC50PD
 19262                                   ER-2777 OR                     ELC50PD
 19263                                   ER-2794                        ELC50PD
 19264        GO TO 4100-UPDATE-AH-COVERAGE.                            ELC50PD
 19265                                                                  ELC50PD
 19266     GO TO 4100-CHECK-AH-ERRORS.                                  ELC50PD
 19267                                                                  ELC50PD
 19268 4100-UPDATE-AH-COVERAGE.                                         ELC50PD
 19269                                                                  ELC50PD
 19270     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT     ELC50PD
 19271     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT          ELC50PD
 19272     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS     ELC50PD
 19273     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19274                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19275     IF CM-AH-CANCEL-DT = LOW-VALUE                               ELC50PD
 19276         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.    ELC50PD
 19277                                                                  ELC50PD
 19278     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19279         MOVE SPACES                  TO CM-AH-EXIT-BATCH         ELC50PD
 19280                                         CM-AH-STATUS-AT-CANCEL.  ELC50PD
 19281                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 349
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19282     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 19283         IF PB-RECORD-RETURNED                                    ELC50PD
 19284              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2 ELC50PD
 19285          ELSE                                                    ELC50PD
 19286              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19287                                                                  ELC50PD
 19288     GO TO 4299-EXIT.                                             ELC50PD
 19289                                                                  ELC50PD
 19290 4100-AH-CANCEL-CONT.                                             ELC50PD
 19291     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19292         GO TO 4299-EXIT.                                         ELC50PD
 19293
 19294     if cm-credit-interface-sw-2 = ' '
 19295        if pb-fatal-errors or pb-unforced-errors
 19296           move '4'              to cm-credit-interface-sw-2
 19297        else
 19298           move '1'              to cm-credit-interface-sw-2
 19299        end-if
 19300     end-if
 19301
 19302     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19303         GO TO 4299-EXIT.                                         ELC50PD
 19304                                                                  ELC50PD
 19305     IF PB-C-AH-CANCEL-AMT GREATER ZERO                           ELC50PD
 19306        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                     ELC50PD
 19307           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT      ELC50PD
 19308        ELSE                                                      ELC50PD
 19309           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.     ELC50PD
 19310                                                                  ELC50PD
 19311     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.              ELC50PD
 19312     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.         ELC50PD
 19313                                                                  ELC50PD
 19314     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19315         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.             ELC50PD
 19316                                                                  ELC50PD
 19317     IF CM-AH-STATUS-AT-CANCEL = SPACE                            ELC50PD
 19318         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL      ELC50PD
 19319         MOVE '8'                TO CM-AH-CURRENT-STATUS.         ELC50PD
 19320                                                                  ELC50PD
 19321     IF PB-RECORD-RETURNED                                        ELC50PD
 19322        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2      ELC50PD
 19323      ELSE                                                        ELC50PD
 19324        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19325                                                                  ELC50PD
 19326     GO TO 4299-EXIT.                                             ELC50PD
 19327                                                                  ELC50PD
 19328 4150-SUMMARY-CERT-CANCEL.                                        ELC50PD
 19329     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19330                                                                  ELC50PD
 19331     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19332        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19333                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC      ELC50PD
 19334     ELSE                                                         ELC50PD
 19335        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19336                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.  ELC50PD
 19337                                                                  ELC50PD
 19338     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 19339        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 350
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19340                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC     ELC50PD
 19341     ELSE                                                         ELC50PD
 19342        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19343                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.  ELC50PD
 19344                                                                  ELC50PD
 19345     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                      ELC50PD
 19346        NEXT SENTENCE                                             ELC50PD
 19347     ELSE                                                         ELC50PD
 19348        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.              ELC50PD
 19349                                                                  ELC50PD
 19350     GO TO 4299-EXIT.                                             ELC50PD
 19351                                                                  ELC50PD
 19352 4200-REVERSE-LF-CANCEL.                                          ELC50PD
 19353     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.            ELC50PD
 19354                                                                  ELC50PD
 19355     IF CM-LF-CANCEL-APPLIED                                      ELC50PD
 19356        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT        ELC50PD
 19357        MOVE SPACES                TO CM-LF-EXIT-BATCH            ELC50PD
 19358        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.      ELC50PD
 19359                                                                  ELC50PD
 19360     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.     ELC50PD
 19361                                                                  ELC50PD
 19362     IF PB-RECORD-RETURNED                                        ELC50PD
 19363        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19364       ELSE                                                       ELC50PD
 19365        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19366                                                                  ELC50PD
 19367 4200-REVERSE-LF-EXIT.                                            ELC50PD
 19368       EXIT.                                                      ELC50PD
 19369                                                                  ELC50PD
 19370 4200-REVERSE-AH-CANCEL.                                          ELC50PD
 19371     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.            ELC50PD
 19372                                                                  ELC50PD
 19373     IF CM-AH-CANCEL-APPLIED                                      ELC50PD
 19374        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT        ELC50PD
 19375        MOVE SPACES                TO CM-AH-EXIT-BATCH            ELC50PD
 19376        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.      ELC50PD
 19377                                                                  ELC50PD
 19378     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.     ELC50PD
 19379                                                                  ELC50PD
 19380     IF PB-RECORD-RETURNED                                        ELC50PD
 19381        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19382       ELSE                                                       ELC50PD
 19383        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19384                                                                  ELC50PD
 19385 4200-REVERSE-AH-EXIT.                                            ELC50PD
 19386       EXIT.                                                      ELC50PD
 19387                                                                  ELC50PD
 19388 4299-EXIT.                                                       ELC50PD
 19389       EXIT.                                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 351
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19391                                                                  ELC50PD
 19392 4500-UPDATE-NEW-CERT.                                            ELC50PD
 19393     IF CERT-WAS-FOUND                                            ELC50PD
 19394         NEXT SENTENCE                                            ELC50PD
 19395       ELSE                                                       ELC50PD
 19396         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19397                                                                  ELC50PD
 19398     IF  CLASIC-CREATED-CERT                                      ELC50PD
 19399         GO TO 4999-EXIT.                                         ELC50PD
 19400                                                                  ELC50PD
 19401     IF  CERT-WAS-CREATED-FOR-CLAIM                               ELC50PD
 19402         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19403                                                                  ELC50PD
 19404     IF CERT-ADDED-BATCH                                          ELC50PD
 19405        IF CM-RECORD-ID = 'CM'                                    ELC50PD
 19406            GO TO 4999-EXIT.                                      ELC50PD
 19407                                                                  ELC50PD
 19408 4520-BUILD-NEW-KEY.                                              ELC50PD
 19409* BUILD CONTROL PRIMARY                                           ELC50PD
 19410                                                                  ELC50PD
 19411     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD              ELC50PD
 19412                                       CM-COMPANY-CD-A1           ELC50PD
 19413                                       CM-COMPANY-CD-A2           ELC50PD
 19414                                       CM-COMPANY-CD-A4           ELC50PD
 19415                                       CM-COMPANY-CD-A5.          ELC50PD
 19416                                                                  ELC50PD
 19417     MOVE PB-SV-CARRIER             TO CM-CARRIER.                ELC50PD
 19418     MOVE PB-SV-GROUPING            TO CM-GROUPING.               ELC50PD
 19419     MOVE PB-SV-STATE               TO CM-STATE.                  ELC50PD
 19420     MOVE PB-ACCOUNT                TO CM-ACCOUNT.                ELC50PD
 19421     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.             ELC50PD
 19422     MOVE PB-CERT-SFX               TO CM-CERT-SFX.               ELC50PD
 19423     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.            ELC50PD
 19424                                                                  ELC50PD
 19425     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.             ELC50PD
 19426                                                                  ELC50PD
 19427     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.      ELC50PD
 19428     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.      ELC50PD
 19429     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.     ELC50PD
 19430     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.    ELC50PD
 19431                                                                  ELC50PD
 19432     IF PB-I-SOC-SEC-NO EQUAL '000000000  '                       ELC50PD
 19433        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.          ELC50PD
 19434                                                                  ELC50PD
 19435     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO                        ELC50PD
 19436         MOVE PB-SV-STATE            TO CM-SSN-STATE              ELC50PD
 19437         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT            ELC50PD
 19438         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2      ELC50PD
 19439         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2    ELC50PD
 19440     ELSE                                                         ELC50PD
 19441         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.            ELC50PD
 19442                                                                  ELC50PD
 19443     IF PB-COMPANY-ID   EQUAL  'CRI'                              ELC50PD
 19444         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME         ELC50PD
 19445         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD            ELC50PD
 19446         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME          ELC50PD
 19447         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL            ELC50PD
 19448         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 352
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19449                                                                  ELC50PD
 19450     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND                  ELC50PD
 19451        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19452         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.   ELC50PD
 19453                                                                  ELC50PD
 19454     IF PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 19455        IF PB-I-JOINT-COVERAGE                                    ELC50PD
 19456            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO           ELC50PD
 19457                                           PB-I-MEMBER-NO         ELC50PD
 19458            GO TO 4550-CONT-CERT-PROCESS.                         ELC50PD
 19459                                                                  ELC50PD
 19460     IF PB-COMPANY-ID  = 'MON' OR 'PEM'                           ELC50PD
 19461        NEXT SENTENCE                                             ELC50PD
 19462     ELSE                                                         ELC50PD
 19463        GO TO 4540-BUILD-MEMBER-NO.                               ELC50PD
 19464                                                                  ELC50PD
 19465******************************************************************ELC50PD
 19466*                                                                *ELC50PD
 19467*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *ELC50PD
 19468*    FOR 'MON'.                                                  *ELC50PD
 19469*                                                                *ELC50PD
 19470******************************************************************ELC50PD
 19471                                                                  ELC50PD
 19472     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.                 ELC50PD
 19473     MOVE SPACES                 TO WS-WORK-MEMB-NAME.            ELC50PD
 19474     MOVE +1                     TO WS-SUB1                       ELC50PD
 19475                                    WS-SUB2.                      ELC50PD
 19476                                                                  ELC50PD
 19477 4530-EDIT-MEMB-NAME.                                             ELC50PD
 19478                                                                  ELC50PD
 19479     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO       ELC50PD
 19480        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)  ELC50PD
 19481        ADD +1                       TO WS-SUB2.                  ELC50PD
 19482                                                                  ELC50PD
 19483     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7            ELC50PD
 19484        ADD +1                       TO WS-SUB1                   ELC50PD
 19485        GO TO 4530-EDIT-MEMB-NAME.                                ELC50PD
 19486                                                                  ELC50PD
 19487     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.          ELC50PD
 19488     MOVE PB-SV-STATE                TO CM-MEMB-STATE.            ELC50PD
 19489     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.            ELC50PD
 19490*    MOVE SPACE                      TO DC-OPTION-CODE.           ELC50PD
 19491     SET  BIN-TO-GREG                TO TRUE.                     ELC50PD
 19492     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 19493     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.              ELC50PD
 19494                                                                  ELC50PD
 19495     GO TO 4550-CONT-CERT-PROCESS.                                ELC50PD
 19496                                                                  ELC50PD
 19497******************************************************************ELC50PD
 19498*    END FOR 'MON' CODE FOR MEMBER NO.                           *ELC50PD
 19499******************************************************************ELC50PD
 19500                                                                  ELC50PD
 19501 4540-BUILD-MEMBER-NO.                                            ELC50PD
 19502                                                                  ELC50PD
 19503     IF PB-I-MEMBER-NO  = SPACES OR ZERO                          ELC50PD
 19504         MOVE PB-SV-STATE            TO CM-MEMB-STATE             ELC50PD
 19505         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT           ELC50PD
 19506         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 353
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19507         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5    ELC50PD
 19508     ELSE                                                         ELC50PD
 19509         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.             ELC50PD
 19510                                                                  ELC50PD
 19511     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND                    ELC50PD
 19512        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19513         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.   ELC50PD
 19514                                                                  ELC50PD
 19515 4550-CONT-CERT-PROCESS.                                          ELC50PD
 19516                                                                  ELC50PD
 19517*    IF PB-I-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 19518*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO          ELC50PD
 19519*    ELSE                                                         ELC50PD
 19520*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.         ELC50PD
 19521                                                                  ELC50PD
 19522     IF CERT-WAS-CREATED-FOR-CLAIM                                ELC50PD
 19523        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19524        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.   ELC50PD
 19525                                                                  ELC50PD
 19526     IF CERT-AND-CLAIM-ONLINE                                     ELC50PD
 19527        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19528        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.  ELC50PD
 19529                                                                  ELC50PD
 19530     MOVE 'CM'                     TO CM-RECORD-ID.               ELC50PD
 19531     MOVE LOW-VALUES               TO CM-STATUS-DATA.             ELC50PD
 19532                                                                  ELC50PD
 19533     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE             ELC50PD
 19534        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW     ELC50PD
 19535        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT   ELC50PD
 19536     ELSE                                                         ELC50PD
 19537        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW        ELC50PD
 19538        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.     ELC50PD
 19539                                                                  ELC50PD
 19540     MOVE ZERO                     TO CM-LOAN-BALANCE.            ELC50PD
 19541     MOVE '1'                      TO CM-PREMIUM-TYPE.            ELC50PD
 19542     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.       ELC50PD
 19543     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.       ELC50PD
 19544     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.      ELC50PD
 19545     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.             ELC50PD
 19546     MOVE ZEROS                    TO CM-LF-REMAINING-AMT         ELC50PD
 19547                                      CM-LF-ITD-CANCEL-AMT        ELC50PD
 19548                                      CM-LF-ITD-DEATH-AMT         ELC50PD
 19549                                      CM-AH-ITD-AH-PMT            ELC50PD
 19550                                      CM-AH-ITD-LUMP-PMT          ELC50PD
 19551                                      CM-AH-ITD-CANCEL-AMT        ELC50PD
 19552                                      CM-LF-NSP-PREMIUM-AMT       ELC50PD
 19553                                      CM-AH-NSP-PREMIUM-AMT.      ELC50PD
 19554*                                     CM-CLAIM-DEDUCT-WITHHELD    ELC50PD
 19555*                                     CM-CANCEL-DEDUCT-WITHHELD.  ELC50PD
 19556     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.                ELC50PD
 19557     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.           ELC50PD
 19558     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.              ELC50PD
 19559     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.                ELC50PD
 19560     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.             ELC50PD
 19561     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.             ELC50PD
 19562     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.              ELC50PD
 19563     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.              ELC50PD
 19564     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 354
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19565     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.             ELC50PD
 19566     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.               ELC50PD
 19567     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.         ELC50PD
 19568                                                                  ELC50PD
 19569     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 19570         MOVE ZERO                 TO PB-I-LIVES.                 ELC50PD
 19571                                                                  ELC50PD
 19572     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 19573         MOVE ZERO                 TO PB-I-NUM-BILLED.            ELC50PD
 19574                                                                  ELC50PD
 19575     MOVE PB-I-LIVES               TO CM-LIVES.                   ELC50PD
 19576     MOVE PB-I-NUM-BILLED          TO CM-BILLED.                  ELC50PD
 19577                                                                  ELC50PD
 19578     IF PB-COMPANY-ID EQUAL  'DMD'                                ELC50PD
 19579         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE       ELC50PD
 19580         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.           ELC50PD
 19581                                                                  ELC50PD
 19582     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.           ELC50PD
 19583     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.            ELC50PD
 19584     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.      ELC50PD
 19585     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.          ELC50PD
 19586     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.      ELC50PD
 19587     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 19588                                                                  ELC50PD
 19589     IF PB-I-LF-POLICY-FEE NUMERIC                                ELC50PD
 19590        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE            ELC50PD
 19591     ELSE                                                         ELC50PD
 19592        MOVE +0                    TO CM-LF-POLICY-FEE.           ELC50PD
 19593                                                                  ELC50PD
 19594     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19595        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT           ELC50PD
 19596        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT       ELC50PD
 19597     ELSE                                                         ELC50PD
 19598        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.          ELC50PD
 19599                                                                  ELC50PD
 19600     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.        ELC50PD
 19601     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.    ELC50PD
 19602     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.        ELC50PD
 19603     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.      ELC50PD
 19604     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.       ELC50PD
 19605     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.           ELC50PD
 19606     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.            ELC50PD
 19607     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.          ELC50PD
 19608     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 19609                                                                  ELC50PD
 19610     IF PB-I-AH-POLICY-FEE NUMERIC                                ELC50PD
 19611        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE            ELC50PD
 19612     ELSE                                                         ELC50PD
 19613        MOVE +0                    TO CM-AH-POLICY-FEE.           ELC50PD
 19614                                                                  ELC50PD
 19615     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 19616        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT           ELC50PD
 19617     ELSE                                                         ELC50PD
 19618        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.          ELC50PD
 19619                                                                  ELC50PD
 19620     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.      ELC50PD
 19621     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.       ELC50PD
 19622                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 355
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19623     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT          ELC50PD
 19624                                      CM-LF-DEATH-EXIT-DT         ELC50PD
 19625                                      CM-AH-SETTLEMENT-EXIT-DT.   ELC50PD
 19626                                                                  ELC50PD
 19627*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR                ELC50PD
 19628*                       'TIH' OR 'OFL' OR 'FLA' OR                ELC50PD
 19629*                       'TII' OR 'TMS' OR 'CRI' OR                ELC50PD
 19630*                       'NCL'                                     ELC50PD
 19631     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 19632                                                                  ELC50PD
 19633     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND                 ELC50PD
 19634         IF WS-LF-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19635            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19636                                                                  ELC50PD
 19637     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND                   ELC50PD
 19638         IF WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19639            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19640                                                                  ELC50PD
 19641     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 19642         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS         ELC50PD
 19643     ELSE                                                         ELC50PD
 19644         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS         ELC50PD
 19645         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.     ELC50PD
 19646                                                                  ELC50PD
 19647     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.           ELC50PD
 19648     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.           ELC50PD
 19649     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.         ELC50PD
 19650     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.            ELC50PD
 19651     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.            ELC50PD
 19652     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.             ELC50PD
 19653     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.      ELC50PD
 19654     MOVE SPACE                     TO CM-PAYMENT-MODE.           ELC50PD
 19655                                                                  ELC50PD
 19656     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 19657         MOVE SPACE                 TO CM-SKIP-CODE               ELC50PD
 19658     ELSE                                                         ELC50PD
 19659         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.              ELC50PD
 19660                                                                  ELC50PD
 19661     MOVE '2'                       TO CM-LF-CURRENT-STATUS.      ELC50PD
 19662     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH      ELC50PD
 19663                                       CM-LF-STATUS-AT-CANCEL.    ELC50PD
 19664                                                                  ELC50PD
 19665     MOVE '2'                       TO CM-AH-CURRENT-STATUS.      ELC50PD
 19666     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT ELC50PD
 19667                                       CM-AH-STATUS-AT-CANCEL.    ELC50PD
 19668                                                                  ELC50PD
 19669     MOVE '1'                       TO CM-ENTRY-STATUS.           ELC50PD
 19670                                                                  ELC50PD
 19671     IF PB-REISSUED-CERT                                          ELC50PD
 19672        MOVE '5'                    TO CM-ENTRY-STATUS.           ELC50PD
 19673                                                                  ELC50PD
 19674     IF PB-MONTHLY-CERT                                           ELC50PD
 19675        MOVE 'M'                    TO CM-ENTRY-STATUS.           ELC50PD
 19676                                                                  ELC50PD
 19677     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 19678     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 19679     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 19680        MOVE 'D'                    TO CM-ENTRY-STATUS.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 356
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19681                                                                  ELC50PD
 19682     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 19683        MOVE 'V'                    TO CM-ENTRY-STATUS.           ELC50PD
 19684                                                                  ELC50PD
 19685     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 19686        MOVE 'U'                    TO CM-ENTRY-STATUS.           ELC50PD
 19687                                                                  ELC50PD
 19688     IF PB-REIN-ONLY-CERT                                         ELC50PD
 19689        MOVE '9'                    TO CM-ENTRY-STATUS.           ELC50PD
 19690                                                                  ELC50PD
 19691     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'                  ELC50PD
 19692         MOVE 'Y'                   TO CM-UNDERWRITING-CODE       ELC50PD
 19693     ELSE                                                         ELC50PD
 19694         MOVE SPACE                 TO CM-UNDERWRITING-CODE.      ELC50PD
 19695                                                                  ELC50PD
 19696     IF PB-RECORD-RETURNED                                        ELC50PD
 19697        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1   ELC50PD
 19698      ELSE                                                        ELC50PD
 19699        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.  ELC50PD
 19700                                                                  ELC50PD
 19701     IF PB-I-MAIL-ADDRS-PRESENT                                   ELC50PD
 19702        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.     ELC50PD
 19703                                                                  ELC50PD
 19704     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END          ELC50PD
 19705                                       CM-ENTRY-DT.               ELC50PD
 19706                                                                  ELC50PD
 19707 4999-EXIT.                                                       ELC50PD
 19708     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 357
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19710                                                                  ELC50PD
 19711 5000-PROCESS-REPS.
 19712
 19713     MOVE ' '                    TO AGTC-MASTER-SW
 19714     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 19715     MOVE CO-TYPE                TO AGTC-TYPE
 19716     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 19717     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 19718
 19719     IF (AGTC-MASTER-SW NOT = 'N')
 19720        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 19721        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 19722        PERFORM 8583-READ-ERAGTC-NEXT
 19723                                 THRU 8583-EXIT
 19724     END-IF
 19725
 19726     IF AGTC-MASTER-SW = 'N'
 19727        CONTINUE
 19728     ELSE
 19729        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 19730           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 19731              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 19732              MOVE 'Y'           TO AGTC-MASTER-SW
 19733           END-IF
 19734        END-IF
 19735     END-IF
 19736
 19737     .
 19738 5000-EXIT.
 19739     EXIT.
 19740
 19741
 19742 6370-EDIT-INPUT-LF-CODE.                                         ELC50PD
 19743     IF WK-LIFE-EDIT-ADDR NOT = ZEROS                             ELC50PD
 19744        MOVE +1                  TO SUB                           ELC50PD
 19745        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 19746        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19747        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19748        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19749        GO TO 6370-SEARCH-LOOP.                                   ELC50PD
 19750                                                                  ELC50PD
 19751     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19752                                                                  ELC50PD
 19753     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19754     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19755*    MOVE 'L'                    TO CNTL-REC-TYPE.                ELC50PD
 19756     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.                ELC50PD
 19757     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19758     MOVE '4' TO RC-SW-2.                                         ELC50PD
 19759     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19760                                                                  ELC50PD
 19761     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19762        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19763        GO TO 6370-NO-LF-FOUND.                                   ELC50PD
 19764                                                                  ELC50PD
 19765     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.            ELC50PD
 19766     MOVE +1                     TO SUB.                          ELC50PD
 19767                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 358
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19768 6370-SEARCH-LOOP.                                                ELC50PD
 19769     IF CF-LIFE-CODE-OUT (SUB) = ZEROS                            ELC50PD
 19770         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19771                                                                  ELC50PD
 19772     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)                  ELC50PD
 19773         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD        ELC50PD
 19774         GO TO 6370-HER-NET-PAY-CHECK.                            ELC50PD
 19775                                                                  ELC50PD
 19776     ADD 1   TO SUB.                                              ELC50PD
 19777*    IF SUB GREATER 120                                           ELC50PD
 19778     IF SUB GREATER 200                                           ELC50PD
 19779         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19780                                                                  ELC50PD
 19781     GO TO 6370-SEARCH-LOOP.                                      ELC50PD
 19782                                                                  ELC50PD
 19783 6370-NO-LF-FOUND.                                                ELC50PD
 19784                                                                  ELC50PD
 19785     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19786                                                                  ELC50PD
 19787 6370-HER-NET-PAY-CHECK.                                          ELC50PD
 19788                                                                  ELC50PD
 19789     IF PB-COMPANY-ID = 'CID'
 19790        IF PB-SV-STATE = 'CA' OR 'MN'
 19791           IF PB-I-LF-BENEFIT-CD = '02'
 19792              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19793           ELSE
 19794              IF PB-I-LF-BENEFIT-CD = '04'
 19795                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19796              END-IF
 19797           END-IF
 19798        END-IF
 19799     END-IF
 19800
 19801     IF PB-COMPANY-ID NOT = 'HER'                                 ELC50PD
 19802         GO TO 6370-EXIT.                                         ELC50PD
 19803                                                                  ELC50PD
 19804     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'                  ELC50PD
 19805         GO TO 6370-EXIT.                                         ELC50PD
 19806                                                                  ELC50PD
 19807     IF PB-I-LF-TERM NOT NUMERIC                                  ELC50PD
 19808         MOVE ZEROS              TO PB-I-LF-TERM.                 ELC50PD
 19809                                                                  ELC50PD
 19810     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 19811         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 19812                                                                  ELC50PD
 19813     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM                  ELC50PD
 19814         GO TO 6370-EXIT.                                         ELC50PD
 19815                                                                  ELC50PD
 19816     IF PB-I-LF-BENEFIT-CD = '33'                                 ELC50PD
 19817         MOVE '31'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19818                                                                  ELC50PD
 19819     IF PB-I-LF-BENEFIT-CD = '34'                                 ELC50PD
 19820         MOVE '32'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19821                                                                  ELC50PD
 19822 6370-EXIT.                                                       ELC50PD
 19823     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 359
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19825                                                                  ELC50PD
 19826 6380-EDIT-INPUT-AH-CODE.                                         ELC50PD
 19827     IF WK-AH-EDIT-ADDR NOT = ZEROS                               ELC50PD
 19828        MOVE +1                  TO SUB                           ELC50PD
 19829        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 19830        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19831        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19832        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19833        GO TO 6380-SEARCH-LOOP.                                   ELC50PD
 19834                                                                  ELC50PD
 19835     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19836                                                                  ELC50PD
 19837     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19838     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19839     MOVE 'A'                    TO CNTL-REC-TYPE.                ELC50PD
 19840*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.                ELC50PD
 19841     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19842     MOVE '5' TO RC-SW-2.                                         ELC50PD
 19843     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19844                                                                  ELC50PD
 19845     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19846        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19847        GO TO 6380-NO-AH-FOUND.                                   ELC50PD
 19848                                                                  ELC50PD
 19849     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.              ELC50PD
 19850     MOVE +1 TO SUB.                                              ELC50PD
 19851                                                                  ELC50PD
 19852 6380-SEARCH-LOOP.                                                ELC50PD
 19853     IF CF-AH-CODE-OUT (SUB) = ZEROS                              ELC50PD
 19854         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19855                                                                  ELC50PD
 19856     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)                    ELC50PD
 19857         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD          ELC50PD
 19858         GO TO 6380-CSO-AH-ONLY-CHECKS.                           ELC50PD
 19859                                                                  ELC50PD
 19860     ADD 1   TO SUB.                                              ELC50PD
 19861     IF SUB GREATER THAN 96                                       ELC50PD
 19862*    IF SUB GREATER THAN 300                                      ELC50PD
 19863         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19864                                                                  ELC50PD
 19865     GO TO 6380-SEARCH-LOOP.                                      ELC50PD
 19866                                                                  ELC50PD
 19867 6380-NO-AH-FOUND.                                                ELC50PD
 19868                                                                  ELC50PD
 19869     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.               ELC50PD
 19870                                                                  ELC50PD
 19871     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE                        ELC50PD
 19872         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD            ELC50PD
 19873     ELSE                                                         ELC50PD
 19874         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.           ELC50PD
 19875                                                                  ELC50PD
 19876 6380-CSO-AH-ONLY-CHECKS.                                         ELC50PD
 19877                                                                  ELC50PD
 19878     IF PB-COMPANY-ID = 'CSO' OR 'CID'                            ELC50PD
 19879        NEXT SENTENCE                                             ELC50PD
 19880      ELSE                                                        ELC50PD
 19881        GO TO 6380-EXIT.                                          ELC50PD
 19882                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 360
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19883     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS                 ELC50PD
 19884         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.                      ELC50PD
 19885                                                                  ELC50PD
 19886                                                                  00041198
 19887     GO TO 6380-EXIT                                              00041198
 19888     .
 19889 6380-CSO-LIFE-WITH-AH-CHECKS.                                    00041202
 19890                                                                  00041203
 19891                                                                  ELC50PD
 19892     .                                                            ELC50PD
 19893 6380-EXIT.                                                       ELC50PD
 19894     EXIT.                                                        ELC50PD
 19895                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 361
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19897                                                                  ELC50PD
 19898 6400-COMPUTE-EXTENSION-DAYS.                                     ELC50PD
 19899                                                                  ELC50PD
 19900******************************************************************ELC50PD
 19901*                                                                *ELC50PD
 19902*                   COMPUTE EXTENSION DAYS                       *ELC50PD
 19903*                                                                *ELC50PD
 19904*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *ELC50PD
 19905*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *ELC50PD
 19906*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *ELC50PD
 19907*    THE EXTENSION DAYS.                                         *ELC50PD
 19908*                                                                *ELC50PD
 19909******************************************************************ELC50PD
 19910                                                                  ELC50PD
 19911     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.            ELC50PD
 19912     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.            ELC50PD
 19913                                                                  ELC50PD
 19914******************************************************************ELC50PD
 19915*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *ELC50PD
 19916*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*ELC50PD
 19917******************************************************************ELC50PD
 19918                                                                  ELC50PD
 19919     IF DC-ELAPSED-MONTHS GREATER THAN +0                         ELC50PD
 19920        COMPUTE WS-ODD-DAYS-OVER =                                ELC50PD
 19921               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER  ELC50PD
 19922     ELSE                                                         ELC50PD
 19923        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.             ELC50PD
 19924                                                                  ELC50PD
 19925     IF WS-ODD-DAYS-OVER = ZEROS                                  ELC50PD
 19926           GO TO 6499-EXIT                                        ELC50PD
 19927     ELSE                                                         ELC50PD
 19928        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY                     ELC50PD
 19929           IF WS-WDF-MONTH = 02                                   ELC50PD
 19930              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT         ELC50PD
 19931              ADD 2       TO  WS-ODD-DAYS-OVER                    ELC50PD
 19932              GO TO 6499-EXIT                                     ELC50PD
 19933           ELSE                                                   ELC50PD
 19934              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31    ELC50PD
 19935                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER                 ELC50PD
 19936                 GO TO 6499-EXIT                                  ELC50PD
 19937               ELSE                                               ELC50PD
 19938                 GO TO 6499-EXIT                                  ELC50PD
 19939        ELSE                                                      ELC50PD
 19940           GO TO 6499-EXIT.                                       ELC50PD
 19941                                                                  ELC50PD
 19942 6412-CHECK-TO-DAY.                                               ELC50PD
 19943                                                                  ELC50PD
 19944        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0         ELC50PD
 19945           IF WS-WDT-DAY = 28                                     ELC50PD
 19946              ADD 2              TO WS-ODD-DAYS-OVER              ELC50PD
 19947           ELSE                                                   ELC50PD
 19948              IF WS-WDT-DAY = 29                                  ELC50PD
 19949                 ADD 1           TO WS-ODD-DAYS-OVER              ELC50PD
 19950              ELSE                                                ELC50PD
 19951                 NEXT SENTENCE                                    ELC50PD
 19952        ELSE                                                      ELC50PD
 19953           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0        ELC50PD
 19954              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 362
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19955                                                                  ELC50PD
 19956     GO TO 6499-EXIT.                                             ELC50PD
 19957                                                                  ELC50PD
 19958                                                                  ELC50PD
 19959 6415-CHECK-LEAP-YEAR.                                            ELC50PD
 19960                                                                  ELC50PD
 19961     IF DC-DAYS-IN-MONTH = 29                                     ELC50PD
 19962        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.                         ELC50PD
 19963                                                                  ELC50PD
 19964 6415-EXIT.                                                       ELC50PD
 19965     EXIT.                                                        ELC50PD
 19966                                                                  ELC50PD
 19967 6499-EXIT.                                                       ELC50PD
 19968      EXIT.                                                       ELC50PD
 19969                                                                  ELC50PD
 19970 6500-END.                                                        ELC50PD
 19971     EXIT.
 19972
 19973                                                                  ELC50PD
 19974******************************************************************ELC50PD
 19975************* PROCEDURE DIVISION FOR EL050 ***********************ELC50PD
 19976********************** ELC50PD END *******************************ELC50PD
 19977                                                                  ELC50PD
 19978*
 19979*
 19980**START***********************************************************
 19981*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 19982*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT
 19983******************************************************************
 19984*
 19985 6600-GET-STATE-MUNICIPAL-TAX.
 19986
 19987     IF PB-COMPANY-ID NOT = 'DMD'
 19988         GO TO 6640-EXIT.
 19989
 19990     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19991     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19992     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19993
 19994*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19995     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19996     MOVE SPACES TO DC-ALPHA-CENTURY.
 19997     SET BIN-TO-GREG          TO TRUE.
 19998     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19999
 20000     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20001     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20002
 20003     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 20004     MOVE WS-ERRESS-KEY       TO ERRESS-PRIMARY-KEY
 20005                                 WS-SAVE-ERRESS-KEY.
 20006
 20007*POSITION FILE AT STARTING KEY RECORD(COMPANY, STATE, CATEGORY)
 20008*WANT RECORD WITH RES-EXPIRE-DT GREATER THAN PB-CERT-EFF-DT
 20009
 20010     START ERRESS KEY NOT LESS THAN ERRESS-PRIMARY-KEY.
 20011
 20012     IF ERRESS-FILE-STATUS NOT EQUAL '00'
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 363
* EL517.cbl
 20013         MOVE ER-8002        TO WS-ERROR
 20014         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20015         GO TO 6640-EXIT.
 20016
 20017*GET RECORD WHERE POSITIONED
 20018
 20019 6600-READ-ERRESS-NEXT.
 20020     READ ERRESS NEXT RECORD.
 20021
 20022     IF ERRESS-FILE-STATUS NOT EQUAL '00'
 20023         MOVE ER-8002        TO WS-ERROR
 20024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20025         GO TO 6640-EXIT.
 20026
 20027*GOT GOOD RECORD ??    FIRST 4 POSITIONS MUST MATCH
 20028
 20029     IF ERRESS-PRIMARY-KEY (1:4) = WS-SAVE-ERRESS-KEY (1:4)
 20030        NEXT SENTENCE
 20031     ELSE
 20032        MOVE ER-8002        TO WS-ERROR
 20033        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20034        GO TO 6640-EXIT.
 20035
 20036     IF WS-CONTRACT-DATE LESS THAN RES-EXPIRE-DATE
 20037        NEXT SENTENCE
 20038     ELSE
 20039        GO TO 6600-READ-ERRESS-NEXT.
 20040
 20041*IS IT LIFE(1) OR IS IT P&C(2) ?????
 20042*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA
 20043
 20044     MOVE +2                     TO WS-SUB1.
 20045
 20046     IF PB-CANCELLATION
 20047        IF PB-C-POLICY-FORM-NO (6:1) = '1'
 20048           MOVE +1               TO WS-SUB1.
 20049
 20050     IF PB-ISSUE
 20051        IF PB-I-POLICY-FORM-NO (6:1) = '1'
 20052           MOVE +1               TO WS-SUB1.
 20053
 20054*
 20055*CONVERT ANNIVERSARY DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 20056*
 20057     MOVE AM-AN-MO            TO WS-NEXT-CONTRACT-DATE (5:2).
 20058     MOVE AM-AN-DA            TO WS-NEXT-CONTRACT-DATE (7:2).
 20059     MOVE AM-AN-YR            TO WS-NEXT-CONTRACT-DATE (3:2).
 20060     MOVE AM-AN-CC            TO WS-NEXT-CONTRACT-DATE (1:2).
 20061
 20062
 20063*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 20064*TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 20065*TEST IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APPLIES
 20066
 20067     ADD 1                    TO WS-YEAR-YY.
 20068
 20069     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 20070         MOVE RES-REN-STATE-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 364
* EL517.cbl
 20071                              TO WS-RES-STATE-TAX
 20072         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
 20073                              TO WS-RES-MUNI-TAX
 20074     ELSE
 20075         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 20076                              TO WS-RES-STATE-TAX
 20077         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 20078                              TO WS-RES-MUNI-TAX.
 20079
 20080*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 20081
 20082     IF PB-CANCELLATION
 20083         GO TO 6640-CANCEL-TAX.
 20084
 20085     IF PB-I-LF-PREMIUM-AMT > ZEROS
 20086          COMPUTE PB-I-STATE-TAX ROUNDED =
 20087                                    PB-I-LF-PREMIUM-AMT
 20088                                  * WS-RES-STATE-TAX
 20089          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20090                                    PB-I-LF-PREMIUM-AMT
 20091                                  * WS-RES-MUNI-TAX
 20092     ELSE
 20093     IF PB-I-AH-PREMIUM-AMT > ZEROS
 20094          COMPUTE PB-I-STATE-TAX ROUNDED =
 20095                                    PB-I-AH-PREMIUM-AMT
 20096                                  * WS-RES-STATE-TAX
 20097          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20098                                    PB-I-AH-PREMIUM-AMT
 20099                                  * WS-RES-MUNI-TAX.
 20100
 20101     GO TO 6640-EXIT.
 20102
 20103 6640-CANCEL-TAX.
 20104     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 20105
 20106     IF PB-C-LF-CANCEL-AMT > ZEROS
 20107          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20108                                    PB-C-LF-CANCEL-AMT
 20109                                  * WS-RES-STATE-TAX
 20110          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20111                                    PB-C-LF-CANCEL-AMT
 20112                                  * WS-RES-MUNI-TAX
 20113     ELSE
 20114     IF PB-C-AH-CANCEL-AMT > ZEROS
 20115          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20116                                    PB-C-AH-CANCEL-AMT
 20117                                  * WS-RES-STATE-TAX
 20118          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20119                                    PB-C-AH-CANCEL-AMT
 20120                                  * WS-RES-MUNI-TAX.
 20121
 20122 6640-EXIT.
 20123     EXIT.
 20124
 20125 6650-GET-RES-STATE-COMM.
 20126
 20127     IF PB-COMPANY-ID NOT = 'DMD'
 20128         GO TO 6700-COMM-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 365
* EL517.cbl
 20129
 20130     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 20131     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 20132     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 20133     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 20134     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 20135     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 20136     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 20137
 20138*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20139
 20140     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20141     MOVE SPACES              TO DC-ALPHA-CENTURY.
 20142     SET BIN-TO-GREG          TO TRUE.
 20143     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20144
 20145     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20146     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20147
 20148     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 20149
 20150*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, ST,
 20151*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 20152*VALUE OF PB-CERT-EFF-DT
 20153
 20154     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
 20155     START ERRESC KEY NOT LESS THAN ERRESC-RECORD-KEY.
 20156
 20157     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20158         GO TO 6700-COMM-EXIT.
 20159
 20160*GET RECORD WHERE POSITIONED
 20161
 20162 6650-READ-ERRESC-NEXT.
 20163     READ ERRESC NEXT RECORD.
 20164
 20165     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20166         GO TO 6700-COMM-EXIT.
 20167
 20168     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 20169        NEXT SENTENCE
 20170     ELSE
 20171         GO TO 6700-COMM-EXIT.
 20172
 20173     IF WS-CONTRACT-DATE IS LESS THAN RESC-EXPIRE-DATE
 20174         NEXT SENTENCE
 20175       ELSE
 20176         GO TO 6650-READ-ERRESC-NEXT.
 20177
 20178*CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT ST
 20179*COMMISSION RECORD'S EFFECTIVE TIME PERIOD??
 20180
 20181     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
 20182         GO TO 6700-COMM-EXIT.
 20183
 20184* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 20185
 20186     MOVE ZEROS               TO WS-SUB WS-SUB1.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 366
* EL517.cbl
 20187
 20188     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 20189
 20190     IF WS-SUB1 > ZERO
 20191         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
 20192             PERFORM 6680-SET-COMMISSION
 20193         ELSE
 20194             PERFORM 6680-SET-TABLE-CODE.
 20195
 20196     GO TO 6700-COMM-EXIT.
 20197
 20198 6680-SET-TABLE-CODE.
 20199     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20200        MOVE ZEROS             TO WS-SUB1
 20201     ELSE
 20202* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20203* TO COMPUTE AH COMMISSION.
 20204        MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 20205        MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 20206        MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 20207        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 20208        PERFORM 6680-READ-CTBL-TABLE
 20209        IF ERCTBL-FILE-STATUS NOT = '00'
 20210           MOVE ZEROS          TO WS-SUB1.
 20211
 20212 6680-READ-CTBL-TABLE.
 20213*
 20214* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 20215* TO COMPUTE LIFE COMMISSION
 20216
 20217     IF CTBL-SW = '0540'
 20218        MOVE WS-LF-COMP-CD     TO CTBL-BEN-CODE
 20219        MOVE PB-I-LF-TERM      TO WS-WORK-TERM
 20220        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 20221
 20222     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 20223
 20224     IF CTBL-TABLE-FOUND
 20225        IF CTBL-SW = '0530'
 20226             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 20227                                        PB-I-AH-TERM
 20228             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20229             MOVE WS-WK-RATE        TO WS-COMMISSION
 20230                                       PB-I-AH-COMMISSION
 20231        ELSE
 20232             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 20233             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20234             MOVE WS-WK-RATE        TO WS-COMMISSION
 20235                                       PB-I-LIFE-COMMISSION
 20236     ELSE
 20237        IF FIRST-TIME-THROUGH
 20238            GO TO 6680-READ-CTBL-TABLE
 20239        ELSE
 20240            MOVE ZEROS         TO WS-SUB1.
 20241
 20242 6680-SET-COMMISSION.
 20243     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20244           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 367
* EL517.cbl
 20245       ELSE
 20246           MOVE RESC-COMMISSION-PER (WS-SUB)
 20247                             TO WS-COMMISSION
 20248           IF CTBL-SW = '0540'
 20249               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION
 20250           ELSE
 20251               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION.
 20252
 20253 6680-SEARCH-CATEGORY.
 20254     ADD +1                   TO WS-SUB.
 20255     IF WS-SUB > +12
 20256         GO TO 6680-EXIT.
 20257
 20258     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20259          MOVE WS-SUB         TO WS-SUB1
 20260          GO TO 6680-EXIT.
 20261
 20262     GO TO 6680-SEARCH-CATEGORY.
 20263
 20264 6680-EXIT.
 20265     EXIT.
 20266
 20267 6700-COMM-EXIT.
 20268     EXIT.
 20269**END*************************************************************
 20270*      CUSTOM CODING FOR CLIENT "DMD"
 20271******************************************************************
 20272*
 20273 7000-GET-RATE.
 20274     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20275
 20276 7000-EXIT.
 20277     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 368
* EL517.cbl
 20279
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 369
* EL517.cbl
 20281 7100-FIND-BENEFIT-IN-STATE.
 20282     MOVE 'N'                    TO BEN-SEARCH-SW.
 20283
 20284     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 20285         VARYING SUB3 FROM 1 BY 1 UNTIL
 20286            ((SUB3 GREATER 50) OR
 20287              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 20288               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 20289
 20290     IF SUB3 NOT = 51
 20291         IF CF-ST-BENEFIT-CD (SUB3) NOT = '00'
 20292             MOVE 'Y'            TO BEN-SEARCH-SW.
 20293
 20294     GO TO 7199-EXIT.
 20295
 20296 7100-BENEFIT-DUMMY.
 20297
 20298 7100-DUMMY-EXIT.
 20299     EXIT.
 20300
 20301 7199-EXIT.
 20302     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 370
* EL517.cbl
 20304 7200-FIND-BENEFIT.
 20305     MOVE 'N'                    TO BEN-SEARCH-SW.
 20306
 20307     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 20308         VARYING SUB3 FROM 1 BY 1 UNTIL
 20309            ((SUB3 GREATER 8) OR
 20310            (CF-BENEFIT-CODE (SUB3) = WS-BEN-CD)).
 20311
 20312     IF SUB3 NOT = 9
 20313         MOVE 'Y'                TO BEN-SEARCH-SW.
 20314
 20315     GO TO 7200-EXIT.
 20316
 20317 7200-BENEFIT-DUMMY.
 20318
 20319     EXIT.
 20320 7200-DUMMY-EXIT.
 20321     EXIT.
 20322
 20323 7200-EXIT.
 20324     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 371
* EL517.cbl
 20326 7250-LOOK-FOR-RESCINDED-CLAIM.
 20327
 20328     IF ELMSTR-OPEN = ' '
 20329         OPEN INPUT ELMSTR
 20330         MOVE 'X'                TO ELMSTR-OPEN
 20331         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20332             NEXT SENTENCE
 20333         ELSE
 20334             MOVE ELMSTR-FILE-STATUS
 20335                                 TO WS-ABEND-FILE-STATUS
 20336             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20337             MOVE EMSG           TO WS-ABEND-MESSAGE
 20338             GO TO ABEND-PGM.
 20339
 20340     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20341                                    W-CL-COMP-CD.
 20342     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20343                                    W-CL-CERT-NO.
 20344     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20345
 20346     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20347
 20348     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20349         GO TO 7250-EXIT.
 20350
 20351     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20352         GO TO 7250-CLAIMS-ERROR.
 20353
 20354 7250-NEXT-CLAIM.
 20355
 20356     READ ELMSTR NEXT.
 20357
 20358     IF ELMSTR-FILE-STATUS = '10'
 20359         GO TO 7250-EXIT.
 20360
 20361     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20362         GO TO 7250-CLAIMS-ERROR.
 20363
 20364     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20365        MSTR-CERT-NO NOT = CL-CERT-NO-A4
 20366         GO TO 7250-EXIT.
 20367
 20368     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20369        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20370        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20371        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20372        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20373         GO TO 7250-NEXT-CLAIM.
 20374
 20375     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20376        OR (CL-CLAIM-TYPE = 'I')
 20377        OR (CL-CLAIM-TYPE = 'G')
 20378          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20379              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 20380              GO TO 7250-EXIT
 20381          END-IF
 20382     END-IF.
 20383
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 372
* EL517.cbl
 20384     GO TO 7250-NEXT-CLAIM.
 20385
 20386 7250-CLAIMS-ERROR.
 20387
 20388     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20389     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20390     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20391     GO TO ABEND-PGM.
 20392
 20393 7250-EXIT.
 20394     EXIT.
 20395 7300-CHECK-FOR-OPEN-CLMS.
 20396
 20397     IF ELMSTR-OPEN = ' '
 20398         OPEN INPUT ELMSTR
 20399         MOVE 'X'                TO ELMSTR-OPEN
 20400         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20401             NEXT SENTENCE
 20402         ELSE
 20403             MOVE ELMSTR-FILE-STATUS
 20404                                 TO WS-ABEND-FILE-STATUS
 20405             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20406             MOVE EMSG           TO WS-ABEND-MESSAGE
 20407             GO TO ABEND-PGM.
 20408
 20409     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20410                                    W-CL-COMP-CD.
 20411     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20412                                    W-CL-CERT-NO.
 20413     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20414
 20415     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20416
 20417     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20418         GO TO 7300-EXIT.
 20419
 20420     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20421         GO TO 7300-CLAIMS-ERROR.
 20422
 20423     MOVE 'Y'                    TO W-BROWSE-SW.
 20424
 20425 7300-NEXT-CLAIM.
 20426
 20427     READ ELMSTR NEXT.
 20428
 20429     IF ELMSTR-FILE-STATUS = '10'
 20430         GO TO 7300-EXIT.
 20431
 20432     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20433         GO TO 7300-CLAIMS-ERROR.
 20434
 20435     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20436        MSTR-CERT-NO NOT = CL-CERT-NO-A4
 20437         GO TO 7300-EXIT.
 20438
 20439     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20440        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20441        PB-SV-STATE    NOT = CL-CERT-STATE    OR
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 373
* EL517.cbl
 20442        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20443        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20444         GO TO 7300-NEXT-CLAIM.
 20445
 20446     IF CL-CLAIM-TYPE = AH-OVERRIDE-L1
 20447        OR 'I' OR 'G'
 20448        IF CLAIM-IS-OPEN
 20449           EVALUATE TRUE
 20450             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20451                 MOVE ER-2884      TO WS-ERROR
 20452             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20453                 MOVE ER-2887      TO WS-ERROR
 20454             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20455                 MOVE ER-2886      TO WS-ERROR
 20456             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20457                 MOVE ER-2888      TO WS-ERROR
 20458             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20459                 MOVE ER-2885      TO WS-ERROR
 20460             WHEN OTHER
 20461                 MOVE ER-2768      TO WS-ERROR
 20462           END-EVALUATE
 20463           IF PB-C-AH-CANCEL-VOIDED OR
 20464              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20465                NOT AH-COVERAGE-CANCELLED)
 20466               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20467               MOVE ER-2768      TO WS-ERROR
 20468           END-IF
 20469           PERFORM 9900-ERROR-FORMAT
 20470                                 THRU 9900-EXIT
 20471           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20472              PB-FORCE-CODE NOT EQUAL '8'
 20473               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20474           END-IF
 20475           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20476           GO TO 7300-EXIT
 20477        ELSE
 20478           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20479*****THIS IS A RESCISSION OR REFORMATION
 20480              IF (AH-COVERAGE-CANCELLED AND
 20481                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 20482                    MOVE ER-2890 TO WS-ERROR
 20483                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20484                    GO TO 7300-EXIT
 20485              END-IF
 20486           ELSE
 20487              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20488               AND PB-C-AH-CANCEL-DT > SPACES
 20489                 MOVE ER-2756       TO WS-ERROR
 20490                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20491                 GO TO 7300-EXIT
 20492              END-IF
 20493           END-IF
 20494        END-IF
 20495     ELSE
 20496        IF CL-CLAIM-TYPE = LIFE-OVERRIDE-L1
 20497           IF CLAIM-IS-OPEN
 20498              MOVE ER-2889    TO WS-ERROR
 20499              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 374
* EL517.cbl
 20500              GO TO 7300-EXIT
 20501           ELSE
 20502              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20503*****THIS IS A RESCISSION OR REFORMATION
 20504                 IF (LF-COVERAGE-CANCELLED AND
 20505                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20506                       MOVE ER-2890 TO WS-ERROR
 20507                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20508                       GO TO 7300-EXIT
 20509                 END-IF
 20510              ELSE
 20511                 IF (AH-COVERAGE-CANCELLED AND
 20512                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 20513                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 20514                    (LF-COVERAGE-CANCELLED AND
 20515                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 20516                     WS-ST-REFUND-CLAIM-FLAG = '4')
 20517                       MOVE ER-2965 TO WS-ERROR
 20518                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20519                       GO TO 7300-EXIT
 20520                 END-IF
 20521                 IF LF-COVERAGE-CANCELLED
 20522                  IF CL-TOTAL-PAID-AMT > 0
 20523                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20524                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20525                        MOVE ER-2891 TO WS-ERROR
 20526                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20527                        GO TO 7300-EXIT
 20528                      END-IF
 20529                    ELSE
 20530                      MOVE ER-2892 TO WS-ERROR
 20531                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20532                      GO TO 7300-EXIT
 20533                    END-IF
 20534                  END-IF
 20535                 END-IF
 20536              END-IF
 20537           END-IF
 20538        END-IF
 20539     END-IF
 20540
 20541     GO TO 7300-NEXT-CLAIM.
 20542
 20543 7300-CLAIMS-ERROR.
 20544
 20545     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20546     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20547     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20548     GO TO ABEND-PGM.
 20549
 20550 7300-EXIT.
 20551     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 375
* EL517.cbl
 20553
 20554 7400-GET-REMAIN-TERM.
 20555     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20556
 20557 7400-EXIT.
 20558     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 376
* EL517.cbl
 20560
 20561 7500-GET-REMAIN-AMOUNT.
 20562     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 20563
 20564 7500-EXIT.
 20565     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 377
* EL517.cbl
 20567
 20568 7600-GET-REFUND.
 20569     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 20570
 20571 7600-EXIT.
 20572     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 378
* EL517.cbl
 20574
 20575 7700-CALL-DL1.
 20576     MOVE 'P'                    TO DMPF-PROCESS-TYPE.
 20577     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 20578
 20579 7700-EXIT.
 20580     EXIT.
 20581
 20582 7710-CALL-DL2.
 20583     MOVE 'P'                    TO DIPF-PROCESS-TYPE.
 20584     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 20585
 20586 7710-EXIT.
 20587     EXIT.
 20588
 20589 7720-CALL-DL3.
 20590     MOVE 'P'                    TO DVBI-PROCESS-TYPE.
 20591     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 20592
 20593 7720-EXIT.
 20594     EXIT.
 20595
 20596 7730-CALL-DL7.
 20597     MOVE 'P'                    TO DCUA-PROCESS-TYPE.
 20598     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 20599
 20600 7730-EXIT.
 20601     EXIT.
 20602
 20603 7740-CALL-DL11.
 20604     MOVE 'P'                    TO DPRB-PROCESS-TYPE.
 20605     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 20606
 20607 7740-EXIT.
 20608     EXIT.
 20609
 20610 7750-CALL-DL17.
 20611     MOVE 'P'                    TO DVRC-PROCESS-TYPE.
 20612     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 20613
 20614 7750-EXIT.
 20615     EXIT.
 20616
 20617 7755-CALL-DL19.
 20618     MOVE 'P'                    TO DOCC-PROCESS-TYPE.
 20619     CALL 'DLB019' USING  WS-DLB-ORIG-COV-CAT.
 20620
 20621 7755-EXIT.
 20622     EXIT.
 20623
 20624 7760-CALL-DL21.
 20625     CALL 'DLB021' USING  WS-DLB-VALID-LOAN-OFFICER.
 20626
 20627 7760-EXIT.
 20628     EXIT.
 20629
 20630 7770-CALL-DL22.
 20631     MOVE 'P'                    TO DVSC-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 379
* EL517.cbl
 20632     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 20633
 20634 7770-EXIT.
 20635     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 380
* EL517.cbl
 20637
 20638 7800-REWRITE-CERT.
 20639     REWRITE CERTIFICATE-MASTER.
 20640     ADD 1 TO WCER.
 20641
 20642 7800-EXIT.
 20643      EXIT.
 20644     EXIT.
 20645
 20646 8000-WRITE-CERT.
 20647
 20648     WRITE CERTIFICATE-MASTER.
 20649     ADD 1 TO WCER.
 20650     IF ELCERT-FILE-STATUS NOT = '00'
 20651         GO TO 8000-FREE-MAIN.
 20652
 20653 8000-FREE-MAIN.
 20654
 20655 8000-EXIT.
 20656     EXIT.
 20657      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 381
* EL517.cbl
 20659
 20660 8100-READ-ERPNDM.
 20661     IF ERPNDM-OPEN = ' '
 20662        OPEN INPUT ERPNDM
 20663        MOVE 'X' TO ERPNDM-OPEN
 20664        IF ERPNDM-FILE-STATUS = '00' OR '97'
 20665           NEXT SENTENCE
 20666        ELSE
 20667           MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20668           MOVE 'ERPNDM'              TO WS-FEM-FILE-NAME
 20669           MOVE EMSG TO WS-ABEND-MESSAGE
 20670           GO TO ABEND-PGM.
 20671
 20672     MOVE SPACES                 TO ERPNDM-FOUND.
 20673     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20674     READ ERPNDM.
 20675
 20676     IF ERPNDM-FILE-STATUS  = '00'
 20677        CONTINUE
 20678     ELSE
 20679        MOVE 'X'                 TO ERPNDM-FOUND
 20680        MOVE ER-2694             TO WS-ERROR
 20681        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20682        MOVE ER-2883             TO WS-ERROR
 20683        PERFORM 9900-ERROR-FORMAT
 20684                                 THRU 9900-EXIT
 20685     END-IF
 20686
 20687     .
 20688 8100-EXIT.
 20689     EXIT.
 20690
 20691 8110-READ-ERMAIL.
 20692     IF ERMAIL-OPEN = ' '
 20693        OPEN  I-O ERMAIL
 20694        MOVE 'X' TO ERMAIL-OPEN
 20695        IF ERMAIL-FILE-STATUS = '00' OR '97'
 20696           NEXT SENTENCE
 20697        ELSE
 20698            MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20699            MOVE 'ERMAIL'              TO WS-FEM-FILE-NAME
 20700            MOVE EMSG TO WS-ABEND-MESSAGE
 20701            GO TO ABEND-PGM.
 20702
 20703     MOVE SPACES                 TO ERMAIL-FOUND.
 20704     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20705     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20706     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20707     MOVE PB-SV-STATE            TO MA-STATE.
 20708
 20709     READ ERMAIL.
 20710
 20711     IF ERMAIL-FILE-STATUS  = '00'
 20712         NEXT SENTENCE
 20713       ELSE
 20714        MOVE 'X'                 TO ERMAIL-FOUND.
 20715
 20716 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 382
* EL517.cbl
 20717     EXIT.
 20718
 20719 8120-REWRITE-ERMAIL.
 20720     REWRITE MAILING-DATA.
 20721
 20722 8120-EXIT.
 20723     EXIT.
 20724
 20725 8130-WRITE-ERMAIL.
 20726     WRITE MAILING-DATA.
 20727
 20728 8130-EXIT.
 20729     EXIT.
 20730
 20731 8140-UNLOCK-ERMAIL.
 20732     MOVE SPACES                 TO ERMAIL-FOUND.
 20733
 20734 8140-EXIT.
 20735     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 383
* EL517.cbl
 20737
 20738 8180-UPDATE-VIN-NUMBER.
 20739
 20740     IF ELCRTT-OPEN = ' '
 20741         OPEN I-O ELCRTT
 20742         MOVE 'X' TO ELCRTT-OPEN
 20743         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20744             NEXT SENTENCE
 20745         ELSE
 20746             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20747             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20748             MOVE EMSG               TO WS-ABEND-MESSAGE
 20749             GO TO ABEND-PGM
 20750         END-IF
 20751     END-IF.
 20752
 20753     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20754     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20755     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20756
 20757     READ ELCRTT.
 20758
 20759     IF ELCRTT-FILE-STATUS  = '00'
 20760        CONTINUE
 20761     ELSE
 20762        GO TO 8180-NOTFND
 20763     END-IF.
 20764
 20765     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20766         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20767         REWRITE CERTIFICATE-TRAILERS
 20768     END-IF.
 20769
 20770     GO TO 8180-EXIT.
 20771
 20772 8180-NOTFND.
 20773
 20774     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20775     MOVE 'CS'         TO CS-RECORD-ID.
 20776     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20777     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20778     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20779     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20780     WRITE CERTIFICATE-TRAILERS.
 20781
 20782 8180-EXIT.
 20783     EXIT.
 20784
 20785 8190-UPDATE-REFUND-CLAIM-FLAG.
 20786
 20787     IF ELCRTT-OPEN = ' '
 20788         OPEN I-O ELCRTT
 20789         MOVE 'X' TO ELCRTT-OPEN
 20790         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20791             NEXT SENTENCE
 20792         ELSE
 20793             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20794             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 384
* EL517.cbl
 20795             MOVE EMSG               TO WS-ABEND-MESSAGE
 20796             GO TO ABEND-PGM
 20797         END-IF
 20798     END-IF.
 20799
 20800     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20801     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20802     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20803
 20804     READ ELCRTT.
 20805
 20806     IF ELCRTT-FILE-STATUS  = '00'
 20807        CONTINUE
 20808     ELSE
 20809        GO TO 8190-NOTFND
 20810     END-IF.
 20811
 20812     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20813     REWRITE CERTIFICATE-TRAILERS.
 20814
 20815     GO TO 8190-EXIT.
 20816
 20817 8190-NOTFND.
 20818
 20819     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20820     MOVE 'CS'         TO CS-RECORD-ID.
 20821     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20822     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20823     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20824     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20825     WRITE CERTIFICATE-TRAILERS.
 20826
 20827 8190-EXIT.
 20828     EXIT.
 20829
 20830 8195-UPDATE-AGE-FLAGS.
 20831     IF ELCRTT-OPEN = ' '
 20832         OPEN I-O ELCRTT
 20833         MOVE 'X' TO ELCRTT-OPEN
 20834         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20835             NEXT SENTENCE
 20836         ELSE
 20837             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20838             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20839             MOVE EMSG               TO WS-ABEND-MESSAGE
 20840             GO TO ABEND-PGM
 20841         END-IF
 20842     END-IF.
 20843
 20844     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20845     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20846     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20847
 20848     READ ELCRTT.
 20849
 20850     IF ELCRTT-FILE-STATUS  = '00'
 20851        CONTINUE
 20852     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 385
* EL517.cbl
 20853        GO TO 8195-NOTFND
 20854     END-IF.
 20855
 20856     IF WS-INS-AGE-SET = 'Y'
 20857        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20858     END-IF
 20859     IF WS-JNT-AGE-SET = 'Y'
 20860        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20861     END-IF
 20862
 20863     REWRITE CERTIFICATE-TRAILERS.
 20864
 20865     GO TO 8195-EXIT.
 20866
 20867 8195-NOTFND.
 20868
 20869     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20870     MOVE 'CS'         TO CS-RECORD-ID.
 20871     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20872     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20873     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20874     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20875     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20876     WRITE CERTIFICATE-TRAILERS.
 20877
 20878 8195-EXIT.
 20879     EXIT.
 20880
 20881 8200-READ-REIN-TABLE.
 20882     MOVE ERREIN-KEY TO RE-CONTROL-PRIMARY.
 20883     READ ERREIN.
 20884     ADD 1 TO RREI.
 20885
 20886     IF RE-CODE NOT = 'A'
 20887        PERFORM REIN-DATE-LOAD.
 20888
 20889     IF ERREIN-FILE-STATUS NOT = '00'
 20890          GO TO 8200-NOTFND.
 20891
 20892     GO TO 8200-EXIT.
 20893
 20894 8200-NOTFND.
 20895     MOVE 'N'                TO WS-REIN-READ-SW.
 20896
 20897 8200-EXIT.
 20898     EXIT.
 20899      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 386
* EL517.cbl
 20901
 20902 8300-READ-CTBL-TABLE.
 20903     MOVE ERCTBL-KEY TO CT-CONTROL-PRIMARY.
 20904     READ ERCTBL.
 20905     ADD 1 TO RCTB.
 20906
 20907     IF ERCTBL-FILE-STATUS NOT = '00'
 20908         GO TO 8300-NOTFND.
 20909
 20910     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20911
 20912     GO TO 8300-EXIT.
 20913
 20914 8300-NOTFND.
 20915     IF CTBL-SW = '0530'
 20916         MOVE 'AA'                     TO WS-AH-COMP-CD
 20917         MOVE '0550'                   TO CTBL-SW
 20918         MOVE '1'                      TO WS-CTBL-READ-SW
 20919         GO TO 8300-EXIT.
 20920
 20921     IF CTBL-SW = '0540'
 20922         MOVE 'AA'                     TO WS-LF-COMP-CD
 20923         MOVE '0550'                   TO CTBL-SW
 20924         MOVE '1'                      TO WS-CTBL-READ-SW
 20925         GO TO 8300-EXIT.
 20926
 20927     IF CTBL-SW = '0550'
 20928         MOVE '2'                      TO WS-CTBL-READ-SW
 20929         GO TO 8300-EXIT.
 20930
 20931 8300-EXIT.
 20932      EXIT.
 20933     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 387
* EL517.cbl
 20935
 20936 8400-GETMAIN-ERFORM.
 20937*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 20938     EXIT.
 20939 8400-EXIT.
 20940     EXIT.
 20941
 20942 8450-READ-FORM-MASTER.
 20943
 20944     MOVE ERFORM-KEY             TO FO-CONTROL-PRIMARY
 20945
 20946     START ERFORM KEY NOT LESS THAN FO-CONTROL-PRIMARY.
 20947
 20948     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 20949        GO TO 8450-FORM-NOT-FOUND.
 20950
 20951     READ ERFORM NEXT.
 20952
 20953     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 20954        GO TO 8450-FORM-NOT-FOUND.
 20955
 20956     MOVE 'Y'                    TO FORM-MASTER-SW.
 20957     GO TO 8450-EXIT.
 20958
 20959 8450-FORM-NOT-FOUND.
 20960
 20961     MOVE 'N'                    TO FORM-MASTER-SW.
 20962
 20963 8450-EXIT.
 20964     EXIT.
 20965
 20966 8500-DATE-CONVERT.
 20967     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 20968
 20969 8500-EXIT.
 20970     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 388
* EL517.cbl
 20972
 20973 8555-RELOAD-CONTROL-FILE.
 20974     MOVE HOLD-ELCNTL (ELCNTL-POINTER) TO  CONTROL-FILE.
 20975
 20976 8555-EXIT.
 20977     EXIT.
 20978
 20979 8557-GETMAIN-ERPLAN.
 20980*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 20981     EXIT.
 20982 8557-EXIT.
 20983     EXIT.
 20984
 20985 8560-GETMAIN.
 20986      MOVE 999 TO ERACCT-POINTER.
 20987
 20988 8560-EXIT.
 20989     EXIT.
 20990
 20991 8570-START-ACCOUNT-MASTER.
 20992     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 20993
 20994 8570-EXIT.
 20995     EXIT.
 20996
 20997 8580-READ-ACCOUNT-MASTER.
 20998     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 20999
 21000     IF WS-BROWSE-STARTED-SW = 'Y'
 21001         START ERACCT KEY NOT LESS THAN AM-CONTROL-BY-VAR-GRP.
 21002
 21003     IF ERACCT-FILE-STATUS = '23'
 21004         MOVE HIGH-VALUE TO ERACCT-KEY
 21005         GO TO 8580-EXIT.
 21006
 21007     IF ERACCT-FILE-STAT-1 = '9'
 21008         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21009         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21010         MOVE RMSG TO WS-ABEND-MESSAGE
 21011         GO TO ABEND-PGM.
 21012
 21013     MOVE SPACE TO WS-BROWSE-STARTED-SW.
 21014
 21015     READ ERACCT NEXT.
 21016     ADD 1 TO RACC.
 21017
*21018     COPY ELCACCTI.
 21019******************************************************************04/14/98
 21020*                                                                *ELCACCTI
 21021*                            ELCACCTI                            *   LV003
 21022*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21023*                            VMOD=2.001                          *ELCACCTI
 21024*                                                                *ELCACCTI
 21025*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
 21026*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
 21027*                                                                *ELCACCTI
 21028*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
 21029*                                                                *ELCACCTI
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 389
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTI)
 21030******************************************************************ELCACCTI
 21031     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
 21032     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
 21033     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
 21034     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
 21035     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
 21036     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
 21037     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
 21038     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
 21039     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
 21040
 21041     IF ERACCT-FILE-STAT-1 = '9'
 21042         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21043         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21044         MOVE RMSG TO WS-ABEND-MESSAGE
 21045         GO TO ABEND-PGM.
 21046
 21047     IF ERACCT-FILE-STATUS NOT = '00'
 21048         MOVE HIGH-VALUE TO ERACCT-KEY
 21049         GO TO 8580-EXIT.
 21050
 21051     MOVE AM-CONTROL-BY-VAR-GRP TO ERACCT-KEY.
 21052
 21053 8580-EXIT.
 21054     EXIT.
 21055
 21056 8582-READ-COMPENSATION-MASTER.
 21057     MOVE ERCOMP-KEY TO CO-CONTROL-PRIMARY
 21058
 21059     READ ERCOMP
 21060
 21061     IF ERCOMP-FILE-STATUS NOT = '00'
 21062        GO TO 8582-COMP-NOT-FOUND
 21063     END-IF
 21064
 21065     MOVE 'Y'                    TO COMP-MASTER-SW.
 21066     GO TO 8582-EXIT
 21067     .
 21068 8582-COMP-NOT-FOUND.
 21069
 21070     MOVE 'N'                    TO COMP-MASTER-SW.
 21071
 21072 8582-EXIT.
 21073     EXIT.
 21074
 21075 8583-READ-ERAGTC.
 21076
 21077     MOVE ERAGTC-KEY TO AG-CONTROL-PRIMARY
 21078
 21079     START ERAGTC KEY IS NOT < AG-CONTROL-PRIMARY
 21080
 21081     IF ERAGTC-FILE-STATUS NOT = '00'
 21082        GO TO 8583-AGTC-NOT-FOUND
 21083     END-IF
 21084
 21085     .
 21086 8583-READ-ERAGTC-NEXT.
 21087
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 390
* EL517.cbl
 21088     READ ERAGTC NEXT RECORD
 21089
 21090     IF ERAGTC-FILE-STATUS NOT = '00'
 21091        GO TO 8583-AGTC-NOT-FOUND
 21092     END-IF
 21093
 21094*    MOVE 'Y'                    TO AGTC-MASTER-SW.
 21095     GO TO 8583-EXIT
 21096     .
 21097 8583-AGTC-NOT-FOUND.
 21098
 21099     MOVE 'N'                    TO AGTC-MASTER-SW.
 21100
 21101 8583-EXIT.
 21102     EXIT.
 21103
 21104 8584-READ-BANK-CROSS-REF.
 21105     MOVE ERBXRF-KEY TO BK-CONTROL-PRIMARY
 21106
 21107     READ ERBXRF
 21108
 21109     IF ERBXRF-FILE-STATUS NOT = '00'
 21110        GO TO 8584-BXRF-NOT-FOUND
 21111     END-IF
 21112
 21113     MOVE 'Y'                    TO BXRF-MASTER-SW.
 21114     GO TO 8584-EXIT
 21115     .
 21116 8584-BXRF-NOT-FOUND.
 21117
 21118     MOVE 'N'                    TO BXRF-MASTER-SW.
 21119
 21120 8584-EXIT.
 21121     EXIT.
 21122
 21123 8585-READ-PLAN-MASTER.
 21124
 21125     MOVE ERPLAN-KEY             TO PL-CONTROL-PRIMARY.
 21126
 21127     READ ERPLAN.
 21128
 21129     IF ERPLAN-FILE-STATUS NOT EQUAL '00'
 21130        GO TO 8585-PLAN-NOT-FOUND.
 21131
 21132     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21133     GO TO 8585-EXIT.
 21134
 21135 8585-PLAN-NOT-FOUND.
 21136
 21137     MOVE 'N'                    TO PLAN-MASTER-SW.
 21138
 21139 8585-EXIT.
 21140     EXIT.
 21141
 21142 8586-READ-LOAN-OFFICER.
 21143
 21144     MOVE ERLOFC-KEY             TO LO-CONTROL-PRIMARY
 21145
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 391
* EL517.cbl
 21146     READ ERLOFC
 21147
 21148     IF ERLOFC-FILE-STATUS NOT = '00'
 21149        MOVE 'N'                 TO LOFC-MASTER-SW
 21150     ELSE
 21151        MOVE 'Y'                 TO LOFC-MASTER-SW
 21152     END-IF
 21153
 21154     .
 21155 8586-EXIT.
 21156     EXIT.
 21157
 21158
 21159 8587-START-ERPDEF.
 21160
 21161     MOVE ERPDEF-KEY             TO PD-CONTROL-PRIMARY
 21162
 21163     START ERPDEF KEY >= PD-CONTROL-PRIMARY
 21164     IF ERPDEF-FILE-STATUS NOT = '00'
 21165        MOVE 'N'                 TO PDEF-MASTER-SW
 21166     ELSE
 21167        MOVE 'Y'                 TO PDEF-MASTER-SW
 21168     END-IF
 21169
 21170
 21171     .
 21172 8587-EXIT.
 21173     EXIT.
 21174
 21175 8588-READ-ERPDEF.
 21176
 21177     READ ERPDEF NEXT RECORD
 21178
 21179     IF ERPDEF-FILE-STATUS NOT = '00'
 21180        MOVE 'N'                 TO PDEF-MASTER-SW
 21181     ELSE
 21182        MOVE 'Y'                 TO PDEF-MASTER-SW
 21183     END-IF
 21184
 21185     .
 21186 8588-EXIT.
 21187     EXIT.
 21188
 21189 8589-ENDBR-ERPDEF.
 21190
 21191     .
 21192 8589-EXIT.
 21193     EXIT.
 21194
 21195 8590-READ-CERT-MASTER.
 21196     MOVE ELCERT-KEY TO CM-CONTROL-PRIMARY.
 21197     READ ELCERT.
 21198     ADD 1 TO RCER.
 21199
 21200     IF ELCERT-FILE-STATUS NOT = '00'
 21201         NEXT SENTENCE
 21202     ELSE
 21203         GO TO 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 392
* EL517.cbl
 21204
 21205     MOVE '1'                     TO CERT-STATUS-SW.
 21206
 21207     IF PB-COMPANY-ID = 'UCL'
 21208         IF WS-ERROR = ER-2799
 21209             GO TO 8590-EXIT.
 21210
 21211     IF PB-CANCELLATION
 21212        MOVE ER-2726              TO  WS-ERROR
 21213        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 21214        IF ACCOUNT-MAST-FOUND
 21215           MOVE AM-EXPIRATION-DT  TO  PB-ACCT-EXP-DT
 21216           MOVE AM-EFFECTIVE-DT   TO  PB-ACCT-EFF-DT
 21217           GO TO 8590-EXIT
 21218        ELSE
 21219           GO TO 8590-EXIT.
 21220
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 393
* EL517.cbl
 21222
 21223 8590-EXIT.
 21224     EXIT.
 21225
 21226 8750-START-ELSTAT.
 21227
 21228     MOVE ELSTAT-KEY             TO SF-CONTROL-PRIMARY
 21229
 21230     START ELSTAT KEY >= SF-CONTROL-PRIMARY
 21231     IF ELSTAT-FILE-STATUS NOT = '00'
 21232        MOVE 'N'                 TO STAT-MASTER-SW
 21233     ELSE
 21234        MOVE 'Y'                 TO STAT-MASTER-SW
 21235     END-IF
 21236
 21237     .
 21238 8750-EXIT.
 21239     EXIT.
 21240
 21241 8752-READ-ELSTAT.
 21242
 21243     READ ELSTAT NEXT RECORD
 21244
 21245     IF ELSTAT-FILE-STATUS NOT = '00'
 21246        MOVE 'N'                 TO STAT-MASTER-SW
 21247     ELSE
 21248        MOVE 'Y'                 TO STAT-MASTER-SW
 21249     END-IF
 21250
 21251     .
 21252 8752-EXIT.
 21253     EXIT.
 21254
 21255 8800-GET-COMP-RATE.
 21256     MOVE +1 TO IB.
 21257     IF WS-COMM-CK-AMT > CT-TBF (1)
 21258         ADD +9 TO IB
 21259         IF WS-COMM-CK-AMT > CT-TBF (2)
 21260             ADD +9 TO IB
 21261             IF WS-COMM-CK-AMT > CT-TBF (3)
 21262                MOVE ZEROS       TO WS-WK-RATE
 21263                GO TO 8800-EXIT.
 21264
 21265     IF PB-I-AGE > CT-AGE (1)
 21266         ADD +3 TO IB
 21267         IF PB-I-AGE > CT-AGE (2)
 21268             ADD +3 TO IB
 21269             IF PB-I-AGE > CT-AGE (3)
 21270                MOVE ZEROS       TO WS-WK-RATE
 21271                GO TO 8800-EXIT.
 21272
 21273     IF WS-WORK-TERM > CT-TRM (1)
 21274         ADD +1 TO IB
 21275         IF WS-WORK-TERM > CT-TRM (2)
 21276             ADD +1 TO IB
 21277             IF WS-WORK-TERM > CT-TRM (3)
 21278                MOVE ZEROS       TO WS-WK-RATE
 21279                GO TO 8800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 394
* EL517.cbl
 21280
 21281     IF CT-RT (IB) NOT NUMERIC
 21282         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21283         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21284         GO TO 8800-GET-COMP-RATE.
 21285
 21286     MOVE CT-RT (IB) TO WS-WK-RATE.
 21287
 21288 8800-EXIT.
 21289     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 395
* EL517.cbl
 21291
 21292 8900-ADDRESS-FILE.
 21293     EXIT.
 21294 8900-ADDRESS-EXIT.
 21295     EXIT.
 21296
 21297 9000-READ-CONTROL.
 21298     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21299     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21300
 21301     IF ELCNTL-FILE-STATUS NOT = '00'
 21302         GO TO 9000-NOTFND.
 21303
 21304     READ ELCNTL NEXT.
 21305     ADD 1 TO RCNT.
 21306
 21307     IF ELCNTL-FILE-STATUS NOT = '00'
 21308         GO TO 9000-NOTFND.
 21309
 21310     IF CNTL-REC-TYPE = '1'
 21311         MOVE CONTROL-FILE TO HOLD-ELCNTL (1)
 21312         MOVE 1            TO ELCNTL-POINTER.
 21313
 21314     IF CNTL-REC-TYPE = '6'
 21315         MOVE CONTROL-FILE TO HOLD-ELCNTL (6)
 21316         MOVE 6            TO ELCNTL-POINTER.
 21317
 21318     GO TO 9000-EXIT.
 21319
 21320 9000-NOTFND.
 21321     IF RC-SW-1 = '1'
 21322         MOVE ER-2616             TO WS-ERROR
 21323         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21324         GO TO 9000-EXIT.
 21325
 21326     IF RC-SW-1 = '2'
 21327         MOVE ER-2602             TO WS-ERROR
 21328         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21329         GO TO 9000-EXIT.
 21330
 21331     GO TO 9000-EXIT.
 21332
 21333 9000-EXIT.
 21334     EXIT.
 21335      EXIT.
 21336
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 396
* EL517.cbl
 21338 9100-READ-CONTROL.
 21339     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21340     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21341
 21342     IF ELCNTL-FILE-STATUS NOT = '00'
 21343         GO TO 9100-NOTFND.
 21344
 21345     READ ELCNTL NEXT.
 21346     ADD 1 TO RCNT.
 21347
 21348     IF ELCNTL-FILE-STATUS NOT = '00'
 21349         GO TO 9100-NOTFND.
 21350
 21351     IF CNTL-REC-TYPE = '3'
 21352         MOVE CONTROL-FILE TO HOLD-ELCNTL (3)
 21353         MOVE 3            TO ELCNTL-POINTER
 21354         GO TO 9100-EXIT.
 21355
 21356     IF CNTL-REC-TYPE = '4'
 21357         MOVE CONTROL-FILE TO HOLD-ELCNTL (4)
 21358         MOVE 4            TO ELCNTL-POINTER
 21359         GO TO 9100-EXIT.
 21360
 21361     IF CNTL-REC-TYPE = '5'
 21362         MOVE CONTROL-FILE TO HOLD-ELCNTL (5)
 21363         MOVE 5            TO ELCNTL-POINTER
 21364         GO TO 9100-EXIT.
 21365
 21366     IF CNTL-REC-TYPE = 'L'
 21367         MOVE CONTROL-FILE TO HOLD-ELCNTL (10)
 21368         MOVE 10           TO ELCNTL-POINTER
 21369         GO TO 9100-EXIT.
 21370
 21371     IF CNTL-REC-TYPE = 'A'
 21372         MOVE CONTROL-FILE TO HOLD-ELCNTL (11)
 21373         MOVE 11           TO ELCNTL-POINTER
 21374         GO TO 9100-EXIT.
 21375
 21376 9100-NOTFND.
 21377     DISPLAY 'CTL FILE NOT FOUND ' RC-SW-2 ' KEY='  ELCNTL-KEY.
 21378
 21379     IF RC-SW-2 = '1'
 21380        MOVE '1'                 TO LF-BENEFIT-ERROR
 21381        MOVE ER-2604             TO WS-ERROR
 21382        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21383        GO TO 9100-EXIT.
 21384
 21385     IF RC-SW-2 = '2'
 21386        MOVE '1'                 TO AH-BENEFIT-ERROR
 21387        MOVE ER-2605             TO WS-ERROR
 21388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21389        GO TO 9100-EXIT.
 21390
 21391     IF RC-SW-2 = '3'
 21392        MOVE ER-2603             TO WS-ERROR
 21393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21394        GO TO 9100-EXIT.
 21395
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 397
* EL517.cbl
 21396     IF RC-SW-2 = '4'
 21397         MOVE PB-I-LF-INPUT-CD   TO PB-I-LF-BENEFIT-CD
 21398         GO TO 9100-EXIT.
 21399
 21400     IF RC-SW-2 = '5'
 21401         MOVE PB-I-AH-INPUT-CD   TO WS-AH-INPUT-CD
 21402         IF WS-AH-INPUT-CD-1 = SPACE
 21403             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21404         ELSE
 21405             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21406
 21407 9100-EXIT.
 21408     EXIT.
 21409      EXIT.
 21410
 21411 9200-CONTROL-GETMAIN.
 21412*    ESTABLISH LINKAGE AREA FOR CONTROL FILE.
 21413     EXIT.
 21414 9200-EXIT.
 21415     EXIT.
 21416
 21417 9250-UNLOCK-RETURN.
 21418*  DUMMIED IN THE BATCH EL517 ....
 21419     EXIT.
 21420 9250-UNLOCK-EXIT.
 21421     EXIT.
 21422      EXIT.
 21423
 21424 9300-ACCUM-BATCH-TOTALS.
 21425         IF PB-ISSUE
 21426             ADD PB-I-LF-PREM-CALC       TO WS-LF-ISS-COMPUTED
 21427             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21428             ADD PB-I-LF-PREMIUM-AMT     TO WS-LF-ISS-ENTERED
 21429             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21430             ADD PB-I-AH-PREM-CALC       TO WS-AH-ISS-COMPUTED
 21431             ADD PB-I-AH-PREMIUM-AMT     TO WS-AH-ISS-ENTERED
 21432             ADD 1                       TO WS-ISSUE-CNT
 21433         ELSE
 21434             ADD PB-C-LF-REF-CALC        TO WS-LF-CAN-COMPUTED
 21435             ADD PB-C-LF-CANCEL-AMT      TO WS-LF-CAN-ENTERED
 21436             ADD PB-C-AH-REF-CALC        TO WS-AH-CAN-COMPUTED
 21437             ADD PB-C-AH-CANCEL-AMT      TO WS-AH-CAN-ENTERED
 21438             ADD 1                       TO WS-CANCEL-CNT.
 21439
 21440 9400-EXIT.
 21441     EXIT.
 21442
 21443 9990-RETURN.
 21444*    END BROUSE OF ACCOUNT FILE
 21445     EXIT.
 21446
 21447 9990-EXIT.
 21448     EXIT.
 21449
 21450
 21451****Check for CRTO record, add one if not found.
 21452 9991-CHECK-FOR-ELCRTO.
 21453     IF ELCRTO-OPEN = ' '
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 398
* EL517.cbl
 21454         OPEN I-O ELCRTO
 21455         MOVE 'X' TO ELCRTO-OPEN
 21456         IF ELCRTO-FILE-STATUS   = '00' OR '97'
 21457             NEXT SENTENCE
 21458         ELSE
 21459             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21460             MOVE 'ELCRTO'           TO WS-FEM-FILE-NAME
 21461             MOVE EMSG               TO WS-ABEND-MESSAGE
 21462             GO TO ABEND-PGM
 21463         END-IF
 21464     END-IF.
 21465     IF ELCRTT-OPEN = ' '
 21466         OPEN I-O ELCRTT
 21467         MOVE 'X' TO ELCRTT-OPEN
 21468         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 21469             NEXT SENTENCE
 21470         ELSE
 21471             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21472             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 21473             MOVE EMSG               TO WS-ABEND-MESSAGE
 21474             GO TO ABEND-PGM
 21475         END-IF
 21476     END-IF.
 21477     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21478     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21479     MOVE +0                     TO ELCRTO-SEQ-NO
 21480     MOVE ELCRTO-KEY             TO OC-CONTROL-PRIMARY
 21481
 21482     START ELCRTO KEY NOT LESS THAN OC-CONTROL-PRIMARY.
 21483
 21484     IF ELCRTO-FILE-STATUS NOT = '00'
 21485         GO TO 9991-CRTO-NOT-FOUND
 21486     END-IF.
 21487
 21488     READ ELCRTO NEXT.
 21489     IF ELCRTO-FILE-STATUS = '00'
 21490        AND (OC-CONTROL-PRIMARY (1:33) =
 21491                 PB-CONTROL-BY-ACCOUNT (1:33))
 21492        AND (OC-RECORD-TYPE = 'I')
 21493           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21494               GO TO 9991-CHECK-INDICATORS
 21495           ELSE
 21496               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21497               GO TO 9991-CRTO-ADD-REC
 21498           END-IF
 21499     END-IF.
 21500
 21501 9991-CRTO-NOT-FOUND.
 21502
 21503     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21504     MOVE 'OC'                TO OC-RECORD-ID
 21505     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21506                              TO OC-CONTROL-PRIMARY (1:33)
 21507     MOVE +4096               TO OC-KEY-SEQ-NO.
 21508
 21509 9991-CRTO-ADD-REC.
 21510
 21511     MOVE 'E517'              TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 399
* EL517.cbl
 21512     MOVE '120000'            TO OC-LAST-MAINT-HHMMSS
 21513     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21514     MOVE 'I'                 TO OC-RECORD-TYPE
 21515     IF PB-ISSUE
 21516         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21517         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21518         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21519         MOVE PB-I-AGE               TO OC-INS-AGE
 21520         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21521         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21522         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21523         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21524         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21525         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21526         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21527         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21528         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21529         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21530         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21531         IF PB-I-JOINT-COMMISSION > +0
 21532             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21533         ELSE
 21534             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21535         END-IF
 21536         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21537         MOVE +0                     TO OC-LF-CANCEL-AMT
 21538                                        OC-LF-ITD-CANCEL-AMT
 21539         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21540         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21541         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21542         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21543         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21544         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21545         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21546         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21547         MOVE +0                     TO OC-AH-CANCEL-AMT
 21548                                        OC-AH-ITD-CANCEL-AMT
 21549         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21550         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21551         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21552     ELSE
 21553         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21554         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21555         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21556         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21557         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21558         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21559         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21560         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21561         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21562          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21563             MOVE SPACES             TO OC-LF-BENCD
 21564             MOVE ZEROS              TO OC-LF-TERM
 21565                                        OC-LF-BEN-AMT
 21566                                        OC-LF-PRM-AMT
 21567                                        OC-LF-ALT-BEN-AMT
 21568                                        OC-LF-ALT-PRM-AMT
 21569                                        OC-LF-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 400
* EL517.cbl
 21570                                        OC-LF-CANCEL-AMT
 21571             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21572             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21573         ELSE
 21574             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21575             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21576             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21577             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21578             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21579             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21580             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21581             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21582             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21583             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21584         END-IF
 21585         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21586         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21587          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21588             MOVE SPACES             TO OC-AH-BENCD
 21589             MOVE ZEROS              TO OC-AH-TERM
 21590                                        OC-AH-BEN-AMT
 21591                                        OC-AH-PRM-AMT
 21592                                        OC-AH-COMM-PCT
 21593                                        OC-AH-CANCEL-AMT
 21594                                        OC-AH-CP
 21595             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21596             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21597         ELSE
 21598             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21599             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21600             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21601             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21602             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21603             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21604             MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 21605             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21606             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21607         END-IF
 21608         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21609         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21610         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21611         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21612     END-IF
 21613     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21614
 21615     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21616     IF ERMAIL-FOUND = ' '
 21617         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21618     END-IF.
 21619
 21620     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21621     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21622     MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY.
 21623
 21624     READ ELCRTT
 21625
 21626     IF ELCRTT-FILE-STATUS  = '00'
 21627         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 401
* EL517.cbl
 21628         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21629     END-IF.
 21630
 21631     WRITE ORIGINAL-CERTIFICATE.
 21632
 21633     GO TO 9991-EXIT.
 21634
 21635 9991-CHECK-INDICATORS.
 21636
 21637     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21638         GO TO 9991-EXIT
 21639     END-IF.
 21640
 21641     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21642         GO TO 9991-EXIT
 21643     END-IF.
 21644
 21645     IF PB-ISSUE
 21646        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21647        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21648        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21649        MOVE PB-I-AGE               TO OC-INS-AGE
 21650        MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21651        MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21652        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21653        MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21654        MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21655        MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21656        MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21657        MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21658        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21659        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21660        MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21661        IF PB-I-JOINT-COMMISSION > +0
 21662            MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21663        ELSE
 21664            MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21665        END-IF
 21666        MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21667        MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21668        MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21669        MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21670        MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21671        MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21672        MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21673        MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21674        MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21675
 21676        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21677        IF ERMAIL-FOUND = ' '
 21678           MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21679        END-IF
 21680
 21681        MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21682        MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21683        MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY
 21684        READ ELCRTT
 21685        IF ELCRTT-FILE-STATUS  = '00'
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 402
* EL517.cbl
 21686           MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21687           MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21688        END-IF
 21689
 21690     ELSE
 21691        IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21692           MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21693           MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21694           MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21695        END-IF
 21696        IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21697           MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21698           MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21699           MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21700        END-IF
 21701        MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21702     END-IF
 21703
 21704     REWRITE ORIGINAL-CERTIFICATE.
 21705
 21706 9991-EXIT.
 21707     EXIT.
 21708
 21709
 21710 9999-SET-PNDB-ERROR-FLAGS.
 21711
 21712     IF PB-BATCH-TRAILER
 21713        GO TO 9999-REWRITE-RECORD.
 21714
 21715     IF PB-COMMON-ERRORS = LOW-VALUES
 21716        GO TO 9999-SET-ERROR-FLAGS.
 21717
 21718 9999-FORMAT-ERRORS.
 21719
 21720     MOVE +0                     TO SUB1.
 21721
 21722 9999-ERROR-LOOP.
 21723
 21724     ADD +1                      TO SUB1.
 21725
 21726     IF SUB1 GREATER THAN PB-NO-OF-ERRORS
 21727        GO TO 9999-SET-ERROR-FLAGS.
 21728
 21729     MOVE PB-COMMON-ERROR (SUB1) TO EM-MESSAGE-NUMBER.
 21730
 21731     READ ELCERR.
 21732
 21733     IF ELCERR-FILE-STATUS NOT = '00'
 21734        ADD +1                       TO EMI-FATAL-CTR
 21735        GO TO  9999-ERROR-LOOP.
 21736
*21737                                 COPY ELCERRPD.
 21738******************************************************************04/15/98
 21739*                                                                *ELCERRPD
 21740*                                                                *ELCERRPD
 21741*                            ELCERRPD                            *   LV002
 21742*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 21743*                            VMOD=2.005                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 403
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21744*                                                                *ELCERRPD
 21745*    CLIENT CODED ERROR MESSAGES                                 *ELCERRPD
 21746*                                                                *ELCERRPD
 21747******************************************************************ELCERRPD
 21748                                                                  ELCERRPD
 21749     IF EM-MESSAGE-NUMBER NOT NUMERIC                             ELCERRPD
 21750         MOVE ZEROS TO EM-MESSAGE-NUMBER.                         ELCERRPD
 21751                                                                  ELCERRPD
 21752     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK                ELCERRPD
 21753                         OR CLIENT-CIG OR CLIENT-CUK              ELCERRPD
 21754        IF EM-MESSAGE-NUMBER EQUAL 0541                           ELCERRPD
 21755            MOVE 'X' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21756                                                                  ELCERRPD
 21757     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21758        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909                     ELCERRPD
 21759            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21760                                                                  ELCERRPD
 21761     IF E-CLIENT-ID EQUAL CLIENT-LAP                              ELCERRPD
 21762        IF EM-MESSAGE-NUMBER EQUAL 2656                           ELCERRPD
 21763            MOVE 'F' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21764                                                                  ELCERRPD
 21765     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB                        ELCERRPD
 21766        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671                     ELCERRPD
 21767            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21768                                                                  ELCERRPD
 21769     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC          ELCERRPD
 21770        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672                     ELCERRPD
 21771            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21772                                                                  ELCERRPD
 21773     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21774        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693                     ELCERRPD
 21775            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21776                                                                  ELCERRPD
 21777     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS                        ELCERRPD
 21778        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696                     ELCERRPD
 21779            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21780                                                                  ELCERRPD
 21781     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21782        IF EM-MESSAGE-NUMBER EQUAL 2738                           ELCERRPD
 21783            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21784                                                                  ELCERRPD
 21785     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21786        IF EM-MESSAGE-NUMBER EQUAL 2739                           ELCERRPD
 21787            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21788                                                                  ELCERRPD
 21789     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21790        IF EM-MESSAGE-NUMBER EQUAL 2741                           ELCERRPD
 21791            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21792                                                                  ELCERRPD
 21793     IF  E-CLIENT-ID EQUAL CLIENT-HAN                             ELCERRPD
 21794             OR                                                   ELCERRPD
 21795         E-CLIENT-ID EQUAL CLIENT-JHL                             ELCERRPD
 21796                                                                  ELCERRPD
 21797         IF  EM-MESSAGE-NUMBER EQUAL 2756                         ELCERRPD
 21798             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21799                                                                  ELCERRPD
 21800     IF E-CLIENT-ID = CLIENT-NCX                                  ELCERRPD
 21801         IF EM-MESSAGE-NUMBER = 9895                              ELCERRPD
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 404
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21802             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21803
 21804     IF E-CLIENT-ID = CLIENT-DCC
 21805        IF EM-MESSAGE-NUMBER = 2719
 21806           MOVE 'W'              TO EM-ERROR-SEVERITY
 21807        END-IF
 21808     END-IF
 21809
 21810     .
 21811
 21812     IF EM-ERROR-SEVERITY = 'W'
 21813        ADD +1                   TO EMI-WARNING-CTR
 21814        GO TO  9999-ERROR-LOOP.
 21815
 21816     IF EM-ERROR-SEVERITY = 'F'
 21817        ADD +1                   TO EMI-FORCABLE-CTR
 21818        GO TO  9999-ERROR-LOOP.
 21819
 21820     IF EM-ERROR-SEVERITY = 'X'
 21821        ADD +1                   TO EMI-FATAL-CTR.
 21822
 21823     GO TO 9999-ERROR-LOOP.
 21824
 21825 9999-SET-ERROR-FLAGS.
 21826
 21827     IF EMI-FATAL-CTR NOT = ZEROS
 21828        MOVE 'X'                 TO PB-FATAL-FLAG
 21829        GO TO 9999-CONT-SET-ERROR-FLAGS.
 21830
 21831     IF EMI-FORCABLE-CTR NOT = ZEROS
 21832        IF PB-ISSUE
 21833           IF PB-ISSUE-FORCE
 21834              MOVE 'F'           TO PB-FORCE-ER-CD
 21835             ELSE
 21836              MOVE 'X'           TO PB-FORCE-ER-CD
 21837          ELSE
 21838           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 21839              MOVE 'F'           TO PB-FORCE-ER-CD
 21840             ELSE
 21841              MOVE 'X'           TO PB-FORCE-ER-CD.
 21842
 21843 9999-CONT-SET-ERROR-FLAGS.
 21844
 21845     IF EMI-WARNING-CTR NOT = ZEROS
 21846        MOVE 'W'                 TO PB-WARN-ER-CD.
 21847
 21848     IF PB-UNFORCED-ERRORS OR
 21849        PB-FATAL-ERRORS    OR
 21850        PB-RECORD-ON-HOLD  OR
 21851        PB-RECORD-RETURNED
 21852*        OR
 21853*       PB-CANCELLATION
 21854          NEXT SENTENCE
 21855        ELSE
 21856          GO TO 9999-REWRITE-RECORD.
 21857
 21858     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 21859     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 405
* EL517.cbl
 21860     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
 21861     MOVE PB-SV-STATE            TO CERT-STATE.
 21862
 21863     READ ELCERT.
 21864
 21865     IF PB-ISSUE
 21866     IF CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE
 21867        GO TO 9999-REWRITE-CERT-MASTER.
 21868
 21869     IF PB-ISSUE
 21870        IF PB-RECORD-RETURNED
 21871            MOVE '4'             TO CM-CREDIT-INTERFACE-SW-1
 21872        ELSE
 21873             MOVE '2'            TO CM-CREDIT-INTERFACE-SW-1.
 21874
 21875     IF PB-CANCELLATION
 21876        IF PB-RECORD-RETURNED
 21877            MOVE '7'             TO CM-CREDIT-INTERFACE-SW-2
 21878        ELSE
 21879            IF PB-C-LF-CANCEL-VOIDED OR PB-C-AH-CANCEL-VOIDED
 21880               MOVE '6'          TO CM-CREDIT-INTERFACE-SW-2
 21881            ELSE
 21882               MOVE '4'          TO CM-CREDIT-INTERFACE-SW-2.
 21883
 21884 9999-REWRITE-CERT-MASTER.
 21885
 21886     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 21887        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 21888        GO TO 9999-REWRITE-RECORD.
 21889
 21890     REWRITE CERTIFICATE-MASTER.
 21891     ADD 1 TO WCER.
 21892
 21893 9999-REWRITE-RECORD.
 21894     IF NOT PB-BATCH-TRAILER
 21895         IF PB-ISSUE
 21896             ADD PB-I-LF-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21897             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21898             ADD PB-I-LF-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21899             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21900             ADD PB-I-AH-PREM-CALC   TO WS-AH-ISS-COMPUTED
 21901             ADD PB-I-AH-PREMIUM-AMT TO WS-AH-ISS-ENTERED
 21902             ADD 1                   TO WS-ISSUE-CNT
 21903         ELSE
 21904             ADD PB-C-LF-REF-CALC    TO WS-LF-CAN-COMPUTED
 21905             ADD PB-C-LF-CANCEL-AMT  TO WS-LF-CAN-ENTERED
 21906             ADD PB-C-AH-REF-CALC    TO WS-AH-CAN-COMPUTED
 21907             ADD PB-C-AH-CANCEL-AMT  TO WS-AH-CAN-ENTERED
 21908             ADD 1                   TO WS-CANCEL-CNT
 21909     ELSE
 21910         MOVE WS-LF-ISS-COMPUTED     TO PB-B-LF-ISS-PRM-COMPUTED
 21911         MOVE WS-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED
 21912         MOVE WS-AH-ISS-COMPUTED     TO PB-B-AH-ISS-PRM-COMPUTED
 21913         MOVE WS-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED
 21914         MOVE WS-LF-CAN-COMPUTED     TO PB-B-LF-CAN-PRM-COMPUTED
 21915         MOVE WS-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED
 21916         MOVE WS-AH-CAN-COMPUTED     TO PB-B-AH-CAN-PRM-COMPUTED
 21917         MOVE WS-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 406
* EL517.cbl
 21918         MOVE WS-ISSUE-CNT           TO PB-B-ISSUE-CNT-ENTERED
 21919         MOVE WS-CANCEL-CNT          TO PB-B-CANCEL-CNT-ENTERED
 21920         MOVE ZEROS                  TO WS-LF-ISS-COMPUTED
 21921                                        WS-LF-ISS-ENTERED
 21922                                        WS-AH-ISS-COMPUTED
 21923                                        WS-AH-ISS-ENTERED
 21924                                        WS-LF-CAN-COMPUTED
 21925                                        WS-LF-CAN-ENTERED
 21926                                        WS-AH-CAN-COMPUTED
 21927                                        WS-AH-CAN-ENTERED
 21928                                        WS-ISSUE-CNT
 21929                                        WS-CANCEL-CNT
 21930         MOVE SPACE                  TO PB-FATAL-FLAG.
 21931
 21932     IF PB-BATCH-TRAILER
 21933         IF PB-B-LF-ISS-PRM-REMITTED =
 21934            PB-B-LF-ISS-PRM-ENTERED   AND
 21935            PB-B-LF-CAN-PRM-REMITTED =
 21936            PB-B-LF-CAN-PRM-ENTERED   AND
 21937            PB-B-AH-ISS-PRM-REMITTED =
 21938            PB-B-AH-ISS-PRM-ENTERED   AND
 21939            PB-B-AH-CAN-PRM-REMITTED =
 21940            PB-B-AH-CAN-PRM-ENTERED   AND
 21941            PB-B-ISSUE-CNT-REMITTED  =
 21942            PB-B-ISSUE-CNT-ENTERED    AND
 21943            PB-B-CANCEL-CNT-REMITTED =
 21944            PB-B-CANCEL-CNT-ENTERED
 21945             MOVE SPACE          TO PB-OUT-BAL-CD
 21946           ELSE
 21947             MOVE 'O'            TO PB-OUT-BAL-CD.
 21948
 21949     REWRITE PENDING-BUSINESS.
 21950
 21951     ADD 1 TO WPND.
 21952
 21953     GO TO 0100-READ-PENDING.
 21954
 21955 9999-EXIT.
 21956     EXIT.
 21957
 21958******************************************************************
 21959*                                                                *
 21960*            E R R O R   F O R M A T   R O U T I N E             *
 21961*                                                                *
 21962******************************************************************
 21963
 21964 9900-ERROR-FORMAT.
 21965
 21966     IF WS-ERROR = PB-COMMON-ERROR (1)  OR
 21967                   PB-COMMON-ERROR (2)  OR
 21968                   PB-COMMON-ERROR (3)  OR
 21969                   PB-COMMON-ERROR (4)  OR
 21970                   PB-COMMON-ERROR (5)  OR
 21971                   PB-COMMON-ERROR (6)  OR
 21972                   PB-COMMON-ERROR (7)  OR
 21973                   PB-COMMON-ERROR (8)  OR
 21974                   PB-COMMON-ERROR (9)  OR
 21975                   PB-COMMON-ERROR (10)
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 407
* EL517.cbl
 21976        GO TO 9900-EXIT.
 21977
 21978     IF PB-NO-OF-ERRORS = +10
 21979        GO TO 9900-EXIT.
 21980
 21981     ADD +1                      TO PB-NO-OF-ERRORS.
 21982     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21983                                       (PB-NO-OF-ERRORS).
 21984
 21985
 21986 9900-EXIT.
 21987     EXIT.
 21988
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 408
* EL517.cbl
 21990 9999-DONE.
 21991*START*************CUSTOM CODE FOR CLIENT "DMD"*************
 21992
 21993     IF DTE-CLIENT NOT EQUAL 'DMD'
 21994          GO TO 9999-DONE-CONT.
 21995
 21996     CLOSE ERRESS
 21997           ERRESC.
 21998
 21999     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
 22000     MOVE 'C'                    TO DMPF-PROCESS-TYPE.
 22001     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 22002     IF DMPF-RETURN-CODE EQUAL 'Z3'
 22003         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22004         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
 22005         MOVE CMSG               TO WS-ABEND-MESSAGE
 22006         GO TO ABEND-PGM.
 22007
 22008     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
 22009     MOVE 'C'                    TO DIPF-PROCESS-TYPE.
 22010     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 22011     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22012         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22013         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
 22014         MOVE CMSG               TO WS-ABEND-MESSAGE
 22015         GO TO ABEND-PGM.
 22016
 22017     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
 22018     MOVE 'C'                    TO DVBI-PROCESS-TYPE.
 22019     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 22020     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22021         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22022         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
 22023         MOVE CMSG               TO WS-ABEND-MESSAGE
 22024         GO TO ABEND-PGM.
 22025
 22026     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22027     MOVE 'C'                    TO DCUA-PROCESS-TYPE.
 22028     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22029     IF DCUA-RETURN-CODE EQUAL 'Z3'
 22030         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22031         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
 22032         MOVE CMSG               TO WS-ABEND-MESSAGE
 22033         GO TO ABEND-PGM.
 22034
 22035     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
 22036     MOVE 'C'                    TO DPRB-PROCESS-TYPE.
 22037     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 22038     IF DPRB-RETURN-CODE EQUAL 'Z3'
 22039         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22040         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
 22041         MOVE CMSG               TO WS-ABEND-MESSAGE
 22042         GO TO ABEND-PGM.
 22043
 22044     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
 22045     MOVE 'C'                    TO DVRC-PROCESS-TYPE.
 22046     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 22047     IF DVRC-RETURN-CODE EQUAL 'Z3'
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 409
* EL517.cbl
 22048         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22049         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
 22050         MOVE CMSG               TO WS-ABEND-MESSAGE
 22051         GO TO ABEND-PGM.
 22052
 22053     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
 22054     MOVE 'C'                    TO DVSC-PROCESS-TYPE.
 22055     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 22056     IF DVSC-RETURN-CODE EQUAL 'Z3'
 22057         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22058         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
 22059         MOVE CMSG               TO WS-ABEND-MESSAGE
 22060         GO TO ABEND-PGM.
 22061
 22062*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22063
 22064 9999-DONE-CONT.
 22065
 22066     IF ERPNDM-OPEN = 'X'
 22067        CLOSE ERPNDM.
 22068
 22069     IF ERMAIL-OPEN = 'X'
 22070        CLOSE ERMAIL.
 22071
 22072     IF ELMSTR-OPEN = 'X'
 22073        CLOSE ELMSTR.
 22074
 22075     IF ELCRTT-OPEN = 'X'
 22076        CLOSE ELCRTT
 22077     END-IF.
 22078
 22079     IF ELCRTO-OPEN = 'X'
 22080        CLOSE ELCRTO
 22081     END-IF.
 22082
 22083     CLOSE      ELCNTL
 22084                ELCERR
 22085                ERPNDB
 22086                ERREIN
 22087                ELCERT
 22088                ERCTBL
 22089                ERPLAN
 22090                ERACCT
 22091                ERBXRF
 22092                ERAGTC
 22093                ERCOMP.
 22094
 22095     IF DTE-CLIENT = 'DCC'
 22096        CLOSE ERPDEF ELSTAT
 22097        IF ERPDEF-FILE-STATUS NOT = '00'
 22098            MOVE ERPDEF-FILE-STATUS
 22099                                 TO WS-ABEND-FILE-STATUS
 22100            MOVE 'ERPDEF'        TO WS-CEM-FILE-NAME
 22101            MOVE CMSG            TO WS-ABEND-MESSAGE
 22102            GO TO ABEND-PGM
 22103        END-IF
 22104        IF ELSTAT-FILE-STATUS NOT = '00'
 22105            MOVE ELSTAT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 410
* EL517.cbl
 22106                                 TO WS-ABEND-FILE-STATUS
 22107            MOVE 'ELSTAT'        TO WS-CEM-FILE-NAME
 22108            MOVE CMSG            TO WS-ABEND-MESSAGE
 22109            GO TO ABEND-PGM
 22110        END-IF
 22111     END-IF
 22112
 22113     IF ELCNTL-FILE-STATUS NOT = '00'
 22114         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22115         MOVE 'ELCNTL'              TO WS-CEM-FILE-NAME
 22116         MOVE CMSG TO WS-ABEND-MESSAGE
 22117         GO TO ABEND-PGM.
 22118
 22119     IF ERPNDB-FILE-STATUS NOT = '00'
 22120         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22121         MOVE 'ERPNDB'              TO WS-CEM-FILE-NAME
 22122         MOVE CMSG TO WS-ABEND-MESSAGE
 22123         GO TO ABEND-PGM.
 22124
 22125     IF ERREIN-FILE-STATUS NOT = '00'
 22126         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22127         MOVE 'ERREIN'              TO WS-CEM-FILE-NAME
 22128         MOVE CMSG TO WS-ABEND-MESSAGE
 22129         GO TO ABEND-PGM.
 22130
 22131     IF ELCERT-FILE-STATUS NOT = '00'
 22132         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22133         MOVE 'ELCERT'              TO WS-CEM-FILE-NAME
 22134         MOVE CMSG TO WS-ABEND-MESSAGE
 22135         GO TO ABEND-PGM.
 22136
 22137     IF ERMAIL-OPEN   = 'X'
 22138       IF ERMAIL-FILE-STATUS NOT = '00'
 22139           MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22140           MOVE 'ERMAIL'              TO WS-CEM-FILE-NAME
 22141           MOVE CMSG TO WS-ABEND-MESSAGE
 22142           GO TO ABEND-PGM.
 22143
 22144     IF ERPNDM-OPEN   = 'X'
 22145       IF ERPNDM-FILE-STATUS NOT = '00'
 22146            MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22147            MOVE 'ERPNDM'              TO WS-CEM-FILE-NAME
 22148            MOVE CMSG TO WS-ABEND-MESSAGE
 22149            GO TO ABEND-PGM.
 22150
 22151     IF ELCRTT-OPEN = 'X'
 22152         IF ELCRTT-FILE-STATUS NOT = '00'
 22153             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22154             MOVE 'ELCRTT'              TO WS-CEM-FILE-NAME
 22155             MOVE CMSG TO WS-ABEND-MESSAGE
 22156             GO TO ABEND-PGM
 22157         END-IF
 22158     END-IF.
 22159
 22160     IF ELCRTO-OPEN = 'X'
 22161         IF ELCRTO-FILE-STATUS NOT = '00'
 22162             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22163             MOVE 'ELCRTO'              TO WS-CEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 411
* EL517.cbl
 22164             MOVE CMSG TO WS-ABEND-MESSAGE
 22165             GO TO ABEND-PGM
 22166         END-IF
 22167     END-IF.
 22168
 22169     IF ERCTBL-FILE-STATUS NOT = '00'
 22170         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22171         MOVE 'ERCTBL'              TO WS-CEM-FILE-NAME
 22172         MOVE CMSG TO WS-ABEND-MESSAGE
 22173         GO TO ABEND-PGM.
 22174
 22175     IF ERPLAN-FILE-STATUS NOT = '00'
 22176        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
 22177        MOVE 'ERPLAN '           TO WS-CEM-FILE-NAME
 22178        MOVE CMSG TO WS-ABEND-MESSAGE
 22179        GO TO ABEND-PGM.
 22180
 22181     IF ERACCT-FILE-STATUS NOT = '00'
 22182         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22183         MOVE 'ERACCT'              TO WS-CEM-FILE-NAME
 22184         MOVE CMSG TO WS-ABEND-MESSAGE
 22185         GO TO ABEND-PGM.
 22186
 22187     IF ERCOMP-FILE-STATUS NOT = '00'
 22188         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22189         MOVE 'ERCOMP'              TO WS-CEM-FILE-NAME
 22190         MOVE CMSG TO WS-ABEND-MESSAGE
 22191         GO TO ABEND-PGM.
 22192
 22193     IF ERBXRF-FILE-STATUS NOT = '00'
 22194         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22195         MOVE 'ERBXRF'              TO WS-CEM-FILE-NAME
 22196         MOVE CMSG TO WS-ABEND-MESSAGE
 22197         GO TO ABEND-PGM.
 22198
 22199     IF ERAGTC-FILE-STATUS NOT = '00'
 22200         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22201         MOVE 'ERAGTC'              TO WS-CEM-FILE-NAME
 22202         MOVE CMSG TO WS-ABEND-MESSAGE
 22203         GO TO ABEND-PGM.
 22204
 22205     IF ELCERR-FILE-STATUS NOT = '00'
 22206         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22207         MOVE 'ELCERR'              TO WS-CEM-FILE-NAME
 22208         MOVE CMSG TO WS-ABEND-MESSAGE
 22209         GO TO ABEND-PGM.
 22210
 22211     MOVE 'C'                     TO CP-IO-FUNCTION.
 22212     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22213
 22214     IF IO-ERROR
 22215        MOVE SPACE                TO WS-ABEND-FILE-STATUS
 22216        MOVE 'ELRATE'             TO WS-CEM-FILE-NAME
 22217        MOVE CMSG                 TO WS-ABEND-MESSAGE
 22218        GO TO ABEND-PGM.
 22219
 22220     OPEN OUTPUT PRINT-FILE.
 22221
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 412
* EL517.cbl
 22222     MOVE CF-CL-MAIL-TO-NAME     TO H2-COMP.
 22223     MOVE WS-CURRENT-DATE        TO H2-DATE.
 22224     MOVE ALPH-DATE              TO H3-DATE.
 22225     MOVE TRAN-CT                TO SUM-TOT.
 22226
 22227 7000-PRT-HDG.
 22228     MOVE HDG1 TO PRT   MOVE '1' TO X.
 22229     PERFORM 7000-PRINT-LINE.
 22230     MOVE HDG2 TO PRT   MOVE ' ' TO X.
 22231     PERFORM 7000-PRINT-LINE.
 22232     MOVE HDG3 TO PRT   MOVE ' ' TO X.
 22233     PERFORM 7000-PRINT-LINE.
 22234     MOVE SUM1 TO PRT   MOVE '0' TO X.
 22235     PERFORM 7000-PRINT-LINE.
 22236     GO TO 9999-END-JOB.
 22237
 22238 7000-HDG-XIT.
 22239     EXIT.
 22240
 22241 7000-PRINT-LINE.
*22242                     COPY ELCPRT2X.
 22243******************************************************************04/15/98
 22244*                                                                *ELCPRT2X
 22245*                                                                *ELCPRT2X
 22246*                            ELCPRT2X.                           *   LV002
 22247*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22248*                            VMOD=2.002                          *   CL**2
 22249*                                                                *ELCPRT2X
 22250*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
 22251*                                                                *ELCPRT2X
 22252*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
 22253*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
 22254*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
 22255*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
 22256*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
 22257*                                                                *ELCPRT2X
 22258*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
 22259*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
 22260******************************************************************ELCPRT2X
 22261                                                                  ELCPRT2X
 22262     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
 22263         FICH-OPEN   = SPACE                                      ELCPRT2X
 22264         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
 22265         OPEN OUTPUT FICH.                                        ELCPRT2X
 22266                                                                  ELCPRT2X
 22267     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22268         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
 22269             OPEN I-O ELREPT                                      ELCPRT2X
 22270             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
 22271                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
 22272                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
 22273                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
 22274                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
 22275                 GO TO ABEND-PGM                                  ELCPRT2X
 22276             ELSE                                                 ELCPRT2X
 22277                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
 22278                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22279                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 413
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22280                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22281                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22282                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22283                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22284                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22285                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
 22286                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22287                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22288                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22289                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22290                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22291                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
 22292                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22293                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
 22294                                                                  ELCPRT2X
 22295     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
 22296        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
 22297         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
 22298         GO TO ABEND-PGM.                                         ELCPRT2X
 22299                                                                  ELCPRT2X
 22300     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22301         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
 22302         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
 22303             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
 22304                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
 22305                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
 22306                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
 22307                     INVALID KEY                                  ELCPRT2X
 22308                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
 22309                         CLOSE ELREPT                             ELCPRT2X
 22310                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
 22311                                                                  ELCPRT2X
 22312     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
 22313         MOVE X                      TO  P-CTL                    ELCPRT2X
 22314         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
 22315                                                                  ELCPRT2X
 22316     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
 22317       MOVE X                        TO  P-CTL                    ELCPRT2X
 22318       IF P-CTL = ' '                                             ELCPRT2X
 22319         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
 22320       ELSE                                                       ELCPRT2X
 22321         IF P-CTL = '0'                                           ELCPRT2X
 22322           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
 22323         ELSE                                                     ELCPRT2X
 22324           IF P-CTL = '-'                                         ELCPRT2X
 22325             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
 22326           ELSE                                                   ELCPRT2X
 22327             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
 22328                                                                  ELCPRT2X
 22329     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
 22330                                                                  ELCPRT2X
 22331 DTE-REPORT-DELETE.                                               ELCPRT2X
 22332     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
 22333         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
 22334         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
 22335                                                                  ELCPRT2X
 22336     READ ELREPT   NEXT RECORD                                    ELCPRT2X
 22337           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 414
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22338                                                                  ELCPRT2X
 22339     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
 22340        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
 22341         DELETE ELREPT RECORD                                     ELCPRT2X
 22342         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
 22343                                                                  ELCPRT2X
 22344 DTE-DELETE-EXIT.                                                 ELCPRT2X
 22345     EXIT.                                                        ELCPRT2X
 22346                                                                  ELCPRT2X
 22347 DTE-PRINT-EXIT.                                                  ELCPRT2X
 22348     EXIT.                                                        ELCPRT2X
 22349******************************************************************ELCPRT2X
 22350
 22351 REIN-DATE-LOAD.
*22352     COPY ELCRENM1.
 22353******************************************************************04/15/98
 22354*                                                                *ELCRENM1
 22355*                                                                *ELCRENM1
 22356*                            ELCRENM1                            *   LV002
 22357*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22358*                            VMOD=2.001                          *ELCRENM1
 22359*                                                                *ELCRENM1
 22360*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRENM1
 22361*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRENM1
 22362*                                                                *ELCRENM1
 22363******************************************************************ELCRENM1
 22364     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.       CL**2
 22365     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.       CL**2
 22366     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.        CL**2
 22367                                                                  ELCRENM1
 22368
 22369 7000-PRINT-LINE-XIT.
 22370      EXIT.
 22371
 22372 9999-END-JOB.
 22373     CLOSE PRINT-FILE.
*22374             COPY ELCPRTCX.
 22375******************************************************************04/15/98
 22376*                                                                *ELCPRTCX
 22377*                                                                *ELCPRTCX
 22378*                            ELCPRTCX.                           *   LV003
 22379*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22380*                            VMOD=2.003                          *   CL**3
 22381*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
 22382*                                                                *ELCPRTCX
 22383* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 22384******************************************************************ELCPRTCX
 22385                                                                  ELCPRTCX
 22386      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
 22387          CLOSE FICH.                                             ELCPRTCX
 22388                                                                  ELCPRTCX
 22389      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
 22390          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
 22391          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
 22392          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
 22393          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
 22394          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
 22395          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 415
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
 22396          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
 22397          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
 22398              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22399              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22400              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22401                  UPON CONSOLE                                    ELCPRTCX
 22402              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22403                  UPON CONSOLE                                    ELCPRTCX
 22404            ELSE                                                  ELCPRTCX
 22405              DISPLAY '***************************************'   ELCPRTCX
 22406              DISPLAY '***************************************'   ELCPRTCX
 22407              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
 22408              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
 22409              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
 22410              DISPLAY '**                                   **'   ELCPRTCX
 22411              DISPLAY '***************************************'   ELCPRTCX
 22412              DISPLAY '***************************************'   ELCPRTCX
 22413              CLOSE ELREPT.                                       ELCPRTCX
 22414                                                                  ELCPRTCX
 22415      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
 22416          DISPLAY '***************************************'       ELCPRTCX
 22417          DISPLAY '***************************************'       ELCPRTCX
 22418          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22419          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
 22420          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
 22421          DISPLAY '**                                   **'       ELCPRTCX
 22422          DISPLAY '***************************************'       ELCPRTCX
 22423          DISPLAY '***************************************'       ELCPRTCX
 22424          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22425                                                                  ELCPRTCX
 22426      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
 22427          DISPLAY '***************************************'       ELCPRTCX
 22428          DISPLAY '***************************************'       ELCPRTCX
 22429          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22430          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
 22431          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
 22432          DISPLAY '**                                   **'       ELCPRTCX
 22433          DISPLAY '***************************************'       ELCPRTCX
 22434          DISPLAY '***************************************'       ELCPRTCX
 22435          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22436                                                                  ELCPRTCX
 22437                                                                  ELCPRTCX
 22438******************************************************************ELCPRTCX
 22439
 22440     GOBACK.
 22441
 22442 ABEND-PGM.
*                   COPY ELCABEND.
 22443***************************************************************** 04/14/98
 22444*                                                               * ELCABEND
 22445*                            ELCABEND.                          *    LV003
 22446*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22447*                            VMOD 2.002                              CL**2
 22448*                                                               * ELCABEND
 22449*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22450*            AND THEN ABENDS.                                   * ELCABEND
 22451*                                                               * ELCABEND
 22452*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 14-Oct-13 13:46 Page 416
* EL517.cbl (/apps/prod/cid1p/copy/ELCABEND)
 22453*                                                               * ELCABEND
 22454***************************************************************** ELCABEND
 22455*APS-010.                                                         ELCABEND
 22456     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22457     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22458                                                                  ELCABEND
 22459     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22460         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22461         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22462                                 UPON CONSOLE.                    ELCABEND
 22463                                                                  ELCABEND
 22464     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22465         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22466         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22467                                 UPON CONSOLE.                    ELCABEND
 22468                                                                  ELCABEND
 22469     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22470     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22471                                 UPON CONSOLE.                    ELCABEND
 22472                                                                  ELCABEND
 22473     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22474     CALL 'ABORTME'.
 22475                                                                  ELCABEND
 22476 APS-EXIT.                                                        ELCABEND
 22477     EXIT.                                                        ELCABEND
 22478
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116640     Code:       91222
