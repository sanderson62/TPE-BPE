* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* ECS158.cbl
* Options: int("ECS158.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS158.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS158.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS158.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS158.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/16/94 16:45:02.
     7*             PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.041.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED. 10/13/86.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* ECS158.cbl
    14
    15*SECURITY.   ***************************************************
    16*            *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.
    18*            *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.
    22*            *
    23*            ***************************************************
    24
    25*REMARKS.
    26*        PROGRAM PULLS AN EXTRACT ON THE CLAS SYSTEM CERT FILE
    27*        AND THE EXTRACTS FROM ECS157 IN ORDER TO PROCESS
    28*        EXTRACTS FOR INSURANCE COMMISSION CALL.
    29*
    30*        RUN DATE IN DATE CARD IS CONSIDERED TO BE CALL-DATE.
    31*
    32*        BEGINNING OF 'CALL' PERIOD IS RUN DATE OR 12 MOS PRIOR
    33*        TO EP-DT
    34*
    35*
    36****************************************************************
    37*
    38*    RR   =  NUMBER OF MONTHS CERT WAS INFORCE DURING PERIOD
    39*                (USED TO CALCULATE MEAN INFORCE)
    40*
    41*    M1   =  NUMBER OF MONTHS REMAINING UNTIL EXPIRATION, DEATH
    42*            CANCELLATION FROM START OF PERIOD OR ISSUE DATE
    43*            WHICHEVER WAS LATER.
    44*                (USED TO CALCULATE MEAN INFORCE)
    45*
    46*    M2   =  NUMBER OF MONTHS REMAINING UNTIL EXPIRATION AT END
    47*            OF PERIOD IF INFORCE AT END OF PERIOD.
    48*                (USED TO CALCULATE UNEARNED PREMIUM AT END)
    49*
    50*    M3   =  NUMBER OF MONTHS REMAINING UNTIL EXPIRATION AT STAR
    51*            OF PERIOD.
    52*                (USED TO CALCULATE UNEARNED PREMIUM AT START)
    53*
    54*    M5   =  NUMBER OF FULL MONTHS REMAINING UNTIL EXPIRATION
    55*          AT END  OF PERIOD IF INFORCE AT END OF PERIOD.
    56*                (USED TO CALCULATE UNEARNED PREMIUM AT END)
    57*
    58*    M6   =  NUMBER OF FULL MONTHS REMAINING UNTIL EXPIRATION
    59*        AT START  OF PERIOD.
    60*                (USED TO CALCULATE UNEARNED PREMIUM AT START)
    61*
    62****************************************************************
    63******************************************************************
    64*                   C H A N G E   L O G
    65*
    66* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    67*-----------------------------------------------------------------
    68*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    69* EFFECTIVE    NUMBER
    70*-----------------------------------------------------------------
    71* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* ECS158.cbl
    72* 120803                   PEMA  REMOVE SUPPLEMENTAL IBNR CALC
    73* 032609  CR2008030600001  PEMA  CHANGE TX AND VA TO ROA
    74* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    75* 062712    2012062600003  PEMA  ADD PROCESSING FOR AHL
    76******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* ECS158.cbl
    78 ENVIRONMENT DIVISION.
    79 INPUT-OUTPUT SECTION.
    80 FILE-CONTROL.
    81
    82     SELECT CERTS        ASSIGN TO SYS010-UT-2400-S-SYS010.
    83     SELECT XTRS-IN      ASSIGN TO SYS012-UT-2400-S-SYS012.
    84     SELECT ERACCTT      ASSIGN TO SYS015-UT-FBA1-ERACCTT
    85                         ACCESS IS SEQUENTIAL
    86                         ORGANIZATION IS INDEXED
    87                         FILE STATUS IS ERACCTT-FILE-STATUS
    88                         RECORD KEY IS AM-CONTROL-PRIMARY.
    89     SELECT XTRACT       ASSIGN TO SYS011-UT-2400-S-SYS011.
    90     SELECT CLMS-HIST    ASSIGN TO SYS013-UT-2400-S-SYS013.
    91     SELECT SORTED-CLAIMS ASSIGN TO SYS016-UT-FBA1-S-SYS016.
    92     SELECT DISK-DATE    ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    93     SELECT PRINTX       ASSIGN TO SYS008-UR-1403-S-SYS008.
    94     SELECT PRINTC       ASSIGN TO SYS009-UR-1403-S-SYS009.
    95     SELECT SORT-CLMS    ASSIGN TO SYS001-UT-FBA1-S-SORTWK1.
    96     SELECT FICH         ASSIGN TO SYS020-UT-2400-S-SYS020.
    97     SELECT ERRTBL-IN    ASSIGN TO SYS014-ERRTBLT
    98                         ACCESS IS DYNAMIC
    99                         ORGANIZATION IS INDEXED
   100                         FILE STATUS IS ERRTBL-FILE-STATUS
   101                         RECORD KEY IS RE-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* ECS158.cbl
   103 DATA DIVISION.
   104 FILE SECTION.
   105
   106 FD  CLMS-HIST
*  107                            COPY ECSEXTFD.
   108******************************************************************07/10/97
   109*                                                                *ECSEXTFD
   110*                            ECSEXTFD                            *   LV001
   111*                            VMOD=2.001                          *ECSEXTFD
   112*                                                                *ECSEXTFD
   113*  NO  CID  MODS  IN  COPYBOOK  ECSEXTFD                         *ECSEXTFD
   114*                                                                *ECSEXTFD
   115******************************************************************ECSEXTFD
   116     RECORDING MODE F                                             ECSEXTFD
   117     LABEL RECORDS STANDARD                                       ECSEXTFD
   118     BLOCK CONTAINS 0 RECORDS
   119     RECORD CONTAINS 510 CHARACTERS.                              ECSEXTFD
   120******************************************************************ECSEXTFD
   121
   122 01  IN-CLMS                 PIC X(510).
   123
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* ECS158.cbl
   125 FD  ERRTBL-IN.
*  126                                 COPY ERCREIN.
   127******************************************************************07/27/93
   128*                                                                *ERCREIN
   129*                            ERCREIN                             *   LV009
   130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   131*                            VMOD=2.010                          *   CL**9
   132*                                                                *ERCREIN
   133*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   134*                                                                *ERCREIN
   135*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   136*                                                                *ERCREIN
   137*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   138*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   139*                                                                *ERCREIN
   140*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   141*       ALTERNATE PATH = NONE                                    *ERCREIN
   142*                                                                *ERCREIN
   143*   LOG = NO                                                     *ERCREIN
   144*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   145*                                                                *ERCREIN
   146******************************************************************ERCREIN
   147*                   C H A N G E   L O G
   148*
   149* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   150*-----------------------------------------------------------------
   151*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   152* EFFECTIVE    NUMBER
   153*-----------------------------------------------------------------
   154* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   155* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   156******************************************************************
   157 01  REINSURANCE-RECORD.                                          ERCREIN
   158     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   159         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   160                                                                  ERCREIN
   161     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   162         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   163         16  RE-KEY.                                              ERCREIN
   164             20  RE-CODE                   PIC X.                 ERCREIN
   165                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   166                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   167             20  RE-TABLE                  PIC XXX.               ERCREIN
   168             20  FILLER                    PIC XXX.               ERCREIN
   169         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   170             20  FILLER                    PIC X.                 ERCREIN
   171             20  RE-COMPANY.                                      ERCREIN
   172                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   173                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   174                                                                  ERCREIN
   175     12  RE-MAINT-INFORMATION.                                    ERCREIN
   176         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   177         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   178         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   179         16  FILLER                        PIC X(10).             ERCREIN
   180                                                                  ERCREIN
   181     12  RE-TABLE-DATA.                                           ERCREIN
   182         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* ECS158.cbl (/apps/prod/cid1p/copy/ERCREIN)
   183                                                                  ERCREIN
   184         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   185             20  RE-REI-COMP-NO.                                  ERCREIN
   186                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   187                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   188             20  RE-LF-QC                  PIC X.                 ERCREIN
   189             20  RE-AH-QC                  PIC X.                 ERCREIN
   190             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   191             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   192             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   193             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   194             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   195             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   196             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   197             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   198             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   199             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   200             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   201             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   202             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   203             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   204             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   205             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   206             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   207             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   208             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   209             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   210             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   211             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   212             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   213             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   214             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   215             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   216             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   217             20  RE-REMAINING              PIC X.                 ERCREIN
   218             20  RE-LF-RUNOFF-SW           PIC X.                      000
   219             20  RE-AH-RUNOFF-SW           PIC X.                      000
   220             20  FILLER                    PIC X(19).                  000
   221                                                                  ERCREIN
   222         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   223         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   224         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   225         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   226             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   227                                                                  ERCREIN
   228         16  FILLER                        PIC X(27).             ERCREIN
   229                                                                  ERCREIN
   230     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   231         16  RE-NAME                       PIC X(30).             ERCREIN
   232         16  RE-LF-PE                      PIC X.                 ERCREIN
   233         16  RE-AH-PE                      PIC X.                 ERCREIN
   234         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   235         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   236         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   237         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   238         16  RE-PRT-ST                     PIC X.                 ERCREIN
   239         16  RE-PRT-OW                     PIC X.                 ERCREIN
   240         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* ECS158.cbl (/apps/prod/cid1p/copy/ERCREIN)
   241         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   242         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   243         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   244         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   245         16  RE-LF-COMM                    PIC X.                 ERCREIN
   246         16  RE-AH-COMM                    PIC X.                 ERCREIN
   247         16  RE-LF-TAX                     PIC X.                 ERCREIN
   248         16  RE-AH-TAX                     PIC X.                 ERCREIN
   249         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   250         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   251         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   252                                                                  ERCREIN
   253         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   254             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   255                                                                  ERCREIN
   256         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   257             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   258                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   259                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   260                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   261                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   262             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   263                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   264                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   265                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   266                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   267                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   268                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   269                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   270                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   271             20  FILLER                    PIC XXX.               ERCREIN
   272             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   273                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   274                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   275                                                                  ERCREIN
   276         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   277             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   278                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   279                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   280                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   281                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   282             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   283                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   284                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   285                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   286                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   287                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   288                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   289                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   290                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   291             20  FILLER                    PIC XXX.               ERCREIN
   292             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   293                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   294                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   295                                                                  ERCREIN
   296         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   297                                                                  ERCREIN
   298         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* ECS158.cbl (/apps/prod/cid1p/copy/ERCREIN)
   299                                                                  ERCREIN
   300         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   301         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   302         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   303         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   304         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   305         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   306         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   307         16  RE-MORT-SW                    PIC X.                 ERCREIN
   308         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   309             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   310             88  RE-CEDED                          VALUE 'C'.        CL**2
   311             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   312             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   313                                                                  ERCREIN
   314         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   315             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   316         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   317             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   318         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   319             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   320         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   321             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   322         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   323             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   324                                                                     CL**3
   325         16  RE-PRT-CRSV                   PIC X.                    CL**5
   326                                                                     CL**5
   327         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   328                                                                     CL**8
   329         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   330                                                                     CL**8
   331         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   332                                                                     CL**9
   333         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   334             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   335             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   336
   337         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   338             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   339                                                                     CL**9
   340         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   341         16  FILLER                        PIC X(2281).              CL**9
   342                                                                  ERCREIN
   343         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   344                                                                  ERCREIN
   345******************************************************************ERCREIN
   346
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* ECS158.cbl
   348 FD  CERTS
*  349                                 COPY ECSCRIFD.
   350******************************************************************07/10/97
   351*                                                                *ECSCRIFD
   352*                            ECSCRIFD                            *   LV001
   353*                            VMOD 2.005                          *ECSCRIFD
   354*                                                                *ECSCRIFD
   355*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   356*                                                                *ECSCRIFD
   357******************************************************************ECSCRIFD
   358     BLOCK CONTAINS 0 RECORDS
   359     RECORDING MODE F.                                            ECSCRIFD
   360                                                                  ECSCRIFD
   361 01  CERT-IN-RECORD.                                              ECSCRIFD
   362                                                                  ECSCRIFD
   363     12  FILLER                            PIC XXX.               ECSCRIFD
   364     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   365     12  FILLER                            PIC X(66).             ECSCRIFD
   366     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   367     12  FILLER                            PIC X(20).             ECSCRIFD
   368     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   369     12  FILLER                            PIC X(14).             ECSCRIFD
   370     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   371     12  FILLER                            PIC X(39).             ECSCRIFD
   372     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   373     12  FILLER                            PIC X(45).             ECSCRIFD
   374     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   375     12  FILLER                            PIC X(35).             ECSCRIFD
   376     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   377     12  FILLER                            PIC X(41).             ECSCRIFD
   378     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   379     12  FILLER                            PIC X(48).             ECSCRIFD
   380     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   381     12  FILLER                            PIC X(9).              ECSCRIFD
   382     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   383     12  FILLER                            PIC X(120).            ECSCRIFD
   384     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   385     12  FILLER                            PIC X(73).             ECSCRIFD
   386     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   387     12  FILLER                            PIC X(464).            ECSCRIFD
   388                                                                  ECSCRIFD
   389******************************************************************ECSCRIFD
*  390                                 COPY ECSCRT01.
   391******************************************************************
   392*                                                                *
   393*                            ECSCRT01                            *
   394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   395*                            VMOD=2.016                          *
   396*                                                                *
   397*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   398*                                                                *
   399*   FILE TYPE = SEQUENTIAL
   400*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   401*                                                                *
   402*   KEY DATA =                         START=4, LEN=36           *
   403*                                                                *
   404*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
   405*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   406******************************************************************
   407******************************************************************
   408*                   C H A N G E   L O G
   409*
   410* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   411*-----------------------------------------------------------------
   412*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   413* EFFECTIVE    NUMBER
   414*-----------------------------------------------------------------
   415* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   416* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   417* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   418* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   419* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   420* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   421* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   422* 032612  CR2011110200001  PEMA  AHL CHANGES
   423******************************************************************
   424
   425 01  CERTIFICATE-RECORD.
   426     12  CR-RECORD-ID                      PIC XX.
   427         88  VALID-CR-ID                      VALUE 'CR'.
   428
   429     12  CR-COMPANY-CD                     PIC X.
   430
   431     12  CR-FULL-CONTROL.
   432         16  CR-CONTROL-1.
   433             20  CR-ACCT-CONTROL.
   434                 24  CR-CARRIER            PIC X.
   435                 24  CR-GROUPING.
   436                     28  CR-GROUP-PREFIX   PIC XXX.
   437                     28  CR-GROUP-PRIME    PIC XXX.
   438                 24  CR-STATE              PIC XX.
   439                 24  CR-ACCOUNT.
   440                     28  CR-ACCT-PREFIX    PIC X(4).
   441                     28  CR-ACCT-PRIME     PIC X(6).
   442             20  CR-DT                     PIC 9(11)  COMP-3.
   443         16  CR-CERT-NO.
   444             20  CR-CERT.
   445                 24  CR-CERT-PREFIX        PIC X(3).
   446                 24  CR-CERT-PRIME         PIC X(7).
   447             20  CR-CERT-SFX               PIC X.
   448
   449     12  CR-INSUREDS-PROFILE.
   450         16  CR-NAME.
   451             20  CR-LNAME                  PIC X(15).
   452             20  CR-FNAME.
   453                 24  CR-1ST-INITIAL        PIC X.
   454                 24  FILLER                PIC X(9).
   455             20  CR-INIT                   PIC X.
   456         16  CR-AGE                        PIC 99.
   457         16  CR-SEX                        PIC X.
   458             88  CR-SEX-MALE                  VALUE 'M'.
   459             88  CR-SEX-FEMALE                VALUE 'F'.
   460         16  CR-SOC-SEC                    PIC X(11).
   461         16  CR-JOINT-NAME.
   462             20  CR-JT-LNAME               PIC X(15).
   463             20  CR-JT-FNAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   464                 24  CR-JT-1ST-INIT        PIC X.
   465                 24  FILLER                PIC X(9).
   466             20  CR-JT-INIT                PIC X.
   467         16  CR-JOINT-AGE                  PIC 99.
   468
   469         16  cr-ahl-ah-claim-no            pic x(9).
   470         16  cr-ahl-ah-cert-seq            pic x(3).
   471         16  cr-hst-proc-lf                pic x.
   472         16  f                             pic x(7).
   473
   474     12  CR-LF-COVERAGE-DATA.
   475         16  CR-LFTYP                      PIC XX.
   476         16  CR-LF-TERM                    PIC S999       COMP-3.
   477         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   478         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   479         16  CR-LF-DEV-CODE                PIC XXX.
   480         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   481
   482         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   483         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   484         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   485         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   486
   487         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   488         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   489         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   490         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   491
   492         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   493         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   494
   495         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   496         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   497
   498         16  CR-LF-REFUND-TYPE             PIC X.
   499         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   500
   501         16  CR-LF-COMM-CHARGEBACK         PIC X.
   502             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   503
   504         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   505
   506         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   507         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   508         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   509
   510         16  cr-ahl-lf-claim-no            pic x(9).
   511         16  cr-ahl-lf-cert-seq            pic x(3).
   512         16  FILLER                        PIC XX.
   513
   514     12  CR-AH-COVERAGE-DATA.
   515         16  CR-AHTYP                      PIC XX.
   516         16  CR-AH-TERM                    PIC S999       COMP-3.
   517         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   518         16  CR-AH-DEV-CODE                PIC XXX.
   519         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   520
   521         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   522         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   523         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   524         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   525
   526         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   527         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   528
   529         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   530         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   531
   532         16  CR-AH-REFUND-TYPE             PIC X.
   533         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   534
   535         16  CR-AH-COMM-CHARGEBACK         PIC X.
   536             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   537
   538         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   539
   540         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   541         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   542         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   543
   544         16  FILLER                        PIC XX.
   545*        16  FILLER                        PIC X(8).
   546
   547     12  CR-LOAN-DATA.
   548         16  CR-LIVES                      PIC S9(7)      COMP-3.
   549         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   550                                           PIC S9(5)V99   COMP-3.
   551         16  CR-BILLED                     PIC S9(7)      COMP-3.
   552         16  CR-APR                        PIC S999V9(4)  COMP-3.
   553         16  CR-PMT-FREQ                   PIC 99.
   554         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   555         16  CR-RATING-CLASS               PIC XX.
   556         16  CR-POLICY-FORM-NO             PIC X(12).
   557         16  CR-GRPTYP                     PIC XX.
   558         16  CR-IND-GRP                    PIC X.
   559             88  CR-INDIVIDUAL                VALUE '1'.
   560             88  CR-GROUP                     VALUE '2'.
   561         16  CR-SKIP                       PIC 99.
   562             88  NO-MONTHS-SKIPPED            VALUE 00.
   563             88  SKIP-JULY                    VALUE 01.
   564             88  SKIP-AUGUST                  VALUE 02.
   565             88  SKIP-SEPTEMBER               VALUE 03.
   566             88  SKIP-JULY-AUG                VALUE 04.
   567             88  SKIP-AUG-SEPT                VALUE 05.
   568             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   569             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   570             88  SKIP-JUNE                    VALUE 08.
   571             88  SKIP-JUNE-JULY               VALUE 09.
   572             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   573             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   574         16  CR-RESIDENT-STATE             PIC XX.
   575         16  CR-RATE-CODE.
   576             20  CR-LF-CLASS-CD            PIC XX.
   577             20  CR-AH-CLASS-CD            PIC XX.
   578         16  CR-MORT.
   579             20  CR-TAB                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   580             20  CR-INT                    PIC 99.
   581             20  CR-GRP                    PIC X.
   582         16  CR-MEMBER-NO                  PIC X(12).
   583         16  CR-OLD-LOF                    PIC XXX.
   584*        16  CR-LOAN-OFFICER               PIC XXX.
   585         16  CR-REIN-TABLE                 PIC XXX.
   586         16  CR-REIN-SPEC                  PIC X.
   587         16  CR-LOAN-1ST-PMT-DT.
   588             20  CR-1ST-PMT-YR             PIC 99.
   589             20  CR-1ST-PMT-MO             PIC 99.
   590             20  CR-1ST-PMT-DA             PIC 99.
   591         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   592         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   593         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   594         16  CR-LAST-ADD-ON-DT             PIC XX.
   595
   596         16  CR-UNDERWRITING-CODE          PIC X.
   597             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   598
   599         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   600         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   601         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   602         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   603
   604     12  CR-STATUS-INFORMATION.
   605         16  CR-ENTRY-STATUS               PIC X.
   606             88  CR-NORMAL-ENTRY              VALUE '1'.
   607             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   608             88  CR-CONVERSION-ENTRY          VALUE '4'.
   609             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   610             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   611             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   612             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   613             88  CR-POLICY-IS-VOID            VALUE 'V'.
   614             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   615             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   616                                                    '5' '9' 'P'.
   617         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   618
   619         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   620         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   621         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   622
   623         16  CR-LF-STATUS-AT-DEATH         PIC X.
   624         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   625
   626         16  CR-LF-CURRENT-STATUS          PIC X.
   627             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   628             88  CR-LF-POLICY-PENDING         VALUE '2'.
   629             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   630             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   631             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   632             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   633             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   634             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   635             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   636             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   637             88  CR-LF-IS-DECLINED            VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   638             88  CR-LF-IS-VOID                VALUE 'V'.
   639             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   640                                                    '4' '5' '9'.
   641
   642         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   643
   644         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   645         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   646
   647         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   648         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   649
   650         16  CR-AH-CURRENT-STATUS          PIC X.
   651             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   652             88  CR-AH-POLICY-PENDING         VALUE '2'.
   653             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   654             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   655             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   656             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   657             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   658             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   659             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   660             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   661             88  CR-AH-IS-DECLINED            VALUE 'D'.
   662             88  CR-AH-IS-VOID                VALUE 'V'.
   663             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   664                                                    '4' '5' '9'.
   665         16  CR-LOAN-OFFICER               PIC X(5).
   666         16  CR-CANCEL-REASON              PIC X.
   667         16  cr-xycor-lf-cov-code          pic x(4).
   668         16  cr-xycor-ah-cov-code          pic x(4).
   669         16  FILLER                        PIC X(6).
   670
   671     12  CR-DEATH-CLAIM-DATA.
   672         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   673
   674         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   675         16  CR-DTH-RPT-DT.
   676             20  CR-DTH-RPT-YR             PIC 99.
   677             20  CR-DTH-RPT-MO             PIC 99.
   678             20  CR-DTH-RPT-DA             PIC 99.
   679         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   680
   681         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   682         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   683         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   684         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   685         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   686
   687         16  CR-DTH-AGE                    PIC 99.
   688         16  CR-DTH-PAY-CD                 PIC X.
   689         16  CR-DEATH-CAUSE                PIC X(6).
   690
   691         16  FILLER                        PIC X(16).
   692
   693     12  CR-DISAB-CLAIM-DATA.
   694         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   695
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   696         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   697         16  CR-DIS-RPT-DT.
   698             20  CR-DIS-RPT-YR             PIC 99.
   699             20  CR-DIS-RPT-MO             PIC 99.
   700             20  CR-DIS-RPT-DA             PIC 99.
   701         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   702         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   703
   704         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   705         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   706         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   707         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   708         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   709
   710         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   711         16  CR-DIS-PAY-CD                 PIC X.
   712         16  FILLER                        PIC XX.
   713
   714         16  CR-DISAB-INCURRED-DETAIL.
   715             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   716**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   717                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   718                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   719                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   720
   721         16  CR-DISAB-CAUSE                PIC X(6).
   722         16  FILLER                        PIC X(14).
   723
   724     12  CR-REMIT-TO                       PIC 99.
   725
   726     12  CR-COMPENSATION-LEVELS.
   727         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   728             20  CR-COM-AGT.
   729                 24  CR-COM-AGT-PREFIX     PIC X(4).
   730                 24  CR-COM-AGT-PRIME      PIC X(6).
   731             20  CR-AGT-TYPE               PIC X.
   732             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   733             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   734
   735     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   736     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   737     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   738     12  CR-CLP-STATE                      PIC XX.
   739     12  CR-POST-CARD-IND                  PIC X.
   740     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   741     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   742     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   743     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   744     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   745     12  FILLER                            PIC X(07).
   746
   747     12  CR-CSR-CODE                       PIC XXX.
   748
   749     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   750     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   751
   752     12  CR-MICROFILM-NUMBERS.
   753*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   754         16  FILLER                        PIC X(5).
   755     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   756
   757     12  CR-USER-CODE                      PIC X.
   758     12  CR-USER-FUTURE                    PIC X(9).
   759
   760     12  CR-BENEFICIARY.
   761         16  CR-BANK-NO                    PIC X(10).
   762         16  FILLER                        PIC X(15).
   763
   764     12  CR-ENTRY-BATCH                    PIC X(6).
   765     12  CR-LF-EXIT-BATCH                  PIC X(6).
   766     12  CR-AH-EXIT-BATCH                  PIC X(6).
   767
   768     12  CR-NOTE-SW                        PIC X.
   769
   770     12  CR-ORIGIN-INDICATOR               PIC X.
   771         88  CR-ENTERED-MANUALLY              VALUE '1'.
   772         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   773
   774     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   775     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   776     12  FILLER                            PIC X(33).
   777
   778******************************************************************
   779
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* ECS158.cbl
   781 FD  ERACCTT.
*  782                                 COPY ERCACCT.
   783******************************************************************04/19/98
   784*                                                                *ERCACCT
   785*                                                                *ERCACCT
   786*                            ERCACCT                             *   LV031
   787*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   788*                            VMOD=2.031                          *ERCACCT
   789*                                                                *ERCACCT
   790*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   791*                                                                *ERCACCT
   792*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   793*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   794*                                                                *ERCACCT
   795*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   796*                                                                *ERCACCT
   797*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   798*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   799*                                                                *ERCACCT
   800*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   801*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   802*                                                                *ERCACCT
   803*   LOG = NO                                                     *ERCACCT
   804*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   805*                                                                *ERCACCT
   806*                                                                *ERCACCT
   807******************************************************************ERCACCT
   808*                   C H A N G E   L O G
   809*
   810* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   811*-----------------------------------------------------------------
   812*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   813* EFFECTIVE    NUMBER
   814*-----------------------------------------------------------------
   815* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   816* 092705    2005050300006  PEMA  ADD SPP LEASES
   817* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   818* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   819* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   820* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   821* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   822******************************************************************
   823                                                                  ERCACCT
   824 01  ACCOUNT-MASTER.                                              ERCACCT
   825     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   826         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   827                                                                  ERCACCT
   828     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   829         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   830         16  AM-MSTR-CNTRL.                                       ERCACCT
   831             20  AM-CONTROL-A.                                    ERCACCT
   832                 24  AM-CARRIER            PIC X.                 ERCACCT
   833                 24  AM-GROUPING.                                 ERCACCT
   834                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   835                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   836                 24  AM-STATE              PIC XX.                ERCACCT
   837                 24  AM-ACCOUNT.                                  ERCACCT
   838                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
   839                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   840             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   841                                           PIC X(19).             ERCACCT
   842             20  AM-CNTRL-B.                                      ERCACCT
   843                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   844                 24  FILLER                PIC X(4).              ERCACCT
   845             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   846                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   847                                                                  ERCACCT
   848     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   849         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   850         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   851         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   852         16  AM-VG-STATE                   PIC XX.                ERCACCT
   853         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   854         16  AM-VG-DATE.                                          ERCACCT
   855             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   856             20  FILLER                    PIC X(4).              ERCACCT
   857         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   858                                           PIC 9(11)      COMP-3. ERCACCT
   859     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   860         16  FILLER                        PIC X(10).
   861         16  AM-VG-KEY3.
   862             20  AM-VG3-ACCOUNT            PIC X(10).
   863             20  AM-VG3-EXP-DT             PIC XX.
   864         16  FILLER                        PIC X(4).
   865     12  AM-MAINT-INFORMATION.                                    ERCACCT
   866         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   867         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   868         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   869         16  FILLER                        PIC XX.                ERCACCT
   870                                                                  ERCACCT
   871     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   872     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   873                                                                  ERCACCT
   874     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   875         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   876         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   877                                                                  ERCACCT
   878     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   879     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   880                                                                  ERCACCT
   881     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   882     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   883                                                                  ERCACCT
   884     12  AM-NAME                           PIC X(30).             ERCACCT
   885     12  AM-PERSON                         PIC X(30).             ERCACCT
   886     12  AM-ADDRS                          PIC X(30).             ERCACCT
   887     12  AM-CITY.
   888         16  AM-ADDR-CITY                  PIC X(28).
   889         16  AM-ADDR-STATE                 PIC XX.
   890     12  AM-ZIP.                                                  ERCACCT
   891         16  AM-ZIP-PRIME.                                        ERCACCT
   892             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   893                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   894             20  FILLER                    PIC X(4).              ERCACCT
   895         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   896     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
   897         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   898         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   899         16  FILLER                        PIC XXX.               ERCACCT
   900     12  AM-TEL-NO.                                               ERCACCT
   901         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   902         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   903         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   904     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   905         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   906         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   907                                                                  ERCACCT
   908     12  AM-COMM-STRUCTURE.                                       ERCACCT
   909         16  AM-DEFN-1.                                           ERCACCT
   910             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   911                 24  AM-AGT.                                      ERCACCT
   912                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   913                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   914                 24  AM-COM-TYP            PIC X.                 ERCACCT
   915                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   916                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   917                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   918                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   919                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   920                 24  AM-GL-CODES           PIC X.                 ERCACCT
   921                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   922                 24  FILLER                PIC X(01).             ERCACCT
   923         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   924             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   925                 24  FILLER                PIC X(11).             ERCACCT
   926                 24  AM-L-COMA             PIC XXX.               ERCACCT
   927                 24  AM-J-COMA             PIC XXX.               ERCACCT
   928                 24  AM-A-COMA             PIC XXX.               ERCACCT
   929                 24  FILLER                PIC X(6).              ERCACCT
   930                                                                  ERCACCT
   931     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   932         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   933                                                                  ERCACCT
   934     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   935                                                                  ERCACCT
   936     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   937         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   938         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   939     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   940         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   941         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   942     12  AM-GPCD                           PIC 99.                ERCACCT
   943     12  AM-IG                             PIC X.                 ERCACCT
   944         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   945         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   946     12  AM-STATUS                         PIC X.                 ERCACCT
   947         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   948         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   949         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   950         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   951         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   952         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   953     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   954     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
   955                                                                  ERCACCT
   956     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   957     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   958     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   959     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   960     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   961     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   962     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   963     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   964     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   965                                                                  ERCACCT
   966     12  AM-USER-FIELDS.                                          ERCACCT
   967         16  AM-FLD-1                      PIC XX.                ERCACCT
   968         16  AM-FLD-2                      PIC XX.                ERCACCT
   969         16  AM-FLD-3                      PIC XX.                ERCACCT
   970         16  AM-FLD-4                      PIC XX.                ERCACCT
   971         16  AM-FLD-5                      PIC XX.                ERCACCT
   972                                                                  ERCACCT
   973     12  AM-1ST-PROD-DATE.                                        ERCACCT
   974         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   975         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   976         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   977     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   978     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   979         16  AM-PUR-YR                     PIC XX.                ERCACCT
   980         16  AM-PUR-MO                     PIC XX.                ERCACCT
   981         16  AM-PUR-DA                     PIC XX.                ERCACCT
   982     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   983     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   984     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   985     12  AM-INACTIVE-DATE.                                        ERCACCT
   986         16  AM-INA-MO                     PIC 99.                ERCACCT
   987         16  AM-INA-DA                     PIC 99.                ERCACCT
   988         16  AM-INA-YR                     PIC 99.                ERCACCT
   989     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   990                                                                  ERCACCT
   991     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   992     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   993                                                                  ERCACCT
   994     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   995         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   996         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   997         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   998         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   999                                                                  ERCACCT
  1000     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  1001         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  1002         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  1003                                                                  ERCACCT
  1004     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  1005                                                                  ERCACCT
  1006     12  AM-OVER-SHORT.                                           ERCACCT
  1007         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  1008         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  1009                                                                  ERCACCT
  1010     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1011     12  AM-DCC-CLP-STATE                  PIC XX.
  1012                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1013     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  1014     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  1015                                                                  ERCACCT
  1016     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  1017     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  1018     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  1019     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  1020     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  1021     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  1022     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  1023     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  1024     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  1025     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  1026     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  1027     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  1028     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  1029     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  1030     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  1031     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  1032                                                                  ERCACCT
  1033     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  1034                                                                  ERCACCT
  1035     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  1036     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  1037                                                                  ERCACCT
  1038     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  1039     12  AM-EARN-METHODS.                                         ERCACCT
  1040         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  1041             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  1042             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  1043             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  1044             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  1045         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  1046             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  1047             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  1048             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  1049             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  1050         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  1051             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  1052             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  1053             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  1054             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  1055             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  1056             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  1057                                                                  ERCACCT
  1058     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  1059     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  1060     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  1061                                                                  ERCACCT
  1062     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  1063     12  AM-RET-P-E                        PIC X.                 ERCACCT
  1064     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  1065     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  1066     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  1067     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  1068         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  1069         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
  1070     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1071         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  1072         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  1073         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  1074     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  1075         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  1076         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  1077     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  1078         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  1079         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  1080         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  1081     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  1082     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  1083                                                                  ERCACCT
  1084     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  1085         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  1086         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  1087         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  1088         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  1089         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  1090                                                                  ERCACCT
  1091     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  1092                                                                  ERCACCT
  1093     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  1094                                                                  ERCACCT
  1095     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  1096         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  1097                                                                  ERCACCT
  1098     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  1099         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  1100         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  1101                                                                  ERCACCT
  1102     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  1103         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  1104                                                                  ERCACCT
  1105     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  1106         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  1107         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  1108                                                                  ERCACCT
  1109     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  1110                                                                  ERCACCT
  1111     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  1112     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1113     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1114     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1115     12  AM-DCC-UEF-STATE                  PIC XX.
  1116     12  FILLER                            PIC XXX.
  1117     12  AM-REPORT-CODE-3                  PIC X(10).
  1118*    12  FILLER                            PIC X(22).             ERCACCT
  1119                                                                  ERCACCT
  1120     12  AM-RESERVE-DATE.                                         ERCACCT
  1121         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  1122         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  1123         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  1124                                                                  ERCACCT
  1125     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  1126     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  1127         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
  1128         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1129         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  1130         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  1131                                                                  ERCACCT
  1132     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  1133         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  1134         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  1135         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  1136         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  1137                                                                  ERCACCT
  1138     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  1139         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  1140             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  1141             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  1142             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  1143             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  1144             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  1145             20  FILLER                    PIC XX.                ERCACCT
  1146         16  FILLER                        PIC X(80).             ERCACCT
  1147                                                                  ERCACCT
  1148     12  AM-TRANSFER-DATA.                                        ERCACCT
  1149         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  1150             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  1151             20  AM-TRNFROM-GROUPING.                             ERCACCT
  1152                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  1153                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  1154             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  1155             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  1156                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  1157                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  1158             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  1159         16  AM-TRANSFERRED-TO.                                   ERCACCT
  1160             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  1161             20  AM-TRNTO-GROUPING.                               ERCACCT
  1162                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  1163                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  1164             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  1165             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  1166                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  1167                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  1168             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  1169         16  FILLER                        PIC X(10).             ERCACCT
  1170                                                                  ERCACCT
  1171     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  1172                                                                  ERCACCT
  1173     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  1174         16  AM-DEFN-1-SAVED.                                     ERCACCT
  1175             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  1176                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  1177                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  1178                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1179                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1180                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1181                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  1182                 24  FILLER                PIC X.                 ERCACCT
  1183                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  1184                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  1185                 24  FILLER                PIC X.                 ERCACCT
  1186         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1187             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  1188                 24  FILLER                PIC X(11).             ERCACCT
  1189                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  1190                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  1191                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  1192                 24  FILLER                PIC X(6).              ERCACCT
  1193                                                                  ERCACCT
  1194     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  1195         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  1196            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  1197            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  1198            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  1199                                                                  ERCACCT
  1200     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  1201     12  FILLER                            PIC X(120).            ERCACCT
  1202                                                                  ERCACCT
  1203     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  1204         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  1205         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  1206             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  1207             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  1208                                                          COMP-3. ERCACCT
  1209             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  1210                                                          COMP-3. ERCACCT
  1211         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  1212             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  1213             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  1214                                                          COMP-3. ERCACCT
  1215             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  1216                                                          COMP-3. ERCACCT
  1217                                                                  ERCACCT
  1218     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  1219         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  1220         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  1221         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  1222         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  1223             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  1224                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  1225                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  1226             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  1227                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  1228                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  1229             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  1230                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  1231                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  1232         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  1233             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  1234                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  1235                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  1236                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  1237             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  1238                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  1239                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  1240             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  1241                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  1242                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  1243                                                                  ERCACCT
  1244     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1245         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  1246                                                                  ERCACCT
  1247     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  1248         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  1249         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  1250         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  1251         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  1252         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  1253             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  1254             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  1255             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  1256             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  1257         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  1258             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  1259             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  1260             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  1261         16  FILLER                        PIC X(102).            ERCACCT
  1262                                                                  ERCACCT
  1263     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  1264         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  1265             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  1266             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  1267             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  1268             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  1269             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  1270         16  FILLER                          PIC X(10).           ERCACCT
  1271******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* ECS158.cbl
  1273 SD  SORT-CLMS.
  1274
  1275 01  SORT-CLMS-REC.
  1276     12  SORT-CLAIM-KEY.
  1277         16  S-CARRIER       PIC X(01).
  1278         16  S-GROUPING      PIC X(06).
  1279         16  S-STATE         PIC X(02).
  1280         16  S-ACCOUNT       PIC X(10).
  1281         16  S-EFF-DATE      PIC X(06).
  1282         16  S-CERT-NO       PIC X(11).
  1283     12  SORT-EP-EXTR        PIC X(510).
  1284
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* ECS158.cbl
  1286 FD  SORTED-CLAIMS
  1287     BLOCK CONTAINS 0 RECORDS
  1288     RECORDING MODE IS F.
  1289
  1290 01  SORTED-CLAIMS-REC.
  1291     12  FILLER              PIC X(36).
  1292     12  SORTED-EXTRACT      PIC X(510).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* ECS158.cbl
  1294 FD  XTRACT
  1295     BLOCK CONTAINS 0 RECORDS
  1296     RECORDING MODE IS F.
  1297
  1298
  1299 01  CALL-X                      PIC X(666).
  1300
  1301 FD  XTRS-IN
  1302     BLOCK CONTAINS 0 RECORDS
  1303     RECORDING MODE IS F.
  1304
  1305 01  XTR-RECORD                  PIC X(666).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* ECS158.cbl
  1307 FD  DISK-DATE
* 1308                                 COPY ELCDTEFD.
  1309******************************************************************04/15/98
  1310*                                                                *ELCDTEFD
  1311*                                                                *ELCDTEFD
  1312*                            ELCDTEFD.                           *   LV002
  1313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1314*                            VMOD=2.007                          *   CL**2
  1315*                                                                *ELCDTEFD
  1316******************************************************************ELCDTEFD
  1317     BLOCK CONTAINS 0 RECORDS
  1318     RECORDING MODE F.                                            ELCDTEFD
  1319                                                                  ELCDTEFD
  1320 01  DATE-DISK.                                                   ELCDTEFD
  1321     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1322     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1323     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1324     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1325     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1326     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1327     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1328                                                                  ELCDTEFD
  1329 01  DATE-DISK-R.                                                 ELCDTEFD
  1330     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1331     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1332                                     PIC  X(32).                  ELCDTEFD
  1333                                                                  ELCDTEFD
  1334 01  DATE-DISK-T.                                                 ELCDTEFD
  1335     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1336     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1337                                     PIC  X(48).                  ELCDTEFD
  1338                                                                  ELCDTEFD
  1339 01  DATE-DISK-M.                                                 ELCDTEFD
  1340     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1341     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1342                                     PIC  X(48).                  ELCDTEFD
  1343                                                                  ELCDTEFD
  1344 01  DATE-DISK-P.                                                 ELCDTEFD
  1345     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1346     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1347     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1348     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1349         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1350                                     PIC  X.                      ELCDTEFD
  1351         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1352     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1353         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1354             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1355             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1356             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1357             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1358         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1359                                                                  ELCDTEFD
  1360 01  DATE-DISK-E.                                                 ELCDTEFD
  1361     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1362     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1363                                     PIC  X(4).                   ELCDTEFD
  1364                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1365 01  DATE-DISK-C.                                                 ELCDTEFD
  1366     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1367     12  DD-CARR1-SECPAY-SW          PIC  X.
  1368     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1369     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1370     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1371     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1372     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1373     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1374     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1375     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1376     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1377     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1378     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1379     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1380     12  DD-CARR2-SECPAY-SW          PIC  X.
  1381     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1382                                                                  ELCDTEFD
  1383 01  DATE-DISK-OPT.                                               ELCDTEFD
  1384     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1385     12  DD-TLR-DATA.                                             ELCDTEFD
  1386         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1387                                     PIC  X(03).                  ELCDTEFD
  1388     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1389         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1390                                     PIC  X(06).                  ELCDTEFD
  1391     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1392         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1393                                     PIC  X(07).                  ELCDTEFD
  1394         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1395     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1396                                     PIC  X(96).                  ELCDTEFD
  1397******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* ECS158.cbl
  1399 FD  PRINTX
* 1400                                 COPY ELCPRTFD.
  1401******************************************************************04/15/98
  1402*                                                                *ELCPRTFD
  1403*                                                                *ELCPRTFD
  1404*                            ELCPRTFD.                           *   LV003
  1405*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1406*                            VMOD=2.006                          *ELCPRTFD
  1407******************************************************************ELCPRTFD
  1408     RECORDING MODE F                                             ELCPRTFD
  1409     LABEL RECORDS OMITTED                                        ELCPRTFD
  1410     BLOCK CONTAINS 0 RECORDS
  1411     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  1412 01  PRT.                                                         ELCPRTFD
  1413     12  P-CTL               PIC  X.                                 CL**2
  1414     12  P-DATA              PIC  X(132).                         ELCPRTFD
  1415******************************************************************ELCPRTFD
  1416 FD  PRINTC
  1417     RECORDING MODE F.
  1418
  1419 01  PRTC.
  1420     12  PRTC-CTL                PIC X(01).
  1421     12  PRTC-DATA               PIC X(132).
  1422
  1423 FD  FICH
* 1424                                 COPY ECSFICH.
  1425******************************************************************10/06/86
  1426*                                                                *ECSFICH
  1427*                            ECSFICH                             *   LV001
  1428*                            VMOD=2.001                          *ECSFICH
  1429*                                                                *ECSFICH
  1430*  NO  CSO  MODS  IN  COPYBOOK  ECSFICH                          *ECSFICH
  1431*                                                                *ECSFICH
  1432******************************************************************ECSFICH
  1433     RECORDING MODE F                                             ECSFICH
  1434     LABEL RECORDS STANDARD                                       ECSFICH
  1435     BLOCK CONTAINS 0 RECORDS
  1436     RECORD CONTAINS 133 CHARACTERS.                              ECSFICH
  1437 01  FICH-REC                PIC  X(133).                         ECSFICH
  1438******************************************************************ECSFICH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* ECS158.cbl
  1440 WORKING-STORAGE SECTION.
  1441 77  FILLER  PIC X(32) VALUE '********************************'.
  1442 77  FILLER  PIC X(32) VALUE '     ECS158 WORKING STORAGE     '.
  1443 77  FILLER  PIC X(32) VALUE '********* VMOD=2.041 ***********'.
  1444
  1445 77  WS-CLMS-DB-CNT          PIC 9(9)  VALUE ZEROS.
  1446 77  WS-CERT-DB-CNT          PIC 9(9)  VALUE ZEROS.
  1447 77  WS-ACCT-DB-CNT          PIC 9(9)  VALUE ZEROS.
  1448 77  WS-RTBL-DB-CNT          PIC 9(9)  VALUE ZEROS.
  1449 77  WS-SCLM-DB-CNT          PIC 9(9)  VALUE ZEROS.
  1450 77  WS-RATE-DB-CNT          PIC 9(9)  VALUE ZEROS.
  1451 77  WS-TOT-CLMS-DB-CNT      PIC 9(9)  VALUE ZEROS.
  1452 77  WS-TOT-CERT-DB-CNT      PIC 9(9)  VALUE ZEROS.
  1453 77  WS-TOT-ACCT-DB-CNT      PIC 9(9)  VALUE ZEROS.
  1454 77  WS-TOT-RTBL-DB-CNT      PIC 9(9)  VALUE ZEROS.
  1455 77  WS-TOT-SCLM-DB-CNT      PIC 9(9)  VALUE ZEROS.
  1456 77  WS-TOT-RATE-DB-CNT      PIC 9(9)  VALUE ZEROS.
  1457 77  FROM-LIFE-SW            PIC X(01) VALUE SPACES.
  1458 77  PAGE-CTR                PIC S9(07)    VALUE +0  COMP-3.
  1459 77  LF-BAL-REMTERM          PIC S9(03)V99 VALUE +0 COMP-3.
  1460 77  LINE-CTR                PIC S9(03)    VALUE +99 COMP-3.
  1461 77  WRK-A                   PIC S9(7)V99  VALUE +0  COMP-3.
  1462 77  WRK-B                   PIC S9(7)V99  VALUE +0  COMP-3.
  1463 77  WRK-ALT                 PIC S9(7)V99  VALUE +0  COMP-3.
  1464 77  WRK-C                   PIC S9(07)V99 VALUE +0  COMP-3.
  1465 77  WRK-D                   PIC S9(4)V9(11) VALUE +0  COMP-3.
  1466 77  WRK-E                   PIC S9(4)V9(11) VALUE +0  COMP-3.
  1467 77  WRK-F                   PIC S9(07)V99 VALUE +0  COMP-3.
  1468 77  WRK-G                   PIC S9(07)V99 VALUE +0  COMP-3.
  1469 77  WRK-H                   PIC S9(07)V99 VALUE +0  COMP-3.
  1470 77  WS-DIFF                 PIC S9(7)V9(5) VALUE +0 COMP-3.
  1471 77  WRK-REMTRM              PIC S9(03)    VALUE +0  COMP-3.
  1472 77  WS-MEAN-CALC            PIC S9(09)V99 VALUE +0  COMP-3.
  1473 77  WS-ACCT-MATCH-SW        PIC X(01)  VALUE SPACES.
  1474     88  ACCOUNT-MATCHED         VALUE '*'.
  1475 77  M4                      PIC S9(03)V99 VALUE +0  COMP-3.
  1476 77  M9                      PIC S9(03)V99 VALUE +0  COMP-3.
  1477 77  WORK-M4                 PIC S9(03)    VALUE +0  COMP-3.
  1478 77  ACCT-MATCH-CONTROL      PIC X(19)     VALUE LOW-VALUES.
  1479 77  ACCT-MATCH-EFF          PIC 9(11)     VALUE 0.
  1480 77  LIFE-AH-SUB             PIC S9(04)    VALUE +0  COMP.
  1481 77  CERT-CONTROL            PIC X(36)     VALUE LOW-VALUES.
  1482 77  CLAIMS-CONTROL          PIC X(36)     VALUE LOW-VALUES.
  1483 77  HOLD-CLAIMS-CONTROL     PIC X(36)     VALUE LOW-VALUES.
  1484 77  WS-LF-RATE-ATTEMPT      PIC 9(07)     VALUE ZEROS.
  1485 77  WS-AH-RATE-ATTEMPT      PIC 9(07)     VALUE ZEROS.
  1486 77  WS-LF-RATE-ERROR        PIC 9(07)     VALUE ZEROS.
  1487 77  WS-AH-RATE-ERROR        PIC 9(07)     VALUE ZEROS.
  1488 77  WS-HOLD-LF-PRIM-FAC     PIC S9(9)V99  VALUE +0  COMP-3.
  1489 77  WS-HOLD-AH-PRIM-FAC     PIC S9(9)V99  VALUE +0  COMP-3.
  1490 77  LF-DEV-TO-PRIM-FACTOR   PIC S99V9(5)  VALUE +0  COMP-3.
  1491 77  AH-DEV-TO-PRIM-FACTOR   PIC S99V9(5)  VALUE +0  COMP-3.
  1492 77  YR                      PIC S999      VALUE +3  COMP.
  1493 77  SA                      PIC S999      VALUE +0  COMP.
  1494 77  SB                      PIC S999      VALUE +0  COMP.
  1495 77  REM-TRM                 PIC S999      VALUE +0  COMP-3.
  1496 77  SV-FACTOR               PIC S9        VALUE +0  COMP-3.
  1497 77  COMM-PREMM              PIC S9(7)V99  VALUE +0  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* ECS158.cbl
  1498 77  AGT-COMM                PIC S9(4)V99  VALUE +0  COMP-3.
  1499 77  REINS                   PIC S9(6)     VALUE +0  COMP-3.
  1500 77  FLD                     PIC S999      VALUE +0  COMP-3.
  1501 77  X                       PIC X         VALUE ' '.
  1502 77  ACC-SW                  PIC X         VALUE SPACES.
  1503 77  EFF-COUNT               PIC X         VALUE SPACES.
  1504 77  FLA-CLM-REIN-BASE       PIC S9(5)V99  VALUE +0  COMP-3.
  1505 77  ADJ-FLA-REIN-BASE       PIC S9(5)V9(4) VALUE +0 COMP-3.
  1506 77  REIN-RT-SW              PIC X         VALUE SPACE.
  1507 77  DTO-CC                  PIC 9(2)      VALUE 0.
  1508 77  DTO-YR                  PIC 9(2)      VALUE 0.
  1509 77  DTO-MO                  PIC 9(2)      VALUE 0.
  1510 77  WORK-MO                 PIC 9(3)      VALUE 0.
  1511 77  WORK-MO1                PIC 9(3)      VALUE 0.
  1512 77  CALL-CNT                PIC S9(7)     VALUE +0  COMP-3.
  1513 77  TEXAS-CNT               PIC S9(7)     VALUE +0  COMP-3.
  1514 77  ERRTBL-FILE-STATUS      PIC XX        VALUE '00'.
  1515 77  ERACCTT-FILE-STATUS     PIC XX        VALUE '00'.
  1516 77  LF-EARN-CODE            PIC X(01)     VALUE ' '.
  1517 77  AH-EARN-METHOD          PIC X(01)     VALUE ' '.
  1518 77  TEMP-3                  PIC S9(2)V9(9) VALUE +0 COMP-3.
  1519 77  WS-MATCH-SWITCH         PIC X(01)     VALUE ' '.
  1520     88  CLAIM-NO-CERT           VALUE '1'.
  1521     88  CERT-NO-CLAIM           VALUE '2'.
  1522     88  CERT-AND-CLAIM          VALUE '3'.
  1523 77  MEAN-CAL                PIC S9(11)V99 VALUE +0  COMP-3.
  1524 77  WS-ACCT-MATCH           PIC X(01)     VALUE SPACES.
  1525     88  FROM-CLAIM              VALUE '1'.
  1526     88  FROM-CERT               VALUE '2'.
  1527 77  SAVE-STATE              PIC X(02)     VALUE SPACES.
  1528 77  TEMP-STATE              PIC X(02)     VALUE SPACES.
  1529 77  SAVE-BUSC-TYPE          PIC 9(02)     VALUE ZEROS.
  1530 77  WS-REPORT-SW            PIC X(01)     VALUE SPACES.
  1531     88  STATE-IS-EXCLUDED       VALUE 'X'.
  1532     88  REPORT-OVER-UNDER-60    VALUES '4' '5'.
  1533 77  WS-EXCL-BUSC-SW         PIC X(01)     VALUE SPACES.
  1534     88  BUSC-TYPE-IS-EXCLUDED   VALUE 'X'.
  1535 77  EXCL-SUB                PIC S9(04)    VALUE +0  COMP.
  1536 77  STATE-TX                PIC X(02)     VALUE SPACES.
  1537 77  STATE-IL                PIC X(02)     VALUE SPACES.
  1538 77  STATE-GA                PIC X(02)     VALUE SPACES.
  1539 77  STATE-NC                PIC X(02)     VALUE SPACES.
  1540 77  STATE-UT                PIC X(02)     VALUE SPACES.
  1541 77  STATE-IA                PIC X(02)     VALUE SPACES.
  1542 77  STATE-NE                PIC X(02)     VALUE SPACES.
  1543 77  STATE-NV                PIC X(02)     VALUE SPACES.
  1544 77  STATE-OH                PIC X(02)     VALUE SPACES.
  1545 77  STATE-OR                PIC X(02)     VALUE SPACES.
  1546 77  STATE-WI                PIC X(02)     VALUE SPACES.
  1547 77  WS-PROCESS-SW           PIC X(01)     VALUE SPACES.
  1548     88  SINGLE-PERIOD-PROCESS   VALUE 'Y'.
  1549 77  NUMBER-OF-PERIODS       PIC S999      VALUE +3  COMP.
  1550 77  WK-DEV-FACTOR           PIC S9(7)     VALUE +1000000.
  1551
  1552 01  WS-DEBUG-AREA.
  1553     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
  1554         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
  1555         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* ECS158.cbl
  1556         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
  1557         88  DEBUG-LF-STATUTORY         VALUE '3'.
  1558         88  DEBUG-AH-STATUTORY         VALUE '4'.
  1559     12  WS-S-CNT                PIC S9(11) COMP-3 VALUE +0.
  1560     12  WS-S-INFORCE-CNT        PIC S9(11) COMP-3 VALUE +0.
  1561     12  WS-S-STATUTORY          PIC S9(11)V99 COMP-3 VALUE +0.
  1562     12  FORMAT-DATE.
  1563         16  FORMAT-MONTH        PIC XX.
  1564         16  FILLER              PIC X  VALUE '/'.
  1565         16  FORMAT-DAY          PIC XX.
  1566         16  FILLER              PIC X  VALUE '/'.
  1567         16  FORMAT-YEAR         PIC XX.
  1568     12  BIN-DE-CLM-PROC-DT      PIC XX.
  1569     12  BIN-DE-INCUR            PIC XX.
  1570
  1571 01  WORK-DEVIATION-CODES.
  1572     12  WK-LF-DEV-CODE.
  1573         16  WK-LF-DEV-CODE-1    PIC X.
  1574         16  WK-LF-DEV-CODE-2    PIC X.
  1575         16  WK-LF-DEV-CODE-3    PIC X.
  1576     12  WK-AH-DEV-CODE.
  1577         16  WK-AH-DEV-CODE-1    PIC X.
  1578         16  WK-AH-DEV-CODE-2    PIC X.
  1579         16  WK-AH-DEV-CODE-3    PIC X.
  1580     12  WK-TEMP-DEV-PCT         PIC 9(7).
  1581     12  WK-TEMP-DEV-PCT-RDF     REDEFINES WK-TEMP-DEV-PCT.
  1582         16  WK-TEMP-DEV         PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* ECS158.cbl
* 1584                             COPY ECSEXTCL.
  1585******************************************************************11/18/98
  1586*                                                                *ECSEXTCL
  1587*                             ECSEXTCL                           *   LV010
  1588*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
  1589*                            VMOD=2.006                          *ECSEXTCL
  1590*                                                                *ECSEXTCL
  1591*     FILE DESCRIPTION = STATE CALL EXTRACT RECORD  (OFF-LINE)   *ECSEXTCL
  1592*                                                                *ECSEXTCL
  1593*     FILE TYPE = SEQUENTIAL                                     *ECSEXTCL
  1594*     RECORD SIZE = XXX  RECFORM = FIXED                         *ECSEXTCL
  1595*                                                                *ECSEXTCL
  1596*     KEY DATA =     START=1, LEN=XX                             *ECSEXTCL
  1597*                                                                *ECSEXTCL
  1598******************************************************************ECSEXTCL
  1599 01  CALL-EXTRACT.                                                ECSEXTCL
  1600     12  SORT-KEY.                                                ECSEXTCL
  1601         16  SX-RECORD-TYPE          PIC X.                       ECSEXTCL
  1602         16  SX-REIN-CO              PIC X(6).                    ECSEXTCL
  1603         16  SX-CARRIER              PIC X.                       ECSEXTCL
  1604         16  SX-GROUPING             PIC X(6).                    ECSEXTCL
  1605         16  SX-STATE                PIC XX.                      ECSEXTCL
  1606         16  SX-ACCOUNT              PIC X(10).                   ECSEXTCL
  1607         16  SX-TERM-CD              PIC X.                       ECSEXTCL
  1608         16  FILLER                  PIC X.                       ECSEXTCL
  1609         16  SX-CAL-TABLE            PIC XX.                      ECSEXTCL
  1610         16  SX-ACCT-TYPE            PIC XX.                      ECSEXTCL
  1611         16  SX-STATE-DEV            PIC XXX.                     ECSEXTCL
  1612     12  EX-REST-OF-RECORD.                                       ECSEXTCL
  1613         16  EX-REIN                 PIC X(6).                    ECSEXTCL
  1614         16  EX-CARRIER              PIC X.                       ECSEXTCL
  1615         16  EX-GROUPING             PIC X(6).                    ECSEXTCL
  1616         16  EX-STATE                PIC XX.                      ECSEXTCL
  1617         16  EX-TERM-CD              PIC X.                       ECSEXTCL
  1618         16  EX-STATE-DEV            PIC X(3).                    ECSEXTCL
  1619         16  EX-I-G                  PIC X.                       ECSEXTCL
  1620         16  EX-CAL-TABLE            PIC XX.                      ECSEXTCL
  1621         16  EX-ACCT-TYPE            PIC XX.                      ECSEXTCL
  1622         16  EX-ACCOUNT              PIC X(10).                   ECSEXTCL
  1623         16  EX-RECORD-TYPE          PIC X.                       ECSEXTCL
  1624         16  EX-TX-RESV-ADJ-REC      PIC X.                       ECSEXTCL
  1625         16  EX-LIFE-AH              PIC X.                       ECSEXTCL
  1626         16  EX-BEN-TYPE             PIC XX.                      ECSEXTCL
  1627         16  EX-TERM                 PIC S999         COMP-3.     ECSEXTCL
  1628         16  EX-PREM                 PIC S9(7)V99     COMP-3.     ECSEXTCL
  1629         16  EX-PREM-ALT             PIC S9(7)V99     COMP-3.     ECSEXTCL
  1630         16  EX-EFF-DATE             PIC 9(8).                       CL**9
  1631         16  EX-NAME                 PIC X(20).                   ECSEXTCL
  1632         16  EX-AGE                  PIC 99.                      ECSEXTCL
  1633         16  EX-ENTRY-DATE           PIC 9(8).                       CL**8
  1634         16  EX-EXIT-DATE            PIC 9(8).                       CL**9
  1635         16  EX-PMT-FREQ             PIC 99.                      ECSEXTCL
  1636         16  EX-APR                  PIC S9(3)V9(4)   COMP-3.     ECSEXTCL
  1637         16  EX-CAP-TERM             PIC S999         COMP-3.     ECSEXTCL
  1638         16  EX-EARN-METHOD          PIC X.                       ECSEXTCL
  1639         16  EX-PRIM-FAC-PREM        PIC S9(7)V99     COMP-3.     ECSEXTCL
  1640         16  EX-PRIM-FAC-PREM-ALT    PIC S9(7)V99     COMP-3.     ECSEXTCL
  1641         16  EX-INITIAL-AMT          PIC S9(9)V99     COMP-3.     ECSEXTCL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* ECS158.cbl (/apps/prod/cid1p/copy/ECSEXTCL)
  1642         16  EX-BENEFIT              PIC S9(7)V99     COMP-3.     ECSEXTCL
  1643         16  EX-DATA-BY-YEAR   OCCURS 3 TIMES.                    ECSEXTCL
  1644             20  EX-INC-CNT          PIC S999         COMP-3.     ECSEXTCL
  1645             20  EX-PD-CNT           PIC S999         COMP-3.     ECSEXTCL
  1646             20  EX-C-CNT            PIC S999         COMP-3.     ECSEXTCL
  1647             20  EX-CLAIM-AMT        PIC S9(9)V99     COMP-3.     ECSEXTCL
  1648             20  RR                  PIC S999         COMP-3.     ECSEXTCL
  1649             20  M1                  PIC S999         COMP-3.     ECSEXTCL
  1650             20  M2                  PIC S999V9       COMP-3.     ECSEXTCL
  1651             20  M3                  PIC S999V9       COMP-3.     ECSEXTCL
  1652             20  M5                  PIC S999         COMP-3.     ECSEXTCL
  1653             20  M6                  PIC S999         COMP-3.     ECSEXTCL
  1654             20  EX-BEG-ST-RES       PIC S9(7)V99     COMP-3.     ECSEXTCL
  1655             20  EX-END-ST-RES       PIC S9(7)V99     COMP-3.     ECSEXTCL
  1656             20  EX-BEG-R78-RES      PIC S9(7)V99     COMP-3.     ECSEXTCL
  1657             20  EX-END-R78-RES      PIC S9(7)V99     COMP-3.     ECSEXTCL
  1658             20  EX-BEG-PRO-RES      PIC S9(7)V99     COMP-3.     ECSEXTCL
  1659             20  EX-END-PRO-RES      PIC S9(7)V99     COMP-3.     ECSEXTCL
  1660             20  EX-BEG-MEAN-RES     PIC S9(7)V99     COMP-3.     ECSEXTCL
  1661             20  EX-END-MEAN-RES     PIC S9(7)V99     COMP-3.     ECSEXTCL
  1662             20  EX-PRI-BEG-ST-RES   PIC S9(7)V99     COMP-3.     ECSEXTCL
  1663             20  EX-PRI-END-ST-RES   PIC S9(7)V99     COMP-3.     ECSEXTCL
  1664             20  EX-PRI-BEG-R78-RES  PIC S9(7)V99     COMP-3.     ECSEXTCL
  1665             20  EX-PRI-END-R78-RES  PIC S9(7)V99     COMP-3.     ECSEXTCL
  1666             20  EX-PRI-BEG-PRO-RES  PIC S9(7)V99     COMP-3.     ECSEXTCL
  1667             20  EX-PRI-END-PRO-RES  PIC S9(7)V99     COMP-3.     ECSEXTCL
  1668             20  EX-PRI-BEG-MEAN-RES PIC S9(7)V99     COMP-3.     ECSEXTCL
  1669             20  EX-PRI-END-MEAN-RES PIC S9(7)V99     COMP-3.     ECSEXTCL
  1670             20  EX-MEAN-INFORCE     PIC S9(11)V99    COMP-3.     ECSEXTCL
  1671             20  EX-OVR-COMM         PIC S9(5)V99     COMP-3.     ECSEXTCL
  1672             20  EX-AGT-COMM         PIC S9(5)V99     COMP-3.     ECSEXTCL
  1673             20  EX-CNC-AMT          PIC S9(7)V99     COMP-3.     ECSEXTCL
  1674             20  EX-B-IBNR           PIC S9(9)V99     COMP-3.     ECSEXTCL
  1675             20  EX-E-IBNR           PIC S9(9)V99     COMP-3.     ECSEXTCL
  1676             20  EX-B-LOSS           PIC S9(9)V99     COMP-3.     ECSEXTCL
  1677             20  EX-E-LOSS           PIC S9(9)V99     COMP-3.     ECSEXTCL
  1678             20  EX-RETRO-PMTS       PIC S9(9)V99     COMP-3.     ECSEXTCL
  1679             20  FILLER              PIC X(12).                      CL*10
  1680                                                                  ECSEXTCL
  1681******************************************************************ECSEXTCL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* ECS158.cbl
  1683
* 1684                             COPY ECSEXT01.
  1685******************************************************************04/29/98
  1686*                                                                *ECSEXT01
  1687*                            ECSEXT01                            *   LV015
  1688*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1689*                            VMOD=2.015                          *ECSEXT01
  1690*                                                                *ECSEXT01
  1691*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1692*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1693*                                                                *ECSEXT01
  1694*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1695*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1696*                                                                *ECSEXT01
  1697*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1698*                                                                *ECSEXT01
  1699******************************************************************ECSEXT01
  1700******************************************************************
  1701*                   C H A N G E   L O G
  1702*
  1703* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1704*-----------------------------------------------------------------
  1705*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1706* EFFECTIVE    NUMBER
  1707*-----------------------------------------------------------------
  1708* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1709* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1710* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1711* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1712* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1713* 032612  CR2011110200001  PEMA  AHL CHANGES
  1714******************************************************************
  1715                                                                  ECSEXT01
  1716 01  DETAIL-EXTRACT.                                              ECSEXT01
  1717     02 DETAIL-FILE.                                              ECSEXT01
  1718     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1719         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1720                                                                  ECSEXT01
  1721     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1722                                                                  ECSEXT01
  1723     12  DE-REIN                           PIC X.                 ECSEXT01
  1724                                                                  ECSEXT01
  1725     12  DE-CONTROL.                                              ECSEXT01
  1726         16  DE-CNTRL1.                                           ECSEXT01
  1727             20  DE-CARRIER                PIC X.                 ECSEXT01
  1728             20  DE-GROUPING.                                     ECSEXT01
  1729                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1730                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1731             20  DE-STATE                  PIC XX.                ECSEXT01
  1732             20  DE-ACCOUNT.                                      ECSEXT01
  1733                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1734                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1735         16  DE-CNTRL2.                                           ECSEXT01
  1736             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1737             20  DE-CERT.                                         ECSEXT01
  1738                 24 DE-CERT-NO.                                   ECSEXT01
  1739                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1740                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* ECS158.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1741                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1742                                                                  ECSEXT01
  1743     12  DE-TRANS                          PIC X.                 ECSEXT01
  1744         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1745         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1746         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1747         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1748         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1749         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1750         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1751         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1752         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1753         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1754                                                                  ECSEXT01
  1755     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1756     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1757                                                                  ECSEXT01
  1758     12  DE-NAME.                                                 ECSEXT01
  1759         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1760         16  DE-FNAME.                                            ECSEXT01
  1761             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1762             20  FILLER                    PIC X(9).              ECSEXT01
  1763         16  DE-INIT                       PIC X.                 ECSEXT01
  1764     12  DE-AGE                            PIC 99.                ECSEXT01
  1765     12  DE-SEX                            PIC X.                 ECSEXT01
  1766     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1767                                                                  ECSEXT01
  1768     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1769     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1770     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1771     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1772     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1773     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1774     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1775     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1776     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1777                                                                  ECSEXT01
  1778     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1779     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1780     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1781     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1782                                                                  ECSEXT01
  1783     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1784     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1785     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1786     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1787     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1788                                                                  ECSEXT01
  1789     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1790     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1791     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1792     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1793                                                                  ECSEXT01
  1794     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1795     12  DE-ADDL-CLP REDEFINES DE-LIVES
  1796                                           PIC S9(5)V99   COMP-3.
  1797     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1798     12  FILLER REDEFINES DE-NUM-BILLED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* ECS158.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1799         16  DE-CLP-STATE                  PIC XX.
  1800         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1801     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1802     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1803                                                                  ECSEXT01
  1804     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1805     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1806     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1807     12  DE-IG                             PIC X.                 ECSEXT01
  1808     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1809*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1810     12  DE-MEMBER-NO.                                            ECSEXT01
  1811         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1812         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1813         16  FILLER                        PIC X(03).             ECSEXT01
  1814     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1815                                                                  ECSEXT01
  1816     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1817         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1818                                                                  ECSEXT01
  1819     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1820     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1821                                                                  ECSEXT01
  1822     12  DE-REI-AREA.                                             ECSEXT01
  1823         16  DE-REI-COMP.                                         ECSEXT01
  1824             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1825             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1826         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1827         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1828         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1829         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1830         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1831         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1832         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1833                                                                  ECSEXT01
  1834     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1835     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1836         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1837         16  F                             PIC X.
  1838*    12  FILLER                            PIC X(5).              ECSEXT01
  1839                                                                  ECSEXT01
  1840     12  DE-BILLED-AREA.                                          ECSEXT01
  1841         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1842             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1843                                                                  ECSEXT01
  1844         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1845             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1846             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1847             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1848             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1849             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1850             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1851                                                                  ECSEXT01
  1852         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1853             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
  1854                                                                  ECSEXT01
  1855         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1856         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* ECS158.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1857         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1858         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1859                                                                  ECSEXT01
  1860         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1861*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1862*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1863                                                                  ECSEXT01
  1864     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1865         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1866         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1867         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1868                                                                  ECSEXT01
  1869     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1870         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1871         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1872     12  DE-CANCEL-REASON                  PIC X.
  1873                                                                  ECSEXT01
  1874     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1875     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1876                                                                  ECSEXT01
  1877     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1878         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1879             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1880         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1881             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1882                                                                  ECSEXT01
  1883     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1884         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1885                                                                  ECSEXT01
  1886     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1887     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1888         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1889         16  FILLER                        PIC X.
  1890                                                                  ECSEXT01
  1891****************************************************************  ECSEXT01
  1892**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1893****************************************************************  ECSEXT01
  1894     12  DE-COMM-LEVELS.                                          ECSEXT01
  1895         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1896             20  DE-AGT.                                          ECSEXT01
  1897                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1898                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1899             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1900             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1901             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1902                                                                  ECSEXT01
  1903     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1904****************************************************************  ECSEXT01
  1905*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1906****************************************************************  ECSEXT01
  1907     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1908     12  FILLER                            PIC X(334).            ECSEXT01
  1909     12  DE-TYPE                           PIC X.                 ECSEXT01
  1910         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1911         88  DE-AH                            VALUE '2'.          ECSEXT01
  1912         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1913         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1914         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* ECS158.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1915         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1916                                                                  ECSEXT01
  1917     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1918     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1919                                                                  ECSEXT01
  1920     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1921     12  DE-REPORTED.                                             ECSEXT01
  1922         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1923         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1924         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1925     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1926     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1927                                                                  ECSEXT01
  1928     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1929     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1930     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1931     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1932     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1933     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1934         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1935         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1936         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1937         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1938         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1939         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1940         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1941                                                                  ECSEXT01
  1942     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1943                                                                  ECSEXT01
  1944     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1945     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1946     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1947     12  FILLER                            PIC XX.                ECSEXT01
  1948     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1949                                                                  ECSEXT01
  1950     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1951     12  DE-BENEFICIARY                    PIC X(10).
  1952     12  filler redefines de-beneficiary.
  1953         16  de-birth-date                 pic 9(11)  comp-3.
  1954         16  f                             pic x(4).
  1955     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1956     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1957     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1958     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1959     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1960     12  DE-CLM-CLASS                      PIC XX.
  1961     12  DE-CLM-DEV                        PIC XXX.
  1962     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1963     12  de-xycor-cert-seq                 pic x(3).
  1964     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1965     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1966     12  DE-XYCOR-STATUS                   PIC X.
  1967     12  FILLER                            PIC X(4).              ECSEXT01
  1968                                                                  ECSEXT01
  1969     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1970                                                                  ECSEXT01
  1971****************************************************************  ECSEXT01
  1972*******               RESERVE EXTRACT                      *****  ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* ECS158.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1973****************************************************************  ECSEXT01
  1974     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1975     12  FILLER                            PIC X(334).            ECSEXT01
  1976                                                                  ECSEXT01
  1977     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1978         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1979         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1980                                                                  ECSEXT01
  1981     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1982     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1983     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1984                                                                  ECSEXT01
  1985     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1986                                                                  ECSEXT01
  1987     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1988     12  DE-RSV-REPORTED.                                         ECSEXT01
  1989         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1990         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1991         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1992     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1993                                                                  ECSEXT01
  1994     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1995     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1996     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1997                                                                  ECSEXT01
  1998     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1999     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  2000     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  2001                                                                  ECSEXT01
  2002     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  2003                                                                  ECSEXT01
  2004     12  DE-RATE-CLASS                     PIC XX.
  2005     12  DE-DEV-CODE                       PIC XXX.
  2006     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  2007     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  2008     12  FILLER                            PIC X(58).             ECSEXT01
  2009                                                                  ECSEXT01
  2010     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  2011******************************************************************ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* ECS158.cbl
  2013 01  TEXAS-REGS-WORK-AREAS.
  2014     12  TEX-FACT-1          PIC S9(7)V9(2)    COMP-3.
  2015     12  TEX-FACT-2          PIC S9(3)   COMP-3.
  2016     12  TEX-FACT-3          PIC S9(3)   COMP-3.
  2017     12  TEX-FACT-4          PIC S9(7)   COMP-3.
  2018     12  TEX-FACT-5          PIC S9(3)   COMP-3.
  2019     12  TEX-FACT-6          PIC S9(3)   COMP-3.
  2020     12  TEX-FACT-7          PIC S9(7)   COMP-3.
  2021     12  TEX-FACT-8          PIC S9V9(6) COMP-3.
  2022     12  TEX-FACT-9          PIC S9(4)V9(11)   COMP-3.
  2023
  2024 01  NET-PAY-INTERFACE.
  2025     05  NP-APR                  PIC S9(3)V9(4)    COMP-3.
  2026     05  NP-ORIG                 PIC S9(3)         COMP-3.
  2027     05  NP-REM                  PIC S9(3)         COMP-3.
  2028     05  NP-OPT                  PIC X(01).
  2029     05  NP-CAP                  PIC S9(3)         COMP-3.
  2030     05  NP-FACTOR               PIC S9(4)V9(9)    COMP-3.
  2031     05  NP-WORK1                PIC S9(6)V9(9)    COMP-3.
  2032     05  NP-WORK2                PIC S9(6)V9(9)    COMP-3.
  2033
  2034 01  METHOD-TABLE.
  2035     05  M-TABLE.
  2036         10  FILLER              PIC X(03) VALUE 'AKP'.
  2037         10  FILLER              PIC X(03) VALUE 'ALP'.
  2038         10  FILLER              PIC X(03) VALUE 'ARR'.
  2039         10  FILLER              PIC X(03) VALUE 'AZP'.
  2040         10  FILLER              PIC X(03) VALUE 'CAP'.
  2041         10  FILLER              PIC X(03) VALUE 'DEP'.
  2042         10  FILLER              PIC X(03) VALUE 'GAP'.
  2043         10  FILLER              PIC X(03) VALUE 'IDP'.
  2044         10  FILLER              PIC X(03) VALUE 'ILP'.
  2045         10  FILLER              PIC X(03) VALUE 'KSP'.
  2046         10  FILLER              PIC X(03) VALUE 'KYP'.
  2047         10  FILLER              PIC X(03) VALUE 'LAP'.
  2048         10  FILLER              PIC X(03) VALUE 'MDP'.
  2049         10  FILLER              PIC X(03) VALUE 'MIP'.
  2050         10  FILLER              PIC X(03) VALUE 'MTP'.
  2051         10  FILLER              PIC X(03) VALUE 'NMR'.
  2052         10  FILLER              PIC X(03) VALUE 'NVP'.
  2053         10  FILLER              PIC X(03) VALUE 'OHO'.
  2054         10  FILLER              PIC X(03) VALUE 'OKK'.
  2055         10  FILLER              PIC X(03) VALUE 'ORP'.
  2056         10  FILLER              PIC X(03) VALUE 'PAR'.
  2057         10  FILLER              PIC X(03) VALUE 'SCP'.
  2058         10  FILLER              PIC X(03) VALUE 'SDP'.
  2059         10  FILLER              PIC X(03) VALUE 'TNR'.
  2060         10  FILLER              PIC X(03) VALUE 'TXT'.
  2061         10  FILLER              PIC X(03) VALUE 'UTR'.
  2062         10  FILLER              PIC X(03) VALUE 'VAV'.
  2063         10  FILLER              PIC X(03) VALUE 'WAR'.
  2064         10  FILLER              PIC X(03) VALUE 'WIP'.
  2065         10  FILLER              PIC X(03) VALUE 'WVR'.
  2066         10  FILLER              PIC X(03) VALUE 'WYP'.
  2067     05  MR-TABLE REDEFINES M-TABLE  OCCURS 31 TIMES
  2068                            INDEXED BY TABLE-INDEX.
  2069         10  T-STATE             PIC X(02).
  2070         10  METHOD-CODE         PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* ECS158.cbl
  2071
  2072 01  TYPE-METHOD                 PIC X(01)     VALUE SPACES.
  2073     88  R78                           VALUE 'R'.
  2074     88  PRATA                         VALUE 'P'.
  2075     88  TEXAS-SPECIAL                 VALUE 'T'.
  2076     88  OK-SPECIAL                    VALUE 'K'.
  2077     88  MEAN                          VALUE 'M'.
  2078     88  ANTICIPATION                  VALUE 'A'.
  2079     88  OHIO-SPECIAL                  VALUE 'O'.
  2080     88  VIRGINIA-SPECIAL              VALUE 'V'.
  2081     88  1-3RD-2-3RDS                  VALUE '1'.
  2082     88  AH-EARN-NET-PAY               VALUE 'N'.
  2083
  2084 01  DEFAULT-AH-METHOD           PIC X(01)     VALUE 'R'.
  2085
  2086 01  WS-ABEND-AREA.
  2087     05  WS-ABEND-FILE-STATUS    PIC X(02).
  2088     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
  2089     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
  2090     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
  2091
  2092 01  WORK-ABEND-CODE.
  2093     12  WAC-1                   PIC X.
  2094     12  WAC-2                   PIC X.
  2095     12  WAC-3-4.
  2096         16  WAC-3               PIC X.
  2097         16  WAC-4               PIC X.
  2098
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* ECS158.cbl
* 2100                               COPY ELCCALC.
  2101******************************************************************04/15/98
  2102*                                                                *ELCCALC
  2103*                           ELCCALC.                            *    LV003
  2104*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2105*                            VMOD=2.025                          *   CL**3
  2106*                                                                *   CL**2
  2107*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  2108*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  2109*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  2110*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  2111*                                                                *   CL**2
  2112*  PASSED TO ELRTRM                                              *   CL**2
  2113*  -----------------                                             *   CL**2
  2114*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  2115*  ORIGINAL TERM                                                 *   CL**2
  2116*  BEGINNING DATE                                                *   CL**2
  2117*  ENDING DATE                                                   *   CL**2
  2118*  COMPANY I.D.                                                  *   CL**2
  2119*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  2120*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  2121*  FREE LOOK DAYS                                                *   CL**2
  2122*                                                                *   CL**2
  2123*  RETURNED FROM ELRTRM                                          *   CL**2
  2124*  ---------------------                                         *   CL**2
  2125*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  2126*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  2127*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  2128*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  2129*----------------------------------------------------------------*   CL**2
  2130*  PASSED TO ELRAMT                                              *   CL**2
  2131*  ----------------                                              *   CL**2
  2132*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  2133*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2134*  ORIGINAL AMOUNT                                               *   CL**2
  2135*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  2136*  A.P.R. - NET PAY ONLY                                         *   CL**2
  2137*  METHOD                                                            CL**2
  2138*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  2139*  COMPANY I.D.                                                  *   CL**2
  2140*  BENEFIT TYPE                                                  *   CL**2
  2141*                                                                *   CL**2
  2142*  RETURNED FROM ELRAMT                                          *   CL**2
  2143*  --------------------                                          *   CL**2
  2144*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  2145*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  2146*  REMAINING AMOUNT FACTOR                                           CL**2
  2147*----------------------------------------------------------------*   CL**2
  2148*  PASSED TO ELRESV                                              *   CL**2
  2149*  -----------------                                             *   CL**2
  2150*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  2151*  VALUATION DATE                                                *   CL**2
  2152*  PAID THRU DATE                                                *   CL**2
  2153*  BENEFIT                                                       *   CL**2
  2154*  INCURRED DATE                                                 *   CL**2
  2155*  REPORTED DATE                                                 *   CL**2
  2156*  ISSUE AGE                                                     *   CL**2
  2157*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2158*  CDT PERCENT                                                   *   CL**2
  2159*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  2160* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  2161* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  2162* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  2163*                                                                *   CL**2
  2164*  RETURNED FROM ELRESV                                          *   CL**2
  2165*  --------------------                                          *   CL**2
  2166*  CDT TABLE USED                                                *   CL**2
  2167*  CDT FACTOR USED                                               *   CL**2
  2168*  PAY TO CURRENT RESERVE                                        *   CL**2
  2169*  I.B.N.R. - A/H ONLY                                           *   CL**2
  2170*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  2171*----------------------------------------------------------------*   CL**2
  2172*  PASSED TO ELRATE                                              *   CL**2
  2173*  ----------------                                              *   CL**2
  2174*  CERT ISSUE DATE                                               *   CL**2
  2175*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2176*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2177*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  2178*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2179*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2180*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2181*  DEVIATION CODE                                                *   CL**2
  2182*  ISSUE AGE                                                     *   CL**2
  2183*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2184*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2185*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  2186*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2187*  A.P.R.                                                        *   CL**2
  2188*  METHOD                                                            CL**2
  2189*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2190*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2191*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2192*  BENEFIT CODE                                                  *   CL**2
  2193*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2194*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  2195*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  2196*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  2197*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  2198*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  2199*                                                                *   CL**2
  2200*  RETURNED FROM ELRATE                                          *   CL**2
  2201*  --------------------                                          *   CL**2
  2202*  CALCULATED PREMIUM                                            *   CL**2
  2203*  PREMIUM RATE                                                  *   CL**2
  2204*  MORTALITY CODE                                                *   CL**2
  2205*  MAX ATTAINED AGE                                              *   CL**2
  2206*  MAX AGE                                                       *   CL**2
  2207*  MAX TERM                                                      *   CL**2
  2208*  MAX MONTHLY BENEFIT                                           *   CL**2
  2209*  MAX TOTAL BENIFIT                                             *   CL**2
  2210*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  2211*----------------------------------------------------------------*   CL**2
  2212*  PASSED TO ELRFND                                              *   CL**2
  2213*  ----------------                                              *   CL**2
  2214*  CERT ISSUE DATE                                               *   CL**2
  2215*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2216*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2217*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2218*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2219*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2220*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2221*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2222*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2223*  DEVIATION CODE                                                *   CL**2
  2224*  ISSUE AGE                                                     *   CL**2
  2225*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2226*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2227*  PROCESS TYPE (CANCEL)                                         *   CL**2
  2228*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2229*  A.P.R.                                                        *   CL**2
  2230*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  2231*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  2232*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2233*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2234*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2235*  BENEFIT CODE                                                  *   CL**2
  2236*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2237*                                                                *   CL**2
  2238*  RETURNED FROM ELRFND                                          *   CL**2
  2239*  --------------------                                          *   CL**2
  2240*  CALCULATED REFUND                                             *   CL**2
  2241*----------------------------------------------------------------*   CL**2
  2242*  PASSED TO ELEARN                                              *   CL**2
  2243*  ----------------                                              *   CL**2
  2244*  CERT ISSUE DATE                                               *   CL**2
  2245*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2246*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2247*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2248*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2249*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2250*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2251*  DEVIATION CODE                                                *   CL**2
  2252*  ISSUE AGE                                                     *   CL**2
  2253*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2254*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2255*  A.P.R.                                                        *   CL**2
  2256*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  2257*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2258*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2259*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2260*  BENEFIT CODE                                                  *   CL**2
  2261*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2262*                                                                *   CL**2
  2263*  RETURNED FROM ELEARN                                          *   CL**2
  2264*  --------------------                                          *   CL**2
  2265*  INDICATED  EARNINGS                                           *   CL**2
  2266*----------------------------------------------------------------*   CL**2
  2267*                 LENGTH = 450                                   *   CL**2
  2268*                                                                *   CL**2
  2269******************************************************************   CL**2
  2270******************************************************************
  2271*                   C H A N G E   L O G
  2272*
  2273* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2274*-----------------------------------------------------------------
  2275*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2276* EFFECTIVE    NUMBER
  2277*-----------------------------------------------------------------
  2278* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2279* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2280* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2281* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2282* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2283* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2284* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2285* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2286* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2287******************************************************************
  2288                                                                     CL**2
  2289 01  CALCULATION-PASS-AREA.                                          CL**2
  2290     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  2291                                     COMP.                           CL**2
  2292                                                                     CL**2
  2293     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  2294       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  2295       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  2296                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  2297       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  2298       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  2299       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  2300       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  2301       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  2302       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  2303       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  2304       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  2305       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  2306       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  2307       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  2308       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  2309       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  2310       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  2311       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  2312       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  2313       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  2314                                                                     CL**2
  2315     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  2316       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  2317***********************  INPUT AREAS ****************************    CL**2
  2318                                                                     CL**2
  2319     12  CP-CALCULATION-AREA.                                        CL**2
  2320         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  2321         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  2322         16  CP-VALUATION-DT       PIC XX.                           CL**2
  2323         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  2324         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  2325           88  CP-AH                               VALUE 'A' 'D'     CL**2
  2326                                                   'I' 'U'.          CL**2
  2327           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  2328           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  2329         16  CP-INCURRED-DT        PIC XX.                           CL**2
  2330         16  CP-REPORTED-DT        PIC XX.                           CL**2
  2331         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2332         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  2333         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  2334                                     COMP-3.                         CL**2
  2335         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  2336                                     COMP-3.                         CL**2
  2337         16  CP-CDT-METHOD         PIC X.                            CL**2
  2338           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  2339           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  2340           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  2341         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  2342           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  2343           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  2344         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  2345                                     COMP-3.                         CL**2
  2346         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  2347                                     COMP-3.                         CL**2
  2348         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  2349                                     COMP-3.                         CL**2
  2350         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  2351                                     COMP-3.                         CL**2
  2352         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2353                                     COMP-3.                         CL**2
  2354         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  2355                                     COMP-3.                         CL**2
  2356         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  2357                                     COMP-3.                         CL**2
  2358         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  2359           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  2360           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  2361           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  2362           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  2363           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  2364           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  2365           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  2366         16  CP-EARNING-METHOD     PIC X.                            CL**2
  2367           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  2368           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  2369           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  2370           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  2371           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  2372           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  2373           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  2374           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  2375           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  2376           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  2377           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2378           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2379           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2380           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2381         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  2382           88  CP-CLAIM                            VALUE '1'.        CL**2
  2383           88  CP-CANCEL                           VALUE '2'.        CL**2
  2384           88  CP-ISSUE                            VALUE '3'.        CL**2
  2385         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  2386           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  2387           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  2388           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  2389           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  51
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2390           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  2391           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  2392           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  2393           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  2394           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  2395           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  2396           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  2397           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  2398           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  2399           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  2400           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  2401           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  2402           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  2403           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  2404                                                     'W' 'X'.        CL**2
  2405           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  2406           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  2407           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  2408           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  2409           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  2410           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  2411           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  2412           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  2413           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  2414           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  2415           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  2416           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  2417           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  2418                                                                     CL**2
  2419         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  2420                                     COMP-3.                         CL**2
  2421         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  2422         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  2423         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  2424         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  2425         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  2426           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  2427               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  2428         16  CP-R78-OPTION         PIC X.                            CL**2
  2429           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  2430           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  2431                                                                     CL**2
  2432         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  2433         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  2434         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  2435         16  CP-RATE-FILE          PIC X.                            CL**2
  2436         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  2437                                     COMP-3.                         CL**2
  2438                                                                     CL**2
  2439         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  2440         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  2441                                                                     CL**2
  2442         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  2443                                     COMP-3.
  2444         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2445                                   PIC S9(5)V99 COMP-3.
  2446         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  2447                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  52
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2448         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2449                                     COMP-3.                         CL**2
  2450         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  2451                                     COMP-3.
  2452         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2453                                  PIC S9(7)V99 COMP-3.
  2454                                                                     CL**2
  2455         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  2456         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  2457         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  2458           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  2459           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  2460           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  2461           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  2462         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  2463         16  CP-CARRIER            PIC X.                            CL**2
  2464         16  CP-REIN-FLAG          PIC X.                            CL**2
  2465         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  2466           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  2467                      '2' '3' '4' '5'.                               CL**2
  2468           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  2469           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  2470           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  2471           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  2472           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  2473           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  2474           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  2475           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2476         16  CP-SIG-SWITCH         PIC X.                            CL**2
  2477         16  CP-RATING-METHOD      PIC X.                            CL**2
  2478           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  2479           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  2480           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  2481           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  2482           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  2483           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  2484           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  2485           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  2486           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  2487         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  2488                                     COMP-3.                         CL**2
  2489         16  CP-BEN-CATEGORY       PIC X.
  2490         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2491         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2492                                   PIC S99V9(5) COMP-3.
  2493         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2494         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2495                                   PIC S99V9(5) COMP-3.
  2496         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2497         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2498         16  CP-EXPIRE-DT          PIC XX.
  2499         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2500         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2501         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2502         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2503         16  CP-DDF-SPEC-CALC      PIC X.
  2504             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2505             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  53
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2506         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2507         16  CP-CANCEL-REASON      PIC X.
  2508         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2509         16  CP-PMT-MODE           PIC X.
  2510         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2511         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2512         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2513         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2514         16  FILLER                PIC X.
  2515                                                                     CL**2
  2516***************    OUTPUT FROM ELRESV   ************************     CL**2
  2517                                                                     CL**2
  2518         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  2519                                                                     CL**2
  2520         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  2521                                     COMP-3.                         CL**2
  2522         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  2523                                     COMP-3.                         CL**2
  2524         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  2525                                     COMP-3.                         CL**2
  2526         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  2527                                     COMP-3.                         CL**2
  2528         16  FILLER                PIC X(09).                        CL**2
  2529***************    OUTPUT FROM ELRTRM   *************************    CL**2
  2530                                                                     CL**2
  2531         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  2532                                     COMP-3.                         CL**2
  2533         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  2534                                     COMP-3.                         CL**2
  2535         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  2536                                     COMP-3.                         CL**2
  2537         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  2538                                     COMP-3.                         CL**2
  2539         16  FILLER                PIC X(12).                        CL**2
  2540                                                                     CL**2
  2541***************    OUTPUT FROM ELRAMT   *************************    CL**2
  2542                                                                     CL**2
  2543         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  2544                                     COMP-3.                         CL**2
  2545         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  2546                                     COMP-3.                         CL**2
  2547         16  FILLER                PIC X(12).                        CL**2
  2548                                                                     CL**2
  2549***************    OUTPUT FROM ELRATE   *************************    CL**2
  2550                                                                     CL**2
  2551         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  2552                                     COMP-3.                         CL**2
  2553         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  2554                                     COMP-3.                         CL**2
  2555         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  2556         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  2557             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  2558         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  2559                                     COMP-3.                         CL**2
  2560         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  2561         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2562         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2563                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  54
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2564         16  FILLER                PIC X(07).                        CL**2
  2565                                                                     CL**2
  2566***************    OUTPUT FROM ELRFND   *************************    CL**2
  2567                                                                     CL**2
  2568         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  2569                                     COMP-3.                         CL**2
  2570         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  2571           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  2572           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  2573           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  2574           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  2575           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  2576           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  2577           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  2578           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  2579           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  2580           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2581           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2582           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2583           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2584           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2585         16  FILLER                PIC X(12).                        CL**2
  2586                                                                     CL**2
  2587***************    OUTPUT FROM ELEARN   *************************    CL**2
  2588                                                                     CL**2
  2589         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  2590                                     COMP-3.                         CL**2
  2591         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  2592                                     COMP-3.                         CL**2
  2593         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  2594                                     COMP-3.                         CL**2
  2595         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  2596                                     COMP-3.                         CL**2
  2597         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  2598                                     COMP-3.                         CL**2
  2599         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  2600                                     COMP-3.                         CL**2
  2601         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  2602           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  2603           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  2604           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  2605           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  2606           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  2607           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  2608           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  2609           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  2610           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  2611         16  FILLER                PIC X(12).                        CL**2
  2612                                                                     CL**2
  2613***************    OUTPUT FROM ELPMNT   *************************    CL**2
  2614                                                                     CL**2
  2615         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  2616                                     COMP-3.                         CL**2
  2617         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  2618                                     COMP-3.                         CL**2
  2619         16  FILLER                PIC X(12).                        CL**2
  2620                                                                     CL**2
  2621***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  55
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2622         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  2623                                     COMP-3.                         CL**2
  2624         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  2625                                     COMP-3.                         CL**2
  2626         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  2627                                     COMP-3.                         CL**2
  2628         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  2629                                     COMP-3.                         CL**2
  2630         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  2631                                     COMP-3.                         CL**2
  2632         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  2633                                     COMP-3.                         CL**2
  2634         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  2635             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  2636             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  2637             88  IO-ERROR                         VALUE 'E'.         CL**2
  2638                                                                     CL**2
  2639         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  2640                                                                     CL**2
  2641         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  2642                                                                     CL**2
  2643         16  CP-RESERVE-REMAINING-TERM                               CL**2
  2644                                   PIC S9(4)V9    VALUE ZERO         CL**2
  2645                                     COMP-3.                         CL**2
  2646                                                                     CL**2
  2647         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  2648                                                                     CL**2
  2649         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  2650                                     COMP-3.                         CL**2
  2651                                                                     CL**2
  2652         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  2653                                     COMP-3.                         CL**2
  2654                                                                     CL**2
  2655         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  2656                                     COMP-3.                         CL**2
  2657                                                                     CL**2
  2658         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  2659                                     COMP-3.                         CL**2
  2660                                                                     CL**2
  2661         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  2662                                     COMP-3.                         CL**2
  2663                                                                     CL**2
  2664         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  2665                                     COMP-3.                         CL**2
  2666                                                                     CL**2
  2667         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  2668                                     COMP-3.                         CL**2
  2669                                                                     CL**2
  2670         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  2671             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  2672                                                                     CL**2
  2673         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  2674                                     COMP-3.                         CL**2
  2675         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2676                                     COMP-3.
  2677         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2678         16  FILLER                PIC X(15).                        CL**2
  2679******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  56
* ECS158.cbl
  2681 01  INITIALIZED-FRONT.
  2682     12  FILLER              PIC X(35)      VALUE SPACES.
  2683     12  FILLER              PIC X(37)      VALUE SPACES.
  2684     12  FILLER              PIC X(02)      VALUE ZEROS.
  2685     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2686     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2687     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2688     12  FILLER              PIC X(26)      VALUE SPACES.
  2689     12  FILLER              PIC 9(02)      VALUE ZEROS.
  2690     12  FILLER              PIC X(12)      VALUE SPACES.
  2691     12  FILLER              PIC 9(02)      VALUE ZEROS.
  2692     12  FILLER              PIC S9(3)V9(4) VALUE +0 COMP-3.
  2693     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2694     12  FILLER              PIC X(01)      VALUE SPACES.
  2695     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2696     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2697     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2698     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2699 01  INITIALIZED-BACK.
  2700     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2701     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2702     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2703     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2704     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2705     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2706     12  FILLER              PIC S9(03)V9   VALUE +0 COMP-3.
  2707     12  FILLER              PIC S9(03)V9   VALUE +0 COMP-3.
  2708     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2709     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2710     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2711     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2712     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2713     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2714     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2715     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2716     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2717     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2718     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2719     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2720     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2721     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2722     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2723     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2724     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2725     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2726     12  FILLER              PIC S9(11)V99  VALUE +0 COMP-3.
  2727     12  FILLER              PIC S9(5)V99   VALUE +0 COMP-3.
  2728     12  FILLER              PIC S9(5)V99   VALUE +0 COMP-3.
  2729     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2730     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2731     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2732     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2733     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2734     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2735     12  FILLER              PIC X(12)      VALUE SPACES.
  2736
  2737******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  57
* ECS158.cbl
  2739 01  FILLER.
  2740     12  WS-RESERVE-WORK OCCURS 3 TIMES.
  2741         16  WS-AH-END-R78-RES      PIC S9(09)V99 COMP-3.
  2742         16  WS-AH-BEG-R78-RES      PIC S9(09)V99 COMP-3.
  2743         16  WS-AH-END-PRO-RES      PIC S9(09)V99 COMP-3.
  2744         16  WS-AH-BEG-PRO-RES      PIC S9(09)V99 COMP-3.
  2745         16  WS-AH-END-NET-RES      PIC S9(09)V99 COMP-3.
  2746         16  WS-AH-BEG-NET-RES      PIC S9(09)V99 COMP-3.
  2747         16  WS-AH-END-MEAN-RES     PIC S9(09)V99 COMP-3.
  2748         16  WS-AH-BEG-MEAN-RES     PIC S9(09)V99 COMP-3.
  2749         16  WS-AH-END-STATE-RES    PIC S9(09)V99 COMP-3.
  2750         16  WS-AH-BEG-STATE-RES    PIC S9(09)V99 COMP-3.
  2751         16  WS-LEV-LF-BEGIN-RES    PIC S9(09)V99 COMP-3.
  2752         16  WS-LEV-LF-BEGIN-ALT    PIC S9(09)V99 COMP-3.
  2753         16  WS-LEV-LF-END-RES      PIC S9(09)V99 COMP-3.
  2754         16  WS-LEV-LF-END-ALT      PIC S9(09)V99 COMP-3.
  2755         16  WS-RED-LF-BEGIN-RES    PIC S9(09)V99 COMP-3.
  2756         16  WS-RED-LF-BEGIN-ALT    PIC S9(09)V99 COMP-3.
  2757         16  WS-RED-LF-END-RES      PIC S9(09)V99 COMP-3.
  2758         16  WS-RED-LF-END-ALT      PIC S9(09)V99 COMP-3.
  2759
  2760     12  WS-RESERVE-INIT.
  2761         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2762         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2763         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2764         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2765         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2766         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2767         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2768         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2769         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2770         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2771         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2772         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2773         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2774         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2775         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2776         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2777
  2778     12  WS-REM-TERM-WORK OCCURS 3 TIMES.
  2779         16  WS-LF-BEG-REM-TRM1     PIC S9(03)V99 COMP-3.
  2780         16  WS-LF-END-REM-TRM1     PIC S9(03)V99 COMP-3.
  2781         16  WS-AH-BEG-REM-TRM1     PIC S9(03)V99 COMP-3.
  2782         16  WS-AH-END-REM-TRM1     PIC S9(03)V99 COMP-3.
  2783         16  WS-LF-LEV-MEAN-INFORCE PIC S9(11)V99 COMP-3.
  2784         16  WS-LF-RED-MEAN-INFORCE PIC S9(11)V99 COMP-3.
  2785
  2786     12  WS-REM-TERM-INIT.
  2787         16  FILLER                 PIC S9(03)V99 COMP-3 VALUE +0.
  2788         16  FILLER                 PIC S9(03)V99 COMP-3 VALUE +0.
  2789         16  FILLER                 PIC S9(03)V99 COMP-3 VALUE +0.
  2790         16  FILLER                 PIC S9(03)V99 COMP-3 VALUE +0.
  2791         16  FILLER                 PIC S9(11)V99 COMP-3 VALUE +0.
  2792         16  FILLER                 PIC S9(11)V99 COMP-3 VALUE +0.
  2793
  2794 01  FILLER.
  2795     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2796     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  58
* ECS158.cbl
  2797     12  FILLER OCCURS 2 TIMES.
  2798         16  WS-DEV           PIC X(03).
  2799         16  WS-BEN-TYPE      PIC X(02).
  2800         16  WS-TERM          PIC S9(03)  COMP-3.
  2801         16  FILLER OCCURS 2 TIMES.
  2802             20  FILLER OCCURS 3 TIMES.
  2803                 24  WS-CLAIM-AMT PIC S9(09)V99 COMP-3.
  2804                 24  WS-INC-CNT   PIC S9(03).
  2805                 24  WS-PD-CNT    PIC S9(03).
  2806
  2807     12  HOLD-LIFE-RECORD        PIC X(666)  VALUE SPACES.
  2808     12  HOLD-AH-RECORD          PIC X(666)  VALUE SPACES.
  2809     12  FROM-REIN               PIC X(01) VALUE SPACES.
  2810     12  WS-AGT-NO.
  2811         16  WS-AGT-SIX       PIC X(06)    VALUE SPACES.
  2812         16  FILLER           PIC X(04)    VALUE SPACES.
  2813
  2814 01  DATE-AREAS.
  2815     05  FIRST-PAY-DT              PIC X(02).
  2816     05  ENTRY-DT                  PIC X(02).
  2817     05  EXIT-DT                   PIC X(02).
  2818     05  EXPIRE-DT                 PIC X(02).
  2819     05  EFFECT-DT                 PIC X(02).
  2820     05  BEGIN-DT   OCCURS 3 TIMES PIC X(02).
  2821     05  END-DT     OCCURS 3 TIMES PIC X(02).
  2822     05  DT-START                  PIC X(02).
  2823     05  DT-END                    PIC X(02).
  2824     05  AH-CLM                    PIC X(02).
  2825     05  AH-CAN                    PIC X(02).
  2826     05  LF-CLM                    PIC X(02).
  2827     05  LF-CAN                    PIC X(02).
  2828     05  WS-CR-BIN-DATE            PIC XX.
  2829
  2830     05  CLM-INCUR-REIN-DATE.
  2831         10  CIRD-CCYY.
  2832             15  CIRD-CC         PIC 99.
  2833             15  CIRD-YR         PIC 99.
  2834         10  CIRD-MO             PIC 99.
  2835
  2836     05  BEGIN-DATE OCCURS 3 TIMES.
  2837         10  BEGIN-CCYY          PIC 9(04).
  2838         10  BEGIN-CCYR  REDEFINES  BEGIN-CCYY.
  2839             15  BEGIN-CC        PIC 99.
  2840             15  BEGIN-YR        PIC 99.
  2841         10  BEGIN-MO            PIC 99.
  2842         10  BEGIN-DA            PIC 99.
  2843
  2844
  2845     05  ENDING-DATE OCCURS 3 TIMES.
  2846         10  ENDING-CCYY         PIC 9(04).
  2847         10  ENDING-CCYR  REDEFINES  ENDING-CCYY.
  2848             15  ENDING-CC       PIC 99.
  2849             15  ENDING-YR       PIC 99.
  2850         10  ENDING-MO           PIC 99.
  2851         10  ENDING-DA           PIC 99.
  2852
  2853     05  ENTRY-DATE.
  2854         10  ENTRY-YR            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  59
* ECS158.cbl
  2855         10  ENTRY-MO            PIC 99.
  2856         10  ENTRY-DA            PIC 99.
  2857
  2858     05  EXIT-DATE.
  2859         10  EXIT-YR             PIC 99.
  2860         10  EXIT-MO             PIC 99.
  2861         10  EXIT-DA             PIC 99.
  2862
  2863     05  EXPIRE-DATE.
  2864         10  EXPIRE-YR           PIC 99.
  2865         10  EXPIRE-MO           PIC 99.
  2866         10  EXPIRE-DA           PIC 99.
  2867
  2868 01  REM-TRM-MISC-FIELDS.
  2869     12  BGN-DT.
  2870         16  BGN-YR              PIC 99.
  2871         16  BGN-MO              PIC 99.
  2872         16  BGN-DA              PIC 99.
  2873     12  END-DTE.
  2874         16  END-YR              PIC 99.
  2875         16  END-MO              PIC 99.
  2876         16  END-DA              PIC 99.
  2877     12  REM-TRM1                PIC S9(3)V99    COMP-3.
  2878     12  REM-TRM2                PIC S9(3)V99    COMP-3.
  2879
* 2880                                 COPY ECSRITAB.
  2881******************************************************************04/29/98
  2882*                                                                *ECSRITAB
  2883*                            ECSRITAB                            *   LV015
  2884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  2885*                            VMOD=2.015                          *ECSRITAB
  2886*                                                                *ECSRITAB
  2887*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  2888*                                                                *ECSRITAB
  2889******************************************************************ECSRITAB
  2890 01  REIN-WORK-AREAS.                                             ECSRITAB
  2891     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2892     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2893     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2894     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2895     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2896     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2897     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2898     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2899     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2900     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2901     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  2902         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  2903             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  2904             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  2905             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  2906     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2907     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2908     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2909     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2910     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2911     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2912     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  60
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2913     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2914     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2915     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2916     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2917     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2918     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2919     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2920     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2921     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2922     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2923     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2924     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2925     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2926     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2927     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2928     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2929                                                                  ECSRITAB
  2930 01  REIN-HOLD-AREAS.                                             ECSRITAB
  2931     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  2932         16  REIN-COMP               PIC X(6).                    ECSRITAB
  2933         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  2934             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  2935             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  2936         16  REIN-WORK-FLDS.                                      ECSRITAB
  2937             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  2938             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  2939             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  2940             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  2941             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  2942             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  2943             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  2944             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  2945             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  2946             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  2947             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  2948             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  2949             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  2950             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  2951             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2952             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2953             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  2954             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  2955             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  2956             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  2957             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2958             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2959             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  2960             20  REIN-REM-SW         PIC X.                       ECSRITAB
  2961             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  2962             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  2963             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  2964             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  2965     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  2966                                                                  ECSRITAB
  2967     12  RWF-FIELDS.                                              ECSRITAB
  2968         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  2969         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  2970         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  61
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2971         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  2972         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  2973         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  2974         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  2975         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  2976         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  2977         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  2978         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  2979         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  2980         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  2981         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  2982         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2983         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2984         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  2985         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  2986         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  2987         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  2988         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2989         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2990         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  2991         16  RWF-REM-SW              PIC X.                       ECSRITAB
  2992         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  2993         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  2994         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  2995         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  2996                                                                  ECSRITAB
  2997     12  WT-COMP-INFO.                                            ECSRITAB
  2998         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  2999         16  WT-LF-QC                PIC X.                       ECSRITAB
  3000         16  WT-AH-QC                PIC X.                       ECSRITAB
  3001         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3002         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3003         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3004         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3005         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
  3006         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3007         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3008         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3009         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3010         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3011         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3012         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3013         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3014         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3015         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3016         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3017         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3018         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3019         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3020         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3021         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3022         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3023         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3024         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3025         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3026         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3027         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3028         16  WT-REMAINING            PIC X.                       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  62
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3029         16  FILLER                  PIC X(21).                   ECSRITAB
  3030                                                                  ECSRITAB
  3031 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3032     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3033     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3034     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3035     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3036     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3037     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3038     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3039     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3040     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3041     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3042     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3043     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3044     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3045     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3046     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3047     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3048     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3049     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3050     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3051     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3052     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3053     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3054     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3055     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3056                                                                  ECSRITAB
  3057     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3058         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3059     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3060         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3061     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3062         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3063     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3064         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3065     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3066         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3067     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3068         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3069                                                                  ECSRITAB
  3070     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3071         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3072         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3073         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3074         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3075         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3076         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3077         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3078         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3079         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3080         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3081         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3082         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3083         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3084         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3085         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3086         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  63
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3087         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3088         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3089         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3090         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3091         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3092         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3093         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3094     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3095     12  REIN-SEARCH.                                             ECSRITAB
  3096         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3097         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3098         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3099         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3100     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3101     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3102     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3103     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3104     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3105     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3106     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3107     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3108     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3109     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3110     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3111     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3112     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3113     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3114     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3115     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3116     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3117     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3118     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3119     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3120     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3121     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
  3122     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3123     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3124     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3125                                                                  ECSRITAB
  3126 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3127* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3128     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3129         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3130         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3131         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3132         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3133         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3134         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3135         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3136         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3137         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3138                                                                  ECSRITAB
  3139 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3140     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3141         16  RC2-REIN-CO.                                         ECSRITAB
  3142             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3143             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3144         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  64
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3145         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3146         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3147         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3148         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3149         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3150                                                                  ECSRITAB
  3151 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3152     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3153         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3154         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3155     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3156                                                                  ECSRITAB
  3157 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3158     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3159         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3160         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3161         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3162 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3163     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3164         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3165                                                                  ECSRITAB
  3166 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3167******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  65
* ECS158.cbl
  3169
  3170 01  ABEND-FIELDS.
  3171     12  PGM-SUB         PIC S999 COMP  VALUE +158.
  3172     12  FIRST-TIME-SW   PIC X  VALUE 'Y'.
  3173         88  FIRST-TIME         VALUE 'Y'.
  3174
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  66
* ECS158.cbl
  3176 01  HEAD-1.
  3177     05  FILLER      PIC X(54) VALUE SPACES.
  3178     05  FILLER      PIC X(18) VALUE 'STATE CALL EXTRACT'.
  3179     05  FILLER      PIC X(47) VALUE SPACES.
  3180     05  FILLER      PIC X(06) VALUE 'ECS158'.
  3181     05  FILLER      PIC X(06) VALUE SPACES.
  3182
  3183 01  HEAD-2.
  3184     05  FILLER      PIC X(47) VALUE SPACES.
  3185     05  HD-CLIENT   PIC X(30) VALUE SPACES.
  3186     05  FILLER      PIC X(42) VALUE SPACES.
  3187     05  HD-DATE     PIC X(08) VALUE SPACES.
  3188     05  FILLER      PIC X(05) VALUE SPACES.
  3189
  3190 01  HEAD-3.
  3191     05  FILLER      PIC X(53) VALUE SPACES.
  3192     05  HD-ALF-DTE  PIC X(18) VALUE SPACES.
  3193     05  FILLER      PIC X(41) VALUE SPACES.
  3194     05  FILLER      PIC X(05) VALUE 'PAGE'.
  3195     05  HD-PAGE     PIC ZZ,ZZZ.
  3196
  3197 01  HEAD-4.
  3198     12  FILLER      PIC X(50)   VALUE
  3199        ' CARR GROUP STATE ACCOUNT    CERTIFICATE EFF-DT   '.
  3200     12  FILLER      PIC X(55)   VALUE
  3201        '   BENEFIT     PREMIUM  TERM  REM TERM    UNEARN    L/A'.
  3202     12  FILLER      PIC X(25)   VALUE
  3203        '   BENEFIT DES  PRIM PREM'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  67
* ECS158.cbl
  3205 01  DETAIL-1.
  3206     12  FILLER      PIC X(02)   VALUE SPACES.
  3207     12  D-CARR      PIC X(01)   VALUE SPACES.
  3208     12  FILLER      PIC X(03)   VALUE SPACES.
  3209     12  D-GROUP     PIC X(06)   VALUE SPACES.
  3210     12  FILLER      PIC X(02)   VALUE SPACES.
  3211     12  D-STATE     PIC X(02)   VALUE SPACES.
  3212     12  FILLER      PIC X(02)   VALUE SPACES.
  3213     12  D-ACCOUNT   PIC X(10)   VALUE SPACES.
  3214     12  FILLER      PIC X(01)   VALUE SPACES.
  3215     12  D-CERT-NO   PIC X(11)   VALUE SPACES.
  3216     12  FILLER      PIC X(01)   VALUE SPACES.
  3217     12  D-EFF-DATE  PIC X(08)   VALUE SPACES.
  3218     12  FILLER      PIC X(01)   VALUE SPACES.
  3219     12  D-BENEFIT   PIC Z(9).99 VALUE ZEROS.
  3220     12  FILLER      PIC X(01)   VALUE SPACES.
  3221     12  D-PREM      PIC Z(7).99 VALUE ZEROS.
  3222     12  FILLER      PIC X(02)   VALUE SPACES.
  3223     12  D-TERM      PIC ZZ9     VALUE ZEROS.
  3224     12  FILLER      PIC X(04)   VALUE SPACES.
  3225     12  D-REM-TERM  PIC ZZ9     VALUE ZEROS.
  3226     12  FILLER      PIC X(05)   VALUE SPACES.
  3227     12  D-UNEARN    PIC Z(7).99 VALUE ZEROS.
  3228     12  FILLER      PIC X(03)   VALUE SPACES.
  3229     12  D-L-A       PIC X(01)   VALUE SPACES.
  3230     12  FILLER      PIC X(05)   VALUE SPACES.
  3231     12  D-BEN-DESC  PIC X(10)   VALUE SPACES.
  3232     12  FILLER      PIC X(01)   VALUE SPACES.
  3233     12  D-PRI-PREM  PIC Z(7).99 VALUE ZEROS.
  3234
  3235 01  HEAD-1B.
  3236     05  FILLER      PIC X(54) VALUE SPACES.
  3237     05  FILLER      PIC X(18) VALUE 'STATE CALL EXTRACT'.
  3238     05  FILLER      PIC X(47) VALUE SPACES.
  3239     05  FILLER      PIC X(07) VALUE 'ECS158B'.
  3240     05  FILLER      PIC X(06) VALUE SPACES.
  3241
  3242 01  HEAD-2B.
  3243     05  FILLER      PIC X(47) VALUE SPACES.
  3244     05  HD2B-CLIENT PIC X(30) VALUE SPACES.
  3245     05  FILLER      PIC X(42) VALUE SPACES.
  3246     05  HD2B-DATE   PIC X(08) VALUE SPACES.
  3247     05  FILLER      PIC X(05) VALUE SPACES.
  3248
  3249 01  HEAD-3B.
  3250     05  FILLER      PIC X(53) VALUE SPACES.
  3251     05  HD3B-ALF-DTE PIC X(18) VALUE SPACES.
  3252     05  FILLER      PIC X(41) VALUE SPACES.
  3253     05  FILLER      PIC X(05) VALUE 'PAGE'.
  3254     05  HD3B-PAGE   PIC ZZ,ZZZ.
  3255
  3256 01  HEAD-4B.
  3257     12  FILLER      PIC X(50)   VALUE
  3258        ' CARR GROUP STATE ACCOUNT    CERTIFICATE EFF-DT   '.
  3259     12  FILLER      PIC X(55)   VALUE
  3260        ' LIFE AMT       AH AMT                              L/A'.
  3261     12  FILLER      PIC X(25)   VALUE
  3262        '                         '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  68
* ECS158.cbl
  3264 01  DETAIL-1B.
  3265     12  FILLER      PIC X(02)   VALUE SPACES.
  3266     12  DB-CARR     PIC X(01)   VALUE SPACES.
  3267     12  FILLER      PIC X(03)   VALUE SPACES.
  3268     12  DB-GROUP    PIC X(06)   VALUE SPACES.
  3269     12  FILLER      PIC X(02)   VALUE SPACES.
  3270     12  DB-STATE    PIC X(02)   VALUE SPACES.
  3271     12  FILLER      PIC X(02)   VALUE SPACES.
  3272     12  DB-ACCOUNT  PIC X(10)   VALUE SPACES.
  3273     12  FILLER      PIC X(01)   VALUE SPACES.
  3274     12  DB-CERT-NO  PIC X(11)   VALUE SPACES.
  3275     12  FILLER      PIC X(01)   VALUE SPACES.
  3276     12  DB-EFF-DATE PIC X(08)   VALUE SPACES.
  3277     12  FILLER      PIC X(01)   VALUE SPACES.
  3278     12  DB-CLAIML   PIC Z(9).99 VALUE ZEROS.
  3279     12  FILLER      PIC X(03)   VALUE SPACES.
  3280     12  DB-CLAIMA   PIC Z(6).99 VALUE ZEROS.
  3281     12  FILLER      PIC X(02)   VALUE SPACES.
  3282     12  FILLER      PIC X(03)   VALUE SPACES.
  3283     12  FILLER      PIC X(04)   VALUE SPACES.
  3284     12  FILLER      PIC X(03)   VALUE SPACES.
  3285     12  FILLER      PIC X(05)   VALUE SPACES.
  3286     12  FILLER      PIC X(10)   VALUE SPACES.
  3287     12  FILLER      PIC X(03)   VALUE SPACES.
  3288     12  DB-L-A      PIC X(01)   VALUE SPACES.
  3289     12  FILLER      PIC X(05)   VALUE SPACES.
  3290     12  FILLER      PIC X(10)   VALUE SPACES.
  3291     12  FILLER      PIC X(01)   VALUE SPACES.
  3292     12  FILLER      PIC X(10)   VALUE SPACES.
  3293
  3294 01  DISPLAY-LINE.
  3295     12  FILLER             PIC X(05) VALUE SPACES.
  3296     12  DISPLAY-MESS       PIC X(30) VALUE SPACES.
  3297     12  FILLER             PIC X(03) VALUE SPACES.
  3298     12  DISPLAY-COUNT      PIC ZZ,ZZZ,ZZZ VALUE ZEROS.
  3299
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  69
* ECS158.cbl
* 3301                                 COPY ELCDATE.
  3302******************************************************************06/11/98
  3303*                                                                *ELCDATE
  3304*                                                                *ELCDATE
  3305*                            ELCDATE.                            *   LV023
  3306*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  3307*                            VMOD=2.003                           ELCDATE
  3308*                                                                *ELCDATE
  3309*                                                                *ELCDATE
  3310*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  3311*                 LENGTH = 200                                   *   CL*19
  3312******************************************************************ELCDATE
  3313                                                                  ELCDATE
  3314 01  DATE-CONVERSION-DATA.                                        ELCDATE
  3315     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  3316     12  DC-OPTION-CODE                PIC X.                        CL*15
  3317         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  3318         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  3319         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  3320         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  3321         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  3322         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  3323         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  3324         88  FIND-CENTURY               VALUE '7'.                   CL*22
  3325         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  3326         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  3327         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  3328         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  3329         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  3330         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  3331         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  3332         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  3333         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  3334         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  3335         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  3336         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  3337         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  3338         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  3339         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  3340         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  3341         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  3342         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  3343         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  3344         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  3345         88  THREE-CHARACTER-BIN                                  ELCDATE
  3346                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  3347         88  GREGORIAN-TO-BIN                                        CL**2
  3348                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  3349         88  BIN-TO-GREGORIAN                                        CL**2
  3350                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  3351         88  JULIAN-TO-BINARY                                        CL**2
  3352                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  3353     12  DC-ERROR-CODE                 PIC X.                        CL*15
  3354         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  3355         88  DATE-CONVERSION-ERROR                                ELCDATE
  3356                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  3357         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  3358         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  70
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3359         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  3360         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  3361         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  3362         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  3363         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  3364         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  3365         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  3366         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  3367     12  DC-END-OF-MONTH               PIC X.                        CL*15
  3368         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  3369     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  3370         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  3371         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  3372         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  3373     12  FILLER                        PIC X.                        CL*15
  3374     12  DC-CONVERSION-DATES.                                        CL*15
  3375         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  3376         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  3377         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  3378         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  3379                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  3380             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  3381             20  SLASH1-1              PIC X.                        CL*15
  3382             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  3383             20  SLASH1-2              PIC X.                        CL*15
  3384             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  3385         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  3386         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  3387                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  3388             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  3389             20  SLASH2-1              PIC X.                        CL*15
  3390             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  3391             20  SLASH2-2              PIC X.                        CL*15
  3392             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  3393         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  3394         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  3395                     DC-GREG-DATE-1-YMD.                          ELCDATE
  3396             20  DC-YMD-YEAR           PIC 99.                       CL*15
  3397             20  DC-YMD-MONTH          PIC 99.                       CL*15
  3398             20  DC-YMD-DAY            PIC 99.                       CL*15
  3399         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  3400         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  3401                      DC-GREG-DATE-1-MDY.                         ELCDATE
  3402             20  DC-MDY-MONTH          PIC 99.                       CL*15
  3403             20  DC-MDY-DAY            PIC 99.                       CL*15
  3404             20  DC-MDY-YEAR           PIC 99.                       CL*15
  3405         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  3406             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  3407             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  3408             20  FILLER                PIC XX.                       CL*15
  3409             20  DC-ALPHA-CENTURY.                                   CL*15
  3410                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  3411             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  3412         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  3413         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  3414         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  3415         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  3416         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  71
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3417                                       PIC 9(05).                    CL*20
  3418         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  3419             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  3420             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  3421         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  3422         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  3423         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  3424     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  3425         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  3426         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  3427             20  FILLER                PIC 9(3).                     CL*15
  3428             20  HOLD-CEN-1-CCYY.                                    CL*15
  3429                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  3430                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  3431             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  3432             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  3433         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  3434             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  3435             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  3436             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  3437                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  3438                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  3439             20  FILLER                PIC 9(3).                     CL*15
  3440         16  HOLD-CENTURY-1-X.                                       CL*15
  3441             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  3442             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  3443                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  3444                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  3445             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  3446             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  3447         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  3448             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  3449             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  3450             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  3451                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  3452                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  3453             20  FILLER                PIC XXX.                      CL*23
  3454         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  3455         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  3456         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  3457         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  3458             20  DC-JULIAN-1-CCYY.                                   CL*15
  3459                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  3460                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  3461             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  3462         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  3463         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  3464             20  DC-JULIAN-2-CCYY.                                   CL*15
  3465                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  3466                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  3467             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  3468         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  3469             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  3470             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  3471             20  DC-EDITA-DAY          PIC 99.                       CL*15
  3472             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  3473             20  DC-EDITA-CCYY.                                      CL*15
  3474                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  72
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3475                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  3476         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  3477             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  3478             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  3479             20  DC-EDITB-DAY          PIC 99.                       CL*15
  3480             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  3481             20  DC-EDITB-CCYY.                                      CL*15
  3482                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  3483                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  3484         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  3485         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  3486                              DC-GREG-DATE-CYMD.                  ELCDATE
  3487             20  DC-CYMD-CEN           PIC 99.                       CL*15
  3488             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  3489             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  3490             20  DC-CYMD-DAY           PIC 99.                       CL*15
  3491         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  3492         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  3493                              DC-GREG-DATE-MDCY.                  ELCDATE
  3494             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  3495             20  DC-MDCY-DAY           PIC 99.                       CL*15
  3496             20  DC-MDCY-CEN           PIC 99.                       CL*15
  3497             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  3498    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  3499        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  3500    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  3501    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  73
* ECS158.cbl
  3503
* 3504                                 COPY ELCDTECX.
  3505******************************************************************06/05/98
  3506*                                                                *ELCDTECX
  3507*                            ELCDTECX.                           *   LV005
  3508*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3509*                            VMOD=2.015                          *ELCDTECX
  3510*                                                                *ELCDTECX
  3511*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  3512*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  3513*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  3514*                                                                *ELCDTECX
  3515******************************************************************ELCDTECX
  3516******************************************************************
  3517*                   C H A N G E   L O G
  3518*
  3519* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3520*-----------------------------------------------------------------
  3521*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3522* EFFECTIVE    NUMBER
  3523*-----------------------------------------------------------------
  3524* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  3525*                                  BENEFIT CODES FROM 300 TO 900
  3526* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  3527* 051304    2003080800002  SMVA  ADD REFUND METHOD
  3528******************************************************************
  3529 01  DATE-CARD.                                                   ELCDTECX
  3530     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  3531     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  3532     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  3533     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  3534     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  3535     12  EP-SW                       PIC  X.                      ELCDTECX
  3536         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  3537     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  3538         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  3539     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  3540     12  RUN-CENTURY.                                             ELCDTECX
  3541         16 RUN-CENTURY-N            PIC  99.                        CL**4
  3542     12  FILLER                      PIC  X.                         CL**4
  3543     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  3544     12  FILLER                      PIC  XXX.                    ELCDTECX
  3545     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  3546                                                                  ELCDTECX
  3547 01  FILLER                          PIC  X(7)                       CL**6
  3548                                          VALUE 'OPTIONS'.        ELCDTECX
  3549 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  3550     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  3551     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  3552     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  3553         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  3554         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  3555     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  3556     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  3557     12  FILLER                      PIC  X.                      ELCDTECX
  3558     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  3559     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  3560     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  74
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3561     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  3562     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  3563     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  3564     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  3565     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  3566     12  FILLER                      PIC  X.                      ELCDTECX
  3567     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  3568     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  3569     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  3570     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  3571     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  3572     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  3573     12  FILLER                      PIC  X.                      ELCDTECX
  3574     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  3575     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  3576     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  3577     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  3578     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  3579     12  DTE-R78                     PIC  X.                      ELCDTECX
  3580     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  3581     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  3582     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  3583     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  3584     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  3585     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  3586     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  3587                                     PIC  X.                      ELCDTECX
  3588         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  3589                                                 ' '.             ELCDTECX
  3590         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  3591         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  3592     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  3593         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  3594         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  3595     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  3596     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  3597                                     PIC  9.                         CL**4
  3598     12  DTE-SYSTEM.                                              ELCDTECX
  3599         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  3600         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  3601         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  3602         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  3603         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  3604         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  3605         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  3606         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  3607         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  3608         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  3609         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  3610         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  3611         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  3612         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  3613         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  3614         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  3615         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  3616         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  3617         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  3618         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  75
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3619         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  3620         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  3621         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  3622         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  3623         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  3624         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  3625     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  3626         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  3627                                     PIC  X.                      ELCDTECX
  3628     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  3629                                                                  ELCDTECX
  3630 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  3631     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  3632     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  3633     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  3634*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  3635     12  FILLER                      PIC  X.                      ELCDTECX
  3636     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  3637     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  3638     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  3639     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  3640     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  3641     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  3642     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  3643                                                                  ELCDTECX
  3644     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  3645     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  3646     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  3647     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  3648                                                                  ELCDTECX
  3649     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  3650     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  3651     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  3652     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  3653                                                                  ELCDTECX
  3654     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  3655     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  3656                                                                  ELCDTECX
  3657     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  3658     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  3659                                                                  ELCDTECX
  3660     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  3661                                                                  ELCDTECX
  3662 01  DATE-CARD-FACTORS.                                           ELCDTECX
  3663     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  3664     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  3665     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  3666     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  3667     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  3668     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  3669     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  3670                                                                  ELCDTECX
  3671 01  FILLER                          PIC  X(12)                   ELCDTECX
  3672                                          VALUE 'COMPANY NAME'.   ELCDTECX
  3673 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  3674     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  3675         16  CNT-ID                  PIC  X.                      ELCDTECX
  3676         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  76
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3677                                                                  ELCDTECX
  3678 01  FILLER                          PIC  X(11)                   ELCDTECX
  3679                                          VALUE 'STATE NAMES'.    ELCDTECX
  3680 01  STATE-NAMES.                                                 ELCDTECX
  3681     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  3682         16  STATE-SUB               PIC  XX.                     ELCDTECX
  3683         16  STATE-PIC1.                                          ELCDTECX
  3684             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  3685             20  FILLER              PIC  XXX.                    ELCDTECX
  3686             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  3687             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  3688             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  3689             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  3690                                                                  ELCDTECX
  3691 01  FILLER                          PIC  X(13)                   ELCDTECX
  3692                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  3693 01  CARRIER-NAMES.                                               ELCDTECX
  3694     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  3695         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  3696         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  3697         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  3698         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3699         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3700         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3701*        16  FILLER                  PIC  X.                      ELCDTECX
  3702         16  CARRIER-SEC-PAY         PIC  X.
  3703             88  SEC-PAY-CARRIER          VALUE 'Y'.
  3704                                                                  ELCDTECX
  3705 01  FILLER                          PIC  X(9)                       CL**6
  3706                                          VALUE 'INS TYPES'.      ELCDTECX
  3707 01  CLAS-INS-TYPES.                                              ELCDTECX
  3708*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  3709     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  3710         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  3711         16  CLAS-I-AB3.                                          ELCDTECX
  3712             20  FILLER              PIC  X.                      ELCDTECX
  3713             20  CLAS-I-AB2.                                      ELCDTECX
  3714                 24  FILLER          PIC  X.                      ELCDTECX
  3715                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  3716         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  3717             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  3718             20  FILLER              PIC  X.                         CL**4
  3719         16  CLAS-I-AB10.                                         ELCDTECX
  3720             20  FILLER              PIC  X(9).                   ELCDTECX
  3721             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  3722         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  3723         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  3724         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  3725         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  3726             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  3727         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  3728         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  3729         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  3730         16  CLAS-I-BEN-CATEGORY     PIC  X.
  3731         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  3732         16  FILLER                  PIC  X(05).
  3733                                                                  ELCDTECX
  3734 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  77
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3735                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  3736 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  3737     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  3738                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  3739         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  3740         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  3741         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  3742         16  CLAS-MORT-DESC.                                      ELCDTECX
  3743             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  3744             20  FILLER              PIC  XX.                        CL**5
  3745             20  CLAS-YEAR           PIC  X(4).                      CL**6
  3746             20  FILLER              PIC  X.                         CL**5
  3747             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  3748             20  FILLER              PIC  X.                         CL**5
  3749             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  3750             20  FILLER              PIC  X.                         CL**5
  3751             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  3752             20  FILLER              PIC  X(5).                      CL**6
  3753                                                                  ELCDTECX
  3754 01  FILLER                          PIC  X(15)                   ELCDTECX
  3755                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  3756 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  3757     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  3758         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  3759         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  3760         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  3761         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  3762         16  FILLER                  PIC  X(4).                      CL**6
  3763                                                                  ELCDTECX
  3764 01  FILLER                          PIC  X(7)                       CL**6
  3765                                     VALUE 'INDEXES'.             ELCDTECX
  3766 01  CLAS-INDEX-TBL.                                              ELCDTECX
  3767     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  3768     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  3769     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  3770     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  3771     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  3772     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  3773     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  3774     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  3775     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  3776     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  3777     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  3778     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  3779     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  3780     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  3781     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  3782     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  3783     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  3784                                                                  ELCDTECX
  3785 01  CLAS-TYPE-MISC.                                              ELCDTECX
  3786     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  3787     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  3788     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  3789     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  3790     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  3791     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  3792     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  78
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3793     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  3794     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  3795     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  3796     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  3797                                                                  ELCDTECX
  3798 01  FILLER                          PIC  X(13)                   ELCDTECX
  3799                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  3800 01  CLAS-MISC.                                                   ELCDTECX
  3801     12  DTE-FICH                    PIC  X.                      ELCDTECX
  3802         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  3803         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  3804         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  3805     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  3806     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  3807     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  3808     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  3809     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  3810     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  3811     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  3812     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  3813     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  3814     12  STATE-L                     PIC  XX.                     ELCDTECX
  3815     12  CLAS-CN                     PIC  99.                     ELCDTECX
  3816     12  CLAS-CO                     PIC  99.                     ELCDTECX
  3817     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  3818         16  DTE-F-1                 PIC  X.                      ELCDTECX
  3819         16  DTE-F-2                 PIC  X.                      ELCDTECX
  3820     12  DTE-ABEND-WORK.                                          ELCDTECX
  3821         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  3822         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  3823                                                                  ELCDTECX
  3824 01  FILLER                          PIC  X(12)                   ELCDTECX
  3825                                     VALUE 'WORKING DATE'.        ELCDTECX
  3826 01  WS-DATE-AND-TIME.                                            ELCDTECX
  3827     12  WS-ACCEPT-DATE.                                          ELCDTECX
  3828         16  WS-AD-YY                PIC  99.                     ELCDTECX
  3829         16  WS-AD-MM                PIC  99.                     ELCDTECX
  3830         16  WS-AD-DD                PIC  99.                     ELCDTECX
  3831     12  WS-CURRENT-DATE.                                         ELCDTECX
  3832         16  WS-CD-MM                PIC  99.                     ELCDTECX
  3833         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3834         16  WS-CD-DD                PIC  99.                     ELCDTECX
  3835         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3836         16  WS-CD-YY                PIC  99.                     ELCDTECX
  3837     12  WS-TIME-OF-DAY.                                          ELCDTECX
  3838         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  3839         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  3840                                                                  ELCDTECX
  3841 01  FILLER                          PIC  X(12)                   ELCDTECX
  3842                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  3843 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  3844     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  3845         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  3846         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  3847         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  3848                                                                  ELCDTECX
  3849 01  FILLER                          PIC  X(10)                   ELCDTECX
  3850                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  79
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3851 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  3852     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  3853         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  3854         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  3855                                                                  ELCDTECX
  3856 01  FILLER                          PIC  X(13)                   ELCDTECX
  3857                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  3858 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  3859     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  3860         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  3861                                                                  ELCDTECX
  3862 01  FILLER                          PIC  X(13)                   ELCDTECX
  3863                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  3864 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  3865     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  3866     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  3867     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  3868                                     PIC  X.                         CL**5
  3869     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  3870     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  3871     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  3872     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  3873     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  3874     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  3875     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  3876     12  FILLER                      PIC  X(75).                  ELCDTECX
  3877******************************************************************ELCDTECX
  3878*01  MISC-CARR-PCT-DATA.                                          00001521
  3879*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3880*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3881*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3882*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3883*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3884*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3885******************************************************************ELCDTECX
  3886
* 3887                                 COPY ELCDTEVR.
  3888***************************************************************** 04/15/98
  3889*                                                                *ELCDTEVR
  3890*                                                                *ELCDTEVR
  3891*                            ELCDTEVR.                           *   LV003
  3892*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3893*                            VMOD=2.001                          *   CL**2
  3894*                                                                *ELCDTEVR
  3895*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  3896*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  3897*                                                                *ELCDTEVR
  3898******************************************************************ELCDTEVR
  3899 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  3900     05  WS-RUN-DATE.                                             ELCDTEVR
  3901         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3902         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  3903         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  3904             15  RUN-CC              PIC  99.                     ELCDTEVR
  3905             15  RUN-YR              PIC  99.                     ELCDTEVR
  3906         10  RUN-MO                  PIC  99.                     ELCDTEVR
  3907         10  RUN-DA                  PIC  99.                     ELCDTEVR
  3908     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  80
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3909            WS-RUN-DATE              PIC 9(11).                      CL**2
  3910     05  WS-EP-DT.                                                ELCDTEVR
  3911         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3912         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  3913         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  3914             15  EP-CC               PIC  99.                     ELCDTEVR
  3915             15  EP-YR               PIC  99.                     ELCDTEVR
  3916         10  EP-MO                   PIC  99.                     ELCDTEVR
  3917         10  EP-DA                   PIC  99.                     ELCDTEVR
  3918     05  WS-EP-DT-N REDEFINES                                        CL**2
  3919            WS-EP-DT                 PIC 9(11).                      CL**2
  3920     05  WS-DTE-CONV-DT.                                             CL**4
  3921         10  FILLER                  PIC  9(03).                     CL**4
  3922         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  3923         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  3924             15  DTE-CONV-CC         PIC  99.                        CL**4
  3925             15  DTE-CONV-YR         PIC  99.                        CL**4
  3926         10  DTE-CONV-MO             PIC  99.                        CL**4
  3927         10  DTE-CONV-DA             PIC  99.                        CL**4
  3928     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  3929            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  3930 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  3931     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  3932         10  FILLER                            PIC 999.           ELCDTEVR
  3933         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  3934         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  3935             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  3936             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  3937         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  3938         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  3939     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  3940            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  3941     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  3942         10  FILLER                            PIC 999.           ELCDTEVR
  3943         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  3944         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  3945         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  3946         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  3947     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  3948            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  3949 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  3950     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  3951         10  FILLER                            PIC 999.           ELCDTEVR
  3952         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  3953         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  3954             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  3955             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  3956         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  3957         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  3958     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  3959            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  3960     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  3961         10  FILLER                            PIC 999.           ELCDTEVR
  3962         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  3963         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  3964             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  3965             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  3966         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  81
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3967         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  3968     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  3969            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  3970     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  3971         10  FILLER                            PIC 999.           ELCDTEVR
  3972         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  3973         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  3974             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  3975             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  3976         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  3977         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  3978     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  3979            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  3980 01  WS-RATE-RECORD.                                              ELCDTEVR
  3981         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  3982             10  FILLER                        PIC 999.           ELCDTEVR
  3983             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  3984             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  3985                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  3986                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  3987             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  3988             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  3989         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  3990                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  3991
* 3992                                 COPY ELCCRTVR.
  3993***************************************************************** 04/24/98
  3994*                                                                *ELCCRTVR
  3995*                                                                *ELCCRTVR
  3996*                            ELCCRTVR                            *   LV003
  3997*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3998*                            VMOD=2.001                          *ELCCRTVR
  3999*                                                                *ELCCRTVR
  4000*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  4001*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  4002*                                                                *ELCCRTVR
  4003******************************************************************ELCCRTVR
  4004                                                                  ELCCRTVR
  4005 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  4006     05  WS-CR-DT.                                                ELCCRTVR
  4007         10  FILLER                PIC 999.                       ELCCRTVR
  4008         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  4009         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  4010             15  CR-CC             PIC 99.                        ELCCRTVR
  4011             15  CR-YR             PIC 99.                        ELCCRTVR
  4012         10  CR-MO                 PIC 99.                        ELCCRTVR
  4013         10  CR-DA                 PIC 99.                        ELCCRTVR
  4014     05  WS-CR-DT-N REDEFINES                                        CL**2
  4015            WS-CR-DT               PIC 9(11).                        CL**2
  4016     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  4017         10  FILLER                    PIC 999.                   ELCCRTVR
  4018         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  4019         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  4020             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  4021             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  4022         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  4023         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  4024     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  82
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  4025            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  4026     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  4027         10  FILLER                    PIC 999.                   ELCCRTVR
  4028         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  4029         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  4030             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  4031             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  4032         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  4033         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  4034     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  4035            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  4036     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  4037         10  FILLER                    PIC 999.                   ELCCRTVR
  4038         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  4039         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  4040             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  4041             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  4042         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  4043         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  4044     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  4045            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  4046     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  4047         10  FILLER                    PIC 999.                   ELCCRTVR
  4048         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  4049         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  4050             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  4051             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  4052         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  4053         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  4054     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  4055            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  4056     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  4057         10  FILLER                    PIC 999.                   ELCCRTVR
  4058         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  4059         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  4060             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  4061             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  4062         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  4063         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  4064     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  4065            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  4066     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  4067         10  FILLER                    PIC 999.                   ELCCRTVR
  4068         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  4069         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  4070             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  4071             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  4072         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  4073         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  4074     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  4075            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  4076     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  4077         10  FILLER                    PIC 999.                   ELCCRTVR
  4078         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  4079         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  4080             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  4081             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  4082         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  83
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  4083         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  4084     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  4085            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  4086     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  4087         10  FILLER                    PIC 999.                   ELCCRTVR
  4088         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  4089         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  4090             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  4091             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  4092         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  4093         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  4094     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  4095            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  4096     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  4097         10  FILLER                    PIC 999.                   ELCCRTVR
  4098         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  4099         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  4100             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  4101             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  4102         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  4103         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  4104     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  4105          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  4106     05  WS-CR-DTH-DT.                                            ELCCRTVR
  4107         10  FILLER                    PIC 999.                   ELCCRTVR
  4108         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  4109         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  4110             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  4111             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  4112         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  4113         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  4114     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  4115            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  4116     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  4117         10  FILLER                    PIC 999.                   ELCCRTVR
  4118         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  4119         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  4120             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  4121             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  4122         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  4123         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  4124     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  4125            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  4126     05  WS-CR-DIS-DT.                                            ELCCRTVR
  4127         10  FILLER                    PIC 999.                   ELCCRTVR
  4128         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  4129         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  4130             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  4131             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  4132         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  4133         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  4134     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  4135            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  4136     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  4137         10  FILLER                    PIC 999.                   ELCCRTVR
  4138         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  4139         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  4140             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  84
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  4141             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  4142         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  4143         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  4144     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  4145            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  4146     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  4147         10  FILLER                    PIC 999.                   ELCCRTVR
  4148         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  4149         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  4150             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  4151             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  4152         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  4153         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  4154     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  4155            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  4156     05  COPY-NDX                      PIC 9.                        CL**6
  4157     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  4158         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  4159             15  FILLER                PIC 999.                   ELCCRTVR
  4160             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  4161             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  4162                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  4163                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  4164             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  4165             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  4166         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  4167                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  4168
* 4169                                 COPY ELCEXTVR.
  4170******************************************************************04/15/98
  4171*                                                                *ELCEXTVR
  4172*                                                                *ELCEXTVR
  4173*                             ELCEXTVR                           *   LV002
  4174*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4175*                            VMOD=2.001                          *ELCEXTVR
  4176*                                                                *ELCEXTVR
  4177*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  4178*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  4179*                                                                *ELCEXTVR
  4180******************************************************************ELCEXTVR
  4181 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  4182     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  4183         10  FILLER              PIC 999.                         ELCEXTVR
  4184         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  4185         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  4186             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  4187             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  4188         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  4189         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  4190     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  4191            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  4192 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  4193     05  WS-DE-EFF.                                               ELCEXTVR
  4194         10  FILLER              PIC 999.                         ELCEXTVR
  4195         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  4196         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  4197             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  4198             15  DE-EF-YR        PIC 99.                          ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  85
* ECS158.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  4199         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  4200         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  4201     05  WS-DE-EFF-N REDEFINES                                       CL**2
  4202            WS-DE-EFF            PIC 9(11).                          CL**2
  4203     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  4204         10  FILLER              PIC 999.                         ELCEXTVR
  4205         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  4206         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  4207             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  4208             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  4209         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  4210         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  4211     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  4212            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  4213     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  4214         10  FILLER                 PIC 999.                      ELCEXTVR
  4215         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  4216         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  4217             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  4218             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  4219         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  4220         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  4221     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  4222            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  4223     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  4224         10  FILLER                 PIC 999.                      ELCEXTVR
  4225         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  4226         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
  4227             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  4228             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  4229         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  4230         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  4231     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  4232            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  4233     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  4234         10  FILLER                 PIC 999.                      ELCEXTVR
  4235         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  4236         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  4237             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  4238             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  4239         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  4240         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  4241     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  4242            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  4243     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  4244         10  FILLER                 PIC 999.                      ELCEXTVR
  4245         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  4246         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  4247             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  4248             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  4249         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  4250         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  4251     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  4252            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  4253     05  WS-DE-PROC-DT.                                           ELCEXTVR
  4254         10  FILLER                 PIC 999.                      ELCEXTVR
  4255         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  4256         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  86
* ECS158.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  4257             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  4258             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  4259         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  4260         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  4261     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  4262            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  4263     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  4264         10  FILLER                 PIC 999.                         CL**5
  4265         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  4266         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  4267             15  DE-CP-CC           PIC 99.                          CL**5
  4268             15  DE-CP-YR           PIC 99.                          CL**5
  4269         10  DE-CP-MO               PIC 99.                          CL**5
  4270         10  DE-CP-DA               PIC 99.                          CL**5
  4271     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  4272            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  4273     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  4274         10  FILLER                 PIC 999.                         CL**5
  4275         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  4276         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  4277             15  DE-RP-CC           PIC 99.                          CL**5
  4278             15  DE-RP-YR           PIC 99.                          CL**5
  4279         10  DE-RP-MO                      PIC 99.                   CL**5
  4280         10  DE-RP-DA                      PIC 99.                   CL**5
  4281     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  4282            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  4283     05  WS-DE-INCUR.                                             ELCEXTVR
  4284         10  FILLER                 PIC 999.                      ELCEXTVR
  4285         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  4286         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  4287             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  4288             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  4289         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  4290         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  4291     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  4292            WS-DE-INCUR             PIC 9(11).                       CL**2
  4293     05  WS-DE-PAY.                                               ELCEXTVR
  4294         10  FILLER                 PIC 999.                      ELCEXTVR
  4295         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  4296         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  4297             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  4298             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  4299         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  4300         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  4301     05  WS-DE-PAY-N REDEFINES                                       CL**2
  4302            WS-DE-PAY               PIC 9(11).                       CL**2
  4303     05  WS-DE-PAID-TO.                                           ELCEXTVR
  4304         10  FILLER                 PIC 999.                      ELCEXTVR
  4305         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  4306         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  4307             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  4308             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  4309         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  4310         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  4311     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  4312            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  4313     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  4314         10 FILLER                  PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  87
* ECS158.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  4315         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  4316         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  4317            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  4318            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  4319         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  4320         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  4321     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  4322            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  4323     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  4324         10 FILLER                  PIC 999.                      ELCEXTVR
  4325         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  4326         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  4327            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  4328            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  4329         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  4330         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  4331     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  4332            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  4333     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  4334         10  FILLER                 PIC 999.                      ELCEXTVR
  4335         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  4336         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  4337             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  4338             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  4339         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  4340         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  4341     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  4342            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
  4343     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  4344         10  FILLER                 PIC 999.                      ELCEXTVR
  4345         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  4346         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  4347             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  4348             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  4349         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  4350         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  4351     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  4352            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  4353     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  4354         10  FILLER                        PIC 999.               ELCEXTVR
  4355         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  4356         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  4357                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  4358             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  4359             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  4360         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  4361         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  4362     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  4363            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  4364     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  4365         10  FILLER                        PIC 999.               ELCEXTVR
  4366         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  4367         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  4368                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  4369             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  4370             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  4371         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  4372         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  88
* ECS158.cbl
  4373     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  4374            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  4375                                                                     CL**5
  4376
* 4377                                 COPY ELCACCTV.
  4378******************************************************************04/14/98
  4379*                                                                *ELCACCTV
  4380*                            ELCACCTV                            *   LV002
  4381*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4382*                            VMOD=2.001                          *ELCACCTV
  4383*                                                                *ELCACCTV
  4384*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  4385*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  4386*                                                                *ELCACCTV
  4387*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  4388*                                                                *ELCACCTV
  4389******************************************************************ELCACCTV
  4390                                                                  ELCACCTV
  4391 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  4392                                                                  ELCACCTV
  4393     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  4394         10  FILLER            PIC 999.                           ELCACCTV
  4395         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  4396         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  4397             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  4398             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  4399         10  AM-EXP-MO         PIC 99.                               CL**5
  4400         10  AM-EXP-DA         PIC 99.                               CL**5
  4401     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  4402            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  4403     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  4404         10  FILLER                    PIC 999.                   ELCACCTV
  4405         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  4406         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  4407             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  4408             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  4409         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  4410         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  4411     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  4412            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  4413     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  4414         10  FILLER                    PIC 999.                   ELCACCTV
  4415         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  4416         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  4417             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  4418             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  4419         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  4420         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  4421     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  4422            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  4423     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  4424         10 FILLER                     PIC 999.                   ELCACCTV
  4425         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  4426         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  4427            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  4428            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  4429         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  4430         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  89
* ECS158.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  4431     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  4432            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  4433     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  4434         10 FILLER                     PIC 999.                   ELCACCTV
  4435         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  4436         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  4437            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  4438            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  4439         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  4440         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  4441     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  4442            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  4443     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  4444         10  FILLER                    PIC 999.                   ELCACCTV
  4445         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  4446         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  4447             15  AM-AN-CC              PIC 99.                    ELCACCTV
  4448             15  AM-AN-YR              PIC 99.                    ELCACCTV
  4449         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  4450         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  4451     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  4452            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  4453     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  4454         10  FILLER                    PIC 999.                   ELCACCTV
  4455         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  4456         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  4457             15  AM-HI-CC              PIC 99.                    ELCACCTV
  4458             15  AM-HI-YR              PIC 99.                    ELCACCTV
  4459         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  4460         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  4461     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  4462            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  4463     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  4464         10  FILLER                    PIC 999.                   ELCACCTV
  4465         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  4466         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  4467             15  AM-LO-CC              PIC 99.                    ELCACCTV
  4468             15  AM-LO-YR              PIC 99.                    ELCACCTV
  4469         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  4470         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  4471     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  4472            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  4473     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  4474         10  FILLER                    PIC 999.                   ELCACCTV
  4475         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  4476         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  4477             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  4478             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  4479         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  4480         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  4481     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  4482            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
  4483
* 4484                                 COPY ELCPSEVR.
  4485******************************************************************04/16/98
  4486*                                                                *ELCPSEVR
  4487*                                                                *ELCPSEVR
  4488*                            ELCPSEVR                            *   LV003
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  90
* ECS158.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  4489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4490*                            VMOD=2.001                          *ELCPSEVR
  4491*                                                                *ELCPSEVR
  4492*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  4493*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  4494*                                                                *ELCPSEVR
  4495******************************************************************ELCPSEVR
  4496                                                                  ELCPSEVR
  4497 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  4498     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  4499         10  FILLER               PIC 999.                        ELCPSEVR
  4500         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  4501         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  4502             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  4503             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  4504         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  4505         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  4506     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  4507            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  4508     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  4509         10  FILLER              PIC 999.                         ELCPSEVR
  4510         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  4511         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  4512             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  4513             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  4514         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  4515         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  4516     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  4517            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  4518 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  4519     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  4520                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  4521         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  4522             15  FILLER              PIC 999.                     ELCPSEVR
  4523             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  4524             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  4525                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  4526                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  4527             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  4528             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  4529         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  4530                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  4531         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  4532             15  FILLER              PIC 999.                     ELCPSEVR
  4533             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  4534             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  4535                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  4536                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  4537             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  4538             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  4539         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  4540                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  4541         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  4542             15  FILLER              PIC 999.                     ELCPSEVR
  4543             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  4544             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  4545                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  4546                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  91
* ECS158.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  4547             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  4548             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  4549         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  4550                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  4551     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  4552         10  FILLER              PIC 999.                         ELCPSEVR
  4553         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  4554         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  4555             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  4556             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  4557         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  4558         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  4559     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  4560            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  92
* ECS158.cbl
  4562 PROCEDURE DIVISION.
  4563
  4564 0001-DT-CRD-READ SECTION.
* 4565                                 COPY ELCDTERX.
  4566******************************************************************04/15/98
  4567*                                                                *ELCDTERX
  4568*                                                                *ELCDTERX
  4569*                            ELCDTERX.                           *   LV002
  4570*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4571*                            VMOD=2.007                          *ELCDTERX
  4572*                                                                *ELCDTERX
  4573*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  4574*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  4575*      = ELCDTEFD)                                               *ELCDTERX
  4576*                                                                *ELCDTERX
  4577******************************************************************ELCDTERX
  4578                                                                  ELCDTERX
  4579     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  4580                                                                  ELCDTERX
  4581     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  4582     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  4583     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  4584                                                                  ELCDTERX
  4585     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  4586                                                                  ELCDTERX
  4587******************************************************************ELCDTERX
  4588*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  4589*          WARNING MESSAGES.                                      ELCDTERX
  4590******************************************************************ELCDTERX
  4591     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  4592         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  4593                                                                  ELCDTERX
  4594     OPEN INPUT DISK-DATE.                                        ELCDTERX
  4595                                                                  ELCDTERX
  4596     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  4597                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  4598                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  4599                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  4600                   CLAX-ID           CLAS-MISC                    ELCDTERX
  4601                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  4602                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  4603                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  4604                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  4605                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  4606                                                                  ELCDTERX
  4607     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  4608                                                                  ELCDTERX
  4609     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  4610                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  4611                                                                  ELCDTERX
  4612     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  4613     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  4614     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  4615     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  4616                                                                  ELCDTERX
  4617     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  4618         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  4619     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  93
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4620         ADD +1                 TO CLAS-CN.                       ELCDTERX
  4621                                                                  ELCDTERX
  4622     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  4623         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  4624     ELSE                                                         ELCDTERX
  4625         ADD +1                 TO CLAS-CO.                       ELCDTERX
  4626                                                                  ELCDTERX
  4627 0005-READ--CARD.                                                 ELCDTERX
  4628     READ DISK-DATE                                               ELCDTERX
  4629         AT END CLOSE DISK-DATE                                   ELCDTERX
  4630             GO TO 0060-READ--TEST.                               ELCDTERX
  4631                                                                  ELCDTERX
  4632     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  4633                                                                  ELCDTERX
  4634     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  4635         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  4636         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  4637         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  4638         GO TO 0005-READ--CARD.                                   ELCDTERX
  4639                                                                  ELCDTERX
  4640     IF DD-ID = 'CLAD'                                            ELCDTERX
  4641         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  4642         GO TO 0005-READ--CARD.                                   ELCDTERX
  4643                                                                  ELCDTERX
  4644     IF DD-ID = 'CLAX'                                            ELCDTERX
  4645         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  4646         GO TO 0005-READ--CARD.                                   ELCDTERX
  4647                                                                  ELCDTERX
  4648     IF DD-ID = 'CLAF'                                            ELCDTERX
  4649         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  4650         GO TO 0005-READ--CARD.                                   ELCDTERX
  4651                                                                  ELCDTERX
  4652     IF DD-ID = 'CLAC'                                            ELCDTERX
  4653         GO TO 0010-READ--CLAC.                                   ELCDTERX
  4654                                                                  ELCDTERX
  4655     IF DD-ID = 'CARR'                                            ELCDTERX
  4656         GO TO 0015-READ--CARR.                                   ELCDTERX
  4657                                                                  ELCDTERX
  4658     IF DD-ID = 'STAT'                                            ELCDTERX
  4659         GO TO 0020-READ--STAT.                                   ELCDTERX
  4660                                                                  ELCDTERX
  4661     IF DD-ID = 'BUSC'                                            ELCDTERX
  4662         GO TO 0025-READ--BUSC.                                   ELCDTERX
  4663                                                                  ELCDTERX
  4664     IF DD-ID = 'MORT'                                            ELCDTERX
  4665         GO TO 0030-READ--MORT.                                   ELCDTERX
  4666                                                                  ELCDTERX
  4667     IF DD-ID = 'CLAI'                                            ELCDTERX
  4668         GO TO 0040-READ--CLAI.                                   ELCDTERX
  4669                                                                  ELCDTERX
  4670     IF DD-ID = 'COLC'                                            ELCDTERX
  4671         GO TO 0065-READ--COLC.                                   ELCDTERX
  4672                                                                  ELCDTERX
  4673     IF DD-IDX NUMERIC AND                                        ELCDTERX
  4674        DD-IDA = 'CL'                                             ELCDTERX
  4675         GO TO 0035-READ--CLXX.                                   ELCDTERX
  4676                                                                  ELCDTERX
  4677     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  94
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4678        DD-IDA = 'PO'                                             ELCDTERX
  4679         GO TO 0050-READ--POXX.                                   ELCDTERX
  4680                                                                  ELCDTERX
  4681     IF DD-ID = 'OPCA'                                            ELCDTERX
  4682         GO TO 0070-READ--OPCA.                                   ELCDTERX
  4683                                                                  ELCDTERX
  4684     IF DD-ID = 'OPST'                                            ELCDTERX
  4685         GO TO 0072-READ--OPST.                                   ELCDTERX
  4686                                                                  ELCDTERX
  4687     IF DD-ID = 'OPBS'                                            ELCDTERX
  4688         GO TO 0074-READ--OPBS.                                   ELCDTERX
  4689                                                                  ELCDTERX
  4690     IF DD-ID = 'OPMS'                                            ELCDTERX
  4691         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  4692                                                                  ELCDTERX
  4693     GO TO 0005-READ--CARD.                                       ELCDTERX
  4694                                                                  ELCDTERX
  4695 0010-READ--CLAC.                                                 ELCDTERX
  4696     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4697     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4698     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4699     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4700     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4701     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4702     GO TO 0005-READ--CARD.                                       ELCDTERX
  4703                                                                  ELCDTERX
  4704 0015-READ--CARR.                                                 ELCDTERX
  4705     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4706     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4707        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  4708        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4709        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  4710        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4711        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4712        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4713        MOVE DD-CARR1-SECPAY-SW
  4714                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4715     END-IF
  4716                                                                  ELCDTERX
  4717     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4718     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4719        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  4720        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4721        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  4722        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4723        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4724        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4725        MOVE DD-CARR2-SECPAY-SW
  4726                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4727     END-IF
  4728                                                                  ELCDTERX
  4729                                                                  ELCDTERX
  4730     GO TO 0005-READ--CARD.                                       ELCDTERX
  4731                                                                  ELCDTERX
  4732 0020-READ--STAT.                                                 ELCDTERX
  4733     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4734     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4735        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  95
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4736         GO TO 0005-READ--CARD.                                   ELCDTERX
  4737                                                                  ELCDTERX
  4738     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  4739     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  4740     GO TO 0020-READ--STAT.                                       ELCDTERX
  4741                                                                  ELCDTERX
  4742 0025-READ--BUSC.                                                 ELCDTERX
  4743     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4744     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4745        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  4746         GO TO 0005-READ--CARD.                                   ELCDTERX
  4747                                                                  ELCDTERX
  4748     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  4749     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  4750     GO TO 0025-READ--BUSC.                                       ELCDTERX
  4751                                                                  ELCDTERX
  4752 0030-READ--MORT.                                                 ELCDTERX
  4753     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4754     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4755        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  4756         GO TO 0005-READ--CARD.                                   ELCDTERX
  4757                                                                  ELCDTERX
  4758     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  4759     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  4760     GO TO 0030-READ--MORT.                                       ELCDTERX
  4761                                                                  ELCDTERX
  4762 0035-READ--CLXX.                                                 ELCDTERX
  4763     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  4764          GO TO 0005-READ--CARD.                                  ELCDTERX
  4765                                                                  ELCDTERX
  4766     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  4767         DISPLAY '***********************************************'ELCDTERX
  4768         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  4769         DISPLAY '***********************************************'ELCDTERX
  4770         GO TO 0055-READ--STOP.                                   ELCDTERX
  4771                                                                  ELCDTERX
  4772     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  4773        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  4774         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  4775                                                                  ELCDTERX
  4776     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  4777        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  4778         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  4779                                                                  ELCDTERX
  4780*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  4781     GO TO 0005-READ--CARD.                                       ELCDTERX
  4782                                                                  ELCDTERX
  4783 0040-READ--CLAI.                                                 ELCDTERX
  4784     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4785     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4786        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  4787         GO TO 0005-READ--CARD.                                   ELCDTERX
  4788                                                                  ELCDTERX
  4789     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  4790     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  4791     GO TO 0040-READ--CLAI.                                       ELCDTERX
  4792                                                                  ELCDTERX
  4793 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  96
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4794     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  4795     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  4796                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  4797     PERFORM ABEND-PGM.                                           ELCDTERX
  4798                                                                  ELCDTERX
  4799 0050-READ--POXX.                                                 ELCDTERX
  4800     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  4801         GO TO 0005-READ--CARD.                                   ELCDTERX
  4802                                                                  ELCDTERX
  4803     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  4804         DISPLAY '***********************************************'ELCDTERX
  4805         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  4806         DISPLAY '***********************************************'ELCDTERX
  4807         GO TO 0055-READ--STOP.                                   ELCDTERX
  4808                                                                  ELCDTERX
  4809     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  4810     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  4811     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  4812     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  4813                                                                  ELCDTERX
  4814     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  4815         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  4816     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  4817         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  4818                                                                  ELCDTERX
  4819     GO TO 0005-READ--CARD.                                       ELCDTERX
  4820                                                                  ELCDTERX
  4821 0055-READ--STOP.                                                 ELCDTERX
  4822     GOBACK.                                                      ELCDTERX
  4823                                                                  ELCDTERX
  4824 0060-READ--TEST.                                                 ELCDTERX
  4825     IF DATX-COD        = SPACE  OR                               ELCDTERX
  4826        CLAX-ID         = SPACE  OR                               ELCDTERX
  4827        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  4828         GO TO 0045-READ--DUMP.                                   ELCDTERX
  4829                                                                  ELCDTERX
  4830     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  4831     GO TO 0079-READ--EXIT.                                       ELCDTERX
  4832                                                                  ELCDTERX
  4833 0065-READ--COLC.                                                 ELCDTERX
  4834     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  4835     GO TO 0005-READ--CARD.                                       ELCDTERX
  4836                                                                  ELCDTERX
  4837 0070-READ--OPCA.                                                 ELCDTERX
  4838                                                                  ELCDTERX
  4839     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4840                                                                  ELCDTERX
  4841     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  4842             OR                                                   ELCDTERX
  4843         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  4844         GO TO 0005-READ--CARD.                                   ELCDTERX
  4845                                                                  ELCDTERX
  4846     ADD 1                       TO INDEXCA.                      ELCDTERX
  4847     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  4848                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  4849     GO TO 0070-READ--OPCA.                                       ELCDTERX
  4850                                                                  ELCDTERX
  4851 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  97
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4852                                                                  ELCDTERX
  4853     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4854                                                                  ELCDTERX
  4855     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  4856             OR                                                   ELCDTERX
  4857         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4858         GO TO 0005-READ--CARD.                                   ELCDTERX
  4859                                                                  ELCDTERX
  4860     ADD 1                       TO INDEXST.                      ELCDTERX
  4861     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  4862                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  4863     GO TO 0072-READ--OPST.                                       ELCDTERX
  4864                                                                  ELCDTERX
  4865 0074-READ--OPBS.                                                 ELCDTERX
  4866                                                                  ELCDTERX
  4867     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4868                                                                  ELCDTERX
  4869     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  4870             OR                                                   ELCDTERX
  4871         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4872         GO TO 0005-READ--CARD.                                   ELCDTERX
  4873                                                                  ELCDTERX
  4874     ADD 1                       TO INDEXBS.                      ELCDTERX
  4875     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  4876     GO TO 0074-READ--OPBS.                                       ELCDTERX
  4877                                                                  ELCDTERX
  4878 0079-READ--EXIT.                                                 ELCDTERX
  4879*    EXIT.                                                        ELCDTERX
  4880******************************************************************ELCDTERX
  4881
  4882     IF DEBUG-IS-ON
  4883         MOVE '3'                TO DTE-PGM-OPT.
  4884
  4885     IF EP-DT = RUN-DATE
  4886        MOVE ALPH-DATE           TO HD-ALF-DTE
  4887     ELSE
  4888        MOVE EP-DT               TO DC-GREG-DATE-CYMD
  4889        MOVE 'L'                 TO DC-OPTION-CODE
  4890        PERFORM 6150-DATE-CONVERSION-ROUTINE
  4891        IF NO-CONVERSION-ERROR
  4892           MOVE DC-GREG-DATE-1-ALPHA TO HD-ALF-DTE
  4893        ELSE
  4894           MOVE 'ALPHA-DATE ERROR'   TO  WS-ABEND-MESSAGE
  4895           MOVE DC-ERROR-CODE        TO  WS-ABEND-FILE-STATUS
  4896           GO TO ABEND-PGM.
  4897
  4898     IF EP-DT = RUN-DATE
  4899        SUBTRACT 1 FROM RUN-CCYY.
  4900
  4901     MOVE EP-DT                      TO DC-GREG-DATE-CYMD.
  4902     MOVE 'L'                        TO DC-OPTION-CODE.
  4903     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  4904     IF NO-CONVERSION-ERROR
  4905        MOVE DC-BIN-DATE-1           TO END-DT (1)
  4906     ELSE
  4907        MOVE SPACE TO DC-ERROR-CODE
  4908        MOVE LOW-VALUES              TO END-DT (1).
  4909
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  98
* ECS158.cbl
  4910     MOVE END-DT (1)                 TO DC-BIN-DATE-1.
  4911     MOVE '6'                        TO DC-OPTION-CODE.
  4912     MOVE -12                        TO DC-ELAPSED-MONTHS.
  4913     move +0                         to dc-elapsed-days
  4914     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  4915     IF NO-CONVERSION-ERROR
  4916        MOVE DC-BIN-DATE-2           TO END-DT (2)
  4917     ELSE
  4918        MOVE SPACE TO DC-ERROR-CODE
  4919        MOVE LOW-VALUES              TO END-DT (2).
  4920
  4921     MOVE END-DT (2)                 TO DC-BIN-DATE-1.
  4922     MOVE '6'                        TO DC-OPTION-CODE.
  4923     MOVE -12                        TO DC-ELAPSED-MONTHS.
  4924     move +0                         to dc-elapsed-days
  4925     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  4926     IF NO-CONVERSION-ERROR
  4927        MOVE DC-BIN-DATE-2           TO END-DT (3)
  4928     ELSE
  4929        MOVE SPACE TO DC-ERROR-CODE
  4930        MOVE LOW-VALUES              TO END-DT (3).
  4931
  4932     MOVE +0                         TO DC-ELAPSED-MONTHS.
  4933
  4934*    MOVE BIN-RUN-DATE               TO DC-BIN-DATE-1.
  4935*    MOVE '6'                        TO DC-OPTION-CODE.
  4936*    MOVE -12                        TO DC-ELAPSED-MONTHS.
  4937*    PERFORM 6150-DATE-CONVERSION-ROUTINE.
  4938*    IF NO-CONVERSION-ERROR
  4939*       MOVE DC-BIN-DATE-2           TO BEGIN-DT (1)
  4940*    ELSE
  4941*       MOVE SPACE TO DC-ERROR-CODE
  4942*       MOVE LOW-VALUES              TO BEGIN-DT (1).
  4943
  4944     IF EP-DT = RUN-DATE
  4945        MOVE BIN-RUN-DATE               TO DC-BIN-DATE-1
  4946        MOVE '6'                        TO DC-OPTION-CODE
  4947        MOVE -12                        TO DC-ELAPSED-MONTHS
  4948        move +0                         to dc-elapsed-days
  4949        PERFORM 6150-DATE-CONVERSION-ROUTINE
  4950        IF NO-CONVERSION-ERROR
  4951          MOVE DC-BIN-DATE-2           TO BEGIN-DT (1)
  4952        ELSE
  4953           MOVE SPACE TO DC-ERROR-CODE
  4954           MOVE LOW-VALUES              TO BEGIN-DT (1)
  4955        END-IF
  4956     ELSE
  4957        MOVE BIN-RUN-DATE               TO BEGIN-DT (1)
  4958     END-IF
  4959
  4960     MOVE BEGIN-DT (1)               TO DC-BIN-DATE-1.
  4961     MOVE '6'                        TO DC-OPTION-CODE.
  4962     MOVE -12                        TO DC-ELAPSED-MONTHS.
  4963     move +0                         to dc-elapsed-days
  4964     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  4965     IF NO-CONVERSION-ERROR
  4966        MOVE DC-BIN-DATE-2           TO BEGIN-DT (2)
  4967     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  99
* ECS158.cbl
  4968        MOVE SPACE TO DC-ERROR-CODE
  4969        MOVE LOW-VALUES              TO BEGIN-DT (2).
  4970
  4971     MOVE BEGIN-DT (2)               TO DC-BIN-DATE-1.
  4972     MOVE '6'                        TO DC-OPTION-CODE.
  4973     MOVE -12                        TO DC-ELAPSED-MONTHS.
  4974     move +0                         to dc-elapsed-days
  4975     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  4976     IF NO-CONVERSION-ERROR
  4977        MOVE DC-BIN-DATE-2           TO BEGIN-DT (3)
  4978     ELSE
  4979        MOVE SPACE TO DC-ERROR-CODE
  4980        MOVE LOW-VALUES              TO BEGIN-DT (3).
  4981
  4982     MOVE +0                         TO DC-ELAPSED-MONTHS.
  4983
  4984     MOVE EP-MO TO ENDING-MO (1)
  4985                   ENDING-MO (2)
  4986                   ENDING-MO (3).
  4987     MOVE EP-DA TO ENDING-DA (1)
  4988                   ENDING-DA (2)
  4989                   ENDING-DA (3).
  4990
  4991     MOVE EP-CCYY      TO ENDING-CCYY (1).
  4992     COMPUTE ENDING-CCYY (2) = (EP-CCYY - 1).
  4993     COMPUTE ENDING-CCYY (3) = (EP-CCYY - 2).
  4994
  4995     MOVE RUN-CCYY     TO BEGIN-CCYY (1).
  4996     COMPUTE BEGIN-CCYY (2) = (RUN-CCYY - 1).
  4997     COMPUTE BEGIN-CCYY (3) = (RUN-CCYY - 2).
  4998
  4999     MOVE RUN-MO TO BEGIN-MO (1)
  5000                    BEGIN-MO (2)
  5001                    BEGIN-MO (3).
  5002     MOVE RUN-DA TO BEGIN-DA (1)
  5003                    BEGIN-DA (2)
  5004                    BEGIN-DA (3).
  5005
  5006     MOVE +3 TO NUMBER-OF-PERIODS.
  5007
  5008     IF EP-SW = '1'
  5009         MOVE ZEROS TO BEGIN-DATE (3)
  5010                       ENDING-DATE (3)
  5011         MOVE 'Y'   TO WS-PROCESS-SW
  5012         MOVE +2    TO NUMBER-OF-PERIODS.
  5013
  5014     MOVE HIGH-VALUES     TO REIN-HOLD-AREAS.
  5015     MOVE SPACES          TO REIN-LEVELS-END.
  5016     DISPLAY 'BEGIN 1 ' BEGIN-DATE (1)
  5017     DISPLAY 'BEGIN 2 ' BEGIN-DATE (2)
  5018     DISPLAY 'BEGIN 3 ' BEGIN-DATE (3)
  5019     DISPLAY ' END  1 ' ENDING-DATE (1)
  5020     DISPLAY ' END  2 ' ENDING-DATE (2)
  5021     DISPLAY ' END 3  ' ENDING-DATE (3)
  5022
  5023     INITIALIZE  CALL-EXTRACT.
  5024
  5025     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 100
* ECS158.cbl
  5026
  5027     MOVE +0 TO CLAS-INDEXS.
  5028
  5029     MOVE SPACES TO STATE-IL
  5030                    STATE-TX
  5031                    STATE-NC
  5032                    STATE-GA
  5033                    STATE-UT
  5034                    STATE-IA
  5035                    STATE-NE
  5036                    STATE-NV
  5037                    STATE-OH
  5038                    STATE-OR
  5039                    STATE-WI.
  5040
  5041 0070-FIND-TX.
  5042
  5043     ADD +1 TO CLAS-INDEXS.
  5044
  5045     IF CLAS-INDEXS GREATER CLAS-MAXS
  5046        GO TO 0080-SORT-CLAIMS.
  5047
  5048     IF STATE-ABBR (CLAS-INDEXS) = 'TX'
  5049        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-TX
  5050     ELSE
  5051     IF STATE-ABBR (CLAS-INDEXS) = 'IL'
  5052        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-IL
  5053     ELSE
  5054     IF STATE-ABBR (CLAS-INDEXS) = 'NC'
  5055        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-NC
  5056     ELSE
  5057     IF STATE-ABBR (CLAS-INDEXS) = 'GA'
  5058        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-GA
  5059     ELSE
  5060     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  5061        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-UT
  5062     ELSE
  5063     IF STATE-ABBR (CLAS-INDEXS) = 'IA'
  5064        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-IA
  5065     ELSE
  5066     IF STATE-ABBR (CLAS-INDEXS) = 'NE'
  5067        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-NE
  5068     ELSE
  5069     IF STATE-ABBR (CLAS-INDEXS) = 'NV'
  5070        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-NV
  5071     ELSE
  5072     IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  5073        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-OH
  5074     ELSE
  5075     IF STATE-ABBR (CLAS-INDEXS) = 'OR'
  5076        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-OR
  5077     ELSE
  5078     IF STATE-ABBR (CLAS-INDEXS) = 'WI'
  5079        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-WI.
  5080
  5081     GO TO 0070-FIND-TX.
  5082
  5083 0080-SORT-CLAIMS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 101
* ECS158.cbl
  5084
  5085     SORT SORT-CLMS ON ASCENDING KEY SORT-CLAIM-KEY
  5086          INPUT PROCEDURE 0090-GET-ONLY-CLAIMS THRU
  5087                          0110-READ-CLAIMS-EXIT
  5088          GIVING SORTED-CLAIMS.
  5089
  5090     IF SORT-RETURN NOT = ZEROES
  5091        MOVE +0101 TO WS-RETURN-CODE
  5092        MOVE ' ERROR ON SORT ' TO WS-ABEND-MESSAGE
  5093        MOVE SPACES            TO WS-ABEND-FILE-STATUS
  5094        GO TO ABEND-PGM.
  5095
  5096     GO TO 0120-CERT-INPUTS-PROC.
  5097
  5098 0090-GET-ONLY-CLAIMS     SECTION.
  5099
  5100     OPEN  INPUT CLMS-HIST.
  5101
  5102 0100-READ-CLAIMS.
  5103
  5104     READ CLMS-HIST INTO DETAIL-EXTRACT AT END
  5105         CLOSE CLMS-HIST
  5106         GO TO 0110-READ-CLAIMS-EXIT.
  5107
  5108     ADD  1 TO WS-CLMS-DB-CNT
  5109               WS-TOT-CLMS-DB-CNT
  5110     IF WS-CLMS-DB-CNT > 10000
  5111        MOVE ZEROS TO WS-CLMS-DB-CNT
  5112        DISPLAY ' CLAIMS READ ' WS-TOT-CLMS-DB-CNT
  5113     END-IF
  5114     IF DE-REIN NOT = SPACE
  5115        GO TO 0100-READ-CLAIMS.
  5116
  5117     IF NOT DE-CLAIM
  5118        GO TO 0100-READ-CLAIMS.
  5119
* 5120     COPY ELCEXTM1.
  5121******************************************************************04/15/98
  5122*                                                                *ELCEXTM1
  5123*                                                                *ELCEXTM1
  5124*                            ELCEXTM1                            *   LV010
  5125*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
  5126*                            VMOD=2.001                          *ELCEXTM1
  5127*                                                                *ELCEXTM1
  5128*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
  5129*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
  5130*                                                                *ELCEXTM1
  5131******************************************************************ELCEXTM1
  5132                                                                  ELCEXTM1
  5133     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
  5134     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
  5135     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
  5136     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
  5137     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
  5138     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
  5139                                                                     CL**9
  5140     EVALUATE TRUE                                                   CL**5
  5141        WHEN DE-ISSUE      OR                                        CL**8
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 102
* ECS158.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
  5142             DE-RC-ISSUE   OR                                        CL**8
  5143             DE-RR-RC-ISS  OR                                        CL**8
  5144             DE-CANCEL     OR                                        CL**8
  5145             DE-RC-CANCEL  OR                                        CL**8
  5146             DE-RR-RC-CNC                                            CL**8
  5147           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
  5148                                                                     CL**9
  5149        WHEN DE-CLAIM      OR                                        CL**8
  5150             DE-RR-RC-CLM                                            CL**6
  5151           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
  5152           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
  5153           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
  5154           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
  5155           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
  5156           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
  5157                                                                     CL**9
  5158        WHEN DE-RESERVE                                              CL**9
  5159           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
  5160           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
  5161           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
  5162                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
  5163           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
  5164                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
  5165           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
  5166     END-EVALUATE.                                                   CL**9
  5167                                                                     CL**9
  5168
  5169     IF DE-CLM-PROC-DT NOT NUMERIC
  5170        MOVE DE-PAY-MO    TO DE-CP-MO
  5171        MOVE DE-PAY-DA    TO DE-CP-DA
  5172        MOVE DE-PAY-YR    TO DE-CP-YR.
  5173
  5174     MOVE DE-INCUR        TO  DC-GREG-DATE-CYMD.
  5175     MOVE 'L'             TO  DC-OPTION-CODE.
  5176     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5177     IF NO-CONVERSION-ERROR
  5178        MOVE DC-BIN-DATE-1  TO  BIN-DE-INCUR
  5179     ELSE
  5180        MOVE 'DE-INCUR CONVERSION ERROR' TO
  5181                                         WS-ABEND-MESSAGE
  5182        MOVE DC-ERROR-CODE  TO  WS-ABEND-FILE-STATUS
  5183        DISPLAY 'DE CONTROL 1 ' DE-CONTROL
  5184        MOVE LOW-VALUES     TO  BIN-DE-INCUR.
  5185*       GO TO ABEND-PGM.
  5186
  5187     MOVE DE-CLM-PROC-DT  TO  DC-GREG-DATE-CYMD.
  5188     MOVE 'L'             TO  DC-OPTION-CODE.
  5189     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5190     IF NO-CONVERSION-ERROR
  5191        MOVE DC-BIN-DATE-1  TO  BIN-DE-CLM-PROC-DT
  5192     ELSE
  5193        MOVE 'DE-CLM-PROC-DT CONVERSION ERROR' TO
  5194                                         WS-ABEND-MESSAGE
  5195        MOVE DC-ERROR-CODE  TO  WS-ABEND-FILE-STATUS
  5196        GO TO ABEND-PGM.
  5197
  5198     IF BIN-DE-CLM-PROC-DT GREATER THAN END-DT (1)
  5199        GO TO 0100-READ-CLAIMS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 103
* ECS158.cbl
  5200
  5201     IF SINGLE-PERIOD-PROCESS AND
  5202            BIN-DE-CLM-PROC-DT NOT GREATER THAN BEGIN-DT (2)
  5203             GO TO 0100-READ-CLAIMS
  5204     ELSE
  5205         IF BIN-DE-CLM-PROC-DT NOT GREATER THAN BEGIN-DT (3)
  5206             GO TO 0100-READ-CLAIMS.
  5207
  5208     MOVE DE-CONTROL            TO SORT-CLAIM-KEY.
  5209
  5210     MOVE DETAIL-EXTRACT        TO SORT-EP-EXTR.
  5211
  5212     RELEASE SORT-CLMS-REC.
  5213
  5214     GO TO 0100-READ-CLAIMS.
  5215
  5216 0110-READ-CLAIMS-EXIT.
  5217     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 104
* ECS158.cbl
  5219
  5220 0120-CERT-INPUTS-PROC SECTION.
  5221
  5222     OPEN OUTPUT XTRACT.
  5223
  5224 0140-OPEN-REST.
  5225
  5226     MOVE 'R' TO CP-RATE-FILE.
  5227     MOVE 'O' TO CP-IO-FUNCTION.
  5228     PERFORM 6130-CALL-RATING-ROUTINE THRU 6140-RATE-EXIT.
  5229     IF IO-ERROR
  5230        MOVE +0302   TO WS-RETURN-CODE
  5231        MOVE ' ERROR ON ERRATE OPEN ' TO WS-ABEND-MESSAGE
  5232        GO TO ABEND-PGM.
  5233
  5234     OPEN INPUT CERTS  ERACCTT SORTED-CLAIMS
  5235          OUTPUT PRINTX.
  5236
  5237     IF DTE-PGM-OPT = '3' OR '4'
  5238        OPEN OUTPUT PRINTC.
  5239
  5240     IF ERACCTT-FILE-STATUS NOT = '00' AND '97'
  5241        MOVE ' ERROR ON OPEN ERACCT ' TO WS-ABEND-MESSAGE
  5242        MOVE ERACCTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  5243        GO TO ABEND-PGM.
  5244
  5245 0150-READ-ACCOUNT.
  5246
  5247     READ ERACCTT  NEXT RECORD.
  5248
  5249     IF ERACCTT-FILE-STATUS = '10'
  5250        MOVE HIGH-VALUES TO AM-CONTROL-PRIMARY.
  5251
  5252     IF ERACCTT-FILE-STATUS NOT = '00' AND '10'
  5253        MOVE ' ERROR ON READ ERACCT ' TO WS-ABEND-MESSAGE
  5254        MOVE ERACCTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  5255        GO TO ABEND-PGM.
  5256
  5257     ADD  1 TO WS-ACCT-DB-CNT
  5258               WS-TOT-ACCT-DB-CNT
  5259     IF WS-ACCT-DB-CNT > 10000
  5260        MOVE ZEROS TO WS-ACCT-DB-CNT
  5261        DISPLAY ' ACCTS  READ ' WS-TOT-ACCT-DB-CNT
  5262     END-IF
* 5263     COPY ELCACCTI.
  5264******************************************************************04/14/98
  5265*                                                                *ELCACCTI
  5266*                            ELCACCTI                            *   LV003
  5267*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5268*                            VMOD=2.001                          *ELCACCTI
  5269*                                                                *ELCACCTI
  5270*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  5271*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  5272*                                                                *ELCACCTI
  5273*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  5274*                                                                *ELCACCTI
  5275******************************************************************ELCACCTI
  5276     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 105
* ECS158.cbl (/apps/prod/cid1p/copy/ELCACCTI)
  5277     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  5278     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  5279     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  5280     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  5281     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  5282     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  5283     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  5284     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  5285
  5286 0160-READ-CERT-MASTER.
  5287
  5288     READ CERTS AT END
  5289          MOVE HIGH-VALUES TO CERT-IN-RECORD.
  5290
  5291     ADD  1 TO WS-CERT-DB-CNT
  5292               WS-TOT-CERT-DB-CNT
  5293     IF WS-CERT-DB-CNT > 10000
  5294        MOVE ZEROS TO WS-CERT-DB-CNT
  5295        DISPLAY ' CERT   READ ' WS-TOT-CERT-DB-CNT
  5296     END-IF
* 5297      COPY ELCCRTM1.
  5298******************************************************************04/15/98
  5299*                                                                *ELCCRTM1
  5300*                                                                *ELCCRTM1
  5301*                            ELCCRTM1                            *   LV003
  5302*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5303*                            VMOD=2.001                          *ELCCRTM1
  5304*                                                                *ELCCRTM1
  5305*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  5306*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  5307*                                                                *ELCCRTM1
  5308******************************************************************ELCCRTM1
  5309     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  5310     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  5311     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  5312     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  5313     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  5314     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  5315     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  5316     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  5317     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  5318                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  5319     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  5320                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  5321     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  5322     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  5323     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  5324     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  5325     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  5326     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  5327           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  5328                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  5329     END-PERFORM.                                                 ELCCRTM1
  5330                                                                  ELCCRTM1
  5331
  5332     IF CR-STATE NOT = HIGH-VALUES
  5333         IF CR-STATE NOT = SAVE-STATE
  5334           MOVE CR-STATE TO TEMP-STATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 106
* ECS158.cbl
  5335           PERFORM 6200-LOCATE-STATE THRU 6200-EXIT.
  5336
  5337     IF CR-STATE NOT = HIGH-VALUES
  5338        IF STATE-IS-EXCLUDED
  5339            GO TO 0160-READ-CERT-MASTER.
  5340
  5341     IF (CR-CARRIER = '9')
  5342        AND (CR-STATE = 'NE')
  5343        AND (CR-ACCOUNT = '0000015860')
  5344        AND (CR-CERT-NO = '1098173790 ')
  5345        DISPLAY ' BIG CERT BYPASSED ' CR-CERT-NO
  5346        GO TO 0160-READ-CERT-MASTER
  5347     END-IF
  5348
  5349     IF CR-POLICY-IS-DECLINED OR
  5350        CR-POLICY-IS-VOID
  5351            GO TO 0160-READ-CERT-MASTER.
  5352
  5353     MOVE CR-FULL-CONTROL TO CERT-CONTROL.
  5354
  5355 0170-READ-SORTED-CLAIMS.
  5356
  5357     READ SORTED-CLAIMS AT END
  5358       MOVE HIGH-VALUES TO SORTED-EXTRACT.
  5359
  5360     ADD  1 TO WS-SCLM-DB-CNT
  5361               WS-TOT-SCLM-DB-CNT
  5362     IF WS-SCLM-DB-CNT > 10000
  5363        MOVE ZEROS TO WS-SCLM-DB-CNT
  5364        DISPLAY ' SCLMS  READ ' WS-TOT-SCLM-DB-CNT
  5365     END-IF
  5366     MOVE SORTED-EXTRACT TO DETAIL-EXTRACT.
  5367
  5368     MOVE DE-CONTROL TO CLAIMS-CONTROL.
  5369
  5370     IF SORTED-EXTRACT NOT = HIGH-VALUES
  5371        IF DE-STATE NOT = SAVE-STATE
  5372           MOVE DE-STATE TO TEMP-STATE
  5373           PERFORM 6200-LOCATE-STATE THRU 6200-EXIT.
  5374
  5375     IF SORTED-EXTRACT NOT = HIGH-VALUES
  5376        IF STATE-IS-EXCLUDED
  5377            GO TO 0170-READ-SORTED-CLAIMS.
  5378
  5379     IF SORTED-EXTRACT = HIGH-VALUES
  5380         GO TO 0230-PROCESS-CLAIMS-EXIT.
  5381
* 5382     COPY   ELCEXTM1.
  5383******************************************************************04/15/98
  5384*                                                                *ELCEXTM1
  5385*                                                                *ELCEXTM1
  5386*                            ELCEXTM1                            *   LV010
  5387*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
  5388*                            VMOD=2.001                          *ELCEXTM1
  5389*                                                                *ELCEXTM1
  5390*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
  5391*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
  5392*                                                                *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 107
* ECS158.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
  5393******************************************************************ELCEXTM1
  5394                                                                  ELCEXTM1
  5395     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
  5396     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
  5397     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
  5398     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
  5399     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
  5400     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
  5401                                                                     CL**9
  5402     EVALUATE TRUE                                                   CL**5
  5403        WHEN DE-ISSUE      OR                                        CL**8
  5404             DE-RC-ISSUE   OR                                        CL**8
  5405             DE-RR-RC-ISS  OR                                        CL**8
  5406             DE-CANCEL     OR                                        CL**8
  5407             DE-RC-CANCEL  OR                                        CL**8
  5408             DE-RR-RC-CNC                                            CL**8
  5409           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
  5410                                                                     CL**9
  5411        WHEN DE-CLAIM      OR                                        CL**8
  5412             DE-RR-RC-CLM                                            CL**6
  5413           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
  5414           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
  5415           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
  5416           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
  5417           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
  5418           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
  5419                                                                     CL**9
  5420        WHEN DE-RESERVE                                              CL**9
  5421           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
  5422           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
  5423           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
  5424                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
  5425           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
  5426                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
  5427           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
  5428     END-EVALUATE.                                                   CL**9
  5429                                                                     CL**9
  5430
  5431     IF DE-CLM-PROC-DT NOT NUMERIC
  5432        MOVE DE-PAY-MO    TO DE-CP-MO
  5433        MOVE DE-PAY-DA    TO DE-CP-DA
  5434        MOVE DE-PAY-YR    TO DE-CP-YR.
  5435
  5436     MOVE DE-INCUR        TO  DC-GREG-DATE-CYMD.
  5437     MOVE 'L'             TO  DC-OPTION-CODE.
  5438     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5439     IF NO-CONVERSION-ERROR
  5440        MOVE DC-BIN-DATE-1  TO  BIN-DE-INCUR
  5441     ELSE
  5442        MOVE 'DE-INCUR CONVERSION ERROR' TO
  5443                                         WS-ABEND-MESSAGE
  5444        MOVE DC-ERROR-CODE  TO  WS-ABEND-FILE-STATUS
  5445        DISPLAY 'CLAIMS CONTROL 2 ' CLAIMS-CONTROL
  5446        MOVE LOW-VALUES     TO  BIN-DE-INCUR.
  5447*       GO TO ABEND-PGM.
  5448
  5449     MOVE DE-CLM-PROC-DT  TO  DC-GREG-DATE-CYMD.
  5450     MOVE 'L'             TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 108
* ECS158.cbl
  5451     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5452     IF NO-CONVERSION-ERROR
  5453        MOVE DC-BIN-DATE-1  TO  BIN-DE-CLM-PROC-DT
  5454     ELSE
  5455        MOVE 'DE-CLM-PROC-DT CONVERSION ERROR' TO
  5456                                         WS-ABEND-MESSAGE
  5457        MOVE DC-ERROR-CODE  TO  WS-ABEND-FILE-STATUS
  5458        GO TO ABEND-PGM.
  5459
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 109
* ECS158.cbl
  5461 0180-MATCH-ROUTINE.
  5462
  5463     IF CERT-CONTROL = HIGH-VALUES
  5464        IF CLAIMS-CONTROL = HIGH-VALUES
  5465           GO TO 6100-E-O-J-RTN.
  5466
  5467     IF CLAIMS-CONTROL LESS THAN CERT-CONTROL
  5468        MOVE '1' TO WS-MATCH-SWITCH
  5469        PERFORM 0190-PROCESS-CLAIMS THRU 0230-PROCESS-CLAIMS-EXIT
  5470        PERFORM 1500-RELEASE THRU 1540-RELEASE-EXIT
  5471        GO TO 0180-MATCH-ROUTINE.
  5472
  5473     IF CLAIMS-CONTROL GREATER THAN CERT-CONTROL
  5474        MOVE '2' TO WS-MATCH-SWITCH
  5475        PERFORM 0240-PROCESS-CERTS THRU 1410-PROCESS-CERTS-EXIT
  5476        PERFORM 0160-READ-CERT-MASTER
  5477        GO TO 0180-MATCH-ROUTINE.
  5478
  5479     MOVE '3' TO WS-MATCH-SWITCH.
  5480     PERFORM 0190-PROCESS-CLAIMS THRU 0230-PROCESS-CLAIMS-EXIT.
  5481     PERFORM 0240-PROCESS-CERTS THRU 1410-PROCESS-CERTS-EXIT.
  5482     PERFORM 0160-READ-CERT-MASTER.
  5483
  5484     GO TO 0180-MATCH-ROUTINE.
  5485
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 110
* ECS158.cbl
  5487 0190-PROCESS-CLAIMS.
  5488
  5489     INITIALIZE  CALL-EXTRACT.
  5490
  5491     MOVE LOW-VALUES          TO HOLD-CLAIMS-CONTROL.
  5492
  5493     MOVE ZEROS TO WS-DEV (1)      WS-DEV (2)
  5494                   WS-BEN-TYPE (1) WS-BEN-TYPE (2)
  5495                   WS-TERM (1)     WS-TERM (2).
  5496
  5497     PERFORM 0200-ZERO-CLAIM-TABLE VARYING
  5498             SB FROM +1 BY +1 UNTIL SB GREATER THAN +2 AFTER
  5499             YR FROM +1 BY +1 UNTIL YR GREATER THAN +3.
  5500
  5501     GO TO 0210-CONTINUE-CLAIMS.
  5502
  5503 0200-ZERO-CLAIM-TABLE.
  5504
  5505     MOVE +0         TO WS-CLAIM-AMT (1 SB YR)
  5506                        WS-CLAIM-AMT (2 SB YR)
  5507                        WS-INC-CNT (1 SB YR)
  5508                        WS-PD-CNT  (1 SB YR)
  5509                        WS-INC-CNT (2 SB YR)
  5510                        WS-PD-CNT  (2 SB YR).
  5511
  5512 0210-CONTINUE-CLAIMS.
  5513
  5514     MOVE +1         TO LIFE-AH-SUB.
  5515
  5516     IF CERT-AND-CLAIM
  5517        GO TO 0220-CLAIMS-LOOP.
  5518
  5519     MOVE CLAIMS-CONTROL      TO ACCT-MATCH-CONTROL.
  5520     MOVE DE-EFF              TO ACCT-MATCH-EFF.
  5521
  5522     MOVE '1'                 TO WS-ACCT-MATCH.
  5523     PERFORM 0250-MATCH-TO-ACCOUNT THRU
  5524             0260-MATCH-ACCT-EXIT.
  5525
  5526     MOVE DE-CARRIER          TO EX-CARRIER.
  5527     MOVE DE-GROUPING         TO EX-GROUPING.
  5528     MOVE DE-STATE            TO EX-STATE.
  5529     MOVE DE-ACCOUNT          TO EX-ACCOUNT.
  5530     MOVE '2'                 TO EX-RECORD-TYPE.
  5531     MOVE '0'                 TO EX-TERM-CD.
  5532     MOVE '000'               TO EX-STATE-DEV.
  5533
  5534     IF DE-DTH OR DE-OB-DTH
  5535        MOVE 'L' TO EX-LIFE-AH
  5536     ELSE
  5537        MOVE 'A' TO EX-LIFE-AH.
  5538
  5539     IF DE-LF-TERM NOT NUMERIC
  5540        MOVE ZEROS            TO DE-LF-TERM.
  5541
  5542     IF DE-AH-TERM NOT NUMERIC
  5543        MOVE ZEROS            TO DE-AH-TERM.
  5544
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 111
* ECS158.cbl
  5545     IF DE-DTH OR DE-OB-DTH
  5546        IF DE-LF-TERM LESS THAN +60
  5547           MOVE '1' TO EX-TERM-CD
  5548        ELSE
  5549           MOVE '2' TO EX-TERM-CD
  5550     ELSE
  5551        IF DE-AH-TERM LESS THAN +60
  5552           MOVE '1' TO EX-TERM-CD
  5553        ELSE
  5554           MOVE '2' TO EX-TERM-CD.
  5555
  5556     IF DE-IG = '1' OR 'I'
  5557        MOVE 'I'              TO EX-I-G
  5558     ELSE
  5559        MOVE 'G'              TO EX-I-G.
  5560
  5561     MOVE '00'                TO EX-CAL-TABLE.
  5562     MOVE '01'                TO EX-ACCT-TYPE.
  5563
  5564     MOVE DE-ACC-NAME         TO EX-NAME.
  5565
  5566     IF ACCOUNT-MATCHED
  5567        MOVE AM-NAME          TO EX-NAME
  5568        MOVE AM-GPCD          TO EX-ACCT-TYPE.
  5569
  5570     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  5571        MOVE CR-RATING-CLASS  TO EX-CAL-TABLE
  5572     ELSE
  5573        MOVE AM-CAL-TABLE     TO EX-CAL-TABLE.
  5574
  5575 0220-CLAIMS-LOOP.
  5576
  5577     IF CLAIMS-CONTROL NOT = HOLD-CLAIMS-CONTROL AND
  5578        HOLD-CLAIMS-CONTROL NOT = LOW-VALUES
  5579           MOVE CLAIMS-CONTROL      TO HOLD-CLAIMS-CONTROL
  5580           GO TO 0230-PROCESS-CLAIMS-EXIT.
  5581
  5582     MOVE CLAIMS-CONTROL      TO HOLD-CLAIMS-CONTROL.
  5583
  5584     IF DE-DTH OR DE-OB-DTH
  5585        MOVE +1   TO LIFE-AH-SUB
  5586     ELSE
  5587        MOVE +2   TO LIFE-AH-SUB.
  5588
  5589     IF DE-LF-TERM NOT NUMERIC
  5590        MOVE ZEROS            TO DE-LF-TERM.
  5591
  5592     IF DE-AH-TERM NOT NUMERIC
  5593        MOVE ZEROS            TO DE-AH-TERM.
  5594
  5595     IF DE-DTH OR DE-OB-DTH
  5596        MOVE DE-LF-TYPE       TO WS-BEN-TYPE (LIFE-AH-SUB)
  5597        MOVE DE-LF-TERM       TO WS-TERM     (LIFE-AH-SUB)
  5598     ELSE
  5599        MOVE DE-AH-TYPE       TO WS-BEN-TYPE (LIFE-AH-SUB)
  5600        MOVE DE-AH-TERM       TO WS-TERM     (LIFE-AH-SUB).
  5601
  5602     IF AM-GPCD NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 112
* ECS158.cbl
  5603         MOVE ZEROS TO AM-GPCD.
  5604
  5605     IF ACCOUNT-MATCHED
  5606         IF AM-GPCD NOT = SAVE-BUSC-TYPE
  5607             PERFORM 6300-LOCATE-BUSC-TYPE THRU 6399-EXIT.
  5608
  5609     IF ACCOUNT-MATCHED
  5610         IF BUSC-TYPE-IS-EXCLUDED
  5611             GO TO 0225-CONTINUE-CLAIMS.
  5612
  5613     IF ACCOUNT-MATCHED
  5614        IF DE-AH OR DE-OB-AH
  5615           MOVE AM-AH-DEVIATION TO WS-DEV (LIFE-AH-SUB)
  5616        ELSE
  5617           MOVE AM-LF-DEVIATION TO WS-DEV (LIFE-AH-SUB).
  5618
  5619     IF NOT SINGLE-PERIOD-PROCESS
  5620         GO TO 0222-CONTINUE.
  5621
  5622     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (1)
  5623       AND
  5624        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (1)
  5625         ADD DE-CLAIM-AMT      TO WS-CLAIM-AMT (LIFE-AH-SUB 1 1)
  5626     ELSE
  5627     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (2)
  5628       AND
  5629        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (2)
  5630        ADD DE-CLAIM-AMT       TO WS-CLAIM-AMT (LIFE-AH-SUB 1 2).
  5631
  5632     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (1)
  5633       AND
  5634        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (1)
  5635        IF DE-VOIDED-PAYMENT
  5636            SUBTRACT +1 FROM WS-PD-CNT (LIFE-AH-SUB 1 1)
  5637        ELSE
  5638           IF DE-CLAIM-AMT NOT = ZEROS
  5639               ADD +1 TO WS-PD-CNT (LIFE-AH-SUB 1 1)
  5640           ELSE
  5641               NEXT SENTENCE
  5642     ELSE
  5643     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (2)
  5644       AND
  5645        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (2)
  5646        IF DE-VOIDED-PAYMENT
  5647            SUBTRACT +1 FROM WS-PD-CNT (LIFE-AH-SUB 1 2)
  5648        ELSE
  5649           IF DE-CLAIM-AMT NOT = ZEROS
  5650               ADD +1 TO WS-PD-CNT (LIFE-AH-SUB 1 2).
  5651
  5652     IF BIN-DE-INCUR NOT GREATER THAN END-DT (1)
  5653       AND
  5654        BIN-DE-INCUR GREATER THAN BEGIN-DT (1)
  5655        MOVE +1                TO WS-INC-CNT (LIFE-AH-SUB 1 1)
  5656     ELSE
  5657     IF BIN-DE-INCUR NOT GREATER THAN END-DT (2)
  5658       AND
  5659        BIN-DE-INCUR GREATER THAN BEGIN-DT (2)
  5660        MOVE +1             TO WS-INC-CNT (LIFE-AH-SUB 1 2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 113
* ECS158.cbl
  5661
  5662     GO TO 0225-CONTINUE-CLAIMS.
  5663
  5664 0222-CONTINUE.
  5665     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (1)
  5666       AND
  5667        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (1)
  5668        ADD DE-CLAIM-AMT       TO WS-CLAIM-AMT (LIFE-AH-SUB 1 1)
  5669     ELSE
  5670     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (2)
  5671       AND
  5672        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (2)
  5673        ADD DE-CLAIM-AMT       TO WS-CLAIM-AMT (LIFE-AH-SUB 1 2)
  5674     ELSE
  5675     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (3)
  5676       AND
  5677        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (3)
  5678        ADD DE-CLAIM-AMT       TO WS-CLAIM-AMT (LIFE-AH-SUB 1 3).
  5679
  5680     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (1)
  5681       AND
  5682        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (1)
  5683        IF DE-VOIDED-PAYMENT
  5684            SUBTRACT +1 FROM WS-PD-CNT (LIFE-AH-SUB 1 1)
  5685        ELSE
  5686           IF DE-CLAIM-AMT NOT = ZEROS
  5687               ADD +1 TO WS-PD-CNT (LIFE-AH-SUB 1 1)
  5688           ELSE
  5689               NEXT SENTENCE
  5690     ELSE
  5691     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (2)
  5692       AND
  5693        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (2)
  5694        IF DE-VOIDED-PAYMENT
  5695            SUBTRACT +1 FROM WS-PD-CNT (LIFE-AH-SUB 1 2)
  5696        ELSE
  5697           IF DE-CLAIM-AMT NOT = ZEROS
  5698               ADD +1 TO WS-PD-CNT (LIFE-AH-SUB 1 2)
  5699           ELSE
  5700               NEXT SENTENCE
  5701     ELSE
  5702     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (3)
  5703       AND
  5704        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (3)
  5705        IF DE-VOIDED-PAYMENT
  5706            SUBTRACT +1 FROM WS-PD-CNT (LIFE-AH-SUB 1 3)
  5707        ELSE
  5708           IF DE-CLAIM-AMT NOT = ZEROS
  5709               ADD +1 TO WS-PD-CNT (LIFE-AH-SUB 1 3).
  5710
  5711     IF BIN-DE-INCUR NOT GREATER THAN END-DT (1)
  5712       AND
  5713        BIN-DE-INCUR GREATER THAN BEGIN-DT (1)
  5714        MOVE +1                TO WS-INC-CNT (LIFE-AH-SUB 1 1)
  5715     ELSE
  5716     IF BIN-DE-INCUR NOT GREATER THAN END-DT (2)
  5717       AND
  5718        BIN-DE-INCUR GREATER THAN BEGIN-DT (2)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 114
* ECS158.cbl
  5719        MOVE +1             TO WS-INC-CNT (LIFE-AH-SUB 1 2)
  5720     ELSE
  5721     IF BIN-DE-INCUR NOT GREATER THAN END-DT (3)
  5722       AND
  5723        BIN-DE-INCUR GREATER THAN BEGIN-DT (3)
  5724        MOVE +1          TO WS-INC-CNT (LIFE-AH-SUB 1 3).
  5725
  5726 0225-CONTINUE-CLAIMS.
  5727
  5728     PERFORM 0170-READ-SORTED-CLAIMS.
  5729
  5730     GO TO 0220-CLAIMS-LOOP.
  5731
  5732 0230-PROCESS-CLAIMS-EXIT.
  5733     EXIT.
  5734
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 115
* ECS158.cbl
  5736 0240-PROCESS-CERTS.
  5737
  5738     IF CR-LF-CANC-DT NOT NUMERIC
  5739        MOVE ZEROS      TO CR-LF-CANC-DT.
  5740
  5741     IF CR-LF-CANCEL-EXIT-DATE NOT NUMERIC
  5742        MOVE ZEROS      TO CR-LF-CANCEL-EXIT-DATE.
  5743
  5744     IF CR-AH-CANC-DT NOT NUMERIC
  5745        MOVE ZEROS      TO CR-AH-CANC-DT.
  5746
  5747     IF CR-AH-CANCEL-EXIT-DATE NOT NUMERIC
  5748        MOVE ZEROS      TO CR-AH-CANCEL-EXIT-DATE.
  5749
  5750     IF CR-DTH-DT NOT NUMERIC
  5751        MOVE ZEROS      TO CR-DTH-DT.
  5752
  5753     IF CR-LF-CLAIM-EXIT-DATE  NOT NUMERIC
  5754        MOVE ZEROS      TO CR-LF-CLAIM-EXIT-DATE.
  5755
  5756     IF CR-DTH-DT NOT = ZEROS
  5757         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
  5758             IF CR-LF-CURRENT-STATUS = '7'
  5759                 MOVE CR-DTH-DT  TO CR-LF-CLAIM-EXIT-DATE.
  5760
  5761     IF CR-LF-CANC-DT NOT = ZEROS
  5762         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  5763             MOVE CR-LF-CANC-DT TO CR-LF-CANCEL-EXIT-DATE.
  5764
  5765     IF CR-AH-CANC-DT NOT = ZEROS
  5766         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  5767             MOVE CR-AH-CANC-DT TO CR-AH-CANCEL-EXIT-DATE.
  5768
  5769     IF CERT-NO-CLAIM
  5770        MOVE ZEROS TO WS-DEV (1)      WS-DEV (2)
  5771                      WS-BEN-TYPE (1) WS-BEN-TYPE (2)
  5772                      WS-TERM (1)     WS-TERM (2)
  5773
  5774        PERFORM 0200-ZERO-CLAIM-TABLE VARYING
  5775             SB FROM +1 BY +1 UNTIL SB GREATER THAN +2 AFTER
  5776             YR FROM +1 BY +1 UNTIL YR GREATER THAN +3.
  5777
  5778     MOVE +1                  TO  LIFE-AH-SUB    YR.
  5779
  5780     INITIALIZE   CALL-EXTRACT.
  5781
  5782     MOVE CALL-EXTRACT        TO HOLD-LIFE-RECORD
  5783                                 HOLD-AH-RECORD.
  5784
  5785     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  5786     MOVE 'L'                        TO DC-OPTION-CODE.
  5787     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5788     IF NO-CONVERSION-ERROR
  5789        MOVE DC-BIN-DATE-1            TO EFFECT-DT
  5790     ELSE
  5791        MOVE LOW-VALUES               TO EFFECT-DT.
  5792
  5793     MOVE CR-ENTRY-DATE              TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 116
* ECS158.cbl
  5794     MOVE 'L'                        TO DC-OPTION-CODE.
  5795     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5796     IF NO-CONVERSION-ERROR
  5797        MOVE DC-BIN-DATE-1            TO ENTRY-DT
  5798     ELSE
  5799        MOVE EFFECT-DT                TO ENTRY-DT.
  5800
  5801     IF ENTRY-DT GREATER THAN END-DT (1)
  5802        GO TO 1410-PROCESS-CERTS-EXIT.
  5803
  5804     MOVE CERT-CONTROL TO ACCT-MATCH-CONTROL.
  5805     MOVE CR-DT        TO ACCT-MATCH-EFF.
  5806     MOVE '2'          TO WS-ACCT-MATCH.
  5807
  5808     PERFORM 0250-MATCH-TO-ACCOUNT THRU
  5809             0260-MATCH-ACCT-EXIT.
  5810
  5811     GO TO 0265-CONTINUE-CERT.
  5812
  5813 0250-MATCH-TO-ACCOUNT.
  5814
  5815     MOVE ' ' TO WS-ACCT-MATCH-SW.
  5816
  5817     IF ACCT-MATCH-CONTROL GREATER THAN AM-CONTROL-A
  5818        PERFORM 0150-READ-ACCOUNT
  5819        GO TO 0250-MATCH-TO-ACCOUNT.
  5820
  5821     IF ACCT-MATCH-CONTROL LESS THAN AM-CONTROL-A
  5822        MOVE +0302 TO WS-RETURN-CODE
  5823        IF FROM-CLAIM
  5824           MOVE 'NO ACCOUNT MASTER FOR CLAIM ' TO
  5825                 WS-ABEND-MESSAGE
  5826           DISPLAY 'CLAIM CONTROL ' ACCT-MATCH-CONTROL
  5827           DISPLAY 'CLAIM EFF DTE ' ACCT-MATCH-EFF
  5828           GO TO 0260-MATCH-ACCT-EXIT
  5829        ELSE
  5830           MOVE 'NO ACCOUNT MASTER FOR CERT  ' TO
  5831                 WS-ABEND-MESSAGE
  5832           DISPLAY 'CERT  CONTROL ' ACCT-MATCH-CONTROL
  5833           DISPLAY 'CERT  EFF DTE ' ACCT-MATCH-EFF
  5834           GO TO 0260-MATCH-ACCT-EXIT.
  5835
  5836     IF ACCT-MATCH-EFF GREATER THAN WS-AM-EXPIRE-DT
  5837        PERFORM 0150-READ-ACCOUNT
  5838        GO TO 0250-MATCH-TO-ACCOUNT.
  5839
  5840     MOVE '*' TO WS-ACCT-MATCH-SW.
  5841
  5842 0260-MATCH-ACCT-EXIT.
  5843     EXIT.
  5844
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 117
* ECS158.cbl
  5846 0265-CONTINUE-CERT.
  5847
  5848     IF CR-LFPRM-CALC NOT NUMERIC
  5849        MOVE +0    TO CR-LFPRM-CALC.
  5850
  5851     IF CR-AHPRM-CALC NOT NUMERIC
  5852        MOVE +0    TO CR-AHPRM-CALC.
  5853
  5854     IF CR-LFRFND-CALC NOT NUMERIC
  5855        MOVE +0    TO CR-LFRFND-CALC.
  5856
  5857     IF CR-AHRFND-CALC NOT NUMERIC
  5858        MOVE +0    TO CR-AHRFND-CALC.
  5859
  5860     IF CR-APR NOT NUMERIC
  5861        MOVE +0    TO CR-APR.
  5862
  5863     IF CR-LF-DEV-CODE = SPACES OR LOW-VALUES
  5864        MOVE ZEROS TO CR-LF-DEV-CODE.
  5865
  5866     IF CR-AH-DEV-CODE = SPACES OR LOW-VALUES
  5867        MOVE ZEROS TO CR-AH-DEV-CODE.
  5868
  5869     IF DTE-CLIENT = 'CRI'
  5870         MOVE CR-LF-DEV-CODE     TO  WK-LF-DEV-CODE
  5871         MOVE 'P'                TO  WK-LF-DEV-CODE-1
  5872         MOVE '0'                TO  WK-LF-DEV-CODE-3
  5873         MOVE CR-AH-DEV-CODE     TO  WK-AH-DEV-CODE
  5874         MOVE 'P'                TO  WK-AH-DEV-CODE-1
  5875         MOVE '0'                TO  WK-AH-DEV-CODE-3.
  5876
  5877     MOVE CR-CARRIER        TO EX-CARRIER.
  5878     MOVE CR-GROUPING       TO EX-GROUPING.
  5879     MOVE CR-STATE          TO EX-STATE.
  5880     MOVE CR-ACCOUNT        TO EX-ACCOUNT
  5881
  5882     IF CR-IND-GRP = '1' OR 'I'
  5883        MOVE 'I'            TO EX-I-G
  5884     ELSE
  5885        MOVE 'G'            TO EX-I-G.
  5886
  5887     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  5888        MOVE CR-RATING-CLASS  TO EX-CAL-TABLE
  5889     ELSE
  5890        MOVE AM-CAL-TABLE     TO EX-CAL-TABLE.
  5891
  5892     IF ACCOUNT-MATCHED
  5893        MOVE AM-GPCD           TO EX-ACCT-TYPE
  5894        MOVE AM-NAME           TO EX-NAME.
  5895
  5896     IF ACCOUNT-MATCHED
  5897         IF AM-GPCD NOT = SAVE-BUSC-TYPE
  5898             PERFORM 6300-LOCATE-BUSC-TYPE THRU 6399-EXIT.
  5899
  5900     IF ACCOUNT-MATCHED
  5901         IF BUSC-TYPE-IS-EXCLUDED
  5902             GO TO 1410-PROCESS-CERTS-EXIT.
  5903
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 118
* ECS158.cbl
  5904     MOVE CR-DT             TO EX-EFF-DATE.
  5905     MOVE CR-AGE            TO EX-AGE.
  5906     MOVE CR-ENTRY-DATE     TO EX-ENTRY-DATE.
  5907     MOVE CR-PMT-FREQ       TO EX-PMT-FREQ.
  5908     MOVE CR-APR            TO EX-APR.
  5909     MOVE CR-LOAN-TERM      TO EX-CAP-TERM.
  5910     MOVE CR-LFAMT          TO EX-INITIAL-AMT.
  5911     MOVE CR-AHAMT          TO EX-BENEFIT.
  5912     MOVE '3'               TO EX-RECORD-TYPE.
  5913
  5914     MOVE CLAS-STARTL TO CLAS-INDEXL
  5915     MOVE CLAS-STARTA TO CLAS-INDEXA.
  5916     MOVE CLAS-STARTS TO CLAS-INDEXS.
  5917
  5918     MOVE WS-RESERVE-INIT   TO WS-RESERVE-WORK (1)
  5919                               WS-RESERVE-WORK (2)
  5920                               WS-RESERVE-WORK (3).
  5921
  5922     MOVE WS-REM-TERM-INIT  TO WS-REM-TERM-WORK (1)
  5923                               WS-REM-TERM-WORK (2)
  5924                               WS-REM-TERM-WORK (3).
  5925
  5926     MOVE LOW-VALUES TO LF-CAN LF-CLM
  5927                        AH-CAN AH-CLM.
  5928
  5929 0270-FIND-STATE.
  5930
  5931     IF CLAS-INDEXS GREATER THAN CLAS-MAXS
  5932        MOVE ' INVALID STATE ' TO WS-ABEND-MESSAGE
  5933        MOVE CR-STATE          TO WS-ABEND-FILE-STATUS
  5934        MOVE +0                TO WS-RETURN-CODE
  5935        GO TO ABEND-PGM.
  5936
  5937     IF STATE-PRIM-FAC-DEV (CLAS-INDEXS) = SPACES OR LOW-VALUES
  5938        MOVE ZEROS TO STATE-PRIM-FAC-DEV (CLAS-INDEXS).
  5939
  5940     IF STATE-SUB (CLAS-INDEXS) NOT = CR-STATE
  5941        ADD +1 TO CLAS-INDEXS
  5942        GO TO 0270-FIND-STATE.
  5943
  5944 0280-PROCESS-LIFE.
  5945
  5946     IF CR-LFTYP = ZEROS OR SPACES
  5947         GO TO 1000-PROCESS-AH.
  5948
  5949     IF CR-LF-DEV-PCT NOT NUMERIC
  5950         MOVE ZEROS TO CR-LF-DEV-PCT.
  5951
  5952     IF DTE-CLIENT  =  'CRI'
  5953         MOVE WK-LF-DEV-CODE      TO  EX-STATE-DEV
  5954     ELSE
  5955         IF CR-LF-DEV-PCT NOT = +0 AND +1.0
  5956             COMPUTE WK-TEMP-DEV-PCT =
  5957                             CR-LF-DEV-PCT * WK-DEV-FACTOR
  5958             MOVE WK-TEMP-DEV     TO  EX-STATE-DEV
  5959         ELSE
  5960             MOVE CR-LF-DEV-CODE  TO  EX-STATE-DEV.
  5961
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 119
* ECS158.cbl
  5962     MOVE 'L'             TO EX-LIFE-AH.
  5963
  5964 0290-CHECK-LF-STATUS.
  5965
  5966     MOVE ZEROS                  TO EX-EXIT-DATE
  5967     MOVE LOW-VALUES             TO EXIT-DT
  5968                                    EXPIRE-DT
  5969
  5970     IF CR-LF-CURRENT-STATUS NOT = '6' AND '7' AND '8'
  5971        GO TO 0300-FIND-LIFE-LOOP.
  5972
  5973     MOVE CR-LF-CANCEL-EXIT-DATE     TO DC-GREG-DATE-CYMD.
  5974     MOVE 'L'                        TO DC-OPTION-CODE.
  5975     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5976     IF NO-CONVERSION-ERROR
  5977        MOVE DC-BIN-DATE-1            TO LF-CAN
  5978     ELSE
  5979        MOVE LOW-VALUES               TO LF-CAN.
  5980
  5981     MOVE CR-LF-CLAIM-EXIT-DATE      TO DC-GREG-DATE-CYMD.
  5982     MOVE 'L'                        TO DC-OPTION-CODE.
  5983     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5984     IF NO-CONVERSION-ERROR
  5985        MOVE DC-BIN-DATE-1            TO LF-CLM
  5986     ELSE
  5987        MOVE LOW-VALUES               TO LF-CLM.
  5988
  5989     IF LF-CAN = LOW-VALUES AND
  5990        LF-CLM = LOW-VALUES
  5991        GO TO 0300-FIND-LIFE-LOOP.
  5992
  5993     IF LF-CAN = LOW-VALUES AND
  5994        LF-CLM NOT = LOW-VALUES
  5995        MOVE CR-LF-CLAIM-EXIT-DATE TO EX-EXIT-DATE
  5996        GO TO 0300-FIND-LIFE-LOOP.
  5997
  5998     IF LF-CLM = LOW-VALUES
  5999        MOVE CR-LF-CANCEL-EXIT-DATE TO EX-EXIT-DATE
  6000        GO TO 0300-FIND-LIFE-LOOP.
  6001
  6002     IF LF-CAN LESS THAN LF-CLM
  6003        MOVE CR-LF-CANCEL-EXIT-DATE TO EX-EXIT-DATE
  6004        GO TO 0300-FIND-LIFE-LOOP.
  6005
  6006     MOVE CR-LF-CLAIM-EXIT-DATE TO EX-EXIT-DATE.
  6007
  6008 0300-FIND-LIFE-LOOP.
  6009
  6010     IF CLAS-INDEXL GREATER THAN CLAS-MAXL
  6011        MOVE ' INVALID LIFE TYPE ' TO WS-ABEND-MESSAGE
  6012        MOVE CR-LFTYP TO WS-ABEND-FILE-STATUS
  6013        GO TO ABEND-PGM.
  6014
  6015     IF CR-LFTYP NOT = CLAS-I-BEN (CLAS-INDEXL)
  6016        ADD +1 TO CLAS-INDEXL
  6017        GO TO 0300-FIND-LIFE-LOOP.
  6018
  6019     MOVE CLAS-I-EP (CLAS-INDEXL) TO LF-EARN-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 120
* ECS158.cbl
  6020
  6021*    IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  6022*       IF AM-EARN-METHOD-R NOT = SPACES AND ZEROS
  6023*          MOVE AM-EARN-METHOD-R TO LF-EARN-CODE
  6024*       ELSE
  6025*          NEXT SENTENCE
  6026*    ELSE
  6027*       IF AM-EARN-METHOD-L NOT = SPACES AND ZEROS
  6028*          MOVE AM-EARN-METHOD-L TO LF-EARN-CODE.
  6029
  6030 0310-WAS-LIFE-INFORCE.
  6031
  6032     IF EX-EXIT-DATE NOT = ZEROS
  6033        MOVE EX-EXIT-DATE        TO DC-GREG-DATE-CYMD
  6034        MOVE 'L'                 TO DC-OPTION-CODE
  6035        PERFORM 6150-DATE-CONVERSION-ROUTINE
  6036        IF NO-CONVERSION-ERROR
  6037           MOVE DC-BIN-DATE-1    TO EXIT-DT
  6038        ELSE
  6039           MOVE LOW-VALUES       TO EXIT-DT
  6040        END-IF
  6041     END-IF
  6042
  6043     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  6044     MOVE 'L'                        TO DC-OPTION-CODE.
  6045     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6046     IF NO-CONVERSION-ERROR
  6047        MOVE DC-BIN-DATE-1            TO EFFECT-DT
  6048     ELSE
  6049        MOVE LOW-VALUES               TO EFFECT-DT.
  6050
  6051     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  6052         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  6053
  6054     MOVE LOW-VALUES             TO     FIRST-PAY-DT.
  6055
  6056     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  6057         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  6058         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  6059                                        DC-ELAPSED-DAYS
  6060         MOVE '3'                    TO DC-OPTION-CODE
  6061         PERFORM 6150-DATE-CONVERSION-ROUTINE
  6062         IF NO-CONVERSION-ERROR
  6063             MOVE DC-BIN-DATE-1      TO FIRST-PAY-DT
  6064         ELSE
  6065             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  6066
  6067     IF FIRST-PAY-DT LESS THAN  EFFECT-DT
  6068         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  6069
  6070     IF CR-LOAN-1ST-PMT-DT = ZEROS
  6071         MOVE EFFECT-DT              TO DC-BIN-DATE-1
  6072         MOVE +1                     TO DC-ELAPSED-MONTHS
  6073         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  6074         MOVE '6'                    TO DC-OPTION-CODE
  6075         PERFORM 6150-DATE-CONVERSION-ROUTINE
  6076         MOVE DC-BIN-DATE-2          TO FIRST-PAY-DT
  6077         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 121
* ECS158.cbl
  6078
  6079     MOVE FIRST-PAY-DT            TO DC-BIN-DATE-1.
  6080
  6081     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6082        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  6083        MOVE CR-LF-TERM TO DC-ELAPSED-MONTHS
  6084     ELSE
  6085        COMPUTE DC-ELAPSED-MONTHS = CR-LF-TERM - +1.
  6086
  6087     MOVE '6'                     TO DC-OPTION-CODE.
  6088     move +0                         to dc-elapsed-days
  6089     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6090     IF NO-CONVERSION-ERROR
  6091         MOVE DC-BIN-DATE-2        TO EXPIRE-DT
  6092     ELSE
  6093         MOVE LOW-VALUES           TO EXPIRE-DT.
  6094
  6095     IF (EXPIRE-DT = LOW-VALUES)      OR
  6096         (DTE-REM-TRM-CALC-OPTION = '1' OR '2')
  6097        MOVE EFFECT-DT               TO DC-BIN-DATE-1
  6098        MOVE CR-LF-TERM              TO DC-ELAPSED-MONTHS
  6099        MOVE ZEROS                   TO DC-ELAPSED-DAYS
  6100        MOVE '6'                     TO DC-OPTION-CODE
  6101        PERFORM 6150-DATE-CONVERSION-ROUTINE
  6102        IF NO-CONVERSION-ERROR
  6103           MOVE DC-BIN-DATE-2        TO EXPIRE-DT
  6104        ELSE
  6105           MOVE LOW-VALUES           TO EXPIRE-DT.
  6106
  6107     MOVE CR-LF-EXPIRE-DATE      TO DC-GREG-DATE-CYMD
  6108     MOVE 'L'                    TO DC-OPTION-CODE
  6109     PERFORM 6150-DATE-CONVERSION-ROUTINE
  6110     IF NO-CONVERSION-ERROR
  6111        MOVE DC-BIN-DATE-1       TO EXPIRE-DT
  6112     ELSE
  6113        MOVE LOW-VALUES          TO EXPIRE-DT
  6114     END-IF
  6115
  6116     MOVE +0                         TO DC-ELAPSED-MONTHS
  6117
  6118     MOVE CR-LF-TERM                 TO EX-TERM.
  6119
  6120     IF CR-LF-TERM LESS THAN +60
  6121        MOVE '1'                     TO EX-TERM-CD
  6122     ELSE
  6123        MOVE '2'                     TO EX-TERM-CD.
  6124
  6125     MOVE CR-LFTYP                   TO EX-BEN-TYPE.
  6126
  6127     MOVE CR-LFPRM                   TO EX-PREM
  6128                                        EX-PRIM-FAC-PREM
  6129                                        WS-HOLD-LF-PRIM-FAC.
  6130
  6131     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  6132        MOVE CR-LFPRM-ALT      TO EX-PREM-ALT
  6133                                  EX-PRIM-FAC-PREM-ALT.
  6134
  6135 0315-LIFE-SUMMARY-ADJUSTMENTS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 122
* ECS158.cbl
  6136
  6137     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
  6138         GO TO 0320-CHECK-LF-PERIOD-INFORCE.
  6139
  6140     IF CR-LFPRM NOT GREATER CR-LFRFND
  6141         MOVE ZERO                   TO EX-INITIAL-AMT
  6142                                        EX-PREM
  6143     ELSE
  6144         IF CR-LFRFND = ZERO
  6145             MOVE CR-LFAMT           TO EX-INITIAL-AMT
  6146             MOVE CR-LFPRM           TO EX-PREM
  6147         ELSE
  6148             COMPUTE TEMP-3 ROUNDED = CR-LFRFND / CR-LFPRM
  6149             COMPUTE EX-INITIAL-AMT ROUNDED =
  6150                              CR-LFAMT - (CR-LFAMT * TEMP-3)
  6151             COMPUTE EX-PREM ROUNDED =
  6152                              CR-LFPRM - CR-LFRFND.
  6153
  6154     MOVE EX-PREM                    TO CR-LFPRM.
  6155
  6156 0320-CHECK-LF-PERIOD-INFORCE.
  6157
  6158     IF YR GREATER THAN NUMBER-OF-PERIODS
  6159         GO TO 0390-END-PROCESS-LIFE.
  6160
  6161     IF ENTRY-DT GREATER END-DT (YR)
  6162        GO TO 0390-END-PROCESS-LIFE.
  6163
  6164     IF CR-ENTRY-STATUS = '5' OR 'M'
  6165        MOVE +0             TO EX-PREM
  6166                               EX-PREM-ALT
  6167                               EX-PRIM-FAC-PREM
  6168                               EX-PRIM-FAC-PREM-ALT
  6169        GO TO 0360-CALC-LF-REFUND.
  6170
  6171     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  6172        GO TO 0340-END-REM-TERM-LF.
  6173
  6174     MOVE EFFECT-DT         TO DT-START.
  6175     IF BEGIN-DT (YR) GREATER THAN DT-START
  6176        MOVE BEGIN-DT (YR) TO DT-START.
  6177
  6178*    IF EXPIRE-DT NOT GREATER THAN END-DT (YR)
  6179*       MOVE EXPIRE-DT TO DT-END
  6180*    ELSE
  6181*       MOVE END-DT (YR) TO DT-END.
  6182
  6183     IF EXPIRE-DT < END-DT (YR)
  6184        MOVE EXPIRE-DT           TO DT-END
  6185     ELSE
  6186        MOVE END-DT (YR)         TO DT-END
  6187     END-IF
  6188
  6189     IF EXIT-DT NOT = LOW-VALUES
  6190        IF EXIT-DT LESS THAN DT-END
  6191           MOVE EXIT-DT TO DT-END.
  6192
  6193     MOVE DT-START                   TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 123
* ECS158.cbl
  6194     MOVE DT-END                     TO DC-BIN-DATE-2.
  6195     MOVE '1'                        TO DC-OPTION-CODE.
  6196     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6197     IF NO-CONVERSION-ERROR
  6198        MOVE DC-ELAPSED-MONTHS       TO RR (YR)
  6199     ELSE
  6200        MOVE +0                      TO RR (YR).
  6201
  6202     IF RR (YR) LESS THAN +0
  6203        MOVE +0 TO RR (YR).
  6204
  6205     MOVE EXPIRE-DT TO DT-END.
  6206
  6207     IF EXIT-DT NOT = LOW-VALUES
  6208        IF EXIT-DT LESS THAN DT-END
  6209           IF EXIT-DT NOT GREATER THAN END-DT (YR)
  6210              MOVE EXIT-DT TO DT-END.
  6211
  6212     MOVE DT-START                   TO DC-BIN-DATE-1.
  6213     MOVE DT-END                     TO DC-BIN-DATE-2.
  6214     MOVE '1'                        TO DC-OPTION-CODE.
  6215     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6216     IF NO-CONVERSION-ERROR
  6217        MOVE DC-ELAPSED-MONTHS       TO M1 (YR)
  6218     ELSE
  6219        MOVE +0                      TO M1 (YR).
  6220
  6221     IF M1 (YR) LESS THAN +0
  6222        MOVE +0 TO M1 (YR).
  6223
  6224
  6225     IF EXPIRE-DT < END-DT (YR)
  6226        MOVE +0                  TO M2 (YR) M5 (YR)
  6227        GO TO 0330-REM-TERM-LF-BEGIN
  6228     END-IF
  6229
  6230     IF EXIT-DT NOT = LOW-VALUES
  6231        IF EXIT-DT <= END-DT (YR)
  6232           MOVE +0               TO M2 (YR) M5 (YR)
  6233           GO TO 0330-REM-TERM-LF-BEGIN
  6234        END-IF
  6235     END-IF
  6236
  6237     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  6238     MOVE 'L'                        TO DC-OPTION-CODE.
  6239     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6240     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  6241
  6242     MOVE ENDING-DATE (YR)           TO DC-GREG-DATE-CYMD.
  6243     MOVE 'L'                        TO DC-OPTION-CODE.
  6244     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6245     MOVE DC-BIN-DATE-1              TO CP-VALUATION-DT.
  6246
  6247     IF CP-TERM-IS-DAYS
  6248        MOVE CR-LF-TERM-IN-DAYS      TO CP-TERM-OR-EXT-DAYS
  6249     ELSE
  6250        MOVE ZEROS                   TO CP-TERM-OR-EXT-DAYS.
  6251
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 124
* ECS158.cbl
  6252     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
  6253                                        CP-LOAN-TERM.
  6254     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  6255     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  6256
  6257     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6258       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  6259       ADD +1 TO CP-ORIGINAL-TERM CP-LOAN-TERM.
  6260
  6261     MOVE 'Y' TO FROM-LIFE-SW.
  6262     PERFORM 6000-CALC-REM-TERM THRU 6010-REM-TERM-EXIT.
  6263
  6264     IF REM-TRM2 GREATER CR-LF-TERM
  6265        MOVE CR-LF-TERM TO M2 (YR) M5 (YR)
  6266                           WS-LF-END-REM-TRM1 (YR)
  6267     ELSE
  6268     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6269       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  6270        MOVE REM-TRM1       TO M2 (YR)
  6271                               WS-LF-END-REM-TRM1 (YR)
  6272        MOVE LF-BAL-REMTERM TO M5 (YR)
  6273     ELSE
  6274        MOVE REM-TRM1       TO M2 (YR)
  6275                               WS-LF-END-REM-TRM1 (YR)
  6276        MOVE REM-TRM2       TO M5 (YR).
  6277
  6278 0330-REM-TERM-LF-BEGIN.
  6279
  6280     IF (ENTRY-DT GREATER BEGIN-DT (YR)) OR
  6281        (DT-END NOT GREATER BEGIN-DT (YR))
  6282        MOVE +0 TO M3 (YR) M6 (YR)
  6283        GO TO 0340-END-REM-TERM-LF.
  6284
  6285     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  6286     MOVE 'L'                        TO DC-OPTION-CODE.
  6287     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6288     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  6289
  6290     MOVE BEGIN-DATE (YR)            TO DC-GREG-DATE-CYMD.
  6291     MOVE 'L'                        TO DC-OPTION-CODE.
  6292     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6293     MOVE DC-BIN-DATE-1              TO CP-VALUATION-DT.
  6294
  6295     IF CP-TERM-IS-DAYS
  6296        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
  6297     ELSE
  6298        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS.
  6299
  6300     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
  6301                                        CP-LOAN-TERM.
  6302
  6303     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  6304     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  6305
  6306     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6307       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  6308       ADD +1 TO CP-ORIGINAL-TERM CP-LOAN-TERM.
  6309
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 125
* ECS158.cbl
  6310     MOVE 'Y' TO FROM-LIFE-SW.
  6311     PERFORM 6000-CALC-REM-TERM THRU 6010-REM-TERM-EXIT.
  6312
  6313     IF REM-TRM2 GREATER CR-LF-TERM
  6314        MOVE CR-LF-TERM TO M3 (YR) M6 (YR)
  6315                           WS-LF-BEG-REM-TRM1 (YR)
  6316     ELSE
  6317     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6318       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  6319        MOVE REM-TRM1       TO M3 (YR)
  6320                               WS-LF-BEG-REM-TRM1 (YR)
  6321        MOVE LF-BAL-REMTERM TO M6 (YR)
  6322     ELSE
  6323        MOVE REM-TRM1       TO M3 (YR)
  6324                               WS-LF-BEG-REM-TRM1 (YR)
  6325        MOVE REM-TRM2       TO M6 (YR).
  6326
  6327 0340-END-REM-TERM-LF.
  6328
  6329     IF M5 (YR) GREATER THAN +0
  6330         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  6331             COMPUTE EX-C-CNT (YR) = CR-LIVES -
  6332                                     CR-SUM-CAN-CNT-ITD
  6333         ELSE
  6334             MOVE +1 TO EX-C-CNT (YR).
  6335
  6336     IF DEBUG-LF-INFORCE-CNT
  6337         IF (YR = +1) AND
  6338            (EX-C-CNT (YR) GREATER THAN ZEROS)
  6339             ADD EX-C-CNT (YR) TO WS-S-INFORCE-CNT
  6340             DISPLAY ' CERT ', CR-FULL-CONTROL
  6341                     ' CNT ', EX-C-CNT (YR)
  6342                     ' TOT ', WS-S-INFORCE-CNT.
  6343
  6344     MOVE +0 TO SA.
  6345
  6346 0350-CALC-LIFE-COMMISSIONS.
  6347
  6348     IF (ENTRY-DT GREATER THAN END-DT (YR))
  6349       OR
  6350        (ENTRY-DT NOT GREATER THAN BEGIN-DT (YR))
  6351        GO TO 0360-CALC-LF-REFUND.
  6352
  6353     ADD +1 TO SA.
  6354
  6355     IF SA GREATER THAN +10
  6356        GO TO 0360-CALC-LF-REFUND.
  6357
  6358     IF CR-COM-AGT (SA) = ZEROS OR SPACES
  6359         GO TO 0350-CALC-LIFE-COMMISSIONS.
  6360
  6361     IF CR-AGT-TYPE (SA) = 'C' OR 'D' OR 'F' OR 'S'
  6362        COMPUTE AGT-COMM =
  6363         (CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (SA)
  6364        ADD AGT-COMM TO EX-AGT-COMM (YR)
  6365     ELSE
  6366        IF CR-AGT-TYPE (SA) = 'O' OR 'P' OR 'G' OR 'B'
  6367           COMPUTE AGT-COMM =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 126
* ECS158.cbl
  6368            (CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (SA)
  6369           ADD AGT-COMM TO EX-OVR-COMM (YR).
  6370
  6371     GO TO 0350-CALC-LIFE-COMMISSIONS.
  6372
  6373 0360-CALC-LF-REFUND.
  6374
  6375     IF LF-CAN GREATER THAN BEGIN-DT (YR) AND
  6376        LF-CAN NOT GREATER THAN END-DT (YR)
  6377        MOVE CR-LFRFND     TO EX-CNC-AMT (YR)
  6378     ELSE
  6379        GO TO 0380-FINISH-LIFE-YEAR.
  6380
  6381     MOVE +0 TO SA.
  6382
  6383 0370-CALC-LIFE-REF-COMM.
  6384
  6385     ADD +1 TO SA.
  6386
  6387     IF SA GREATER THAN +10
  6388        GO TO 0380-FINISH-LIFE-YEAR.
  6389
  6390     IF CR-COM-AGT (SA) = ZEROS OR SPACES
  6391         GO TO 0370-CALC-LIFE-REF-COMM.
  6392
  6393     IF CR-AGT-TYPE (SA) = 'C' OR 'D' OR 'F' OR 'S'
  6394        COMPUTE AGT-COMM =
  6395         -1 * CR-LFRFND * CR-LCOM-L (SA)
  6396        ADD AGT-COMM TO EX-AGT-COMM (YR)
  6397     ELSE
  6398        IF CR-AGT-TYPE (SA) = 'O' OR 'P' OR 'G' OR 'B'
  6399           COMPUTE AGT-COMM =
  6400            -1 * CR-LFRFND * CR-LCOM-L (SA)
  6401           ADD AGT-COMM TO EX-OVR-COMM (YR).
  6402
  6403     GO TO 0370-CALC-LIFE-REF-COMM.
  6404
  6405 0380-FINISH-LIFE-YEAR.
  6406
  6407     ADD +1 TO YR.
  6408     GO TO 0320-CHECK-LF-PERIOD-INFORCE.
  6409
  6410 0390-END-PROCESS-LIFE.
  6411
  6412     IF CR-ENTRY-STATUS = '5' OR 'M'
  6413        GO TO 0400-RELEASE-LIFE-RECORD.
  6414
  6415     IF CR-LF-DEV-PCT NOT NUMERIC
  6416        MOVE +0       TO CR-LF-DEV-PCT.
  6417
  6418     IF DTE-CLIENT = 'CID' OR 'AHL'
  6419        GO TO 0400-RELEASE-LIFE-RECORD
  6420     END-IF
  6421
  6422     IF (CR-STATE = STATE-IL OR STATE-GA OR
  6423                    STATE-NC OR STATE-UT OR STATE-TX OR
  6424                    STATE-IA OR STATE-NE OR STATE-NV OR
  6425                    STATE-OH OR STATE-OR OR STATE-WI)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 127
* ECS158.cbl
  6426                AND
  6427         (RR (1) GREATER THAN +0 OR
  6428          RR (2) GREATER THAN +0 OR
  6429          RR (3) GREATER THAN +0)
  6430        NEXT SENTENCE
  6431     ELSE
  6432     IF DTE-CLIENT  =  'CRI' OR 'CVL' OR 'CID'
  6433         NEXT SENTENCE
  6434     ELSE
  6435         IF (RR (1) GREATER THAN +0 OR
  6436             RR (2) GREATER THAN +0 OR
  6437             RR (3) GREATER THAN +0)
  6438                   AND
  6439            ((CR-LF-DEV-CODE NOT =
  6440                   STATE-PRIM-FAC-DEV (CLAS-INDEXS))
  6441                   OR
  6442            (CR-LF-DEV-PCT NOT = +0 AND +1.0))
  6443             NEXT SENTENCE
  6444         ELSE
  6445             GO TO 0400-RELEASE-LIFE-RECORD.
  6446
  6447*    MOVE EP-DT                      TO DC-GREG-DATE-CYMD.
  6448*    MOVE 'L'                        TO DC-OPTION-CODE.
  6449*    PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6450*    MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  6451     MOVE END-DT (1)                 TO CP-CERT-EFF-DT
  6452     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  6453     MOVE SPACES                     TO CP-ACCT-FLD-5.
  6454     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  6455     MOVE CR-AGE                     TO CP-ISSUE-AGE.
  6456     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM.
  6457     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS.
  6458     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
  6459                                        CP-LOAN-TERM.
  6460     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
  6461                                        CP-RATING-BENEFIT-AMT.
  6462     MOVE CR-APR                     TO CP-LOAN-APR.
  6463     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
  6464     MOVE LF-EARN-CODE               TO CP-EARNING-METHOD.
  6465     MOVE '3'                        TO CP-PROCESS-TYPE.
  6466     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  6467     IF CR-RATING-CLASS NOT = SPACES AND ZEROS
  6468        MOVE CR-RATING-CLASS         TO CP-CLASS-CODE
  6469     ELSE
  6470        MOVE AM-CAL-TABLE            TO CP-CLASS-CODE.
  6471
  6472     IF DTE-CLIENT  =  'CRI'
  6473         MOVE WK-LF-DEV-CODE         TO  CP-DEVIATION-CODE
  6474     ELSE
  6475         MOVE STATE-PRIM-FAC-DEV (CLAS-INDEXS)
  6476                                     TO  CP-DEVIATION-CODE.
  6477
  6478     MOVE +0                         TO CP-RATE-DEV-PCT.
  6479     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
  6480     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
  6481     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
  6482     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  6483     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 128
* ECS158.cbl
  6484     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
  6485
  6486     IF CP-STATE-STD-ABBRV = 'OR'
  6487         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
  6488
  6489     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
  6490        COMPUTE CP-ORIGINAL-BENEFIT =
  6491         (CR-LFAMT - CR-LFPRM).
  6492
  6493     IF CP-TRUNCATED-LIFE
  6494        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM.
  6495
  6496     IF CP-TERM-IS-DAYS
  6497        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
  6498     ELSE
  6499        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS.
  6500
  6501     PERFORM 6130-CALL-RATING-ROUTINE THRU 6140-RATE-EXIT.
  6502     ADD 1 TO WS-LF-RATE-ATTEMPT.
  6503
  6504     IF DTE-CLIENT = 'CID' OR 'AHL'
  6505        IF CR-LFPRM-CALC NOT NUMERIC
  6506           MOVE +0               TO CR-LFPRM-CALC
  6507        END-IF
  6508        IF CR-LFPRM-CALC = ZEROS
  6509           MOVE CR-LFPRM         TO CR-LFPRM-CALC
  6510        END-IF
  6511     END-IF
  6512
  6513     IF NOT CP-ERROR-OCCURED
  6514        IF (CP-CALC-PREMIUM NOT = +0) AND
  6515           (CR-LFPRM-CALC NOT = +0)
  6516           IF DTE-CLIENT = 'CID'
  6517              COMPUTE WS-DIFF = (CP-CALC-PREMIUM -
  6518                 CR-LFPRM-CALC) / CR-LFPRM-CALC
  6519              IF WS-DIFF < 0
  6520                 COMPUTE WS-DIFF = WS-DIFF * -1
  6521              END-IF
  6522              IF WS-DIFF > 0.02
  6523                 MOVE CP-CALC-PREMIUM TO EX-PRIM-FAC-PREM
  6524                                    WS-HOLD-LF-PRIM-FAC
  6525              END-IF
  6526           ELSE
  6527              MOVE CP-CALC-PREMIUM TO EX-PRIM-FAC-PREM
  6528                                    WS-HOLD-LF-PRIM-FAC
  6529           END-IF
  6530        END-IF
  6531     ELSE
  6532        ADD 1 TO WS-LF-RATE-ERROR
  6533     END-IF
  6534
  6535     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L'
  6536        GO TO 0400-RELEASE-LIFE-RECORD.
  6537
  6538     IF CR-LF-DEV-PCT = +0
  6539        GO TO 0400-RELEASE-LIFE-RECORD.
  6540
  6541     MOVE 'L'          TO CP-BENEFIT-TYPE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 129
* ECS158.cbl
  6542     MOVE '2'          TO CP-EARNING-METHOD.
  6543     MOVE SPACES       TO CP-SPECIAL-CALC-CD.
  6544     MOVE 'LEV'        TO CP-DEVIATION-CODE.
  6545     MOVE CR-LFTYP     TO CP-BENEFIT-CD.
  6546     MOVE CR-LFAMT-ALT TO CP-ORIGINAL-BENEFIT
  6547                          CP-RATING-BENEFIT-AMT.
  6548
  6549     IF CP-STATE-STD-ABBRV = 'OR'
  6550         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
  6551
  6552     MOVE CR-LFPRM-ALT TO CP-ORIGINAL-PREMIUM.
  6553     MOVE +0           TO CP-CRITICAL-MONTHS
  6554                          CP-RATE-DEV-PCT.
  6555
  6556     MOVE CR-LF-TERM   TO CP-ORIGINAL-TERM
  6557                          CP-REMAINING-TERM
  6558                          CP-LOAN-TERM.
  6559
  6560     IF CLAS-I-BAL (CLAS-INDEXL) = 'L'
  6561        ADD +1 TO CP-ORIGINAL-TERM
  6562                  CP-REMAINING-TERM
  6563                  CP-LOAN-TERM.
  6564
  6565     PERFORM 6130-CALL-RATING-ROUTINE THRU 6140-RATE-EXIT.
  6566     ADD 1 TO WS-LF-RATE-ATTEMPT.
  6567
  6568     IF NOT CP-ERROR-OCCURED
  6569        IF CP-CALC-PREMIUM NOT = +0
  6570           MOVE CP-CALC-PREMIUM TO EX-PRIM-FAC-PREM-ALT
  6571        ELSE
  6572           NEXT SENTENCE
  6573     ELSE
  6574        ADD 1 TO WS-LF-RATE-ERROR.
  6575
  6576 0400-RELEASE-LIFE-RECORD.
  6577
  6578     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  6579     MOVE 'L'                        TO DC-OPTION-CODE.
  6580     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6581     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  6582
  6583     PERFORM 0410-BUILD-LIFE-CLAIMS
  6584         VARYING YR FROM +1 BY +1
  6585         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  6586
  6587     GO TO 0420-END-LIFE-CLAIMS.
  6588
  6589 0410-BUILD-LIFE-CLAIMS.
  6590
  6591     IF CERT-AND-CLAIM
  6592        MOVE WS-CLAIM-AMT (1 1 YR) TO EX-CLAIM-AMT (YR)
  6593        MOVE WS-INC-CNT   (1 1 YR) TO EX-INC-CNT   (YR)
  6594        MOVE WS-PD-CNT    (1 1 YR) TO EX-PD-CNT    (YR).
  6595
  6596 0420-END-LIFE-CLAIMS.
  6597
  6598     IF CR-ENTRY-STATUS = '5' OR 'M'
  6599        GO TO 0460-END-LF-RESERVES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 130
* ECS158.cbl
  6600
  6601     MOVE EX-PREM       TO WRK-C.
  6602     MOVE EX-PREM-ALT   TO WRK-ALT.
  6603
  6604     PERFORM 0480-CALC-LIFE-UNEARN THRU 0540-LIFE-UNEARN-EXIT
  6605         VARYING YR FROM +1 BY +1
  6606         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  6607
  6608     PERFORM 0430-BUILD-LF-DEV-RESERVES
  6609         VARYING YR FROM +1 BY +1
  6610         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  6611
  6612     GO TO 0440-CALC-LF-PRIM-FAC.
  6613
  6614 0430-BUILD-LF-DEV-RESERVES.
  6615
  6616     IF (DTE-CLIENT = 'CID') AND
  6617        (STATE-ABBR (CLAS-INDEXS) = 'WY') AND
  6618        (CLAS-I-EP (CLAS-INDEXL) = 'T')
  6619           COMPUTE EX-BEG-ST-RES (YR) =
  6620             WS-RED-LF-BEGIN-RES (YR) +
  6621             WS-RED-LF-BEGIN-ALT (YR)
  6622           COMPUTE EX-END-ST-RES (YR) =
  6623             WS-RED-LF-END-RES (YR) +
  6624             WS-RED-LF-END-ALT (YR)
  6625           MOVE EX-BEG-ST-RES (YR) TO
  6626                EX-PRI-BEG-ST-RES (YR)
  6627           MOVE EX-END-ST-RES (YR) TO
  6628                EX-PRI-END-ST-RES (YR)
  6629     ELSE
  6630     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  6631        COMPUTE EX-BEG-ST-RES (YR) =
  6632          WS-LEV-LF-BEGIN-RES (YR) +
  6633          WS-LEV-LF-BEGIN-ALT (YR)
  6634        COMPUTE EX-END-ST-RES (YR) =
  6635          WS-LEV-LF-END-RES (YR) +
  6636          WS-LEV-LF-END-ALT (YR)
  6637          MOVE EX-BEG-ST-RES (YR) TO
  6638               EX-PRI-BEG-ST-RES (YR)
  6639          MOVE EX-END-ST-RES (YR) TO
  6640               EX-PRI-END-ST-RES (YR)
  6641     ELSE
  6642     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
  6643        COMPUTE EX-BEG-ST-RES (YR) =
  6644          WS-RED-LF-BEGIN-RES (YR) +
  6645          WS-RED-LF-BEGIN-ALT (YR)
  6646        COMPUTE EX-END-ST-RES (YR) =
  6647          WS-RED-LF-END-RES (YR) +
  6648          WS-RED-LF-END-ALT (YR)
  6649          MOVE EX-BEG-ST-RES (YR) TO
  6650               EX-PRI-BEG-ST-RES (YR)
  6651          MOVE EX-END-ST-RES (YR) TO
  6652               EX-PRI-END-ST-RES (YR)
  6653     ELSE
  6654     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')
  6655        COMPUTE EX-BEG-ST-RES (YR) =
  6656          WS-RED-LF-BEGIN-RES (YR) +
  6657          WS-LEV-LF-BEGIN-ALT (YR)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 131
* ECS158.cbl
  6658        COMPUTE EX-END-ST-RES (YR) =
  6659          WS-RED-LF-END-RES (YR) +
  6660          WS-LEV-LF-END-ALT (YR)
  6661          MOVE EX-BEG-ST-RES (YR) TO
  6662               EX-PRI-BEG-ST-RES (YR)
  6663          MOVE EX-END-ST-RES (YR) TO
  6664               EX-PRI-END-ST-RES (YR)
  6665     ELSE
  6666     IF (STATE-ABBR (CLAS-INDEXS) = 'OH')  AND
  6667        (EX-CAL-TABLE NOT = 'L ') AND
  6668        (EX-TERM GREATER THAN +60)  AND
  6669        (EX-APR GREATER THAN +0)  AND
  6670        (EX-EFF-DATE  GREATER THAN 19831031 )
  6671**      (EX-EFF-DATE  GREATER THAN 199831031 )
  6672           COMPUTE EX-BEG-ST-RES (YR) =
  6673             WS-RED-LF-BEGIN-RES (YR) +
  6674             WS-RED-LF-BEGIN-ALT (YR)
  6675           COMPUTE EX-END-ST-RES (YR) =
  6676             WS-RED-LF-END-RES (YR) +
  6677             WS-RED-LF-END-ALT (YR)
  6678           MOVE EX-BEG-ST-RES (YR) TO
  6679                EX-PRI-BEG-ST-RES (YR)
  6680           MOVE EX-END-ST-RES (YR) TO
  6681                EX-PRI-END-ST-RES (YR)
  6682     ELSE
  6683     IF (CLAS-I-EP (CLAS-INDEXL) = 'N' OR 'T') AND
  6684         (DTE-CLIENT NOT = 'MON')
  6685           COMPUTE EX-BEG-ST-RES (YR) =
  6686             WS-RED-LF-BEGIN-RES (YR) +
  6687             WS-RED-LF-BEGIN-ALT (YR)
  6688           COMPUTE EX-END-ST-RES (YR) =
  6689             WS-RED-LF-END-RES (YR) +
  6690             WS-RED-LF-END-ALT (YR)
  6691           MOVE EX-BEG-ST-RES (YR) TO
  6692                EX-PRI-BEG-ST-RES (YR)
  6693           MOVE EX-END-ST-RES (YR) TO
  6694                EX-PRI-END-ST-RES (YR)
  6695     ELSE
  6696     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  6697        COMPUTE EX-BEG-ST-RES (YR) =
  6698          WS-LEV-LF-BEGIN-RES (YR) +
  6699          WS-LEV-LF-BEGIN-ALT (YR)
  6700        COMPUTE EX-END-ST-RES (YR) =
  6701          WS-LEV-LF-END-RES (YR) +
  6702          WS-LEV-LF-END-ALT (YR)
  6703        MOVE EX-BEG-ST-RES (YR) TO
  6704             EX-PRI-BEG-ST-RES (YR)
  6705        MOVE EX-END-ST-RES (YR) TO
  6706             EX-PRI-END-ST-RES (YR)
  6707     ELSE
  6708     IF (DTE-CLIENT = 'MON') AND
  6709        (CLAS-I-EP (CLAS-INDEXL) = '2')
  6710          COMPUTE EX-BEG-ST-RES (YR) =
  6711            WS-LEV-LF-BEGIN-RES (YR) +
  6712            WS-LEV-LF-BEGIN-ALT (YR)
  6713          COMPUTE EX-END-ST-RES (YR) =
  6714            WS-LEV-LF-END-RES (YR) +
  6715            WS-LEV-LF-END-ALT (YR)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 132
* ECS158.cbl
  6716          MOVE EX-BEG-ST-RES (YR) TO
  6717               EX-PRI-BEG-ST-RES (YR)
  6718          MOVE EX-END-ST-RES (YR) TO
  6719               EX-PRI-END-ST-RES (YR)
  6720     ELSE
  6721        COMPUTE EX-BEG-ST-RES (YR) =
  6722          WS-RED-LF-BEGIN-RES (YR) +
  6723          WS-RED-LF-BEGIN-ALT (YR)
  6724        COMPUTE EX-END-ST-RES (YR) =
  6725          WS-RED-LF-END-RES (YR) +
  6726          WS-RED-LF-END-ALT (YR)
  6727          MOVE EX-BEG-ST-RES (YR) TO
  6728               EX-PRI-BEG-ST-RES (YR)
  6729          MOVE EX-END-ST-RES (YR) TO
  6730               EX-PRI-END-ST-RES (YR).
  6731
  6732     IF CLAS-I-EP (CLAS-INDEXL) = 'N' OR 'T'
  6733        MOVE WS-LF-RED-MEAN-INFORCE (YR) TO
  6734             EX-MEAN-INFORCE (YR)
  6735     ELSE
  6736     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  6737        MOVE WS-LF-LEV-MEAN-INFORCE (YR) TO
  6738             EX-MEAN-INFORCE (YR)
  6739     ELSE
  6740        MOVE WS-LF-RED-MEAN-INFORCE (YR) TO
  6741             EX-MEAN-INFORCE (YR).
  6742
  6743 0440-CALC-LF-PRIM-FAC.
  6744
  6745     IF EX-PREM NOT = EX-PRIM-FAC-PREM
  6746        MOVE EX-PRIM-FAC-PREM     TO WRK-C
  6747        MOVE EX-PRIM-FAC-PREM-ALT TO WRK-ALT
  6748        PERFORM 0480-CALC-LIFE-UNEARN THRU
  6749                                      0530-CALC-UNEARN-FINISH
  6750            VARYING YR FROM +1 BY +1
  6751            UNTIL YR GREATER THAN NUMBER-OF-PERIODS
  6752        PERFORM 0450-BUILD-LF-PRI-RESERVES
  6753            VARYING YR FROM +1 BY +1
  6754            UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  6755
  6756     GO TO 0460-END-LF-RESERVES.
  6757
  6758 0450-BUILD-LF-PRI-RESERVES.
  6759
  6760     IF (DTE-CLIENT = 'CID') AND
  6761        (STATE-ABBR (CLAS-INDEXS) = 'WY') AND
  6762        (CLAS-I-EP (CLAS-INDEXL) = 'T')
  6763          COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6764            WS-RED-LF-BEGIN-RES (YR) +
  6765            WS-RED-LF-BEGIN-ALT (YR)
  6766          COMPUTE EX-PRI-END-ST-RES (YR) =
  6767            WS-RED-LF-END-RES (YR) +
  6768            WS-RED-LF-END-ALT (YR)
  6769     ELSE
  6770     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  6771        COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6772          WS-LEV-LF-BEGIN-RES (YR) +
  6773          WS-LEV-LF-BEGIN-ALT (YR)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 133
* ECS158.cbl
  6774        COMPUTE EX-PRI-END-ST-RES (YR) =
  6775          WS-LEV-LF-END-RES (YR) +
  6776          WS-LEV-LF-END-ALT (YR)
  6777     ELSE
  6778     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
  6779        COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6780          WS-RED-LF-BEGIN-RES (YR) +
  6781          WS-RED-LF-BEGIN-ALT (YR)
  6782        COMPUTE EX-PRI-END-ST-RES (YR) =
  6783          WS-RED-LF-END-RES (YR) +
  6784          WS-RED-LF-END-ALT (YR)
  6785     ELSE
  6786     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  6787        COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6788          WS-RED-LF-BEGIN-RES (YR) +
  6789          WS-LEV-LF-BEGIN-ALT (YR)
  6790        COMPUTE EX-PRI-END-ST-RES (YR) =
  6791          WS-RED-LF-END-RES (YR) +
  6792          WS-LEV-LF-END-ALT (YR)
  6793     ELSE
  6794     IF (STATE-ABBR (CLAS-INDEXS) = 'OH')  AND
  6795        (EX-CAL-TABLE NOT = 'L ') AND
  6796        (EX-TERM GREATER THAN +60)  AND
  6797        (EX-APR GREATER THAN +0)  AND
  6798        (EX-EFF-DATE  GREATER THAN  19831031 )
  6799          COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6800            WS-RED-LF-BEGIN-RES (YR) +
  6801            WS-RED-LF-BEGIN-ALT (YR)
  6802          COMPUTE EX-PRI-END-ST-RES (YR) =
  6803            WS-RED-LF-END-RES (YR) +
  6804            WS-RED-LF-END-ALT (YR)
  6805     ELSE
  6806     IF (CLAS-I-EP (CLAS-INDEXL) = 'N' OR 'T') AND
  6807        (DTE-CLIENT NOT = 'MON')
  6808          COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6809            WS-RED-LF-BEGIN-RES (YR) +
  6810            WS-RED-LF-BEGIN-ALT (YR)
  6811          COMPUTE EX-PRI-END-ST-RES (YR) =
  6812            WS-RED-LF-END-RES (YR) +
  6813            WS-RED-LF-END-ALT (YR)
  6814     ELSE
  6815     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  6816        COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6817          WS-LEV-LF-BEGIN-RES (YR) +
  6818          WS-LEV-LF-BEGIN-ALT (YR)
  6819        COMPUTE EX-PRI-END-ST-RES (YR) =
  6820          WS-LEV-LF-END-RES (YR) +
  6821          WS-LEV-LF-END-ALT (YR)
  6822     ELSE
  6823     IF (CLAS-I-EP (CLAS-INDEXL) = '2') AND
  6824        (DTE-CLIENT = 'MON')
  6825          COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6826            WS-LEV-LF-BEGIN-RES (YR) +
  6827            WS-LEV-LF-BEGIN-ALT (YR)
  6828          COMPUTE EX-PRI-END-ST-RES (YR) =
  6829            WS-LEV-LF-END-RES (YR) +
  6830            WS-LEV-LF-END-ALT (YR)
  6831     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 134
* ECS158.cbl
  6832        COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6833          WS-RED-LF-BEGIN-RES (YR) +
  6834          WS-RED-LF-BEGIN-ALT (YR)
  6835        COMPUTE EX-PRI-END-ST-RES (YR) =
  6836          WS-RED-LF-END-RES (YR) +
  6837          WS-RED-LF-END-ALT (YR).
  6838
  6839 0460-END-LF-RESERVES.
  6840
  6841     IF DEBUG-LF-STATUTORY
  6842         GO TO 0460-CONTINUE.
  6843
  6844     IF DTE-PGM-OPT NOT = '3' AND '4'
  6845        GO TO 0470-BYPASS-LF-DETAIL.
  6846
  6847     IF M5 (1) = +0
  6848        GO TO 0470-BYPASS-LF-DETAIL.
  6849
  6850 0460-CONTINUE.
  6851
  6852     MOVE EX-CARRIER           TO D-CARR.
  6853     MOVE EX-GROUPING          TO D-GROUP.
  6854     MOVE EX-STATE             TO D-STATE.
  6855     MOVE EX-ACCOUNT           TO D-ACCOUNT.
  6856     MOVE CR-CERT-NO           TO D-CERT-NO.
  6857     MOVE 'L'                  TO DC-OPTION-CODE.
  6858     MOVE EX-EFF-DATE          TO DC-GREG-DATE-CYMD.
  6859     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6860     MOVE DC-GREG-DATE-1-EDIT  TO D-EFF-DATE.
  6861     MOVE EX-PREM              TO D-PREM.
  6862     MOVE EX-PRIM-FAC-PREM     TO D-PRI-PREM
  6863     MOVE EX-TERM              TO D-TERM.
  6864     MOVE M2 (1)               TO D-REM-TERM.
  6865     MOVE EX-END-ST-RES (1)    TO D-UNEARN.
  6866     MOVE EX-INITIAL-AMT       TO D-BENEFIT.
  6867     MOVE 'L'                  TO D-L-A.
  6868     MOVE CLAS-I-AB10 (CLAS-INDEXL) TO D-BEN-DESC.
  6869
  6870     PERFORM 1600-PRINT-A-LINE.
  6871
  6872     IF DEBUG-LF-STATUTORY
  6873         IF EX-END-ST-RES (1) NOT = ZEROS
  6874             ADD +1                TO WS-S-CNT
  6875             ADD EX-END-ST-RES (1) TO WS-S-STATUTORY
  6876             DISPLAY ' CNT ', WS-S-CNT
  6877                     ' TOT ', WS-S-STATUTORY
  6878                     ' RESV ', EX-END-ST-RES (1)
  6879                     ' CERT ', CR-FULL-CONTROL.
  6880
  6881 0470-BYPASS-LF-DETAIL.
  6882
  6883     MOVE CALL-EXTRACT TO HOLD-LIFE-RECORD.
  6884
  6885     IF CR-ENTRY-STATUS NOT = '9'
  6886        PERFORM 1500-RELEASE THRU 1540-RELEASE-EXIT.
  6887
  6888     GO TO 1000-PROCESS-AH.
  6889
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 135
* ECS158.cbl
  6890 0480-CALC-LIFE-UNEARN.
  6891
  6892     MOVE +0     TO WS-LEV-LF-BEGIN-RES (YR)
  6893                    WS-LEV-LF-BEGIN-ALT (YR)
  6894                    WS-LEV-LF-END-RES (YR)
  6895                    WS-LEV-LF-END-ALT (YR)
  6896                    WS-RED-LF-BEGIN-RES (YR)
  6897                    WS-RED-LF-BEGIN-ALT (YR)
  6898                    WS-RED-LF-END-RES (YR)
  6899                    WS-RED-LF-END-ALT (YR)
  6900                    WRK-B  MEAN-CAL.
  6901
  6902 0490-CALC-LEVEL-BEG.
  6903
  6904     MOVE +0        TO WRK-B   WRK-H.
  6905
  6906     MOVE WS-LF-BEG-REM-TRM1 (YR) TO M4.
  6907
  6908     IF M4 NOT POSITIVE
  6909         IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6910            (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L') AND
  6911            (M4 = ZEROS) AND (M6 (YR) GREATER THAN +0)
  6912              NEXT SENTENCE
  6913         ELSE
  6914              GO TO 0500-CALC-LEVEL-END.
  6915
  6916     PERFORM 0550-CALC-LEVEL-UNEARN THRU 0590-LEVEL-EXIT.
  6917
  6918     MOVE WRK-B  TO WS-LEV-LF-BEGIN-RES (YR).
  6919     MOVE WRK-H  TO WS-LEV-LF-BEGIN-ALT (YR).
  6920
  6921 0500-CALC-LEVEL-END.
  6922
  6923     MOVE +0        TO WRK-B   WRK-H.
  6924
  6925     MOVE WS-LF-END-REM-TRM1 (YR) TO M4.
  6926
  6927     IF M4 NOT POSITIVE
  6928         IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6929            (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L') AND
  6930            (M4 = ZEROS) AND (M5 (YR) GREATER THAN +0)
  6931              NEXT SENTENCE
  6932         ELSE
  6933              GO TO 0510-CALC-REDUCE-BEG.
  6934
  6935     PERFORM 0550-CALC-LEVEL-UNEARN THRU 0590-LEVEL-EXIT.
  6936
  6937     MOVE WRK-B  TO WS-LEV-LF-END-RES (YR).
  6938     MOVE WRK-H  TO WS-LEV-LF-END-ALT (YR).
  6939
  6940 0510-CALC-REDUCE-BEG.
  6941
  6942     MOVE +0   TO WRK-B   WRK-H.
  6943
  6944     IF ENTRY-DT GREATER  BEGIN-DT (YR)
  6945        GO TO 0520-CALC-REDUCE-END.
  6946
  6947     MOVE WS-LF-BEG-REM-TRM1 (YR) TO M4.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 136
* ECS158.cbl
  6948     MOVE M6 (YR)                TO M9
  6949
  6950     IF M4 NOT POSITIVE
  6951         IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6952            (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L') AND
  6953            (M4 = ZEROS) AND (M6 (YR) GREATER THAN +0)
  6954              NEXT SENTENCE
  6955         ELSE
  6956              GO TO 0520-CALC-REDUCE-END.
  6957
  6958     PERFORM 0600-CALC-REDUCE-UNEARN THRU 0640-REDUCE-EXIT.
  6959
  6960     MOVE WRK-B  TO WS-RED-LF-BEGIN-RES (YR).
  6961     MOVE WRK-H  TO WS-RED-LF-BEGIN-ALT (YR).
  6962
  6963 0520-CALC-REDUCE-END.
  6964
  6965     MOVE +0   TO WRK-B   WRK-H.
  6966
  6967     IF ENTRY-DT GREATER THAN END-DT (YR)
  6968        GO TO 0530-CALC-UNEARN-FINISH.
  6969
  6970     MOVE WS-LF-END-REM-TRM1 (YR) TO M4.
  6971     MOVE M5 (YR)                TO M9
  6972
  6973     IF M4 NOT POSITIVE
  6974         IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6975            (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L') AND
  6976            (M4 = ZEROS) AND (M5 (YR) GREATER THAN +0)
  6977              NEXT SENTENCE
  6978         ELSE
  6979              GO TO 0530-CALC-UNEARN-FINISH.
  6980
  6981     PERFORM 0600-CALC-REDUCE-UNEARN THRU 0640-REDUCE-EXIT.
  6982
  6983     MOVE WRK-B  TO WS-RED-LF-END-RES (YR).
  6984     MOVE WRK-H  TO WS-RED-LF-END-ALT (YR).
  6985
  6986 0530-CALC-UNEARN-FINISH.
  6987
  6988 0535-DUMMY-PARA.
  6989
  6990     IF (M5 (YR) NOT = +0) OR
  6991        (M6 (YR) NOT = +0)
  6992        PERFORM 0710-LEVEL-MEAN THRU 0730-L-EXIT
  6993        PERFORM 0740-REDUCING-MEAN THRU  0770-R-EXIT.
  6994
  6995 0540-LIFE-UNEARN-EXIT.
  6996     EXIT.
  6997
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 137
* ECS158.cbl
  6999 0550-CALC-LEVEL-UNEARN.
  7000
  7001 0560-CALC-PRO-FACTOR.
  7002
  7003     IF DTE-CLIENT = 'WSL' OR 'FLI' OR 'FLU' OR
  7004                     'MIC' OR 'MCC'
  7005        COMPUTE WRK-D ROUNDED = (M4 - .5) / EX-TERM
  7006     ELSE
  7007        COMPUTE WRK-D ROUNDED = M4 / EX-TERM.
  7008
  7009     IF WRK-D GREATER +1.000
  7010        MOVE +1.000 TO WRK-D.
  7011
  7012 0570-END-CALC-PRO-FACTOR.
  7013
  7014     COMPUTE WRK-B ROUNDED = WRK-D * WRK-C.
  7015
  7016     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  7017        GO TO 0590-LEVEL-EXIT.
  7018
  7019     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L'
  7020        GO TO 0580-COMPUTE-LEV-UNEARN.
  7021
  7022     IF CLAS-I-BAL (CLAS-INDEXL) = 'L'
  7023        GO TO 0580-COMPUTE-LEV-UNEARN.
  7024
  7025     IF DTE-CLIENT = 'WSL' OR 'FLI' OR 'FLU' OR
  7026                     'MIC' OR 'MCC'
  7027        COMPUTE WRK-D ROUNDED = (M4 + .5) / (EX-TERM + 1)
  7028     ELSE
  7029        COMPUTE WRK-D ROUNDED = (M4 + 1) / (EX-TERM + 1).
  7030
  7031 0580-COMPUTE-LEV-UNEARN.
  7032
  7033     COMPUTE WRK-H ROUNDED = WRK-D * WRK-ALT.
  7034
  7035 0590-LEVEL-EXIT.
  7036     EXIT.
  7037
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 138
* ECS158.cbl
  7039 0600-CALC-REDUCE-UNEARN.
  7040
  7041 0610-CALC-R78-FACTOR.
  7042
  7043     COMPUTE WRK-F = M4 * (M4 + +1).
  7044
  7045     IF DTE-R78 = '1' OR DTE-CLIENT = 'FLI'
  7046         COMPUTE WRK-F = M4 * M4.
  7047
  7048     IF DTE-CLIENT = 'MPP'
  7049        COMPUTE WRK-F = (EX-TERM - M4) *
  7050                       ((EX-TERM - M4) + +1).
  7051
  7052     COMPUTE WRK-G = EX-TERM * (EX-TERM + +1).
  7053     COMPUTE WRK-E ROUNDED = WRK-F / WRK-G.
  7054
  7055     IF WRK-E GREATER +1.000
  7056         MOVE +1.000 TO WRK-E.
  7057
  7058 0620-CALC-R78-FACTOR-END.
  7059
  7060     COMPUTE WRK-B ROUNDED = WRK-E * WRK-C.
  7061
  7062     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  7063        GO TO 0640-REDUCE-EXIT.
  7064
  7065     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
  7066         MOVE 'R' TO CLAS-I-EP (CLAS-INDEXL).
  7067
  7068     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  7069        IF (DTE-CLIENT = 'CID')
  7070           AND (STATE-ABBR (CLAS-INDEXS) = 'TX' OR 'VA')
  7071           CONTINUE
  7072        ELSE
  7073           PERFORM 0650-TEXAS-REG-RED
  7074                                 THRU 0660-TEXAS-REG-RED-X
  7075           GO TO 0630-COMPUTE-RED-UNEARN
  7076        END-IF
  7077     END-IF
  7078
  7079     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  7080        PERFORM 0690-BALLOON-RED THRU 0700-BALLOON-RED-EXIT
  7081        COMPUTE WRK-H ROUNDED = WRK-E * WRK-ALT
  7082        GO TO 0640-REDUCE-EXIT.
  7083
  7084     if dte-client = 'AHL'
  7085        go to 0640-reduce-exit
  7086     end-if
  7087
  7088     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
  7089         GO TO 0640-REDUCE-EXIT.
  7090
  7091     IF (DTE-CLIENT = 'NCL') AND
  7092        (CLAS-I-EP (CLAS-INDEXL) = 'N') AND
  7093        (EX-EFF-DATE  LESS THAN  19910101)
  7094         GO TO 0630-COMPUTE-RED-UNEARN.
  7095
  7096     IF (DTE-CLIENT = 'CID') AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 139
* ECS158.cbl
  7097        ((STATE-ABBR (CLAS-INDEXS) = 'TX' OR 'VA')
  7098*       (EX-EFF-DATE > 19911231)
  7099              OR
  7100        ((STATE-ABBR (CLAS-INDEXS) = 'MN')
  7101         AND (EX-EFF-DATE > 20091231)))
  7102        PERFORM 0800-RULE-ANTIC  THRU 0800-EXIT
  7103        GO TO 0640-REDUCE-EXIT
  7104     END-IF
  7105
  7106     IF (CLAS-I-EP (CLAS-INDEXL) = 'N') AND
  7107        (DTE-CLIENT NOT = 'MON') AND
  7108        (CR-APR NOT = +0)
  7109         PERFORM 0670-NET-PAY-RED THRU 0680-NET-PAY-RED-X
  7110         GO TO 0630-COMPUTE-RED-UNEARN.
  7111
  7112*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  7113     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  7114        (EX-CAL-TABLE NOT = 'L ')
  7115         IF (EX-TERM GREATER THAN +60)  AND
  7116            (EX-APR GREATER THAN +0)  AND
  7117            (EX-EFF-DATE  GREATER THAN  19831031)
  7118             PERFORM 0670-NET-PAY-RED THRU 0680-NET-PAY-RED-X
  7119             GO TO 0630-COMPUTE-RED-UNEARN.
  7120
  7121     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  7122         IF (EX-TERM GREATER THAN +61)  AND
  7123            (EX-APR GREATER THAN ZERO)  AND
  7124            (EX-EFF-DATE  GREATER THAN  19830318)
  7125             PERFORM 0670-NET-PAY-RED THRU 0680-NET-PAY-RED-X
  7126             GO TO 0630-COMPUTE-RED-UNEARN.
  7127
  7128     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  7129         IF (EX-TERM GREATER THAN +62)  AND
  7130            (EX-APR GREATER THAN ZERO)  AND
  7131            (EX-EFF-DATE  GREATER THAN  19810831) AND
  7132            (EX-EFF-DATE  LESS THAN  19830901)
  7133             PERFORM 0670-NET-PAY-RED THRU 0680-NET-PAY-RED-X
  7134             GO TO 0630-COMPUTE-RED-UNEARN.
  7135
  7136     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  7137         IF (EX-TERM GREATER THAN +60)  AND
  7138            (EX-APR GREATER THAN ZERO)  AND
  7139            (EX-EFF-DATE  GREATER THAN  19831231)
  7140             PERFORM 0670-NET-PAY-RED THRU 0680-NET-PAY-RED-X
  7141             GO TO 0630-COMPUTE-RED-UNEARN.
  7142
  7143 0630-COMPUTE-RED-UNEARN.
  7144     COMPUTE WRK-B ROUNDED = WRK-E * WRK-C.
  7145
  7146 0640-REDUCE-EXIT.
  7147     EXIT.
  7148
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 140
* ECS158.cbl
  7150 0650-TEXAS-REG-RED.
  7151
  7152     MOVE +0            TO WRK-B.
  7153     IF M4 NOT POSITIVE
  7154         GO TO 0660-TEXAS-REG-RED-X.
  7155
  7156     IF M4 NOT LESS EX-TERM
  7157         MOVE WRK-C     TO WRK-B
  7158         MOVE +1        TO WRK-E
  7159         GO TO 0660-TEXAS-REG-RED-X.
  7160
  7161     COMPUTE TEX-FACT-4 =
  7162         (EX-TERM * EX-TERM) + (EX-PMT-FREQ * EX-TERM).
  7163     DIVIDE M4 BY EX-PMT-FREQ
  7164         GIVING TEX-FACT-5
  7165         REMAINDER TEX-FACT-6.
  7166     COMPUTE TEX-FACT-5 = TEX-FACT-5 * EX-PMT-FREQ.
  7167     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  7168         (TEX-FACT-5 * EX-PMT-FREQ) +
  7169         (2 * (TEX-FACT-6 * (TEX-FACT-5 + EX-PMT-FREQ))).
  7170     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  7171     MOVE TEX-FACT-8   TO WRK-E.
  7172
  7173 0660-TEXAS-REG-RED-X.
  7174     EXIT.
  7175
  7176 0670-NET-PAY-RED.
  7177
  7178     MOVE ZERO          TO WRK-B.
  7179     IF M4 NOT POSITIVE
  7180         GO TO 0680-NET-PAY-RED-X.
  7181
  7182     IF M4 NOT LESS EX-TERM
  7183         MOVE WRK-C     TO WRK-B
  7184         MOVE +1        TO WRK-E
  7185         GO TO 0680-NET-PAY-RED-X.
  7186
  7187     MOVE EX-TERM       TO NP-ORIG, NP-CAP.
  7188     MOVE EX-APR        TO NP-APR.
  7189     MOVE M4            TO NP-REM.
  7190
  7191     MOVE CLAS-I-BAL (CLAS-INDEXL) TO NP-OPT.
  7192     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
  7193        MOVE EX-CAP-TERM TO NP-ORIG.
  7194
  7195     MOVE 'R' TO NP-OPT.
  7196     CALL 'ECSNETRM' USING
  7197         NP-APR, NP-ORIG, NP-REM, NP-OPT, NP-CAP, NP-FACTOR.
  7198
  7199     MOVE NP-FACTOR  TO WRK-E.
  7200
  7201 0680-NET-PAY-RED-X.
  7202     EXIT.
  7203
  7204 0690-BALLOON-RED.
  7205
  7206     IF CLAS-I-BAL (CLAS-INDEXL) = 'L'
  7207        GO TO 0700-BALLOON-RED-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 141
* ECS158.cbl
  7208
  7209     IF DTE-R78 = '1' OR DTE-CLIENT = 'FLI'
  7210        COMPUTE WRK-F = (M4 + 1) * (M4 + 1)
  7211     ELSE
  7212        COMPUTE WRK-F = (M4 + 1) * (M4 + 2).
  7213
  7214     IF DTE-CLIENT = 'MPP'
  7215        COMPUTE WRK-F = ((EX-TERM + 1) - (M4 + 1)) *
  7216                (((EX-TERM + 1) - (M4 + 1)) + 1).
  7217
  7218     COMPUTE WRK-G = (EX-TERM + 1) * (EX-TERM + 2).
  7219     COMPUTE WRK-E ROUNDED = WRK-F / WRK-G.
  7220
  7221 0700-BALLOON-RED-EXIT.
  7222     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 142
* ECS158.cbl
  7224
  7225 0710-LEVEL-MEAN.
  7226
  7227     MOVE +0 TO WS-LF-LEV-MEAN-INFORCE (YR).
  7228
  7229     IF RR (YR) NOT = +0
  7230        MOVE EX-INITIAL-AMT TO WS-LF-LEV-MEAN-INFORCE (YR)
  7231        ADD CR-LFAMT-ALT    TO WS-LF-LEV-MEAN-INFORCE (YR).
  7232
  7233 0720-IBNR-CALC.
  7234
  7235     IF DTE-CLIENT = 'MON' OR 'DCC' OR 'CID' OR 'AHL'
  7236         GO TO 0730-L-EXIT.
  7237
  7238     IF M6 (YR) POSITIVE
  7239        COMPUTE EX-B-IBNR (YR) =
  7240                EX-B-IBNR (YR) +
  7241                (MEAN-CAL * .0005).
  7242
  7243     IF M5 (YR) POSITIVE
  7244        COMPUTE EX-E-IBNR (YR) =
  7245                EX-E-IBNR (YR) +
  7246                (MEAN-CAL * .0005).
  7247
  7248 0730-L-EXIT.
  7249     EXIT.
  7250
  7251 0740-REDUCING-MEAN.
  7252
  7253     MOVE +0             TO MEAN-CAL
  7254                            WS-LF-RED-MEAN-INFORCE (YR).
  7255
  7256     DIVIDE EX-TERM INTO EX-INITIAL-AMT GIVING WRK-A.
  7257     MOVE RR (YR)        TO  WORK-M4.
  7258
  7259     IF DTE-CLIENT NOT = 'MON' AND 'CID' AND 'DCC' AND 'AHL'
  7260         IF M6 (YR) POSITIVE
  7261             COMPUTE EX-B-IBNR (YR) =
  7262             EX-B-IBNR (YR) + ((M6 (YR) * WRK-A) * .0005).
  7263
  7264 0750-R-MEAN.
  7265
  7266     COMPUTE  MEAN-CAL  =  MEAN-CAL  +  (M1 (YR) * WRK-A) +
  7267                           CR-LFAMT-ALT.
  7268     COMPUTE  M1 (YR) =  M1 (YR) - +1.
  7269     COMPUTE  WORK-M4  =  WORK-M4  -  +1.
  7270
  7271     IF WORK-M4  GREATER  ZERO
  7272         GO  TO  0750-R-MEAN.
  7273
  7274     IF RR (YR) NOT = +0
  7275        DIVIDE RR (YR) INTO MEAN-CAL GIVING MEAN-CAL.
  7276
  7277     MOVE MEAN-CAL TO WS-LF-RED-MEAN-INFORCE (YR).
  7278
  7279     IF DTE-CLIENT NOT = 'MON' AND 'CID' AND 'DCC' AND 'AHL'
  7280         IF M5 (YR) POSITIVE
  7281             COMPUTE EX-E-IBNR (YR) =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 143
* ECS158.cbl
  7282             EX-E-IBNR (YR) + ((M5 (YR) * WRK-A) * .0005).
  7283
  7284     GO TO 0770-R-EXIT.
  7285
  7286 0760-R-NET-PAY-MEAN.
  7287
  7288     MOVE M3 (YR)                  TO NP-ORIG NP-REM NP-CAP.
  7289     MOVE EX-APR                   TO NP-APR.
  7290     MOVE CLAS-I-BAL (CLAS-INDEXL) TO NP-OPT.
  7291
  7292     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
  7293        MOVE EX-CAP-TERM TO NP-ORIG.
  7294
  7295     CALL 'ECSNETRM' USING
  7296        NP-APR, NP-ORIG, NP-REM, NP-OPT, NP-CAP,  NP-FACTOR.
  7297
  7298     COMPUTE NP-WORK1 = NP-FACTOR * 6.5
  7299     MOVE M2 (YR)                  TO NP-ORIG NP-REM NP-CAP.
  7300     MOVE EX-APR                   TO NP-APR.
  7301     MOVE CLAS-I-BAL (CLAS-INDEXL) TO NP-OPT.
  7302
  7303     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
  7304        MOVE EX-CAP-TERM TO NP-ORIG.
  7305
  7306     CALL 'ECSNETRM' USING
  7307        NP-APR, NP-ORIG, NP-REM, NP-OPT, NP-CAP, NP-FACTOR.
  7308
  7309     COMPUTE  NP-WORK2 = NP-FACTOR * 6.5
  7310     SUBTRACT NP-WORK2 FROM NP-WORK1.
  7311
  7312     COMPUTE MEAN-CAL = NP-WORK1 * (EX-INITIAL-AMT / +1000)
  7313     IF RR (YR) NOT = +0
  7314        DIVIDE RR (YR) INTO MEAN-CAL GIVING MEAN-CAL.
  7315
  7316     MOVE MEAN-CAL TO WS-LF-RED-MEAN-INFORCE (YR).
  7317
  7318 0770-R-EXIT.
  7319     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 144
* ECS158.cbl
  7321
  7322 0800-RULE-ANTIC.
  7323
  7324     PERFORM 1700-CALC-REM-AMT   THRU 1799-EXIT
  7325
  7326     MOVE EFFECT-DT              TO  CP-CERT-EFF-DT
  7327
  7328     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
  7329        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
  7330        MOVE '3'                 TO  DC-OPTION-CODE
  7331        PERFORM 6150-DATE-CONVERSION-ROUTINE
  7332        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
  7333     ELSE
  7334        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
  7335        MOVE +1                  TO  DC-ELAPSED-MONTHS
  7336        MOVE +0                  TO  DC-ELAPSED-DAYS
  7337        MOVE '6'                 TO  DC-OPTION-CODE
  7338        PERFORM 6150-DATE-CONVERSION-ROUTINE
  7339        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
  7340     END-IF
  7341     MOVE M4                     TO  CP-REMAINING-TERM
  7342     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  7343                                 TO CP-BENEFIT-TYPE
  7344     MOVE SPACES                 TO CP-ACCT-FLD-5
  7345     MOVE DTE-CLIENT             TO CP-COMPANY-ID
  7346     MOVE CR-AGE                 TO CP-ISSUE-AGE
  7347     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM
  7348     MOVE CR-LF-CRIT-PERIOD      TO CP-CRITICAL-MONTHS
  7349     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  7350                                    CP-LOAN-TERM
  7351     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
  7352                                    CP-RATING-BENEFIT-AMT
  7353     MOVE WS-REM-AMT             TO CP-REMAINING-BENEFIT
  7354     MOVE CR-APR                 TO CP-LOAN-APR
  7355     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY
  7356     MOVE LF-EARN-CODE           TO CP-RATING-METHOD
  7357     MOVE '6'                    TO CP-EARNING-METHOD
  7358     MOVE '3'                    TO CP-PROCESS-TYPE
  7359     MOVE ' '                    TO CP-SPECIAL-CALC-CD
  7360     IF CR-RATING-CLASS NOT = SPACES AND ZEROS
  7361        MOVE CR-RATING-CLASS     TO CP-CLASS-CODE
  7362     ELSE
  7363        MOVE AM-CAL-TABLE        TO CP-CLASS-CODE
  7364     END-IF
  7365
  7366     MOVE CR-LF-DEV-CODE         TO  CP-DEVIATION-CODE
  7367
  7368     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT
  7369     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE
  7370     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV
  7371     MOVE CR-LFTYP                   TO CP-BENEFIT-CD
  7372     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD
  7373     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS
  7374     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE
  7375
  7376     IF CP-STATE-STD-ABBRV = 'OR'
  7377        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
  7378     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 145
* ECS158.cbl
  7379
  7380     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
  7381        COMPUTE CP-ORIGINAL-BENEFIT =
  7382         (CR-LFAMT - CR-LFPRM)
  7383     END-IF
  7384
  7385     IF CP-TRUNCATED-LIFE
  7386        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
  7387     END-IF
  7388
  7389     IF CP-TERM-IS-DAYS
  7390        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
  7391     ELSE
  7392        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
  7393     END-IF
  7394
  7395     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
  7396     MOVE CP-CALC-REFUND         TO WRK-B
  7397
  7398     .
  7399 0800-EXIT.
  7400     EXIT.
  7401
  7402 1000-PROCESS-AH.
  7403
  7404     MOVE ZEROS               TO  EX-EXIT-DATE.
  7405     MOVE INITIALIZED-BACK    TO  EX-DATA-BY-YEAR (1)
  7406                                  EX-DATA-BY-YEAR (2)
  7407                                  EX-DATA-BY-YEAR (3).
  7408
  7409     IF CR-AHTYP = ZEROS OR SPACES
  7410        GO TO 1400-CHECK-IF-REINSURANCE.
  7411
  7412     IF CR-AH-DEV-PCT NOT NUMERIC
  7413         MOVE ZEROS TO CR-AH-DEV-PCT.
  7414
  7415     IF DTE-CLIENT  = 'CRI'
  7416         MOVE WK-AH-DEV-CODE     TO  EX-STATE-DEV
  7417     ELSE
  7418         IF CR-AH-DEV-PCT NOT = +0 AND +1.0
  7419             COMPUTE WK-TEMP-DEV-PCT =
  7420                             CR-AH-DEV-PCT * WK-DEV-FACTOR
  7421             MOVE WK-TEMP-DEV    TO  EX-STATE-DEV
  7422         ELSE
  7423             MOVE CR-AH-DEV-CODE TO  EX-STATE-DEV.
  7424
  7425     MOVE 'A'             TO EX-LIFE-AH.
  7426
  7427 1010-CHECK-AH-STATUS.
  7428
  7429     MOVE +2 TO LIFE-AH-SUB.
  7430     MOVE +1 TO YR.
  7431
  7432     IF CR-AH-CURRENT-STATUS NOT = '6' AND '7' AND '8'
  7433        GO TO 1020-FIND-AH-LOOP.
  7434
  7435     MOVE CR-AH-CANCEL-EXIT-DATE     TO DC-GREG-DATE-CYMD.
  7436     MOVE 'L'                        TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 146
* ECS158.cbl
  7437     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7438     IF NO-CONVERSION-ERROR
  7439        MOVE DC-BIN-DATE-1            TO AH-CAN
  7440     ELSE
  7441        MOVE LOW-VALUES               TO AH-CAN.
  7442
  7443     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO DC-GREG-DATE-CYMD.
  7444     MOVE 'L'                        TO DC-OPTION-CODE.
  7445     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7446     IF NO-CONVERSION-ERROR
  7447        MOVE DC-BIN-DATE-1            TO AH-CLM
  7448     ELSE
  7449        MOVE LOW-VALUES               TO AH-CLM.
  7450
  7451     IF AH-CAN = LOW-VALUES AND
  7452        AH-CLM = LOW-VALUES
  7453        GO TO 1020-FIND-AH-LOOP.
  7454
  7455     IF AH-CAN = LOW-VALUES AND
  7456        AH-CLM NOT = LOW-VALUES
  7457        MOVE CR-AH-SETTLEMENT-EXIT-DATE TO EX-EXIT-DATE
  7458        GO TO 1020-FIND-AH-LOOP.
  7459
  7460     IF AH-CLM = LOW-VALUES
  7461         MOVE CR-AH-CANCEL-EXIT-DATE TO EX-EXIT-DATE
  7462         GO TO 1020-FIND-AH-LOOP.
  7463
  7464     IF AH-CAN LESS THAN AH-CLM
  7465         MOVE CR-AH-CANCEL-EXIT-DATE TO EX-EXIT-DATE
  7466         GO TO 1020-FIND-AH-LOOP.
  7467
  7468     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO EX-EXIT-DATE.
  7469
  7470 1020-FIND-AH-LOOP.
  7471
  7472
  7473     IF CLAS-INDEXA GREATER THAN CLAS-MAXA
  7474        MOVE ' INVALID AH   TYPE ' TO WS-ABEND-MESSAGE
  7475        MOVE CR-AHTYP TO WS-ABEND-FILE-STATUS
  7476        GO TO ABEND-PGM.
  7477
  7478     IF CR-AHTYP NOT = CLAS-I-BEN (CLAS-INDEXA)
  7479        ADD +1 TO CLAS-INDEXA
  7480        GO TO 1020-FIND-AH-LOOP.
  7481
  7482     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
  7483
  7484*    IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  7485*       IF AM-EARN-METHOD-A NOT = SPACES AND ZEROS
  7486*          MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
  7487
  7488     if dte-client = 'AHL'
  7489        move 'R'                 to type-method
  7490     else
  7491        PERFORM 1300-FIND-METHOD THRU 1310-METHOD-EXIT
  7492     end-if
  7493
  7494
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 147
* ECS158.cbl
  7495
  7496     MOVE EX-EXIT-DATE               TO DC-GREG-DATE-CYMD.
  7497     MOVE 'L'                        TO DC-OPTION-CODE.
  7498     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7499     IF NO-CONVERSION-ERROR
  7500        MOVE DC-BIN-DATE-1            TO EXIT-DT
  7501     ELSE
  7502        MOVE LOW-VALUES               TO EXIT-DT.
  7503
  7504     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  7505     MOVE 'L'                        TO DC-OPTION-CODE.
  7506     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7507     IF NO-CONVERSION-ERROR
  7508        MOVE DC-BIN-DATE-1            TO EFFECT-DT
  7509     ELSE
  7510        MOVE LOW-VALUES               TO EFFECT-DT.
  7511
  7512     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  7513         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  7514
  7515     MOVE LOW-VALUES             TO     FIRST-PAY-DT.
  7516
  7517     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  7518         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  7519         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  7520                                        DC-ELAPSED-DAYS
  7521         MOVE '3'                    TO DC-OPTION-CODE
  7522         PERFORM 6150-DATE-CONVERSION-ROUTINE
  7523         IF NO-CONVERSION-ERROR
  7524             MOVE DC-BIN-DATE-1      TO FIRST-PAY-DT
  7525         ELSE
  7526             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  7527
  7528     IF FIRST-PAY-DT  LESS THAN  EFFECT-DT
  7529         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  7530
  7531     IF CR-LOAN-1ST-PMT-DT = ZEROS
  7532         MOVE EFFECT-DT              TO DC-BIN-DATE-1
  7533         MOVE +1                     TO DC-ELAPSED-MONTHS
  7534         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  7535         MOVE '6'                    TO DC-OPTION-CODE
  7536         PERFORM 6150-DATE-CONVERSION-ROUTINE
  7537         MOVE DC-BIN-DATE-2          TO FIRST-PAY-DT
  7538         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  7539
  7540     MOVE FIRST-PAY-DT            TO DC-BIN-DATE-1.
  7541     COMPUTE DC-ELAPSED-MONTHS = CR-AH-TERM - +1
  7542     MOVE ZEROS                   TO DC-ELAPSED-DAYS.
  7543     MOVE '6'                     TO DC-OPTION-CODE.
  7544     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7545     IF NO-CONVERSION-ERROR
  7546         MOVE DC-BIN-DATE-2        TO EXPIRE-DT
  7547     ELSE
  7548         MOVE LOW-VALUES           TO EXPIRE-DT.
  7549
  7550     IF (EXPIRE-DT = LOW-VALUES)      OR
  7551         (DTE-REM-TRM-CALC-OPTION = '1' OR '2')
  7552        MOVE EFFECT-DT               TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 148
* ECS158.cbl
  7553        MOVE CR-AH-TERM              TO DC-ELAPSED-MONTHS
  7554        MOVE ZEROS                   TO DC-ELAPSED-DAYS
  7555        MOVE '6'                     TO DC-OPTION-CODE
  7556        PERFORM 6150-DATE-CONVERSION-ROUTINE
  7557        IF NO-CONVERSION-ERROR
  7558           MOVE DC-BIN-DATE-2        TO EXPIRE-DT
  7559        ELSE
  7560           MOVE LOW-VALUES           TO EXPIRE-DT.
  7561
  7562     MOVE CR-AH-EXPIRE-DATE      TO DC-GREG-DATE-CYMD
  7563     MOVE 'L'                    TO DC-OPTION-CODE
  7564     PERFORM 6150-DATE-CONVERSION-ROUTINE
  7565     IF NO-CONVERSION-ERROR
  7566        MOVE DC-BIN-DATE-1       TO EXPIRE-DT
  7567     ELSE
  7568        MOVE LOW-VALUES          TO EXPIRE-DT
  7569     END-IF
  7570
  7571     MOVE +0                         TO DC-ELAPSED-MONTHS
  7572
  7573     MOVE CR-AH-TERM         TO EX-TERM
  7574
  7575     IF CR-AH-TERM LESS THAN +60
  7576        MOVE '1' TO EX-TERM-CD
  7577     ELSE
  7578        MOVE '2' TO EX-TERM-CD.
  7579
  7580     MOVE CR-AHTYP           TO EX-BEN-TYPE.
  7581
  7582     MOVE CR-AHPRM          TO EX-PREM
  7583                               EX-PRIM-FAC-PREM
  7584                               WS-HOLD-AH-PRIM-FAC.
  7585
  7586 1035-A-H-SUMMARY-ADJUSTMENTS.
  7587
  7588     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
  7589         GO TO 1040-CHECK-AH-PERIOD-INFORCE.
  7590
  7591     IF CR-AHPRM NOT GREATER CR-AHRFND
  7592         MOVE ZERO                   TO EX-BENEFIT
  7593                                        EX-PREM
  7594     ELSE
  7595         IF CR-AHRFND = ZERO
  7596             MOVE CR-AHAMT           TO EX-BENEFIT
  7597             MOVE CR-AHPRM           TO EX-PREM
  7598         ELSE
  7599             COMPUTE TEMP-3 ROUNDED = CR-AHRFND / CR-AHPRM
  7600             COMPUTE EX-BENEFIT ROUNDED =
  7601                              CR-AHAMT - (CR-AHAMT * TEMP-3)
  7602             COMPUTE EX-PREM ROUNDED =
  7603                              CR-AHPRM - CR-AHRFND.
  7604
  7605     MOVE EX-PREM                    TO CR-AHPRM.
  7606
  7607 1040-CHECK-AH-PERIOD-INFORCE.
  7608
  7609     IF YR GREATER THAN NUMBER-OF-PERIODS
  7610         GO TO 1110-END-PROCESS-AH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 149
* ECS158.cbl
  7611
  7612     IF ENTRY-DT GREATER END-DT (YR)
  7613        GO TO 1110-END-PROCESS-AH.
  7614
  7615     IF CR-ENTRY-STATUS = '5' OR 'M'
  7616        MOVE +0                TO EX-PREM
  7617                                  EX-PRIM-FAC-PREM
  7618                                  WS-HOLD-AH-PRIM-FAC
  7619        GO TO 1080-CALC-AH-REFUND.
  7620
  7621     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
  7622        GO TO 1060-END-REM-TERM-AH.
  7623
  7624     MOVE EFFECT-DT         TO DT-START.
  7625     IF BEGIN-DT (YR) GREATER THAN DT-START
  7626        MOVE BEGIN-DT (YR) TO DT-START.
  7627
  7628*    IF EXPIRE-DT NOT GREATER THAN END-DT (YR)
  7629*       MOVE EXPIRE-DT TO DT-END
  7630*    ELSE
  7631*       MOVE END-DT (YR) TO DT-END.
  7632
  7633     IF EXPIRE-DT < END-DT (YR)
  7634        MOVE EXPIRE-DT           TO DT-END
  7635     ELSE
  7636        MOVE END-DT (YR)         TO DT-END
  7637     END-IF
  7638
  7639     IF EXIT-DT NOT = LOW-VALUES
  7640        IF EXIT-DT LESS THAN DT-END
  7641           MOVE EXIT-DT TO DT-END.
  7642
  7643     MOVE DT-START                   TO DC-BIN-DATE-1.
  7644     MOVE DT-END                     TO DC-BIN-DATE-2.
  7645     MOVE '1'                        TO DC-OPTION-CODE.
  7646     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7647     IF NO-CONVERSION-ERROR
  7648        MOVE DC-ELAPSED-MONTHS       TO RR (YR)
  7649     ELSE
  7650        MOVE +0                      TO RR (YR).
  7651
  7652     IF RR (YR) LESS THAN +0
  7653        MOVE +0 TO RR (YR).
  7654
  7655     MOVE EXPIRE-DT TO DT-END.
  7656
  7657     IF EXIT-DT NOT = LOW-VALUES
  7658        IF EXIT-DT LESS THAN DT-END
  7659            IF EXIT-DT NOT GREATER THAN END-DT (YR)
  7660                MOVE EXIT-DT TO DT-END.
  7661
  7662     MOVE DT-START                   TO DC-BIN-DATE-1.
  7663     MOVE DT-END                     TO DC-BIN-DATE-2.
  7664     MOVE '1'                        TO DC-OPTION-CODE.
  7665     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7666     IF NO-CONVERSION-ERROR
  7667        MOVE DC-ELAPSED-MONTHS       TO M1 (YR)
  7668     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 150
* ECS158.cbl
  7669        MOVE +0                      TO M1 (YR).
  7670
  7671     IF M1 (YR) LESS THAN +0
  7672        MOVE +0 TO M1 (YR).
  7673
  7674     IF EXPIRE-DT < END-DT (YR)
  7675        MOVE +0                  TO M2 (YR) M5 (YR)
  7676        GO TO 1050-REM-TERM-AH-BEGIN
  7677     END-IF
  7678
  7679     IF EXIT-DT NOT = LOW-VALUES
  7680        IF EXIT-DT <= END-DT (YR)
  7681           MOVE +0               TO M2 (YR) M5 (YR)
  7682        GO TO 1050-REM-TERM-AH-BEGIN
  7683        END-IF
  7684     END-IF
  7685
  7686*    IF DT-END <= END-DT (YR)
  7687*        MOVE +0 TO M2 (YR) M5 (YR)
  7688*        GO TO 1050-REM-TERM-AH-BEGIN.
  7689
  7690     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  7691     MOVE 'L'                        TO DC-OPTION-CODE.
  7692     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7693     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  7694
  7695     MOVE ENDING-DATE(YR)            TO DC-GREG-DATE-CYMD.
  7696     MOVE 'L'                        TO DC-OPTION-CODE.
  7697     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7698     MOVE DC-BIN-DATE-1              TO CP-VALUATION-DT.
  7699
  7700     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
  7701
  7702     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
  7703                                        CP-LOAN-TERM.
  7704     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
  7705     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
  7706     MOVE 'N' TO FROM-LIFE-SW.
  7707     PERFORM 6000-CALC-REM-TERM THRU 6010-REM-TERM-EXIT.
  7708
  7709     IF REM-TRM2 GREATER CR-AH-TERM
  7710        MOVE CR-AH-TERM TO M2 (YR) M5 (YR)
  7711                           WS-AH-END-REM-TRM1 (YR)
  7712     ELSE
  7713        MOVE REM-TRM1 TO M2 (YR)
  7714                         WS-AH-END-REM-TRM1 (YR)
  7715        MOVE REM-TRM2 TO M5 (YR).
  7716
  7717 1050-REM-TERM-AH-BEGIN.
  7718
  7719     IF (ENTRY-DT GREATER BEGIN-DT (YR)) OR
  7720        (DT-END NOT GREATER BEGIN-DT (YR))
  7721        MOVE +0 TO M3 (YR) M6 (YR)
  7722        GO TO 1060-END-REM-TERM-AH.
  7723
  7724     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  7725     MOVE 'L'                        TO DC-OPTION-CODE.
  7726     PERFORM 6150-DATE-CONVERSION-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 151
* ECS158.cbl
  7727     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  7728
  7729     MOVE BEGIN-DATE(YR)             TO DC-GREG-DATE-CYMD.
  7730     MOVE 'L'                        TO DC-OPTION-CODE.
  7731     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7732     MOVE DC-BIN-DATE-1              TO CP-VALUATION-DT.
  7733
  7734     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
  7735
  7736     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
  7737                                        CP-LOAN-TERM.
  7738
  7739     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
  7740     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
  7741     MOVE 'N' TO FROM-LIFE-SW.
  7742     PERFORM 6000-CALC-REM-TERM THRU 6010-REM-TERM-EXIT.
  7743
  7744     IF REM-TRM2 GREATER CR-AH-TERM
  7745        MOVE CR-AH-TERM TO M3 (YR) M6 (YR)
  7746                           WS-AH-BEG-REM-TRM1 (YR)
  7747     ELSE
  7748        MOVE REM-TRM1 TO M3 (YR)
  7749                         WS-AH-BEG-REM-TRM1 (YR)
  7750        MOVE REM-TRM2 TO M6 (YR).
  7751
  7752 1060-END-REM-TERM-AH.
  7753
  7754     IF M5 (YR) GREATER THAN +0
  7755         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
  7756             COMPUTE EX-C-CNT (YR) = CR-LIVES -
  7757                                     CR-SUM-CAN-CNT-ITD
  7758         ELSE
  7759             MOVE +1 TO EX-C-CNT (YR).
  7760
  7761     IF DEBUG-AH-INFORCE-CNT
  7762         IF (YR = +1) AND
  7763            (EX-C-CNT (YR) GREATER THAN ZEROS)
  7764             ADD EX-C-CNT (YR) TO WS-S-INFORCE-CNT
  7765             DISPLAY ' CERT ', CR-FULL-CONTROL
  7766                     ' CNT ', EX-C-CNT (YR)
  7767                     ' TOT ', WS-S-INFORCE-CNT.
  7768
  7769     MOVE +0 TO SA.
  7770
  7771 1070-CALC-AH-COMMISSIONS.
  7772
  7773     IF (ENTRY-DT GREATER THAN END-DT (YR))
  7774       OR
  7775        (ENTRY-DT NOT GREATER THAN BEGIN-DT (YR))
  7776        GO TO 1080-CALC-AH-REFUND.
  7777
  7778     IF CR-ENTRY-STATUS = '5' OR 'M'
  7779        GO TO 1080-CALC-AH-REFUND.
  7780
  7781     ADD +1 TO SA.
  7782
  7783     IF SA GREATER THAN +10
  7784        GO TO 1080-CALC-AH-REFUND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 152
* ECS158.cbl
  7785
  7786     IF CR-COM-AGT (SA) = ZEROS OR SPACES
  7787         GO TO 1070-CALC-AH-COMMISSIONS.
  7788
  7789     IF CR-AGT-TYPE (SA) = 'C' OR 'D' OR 'F' OR 'S'
  7790        COMPUTE AGT-COMM =
  7791         CR-AHPRM * CR-LCOM-AH (SA)
  7792         ADD AGT-COMM TO EX-AGT-COMM (YR)
  7793     ELSE
  7794        IF CR-AGT-TYPE (SA) = 'O' OR 'P' OR 'G' OR 'B'
  7795           COMPUTE AGT-COMM =
  7796            CR-AHPRM * CR-LCOM-AH (SA)
  7797            ADD AGT-COMM TO EX-OVR-COMM (YR).
  7798
  7799     GO TO 1070-CALC-AH-COMMISSIONS.
  7800
  7801 1080-CALC-AH-REFUND.
  7802
  7803     IF AH-CAN GREATER THAN BEGIN-DT (YR) AND
  7804        AH-CAN NOT GREATER THAN END-DT (YR)
  7805        MOVE CR-AHRFND     TO EX-CNC-AMT (YR)
  7806     ELSE
  7807        GO TO 1100-FINISH-AH-YEAR.
  7808
  7809     MOVE +0 TO SA.
  7810
  7811 1090-CALC-AH-REF-COMM.
  7812
  7813     ADD +1 TO SA.
  7814
  7815     IF SA GREATER THAN +10
  7816        GO TO 1100-FINISH-AH-YEAR.
  7817
  7818     IF CR-COM-AGT (SA) = ZEROS OR SPACES
  7819         GO TO 1090-CALC-AH-REF-COMM.
  7820
  7821     IF CR-AGT-TYPE (SA) = 'C' OR 'D' OR 'F' OR 'S'
  7822        COMPUTE AGT-COMM = -1 * CR-AHRFND * CR-LCOM-AH (SA)
  7823        ADD AGT-COMM TO EX-AGT-COMM (YR)
  7824     ELSE
  7825        IF CR-AGT-TYPE (SA) = 'O' OR 'P' OR 'G' OR 'B'
  7826           COMPUTE AGT-COMM = -1 * CR-AHRFND * CR-LCOM-AH (SA)
  7827           ADD AGT-COMM TO EX-OVR-COMM (YR).
  7828
  7829     GO TO 1090-CALC-AH-REF-COMM.
  7830
  7831 1100-FINISH-AH-YEAR.
  7832
  7833     ADD +1 TO YR.
  7834     GO TO 1040-CHECK-AH-PERIOD-INFORCE.
  7835
  7836 1110-END-PROCESS-AH.
  7837
  7838     IF CR-ENTRY-STATUS = '5' OR 'M'
  7839        GO TO 1120-RELEASE-AH-RECORD.
  7840
  7841     IF CR-AH-DEV-PCT NOT NUMERIC
  7842        MOVE +0       TO CR-AH-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 153
* ECS158.cbl
  7843
  7844     IF DTE-CLIENT = 'CID' OR 'AHL'
  7845        GO TO 1120-RELEASE-AH-RECORD
  7846     END-IF
  7847
  7848     IF (CR-STATE =  STATE-IL OR STATE-GA OR
  7849         STATE-NC OR STATE-UT OR STATE-TX OR
  7850         STATE-IA OR STATE-NE OR STATE-NV OR
  7851         STATE-OH OR STATE-OR OR STATE-WI)
  7852                     AND
  7853         (RR (1) GREATER THAN +0 OR
  7854          RR (2) GREATER THAN +0 OR
  7855          RR (3) GREATER THAN +0)
  7856        NEXT SENTENCE
  7857     ELSE
  7858     IF DTE-CLIENT = 'CRI' OR 'CVL' OR 'CID'
  7859         NEXT SENTENCE
  7860     ELSE
  7861         IF (RR (1) GREATER THAN +0 OR
  7862             RR (2) GREATER THAN +0 OR
  7863             RR (3) GREATER THAN +0)
  7864           AND ((CR-AH-DEV-CODE NOT =
  7865                   STATE-PRIM-FAC-DEV (CLAS-INDEXS))
  7866           OR (CR-AH-DEV-PCT NOT = +0 AND +1.0))
  7867             NEXT SENTENCE
  7868         ELSE
  7869             GO TO 1120-RELEASE-AH-RECORD.
  7870
  7871     MOVE EP-DT                      TO DC-GREG-DATE-CYMD.
  7872     MOVE 'L'                        TO DC-OPTION-CODE.
  7873     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7874     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  7875     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
  7876     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
  7877     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
  7878     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
  7879     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
  7880     IF CR-RATING-CLASS NOT = SPACES AND ZEROS
  7881        MOVE CR-RATING-CLASS         TO CP-CLASS-CODE
  7882     ELSE
  7883        MOVE AM-CAL-TABLE            TO CP-CLASS-CODE.
  7884
  7885     IF DTE-CLIENT = 'CRI'
  7886         MOVE WK-AH-DEV-CODE     TO  CP-DEVIATION-CODE
  7887     ELSE
  7888         MOVE STATE-PRIM-FAC-DEV (CLAS-INDEXS)
  7889                                 TO  CP-DEVIATION-CODE.
  7890
  7891     MOVE +0                         TO CP-RATE-DEV-PCT.
  7892     MOVE 'A'                        TO CP-BENEFIT-TYPE.
  7893     MOVE '3'                        TO CP-PROCESS-TYPE.
  7894     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
  7895     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
  7896                                        CP-LOAN-TERM.
  7897     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
  7898                                        CP-RATING-BENEFIT-AMT.
  7899     IF CP-STATE-STD-ABBRV = 'OR'
  7900         COMPUTE CP-RATING-BENEFIT-AMT =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 154
* ECS158.cbl
  7901                                 CR-AHAMT * CR-AH-TERM.
  7902     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY
  7903     MOVE CR-AGE                     TO CP-ISSUE-AGE.
  7904     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  7905     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  7906     MOVE CR-APR                     TO CP-LOAN-APR.
  7907     MOVE CR-AH-CRIT-PERIOD          TO CP-CRITICAL-MONTHS.
  7908     MOVE SPACES                     TO CP-ACCT-FLD-5.
  7909     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
  7910
  7911     PERFORM 6130-CALL-RATING-ROUTINE THRU 6140-RATE-EXIT.
  7912
  7913     ADD 1 TO WS-AH-RATE-ATTEMPT.
  7914
  7915     IF DTE-CLIENT = 'CID' OR 'AHL'
  7916        IF CR-AHPRM-CALC NOT NUMERIC
  7917           MOVE +0               TO CR-AHPRM-CALC
  7918        END-IF
  7919        IF CR-AHPRM-CALC = ZEROS
  7920           MOVE CR-AHPRM         TO CR-AHPRM-CALC
  7921        END-IF
  7922     END-IF
  7923
  7924     IF NOT CP-ERROR-OCCURED
  7925        IF (CP-CALC-PREMIUM NOT = +0) AND
  7926           (CR-AHPRM-CALC NOT = +0)
  7927           IF DTE-CLIENT = 'CID'
  7928              COMPUTE WS-DIFF = (CP-CALC-PREMIUM -
  7929                 CR-AHPRM-CALC) / CR-AHPRM-CALC
  7930              IF WS-DIFF < 0
  7931                 COMPUTE WS-DIFF = WS-DIFF * -1
  7932              END-IF
  7933              IF WS-DIFF > 0.02
  7934                 MOVE CP-CALC-PREMIUM TO EX-PRIM-FAC-PREM
  7935                                    WS-HOLD-AH-PRIM-FAC
  7936              END-IF
  7937           ELSE
  7938              MOVE CP-CALC-PREMIUM TO EX-PRIM-FAC-PREM
  7939                                   WS-HOLD-AH-PRIM-FAC
  7940           END-IF
  7941        END-IF
  7942     ELSE
  7943        ADD 1 TO WS-AH-RATE-ERROR
  7944     END-IF
  7945
  7946     .
  7947 1120-RELEASE-AH-RECORD.
  7948
  7949     PERFORM 1130-BUILD-AH-CLAIMS
  7950         VARYING YR FROM +1 BY +1
  7951         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  7952
  7953     GO TO 1140-END-AH-CLAIMS.
  7954
  7955 1130-BUILD-AH-CLAIMS.
  7956
  7957     IF CERT-AND-CLAIM
  7958        MOVE WS-CLAIM-AMT (2 1 YR) TO EX-CLAIM-AMT (YR)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 155
* ECS158.cbl
  7959        MOVE WS-INC-CNT   (2 1 YR) TO EX-INC-CNT   (YR)
  7960        MOVE WS-PD-CNT    (2 1 YR) TO EX-PD-CNT    (YR).
  7961
  7962 1140-END-AH-CLAIMS.
  7963
  7964     IF CR-ENTRY-STATUS = '5' OR 'M'
  7965        GO TO 1180-END-AH-RESERVES.
  7966
  7967     MOVE EX-PREM TO WRK-C.
  7968
  7969*    PERFORM 1200-CALC-AH-UNEARN THRU 1299-AH-UNEARN-EXIT
  7970     PERFORM 1200-CALC-AH-UNEARN THRU 1200-EXIT
  7971         VARYING YR FROM +1 BY +1
  7972         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  7973
  7974     PERFORM 1150-BUILD-AH-DEV-RESERVES
  7975         VARYING YR FROM +1 BY +1
  7976         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  7977
  7978     GO TO 1160-CALC-AH-PRIM-FAC.
  7979
  7980 1150-BUILD-AH-DEV-RESERVES.
  7981
  7982     MOVE WS-AH-BEG-MEAN-RES (YR)  TO EX-BEG-MEAN-RES (YR)
  7983                                      EX-PRI-BEG-MEAN-RES (YR).
  7984
  7985     MOVE WS-AH-BEG-STATE-RES (YR) TO EX-BEG-ST-RES (YR)
  7986                                      EX-PRI-BEG-ST-RES (YR).
  7987
  7988     MOVE WS-AH-BEG-R78-RES (YR)   TO EX-BEG-R78-RES (YR)
  7989                                      EX-PRI-BEG-R78-RES (YR).
  7990
  7991     MOVE WS-AH-BEG-PRO-RES (YR)   TO EX-BEG-PRO-RES (YR)
  7992                                      EX-PRI-BEG-PRO-RES (YR).
  7993
  7994     MOVE WS-AH-END-MEAN-RES (YR)  TO EX-END-MEAN-RES (YR)
  7995                                      EX-PRI-END-MEAN-RES (YR).
  7996
  7997     MOVE WS-AH-END-STATE-RES (YR) TO EX-END-ST-RES (YR)
  7998                                      EX-PRI-END-ST-RES (YR).
  7999
  8000     MOVE WS-AH-END-R78-RES (YR)   TO EX-END-R78-RES (YR)
  8001                                      EX-PRI-END-R78-RES (YR).
  8002
  8003     MOVE WS-AH-END-PRO-RES (YR)   TO EX-END-PRO-RES (YR)
  8004                                      EX-PRI-END-PRO-RES (YR).
  8005
  8006 1160-CALC-AH-PRIM-FAC.
  8007
  8008     IF EX-PREM NOT = EX-PRIM-FAC-PREM
  8009        MOVE EX-PRIM-FAC-PREM TO WRK-C
  8010*       PERFORM 1200-CALC-AH-UNEARN THRU 1299-AH-UNEARN-EXIT
  8011        PERFORM 1200-CALC-AH-UNEARN THRU 1200-EXIT
  8012            VARYING YR FROM +1 BY +1
  8013            UNTIL YR GREATER THAN NUMBER-OF-PERIODS
  8014        PERFORM 1170-BUILD-AH-PRI-RESERVES
  8015            VARYING YR FROM +1 BY +1
  8016            UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 156
* ECS158.cbl
  8017
  8018     GO TO 1180-END-AH-RESERVES.
  8019
  8020 1170-BUILD-AH-PRI-RESERVES.
  8021
  8022     MOVE WS-AH-BEG-MEAN-RES  (YR) TO EX-PRI-BEG-MEAN-RES (YR).
  8023     MOVE WS-AH-BEG-STATE-RES (YR) TO EX-PRI-BEG-ST-RES   (YR).
  8024     MOVE WS-AH-BEG-R78-RES   (YR) TO EX-PRI-BEG-R78-RES  (YR).
  8025     MOVE WS-AH-BEG-PRO-RES   (YR) TO EX-PRI-BEG-PRO-RES  (YR).
  8026
  8027     MOVE WS-AH-END-MEAN-RES  (YR) TO EX-PRI-END-MEAN-RES (YR).
  8028     MOVE WS-AH-END-STATE-RES (YR) TO EX-PRI-END-ST-RES   (YR).
  8029     MOVE WS-AH-END-R78-RES   (YR) TO EX-PRI-END-R78-RES  (YR).
  8030     MOVE WS-AH-END-PRO-RES   (YR) TO EX-PRI-END-PRO-RES  (YR).
  8031
  8032 1180-END-AH-RESERVES.
  8033
  8034     IF DEBUG-AH-STATUTORY
  8035         GO TO 1180-CONTINUE.
  8036
  8037     IF DTE-PGM-OPT NOT = '3' AND '4'
  8038        GO TO 1190-BYPASS-AH-DETAIL.
  8039
  8040     IF M5 (1) = +0
  8041        GO TO 1190-BYPASS-AH-DETAIL.
  8042
  8043 1180-CONTINUE.
  8044
  8045     MOVE EX-CARRIER           TO D-CARR.
  8046     MOVE EX-GROUPING          TO D-GROUP.
  8047     MOVE EX-STATE             TO D-STATE.
  8048     MOVE EX-ACCOUNT           TO D-ACCOUNT.
  8049     MOVE CR-CERT-NO           TO D-CERT-NO.
  8050
  8051     MOVE 'L'                  TO DC-OPTION-CODE.
  8052     MOVE EX-EFF-DATE          TO DC-GREG-DATE-CYMD.
  8053     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  8054     MOVE DC-GREG-DATE-1-EDIT  TO D-EFF-DATE.
  8055
  8056     MOVE EX-PREM              TO D-PREM.
  8057     MOVE EX-PRIM-FAC-PREM     TO D-PRI-PREM.
  8058     MOVE EX-TERM              TO D-TERM.
  8059     MOVE M2 (1)               TO D-REM-TERM.
  8060     MOVE EX-END-ST-RES (1)    TO D-UNEARN.
  8061     MOVE EX-BENEFIT           TO D-BENEFIT.
  8062     MOVE 'A'                  TO D-L-A.
  8063     MOVE CLAS-I-AB10 (CLAS-INDEXA) TO D-BEN-DESC.
  8064
  8065     PERFORM 1600-PRINT-A-LINE.
  8066
  8067     IF DEBUG-AH-STATUTORY
  8068         IF EX-END-ST-RES (1) NOT = ZEROS
  8069             ADD +1                TO WS-S-CNT
  8070             ADD EX-END-ST-RES (1) TO WS-S-STATUTORY
  8071             DISPLAY ' CNT ', WS-S-CNT
  8072                     ' TOT ', WS-S-STATUTORY
  8073                     ' RESV ', EX-END-ST-RES (1)
  8074                     ' CERT ', CR-FULL-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 157
* ECS158.cbl
  8075
  8076 1190-BYPASS-AH-DETAIL.
  8077
  8078     MOVE CALL-EXTRACT          TO HOLD-AH-RECORD.
  8079
  8080     IF CR-ENTRY-STATUS NOT = '9'
  8081        PERFORM 1500-RELEASE THRU 1540-RELEASE-EXIT.
  8082
  8083     GO TO 1400-CHECK-IF-REINSURANCE.
  8084
  8085 1200-CALC-AH-UNEARN.
  8086
  8087     MOVE +0 TO         WS-AH-END-R78-RES (YR)
  8088                        WS-AH-BEG-R78-RES (YR)
  8089                        WS-AH-END-PRO-RES (YR)
  8090                        WS-AH-BEG-PRO-RES (YR)
  8091                        WS-AH-END-NET-RES (YR)
  8092                        WS-AH-BEG-NET-RES (YR)
  8093                        WS-AH-END-MEAN-RES (YR)
  8094                        WS-AH-BEG-MEAN-RES (YR)
  8095                        WS-AH-END-STATE-RES (YR)
  8096                        WS-AH-BEG-STATE-RES (YR)
  8097                        WRK-B.
  8098
  8099     IF ENTRY-DT GREATER  BEGIN-DT (YR)
  8100        GO TO  1200-CALC-AH-END
  8101     END-IF
  8102
  8103     MOVE WS-AH-BEG-REM-TRM1 (YR)
  8104                                 TO M4
  8105                                    CP-REMAINING-TERM
  8106
  8107     IF M4 NOT POSITIVE
  8108        GO TO 1200-CALC-AH-END
  8109     END-IF
  8110
  8111     MOVE BEGIN-DATE (YR)        TO DC-GREG-DATE-CYMD
  8112     MOVE 'L'                    TO DC-OPTION-CODE
  8113     PERFORM 6150-DATE-CONVERSION-ROUTINE
  8114     MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
  8115
  8116     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  8117                                 TO CP-BENEFIT-TYPE
  8118     MOVE M4                     TO WRK-REMTRM
  8119     PERFORM 1250-CALC-UNEARNED-PREMIUM
  8120                                 THRU 1250-EXIT
  8121
  8122     MOVE CP-R78-U-PRM           TO WS-AH-BEG-R78-RES (YR)
  8123     MOVE CP-PRORATA-U-PRM       TO WS-AH-BEG-PRO-RES (YR)
  8124     MOVE CP-STATE-U-PRM         TO WS-AH-BEG-STATE-RES (YR)
  8125
  8126     COMPUTE WS-AH-BEG-MEAN-RES (YR) =
  8127        (WS-AH-BEG-PRO-RES (YR) + WS-AH-BEG-R78-RES (YR)) * .5
  8128
  8129*    PERFORM 0560-CALC-PRO-FACTOR
  8130*
  8131*    COMPUTE WRK-B ROUNDED = WRK-D * WRK-C
  8132*    MOVE WRK-B TO WS-AH-BEG-PRO-RES (YR)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 158
* ECS158.cbl
  8133     .
  8134 1200-CALC-AH-END.
  8135
  8136     IF ENTRY-DT GREATER THAN END-DT (YR)
  8137        GO TO  1200-EXIT
  8138     END-IF
  8139
  8140     MOVE WS-AH-END-REM-TRM1 (YR)
  8141                                 TO M4
  8142                                    CP-REMAINING-TERM
  8143
  8144     IF M4 NOT POSITIVE
  8145        GO TO 1200-EXIT
  8146     END-IF
  8147
  8148     MOVE ENDING-DATE (YR)       TO DC-GREG-DATE-CYMD
  8149     MOVE 'L'                    TO DC-OPTION-CODE
  8150     PERFORM 6150-DATE-CONVERSION-ROUTINE
  8151     MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
  8152
  8153     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  8154                                 TO CP-BENEFIT-TYPE
  8155     MOVE M4                     TO WRK-REMTRM
  8156     PERFORM 1250-CALC-UNEARNED-PREMIUM
  8157                                 THRU 1250-EXIT
  8158
  8159     MOVE CP-R78-U-PRM           TO WS-AH-END-R78-RES (YR)
  8160     MOVE CP-PRORATA-U-PRM       TO WS-AH-END-PRO-RES (YR)
  8161     MOVE CP-STATE-U-PRM         TO WS-AH-END-STATE-RES (YR)
  8162
  8163     COMPUTE WS-AH-END-MEAN-RES (YR) =
  8164        (WS-AH-END-PRO-RES (YR) + WS-AH-END-R78-RES (YR)) * .5
  8165
  8166*    PERFORM 0560-CALC-PRO-FACTOR
  8167*
  8168*    COMPUTE WRK-B ROUNDED = WRK-D * WRK-C
  8169*    MOVE WRK-B TO WS-AH-END-PRO-RES (YR)
  8170     .
  8171 1200-EXIT.
  8172     EXIT.
  8173
  8174 1230-CALC-AH-R78-BEG.
  8175
  8176     IF ENTRY-DT GREATER THAN BEGIN-DT (YR)
  8177        GO TO 1240-CALC-AH-R78-END.
  8178
  8179     MOVE WS-AH-BEG-REM-TRM1 (YR) TO M4.
  8180
  8181     IF M4 NOT POSITIVE
  8182        GO TO 1240-CALC-AH-R78-END.
  8183
  8184     PERFORM 0610-CALC-R78-FACTOR.
  8185
  8186     COMPUTE WRK-B ROUNDED = WRK-E * WRK-C.
  8187     MOVE WRK-B TO WS-AH-BEG-R78-RES (YR).
  8188
  8189 1240-CALC-AH-R78-END.
  8190
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 159
* ECS158.cbl
  8191     IF ENTRY-DT GREATER THAN END-DT (YR)
  8192        GO TO 1250-CALC-AH-MEAN-RES.
  8193
  8194     MOVE WS-AH-END-REM-TRM1 (YR) TO M4.
  8195
  8196     IF M4 NOT POSITIVE
  8197        GO TO 1250-CALC-AH-MEAN-RES.
  8198
  8199     PERFORM 0610-CALC-R78-FACTOR.
  8200
  8201     COMPUTE WRK-B ROUNDED = WRK-E * WRK-C.
  8202     MOVE WRK-B TO WS-AH-END-R78-RES (YR).
  8203
  8204 1250-CALC-AH-MEAN-RES.
  8205
  8206     COMPUTE WS-AH-BEG-MEAN-RES (YR) =
  8207        (WS-AH-BEG-PRO-RES (YR) + WS-AH-BEG-R78-RES (YR)) * .5.
  8208
  8209     COMPUTE WS-AH-END-MEAN-RES (YR) =
  8210        (WS-AH-END-PRO-RES (YR) + WS-AH-END-R78-RES (YR)) * .5.
  8211
  8212 1260-CALC-AH-NET-BEG.
  8213
  8214     IF AH-EARN-NET-PAY
  8215         NEXT SENTENCE
  8216     ELSE
  8217         GO TO 1280-CALC-STATE-REGS.
  8218
  8219     IF ENTRY-DT GREATER THAN BEGIN-DT (YR)
  8220        GO TO 1270-CALC-AH-NET-END.
  8221
  8222     MOVE WS-AH-BEG-REM-TRM1 (YR) TO M4.
  8223
  8224     IF M4 NOT POSITIVE
  8225        GO TO 1270-CALC-AH-NET-END.
  8226
  8227     PERFORM 1275-NET-PAY-AH THRU 1275-NET-PAY-AH-X.
  8228
  8229     COMPUTE WRK-B ROUNDED = WRK-E * WRK-C.
  8230     MOVE WRK-B TO WS-AH-BEG-NET-RES (YR).
  8231
  8232 1270-CALC-AH-NET-END.
  8233
  8234     IF ENTRY-DT GREATER THAN END-DT (YR)
  8235        GO TO 1280-CALC-STATE-REGS.
  8236
  8237     MOVE WS-AH-END-REM-TRM1 (YR) TO M4.
  8238
  8239     IF M4 NOT POSITIVE
  8240        GO TO 1280-CALC-STATE-REGS.
  8241
  8242     PERFORM 1275-NET-PAY-AH THRU 1275-NET-PAY-AH-X.
  8243
  8244     COMPUTE WRK-B ROUNDED = WRK-E * WRK-C.
  8245     MOVE WRK-B TO WS-AH-END-NET-RES (YR).
  8246
  8247     GO TO 1280-CALC-STATE-REGS.
  8248
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 160
* ECS158.cbl
  8249 1275-NET-PAY-AH.
  8250
  8251     MOVE ZERO                     TO WRK-B.
  8252
  8253     IF M4 NOT POSITIVE
  8254         GO TO 1275-NET-PAY-AH-X.
  8255
  8256     IF M4 NOT LESS EX-TERM
  8257         MOVE WRK-C                TO WRK-B
  8258         MOVE +1                   TO WRK-E
  8259         GO TO 1275-NET-PAY-AH-X.
  8260
  8261     MOVE EX-TERM                  TO NP-ORIG
  8262                                      NP-CAP.
  8263     MOVE EX-APR                   TO NP-APR.
  8264     MOVE M4                       TO NP-REM.
  8265
  8266     MOVE CLAS-I-BAL (CLAS-INDEXA) TO NP-OPT.
  8267     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
  8268        MOVE EX-CAP-TERM           TO NP-ORIG.
  8269
  8270     MOVE 'R'                      TO NP-OPT.
  8271
  8272     CALL 'ECSNETRM' USING
  8273         NP-APR, NP-ORIG, NP-REM, NP-OPT, NP-CAP, NP-FACTOR.
  8274
  8275     MOVE NP-FACTOR                TO WRK-E.
  8276
  8277 1275-NET-PAY-AH-X.
  8278     EXIT.
  8279
  8280 1280-CALC-STATE-REGS.
  8281
  8282     IF ANTICIPATION
  8283        IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  8284              IF EX-BEN-TYPE NOT = ZERO
  8285                 MOVE M6 (YR) TO WORK-M4
  8286                 MOVE M3 (YR) TO WRK-REMTRM
  8287                 PERFORM 1320-CHECK-AH-RATES THRU 1330-CHECK-EXIT
  8288                 IF CP-ERROR-RATE-NOT-FOUND OR
  8289                    CP-ERROR-RATE-IS-ZERO   OR
  8290                    CP-ERROR-IN-DATES
  8291                  NEXT SENTENCE
  8292                 ELSE
  8293                  COMPUTE WRK-B ROUNDED =
  8294                   ((M3 (YR) * EX-BENEFIT) / +100)
  8295                               * CP-PREMIUM-RATE
  8296                  MOVE WRK-B TO WS-AH-BEG-STATE-RES (YR).
  8297
  8298     IF ANTICIPATION
  8299        IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  8300              IF EX-BEN-TYPE NOT = ZERO
  8301                 MOVE M5 (YR) TO WORK-M4
  8302                 MOVE M2 (YR) TO WRK-REMTRM
  8303                 PERFORM 1320-CHECK-AH-RATES THRU 1330-CHECK-EXIT
  8304                 IF CP-ERROR-RATE-NOT-FOUND OR
  8305                    CP-ERROR-RATE-IS-ZERO   OR
  8306                    CP-ERROR-IN-DATES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 161
* ECS158.cbl
  8307                  NEXT SENTENCE
  8308                 ELSE
  8309                  COMPUTE WRK-B ROUNDED =
  8310                   ((M2 (YR) * EX-BENEFIT) / +100)
  8311                               * CP-PREMIUM-RATE
  8312                  MOVE WRK-B TO WS-AH-END-STATE-RES (YR).
  8313
  8314     IF R78
  8315        MOVE WS-AH-BEG-R78-RES (YR) TO
  8316                       WS-AH-BEG-STATE-RES (YR)
  8317        MOVE WS-AH-END-R78-RES (YR) TO
  8318                       WS-AH-END-STATE-RES (YR).
  8319
  8320     IF AH-EARN-NET-PAY
  8321        MOVE WS-AH-BEG-NET-RES (YR) TO
  8322                       WS-AH-BEG-STATE-RES (YR)
  8323        MOVE WS-AH-END-NET-RES (YR) TO
  8324                       WS-AH-END-STATE-RES (YR).
  8325
  8326     IF PRATA
  8327        MOVE WS-AH-BEG-PRO-RES (YR) TO
  8328                       WS-AH-BEG-STATE-RES (YR)
  8329        MOVE WS-AH-END-PRO-RES (YR) TO
  8330                       WS-AH-END-STATE-RES (YR).
  8331
  8332     IF MEAN
  8333        COMPUTE WS-AH-BEG-STATE-RES (YR) =
  8334        (WS-AH-BEG-PRO-RES (YR) + WS-AH-BEG-R78-RES (YR)) * .5
  8335        COMPUTE WS-AH-END-STATE-RES (YR) =
  8336        (WS-AH-END-PRO-RES (YR) + WS-AH-END-R78-RES (YR)) * .5.
  8337
  8338     IF 1-3RD-2-3RDS
  8339        COMPUTE WS-AH-BEG-STATE-RES (YR) =
  8340        (WS-AH-BEG-PRO-RES (YR) * .6667) +
  8341        (WS-AH-BEG-R78-RES (YR) * .3333)
  8342        COMPUTE WS-AH-END-STATE-RES (YR) =
  8343        (WS-AH-END-PRO-RES (YR) * .6667) +
  8344        (WS-AH-END-R78-RES (YR) * .3333).
  8345
  8346 1299-AH-UNEARN-EXIT.
  8347     EXIT.
  8348
  8349 1250-CALC-UNEARNED-PREMIUM.
  8350
  8351*    MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8352*    MOVE 'L'                    TO DC-OPTION-CODE
  8353*    PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  8354*    MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
  8355     MOVE EFFECT-DT              TO CP-CERT-EFF-DT
  8356
  8357*    MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
  8358
  8359     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  8360     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
  8361     MOVE CR-AHAMT               TO CP-ORIGINAL-BENEFIT
  8362                                    CP-RATING-BENEFIT-AMT
  8363     MOVE CLAS-I-BAL (CLAS-INDEXA)
  8364                                 TO CP-SPECIAL-CALC-CD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 162
* ECS158.cbl
  8365     MOVE DTE-R78                TO CP-R78-OPTION
  8366     MOVE SPACES                 TO CP-ACCT-FLD-5
  8367     MOVE DTE-CLIENT             TO CP-COMPANY-ID
  8368     MOVE CR-AGE                 TO CP-ISSUE-AGE
  8369     MOVE CR-APR                 TO CP-LOAN-APR
  8370     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY
  8371     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM
  8372     MOVE SPACES                 TO CP-DOMICILE-STATE
  8373     MOVE CR-CARRIER             TO CP-CARRIER
  8374
  8375     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  8376         MOVE CR-RATING-CLASS    TO CP-CLASS-CODE
  8377     ELSE
  8378         MOVE AM-CAL-TABLE       TO CP-CLASS-CODE
  8379     END-IF
  8380
  8381     MOVE STATE-SUB (CLAS-INDEXS)
  8382                                 TO CP-STATE
  8383     MOVE STATE-ABBR (CLAS-INDEXS)
  8384                                 TO CP-STATE-STD-ABBRV
  8385     MOVE DTE-CLASIC-COMPANY-CD  TO CP-COMPANY-CD
  8386     MOVE CR-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS
  8387
  8388     MOVE ' ' TO CP-EARNING-METHOD
  8389
  8390
  8391     IF DTE-CLIENT = 'CID'
  8392        IF CP-STATE-STD-ABBRV = 'OH'
  8393           IF CR-LFTYP NOT = ZEROS AND SPACES
  8394              IF (CLAS-I-EP (CLAS-INDEXL) = 'N' OR '5')
  8395                          OR
  8396                 ((CR-LF-TERM > +60)
  8397                  AND (CR-APR > ZEROS))
  8398                 MOVE '5'          TO CP-EARNING-METHOD
  8399              END-IF
  8400           END-IF
  8401        END-IF
  8402     END-IF
  8403
  8404
  8405
  8406     CALL 'ELUPRMX' USING CALCULATION-PASS-AREA
  8407
  8408     if dte-client not = 'AHL'
  8409        IF CP-STATE-STD-ABBRV = 'VA'
  8410           PERFORM 1320-CHECK-AH-RATES
  8411                                 THRU 1330-CHECK-EXIT
  8412           IF CP-ERROR-RATE-NOT-FOUND  OR
  8413              CP-ERROR-RATE-IS-ZERO  OR
  8414              CP-ERROR-IN-DATES
  8415              CONTINUE
  8416           ELSE
  8417              COMPUTE CP-STATE-U-PRM ROUNDED =
  8418                 ((WRK-REMTRM * CR-AHAMT)
  8419                 / +100) * CP-PREMIUM-RATE
  8420           END-IF
  8421        END-IF
  8422     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 163
* ECS158.cbl
  8423
  8424     .
  8425 1250-EXIT.
  8426     EXIT.
  8427
  8428 1300-FIND-METHOD.
  8429
  8430     IF STATE-ABBR (CLAS-INDEXS) = 'VA'
  8431        MOVE '1'                 TO STATE-CALL-EARN (CLAS-INDEXS)
  8432     END-IF
  8433
  8434     IF STATE-CALL-EARN (CLAS-INDEXS) = '2'
  8435        MOVE 'R' TO TYPE-METHOD
  8436        GO TO 1310-METHOD-EXIT
  8437     ELSE
  8438        IF STATE-CALL-EARN (CLAS-INDEXS) = '3'
  8439           MOVE 'P' TO TYPE-METHOD
  8440           GO TO 1310-METHOD-EXIT
  8441        ELSE
  8442           IF STATE-CALL-EARN (CLAS-INDEXS) = '4'
  8443              MOVE 'M' TO TYPE-METHOD
  8444              GO TO 1310-METHOD-EXIT
  8445           ELSE
  8446              IF STATE-CALL-EARN (CLAS-INDEXS) = '5'
  8447                 MOVE CLAS-I-EP (CLAS-INDEXA) TO TYPE-METHOD
  8448                 GO TO 1310-METHOD-EXIT.
  8449
  8450     SET TABLE-INDEX TO +1
  8451
  8452     SEARCH MR-TABLE VARYING TABLE-INDEX
  8453              AT END
  8454         MOVE DEFAULT-AH-METHOD             TO TYPE-METHOD
  8455              WHEN
  8456         T-STATE (TABLE-INDEX) = STATE-ABBR (CLAS-INDEXS)
  8457             MOVE METHOD-CODE (TABLE-INDEX) TO TYPE-METHOD.
  8458
  8459     IF AH-EARN-METHOD = 'A' OR 'C'
  8460        MOVE 'A' TO TYPE-METHOD
  8461        GO TO 1310-METHOD-EXIT.
  8462
  8463     IF DTE-CLIENT = 'CSO' OR 'CID'
  8464         IF STATE-ABBR (CLAS-INDEXS) = 'CO'
  8465             IF EX-EFF-DATE LESS THAN 19970101
  8466                 MOVE 'R'        TO  TYPE-METHOD
  8467                 GO TO 1310-METHOD-EXIT
  8468             ELSE
  8469                 MOVE 'M'        TO  TYPE-METHOD
  8470                 GO TO 1310-METHOD-EXIT.
  8471
  8472     IF TEXAS-SPECIAL
  8473        IF EX-EFF-DATE  GREATER THAN  19830831
  8474           MOVE 'M' TO TYPE-METHOD
  8475           GO TO 1310-METHOD-EXIT
  8476        ELSE
  8477           MOVE 'R' TO TYPE-METHOD
  8478           GO TO 1310-METHOD-EXIT.
  8479
  8480     IF OK-SPECIAL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 164
* ECS158.cbl
  8481        IF EX-EFF-DATE  GREATER THAN  19820629
  8482           MOVE 'M' TO TYPE-METHOD
  8483           GO TO 1310-METHOD-EXIT
  8484        ELSE
  8485           MOVE 'R' TO TYPE-METHOD
  8486           GO TO 1310-METHOD-EXIT.
  8487
  8488     IF OHIO-SPECIAL
  8489        IF EX-EFF-DATE  GREATER THAN  19831031
  8490           MOVE 'M' TO TYPE-METHOD
  8491           GO TO 1310-METHOD-EXIT
  8492        ELSE
  8493           MOVE 'P' TO TYPE-METHOD
  8494           GO TO 1310-METHOD-EXIT.
  8495
  8496     IF VIRGINIA-SPECIAL
  8497        MOVE 'A'                 TO TYPE-METHOD
  8498                                    AH-EARN-METHOD
  8499        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
  8500           MOVE 'P'              TO TYPE-METHOD
  8501                                    AH-EARN-METHOD
  8502        END-IF
  8503     END-IF
  8504
  8505     IF (DTE-CLIENT = 'NCL') AND
  8506        (EX-EFF-DATE  LESS THAN  19910101 )
  8507          NEXT SENTENCE
  8508     ELSE
  8509         IF (CR-APR GREATER THAN +0)
  8510            IF  (AH-EARN-METHOD = 'N') OR
  8511                (CLAS-I-EP (CLAS-INDEXA) = 'N')
  8512                 MOVE 'N' TO TYPE-METHOD.
  8513
  8514 1310-METHOD-EXIT.
  8515     EXIT.
  8516
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 165
* ECS158.cbl
  8518 1320-CHECK-AH-RATES.
  8519
  8520     MOVE EFFECT-DT              TO CP-CERT-EFF-DT
  8521
  8522     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
  8523     MOVE SPACES                     TO CP-ACCT-FLD-5.
  8524     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  8525     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
  8526     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
  8527     MOVE CR-AGE                     TO CP-ISSUE-AGE.
  8528     MOVE WRK-REMTRM                 TO CP-ORIGINAL-TERM.
  8529     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
  8530                                        CP-RATING-BENEFIT-AMT.
  8531     IF CP-STATE-STD-ABBRV = 'OR'
  8532         COMPUTE CP-RATING-BENEFIT-AMT =
  8533                                 CR-AHAMT * WRK-REMTRM.
  8534     MOVE CR-APR                     TO CP-LOAN-APR.
  8535     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
  8536     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
  8537     MOVE '3'                        TO CP-PROCESS-TYPE.
  8538     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
  8539     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
  8540     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  8541         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
  8542     ELSE
  8543         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
  8544     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
  8545     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
  8546     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  8547     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
  8548     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
  8549     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
  8550
  8551     PERFORM 6130-CALL-RATING-ROUTINE THRU 6140-RATE-EXIT.
  8552
  8553 1330-CHECK-EXIT.
  8554     EXIT.
  8555
  8556 1400-CHECK-IF-REINSURANCE.
  8557
  8558     IF DTE-PGM-OPT = '2' OR '4'
  8559        PERFORM 2000-REINSURANCE-ROUTINE THRU
  8560                2030-REINSURANCE-ROUTINE-X.
  8561
  8562 1410-PROCESS-CERTS-EXIT.
  8563     EXIT.
  8564
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 166
* ECS158.cbl
  8566 1500-RELEASE.
  8567
  8568     IF CERT-NO-CLAIM OR
  8569        CERT-AND-CLAIM
  8570        GO TO 1520-RELEASE-SORT-RECORD.
  8571
  8572     MOVE +1 TO LIFE-AH-SUB
  8573                YR.
  8574
  8575 1510-ADD-CLAIMS-TO-EXTRACT.
  8576
  8577     IF LIFE-AH-SUB GREATER THAN +2
  8578        GO TO 1540-RELEASE-EXIT.
  8579
  8580     IF YR GREATER THAN NUMBER-OF-PERIODS
  8581         PERFORM 1520-RELEASE-SORT-RECORD
  8582         ADD +1 TO LIFE-AH-SUB
  8583         MOVE +1 TO YR
  8584         GO TO 1510-ADD-CLAIMS-TO-EXTRACT.
  8585
  8586     MOVE WS-CLAIM-AMT (LIFE-AH-SUB 1 YR) TO EX-CLAIM-AMT (YR).
  8587     MOVE WS-INC-CNT   (LIFE-AH-SUB 1 YR) TO EX-INC-CNT   (YR).
  8588     MOVE WS-PD-CNT    (LIFE-AH-SUB 1 YR) TO EX-PD-CNT    (YR).
  8589     MOVE WS-DEV       (LIFE-AH-SUB)      TO EX-STATE-DEV.
  8590     MOVE WS-BEN-TYPE  (LIFE-AH-SUB)      TO EX-BEN-TYPE.
  8591
  8592     IF LIFE-AH-SUB = +1
  8593         MOVE 'L'                       TO EX-LIFE-AH
  8594     ELSE
  8595         MOVE 'A'                       TO EX-LIFE-AH.
  8596
  8597     ADD +1 TO YR.
  8598     GO TO 1510-ADD-CLAIMS-TO-EXTRACT.
  8599
  8600 1520-RELEASE-SORT-RECORD.
  8601
  8602     IF SINGLE-PERIOD-PROCESS
  8603         MOVE ZEROS              TO  EX-INC-CNT          (2)
  8604                                     EX-PD-CNT           (2)
  8605                                     EX-C-CNT            (2)
  8606                                     RR                  (2)
  8607                                     M1                  (2)
  8608                                     M2                  (2)
  8609                                     M3                  (2)
  8610                                     M5                  (2)
  8611                                     M6                  (2)
  8612                                     EX-BEG-ST-RES       (2)
  8613                                     EX-END-ST-RES       (2)
  8614                                     EX-BEG-R78-RES      (2)
  8615                                     EX-END-R78-RES      (2)
  8616                                     EX-BEG-PRO-RES      (2)
  8617                                     EX-END-PRO-RES      (2)
  8618                                     EX-BEG-MEAN-RES     (2)
  8619                                     EX-END-MEAN-RES     (2)
  8620                                     EX-PRI-BEG-ST-RES   (2)
  8621                                     EX-PRI-END-ST-RES   (2)
  8622                                     EX-PRI-BEG-R78-RES  (2)
  8623                                     EX-PRI-END-R78-RES  (2)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 167
* ECS158.cbl
  8624                                     EX-PRI-BEG-PRO-RES  (2)
  8625                                     EX-PRI-END-PRO-RES  (2)
  8626                                     EX-PRI-BEG-MEAN-RES (2)
  8627                                     EX-PRI-END-MEAN-RES (2)
  8628                                     EX-MEAN-INFORCE     (2)
  8629                                     EX-OVR-COMM         (2)
  8630                                     EX-AGT-COMM         (2)
  8631                                     EX-CNC-AMT          (2)
  8632                                     EX-RETRO-PMTS       (2)
  8633         MOVE INITIALIZED-BACK   TO  EX-DATA-BY-YEAR   (3).
  8634
  8635     MOVE LOW-VALUES             TO SORT-KEY.
  8636
  8637     IF EX-CLAIM-AMT (1) NOT NUMERIC
  8638        MOVE ZEROS TO EX-CLAIM-AMT (1).
  8639
  8640     IF EX-CLAIM-AMT (2) NOT NUMERIC
  8641        MOVE ZEROS TO EX-CLAIM-AMT (2).
  8642
  8643     IF EX-CLAIM-AMT (3) NOT NUMERIC
  8644        MOVE ZEROS TO EX-CLAIM-AMT (3).
  8645
  8646     IF EX-BEN-TYPE = '00'
  8647        NEXT SENTENCE
  8648     ELSE
  8649        IF EX-CLAIM-AMT (1) GREATER THAN +0
  8650           PERFORM XXXX-PRINT-CLAIMS THRU XXXX-EXIT
  8651           WRITE CALL-X FROM CALL-EXTRACT
  8652           ADD +1 TO CALL-CNT
  8653        ELSE
  8654           WRITE CALL-X FROM CALL-EXTRACT
  8655           ADD +1 TO CALL-CNT.
  8656
  8657 1530-CHECK-FOR-TEXAS.
  8658
  8659     IF EX-BEN-TYPE = '00'
  8660        NEXT SENTENCE
  8661     ELSE
  8662        IF REPORT-OVER-UNDER-60  OR
  8663           EX-STATE = STATE-TX
  8664           IF (EX-CLAIM-AMT (1) GREATER THAN +0 OR
  8665               EX-CLAIM-AMT (2) GREATER THAN +0 OR
  8666               EX-CLAIM-AMT (3) GREATER THAN +0)
  8667             IF EX-TERM-CD = '1'
  8668                MOVE '2'    TO EX-TERM-CD
  8669                MOVE 'X'    TO EX-TX-RESV-ADJ-REC
  8670                WRITE CALL-X FROM CALL-EXTRACT
  8671                MOVE SPACES TO EX-TX-RESV-ADJ-REC
  8672                ADD +1 TO TEXAS-CNT
  8673             ELSE
  8674             IF EX-TERM-CD = '2'
  8675                MOVE '1'    TO EX-TERM-CD
  8676                MOVE 'X'    TO EX-TX-RESV-ADJ-REC
  8677                WRITE CALL-X FROM CALL-EXTRACT
  8678                MOVE SPACES TO EX-TX-RESV-ADJ-REC
  8679                ADD +1 TO TEXAS-CNT.
  8680
  8681 1540-RELEASE-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 168
* ECS158.cbl
  8682     EXIT.
  8683
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 169
* ECS158.cbl
  8685 XXXX-PRINT-CLAIMS.
  8686
  8687     IF DTE-PGM-OPT = '3' OR '4'
  8688        NEXT SENTENCE
  8689     ELSE
  8690        GO TO XXXX-EXIT.
  8691
  8692     MOVE SPACES              TO DETAIL-1B.
  8693
  8694     IF EX-LIFE-AH = 'L'
  8695        MOVE EX-CLAIM-AMT (1) TO DB-CLAIML
  8696     ELSE
  8697     IF EX-LIFE-AH = 'A'
  8698        MOVE EX-CLAIM-AMT (1) TO DB-CLAIMA.
  8699
  8700     MOVE EX-CARRIER       TO DB-CARR.
  8701     MOVE EX-GROUPING      TO DB-GROUP.
  8702     MOVE EX-STATE         TO DB-STATE.
  8703     MOVE EX-ACCOUNT       TO DB-ACCOUNT.
  8704     MOVE EX-EFF-DATE-YR   TO FORMAT-YEAR.
  8705     MOVE EX-EFF-DATE-MO   TO FORMAT-MONTH.
  8706     MOVE EX-EFF-DATE-DA   TO FORMAT-DAY.
  8707     MOVE FORMAT-DATE      TO DB-EFF-DATE.
  8708     MOVE EX-LIFE-AH       TO DB-L-A.
  8709     MOVE DETAIL-1B        TO PRTC-DATA.
  8710     MOVE SPACES           TO PRTC-CTL.
  8711     WRITE PRTC.
  8712
  8713 XXXX-EXIT.
  8714     EXIT.
  8715
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 170
* ECS158.cbl
  8717
  8718 1600-PRINT-A-LINE.
  8719
  8720     IF LINE-CTR GREATER THAN +60
  8721        MOVE +8 TO LINE-CTR
  8722        ADD +1 TO PAGE-CTR
  8723        PERFORM 1630-PRINT-HEADINGS THRU
  8724                1640-PRINT-HEADINGS-EXIT.
  8725
  8726     MOVE DETAIL-1 TO P-DATA.
  8727     MOVE ' '      TO X.
  8728     PERFORM 1610-PRT-RTN THRU 1620-E-PRT-RTN.
  8729     ADD +1 TO LINE-CTR.
  8730
  8731 1610-PRT-RTN.
* 8732                                 COPY ELCPRT2.
  8733******************************************************************04/15/98
  8734*                                                                *ELCPRT2
  8735*                                                                *ELCPRT2
  8736*                            ELCPRT2                             *   LV005
  8737*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  8738*                            VMOD=2.002                          *   CL**5
  8739*                                                                *   CL**4
  8740******************************************************************   CL**4
  8741                                                                     CL**4
  8742     IF DTE-FICH NOT = SPACE AND                                     CL**4
  8743        FICH-OPEN    = SPACE                                         CL**4
  8744         MOVE 'X'                TO  FICH-OPEN                       CL**4
  8745         OPEN OUTPUT FICH.                                           CL**4
  8746                                                                     CL**4
  8747     IF DTE-FICH NOT = SPACE                                         CL**4
  8748         MOVE X                  TO  P-CTL                           CL**4
  8749         WRITE FICH-REC FROM PRT.                                    CL**4
  8750                                                                     CL**4
  8751     IF DTE-FICH = SPACE OR '2'                                      CL**4
  8752       MOVE X                    TO  P-CTL                           CL**4
  8753       IF P-CTL = ' '                                                CL**4
  8754         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  8755       ELSE                                                          CL**4
  8756         IF P-CTL = '0'                                              CL**4
  8757           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  8758         ELSE                                                        CL**4
  8759           IF P-CTL = '-'                                            CL**4
  8760             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  8761           ELSE                                                      CL**4
  8762             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  8763                                                                     CL**4
  8764******************************************************************   CL**4
  8765 1620-E-PRT-RTN.
  8766     EXIT.
  8767
  8768 1630-PRINT-HEADINGS.
  8769
  8770     MOVE '1'             TO X.
  8771     MOVE HEAD-1          TO P-DATA.
  8772     PERFORM 1610-PRT-RTN THRU 1620-E-PRT-RTN.
  8773
  8774     MOVE ' '             TO X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 171
* ECS158.cbl
  8775     MOVE WS-CURRENT-DATE TO HD-DATE.
  8776     MOVE COMPANY-NAME    TO HD-CLIENT.
  8777     MOVE HEAD-2          TO P-DATA.
  8778     PERFORM 1610-PRT-RTN THRU 1620-E-PRT-RTN.
  8779
  8780     MOVE PAGE-CTR        TO HD-PAGE.
  8781     MOVE ALPH-DATE       TO HD-ALF-DTE.
  8782     MOVE HEAD-3          TO P-DATA.
  8783     PERFORM 1610-PRT-RTN THRU 1620-E-PRT-RTN.
  8784
  8785     MOVE '0'             TO X.
  8786     MOVE HEAD-4          TO P-DATA.
  8787     PERFORM 1610-PRT-RTN THRU 1620-E-PRT-RTN.
  8788
  8789 1640-PRINT-HEADINGS-EXIT.
  8790     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 172
* ECS158.cbl
  8792
  8793 1700-CALC-REM-AMT.
  8794
  8795     IF CR-LFTYP = 'QD'
  8796        MOVE +15.0               TO CR-APR
  8797     END-IF
  8798
  8799     if dte-client = 'AHL'
  8800        if cr-loan-term = zeros
  8801           move cr-lf-term       to cr-loan-term
  8802        end-if
  8803     end-if
  8804
  8805     MOVE +0                     TO WS-REM-AMT
  8806     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  8807        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  8808           COMPUTE WS-REM-AMT =
  8809             CR-LFAMT + CR-LFAMT-ALT
  8810        ELSE
  8811           MOVE CR-LFAMT         TO WS-REM-AMT
  8812        END-IF
  8813        GO TO 1750-DISPLAY-AMTS
  8814     END-IF
  8815
  8816     if dte-client = 'AHL'
  8817        compute intermed rounded =
  8818           cr-lfamt / cr-loan-term
  8819     else
  8820        COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
  8821     end-if
  8822
  8823     IF M4 = CR-LF-TERM
  8824        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  8825           COMPUTE WS-REM-AMT =
  8826             CR-LFAMT + CR-LFAMT-ALT
  8827        ELSE
  8828           MOVE CR-LFAMT         TO WS-REM-AMT
  8829        END-IF
  8830        GO TO 1750-DISPLAY-AMTS
  8831     END-IF
  8832
  8833     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  8834        GO TO 1710-ORDINARY-REM
  8835     END-IF
  8836
  8837     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  8838        GO TO 1720-CALC-TEXAS-REM
  8839     END-IF
  8840
  8841     IF CR-LFTYP = 'QD'
  8842        MOVE +15.0               TO CR-APR
  8843        MOVE 'N'                 TO
  8844                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
  8845        GO TO 1730-CALC-NET-PAY-REM
  8846     END-IF
  8847
  8848     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  8849        GO TO 1730-CALC-NET-PAY-REM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 173
* ECS158.cbl
  8850     END-IF
  8851
  8852     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  8853        (CR-RATING-CLASS NOT = 'L ')
  8854         IF (CR-LF-TERM GREATER THAN +60) AND
  8855            (CR-DT GREATER THAN 19831031) AND
  8856            (CR-APR GREATER THAN ZERO)
  8857             GO TO 1730-CALC-NET-PAY-REM
  8858        END-IF
  8859     END-IF
  8860
  8861     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  8862         IF (CR-LF-TERM GREATER THAN +61) AND
  8863            (CR-DT  GREATER THAN 19830318) AND
  8864            (CR-APR GREATER THAN ZERO)
  8865             GO TO 1730-CALC-NET-PAY-REM
  8866        END-IF
  8867     END-IF
  8868
  8869     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  8870         IF (CR-LF-TERM GREATER THAN +62) AND
  8871            (CR-DT  GREATER THAN 19810831) AND
  8872            (CR-DT  LESS THAN 19830901) AND
  8873            (CR-APR GREATER THAN ZERO)
  8874             GO TO 1730-CALC-NET-PAY-REM
  8875        END-IF
  8876     END-IF
  8877
  8878     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  8879         IF (CR-LF-TERM GREATER THAN +60) AND
  8880            (CR-DT  GREATER THAN 19831231) AND
  8881            (CR-APR GREATER THAN ZERO)
  8882             GO TO 1730-CALC-NET-PAY-REM
  8883        END-IF
  8884     END-IF
  8885
  8886     .
  8887 1710-ORDINARY-REM.
  8888
  8889     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  8890         COMPUTE WS-REM-AMT ROUNDED =
  8891                  (INTERMED * M9) + CR-LFAMT-ALT
  8892     else
  8893        if dte-client = 'AHL'
  8894           compute ws-rem-amt rounded = intermed *
  8895              (m9 + (cr-loan-term - cr-lf-term))
  8896        ELSE
  8897           COMPUTE WS-REM-AMT ROUNDED = INTERMED * M9
  8898        end-if
  8899     END-IF
  8900
  8901     GO TO 1750-DISPLAY-AMTS
  8902
  8903     .
  8904 1720-CALC-TEXAS-REM.
  8905
  8906     DIVIDE CR-LFAMT BY CR-LF-TERM
  8907         GIVING TEX-FACT-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 174
* ECS158.cbl
  8908     DIVIDE M9 BY CR-PMT-FREQ
  8909         GIVING TEX-FACT-2
  8910         REMAINDER TEX-FACT-3.
  8911
  8912     IF TEX-FACT-3 NOT = ZERO
  8913         ADD +1                  TO TEX-FACT-2
  8914     END-IF
  8915
  8916     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  8917         MOVE CR-LFAMT           TO WS-REM-AMT
  8918     ELSE
  8919         COMPUTE WS-REM-AMT ROUNDED =
  8920             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
  8921     END-IF
  8922
  8923     GO TO 1750-DISPLAY-AMTS
  8924
  8925     .
  8926 1730-CALC-NET-PAY-REM.
  8927
  8928     MOVE EFFECT-DT              TO  CP-CERT-EFF-DT
  8929
  8930     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
  8931        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
  8932        MOVE '3'                 TO  DC-OPTION-CODE
  8933        PERFORM 6150-DATE-CONVERSION-ROUTINE
  8934        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
  8935     ELSE
  8936        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
  8937        MOVE +1                  TO  DC-ELAPSED-MONTHS
  8938        MOVE +0                  TO  DC-ELAPSED-DAYS
  8939        MOVE '6'                 TO  DC-OPTION-CODE
  8940        PERFORM 6150-DATE-CONVERSION-ROUTINE
  8941        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
  8942     END-IF
  8943
  8944     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  8945        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
  8946     ELSE
  8947        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
  8948     END-IF
  8949     MOVE CR-APR                 TO  CP-LOAN-APR
  8950     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
  8951     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
  8952     MOVE M9                     TO  CP-REMAINING-TERM
  8953     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  8954                                 TO CP-SPECIAL-CALC-CD
  8955     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  8956                                 TO  CP-BENEFIT-TYPE
  8957     MOVE CLAS-I-EP (CLAS-INDEXL)
  8958                                 TO  CP-EARNING-METHOD
  8959     if dte-client = 'ahl'
  8960        move +14                 to cp-loan-apr
  8961     end-if
  8962
  8963     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
  8964
  8965     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 175
* ECS158.cbl
  8966
  8967     .
  8968 1750-DISPLAY-AMTS.
  8969
  8970*    IF (CR-DT > 19921231) AND
  8971*       (CR-DT < 19940101) AND
  8972*    IF (WS-BIN-VAL-DATES (VYR) = X'95FF')
  8973*       MOVE CR-DT TO WS-DISPLAY-DATE
  8974*       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
  8975*       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
  8976*       MOVE CR-LFPRM TO WS-DISPLAY-PRM
  8977*       IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L'
  8978*          ADD CR-LFAMT CR-LFAMT-ALT GIVING WS-DISPLAY-AMT
  8979*       ELSE
  8980*          MOVE CR-LFAMT     TO WS-DISPLAY-AMT
  8981*       END-IF
  8982*       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
  8983*       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  8984*        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  8985*        WS-DISPLAY-AMT '   ' WS-DISPLAY-RAMT
  8986*    END-IF
  8987
  8988     .
  8989 1799-EXIT.
  8990     EXIT.
  8991
  8992 2000-REINSURANCE-ROUTINE.
  8993
  8994     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
  8995
  8996     IF CR-REIN-TABLE = SPACES OR ZEROS
  8997        GO TO 2030-REINSURANCE-ROUTINE-X.
  8998
  8999     MOVE CR-REIN-TABLE          TO REIN-SRCH.
  9000     PERFORM 2040-RR-READ-REIN THRU 2050-RR-READ-REIN-X.
  9001
  9002 2010-REINSURE-ROUTINE-GET-CALC.
* 9003                                 COPY ECSRTPFM.
  9004******************************************************************07/10/97
  9005*                                                                *ECSRTPFM
  9006*                            ECSRTPFM                            *   LV001
  9007*                            VMOD=2.002                          *ECSRTPFM
  9008*                                                                *ECSRTPFM
  9009******************************************************************ECSRTPFM
  9010                                                                  ECSRTPFM
  9011     IF    CR-LFAMT  NUMERIC                                      00000072
  9012           NEXT SENTENCE                                          00000073
  9013        ELSE                                                      00000074
  9014           MOVE ZEROS TO CR-LFAMT.                                00000075
  9015                                                                  00000076
  9016     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
  9017           NEXT SENTENCE                                          00000078
  9018        ELSE                                                      00000079
  9019           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
  9020                                                                  00000081
  9021                                                                  00000082
  9022     IF    CR-LFPRM  NUMERIC                                      00000083
  9023           NEXT SENTENCE                                          00000084
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 176
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
  9024        ELSE                                                      00000085
  9025           MOVE ZEROS TO CR-LFPRM.                                00000086
  9026                                                                  00000087
  9027     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
  9028           NEXT SENTENCE                                          00000089
  9029        ELSE                                                      00000090
  9030           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
  9031                                                                  00000092
  9032                                                                  00000093
  9033     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
  9034           NEXT SENTENCE                                          00000095
  9035        ELSE                                                      00000096
  9036           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
  9037                                                                  00000098
  9038     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
  9039           NEXT SENTENCE                                          00000100
  9040        ELSE                                                      00000101
  9041           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
  9042                                                                  00000103
  9043     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
  9044           NEXT SENTENCE                                          00000105
  9045        ELSE                                                      00000106
  9046           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
  9047                                                                  00000108
  9048     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
  9049     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
  9050     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
  9051         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
  9052     ELSE                                                         ECSRTPFM
  9053         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
  9054     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
  9055                                                                  ECSRTPFM
  9056     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
  9057     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
  9058     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
  9059         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
  9060     ELSE                                                         ECSRTPFM
  9061         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
  9062     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
  9063                                                                  ECSRTPFM
  9064     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
  9065         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
  9066             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
  9067                                                                  ECSRTPFM
  9068
  9069 2020-REINSURE-ROUTINE-SKIP-1.
  9070     PERFORM 2060-REINSURE-CANCEL THRU 2070-REINSURE-CANCEL-X.
  9071
  9072     PERFORM 2080-REINSURE-CLAIM THRU 2090-REINSURE-CLAIM-X
  9073         VARYING YR FROM +1 BY +1
  9074         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9075
  9076     PERFORM 2100-REINSURANCE-EXTRACTS THRU
  9077             3050-REINSURANCE-EXTRACTS-X
  9078             VARYING SUB1 FROM +1 BY +1 UNTIL
  9079             REIN-COMP (SUB1) = SPACES.
  9080
  9081 2030-REINSURANCE-ROUTINE-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 177
* ECS158.cbl
  9082     EXIT.
  9083
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 178
* ECS158.cbl
  9085 2040-RR-READ-REIN.
  9086     IF REIN-OPEN-SW = ' '
  9087        MOVE DTE-CLASIC-COMPANY-CD TO REIN-SRCH-COMP-CD
  9088        MOVE 'X'                   TO REIN-OPEN-SW
  9089        MOVE 'A'                   TO REIN-SRCH-CODE
  9090        OPEN INPUT ERRTBL-IN
  9091        IF ERRTBL-FILE-STATUS NOT = '00' AND '97'
  9092           MOVE ' ERROR ON OPEN ERRTBL ' TO WS-ABEND-MESSAGE
  9093           MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9094           GO TO ABEND-PGM
  9095        ELSE
  9096           PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT.
  9097
  9098     IF REIN-SRCH NOT = SAVE-REIN-SRCH
  9099        MOVE REIN-SRCH   TO SAVE-REIN-SRCH
  9100        MOVE REIN-SEARCH TO RE-CONTROL-PRIMARY
  9101        READ ERRTBL-IN
  9102        IF ERRTBL-FILE-STATUS NOT = '00'
  9103           MOVE ' ERROR ON READ ERRTBL ' TO WS-ABEND-MESSAGE
  9104           MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9105           GO TO ABEND-PGM.
  9106
  9107*    ADD  1 TO WS-RTBL-DB-CNT
  9108*              WS-TOT-RTBL-DB-CNT
  9109*    IF WS-RTBL-DB-CNT > 10000
  9110*       MOVE ZEROS TO WS-RTBL-DB-CNT
  9111*       DISPLAY ' RTBLS  READ ' WS-TOT-RTBL-DB-CNT
  9112*    END-IF
  9113     .
  9114 2050-RR-READ-REIN-X.
  9115     EXIT.
  9116
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 179
* ECS158.cbl
  9118 2060-REINSURE-CANCEL.
  9119
  9120     IF REIN-COMP (1) = SPACES
  9121        GO TO 2070-REINSURE-CANCEL-X.
  9122
  9123     IF CR-LFRFND = +0 AND
  9124        CR-AHRFND = +0
  9125        GO TO 2070-REINSURE-CANCEL-X.
  9126
  9127     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
  9128             VARYING SUB1 FROM +1 BY +1 UNTIL
  9129                       REIN-COMP (SUB1) = SPACES.
  9130
  9131 2070-REINSURE-CANCEL-X.
  9132     EXIT.
  9133
  9134 2080-REINSURE-CLAIM.
  9135
  9136     IF REIN-COMP (1) = SPACES
  9137        GO TO 2090-REINSURE-CLAIM-X.
  9138
  9139     IF CERT-NO-CLAIM
  9140        GO TO 2090-REINSURE-CLAIM-X.
  9141
  9142     MOVE WS-CLAIM-AMT (1 1 YR) TO RW-LFCLMWK.
  9143     MOVE WS-CLAIM-AMT (2 1 YR) TO RW-AHCLMWK.
  9144     MOVE +0                    TO RW-LFCLM
  9145                                   RW-AHCLM.
  9146
  9147     IF RW-LFCLMWK = +0
  9148         AND RW-AHCLMWK = +0
  9149             GO TO 2090-REINSURE-CLAIM-X.
  9150
  9151     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
  9152                  VARYING SUB1 FROM +1 BY +1 UNTIL
  9153                            REIN-COMP (SUB1) = SPACES.
  9154
  9155     MOVE RWF-LFCLML TO WS-CLAIM-AMT (1 2 YR)
  9156     MOVE RWF-AHCLML TO WS-CLAIM-AMT (2 2 YR).
  9157
  9158 2090-REINSURE-CLAIM-X.
  9159     EXIT.
  9160
  9161
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 180
* ECS158.cbl
  9163 2100-REINSURANCE-EXTRACTS.
  9164
  9165     IF REIN-LF-AH-FLGS (SUB1) = SPACES
  9166        GO TO 3050-REINSURANCE-EXTRACTS-X.
  9167
  9168     IF REIN-REM-SW (SUB1) = 'Z'
  9169        GO TO 3050-REINSURANCE-EXTRACTS-X.
  9170
  9171     MOVE HOLD-LIFE-RECORD      TO CALL-EXTRACT.
  9172
  9173     MOVE REIN-COMP (SUB1)      TO EX-REIN.
  9174     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
  9175
  9176     MOVE ZEROS                 TO  EX-PREM
  9177                        EX-PRIM-FAC-PREM
  9178                           EX-OVR-COMM (1)
  9179                          EX-OVR-COMM (2)
  9180                          EX-OVR-COMM (3)
  9181                            EX-AGT-COMM (1)
  9182                            EX-AGT-COMM (2)
  9183                            EX-AGT-COMM (3)
  9184                            EX-INITIAL-AMT
  9185                            EX-BENEFIT
  9186                            EX-CNC-AMT (1)
  9187                            EX-CNC-AMT (2)
  9188                            EX-CNC-AMT (3)
  9189                            EX-CLAIM-AMT (1)
  9190                            EX-CLAIM-AMT (2)
  9191                            EX-CLAIM-AMT (3).
  9192
  9193
  9194     IF REIN-LF-FLG (SUB1) = 'X'
  9195         MOVE RWF-LFAMT          TO EX-INITIAL-AMT
  9196         MOVE RWF-LFPRM          TO EX-PREM
  9197                                    EX-PRIM-FAC-PREM
  9198         MOVE CR-LFTYP           TO EX-BEN-TYPE
  9199     ELSE
  9200         MOVE ZEROS              TO EX-BEN-TYPE.
  9201
  9202     IF REIN-LF-FLG (SUB1) = 'X'
  9203        IF SINGLE-PERIOD-PROCESS
  9204            IF LF-CAN GREATER THAN BEGIN-DT (1) AND
  9205               LF-CAN NOT GREATER THAN END-DT (1)
  9206               MOVE RWF-LFRFND   TO EX-CNC-AMT (1)
  9207            ELSE
  9208               NEXT SENTENCE
  9209        ELSE
  9210        IF LF-CAN GREATER THAN BEGIN-DT (1) AND
  9211           LF-CAN NOT GREATER THAN END-DT (1)
  9212           MOVE RWF-LFRFND       TO EX-CNC-AMT (1)
  9213        ELSE
  9214        IF LF-CAN GREATER THAN BEGIN-DT (2) AND
  9215           LF-CAN NOT GREATER THAN END-DT (2)
  9216           MOVE RWF-LFRFND       TO EX-CNC-AMT (2)
  9217        ELSE
  9218        IF LF-CAN GREATER THAN BEGIN-DT (3) AND
  9219           LF-CAN NOT GREATER THAN END-DT (3)
  9220           MOVE RWF-LFRFND       TO EX-CNC-AMT (3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 181
* ECS158.cbl
  9221
  9222     IF (REIN-LF-FLG (SUB1) = 'X') AND
  9223        (CR-LFPRM NOT = +0)
  9224        COMPUTE LF-DEV-TO-PRIM-FACTOR =
  9225              (WS-HOLD-LF-PRIM-FAC / CR-LFPRM)
  9226        COMPUTE EX-PRIM-FAC-PREM =
  9227              (LF-DEV-TO-PRIM-FACTOR * EX-PREM).
  9228
  9229 2110-DO-REIN-LF-CLM.
  9230
  9231     IF SINGLE-PERIOD-PROCESS
  9232         MOVE WS-CLAIM-AMT (1 2 1) TO EX-CLAIM-AMT (1)
  9233         MOVE WS-CLAIM-AMT (1 2 2) TO EX-CLAIM-AMT (2)
  9234     ELSE
  9235         MOVE WS-CLAIM-AMT (1 2 1) TO EX-CLAIM-AMT (1)
  9236         MOVE WS-CLAIM-AMT (1 2 2) TO EX-CLAIM-AMT (2)
  9237         MOVE WS-CLAIM-AMT (1 2 3) TO EX-CLAIM-AMT (3).
  9238
  9239     MOVE +0 TO SB.
  9240
  9241 2120-DO-REIN-LF-ISS-COMM.
  9242
  9243     ADD +1                      TO SB.
  9244     IF SB GREATER THAN NUMBER-OF-PERIODS
  9245         MOVE +0      TO SB
  9246         GO TO 2130-DO-REIN-LF-CNC-COMM.
  9247
  9248     IF EX-PREM = +0
  9249        GO TO 2120-DO-REIN-LF-ISS-COMM.
  9250
  9251     IF ENTRY-DT GREATER THAN BEGIN-DT (SB) AND
  9252        NOT GREATER THAN END-DT (SB)
  9253        MOVE +1                     TO SV-FACTOR
  9254        MOVE EX-PREM                TO COMM-PREMM
  9255        MOVE 'X'                    TO FROM-REIN
  9256        PERFORM 5000-COMMISSIONS-LIFE THRU 5020-L-COMM-EXIT.
  9257
  9258     GO TO 2120-DO-REIN-LF-ISS-COMM.
  9259
  9260 2130-DO-REIN-LF-CNC-COMM.
  9261
  9262     ADD +1                      TO SB.
  9263     IF SB GREATER THAN NUMBER-OF-PERIODS
  9264         GO TO 2140-END-LIFE-REIN.
  9265
  9266     IF EX-CNC-AMT (SB) = +0
  9267        GO TO 2130-DO-REIN-LF-CNC-COMM.
  9268
  9269     MOVE -1                     TO SV-FACTOR.
  9270     MOVE EX-CNC-AMT (SB)        TO COMM-PREMM.
  9271     MOVE 'X'                    TO FROM-REIN.
  9272     PERFORM 5000-COMMISSIONS-LIFE THRU 5020-L-COMM-EXIT.
  9273
  9274     GO TO 2130-DO-REIN-LF-CNC-COMM.
  9275
  9276 2140-END-LIFE-REIN.
  9277
  9278     MOVE EX-PREM TO WRK-C.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 182
* ECS158.cbl
  9279     MOVE +0          TO WRK-ALT.
  9280
  9281     PERFORM 0480-CALC-LIFE-UNEARN THRU 0530-CALC-UNEARN-FINISH
  9282         VARYING YR FROM +1 BY +1
  9283         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9284
  9285     PERFORM 0430-BUILD-LF-DEV-RESERVES
  9286         VARYING YR FROM +1 BY +1
  9287         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9288
  9289     IF EX-PREM NOT = EX-PRIM-FAC-PREM
  9290        MOVE EX-PRIM-FAC-PREM TO WRK-C
  9291        MOVE +0               TO WRK-ALT
  9292        PERFORM 0480-CALC-LIFE-UNEARN THRU
  9293                             0540-LIFE-UNEARN-EXIT
  9294            VARYING YR FROM +1 BY +1
  9295            UNTIL YR GREATER THAN NUMBER-OF-PERIODS
  9296        PERFORM 0450-BUILD-LF-PRI-RESERVES
  9297            VARYING YR FROM +1 BY +1
  9298            UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9299
  9300     IF DTE-PGM-OPT NOT = '3' AND '4'
  9301        GO TO 2150-BYPASS-LF-DETAIL-REIN.
  9302
  9303     MOVE EX-CARRIER           TO D-CARR.
  9304     MOVE EX-GROUPING          TO D-GROUP.
  9305     MOVE EX-STATE             TO D-STATE.
  9306     MOVE EX-ACCOUNT           TO D-ACCOUNT.
  9307     MOVE CR-CERT-NO           TO D-CERT-NO.
  9308
  9309     MOVE 'L'                  TO DC-OPTION-CODE.
  9310     MOVE EX-EFF-DATE          TO DC-GREG-DATE-CYMD.
  9311     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  9312     MOVE DC-GREG-DATE-1-EDIT  TO D-EFF-DATE.
  9313
  9314     MOVE EX-PREM              TO D-PREM.
  9315     MOVE EX-PRIM-FAC-PREM     TO D-PRI-PREM.
  9316     MOVE EX-TERM              TO D-TERM.
  9317     MOVE M2 (1)               TO D-REM-TERM.
  9318     MOVE EX-END-ST-RES (1)    TO D-UNEARN.
  9319     MOVE EX-INITIAL-AMT       TO D-BENEFIT.
  9320     MOVE 'L'                  TO D-L-A.
  9321     MOVE 'LIFE REIN '         TO D-BEN-DESC.
  9322
  9323     PERFORM 1600-PRINT-A-LINE.
  9324
  9325 2150-BYPASS-LF-DETAIL-REIN.
  9326
  9327     PERFORM 1520-RELEASE-SORT-RECORD THRU 1540-RELEASE-EXIT.
  9328
  9329 3000-DO-AH-REIN.
  9330
  9331     MOVE HOLD-AH-RECORD        TO CALL-EXTRACT.
  9332
  9333     MOVE REIN-COMP (SUB1)      TO EX-REIN.
  9334
  9335     MOVE ZEROS                 TO EX-PREM
  9336                                   EX-PRIM-FAC-PREM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 183
* ECS158.cbl
  9337                                   EX-OVR-COMM (1)
  9338                                   EX-OVR-COMM (2)
  9339                                   EX-OVR-COMM (3)
  9340                                   EX-AGT-COMM (1)
  9341                                   EX-AGT-COMM (2)
  9342                                   EX-AGT-COMM (3)
  9343                                   EX-INITIAL-AMT
  9344                                   EX-BENEFIT
  9345                                   EX-CNC-AMT (1)
  9346                                   EX-CNC-AMT (2)
  9347                                   EX-CNC-AMT (3)
  9348                                   EX-CLAIM-AMT (1)
  9349                                   EX-CLAIM-AMT (2)
  9350                                   EX-CLAIM-AMT (3).
  9351
  9352     IF REIN-AH-FLG (SUB1) = 'X'
  9353         MOVE RWF-AHAMT          TO EX-BENEFIT
  9354         MOVE RWF-AHPRM          TO EX-PREM
  9355                                    EX-PRIM-FAC-PREM
  9356         MOVE CR-AHTYP           TO EX-BEN-TYPE
  9357     ELSE
  9358         MOVE ZEROS              TO EX-BEN-TYPE.
  9359
  9360     IF REIN-AH-FLG (SUB1) = 'X'
  9361        IF SINGLE-PERIOD-PROCESS
  9362            IF AH-CAN GREATER THAN BEGIN-DT (1) AND
  9363               AH-CAN NOT GREATER THAN END-DT (1)
  9364               MOVE RWF-AHRFND   TO EX-CNC-AMT (1)
  9365            ELSE
  9366               NEXT SENTENCE
  9367        ELSE
  9368        IF AH-CAN GREATER THAN BEGIN-DT (1) AND
  9369           AH-CAN NOT GREATER THAN END-DT (1)
  9370           MOVE RWF-AHRFND       TO EX-CNC-AMT (1)
  9371        ELSE
  9372        IF AH-CAN GREATER THAN BEGIN-DT (2) AND
  9373           AH-CAN NOT GREATER THAN END-DT (2)
  9374           MOVE RWF-AHRFND       TO EX-CNC-AMT (2)
  9375        ELSE
  9376        IF AH-CAN GREATER THAN BEGIN-DT (3) AND
  9377           AH-CAN NOT GREATER THAN END-DT (3)
  9378           MOVE RWF-AHRFND       TO EX-CNC-AMT (3).
  9379
  9380     IF (REIN-AH-FLG (SUB1) = 'X') AND
  9381        (CR-AHPRM NOT = +0)
  9382        COMPUTE AH-DEV-TO-PRIM-FACTOR =
  9383              (WS-HOLD-AH-PRIM-FAC / CR-AHPRM)
  9384        COMPUTE EX-PRIM-FAC-PREM =
  9385              (AH-DEV-TO-PRIM-FACTOR * EX-PREM).
  9386
  9387 3010-DO-REIN-AH-CLM.
  9388
  9389     IF SINGLE-PERIOD-PROCESS
  9390         MOVE WS-CLAIM-AMT (2 2 1) TO EX-CLAIM-AMT (1)
  9391         MOVE WS-CLAIM-AMT (2 2 2) TO EX-CLAIM-AMT (2)
  9392     ELSE
  9393         MOVE WS-CLAIM-AMT (2 2 1) TO EX-CLAIM-AMT (1)
  9394         MOVE WS-CLAIM-AMT (2 2 2) TO EX-CLAIM-AMT (2)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 184
* ECS158.cbl
  9395         MOVE WS-CLAIM-AMT (2 2 3) TO EX-CLAIM-AMT (3).
  9396
  9397     MOVE +0                     TO SB.
  9398
  9399 3020-DO-REIN-AH-ISS-COMM.
  9400
  9401     ADD +1 TO SB.
  9402     IF SB GREATER THAN NUMBER-OF-PERIODS
  9403         MOVE +0      TO SB
  9404         GO TO 3030-DO-REIN-AH-CNC-COMM.
  9405
  9406     IF EX-PREM = +0
  9407        GO TO 3020-DO-REIN-AH-ISS-COMM.
  9408
  9409     IF ENTRY-DT GREATER THAN BEGIN-DT (SB) AND
  9410        NOT GREATER THAN END-DT (SB)
  9411        MOVE +1                     TO SV-FACTOR
  9412        MOVE EX-PREM                TO COMM-PREMM
  9413        MOVE 'X'                    TO FROM-REIN
  9414        PERFORM 5030-COMMISSIONS-AH THRU 5050-A-COMM-EXIT.
  9415
  9416     GO TO 3020-DO-REIN-AH-ISS-COMM.
  9417
  9418 3030-DO-REIN-AH-CNC-COMM.
  9419
  9420     ADD +1 TO SB.
  9421     IF SB GREATER THAN NUMBER-OF-PERIODS
  9422         GO TO 3040-END-AH-REIN.
  9423
  9424     IF EX-CNC-AMT (SB) = +0
  9425        GO TO 3030-DO-REIN-AH-CNC-COMM.
  9426
  9427     MOVE -1                     TO SV-FACTOR.
  9428     MOVE EX-CNC-AMT (SB)        TO COMM-PREMM.
  9429     MOVE 'X'                    TO FROM-REIN.
  9430     PERFORM 5030-COMMISSIONS-AH THRU 5050-A-COMM-EXIT.
  9431
  9432     GO TO 3030-DO-REIN-AH-CNC-COMM.
  9433
  9434 3040-END-AH-REIN.
  9435
  9436     MOVE EX-PREM TO WRK-C.
  9437
  9438*    PERFORM 1200-CALC-AH-UNEARN THRU 1299-AH-UNEARN-EXIT
  9439     PERFORM 1200-CALC-AH-UNEARN THRU 1200-EXIT
  9440         VARYING YR FROM +1 BY +1
  9441         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9442
  9443     PERFORM 1150-BUILD-AH-DEV-RESERVES
  9444         VARYING YR FROM +1 BY +1
  9445         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9446
  9447     IF EX-PREM NOT = EX-PRIM-FAC-PREM
  9448        MOVE EX-PRIM-FAC-PREM TO WRK-C
  9449*       PERFORM 1200-CALC-AH-UNEARN THRU 1299-AH-UNEARN-EXIT
  9450        PERFORM 1200-CALC-AH-UNEARN THRU 1200-EXIT
  9451            VARYING YR FROM +1 BY +1
  9452            UNTIL YR GREATER THAN NUMBER-OF-PERIODS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 185
* ECS158.cbl
  9453            PERFORM 1170-BUILD-AH-PRI-RESERVES
  9454                VARYING YR FROM +1 BY +1
  9455                UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9456
  9457     IF DTE-PGM-OPT NOT = '3' AND '4'
  9458        GO TO 3050-BYPASS-AH-DETAIL-REIN.
  9459
  9460     MOVE EX-CARRIER           TO D-CARR.
  9461     MOVE EX-GROUPING          TO D-GROUP.
  9462     MOVE EX-STATE             TO D-STATE.
  9463     MOVE EX-ACCOUNT           TO D-ACCOUNT.
  9464     MOVE CR-CERT-NO           TO D-CERT-NO.
  9465
  9466     MOVE 'L'                  TO DC-OPTION-CODE.
  9467     MOVE EX-EFF-DATE          TO DC-GREG-DATE-CYMD.
  9468     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  9469     MOVE DC-GREG-DATE-1-EDIT  TO D-EFF-DATE.
  9470
  9471     MOVE EX-PREM              TO D-PREM.
  9472     MOVE EX-PRIM-FAC-PREM     TO D-PRI-PREM.
  9473     MOVE EX-TERM              TO D-TERM.
  9474     MOVE M2 (1)               TO D-REM-TERM.
  9475     MOVE EX-END-ST-RES (1)    TO D-UNEARN.
  9476     MOVE EX-BENEFIT           TO D-BENEFIT.
  9477     MOVE 'A'                  TO D-L-A.
  9478     MOVE ' AH REIN'           TO D-BEN-DESC.
  9479
  9480     PERFORM 1600-PRINT-A-LINE.
  9481
  9482 3050-BYPASS-AH-DETAIL-REIN.
  9483
  9484     PERFORM 1520-RELEASE-SORT-RECORD THRU 1540-RELEASE-EXIT.
  9485
  9486 3050-REINSURANCE-EXTRACTS-X.
  9487     EXIT.
  9488
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 186
* ECS158.cbl
  9490 4000-REINSURANCE-ROUTINES.
* 9491                             COPY ECSRIRTN.
  9492******************************************************************04/30/98
  9493*                                                                *ECSRIRTN
  9494*                            ECSRIRTN                            *   LV012
  9495*                            VMOD=2.025.                         *ECSRIRTN
  9496*                                                                *ECSRIRTN
  9497******************************************************************ECSRIRTN
  9498******************************************************************
  9499*                   C H A N G E   L O G
  9500*
  9501* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9502*-----------------------------------------------------------------
  9503*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9504* EFFECTIVE    NUMBER
  9505*-----------------------------------------------------------------
  9506* 062703                   PEMA  ADD DCC CLIENT ID TO
  9507*                                SPECIAL CEDED CLAIM CALC
  9508* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9509                                                                  ECSRIRTN
  9510 REINSURE-CALC.                                                   ECSRIRTN
  9511                                                                  ECSRIRTN
  9512     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
  9513     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  9514     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
  9515     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
  9516                                   REIN-REM-SW (SUB1).            ECSRIRTN
  9517                                                                  ECSRIRTN
  9518     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
  9519                                   WS-RWF-EP-STOP-DATE-N             CL*12
  9520                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
  9521                                                                  ECSRIRTN
  9522     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
  9523                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
  9524                                   RWF-AH-RUNOFF-SW               ECSRIRTN
  9525                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  9526                                                                  ECSRIRTN
  9527     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  9528        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  9529          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  9530          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  9531          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  9532                                                                  ECSRIRTN
  9533     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  9534        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  9535         GO TO CALC-CONTINUED.                                    ECSRIRTN
  9536                                                                  ECSRIRTN
  9537     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
  9538                                          WS-RWF-EP-STOP-DATE-N      CL*12
  9539                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
  9540                                                                  ECSRIRTN
  9541     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
  9542         GO TO CALC-CONTINUED.                                    ECSRIRTN
  9543                                                                  ECSRIRTN
  9544     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
  9545         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
  9546                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
  9547                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 187
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9548     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
  9549         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
  9550                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  9551                                                                  ECSRIRTN
  9552 CALC-CONTINUED.                                                  ECSRIRTN
  9553                                                                  ECSRIRTN
  9554     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
  9555     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
  9556                                                                  ECSRIRTN
  9557     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
  9558         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
  9559     ELSE                                                         ECSRIRTN
  9560         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
  9561     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
  9562                                                                  ECSRIRTN
  9563     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
  9564     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
  9565     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
  9566         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
  9567     ELSE                                                         ECSRIRTN
  9568         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
  9569     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
  9570                                                                  ECSRIRTN
  9571     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
  9572         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
  9573         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
  9574         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
  9575         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
  9576         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
  9577         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
  9578                                                                  ECSRIRTN
  9579     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  9580         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
  9581                                                                  ECSRIRTN
  9582     IF CR-DT LESS WT-LO-DATE                                        CL**2
  9583         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  9584                                                                  ECSRIRTN
  9585     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
  9586         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  9587                                                                  ECSRIRTN
  9588     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
  9589     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
  9590                                                                  ECSRIRTN
  9591     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
  9592         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
  9593                                                                  ECSRIRTN
  9594     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
  9595       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  9596        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
  9597        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  9598           NEXT SENTENCE                                          ECSRIRTN
  9599       ELSE                                                       ECSRIRTN
  9600           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
  9601                       REIN-AH-FLG (SUB1).                        ECSRIRTN
  9602                                                                  ECSRIRTN
  9603     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  9604         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
  9605            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 188
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9606             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
  9607                                                                  ECSRIRTN
  9608     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  9609         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
  9610            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
  9611             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
  9612                                                                  ECSRIRTN
  9613     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
  9614         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
  9615             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
  9616                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
  9617             ELSE                                                 ECSRIRTN
  9618                 NEXT SENTENCE                                    ECSRIRTN
  9619         ELSE                                                     ECSRIRTN
  9620             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  9621                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  9622                                                                  ECSRIRTN
  9623     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
  9624         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
  9625             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
  9626                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
  9627             ELSE                                                 ECSRIRTN
  9628                 NEXT SENTENCE                                    ECSRIRTN
  9629         ELSE                                                     ECSRIRTN
  9630             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  9631                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  9632                                                                  ECSRIRTN
  9633     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
  9634         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
  9635                                                                  ECSRIRTN
  9636     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
  9637         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
  9638         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  9639                                                                  ECSRIRTN
  9640     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
  9641         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
  9642                                                                  ECSRIRTN
  9643     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
  9644         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
  9645         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
  9646                                                                  ECSRIRTN
  9647     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  9648         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  9649                                                                  ECSRIRTN
  9650     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  9651         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  9652                                                                  ECSRIRTN
  9653     GO TO REINSURE-CALC-X.                                       ECSRIRTN
  9654                                                                  ECSRIRTN
  9655 REINSURE-CK-LIFE.                                                ECSRIRTN
  9656                                                                  ECSRIRTN
  9657     IF CR-LFTYP = ZERO                                           ECSRIRTN
  9658         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9659                                                                  ECSRIRTN
  9660     IF WT-LF-PCT = ZERO                                          ECSRIRTN
  9661         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9662                                                                  ECSRIRTN
  9663     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 189
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9664         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
  9665             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9666                                                                  ECSRIRTN
  9667     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  9668                                                                  ECSRIRTN
  9669     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
  9670         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
  9671             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  9672         ELSE                                                     ECSRIRTN
  9673             NEXT SENTENCE                                        ECSRIRTN
  9674     ELSE                                                         ECSRIRTN
  9675         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
  9676             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9677                                                                  ECSRIRTN
  9678     IF CEDING-AD-D-ONLY                                          ECSRIRTN
  9679         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
  9680             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  9681         ELSE                                                     ECSRIRTN
  9682             NEXT SENTENCE                                        ECSRIRTN
  9683     ELSE                                                         ECSRIRTN
  9684         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
  9685             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9686                                                                  ECSRIRTN
  9687     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  9688         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
  9689             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9690                                                                  ECSRIRTN
  9691     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  9692         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
  9693            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  9694                                                                  ECSRIRTN
  9695     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
  9696         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
  9697             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9698                                                                  ECSRIRTN
  9699     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
  9700         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
  9701            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  9702                                                                  ECSRIRTN
  9703     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  9704         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  9705             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9706                                                                  ECSRIRTN
  9707     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
  9708         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  9709            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
  9710            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
  9711             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9712                                                                  ECSRIRTN
  9713     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
  9714         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  9715            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
  9716             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9717                                                                  ECSRIRTN
  9718     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  9719         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
  9720             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9721                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 190
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9722     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  9723         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
  9724             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9725                                                                  ECSRIRTN
  9726     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
  9727        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
  9728           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
  9729            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  9730                                                                  ECSRIRTN
  9731     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  9732         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  9733            CR-IND-GRP = '1'                                      ECSRIRTN
  9734             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9735                                                                  ECSRIRTN
  9736     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
  9737         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  9738            CR-IND-GRP = '1'                                      ECSRIRTN
  9739             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9740                                                                  ECSRIRTN
  9741     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
  9742         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  9743            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
  9744            CR-IND-GRP = '1'                                      ECSRIRTN
  9745             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9746                                                                  ECSRIRTN
  9747     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
  9748         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  9749            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  9750            CR-IND-GRP = '1'                                      ECSRIRTN
  9751             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9752                                                                  ECSRIRTN
  9753     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  9754         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
  9755            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  9756                                                                  ECSRIRTN
  9757     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  9758        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
  9759                                                                  ECSRIRTN
  9760     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
  9761         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9762                                                                  ECSRIRTN
  9763     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
  9764         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9765                                                                  ECSRIRTN
  9766     IF CR-LF-TERM  NUMERIC                                       00002331
  9767        NEXT SENTENCE                                             00002332
  9768     ELSE                                                         00002333
  9769        MOVE ZEROS               TO CR-LF-TERM                    00002334
  9770     END-IF
  9771                                                                  00002335
  9772     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
  9773         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9774                                                                  ECSRIRTN
  9775     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
  9776         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9777                                                                  ECSRIRTN
  9778     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  9779                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 191
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9780     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
  9781         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9782                                                                  ECSRIRTN
  9783     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
  9784         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9785                                                                  ECSRIRTN
  9786     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  9787                                                                  ECSRIRTN
  9788 REINSURE-CK-LIFE-X.                                              ECSRIRTN
  9789     EXIT.                                                        ECSRIRTN
  9790                                                                  ECSRIRTN
  9791 REINSURE-CK-AH.                                                  ECSRIRTN
  9792                                                                  ECSRIRTN
  9793     IF CR-AHTYP = ZERO                                           ECSRIRTN
  9794         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9795                                                                  ECSRIRTN
  9796     IF WT-AH-PCT = ZERO                                          ECSRIRTN
  9797         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9798                                                                  ECSRIRTN
  9799     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  9800         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
  9801             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9802                                                                  ECSRIRTN
  9803     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  9804                                                                  ECSRIRTN
  9805     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
  9806         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
  9807             GO TO REINSURE-CK-AH-X                               ECSRIRTN
  9808         ELSE                                                     ECSRIRTN
  9809             NEXT SENTENCE                                        ECSRIRTN
  9810     ELSE                                                         ECSRIRTN
  9811         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
  9812             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9813                                                                  ECSRIRTN
  9814     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  9815         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
  9816             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9817                                                                  ECSRIRTN
  9818     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  9819         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
  9820             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9821                                                                  ECSRIRTN
  9822     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  9823         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
  9824             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9825                                                                  ECSRIRTN
  9826     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  9827         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  9828             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9829                                                                  ECSRIRTN
  9830     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  9831         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
  9832            CR-IND-GRP = '1'                                      ECSRIRTN
  9833             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9834                                                                  ECSRIRTN
  9835     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  9836         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
  9837             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 192
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9838                                                                  ECSRIRTN
  9839     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  9840         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
  9841            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  9842                                                                  ECSRIRTN
  9843     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
  9844         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
  9845            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  9846                                                                  ECSRIRTN
  9847     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
  9848         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
  9849             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9850                                                                  ECSRIRTN
  9851     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  9852        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
  9853                                                                  ECSRIRTN
  9854     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
  9855         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9856                                                                  ECSRIRTN
  9857     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
  9858         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9859                                                                  ECSRIRTN
  9860     IF CR-AH-TERM  NUMERIC                                       00002331
  9861        NEXT SENTENCE                                             00002332
  9862     ELSE                                                         00002333
  9863        MOVE ZEROS               TO CR-AH-TERM                    00002334
  9864     END-IF
  9865                                                                  00002335
  9866     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
  9867         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9868                                                                  ECSRIRTN
  9869     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
  9870         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9871                                                                  ECSRIRTN
  9872     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  9873                                                                  ECSRIRTN
  9874     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
  9875         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
  9876             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
  9877                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
  9878                                                                  ECSRIRTN
  9879     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
  9880         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
  9881             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
  9882                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
  9883                                                                  ECSRIRTN
  9884     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
  9885     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
  9886                                                                  ECSRIRTN
  9887     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
  9888         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
  9889                                                                  ECSRIRTN
  9890     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
  9891         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
  9892                                                                  ECSRIRTN
  9893     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
  9894                                                                  ECSRIRTN
  9895     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 193
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9896                                                                  ECSRIRTN
  9897     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
  9898         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9899                                                                  ECSRIRTN
  9900     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  9901         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9902                                                                  ECSRIRTN
  9903     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  9904                                                                  ECSRIRTN
  9905 REINSURE-CK-AH-X.                                                ECSRIRTN
  9906     EXIT.                                                        ECSRIRTN
  9907                                                                  ECSRIRTN
  9908 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
  9909                                                                  ECSRIRTN
  9910     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
  9911        RS-AH-BEN = ZERO                                          ECSRIRTN
  9912         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  9913                                                                  ECSRIRTN
  9914     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
  9915        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  9916         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  9917                                                                  ECSRIRTN
  9918     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
  9919                                    REIN-AH-FLG (SUB1).           ECSRIRTN
  9920                                                                  ECSRIRTN
  9921     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  9922         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  9923             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
  9924                                     WT-AHBEN-HI.                 ECSRIRTN
  9925     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  9926         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  9927             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
  9928                                     WT-AHMOA-HI.                 ECSRIRTN
  9929                                                                  ECSRIRTN
  9930     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  9931     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  9932                                                                  ECSRIRTN
  9933     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  9934         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
  9935                                                                  ECSRIRTN
  9936     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  9937         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
  9938                                                                  ECSRIRTN
  9939     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  9940                                                                  ECSRIRTN
  9941     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  9942         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
  9943                                                                  ECSRIRTN
  9944     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
  9945         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
  9946                                       / RW-AHWRK                 ECSRIRTN
  9947       ELSE                                                       ECSRIRTN
  9948         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
  9949                                                                  ECSRIRTN
  9950     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
  9951         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
  9952                                       / RS-LIFE-BEN              ECSRIRTN
  9953       ELSE                                                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 194
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9954         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
  9955                                                                  ECSRIRTN
  9956     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
  9957        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
  9958          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  9959          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  9960                                      / CR-AH-TERM.               ECSRIRTN
  9961                                                                  ECSRIRTN
  9962     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  9963        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
  9964          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  9965          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  9966               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  9967            ELSE                                                  ECSRIRTN
  9968                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  9969                                                                  ECSRIRTN
  9970     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  9971        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
  9972        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
  9973          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  9974          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  9975                                      / CR-AH-TERM                ECSRIRTN
  9976         ELSE                                                     ECSRIRTN
  9977          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  9978          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  9979               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  9980            ELSE                                                  ECSRIRTN
  9981                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  9982                                                                  ECSRIRTN
  9983 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
  9984     EXIT.                                                        ECSRIRTN
  9985                                                                  ECSRIRTN
  9986                                                                  ECSRIRTN
  9987 REIN-CALC-LIFE.                                                  ECSRIRTN
  9988                                                                  ECSRIRTN
  9989     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
  9990         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
  9991     ELSE                                                         ECSRIRTN
  9992         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
  9993                                                                  ECSRIRTN
  9994     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
  9995         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
  9996     ELSE                                                         ECSRIRTN
  9997         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
  9998           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
  9999               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 10000           ELSE                                                   ECSRIRTN
 10001               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 10002                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 10003                                                                  ECSRIRTN
 10004 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 10005                                                                  ECSRIRTN
 10006     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
 10007                                                                  ECSRIRTN
 10008     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10009         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 10010                                                                  ECSRIRTN
 10011     IF WT-REMAINING = 'L'                                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 195
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10012         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 10013         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 10014                                                                  ECSRIRTN
 10015     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 10016         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 10017                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 10018         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 10019                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 10020     ELSE                                                         ECSRIRTN
 10021         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 10022             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 10023             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 10024                                                                  ECSRIRTN
 10025     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 10026         (WT-LF-QC = '2' AND                                         CL**8
 10027          PGM-SUB = +50  AND                                         CL**8
 10028          DTE-CLIENT = 'LAP'))                                       CL**8
 10029          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 10030     ELSE                                                         ECSRIRTN
 10031         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 10032                                                                  ECSRIRTN
 10033     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 10034         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 10035         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 10036         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 10037                                                                  ECSRIRTN
 10038     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 10039                                                                  ECSRIRTN
 10040 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 10041                                                                  ECSRIRTN
 10042     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 10043         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 10044         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 10045                                                                  ECSRIRTN
 10046     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 10047     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 10048     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 10049                                       RW-LFPRM.                  ECSRIRTN
 10050                                                                  ECSRIRTN
 10051 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 10052                                                                  ECSRIRTN
 10053     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 10054                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 10055                                                                  ECSRIRTN
 10056     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 10057        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 10058                                                                  ECSRIRTN
 10059     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 10060        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 10061         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 10062     ELSE                                                         ECSRIRTN
 10063         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 10064         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
 10065                                                                  ECSRIRTN
 10066                                                                  ECSRIRTN
 10067 REIN-CALC-LIFE-X.                                                ECSRIRTN
 10068     EXIT.                                                        ECSRIRTN
 10069                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 196
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10070 REIN-CALC-AH.                                                    ECSRIRTN
 10071                                                                  ECSRIRTN
 10072     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 10073         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 10074             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 10075                                 WT-AHBEN-HI.                     ECSRIRTN
 10076                                                                  ECSRIRTN
 10077     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 10078         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 10079             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 10080                                 WT-AHMOA-HI.                     ECSRIRTN
 10081                                                                  ECSRIRTN
 10082     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 10083     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 10084                                                                  ECSRIRTN
 10085     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 10086         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 10087                                                                  ECSRIRTN
 10088     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 10089         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 10090                                                                  ECSRIRTN
 10091     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 10092         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 10093                                                                  ECSRIRTN
 10094     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 10095         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 10096     ELSE                                                         ECSRIRTN
 10097         IF WT-REMAINING = 'L'                                    ECSRIRTN
 10098             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 10099         ELSE                                                     ECSRIRTN
 10100             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 10101             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 10102                                                                  ECSRIRTN
 10103 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 10104                                                                  ECSRIRTN
 10105     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10106         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 10107                                                                  ECSRIRTN
 10108     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10109         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 10110         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 10111                                                                  ECSRIRTN
 10112     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 10113         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 10114                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 10115         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 10116                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 10117     ELSE                                                         ECSRIRTN
 10118         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 10119             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 10120             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 10121                                                                  ECSRIRTN
 10122     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
 10123         (WT-AH-QC = '2' AND                                         CL**8
 10124          PGM-SUB = +50  AND                                         CL**8
 10125          DTE-CLIENT = 'LAP'))                                       CL**8
 10126         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 10127     ELSE                                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 197
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10128         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 10129                                                                  ECSRIRTN
 10130     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 10131         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 10132            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 10133                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 10134                                                                  ECSRIRTN
 10135     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 10136         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 10137         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 10138         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 10139                                                                  ECSRIRTN
 10140     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 10141                                                                  ECSRIRTN
 10142 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 10143                                                                  ECSRIRTN
 10144     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 10145         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 10146         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 10147                                                                  ECSRIRTN
 10148     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 10149     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 10150     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 10151                                    RW-AHPRM.                     ECSRIRTN
 10152                                                                  ECSRIRTN
 10153 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 10154                                                                  ECSRIRTN
 10155     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 10156                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 10157                                                                  ECSRIRTN
 10158     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 10159                                                                  ECSRIRTN
 10160     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 10161        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 10162         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 10163     ELSE                                                         ECSRIRTN
 10164         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 10165         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 10166                                                                  ECSRIRTN
 10167                                                                  ECSRIRTN
 10168 REIN-CALC-AH-X.                                                  ECSRIRTN
 10169     EXIT.                                                        ECSRIRTN
 10170                                                                  ECSRIRTN
 10171 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 10172                                                                  ECSRIRTN
 10173     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 10174     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 10175     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 10176     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 10177                                                                  ECSRIRTN
 10178     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 10179         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 10180                                                                  ECSRIRTN
 10181     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 10182        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 10183           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 10184                                                                  ECSRIRTN
 10185     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 198
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10186        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 10187           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 10188                                                                  ECSRIRTN
 10189 REINSURE-CALC-X.                                                 ECSRIRTN
 10190                                                                  ECSRIRTN
 10191     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 10192         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 10193                                                                  ECSRIRTN
 10194     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 10195                                                                  ECSRIRTN
 10196 REINSURE-SUBTRACT.                                               ECSRIRTN
 10197                                                                  ECSRIRTN
 10198     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 10199     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 10200     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 10201     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 10202                                                                  ECSRIRTN
 10203 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 10204     EXIT.                                                        ECSRIRTN
 10205                                                                  ECSRIRTN
 10206 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 10207                                                                  ECSRIRTN
 10208     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 10209     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 10210                                                                  ECSRIRTN
 10211     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 10212         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 10213                                                                  ECSRIRTN
 10214     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 10215         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 10216                                                                  ECSRIRTN
 10217     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 10218         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 10219             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 10220                                                                  ECSRIRTN
 10221     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10222         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 10223                                                                  ECSRIRTN
 10224     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10225         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 10226         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 10227                                                                  ECSRIRTN
 10228     IF CR-LFPRM = ZERO                                           ECSRIRTN
 10229        MOVE ZERO                TO REIN-FACTOR
 10230     ELSE                                                         ECSRIRTN
 10231        IF DTE-CLIENT = 'GIC'  AND
 10232           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 10233           MOVE +1.0             TO REIN-FACTOR
 10234        ELSE
 10235           IF DTE-CLIENT = 'DCC'
 10236              COMPUTE REIN-FACTOR = CR-LFRFND /
 10237                 (CR-LFPRM + CR-LFPRM-ALT)
 10238           ELSE
 10239              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 10240                 (CR-LFPRM + CR-LFPRM-ALT)
 10241            END-IF
 10242         END-IF
 10243     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 199
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10244                                                                  ECSRIRTN
 10245     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 10246         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 10247             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 10248                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 10249                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 10250             ELSE                                                 ECSRIRTN
 10251                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 10252                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 10253                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 10254                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 10255         ELSE                                                     ECSRIRTN
 10256             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 10257                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *        ECSRIRTN
 10258                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT))   ECSRIRTN
 10259             ELSE                                                 ECSRIRTN
 10260*                COMPUTE RWF-LFRFND = REIN-FACTOR
 10261*                   * REIN-CALCED-LIFE *
 10262*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 10263                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 10264                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 10265                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 10266                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 10267                                                                  ECSRIRTN
 10268     IF CR-LFAMT = ZERO                                           ECSRIRTN
 10269         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 10270             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 10271                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 10272                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 10273             ELSE                                                 ECSRIRTN
 10274                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 10275                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 10276                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 10277                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 10278                                                                  ECSRIRTN
 10279     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 10280                                                                  ECSRIRTN
 10281                                                                  ECSRIRTN
 10282 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 10283                                                                  ECSRIRTN
 10284     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 10285       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 10286         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 10287         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 10288                                                                  ECSRIRTN
 10289     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 10290       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 10291           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 10292           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 10293       ELSE                                                       ECSRIRTN
 10294           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
 10295               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 10296                                                                  ECSRIRTN
 10297     IF FLAT-CANCEL-LF                                            ECSRIRTN
 10298         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 10299         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 10300                                                                  ECSRIRTN
 10301     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 200
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10302         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 10303         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 10304                                                                  ECSRIRTN
 10305     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 10306     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 10307     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 10308                                         RW-LFRFND.               ECSRIRTN
 10309                                                                  ECSRIRTN
 10310 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 10311                                                                  ECSRIRTN
 10312     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 10313                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 10314                                                                  ECSRIRTN
 10315     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 10316        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 10317                                                                  ECSRIRTN
 10318     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 10319        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 10320         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 10321     ELSE                                                         ECSRIRTN
 10322         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 10323         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 10324                                                                  ECSRIRTN
 10325                                                                  ECSRIRTN
 10326 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 10327                                                                  ECSRIRTN
 10328     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 10329         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10330                                                                  ECSRIRTN
 10331     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 10332         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 10333             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 10334                                                                  ECSRIRTN
 10335     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 10336         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 10337         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 10338             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 10339                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 10340         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10341                                                                  ECSRIRTN
 10342     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10343         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 10344                                                                  ECSRIRTN
 10345     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10346         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 10347         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10348                                                                  ECSRIRTN
 10349     IF CR-AHPRM = ZERO                                           ECSRIRTN
 10350        MOVE ZERO                TO REIN-FACTOR
 10351     ELSE
 10352        IF DTE-CLIENT = 'GIC'  AND
 10353           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 10354            MOVE +1.0            TO REIN-FACTOR
 10355        ELSE
 10356           IF DTE-CLIENT = 'DCC'
 10357              COMPUTE REIN-FACTOR =
 10358                 CR-AHRFND / CR-AHPRM
 10359           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 201
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10360              COMPUTE REIN-FACTOR ROUNDED =
 10361                                CR-AHRFND-CALC / CR-AHPRM
 10362           END-IF
 10363        END-IF
 10364     END-IF
 10365
 10366     IF CR-AHAMT NOT = ZERO
 10367        IF (DTE-CLIENT = 'DCC')
 10368           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 10369           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 10370        ELSE
 10371           IF WT-AH-QC = ('1' OR '4')
 10372              COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND *
 10373                       RWF-AHAMT) / CR-AHAMT
 10374           ELSE
 10375              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 10376              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 10377                       RWF-AHAMT) / CR-AHAMT
 10378           END-IF
 10379        END-IF
 10380     ELSE
 10381        IF RWF-AH-LIMIT = ZERO
 10382           IF WT-AH-QC = ('1' OR '4')
 10383              COMPUTE RWF-AHRFND ROUNDED =
 10384                       CR-AHRFND * WT-AH-PCT
 10385           ELSE
 10386              COMPUTE RWF-AHRFND =
 10387                            REIN-FACTOR * REIN-CALCED-AH
 10388              COMPUTE RWF-AHRFND ROUNDED =
 10389                       RWF-AHRFND * WT-AH-PCT
 10390           END-IF
 10391        END-IF
 10392     END-IF
 10393
 10394     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 10395                                                                  ECSRIRTN
 10396                                                                  ECSRIRTN
 10397 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 10398                                                                  ECSRIRTN
 10399     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 10400       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 10401         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 10402         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10403                                                                  ECSRIRTN
 10404     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 10405       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 10406           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 10407           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 10408       ELSE                                                       ECSRIRTN
 10409           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
 10410               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 10411                                                                  ECSRIRTN
 10412     IF FLAT-CANCEL-AH                                            ECSRIRTN
 10413         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 10414         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10415                                                                  ECSRIRTN
 10416     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 10417         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 202
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10418         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10419                                                                  ECSRIRTN
 10420     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 10421     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 10422     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 10423                                    RW-AHRFND.                    ECSRIRTN
 10424                                                                  ECSRIRTN
 10425 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 10426                                                                  ECSRIRTN
 10427     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 10428                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 10429                                                                  ECSRIRTN
 10430     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 10431                                                                  ECSRIRTN
 10432     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 10433        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 10434         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 10435     ELSE                                                         ECSRIRTN
 10436         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 10437         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 10438                                                                  ECSRIRTN
 10439                                                                  ECSRIRTN
 10440 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 10441                                                                  ECSRIRTN
 10442     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 10443         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 10444                                                                  ECSRIRTN
 10445     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 10446         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 10447                                                                  ECSRIRTN
 10448     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 10449                                                                  ECSRIRTN
 10450 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 10451                                                                  ECSRIRTN
 10452     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 10453     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 10454                                                                  ECSRIRTN
 10455     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 10456         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 10457             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 10458                                                                  ECSRIRTN
 10459     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 10460         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 10461                                                                  ECSRIRTN
 10462     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 10463         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 10464                                                                  ECSRIRTN
 10465 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 10466                                                                  ECSRIRTN
 10467     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 10468         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 10469                                                                  ECSRIRTN
 10470     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 10471                                                                  ECSRIRTN
 10472 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 10473                                                                  ECSRIRTN
 10474     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 10475     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 203
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10476                                                                  ECSRIRTN
 10477 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 10478     EXIT.                                                        ECSRIRTN
 10479                                                                  ECSRIRTN
 10480 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 10481                                                                  ECSRIRTN
 10482     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 10483         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 10484                                                                  ECSRIRTN
 10485 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 10486     EXIT.                                                        ECSRIRTN
 10487                                                                  ECSRIRTN
 10488 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 10489                                                                  ECSRIRTN
 10490     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 10491     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 10492                                                                  ECSRIRTN
 10493     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 10494         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 10495                                                                  ECSRIRTN
 10496     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 10497        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 10498          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 10499          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 10500          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 10501                                                                  ECSRIRTN
 10502     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 10503        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 10504          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 10505                                                                  ECSRIRTN
 10506     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 10507                                  RWF-AHCLML.                     ECSRIRTN
 10508                                                                  ECSRIRTN
 10509     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 10510         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10511                                                                  ECSRIRTN
 10512     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 10513         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10514                                                                  ECSRIRTN
 10515     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10516         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 10517             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 10518                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 10519                                                                  ECSRIRTN
 10520     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 10521         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 10522                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 10523                                                                  ECSRIRTN
 10524     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10525         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
 10526                                                                  ECSRIRTN
 10527     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10528         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 10529             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 10530                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 10531             ELSE                                                 ECSRIRTN
 10532                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 10533         ELSE                                                     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 204
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10534             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 10535                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 10536                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 10537             ELSE                                                 ECSRIRTN
 10538                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 10539                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 10540                                                                  ECSRIRTN
 10541     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10542         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10543                                                                  ECSRIRTN
 10544     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 10545         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 10546            OR 'DCC'
 10547             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 10548                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 10549         ELSE                                                     ECSRIRTN
 10550             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 10551                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 10552                                                                  ECSRIRTN
 10553     IF CR-LFAMT = ZERO                                           ECSRIRTN
 10554         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 10555             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 10556                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 10557                                                                  ECSRIRTN
 10558     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10559         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 10560             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 10561                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 10562                                                                  ECSRIRTN
 10563     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10564         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 10565             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 10566               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 10567                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 10568                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 10569                  ELSE                                            ECSRIRTN
 10570                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 10571                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 10572              ELSE                                                ECSRIRTN
 10573                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 10574                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 10575                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 10576                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 10577                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 10578                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 10579                                                                  ECSRIRTN
 10580     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 10581                                                                  ECSRIRTN
 10582     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 10583                                                                  ECSRIRTN
 10584                                                                  ECSRIRTN
 10585 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 10586                                                                  ECSRIRTN
 10587     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 10588         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10589                                                                  ECSRIRTN
 10590     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 10591         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 205
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10592     ELSE                                                         ECSRIRTN
 10593         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 10594                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 10595                                                                  ECSRIRTN
 10596     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 10597         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10598                                                                  ECSRIRTN
 10599     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 10600         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 10601             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 10602         ELSE                                                     ECSRIRTN
 10603             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 10604     ELSE                                                         ECSRIRTN
 10605         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 10606             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 10607             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 10608         ELSE                                                     ECSRIRTN
 10609             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 10610             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 10611                                                                  ECSRIRTN
 10612                                                                  ECSRIRTN
 10613 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 10614                                                                  ECSRIRTN
 10615     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 10616         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 10617                                                                  ECSRIRTN
 10618     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 10619         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10620                                                                  ECSRIRTN
 10621     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 10622         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 10623                                                                  ECSRIRTN
 10624     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 10625     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 10626                                                                  ECSRIRTN
 10627     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 10628             VARYING                                              ECSRIRTN
 10629         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 10630             UNTIL                                                ECSRIRTN
 10631         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 10632                                                                  ECSRIRTN
 10633     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 10634         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 10635     ELSE                                                         ECSRIRTN
 10636         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 10637                                                                  ECSRIRTN
 10638 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 10639                                                                  ECSRIRTN
 10640     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 10641         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 10642                                                                  ECSRIRTN
 10643     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10644       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 10645           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 10646                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 10647               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 10648                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 10649               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 206
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10650                                                                  ECSRIRTN
 10651     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 10652       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 10653           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 10654                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 10655           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 10656                                                                  ECSRIRTN
 10657     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 10658         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 10659                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 10660                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 10661         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 10662                                                                  ECSRIRTN
 10663     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 10664         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 10665                                                                  ECSRIRTN
 10666     IF INC-SUB = +1                                              ECSRIRTN
 10667         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10668     IF INC-SUB = +2                                              ECSRIRTN
 10669         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10670     IF INC-SUB = +3                                              ECSRIRTN
 10671         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10672     IF INC-SUB = +4                                              ECSRIRTN
 10673         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10674     IF INC-SUB = +5                                              ECSRIRTN
 10675         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10676                                                                  ECSRIRTN
 10677     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 10678                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 10679                                                                  ECSRIRTN
 10680     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 10681         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 10682                                                                  ECSRIRTN
 10683     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 10684              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 10685         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 10686     ELSE                                                         ECSRIRTN
 10687         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 10688                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 10689                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 10690                                                                  ECSRIRTN
 10691 CHECK-DISABS-EXIT.                                               ECSRIRTN
 10692      EXIT.                                                       ECSRIRTN
 10693                                                                  ECSRIRTN
 10694 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 10695                                                                  ECSRIRTN
 10696     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 10697         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10698                                                                  ECSRIRTN
 10699     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10700         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 10701             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 10702                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 10703                                                                  ECSRIRTN
 10704     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 10705         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 10706             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 10707                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 207
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10708 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 10709                                                                  ECSRIRTN
 10710     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 10711         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 10712         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 10713             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 10714                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 10715         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 10716         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10717                                                                  ECSRIRTN
 10718     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10719         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 10720                                                                  ECSRIRTN
 10721     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10722         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 10723             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 10724                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 10725             ELSE                                                 ECSRIRTN
 10726                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 10727         ELSE                                                     ECSRIRTN
 10728             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 10729                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 10730                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 10731             ELSE                                                 ECSRIRTN
 10732                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 10733                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 10734                                                                  ECSRIRTN
 10735     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10736         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10737                                                                  ECSRIRTN
 10738     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 10739         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 10740                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 10741     ELSE                                                         ECSRIRTN
 10742         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 10743             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 10744                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 10745                                                                  ECSRIRTN
 10746     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10747         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 10748             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 10749                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 10750                                                                  ECSRIRTN
 10751     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10752         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 10753             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 10754               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 10755                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 10756                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 10757                  ELSE                                            ECSRIRTN
 10758                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 10759                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 10760              ELSE                                                ECSRIRTN
 10761                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 10762                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 10763                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 10764                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 10765                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 208
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10766                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 10767                                                                  ECSRIRTN
 10768                                                                  ECSRIRTN
 10769     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 10770        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 10771                               '220000' OR '230000')              ECSRIRTN
 10772           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 10773               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 10774                                                                  ECSRIRTN
 10775     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 10776                                                                  ECSRIRTN
 10777     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 10778                                                                  ECSRIRTN
 10779                                                                  ECSRIRTN
 10780 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 10781                                                                  ECSRIRTN
 10782     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 10783         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10784                                                                  ECSRIRTN
 10785     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 10786         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 10787         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10788                                                                  ECSRIRTN
 10789     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 10790                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 10791                                                                  ECSRIRTN
 10792     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 10793         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10794                                                                  ECSRIRTN
 10795     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 10796         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10797                                                                  ECSRIRTN
 10798     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 10799                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 10800         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 10801                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 10802         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 10803     ELSE                                                         ECSRIRTN
 10804         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 10805         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 10806                                                                  ECSRIRTN
 10807                                                                  ECSRIRTN
 10808 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 10809                                                                  ECSRIRTN
 10810     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 10811         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 10812                                                                  ECSRIRTN
 10813     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 10814         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 10815                                                                  ECSRIRTN
 10816     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 10817                                                                  ECSRIRTN
 10818 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 10819                                                                  ECSRIRTN
 10820     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 10821     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 10822                                                                  ECSRIRTN
 10823     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 209
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10824         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 10825             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 10826                                                                  ECSRIRTN
 10827     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 10828     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 10829                                                                  ECSRIRTN
 10830     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 10831         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 10832                                                                  ECSRIRTN
 10833     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 10834         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 10835                                                                  ECSRIRTN
 10836 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 10837                                                                  ECSRIRTN
 10838     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 10839         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 10840                                                                  ECSRIRTN
 10841     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 10842                                                                  ECSRIRTN
 10843 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 10844                                                                  ECSRIRTN
 10845     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 10846     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 10847                                                                  ECSRIRTN
 10848 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 10849     EXIT.                                                        ECSRIRTN
 10850                                                                  ECSRIRTN
 10851 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 10852                                                                  ECSRIRTN
 10853     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 10854         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 10855                                                                  ECSRIRTN
 10856 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 10857     EXIT.                                                        ECSRIRTN
 10858                                                                  ECSRIRTN
 10859                                                                  ECSRIRTN
 10860 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 10861                                                                  ECSRIRTN
 10862     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 10863     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 10864     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 10865     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 10866                                                                  ECSRIRTN
 10867     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 10868         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 10869         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 10870         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 10871         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 10872         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 10873         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
 10874         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 10875         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 10876         REIN-AH-LIMIT (1).                                       ECSRIRTN
 10877                                                                  ECSRIRTN
 10878     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 10879         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 10880                                                                  ECSRIRTN
 10881     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 210
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10882                                                                  ECSRIRTN
 10883 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 10884                                                                  ECSRIRTN
 10885     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 10886                                                                  ECSRIRTN
 10887 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 10888     EXIT.                                                        ECSRIRTN
 10889                                                                  ECSRIRTN
 10890 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 10891                                                                  ECSRIRTN
 10892     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 10893                                                                  ECSRIRTN
 10894     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 10895         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 10896                                                                  ECSRIRTN
 10897     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 10898         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 10899             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 10900                                                                  ECSRIRTN
 10901     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 10902         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 10903         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 10904         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 10905     ELSE                                                         ECSRIRTN
 10906         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 10907         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 10908         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 10909                                                                  ECSRIRTN
 10910     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 10911                                                                  ECSRIRTN
 10912     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 10913        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 10914         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 10915                                                                  ECSRIRTN
 10916     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 10917         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 10918                                                                  ECSRIRTN
 10919 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 10920     EXIT.                                                        ECSRIRTN
 10921                                                                  ECSRIRTN
 10922 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 10923                                                                  ECSRIRTN
 10924     CONTINUE.                                                    ECSRIRTN
 10925*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 10926 FIND-REI-CO-EXIT.                                                ECSRIRTN
 10927     EXIT.                                                        ECSRIRTN
 10928                                                                  ECSRIRTN
 10929 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 10930                                                                  ECSRIRTN
 10931     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
 10932         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 10933                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 10934                                                                  ECSRIRTN
 10935     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 10936         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 10937                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 10938                                                                  ECSRIRTN
 10939     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 211
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10940                                                                  ECSRIRTN
 10941     START ERRTBL-IN                                              ECSRIRTN
 10942           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 10943             INVALID KEY                                          ECSRIRTN
 10944               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 10945                                                                  ECSRIRTN
 10946     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 10947     MOVE 0 TO SUB1.                                              ECSRIRTN
 10948 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 10949                                                                  ECSRIRTN
 10950     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 10951                                                                  ECSRIRTN
 10952     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 10953        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 10954                                                                  ECSRIRTN
 10955     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 10956        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 10957        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 10958                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 10959        GO TO ABEND-PGM.                                          ECSRIRTN
 10960                                                                  ECSRIRTN
 10961     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 10962        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 10963                                                                  ECSRIRTN
 10964     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 10965        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 10966                                                                  ECSRIRTN
 10967     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 10968        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 10969                                                                  ECSRIRTN
 10970     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 10971        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 10972                                                                  ECSRIRTN
 10973     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 10974        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 10975                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 10976        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 211)**
**    Index-name belongs to different table - unexpected behaviour may occur
 10977                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 10978        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 211)**
**    Index-name belongs to different table - unexpected behaviour may occur
 10979                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 10980     END-PERFORM.                                                 ECSRIRTN
 10981     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 10982                                                                  ECSRIRTN
 10983     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 10984        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 10985                                                                  ECSRIRTN
 10986     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 10987        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 10988                                                                  ECSRIRTN
 10989     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 10990        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 10991                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 212
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10992     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 10993        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 10994                                                                  ECSRIRTN
 10995     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 10996        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 10997        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 10998        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 10999        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 11000        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 11001        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 11002          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 11003                                                                  ECSRIRTN
 11004     ADD +1 TO CO-SUB.                                            ECSRIRTN
 11005                                                                  ECSRIRTN
 11006     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 11007        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 11008        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 11009        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 11010        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 11011                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 11012        GO TO ABEND-PGM.                                          ECSRIRTN
 11013                                                                  ECSRIRTN
 11014     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 11015                                                                  ECSRIRTN
 11016     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 11017                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 11018     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 11019                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 11020     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 11021                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 11022                                                                  ECSRIRTN
 11023     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 11024         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 11025     ELSE                                                         ECSRIRTN
 11026         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 11027                                                                  ECSRIRTN
 11028     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 11029     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 11030     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 11031     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 11032                                                                  ECSRIRTN
 11033 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 11034                                                                  ECSRIRTN
 11035     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 11036        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 11037                                                                  ECSRIRTN
 11038     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 11039        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 11040                                                                  ECSRIRTN
 11041     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 11042        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 11043                                                                  ECSRIRTN
 11044     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 11045        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 11046                                                                  ECSRIRTN
 11047     ADD +1 TO SUB1.                                              ECSRIRTN
 11048                                                                  ECSRIRTN
 11049     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 213
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 11050        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 11051        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 11052                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 11053        GO TO ABEND-PGM.                                          ECSRIRTN
 11054                                                                  ECSRIRTN
 11055     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 11056     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 11057     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 11058     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 11059     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 11060     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 11061     if re-state-exhibit-opt-f = 'Y'
 11062        move 'Y'         to rc2-ecs152-rpt (sub1)
 11063     else
 11064        move 'N'         to rc2-ecs152-rpt (sub1)
 11065     end-if
 11066                                                                  ECSRIRTN
 11067     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 11068                                                                  ECSRIRTN
 11069 REIN-BUILD-EXIT.                                                 ECSRIRTN
 11070     EXIT.                                                        ECSRIRTN
 11071                                                                  ECSRIRTN
 11072 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 11073                                                                  ECSRIRTN
 11074     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 11075                                                                  ECSRIRTN
 11076     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 11077                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 11078                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 11079                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 11080                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 11081                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 11082                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 11083                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 11084                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 11085                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 11086                                                                  ECSRIRTN
 11087 ZERO-RCT-EXIT.                                                   ECSRIRTN
 11088     EXIT.                                                        ECSRIRTN
 11089                                                                  ECSRIRTN
 11090 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 11091                                                                  ECSRIRTN
 11092     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 11093                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 11094     move spaces      to rc2-ecs152-rpt (co-sub)
 11095                                                                  ECSRIRTN
 11096     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 11097                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 11098                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 11099                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
 11100                                                                  ECSRIRTN
 11101 ZERO-RC2-EXIT.                                                   ECSRIRTN
 11102     EXIT.                                                        ECSRIRTN
 11103******************************************************************ECSRIRTN
 11104
 11105 5000-COMMISSIONS-LIFE.
 11106     MOVE +0 TO SA.
 11107
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 214
* ECS158.cbl
 11108 5010-COMM-LIFE-LOOP.
 11109
 11110     ADD +1 TO SA.
 11111     IF SA GREATER +10
 11112         GO TO 5020-L-COMM-EXIT.
 11113
 11114     IF CR-COM-AGT (SA) = ZEROS OR SPACES
 11115        GO TO 5010-COMM-LIFE-LOOP.
 11116
 11117     IF FROM-REIN = 'X'
 11118        IF CR-AGT-TYPE (SA) = 'W'
 11119           MOVE CR-COM-AGT (SA) TO WS-AGT-NO
 11120           IF WS-AGT-SIX = REIN-COMP (SUB1)
 11121              COMPUTE AGT-COMM =
 11122                 SV-FACTOR * (COMM-PREMM * CR-LCOM-L (SA))
 11123                 ADD AGT-COMM TO EX-AGT-COMM (SB)
 11124           ELSE
 11125              NEXT SENTENCE
 11126        ELSE
 11127           IF CR-AGT-TYPE (SA) = 'R' OR 'D' OR 'U' OR 'S'
 11128              COMPUTE AGT-COMM =
 11129                 SV-FACTOR * (COMM-PREMM * CR-LCOM-L (SA))
 11130                 ADD AGT-COMM TO EX-AGT-COMM (SB)
 11131           ELSE
 11132              IF CR-AGT-TYPE (SA) = 'T' OR 'P' OR 'V' OR 'B'
 11133                 COMPUTE AGT-COMM =
 11134                   SV-FACTOR * (COMM-PREMM * CR-LCOM-L (SA))
 11135                   ADD AGT-COMM TO EX-OVR-COMM (SB).
 11136
 11137     GO TO 5010-COMM-LIFE-LOOP.
 11138
 11139 5020-L-COMM-EXIT.
 11140     EXIT.
 11141
 11142 5030-COMMISSIONS-AH.
 11143     MOVE +0 TO SA.
 11144
 11145 5040-COMM-AH-LOOP.
 11146     ADD +1 TO SA.
 11147
 11148     IF SA GREATER +10
 11149         GO TO 5050-A-COMM-EXIT.
 11150
 11151     IF CR-COM-AGT (SA) = ZEROS OR SPACES
 11152         GO TO 5040-COMM-AH-LOOP.
 11153
 11154     IF FROM-REIN = 'X'
 11155        IF CR-AGT-TYPE (SA) = 'W'
 11156           MOVE CR-COM-AGT (SA) TO WS-AGT-NO
 11157           IF WS-AGT-SIX = REIN-COMP (SUB1)
 11158              COMPUTE AGT-COMM =
 11159                SV-FACTOR * (COMM-PREMM * CR-LCOM-AH (SA))
 11160                ADD AGT-COMM TO EX-AGT-COMM (SB)
 11161           ELSE
 11162              NEXT SENTENCE
 11163        ELSE
 11164           IF CR-AGT-TYPE (SA) = 'R' OR 'D' OR 'U' OR 'S'
 11165              COMPUTE AGT-COMM =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 215
* ECS158.cbl
 11166                SV-FACTOR * (COMM-PREMM * CR-LCOM-AH (SA))
 11167                 ADD AGT-COMM TO EX-AGT-COMM (SB)
 11168           ELSE
 11169              IF CR-AGT-TYPE (SA) = 'T' OR 'P' OR 'V' OR 'B'
 11170                 COMPUTE AGT-COMM =
 11171                   SV-FACTOR * (COMM-PREMM * CR-LCOM-AH (SA))
 11172                   ADD AGT-COMM TO EX-OVR-COMM (SB).
 11173
 11174     GO TO 5040-COMM-AH-LOOP.
 11175
 11176 5050-A-COMM-EXIT.
 11177     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 216
* ECS158.cbl
 11179
 11180 6000-CALC-REM-TERM.
 11181
 11182     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
 11183         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 11184
 11185     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 11186         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 11187         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11188                                        DC-ELAPSED-DAYS
 11189         MOVE '3'                    TO DC-OPTION-CODE
 11190         PERFORM 6150-DATE-CONVERSION-ROUTINE
 11191         IF NO-CONVERSION-ERROR
 11192             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 11193         ELSE
 11194             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 11195
 11196     IF CR-LOAN-1ST-PMT-DT = ZEROS
 11197         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 11198         MOVE +1                     TO DC-ELAPSED-MONTHS
 11199         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 11200         MOVE '6'                    TO DC-OPTION-CODE
 11201         PERFORM 6150-DATE-CONVERSION-ROUTINE
 11202         MOVE DC-BIN-DATE-2          TO CP-FIRST-PAY-DATE
 11203         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
 11204
 11205     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 11206     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 11207     MOVE '3'                        TO CP-PROCESS-TYPE.
 11208     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 11209     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 11210     MOVE SPACES                     TO CP-ACCT-FLD-5.
 11211     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
 11212     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 11213
 11214     IF DTE-CLIENT = 'FIM'
 11215         MOVE '5'                    TO CP-REM-TERM-METHOD.
 11216
 11217     IF DTE-CLIENT = 'POS'
 11218        IF CR-CARRIER = '1'
 11219           MOVE '1'                TO CP-REM-TERM-METHOD
 11220        ELSE
 11221           MOVE '2'                TO CP-REM-TERM-METHOD.
 11222
 11223     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 11224
 11225     IF DTE-CLIENT = 'NCL'
 11226         MOVE CP-REMAINING-TERM-1 TO CP-REMAINING-TERM-2.
 11227
 11228     IF FROM-LIFE-SW = 'Y'
 11229        IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
 11230          (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
 11231          MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTERM
 11232          COMPUTE CP-REMAINING-TERM-1 =
 11233                  CP-REMAINING-TERM-1 - +1
 11234          COMPUTE CP-REMAINING-TERM-2 =
 11235                  CP-REMAINING-TERM-2 - +1.
 11236
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 217
* ECS158.cbl
 11237     IF CP-REMAINING-TERM-1 NEGATIVE
 11238         MOVE ZEROS TO CP-REMAINING-TERM-1.
 11239
 11240     IF CP-REMAINING-TERM-2 NEGATIVE
 11241         MOVE ZEROS TO CP-REMAINING-TERM-2.
 11242
 11243     IF NO-CP-ERROR
 11244        MOVE CP-REMAINING-TERM-1        TO REM-TRM1
 11245        MOVE CP-REMAINING-TERM-2        TO REM-TRM2
 11246     ELSE
 11247        MOVE +0                         TO REM-TRM1
 11248                                           REM-TRM2.
 11249
 11250 6010-REM-TERM-EXIT.
 11251     EXIT.
 11252
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 218
* ECS158.cbl
 11254 6100-E-O-J-RTN.
 11255
 11256     OPEN INPUT XTRS-IN.
 11257
 11258 6103-READ-LOSS-XTRS.
 11259
 11260     READ XTRS-IN INTO CALL-EXTRACT
 11261             AT END
 11262                CLOSE XTRS-IN
 11263                GO TO 6107-CLOSE-FILES.
 11264
 11265     PERFORM 1520-RELEASE-SORT-RECORD THRU 1540-RELEASE-EXIT.
 11266
 11267     GO TO 6103-READ-LOSS-XTRS.
 11268
 11269 6107-CLOSE-FILES.
 11270
 11271     MOVE '0'                 TO X.
 11272     MOVE '   ECS158  EXTRACT COMPLETE  ' TO P-DATA.
 11273     PERFORM 1610-PRT-RTN THRU 1620-E-PRT-RTN.
 11274     DISPLAY '  CONTROL TOTALS  '.
 11275     DISPLAY ' LIFE RATE ATTEMPTS....... ' WS-LF-RATE-ATTEMPT.
 11276     DISPLAY ' LIFE RATE ERRORS  ....... ' WS-LF-RATE-ERROR.
 11277     DISPLAY ' AH   RATE ATTEMPTS....... ' WS-AH-RATE-ATTEMPT.
 11278     DISPLAY ' AH   RATE ERRORS  ....... ' WS-AH-RATE-ERROR.
 11279     DISPLAY ' TEXAS ADJ RECS    ....... ' TEXAS-CNT.
 11280     DISPLAY ' '.
 11281
 11282     CLOSE CERTS  PRINTX XTRACT.
 11283     CLOSE ERACCTT.
 11284
 11285     IF REIN-OPEN-SW = 'X'
 11286        CLOSE ERRTBL-IN.
 11287
 11288     CLOSE SORTED-CLAIMS.
 11289
 11290     IF DTE-PGM-OPT = '3' OR '4'
 11291        CLOSE PRINTC.
 11292
 11293     MOVE 'R' TO CP-RATE-FILE.
 11294     MOVE 'C' TO CP-IO-FUNCTION.
 11295     PERFORM 6130-CALL-RATING-ROUTINE THRU 6140-RATE-EXIT.
 11296
 11297     IF IO-ERROR
 11298        MOVE +0303   TO WS-RETURN-CODE
 11299        MOVE ' ERROR ON ERRATE CLOSE' TO WS-ABEND-MESSAGE
 11300        GO TO ABEND-PGM.
 11301
 11302     IF ERACCTT-FILE-STATUS NOT = '00'
 11303        MOVE ' ERROR ON CLOSE  ERACCT ' TO WS-ABEND-MESSAGE
 11304        MOVE ERACCTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 11305        GO TO ABEND-PGM.
 11306
 11307 6110-CLOSE-FICH.
*11308                             COPY ELCPRTC.
 11309******************************************************************04/15/98
 11310*                                                                *ELCPRTC
 11311*                                                                *ELCPRTC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 219
* ECS158.cbl (/apps/prod/cid1p/copy/ELCPRTC)
 11312*                            ELCPRTC.                            *   LV003
 11313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 11314*                            VMOD=2.002                          *   CL**2
 11315*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 11316*                                                                *ELCPRTC
 11317* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 11318******************************************************************ELCPRTC
 11319                                                                  ELCPRTC
 11320      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 11321          CLOSE FICH.                                             ELCPRTC
 11322                                                                  ELCPRTC
 11323******************************************************************ELCPRTC
 11324
 11325     MOVE ZEROS  TO RETURN-CODE.
 11326     GOBACK.
 11327
 11328 6120-E-O-J-XIT.
 11329     EXIT.
 11330
 11331 6130-CALL-RATING-ROUTINE.
 11332
 11333     ADD 1 TO WS-RATE-DB-CNT
 11334              WS-TOT-RATE-DB-CNT
 11335     IF WS-RATE-DB-CNT > 10000
 11336        DISPLAY ' RATES ' WS-TOT-RATE-DB-CNT
 11337        MOVE ZEROS TO WS-RATE-DB-CNT
 11338     END-IF
 11339     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 11340
 11341 6140-RATE-EXIT.
 11342     EXIT.
 11343
 11344 6150-DATE-CONVERSION-ROUTINE.
 11345     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 11346
 11347 6200-LOCATE-STATE.
 11348     MOVE SPACES TO SAVE-STATE
 11349                    WS-REPORT-SW.
 11350     MOVE +0     TO EXCL-SUB.
 11351
 11352 6200-LOCATE-STATE-LOOP.
 11353     ADD +1 TO EXCL-SUB.
 11354
 11355     IF EXCL-SUB GREATER THAN CLAS-MAXS
 11356         MOVE TEMP-STATE TO SAVE-STATE
 11357         GO TO 6200-EXIT.
 11358
 11359     IF STATE-SUB (EXCL-SUB) = TEMP-STATE
 11360         MOVE TEMP-STATE TO SAVE-STATE
 11361         MOVE STATE-CALL-BREAK (EXCL-SUB) TO WS-REPORT-SW
 11362         GO TO 6200-EXIT.
 11363
 11364     GO TO 6200-LOCATE-STATE-LOOP.
 11365
 11366 6200-EXIT.
 11367      EXIT.
 11368
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 220
* ECS158.cbl
 11370 6300-LOCATE-BUSC-TYPE.
 11371
 11372     MOVE ZEROS                  TO SAVE-BUSC-TYPE.
 11373     MOVE SPACES                 TO WS-EXCL-BUSC-SW.
 11374
 11375     MOVE +1                     TO CLAS-INDEXB.
 11376
 11377     IF AM-GPCD NOT NUMERIC
 11378         GO TO 6399-EXIT.
 11379
 11380     MOVE AM-GPCD            TO SAVE-BUSC-TYPE.
 11381
 11382 6300-LOCATE-BUSC-LOOP.
 11383
 11384     IF CLAS-INDEXB GREATER THAN CLAS-MAXB
 11385         GO TO 6399-EXIT.
 11386
 11387     IF CLAS-BUSC-CODE (CLAS-INDEXB) NOT = SAVE-BUSC-TYPE
 11388         ADD +1 TO CLAS-INDEXB
 11389         GO TO 6300-LOCATE-BUSC-LOOP.
 11390
 11391     MOVE CLAS-BUSC-EXCL (CLAS-INDEXB) TO WS-EXCL-BUSC-SW.
 11392
 11393 6399-EXIT.
 11394     EXIT.
 11395
 11396 9999-DUM-END.
 11397     MOVE ZEROS  TO RETURN-CODE.
 11398     GOBACK.
 11399
 11400 ABEND-PGM.
*11401                          COPY ELCABEND.
 11402***************************************************************** 04/14/98
 11403*                                                               * ELCABEND
 11404*                            ELCABEND.                          *    LV003
 11405*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 11406*                            VMOD 2.002                              CL**2
 11407*                                                               * ELCABEND
 11408*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 11409*            AND THEN ABENDS.                                   * ELCABEND
 11410*                                                               * ELCABEND
 11411*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 11412*                                                               * ELCABEND
 11413***************************************************************** ELCABEND
 11414*APS-010.                                                         ELCABEND
 11415     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 11416     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 11417                                                                  ELCABEND
 11418     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 11419         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 11420         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 11421                                 UPON CONSOLE.                    ELCABEND
 11422                                                                  ELCABEND
 11423     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 11424         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 11425         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 11426                                 UPON CONSOLE.                    ELCABEND
 11427                                                                  ELCABEND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 221
* ECS158.cbl (/apps/prod/cid1p/copy/ELCABEND)
 11428     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 11429     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 11430                                 UPON CONSOLE.                    ELCABEND
 11431                                                                  ELCABEND
 11432     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 11433     CALL 'ABORTME'.
 11434                                                                  ELCABEND
 11435 APS-EXIT.                                                        ELCABEND
 11436     EXIT.                                                        ELCABEND
 11437
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  211
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:      285120     Code:       59828
