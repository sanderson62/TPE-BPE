* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS057.cbl
* Options: int("ECS057.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS057.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS057.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS057.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         04/18/98
     2                                                                  ECS057
     3 PROGRAM-ID.                ECS057.                                  LV004
     4                                                                  ECS057
     5*AUTHOR.       SUZAN VUKOV.                                       ECS057
     6                                                                  ECS057
     7*REMARKS.                                                         ECS057
     8*        CREATE PERIODIC FEE PAYMENT HISTORY REPORT
     9*
    10******************************************************************
    11*                   C H A N G E   L O G
    12*
    13* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS057.cbl
    14*-----------------------------------------------------------------
    15*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    16* EFFECTIVE    NUMBER
    17*-----------------------------------------------------------------
    18* 032703   2001061800003   SMVA  NEW PROGRAM
    19* 033104                 SMVA  ADD ME DATE TO HEADER & CHG RPT
    20*                              AMTS TO CASH RECEIVED FROM GROSS
    21* 062304   2004061600004   PEMA  ADD CANCELATION PROCESSING
    22* 060308 IR2008050500002   PEMA  PROCESS GIANTS ONLY
    23* 070808 IR2008070700001   PEMA  ADD CODES TO GIANT LIST
    24* 071212 CR2012020100004   PEMA  ADD 10C BENEFIT CODES TO LIST
    25* 011515 CR2015010900003   PEMA  ADD CLP RPT AND CASH CERTS
    26* 070715 IR2015070600002   PEMA  FIX CARR 7 CLP CALCS
    27******************************************************************
    28                                                                  ECS057
    29 ENVIRONMENT DIVISION.                                            ECS057
    30 CONFIGURATION SECTION.                                           ECS057
    31                                                                     CL**3
    32 INPUT-OUTPUT SECTION.                                            ECS057
    33 FILE-CONTROL.                                                    ECS057
    34                                                                  ECS057
    35     SELECT PRT-RPT          ASSIGN TO SYS008.
    36
    37     SELECT SORTFL           ASSIGN TO SORTWK1.
    38
    39     SELECT OFFLN-CERT-IN    ASSIGN TO SYS010.
    40
    41     SELECT DISK-DATE        ASSIGN TO SYS019.
    42
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS057.cbl
    44 DATA DIVISION.                                                   ECS057
    45 FILE SECTION.                                                    ECS057
    46                                                                  ECS057
    47 FD  PRT-RPT                                                      ECS057
*   48                             COPY ELCPRTFD.                       ECS057
    49******************************************************************04/15/98
    50*                                                                *ELCPRTFD
    51*                                                                *ELCPRTFD
    52*                            ELCPRTFD.                           *   LV003
    53*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    54*                            VMOD=2.006                          *ELCPRTFD
    55******************************************************************ELCPRTFD
    56     RECORDING MODE F                                             ELCPRTFD
    57     LABEL RECORDS OMITTED                                        ELCPRTFD
    58     BLOCK CONTAINS 0 RECORDS
    59     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    60 01  PRT.                                                         ELCPRTFD
    61     12  P-CTL               PIC  X.                                 CL**2
    62     12  P-DATA              PIC  X(132).                         ELCPRTFD
    63******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS057.cbl
    65 FD  OFFLN-CERT-IN.
*   66                             COPY ECSCRT01.
    67******************************************************************
    68*                                                                *
    69*                            ECSCRT01                            *
    70*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    71*                            VMOD=2.016                          *
    72*                                                                *
    73*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
    74*                                                                *
    75*   FILE TYPE = SEQUENTIAL
    76*   RECORD SIZE = 1056 RECFORM = FIXED                           *
    77*                                                                *
    78*   KEY DATA =                         START=4, LEN=36           *
    79*                                                                *
    80*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
    81*                                                                *
    82******************************************************************
    83******************************************************************
    84*                   C H A N G E   L O G
    85*
    86* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    87*-----------------------------------------------------------------
    88*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    89* EFFECTIVE    NUMBER
    90*-----------------------------------------------------------------
    91* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    92* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    93* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    94* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
    95* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    96* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    97* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    98* 032612  CR2011110200001  PEMA  AHL CHANGES
    99* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
   100* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   101******************************************************************
   102
   103 01  CERTIFICATE-RECORD.
   104     12  CR-RECORD-ID                      PIC XX.
   105         88  VALID-CR-ID                      VALUE 'CR'.
   106
   107     12  CR-COMPANY-CD                     PIC X.
   108
   109     12  CR-FULL-CONTROL.
   110         16  CR-CONTROL-1.
   111             20  CR-ACCT-CONTROL.
   112                 24  CR-CARRIER            PIC X.
   113                 24  CR-GROUPING.
   114                     28  CR-GROUP-PREFIX   PIC XXX.
   115                     28  CR-GROUP-PRIME    PIC XXX.
   116                 24  CR-STATE              PIC XX.
   117                 24  CR-ACCOUNT.
   118                     28  CR-ACCT-PREFIX    PIC X(4).
   119                     28  CR-ACCT-PRIME     PIC X(6).
   120             20  CR-DT                     PIC 9(11)  COMP-3.
   121         16  CR-CERT-NO.
   122             20  CR-CERT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS057.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   123                 24  CR-CERT-PREFIX        PIC X(3).
   124                 24  CR-CERT-PRIME         PIC X(7).
   125             20  CR-CERT-SFX               PIC X.
   126
   127     12  CR-INSUREDS-PROFILE.
   128         16  CR-NAME.
   129             20  CR-LNAME                  PIC X(15).
   130             20  CR-FNAME.
   131                 24  CR-1ST-INITIAL        PIC X.
   132                 24  FILLER                PIC X(9).
   133             20  CR-INIT                   PIC X.
   134         16  CR-AGE                        PIC 99.
   135         16  CR-SEX                        PIC X.
   136             88  CR-SEX-MALE                  VALUE 'M'.
   137             88  CR-SEX-FEMALE                VALUE 'F'.
   138         16  CR-SOC-SEC                    PIC X(11).
   139         16  CR-JOINT-NAME.
   140             20  CR-JT-LNAME               PIC X(15).
   141             20  CR-JT-FNAME.
   142                 24  CR-JT-1ST-INIT        PIC X.
   143                 24  FILLER                PIC X(9).
   144             20  CR-JT-INIT                PIC X.
   145         16  CR-JOINT-AGE                  PIC 99.
   146
   147         16  cr-ahl-ah-claim-no            pic x(9).
   148         16  cr-ahl-ah-cert-seq            pic x(3).
   149         16  cr-hst-proc-lf                pic x.
   150         16  f                             pic x(7).
   151
   152     12  CR-LF-COVERAGE-DATA.
   153         16  CR-LFTYP                      PIC XX.
   154         16  CR-LF-TERM                    PIC S999       COMP-3.
   155         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   156         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   157         16  CR-LF-DEV-CODE                PIC XXX.
   158         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   159
   160         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   161         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   162         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   163         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   164
   165         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   166         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   167         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   168         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   169
   170         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   171         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   172
   173         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   174         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   175
   176         16  CR-LF-REFUND-TYPE             PIC X.
   177         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   178
   179         16  CR-LF-COMM-CHARGEBACK         PIC X.
   180             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS057.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   181
   182         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   183
   184         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   185         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   186         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   187
   188         16  cr-ahl-lf-claim-no            pic x(9).
   189         16  cr-ahl-lf-cert-seq            pic x(3).
   190         16  FILLER                        PIC XX.
   191
   192     12  CR-AH-COVERAGE-DATA.
   193         16  CR-AHTYP                      PIC XX.
   194         16  CR-AH-TERM                    PIC S999       COMP-3.
   195         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   196         16  CR-AH-DEV-CODE                PIC XXX.
   197         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   198
   199         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   200         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   201         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   202         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   203
   204         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   205         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   206
   207         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   208         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   209
   210         16  CR-AH-REFUND-TYPE             PIC X.
   211         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   212
   213         16  CR-AH-COMM-CHARGEBACK         PIC X.
   214             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   215
   216         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   217
   218         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   219         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   220         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   221
   222         16  FILLER                        PIC XX.
   223*        16  FILLER                        PIC X(8).
   224
   225     12  CR-LOAN-DATA.
   226         16  CR-LIVES                      PIC S9(7)      COMP-3.
   227         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   228                                           PIC S9(5)V99   COMP-3.
   229         16  CR-BILLED                     PIC S9(7)      COMP-3.
   230         16  CR-APR                        PIC S999V9(4)  COMP-3.
   231         16  CR-PMT-FREQ                   PIC 99.
   232         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   233         16  CR-RATING-CLASS               PIC XX.
   234         16  CR-POLICY-FORM-NO             PIC X(12).
   235         16  CR-GRPTYP                     PIC XX.
   236         16  CR-IND-GRP                    PIC X.
   237             88  CR-INDIVIDUAL                VALUE '1'.
   238             88  CR-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS057.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   239         16  CR-SKIP                       PIC 99.
   240             88  NO-MONTHS-SKIPPED            VALUE 00.
   241             88  SKIP-JULY                    VALUE 01.
   242             88  SKIP-AUGUST                  VALUE 02.
   243             88  SKIP-SEPTEMBER               VALUE 03.
   244             88  SKIP-JULY-AUG                VALUE 04.
   245             88  SKIP-AUG-SEPT                VALUE 05.
   246             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   247             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   248             88  SKIP-JUNE                    VALUE 08.
   249             88  SKIP-JUNE-JULY               VALUE 09.
   250             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   251             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   252         16  CR-RESIDENT-STATE             PIC XX.
   253         16  CR-RATE-CODE.
   254             20  CR-LF-CLASS-CD            PIC XX.
   255             20  CR-AH-CLASS-CD            PIC XX.
   256         16  CR-MORT.
   257             20  CR-TAB                    PIC X.
   258             20  CR-INT                    PIC 99.
   259             20  CR-GRP                    PIC X.
   260         16  CR-MEMBER-NO                  PIC X(12).
   261         16  CR-OLD-LOF                    PIC XXX.
   262*        16  CR-LOAN-OFFICER               PIC XXX.
   263         16  CR-REIN-TABLE                 PIC XXX.
   264         16  CR-REIN-SPEC                  PIC X.
   265         16  CR-LOAN-1ST-PMT-DT.
   266             20  CR-1ST-PMT-YR             PIC 99.
   267             20  CR-1ST-PMT-MO             PIC 99.
   268             20  CR-1ST-PMT-DA             PIC 99.
   269         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   270         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   271         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   272         16  CR-LAST-ADD-ON-DT             PIC XX.
   273
   274         16  CR-UNDERWRITING-CODE          PIC X.
   275             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   276
   277         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   278         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   279         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   280         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   281
   282     12  CR-STATUS-INFORMATION.
   283         16  CR-ENTRY-STATUS               PIC X.
   284             88  CR-NORMAL-ENTRY              VALUE '1'.
   285             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   286             88  CR-CONVERSION-ENTRY          VALUE '4'.
   287             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   288             88  CR-POLICY-IS-CASH            VALUE 'C'.
   289             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   290             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   291             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   292             88  CR-POLICY-IS-VOID            VALUE 'V'.
   293             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   294             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   295                                                'C' '5' '9' 'P'.
   296         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS057.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   297
   298         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   299         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   300         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   301
   302         16  CR-LF-STATUS-AT-DEATH         PIC X.
   303         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   304
   305         16  CR-LF-CURRENT-STATUS          PIC X.
   306             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   307             88  CR-LF-POLICY-PENDING         VALUE '2'.
   308             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   309             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   310             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   311             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   312             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   313             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   314             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   315             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   316             88  CR-LF-IS-DECLINED            VALUE 'D'.
   317             88  CR-LF-IS-VOID                VALUE 'V'.
   318             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   319                                                    '4' '5' '9'.
   320
   321         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   322
   323         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   324         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   325
   326         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   327         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   328
   329         16  CR-AH-CURRENT-STATUS          PIC X.
   330             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   331             88  CR-AH-POLICY-PENDING         VALUE '2'.
   332             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   333             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   334             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   335             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   336             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   337             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   338             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   339             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   340             88  CR-AH-IS-DECLINED            VALUE 'D'.
   341             88  CR-AH-IS-VOID                VALUE 'V'.
   342             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   343                                                    '4' '5' '9'.
   344         16  CR-LOAN-OFFICER               PIC X(5).
   345         16  CR-CANCEL-REASON              PIC X.
   346         16  cr-xycor-lf-cov-code          pic x(4).
   347         16  cr-xycor-ah-cov-code          pic x(4).
   348         16  cr-temp-epiq                  pic x(4).
   349         16  FILLER                        PIC XX.
   350
   351     12  CR-DEATH-CLAIM-DATA.
   352         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   353
   354         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS057.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   355         16  CR-DTH-RPT-DT.
   356             20  CR-DTH-RPT-YR             PIC 99.
   357             20  CR-DTH-RPT-MO             PIC 99.
   358             20  CR-DTH-RPT-DA             PIC 99.
   359         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   360
   361         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   362         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   363         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   364         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   365         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   366
   367         16  CR-DTH-AGE                    PIC 99.
   368         16  CR-DTH-PAY-CD                 PIC X.
   369         16  CR-DEATH-CAUSE                PIC X(6).
   370
   371         16  FILLER                        PIC X(16).
   372
   373     12  CR-DISAB-CLAIM-DATA.
   374         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   375
   376         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   377         16  CR-DIS-RPT-DT.
   378             20  CR-DIS-RPT-YR             PIC 99.
   379             20  CR-DIS-RPT-MO             PIC 99.
   380             20  CR-DIS-RPT-DA             PIC 99.
   381         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   382         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   383
   384         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   385         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   386         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   387         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   388         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   389
   390         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   391         16  CR-DIS-PAY-CD                 PIC X.
   392         16  FILLER                        PIC XX.
   393
   394         16  CR-DISAB-INCURRED-DETAIL.
   395             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   396**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   397                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   398                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   399                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   400
   401         16  CR-DISAB-CAUSE                PIC X(6).
   402         16  FILLER                        PIC X(14).
   403
   404     12  CR-REMIT-TO                       PIC 99.
   405
   406     12  CR-COMPENSATION-LEVELS.
   407         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   408             20  CR-COM-AGT.
   409                 24  CR-COM-AGT-PREFIX     PIC X(4).
   410                 24  CR-COM-AGT-PRIME      PIC X(6).
   411             20  CR-AGT-TYPE               PIC X.
   412             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS057.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   413             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   414
   415     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   416     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   417     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   418     12  CR-CLP-STATE                      PIC XX.
   419     12  CR-POST-CARD-IND                  PIC X.
   420     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   421     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   422     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   423     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   424     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   425     12  FILLER                            PIC X(07).
   426
   427     12  CR-CSR-CODE                       PIC XXX.
   428
   429     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   430     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   431
   432     12  CR-MICROFILM-NUMBERS.
   433*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   434         16  FILLER                        PIC X(5).
   435     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   436
   437     12  CR-USER-CODE                      PIC X.
   438     12  CR-USER-FUTURE                    PIC X(9).
   439
   440     12  CR-BENEFICIARY.
   441         16  CR-BANK-NO                    PIC X(10).
   442         16  FILLER                        PIC X(15).
   443
   444     12  CR-ENTRY-BATCH                    PIC X(6).
   445     12  CR-LF-EXIT-BATCH                  PIC X(6).
   446     12  CR-AH-EXIT-BATCH                  PIC X(6).
   447
   448     12  CR-NOTE-SW                        PIC X.
   449
   450     12  CR-ORIGIN-INDICATOR               PIC X.
   451         88  CR-ENTERED-MANUALLY              VALUE '1'.
   452         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   453
   454     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   455     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   456     12  FILLER                            PIC X(33).
   457
   458******************************************************************
   459                                                                  ECS057
   460 FD  DISK-DATE                                                    ECS057
*  461                             COPY ELCDTEFD.                       ECS057
   462******************************************************************04/15/98
   463*                                                                *ELCDTEFD
   464*                                                                *ELCDTEFD
   465*                            ELCDTEFD.                           *   LV002
   466*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   467*                            VMOD=2.007                          *   CL**2
   468*                                                                *ELCDTEFD
   469******************************************************************ELCDTEFD
   470     BLOCK CONTAINS 0 RECORDS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   471     RECORDING MODE F.                                            ELCDTEFD
   472                                                                  ELCDTEFD
   473 01  DATE-DISK.                                                   ELCDTEFD
   474     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   475     12  FILLER                      PIC  X(14).                  ELCDTEFD
   476     12  DD-CR1                      PIC  9.                      ELCDTEFD
   477     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   478     12  DD-CR2                      PIC  9.                      ELCDTEFD
   479     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   480     12  FILLER                      PIC  X(20).                  ELCDTEFD
   481                                                                  ELCDTEFD
   482 01  DATE-DISK-R.                                                 ELCDTEFD
   483     12  FILLER                      PIC  X(4).                   ELCDTEFD
   484     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   485                                     PIC  X(32).                  ELCDTEFD
   486                                                                  ELCDTEFD
   487 01  DATE-DISK-T.                                                 ELCDTEFD
   488     12  FILLER                      PIC  X(4).                   ELCDTEFD
   489     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   490                                     PIC  X(48).                  ELCDTEFD
   491                                                                  ELCDTEFD
   492 01  DATE-DISK-M.                                                 ELCDTEFD
   493     12  FILLER                      PIC  X(4).                   ELCDTEFD
   494     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   495                                     PIC  X(48).                  ELCDTEFD
   496                                                                  ELCDTEFD
   497 01  DATE-DISK-P.                                                 ELCDTEFD
   498     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   499     12  DD-IDX                      PIC  99.                     ELCDTEFD
   500     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   501     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   502         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   503                                     PIC  X.                      ELCDTEFD
   504         16  FILLER                  PIC  X(46).                  ELCDTEFD
   505     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   506         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   507             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   508             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   509             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   510             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   511         16  FILLER                  PIC  X(16).                  ELCDTEFD
   512                                                                  ELCDTEFD
   513 01  DATE-DISK-E.                                                 ELCDTEFD
   514     12  FILLER                      PIC  X(4).                   ELCDTEFD
   515     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   516                                     PIC  X(4).                   ELCDTEFD
   517                                                                  ELCDTEFD
   518 01  DATE-DISK-C.                                                 ELCDTEFD
   519     12  FILLER                      PIC  X(7).                   ELCDTEFD
   520     12  DD-CARR1-SECPAY-SW          PIC  X.
   521     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   522     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   523     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   524     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   525     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   526     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   527     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   528     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   529     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   530     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   531     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   532     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   533     12  DD-CARR2-SECPAY-SW          PIC  X.
   534     12  FILLER                      PIC  X(7).                   ELCDTEFD
   535                                                                  ELCDTEFD
   536 01  DATE-DISK-OPT.                                               ELCDTEFD
   537     12  FILLER                      PIC  X(04).                  ELCDTEFD
   538     12  DD-TLR-DATA.                                             ELCDTEFD
   539         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   540                                     PIC  X(03).                  ELCDTEFD
   541     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   542         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   543                                     PIC  X(06).                  ELCDTEFD
   544     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   545         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   546                                     PIC  X(07).                  ELCDTEFD
   547         16  FILLER                  PIC  X(05).                  ELCDTEFD
   548     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   549                                     PIC  X(96).                  ELCDTEFD
   550******************************************************************ELCDTEFD
   551
   552 SD  SORTFL.
   553
   554 01  SRT-REC.
   555     12  SRT-STATE               PIC XX.
   556     12  SRT-ACCOUNT             PIC X(10).
   557     12  SRT-ENTRY-DT            PIC 9(11)  COMP-3.
   558     12  SRT-BATCH-NO            PIC X(6).
   559     12  SRT-EFF-DT              PIC 9(11)  COMP-3.
   560     12  SRT-AMOUNT              PIC S9(9)V99 COMP-3.
   561
   562 WORKING-STORAGE SECTION.                                         ECS057
   563 77  FILLER  PIC  X(32) VALUE '********************************'. ECS057
   564 77  FILLER  PIC  X(32) VALUE '     ECS057 WORKING STORAGE     '. ECS057
   565 77  FILLER  PIC  X(32) VALUE '********** VMOD=2.008 **********'.    CL**3
   566                                                                  ECS057
   567 77  WK-YR                   PIC S9(5)   COMP-3  VALUE +0.        ECS057
   568 77  PAGER                   PIC S9(5)   COMP-3  VALUE +1.        ECS057
   569 77  X                       PIC  X.                              ECS057
   570 77  a1                      pic s999    comp-3  value +0.
   571 77  ws-fees-outside-clp     pic s9(7)v99 comp-3 value +0.
   572 77  ws-lf-canc-fees-outside-clp
   573                             pic s9(7)v99 comp-3 value +0.
   574 77  ws-ah-canc-fees-outside-clp
   575                             pic s9(7)v99 comp-3 value +0.
   576
   577 01  WS-COUNTERS-AND-SUBS.
   578     05  MONTH-SUB            COMP    PIC S9(03) VALUE +0.
   579     05  SAVE-1ST-EFF-MONTH           PIC 9(03)  VALUE 0.
   580     05  COLUMN-SUB           COMP    PIC S9(02) VALUE +0.
   581     05  SUB                  COMP    PIC S9(03) VALUE +0.
   582     05  SUB1                 COMP    PIC S9(03) VALUE +0.
   583     05  SUB2                 COMP    PIC S9(03) VALUE +0.
   584     05  SUB3                 COMP    PIC S9(03) VALUE +0.
   585     05  PROCMO               COMP    PIC S9(03) VALUE +0.
   586     05  EFFMO                COMP    PIC S9(03) VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS057.cbl
   587     05  EFFMOCOL             COMP    PIC S9(03) VALUE +0.
   588     05  MOHDR                COMP    PIC S9(03) VALUE +0.
   589     05  PGM-SUB              COMP    PIC S9(03) VALUE +57.
   590     05  WS-LINE-COUNT        COMP-3  PIC S9(03) VALUE +56.
   591     05  WS-LINE-COUNT-MAX    COMP-3  PIC S9(03) VALUE +55.
   592     05  WS-PAGE              COMP-3  PIC S9(05) VALUE +0.
   593
   594 01  WS-DATES.
   595     05  WS-HDR-EFF-CCYY              PIC 9(04)  VALUE 0.
   596     05  WS-HDR-EFF-CCYY-2                       REDEFINES
   597         WS-HDR-EFF-CCYY.
   598         10  WS-HDR-EFF-CC            PIC 9(02).
   599         10  WS-HDR-EFF-YY            PIC 9(02).
   600
   601     05  WS-CR-ENTRY-DATE             PIC 9(11).
   602     05  WS-CR-ENTRY-DATE-R                      REDEFINES
   603         WS-CR-ENTRY-DATE.
   604         10  FILLER                   PIC 9(03).
   605         10  WS-CR-ENTRY-CYMD.
   606             15  WS-CR-ENTRY-CC       PIC 9(02).
   607             15  WS-CR-ENTRY-YY       PIC 9(02).
   608             15  WS-CR-ENTRY-MM       PIC 9(02).
   609             15  WS-CR-ENTRY-DD       PIC 9(02).
   610
   611     05  WS-LF-EXIT-DATE              PIC 9(11).
   612     05  WS-LF-EXIT-DATE-R                      REDEFINES
   613         WS-LF-EXIT-DATE.
   614         10  FILLER                   PIC 9(03).
   615         10  WS-LF-EXIT-CYMD.
   616             15  WS-LF-EXIT-CC       PIC 9(02).
   617             15  WS-LF-EXIT-YY       PIC 9(02).
   618             15  WS-LF-EXIT-MM       PIC 9(02).
   619             15  WS-LF-EXIT-DD       PIC 9(02).
   620
   621     05  WS-AH-EXIT-DATE              PIC 9(11).
   622     05  WS-AH-EXIT-DATE-R                      REDEFINES
   623         WS-AH-EXIT-DATE.
   624         10  FILLER                   PIC 9(03).
   625         10  WS-AH-EXIT-CYMD.
   626             15  WS-AH-EXIT-CC       PIC 9(02).
   627             15  WS-AH-EXIT-YY       PIC 9(02).
   628             15  WS-AH-EXIT-MM       PIC 9(02).
   629             15  WS-AH-EXIT-DD       PIC 9(02).
   630
   631     05  WS-EARLIEST-PROCESS-DT.
   632         10  WS-EARLIEST-PROC-DT-CCYY PIC 9(04)  VALUE 0.
   633         10  WS-EARLIEST-PROC-DT-MM   PIC 9(02)  VALUE 0.
   634         10  WS-EARLIEST-PROC-DT-DD   PIC 9(02)  VALUE 0.
   635
   636     05  WS-CERT-EFF-DT               PIC 9(11).
   637     05  WS-CERT-EFF-DT-R                        REDEFINES
   638         WS-CERT-EFF-DT.
   639         10  FILLER                   PIC 9(03).
   640         10  WS-CERT-EFF-CYMD.
   641             15  WS-CERT-EFF-CC       PIC 9(02).
   642             15  WS-CERT-EFF-YY       PIC 9(02).
   643             15  WS-CERT-EFF-MM       PIC 9(02).
   644             15  WS-CERT-EFF-DD       PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS057.cbl
   645
   646     05  WS-HOLD-ENTRY-DATE           PIC 9(11)  VALUE 0.
   647     05  WS-HOLD-ENTRY-DATE-R                    REDEFINES
   648         WS-HOLD-ENTRY-DATE.
   649         10  FILLER                   PIC 9(03).
   650         10  WS-HOLD-ENTRY-CYMD.
   651             15  WS-HOLD-ENTRY-CC     PIC X(02).
   652             15  WS-HOLD-ENTRY-YY     PIC X(02).
   653             15  WS-HOLD-ENTRY-MM     PIC X(02).
   654             15  FILLER               PIC X(02).
   655
   656     05  WS-HOLD-EXIT-DATE            PIC 9(11)  VALUE 0.
   657     05  WS-HOLD-EXIT-DATE-R                     REDEFINES
   658         WS-HOLD-EXIT-DATE.
   659         10  FILLER                   PIC 9(03).
   660         10  WS-HOLD-EXIT-CYMD.
   661             15  WS-HOLD-EXIT-CC      PIC X(02).
   662             15  WS-HOLD-EXIT-YY      PIC X(02).
   663             15  WS-HOLD-EXIT-MM      PIC X(02).
   664             15  FILLER               PIC X(02).
   665
   666 01  WS-SWITCHES.
   667     05  WS-EOF-OFFLN-CERT            PIC X(01)  VALUE SPACE.
   668         88  EOF                                 VALUE '1'.
   669
   670     05  WS-FIRST-TIME-SW             PIC X(01)  VALUE SPACE.
   671         88  NOT-FIRST-TIME                      VALUE 'X'.
   672
   673     05  WS-DETAIL-LINE-SW            PIC X(01)  VALUE SPACE.
   674         88  DETAIL-LN-NOT-DONE                  VALUE '1'.
   675         88  DETAIL-LN-WITH-PREMIUM-DONE         VALUE '2'.
   676
   677     05  WS-SUBTOTAL-SW               PIC X(01)  VALUE SPACE.
   678         88  SUBTOT-NOT-NEEDED                   VALUE '1'.
   679         88  SUBTOT-REQUIRED-FOR-PROCMO          VALUE '2'.
   680
   681     05  WS-MON-TOTAL-SW              PIC X(01)  VALUE SPACE.
   682         88  NEW-MONTH-TOTAL                     VALUE '1'.
   683         88  TOTAL-FOR-MONTH-DONE                VALUE '2'.
   684
   685 01  WS-MISC.
   686     05  WS-HOLD-ACCT                 PIC X(10)  VALUE SPACES.
   687     05  WS-HOLD-STATE                PIC X(02)  VALUE SPACES.
   688     05  WS-HOLD-ENTRY-BATCH          PIC X(06)  VALUE SPACES.
   689     05  WS-HOLD-ALPHA-MO             PIC X(03)  VALUE SPACES.
   690     05  WS-HOLD-PREV-ACCT            PIC X(10)  VALUE SPACES.
   691     05  WS-HOLD-PREV-MM              PIC X(02)  VALUE SPACES.
   692     05  WS-HOLD-PREV-YY              PIC X(02)  VALUE SPACES.
   693
   694     05  WS-PREMIUM-PAYMENT           PIC S9(07)V99
   695                                                 VALUE ZEROS.
   696
   697
   698
   699
   700***** THE FOLLOWING TOTAL TABLES DEFINED FOR EACH ACCOUNT
   701******************************************************************
   702 01  WS-PAYMENT-BYBATCH-TABLE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS057.cbl
   703     05  WS-PAYMENT-BYBATCH         COMP-3   PIC S9(07)V99
   704                                                 VALUE ZEROS
   705                                                 OCCURS 12 TIMES.
   706
   707 01  WS-PAYMENT-BYPROCMO-TABLE.
   708     05  WS-PAYMENT-BYPROCMO        COMP-3   PIC S9(07)V99
   709                                                 VALUE ZEROS
   710                                                 OCCURS 12 TIMES.
   711
   712 01  WS-12MO-TOTALS-TABLE.
   713     05  WS-PAYMENT-12MOTOTS-BYACCT COMP-3   PIC S9(07)V99
   714                                                 VALUE ZEROS
   715                                                 OCCURS 12 TIMES.
   716
   717
   718***** THE FOLLOWING TOTAL TABLES DEFINED TO SUMMARIZE ALL ACCOUNTS
   719******************************************************************
   720 01  WS-ALLACCT-PAYMENTS-TABLE.
   721     05  WS-ALLACCT-BYPROCMO  OCCURS 12 TIMES.
   722         10  WS-ALLACCT-BYPROCMO-EFFMO COMP-3 PIC S9(07)V99
   723                                                 VALUE ZEROS
   724                                                 OCCURS 12 TIMES.
   725
   726 01  WS-ALLACCT-12MO-TOTALS-TABLE.
   727     05  WS-ALLACCT-12MOTOTS          COMP-3 PIC S9(07)V99
   728                                                 VALUE ZEROS
   729                                                 OCCURS 12 TIMES.
   730******************************************************************
   731
   732 01  WS-TOT-PAYMENTS-PROCMO          COMP-3  PIC S9(07)V99
   733                                                 VALUE ZEROS.
   734
   735 01  WS-12MO-ACCT-TOTAL              COMP-3  PIC S9(07)V99
   736                                                 VALUE ZEROS.
   737
   738 01  WS-12MO-ALLACCT-GRAND-TOTAL     COMP-3  PIC S9(07)V99
   739                                                 VALUE ZEROS.
   740
   741******************************************************************
   742
   743 01  MONTH-TAB.
   744     05  MONTH-TB1.
   745         10  FILLER                   PIC X(03)  VALUE 'JAN'.
   746         10  FILLER                   PIC X(03)  VALUE 'FEB'.
   747         10  FILLER                   PIC X(03)  VALUE 'MAR'.
   748         10  FILLER                   PIC X(03)  VALUE 'APR'.
   749         10  FILLER                   PIC X(03)  VALUE 'MAY'.
   750         10  FILLER                   PIC X(03)  VALUE 'JUN'.
   751         10  FILLER                   PIC X(03)  VALUE 'JUL'.
   752         10  FILLER                   PIC X(03)  VALUE 'AUG'.
   753         10  FILLER                   PIC X(03)  VALUE 'SEP'.
   754         10  FILLER                   PIC X(03)  VALUE 'OCT'.
   755         10  FILLER                   PIC X(03)  VALUE 'NOV'.
   756         10  FILLER                   PIC X(03)  VALUE 'DEC'.
   757     05  MONTH-TB2  REDEFINES  MONTH-TB1.
   758         10  ALPHA-MONTH              PIC X(03)  OCCURS 12 TIMES.
   759
   760 01  WS-NUMERIC-MONTH-TAB.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS057.cbl
   761     05  MONTH-TB3.
   762         10  FILLER                   PIC X(02)  VALUE '01'.
   763         10  FILLER                   PIC X(02)  VALUE '02'.
   764         10  FILLER                   PIC X(02)  VALUE '03'.
   765         10  FILLER                   PIC X(02)  VALUE '04'.
   766         10  FILLER                   PIC X(02)  VALUE '05'.
   767         10  FILLER                   PIC X(02)  VALUE '06'.
   768         10  FILLER                   PIC X(02)  VALUE '07'.
   769         10  FILLER                   PIC X(02)  VALUE '08'.
   770         10  FILLER                   PIC X(02)  VALUE '09'.
   771         10  FILLER                   PIC X(02)  VALUE '10'.
   772         10  FILLER                   PIC X(02)  VALUE '11'.
   773         10  FILLER                   PIC X(02)  VALUE '12'.
   774     05  MONTH-TB4                               REDEFINES
   775         MONTH-TB3.
   776         10  NUMERIC-MONTH            PIC X(02)  OCCURS 12 TIMES.
   777
   778 01  WS-ACCOUNT-HEADING.
   779     05  FILLER                       PIC X(01)  VALUE '0'.
   780     05  FILLER                       PIC X(10)  VALUE
   781         'ACCOUNT - '.
   782     05  WS-H-ACCOUNT                 PIC X(10)  VALUE SPACES.
   783     05  FILLER                       PIC X(06)  VALUE SPACES.
   784     05  WS-H-LITERAL                 PIC X(08)  VALUE
   785         'STATE - '.
   786     05  WS-H-STATE                   PIC X(02)  VALUE SPACES.
   787     05  FILLER                       PIC X(96)  VALUE SPACES.
   788
   789
   790 01  WS-HEADING1.
   791     05  FILLER                       PIC X(01)  VALUE '1'.
   792     05  FILLER                       PIC X(47)  VALUE SPACES.
   793     05  WS-H1-TITLE                  PIC X(28)  VALUE
   794         'PERIODIC FEE PAYMENT HISTORY'.
   795     05  FILLER                       PIC X(5)  VALUE SPACES.
   796     05  WS-H1-CLP-TITLE              PIC X(40)  VALUE SPACES.
   797     05  WS-H1-REPORT-ID              PIC X(06)  VALUE 'ECS057'.
   798     05  WS-H1-CLP-ID                 PIC XXX    VALUE SPACES.
   799     05  FILLER                       PIC XXX  VALUE SPACES.
   800
   801
   802 01  WS-HEADING2.
   803     05  FILLER                       PIC X(01)  VALUE SPACE.
   804     05  FILLER                       PIC X(46)  VALUE SPACES.
   805     05  WS-H2-COMPANY-NAME           PIC X(30)  VALUE SPACES.
   806     05  FILLER                       PIC X(44)  VALUE SPACES.
   807     05  WS-H2-DATE                   PIC X(08)  VALUE SPACES.
   808     05  FILLER                       PIC X(04)  VALUE SPACES.
   809
   810
   811 01  WS-HEADING3.
   812     05  FILLER                       PIC X(01)  VALUE SPACE.
   813     05  FILLER                       PIC X(52)  VALUE SPACES.
   814     05  WS-H3-MONTHEND-DT            PIC X(18)  VALUE SPACES.
   815     05  FILLER                       PIC X(50)  VALUE SPACES.
   816     05  FILLER                       PIC X(04)  VALUE 'PAGE'.
   817     05  FILLER                       PIC X(01)  VALUE SPACES.
   818     05  WS-H3-PAGE                   PIC ZZ,ZZ9.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS057.cbl
   819     05  FILLER                       PIC X(01)  VALUE SPACE.
   820
   821
   822 01  WS-HEADING4.
   823     05  FILLER                       PIC X(01)  VALUE '0'.
   824     05  FILLER                       PIC X(44)  VALUE SPACES.
   825     05  FILLER                       PIC X(33)  VALUE
   826         'MASTER CERTIFICATE EFFECTIVE DATE'.
   827     05  FILLER                       PIC X(55)  VALUE SPACES.
   828
   829
   830 01  WS-HEADING5.
   831     05  FILLER                       PIC X(01)  VALUE ' '.
   832     05  FILLER                       PIC X(12)  VALUE SPACES.
   833     05  WS-H5-EFFECTIVE-MONTHS       PIC X(120) VALUE SPACES.
   834     05  WS-H5-EFFECTIVE-MONTHS-R                REDEFINES
   835         WS-H5-EFFECTIVE-MONTHS.
   836         10  WS-H5-EFF-MOYY                      OCCURS 12 TIMES.
   837             15  FILLER               PIC X(05).
   838             15  WS-H5-EFF-MO         PIC X(03).
   839             15  WS-H5-EFF-YY         PIC X(02).
   840
   841
   842 01  WS-HEADING6.
   843     05  FILLER                       PIC X(01)  VALUE SPACE.
   844     05  FILLER                       PIC X(09)  VALUE
   845         'PROCESSED'.
   846     05  FILLER                       PIC X(125) VALUE SPACES.
   847
   848
   849 01  WS-HEADING7.
   850     05  FILLER                       PIC X(01)  VALUE SPACE.
   851     05  WS-H7-VARIABLE-HDR          PIC X(15)  VALUE
   852         'DATE AND BATCH#'.
   853     05  FILLER                       PIC X(117) VALUE SPACES.
   854
   855
   856 01  WS-DETAIL.
   857     05  WS-D1-PRINT-CTL              PIC X(01)   VALUE ' '.
   858     05  WS-D1-PROCESS-DATE.
   859         10  WS-D1-PROCESS-MO         PIC X(03)   VALUE SPACES.
   860         10  WS-D1-PROCESS-YY         PIC X(02)   VALUE SPACES.
   861     05  WS-D1-BATCH-NO               PIC X(06)   VALUE SPACES.
   862     05  FILLER                       PIC X(01)   VALUE SPACES.
   863     05  WS-D1-PAYMENT                PIC ZZZZZ9.99-
   864                                                  OCCURS 12 TIMES.
   865
   866
   867 01  WS-WK.
   868     12  WS-RETURN-CODE               PIC X(04)   VALUE SPACES.
   869     12  WS-ABEND-MESSAGE             PIC X(80)   VALUE SPACES.
   870     12  WS-ZERO                      PIC S9(01)  VALUE ZERO.
   871     12  WS-ABEND-FILE-STATUS         PIC X(02)   VALUE SPACES.
   872                                                                  ECS057
*  873     COPY ELCDTECX.                                               ECS057
   874******************************************************************06/05/98
   875*                                                                *ELCDTECX
   876*                            ELCDTECX.                           *   LV005
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   877*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   878*                            VMOD=2.015                          *ELCDTECX
   879*                                                                *ELCDTECX
   880*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   881*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   882*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   883*                                                                *ELCDTECX
   884******************************************************************ELCDTECX
   885******************************************************************
   886*                   C H A N G E   L O G
   887*
   888* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   889*-----------------------------------------------------------------
   890*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   891* EFFECTIVE    NUMBER
   892*-----------------------------------------------------------------
   893* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   894*                                  BENEFIT CODES FROM 300 TO 900
   895* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   896* 051304    2003080800002  SMVA  ADD REFUND METHOD
   897* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   898******************************************************************
   899 01  DATE-CARD.                                                   ELCDTECX
   900     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   901     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   902     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   903     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   904     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   905     12  EP-SW                       PIC  X.                      ELCDTECX
   906         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   907     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   908         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   909     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   910     12  RUN-CENTURY.                                             ELCDTECX
   911         16 RUN-CENTURY-N            PIC  99.                        CL**4
   912     12  FILLER                      PIC  X.                         CL**4
   913     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   914     12  FILLER                      PIC  XXX.                    ELCDTECX
   915     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   916                                                                  ELCDTECX
   917 01  FILLER                          PIC  X(7)                       CL**6
   918                                          VALUE 'OPTIONS'.        ELCDTECX
   919 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   920     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   921     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   922     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   923         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   924         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   925     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   926     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   927     12  FILLER                      PIC  X.                      ELCDTECX
   928     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   929     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   930     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   931     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   932     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   933     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   934     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   935     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   936     12  FILLER                      PIC  X.                      ELCDTECX
   937     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   938     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   939     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   940     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   941     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   942     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   943     12  FILLER                      PIC  X.                      ELCDTECX
   944     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   945     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   946     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   947     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   948     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   949     12  DTE-R78                     PIC  X.                      ELCDTECX
   950     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   951     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   952     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   953     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   954     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   955     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   956     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   957                                     PIC  X.                      ELCDTECX
   958         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   959                                                 ' '.             ELCDTECX
   960         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   961         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   962     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   963         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   964         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   965     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   966     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   967                                     PIC  9.                         CL**4
   968     12  DTE-SYSTEM.                                              ELCDTECX
   969         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   970         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   971         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   972         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   973         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   974         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   975         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   976         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   977         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   978         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   979         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   980         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   981         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   982         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   983         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   984         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   985         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   986         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   987         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   988         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   989         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   990         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   991         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   992         16  DTE-SYS-X               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   993         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   994         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   995     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   996         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   997                                     PIC  X.                      ELCDTECX
   998     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   999                                                                  ELCDTECX
  1000 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1001     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1002     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1003     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1004*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1005     12  FILLER                      PIC  X.                      ELCDTECX
  1006     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1007     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1008     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1009     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1010     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1011     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1012     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1013                                                                  ELCDTECX
  1014     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1015     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1016     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1017     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1018                                                                  ELCDTECX
  1019     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1020     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1021     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1022     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1023                                                                  ELCDTECX
  1024     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1025     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1026                                                                  ELCDTECX
  1027     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1028     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1029                                                                  ELCDTECX
  1030     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1031                                                                  ELCDTECX
  1032 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1033     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1034     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1035     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1036     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1037     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1038     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1039     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1040                                                                  ELCDTECX
  1041 01  FILLER                          PIC  X(12)                   ELCDTECX
  1042                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1043 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1044     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1045         16  CNT-ID                  PIC  X.                      ELCDTECX
  1046         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1047                                                                  ELCDTECX
  1048 01  FILLER                          PIC  X(11)                   ELCDTECX
  1049                                          VALUE 'STATE NAMES'.    ELCDTECX
  1050 01  STATE-NAMES.                                                 ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1051     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1052         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1053         16  STATE-PIC1.                                          ELCDTECX
  1054             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1055             20  FILLER              PIC  XXX.                    ELCDTECX
  1056             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1057             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1058             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1059             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1060                                                                  ELCDTECX
  1061 01  FILLER                          PIC  X(13)                   ELCDTECX
  1062                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1063 01  CARRIER-NAMES.                                               ELCDTECX
  1064     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1065         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1066         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1067         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1068         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1069         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1070         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1071*        16  FILLER                  PIC  X.                      ELCDTECX
  1072         16  CARRIER-SEC-PAY         PIC  X.
  1073             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1074                                                                  ELCDTECX
  1075 01  FILLER                          PIC  X(9)                       CL**6
  1076                                          VALUE 'INS TYPES'.      ELCDTECX
  1077 01  CLAS-INS-TYPES.                                              ELCDTECX
  1078*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1079     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1080         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1081         16  CLAS-I-AB3.                                          ELCDTECX
  1082             20  FILLER              PIC  X.                      ELCDTECX
  1083             20  CLAS-I-AB2.                                      ELCDTECX
  1084                 24  FILLER          PIC  X.                      ELCDTECX
  1085                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1086         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1087             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1088             20  FILLER              PIC  X.                         CL**4
  1089         16  CLAS-I-AB10.                                         ELCDTECX
  1090             20  FILLER              PIC  X(9).                   ELCDTECX
  1091             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1092         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1093         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1094         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1095         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1096             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1097         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1098         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1099         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1100         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1101         16  CLAS-I-REFUND-METHOD    PIC  X.
  1102         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1103         16  FILLER                  PIC  XXX.
  1104                                                                  ELCDTECX
  1105 01  FILLER                          PIC  X(16)                   ELCDTECX
  1106                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1107 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1108     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1109                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1110         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1111         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1112         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1113         16  CLAS-MORT-DESC.                                      ELCDTECX
  1114             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1115             20  FILLER              PIC  XX.                        CL**5
  1116             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1117             20  FILLER              PIC  X.                         CL**5
  1118             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1119             20  FILLER              PIC  X.                         CL**5
  1120             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1121             20  FILLER              PIC  X.                         CL**5
  1122             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1123             20  FILLER              PIC  X(5).                      CL**6
  1124                                                                  ELCDTECX
  1125 01  FILLER                          PIC  X(15)                   ELCDTECX
  1126                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1127 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1128     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1129         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1130         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1131         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1132         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1133         16  FILLER                  PIC  X(4).                      CL**6
  1134                                                                  ELCDTECX
  1135 01  FILLER                          PIC  X(7)                       CL**6
  1136                                     VALUE 'INDEXES'.             ELCDTECX
  1137 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1138     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1139     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1140     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1141     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1142     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1143     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1144     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1145     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1146     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1147     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1148     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1149     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1150     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1151     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1152     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1153     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1154     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1155                                                                  ELCDTECX
  1156 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1157     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1158     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1159     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1160     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1161     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1162     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1163     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1164     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1165     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1166     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1167     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1168                                                                  ELCDTECX
  1169 01  FILLER                          PIC  X(13)                   ELCDTECX
  1170                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1171 01  CLAS-MISC.                                                   ELCDTECX
  1172     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1173         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1174         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1175         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1176     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1177     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1178     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1179     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1180     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1181     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1182     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1183     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1184     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1185     12  STATE-L                     PIC  XX.                     ELCDTECX
  1186     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1187     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1188     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1189         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1190         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1191     12  DTE-ABEND-WORK.                                          ELCDTECX
  1192         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1193         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1194                                                                  ELCDTECX
  1195 01  FILLER                          PIC  X(12)                   ELCDTECX
  1196                                     VALUE 'WORKING DATE'.        ELCDTECX
  1197 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1198     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1199         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1200         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1201         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1202     12  WS-CURRENT-DATE.                                         ELCDTECX
  1203         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1204         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1205         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1206         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1207         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1208     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1209         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1210         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1211                                                                  ELCDTECX
  1212 01  FILLER                          PIC  X(12)                   ELCDTECX
  1213                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1214 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1215     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1216         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1217         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1218         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1219                                                                  ELCDTECX
  1220 01  FILLER                          PIC  X(10)                   ELCDTECX
  1221                                     VALUE 'STATE TLRS'.          ELCDTECX
  1222 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1223     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1224         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1225         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1226                                                                  ELCDTECX
  1227 01  FILLER                          PIC  X(13)                   ELCDTECX
  1228                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1229 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1230     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1231         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1232                                                                  ELCDTECX
  1233 01  FILLER                          PIC  X(13)                   ELCDTECX
  1234                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1235 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1236     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1237     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1238     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1239                                     PIC  X.                         CL**5
  1240     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1241     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1242     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1243     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1244     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1245     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1246     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1247     12  FILLER                      PIC  X(75).                  ELCDTECX
  1248******************************************************************ELCDTECX
  1249*01  MISC-CARR-PCT-DATA.                                          00001521
  1250*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1251*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1252*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1253*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1254*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1255*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1256******************************************************************ELCDTECX
  1257                                                                  ECS057
* 1258     COPY ELCDTEVR.                                               ECS057
  1259***************************************************************** 04/15/98
  1260*                                                                *ELCDTEVR
  1261*                                                                *ELCDTEVR
  1262*                            ELCDTEVR.                           *   LV003
  1263*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1264*                            VMOD=2.001                          *   CL**2
  1265*                                                                *ELCDTEVR
  1266*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1267*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1268*                                                                *ELCDTEVR
  1269******************************************************************ELCDTEVR
  1270 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1271     05  WS-RUN-DATE.                                             ELCDTEVR
  1272         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1273         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1274         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1275             15  RUN-CC              PIC  99.                     ELCDTEVR
  1276             15  RUN-YR              PIC  99.                     ELCDTEVR
  1277         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1278         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1279     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1280            WS-RUN-DATE              PIC 9(11).                      CL**2
  1281     05  WS-EP-DT.                                                ELCDTEVR
  1282         10  FILLER                  PIC  9(03).                  ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1283         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1284         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1285             15  EP-CC               PIC  99.                     ELCDTEVR
  1286             15  EP-YR               PIC  99.                     ELCDTEVR
  1287         10  EP-MO                   PIC  99.                     ELCDTEVR
  1288         10  EP-DA                   PIC  99.                     ELCDTEVR
  1289     05  WS-EP-DT-N REDEFINES                                        CL**2
  1290            WS-EP-DT                 PIC 9(11).                      CL**2
  1291     05  WS-DTE-CONV-DT.                                             CL**4
  1292         10  FILLER                  PIC  9(03).                     CL**4
  1293         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1294         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1295             15  DTE-CONV-CC         PIC  99.                        CL**4
  1296             15  DTE-CONV-YR         PIC  99.                        CL**4
  1297         10  DTE-CONV-MO             PIC  99.                        CL**4
  1298         10  DTE-CONV-DA             PIC  99.                        CL**4
  1299     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1300            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1301 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1302     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1303         10  FILLER                            PIC 999.           ELCDTEVR
  1304         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1305         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1306             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1307             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1308         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1309         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1310     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1311            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1312     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1313         10  FILLER                            PIC 999.           ELCDTEVR
  1314         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1315         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1316         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1317         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1318     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1319            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1320 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1321     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1322         10  FILLER                            PIC 999.           ELCDTEVR
  1323         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1324         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1325             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1326             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1327         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1328         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1329     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1330            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1331     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1332         10  FILLER                            PIC 999.           ELCDTEVR
  1333         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1334         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1335             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1336             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1337         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1338         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1339     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1340            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1341     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1342         10  FILLER                            PIC 999.           ELCDTEVR
  1343         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1344         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1345             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1346             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1347         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1348         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1349     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1350            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1351 01  WS-RATE-RECORD.                                              ELCDTEVR
  1352         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1353             10  FILLER                        PIC 999.           ELCDTEVR
  1354             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1355             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1356                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1357                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1358             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1359             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1360         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1361                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1362                                                                  ECS057
* 1363     COPY ELCDATE.                                                   CL**4
  1364******************************************************************06/11/98
  1365*                                                                *ELCDATE
  1366*                                                                *ELCDATE
  1367*                            ELCDATE.                            *   LV023
  1368*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1369*                            VMOD=2.003                           ELCDATE
  1370*                                                                *ELCDATE
  1371*                                                                *ELCDATE
  1372*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1373*                 LENGTH = 200                                   *   CL*19
  1374******************************************************************ELCDATE
  1375                                                                  ELCDATE
  1376 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1377     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1378     12  DC-OPTION-CODE                PIC X.                        CL*15
  1379         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1380         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1381         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1382         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1383         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1384         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1385         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1386         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1387         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1388         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1389         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1390         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1391         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1392         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1393         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1394         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1395         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1396         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1397         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1398         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1399         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1400         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1401         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1402         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1403         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1404         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1405         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1406         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1407         88  THREE-CHARACTER-BIN                                  ELCDATE
  1408                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1409         88  GREGORIAN-TO-BIN                                        CL**2
  1410                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1411         88  BIN-TO-GREGORIAN                                        CL**2
  1412                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1413         88  JULIAN-TO-BINARY                                        CL**2
  1414                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1415     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1416         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1417         88  DATE-CONVERSION-ERROR                                ELCDATE
  1418                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1419         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1420         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1421         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1422         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1423         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1424         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1425         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1426         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1427         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1428         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1429     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1430         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1431     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1432         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1433         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1434         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1435     12  FILLER                        PIC X.                        CL*15
  1436     12  DC-CONVERSION-DATES.                                        CL*15
  1437         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1438         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1439         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1440         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1441                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1442             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1443             20  SLASH1-1              PIC X.                        CL*15
  1444             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1445             20  SLASH1-2              PIC X.                        CL*15
  1446             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1447         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1448         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1449                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1450             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1451             20  SLASH2-1              PIC X.                        CL*15
  1452             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1453             20  SLASH2-2              PIC X.                        CL*15
  1454             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1455         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1456         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1457                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1458             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1459             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1460             20  DC-YMD-DAY            PIC 99.                       CL*15
  1461         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1462         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1463                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1464             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1465             20  DC-MDY-DAY            PIC 99.                       CL*15
  1466             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1467         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1468             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1469             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1470             20  FILLER                PIC XX.                       CL*15
  1471             20  DC-ALPHA-CENTURY.                                   CL*15
  1472                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1473             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1474         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1475         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1476         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1477         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1478         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1479                                       PIC 9(05).                    CL*20
  1480         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1481             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1482             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1483         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1484         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1485         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1486     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1487         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1488         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1489             20  FILLER                PIC 9(3).                     CL*15
  1490             20  HOLD-CEN-1-CCYY.                                    CL*15
  1491                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1492                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1493             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1494             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1495         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1496             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1497             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1498             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1499                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1500                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1501             20  FILLER                PIC 9(3).                     CL*15
  1502         16  HOLD-CENTURY-1-X.                                       CL*15
  1503             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1504             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1505                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1506                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1507             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1508             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1509         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1510             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1511             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1512             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1513                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1514                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1515             20  FILLER                PIC XXX.                      CL*23
  1516         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1517         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1518         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1519         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1520             20  DC-JULIAN-1-CCYY.                                   CL*15
  1521                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1522                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1523             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1524         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1525         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1526             20  DC-JULIAN-2-CCYY.                                   CL*15
  1527                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1528                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1529             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1530         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1531             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1532             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1533             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1534             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1535             20  DC-EDITA-CCYY.                                      CL*15
  1536                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1537                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1538         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1539             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1540             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1541             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1542             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1543             20  DC-EDITB-CCYY.                                      CL*15
  1544                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1545                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1546         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1547         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1548                              DC-GREG-DATE-CYMD.                  ELCDATE
  1549             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1550             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1551             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1552             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1553         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1554         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1555                              DC-GREG-DATE-MDCY.                  ELCDATE
  1556             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1557             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1558             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1559             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1560    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1561        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1562    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1563    12  FILLER                         PIC X(28).                    CL*26
  1564
  1565 LINKAGE SECTION.
  1566
  1567 01 PARM.
  1568    05  PARM-LENGTH          COMP     PIC S9(04)  VALUE ZEROS.
  1569    05  PARM-CYCLE-DT-CYMD            PIC X(08)   VALUE SPACES.
  1570    05  PARM-RPT-TYPE                 PIC XXX     VALUE SPACES.
  1571
  1572 PROCEDURE DIVISION USING PARM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS057.cbl
  1573                                                                  ECS057
  1574 0000-MAIN.
* 1575                             COPY ELCDTERX.                       ECS057
  1576******************************************************************04/15/98
  1577*                                                                *ELCDTERX
  1578*                                                                *ELCDTERX
  1579*                            ELCDTERX.                           *   LV002
  1580*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1581*                            VMOD=2.007                          *ELCDTERX
  1582*                                                                *ELCDTERX
  1583*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1584*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1585*      = ELCDTEFD)                                               *ELCDTERX
  1586*                                                                *ELCDTERX
  1587******************************************************************ELCDTERX
  1588                                                                  ELCDTERX
  1589     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1590                                                                  ELCDTERX
  1591     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1592     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1593     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1594                                                                  ELCDTERX
  1595     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1596                                                                  ELCDTERX
  1597******************************************************************ELCDTERX
  1598*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1599*          WARNING MESSAGES.                                      ELCDTERX
  1600******************************************************************ELCDTERX
  1601     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1602         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1603                                                                  ELCDTERX
  1604     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1605                                                                  ELCDTERX
  1606     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1607                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1608                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1609                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1610                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1611                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1612                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1613                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1614                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1615                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1616                                                                  ELCDTERX
  1617     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1618                                                                  ELCDTERX
  1619     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1620                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1621                                                                  ELCDTERX
  1622     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1623     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1624     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1625     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1626                                                                  ELCDTERX
  1627     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1628         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1629     ELSE                                                         ELCDTERX
  1630         ADD +1                 TO CLAS-CN.                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1631                                                                  ELCDTERX
  1632     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1633         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1634     ELSE                                                         ELCDTERX
  1635         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1636                                                                  ELCDTERX
  1637 0005-READ--CARD.                                                 ELCDTERX
  1638     READ DISK-DATE                                               ELCDTERX
  1639         AT END CLOSE DISK-DATE                                   ELCDTERX
  1640             GO TO 0060-READ--TEST.                               ELCDTERX
  1641                                                                  ELCDTERX
  1642     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1643                                                                  ELCDTERX
  1644     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1645         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1646         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1647         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1648         GO TO 0005-READ--CARD.                                   ELCDTERX
  1649                                                                  ELCDTERX
  1650     IF DD-ID = 'CLAD'                                            ELCDTERX
  1651         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1652         GO TO 0005-READ--CARD.                                   ELCDTERX
  1653                                                                  ELCDTERX
  1654     IF DD-ID = 'CLAX'                                            ELCDTERX
  1655         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1656         GO TO 0005-READ--CARD.                                   ELCDTERX
  1657                                                                  ELCDTERX
  1658     IF DD-ID = 'CLAF'                                            ELCDTERX
  1659         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1660         GO TO 0005-READ--CARD.                                   ELCDTERX
  1661                                                                  ELCDTERX
  1662     IF DD-ID = 'CLAC'                                            ELCDTERX
  1663         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1664                                                                  ELCDTERX
  1665     IF DD-ID = 'CARR'                                            ELCDTERX
  1666         GO TO 0015-READ--CARR.                                   ELCDTERX
  1667                                                                  ELCDTERX
  1668     IF DD-ID = 'STAT'                                            ELCDTERX
  1669         GO TO 0020-READ--STAT.                                   ELCDTERX
  1670                                                                  ELCDTERX
  1671     IF DD-ID = 'BUSC'                                            ELCDTERX
  1672         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1673                                                                  ELCDTERX
  1674     IF DD-ID = 'MORT'                                            ELCDTERX
  1675         GO TO 0030-READ--MORT.                                   ELCDTERX
  1676                                                                  ELCDTERX
  1677     IF DD-ID = 'CLAI'                                            ELCDTERX
  1678         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1679                                                                  ELCDTERX
  1680     IF DD-ID = 'COLC'                                            ELCDTERX
  1681         GO TO 0065-READ--COLC.                                   ELCDTERX
  1682                                                                  ELCDTERX
  1683     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1684        DD-IDA = 'CL'                                             ELCDTERX
  1685         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1686                                                                  ELCDTERX
  1687     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1688        DD-IDA = 'PO'                                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1689         GO TO 0050-READ--POXX.                                   ELCDTERX
  1690                                                                  ELCDTERX
  1691     IF DD-ID = 'OPCA'                                            ELCDTERX
  1692         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1693                                                                  ELCDTERX
  1694     IF DD-ID = 'OPST'                                            ELCDTERX
  1695         GO TO 0072-READ--OPST.                                   ELCDTERX
  1696                                                                  ELCDTERX
  1697     IF DD-ID = 'OPBS'                                            ELCDTERX
  1698         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1699                                                                  ELCDTERX
  1700     IF DD-ID = 'OPMS'                                            ELCDTERX
  1701         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1702                                                                  ELCDTERX
  1703     GO TO 0005-READ--CARD.                                       ELCDTERX
  1704                                                                  ELCDTERX
  1705 0010-READ--CLAC.                                                 ELCDTERX
  1706     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1707     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1708     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1709     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1710     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1711     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1712     GO TO 0005-READ--CARD.                                       ELCDTERX
  1713                                                                  ELCDTERX
  1714 0015-READ--CARR.                                                 ELCDTERX
  1715     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1716     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1717        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1718        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1719        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1720        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1721        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1722        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1723        MOVE DD-CARR1-SECPAY-SW
  1724                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1725     END-IF
  1726                                                                  ELCDTERX
  1727     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1728     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1729        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1730        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1731        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1732        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1733        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1734        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1735        MOVE DD-CARR2-SECPAY-SW
  1736                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1737     END-IF
  1738                                                                  ELCDTERX
  1739                                                                  ELCDTERX
  1740     GO TO 0005-READ--CARD.                                       ELCDTERX
  1741                                                                  ELCDTERX
  1742 0020-READ--STAT.                                                 ELCDTERX
  1743     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1744     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1745        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1746         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1747                                                                  ELCDTERX
  1748     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1749     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1750     GO TO 0020-READ--STAT.                                       ELCDTERX
  1751                                                                  ELCDTERX
  1752 0025-READ--BUSC.                                                 ELCDTERX
  1753     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1754     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1755        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1756         GO TO 0005-READ--CARD.                                   ELCDTERX
  1757                                                                  ELCDTERX
  1758     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1759     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1760     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1761                                                                  ELCDTERX
  1762 0030-READ--MORT.                                                 ELCDTERX
  1763     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1764     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1765        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1766         GO TO 0005-READ--CARD.                                   ELCDTERX
  1767                                                                  ELCDTERX
  1768     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1769     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1770     GO TO 0030-READ--MORT.                                       ELCDTERX
  1771                                                                  ELCDTERX
  1772 0035-READ--CLXX.                                                 ELCDTERX
  1773     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1774          GO TO 0005-READ--CARD.                                  ELCDTERX
  1775                                                                  ELCDTERX
  1776     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1777         DISPLAY '***********************************************'ELCDTERX
  1778         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1779         DISPLAY '***********************************************'ELCDTERX
  1780         GO TO 0055-READ--STOP.                                   ELCDTERX
  1781                                                                  ELCDTERX
  1782     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1783        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1784         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1785                                                                  ELCDTERX
  1786     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1787        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1788         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1789                                                                  ELCDTERX
  1790*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1791     GO TO 0005-READ--CARD.                                       ELCDTERX
  1792                                                                  ELCDTERX
  1793 0040-READ--CLAI.                                                 ELCDTERX
  1794     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1795     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1796        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1797         GO TO 0005-READ--CARD.                                   ELCDTERX
  1798                                                                  ELCDTERX
  1799     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1800     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1801     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1802                                                                  ELCDTERX
  1803 0045-READ--DUMP.                                                 ELCDTERX
  1804     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1805     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1806                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1807     PERFORM ABEND-PGM.                                           ELCDTERX
  1808                                                                  ELCDTERX
  1809 0050-READ--POXX.                                                 ELCDTERX
  1810     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1811         GO TO 0005-READ--CARD.                                   ELCDTERX
  1812                                                                  ELCDTERX
  1813     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1814         DISPLAY '***********************************************'ELCDTERX
  1815         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1816         DISPLAY '***********************************************'ELCDTERX
  1817         GO TO 0055-READ--STOP.                                   ELCDTERX
  1818                                                                  ELCDTERX
  1819     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1820     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1821     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1822     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1823                                                                  ELCDTERX
  1824     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1825         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1826     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1827         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1828                                                                  ELCDTERX
  1829     GO TO 0005-READ--CARD.                                       ELCDTERX
  1830                                                                  ELCDTERX
  1831 0055-READ--STOP.                                                 ELCDTERX
  1832     GOBACK.                                                      ELCDTERX
  1833                                                                  ELCDTERX
  1834 0060-READ--TEST.                                                 ELCDTERX
  1835     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1836        CLAX-ID         = SPACE  OR                               ELCDTERX
  1837        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1838         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1839                                                                  ELCDTERX
  1840     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1841     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1842                                                                  ELCDTERX
  1843 0065-READ--COLC.                                                 ELCDTERX
  1844     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1845     GO TO 0005-READ--CARD.                                       ELCDTERX
  1846                                                                  ELCDTERX
  1847 0070-READ--OPCA.                                                 ELCDTERX
  1848                                                                  ELCDTERX
  1849     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1850                                                                  ELCDTERX
  1851     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1852             OR                                                   ELCDTERX
  1853         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1854         GO TO 0005-READ--CARD.                                   ELCDTERX
  1855                                                                  ELCDTERX
  1856     ADD 1                       TO INDEXCA.                      ELCDTERX
  1857     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1858                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1859     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1860                                                                  ELCDTERX
  1861 0072-READ--OPST.                                                 ELCDTERX
  1862                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS057.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1863     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1864                                                                  ELCDTERX
  1865     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1866             OR                                                   ELCDTERX
  1867         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1868         GO TO 0005-READ--CARD.                                   ELCDTERX
  1869                                                                  ELCDTERX
  1870     ADD 1                       TO INDEXST.                      ELCDTERX
  1871     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1872                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1873     GO TO 0072-READ--OPST.                                       ELCDTERX
  1874                                                                  ELCDTERX
  1875 0074-READ--OPBS.                                                 ELCDTERX
  1876                                                                  ELCDTERX
  1877     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1878                                                                  ELCDTERX
  1879     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1880             OR                                                   ELCDTERX
  1881         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1882         GO TO 0005-READ--CARD.                                   ELCDTERX
  1883                                                                  ELCDTERX
  1884     ADD 1                       TO INDEXBS.                      ELCDTERX
  1885     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1886     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1887                                                                  ELCDTERX
  1888 0079-READ--EXIT.                                                 ELCDTERX
  1889*    EXIT.                                                        ELCDTERX
  1890******************************************************************ELCDTERX
  1891                                                                  ECS057
  1892     PERFORM 0050-EDIT-ME-CYCLE-DT    THRU 0050-EXIT
  1893     MOVE COMPANY-NAME                TO WS-H2-COMPANY-NAME
  1894     MOVE WS-CURRENT-DATE             TO WS-H2-DATE
  1895     MOVE SPACES                      TO WS-H5-EFFECTIVE-MONTHS
  1896
  1897     SUBTRACT +1                      FROM RUN-CCYY
  1898         GIVING WS-HDR-EFF-CCYY
  1899
  1900     COMPUTE MONTH-SUB = RUN-MO + +1
  1901     IF MONTH-SUB > +12
  1902         MOVE +1                      TO MONTH-SUB
  1903         MOVE RUN-CCYY                TO WS-HDR-EFF-CCYY
  1904     END-IF
  1905
  1906     MOVE MONTH-SUB                   TO SAVE-1ST-EFF-MONTH
  1907     MOVE WS-HDR-EFF-CCYY             TO WS-EARLIEST-PROC-DT-CCYY
  1908     MOVE NUMERIC-MONTH (MONTH-SUB)   TO WS-EARLIEST-PROC-DT-MM
  1909     MOVE '01'                        TO WS-EARLIEST-PROC-DT-DD
  1910
  1911     MOVE +1                          TO COLUMN-SUB
  1912     PERFORM 0100-EFF-MO-HDR          THRU 0100-EXIT
  1913         UNTIL COLUMN-SUB > +12
  1914
  1915     SORT SORTFL
  1916             ON ASCENDING KEY SRT-STATE
  1917                              SRT-ACCOUNT
  1918                              SRT-ENTRY-DT
  1919                              SRT-BATCH-NO
  1920                              SRT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS057.cbl
  1921         INPUT PROCEDURE 0010-INPUT-RTN  THRU 0019-EXIT
  1922        OUTPUT PROCEDURE 0020-OUTPUT-RTN THRU 0029-EXIT.
  1923
  1924     IF SORT-RETURN NOT = ZEROES
  1925         MOVE +0101                     TO  WS-RETURN-CODE
  1926         MOVE 'INTERNAL SORT ABORTED'   TO  WS-ABEND-MESSAGE
  1927         GO TO ABEND-PGM
  1928     END-IF
  1929
  1930     GOBACK
  1931
  1932     .
  1933 0010-INPUT-RTN SECTION.
  1934
  1935     PERFORM 8800-OPEN-FILES             THRU 8800-EXIT
  1936     PERFORM 0200-READ-SORTED-OFFLN-CERT THRU 0200-EXIT
  1937         UNTIL EOF
  1938     .
  1939 0019-EXIT.
  1940     EXIT.
  1941
  1942 0020-OUTPUT-RTN SECTION.
  1943
  1944
  1945     MOVE SPACES                 TO WS-EOF-OFFLN-CERT
  1946
  1947     PERFORM 0300-RETURN         THRU 0300-EXIT
  1948         UNTIL EOF
  1949
  1950********
  1951***** Need to print totals for last month of last account
  1952********
  1953     MOVE WS-CR-ENTRY-CYMD              TO WS-HOLD-ENTRY-CYMD
  1954     PERFORM 0225-WRITE-PREV-ACCUM-DATA THRU 0225-EXIT
  1955
  1956     IF SUBTOT-REQUIRED-FOR-PROCMO
  1957         PERFORM 0350-SUBTOTAL          THRU 0350-EXIT
  1958         SET SUBTOT-NOT-NEEDED          TO TRUE
  1959     END-IF
  1960
  1961     PERFORM 0240-TOTAL-FOR-PROCMO      THRU 0240-EXIT
  1962     PERFORM 0360-12MO-TOTAL-FOR-ACCT   THRU 0360-EXIT
  1963
  1964     PERFORM 0380-ALLACCT-SUMMARY       THRU 0380-EXIT
  1965     PERFORM 8900-CLOSE-FILES           THRU 8900-EXIT
  1966
  1967     .
  1968 0029-EXIT.
  1969     EXIT.
  1970
  1971                                                                  ECS057
  1972 0050-EDIT-ME-CYCLE-DT.
  1973
  1974   IF PARM-LENGTH = +0
  1975       DISPLAY 'CYCLE DATE INPUT PARM MISSING'
  1976       PERFORM ABEND-PGM            THRU APS-EXIT
  1977   END-IF
  1978
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS057.cbl
  1979   MOVE PARM-CYCLE-DT-CYMD          TO DC-GREG-DATE-CYMD
  1980   MOVE 'L'                         TO DC-OPTION-CODE
  1981   PERFORM 8500-DATE-CONVERSION     THRU 8500-EXIT
  1982
  1983   IF NO-CONVERSION-ERROR
  1984       MOVE DC-GREG-DATE-1-ALPHA    TO WS-H3-MONTHEND-DT
  1985   ELSE
  1986       DISPLAY 'INVALID ME CYCLE DATE ' PARM-CYCLE-DT-CYMD
  1987       PERFORM ABEND-PGM            THRU APS-EXIT
  1988   END-IF
  1989
  1990   IF PARM-RPT-TYPE = 'CLP'
  1991      MOVE ' BY CLP STATE '      TO WS-H1-CLP-TITLE
  1992      MOVE 'CLP'                 TO WS-H1-CLP-ID
  1993   END-IF
  1994
  1995   .
  1996 0050-EXIT.
  1997     EXIT.
  1998
  1999 0100-EFF-MO-HDR.
  2000
  2001     MOVE ALPHA-MONTH (MONTH-SUB)   TO WS-H5-EFF-MO (COLUMN-SUB)
  2002     MOVE WS-HDR-EFF-YY             TO WS-H5-EFF-YY (COLUMN-SUB)
  2003                                                                  ECS057
  2004     ADD +1                         TO MONTH-SUB
  2005                                                                  ECS057
  2006     IF MONTH-SUB > +12
  2007         MOVE +1                    TO MONTH-SUB
  2008         MOVE RUN-CCYY              TO WS-HDR-EFF-CCYY
  2009     END-IF
  2010                                                                  ECS057
  2011     ADD +1                         TO COLUMN-SUB
  2012                                                                  ECS057
  2013     .
  2014
  2015 0100-EXIT.
  2016     EXIT.
  2017 0200-READ-SORTED-OFFLN-CERT.
  2018
  2019     READ OFFLN-CERT-IN
  2020         AT END
  2021             SET EOF                        TO TRUE
  2022             GO TO 0200-EXIT
  2023     END-READ
  2024
  2025     MOVE CR-ENTRY-DATE                     TO WS-CR-ENTRY-DATE
  2026     MOVE CR-LF-CANCEL-EXIT-DATE            TO WS-LF-EXIT-DATE
  2027     MOVE CR-AH-CANCEL-EXIT-DATE            TO WS-AH-EXIT-DATE
  2028
  2029********
  2030** Report goes back 12 months from current processing month
  2031********
  2032     IF (WS-CR-ENTRY-CYMD >= WS-EARLIEST-PROCESS-DT)
  2033        OR (WS-LF-EXIT-CYMD >= WS-EARLIEST-PROCESS-DT)
  2034        OR (WS-AH-EXIT-CYMD >= WS-EARLIEST-PROCESS-DT)
  2035        CONTINUE
  2036     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS057.cbl
  2037         GO TO 0200-EXIT
  2038     END-IF
  2039
  2040     if (cr-policy-is-cash)
  2041        or (CR-LFTYP = 'MJ' OR 'MS'
  2042         OR 'NJ' OR 'NL'
  2043         OR 'SJ' OR 'SL'
  2044         OR 'HJ' OR 'HL'
  2045         OR 'PL' OR 'PJ')
  2046        OR (CR-AHTYP =
  2047               'MJ' OR 'MS' OR 'MI' OR 'MU'
  2048            OR 'MX' OR 'MY' OR 'MZ'
  2049            OR 'NI' OR 'NJ' OR 'NL' OR 'NU'
  2050            OR 'SI' OR 'SJ' OR 'SL' OR 'SU'
  2051            OR 'HD' OR 'HE' OR 'HF' OR 'HG'
  2052            OR 'HJ' OR 'HL'
  2053            OR 'PL' OR 'PJ' OR 'PI' OR 'PU')
  2054        CONTINUE
  2055     ELSE
  2056        GO TO 0200-EXIT
  2057     END-IF
  2058
  2059     if cr-carrier = '7'
  2060        move +0                  to ws-fees-outside-clp
  2061                                    ws-lf-canc-fees-outside-clp
  2062                                    ws-ah-canc-fees-outside-clp
  2063        perform varying a1 from +1 by +1 until a1 > +10
  2064           if cr-agt-type (A1) = 'C' OR 'D' OR 'S' OR 'O'
  2065              compute ws-fees-outside-clp rounded =
  2066                 ws-fees-outside-clp +
  2067                 cr-lfprm * cr-lcom-l (a1) +
  2068                 cr-ahprm * cr-lcom-ah (a1)
  2069              compute ws-lf-canc-fees-outside-clp rounded =
  2070                 ws-lf-canc-fees-outside-clp +
  2071                 cr-lfrfnd * cr-lcom-l (a1)
  2072              compute ws-ah-canc-fees-outside-clp rounded =
  2073                 ws-ah-canc-fees-outside-clp +
  2074                 cr-ahrfnd * cr-lcom-ah (a1)
  2075           end-if
  2076        end-perform
  2077     end-if
  2078
  2079     IF WS-CR-ENTRY-CYMD >= WS-EARLIEST-PROCESS-DT
  2080        MOVE CR-STATE            TO SRT-STATE
  2081        MOVE CR-ACCOUNT          TO SRT-ACCOUNT
  2082        if cr-carrier = 7
  2083           compute srt-amount =
  2084              cr-lfprm + cr-ahprm - ws-fees-outside-clp
  2085        else
  2086           COMPUTE SRT-AMOUNT = (CR-LFPRM + CR-AHPRM) -
  2087                                 ((CR-LFPRM * CR-LCOM-L (1)) +
  2088                                 (CR-AHPRM * CR-LCOM-AH (1)))
  2089        end-if
  2090        MOVE CR-DT               TO SRT-EFF-DT
  2091        MOVE CR-ENTRY-DATE       TO SRT-ENTRY-DT
  2092        MOVE CR-ENTRY-BATCH      TO SRT-BATCH-NO
  2093        RELEASE SRT-REC
  2094     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS057.cbl
  2095
  2096     IF WS-LF-EXIT-CYMD >= WS-EARLIEST-PROCESS-DT
  2097        MOVE CR-STATE            TO SRT-STATE
  2098        MOVE CR-ACCOUNT          TO SRT-ACCOUNT
  2099        if cr-carrier = 7
  2100           compute srt-amount = (cr-lfrfnd -
  2101              ws-lf-canc-fees-outside-clp) * -1
  2102        else
  2103           COMPUTE SRT-AMOUNT = (CR-LFRFND
  2104           - (CR-LFRFND * CR-LCOM-L (1))) * -1
  2105        end-if
  2106        MOVE CR-LF-CANC-DT       TO SRT-EFF-DT
  2107        MOVE CR-LF-CANCEL-EXIT-DATE
  2108                                 TO SRT-ENTRY-DT
  2109        MOVE CR-LF-EXIT-BATCH    TO SRT-BATCH-NO
  2110        RELEASE SRT-REC
  2111     END-IF
  2112
  2113     IF WS-AH-EXIT-CYMD >= WS-EARLIEST-PROCESS-DT
  2114        MOVE CR-STATE            TO SRT-STATE
  2115        MOVE CR-ACCOUNT          TO SRT-ACCOUNT
  2116        if cr-carrier = 7
  2117           compute srt-amount = (cr-ahrfnd -
  2118              ws-ah-canc-fees-outside-clp) * -1
  2119        else
  2120           COMPUTE SRT-AMOUNT = (CR-AHRFND
  2121              - (CR-AHRFND * CR-LCOM-AH (1))) * -1
  2122        end-if
  2123        MOVE CR-AH-CANC-DT       TO SRT-EFF-DT
  2124        MOVE CR-AH-CANCEL-EXIT-DATE
  2125                                 TO SRT-ENTRY-DT
  2126        MOVE CR-AH-EXIT-BATCH    TO SRT-BATCH-NO
  2127        RELEASE SRT-REC
  2128     END-IF
  2129
  2130     .
  2131 0200-EXIT.
  2132     EXIT.
  2133
  2134 0300-RETURN.
  2135
  2136     RETURN SORTFL
  2137         AT END
  2138             SET EOF                        TO TRUE
  2139             GO TO 0300-EXIT
  2140     END-RETURN
  2141
  2142     MOVE SRT-ENTRY-DT                    TO WS-CR-ENTRY-DATE
  2143
  2144********
  2145** Report goes back 12 months from current processing month
  2146********
  2147
  2148     IF SRT-ACCOUNT = WS-HOLD-ACCT
  2149        AND WS-CR-ENTRY-CYMD = WS-HOLD-ENTRY-CYMD
  2150        AND SRT-BATCH-NO = WS-HOLD-ENTRY-BATCH
  2151         CONTINUE
  2152     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS057.cbl
  2153         IF NOT-FIRST-TIME
  2154             PERFORM 0225-WRITE-PREV-ACCUM-DATA
  2155                                            THRU 0225-EXIT
  2156         ELSE
  2157             MOVE +1                        TO SUB
  2158             SET NOT-FIRST-TIME             TO TRUE
  2159             MOVE SRT-ACCOUNT               TO WS-H-ACCOUNT
  2160             MOVE SRT-STATE                 TO WS-H-STATE
  2161         END-IF
  2162
  2163         MOVE SRT-ACCOUNT                   TO WS-HOLD-ACCT
  2164         MOVE SRT-STATE                     TO WS-HOLD-STATE
  2165         MOVE WS-CR-ENTRY-CYMD              TO WS-HOLD-ENTRY-CYMD
  2166         MOVE SRT-BATCH-NO                  TO WS-HOLD-ENTRY-BATCH
  2167     END-IF
  2168
  2169     MOVE SRT-AMOUNT             TO WS-PREMIUM-PAYMENT
  2170     MOVE SRT-EFF-DT             TO WS-CERT-EFF-DT
  2171     MOVE WS-HOLD-ENTRY-MM       TO SUB1
  2172
  2173     PERFORM 0250-ACCUM-PAYMENTS
  2174                                 THRU 0250-EXIT
  2175
  2176
  2177     .
  2178 0300-EXIT.
  2179     EXIT.
  2180
  2181 0225-WRITE-PREV-ACCUM-DATA.
  2182
  2183**** Entry dates correspond to process dates on the report
  2184**** The input file is presorted in the job step prior to executing
  2185**** this program.  The sort order is account number, entry date,
  2186**** batch#, & eff date.
  2187
  2188***** IF there are multiple batches in the same month for the
  2189***** same account, don't bump to next process month.
  2190*    IF WS-HOLD-ENTRY-MM = WS-HOLD-PREV-MM
  2191*       AND WS-HOLD-ACCT = WS-HOLD-PREV-ACCT
  2192*        SUBTRACT +1                        FROM SUB
  2193*        SET SUBTOT-REQUIRED-FOR-PROCMO     TO TRUE
  2194*    END-IF
  2195
  2196     MOVE WS-HOLD-ENTRY-MM                  TO SUB2
  2197     PERFORM 0340-DETAIL-LINES              THRU 0340-EXIT
  2198         VARYING SUB FROM SUB BY +1
  2199         UNTIL DETAIL-LN-WITH-PREMIUM-DONE
  2200               OR SUB > +12
  2201     SUBTRACT +1                            FROM SUB
  2202
  2203     PERFORM 0370-CLEAR-PAYMENT-TABLE       THRU 0370-EXIT
  2204         VARYING COLUMN-SUB FROM +1 BY +1
  2205         UNTIL COLUMN-SUB > +12
  2206
  2207     SET DETAIL-LN-NOT-DONE                 TO TRUE
  2208
  2209     IF SUBTOT-REQUIRED-FOR-PROCMO
  2210        AND (WS-CR-ENTRY-MM NOT = WS-HOLD-ENTRY-MM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS057.cbl
  2211            OR SRT-ACCOUNT NOT = WS-HOLD-ACCT)
  2212         PERFORM 0350-SUBTOTAL              THRU 0350-EXIT
  2213         SET SUBTOT-NOT-NEEDED              TO TRUE
  2214         PERFORM 0240-TOTAL-FOR-PROCMO      THRU 0240-EXIT
  2215         SET TOTAL-FOR-MONTH-DONE           TO TRUE
  2216     END-IF
  2217
  2218     IF WS-TOT-PAYMENTS-PROCMO NOT = +0
  2219        AND NOT TOTAL-FOR-MONTH-DONE
  2220         IF WS-CR-ENTRY-MM NOT = WS-HOLD-ENTRY-MM
  2221            OR SRT-ACCOUNT NOT = WS-HOLD-ACCT
  2222             PERFORM 0240-TOTAL-FOR-PROCMO  THRU 0240-EXIT
  2223         END-IF
  2224     END-IF
  2225
  2226     IF TOTAL-FOR-MONTH-DONE
  2227         SET NEW-MONTH-TOTAL                TO TRUE
  2228     END-IF
  2229
  2230     MOVE WS-HOLD-ENTRY-MM                  TO WS-HOLD-PREV-MM
  2231     MOVE WS-HOLD-ACCT                      TO WS-HOLD-PREV-ACCT
  2232
  2233     IF SRT-ACCOUNT = WS-HOLD-ACCT
  2234         CONTINUE
  2235     ELSE
  2236         PERFORM 0360-12MO-TOTAL-FOR-ACCT   THRU 0360-EXIT
  2237         MOVE +1                            TO SUB
  2238         MOVE SRT-ACCOUNT                   TO WS-H-ACCOUNT
  2239         MOVE SRT-STATE                     TO WS-H-STATE
  2240         MOVE +56                           TO WS-LINE-COUNT
  2241     END-IF
  2242
  2243     .
  2244 0225-EXIT.
  2245     EXIT.
  2246
  2247
  2248 0240-TOTAL-FOR-PROCMO.
  2249
  2250     MOVE SPACES                         TO WS-DETAIL
  2251     MOVE WS-HOLD-ALPHA-MO               TO WS-D1-PROCESS-MO
  2252     MOVE WS-HOLD-ENTRY-YY               TO WS-D1-PROCESS-YY
  2253     MOVE 'SUBTOT'                       TO WS-D1-BATCH-NO
  2254     MOVE WS-TOT-PAYMENTS-PROCMO         TO WS-D1-PAYMENT (1)
  2255     PERFORM 0400-PRINT-DETAIL           THRU 0400-EXIT
  2256     MOVE ZEROS                          TO WS-TOT-PAYMENTS-PROCMO
  2257     ADD +1                              TO SUB
  2258
  2259     MOVE SPACES                         TO WS-DETAIL
  2260     PERFORM 0400-PRINT-DETAIL           THRU 0400-EXIT
  2261
  2262     .
  2263 0240-EXIT.
  2264     EXIT.
  2265
  2266
  2267 0250-ACCUM-PAYMENTS.
  2268
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS057.cbl
  2269     EVALUATE TRUE
  2270     WHEN WS-CERT-EFF-MM = 01
  2271         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (1)
  2272         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (1)
  2273         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (1)
  2274         ADD WS-PREMIUM-PAYMENT
  2275                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 1)
  2276         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (1)
  2277
  2278     WHEN WS-CERT-EFF-MM = 02
  2279         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (2)
  2280         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (2)
  2281         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (2)
  2282         ADD WS-PREMIUM-PAYMENT
  2283                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 2)
  2284         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (2)
  2285
  2286     WHEN WS-CERT-EFF-MM = 03
  2287         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (3)
  2288         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (3)
  2289         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (3)
  2290         ADD WS-PREMIUM-PAYMENT
  2291                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 3)
  2292         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (3)
  2293
  2294     WHEN WS-CERT-EFF-MM = 04
  2295         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (4)
  2296         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (4)
  2297         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (4)
  2298         ADD WS-PREMIUM-PAYMENT
  2299                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 4)
  2300         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (4)
  2301
  2302     WHEN WS-CERT-EFF-MM = 05
  2303         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (5)
  2304         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (5)
  2305         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (5)
  2306         ADD WS-PREMIUM-PAYMENT
  2307                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 5)
  2308         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (5)
  2309
  2310     WHEN WS-CERT-EFF-MM = 06
  2311         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (6)
  2312         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (6)
  2313         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (6)
  2314         ADD WS-PREMIUM-PAYMENT
  2315                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 6)
  2316         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (6)
  2317
  2318     WHEN WS-CERT-EFF-MM = 07
  2319         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (7)
  2320         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (7)
  2321         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (7)
  2322         ADD WS-PREMIUM-PAYMENT
  2323                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 7)
  2324         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (7)
  2325
  2326     WHEN WS-CERT-EFF-MM = 08
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS057.cbl
  2327         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (8)
  2328         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (8)
  2329         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (8)
  2330         ADD WS-PREMIUM-PAYMENT
  2331                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 8)
  2332         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (8)
  2333
  2334     WHEN WS-CERT-EFF-MM = 09
  2335         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (9)
  2336         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (9)
  2337         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (9)
  2338         ADD WS-PREMIUM-PAYMENT
  2339                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 9)
  2340         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (9)
  2341
  2342     WHEN WS-CERT-EFF-MM = 10
  2343         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (10)
  2344         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (10)
  2345         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (10)
  2346         ADD WS-PREMIUM-PAYMENT
  2347                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 10)
  2348         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (10)
  2349
  2350     WHEN WS-CERT-EFF-MM = 11
  2351         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (11)
  2352         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (11)
  2353         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (11)
  2354         ADD WS-PREMIUM-PAYMENT
  2355                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 11)
  2356         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (11)
  2357
  2358     WHEN WS-CERT-EFF-MM = 12
  2359         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYBATCH (12)
  2360         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-BYPROCMO (12)
  2361         ADD WS-PREMIUM-PAYMENT TO WS-PAYMENT-12MOTOTS-BYACCT (12)
  2362         ADD WS-PREMIUM-PAYMENT
  2363                           TO WS-ALLACCT-BYPROCMO-EFFMO (SUB1 12)
  2364         ADD WS-PREMIUM-PAYMENT TO WS-ALLACCT-12MOTOTS (12)
  2365     END-EVALUATE
  2366
  2367     ADD WS-PREMIUM-PAYMENT     TO WS-TOT-PAYMENTS-PROCMO
  2368
  2369     .
  2370 0250-EXIT.
  2371     EXIT.
  2372
  2373
  2374 0340-DETAIL-LINES.
  2375
  2376     IF WS-H5-EFF-MO (SUB) = ALPHA-MONTH (SUB2)
  2377        AND WS-H5-EFF-YY (SUB) = WS-HOLD-ENTRY-YY
  2378         SET DETAIL-LN-WITH-PREMIUM-DONE   TO TRUE
  2379         MOVE ALPHA-MONTH (SUB2)           TO WS-HOLD-ALPHA-MO
  2380         MOVE WS-HOLD-ENTRY-BATCH          TO WS-D1-BATCH-NO
  2381         MOVE SAVE-1ST-EFF-MONTH           TO SUB3
  2382         MOVE +1                           TO COLUMN-SUB
  2383         PERFORM 0345-MOVE-PAYMENTS-TO-RPT THRU 0345-EXIT
  2384             VARYING SUB3 FROM SUB3 BY +1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS057.cbl
  2385             UNTIL SUB3 > +12
  2386         IF SAVE-1ST-EFF-MONTH > +1
  2387             PERFORM 0345-MOVE-PAYMENTS-TO-RPT
  2388                                           THRU 0345-EXIT
  2389                 VARYING SUB3 FROM +1 BY +1
  2390                 UNTIL SUB3 = SAVE-1ST-EFF-MONTH
  2391         END-IF
  2392     ELSE
  2393         MOVE SPACES                       TO WS-D1-BATCH-NO
  2394         PERFORM 0347-ZERO-PAYMENTS        THRU 0347-EXIT
  2395             VARYING COLUMN-SUB FROM +1 BY +1
  2396             UNTIL COLUMN-SUB > +12
  2397     END-IF
  2398
  2399     MOVE WS-H5-EFF-MO (SUB)              TO WS-D1-PROCESS-MO
  2400     MOVE WS-H5-EFF-YY (SUB)              TO WS-D1-PROCESS-YY
  2401     PERFORM 0400-PRINT-DETAIL            THRU 0400-EXIT
  2402
  2403     .
  2404 0340-EXIT.
  2405     EXIT.
  2406
  2407
  2408 0345-MOVE-PAYMENTS-TO-RPT.
  2409
  2410     MOVE WS-PAYMENT-BYBATCH (SUB3) TO WS-D1-PAYMENT (COLUMN-SUB)
  2411     ADD +1                         TO COLUMN-SUB
  2412
  2413     .
  2414 0345-EXIT.
  2415     EXIT.
  2416
  2417 0347-ZERO-PAYMENTS.
  2418
  2419     MOVE ZEROS                     TO WS-D1-PAYMENT (COLUMN-SUB)
  2420
  2421     .
  2422 0347-EXIT.
  2423     EXIT.
  2424
  2425 0350-SUBTOTAL.
  2426
  2427     MOVE SPACES                          TO WS-DETAIL
  2428     MOVE WS-H5-EFF-MO (SUB)              TO WS-D1-PROCESS-MO
  2429     MOVE WS-H5-EFF-YY (SUB)              TO WS-D1-PROCESS-YY
  2430     MOVE 'TOTALS'                        TO WS-D1-BATCH-NO
  2431     PERFORM 0400-PRINT-DETAIL            THRU 0400-EXIT
  2432     MOVE SPACES                          TO WS-DETAIL
  2433     MOVE 'BY'                            TO WS-D1-PROCESS-YY
  2434     MOVE 'EFF MO'                        TO WS-D1-BATCH-NO
  2435
  2436     MOVE SAVE-1ST-EFF-MONTH              TO SUB3
  2437     MOVE +1                              TO COLUMN-SUB
  2438     PERFORM 0355-MOVE-PROCMO-TOTS-TO-RPT THRU 0355-EXIT
  2439         VARYING SUB3 FROM SUB3 BY +1
  2440         UNTIL SUB3 > +12
  2441     IF SAVE-1ST-EFF-MONTH > +1
  2442         PERFORM 0355-MOVE-PROCMO-TOTS-TO-RPT THRU 0355-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS057.cbl
  2443             VARYING SUB3 FROM +1 BY +1
  2444             UNTIL SUB3 = SAVE-1ST-EFF-MONTH
  2445     END-IF
  2446
  2447     PERFORM 0400-PRINT-DETAIL            THRU 0400-EXIT
  2448
  2449     MOVE SPACES                          TO WS-DETAIL
  2450     MOVE 'SUBTOT'                        TO WS-D1-BATCH-NO
  2451     MOVE WS-TOT-PAYMENTS-PROCMO          TO WS-D1-PAYMENT (1)
  2452     PERFORM 0400-PRINT-DETAIL            THRU 0400-EXIT
  2453
  2454     PERFORM 0373-CLEAR-SUBTOTALS         THRU 0373-EXIT
  2455         VARYING COLUMN-SUB FROM +1 BY +1
  2456         UNTIL COLUMN-SUB > +12
  2457
  2458     .
  2459 0350-EXIT.
  2460     EXIT.
  2461
  2462 0355-MOVE-PROCMO-TOTS-TO-RPT.
  2463
  2464     MOVE WS-PAYMENT-BYPROCMO (SUB3)
  2465                                    TO WS-D1-PAYMENT (COLUMN-SUB)
  2466     ADD +1                         TO COLUMN-SUB
  2467
  2468     .
  2469 0355-EXIT.
  2470     EXIT.
  2471
  2472
  2473 0360-12MO-TOTAL-FOR-ACCT.
  2474
  2475     MOVE SPACES                        TO WS-DETAIL
  2476     MOVE '-'                           TO WS-D1-PRINT-CTL
  2477     MOVE '12M'                         TO WS-D1-PROCESS-MO
  2478     MOVE 'O '                          TO WS-D1-PROCESS-YY
  2479     MOVE 'TOTALS'                      TO WS-D1-BATCH-NO
  2480     PERFORM 0400-PRINT-DETAIL          THRU 0400-EXIT
  2481
  2482     MOVE SPACE                         TO WS-D1-PRINT-CTL
  2483     MOVE 'BY'                          TO WS-D1-PROCESS-YY
  2484     MOVE 'EFF MO'                      TO WS-D1-BATCH-NO
  2485     MOVE SAVE-1ST-EFF-MONTH            TO SUB3
  2486     MOVE +1                            TO COLUMN-SUB
  2487     PERFORM 0365-MOVE-12MO-TOTS        THRU 0365-EXIT
  2488         VARYING SUB3 FROM SUB3 BY +1
  2489         UNTIL SUB3 > +12
  2490
  2491     IF SAVE-1ST-EFF-MONTH > +1
  2492         PERFORM 0365-MOVE-12MO-TOTS    THRU 0365-EXIT
  2493             VARYING SUB3 FROM +1 BY +1
  2494             UNTIL SUB3 = SAVE-1ST-EFF-MONTH
  2495     END-IF
  2496
  2497     PERFORM 0400-PRINT-DETAIL          THRU 0400-EXIT
  2498
  2499     MOVE SPACES                        TO WS-DETAIL
  2500     MOVE '0'                           TO WS-D1-PRINT-CTL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS057.cbl
  2501     MOVE 'ACC'                         TO WS-D1-PROCESS-MO
  2502     MOVE 'T '                          TO WS-D1-PROCESS-YY
  2503     MOVE 'TOTALS'                      TO WS-D1-BATCH-NO
  2504     PERFORM 0400-PRINT-DETAIL          THRU 0400-EXIT
  2505
  2506     MOVE SPACES                        TO WS-DETAIL
  2507     MOVE 'LAS'                         TO WS-D1-PROCESS-MO
  2508     MOVE 'T '                          TO WS-D1-PROCESS-YY
  2509     MOVE '12 MOS'                      TO WS-D1-BATCH-NO
  2510     MOVE WS-12MO-ACCT-TOTAL            TO WS-D1-PAYMENT (1)
  2511     PERFORM 0400-PRINT-DETAIL          THRU 0400-EXIT
  2512
  2513     PERFORM 0375-CLEAR-12MO-TOTALS     THRU 0375-EXIT
  2514         VARYING COLUMN-SUB FROM +1 BY +1
  2515         UNTIL COLUMN-SUB > +12
  2516
  2517     MOVE ZEROS                         TO WS-12MO-ACCT-TOTAL
  2518
  2519
  2520     .
  2521 0360-EXIT.
  2522     EXIT.
  2523
  2524 0365-MOVE-12MO-TOTS.
  2525
  2526     MOVE WS-PAYMENT-12MOTOTS-BYACCT (SUB3)
  2527                                    TO WS-D1-PAYMENT (COLUMN-SUB)
  2528     ADD +1                         TO COLUMN-SUB
  2529     ADD WS-PAYMENT-12MOTOTS-BYACCT (SUB3)  TO WS-12MO-ACCT-TOTAL
  2530
  2531     .
  2532 0365-EXIT.
  2533     EXIT.
  2534
  2535
  2536 0370-CLEAR-PAYMENT-TABLE.
  2537
  2538     MOVE ZEROS                TO WS-PAYMENT-BYBATCH (COLUMN-SUB)
  2539
  2540     .
  2541 0370-EXIT.
  2542     EXIT.
  2543
  2544 0373-CLEAR-SUBTOTALS.
  2545
  2546     MOVE ZEROS                TO WS-PAYMENT-BYPROCMO (COLUMN-SUB)
  2547
  2548     .
  2549 0373-EXIT.
  2550     EXIT.
  2551
  2552 0375-CLEAR-12MO-TOTALS.
  2553
  2554     MOVE ZEROS        TO WS-PAYMENT-12MOTOTS-BYACCT (COLUMN-SUB)
  2555
  2556     .
  2557 0375-EXIT.
  2558     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS057.cbl
  2559
  2560
  2561 0380-ALLACCT-SUMMARY.
  2562
  2563     MOVE 'ALL ACCTS'                      TO WS-H-ACCOUNT
  2564     MOVE SPACES                           TO WS-H-LITERAL
  2565     MOVE SPACES                           TO WS-H-STATE
  2566     MOVE +56                              TO WS-LINE-COUNT
  2567     MOVE 'DATE           '                TO WS-H7-VARIABLE-HDR
  2568
  2569     MOVE SAVE-1ST-EFF-MONTH               TO PROCMO
  2570     MOVE +1                               TO MOHDR
  2571     PERFORM 0382-ALLACCT-PROCMO-TOTS      THRU 0382-EXIT
  2572         VARYING PROCMO FROM PROCMO BY +1
  2573             UNTIL PROCMO > +12
  2574     IF SAVE-1ST-EFF-MONTH > +1
  2575         PERFORM 0382-ALLACCT-PROCMO-TOTS  THRU 0382-EXIT
  2576             VARYING PROCMO FROM +1 BY +1
  2577                 UNTIL PROCMO = SAVE-1ST-EFF-MONTH
  2578     END-IF
  2579
  2580     MOVE SPACES                           TO WS-DETAIL
  2581     MOVE '0'                              TO WS-D1-PRINT-CTL
  2582     MOVE '12M'                            TO WS-D1-PROCESS-MO
  2583     MOVE 'O '                             TO WS-D1-PROCESS-YY
  2584     MOVE 'TOTALS'                         TO WS-D1-BATCH-NO
  2585     PERFORM 0400-PRINT-DETAIL             THRU 0400-EXIT
  2586
  2587     MOVE SPACE                            TO WS-D1-PRINT-CTL
  2588     MOVE 'BY'                             TO WS-D1-PROCESS-YY
  2589     MOVE 'EFF MO'                         TO WS-D1-BATCH-NO
  2590     MOVE SAVE-1ST-EFF-MONTH               TO SUB3
  2591     MOVE +1                               TO COLUMN-SUB
  2592     PERFORM 0385-MOVE-ALLACCTS-12MO-TOTS  THRU 0385-EXIT
  2593         VARYING SUB3 FROM SUB3 BY +1
  2594         UNTIL SUB3 > +12
  2595
  2596     IF SAVE-1ST-EFF-MONTH > +1
  2597         PERFORM 0385-MOVE-ALLACCTS-12MO-TOTS THRU 0385-EXIT
  2598             VARYING SUB3 FROM +1 BY +1
  2599             UNTIL SUB3 = SAVE-1ST-EFF-MONTH
  2600     END-IF
  2601
  2602     PERFORM 0400-PRINT-DETAIL             THRU 0400-EXIT
  2603
  2604     MOVE SPACES                           TO WS-DETAIL
  2605     MOVE '0'                              TO WS-D1-PRINT-CTL
  2606     MOVE 'GRA'                            TO WS-D1-PROCESS-MO
  2607     MOVE 'ND'                             TO WS-D1-PROCESS-YY
  2608     MOVE ' TOTAL'                         TO WS-D1-BATCH-NO
  2609     PERFORM 0400-PRINT-DETAIL             THRU 0400-EXIT
  2610
  2611     MOVE SPACES                           TO WS-DETAIL
  2612     MOVE 'LAS'                            TO WS-D1-PROCESS-MO
  2613     MOVE 'T '                             TO WS-D1-PROCESS-YY
  2614     MOVE '12 MOS'                         TO WS-D1-BATCH-NO
  2615     MOVE WS-12MO-ALLACCT-GRAND-TOTAL      TO WS-D1-PAYMENT (1)
  2616     PERFORM 0400-PRINT-DETAIL             THRU 0400-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS057.cbl
  2617
  2618     .
  2619 0380-EXIT.
  2620     EXIT.
  2621
  2622
  2623 0382-ALLACCT-PROCMO-TOTS.
  2624
  2625     MOVE SPACES                           TO WS-DETAIL
  2626     MOVE WS-H5-EFF-MOYY (MOHDR) (6:5)     TO WS-D1-PROCESS-DATE
  2627
  2628     MOVE +1                               TO EFFMOCOL
  2629     PERFORM 0384-ALLACCT-EFFMO-TOTS       THRU 0384-EXIT
  2630         VARYING EFFMO FROM SAVE-1ST-EFF-MONTH BY +1
  2631             UNTIL EFFMO > +12
  2632     IF SAVE-1ST-EFF-MONTH > +1
  2633         PERFORM 0384-ALLACCT-EFFMO-TOTS   THRU 0384-EXIT
  2634             VARYING EFFMO FROM +1 BY +1
  2635                 UNTIL EFFMO = SAVE-1ST-EFF-MONTH
  2636     END-IF
  2637     PERFORM 0400-PRINT-DETAIL             THRU 0400-EXIT
  2638     ADD +1                                TO MOHDR
  2639
  2640     .
  2641 0382-EXIT.
  2642     EXIT.
  2643
  2644
  2645 0384-ALLACCT-EFFMO-TOTS.
  2646
  2647     MOVE WS-ALLACCT-BYPROCMO-EFFMO (PROCMO EFFMO)
  2648                                     TO WS-D1-PAYMENT (EFFMOCOL)
  2649     ADD +1                          TO EFFMOCOL
  2650
  2651     .
  2652 0384-EXIT.
  2653     EXIT.
  2654
  2655
  2656 0385-MOVE-ALLACCTS-12MO-TOTS.
  2657
  2658     MOVE WS-ALLACCT-12MOTOTS (SUB3)
  2659                                    TO WS-D1-PAYMENT (COLUMN-SUB)
  2660     ADD +1                         TO COLUMN-SUB
  2661     ADD WS-ALLACCT-12MOTOTS (SUB3) TO WS-12MO-ALLACCT-GRAND-TOTAL
  2662
  2663     .
  2664 0385-EXIT.
  2665     EXIT.
  2666
  2667
  2668 0400-PRINT-DETAIL.
  2669
  2670     IF WS-LINE-COUNT >= WS-LINE-COUNT-MAX
  2671         PERFORM 4500-PRINT-HEADINGS  THRU 4500-EXIT
  2672     END-IF
  2673
  2674     MOVE WS-DETAIL                   TO PRT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS057.cbl
  2675     PERFORM 4900-WRITE               THRU 4900-EXIT
  2676
  2677     INITIALIZE WS-DETAIL
  2678
  2679     .
  2680 0400-EXIT.
  2681     EXIT.
  2682
  2683
  2684 4500-PRINT-HEADINGS.
  2685
  2686     MOVE WS-HEADING1                 TO PRT
  2687     PERFORM 4900-WRITE               THRU 4900-EXIT
  2688
  2689     MOVE WS-HEADING2                 TO PRT
  2690     PERFORM 4900-WRITE               THRU 4900-EXIT
  2691
  2692     ADD +1                           TO WS-PAGE
  2693     MOVE WS-PAGE                     TO WS-H3-PAGE
  2694     MOVE WS-HEADING3                 TO PRT
  2695     PERFORM 4900-WRITE               THRU 4900-EXIT
  2696
  2697     MOVE WS-ACCOUNT-HEADING          TO PRT
  2698     PERFORM 4900-WRITE               THRU 4900-EXIT
  2699
  2700     MOVE WS-HEADING4                 TO PRT
  2701     PERFORM 4900-WRITE               THRU 4900-EXIT
  2702
  2703     MOVE WS-HEADING5                 TO PRT
  2704     PERFORM 4900-WRITE               THRU 4900-EXIT
  2705
  2706     MOVE WS-HEADING6                 TO PRT
  2707     PERFORM 4900-WRITE               THRU 4900-EXIT
  2708
  2709     MOVE WS-HEADING7                 TO PRT
  2710     PERFORM 4900-WRITE               THRU 4900-EXIT
  2711
  2712     MOVE SPACES                      TO PRT
  2713     PERFORM 4900-WRITE               THRU 4900-EXIT
  2714
  2715     .
  2716 4500-EXIT.
  2717     EXIT.
  2718
  2719
  2720 4900-WRITE.
  2721
  2722     EVALUATE TRUE
  2723     WHEN P-CTL = '1'
  2724         MOVE +1                      TO WS-LINE-COUNT
  2725
  2726     WHEN P-CTL = SPACE
  2727         ADD +1                       TO WS-LINE-COUNT
  2728
  2729     WHEN P-CTL = '0'
  2730         ADD +2                       TO WS-LINE-COUNT
  2731
  2732     WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS057.cbl
  2733         ADD +3                       TO WS-LINE-COUNT
  2734     END-EVALUATE
  2735
  2736     WRITE PRT
  2737
  2738     .
  2739 4900-EXIT.
  2740     EXIT.
  2741
  2742 8500-DATE-CONVERSION.
  2743
  2744     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2745
  2746     .
  2747 8500-EXIT.
  2748     EXIT.
  2749
  2750 8800-OPEN-FILES.
  2751                                                                  ECS057
  2752     OPEN INPUT   OFFLN-CERT-IN                                   ECS057
  2753          OUTPUT  PRT-RPT
  2754
  2755     .
  2756 8800-EXIT.
  2757     EXIT.
  2758                                                                  ECS057
  2759 8900-CLOSE-FILES.
  2760                                                                  ECS057
  2761     CLOSE OFFLN-CERT-IN
  2762           PRT-RPT
  2763
  2764     .
  2765 8900-EXIT.
  2766     EXIT.
  2767                                                                  ECS057
  2768
  2769 ABEND-PGM SECTION.                                               ECS057
* 2770                             COPY ELCABEND.                       ECS057
  2771***************************************************************** 04/14/98
  2772*                                                               * ELCABEND
  2773*                            ELCABEND.                          *    LV003
  2774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2775*                            VMOD 2.002                              CL**2
  2776*                                                               * ELCABEND
  2777*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2778*            AND THEN ABENDS.                                   * ELCABEND
  2779*                                                               * ELCABEND
  2780*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2781*                                                               * ELCABEND
  2782***************************************************************** ELCABEND
  2783*APS-010.                                                         ELCABEND
  2784     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2785     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2786                                                                  ELCABEND
  2787     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2788         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2789         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2790                                 UPON CONSOLE.                    ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS057.cbl (/apps/prod/cid1p/copy/ELCABEND)
  2791                                                                  ELCABEND
  2792     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2793         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2794         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2795                                 UPON CONSOLE.                    ELCABEND
  2796                                                                  ELCABEND
  2797     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2798     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2799                                 UPON CONSOLE.                    ELCABEND
  2800                                                                  ELCABEND
  2801     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2802     CALL 'ABORTME'.
  2803                                                                  ELCABEND
  2804 APS-EXIT.                                                        ELCABEND
  2805     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       51316     Code:        9041
