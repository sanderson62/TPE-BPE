* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   1
* FNB169.cbl
* Options: int("FNB169.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB169.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB169.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB169.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    FNB169.
     3
     4******************************************************************
     5*                                                                *
     6*            FREEDOM INTERFACE FOR DCC CONTRACT FEES             *
     7*                                                                *
     8******************************************************************
     9*                   C H A N G E   L O G
    10*
    11* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    12*-----------------------------------------------------------------
    13*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   2
* FNB169.cbl
    14* EFFECTIVE    NUMBER
    15*-----------------------------------------------------------------
    16* 050704    2003080800002  SMVA  NEW PROGRAM FOR SECURE PAY
    17* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
    18* 021009  IR2009020900001  PEMA  ADD AGT TYPE J AS INCENTIVE
    19* 022009    2008050500001  AJRA  ADD PROCESSING FOR CCC
    20* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    21* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    22* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    23* 080212  IR2012080100002  PEMA  CORRECT AGT TYPE N
    24* 082912  IR2012080700001  PEMA  CORRECT REF ADMIN FEE
    25* 080612  IR2013080500001  PEMA  CORRECT REF CSO ADMIN FEE
    26* 100413  IR2013100100001  PEMA  INCREASE PDEF OCCURS
    27* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    28******************************************************************
    29
    30 ENVIRONMENT DIVISION.
    31 INPUT-OUTPUT SECTION.
    32 FILE-CONTROL.
    33
    34     SELECT DETEXTR              ASSIGN TO SYS010
    35                                 FILE STATUS IS DETEXT-STATUS.
    36     SELECT FREEDOM-EXTRACT      ASSIGN TO SYS011
    37                                 ORGANIZATION IS LINE SEQUENTIAL.
    38
    39     SELECT CSI-FREEDOM-EXTRACT  ASSIGN TO SYS012
    40                                 ORGANIZATION IS LINE SEQUENTIAL.
    41
    42     SELECT CCC-FREEDOM-EXTRACT  ASSIGN TO SYS013
    43                                 ORGANIZATION IS LINE SEQUENTIAL.
    44
    45     SELECT ERACCT               ASSIGN TO ERACCT
    46                                 ORGANIZATION IS INDEXED
    47                                 ACCESS IS DYNAMIC
    48                                 RECORD KEY IS AM-CONTROL-PRIMARY
    49                                 FILE STATUS IS ERACCT-STATUS.
    50
    51     SELECT ERPDEF           ASSIGN TO ERPDEF
    52                             ACCESS IS DYNAMIC
    53                             ORGANIZATION IS INDEXED
    54                             FILE STATUS IS ERPDEF-FILE-STATUS
    55                             RECORD KEY IS PD-CONTROL-PRIMARY.
    56
    57     SELECT DISK-DATE            ASSIGN TO SYS019.
    58
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   3
* FNB169.cbl
    60 DATA DIVISION.
    61 FILE SECTION.
    62
    63 FD  DETEXTR
    64     LABEL RECORDS ARE STANDARD
    65     RECORDING MODE IS F
    66     RECORD CONTAINS 510 CHARACTERS
    67     BLOCK CONTAINS 0 RECORDS.
*   68     COPY ECSEXT01.
    69******************************************************************04/29/98
    70*                                                                *ECSEXT01
    71*                            ECSEXT01                            *   LV015
    72*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
    73*                            VMOD=2.015                          *ECSEXT01
    74*                                                                *ECSEXT01
    75*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
    76*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
    77*                                                                *ECSEXT01
    78*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
    79*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
    80*                                                                *ECSEXT01
    81*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
    82*                                                                *ECSEXT01
    83******************************************************************ECSEXT01
    84******************************************************************
    85*                   C H A N G E   L O G
    86*
    87* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    88*-----------------------------------------------------------------
    89*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    90* EFFECTIVE    NUMBER
    91*-----------------------------------------------------------------
    92* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    93* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
    94* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    95* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
    96* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    97* 032612  CR2011110200001  PEMA  AHL CHANGES
    98******************************************************************
    99                                                                  ECSEXT01
   100 01  DETAIL-EXTRACT.                                              ECSEXT01
   101     02 DETAIL-FILE.                                              ECSEXT01
   102     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
   103         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
   104                                                                  ECSEXT01
   105     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
   106                                                                  ECSEXT01
   107     12  DE-REIN                           PIC X.                 ECSEXT01
   108                                                                  ECSEXT01
   109     12  DE-CONTROL.                                              ECSEXT01
   110         16  DE-CNTRL1.                                           ECSEXT01
   111             20  DE-CARRIER                PIC X.                 ECSEXT01
   112             20  DE-GROUPING.                                     ECSEXT01
   113                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
   114                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
   115             20  DE-STATE                  PIC XX.                ECSEXT01
   116             20  DE-ACCOUNT.                                      ECSEXT01
   117                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   4
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   118                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
   119         16  DE-CNTRL2.                                           ECSEXT01
   120             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
   121             20  DE-CERT.                                         ECSEXT01
   122                 24 DE-CERT-NO.                                   ECSEXT01
   123                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
   124                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
   125                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
   126                                                                  ECSEXT01
   127     12  DE-TRANS                          PIC X.                 ECSEXT01
   128         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
   129         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
   130         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
   131         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
   132         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
   133         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
   134         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
   135         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
   136         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
   137         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
   138                                                                  ECSEXT01
   139     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
   140     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
   141                                                                  ECSEXT01
   142     12  DE-NAME.                                                 ECSEXT01
   143         16  DE-LNAME                      PIC X(15).             ECSEXT01
   144         16  DE-FNAME.                                            ECSEXT01
   145             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
   146             20  FILLER                    PIC X(9).              ECSEXT01
   147         16  DE-INIT                       PIC X.                 ECSEXT01
   148     12  DE-AGE                            PIC 99.                ECSEXT01
   149     12  DE-SEX                            PIC X.                 ECSEXT01
   150     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
   151                                                                  ECSEXT01
   152     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
   153     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
   154     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
   155     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
   156     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   157     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
   158     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
   159     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
   160     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   161                                                                  ECSEXT01
   162     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
   163     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
   164     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
   165     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
   166                                                                  ECSEXT01
   167     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
   168     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
   169     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
   170     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   171     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   172                                                                  ECSEXT01
   173     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
   174     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
   175     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   5
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   176     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
   177                                                                  ECSEXT01
   178     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
   179     12  DE-ADDL-CLP REDEFINES DE-LIVES
   180                                           PIC S9(5)V99   COMP-3.
   181     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
   182     12  FILLER REDEFINES DE-NUM-BILLED.
   183         16  DE-CLP-STATE                  PIC XX.
   184         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
   185     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
   186     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
   187                                                                  ECSEXT01
   188     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
   189     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
   190     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
   191     12  DE-IG                             PIC X.                 ECSEXT01
   192     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
   193*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
   194     12  DE-MEMBER-NO.                                            ECSEXT01
   195         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
   196         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
   197         16  FILLER                        PIC X(03).             ECSEXT01
   198     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
   199                                                                  ECSEXT01
   200     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
   201         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
   202                                                                  ECSEXT01
   203     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
   204     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
   205                                                                  ECSEXT01
   206     12  DE-REI-AREA.                                             ECSEXT01
   207         16  DE-REI-COMP.                                         ECSEXT01
   208             20  DE-REINCO                 PIC XXX.               ECSEXT01
   209             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
   210         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   211         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   212         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   213         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
   214         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   215         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   216         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   217                                                                  ECSEXT01
   218     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   219     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
   220         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
   221         16  F                             PIC X.
   222*    12  FILLER                            PIC X(5).              ECSEXT01
   223                                                                  ECSEXT01
   224     12  DE-BILLED-AREA.                                          ECSEXT01
   225         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
   226             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
   227                                                                  ECSEXT01
   228         16  DE-BILL-SW                    PIC X.                 ECSEXT01
   229             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
   230             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
   231             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
   232             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
   233             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   6
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   234             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
   235                                                                  ECSEXT01
   236         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
   237             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
   238                                                                  ECSEXT01
   239         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   240         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   241         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   242         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   243                                                                  ECSEXT01
   244         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
   245*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
   246*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
   247                                                                  ECSEXT01
   248     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
   249         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
   250         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
   251         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
   252                                                                  ECSEXT01
   253     12  DE-REVERSE-REASONS.                                      ECSEXT01
   254         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
   255         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
   256     12  DE-CANCEL-REASON                  PIC X.
   257                                                                  ECSEXT01
   258     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
   259     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
   260                                                                  ECSEXT01
   261     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
   262         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   263             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
   264         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   265             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
   266                                                                  ECSEXT01
   267     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
   268         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
   269                                                                  ECSEXT01
   270     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
   271     12  FILLER REDEFINES DE-NCL-POOL-CODE.
   272         16  DE-LOAN-TERM                  PIC S999 COMP-3.
   273         16  FILLER                        PIC X.
   274                                                                  ECSEXT01
   275****************************************************************  ECSEXT01
   276**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
   277****************************************************************  ECSEXT01
   278     12  DE-COMM-LEVELS.                                          ECSEXT01
   279         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
   280             20  DE-AGT.                                          ECSEXT01
   281                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
   282                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
   283             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
   284             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   285             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   286                                                                  ECSEXT01
   287     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
   288****************************************************************  ECSEXT01
   289*******                 CLAIM EXTRACT                      *****  ECSEXT01
   290****************************************************************  ECSEXT01
   291     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   7
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   292     12  FILLER                            PIC X(334).            ECSEXT01
   293     12  DE-TYPE                           PIC X.                 ECSEXT01
   294         88  DE-DTH                           VALUE '1'.          ECSEXT01
   295         88  DE-AH                            VALUE '2'.          ECSEXT01
   296         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
   297         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
   298         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
   299         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
   300                                                                  ECSEXT01
   301     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
   302     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   303                                                                  ECSEXT01
   304     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
   305     12  DE-REPORTED.                                             ECSEXT01
   306         16  DE-RPT-YR                     PIC 99.                ECSEXT01
   307         16  DE-RPT-MO                     PIC 99.                ECSEXT01
   308         16  DE-RPT-DA                     PIC 99.                ECSEXT01
   309     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
   310     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
   311                                                                  ECSEXT01
   312     12  DE-CNUM                           PIC X(7).              ECSEXT01
   313     12  DE-CHECK                          PIC X(7).              ECSEXT01
   314     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
   315     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
   316     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
   317     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
   318         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
   319         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
   320         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
   321         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
   322         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
   323         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
   324         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
   325                                                                  ECSEXT01
   326     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
   327                                                                  ECSEXT01
   328     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
   329     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   330     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   331     12  FILLER                            PIC XX.                ECSEXT01
   332     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
   333                                                                  ECSEXT01
   334     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
   335     12  DE-BENEFICIARY                    PIC X(10).
   336     12  filler redefines de-beneficiary.
   337         16  de-birth-date                 pic 9(11)  comp-3.
   338         16  f                             pic x(4).
   339     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
   340     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
   341     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
   342     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
   343     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
   344     12  DE-CLM-CLASS                      PIC XX.
   345     12  DE-CLM-DEV                        PIC XXX.
   346     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
   347     12  de-xycor-cert-seq                 pic x(3).
   348     12  DE-XYCOR-CHECK-NO                 PIC X(8).
   349     12  DE-XYCOR-ACTION-CD                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   8
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   350     12  DE-XYCOR-STATUS                   PIC X.
   351     12  FILLER                            PIC X(4).              ECSEXT01
   352                                                                  ECSEXT01
   353     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   354                                                                  ECSEXT01
   355****************************************************************  ECSEXT01
   356*******               RESERVE EXTRACT                      *****  ECSEXT01
   357****************************************************************  ECSEXT01
   358     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
   359     12  FILLER                            PIC X(334).            ECSEXT01
   360                                                                  ECSEXT01
   361     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
   362         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
   363         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
   364                                                                  ECSEXT01
   365     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
   366     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
   367     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
   368                                                                  ECSEXT01
   369     12  DE-CLMNO                          PIC X(7).              ECSEXT01
   370                                                                  ECSEXT01
   371     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
   372     12  DE-RSV-REPORTED.                                         ECSEXT01
   373         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
   374         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
   375         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
   376     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
   377                                                                  ECSEXT01
   378     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
   379     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
   380     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
   381                                                                  ECSEXT01
   382     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
   383     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   384     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   385                                                                  ECSEXT01
   386     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
   387                                                                  ECSEXT01
   388     12  DE-RATE-CLASS                     PIC XX.
   389     12  DE-DEV-CODE                       PIC XXX.
   390     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
   391     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
   392     12  FILLER                            PIC X(58).             ECSEXT01
   393                                                                  ECSEXT01
   394     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   395******************************************************************ECSEXT01
   396
   397 FD  FREEDOM-EXTRACT
   398     LABEL RECORDS ARE STANDARD
   399     RECORDING MODE IS F
   400     BLOCK CONTAINS 0 RECORDS.
   401 01  EXTRACT-RECORD      PIC X(250).
   402
   403 FD  CSI-FREEDOM-EXTRACT
   404     LABEL RECORDS ARE STANDARD
   405     RECORDING MODE IS F
   406     BLOCK CONTAINS 0 RECORDS.
   407 01  CSI-EXTRACT-RECORD          PIC X(250).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   9
* FNB169.cbl
   408
   409 FD  CCC-FREEDOM-EXTRACT
   410     LABEL RECORDS ARE STANDARD
   411     RECORDING MODE IS F
   412     BLOCK CONTAINS 0 RECORDS.
   413 01  CCC-EXTRACT-RECORD          PIC X(250).
   414
   415 FD  ERACCT.
*  416     COPY ERCACCT.
   417******************************************************************04/19/98
   418*                                                                *ERCACCT
   419*                                                                *ERCACCT
   420*                            ERCACCT                             *   LV031
   421*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   422*                            VMOD=2.031                          *ERCACCT
   423*                                                                *ERCACCT
   424*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   425*                                                                *ERCACCT
   426*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   427*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   428*                                                                *ERCACCT
   429*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   430*                                                                *ERCACCT
   431*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   432*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   433*                                                                *ERCACCT
   434*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   435*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   436*                                                                *ERCACCT
   437*   LOG = NO                                                     *ERCACCT
   438*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   439*                                                                *ERCACCT
   440*                                                                *ERCACCT
   441******************************************************************ERCACCT
   442*                   C H A N G E   L O G
   443*
   444* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   445*-----------------------------------------------------------------
   446*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   447* EFFECTIVE    NUMBER
   448*-----------------------------------------------------------------
   449* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   450* 092705    2005050300006  PEMA  ADD SPP LEASES
   451* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   452* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   453* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   454* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   455* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   456******************************************************************
   457                                                                  ERCACCT
   458 01  ACCOUNT-MASTER.                                              ERCACCT
   459     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   460         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   461                                                                  ERCACCT
   462     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   463         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   464         16  AM-MSTR-CNTRL.                                       ERCACCT
   465             20  AM-CONTROL-A.                                    ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  10
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   466                 24  AM-CARRIER            PIC X.                 ERCACCT
   467                 24  AM-GROUPING.                                 ERCACCT
   468                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   469                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   470                 24  AM-STATE              PIC XX.                ERCACCT
   471                 24  AM-ACCOUNT.                                  ERCACCT
   472                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   473                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   474             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   475                                           PIC X(19).             ERCACCT
   476             20  AM-CNTRL-B.                                      ERCACCT
   477                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   478                 24  FILLER                PIC X(4).              ERCACCT
   479             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   480                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   481                                                                  ERCACCT
   482     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   483         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   484         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   485         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   486         16  AM-VG-STATE                   PIC XX.                ERCACCT
   487         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   488         16  AM-VG-DATE.                                          ERCACCT
   489             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   490             20  FILLER                    PIC X(4).              ERCACCT
   491         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   492                                           PIC 9(11)      COMP-3. ERCACCT
   493     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   494         16  FILLER                        PIC X(10).
   495         16  AM-VG-KEY3.
   496             20  AM-VG3-ACCOUNT            PIC X(10).
   497             20  AM-VG3-EXP-DT             PIC XX.
   498         16  FILLER                        PIC X(4).
   499     12  AM-MAINT-INFORMATION.                                    ERCACCT
   500         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   501         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   502         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   503         16  FILLER                        PIC XX.                ERCACCT
   504                                                                  ERCACCT
   505     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   506     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   507                                                                  ERCACCT
   508     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   509         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   510         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   511                                                                  ERCACCT
   512     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   513     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   514                                                                  ERCACCT
   515     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   516     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   517                                                                  ERCACCT
   518     12  AM-NAME                           PIC X(30).             ERCACCT
   519     12  AM-PERSON                         PIC X(30).             ERCACCT
   520     12  AM-ADDRS                          PIC X(30).             ERCACCT
   521     12  AM-CITY.
   522         16  AM-ADDR-CITY                  PIC X(28).
   523         16  AM-ADDR-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  11
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   524     12  AM-ZIP.                                                  ERCACCT
   525         16  AM-ZIP-PRIME.                                        ERCACCT
   526             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   527                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   528             20  FILLER                    PIC X(4).              ERCACCT
   529         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   530     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   531         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   532         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   533         16  FILLER                        PIC XXX.               ERCACCT
   534     12  AM-TEL-NO.                                               ERCACCT
   535         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   536         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   537         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   538     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   539         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   540         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   541                                                                  ERCACCT
   542     12  AM-COMM-STRUCTURE.                                       ERCACCT
   543         16  AM-DEFN-1.                                           ERCACCT
   544             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   545                 24  AM-AGT.                                      ERCACCT
   546                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   547                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   548                 24  AM-COM-TYP            PIC X.                 ERCACCT
   549                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   550                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   551                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   552                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   553                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   554                 24  AM-GL-CODES           PIC X.                 ERCACCT
   555                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   556                 24  FILLER                PIC X(01).             ERCACCT
   557         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   558             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   559                 24  FILLER                PIC X(11).             ERCACCT
   560                 24  AM-L-COMA             PIC XXX.               ERCACCT
   561                 24  AM-J-COMA             PIC XXX.               ERCACCT
   562                 24  AM-A-COMA             PIC XXX.               ERCACCT
   563                 24  FILLER                PIC X(6).              ERCACCT
   564                                                                  ERCACCT
   565     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   566         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   567                                                                  ERCACCT
   568     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   569                                                                  ERCACCT
   570     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   571         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   572         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   573     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   574         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   575         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   576     12  AM-GPCD                           PIC 99.                ERCACCT
   577     12  AM-IG                             PIC X.                 ERCACCT
   578         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   579         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   580     12  AM-STATUS                         PIC X.                 ERCACCT
   581         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  12
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   582         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   583         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   584         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   585         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   586         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   587     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   588     12  AM-ID-NO                          PIC X(11).             ERCACCT
   589                                                                  ERCACCT
   590     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   591     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   592     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   593     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   594     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   595     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   596     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   597     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   598     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   599                                                                  ERCACCT
   600     12  AM-USER-FIELDS.                                          ERCACCT
   601         16  AM-FLD-1                      PIC XX.                ERCACCT
   602         16  AM-FLD-2                      PIC XX.                ERCACCT
   603         16  AM-FLD-3                      PIC XX.                ERCACCT
   604         16  AM-FLD-4                      PIC XX.                ERCACCT
   605         16  AM-FLD-5                      PIC XX.                ERCACCT
   606                                                                  ERCACCT
   607     12  AM-1ST-PROD-DATE.                                        ERCACCT
   608         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   609         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   610         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   611     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   612     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   613         16  AM-PUR-YR                     PIC XX.                ERCACCT
   614         16  AM-PUR-MO                     PIC XX.                ERCACCT
   615         16  AM-PUR-DA                     PIC XX.                ERCACCT
   616     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   617     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   618     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   619     12  AM-INACTIVE-DATE.                                        ERCACCT
   620         16  AM-INA-MO                     PIC 99.                ERCACCT
   621         16  AM-INA-DA                     PIC 99.                ERCACCT
   622         16  AM-INA-YR                     PIC 99.                ERCACCT
   623     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   624                                                                  ERCACCT
   625     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   626     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   627                                                                  ERCACCT
   628     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   629         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   630         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   631         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   632         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   633                                                                  ERCACCT
   634     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   635         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   636         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   637                                                                  ERCACCT
   638     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   639                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  13
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   640     12  AM-OVER-SHORT.                                           ERCACCT
   641         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   642         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   643                                                                  ERCACCT
   644     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   645     12  AM-DCC-CLP-STATE                  PIC XX.
   646                                                                  ERCACCT
   647     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   648     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   649                                                                  ERCACCT
   650     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   651     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   652     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   653     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   654     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   655     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   656     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   657     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   658     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   659     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   660     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   661     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   662     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   663     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   664     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   665     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   666                                                                  ERCACCT
   667     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   668                                                                  ERCACCT
   669     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   670     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   671                                                                  ERCACCT
   672     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   673     12  AM-EARN-METHODS.                                         ERCACCT
   674         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   675             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   676             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   677             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   678             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   679         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   680             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   681             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   682             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   683             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   684         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   685             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   686             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   687             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   688             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   689             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   690             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   691                                                                  ERCACCT
   692     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   693     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   694     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   695                                                                  ERCACCT
   696     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   697     12  AM-RET-P-E                        PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  14
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   698     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   699     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   700     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   701     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   702         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   703         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   704     12  AM-RETRO-EARNINGS.                                       ERCACCT
   705         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   706         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   707         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   708     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   709         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   710         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   711     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   712         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   713         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   714         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   715     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   716     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   717                                                                  ERCACCT
   718     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   719         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   720         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   721         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   722         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   723         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   724                                                                  ERCACCT
   725     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   726                                                                  ERCACCT
   727     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   728                                                                  ERCACCT
   729     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   730         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   731                                                                  ERCACCT
   732     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   733         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   734         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   735                                                                  ERCACCT
   736     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   737         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   738                                                                  ERCACCT
   739     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   740         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   741         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   742                                                                  ERCACCT
   743     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   744                                                                  ERCACCT
   745     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   746     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   747     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   748     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   749     12  AM-DCC-UEF-STATE                  PIC XX.
   750     12  FILLER                            PIC XXX.
   751     12  AM-REPORT-CODE-3                  PIC X(10).
   752*    12  FILLER                            PIC X(22).             ERCACCT
   753                                                                  ERCACCT
   754     12  AM-RESERVE-DATE.                                         ERCACCT
   755         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  15
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   756         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   757         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   758                                                                  ERCACCT
   759     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   760     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   761         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   762         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   763         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   764         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   765                                                                  ERCACCT
   766     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   767         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   768         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   769         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   770         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   771                                                                  ERCACCT
   772     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   773         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   774             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   775             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   776             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   777             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   778             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   779             20  FILLER                    PIC XX.                ERCACCT
   780         16  FILLER                        PIC X(80).             ERCACCT
   781                                                                  ERCACCT
   782     12  AM-TRANSFER-DATA.                                        ERCACCT
   783         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   784             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   785             20  AM-TRNFROM-GROUPING.                             ERCACCT
   786                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   787                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   788             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   789             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   790                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   791                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   792             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   793         16  AM-TRANSFERRED-TO.                                   ERCACCT
   794             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   795             20  AM-TRNTO-GROUPING.                               ERCACCT
   796                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   797                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   798             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   799             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   800                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   801                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   802             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   803         16  FILLER                        PIC X(10).             ERCACCT
   804                                                                  ERCACCT
   805     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   806                                                                  ERCACCT
   807     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   808         16  AM-DEFN-1-SAVED.                                     ERCACCT
   809             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   810                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   811                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   812                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   813                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  16
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   814                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   815                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   816                 24  FILLER                PIC X.                 ERCACCT
   817                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   818                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   819                 24  FILLER                PIC X.                 ERCACCT
   820         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   821             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   822                 24  FILLER                PIC X(11).             ERCACCT
   823                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   824                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   825                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   826                 24  FILLER                PIC X(6).              ERCACCT
   827                                                                  ERCACCT
   828     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   829         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   830            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   831            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   832            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   833                                                                  ERCACCT
   834     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   835     12  FILLER                            PIC X(120).            ERCACCT
   836                                                                  ERCACCT
   837     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   838         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   839         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   840             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   841             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   842                                                          COMP-3. ERCACCT
   843             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   844                                                          COMP-3. ERCACCT
   845         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   846             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   847             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   848                                                          COMP-3. ERCACCT
   849             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   850                                                          COMP-3. ERCACCT
   851                                                                  ERCACCT
   852     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   853         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   854         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   855         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   856         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   857             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   858                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   859                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   860             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   861                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   862                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   863             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   864                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   865                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   866         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   867             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   868                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   869                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   870                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   871             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  17
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   872                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   873                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   874             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   875                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   876                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   877                                                                  ERCACCT
   878     12  AM-COMMENTS.                                             ERCACCT
   879         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   880                                                                  ERCACCT
   881     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   882         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   883         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   884         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   885         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   886         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   887             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   888             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   889             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   890             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   891         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   892             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   893             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   894             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   895         16  FILLER                        PIC X(102).            ERCACCT
   896                                                                  ERCACCT
   897     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   898         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   899             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   900             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   901             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   902             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   903             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   904         16  FILLER                          PIC X(10).           ERCACCT
   905******************************************************************ERCACCT
   906
   907 FD  ERPDEF.
   908
*  909                             COPY ERCPDEF.
   910******************************************************************
   911*                                                                *
   912*                                                                *
   913*                            ERCPDEF.                            *
   914*                                                                *
   915*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   916*                                                                *
   917*    FILE TYPE = VSAM,KSDS                                       *
   918*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   919*                                                                *
   920*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   921*                                                                *
   922*    LOG = YES                                                   *
   923*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   924******************************************************************
   925*                   C H A N G E   L O G
   926*
   927* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   928*-----------------------------------------------------------------
   929*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  18
* FNB169.cbl (/apps/test/cid1s/copy/ERCPDEF)
   930* EFFECTIVE    NUMBER
   931*-----------------------------------------------------------------
   932* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   933******************************************************************
   934 01  PRODUCT-MASTER.
   935    12  PD-RECORD-ID                 PIC X(02).
   936        88  VALID-PD-ID                  VALUE 'PD'.
   937
   938    12  PD-CONTROL-PRIMARY.
   939        16  PD-COMPANY-CD            PIC X.
   940        16  PD-STATE                 PIC XX.
   941        16  PD-PRODUCT-CD            PIC XXX.
   942        16  PD-FILLER                PIC X(7).
   943        16  PD-BEN-TYPE              PIC X.
   944        16  PD-BEN-CODE              PIC XX.
   945        16  PD-PROD-EXP-DT           PIC XX.
   946
   947    12  FILLER                       PIC X(50).
   948
   949    12  PD-PRODUCT-DATA OCCURS 8.
   950        16  PD-PROD-CODE             PIC X.
   951            88  PD-PROD-LIFE           VALUE 'L'.
   952            88  PD-PROD-PROP           VALUE 'P'.
   953            88  PD-PROD-AH             VALUE 'A'.
   954            88  PD-PROD-IU             VALUE 'I'.
   955            88  PD-PROD-GAP            VALUE 'G'.
   956            88  PD-PROD-FMLA           VALUE 'F'.
   957        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   958        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   959        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   960        16  PD-MAX-TERM              PIC S999        COMP-3.
   961        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   962        16  FILLER                   PIC X.
   963        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   964        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   965        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   966        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   967        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   968        16  PD-REC-CRIT-PERIOD       PIC 99.
   969        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   970            20  PD-RECURRING-YN      PIC X.
   971            20  FILLER               PIC X.
   972        16  PD-RTW-MOS               PIC 99.
   973        16  PD-MAX-EXTENSION         PIC 99.
   974        16  FILLER                   PIC XX.
   975
   976    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   977
   978    12  PD-TERM-LIMITS OCCURS 15.
   979        16  PD-LOW-TERM              PIC S999        COMP-3.
   980        16  PD-HI-TERM               PIC S999        COMP-3.
   981
   982*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   983    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   984        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   985        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   986
   987    12  PD-EARN-FACTORS.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  19
* FNB169.cbl (/apps/test/cid1s/copy/ERCPDEF)
   988        16  FILLER OCCURS 15.
   989            20  FILLER OCCURS 15.
   990                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   991
   992    12  PD-PRODUCT-DESC              PIC X(80).
   993    12  PD-TRUNCATED                 PIC X.
   994    12  FILLER                       PIC X(59).
   995
   996    12  PD-MAINT-INFORMATION.
   997        16  PD-LAST-MAINT-DT         PIC X(02).
   998        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   999        16  PD-LAST-MAINT-BY         PIC X(04).
  1000
  1001 FD  DISK-DATE
* 1002     COPY ELCDTEFD.
  1003******************************************************************04/15/98
  1004*                                                                *ELCDTEFD
  1005*                                                                *ELCDTEFD
  1006*                            ELCDTEFD.                           *   LV002
  1007*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1008*                            VMOD=2.007                          *   CL**2
  1009*                                                                *ELCDTEFD
  1010******************************************************************ELCDTEFD
  1011     BLOCK CONTAINS 0 RECORDS
  1012     RECORDING MODE F.                                            ELCDTEFD
  1013                                                                  ELCDTEFD
  1014 01  DATE-DISK.                                                   ELCDTEFD
  1015     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1016     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1017     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1018     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1019     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1020     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1021     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1022                                                                  ELCDTEFD
  1023 01  DATE-DISK-R.                                                 ELCDTEFD
  1024     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1025     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1026                                     PIC  X(32).                  ELCDTEFD
  1027                                                                  ELCDTEFD
  1028 01  DATE-DISK-T.                                                 ELCDTEFD
  1029     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1030     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1031                                     PIC  X(48).                  ELCDTEFD
  1032                                                                  ELCDTEFD
  1033 01  DATE-DISK-M.                                                 ELCDTEFD
  1034     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1035     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1036                                     PIC  X(48).                  ELCDTEFD
  1037                                                                  ELCDTEFD
  1038 01  DATE-DISK-P.                                                 ELCDTEFD
  1039     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1040     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1041     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1042     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1043         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1044                                     PIC  X.                      ELCDTEFD
  1045         16  FILLER                  PIC  X(46).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  20
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1046     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1047         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1048             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1049             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1050             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1051             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1052         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1053                                                                  ELCDTEFD
  1054 01  DATE-DISK-E.                                                 ELCDTEFD
  1055     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1056     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1057                                     PIC  X(4).                   ELCDTEFD
  1058                                                                  ELCDTEFD
  1059 01  DATE-DISK-C.                                                 ELCDTEFD
  1060     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1061     12  DD-CARR1-SECPAY-SW          PIC  X.
  1062     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1063     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1064     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1065     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1066     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1067     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1068     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1069     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1070     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1071     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1072     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1073     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1074     12  DD-CARR2-SECPAY-SW          PIC  X.
  1075     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1076                                                                  ELCDTEFD
  1077 01  DATE-DISK-OPT.                                               ELCDTEFD
  1078     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1079     12  DD-TLR-DATA.                                             ELCDTEFD
  1080         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1081                                     PIC  X(03).                  ELCDTEFD
  1082     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1083         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1084                                     PIC  X(06).                  ELCDTEFD
  1085     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1086         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1087                                     PIC  X(07).                  ELCDTEFD
  1088         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1089     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1090                                     PIC  X(96).                  ELCDTEFD
  1091******************************************************************ELCDTEFD
  1092
  1093
  1094 WORKING-STORAGE SECTION.
  1095
  1096 77  B-SUB                   PIC S9(4)   COMP.
  1097 77  D1                      PIC S9(5) COMP-3 VALUE +0.
  1098 77  P1                      PIC S999 COMP-3 VALUE +0.
  1099 77  P2                      PIC S999 COMP-3 VALUE +0.
  1100 77  CNC-WK                  PIC S9(7)V99 COMP-3 VALUE +0.
  1101 77  WS-MONTH                PIC S999     COMP-3 VALUE +0.
  1102 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  1103 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  21
* FNB169.cbl
  1104 77  DD-IU-SW                    PIC X   VALUE ' '.
  1105     88  DD-IU-PRESENT                 VALUE 'Y'.
  1106 77  WS-FACT-CERT            PIC X(11) VALUE SPACES.
  1107 77  A-OW                        PIC S9(7)V99 COMP-3 VALUE +0.
  1108 77  W-FACTOR            PIC S9(09)V9(08) COMP-3 VALUE +0.
  1109 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  1110 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  1111 77  WS-DDF-TERM             PIC S999 COMP-3 VALUE +0.
  1112
  1113 01  WS-DCC-PRODUCT-CODE         PIC XXX  VALUE SPACES.
  1114 01  AGT-LEVEL                 COMP   PIC 9(04).
  1115 01  WS-CNC-FACT               COMP-3 PIC S9(03)V9(07) VALUE +0.
  1116 01  WS-LF-CNC-FACT            COMP-3 PIC S9(03)V9(07) VALUE +0.
  1117 01  WS-WORK-AMT               COMP-3 PIC S9(7)V99 VALUE +0.
  1118 01  WS-LF-WORK                  PIC S9(7)V99 VALUE +0 COMP-3.
  1119 01  WS-AH-WORK                  PIC S9(7)V99 VALUE +0 COMP-3.
  1120 01  TEST-DISP-FX-AMT PIC ZZZZZZZZ9.99.
  1121 01  TEST-DISP-L-PC PIC ZZ.ZZZZZ.
  1122 01  TEST-DISP-A-PC PIC ZZ.ZZZZZ.
  1123 01  FILLER.
  1124     05  WS-ZERO               COMP-3 PIC S9(03) VALUE +0.
  1125     05  WS-ABEND-MESSAGE             PIC X(80)  VALUE SPACES.
  1126     05  PGM-SUB               COMP   PIC S9(04) VALUE +310.
  1127     05  WS-RETURN-CODE        COMP-3 PIC S9(03) VALUE +0.
  1128
  1129     05  DETEXT-STATUS                PIC X(02)  VALUE '00'.
  1130         88  EOF-DETEXT                          VALUE '10'.
  1131
  1132     05  DATE-SW                      PIC X(01)  VALUE ' '.
  1133         88  VALID-DATE                          VALUE 'V'.
  1134
  1135     05  VALID-RECORD-SW              PIC X(01)  VALUE '0'.
  1136         88  VALID-RECORD                        VALUE '1'.
  1137
  1138     05  END-OF-SEARCH-SW             PIC X(01)  VALUE '0'.
  1139         88  END-OF-SEARCH                       VALUE '1'.
  1140
  1141     05  ERACCT-STATUS                PIC X(02)  VALUE '00'.
  1142     05  ERPDEF-FILE-STATUS           PIC XX     VALUE '00'.
  1143
  1144
  1145 01  max-pdef                    pic s9(5) comp-3 value +5000.
  1146 01  DCC-DDF-WORK-AREA.
  1147     05  F OCCURS 5000.
  1148         10  DD-STATE                 PIC XX.
  1149         10  DD-PRODUCT-CD            PIC XXX.
  1150         10  DD-FILLER                PIC X(7).
  1151         10  DD-BEN-TYPE              PIC X.
  1152         10  DD-BEN-CODE              PIC XX.
  1153         10  DD-PROD-EXP-DT           PIC XX.
  1154         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  1155         10  DD-PROD-DATA OCCURS 8.
  1156             15  DD-PROD-CODE         PIC X.
  1157         10  DD-EARN-FACTORS.
  1158             15  F OCCURS 15.
  1159                 20  F OCCURS 15.
  1160                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1161         10  DD-TRUNCATED             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  22
* FNB169.cbl
  1162
  1163 01  WS-EXTRACT-RECORD.
* 1164     COPY FNC022.
  1165     05  FX-COMMON-SECTION.                                       00010001
  1166         10  FX-SYSTEM             PIC X(10).                     00020001
  1167         10  FX-SOURCE-CODE        PIC X(6).                      00030001
  1168         10  FX-DIVISION           PIC X(2).                      00040001
  1169         10  FX-TRAN-TYPE          PIC X(2).                      00050001
  1170         10  FX-SUB-TYPE           PIC X(2).                      00060001
  1171         10  FX-CLM-RES            PIC X(2).                      00070001
  1172         10  FX-ANN-STMT           PIC X(3).                      00080001
  1173         10  FX-PLAN-CODE          PIC X(6).                      00090001
  1174         10  FX-FORM               PIC X(3).                      00091001
  1175         10  FX-JOURNAL-DATE       PIC X(8).                      00092001
  1176         10  FX-POSTING-DATE       PIC X(8).                      00093001
  1177         10  FX-POLICY-NO          PIC X(10).                     00094001
  1178         10  FX-CITY               PIC X(30).                     00095002
  1179         10  FX-STATE              PIC X(2).                      00095102
  1180         10  FX-ZIP-CODE           PIC X(9).                      00096001
  1181         10  FX-LOC-CODE           PIC X.                         00096102
  1182         10  FX-FY-REN             PIC X.                         00097001
  1183         10  FX-AGENT-01           PIC X(9).                      00098001
  1184         10  FX-AGENT-50           PIC X(9).                      00099001
  1185         10  FX-COST-CENTER        PIC X(4).                      00100001
  1186         10  FX-TAXABLE            PIC X.                         00110004
  1187         10  FX-DISTR              PIC X(2).                      00120001
  1188         10  FX-SOURCE-ACCT        PIC X(10).                     00130001
  1189         10  FX-DESCRIPTION        PIC X(30).                     00140001
  1190         10  FX-REFERENCE          PIC X(10).                     00150001
  1191         10  FX-SUSPENSE           PIC X(15).                     00151002
  1192         10  FX-AMOUNT             PIC S9(10)V99                  00160001
  1193                                   SIGN IS TRAILING SEPARATE.     00170001
  1194                                                                  00180001
  1195     05  FX-CLAIM-SECTION.                                        00190001
  1196         10  FX-CLAIM-NO           PIC X(10).                     00200001
  1197         10  FX-CLAIM-TYPE         PIC X.                         00210001
  1198         10  FX-DRAFT-NO           PIC X(10).                     00220001
  1199         10  FX-DRAFT-STATUS       PIC X.                         00230001
  1200         10  FX-TAX-ID             PIC X(10).                     00240001
  1201         10  FILLER                PIC X(10).                     00250003
  1202                                                                  00290001
  1203
  1204
  1205 01  FNX001-PARMS.
  1206     05  FNX001-DATA                  PIC X(50).
  1207     05  FNX001-CITY                  PIC X(30).
  1208     05  FNX001-STATE                 PIC X(02).
  1209     05  FNX001-ZIP                   PIC X(09).
  1210
  1211 01  SYSTEM-DATE.
  1212     05  SYS-MO                       PIC 9(02).
  1213     05  SYS-DA                       PIC 9(02).
  1214     05  SYS-CCYY                     PIC 9(04).
  1215
  1216***** FUNCTION-DATE COPYBOOK
* 1217 COPY ELCFUNDT.
  1218***************************************************************** 12/03/98
  1219*                                                               * ELCFUNDT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  23
* FNB169.cbl (/apps/prod/cid1p/copy/ELCFUNDT)
  1220*                            ELCFUNDT.                          *    LV004
  1221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  1222*                            VMOD=2.001                         * ELCFUNDT
  1223*                                                               * ELCFUNDT
  1224*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  1225*                                                               * ELCFUNDT
  1226***************************************************************** ELCFUNDT
  1227                                                                  ELCFUNDT
  1228                                                                  ELCFUNDT
  1229 01  FUNCTION-DATE.                                                  CL**2
  1230     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  1231     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  1232         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  1233         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  1234             15  WS-FN-CC          PIC 99.                           CL**3
  1235             15  WS-FN-YR          PIC 99.                           CL**3
  1236         10  WS-FN-MO              PIC 99.                           CL**3
  1237         10  WS-FN-DA              PIC 99.                           CL**3
  1238     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  1239     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  1240     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  1241     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  1242     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  1243         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  1244         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  1245         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  1246     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  1247     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
  1248
  1249
  1250***** STATE EDIT TABLE
* 1251 COPY FNC018.
  1252***************************************************************** 00020002
  1253*                                                               * 00030002
  1254*                     STATE CODE TABLE                          * 00040002
  1255*                                                               * 00050002
  1256*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     * 00060002
  1257*            SEARCH VERB WILL NOT WORK PROPERLY !               * 00070002
  1258*                                                               * 00080002
  1259***************************************************************** 00090002
  1260*                                                                 00100002
  1261 01  STATE-VALUES.                                                00110002
  1262     05  PIC X(24)  VALUE 'AKAKALASKA              '.             00120002
  1263     05  PIC X(24)  VALUE 'ALALALABAMA             '.             00130002
  1264     05  PIC X(24)  VALUE 'ARARARKANSAS            '.             00140002
  1265     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.             00150002
  1266     05  PIC X(24)  VALUE 'AZAZARIZONA             '.             00160002
  1267     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.             00170002
  1268     05  PIC X(24)  VALUE 'CDCNCANADA              '.             00180002
  1269     05  PIC X(24)  VALUE 'CNCNCANADA              '.             00190002
  1270     05  PIC X(24)  VALUE 'COCOCOLORADO            '.             00200002
  1271     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.             00210002
  1272     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.             00220002
  1273     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.             00230002
  1274     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.             00240002
  1275     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.             00250002
  1276     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.             00260002
  1277     05  PIC X(24)  VALUE 'GUGUGUAM                '.             00270002
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  24
* FNB169.cbl (/apps/prod/cid1p/copy/FNC018)
  1278     05  PIC X(24)  VALUE 'HIHIHAWAII              '.             00280002
  1279     05  PIC X(24)  VALUE 'IAIAIOWA                '.             00290002
  1280     05  PIC X(24)  VALUE 'IDIDIDAHO               '.             00300002
  1281     05  PIC X(24)  VALUE 'ILILILLINOIS            '.             00310002
  1282     05  PIC X(24)  VALUE 'INININDIANA             '.             00320002
  1283     05  PIC X(24)  VALUE 'KSKSKANSAS              '.             00330002
  1284     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.             00340002
  1285     05  PIC X(24)  VALUE 'LALALOUISIANA           '.             00350002
  1286     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.             00360002
  1287     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.             00370002
  1288     05  PIC X(24)  VALUE 'MEMEMAINE               '.             00380002
  1289     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.             00390002
  1290     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.             00400002
  1291     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.             00410002
  1292     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.             00420002
  1293     05  PIC X(24)  VALUE 'MTMTMONTANA             '.             00430002
  1294     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.             00440002
  1295     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.             00450002
  1296     05  PIC X(24)  VALUE 'NENENEBRASKA            '.             00460002
  1297     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.             00470002
  1298     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.             00480002
  1299     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.             00490002
  1300     05  PIC X(24)  VALUE 'NVNVNEVADA              '.             00500002
  1301     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.             00510002
  1302     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.             00520002
  1303     05  PIC X(24)  VALUE 'OHOHOHIO                '.             00530002
  1304     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.             00540002
  1305     05  PIC X(24)  VALUE 'OROROREGON              '.             00550002
  1306     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.             00560002
  1307     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.             00570002
  1308     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.             00580002
  1309     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.             00590002
  1310     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.             00600002
  1311     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.             00610002
  1312     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.             00620002
  1313     05  PIC X(24)  VALUE 'TXTXTEXAS               '.             00630002
  1314     05  PIC X(24)  VALUE 'UTUTUTAH                '.             00640002
  1315     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.             00650002
  1316     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.             00660002
  1317     05  PIC X(24)  VALUE 'VTVTVERMONT             '.             00670002
  1318     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.             00680002
  1319     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.             00690002
  1320     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.             00700002
  1321     05  PIC X(24)  VALUE 'WYWYWYOMING             '.             00710002
  1322                                                                  00720002
  1323 01  FILLER REDEFINES STATE-VALUES.                               00730002
  1324     05  STATE-TABLE                                              00740002
  1325             OCCURS 60 TIMES                                      00750002
  1326             ASCENDING KEY IS ST-STATE                            00760002
  1327             INDEXED BY ST-INDEX.                                 00770002
  1328         10  ST-STATE          PIC XX.                            00780002
  1329         10  ST-ALT-STATE      PIC XX.                            00790002
  1330         10  ST-NAME           PIC X(20).                         00800002
  1331                                                                  00810002
  1333
* 1334 COPY ELCDTECX.
  1335******************************************************************06/05/98
  1336*                                                                *ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  25
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1337*                            ELCDTECX.                           *   LV005
  1338*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1339*                            VMOD=2.015                          *ELCDTECX
  1340*                                                                *ELCDTECX
  1341*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1342*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1343*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1344*                                                                *ELCDTECX
  1345******************************************************************ELCDTECX
  1346******************************************************************
  1347*                   C H A N G E   L O G
  1348*
  1349* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1350*-----------------------------------------------------------------
  1351*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1352* EFFECTIVE    NUMBER
  1353*-----------------------------------------------------------------
  1354* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1355*                                  BENEFIT CODES FROM 300 TO 900
  1356* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1357* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1358******************************************************************
  1359 01  DATE-CARD.                                                   ELCDTECX
  1360     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1361     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1362     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1363     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1364     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1365     12  EP-SW                       PIC  X.                      ELCDTECX
  1366         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1367     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1368         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1369     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1370     12  RUN-CENTURY.                                             ELCDTECX
  1371         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1372     12  FILLER                      PIC  X.                         CL**4
  1373     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1374     12  FILLER                      PIC  XXX.                    ELCDTECX
  1375     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1376                                                                  ELCDTECX
  1377 01  FILLER                          PIC  X(7)                       CL**6
  1378                                          VALUE 'OPTIONS'.        ELCDTECX
  1379 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1380     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1381     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1382     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1383         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1384         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1385     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1386     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1387     12  FILLER                      PIC  X.                      ELCDTECX
  1388     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1389     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1390     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1391     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1392     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1393     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1394     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  26
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1395     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1396     12  FILLER                      PIC  X.                      ELCDTECX
  1397     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1398     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1399     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1400     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1401     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1402     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1403     12  FILLER                      PIC  X.                      ELCDTECX
  1404     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1405     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1406     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1407     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1408     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1409     12  DTE-R78                     PIC  X.                      ELCDTECX
  1410     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1411     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1412     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1413     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1414     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1415     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1416     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1417                                     PIC  X.                      ELCDTECX
  1418         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1419                                                 ' '.             ELCDTECX
  1420         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1421         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1422     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1423         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1424         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1425     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1426     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1427                                     PIC  9.                         CL**4
  1428     12  DTE-SYSTEM.                                              ELCDTECX
  1429         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1430         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1431         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1432         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1433         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1434         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1435         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1436         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1437         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1438         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1439         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1440         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1441         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1442         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1443         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1444         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1445         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1446         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1447         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1448         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1449         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1450         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1451         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1452         16  DTE-SYS-X               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  27
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1453         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1454         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1455     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1456         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1457                                     PIC  X.                      ELCDTECX
  1458     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1459                                                                  ELCDTECX
  1460 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1461     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1462     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1463     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1464*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1465     12  FILLER                      PIC  X.                      ELCDTECX
  1466     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1467     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1468     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1469     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1470     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1471     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1472     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1473                                                                  ELCDTECX
  1474     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1475     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1476     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1477     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1478                                                                  ELCDTECX
  1479     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1480     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1481     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1482     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1483                                                                  ELCDTECX
  1484     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1485     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1486                                                                  ELCDTECX
  1487     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1488     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1489                                                                  ELCDTECX
  1490     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1491                                                                  ELCDTECX
  1492 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1493     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1494     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1495     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1496     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1497     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1498     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1499     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1500                                                                  ELCDTECX
  1501 01  FILLER                          PIC  X(12)                   ELCDTECX
  1502                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1503 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1504     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1505         16  CNT-ID                  PIC  X.                      ELCDTECX
  1506         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1507                                                                  ELCDTECX
  1508 01  FILLER                          PIC  X(11)                   ELCDTECX
  1509                                          VALUE 'STATE NAMES'.    ELCDTECX
  1510 01  STATE-NAMES.                                                 ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  28
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1511     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1512         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1513         16  STATE-PIC1.                                          ELCDTECX
  1514             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1515             20  FILLER              PIC  XXX.                    ELCDTECX
  1516             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1517             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1518             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1519             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1520                                                                  ELCDTECX
  1521 01  FILLER                          PIC  X(13)                   ELCDTECX
  1522                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1523 01  CARRIER-NAMES.                                               ELCDTECX
  1524     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1525         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1526         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1527         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1528         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1529         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1530         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1531*        16  FILLER                  PIC  X.                      ELCDTECX
  1532         16  CARRIER-SEC-PAY         PIC  X.
  1533             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1534                                                                  ELCDTECX
  1535 01  FILLER                          PIC  X(9)                       CL**6
  1536                                          VALUE 'INS TYPES'.      ELCDTECX
  1537 01  CLAS-INS-TYPES.                                              ELCDTECX
  1538*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1539     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1540         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1541         16  CLAS-I-AB3.                                          ELCDTECX
  1542             20  FILLER              PIC  X.                      ELCDTECX
  1543             20  CLAS-I-AB2.                                      ELCDTECX
  1544                 24  FILLER          PIC  X.                      ELCDTECX
  1545                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1546         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1547             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1548             20  FILLER              PIC  X.                         CL**4
  1549         16  CLAS-I-AB10.                                         ELCDTECX
  1550             20  FILLER              PIC  X(9).                   ELCDTECX
  1551             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1552         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1553         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1554         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1555         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1556             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1557         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1558         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1559         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1560         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1561         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  1562         16  FILLER                  PIC  X(05).
  1563                                                                  ELCDTECX
  1564 01  FILLER                          PIC  X(16)                   ELCDTECX
  1565                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1566 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1567     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1568                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  29
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1569         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1570         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1571         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1572         16  CLAS-MORT-DESC.                                      ELCDTECX
  1573             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1574             20  FILLER              PIC  XX.                        CL**5
  1575             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1576             20  FILLER              PIC  X.                         CL**5
  1577             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1578             20  FILLER              PIC  X.                         CL**5
  1579             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1580             20  FILLER              PIC  X.                         CL**5
  1581             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1582             20  FILLER              PIC  X(5).                      CL**6
  1583                                                                  ELCDTECX
  1584 01  FILLER                          PIC  X(15)                   ELCDTECX
  1585                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1586 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1587     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1588         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1589         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1590         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1591         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1592         16  FILLER                  PIC  X(4).                      CL**6
  1593                                                                  ELCDTECX
  1594 01  FILLER                          PIC  X(7)                       CL**6
  1595                                     VALUE 'INDEXES'.             ELCDTECX
  1596 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1597     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1598     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1599     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1600     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1601     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1602     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1603     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1604     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1605     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1606     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1607     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1608     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1609     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1610     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1611     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1612     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1613     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1614                                                                  ELCDTECX
  1615 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1616     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1617     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1618     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1619     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1620     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1621     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1622     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1623     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1624     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1625     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1626     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  30
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1627                                                                  ELCDTECX
  1628 01  FILLER                          PIC  X(13)                   ELCDTECX
  1629                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1630 01  CLAS-MISC.                                                   ELCDTECX
  1631     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1632         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1633         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1634         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1635     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1636     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1637     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1638     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1639     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1640     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1641     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1642     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1643     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1644     12  STATE-L                     PIC  XX.                     ELCDTECX
  1645     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1646     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1647     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1648         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1649         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1650     12  DTE-ABEND-WORK.                                          ELCDTECX
  1651         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1652         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1653                                                                  ELCDTECX
  1654 01  FILLER                          PIC  X(12)                   ELCDTECX
  1655                                     VALUE 'WORKING DATE'.        ELCDTECX
  1656 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1657     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1658         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1659         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1660         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1661     12  WS-CURRENT-DATE.                                         ELCDTECX
  1662         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1663         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1664         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1665         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1666         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1667     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1668         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1669         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1670                                                                  ELCDTECX
  1671 01  FILLER                          PIC  X(12)                   ELCDTECX
  1672                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1673 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1674     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1675         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1676         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1677         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1678                                                                  ELCDTECX
  1679 01  FILLER                          PIC  X(10)                   ELCDTECX
  1680                                     VALUE 'STATE TLRS'.          ELCDTECX
  1681 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1682     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1683         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1684         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  31
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1685                                                                  ELCDTECX
  1686 01  FILLER                          PIC  X(13)                   ELCDTECX
  1687                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1688 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1689     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1690         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1691                                                                  ELCDTECX
  1692 01  FILLER                          PIC  X(13)                   ELCDTECX
  1693                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1694 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1695     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1696     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1697     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1698                                     PIC  X.                         CL**5
  1699     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1700     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1701     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1702     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1703     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1704     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1705     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1706     12  FILLER                      PIC  X(75).                  ELCDTECX
  1707******************************************************************ELCDTECX
  1708*01  MISC-CARR-PCT-DATA.                                          00001521
  1709*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1710*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1711*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1712*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1713*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1714*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1715******************************************************************ELCDTECX
* 1716 COPY ELCDTEVR.
  1717***************************************************************** 04/15/98
  1718*                                                                *ELCDTEVR
  1719*                                                                *ELCDTEVR
  1720*                            ELCDTEVR.                           *   LV003
  1721*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1722*                            VMOD=2.001                          *   CL**2
  1723*                                                                *ELCDTEVR
  1724*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1725*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1726*                                                                *ELCDTEVR
  1727******************************************************************ELCDTEVR
  1728 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1729     05  WS-RUN-DATE.                                             ELCDTEVR
  1730         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1731         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1732         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1733             15  RUN-CC              PIC  99.                     ELCDTEVR
  1734             15  RUN-YR              PIC  99.                     ELCDTEVR
  1735         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1736         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1737     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1738            WS-RUN-DATE              PIC 9(11).                      CL**2
  1739     05  WS-EP-DT.                                                ELCDTEVR
  1740         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1741         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1742         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  32
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1743             15  EP-CC               PIC  99.                     ELCDTEVR
  1744             15  EP-YR               PIC  99.                     ELCDTEVR
  1745         10  EP-MO                   PIC  99.                     ELCDTEVR
  1746         10  EP-DA                   PIC  99.                     ELCDTEVR
  1747     05  WS-EP-DT-N REDEFINES                                        CL**2
  1748            WS-EP-DT                 PIC 9(11).                      CL**2
  1749     05  WS-DTE-CONV-DT.                                             CL**4
  1750         10  FILLER                  PIC  9(03).                     CL**4
  1751         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1752         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1753             15  DTE-CONV-CC         PIC  99.                        CL**4
  1754             15  DTE-CONV-YR         PIC  99.                        CL**4
  1755         10  DTE-CONV-MO             PIC  99.                        CL**4
  1756         10  DTE-CONV-DA             PIC  99.                        CL**4
  1757     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1758            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1759 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1760     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1761         10  FILLER                            PIC 999.           ELCDTEVR
  1762         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1763         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1764             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1765             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1766         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1767         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1768     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1769            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1770     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1771         10  FILLER                            PIC 999.           ELCDTEVR
  1772         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1773         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1774         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1775         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1776     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1777            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1778 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1779     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1780         10  FILLER                            PIC 999.           ELCDTEVR
  1781         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1782         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1783             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1784             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1785         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1786         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1787     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1788            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1789     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1790         10  FILLER                            PIC 999.           ELCDTEVR
  1791         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1792         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1793             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1794             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1795         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1796         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1797     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1798            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1799     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1800         10  FILLER                            PIC 999.           ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  33
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1801         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1802         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1803             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1804             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1805         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1806         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1807     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1808            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1809 01  WS-RATE-RECORD.                                              ELCDTEVR
  1810         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1811             10  FILLER                        PIC 999.           ELCDTEVR
  1812             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1813             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1814                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1815                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1816             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1817             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1818         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1819                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1820
  1821 LINKAGE SECTION.
  1822
  1823 01  PARM.
  1824     05  PARM-LENGTH                  PIC S9(04) COMP.
  1825     05  CYCLE-DATE                   PIC X(08).
  1826
  1827
  1828
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  34
* FNB169.cbl
  1830
  1831 PROCEDURE DIVISION USING PARM.
  1832
  1833*************************************************************
* 1834 COPY ELCDTERX.
  1835******************************************************************04/15/98
  1836*                                                                *ELCDTERX
  1837*                                                                *ELCDTERX
  1838*                            ELCDTERX.                           *   LV002
  1839*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1840*                            VMOD=2.007                          *ELCDTERX
  1841*                                                                *ELCDTERX
  1842*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1843*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1844*      = ELCDTEFD)                                               *ELCDTERX
  1845*                                                                *ELCDTERX
  1846******************************************************************ELCDTERX
  1847                                                                  ELCDTERX
  1848     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1849                                                                  ELCDTERX
  1850     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1851     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1852     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1853                                                                  ELCDTERX
  1854     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1855                                                                  ELCDTERX
  1856******************************************************************ELCDTERX
  1857*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1858*          WARNING MESSAGES.                                      ELCDTERX
  1859******************************************************************ELCDTERX
  1860     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1861         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1862                                                                  ELCDTERX
  1863     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1864                                                                  ELCDTERX
  1865     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1866                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1867                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1868                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1869                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1870                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1871                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1872                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1873                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1874                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1875                                                                  ELCDTERX
  1876     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1877                                                                  ELCDTERX
  1878     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1879                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1880                                                                  ELCDTERX
  1881     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1882     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1883     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1884     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1885                                                                  ELCDTERX
  1886     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1887         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  35
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1888     ELSE                                                         ELCDTERX
  1889         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1890                                                                  ELCDTERX
  1891     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1892         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1893     ELSE                                                         ELCDTERX
  1894         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1895                                                                  ELCDTERX
  1896 0005-READ--CARD.                                                 ELCDTERX
  1897     READ DISK-DATE                                               ELCDTERX
  1898         AT END CLOSE DISK-DATE                                   ELCDTERX
  1899             GO TO 0060-READ--TEST.                               ELCDTERX
  1900                                                                  ELCDTERX
  1901     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1902                                                                  ELCDTERX
  1903     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1904         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1905         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1906         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1907         GO TO 0005-READ--CARD.                                   ELCDTERX
  1908                                                                  ELCDTERX
  1909     IF DD-ID = 'CLAD'                                            ELCDTERX
  1910         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1911         GO TO 0005-READ--CARD.                                   ELCDTERX
  1912                                                                  ELCDTERX
  1913     IF DD-ID = 'CLAX'                                            ELCDTERX
  1914         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1915         GO TO 0005-READ--CARD.                                   ELCDTERX
  1916                                                                  ELCDTERX
  1917     IF DD-ID = 'CLAF'                                            ELCDTERX
  1918         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1919         GO TO 0005-READ--CARD.                                   ELCDTERX
  1920                                                                  ELCDTERX
  1921     IF DD-ID = 'CLAC'                                            ELCDTERX
  1922         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1923                                                                  ELCDTERX
  1924     IF DD-ID = 'CARR'                                            ELCDTERX
  1925         GO TO 0015-READ--CARR.                                   ELCDTERX
  1926                                                                  ELCDTERX
  1927     IF DD-ID = 'STAT'                                            ELCDTERX
  1928         GO TO 0020-READ--STAT.                                   ELCDTERX
  1929                                                                  ELCDTERX
  1930     IF DD-ID = 'BUSC'                                            ELCDTERX
  1931         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1932                                                                  ELCDTERX
  1933     IF DD-ID = 'MORT'                                            ELCDTERX
  1934         GO TO 0030-READ--MORT.                                   ELCDTERX
  1935                                                                  ELCDTERX
  1936     IF DD-ID = 'CLAI'                                            ELCDTERX
  1937         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1938                                                                  ELCDTERX
  1939     IF DD-ID = 'COLC'                                            ELCDTERX
  1940         GO TO 0065-READ--COLC.                                   ELCDTERX
  1941                                                                  ELCDTERX
  1942     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1943        DD-IDA = 'CL'                                             ELCDTERX
  1944         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1945                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  36
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1946     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1947        DD-IDA = 'PO'                                             ELCDTERX
  1948         GO TO 0050-READ--POXX.                                   ELCDTERX
  1949                                                                  ELCDTERX
  1950     IF DD-ID = 'OPCA'                                            ELCDTERX
  1951         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1952                                                                  ELCDTERX
  1953     IF DD-ID = 'OPST'                                            ELCDTERX
  1954         GO TO 0072-READ--OPST.                                   ELCDTERX
  1955                                                                  ELCDTERX
  1956     IF DD-ID = 'OPBS'                                            ELCDTERX
  1957         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1958                                                                  ELCDTERX
  1959     IF DD-ID = 'OPMS'                                            ELCDTERX
  1960         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1961                                                                  ELCDTERX
  1962     GO TO 0005-READ--CARD.                                       ELCDTERX
  1963                                                                  ELCDTERX
  1964 0010-READ--CLAC.                                                 ELCDTERX
  1965     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1966     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1967     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1968     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1969     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1970     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1971     GO TO 0005-READ--CARD.                                       ELCDTERX
  1972                                                                  ELCDTERX
  1973 0015-READ--CARR.                                                 ELCDTERX
  1974     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1975     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1976        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1977        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1978        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1979        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1980        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1981        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1982        MOVE DD-CARR1-SECPAY-SW
  1983                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1984     END-IF
  1985                                                                  ELCDTERX
  1986     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1987     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1988        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1989        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1990        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1991        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1992        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1993        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1994        MOVE DD-CARR2-SECPAY-SW
  1995                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1996     END-IF
  1997                                                                  ELCDTERX
  1998                                                                  ELCDTERX
  1999     GO TO 0005-READ--CARD.                                       ELCDTERX
  2000                                                                  ELCDTERX
  2001 0020-READ--STAT.                                                 ELCDTERX
  2002     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2003     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  37
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2004        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2005         GO TO 0005-READ--CARD.                                   ELCDTERX
  2006                                                                  ELCDTERX
  2007     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2008     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2009     GO TO 0020-READ--STAT.                                       ELCDTERX
  2010                                                                  ELCDTERX
  2011 0025-READ--BUSC.                                                 ELCDTERX
  2012     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2013     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2014        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2015         GO TO 0005-READ--CARD.                                   ELCDTERX
  2016                                                                  ELCDTERX
  2017     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2018     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2019     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2020                                                                  ELCDTERX
  2021 0030-READ--MORT.                                                 ELCDTERX
  2022     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2023     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2024        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2025         GO TO 0005-READ--CARD.                                   ELCDTERX
  2026                                                                  ELCDTERX
  2027     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2028     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2029     GO TO 0030-READ--MORT.                                       ELCDTERX
  2030                                                                  ELCDTERX
  2031 0035-READ--CLXX.                                                 ELCDTERX
  2032     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2033          GO TO 0005-READ--CARD.                                  ELCDTERX
  2034                                                                  ELCDTERX
  2035     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2036         DISPLAY '***********************************************'ELCDTERX
  2037         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2038         DISPLAY '***********************************************'ELCDTERX
  2039         GO TO 0055-READ--STOP.                                   ELCDTERX
  2040                                                                  ELCDTERX
  2041     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2042        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2043         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2044                                                                  ELCDTERX
  2045     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2046        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2047         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2048                                                                  ELCDTERX
  2049*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2050     GO TO 0005-READ--CARD.                                       ELCDTERX
  2051                                                                  ELCDTERX
  2052 0040-READ--CLAI.                                                 ELCDTERX
  2053     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2054     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2055        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2056         GO TO 0005-READ--CARD.                                   ELCDTERX
  2057                                                                  ELCDTERX
  2058     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2059     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2060     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2061                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  38
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2062 0045-READ--DUMP.                                                 ELCDTERX
  2063     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2064     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2065                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2066     PERFORM ABEND-PGM.                                           ELCDTERX
  2067                                                                  ELCDTERX
  2068 0050-READ--POXX.                                                 ELCDTERX
  2069     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2070         GO TO 0005-READ--CARD.                                   ELCDTERX
  2071                                                                  ELCDTERX
  2072     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2073         DISPLAY '***********************************************'ELCDTERX
  2074         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2075         DISPLAY '***********************************************'ELCDTERX
  2076         GO TO 0055-READ--STOP.                                   ELCDTERX
  2077                                                                  ELCDTERX
  2078     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2079     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2080     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2081     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2082                                                                  ELCDTERX
  2083     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2084         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2085     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2086         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2087                                                                  ELCDTERX
  2088     GO TO 0005-READ--CARD.                                       ELCDTERX
  2089                                                                  ELCDTERX
  2090 0055-READ--STOP.                                                 ELCDTERX
  2091     GOBACK.                                                      ELCDTERX
  2092                                                                  ELCDTERX
  2093 0060-READ--TEST.                                                 ELCDTERX
  2094     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2095        CLAX-ID         = SPACE  OR                               ELCDTERX
  2096        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2097         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2098                                                                  ELCDTERX
  2099     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2100     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2101                                                                  ELCDTERX
  2102 0065-READ--COLC.                                                 ELCDTERX
  2103     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2104     GO TO 0005-READ--CARD.                                       ELCDTERX
  2105                                                                  ELCDTERX
  2106 0070-READ--OPCA.                                                 ELCDTERX
  2107                                                                  ELCDTERX
  2108     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2109                                                                  ELCDTERX
  2110     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2111             OR                                                   ELCDTERX
  2112         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2113         GO TO 0005-READ--CARD.                                   ELCDTERX
  2114                                                                  ELCDTERX
  2115     ADD 1                       TO INDEXCA.                      ELCDTERX
  2116     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2117                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2118     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2119                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  39
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2120 0072-READ--OPST.                                                 ELCDTERX
  2121                                                                  ELCDTERX
  2122     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2123                                                                  ELCDTERX
  2124     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2125             OR                                                   ELCDTERX
  2126         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2127         GO TO 0005-READ--CARD.                                   ELCDTERX
  2128                                                                  ELCDTERX
  2129     ADD 1                       TO INDEXST.                      ELCDTERX
  2130     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2131                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2132     GO TO 0072-READ--OPST.                                       ELCDTERX
  2133                                                                  ELCDTERX
  2134 0074-READ--OPBS.                                                 ELCDTERX
  2135                                                                  ELCDTERX
  2136     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2137                                                                  ELCDTERX
  2138     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2139             OR                                                   ELCDTERX
  2140         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2141         GO TO 0005-READ--CARD.                                   ELCDTERX
  2142                                                                  ELCDTERX
  2143     ADD 1                       TO INDEXBS.                      ELCDTERX
  2144     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2145     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2146                                                                  ELCDTERX
  2147 0079-READ--EXIT.                                                 ELCDTERX
  2148*    EXIT.                                                        ELCDTERX
  2149******************************************************************ELCDTERX
  2150*************************************************************
  2151     PERFORM 0000-HOUSEKEEPING       THRU 0000-EXIT
  2152
  2153     PERFORM 1000-PROCESS            THRU 1000-EXIT
  2154         UNTIL EOF-DETEXT
  2155
  2156     CLOSE DETEXTR
  2157           FREEDOM-EXTRACT
  2158           CSI-FREEDOM-EXTRACT
  2159           CCC-FREEDOM-EXTRACT
  2160           ERACCT
  2161     GOBACK.
  2162
  2163
  2164 1000-PROCESS.
  2165
  2166     PERFORM 1100-GET-LOGIC-RECORD   THRU 1100-EXIT
  2167          WITH TEST AFTER
  2168              UNTIL VALID-RECORD OR EOF-DETEXT
  2169
  2170     IF EOF-DETEXT
  2171         GO TO 1000-EXIT
  2172     END-IF
  2173
  2174*    IF DE-ADDL-CLP = +0
  2175*        GO TO 1000-EXIT
  2176*    END-IF
  2177
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  40
* FNB169.cbl
  2178     MOVE SPACES                     TO WS-EXTRACT-RECORD
  2179
  2180     MOVE 'LOGIC '                   TO FX-SOURCE-CODE
  2181     MOVE '11'                       TO FX-DIVISION
  2182     MOVE ' '                        TO FX-FY-REN
  2183
  2184     MOVE CYCLE-DATE                 TO FX-POSTING-DATE
  2185     MOVE DE-CERT                    TO FX-POLICY-NO
  2186
  2187     IF DE-CLP-STATE = SPACES
  2188        MOVE DE-STATE                TO DE-CLP-STATE
  2189     END-IF
  2190     MOVE DE-CLP-STATE               TO FX-STATE
  2191*    MOVE DE-STATE                   TO FX-STATE
  2192     MOVE 'Y'                        TO FX-LOC-CODE
  2193
  2194     PERFORM 1300-GET-ADDR           THRU 1300-EXIT
  2195
  2196*    DISPLAY ' CARRIER = ' DE-CARRIER
  2197*    MOVE '3'                    TO DE-CARRIER
  2198
  2199     IF DE-CARRIER = '3' OR '4'
  2200        MOVE 'CSIDCCFEES'        TO FX-SYSTEM
  2201     ELSE
  2202       IF DE-CARRIER = '5' OR '6'
  2203          MOVE 'CCCDCCFEES'      TO FX-SYSTEM
  2204          MOVE '50'              TO FX-DIVISION
  2205       ELSE
  2206        MOVE 'LPAC LOGIC'        TO FX-SYSTEM
  2207       END-IF
  2208     END-IF
  2209
  2210     MOVE DE-ACCT-PRIME              TO FX-AGENT-01
  2211     MOVE '6211'                     TO FX-COST-CENTER
  2212     MOVE ' '                        TO FX-DISTR
  2213     MOVE ' '                        TO FX-SOURCE-ACCT
  2214     MOVE ' '                        TO FX-REFERENCE
  2215
  2216     MOVE +1                         TO AGT-LEVEL
  2217
  2218
  2219     PERFORM UNTIL AGT-LEVEL > +10
  2220
  2221*    DISPLAY 'DE CERT ' DE-CERT
  2222*    DISPLAY 'AGT LEVEL ' AGT-LEVEL
  2223*    DISPLAY 'DE-AGT ' DE-AGT (AGT-LEVEL)
  2224*    DISPLAY 'DE-AGT-TYPE ' DE-AGT-TYPE (AGT-LEVEL)
  2225*    DISPLAY 'DE-TRAN ' DE-TRANS
  2226     MOVE DE-L-PC (AGT-LEVEL) TO TEST-DISP-L-PC
  2227*    DISPLAY 'DE-L-PC ' TEST-DISP-L-PC
  2228     MOVE DE-A-PC (AGT-LEVEL) TO TEST-DISP-A-PC
  2229*    DISPLAY 'DE-A-PC ' TEST-DISP-A-PC
  2230
  2231         EVALUATE DE-TRANS
  2232          WHEN 'I'
  2233            EVALUATE TRUE
  2234              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2235                MOVE 'ISSUE INCENTIVE'     TO FX-DESCRIPTION
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  41
* FNB169.cbl
  2236                MOVE '01'                  TO FX-SUB-TYPE
  2237                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2238                                    * -1
  2239                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2240                MOVE '70'                  TO FX-TRAN-TYPE
  2241                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2242                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2243                MOVE '90'                  TO FX-TRAN-TYPE
  2244                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2245
  2246              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2247                MOVE 'ISSUE LMBA FEE'      TO FX-DESCRIPTION
  2248                MOVE '01'                  TO FX-SUB-TYPE
  2249                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2250                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2251                                    * -1
  2252                ELSE
  2253                   COMPUTE WS-LF-WORK ROUNDED = DE-REI-LFPRM *
  2254                      DE-L-PC (AGT-LEVEL)
  2255                   COMPUTE WS-AH-WORK ROUNDED = DE-REI-AHPRM *
  2256                      DE-A-PC (AGT-LEVEL)
  2257                   COMPUTE FX-AMOUNT ROUNDED = (WS-LF-WORK +
  2258                      WS-AH-WORK) * -1
  2259                END-IF
  2260                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2261                MOVE '75'                  TO FX-TRAN-TYPE
  2262                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2263                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2264                MOVE '95'                  TO FX-TRAN-TYPE
  2265                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2266
  2267              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2268                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2269                MOVE 'ISSUE CONTRACT FEE'  TO FX-DESCRIPTION
  2270                MOVE '01'                  TO FX-SUB-TYPE
  2271                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2272                                    * -1
  2273                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2274                MOVE '72'                  TO FX-TRAN-TYPE
  2275                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2276                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2277                MOVE '92'                  TO FX-TRAN-TYPE
  2278                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2279
  2280              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'N')
  2281                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2282                MOVE 'ISSUE CSO ADMIN FEE'  TO FX-DESCRIPTION
  2283                MOVE '01'                  TO FX-SUB-TYPE
  2284                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2285                                    * -1
  2286                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2287                MOVE '77'                  TO FX-TRAN-TYPE
  2288                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2289                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2290                MOVE '97'                  TO FX-TRAN-TYPE
  2291                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2292            END-EVALUATE
  2293          WHEN '8'
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  42
* FNB169.cbl
  2294            EVALUATE TRUE
  2295              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2296                MOVE 'ISSUE RC-L INCENTIVE'
  2297                                           TO FX-DESCRIPTION
  2298                MOVE '01'                  TO FX-SUB-TYPE
  2299                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2300                                    * -1
  2301                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2302                MOVE '70'                  TO FX-TRAN-TYPE
  2303                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2304                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2305                MOVE '90'                  TO FX-TRAN-TYPE
  2306                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2307
  2308              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2309                MOVE 'ISSUE RC-L LMBA FEE' TO FX-DESCRIPTION
  2310                MOVE '01'                  TO FX-SUB-TYPE
  2311                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2312                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2313                                    * -1
  2314                ELSE
  2315                   COMPUTE FX-AMOUNT ROUNDED = ((DE-REI-LFPRM
  2316                      * DE-L-PC (AGT-LEVEL)) + (DE-REI-AHPRM
  2317                      * DE-A-PC (AGT-LEVEL))) * -1
  2318                END-IF
  2319                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2320                MOVE '75'                  TO FX-TRAN-TYPE
  2321                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2322                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2323                MOVE '95'                  TO FX-TRAN-TYPE
  2324                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2325
  2326              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2327                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2328                MOVE 'ISSUE RC-L CONTRACT FEE'
  2329                                           TO FX-DESCRIPTION
  2330                MOVE '01'                  TO FX-SUB-TYPE
  2331                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2332                                    * -1
  2333                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2334                MOVE '72'                  TO FX-TRAN-TYPE
  2335                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2336                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2337                MOVE '92'                  TO FX-TRAN-TYPE
  2338                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2339
  2340            END-EVALUATE
  2341          WHEN 'C'
  2342            EVALUATE TRUE
  2343              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I'
  2344                MOVE 'CANCEL MGT FEE  '    TO FX-DESCRIPTION
  2345                MOVE '01'                  TO FX-SUB-TYPE
  2346                COMPUTE A-OW = DE-A-PC (AGT-LEVEL) * 1000
  2347                PERFORM 2530-CALC-DDF-FEES THRU 2530-EXIT
  2348                move cnc-wk to fx-amount
  2349                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2350                MOVE '70'                  TO FX-TRAN-TYPE
  2351                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  43
* FNB169.cbl
  2352                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2353                MOVE '90'                  TO FX-TRAN-TYPE
  2354                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2355              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'J'
  2356                MOVE 'CANCEL SLS MKT  '    TO FX-DESCRIPTION
  2357                MOVE '01'                  TO FX-SUB-TYPE
  2358                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2359                IF DE-CANCEL-REASON = 'R'
  2360                   MOVE +1      TO WS-CNC-FACT
  2361                END-IF
  2362                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2363                                    * WS-CNC-FACT
  2364                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2365                MOVE '70'                  TO FX-TRAN-TYPE
  2366                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2367                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2368                MOVE '90'                  TO FX-TRAN-TYPE
  2369                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2370
  2371              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2372                MOVE 'CANCEL LMBA FEE'     TO FX-DESCRIPTION
  2373                MOVE '01'                  TO FX-SUB-TYPE
  2374                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2375                   IF DE-AH-PRM NOT = ZEROS
  2376                      COMPUTE WS-CNC-FACT ROUNDED = DE-AH-RFND /
  2377                         DE-AH-PRM
  2378                      IF DE-CANCEL-REASON = 'R'
  2379                         MOVE +1 TO WS-CNC-FACT
  2380                      END-IF
  2381                      COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL)
  2382                         * 1000 * WS-CNC-FACT
  2383                   END-IF
  2384                ELSE
  2385                   MOVE ZEROS   TO WS-WORK-AMT
  2386                   IF DE-LF-PRM NOT = ZEROS
  2387                      COMPUTE WS-CNC-FACT ROUNDED = DE-LF-RFND /
  2388                         DE-LF-PRM
  2389                      COMPUTE WS-WORK-AMT ROUNDED =
  2390                        (DE-L-PC (AGT-LEVEL) * DE-REI-LFPRM)
  2391                          * WS-CNC-FACT
  2392                   END-IF
  2393                   IF DE-AH-PRM NOT = ZEROS
  2394                      COMPUTE WS-CNC-FACT ROUNDED = DE-AH-RFND /
  2395                         DE-AH-PRM
  2396                      COMPUTE WS-WORK-AMT ROUNDED = WS-WORK-AMT +
  2397                     ((DE-A-PC (AGT-LEVEL) * DE-REI-AHPRM)
  2398                        * WS-CNC-FACT)
  2399                   END-IF
  2400                   MOVE WS-WORK-AMT TO FX-AMOUNT
  2401                END-IF
  2402                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2403                MOVE '75'                  TO FX-TRAN-TYPE
  2404                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2405                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2406                MOVE '95'                  TO FX-TRAN-TYPE
  2407                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2408
  2409              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  44
* FNB169.cbl
  2410                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2411                MOVE 'CANCEL CONTRACT FEE' TO FX-DESCRIPTION
  2412                MOVE '01'                  TO FX-SUB-TYPE
  2413                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2414                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2415                                    * WS-CNC-FACT
  2416                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2417                MOVE '72'                  TO FX-TRAN-TYPE
  2418                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2419                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2420                MOVE '92'                  TO FX-TRAN-TYPE
  2421                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2422
  2423              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'N')
  2424                AND (DE-A-PC (AGT-LEVEL) NOT = ZEROS)
  2425                MOVE 'CANCEL CSO ADMIN FEE' TO FX-DESCRIPTION
  2426                MOVE '01'                  TO FX-SUB-TYPE
  2427
  2428                COMPUTE A-OW = DE-A-PC (AGT-LEVEL) * 1000
  2429                PERFORM 2530-CALC-DDF-FEES THRU 2530-EXIT
  2430
  2431                MOVE CNC-WK      TO FX-AMOUNT
  2432                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2433                MOVE '77'                  TO FX-TRAN-TYPE
  2434                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2435                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2436                MOVE '97'                  TO FX-TRAN-TYPE
  2437                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2438
  2439            END-EVALUATE
  2440          WHEN '7'
  2441            EVALUATE TRUE
  2442              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2443                MOVE 'CANCEL RC-L INCENTIVE'
  2444                                           TO FX-DESCRIPTION
  2445                MOVE '01'                  TO FX-SUB-TYPE
  2446                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2447                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2448                                    * WS-CNC-FACT
  2449                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2450                MOVE '70'                  TO FX-TRAN-TYPE
  2451                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2452                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2453                MOVE '90'                  TO FX-TRAN-TYPE
  2454                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2455
  2456              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2457                MOVE 'CANCEL RC-L LMBA FEE'
  2458                                           TO FX-DESCRIPTION
  2459                MOVE '01'                  TO FX-SUB-TYPE
  2460                IF DE-AH-PRM NOT = ZEROS
  2461                   COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2462                ELSE
  2463                   MOVE ZEROS   TO WS-CNC-FACT
  2464                END-IF
  2465                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2466                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2467                                    * WS-CNC-FACT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  45
* FNB169.cbl
  2468                ELSE
  2469                   COMPUTE WS-WORK-AMT = (DE-A-PC (AGT-LEVEL) *
  2470                      DE-REI-AHPRM)  * WS-CNC-FACT
  2471                   IF DE-LF-PRM NOT = ZEROS
  2472                      COMPUTE WS-LF-CNC-FACT = DE-LF-RFND /
  2473                         DE-LF-PRM
  2474                      COMPUTE FX-AMOUNT ROUNDED = WS-WORK-AMT +
  2475                       ((DE-L-PC (AGT-LEVEL) * DE-REI-LFPRM)
  2476                          * WS-LF-CNC-FACT)
  2477                   END-IF
  2478                END-IF
  2479                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2480                MOVE '75'                  TO FX-TRAN-TYPE
  2481                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2482                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2483                MOVE '95'                  TO FX-TRAN-TYPE
  2484                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2485
  2486              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2487                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2488                MOVE 'CANCEL RC-L CONTRACT FEE'
  2489                                           TO FX-DESCRIPTION
  2490                MOVE '01'                  TO FX-SUB-TYPE
  2491                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2492                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2493                                    * WS-CNC-FACT
  2494                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2495                MOVE '72'                  TO FX-TRAN-TYPE
  2496                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2497                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2498                MOVE '92'                  TO FX-TRAN-TYPE
  2499                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2500            END-EVALUATE
  2501         END-EVALUATE
  2502         MOVE FX-AMOUNT TO TEST-DISP-FX-AMT
  2503*        DISPLAY 'FX AMT ' TEST-DISP-FX-AMT
  2504*        DISPLAY ' '
  2505
  2506         ADD +1                      TO AGT-LEVEL
  2507     END-PERFORM
  2508
  2509     .
  2510 1000-EXIT.
  2511     EXIT.
  2512
  2513 1010-WRITE-EXTRACT.
  2514
  2515     IF DE-CARRIER = '3' OR '4'
  2516        WRITE CSI-EXTRACT-RECORD
  2517                     FROM WS-EXTRACT-RECORD
  2518     ELSE
  2519       IF DE-CARRIER = '5' OR '6'
  2520          WRITE CCC-EXTRACT-RECORD FROM
  2521                WS-EXTRACT-RECORD
  2522       ELSE
  2523        WRITE EXTRACT-RECORD
  2524                     FROM WS-EXTRACT-RECORD
  2525       END-IF
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  46
* FNB169.cbl
  2526     END-IF
  2527
  2528     .
  2529 1010-EXIT.
  2530     EXIT.
  2531
  2532 1100-GET-LOGIC-RECORD.
  2533
  2534     MOVE '0'                        TO VALID-RECORD-SW
  2535     READ DETEXTR
  2536         AT END GO TO 1100-EXIT
  2537     END-READ
  2538
  2539     IF DE-REIN NOT = SPACE
  2540         GO TO 1100-EXIT
  2541     END-IF
  2542
  2543     IF DE-TRANS = 'I' OR 'C' OR '7' OR '8'
  2544         CONTINUE
  2545     ELSE
  2546         GO TO 1100-EXIT
  2547     END-IF
  2548
  2549     IF DE-ENTRY-STATUS = 'M'
  2550        GO TO 1100-EXIT
  2551     END-IF
  2552
  2553     IF (DE-TRANS = 'I' OR '8')
  2554       AND (DE-ENTRY-STATUS = '3' OR '5')
  2555         GO TO 1100-EXIT
  2556     END-IF
  2557
  2558     IF (DE-LF-TYPE = ZERO)  AND
  2559        (DE-AH-TYPE = ZERO)
  2560           GO TO 1100-EXIT
  2561     END-IF
  2562
  2563     SET VALID-RECORD TO TRUE
  2564
  2565     .
  2566 1100-EXIT.
  2567     EXIT.
  2568
  2569
  2570 1300-GET-ADDR.
  2571
  2572     MOVE DE-COMPANY-CD          TO AM-COMPANY-CD
  2573     MOVE DE-CNTRL1              TO AM-CNTRL-1
  2574     MOVE DE-EFF                 TO AM-EXPIRE-DT
  2575
  2576     START ERACCT KEY >= AM-CONTROL-PRIMARY
  2577
  2578     IF ERACCT-STATUS NOT = '00'
  2579         DISPLAY 'ERROR ON ERACCT START ' ERACCT-STATUS
  2580         GO TO 1300-EXIT
  2581     END-IF
  2582
  2583     MOVE '0' TO END-OF-SEARCH-SW
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  47
* FNB169.cbl
  2584     MOVE ' '                    TO WS-DCC-PRODUCT-CODE
  2585
  2586     PERFORM UNTIL END-OF-SEARCH
  2587        READ ERACCT NEXT
  2588
  2589        IF ERACCT-STATUS = '00'
  2590           IF (AM-COMPANY-CD = DE-COMPANY-CD)
  2591              AND (AM-CNTRL-1 = DE-CNTRL1)
  2592              MOVE SPACES        TO FX-CITY
  2593              STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  2594                DELIMITED BY '  ' INTO FX-CITY
  2595              END-STRING
  2596              MOVE AM-ZIP        TO FX-ZIP-CODE
  2597              IF (DE-EFF >= AM-EFFECT-DT)
  2598                 AND (DE-EFF < AM-EXPIRE-DT)
  2599                 MOVE AM-DCC-PRODUCT-CODE
  2600                                 TO WS-DCC-PRODUCT-CODE
  2601              END-IF
  2602           ELSE
  2603              SET END-OF-SEARCH  TO TRUE
  2604           END-IF
  2605        ELSE
  2606           DISPLAY 'ERACCT READ NEXT STATUS ' ERACCT-STATUS
  2607           SET END-OF-SEARCH     TO TRUE
  2608        END-IF
  2609     END-PERFORM
  2610
  2611     MOVE FX-CITY                    TO FNX001-DATA
  2612     CALL 'FNX001' USING FNX001-PARMS
  2613     MOVE FNX001-CITY                TO FX-CITY
  2614
  2615     .
  2616 1300-EXIT.
  2617     EXIT.
  2618
  2619
  2620 1400-OTHER-FX-DATA.
  2621
  2622     IF FX-STATE NOT= SPACES
  2623         SEARCH ALL STATE-TABLE
  2624             AT END DISPLAY 'INVALID STATE CODE: ' FX-STATE
  2625             WHEN ST-STATE (ST-INDEX) = FX-STATE
  2626                 MOVE ST-ALT-STATE (ST-INDEX) TO FX-STATE
  2627         END-SEARCH
  2628     END-IF
  2629
  2630     MOVE SYSTEM-DATE                TO FX-JOURNAL-DATE
  2631
  2632**** THE '*' IN POSITION 250 ENSURES A 250 BYTE RECORD IS PASSED
  2633**** TO FREEDOM - PREVENTS TRUNCATION OF BLANK FIELDS
  2634     MOVE '*'                        TO WS-EXTRACT-RECORD(250:1)
  2635
  2636     .
  2637 1400-EXIT.
  2638     EXIT.
  2639
  2640 2520-REF-CSO-ADMIN-FEE.
  2641
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  48
* FNB169.cbl
  2642     IF DE-CERT-NO = WS-FACT-CERT
  2643        CONTINUE
  2644     ELSE
  2645        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2646     END-IF
  2647
  2648     MOVE ZEROS                  TO CNC-WK
  2649
  2650     EVALUATE TRUE
  2651        WHEN (DE-DCC-DDF-REM-TRM3 = 0)
  2652           OR (DE-CANCEL-REASON = 'R')
  2653           DISPLAY ' REM TERM = 0 OR REPO'
  2654           MOVE 0                TO CNC-WK
  2655
  2656        when de-ah-rfnd = de-ah-prm
  2657           display ' full refund '
  2658           move a-ow             to cnc-wk
  2659        WHEN DE-DCC-DDF-REM-TRM3 = DE-AH-TERM
  2660           DISPLAY ' REM TERM  = ORIG TERM '
  2661           MOVE A-OW             TO CNC-WK
  2662
  2663        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4
  2664           DISPLAY ' ORIG TERM - REM TRM < 4 '
  2665           COMPUTE W-FACTOR ROUNDED = A-OW -
  2666              (DD-1ST-YR-ALLOW (D1)
  2667              * WS-MONTH / 3) - (A-OW - DD-1ST-YR-ALLOW (D1))
  2668              * (1 - WS-HI-UEF) * WS-MONTH / 12
  2669           COMPUTE CNC-WK = W-FACTOR * 1
  2670
  2671**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
  2672
  2673        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13
  2674           DISPLAY ' ORIG TERM - REM TRM < 13 '
  2675           COMPUTE W-FACTOR ROUNDED = (a-ow -
  2676              DD-1ST-YR-ALLOW (D1))
  2677              - (a-ow - DD-1ST-YR-ALLOW (D1))
  2678              * (1 - WS-hi-UEF) * ws-MONTH / 12
  2679           COMPUTE CNC-WK = W-FACTOR * 1
  2680
  2681****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
  2682
  2683        WHEN OTHER
  2684           DISPLAY ' OTHER '
  2685           COMPUTE W-FACTOR ROUNDED = (a-ow -
  2686              DD-1ST-YR-ALLOW (D1))
  2687              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
  2688              * ws-MONTH / 12)
  2689           COMPUTE CNC-WK = W-FACTOR * 1
  2690     END-EVALUATE
  2691
  2692     .
  2693 2520-EXIT.
  2694     EXIT.
  2695
  2696 2530-CALC-DDF-FEES.
  2697
  2698*****   THIS PARA IS ONLY FOR COMM TYPES N AND I
  2699*****   DCC DDF REFUNDS ONLY
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  49
* FNB169.cbl
  2700
  2701     IF DE-CERT-NO = WS-FACT-CERT
  2702        CONTINUE
  2703     ELSE
  2704        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2705     END-IF
  2706
  2707     COMPUTE WS-MONTH =
  2708        FUNCTION REM(DE-AH-TERM - DE-DCC-DDF-REM-TRM3, 12)
  2709     IF WS-MONTH = 0
  2710        MOVE 12 TO WS-MONTH
  2711     END-IF
  2712     DISPLAY ' WS MONTH ' WS-MONTH
  2713
  2714     EVALUATE TRUE
  2715        WHEN DE-AGT-TYPE (AGT-LEVEL) = 'N'
  2716           PERFORM 2520-REF-CSO-ADMIN-FEE
  2717                                 THRU 2520-EXIT
  2718        WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'I')
  2719           AND (DE-CANCEL-REASON = 'R')
  2720              MOVE A-OW TO CNC-WK
  2721        WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'I')
  2722           EVALUATE TRUE
  2723              WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4)
  2724                 OR (NOT DD-IU-PRESENT)
  2725                 COMPUTE WS-CNC-FACT = DE-REI-AHRFND /
  2726                   DE-REI-AHPRM
  2727                 COMPUTE CNC-WK ROUNDED = WS-CNC-FACT * A-OW
  2728               WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13)
  2729                  AND (DD-IU-PRESENT)
  2730                  COMPUTE WS-CLP-MO3 = DE-REI-AHPRM -
  2731                     (DE-REI-AHPRM -
  2732                     DE-IU-RATE-UP) * (WS-HI-UEF -
  2733                     WS-LO-UEF) * 3 / 12
  2734                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
  2735                  COMPUTE WS-CNC-FACT = WS-CLP-MO3 / DE-REI-AHPRM
  2736                  COMPUTE WS-COMM-MO3 ROUNDED = WS-CNC-FACT
  2737                   * A-OW
  2738                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
  2739                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
  2740                    A-OW * WS-HI-UEF) * (WS-MONTH - 3) / 9
  2741              WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) > 12
  2742                 COMPUTE CNC-WK = A-OW *
  2743                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
  2744                    WS-MONTH / 12)
  2745           END-EVALUATE
  2746           DISPLAY ' CSO REF MGT FEE ' DE-CERT-NO ' ' CNC-WK
  2747     END-EVALUATE
  2748
  2749     .
  2750 2530-EXIT.
  2751     EXIT.
  2752
  2753 2540-CALC-DDF-COMM.
  2754
  2755     IF DE-CERT-NO = WS-FACT-CERT
  2756        DISPLAY ' FACTORS ALREADY BUILT IN 2540 ' DE-CERT-NO
  2757     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  50
* FNB169.cbl
  2758        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2759     END-IF
  2760
  2761     COMPUTE WS-MONTH =
  2762        FUNCTION REM(DE-AH-TERM - DE-DCC-DDF-REM-TRM3, 12)
  2763     IF WS-MONTH = 0
  2764        MOVE 12 TO WS-MONTH
  2765     END-IF
  2766     DISPLAY ' WS MONTH ' WS-MONTH
  2767
  2768     EVALUATE TRUE
  2769        WHEN DE-CANCEL-REASON = 'R'
  2770           MOVE A-OW             TO CNC-WK
  2771        WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4)
  2772           OR (NOT DD-IU-PRESENT)
  2773              COMPUTE WS-CNC-FACT = DE-REI-AHRFND / DE-REI-AHPRM
  2774              COMPUTE CNC-WK = WS-CNC-FACT * A-OW
  2775        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13
  2776            COMPUTE WS-CLP-MO3 = DE-REI-AHPRM - (DE-REI-AHPRM -
  2777               DE-IU-RATE-UP) * (WS-HI-UEF -
  2778               WS-LO-UEF) * 3 / 12
  2779            DISPLAY ' UECLPMO3 ' WS-CLP-MO3
  2780            COMPUTE WS-CNC-FACT = WS-CLP-MO3 / DE-REI-AHPRM
  2781            COMPUTE WS-COMM-MO3 ROUNDED = WS-CNC-FACT * A-OW
  2782            DISPLAY ' UECOMMO3 ' WS-COMM-MO3
  2783            COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
  2784              A-OW * WS-HI-UEF) * (WS-MONTH - 3) / 9
  2785        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) > 12
  2786           COMPUTE CNC-WK = a-ow * (WS-HI-UEF - (WS-HI-UEF -
  2787              WS-LO-UEF) * ws-MONTH / 12)
  2788     END-EVALUATE
  2789
  2790     DISPLAY ' CSO REF comm    ' DE-CERT-NO ' ' CNC-WK
  2791
  2792     .
  2793 2540-EXIT.
  2794     EXIT.
  2795
  2796 2550-GET-DDF-FACTORS.
  2797
  2798     MOVE ZEROS                  TO CNC-WK
  2799                                    WS-LO-UEF WS-HI-UEF
  2800     move ' '                    to dd-iu-sw
  2801     if de-clp-state = spaces
  2802        move de-state            to de-clp-state
  2803     end-if
  2804
  2805     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
  2806        ((DE-clp-STATE = DD-STATE (D1))
  2807        and (WS-DCC-PRODUCT-CODE = dd-product-cd (d1))
  2808*       AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
  2809        AND ('A'           = DD-BEN-TYPE   (D1))
  2810        AND (DE-AH-TYPE    = DD-BEN-CODE   (D1))
  2811        AND (DE-EFF        < DD-PROD-EXP-DT (D1)))
  2812                        OR
  2813        D1 > max-pdef
  2814     END-PERFORM
  2815     IF D1 > max-pdef
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  51
* FNB169.cbl
  2816        DISPLAY ' COULD NOT FIND UEP FACTORS '
  2817        GO TO 2550-EXIT
  2818     END-IF
  2819
  2820     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  2821        (P1 > +8)
  2822        OR (DD-PROD-CODE (D1 P1) = 'I')
  2823     END-PERFORM
  2824     IF P1 < +9
  2825        display ' setting iu present to true '
  2826        SET DD-IU-PRESENT        TO TRUE
  2827     END-IF
  2828
  2829     MOVE DE-AH-TERM             TO WS-DDF-TERM
  2830
  2831     IF (DE-LOAN-TERM > WS-DDF-TERM)
  2832        AND (DD-TRUNCATED (D1) = 'Y')
  2833        MOVE DE-LOAN-TERM        TO WS-DDF-TERM
  2834        DISPLAY ' FOUND TRUNCATED ' DE-CERT-NO
  2835     END-IF
  2836
  2837     EVALUATE TRUE
  2838        WHEN WS-DDF-TERM > +168
  2839           MOVE 15               TO P1
  2840        WHEN WS-DDF-TERM > +156
  2841           MOVE 14               TO P1
  2842        WHEN WS-DDF-TERM > +144
  2843           MOVE 13               TO P1
  2844        WHEN WS-DDF-TERM > +132
  2845           MOVE 12               TO P1
  2846        WHEN WS-DDF-TERM > +120
  2847           MOVE 11               TO P1
  2848        WHEN WS-DDF-TERM > +108
  2849           MOVE 10               TO P1
  2850        WHEN WS-DDF-TERM > +96
  2851           MOVE 9                TO P1
  2852        WHEN WS-DDF-TERM > +84
  2853           MOVE 8                TO P1
  2854        WHEN WS-DDF-TERM > +72
  2855           MOVE 7                TO P1
  2856        WHEN WS-DDF-TERM > +60
  2857           MOVE 6                TO P1
  2858        WHEN WS-DDF-TERM > +48
  2859           MOVE 5                TO P1
  2860        WHEN WS-DDF-TERM > +36
  2861           MOVE 4                TO P1
  2862        WHEN WS-DDF-TERM > +24
  2863           MOVE 3                TO P1
  2864        WHEN WS-DDF-TERM > +12
  2865           MOVE 2                TO P1
  2866        WHEN OTHER
  2867           MOVE 1                TO P1
  2868     END-EVALUATE
  2869
  2870     EVALUATE TRUE
  2871*       WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +13)
  2872*          and (dd-iu-present)
  2873*          MOVE 2                TO P2
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  52
* FNB169.cbl
  2874*       WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +13
  2875*          MOVE 1                TO P2
  2876        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +25
  2877           MOVE 2                TO P2
  2878        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +37
  2879           MOVE 3                TO P2
  2880        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +49
  2881           MOVE 4                TO P2
  2882        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +61
  2883           MOVE 5                TO P2
  2884        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +73
  2885           MOVE 6                TO P2
  2886        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +85
  2887           MOVE 7                TO P2
  2888        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +97
  2889           MOVE 8                TO P2
  2890        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +109
  2891           MOVE 9                TO P2
  2892        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +121
  2893           MOVE 10               TO P2
  2894        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +133
  2895           MOVE 11               TO P2
  2896        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +145
  2897           MOVE 12               TO P2
  2898        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +157
  2899           MOVE 13               TO P2
  2900        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +169
  2901           MOVE 14               TO P2
  2902        WHEN OTHER
  2903           MOVE 15               TO P2
  2904     END-EVALUATE
  2905
  2906     MOVE DE-CERT-NO             TO WS-FACT-CERT
  2907     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
  2908                                 TO WS-LO-UEF
  2909     MOVE DD-UEP-FACTOR (D1 P1 P2)
  2910                                 TO WS-HI-UEF
  2911
  2912     .
  2913 2550-EXIT.
  2914     EXIT.
  2915
  2916 0000-HOUSEKEEPING.
  2917
  2918     CALL 'DATEEDIT' USING CYCLE-DATE,  DATE-SW
  2919     IF NOT VALID-DATE
  2920         DISPLAY 'INVALID DATE PARAMETER: ' CYCLE-DATE
  2921         PERFORM ABEND-PGM           THRU ABEND-EXIT
  2922     END-IF
  2923
  2924     MOVE FUNCTION CURRENT-DATE      TO FUNCTION-DATE
  2925     MOVE WS-FN-MO                   TO SYS-MO
  2926     MOVE WS-FN-DA                   TO SYS-DA
  2927     MOVE WS-FN-CCYR                 TO SYS-CCYY
  2928
  2929     OPEN INPUT  ERACCT ERPDEF
  2930                 DETEXTR
  2931          OUTPUT FREEDOM-EXTRACT CSI-FREEDOM-EXTRACT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  53
* FNB169.cbl
  2932                 CCC-FREEDOM-EXTRACT
  2933
  2934     IF ERACCT-STATUS = '00' OR '97'
  2935         CONTINUE
  2936     ELSE
  2937         DISPLAY 'OPEN ERROR ' ERACCT-STATUS ' ON ERACCT'
  2938     END-IF
  2939
  2940     IF ERPDEF-FILE-STATUS = '00' OR '97'
  2941         CONTINUE
  2942     ELSE
  2943         DISPLAY 'OPEN ERROR ' ERPDEF-FILE-STATUS ' ON ERPDEF'
  2944     END-IF
  2945
  2946     IF DTE-CLIENT = 'DCC'
  2947        MOVE 0 TO B-SUB
  2948        MOVE DTE-CLASIC-COMPANY-CD
  2949                                 TO PD-CONTROL-PRIMARY
  2950        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  2951        IF ERPDEF-FILE-STATUS = '00'
  2952           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  2953              READ ERPDEF NEXT RECORD
  2954              IF ERPDEF-FILE-STATUS = '00'
  2955                 ADD 1 TO B-SUB
  2956                 IF B-SUB > max-pdef
  2957                    DISPLAY ' DDF UEP TABLE BLEW '
  2958                    GO TO ABEND-PGM
  2959                 END-IF
  2960                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  2961                 MOVE PD-PRODUCT-CD
  2962                                 TO DD-PRODUCT-CD (B-SUB)
  2963                 MOVE PD-BEN-TYPE
  2964                                 TO DD-BEN-TYPE (B-SUB)
  2965                 MOVE PD-BEN-CODE
  2966                                 TO DD-BEN-CODE (B-SUB)
  2967                 MOVE PD-PROD-EXP-DT
  2968                                 TO DD-PROD-EXP-DT (B-SUB)
  2969                 MOVE PD-1ST-YR-ADMIN-ALLOW
  2970                                 TO DD-1ST-YR-ALLOW (B-SUB)
  2971                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  2972                    P2 > +8
  2973                    MOVE PD-PROD-CODE (P2)
  2974                                 TO DD-PROD-CODE (B-SUB P2)
  2975                 END-PERFORM
  2976                 MOVE PD-EARN-FACTORS
  2977                                 TO DD-EARN-FACTORS (B-SUB)
  2978                 move pd-truncated to dd-truncated (b-sub)
  2979              END-IF
  2980           END-PERFORM
  2981        DISPLAY ' DCC PRODUCT DEF TABLE LOADED SUCCESSFULLY '
  2982        END-IF
  2983        CLOSE ERPDEF
  2984     END-IF
  2985
  2986     .
  2987 0000-EXIT.
  2988     EXIT.
  2989
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  54
* FNB169.cbl
  2990
  2991 ABEND-PGM SECTION.
  2992     DIVIDE WS-ZERO BY WS-ZERO       GIVING WS-ZERO.
  2993 ABEND-EXIT.
  2994
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:     3575132     Code:       11816
