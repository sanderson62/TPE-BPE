* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   1
* EL517.cbl
* Options: int("EL517.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL517.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL517.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL517.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL517 .
     5*              PROGRAM CONVERTED BY
     6*              COBOL CONVERSION AID PO 5785-ABJ
     7*              CONVERSION DATE 06/08/94 08:12:06.
     8*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     9*                            VMOD=2.040.
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   2
* EL517.cbl
    14*DATE-COMPILED.
    15
    16*SECURITY.   *****************************************************
    17*            *                                                   *
    18*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    19*            *                                                   *
    20*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    21*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    22*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    23*            *                                                   *
    24*            *****************************************************
    25
    26*REMARKS.
    27*          THIS PROGRAM IS THE BATCH EDIT ROUTINE
    28*          FOR THE ON-LINE CREDIT SYSTEM PENDING BUSINESS
    29******************************************************************
    30*                   C H A N G E   L O G
    31*
    32* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    33*-----------------------------------------------------------------
    34*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    35* EFFECTIVE    NUMBER
    36*-----------------------------------------------------------------
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38* 062904    2001061800003  PEMA  ADD CLM TYPE I AND G
    39* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    40*                                IS OPEN OR CNC DT < PD THRU
    41*                                ALSO ADD ALTERNATE KEY CLAUSE
    42* 111204    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    43* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    44* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    45* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    46* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
    47* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFUND
    48* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    49* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    50* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    51* 061412  CR2011022800001  AJRA  NAPERSOFT
    52* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    53* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    54* 101112  CR2011022800001  AJRA  FIX CERT PEND CANCEL ERROR MSG
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    57******************************************************************
    58
    59 ENVIRONMENT DIVISION.
    60
    61 INPUT-OUTPUT SECTION.
    62
    63 FILE-CONTROL.
    64
    65     SELECT DISK-DATE        ASSIGN TO SYS019-UT-3380-S-SYS019.
    66
    67     SELECT ELCNTL           ASSIGN TO SYS021-3380-ELCNTL
    68                             ORGANIZATION IS INDEXED
    69                             ACCESS IS DYNAMIC
    70                             RECORD KEY IS CF-CONTROL-PRIMARY
    71                             FILE STATUS IS ELCNTL-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   3
* EL517.cbl
    72
    73     SELECT ERPNDB           ASSIGN TO SYS022-3380-ERPNDB
    74                             ORGANIZATION IS INDEXED
    75                             ACCESS IS SEQUENTIAL
    76                             RECORD KEY IS PB-CONTROL-PRIMARY
    77                             ALTERNATE RECORD KEY IS
    78                                 PB-CONTROL-BY-ACCOUNT
    79                             FILE STATUS IS ERPNDB-FILE-STATUS.
    80
    81     SELECT ERREIN           ASSIGN TO SYS022-3380-ERREIN
    82                             ORGANIZATION IS INDEXED
    83                             ACCESS IS DYNAMIC
    84                             RECORD KEY IS RE-CONTROL-PRIMARY
    85                             FILE STATUS IS ERREIN-FILE-STATUS.
    86
    87     SELECT ELCERT
*                                  COPY ELCCERTS.
    88******************************************************************04/15/98
    89*                                                                *ELCCERTS
    90*                            ELCCERTS.                           *   LV002
    91*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    92*                            VMOD=2.001                          *ELCCERTS
    93*                                                                *ELCCERTS
    94*           SELECT STATEMENT FOR THE CERTIFICATE MASTER          *ELCCERTS
    95*                                                                *ELCCERTS
    96*  NO  CID  MODS  TO  COPYBOOK  ELCCERTS                         *ELCCERTS
    97******************************************************************ELCCERTS
    98                                                                  ELCCERTS
    99         ASSIGN TO SYS022-3380-ELCERT                             ELCCERTS
   100         ORGANIZATION IS INDEXED                                  ELCCERTS
   101         ACCESS IS DYNAMIC                                        ELCCERTS
   102         RECORD KEY IS CM-CONTROL-PRIMARY                         ELCCERTS
   103         FILE STATUS IS ELCERT-FILE-STATUS.                       ELCCERTS
   104                                                                  ELCCERTS
   105
   106     SELECT ELMSTR           ASSIGN TO SYS023-3380-ELMSTR5
   107                             ORGANIZATION IS INDEXED
   108                             ACCESS IS DYNAMIC
   109                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
   110                             FILE STATUS IS ELMSTR-FILE-STATUS.
   111
   112     SELECT ERCTBL           ASSIGN TO SYS022-3380-ERCTBL
   113                             ORGANIZATION IS INDEXED
   114                             ACCESS IS DYNAMIC
   115                             RECORD KEY IS CT-CONTROL-PRIMARY
   116                             FILE STATUS IS ERCTBL-FILE-STATUS.
   117
   118     SELECT ERACCT           ASSIGN TO SYS022-3380-ERACCT2
   119                             ORGANIZATION IS INDEXED
   120                             ACCESS IS DYNAMIC
   121                             RECORD KEY IS AM-CONTROL-BY-VAR-GRP
   122                             FILE STATUS IS ERACCT-FILE-STATUS.
   123
   124     SELECT ELCERR           ASSIGN TO SYS022-3380-ELERRS
   125                             ORGANIZATION IS INDEXED
   126                             ACCESS IS DYNAMIC
   127                             RECORD KEY IS EM-CONTROL-PRIMARY
   128                             FILE STATUS IS ELCERR-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   4
* EL517.cbl
   129
   130     SELECT ERPNDM           ASSIGN TO SYS022-3380-ERPNDM
   131                             ORGANIZATION IS INDEXED
   132                             ACCESS IS DYNAMIC
   133                             RECORD KEY IS PM-CONTROL-PRIMARY
   134                             FILE STATUS IS ERPNDM-FILE-STATUS.
   135
   136     SELECT ERMAIL           ASSIGN TO SYS022-3380-ERMAIL
   137                             ORGANIZATION IS INDEXED
   138                             ACCESS IS DYNAMIC
   139                             RECORD KEY IS MA-CONTROL-PRIMARY
   140                             FILE STATUS IS ERMAIL-FILE-STATUS.
   141
   142     SELECT ERPLAN           ASSIGN TO SYS022-3380-ERPLAN
   143                             ORGANIZATION IS INDEXED
   144                             ACCESS IS DYNAMIC
   145                             RECORD KEY IS PL-CONTROL-PRIMARY
   146                             FILE STATUS IS ERPLAN-FILE-STATUS.
   147
   148     SELECT ERFORM           ASSIGN TO SYS022-3380-ERFORM
   149                             ORGANIZATION IS INDEXED
   150                             ACCESS IS DYNAMIC
   151                             RECORD KEY IS FO-CONTROL-PRIMARY
   152                             FILE STATUS IS ERFORM-FILE-STATUS.
   153
   154     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
   155
   156     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
   157
   158     SELECT ELREPT           ASSIGN TO SYS010-3380-ELREPT
   159                             ORGANIZATION IS INDEXED
   160                             ACCESS IS DYNAMIC
   161                             RECORD KEY IS RF-CONTROL-PRIMARY
   162                             FILE STATUS IS DTE-VSAM-FLAGS.
   163
   164     SELECT ERRESS           ASSIGN TO SYS021-3380-ERRESS
   165                             ORGANIZATION IS INDEXED
   166                             ACCESS IS DYNAMIC
   167                             RECORD KEY IS ERRESS-PRIMARY-KEY
   168                             FILE STATUS IS ERRESS-FILE-STATUS.
   169
   170     SELECT ERRESC           ASSIGN TO SYS021-3380-ERRESC
   171                             ORGANIZATION IS INDEXED
   172                             ACCESS IS DYNAMIC
   173                             RECORD KEY IS ERRESC-RECORD-KEY
   174                             FILE STATUS IS ERRESC-FILE-STATUS.
   175
   176     SELECT ERCOMP           ASSIGN TO             ERCOMP
   177                             ORGANIZATION IS INDEXED
   178                             ACCESS IS DYNAMIC
   179                             RECORD KEY IS CO-CONTROL-PRIMARY
   180                             FILE STATUS IS ERCOMP-FILE-STATUS.
   181
   182     SELECT ERLOFC           ASSIGN TO             ERLOFC
   183                             ORGANIZATION IS INDEXED
   184                             ACCESS IS DYNAMIC
   185                             RECORD KEY IS LO-CONTROL-PRIMARY
   186                             FILE STATUS IS ERLOFC-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   5
* EL517.cbl
   187
   188     SELECT ERBXRF           ASSIGN TO             ERBXRF
   189                             ORGANIZATION IS INDEXED
   190                             ACCESS IS DYNAMIC
   191                             RECORD KEY IS BK-CONTROL-PRIMARY
   192                             FILE STATUS IS ERBXRF-FILE-STATUS.
   193
   194     SELECT ERAGTC           ASSIGN TO             ERAGTC
   195                             ORGANIZATION IS INDEXED
   196                             ACCESS IS DYNAMIC
   197                             RECORD KEY IS AG-CONTROL-PRIMARY
   198                             FILE STATUS IS ERAGTC-FILE-STATUS.
   199
   200     SELECT ELCRTT           ASSIGN TO             ELCRTT
   201                             ORGANIZATION IS INDEXED
   202                             ACCESS IS DYNAMIC
   203                             RECORD KEY IS CS-CONTROL-PRIMARY
   204                             FILE STATUS IS ELCRTT-FILE-STATUS.
   205
   206     SELECT ERPDEF           ASSIGN TO ERPDEF
   207                             ACCESS IS DYNAMIC
   208                             ORGANIZATION IS INDEXED
   209                             FILE STATUS IS ERPDEF-FILE-STATUS
   210                             RECORD KEY IS PD-CONTROL-PRIMARY.
   211
   212     SELECT ELSTAT           ASSIGN TO ELSTAT
   213                             ACCESS IS DYNAMIC
   214                             ORGANIZATION IS INDEXED
   215                             FILE STATUS IS ELSTAT-FILE-STATUS
   216                             RECORD KEY IS SF-CONTROL-PRIMARY.
   217
   218     SELECT ELCRTO           ASSIGN TO ELCRTO
   219                             ACCESS IS DYNAMIC
   220                             ORGANIZATION IS INDEXED
   221                             FILE STATUS IS ELCRTO-FILE-STATUS
   222                             RECORD KEY IS OC-CONTROL-PRIMARY.
   223
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   6
* EL517.cbl
   225 DATA DIVISION.
   226
   227 FILE SECTION.
   228
   229 FD  DISK-DATE
*                                      COPY ELCDTEFD.
   230******************************************************************04/15/98
   231*                                                                *ELCDTEFD
   232*                                                                *ELCDTEFD
   233*                            ELCDTEFD.                           *   LV002
   234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   235*                            VMOD=2.007                          *   CL**2
   236*                                                                *ELCDTEFD
   237******************************************************************ELCDTEFD
   238     BLOCK CONTAINS 0 RECORDS
   239     RECORDING MODE F.                                            ELCDTEFD
   240                                                                  ELCDTEFD
   241 01  DATE-DISK.                                                   ELCDTEFD
   242     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   243     12  FILLER                      PIC  X(14).                  ELCDTEFD
   244     12  DD-CR1                      PIC  9.                      ELCDTEFD
   245     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   246     12  DD-CR2                      PIC  9.                      ELCDTEFD
   247     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   248     12  FILLER                      PIC  X(20).                  ELCDTEFD
   249                                                                  ELCDTEFD
   250 01  DATE-DISK-R.                                                 ELCDTEFD
   251     12  FILLER                      PIC  X(4).                   ELCDTEFD
   252     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   253                                     PIC  X(32).                  ELCDTEFD
   254                                                                  ELCDTEFD
   255 01  DATE-DISK-T.                                                 ELCDTEFD
   256     12  FILLER                      PIC  X(4).                   ELCDTEFD
   257     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   258                                     PIC  X(48).                  ELCDTEFD
   259                                                                  ELCDTEFD
   260 01  DATE-DISK-M.                                                 ELCDTEFD
   261     12  FILLER                      PIC  X(4).                   ELCDTEFD
   262     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   263                                     PIC  X(48).                  ELCDTEFD
   264                                                                  ELCDTEFD
   265 01  DATE-DISK-P.                                                 ELCDTEFD
   266     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   267     12  DD-IDX                      PIC  99.                     ELCDTEFD
   268     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   269     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   270         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   271                                     PIC  X.                      ELCDTEFD
   272         16  FILLER                  PIC  X(46).                  ELCDTEFD
   273     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   274         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   275             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   276             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   277             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   278             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   279         16  FILLER                  PIC  X(16).                  ELCDTEFD
   280                                                                  ELCDTEFD
   281 01  DATE-DISK-E.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   7
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   282     12  FILLER                      PIC  X(4).                   ELCDTEFD
   283     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   284                                     PIC  X(4).                   ELCDTEFD
   285                                                                  ELCDTEFD
   286 01  DATE-DISK-C.                                                 ELCDTEFD
   287     12  FILLER                      PIC  X(7).                   ELCDTEFD
   288     12  DD-CARR1-SECPAY-SW          PIC  X.
   289     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   290     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   291     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   292     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   293     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   294     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   295     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   296     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   297     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   298     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   299     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   300     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   301     12  DD-CARR2-SECPAY-SW          PIC  X.
   302     12  FILLER                      PIC  X(7).                   ELCDTEFD
   303                                                                  ELCDTEFD
   304 01  DATE-DISK-OPT.                                               ELCDTEFD
   305     12  FILLER                      PIC  X(04).                  ELCDTEFD
   306     12  DD-TLR-DATA.                                             ELCDTEFD
   307         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   308                                     PIC  X(03).                  ELCDTEFD
   309     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   310         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   311                                     PIC  X(06).                  ELCDTEFD
   312     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   313         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   314                                     PIC  X(07).                  ELCDTEFD
   315         16  FILLER                  PIC  X(05).                  ELCDTEFD
   316     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   317                                     PIC  X(96).                  ELCDTEFD
   318******************************************************************ELCDTEFD
   319
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   8
* EL517.cbl
   321 FD  ELCNTL.
*  322                                 COPY ELCCNTL.
   323******************************************************************
   324*                                                                *
   325*                                                                *
   326*                            ELCCNTL.                            *
   327*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   328*                            VMOD=2.059                          *
   329*                                                                *
   330*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   331*                                                                *
   332*   FILE TYPE = VSAM,KSDS                                        *
   333*   RECORD SIZE = 750  RECFORM = FIXED                           *
   334*                                                                *
   335*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   336*       ALTERNATE INDEX = NONE                                   *
   337*                                                                *
   338*   LOG = YES                                                    *
   339*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   340******************************************************************
   341*                   C H A N G E   L O G
   342*
   343* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   344*-----------------------------------------------------------------
   345*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   346* EFFECTIVE    NUMBER
   347*-----------------------------------------------------------------
   348* 082503                   PEMA  ADD BENEFIT GROUP
   349* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   350* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   351* 092705    2005050300006  PEMA  ADD SPP LEASES
   352* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   353* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   354* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FOR AK
   355* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH CLAIM
   356* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   357* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   358* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   359******************************************************************
   360*
   361 01  CONTROL-FILE.
   362     12  CF-RECORD-ID                       PIC XX.
   363         88  VALID-CF-ID                        VALUE 'CF'.
   364
   365     12  CF-CONTROL-PRIMARY.
   366         16  CF-COMPANY-ID                  PIC XXX.
   367         16  CF-RECORD-TYPE                 PIC X.
   368             88  CF-COMPANY-MASTER              VALUE '1'.
   369             88  CF-PROCESSOR-MASTER            VALUE '2'.
   370             88  CF-STATE-MASTER                VALUE '3'.
   371             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   372             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   373             88  CF-CARRIER-MASTER              VALUE '6'.
   374             88  CF-MORTALITY-MASTER            VALUE '7'.
   375             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   376             88  CF-TERMINAL-MASTER             VALUE '9'.
   377             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   378             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page   9
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   379             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   380             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   381             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   382             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   383             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   384             88  CF-REMINDERS-MASTER            VALUE 'R'.
   385             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   386         16  CF-ACCESS-CD-GENL              PIC X(4).
   387         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   388             20  CF-PROCESSOR               PIC X(4).
   389         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   390             20  CF-STATE-CODE              PIC XX.
   391             20  FILLER                     PIC XX.
   392         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   393             20  FILLER                     PIC XX.
   394             20  CF-HI-BEN-IN-REC           PIC XX.
   395         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   396             20  FILLER                     PIC XXX.
   397             20  CF-CARRIER-CNTL            PIC X.
   398         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   399             20  FILLER                     PIC XX.
   400             20  CF-HI-TYPE-IN-REC          PIC 99.
   401         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   402             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   403                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   404             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   405             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   406         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   407             20  FILLER                     PIC X.
   408             20  CF-CUSTOM-REPORT-NO        PIC 999.
   409         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   410             20  FILLER                     PIC XX.
   411             20  CF-MORTGAGE-PLAN           PIC XX.
   412         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   413
   414     12  CF-LAST-MAINT-DT                   PIC XX.
   415     12  CF-LAST-MAINT-BY                   PIC X(4).
   416     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   417
   418     12  CF-RECORD-BODY                     PIC X(728).
   419
   420
   421****************************************************************
   422*             COMPANY MASTER RECORD                            *
   423****************************************************************
   424
   425     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   426         16  CF-COMPANY-ADDRESS.
   427             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   428             20  CF-CL-IN-CARE-OF           PIC X(30).
   429             20  CF-CL-ADDR-LINE-1          PIC X(30).
   430             20  CF-CL-ADDR-LINE-2          PIC X(30).
   431             20  CF-CL-CITY-STATE           PIC X(30).
   432             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   433             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   434         16  CF-COMPANY-CD                  PIC X.
   435         16  CF-COMPANY-PASSWORD            PIC X(8).
   436         16  CF-SECURITY-OPTION             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  10
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   437             88  ALL-SECURITY                   VALUE '1'.
   438             88  COMPANY-VERIFY                 VALUE '2'.
   439             88  PROCESSOR-VERIFY               VALUE '3'.
   440             88  NO-SECURITY                    VALUE '4'.
   441             88  ALL-BUT-TERM                   VALUE '5'.
   442         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   443             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   444         16  CF-LGX-INTERFACE-CNTL          PIC X.
   445             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   446         16  CF-INFORCE-LOCATION            PIC X.
   447             88  CERTS-ARE-ONLINE               VALUE '1'.
   448             88  CERTS-ARE-OFFLINE              VALUE '2'.
   449             88  NO-CERTS-AVAILABLE             VALUE '3'.
   450         16  CF-LOWER-CASE-LETTERS          PIC X.
   451         16  CF-CERT-ACCESS-CONTROL         PIC X.
   452             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   453             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   454             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   455             88  CF-ACCNT-CNTL                  VALUE '3'.
   456             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   457
   458         16  CF-FORMS-PRINTER-ID            PIC X(4).
   459         16  CF-CHECK-PRINTER-ID            PIC X(4).
   460
   461         16  CF-LGX-CREDIT-USER             PIC X.
   462             88  CO-IS-NOT-USER                 VALUE 'N'.
   463             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   464
   465         16 CF-CREDIT-CALC-CODES.
   466             20  CF-CR-REM-TERM-CALC PIC X.
   467               88  CR-EARN-AFTER-15TH           VALUE '1'.
   468               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   469               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   470               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   471               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   472               88  CR-EARN-AFTER-14TH           VALUE '6'.
   473               88  CR-EARN-AFTER-16TH           VALUE '7'.
   474             20  CF-CR-R78-METHOD           PIC X.
   475               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   476               88  DONT-USE-PLUS-ONE            VALUE '1'.
   477
   478         16  CF-CLAIM-CONTROL-COUNTS.
   479             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   480                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   481
   482             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   483                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   484
   485             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   486                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   487
   488             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   489                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   490
   491         16  CF-CURRENT-MONTH-END           PIC XX.
   492
   493         16  CF-CO-CALC-QUOTE-TOLERANCE.
   494             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  11
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   495             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   496             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   497             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   498                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   499                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   500             20  CF-CO-PREM-REJECT-SW       PIC X.
   501                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   502                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   503             20  CF-CO-REF-REJECT-SW        PIC X.
   504                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   505                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   506
   507         16  CF-CO-REPORTING-DT             PIC XX.
   508         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   509         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   510           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   511           88  CF-CO-MONTH-END                  VALUE '1'.
   512
   513         16  CF-LGX-CLAIM-USER              PIC X.
   514             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   515             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   516
   517         16  CF-CREDIT-EDIT-CONTROLS.
   518             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   519             20  CF-MIN-AGE                 PIC 99.
   520             20  CF-DEFAULT-AGE             PIC 99.
   521             20  CF-MIN-TERM                PIC S999      COMP-3.
   522             20  CF-MAX-TERM                PIC S999      COMP-3.
   523             20  CF-DEFAULT-SEX             PIC X.
   524             20  CF-JOINT-AGE-INPUT         PIC X.
   525                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   526             20  CF-BIRTH-DATE-INPUT        PIC X.
   527                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   528             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   529                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   530                 88  CF-ZERO-CARRIER            VALUE '1'.
   531                 88  CF-ZERO-GROUPING           VALUE '2'.
   532                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   533             20  CF-EDIT-SW                 PIC X.
   534                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   535             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   536             20  CF-CR-PR-METHOD            PIC X.
   537               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   538               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   539             20  FILLER                     PIC X.
   540
   541         16  CF-CREDIT-MISC-CONTROLS.
   542             20  CF-REIN-TABLE-SW           PIC X.
   543                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   544             20  CF-COMP-TABLE-SW           PIC X.
   545                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   546             20  CF-EXPERIENCE-RETENTION-AGE
   547                                            PIC S9        COMP-3.
   548             20  CF-CONVERSION-DT           PIC XX.
   549             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   550             20  CF-RUN-FREQUENCY-SW        PIC X.
   551                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   552                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  12
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   553
   554             20  CF-CR-CHECK-NO-CONTROL.
   555                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   556                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   557                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   558                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   559                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   560                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   561
   562                 24  CF-CR-CHECK-COUNT       REDEFINES
   563                     CF-CR-CHECK-COUNTER      PIC X(4).
   564
   565                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   566                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   567
   568                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   569                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   570                 24  CF-MAIL-PROCESSING       PIC X.
   571                     88  MAIL-PROCESSING          VALUE 'Y'.
   572
   573         16  CF-MISC-SYSTEM-CONTROL.
   574             20  CF-SYSTEM-C                 PIC X.
   575                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   576             20  CF-SYSTEM-D                 PIC X.
   577                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   578             20  CF-SOC-SEC-NO-SW            PIC X.
   579                 88  SOC-SEC-NO-USED             VALUE '1'.
   580             20  CF-MEMBER-NO-SW             PIC X.
   581                 88  MEMBER-NO-USED              VALUE '1'.
   582             20  CF-TAX-ID-NUMBER            PIC X(11).
   583             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   584             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   585                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   586                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   587                 88  CF-ALL-APPROVED             VALUE 'Y'.
   588                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   589             20  CF-SYSTEM-E                 PIC X.
   590                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   591
   592         16  CF-LGX-LIFE-USER               PIC X.
   593             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   594             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   595
   596         16  CF-CR-MONTH-END-DT             PIC XX.
   597
   598         16  CF-FILE-MAINT-DATES.
   599             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   600                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   601             20  CF-LAST-BATCH       REDEFINES
   602                 CF-LAST-BATCH-NO               PIC X(4).
   603             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   604             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   605             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   606             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   607             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   608             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   609             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   610             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  13
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   611             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   612             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   613
   614         16  CF-NEXT-COMPANY-ID             PIC XXX.
   615         16  FILLER                         PIC X.
   616
   617         16  CF-ALT-MORT-CODE               PIC X(4).
   618         16  CF-MEMBER-CAPTION              PIC X(10).
   619
   620         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   621             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   622             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   623             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   624             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   625             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   626
   627         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   628
   629         16  CF-LIFE-OVERRIDE-L1            PIC X.
   630         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   631         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   632         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   633
   634         16  CF-AH-OVERRIDE-L1              PIC X.
   635         16  CF-AH-OVERRIDE-L2              PIC XX.
   636         16  CF-AH-OVERRIDE-L6              PIC X(6).
   637         16  CF-AH-OVERRIDE-L12             PIC X(12).
   638
   639         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   640         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   641
   642         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   643         16  CF-AR-LAST-EL860-DT            PIC XX.
   644         16  CF-MP-MONTH-END-DT             PIC XX.
   645
   646         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   647         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   648             88  CF-CLAIM-PAID-TO               VALUE '1'.
   649
   650         16  CF-AR-MONTH-END-DT             PIC XX.
   651
   652         16  CF-CRDTCRD-USER                PIC X.
   653             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   654             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   655
   656         16  CF-CC-MONTH-END-DT             PIC XX.
   657
   658         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   659
   660         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   661             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   662             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   663             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   664         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   665         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   666         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   667         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   668             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  14
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   669             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   670         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   671         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   672         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   673             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   674         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   675
   676         16  CF-CL-ZIP-CODE.
   677             20  CF-CL-ZIP-PRIME.
   678                 24  CF-CL-ZIP-1ST          PIC X.
   679                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   680                 24  FILLER                 PIC X(4).
   681             20  CF-CL-ZIP-PLUS4            PIC X(4).
   682         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   683             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   684             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   685             20  FILLER                     PIC XXX.
   686
   687         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   688         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   689         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   690         16  CF-CO-OPTION-START-DATE        PIC XX.
   691         16  CF-REM-TRM-CALC-OPTION         PIC X.
   692           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   693                                                      '3' '4'.
   694           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   695           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   696           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   697           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   698           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   699           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   700
   701         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   702
   703         16  CF-PAYMENT-APPROVAL-LEVELS.
   704             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   705             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   706             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   707             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   708             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   709             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   710
   711         16  CF-END-USER-REPORTING-USER     PIC X.
   712             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   713             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   714
   715         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   716             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   717             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   718
   719         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   720
   721         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   722         16  FILLER                         PIC X.
   723
   724         16  CF-CREDIT-ARCHIVE-CNTL.
   725             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   726             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  15
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   727             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   728
   729         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   730
   731         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   732             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   733             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   734
   735         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   736             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   737             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   738
   739         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   740
   741         16  CF-CO-ACH-ID-CODE              PIC  X.
   742             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   743             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   744             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   745         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   746         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   747         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   748         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   749         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   750         16  CF-CO-ACH-RECV-NO              PIC X(08).
   751         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   752         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   753         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   754                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   755         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   756                 CF-CO-ACH-TRACE-NO         PIC X(4).
   757
   758         16  CF-CO-OVER-SHORT.
   759             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   760             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   761
   762*         16  FILLER                         PIC X(102).
   763         16  CF-PAYMENT-APPROVAL-LEVELS-2.
   764             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   765             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   766
   767         16  CF-AH-APPROVAL-DAYS.
   768             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   769             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   770             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   771             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   772
   773         16  FILLER                         PIC X(82).
   774****************************************************************
   775*             PROCESSOR/USER RECORD                            *
   776****************************************************************
   777
   778     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   779         16  CF-PROCESSOR-NAME              PIC X(30).
   780         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   781         16  CF-PROCESSOR-TITLE             PIC X(26).
   782         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   783                 88  MESSAGE-YES                VALUE 'Y'.
   784                 88  MESSAGE-NO                 VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  16
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   785
   786*****************************************************
   787****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   788****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   789****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   790****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   791*****************************************************
   792
   793         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   794             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   795             20  CF-APPLICATION-FORCE       PIC X.
   796             20  CF-INDIVIDUAL-APP.
   797                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   798                     28  CF-BROWSE-APP      PIC X.
   799                     28  CF-UPDATE-APP      PIC X.
   800
   801         16  CF-CURRENT-TERM-ON             PIC X(4).
   802         16  CF-PROCESSOR-LIMITS-CLAIMS.
   803             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   804             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   805             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   806             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   807             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   808             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   809             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   810         16  CF-PROCESSOR-CARRIER           PIC X.
   811             88  NO-CARRIER-SECURITY            VALUE ' '.
   812         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   813             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   814         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
   815             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   816         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   817             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   818
   819         16  CF-PROC-SYS-ACCESS-SW.
   820             20  CF-PROC-CREDIT-CLAIMS-SW.
   821                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   822                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   823                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   824                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   825             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   826                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   827                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   828             20  CF-PROC-LIFE-GNRLDGR-SW.
   829                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   830                     88  ACCESS-TO-LIFE             VALUE 'Y'.
   831                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   832                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
   833             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
   834                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   835                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   836         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   837             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   838             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   839         16  CF-PROCESSOR-PRINTER               PIC X(4).
   840
   841         16  CF-APPROVAL-LEVEL                  PIC X.
   842             88  APPROVAL-LEVEL-1                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  17
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   843             88  APPROVAL-LEVEL-2                   VALUE '2'.
   844             88  APPROVAL-LEVEL-3                   VALUE '3'.
   845             88  APPROVAL-LEVEL-4                   VALUE '4'.
   846
   847         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   848
   849         16  CF-LANGUAGE-TYPE                   PIC X.
   850             88  CF-LANG-IS-ENG                     VALUE 'E'.
   851             88  CF-LANG-IS-FR                      VALUE 'F'.
   852
   853         16  CF-CSR-IND                         PIC X.
   854         16  FILLER                             PIC X(239).
   855
   856****************************************************************
   857*             PROCESSOR/REMINDERS RECORD                       *
   858****************************************************************
   859
   860     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   861         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   862             20  CF-START-REMIND-DT         PIC XX.
   863             20  CF-END-REMIND-DT           PIC XX.
   864             20  CF-REMINDER-TEXT           PIC X(50).
   865         16  FILLER                         PIC X(296).
   866
   867
   868****************************************************************
   869*             STATE MASTER RECORD                              *
   870****************************************************************
   871
   872     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   873         16  CF-STATE-ABBREVIATION          PIC XX.
   874         16  CF-STATE-NAME                  PIC X(25).
   875         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   876         16  CF-ST-CALC-QUOTE-TOLERANCE.
   877             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   878             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   879             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   880             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   881                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   882                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   883             20  CF-ST-PREM-REJECT-SW       PIC X.
   884                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   885                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   886             20  CF-ST-REF-REJECT-SW        PIC X.
   887                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
   888                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   889         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
   890         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
   891         16  CF-ST-REFUND-RULES.
   892             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   893             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   894             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   895         16  CF-ST-FST-PMT-EXTENSION.
   896             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   897             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
   898                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   899                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   900                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  18
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   901                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
   902         16  CF-ST-STATE-CALL.
   903             20  CF-ST-CALL-UNEARNED        PIC X.
   904             20  CF-ST-CALL-RPT-CNTL        PIC X.
   905             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   906         16  CF-REPLACEMENT-LAW-SW          PIC X.
   907             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   908             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   909         16  CF-REPLACEMENT-LETTER          PIC X(4).
   910         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   911         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   912         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
   913         16  CF-ST-SPLIT-PAYMENT            PIC X.
   914         16  FILLER                         PIC X.
   915         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   916             20  CF-ST-BENEFIT-CD           PIC XX.
   917             20  CF-ST-BENEFIT-KIND         PIC X.
   918                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   919                 88  CF-ST-AH-KIND              VALUE 'A'.
   920             20  CF-ST-REM-TERM-CALC        PIC X.
   921                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   922                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   923                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   924                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   925                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   926                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   927                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   928                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   929
   930             20  CF-ST-REFUND-CALC          PIC X.
   931                 88  ST-REFUND-NOT-USED         VALUE SPACE.
   932                 88  ST-REFD-BY-R78             VALUE '1'.
   933                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
   934                 88  ST-REFD-AS-CALIF           VALUE '3'.
   935                 88  ST-REFD-AS-TEXAS           VALUE '4'.
   936                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
   937                 88  ST-REFD-ANTICIPATION       VALUE '6'.
   938                 88  ST-REFD-UTAH               VALUE '7'.
   939                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
   940                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
   941                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
   942
   943             20  CF-ST-EARNING-CALC         PIC X.
   944                 88  ST-EARNING-NOT-USED        VALUE SPACE.
   945                 88  ST-EARN-BY-R78             VALUE '1'.
   946                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
   947                 88  ST-EARN-AS-CALIF           VALUE '3'.
   948                 88  ST-EARN-AS-TEXAS           VALUE '4'.
   949                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
   950                 88  ST-EARN-ANTICIPATION       VALUE '6'.
   951                 88  ST-EARN-MEAN               VALUE '8'.
   952                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
   953
   954             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
   955                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
   956                 88  ST-OVRD-BY-R78             VALUE '1'.
   957                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
   958                 88  ST-OVRD-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  19
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   959                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
   960                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
   961                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
   962                 88  ST-OVRD-MEAN               VALUE '8'.
   963                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
   964             20  FILLER                     PIC X.
   965
   966         16  CF-ST-COMMISSION-CAPS.
   967             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
   968             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
   969             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
   970             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
   971         16  CF-COMM-CAP-LIMIT-TO           PIC X.
   972                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
   973
   974         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
   975
   976         16  CF-ST-STATUTORY-INTEREST.
   977             20  CF-ST-STAT-DATE-FROM       PIC X.
   978                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
   979                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
   980             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
   981             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
   982             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
   983             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
   984             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
   985
   986         16  CF-ST-OVER-SHORT.
   987             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
   988             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
   989
   990         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
   991
   992         16  CF-ST-RT-CALC                  PIC X.
   993
   994         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
   995         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
   996         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
   997         16  CF-ST-RF-LR-CALC               PIC X.
   998         16  CF-ST-RF-LL-CALC               PIC X.
   999         16  CF-ST-RF-LN-CALC               PIC X.
  1000         16  CF-ST-RF-AH-CALC               PIC X.
  1001         16  CF-ST-RF-CP-CALC               PIC X.
  1002*        16  FILLER                         PIC X(206).
  1003*CIDMOD         16  FILLER                         PIC X(192).
  1004         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1005             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1006         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1007         16  CF-ST-VFY-2ND-BENE             PIC X.
  1008         16  CF-ST-CAUSAL-STATE             PIC X.
  1009         16  FILLER                         PIC X(185).
  1010
  1011****************************************************************
  1012*             BENEFIT MASTER RECORD                            *
  1013****************************************************************
  1014
  1015     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1016         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  20
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1017             20  CF-BENEFIT-CODE            PIC XX.
  1018             20  CF-BENEFIT-NUMERIC  REDEFINES
  1019                 CF-BENEFIT-CODE            PIC XX.
  1020             20  CF-BENEFIT-ALPHA           PIC XXX.
  1021             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1022             20  CF-BENEFIT-COMMENT         PIC X(10).
  1023
  1024             20  CF-LF-COVERAGE-TYPE        PIC X.
  1025                 88  CF-REDUCING                VALUE 'R'.
  1026                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1027
  1028             20  CF-SPECIAL-CALC-CD         PIC X.
  1029                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1030                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1031                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1032                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1033                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1034                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1035                 88  CF-FARM-PLAN               VALUE 'F'.
  1036                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1037                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1038                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1039                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1040                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1041                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1042                 88  CF-PRUDENTIAL              VALUE 'P'.
  1043                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1044                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1045                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1046                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1047                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1048                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1049
  1050             20  CF-JOINT-INDICATOR         PIC X.
  1051                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1052
  1053*            20  FILLER                     PIC X(12).
  1054             20  FILLER                     PIC X(11).
  1055             20  CF-BENEFIT-CATEGORY        PIC X.
  1056             20  CF-LOAN-TYPE               PIC X(8).
  1057
  1058             20  CF-CO-REM-TERM-CALC        PIC X.
  1059                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1060                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1061                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1062                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1063                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1064
  1065             20  CF-CO-EARNINGS-CALC        PIC X.
  1066                 88  CO-EARN-BY-R78             VALUE '1'.
  1067                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1068                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1069                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1070                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1071                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1072                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1073                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1074
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  21
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1075             20  CF-CO-REFUND-CALC          PIC X.
  1076                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1077                 88  CO-REFD-BY-R78             VALUE '1'.
  1078                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1079                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1080                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1081                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1082                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1083                 88  CO-REFD-MEAN               VALUE '8'.
  1084                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1085                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1086                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1087
  1088             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1089                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1090                 88  CO-OVRD-BY-R78             VALUE '1'.
  1091                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1092                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1093                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1094                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1095                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1096                 88  CO-OVRD-MEAN               VALUE '8'.
  1097                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1098
  1099             20  CF-CO-BEN-I-G-CD           PIC X.
  1100                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1101                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1102                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1103
  1104         16  FILLER                         PIC X(304).
  1105
  1106
  1107****************************************************************
  1108*             CARRIER MASTER RECORD                            *
  1109****************************************************************
  1110
  1111     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1112         16  CF-ADDRESS-DATA.
  1113             20  CF-MAIL-TO-NAME            PIC X(30).
  1114             20  CF-IN-CARE-OF              PIC X(30).
  1115             20  CF-ADDRESS-LINE-1          PIC X(30).
  1116             20  CF-ADDRESS-LINE-2          PIC X(30).
  1117             20  CF-CITY-STATE              PIC X(30).
  1118             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1119             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1120
  1121         16  CF-CLAIM-NO-CONTROL.
  1122             20  CF-CLAIM-NO-METHOD         PIC X.
  1123                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1124                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1125                 88  CLAIM-NO-SEQ               VALUE '3'.
  1126                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1127             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1128                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1129                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1130                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1131
  1132         16  CF-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  22
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1133             20  CF-CHECK-NO-METHOD         PIC X.
  1134                 88  CHECK-NO-MANUAL            VALUE '1'.
  1135                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1136                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1137                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1138             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1139                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1140
  1141         16  CF-DOMICILE-STATE              PIC XX.
  1142
  1143         16  CF-EXPENSE-CONTROLS.
  1144             20  CF-EXPENSE-METHOD          PIC X.
  1145                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1146                 88  DOLLARS-PER-PMT            VALUE '2'.
  1147                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1148                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1149             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1150             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1151
  1152         16  CF-CORRESPONDENCE-CONTROL.
  1153             20  CF-LETTER-RESEND-OPT       PIC X.
  1154                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1155                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1156             20  FILLER                     PIC X(4).
  1157
  1158         16  CF-RESERVE-CONTROLS.
  1159             20  CF-MANUAL-SW               PIC X.
  1160                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1161             20  CF-FUTURE-SW               PIC X.
  1162                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1163             20  CF-PTC-SW                  PIC X.
  1164                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1165             20  CF-IBNR-SW                 PIC X.
  1166                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1167             20  CF-PTC-LF-SW               PIC X.
  1168                 88  CF-LF-PTC-USED             VALUE '1'.
  1169             20  CF-CDT-ACCESS-METHOD       PIC X.
  1170                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1171                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1172                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1173             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1174
  1175         16  CF-CLAIM-CALC-METHOD           PIC X.
  1176             88  360-PLUS-MONTHS                VALUE '1'.
  1177             88  365-PLUS-MONTHS                VALUE '2'.
  1178             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1179             88  360-DAILY                      VALUE '4'.
  1180             88  365-DAILY                      VALUE '5'.
  1181
  1182         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1183         16  FILLER                         PIC X(11).
  1184
  1185         16  CF-LIMIT-AMOUNTS.
  1186             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1187             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1188             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1189             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1190             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  23
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1191             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1192             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1193             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1194             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1195             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1196
  1197         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1198         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1199         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1200
  1201         16  CF-ZIP-CODE.
  1202             20  CF-ZIP-PRIME.
  1203                 24  CF-ZIP-1ST             PIC X.
  1204                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1205                 24  FILLER                 PIC X(4).
  1206             20  CF-ZIP-PLUS4               PIC X(4).
  1207         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1208             20  CF-CAN-POSTAL-1            PIC XXX.
  1209             20  CF-CAN-POSTAL-2            PIC XXX.
  1210             20  FILLER                     PIC XXX.
  1211
  1212         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1213         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1214         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1215
  1216         16  CF-RATING-SWITCH               PIC X.
  1217             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1218             88  CF-NO-RATING                   VALUE 'N'.
  1219
  1220         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1221
  1222         16  CF-CARRIER-OVER-SHORT.
  1223             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1224             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1225
  1226         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1227         16  CF-SECPAY-SWITCH               PIC X.
  1228             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1229             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1230         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1231         16  FILLER                         PIC X(448).
  1232*        16  FILLER                         PIC X(452).
  1233
  1234
  1235****************************************************************
  1236*             MORTALITY MASTER RECORD                          *
  1237****************************************************************
  1238
  1239     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1240         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1241                                INDEXED BY CF-MORT-NDX.
  1242             20  CF-MORT-TABLE              PIC X(5).
  1243             20  CF-MORT-TABLE-TYPE         PIC X.
  1244                 88  CF-MORT-JOINT              VALUE 'J'.
  1245                 88  CF-MORT-SINGLE             VALUE 'S'.
  1246                 88  CF-MORT-COMBINED           VALUE 'C'.
  1247                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1248                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  24
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1249             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1250             20  CF-MORT-AGE-METHOD         PIC XX.
  1251                 88  CF-AGE-LAST                VALUE 'AL'.
  1252                 88  CF-AGE-NEAR                VALUE 'AN'.
  1253             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1254             20  CF-MORT-ADJUSTMENT-DIRECTION
  1255                                            PIC X.
  1256                 88  CF-MINUS                   VALUE '-'.
  1257                 88  CF-PLUS                    VALUE '+'.
  1258             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1259             20  CF-MORT-JOINT-CODE         PIC X.
  1260                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1261             20  CF-MORT-PC-Q               PIC X.
  1262                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1263             20  CF-MORT-TABLE-CODE         PIC X(4).
  1264             20  CF-MORT-COMMENTS           PIC X(15).
  1265             20  FILLER                     PIC X(14).
  1266
  1267         16  FILLER                         PIC X(251).
  1268
  1269
  1270****************************************************************
  1271*             BUSSINESS TYPE MASTER RECORD                     *
  1272****************************************************************
  1273
  1274     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1275* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1276* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1277* AND RECORD 05 IS TYPES 81-99
  1278         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1279             20  CF-BUSINESS-TITLE          PIC  X(19).
  1280             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1281                                            PIC S9V9(4) COMP-3.
  1282             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1283             20  FILLER                     PIC  X.
  1284         16  FILLER                         PIC  X(248).
  1285
  1286
  1287****************************************************************
  1288*             TERMINAL MASTER RECORD                           *
  1289****************************************************************
  1290
  1291     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1292
  1293         16  CF-COMPANY-TERMINALS.
  1294             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1295                                  PIC X(4).
  1296         16  FILLER               PIC X(248).
  1297
  1298
  1299****************************************************************
  1300*             LIFE EDIT MASTER RECORD                          *
  1301****************************************************************
  1302
  1303     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1304         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1305             20  CF-LIFE-CODE-IN            PIC XX.
  1306             20  CF-LIFE-CODE-OUT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  25
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1307         16  FILLER                         PIC X(248).
  1308
  1309
  1310****************************************************************
  1311*             AH EDIT MASTER RECORD                            *
  1312****************************************************************
  1313
  1314     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1315         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1316             20  CF-AH-CODE-IN              PIC XXX.
  1317             20  CF-AH-CODE-OUT             PIC XX.
  1318         16  FILLER                         PIC X(248).
  1319
  1320
  1321****************************************************************
  1322*             CREDIBILITY TABLES                               *
  1323****************************************************************
  1324
  1325     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1326         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1327                             INDEXED BY CF-CRDB-NDX.
  1328             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1329             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1330             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1331         16  FILLER                         PIC  X(332).
  1332
  1333
  1334****************************************************************
  1335*             REPORT CUSTOMIZATION RECORD                      *
  1336****************************************************************
  1337
  1338     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1339         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1340             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1341             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1342             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1343**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1344****       A T-TRANSFER.                                   ****
  1345             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1346
  1347         16  FILLER                         PIC XX.
  1348
  1349         16  CF-CARRIER-CNTL-OPT.
  1350             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1351                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1352                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1353             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1354                                            PIC X.
  1355         16  CF-GROUP-CNTL-OPT.
  1356             20  CF-GROUP-OPT-SEQ           PIC 9.
  1357                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1358                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1359             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1360                                            PIC X(6).
  1361         16  CF-STATE-CNTL-OPT.
  1362             20  CF-STATE-OPT-SEQ           PIC 9.
  1363                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1364                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  26
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1365             20  CF-STATE-SELECT OCCURS 3 TIMES
  1366                                            PIC XX.
  1367         16  CF-ACCOUNT-CNTL-OPT.
  1368             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1369                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1370                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1371             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1372                                            PIC X(10).
  1373         16  CF-BUS-TYP-CNTL-OPT.
  1374             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1375                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1376                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1377             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1378                                            PIC XX.
  1379         16  CF-LF-TYP-CNTL-OPT.
  1380             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1381                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1382                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1383             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1384                                            PIC XX.
  1385         16  CF-AH-TYP-CNTL-OPT.
  1386             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1387                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1388                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1389             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1390                                            PIC XX.
  1391         16  CF-REPTCD1-CNTL-OPT.
  1392             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1393                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1394                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1395             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1396                                            PIC X(10).
  1397         16  CF-REPTCD2-CNTL-OPT.
  1398             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1399                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1400                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1401             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1402                                            PIC X(10).
  1403         16  CF-USER1-CNTL-OPT.
  1404             20  CF-USER1-OPT-SEQ           PIC 9.
  1405                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1406                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1407             20  CF-USER1-SELECT OCCURS 3 TIMES
  1408                                            PIC X(10).
  1409         16  CF-USER2-CNTL-OPT.
  1410             20  CF-USER2-OPT-SEQ           PIC 9.
  1411                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1412                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1413             20  CF-USER2-SELECT OCCURS 3 TIMES
  1414                                            PIC X(10).
  1415         16  CF-USER3-CNTL-OPT.
  1416             20  CF-USER3-OPT-SEQ           PIC 9.
  1417                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1418                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1419             20  CF-USER3-SELECT OCCURS 3 TIMES
  1420                                            PIC X(10).
  1421         16  CF-USER4-CNTL-OPT.
  1422             20  CF-USER4-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  27
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1423                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1424                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1425             20  CF-USER4-SELECT OCCURS 3 TIMES
  1426                                            PIC X(10).
  1427         16  CF-USER5-CNTL-OPT.
  1428             20  CF-USER5-OPT-SEQ           PIC 9.
  1429                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1430                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1431             20  CF-USER5-SELECT OCCURS 3 TIMES
  1432                                            PIC X(10).
  1433         16  CF-REINS-CNTL-OPT.
  1434             20  CF-REINS-OPT-SEQ           PIC 9.
  1435                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1436                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1437             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1438                 24  CF-REINS-PRIME         PIC XXX.
  1439                 24  CF-REINS-SUB           PIC XXX.
  1440
  1441         16  CF-AGENT-CNTL-OPT.
  1442             20  CF-AGENT-OPT-SEQ           PIC 9.
  1443                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1444                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1445             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1446                                            PIC X(10).
  1447
  1448         16  FILLER                         PIC X(43).
  1449
  1450         16  CF-LOSS-RATIO-SELECT.
  1451             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1452             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1453         16  CF-ENTRY-DATE-SELECT.
  1454             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1455             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1456         16  CF-EFFECTIVE-DATE-SELECT.
  1457             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1458             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1459
  1460         16  CF-EXCEPTION-LIST-IND          PIC X.
  1461             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1462
  1463         16  FILLER                         PIC X(318).
  1464
  1465****************************************************************
  1466*                  EXCEPTION REPORTING RECORD                  *
  1467****************************************************************
  1468
  1469     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1470         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1471             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1472
  1473         16  CF-COMBINED-LIFE-AH-OPT.
  1474             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1475             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1476             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1477             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1478
  1479         16  CF-LIFE-OPT.
  1480             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  28
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1481             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1482             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1483             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1484             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1485             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1486             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1487             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1488             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1489             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1490
  1491         16  CF-AH-OPT.
  1492             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1493             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1494             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1495             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1496             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1497             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1498             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1499             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1500             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1501             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1502
  1503         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1504             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1505             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1506             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1507
  1508         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1509
  1510         16  FILLER                         PIC X(673).
  1511
  1512
  1513****************************************************************
  1514*             MORTGAGE SYSTEM PLAN RECORD                      *
  1515****************************************************************
  1516
  1517     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1518         16  CF-PLAN-TYPE                   PIC X.
  1519             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1520             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1521             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1522         16  CF-PLAN-ABBREV                 PIC XXX.
  1523         16  CF-PLAN-DESCRIPT               PIC X(10).
  1524         16  CF-PLAN-NOTES                  PIC X(20).
  1525         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1526         16  CF-PLAN-UNDERWRITING.
  1527             20  CF-PLAN-TERM-DATA.
  1528                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1529                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1530             20  CF-PLAN-AGE-DATA.
  1531                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1532                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1533                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1534             20  CF-PLAN-BENEFIT-DATA.
  1535                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1536                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1537                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1538                                            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  29
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1539         16  CF-PLAN-POLICY-FORMS.
  1540             20  CF-POLICY-FORM             PIC X(12).
  1541             20  CF-MASTER-APPLICATION      PIC X(12).
  1542             20  CF-MASTER-POLICY           PIC X(12).
  1543         16  CF-PLAN-RATING.
  1544             20  CF-RATE-CODE               PIC X(5).
  1545             20  CF-SEX-RATING              PIC X.
  1546                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1547                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1548             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1549             20  CF-SUB-STD-TYPE            PIC X.
  1550                 88  CF-PCT-OF-PREM            VALUE '1'.
  1551                 88  CF-PCT-OF-BENE            VALUE '2'.
  1552         16  CF-PLAN-PREM-TOLERANCES.
  1553             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1554             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1555         16  CF-PLAN-PYMT-TOLERANCES.
  1556             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1557             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1558         16  CF-PLAN-MISC-DATA.
  1559             20  FILLER                     PIC X.
  1560             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1561             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1562         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1563         16  CF-PLAN-IND-GRP                PIC X.
  1564             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1565                                                     '1'.
  1566             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1567                                                     '2'.
  1568         16  CF-MIB-SEARCH-SW               PIC X.
  1569             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1570             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1571             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1572             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1573         16  CF-ALPHA-SEARCH-SW             PIC X.
  1574             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1575             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1576             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1577             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1578             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1579             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1580             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1581             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1582             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1583             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1584                                                     'A' 'B' 'C'
  1585                                                     'X' 'Y' 'Z'.
  1586         16  CF-EFF-DT-RULE-SW              PIC X.
  1587             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1588             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1589             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1590             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1591             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1592         16  FILLER                         PIC X(4).
  1593         16  CF-HEALTH-QUESTIONS            PIC X.
  1594             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1595         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1596         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  30
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1597         16  CF-PLAN-SNGL-JNT               PIC X.
  1598             88  CF-COMBINED-PLAN              VALUE 'C'.
  1599             88  CF-JNT-PLAN                   VALUE 'J'.
  1600             88  CF-SNGL-PLAN                  VALUE 'S'.
  1601         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1602         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1603         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1604         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1605         16  CF-RERATE-CNTL                 PIC  X.
  1606             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1607             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1608             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1609             88  CF-AUTO-RECALC                 VALUE '4'.
  1610         16  CF-BENEFIT-TYPE                PIC  X.
  1611             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1612             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1613         16  CF-POLICY-FEE                  PIC S999V99
  1614                                                    COMP-3.
  1615         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1616         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1617         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1618         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1619         16  FILLER                         PIC  X(32).
  1620         16  CF-TERMINATION-FORM            PIC  X(04).
  1621         16  FILLER                         PIC  X(08).
  1622         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1623                                                       COMP-3.
  1624         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1625         16  CF-ISSUE-LETTER                PIC  X(4).
  1626         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1627         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1628             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1629             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1630         16  CF-MP-REFUND-CALC              PIC X.
  1631             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1632             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1633             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1634             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1635             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1636             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1637             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1638             88  CF-MP-REFD-MEAN                VALUE '8'.
  1639         16  CF-ALT-RATE-CODE               PIC  X(5).
  1640
  1641
  1642         16  FILLER                         PIC X(498).
  1643****************************************************************
  1644*             MORTGAGE COMPANY MASTER RECORD                   *
  1645****************************************************************
  1646
  1647     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1648         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1649         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1650             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1651             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1652             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1653             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1654             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  31
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1655
  1656         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1657         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1658         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1659         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1660         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1661
  1662         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1663             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1664         16  CF-MP-RECON-USE-IND            PIC X(1).
  1665             88  CF-MP-USE-RECON             VALUE 'Y'.
  1666         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1667             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1668         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1669             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1670             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1671         16  FILLER                         PIC X(1).
  1672         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1673             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1674         16  CF-MORTG-MIB-VERSION           PIC X.
  1675             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1676             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1677             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1678         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1679             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1680                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1681             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1682                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1683             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1684                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1685             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1686                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1687             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1688                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1689             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1690                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1691         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1692         16  FILLER                         PIC X(7).
  1693         16  CF-MORTG-DESTINATION-SYMBOL.
  1694             20  CF-MORTG-MIB-COMM          PIC X(5).
  1695             20  CF-MORTG-MIB-TERM          PIC X(5).
  1696         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1697             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1698         16  FILLER                         PIC X(03).
  1699         16  CF-MP-CHECK-NO-CONTROL.
  1700             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1701                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1702                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1703                                                ' ' LOW-VALUES.
  1704                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1705                                               VALUE '3'.
  1706         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1707         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1708         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1709             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1710                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1711             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1712                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  32
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1713             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1714                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1715             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1716                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1717             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1718                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1719             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1720                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1721         16  CF-MORTG-BILLING-AREA.
  1722             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1723                                            PIC X.
  1724         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1725         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  1726         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1727         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1728             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1729             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1730         16  FILLER                         PIC X.
  1731         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1732             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  1733             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1734         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1735         16  FILLER                         PIC X(8).
  1736         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1737         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1738         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1739         16  CF-ACH-COMPANY-ID.
  1740             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1741                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1742                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1743                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1744             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1745         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1746             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1747         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1748             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  1749             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1750         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1751         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1752         16  FILLER                         PIC X(536).
  1753
  1754****************************************************************
  1755*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1756****************************************************************
  1757
  1758     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1759         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  1760             20  CF-FEMALE-HEIGHT.
  1761                 24  CF-FEMALE-FT           PIC 99.
  1762                 24  CF-FEMALE-IN           PIC 99.
  1763             20  CF-FEMALE-MIN-WT           PIC 999.
  1764             20  CF-FEMALE-MAX-WT           PIC 999.
  1765         16  FILLER                         PIC X(428).
  1766
  1767     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1768         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1769             20  CF-MALE-HEIGHT.
  1770                 24  CF-MALE-FT             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  33
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1771                 24  CF-MALE-IN             PIC 99.
  1772             20  CF-MALE-MIN-WT             PIC 999.
  1773             20  CF-MALE-MAX-WT             PIC 999.
  1774         16  FILLER                         PIC X(428).
  1775******************************************************************
  1776*             AUTOMATIC ACTIVITY RECORD                          *
  1777******************************************************************
  1778     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1779         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1780             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1781             20  CF-SYS-LETTER-ID           PIC X(04).
  1782             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1783             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  1784             20  CF-SYS-RESET-SW            PIC X(01).
  1785             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1786             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1787
  1788         16  FILLER                         PIC X(50).
  1789
  1790         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  1791             20  CF-USER-ACTIVE-SW          PIC X(01).
  1792             20  CF-USER-LETTER-ID          PIC X(04).
  1793             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1794             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1795             20  CF-USER-RESET-SW           PIC X(01).
  1796             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1797             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1798             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1799
  1800         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  34
* EL517.cbl
  1802 FD  ERPNDB.
* 1803                                  COPY ERCPNDB.
  1804******************************************************************
  1805*                                                                *
  1806*                                                                *
  1807*                            ERCPNDB.                            *
  1808*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1809*                            VMOD=2.025                          *
  1810*                                                                *
  1811*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1812*                                                                *
  1813******************************************************************
  1814*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1815*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1816******************************************************************
  1817*                                                                *
  1818*                                                                *
  1819*   FILE TYPE = VSAM,KSDS                                        *
  1820*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1821*                                                                *
  1822*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1823*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1824*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1825*                                                 RKP=13,LEN=36  *
  1826*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1827*                                      AND CHG-SEQ.)             *
  1828*                                                RKP=49,LEN=11   *
  1829*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1830*                                      AND CHG-SEQ.)             *
  1831*                                                RKP=60,LEN=15   *
  1832*                                                                *
  1833*   LOG = NO                                                     *
  1834*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1835******************************************************************
  1836******************************************************************
  1837*                   C H A N G E   L O G
  1838*
  1839* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1840*-----------------------------------------------------------------
  1841*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1842* EFFECTIVE    NUMBER
  1843*-----------------------------------------------------------------
  1844* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1845* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1846* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1847* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1848* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1849* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1850* 032306                   PEMA  ADD BOW LOAN NUMBER
  1851* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1852* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1853* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1854* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1855* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1856* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  1857* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1858* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1859******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  35
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1860
  1861 01  PENDING-BUSINESS.
  1862     12  PB-RECORD-ID                     PIC XX.
  1863         88  VALID-PB-ID                        VALUE 'PB'.
  1864
  1865     12  PB-CONTROL-PRIMARY.
  1866         16  PB-COMPANY-CD                PIC X.
  1867         16  PB-ENTRY-BATCH               PIC X(6).
  1868         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1869         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1870
  1871     12  PB-CONTROL-BY-ACCOUNT.
  1872         16  PB-COMPANY-CD-A1             PIC X.
  1873         16  PB-CARRIER                   PIC X.
  1874         16  PB-GROUPING.
  1875             20  PB-GROUPING-PREFIX       PIC XXX.
  1876             20  PB-GROUPING-PRIME        PIC XXX.
  1877         16  PB-STATE                     PIC XX.
  1878         16  PB-ACCOUNT.
  1879             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1880             20  PB-ACCOUNT-PRIME         PIC X(6).
  1881         16  PB-CERT-EFF-DT               PIC XX.
  1882         16  PB-CERT-NO.
  1883             20  PB-CERT-PRIME            PIC X(10).
  1884             20  PB-CERT-SFX              PIC X.
  1885         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1886
  1887         16  PB-RECORD-TYPE               PIC X.
  1888             88  PB-MAILING-DATA                VALUE '0'.
  1889             88  PB-ISSUE                       VALUE '1'.
  1890             88  PB-CANCELLATION                VALUE '2'.
  1891             88  PB-BATCH-TRAILER               VALUE '9'.
  1892
  1893     12  PB-CONTROL-BY-ORIG-BATCH.
  1894         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1895         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1896         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1897         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1898
  1899     12  PB-CONTROL-BY-CSR.
  1900         16  PB-CSR-COMPANY-CD            PIC X.
  1901         16  PB-CSR-ID                    PIC X(4).
  1902         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1903         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1904         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1905******************************************************************
  1906*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1907******************************************************************
  1908
  1909     12  PB-LAST-MAINT-DT                 PIC XX.
  1910     12  PB-LAST-MAINT-BY                 PIC X(4).
  1911     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1912
  1913     12  PB-RECORD-BODY                   PIC X(375).
  1914
  1915     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1916         16  PB-CERT-ORIGIN               PIC X.
  1917             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  36
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1918         16  PB-I-NAME.
  1919             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1920             20  PB-I-INSURED-FIRST-NAME.
  1921                 24  PB-I-INSURED-1ST-INIT PIC X.
  1922                 24  FILLER                PIC X(9).
  1923             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1924         16  PB-I-AGE                     PIC S99   COMP-3.
  1925         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1926         16  PB-I-BIRTHDAY                PIC XX.
  1927         16  PB-I-INSURED-SEX             PIC X.
  1928             88  PB-SEX-MALE     VALUE 'M'.
  1929             88  PB-SEX-FEMALE   VALUE 'F'.
  1930
  1931         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1932         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1933         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1934         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1935         16  PB-I-SKIP-CODE               PIC X.
  1936             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1937             88  PB-SKIP-JULY              VALUE '1'.
  1938             88  PB-SKIP-AUGUST            VALUE '2'.
  1939             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1940             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1941             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1942             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1943             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1944             88  PB-SKIP-JUNE              VALUE '8'.
  1945             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1946             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1947             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1948         16  PB-I-TERM-TYPE               PIC X.
  1949             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1950             88  PB-PAID-WEEKLY            VALUE 'W'.
  1951             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1952             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1953             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1954         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1955         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1956         16  PB-I-DATA-ENTRY-SW           PIC X.
  1957             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1958             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1959             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1960             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1961         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1962         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1963*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1964         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1965         16  FILLER                       PIC X.
  1966
  1967         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1968             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1969             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1970                                                   '90' THRU '99'.
  1971         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1972                                          PIC XX.
  1973         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1974         16  PB-I-AMOUNT-FINANCED REDEFINES
  1975                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  37
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1976         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1977         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1978                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1979         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1980         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1981         16  PB-I-CLP-AMOUNT REDEFINES
  1982                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1983         16  PB-I-LF-CALC-FLAG            PIC X.
  1984             88 PB-COMP-LF-PREM               VALUE '?'.
  1985         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1986         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1987         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1988         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1989         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1990         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1991         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1992         16  PB-I-LF-ABBR                 PIC XXX.
  1993         16  PB-I-LF-INPUT-CD             PIC XX.
  1994
  1995         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1996             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  1997             88  PB-INVALID-AH               VALUE '  ' '00'
  1998                                                   '90' THRU '99'.
  1999         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2000         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2001         16  PB-I-AH-CALC-FLAG            PIC X.
  2002             88 PB-COMP-AH-PREM                  VALUE '?'.
  2003         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2004         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2005         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2006         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2007         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2008         16  PB-I-AH-ABBR                 PIC XXX.
  2009         16  PB-I-AH-INPUT-CD             PIC XXX.
  2010
  2011         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2012         16  PB-I-REIN-TABLE              PIC XXX.
  2013         16  PB-I-BUSINESS-TYPE           PIC 99.
  2014         16  PB-I-INDV-GRP-CD             PIC X.
  2015         16  PB-I-MORT-CODE.
  2016             20  PB-I-TABLE               PIC X.
  2017             20  PB-I-INTEREST            PIC XX.
  2018             20  PB-I-MORT-TYP            PIC X.
  2019         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2020         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2021         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2022         16  PB-I-INDV-GRP-OVRD           PIC X.
  2023         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2024         16  PB-I-SIG-SW                  PIC X.
  2025             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2026         16  PB-I-RATE-CLASS              PIC XX.
  2027         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2028         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2029         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2030         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2031         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2032         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2033         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  38
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2034         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2035         16  PB-I-OB-FLAG                 PIC X.
  2036             88  PB-I-OB                      VALUE 'B'.
  2037             88  PB-I-SUMMARY                 VALUE 'Z'.
  2038         16  PB-I-ENTRY-STATUS            PIC X.
  2039             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2040                                              'M' '5' '9' '2'.
  2041             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2042             88  PB-I-POLICY-PENDING          VALUE '2'.
  2043             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2044             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2045             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2046             88  PB-I-REIN-ONLY               VALUE '9'.
  2047             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2048             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2049             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2050             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2051         16  PB-I-INT-CODE                PIC X.
  2052             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2053             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2054         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2055         16  PB-I-SOC-SEC-NO              PIC X(11).
  2056         16  PB-I-MEMBER-NO               PIC X(12).
  2057         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2058*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2059         16  PB-I-OLD-LOF                 PIC XXX.
  2060         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2061         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2062         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2063         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2064         16  PB-I-LIFE-INDICATOR          PIC X.
  2065             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2066         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2067         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2068                                          PIC S9(5)V99    COMP-3.
  2069         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2070             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2071             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2072         16  PB-I-1ST-PMT-DT              PIC XX.
  2073         16  PB-I-JOINT-INSURED.
  2074             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2075             20 PB-I-JOINT-FIRST-NAME.
  2076                24  PB-I-JOINT-FIRST-INIT PIC X.
  2077                24  FILLER                PIC X(9).
  2078             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2079*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2080         16  PB-I-BENEFICIARY-NAME.
  2081             20  PB-I-BANK-NUMBER         PIC X(10).
  2082             20  FILLER                   PIC X(15).
  2083         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2084         16  PB-I-REFERENCE               PIC X(12).
  2085         16  FILLER REDEFINES PB-I-REFERENCE.
  2086             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2087             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2088             20  PB-I-CLP-STATE           PIC XX.
  2089         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2090             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2091             88  PB-I-POLICY-DECLINED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  39
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2092             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2093         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2094         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2095         16  PB-I-RESIDENT-STATE          PIC XX.
  2096         16  PB-I-RATE-CODE               PIC X(4).
  2097         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2098         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2099         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2100         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2101         16  PB-I-BANK-NOCHRGB            PIC 99.
  2102         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2103         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2104
  2105     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2106         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2107             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2108         16  PB-C-CANCEL-ORIGIN           PIC X.
  2109             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2110         16  PB-C-LF-CANCEL-DT            PIC XX.
  2111         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2112         16  PB-C-LF-CALC-REQ             PIC X.
  2113             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2114         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2115         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2116         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2117             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2118         16  PB-C-AH-CANCEL-DT            PIC XX.
  2119         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2120         16  PB-C-AH-CALC-REQ             PIC X.
  2121             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2122         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2123         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2124         16  PB-C-LAST-NAME               PIC X(15).
  2125         16  PB-C-REFUND-SW               PIC X.
  2126             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2127             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2128         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2129         16  PB-C-PAYEE-CODE              PIC X(6).
  2130         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2131         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2132         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2133         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2134         16  PB-C-REFERENCE               PIC X(12).
  2135         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2136         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2137         16  PB-C-POST-CARD-IND           PIC X.
  2138         16  PB-C-CANCEL-REASON           PIC X.
  2139         16  PB-C-REF-INTERFACE-SW        PIC X.
  2140         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2141         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2142         16  FILLER                       PIC X(01).
  2143*        16  FILLER                       PIC X(18).
  2144         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2145*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2146         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2147         16  PB-CANCELED-CERT-DATA.
  2148             20  PB-CI-INSURED-NAME.
  2149                 24  PB-CI-LAST-NAME      PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  40
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2150                 24  PB-CI-INITIALS       PIC XX.
  2151             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2152             20  PB-CI-INSURED-SEX        PIC X.
  2153             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2154             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2155             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2156             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2157             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2158             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2159             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2160             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2161             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2162             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2163             20  PB-CI-RATE-CLASS         PIC XX.
  2164             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2165             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2166             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2167             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2168             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2169             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2170             20  PB-CI-LF-ABBR            PIC X(3).
  2171             20  PB-CI-AH-ABBR            PIC X(3).
  2172             20  PB-CI-OB-FLAG            PIC X.
  2173                 88  PB-CI-OB                VALUE 'B'.
  2174             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2175                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2176                                           'M' '4' '5' '9' '2'.
  2177                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2178                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2179                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2180                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2181                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2182                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2183                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2184                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2185                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2186                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2187                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2188                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2189             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2190                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2191                                           'M' '4' '5' '9' '2'.
  2192                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2193                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2194                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2195                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2196                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2197                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2198                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2199                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2200                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2201                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2202                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2203                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2204             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2205             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2206             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2207             20  PB-CI-MEMBER-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  41
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2208             20  PB-CI-INT-CODE           PIC X.
  2209                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2210                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2211             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2212             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2213             20  PB-CI-COMP-EXCP-SW       PIC X.
  2214                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2215                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2216             20  PB-CI-ENTRY-STATUS       PIC X.
  2217             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2218             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2219             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2220             20  PB-CI-DEATH-DT           PIC XX.
  2221             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2222             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2223             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2224             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2225             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2226             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2227             20  PB-CI-ENTRY-DT              PIC XX.
  2228             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2229             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2230             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2231             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2232             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2233             20  PB-CI-OLD-LOF               PIC XXX.
  2234*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2235             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2236             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2237             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2238             20  PB-CI-INDV-GRP-CD           PIC X.
  2239             20  PB-CI-BENEFICIARY-NAME.
  2240                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2241                 24  FILLER                  PIC X(15).
  2242             20  PB-CI-NOTE-SW               PIC X.
  2243             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2244             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2245             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2246             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2247             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2248             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2249             20  PB-CI-FIRST-NAME            PIC X(10).
  2250             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2251
  2252         16  FILLER                       PIC X(13).
  2253*032306  16  FILLER                       PIC X(27).
  2254*        16  FILLER                       PIC X(46).
  2255
  2256     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2257         16  FILLER                       PIC X(10).
  2258         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2259         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2260         16  PB-M-INSURED-MID-INIT        PIC X.
  2261         16  PB-M-INSURED-AGE             PIC 99.
  2262         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2263         16  PB-M-INSURED-SEX             PIC X.
  2264         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2265         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  42
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2266         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2267         16  PB-M-INSURED-CITY-STATE.
  2268             20  PB-M-INSURED-CITY        PIC X(28).
  2269             20  PB-M-INSURED-STATE       PIC XX.
  2270         16  PB-M-INSURED-ZIP-CODE.
  2271             20  PB-M-INSURED-ZIP-PRIME.
  2272                 24  PB-M-INSURED-ZIP-1   PIC X.
  2273                     88  PB-M-CANADIAN-POST-CODE
  2274                                             VALUE 'A' THRU 'Z'.
  2275                 24  FILLER               PIC X(4).
  2276             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2277         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2278                                        PB-M-INSURED-ZIP-CODE.
  2279             20  PM-M-INS-CAN-POST1       PIC XXX.
  2280             20  PM-M-INS-CAN-POST2       PIC XXX.
  2281             20  FILLER                   PIC XXX.
  2282         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2283         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2284         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2285         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2286         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2287         16  PB-M-CRED-BENE-CITYST.
  2288             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2289             20  PB-M-CRED-BENE-STATE     PIC XX.
  2290
  2291         16  FILLER                       PIC X(92).
  2292
  2293     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2294         16  FILLER                       PIC X(10).
  2295         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2296         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2297         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2298         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2299         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2300         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2301         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2302         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2303         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2304         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2305         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2306         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2307         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2308         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2309         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2310         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2311         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2312         16  PB-ACCOUNT-NAME              PIC X(30).
  2313         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2314         16  PB-REFERENCE                 PIC X(12).
  2315         16  PB-B-RECEIVED-DT             PIC XX.
  2316         16  FILLER                       PIC X(234).
  2317
  2318     12  PB-RECORD-STATUS.
  2319         16  PB-CREDIT-SELECT-DT          PIC XX.
  2320         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2321         16  PB-BILLED-DT                 PIC XX.
  2322         16  PB-BILLING-STATUS            PIC X.
  2323             88  PB-ENTRY-REVERSED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  43
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2324             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2325             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2326         16  PB-RECORD-BILL               PIC X.
  2327             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2328             88  PB-RECORD-RETURNED           VALUE 'R'.
  2329             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2330             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2331             88  PB-OVERRIDE-AH               VALUE 'A'.
  2332             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2333         16  PB-BATCH-ENTRY               PIC X.
  2334             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2335             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2336             88  PB-REISSUED-CERT             VALUE 'E'.
  2337             88  PB-MONTHLY-CERT              VALUE 'M'.
  2338             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2339             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2340             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2341         16  PB-FORCE-CODE                PIC X.
  2342             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2343             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2344             88  PB-CANCEL-FORCE              VALUE '8'.
  2345             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2346             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2347             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2348             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2349             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2350             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2351             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2352         16  PB-FATAL-FLAG                PIC X.
  2353             88  PB-FATAL-ERRORS              VALUE 'X'.
  2354         16  PB-FORCE-ER-CD               PIC X.
  2355             88  PB-FORCE-ERRORS              VALUE 'F'.
  2356             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2357         16  PB-WARN-ER-CD                PIC X.
  2358             88  PB-WARNING-ERRORS            VALUE 'W'.
  2359         16  FILLER                       PIC X.
  2360         16  PB-OUT-BAL-CD                PIC X.
  2361             88  PB-OUT-OF-BAL                VALUE 'O'.
  2362         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2363         16  PB-AH-OVERRIDE-L1            PIC X.
  2364         16  PB-INPUT-DT                  PIC XX.
  2365         16  PB-INPUT-BY                  PIC X(4).
  2366         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2367         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2368         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2369         16  PB-LF-EARNING-METHOD         PIC X.
  2370         16  PB-AH-EARNING-METHOD         PIC X.
  2371         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2372         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2373         16  PB-REIN-CD                   PIC XXX.
  2374         16  PB-LF-REFUND-TYPE            PIC X.
  2375         16  PB-AH-REFUND-TYPE            PIC X.
  2376         16  PB-ACCT-EFF-DT               PIC XX.
  2377         16  PB-ACCT-EXP-DT               PIC XX.
  2378         16  PB-COMPANY-ID                PIC X(3).
  2379         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2380         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2381         16  PB-SV-CARRIER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  44
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2382         16  PB-SV-GROUPING               PIC X(6).
  2383         16  PB-SV-STATE                  PIC XX.
  2384         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2385         16  PB-GA-BILLING-INFO.
  2386             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2387                                          PIC XX.
  2388         16  PB-SV-REMIT-TO  REDEFINES
  2389             PB-GA-BILLING-INFO           PIC X(10).
  2390         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2391         16  PB-I-LOAN-OFFICER            PIC X(5).
  2392         16  PB-I-VIN                     PIC X(17).
  2393
  2394         16  FILLER                       PIC X(04).
  2395         16  IMNET-BYPASS-SW              PIC X.
  2396
  2397******************************************************************
  2398*                COMMON EDIT ERRORS                              *
  2399******************************************************************
  2400
  2401     12  PB-COMMON-ERRORS.
  2402         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2403                                           PIC S9(4)     COMP.
  2404
  2405******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  45
* EL517.cbl
  2407 FD  ERREIN.
* 2408                                  COPY ERCREIN.
  2409******************************************************************07/27/93
  2410*                                                                *ERCREIN
  2411*                            ERCREIN                             *   LV009
  2412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2413*                            VMOD=2.010                          *   CL**9
  2414*                                                                *ERCREIN
  2415*   ONLINE CREDIT SYSTEM                                         *ERCREIN
  2416*                                                                *ERCREIN
  2417*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
  2418*                                                                *ERCREIN
  2419*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
  2420*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
  2421*                                                                *ERCREIN
  2422*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
  2423*       ALTERNATE PATH = NONE                                    *ERCREIN
  2424*                                                                *ERCREIN
  2425*   LOG = NO                                                     *ERCREIN
  2426*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
  2427*                                                                *ERCREIN
  2428******************************************************************ERCREIN
  2429*                   C H A N G E   L O G
  2430*
  2431* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2432*-----------------------------------------------------------------
  2433*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2434* EFFECTIVE    NUMBER
  2435*-----------------------------------------------------------------
  2436* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  2437* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  2438******************************************************************
  2439 01  REINSURANCE-RECORD.                                          ERCREIN
  2440     12  RE-RECORD-ID                      PIC XX.                ERCREIN
  2441         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
  2442                                                                  ERCREIN
  2443     12  RE-CONTROL-PRIMARY.                                      ERCREIN
  2444         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
  2445         16  RE-KEY.                                              ERCREIN
  2446             20  RE-CODE                   PIC X.                 ERCREIN
  2447                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
  2448                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
  2449             20  RE-TABLE                  PIC XXX.               ERCREIN
  2450             20  FILLER                    PIC XXX.               ERCREIN
  2451         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
  2452             20  FILLER                    PIC X.                 ERCREIN
  2453             20  RE-COMPANY.                                      ERCREIN
  2454                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
  2455                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
  2456                                                                  ERCREIN
  2457     12  RE-MAINT-INFORMATION.                                    ERCREIN
  2458         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
  2459         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
  2460         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
  2461         16  FILLER                        PIC X(10).             ERCREIN
  2462                                                                  ERCREIN
  2463     12  RE-TABLE-DATA.                                           ERCREIN
  2464         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  46
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2465                                                                  ERCREIN
  2466         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
  2467             20  RE-REI-COMP-NO.                                  ERCREIN
  2468                 24  RE-REI-COMP           PIC XXX.               ERCREIN
  2469                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
  2470             20  RE-LF-QC                  PIC X.                 ERCREIN
  2471             20  RE-AH-QC                  PIC X.                 ERCREIN
  2472             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2473             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2474             20  RE-LFAGE-LO               PIC 99.                ERCREIN
  2475             20  RE-LFAGE-HI               PIC 99.                ERCREIN
  2476             20  RE-AHAGE-LO               PIC 99.                ERCREIN
  2477             20  RE-AHAGE-HI               PIC 99.                ERCREIN
  2478             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
  2479             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
  2480             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
  2481             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
  2482             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2483             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2484             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
  2485             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
  2486             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
  2487             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
  2488             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2489             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2490             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2491             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2492             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2493             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2494             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2495             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2496             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
  2497             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
  2498             20  RE-INTERACTIVE            PIC X.                 ERCREIN
  2499             20  RE-REMAINING              PIC X.                 ERCREIN
  2500             20  RE-LF-RUNOFF-SW           PIC X.                      000
  2501             20  RE-AH-RUNOFF-SW           PIC X.                      000
  2502             20  FILLER                    PIC X(19).                  000
  2503                                                                  ERCREIN
  2504         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
  2505         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
  2506         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
  2507         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
  2508             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
  2509                                                                  ERCREIN
  2510         16  FILLER                        PIC X(27).             ERCREIN
  2511                                                                  ERCREIN
  2512     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
  2513         16  RE-NAME                       PIC X(30).             ERCREIN
  2514         16  RE-LF-PE                      PIC X.                 ERCREIN
  2515         16  RE-AH-PE                      PIC X.                 ERCREIN
  2516         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2517         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2518         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2519         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2520         16  RE-PRT-ST                     PIC X.                 ERCREIN
  2521         16  RE-PRT-OW                     PIC X.                 ERCREIN
  2522         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  47
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2523         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
  2524         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
  2525         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
  2526         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
  2527         16  RE-LF-COMM                    PIC X.                 ERCREIN
  2528         16  RE-AH-COMM                    PIC X.                 ERCREIN
  2529         16  RE-LF-TAX                     PIC X.                 ERCREIN
  2530         16  RE-AH-TAX                     PIC X.                 ERCREIN
  2531         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
  2532         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2533         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2534                                                                  ERCREIN
  2535         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
  2536             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
  2537                                                                  ERCREIN
  2538         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
  2539             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
  2540                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2541                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2542                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2543                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2544             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
  2545                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
  2546                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
  2547                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2548                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
  2549                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2550                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2551                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2552                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2553             20  FILLER                    PIC XXX.               ERCREIN
  2554             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2555                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2556                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2557                                                                  ERCREIN
  2558         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
  2559             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
  2560                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2561                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2562                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2563                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2564             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
  2565                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
  2566                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
  2567                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2568                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
  2569                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2570                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2571                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2572                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2573             20  FILLER                    PIC XXX.               ERCREIN
  2574             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2575                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2576                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2577                                                                  ERCREIN
  2578         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
  2579                                                                  ERCREIN
  2580         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  48
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2581                                                                  ERCREIN
  2582         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2583         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2584         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2585         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2586         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2587         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2588         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
  2589         16  RE-MORT-SW                    PIC X.                 ERCREIN
  2590         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
  2591             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
  2592             88  RE-CEDED                          VALUE 'C'.        CL**2
  2593             88  RE-ASSUMED                        VALUE 'A'.        CL**2
  2594             88  RE-PHANTOM                        VALUE 'P'.        CL**2
  2595                                                                  ERCREIN
  2596         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
  2597             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
  2598         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
  2599             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
  2600         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
  2601             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
  2602         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
  2603             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  2604         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  2605             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  2606                                                                     CL**3
  2607         16  RE-PRT-CRSV                   PIC X.                    CL**5
  2608                                                                     CL**5
  2609         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  2610                                                                     CL**8
  2611         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  2612                                                                     CL**8
  2613         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  2614                                                                     CL**9
  2615         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  2616             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  2617             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  2618
  2619         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  2620             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  2621                                                                     CL**9
  2622         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  2623         16  FILLER                        PIC X(2281).              CL**9
  2624                                                                  ERCREIN
  2625         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  2626                                                                  ERCREIN
  2627******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  49
* EL517.cbl
  2629 FD  ELCERT.
* 2630                                  COPY ELCCERT.
  2631******************************************************************04/15/98
  2632*                                                                *ELCCERT
  2633*                            ELCCERT.                            *   LV002
  2634*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2635*                            VMOD=2.013                          *   CL**2
  2636*                                                                *ELCCERT
  2637*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
  2638*                                                                *ELCCERT
  2639*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
  2640*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
  2641*                                                                *ELCCERT
  2642*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
  2643*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
  2644*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
  2645*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
  2646*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
  2647*                                                                *ELCCERT
  2648*   LOG = YES                                                    *ELCCERT
  2649*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
  2650******************************************************************
  2651*                   C H A N G E   L O G
  2652*
  2653* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2654*-----------------------------------------------------------------
  2655*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2656* EFFECTIVE    NUMBER
  2657*-----------------------------------------------------------------
  2658* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2659* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2660* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2661* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2662* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2663* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2664* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2665* 032612  CR2011110200001  PEMA  AHL CHANGES
  2666******************************************************************
  2667                                                                  ELCCERT
  2668 01  CERTIFICATE-MASTER.                                          ELCCERT
  2669     12  CM-RECORD-ID                      PIC XX.                ELCCERT
  2670         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
  2671                                                                  ELCCERT
  2672     12  CM-CONTROL-PRIMARY.                                      ELCCERT
  2673         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
  2674         16  CM-CARRIER                    PIC X.                 ELCCERT
  2675         16  CM-GROUPING.                                         ELCCERT
  2676             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
  2677             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
  2678         16  CM-STATE                      PIC XX.                ELCCERT
  2679         16  CM-ACCOUNT.                                          ELCCERT
  2680             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
  2681             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
  2682         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
  2683         16  CM-CERT-NO.                                          ELCCERT
  2684             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
  2685             20  CM-CERT-SFX               PIC X.                 ELCCERT
  2686                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  50
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2687     12  CM-CONTROL-BY-NAME.                                      ELCCERT
  2688         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
  2689         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
  2690         16  CM-INSURED-INITIALS.                                 ELCCERT
  2691             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
  2692             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
  2693                                                                  ELCCERT
  2694     12  CM-CONTROL-BY-SSN.                                       ELCCERT
  2695         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
  2696         16  CM-SOC-SEC-NO.                                       ELCCERT
  2697             20  CM-SSN-STATE              PIC XX.                ELCCERT
  2698             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
  2699             20  CM-SSN-LN3.                                      ELCCERT
  2700                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
  2701                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
  2702                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
  2703                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
  2704                                                                  ELCCERT
  2705     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
  2706         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
  2707         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
  2708                                                                  ELCCERT
  2709     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
  2710         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
  2711         16  CM-MEMBER-NO.                                        ELCCERT
  2712             20  CM-MEMB-STATE             PIC XX.                ELCCERT
  2713             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
  2714             20  CM-MEMB-LN4.                                     ELCCERT
  2715                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
  2716                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
  2717                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
  2718                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
  2719                                                                  ELCCERT
  2720     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
  2721         16  CM-INSURED-FIRST-NAME.                               ELCCERT
  2722             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
  2723             20  FILLER                    PIC X(9).              ELCCERT
  2724         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
  2725         16  CM-INSURED-SEX                PIC X.                 ELCCERT
  2726             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
  2727             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
  2728         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
  2729         16  CM-JOINT-INSURED-NAME.                               ELCCERT
  2730             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
  2731             20  CM-JT-FIRST-NAME.                                ELCCERT
  2732                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
  2733                 24  FILLER                PIC X(9).              ELCCERT
  2734             20  CM-JT-INITIAL             PIC X.                 ELCCERT
  2735                                                                  ELCCERT
  2736     12  CM-LIFE-DATA.                                            ELCCERT
  2737         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
  2738         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2739         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2740         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
  2741         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
  2742         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2743         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
  2744         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  51
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2745         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
  2746         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2747         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2748         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2749         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2750         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2751         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2752         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2753         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
  2754         16  FILLER                        PIC XX.                ELCCERT
  2755                                                                  ELCCERT
  2756     12  CM-AH-DATA.                                              ELCCERT
  2757         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
  2758         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2759         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2760         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
  2761         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2762         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2763         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2764         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2765         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2766         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
  2767         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
  2768         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
  2769             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
  2770         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2771         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2772         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
  2773         16  FILLER                        PIC X.                 ELCCERT
  2774                                                                  ELCCERT
  2775     12  CM-LOAN-INFORMATION.                                     ELCCERT
  2776         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
  2777         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2778                                           PIC S9(5)V99  COMP-3.
  2779         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
  2780         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
  2781         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
  2782         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
  2783         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
  2784         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
  2785         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
  2786         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
  2787         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
  2788         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
  2789             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
  2790             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
  2791         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
  2792             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
  2793             20  CM-RATE-CODE              PIC X(4).              ELCCERT
  2794             20  FILLER                    PIC XX.                ELCCERT
  2795         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
  2796             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
  2797             20  FILLER                    PIC XXX.               ELCCERT
  2798         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
  2799         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
  2800             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
  2801         16  CM-POST-CARD-IND              PIC X.
  2802         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  52
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2803         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
  2804             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
  2805             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
  2806             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
  2807         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
  2808             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
  2809             88  CM-GROUP                     VALUE 'G'.          ELCCERT
  2810         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
  2811             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
  2812             88  SKIP-JULY                    VALUE '1'.          ELCCERT
  2813             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
  2814             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
  2815             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
  2816             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
  2817             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
  2818             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
  2819             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
  2820             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
  2821             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
  2822             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
  2823         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
  2824             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
  2825             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
  2826             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
  2827             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
  2828             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
  2829         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
  2830         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
  2831         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
  2832*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
  2833         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
  2834         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
  2835         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2836         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2837         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
  2838                                                                  ELCCERT
  2839     12  CM-STATUS-DATA.                                          ELCCERT
  2840         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
  2841         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
  2842                                                                  ELCCERT
  2843         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2844         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
  2845         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2846                                                                  ELCCERT
  2847         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
  2848         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
  2849         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
  2850                                                                  ELCCERT
  2851         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
  2852             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2853                                                'M' '4' '5' '9'.  ELCCERT
  2854             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2855             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
  2856             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2857             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2858             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2859             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2860             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  53
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2861             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2862             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2863             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2864             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
  2865             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
  2866                                                                  ELCCERT
  2867         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2868         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
  2869         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2870                                                                  ELCCERT
  2871         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
  2872         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
  2873         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
  2874                                                                  ELCCERT
  2875         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
  2876             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2877                                                'M' '4' '5' '9'.  ELCCERT
  2878             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2879             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
  2880             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2881             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2882             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2883             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2884             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
  2885             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2886             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2887             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2888             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
  2889             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
  2890                                                                  ELCCERT
  2891         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
  2892             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
  2893             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
  2894             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
  2895         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
  2896                                                                  ELCCERT
  2897         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
  2898         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
  2899         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
  2900         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
  2901                                                                  ELCCERT
  2902     12  CM-NOTE-SW                        PIC X.                 ELCCERT
  2903         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
  2904         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
  2905         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
  2906         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
  2907         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2908         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2909         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2910         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2911     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
  2912         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
  2913         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
  2914     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
  2915         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
  2916         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
  2917                                                                  ELCCERT
  2918*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  54
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2919     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2920     12  FILLER                            PIC X.
  2921                                                                  ELCCERT
  2922*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2923     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2924     12  FILLER                            PIC X.
  2925*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2926     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
  2927                                                                  ELCCERT
  2928     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
  2929         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
  2930         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
  2931         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
  2932         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
  2933         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
  2934     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
  2935         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
  2936         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
  2937         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
  2938         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
  2939         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
  2940         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
  2941         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
  2942         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
  2943                                                                  ELCCERT
  2944     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
  2945         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
  2946         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
  2947                                                                  ELCCERT
  2948     12  CM-USER-FIELD                     PIC X.                 ELCCERT
  2949     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2950     12  CM-CLP-STATE                      PIC XX.
  2951     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2952     12  CM-USER-RESERVED                  PIC XXX.
  2953     12  FILLER REDEFINES CM-USER-RESERVED.
  2954         16  CM-AH-CLASS-CD                PIC XX.
  2955         16  F                             PIC X.
  2956******************************************************************ELCCERT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  55
* EL517.cbl
  2958 FD  ELMSTR.
* 2959                                  COPY ELCMSTR.
  2960******************************************************************04/15/98
  2961*                                                                *ELCMSTR
  2962*                            ELCMSTR.                            *   LV002
  2963*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2964*                            VMOD=2.012                          *   CL**2
  2965*                                                                *ELCMSTR
  2966*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  2967*                                                                *ELCMSTR
  2968*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  2969*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  2970*                                                                *ELCMSTR
  2971*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  2972*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  2973*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  2974*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  2975*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  2976*                                                 RKP=75,LEN=21  *ELCMSTR
  2977*                                                                *ELCMSTR
  2978*   **** NOTE ****                                               *ELCMSTR
  2979*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  2980*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  2981*                                                                *ELCMSTR
  2982*   LOG = YES                                                    *ELCMSTR
  2983*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  2984******************************************************************
  2985*                   C H A N G E   L O G
  2986*
  2987* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2988*-----------------------------------------------------------------
  2989*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2990* EFFECTIVE    NUMBER
  2991*-----------------------------------------------------------------
  2992* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2993* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  2994******************************************************************ELCMSTR
  2995 01  CLAIM-MASTER.                                                ELCMSTR
  2996     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  2997         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  2998                                                                  ELCMSTR
  2999     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  3000         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  3001         16  CL-CARRIER              PIC X.                       ELCMSTR
  3002         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  3003         16  CL-CERT-NO.                                          ELCMSTR
  3004             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  3005             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  3006                                                                  ELCMSTR
  3007     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  3008         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  3009         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  3010         16  CL-INSURED-NAME.                                     ELCMSTR
  3011             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  3012             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  3013                                                                  ELCMSTR
  3014     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
  3015         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  56
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3016         16  CL-SOC-SEC-NO.                                       ELCMSTR
  3017             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  3018             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  3019             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  3020                                                                  ELCMSTR
  3021     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  3022         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  3023         16  CL-CERT-NO-A4.                                       ELCMSTR
  3024             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  3025             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  3026                                                                  ELCMSTR
  3027     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  3028         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  3029         16  CL-CCN-A5.                                           ELCMSTR
  3030             20  CL-CCN.                                          ELCMSTR
  3031                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  3032                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  3033             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  3034                                                                  ELCMSTR
  3035     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  3036         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  3037         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  3038             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  3039             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  3040             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  3041         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  3042         16  FILLER                  PIC X(5).                    ELCMSTR
  3043                                                                  ELCMSTR
  3044     12  CL-PROCESSING-INFO.                                      ELCMSTR
  3045         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  3046         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  3047             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  3048             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  3049         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  3050*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  3051*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  3052*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  3053*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  3054*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  3055         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  3056             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  3057             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  3058             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  3059         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  3060         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  3061         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  3062         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  3063         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  3064         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  3065         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  3066         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  3067         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  3068         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  3069         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  3070             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  3071             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
  3072             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
  3073         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  57
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3074                                                                  ELCMSTR
  3075         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  3076             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  3077             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  3078                                                                  ELCMSTR
  3079         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  3080             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  3081             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  3082                                                                  ELCMSTR
  3083         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  3084         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  3085         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  3086                                                                  ELCMSTR
  3087         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  3088         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  3089         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  3090             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  3091             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  3092             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  3093             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  3094             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  3095             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  3096         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  3097         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  3098         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  3099             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  3100         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3101         16  FILLER                  PIC X.
  3102                                                                  ELCMSTR
  3103     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  3104         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  3105             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  3106             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  3107             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  3108         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  3109             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  3110             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  3111             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  3112             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  3113                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  3114                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  3115             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  3116                                                                  ELCMSTR
  3117     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  3118         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  3119             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  3120             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  3121         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  3122             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  3123             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  3124         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  3125         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  3126         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
  3127         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  3128         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  3129         16  FILLER                  PIC XX.                      ELCMSTR
  3130         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  3131         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  58
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3132         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  3133         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  3134             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  3135             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  3136             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  3137             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  3138             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  3139             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  3140             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  3141             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  3142             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  3143         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  3144         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  3145         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  3146         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  3147         16  CL-DENIAL-TYPE          PIC X.
  3148             88  CL-TYPE-DENIAL          VALUE '1'.
  3149             88  CL-TYPE-RESCISSION      VALUE '2'.
  3150             88  CL-TYPE-REFORMATION     VALUE '3'.
  3151             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3152             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3153         16  FILLER                  PIC X(5).                    ELCMSTR
  3154                                                                  ELCMSTR
  3155     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  3156         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  3157             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  3158             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  3159             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  3160         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  3161         16  FILLER                  PIC XX.                      ELCMSTR
  3162         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  3163         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  3164             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3165                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  3166             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3167                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  3168             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  3169                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  3170             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  3171                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  3172             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  3173                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  3174             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3175                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  3176             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3177                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  3178                                                                  ELCMSTR
  3179     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  3180         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
  3181         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  3182                                                                  ELCMSTR
  3183     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  3184                                                                  ELCMSTR
  3185     12  CL-PROCESS-ERRORS.                                       ELCMSTR
  3186         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  3187             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  3188         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  3189             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  59
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3190                                                                  ELCMSTR
  3191     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  3192                                                                  ELCMSTR
  3193     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  3194         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  3195         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  3196         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  3197         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  3198                                                                  ELCMSTR
  3199     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  3200         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  3201         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  3202         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  3203         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  3204                                                                  ELCMSTR
  3205     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  3206     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  3207     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  3208                                                                  ELCMSTR
  3209     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  3210     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  3211     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  3212     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  3213                                                                  ELCMSTR
  3214*    12  FILLER                      PIC X(5).                    ELCMSTR
  3215     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  3216     12  FILLER                      PIC X(4).                    ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  60
* EL517.cbl
  3218 FD  ERCTBL.
* 3219                                 COPY ERCCTBL.
  3220******************************************************************04/29/98
  3221*                                                                *ERCCTBL
  3222*                                                                *ERCCTBL
  3223*                            ERCCTBL                             *   LV002
  3224*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3225*                            VMOD=2.003                              CL**2
  3226*                                                                *ERCCTBL
  3227*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  3228*                                                                *ERCCTBL
  3229*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  3230*                                                                *ERCCTBL
  3231*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  3232*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  3233*                                                                *ERCCTBL
  3234*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  3235*       ALTERNATE PATH = NONE                                    *ERCCTBL
  3236*                                                                *ERCCTBL
  3237*   LOG = NO                                                     *ERCCTBL
  3238*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  3239*                                                                *ERCCTBL
  3240*                                                                *ERCCTBL
  3241******************************************************************ERCCTBL
  3242                                                                  ERCCTBL
  3243 01  COMM-TABLE-RECORD.                                           ERCCTBL
  3244     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  3245         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  3246                                                                  ERCCTBL
  3247     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  3248         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  3249         16  CT-TABLE                      PIC XXX.               ERCCTBL
  3250         16  CT-CNTRL-2.                                          ERCCTBL
  3251             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  3252             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  3253                                                                  ERCCTBL
  3254     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  3255         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  3256         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  3257         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  3258         16  FILLER                        PIC X(31).             ERCCTBL
  3259                                                                  ERCCTBL
  3260     12  CT-LIMITS.                                               ERCCTBL
  3261         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  3262                                                                  ERCCTBL
  3263         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  3264                                                                  ERCCTBL
  3265         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  3266                                                                  ERCCTBL
  3267     12  CT-RATES.                                                ERCCTBL
  3268         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  3269             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  3270             20  CT-RT-R   REDEFINES                              ERCCTBL
  3271                 CT-RT                     PIC XXX.               ERCCTBL
  3272                                                                  ERCCTBL
  3273     12  FILLER                            PIC  X(42).            ERCCTBL
  3274                                                                  ERCCTBL
  3275******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  61
* EL517.cbl
  3276
  3277 FD  ERACCT.
* 3278                                 COPY ERCACCT.
  3279******************************************************************04/19/98
  3280*                                                                *ERCACCT
  3281*                                                                *ERCACCT
  3282*                            ERCACCT                             *   LV031
  3283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  3284*                            VMOD=2.031                          *ERCACCT
  3285*                                                                *ERCACCT
  3286*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  3287*                                                                *ERCACCT
  3288*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  3289*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  3290*                                                                *ERCACCT
  3291*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  3292*                                                                *ERCACCT
  3293*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  3294*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  3295*                                                                *ERCACCT
  3296*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  3297*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  3298*                                                                *ERCACCT
  3299*   LOG = NO                                                     *ERCACCT
  3300*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  3301*                                                                *ERCACCT
  3302*                                                                *ERCACCT
  3303******************************************************************ERCACCT
  3304*                   C H A N G E   L O G
  3305*
  3306* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3307*-----------------------------------------------------------------
  3308*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3309* EFFECTIVE    NUMBER
  3310*-----------------------------------------------------------------
  3311* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3312* 092705    2005050300006  PEMA  ADD SPP LEASES
  3313* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3314* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3315* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3316* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3317* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3318******************************************************************
  3319                                                                  ERCACCT
  3320 01  ACCOUNT-MASTER.                                              ERCACCT
  3321     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  3322         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  3323                                                                  ERCACCT
  3324     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  3325         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  3326         16  AM-MSTR-CNTRL.                                       ERCACCT
  3327             20  AM-CONTROL-A.                                    ERCACCT
  3328                 24  AM-CARRIER            PIC X.                 ERCACCT
  3329                 24  AM-GROUPING.                                 ERCACCT
  3330                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  3331                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  3332                 24  AM-STATE              PIC XX.                ERCACCT
  3333                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  62
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3334                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  3335                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  3336             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  3337                                           PIC X(19).             ERCACCT
  3338             20  AM-CNTRL-B.                                      ERCACCT
  3339                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  3340                 24  FILLER                PIC X(4).              ERCACCT
  3341             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  3342                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  3343                                                                  ERCACCT
  3344     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  3345         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  3346         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  3347         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  3348         16  AM-VG-STATE                   PIC XX.                ERCACCT
  3349         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  3350         16  AM-VG-DATE.                                          ERCACCT
  3351             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  3352             20  FILLER                    PIC X(4).              ERCACCT
  3353         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  3354                                           PIC 9(11)      COMP-3. ERCACCT
  3355     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3356         16  FILLER                        PIC X(10).
  3357         16  AM-VG-KEY3.
  3358             20  AM-VG3-ACCOUNT            PIC X(10).
  3359             20  AM-VG3-EXP-DT             PIC XX.
  3360         16  FILLER                        PIC X(4).
  3361     12  AM-MAINT-INFORMATION.                                    ERCACCT
  3362         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  3363         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  3364         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  3365         16  FILLER                        PIC XX.                ERCACCT
  3366                                                                  ERCACCT
  3367     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  3368     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  3369                                                                  ERCACCT
  3370     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  3371         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  3372         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  3373                                                                  ERCACCT
  3374     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  3375     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  3376                                                                  ERCACCT
  3377     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  3378     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  3379                                                                  ERCACCT
  3380     12  AM-NAME                           PIC X(30).             ERCACCT
  3381     12  AM-PERSON                         PIC X(30).             ERCACCT
  3382     12  AM-ADDRS                          PIC X(30).             ERCACCT
  3383     12  AM-CITY.
  3384         16  AM-ADDR-CITY                  PIC X(28).
  3385         16  AM-ADDR-STATE                 PIC XX.
  3386     12  AM-ZIP.                                                  ERCACCT
  3387         16  AM-ZIP-PRIME.                                        ERCACCT
  3388             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  3389                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  3390             20  FILLER                    PIC X(4).              ERCACCT
  3391         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  63
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3392     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  3393         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  3394         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  3395         16  FILLER                        PIC XXX.               ERCACCT
  3396     12  AM-TEL-NO.                                               ERCACCT
  3397         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  3398         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  3399         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  3400     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  3401         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  3402         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  3403                                                                  ERCACCT
  3404     12  AM-COMM-STRUCTURE.                                       ERCACCT
  3405         16  AM-DEFN-1.                                           ERCACCT
  3406             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  3407                 24  AM-AGT.                                      ERCACCT
  3408                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  3409                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  3410                 24  AM-COM-TYP            PIC X.                 ERCACCT
  3411                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  3412                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  3413                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  3414                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  3415                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  3416                 24  AM-GL-CODES           PIC X.                 ERCACCT
  3417                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  3418                 24  FILLER                PIC X(01).             ERCACCT
  3419         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  3420             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  3421                 24  FILLER                PIC X(11).             ERCACCT
  3422                 24  AM-L-COMA             PIC XXX.               ERCACCT
  3423                 24  AM-J-COMA             PIC XXX.               ERCACCT
  3424                 24  AM-A-COMA             PIC XXX.               ERCACCT
  3425                 24  FILLER                PIC X(6).              ERCACCT
  3426                                                                  ERCACCT
  3427     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  3428         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  3429                                                                  ERCACCT
  3430     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  3431                                                                  ERCACCT
  3432     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  3433         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  3434         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  3435     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  3436         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  3437         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  3438     12  AM-GPCD                           PIC 99.                ERCACCT
  3439     12  AM-IG                             PIC X.                 ERCACCT
  3440         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  3441         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  3442     12  AM-STATUS                         PIC X.                 ERCACCT
  3443         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  3444         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  3445         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  3446         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3447         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3448         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3449     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  64
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3450     12  AM-ID-NO                          PIC X(11).             ERCACCT
  3451                                                                  ERCACCT
  3452     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  3453     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  3454     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  3455     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3456     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3457     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3458     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3459     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3460     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3461                                                                  ERCACCT
  3462     12  AM-USER-FIELDS.                                          ERCACCT
  3463         16  AM-FLD-1                      PIC XX.                ERCACCT
  3464         16  AM-FLD-2                      PIC XX.                ERCACCT
  3465         16  AM-FLD-3                      PIC XX.                ERCACCT
  3466         16  AM-FLD-4                      PIC XX.                ERCACCT
  3467         16  AM-FLD-5                      PIC XX.                ERCACCT
  3468                                                                  ERCACCT
  3469     12  AM-1ST-PROD-DATE.                                        ERCACCT
  3470         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  3471         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  3472         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  3473     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  3474     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  3475         16  AM-PUR-YR                     PIC XX.                ERCACCT
  3476         16  AM-PUR-MO                     PIC XX.                ERCACCT
  3477         16  AM-PUR-DA                     PIC XX.                ERCACCT
  3478     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3479     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3480     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  3481     12  AM-INACTIVE-DATE.                                        ERCACCT
  3482         16  AM-INA-MO                     PIC 99.                ERCACCT
  3483         16  AM-INA-DA                     PIC 99.                ERCACCT
  3484         16  AM-INA-YR                     PIC 99.                ERCACCT
  3485     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  3486                                                                  ERCACCT
  3487     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3488     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3489                                                                  ERCACCT
  3490     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  3491         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  3492         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  3493         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  3494         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  3495                                                                  ERCACCT
  3496     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  3497         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  3498         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  3499                                                                  ERCACCT
  3500     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  3501                                                                  ERCACCT
  3502     12  AM-OVER-SHORT.                                           ERCACCT
  3503         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  3504         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  3505                                                                  ERCACCT
  3506     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3507     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  65
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3508                                                                  ERCACCT
  3509     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  3510     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  3511                                                                  ERCACCT
  3512     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  3513     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  3514     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  3515     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  3516     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  3517     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  3518     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  3519     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  3520     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3521     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  3522     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  3523     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  3524     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3525     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3526     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3527     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  3528                                                                  ERCACCT
  3529     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  3530                                                                  ERCACCT
  3531     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  3532     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  3533                                                                  ERCACCT
  3534     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  3535     12  AM-EARN-METHODS.                                         ERCACCT
  3536         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  3537             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  3538             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  3539             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  3540             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3541         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  3542             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  3543             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  3544             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  3545             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3546         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  3547             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  3548             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  3549             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  3550             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  3551             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  3552             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  3553                                                                  ERCACCT
  3554     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  3555     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  3556     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  3557                                                                  ERCACCT
  3558     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  3559     12  AM-RET-P-E                        PIC X.                 ERCACCT
  3560     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  3561     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  3562     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  3563     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  3564         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  3565         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  66
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3566     12  AM-RETRO-EARNINGS.                                       ERCACCT
  3567         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  3568         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  3569         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  3570     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  3571         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  3572         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  3573     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  3574         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  3575         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  3576         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  3577     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  3578     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  3579                                                                  ERCACCT
  3580     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  3581         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  3582         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  3583         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  3584         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  3585         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  3586                                                                  ERCACCT
  3587     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3588                                                                  ERCACCT
  3589     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3590                                                                  ERCACCT
  3591     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  3592         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  3593                                                                  ERCACCT
  3594     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  3595         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  3596         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  3597                                                                  ERCACCT
  3598     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  3599         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  3600                                                                  ERCACCT
  3601     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  3602         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  3603         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  3604                                                                  ERCACCT
  3605     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  3606                                                                  ERCACCT
  3607     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  3608     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3609     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3610     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3611     12  AM-DCC-UEF-STATE                  PIC XX.
  3612     12  FILLER                            PIC XXX.
  3613     12  AM-REPORT-CODE-3                  PIC X(10).
  3614*    12  FILLER                            PIC X(22).             ERCACCT
  3615                                                                  ERCACCT
  3616     12  AM-RESERVE-DATE.                                         ERCACCT
  3617         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  3618         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  3619         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  3620                                                                  ERCACCT
  3621     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  3622     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  3623         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  67
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3624         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  3625         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  3626         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  3627                                                                  ERCACCT
  3628     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  3629         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  3630         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  3631         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  3632         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  3633                                                                  ERCACCT
  3634     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  3635         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  3636             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  3637             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  3638             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  3639             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  3640             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  3641             20  FILLER                    PIC XX.                ERCACCT
  3642         16  FILLER                        PIC X(80).             ERCACCT
  3643                                                                  ERCACCT
  3644     12  AM-TRANSFER-DATA.                                        ERCACCT
  3645         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  3646             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  3647             20  AM-TRNFROM-GROUPING.                             ERCACCT
  3648                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  3649                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  3650             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  3651             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  3652                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  3653                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  3654             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  3655         16  AM-TRANSFERRED-TO.                                   ERCACCT
  3656             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  3657             20  AM-TRNTO-GROUPING.                               ERCACCT
  3658                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  3659                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  3660             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  3661             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  3662                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  3663                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  3664             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  3665         16  FILLER                        PIC X(10).             ERCACCT
  3666                                                                  ERCACCT
  3667     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  3668                                                                  ERCACCT
  3669     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  3670         16  AM-DEFN-1-SAVED.                                     ERCACCT
  3671             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  3672                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  3673                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  3674                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3675                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3676                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3677                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  3678                 24  FILLER                PIC X.                 ERCACCT
  3679                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  3680                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  3681                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  68
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3682         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  3683             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  3684                 24  FILLER                PIC X(11).             ERCACCT
  3685                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  3686                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  3687                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  3688                 24  FILLER                PIC X(6).              ERCACCT
  3689                                                                  ERCACCT
  3690     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  3691         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  3692            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  3693            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  3694            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  3695                                                                  ERCACCT
  3696     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  3697     12  FILLER                            PIC X(120).            ERCACCT
  3698                                                                  ERCACCT
  3699     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  3700         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  3701         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  3702             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  3703             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3704                                                          COMP-3. ERCACCT
  3705             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3706                                                          COMP-3. ERCACCT
  3707         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  3708             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  3709             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3710                                                          COMP-3. ERCACCT
  3711             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3712                                                          COMP-3. ERCACCT
  3713                                                                  ERCACCT
  3714     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  3715         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  3716         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  3717         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  3718         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  3719             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  3720                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  3721                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  3722             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  3723                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  3724                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  3725             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  3726                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  3727                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  3728         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  3729             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  3730                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  3731                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  3732                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  3733             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  3734                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  3735                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  3736             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  3737                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  3738                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  3739                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  69
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3740     12  AM-COMMENTS.                                             ERCACCT
  3741         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  3742                                                                  ERCACCT
  3743     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  3744         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  3745         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  3746         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  3747         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  3748         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  3749             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  3750             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  3751             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  3752             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  3753         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  3754             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  3755             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  3756             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  3757         16  FILLER                        PIC X(102).            ERCACCT
  3758                                                                  ERCACCT
  3759     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  3760         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  3761             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  3762             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  3763             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  3764             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  3765             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  3766         16  FILLER                          PIC X(10).           ERCACCT
  3767******************************************************************ERCACCT
  3768
  3769 FD  ELCERR.
* 3770                                 COPY ELCERRS.
  3771******************************************************************04/15/98
  3772*                                                                *ELCERRS
  3773*                                                                *ELCERRS
  3774*                            ELCERRS.                            *   LV002
  3775*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3776*                            VMOD 2.002                          *   CL**2
  3777*                                                                *ELCERRS
  3778*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *ELCERRS
  3779*                                                                *ELCERRS
  3780*   FILE TYPE = VSAM,KSDS                                        *ELCERRS
  3781*   RECORD SIZE = 72    RECFORM = FIX                            *ELCERRS
  3782*                                                                *ELCERRS
  3783*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *ELCERRS
  3784*       ALTERNATE PATH  = NOT USED                               *ELCERRS
  3785*                                                                *ELCERRS
  3786*   LOG = NO                                                     *ELCERRS
  3787*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCERRS
  3788******************************************************************ELCERRS
  3789 01  ERROR-MESSAGE-FILE.                                          ELCERRS
  3790     12  EM-RECORD-ID                PIC XX.                      ELCERRS
  3791         88  VALID-EM-ID                VALUE 'EM'.               ELCERRS
  3792                                                                  ELCERRS
  3793     12  EM-CONTROL-PRIMARY.                                      ELCERRS
  3794         16  EM-MESSAGE-NUMBER       PIC 9(4).                    ELCERRS
  3795                                                                  ELCERRS
  3796     12  EM-ERROR-TEXT.                                           ELCERRS
  3797         16  EM-ERROR-TEXT-PREFIX    PIC X(6).                    ELCERRS
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  70
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRS)
  3798         16  FILLER                  PIC X(59).                   ELCERRS
  3799                                                                  ELCERRS
  3800     12  EM-ERROR-SEVERITY           PIC X.                       ELCERRS
  3801         88  ERROR-IS-NOTE              VALUE 'N'.                ELCERRS
  3802         88  ERROR-IS-WARNING           VALUE 'W'.                ELCERRS
  3803         88  ERROR-IS-FORCABLE          VALUE 'F'.                ELCERRS
  3804         88  ERROR-IS-FATAL             VALUE 'X'.                ELCERRS
  3805                                                                  ELCERRS
  3806******************************************************************ELCERRS
  3807
  3808 FD  ERPNDM.
* 3809                                 COPY ERCPNDM.
  3810******************************************************************
  3811*                                                                *
  3812*                                                                *
  3813*                            ERCPNDM                             *
  3814*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3815*                            VMOD=2.003                          *
  3816*                                                                *
  3817*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  3818*                                                                *
  3819*   FILE TYPE = VSAM,KSDS                                        *
  3820*   RECORD SIZE = 374   RECFORM = FIX                            *
  3821*                                                                *
  3822*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  3823*   ALTERNATE PATH    = NOT USED                                 *
  3824*                                                                *
  3825*   LOG = YES                                                    *
  3826*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3827******************************************************************
  3828*                   C H A N G E   L O G
  3829*
  3830* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3831*-----------------------------------------------------------------
  3832*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3833* EFFECTIVE    NUMBER
  3834*-----------------------------------------------------------------
  3835* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3836* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  3837* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3838******************************************************************
  3839
  3840 01  PENDING-MAILING-DATA.
  3841     12  PM-RECORD-ID                      PIC XX.
  3842         88  VALID-MA-ID                       VALUE 'PM'.
  3843
  3844     12  PM-CONTROL-PRIMARY.
  3845         16  PM-COMPANY-CD                 PIC X.
  3846         16  PM-ENTRY-BATCH                PIC X(6).
  3847         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  3848         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  3849
  3850     12  FILLER                            PIC X(14).
  3851
  3852     12  PM-ACCESS-CONTROL.
  3853         16  PM-SOURCE-SYSTEM              PIC XX.
  3854             88  PM-FROM-CREDIT                VALUE 'CR'.
  3855             88  PM-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  71
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3856             88  PM-FROM-WARRANTY              VALUE 'WA'.
  3857             88  PM-FROM-OTHER                 VALUE 'OT'.
  3858         16  PM-RECORD-ADD-DT              PIC XX.
  3859         16  PM-RECORD-ADDED-BY            PIC XXXX.
  3860         16  PM-LAST-MAINT-DT              PIC XX.
  3861         16  PM-LAST-MAINT-BY              PIC XXXX.
  3862         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3863
  3864     12  PM-PROFILE-INFO.
  3865         16  PM-QUALIFY-CODE-1             PIC XX.
  3866         16  PM-QUALIFY-CODE-2             PIC XX.
  3867         16  PM-QUALIFY-CODE-3             PIC XX.
  3868         16  PM-QUALIFY-CODE-4             PIC XX.
  3869         16  PM-QUALIFY-CODE-5             PIC XX.
  3870
  3871         16  PM-INSURED-LAST-NAME          PIC X(15).
  3872         16  PM-INSURED-FIRST-NAME         PIC X(10).
  3873         16  PM-INSURED-MIDDLE-INIT        PIC X.
  3874         16  PM-INSURED-ISSUE-AGE          PIC 99.
  3875         16  PM-INSURED-BIRTH-DT           PIC XX.
  3876         16  PM-INSURED-SEX                PIC X.
  3877             88  PM-SEX-MALE                   VALUE 'M'.
  3878             88  PM-SEX-FEMALE                 VALUE 'F'.
  3879         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  3880
  3881         16  PM-ADDRESS-CORRECTED          PIC X.
  3882         16  PM-JOINT-BIRTH-DT             PIC XX.
  3883*        16  FILLER                        PIC X(12).
  3884
  3885         16  PM-ADDRESS-LINE-1             PIC X(30).
  3886         16  PM-ADDRESS-LINE-2             PIC X(30).
  3887         16  PM-CITY-STATE.
  3888             20  PM-CITY                   PIC X(28).
  3889             20  PM-STATE                  PIC XX.
  3890         16  PM-ZIP.
  3891             20  PM-ZIP-CODE.
  3892                 24  PM-ZIP-1              PIC X.
  3893                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3894                 24  FILLER                PIC X(4).
  3895             20  PM-ZIP-PLUS4              PIC X(4).
  3896         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  3897             20  PM-CAN-POST1              PIC XXX.
  3898             20  PM-CAN-POST2              PIC XXX.
  3899             20  FILLER                    PIC XXX.
  3900
  3901         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  3902
  3903         16  FILLER                        PIC X(03).
  3904
  3905     12  PM-CRED-BENE-INFO.
  3906         16  PM-CRED-BENE-NAME             PIC X(25).
  3907         16  PM-CRED-BENE-ADDR             PIC X(30).
  3908         16  PM-CRED-BENE-ADDR2            PIC X(30).
  3909         16  PM-CRED-BENE-CTYST.
  3910             20  PM-CRED-BENE-CITY         PIC X(28).
  3911             20  PM-CRED-BENE-STATE        PIC XX.
  3912         16  PM-CRED-BENE-ZIP.
  3913             20  PM-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  72
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3914                 24  PM-CB-ZIP-1           PIC X.
  3915                     88  PM-CB-CANADIAN-POST-CODE
  3916                                  VALUE 'A' THRU 'Z'.
  3917                 24  FILLER                PIC X(4).
  3918             20  PM-CB-ZIP-PLUS4           PIC X(4).
  3919         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  3920             20  PM-CB-CAN-POST1           PIC XXX.
  3921             20  PM-CB-CAN-POST2           PIC XXX.
  3922             20  FILLER                    PIC XXX.
  3923     12  PM-POST-CARD-MAIL-DATA.
  3924         16  PM-MAIL-DATA OCCURS 7.
  3925             20  PM-MAIL-TYPE              PIC X.
  3926                 88  PM-12MO-MAILING           VALUE '1'.
  3927                 88  PM-EXP-MAILING            VALUE '2'.
  3928             20  PM-MAIL-STATUS            PIC X.
  3929                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  3930                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  3931                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  3932             20  PM-MAIL-DATE              PIC XX.
  3933     12  FILLER                            PIC XX.
  3934     12  FILLER                            PIC X(12).
  3935*    12  FILLER                            PIC X(30).
  3936
  3937******************************************************************
  3938
  3939 FD  ERMAIL.
* 3940                                 COPY ERCMAIL.
  3941******************************************************************
  3942*                                                                *
  3943*                                                                *
  3944*                            ERCMAIL                             *
  3945*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3946*                            VMOD=2.003                          *
  3947*                                                                *
  3948*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3949*                                                                *
  3950*   FILE TYPE = VSAM,KSDS                                        *
  3951*   RECORD SIZE = 374   RECFORM = FIX                            *
  3952*                                                                *
  3953*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3954*   ALTERNATE PATH    = NOT USED                                 *
  3955*                                                                *
  3956*   LOG = YES                                                    *
  3957*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3958******************************************************************
  3959*                   C H A N G E   L O G
  3960*
  3961* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3962*-----------------------------------------------------------------
  3963*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3964* EFFECTIVE    NUMBER
  3965*-----------------------------------------------------------------
  3966* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3967* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3968* 111108                   PEMA  ADD CRED BENE ADDR2
  3969******************************************************************
  3970
  3971 01  MAILING-DATA.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  73
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  3972     12  MA-RECORD-ID                      PIC XX.
  3973         88  VALID-MA-ID                       VALUE 'MA'.
  3974
  3975     12  MA-CONTROL-PRIMARY.
  3976         16  MA-COMPANY-CD                 PIC X.
  3977         16  MA-CARRIER                    PIC X.
  3978         16  MA-GROUPING.
  3979             20  MA-GROUPING-PREFIX        PIC XXX.
  3980             20  MA-GROUPING-PRIME         PIC XXX.
  3981         16  MA-STATE                      PIC XX.
  3982         16  MA-ACCOUNT.
  3983             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3984             20  MA-ACCOUNT-PRIME          PIC X(6).
  3985         16  MA-CERT-EFF-DT                PIC XX.
  3986         16  MA-CERT-NO.
  3987             20  MA-CERT-PRIME             PIC X(10).
  3988             20  MA-CERT-SFX               PIC X.
  3989
  3990     12  FILLER                            PIC XX.
  3991
  3992     12  MA-ACCESS-CONTROL.
  3993         16  MA-SOURCE-SYSTEM              PIC XX.
  3994             88  MA-FROM-CREDIT                VALUE 'CR'.
  3995             88  MA-FROM-VSI                   VALUE 'VS'.
  3996             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3997             88  MA-FROM-OTHER                 VALUE 'OT'.
  3998         16  MA-RECORD-ADD-DT              PIC XX.
  3999         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4000         16  MA-LAST-MAINT-DT              PIC XX.
  4001         16  MA-LAST-MAINT-BY              PIC XXXX.
  4002         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4003
  4004     12  MA-PROFILE-INFO.
  4005         16  MA-QUALIFY-CODE-1             PIC XX.
  4006         16  MA-QUALIFY-CODE-2             PIC XX.
  4007         16  MA-QUALIFY-CODE-3             PIC XX.
  4008         16  MA-QUALIFY-CODE-4             PIC XX.
  4009         16  MA-QUALIFY-CODE-5             PIC XX.
  4010
  4011         16  MA-INSURED-LAST-NAME          PIC X(15).
  4012         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4013         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4014         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4015         16  MA-INSURED-BIRTH-DT           PIC XX.
  4016         16  MA-INSURED-SEX                PIC X.
  4017             88  MA-SEX-MALE                   VALUE 'M'.
  4018             88  MA-SEX-FEMALE                 VALUE 'F'.
  4019         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4020
  4021         16  MA-ADDRESS-CORRECTED          PIC X.
  4022         16  MA-JOINT-BIRTH-DT             PIC XX.
  4023*        16  FILLER                        PIC X(12).
  4024
  4025         16  MA-ADDRESS-LINE-1             PIC X(30).
  4026         16  MA-ADDRESS-LINE-2             PIC X(30).
  4027         16  MA-CITY-STATE.
  4028             20  MA-CITY                   PIC X(28).
  4029             20  MA-ADDR-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  74
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  4030         16  MA-ZIP.
  4031             20  MA-ZIP-CODE.
  4032                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4033                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4034                 24  FILLER                PIC X(4).
  4035             20  MA-ZIP-PLUS4              PIC X(4).
  4036         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4037             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4038             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4039             20  FILLER                    PIC X(3).
  4040
  4041         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4042
  4043         16  FILLER                        PIC XXX.
  4044*        16  FILLER                        PIC X(10).
  4045
  4046
  4047     12  MA-CRED-BENE-INFO.
  4048         16  MA-CRED-BENE-NAME                 PIC X(25).
  4049         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4050         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4051         16  MA-CRED-BENE-CTYST.
  4052             20  MA-CRED-BENE-CITY             PIC X(28).
  4053             20  MA-CRED-BENE-STATE            PIC XX.
  4054         16  MA-CRED-BENE-ZIP.
  4055             20  MA-CB-ZIP-CODE.
  4056                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  4057                     88  MA-CB-CANADIAN-POST-CODE
  4058                                           VALUE 'A' THRU 'Z'.
  4059                 24  FILLER                    PIC X(4).
  4060             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4061         16  MA-CB-CANADIAN-POSTAL-CODE
  4062                            REDEFINES MA-CRED-BENE-ZIP.
  4063             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4064             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4065             20  FILLER                        PIC X(3).
  4066     12  MA-POST-CARD-MAIL-DATA.
  4067         16  MA-MAIL-DATA OCCURS 7.
  4068             20  MA-MAIL-TYPE              PIC X.
  4069                 88  MA-12MO-MAILING           VALUE '1'.
  4070                 88  MA-EXP-MAILING            VALUE '2'.
  4071             20  MA-MAIL-STATUS            PIC X.
  4072                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4073                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4074                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4075             20  MA-MAIL-DATE              PIC XX.
  4076     12  FILLER                            PIC XX.
  4077     12  FILLER                            PIC XX.
  4078*    12  FILLER                            PIC X(30).
  4079******************************************************************
  4080
  4081 FD  ERPLAN.
* 4082                                 COPY ERCPLAN.
  4083******************************************************************04/29/98
  4084*                                                                *ERCPLAN
  4085*                                                                *ERCPLAN
  4086*                            ERCPLAN                             *   LV003
  4087*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  75
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4088*                            VMOD=2.003                          *   CL**2
  4089*                                                                *ERCPLAN
  4090*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
  4091*                                                                *ERCPLAN
  4092*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
  4093*   PLAN MASTER                                                  *ERCPLAN
  4094*                                                                *ERCPLAN
  4095*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
  4096*                                                                *ERCPLAN
  4097*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
  4098*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
  4099*                                                                *ERCPLAN
  4100*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
  4101*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
  4102*                                                                *ERCPLAN
  4103*   LOG = NO                                                     *ERCPLAN
  4104*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
  4105*                                                                *ERCPLAN
  4106*                                                                *ERCPLAN
  4107******************************************************************ERCPLAN
  4108                                                                  ERCPLAN
  4109 01  PLAN-MASTER.                                                 ERCPLAN
  4110     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
  4111         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
  4112                                                                  ERCPLAN
  4113     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
  4114         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
  4115         16  PL-MSTR-CNTRL.                                       ERCPLAN
  4116             20  PL-CONTROL-A.                                    ERCPLAN
  4117                 24  PL-CARRIER            PIC X.                 ERCPLAN
  4118                 24  PL-GROUPING           PIC X(6).              ERCPLAN
  4119                 24  PL-STATE              PIC XX.                ERCPLAN
  4120                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
  4121             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
  4122             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
  4123             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
  4124                                                                  ERCPLAN
  4125     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
  4126         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
  4127         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
  4128         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
  4129         16  PL-VG-STATE                   PIC XX.                ERCPLAN
  4130         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
  4131         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
  4132         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
  4133         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
  4134                                                                  ERCPLAN
  4135     12  PL-MAINT-INFORMATION.                                    ERCPLAN
  4136         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
  4137         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
  4138         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
  4139         16  FILLER                        PIC XX.                ERCPLAN
  4140                                                                  ERCPLAN
  4141     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
  4142         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
  4143         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
  4144             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
  4145             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  76
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4146             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
  4147             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
  4148                                                                  ERCPLAN
  4149     12  FILLER                            PIC X(30).             ERCPLAN
  4150                                                                  ERCPLAN
  4151     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
  4152         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
  4153         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
  4154         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
  4155     12  FILLER                            PIC X(24).             ERCPLAN
  4156     12  PL-TOLERANCES.                                           ERCPLAN
  4157         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
  4158         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
  4159         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
  4160         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
  4161         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4162         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4163     12  PL-OVER-SHORT.                                           ERCPLAN
  4164         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
  4165         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
  4166     12  FILLER                            PIC X(24).             ERCPLAN
  4167     12  PLAN-MISC.                                               ERCPLAN
  4168         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
  4169         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4170         16  PL-IG                         PIC X.                 ERCPLAN
  4171         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
  4172         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
  4173         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
  4174         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
  4175         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
  4176         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
  4177         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
  4178         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4179                                                                  ERCPLAN
  4180         16  FILLER                        PIC X(99).             ERCPLAN
  4181******************************************************************ERCPLAN
  4182 FD  ERFORM.
* 4183                                 COPY ERCFORM.
  4184******************************************************************04/29/98
  4185*                                                                *ERCFORM
  4186*                                                                *ERCFORM
  4187*                            ERCFORM.                            *   LV002
  4188*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4189*                            VMOD=2.003                          *   CL**2
  4190*                                                                *ERCFORM
  4191*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *ERCFORM
  4192*                                                                *ERCFORM
  4193*    FILE TYPE = VSAM,KSDS                                       *ERCFORM
  4194*    RECORD SIZE = 500  RECFORM = FIXED                          *ERCFORM
  4195*                                                                *ERCFORM
  4196*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *ERCFORM
  4197*                                                                *ERCFORM
  4198*    LOG = YES                                                   *ERCFORM
  4199*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCFORM
  4200******************************************************************ERCFORM
  4201 01  FORM-MASTER.                                                 ERCFORM
  4202    12  FO-RECORD-ID                 PIC X(02).                   ERCFORM
  4203        88  VALID-FO-ID                  VALUE 'FO'.              ERCFORM
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  77
* EL517.cbl (/apps/prod/cid1p/copy/ERCFORM)
  4204                                                                  ERCFORM
  4205    12  FO-CONTROL-PRIMARY.                                       ERCFORM
  4206        16  FO-COMPANY-CD            PIC X(01).                   ERCFORM
  4207        16  FO-STATE                 PIC X(02).                   ERCFORM
  4208        16  FO-FORM-ID               PIC X(12).                   ERCFORM
  4209        16  FO-FORM-EXP-DT           PIC X(02).                   ERCFORM
  4210                                                                  ERCFORM
  4211    12  FO-POLICY-FORM-DATA.                                      ERCFORM
  4212        16  FO-IND-GRP-CD            PIC X(01).                   ERCFORM
  4213        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.      ERCFORM
  4214        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4215        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4216        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4217        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4218        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4219        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4220        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.      ERCFORM
  4221        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.      ERCFORM
  4222        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).                   ERCFORM
  4223        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4224        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4225        16  FO-DIS-DEF-TYPE          PIC 9(02).                   ERCFORM
  4226        16  FO-DISMEMBERMENT-CD      PIC X(01).                   ERCFORM
  4227        16  FO-APP-CERT-USE-CD       PIC X(01).                   ERCFORM
  4228                                                                  ERCFORM
  4229    12  FILLER                       PIC X(29).                   ERCFORM
  4230                                                                  ERCFORM
  4231    12  FO-FORM-PLAN-TABLE.                                       ERCFORM
  4232        16  FO-FORM-PLANS     OCCURS 40 TIMES.                    ERCFORM
  4233            20  FO-PLAN-TYPE         PIC X(01).                   ERCFORM
  4234            20  FO-PLAN-ID           PIC X(02).                   ERCFORM
  4235            20  FO-PLAN-TERM         PIC 9(03).                   ERCFORM
  4236            20  FO-PLAN-REFUND-METHOD                             ERCFORM
  4237                                     PIC X.                       ERCFORM
  4238                                                                  ERCFORM
  4239    12  FILLER                       PIC X(30).                   ERCFORM
  4240                                                                  ERCFORM
  4241    12  FO-COMMENTS-AREA.                                         ERCFORM
  4242        16  FO-COMMENT-LINE-1        PIC X(78).                   ERCFORM
  4243                                                                  ERCFORM
  4244    12  FILLER                       PIC X(20).                   ERCFORM
  4245                                                                  ERCFORM
  4246    12  FO-MAINT-INFORMATION.                                     ERCFORM
  4247        16  FO-LAST-MAINT-DT         PIC X(02).                   ERCFORM
  4248        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.      ERCFORM
  4249        16  FO-LAST-MAINT-BY         PIC X(04).                   ERCFORM
  4250
  4251 FD  PRINT-FILE
* 4252                                 COPY ELCPRTFD.
  4253******************************************************************04/15/98
  4254*                                                                *ELCPRTFD
  4255*                                                                *ELCPRTFD
  4256*                            ELCPRTFD.                           *   LV003
  4257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4258*                            VMOD=2.006                          *ELCPRTFD
  4259******************************************************************ELCPRTFD
  4260     RECORDING MODE F                                             ELCPRTFD
  4261     LABEL RECORDS OMITTED                                        ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  78
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
  4262     BLOCK CONTAINS 0 RECORDS
  4263     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  4264 01  PRT.                                                         ELCPRTFD
  4265     12  P-CTL               PIC  X.                                 CL**2
  4266     12  P-DATA              PIC  X(132).                         ELCPRTFD
  4267******************************************************************ELCPRTFD
  4268 FD  FICH
* 4269                                 COPY ELCFCHFD.
  4270******************************************************************04/15/98
  4271*                                                                *ELCFCHFD
  4272*                            ELCFCHFD.                           *   LV003
  4273*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4274*                            VMOD=2.004                          *   CL**3
  4275*                                                                *ELCFCHFD
  4276******************************************************************ELCFCHFD
  4277     BLOCK CONTAINS 0 RECORDS
  4278     RECORDING MODE F.                                            ELCFCHFD
  4279                                                                  ELCFCHFD
  4280 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  4281******************************************************************ELCFCHFD
  4282
  4283 FD  ELREPT.
* 4284                                 COPY ELCREPT.
  4285******************************************************************04/15/98
  4286*                                                                *ELCREPT
  4287*                                                                *ELCREPT
  4288*                            ELCREPT.                            *   LV002
  4289*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4290*                            VMOD=2.002                          *   CL**2
  4291*                                                                *ELCREPT
  4292*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  4293*                                                                *ELCREPT
  4294*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  4295*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  4296*                                                                *ELCREPT
  4297*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  4298*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  4299*                                                                *ELCREPT
  4300*   LOG = NO                                                     *ELCREPT
  4301*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  4302******************************************************************ELCREPT
  4303 01  REPORT-SAVE-FILE.                                            ELCREPT
  4304     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  4305         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  4306                                                                  ELCREPT
  4307     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  4308         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  4309         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  4310             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  4311             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  4312         16  RF-REPORT-ID.                                        ELCREPT
  4313             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  4314                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  4315                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  4316             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  4317         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  4318     12  RF-REPORT-LINE-133.                                      ELCREPT
  4319         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  79
* EL517.cbl (/apps/prod/cid1p/copy/ELCREPT)
  4320         16  RF-DATA-133             PIC X(132).                  ELCREPT
  4321         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  4322             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  4323             20  FILLER              PIC X(52).                   ELCREPT
  4324         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  4325             20  FILLER              PIC X(53).                   ELCREPT
  4326             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  4327     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  4328         16  FILLER                  PIC X.                       ELCREPT
  4329         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
  4330         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  4331         16  FILLER                  PIC X(115).                  ELCREPT
  4332         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  4333******************************************************************ELCREPT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  80
* EL517.cbl
  4335
  4336 FD  ERRESS.
* 4337                                 COPY ERCRESS.
  4338******************************************************************04/29/98
  4339*                                                                *ERCRESS
  4340*                            ERCRESS                             *   LV002
  4341*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4342*                            VMOD=2.002                          *   CL**2
  4343*                                                                *ERCRESS
  4344*   CREDIT RESIDENT STATE TAXES MASTER                          * ERCRESS
  4345*                                                                *ERCRESS
  4346*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *ERCRESS
  4347*   VSAM RESIDENT STATE TAX MASTER                              * ERCRESS
  4348*                                                                *ERCRESS
  4349*   FILE DESCRIPTION = ER.TEST.ERRESS                           * ERCRESS
  4350*                                                                *ERCRESS
  4351*   FILE TYPE = VSAM,KSDS                                        *ERCRESS
  4352*   RECORD SIZE = 0047 RECFORM = FIXED                           *ERCRESS
  4353*                                                                *ERCRESS
  4354*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *ERCRESS
  4355*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *ERCRESS
  4356*                                                                *ERCRESS
  4357*   LOG = NO                                                     *ERCRESS
  4358*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESS
  4359*                                                                *ERCRESS
  4360*                                                                *ERCRESS
  4361******************************************************************ERCRESS
  4362                                                                  ERCRESS
  4363 01  RESIDENT-STATE-TAX-MASTER.                                   ERCRESS
  4364                                                                  ERCRESS
  4365     10  ERRESS-PRIMARY-KEY.                                      ERCRESS
  4366         15  RES-COMPANY-CD        PIC X.                         ERCRESS
  4367         15  RES-RESIDENT-STATE    PIC XX.                        ERCRESS
  4368         15  RES-COVERAGE-CATEGORY PIC X.                         ERCRESS
  4369         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.               ERCRESS
  4370*                                      YYYYMMDD                   ERCRESS
  4371*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C                   ERCRESS
  4372                                                                  ERCRESS
  4373     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.                      ERCRESS
  4374                                                                  ERCRESS
  4375         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4376         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4377         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4378         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4379                                                                  ERCRESS
  4380     10 RES-RECALC-SW              PIC   X.                       ERCRESS
  4381         88 RECALC                VALUE 'Y'.                      ERCRESS
  4382         88 NO-RECALC             VALUE 'N'.                      ERCRESS
  4383     10  RES-MAINT-BY              PIC X(4).                      ERCRESS
  4384     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.            ERCRESS
  4385     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.            ERCRESS
  4386*                                      YYYYMMDD                   ERCRESS
  4387
  4388 FD  ERRESC.
* 4389                                 COPY ERCRESC.
  4390******************************************************************04/29/98
  4391*                                                                *ERCRESC
  4392*                            ERCRESC                             *   LV002
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  81
* EL517.cbl (/apps/prod/cid1p/copy/ERCRESC)
  4393*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4394*                            VMOD=2.003                          *   CL**2
  4395*                                                                *ERCRESC
  4396*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  4397*                                                                *ERCRESC
  4398*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  4399*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  4400*                                                                *ERCRESC
  4401*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  4402*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  4403*                                                                *ERCRESC
  4404*   LOG = NO                                                     *ERCRESC
  4405*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  4406*                                                                *ERCRESC
  4407******************************************************************ERCRESC
  4408                                                                  ERCRESC
  4409 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  4410                                                                  ERCRESC
  4411     10  ERRESC-RECORD-KEY.                                       ERCRESC
  4412         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  4413         15  RESC-CARRIER              PIC   X.                   ERCRESC
  4414         15  RESC-GROUP                PIC   X(6).                ERCRESC
  4415         15  RESC-STATE                PIC   XX.                  ERCRESC
  4416         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  4417         15  RESC-AGENT                PIC   X(10).               ERCRESC
  4418         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  4419         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  4420*                                           YYYYMMDD              ERCRESC
  4421     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  4422                                                                  ERCRESC
  4423     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  4424         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  4425             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  4426             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  4427             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  4428                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  4429                                                                  ERCRESC
  4430     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  4431     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  4432     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  4433*                                          YYYYMMDD               ERCRESC
  4434
  4435 FD  ERCOMP.
* 4436                                 COPY ERCCOMP.
  4437******************************************************************
  4438*                                                                *
  4439*                                                                *
  4440*                            ERCCOMP                             *
  4441*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4442*                            VMOD=2.019                          *
  4443*                                                                *
  4444*   ONLINE CREDIT SYSTEM                                         *
  4445*                                                                *
  4446*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4447*                                                                *
  4448*   FILE TYPE = VSAM,KSDS                                        *
  4449*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4450*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  82
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4451*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4452*       ALTERNATE PATH = NONE                                    *
  4453*                                                                *
  4454*   LOG = NO                                                     *
  4455*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4456*                                                                *
  4457******************************************************************
  4458*                   C H A N G E   L O G
  4459*
  4460* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4461*-----------------------------------------------------------------
  4462*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4463* EFFECTIVE    NUMBER
  4464*-----------------------------------------------------------------
  4465* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4466* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4467* 092205    2005050300006  PEMA  ADD LEASE FEE
  4468* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4469* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4470* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4471* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4472* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4473* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4474******************************************************************
  4475
  4476 01  COMPENSATION-MASTER.
  4477     12  CO-RECORD-ID                          PIC XX.
  4478         88  VALID-CO-ID                          VALUE 'CO'.
  4479
  4480     12  CO-CONTROL-PRIMARY.
  4481         16  CO-COMPANY-CD                     PIC X.
  4482         16  CO-CONTROL.
  4483             20  CO-CTL-1.
  4484                 24  CO-CARR-GROUP.
  4485                     28  CO-CARRIER            PIC X.
  4486                     28  CO-GROUPING.
  4487                         32  CO-GROUP-PREFIX   PIC XXX.
  4488                         32  CO-GROUP-PRIME    PIC XXX.
  4489                 24  CO-RESP-NO.
  4490                     28  CO-RESP-PREFIX        PIC X(4).
  4491                     28  CO-RESP-PRIME         PIC X(6).
  4492             20  CO-CTL-2.
  4493                 24  CO-ACCOUNT.
  4494                     28  CO-ACCT-PREFIX        PIC X(4).
  4495                     28  CO-ACCT-PRIME         PIC X(6).
  4496         16  CO-TYPE                           PIC X.
  4497             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4498             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4499             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4500
  4501     12  CO-MAINT-INFORMATION.
  4502         16  CO-LAST-MAINT-DT                  PIC XX.
  4503         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4504         16  CO-LAST-MAINT-USER                PIC X(4).
  4505     12  FILLER                                PIC XX.
  4506     12  CO-STMT-TYPE                          PIC XXX.
  4507     12  CO-COMP-TYPE                          PIC X.
  4508         88  CO-COMP-IS-SPPDD                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  83
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4509     12  CO-STMT-OWNER                         PIC X(4).
  4510     12  CO-BALANCE-CONTROL                    PIC X.
  4511         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4512         88  CO-NO-BALANCE                        VALUE 'N'.
  4513
  4514     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4515         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4516         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4517         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4518
  4519     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4520         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4521         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4522
  4523     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4524     12  CO-GA-DIRECT-DEP                      PIC X.
  4525     12  CO-FUTURE-SPACE                       PIC X.
  4526         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4527
  4528     12  CO-ACCT-NAME                          PIC X(30).
  4529     12  CO-MAIL-NAME                          PIC X(30).
  4530     12  CO-ADDR-1                             PIC X(30).
  4531     12  CO-ADDR-2                             PIC X(30).
  4532     12  CO-ADDR-3.
  4533         16  CO-ADDR-CITY                      PIC X(27).
  4534         16  CO-ADDR-STATE                     PIC XX.
  4535     12  CO-CSO-1099                           PIC X.
  4536     12  CO-ZIP.
  4537         16  CO-ZIP-PRIME.
  4538             20  CO-ZIP-PRI-1ST                PIC X.
  4539                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4540             20  FILLER                        PIC X(4).
  4541         16  CO-ZIP-PLUS4                      PIC X(4).
  4542     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4543         16  CO-CAN-POSTAL-1                   PIC XXX.
  4544         16  CO-CAN-POSTAL-2                   PIC XXX.
  4545         16  FILLER                            PIC XXX.
  4546     12  CO-SOC-SEC                            PIC X(13).
  4547     12  CO-TELEPHONE.
  4548         16  CO-AREA-CODE                      PIC XXX.
  4549         16  CO-PREFIX                         PIC XXX.
  4550         16  CO-PHONE                          PIC X(4).
  4551
  4552     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4553
  4554     12  CO-AR-BAL-LEVEL                       PIC X.
  4555         88  CO-AR-REF-LVL                        VALUE '1'.
  4556         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4557         88  CO-AR-BILL-LVL                       VALUE '2'.
  4558         88  CO-AR-AGT-LVL                        VALUE '3'.
  4559         88  CO-AR-FR-LVL                         VALUE '4'.
  4560
  4561     12  CO-AR-NORMAL-PRINT                    PIC X.
  4562         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4563         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4564
  4565     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4566
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  84
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4567     12  CO-AR-REPORTING                       PIC X.
  4568         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4569         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4570
  4571     12  CO-AR-PULL-CHECK                      PIC X.
  4572         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4573         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4574
  4575     12  CO-AR-BALANCE-PRINT                   PIC X.
  4576         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4577
  4578     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4579         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4580         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4581         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4582
  4583     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4584
  4585     12  CO-USER-CODE                          PIC X.
  4586     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4587
  4588******************************************************************
  4589*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4590*    THE LAST MONTH END RUN.
  4591******************************************************************
  4592
  4593     12  CO-LAST-ACTIVITY-DATE.
  4594         16  CO-ACT-YEAR                       PIC 99.
  4595         16  CO-ACT-MONTH                      PIC 99.
  4596         16  CO-ACT-DAY                        PIC 99.
  4597
  4598     12  CO-LAST-STMT-DT.
  4599         16  CO-LAST-STMT-YEAR                 PIC 99.
  4600         16  CO-LAST-STMT-MONTH                PIC 99.
  4601         16  CO-LAST-STMT-DAY                  PIC 99.
  4602
  4603     12  CO-MO-END-TOTALS.
  4604         16  CO-MONTHLY-TOTALS.
  4605             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4606             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4607             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4608             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4609             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4610
  4611         16  CO-AGING-TOTALS.
  4612             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4613             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4614             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4615             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4616
  4617         16  CO-YTD-TOTALS.
  4618             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4619             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4620
  4621         16  CO-OVER-UNDER-TOTALS.
  4622             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4623             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4624
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  85
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4625     12  CO-MISCELLANEOUS-TOTALS.
  4626         16  CO-FICA-TOTALS.
  4627             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4628             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4629
  4630         16  CO-CLAIM-TOTALS.
  4631             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4632             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4633
  4634******************************************************************
  4635*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4636*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4637******************************************************************
  4638
  4639     12  CO-CURRENT-TOTALS.
  4640         16  CO-CURRENT-LAST-STMT-DT.
  4641             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4642             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4643             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4644
  4645         16  CO-CURRENT-MONTHLY-TOTALS.
  4646             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4647             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4648             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4649             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4650             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4651
  4652         16  CO-CURRENT-AGING-TOTALS.
  4653             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4654             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4655             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4656             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4657
  4658         16  CO-CURRENT-YTD-TOTALS.
  4659             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4660             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4661
  4662     12  CO-PAID-COMM-TOTALS.
  4663         16  CO-YTD-PAID-COMMS.
  4664             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4665             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4666
  4667     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4668         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4669         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4670
  4671     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4672         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4673         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4674         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4675         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4676         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4677         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4678         88  CO-FINAL-LETTER                  VALUE 'F'.
  4679         88  CO-RECONCILING                   VALUE 'R'.
  4680         88  CO-PHONE-CALL                    VALUE 'P'.
  4681         88  CO-LEGAL                         VALUE 'L'.
  4682         88  CO-COLLECTION-AGENCY             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  86
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4683         88  CO-WRITE-OFF                     VALUE 'W'.
  4684         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4685
  4686     12  CO-CSR-CODE                       PIC X(4).
  4687
  4688     12  CO-GA-STATUS-INFO.
  4689         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4690         16  CO-GA-TERMINATION-DT          PIC XX.
  4691         16  CO-GA-STATUS-CODE             PIC X.
  4692             88  CO-GA-ACTIVE                 VALUE 'A'.
  4693             88  CO-GA-INACTIVE               VALUE 'I'.
  4694             88  CO-GA-PENDING                VALUE 'P'.
  4695         16  CO-GA-COMMENTS.
  4696             20  CO-GA-COMMENT-1           PIC X(40).
  4697             20  CO-GA-COMMENT-2           PIC X(40).
  4698             20  CO-GA-COMMENT-3           PIC X(40).
  4699             20  CO-GA-COMMENT-4           PIC X(40).
  4700
  4701     12  CO-RPTCD2                         PIC X(10).
  4702     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4703         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4704         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4705
  4706     12  CO-TYPE-AGENT                     PIC X(01).
  4707         88  CO-CORPORATION                   VALUE 'C'.
  4708         88  CO-PARTNERSHIP                   VALUE 'P'.
  4709         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4710         88  CO-TRUST                         VALUE 'T'.
  4711         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4712
  4713     12  CO-FAXNO.
  4714         16  CO-FAX-AREA-CODE                  PIC XXX.
  4715         16  CO-FAX-PREFIX                     PIC XXX.
  4716         16  CO-FAX-PHONE                      PIC X(4).
  4717
  4718     12  CO-BANK-INFORMATION.
  4719         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4720         16  CO-BANK-TRANSIT-NON REDEFINES
  4721             CO-BANK-TRANSIT-NO                PIC 9(8).
  4722
  4723         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4724     12  CO-MISC-DEDUCT-INFO REDEFINES
  4725                  CO-BANK-INFORMATION.
  4726         16  CO-MD-GL-ACCT                     PIC X(10).
  4727         16  CO-MD-DIV                         PIC XX.
  4728         16  CO-MD-CENTER                      PIC X(4).
  4729         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4730         16  CO-CREATE-AP-CHECK                PIC X.
  4731         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4732         16  FILLER                            PIC XXX.
  4733     12  CO-ACH-STATUS                         PIC X.
  4734         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4735         88  CO-ACH-PENDING                        VALUE 'P'.
  4736
  4737     12  CO-BILL-SW                            PIC X.
  4738     12  CO-CONTROL-NAME                       PIC X(30).
  4739     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4740     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  87
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4741     12  CO-CLP-STATE                          PIC XX.
  4742     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4743     12  CO-SPP-REFUND-EDIT                    PIC X.
  4744
  4745******************************************************************
  4746
  4747 FD  ERLOFC.
* 4748                                 COPY ERCLOFC.
  4749******************************************************************12/04/92
  4750*                                                                *ERCLOFC
  4751*                                                                *ERCLOFC
  4752*                            ERCLOFC                             *   LV002
  4753*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4754*                            VMOD=2.003                          *   CL**2
  4755*                                                                *ERCLOFC
  4756*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *ERCLOFC
  4757*                                                                *ERCLOFC
  4758*   FILE TYPE = VSAM,KSDS                                        *ERCLOFC
  4759*   RECORD SIZE = 670   RECFORM = FIX                            *ERCLOFC
  4760*                                                                *ERCLOFC
  4761*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *ERCLOFC
  4762*                                                                *ERCLOFC
  4763*   LOG = YES                                                    *ERCLOFC
  4764*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCLOFC
  4765*                                                                *ERCLOFC
  4766******************************************************************ERCLOFC
  4767                                                                  ERCLOFC
  4768 01  LOAN-OFFICER-MASTER.                                         ERCLOFC
  4769     12  LO-RECORD-ID                PIC XX.                      ERCLOFC
  4770         88  VALID-LO-ID                VALUE 'LO'.               ERCLOFC
  4771                                                                  ERCLOFC
  4772     12  LO-CONTROL-PRIMARY.                                      ERCLOFC
  4773         16  LO-COMPANY-CD           PIC X.                       ERCLOFC
  4774         16  LO-CARRIER              PIC X.                       ERCLOFC
  4775         16  LO-GROUPING.                                         ERCLOFC
  4776             20  LO-GROUPING-PREFIX  PIC XXX.                     ERCLOFC
  4777             20  LO-GROUPING-PRIME   PIC XXX.                     ERCLOFC
  4778         16  LO-STATE                PIC XX.                      ERCLOFC
  4779         16  LO-ACCOUNT.                                          ERCLOFC
  4780             20  LO-ACCOUNT-PREFIX   PIC X(4).                    ERCLOFC
  4781             20  LO-ACCOUNT-PRIME    PIC X(6).                    ERCLOFC
  4782         16  LO-OFFICER-CODE         PIC X(5).
  4783                                                                  ERCLOFC
  4784     12  LO-OFFICER-NAME             PIC X(30).                   ERCLOFC
  4785                                                                  ERCLOFC
  4786     12  LO-LAST-MAINT-DT            PIC XX.                      ERCLOFC
  4787     12  LO-LAST-USER                PIC X(4).                    ERCLOFC
  4788     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.            ERCLOFC
  4789                                                                  ERCLOFC
  4790     12  LO-COMP-CONTROL             PIC X.                       ERCLOFC
  4791             88  LO-SHOW-COMP           VALUE 'Y'.                ERCLOFC
  4792             88  LO-SUPPRESS-COMP       VALUE 'N'.                ERCLOFC
  4793     12  LO-DETAIL-CONTROL           PIC X.                       ERCLOFC
  4794             88  LO-PRINT-DETAIL        VALUE 'D'.                ERCLOFC
  4795             88  LO-PRINT-SUMMARY       VALUE 'S'.                ERCLOFC
  4796                                                                  ERCLOFC
  4797     12  LO-SV-CARRIER               PIC X.                       ERCLOFC
  4798     12  LO-SV-GROUPING              PIC X(6).                    ERCLOFC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  88
* EL517.cbl (/apps/prod/cid1p/copy/ERCLOFC)
  4799     12  LO-SV-STATE                 PIC XX.                      ERCLOFC
  4800                                                                  ERCLOFC
  4801     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.               CL**2
  4802     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.            CL**2
  4803                                                                  ERCLOFC
  4804     12  LO-OFFICER-INFO.                                         ERCLOFC
  4805         16  FILLER OCCURS 12 TIMES.                              ERCLOFC
  4806             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.            ERCLOFC
  4807             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.            ERCLOFC
  4808             20  LO-LF-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4809             20  LO-LF-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4810             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4811             20  LO-AH-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4812             20  LO-AH-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4813             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4814     12  FILLER                      PIC X(198).
  4815******************************************************************ERCLOFC
  4816
  4817 FD  ERBXRF.
* 4818                                 COPY ERCBXRF.
  4819******************************************************************04/29/98
  4820*                                                                *ERCBXRF
  4821*                                                                *ERCBXRF
  4822*                            ERCBXRF                             *   LV002
  4823*                                                                *ERCBXRF
  4824*   ONLINE CREDIT SYSTEM                                         *ERCBXRF
  4825*                                                                *ERCBXRF
  4826*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *ERCBXRF
  4827*                                                                *ERCBXRF
  4828*   FILE TYPE = VSAM,KSDS                                        *ERCBXRF
  4829*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE                ERCBXRF
  4830*                                                                *ERCBXRF
  4831*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *ERCBXRF
  4832*       ALTERNATE PATH = NONE                                    *ERCBXRF
  4833*                                                                *ERCBXRF
  4834*   LOG = NO                                                     *ERCBXRF
  4835*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCBXRF
  4836*                                                                *ERCBXRF
  4837******************************************************************ERCBXRF
  4838                                                                  ERCBXRF
  4839 01  BANK-CROSS-REFERENCE.                                        ERCBXRF
  4840     12  BK-RECORD-ID                PIC XX.                      ERCBXRF
  4841         88  VALID-BK-ID             VALUE 'BK'.                  ERCBXRF
  4842                                                                  ERCBXRF
  4843     12  BK-CONTROL-PRIMARY.                                      ERCBXRF
  4844         16  BK-COMPANY-CD           PIC X.                       ERCBXRF
  4845         16  BK-CARRIER              PIC X.                       ERCBXRF
  4846         16  BK-GROUPING             PIC X(6).                    ERCBXRF
  4847         16  BK-BANK-NO              PIC X(10).                   ERCBXRF
  4848                                                                  ERCBXRF
  4849     12  BK-MAINT-INFORMATION.                                    ERCBXRF
  4850         16  BK-LAST-MAINT-DT        PIC XX.                      ERCBXRF
  4851         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.           ERCBXRF
  4852         16  BK-LAST-MAINT-USER      PIC X(4).                    ERCBXRF
  4853         16  FILLER                  PIC X(9).                    ERCBXRF
  4854                                                                  ERCBXRF
  4855     12  FILLER                      PIC X(37).                   ERCBXRF
  4856                                                                  ERCBXRF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  89
* EL517.cbl (/apps/prod/cid1p/copy/ERCBXRF)
  4857     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.             ERCBXRF
  4858                                                                  ERCBXRF
  4859     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES                  ERCBXRF
  4860                            DEPENDING ON BK-BANK-POINTER-CNT.     ERCBXRF
  4861         16  BK-AM-ACCOUNT           PIC X(10).                   ERCBXRF
  4862         16  BK-AM-EXP-DT            PIC XX.                      ERCBXRF
  4863         16  BK-AM-EFF-DT            PIC XX.                      ERCBXRF
  4864         16  BK-AM-STATE             PIC XX.                      ERCBXRF
  4865         16  FILLER                  PIC X(20).                   ERCBXRF
  4866                                                                  ERCBXRF
  4867******************************************************************ERCBXRF
  4868
  4869 FD  ERAGTC.
* 4870                                 COPY ERCAGTC.
  4871******************************************************************
  4872*                                                                *
  4873*                                                                *
  4874*                            ERCAGTC                             *
  4875*                            VMOD=2.001                          *
  4876*                                                                *
  4877*   ONLINE CREDIT SYSTEM                                         *
  4878*                                                                *
  4879*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  4880*                                                                *
  4881*   FILE TYPE = VSAM,KSDS                                        *
  4882*   RECORD SIZE = 450   RECFORM = FIXED                          *
  4883*                                                                *
  4884*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  4885*       ALTERNATE PATH = NONE                                    *
  4886*                                                                *
  4887*   LOG = NO                                                     *
  4888*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4889*                                                                *
  4890******************************************************************
  4891*                   C H A N G E   L O G
  4892*
  4893* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4894*-----------------------------------------------------------------
  4895*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4896* EFFECTIVE    NUMBER
  4897*-----------------------------------------------------------------
  4898* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  4899* 111004                         NEW FILE AND COPYBOOK
  4900* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  4901******************************************************************
  4902
  4903 01  AGENT-COMMISSIONS.
  4904     12  AG-RECORD-ID                          PIC XX.
  4905         88  VALID-CO-ID                          VALUE 'AG'.
  4906
  4907     12  AG-CONTROL-PRIMARY.
  4908         16  AG-COMPANY-CD                     PIC X.
  4909         16  AG-CONTROL.
  4910             20  AG-CTL-1.
  4911                 24  AG-CARR-GROUP.
  4912                     28  AG-CARRIER            PIC X.
  4913                     28  AG-GROUPING           PIC X(6).
  4914                 24  AG-BANK                   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  90
* EL517.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  4915             20  AG-CTL-2.
  4916                 24  AG-EXP-DT                 PIC XX.
  4917         16  AG-TYPE                           PIC X.
  4918             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  4919             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  4920
  4921     12  AG-MAINT-INFORMATION.
  4922         16  AG-LAST-MAINT-DT                  PIC XX.
  4923         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4924         16  AG-LAST-MAINT-USER                PIC X(4).
  4925         16  FILLER                            PIC X(10).
  4926
  4927     12  AG-EFF-DT                             PIC XX.
  4928     12  AG-COMM-STRUCTURE.
  4929         16  AG-AGT-COMMS OCCURS 10.
  4930             20  AG-AGT                PIC X(10).
  4931             20  AG-COM-TYP            PIC X.
  4932             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  4933             20  AG-RECALC-LV-INDIC    PIC X.
  4934             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  4935             20  AG-LRCALC-LV-INDIC    PIC X.
  4936             20  FILLER                PIC X(05).
  4937
  4938     12  FILLER                  PIC X(145).
  4939******************************************************************
  4940
  4941 FD  ELCRTT.
* 4942                                 COPY ELCCRTT.
  4943******************************************************************
  4944*                                                                *ELCCRTT
  4945*                            ELCCRTT.                            *
  4946*                                                                *ELCCRTT
  4947*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  4948*                                                                *ELCCRTT
  4949*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  4950*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  4951*                                                                *ELCCRTT
  4952*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  4953*                                                                *ELCCRTT
  4954*   LOG = YES                                                    *ELCCRTT
  4955*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  4956******************************************************************
  4957*                   C H A N G E   L O G
  4958*
  4959* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4960*-----------------------------------------------------------------
  4961*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4962* EFFECTIVE    NUMBER
  4963*-----------------------------------------------------------------
  4964* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4965* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  4966* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  4967* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4968******************************************************************
  4969                                                                  ELCCRTT
  4970 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  4971     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  4972         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  91
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  4973                                                                  ELCCRTT
  4974     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  4975         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  4976         16  CS-CARRIER                    PIC X.                 ELCCRTT
  4977         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  4978         16  CS-STATE                      PIC XX.                ELCCRTT
  4979         16  CS-ACCOUNT                    PIC X(10).
  4980         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  4981         16  CS-CERT-NO.                                          ELCCRTT
  4982             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  4983             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  4984         16  CS-TRAILER-TYPE               PIC X.
  4985             88  COMM-TRLR           VALUE 'A'.
  4986             88  FUTURE-TRLR         VALUE 'B'.
  4987             88  CERT-DATA-TRLR      VALUE 'C'.
  4988                                                                  ELCCRTT
  4989     12  CS-DATA-AREA                      PIC X(516).
  4990
  4991     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  4992         16  CS-BANK-COMMISSION-AREA.
  4993             20  CS-BANK-COMMS       OCCURS 10.
  4994                 24  CS-AGT                PIC X(10).
  4995                 24  CS-COM-TYP            PIC X.
  4996                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  4997                 24  CS-RECALC-LV-INDIC    PIC X.
  4998                 24  FILLER                PIC X(10).
  4999
  5000         16  FILLER                        PIC X(256).
  5001
  5002     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5003         16  CS-VIN-NUMBER                 PIC X(17).
  5004         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5005         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5006         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5007         16  FILLER                        PIC X(496).
  5008
  5009******************************************************************ELCCRTT
  5010
  5011 FD  ERPDEF.
  5012
* 5013                                 COPY ERCPDEF.
  5014******************************************************************
  5015*                                                                *
  5016*                                                                *
  5017*                            ERCPDEF.                            *
  5018*                                                                *
  5019*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5020*                                                                *
  5021*    FILE TYPE = VSAM,KSDS                                       *
  5022*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5023*                                                                *
  5024*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5025*                                                                *
  5026*    LOG = YES                                                   *
  5027*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5028******************************************************************
  5029 01  PRODUCT-MASTER.
  5030    12  PD-RECORD-ID                 PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  92
* EL517.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  5031        88  VALID-PD-ID                  VALUE 'PD'.
  5032
  5033    12  PD-CONTROL-PRIMARY.
  5034        16  PD-COMPANY-CD            PIC X.
  5035        16  PD-STATE                 PIC XX.
  5036        16  PD-PRODUCT-CD            PIC XXX.
  5037        16  PD-FILLER                PIC X(7).
  5038        16  PD-BEN-TYPE              PIC X.
  5039        16  PD-BEN-CODE              PIC XX.
  5040        16  PD-PROD-EXP-DT           PIC XX.
  5041
  5042    12  FILLER                       PIC X(50).
  5043
  5044    12  PD-PRODUCT-DATA OCCURS 8.
  5045        16  PD-PROD-CODE             PIC X.
  5046            88  PD-PROD-LIFE           VALUE 'L'.
  5047            88  PD-PROD-PROP           VALUE 'P'.
  5048            88  PD-PROD-AH             VALUE 'A'.
  5049            88  PD-PROD-IU             VALUE 'I'.
  5050            88  PD-PROD-GAP            VALUE 'G'.
  5051        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5052        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5053        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5054        16  PD-MAX-TERM              PIC S999        COMP-3.
  5055        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5056        16  FILLER                   PIC X.
  5057        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5058        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5059        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5060        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5061        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5062        16  PD-REC-CRIT-PERIOD       PIC X.
  5063        16  PD-RTW-MOS               PIC 99.
  5064        16  FILLER                   PIC X(5).
  5065
  5066    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5067
  5068    12  PD-TERM-LIMITS OCCURS 15.
  5069        16  PD-LOW-TERM              PIC S999        COMP-3.
  5070        16  PD-HI-TERM               PIC S999        COMP-3.
  5071
  5072*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5073    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5074        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5075        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5076
  5077    12  PD-EARN-FACTORS.
  5078        16  FILLER OCCURS 15.
  5079            20  FILLER OCCURS 15.
  5080                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5081
  5082    12  PD-PRODUCT-DESC              PIC X(80).
  5083    12  PD-TRUNCATED                 PIC X.
  5084    12  FILLER                       PIC X(59).
  5085
  5086    12  PD-MAINT-INFORMATION.
  5087        16  PD-LAST-MAINT-DT         PIC X(02).
  5088        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  93
* EL517.cbl
  5089        16  PD-LAST-MAINT-BY         PIC X(04).
  5090
  5091 FD  ELSTAT.
  5092
* 5093                                 COPY ELCSTATE.
  5094******************************************************************
  5095*                                                                *
  5096*                                                                *
  5097*                            ELCSTATE.                           *
  5098*                                                                *
  5099*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  5100*                                                                *
  5101*   FILE TYPE = VSAM,KSDS                                        *
  5102*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5103*                                                                *
  5104*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  5105*       ALTERNATE INDEX = NONE                                   *
  5106*                                                                *
  5107*   LOG = YES                                                    *
  5108*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5109******************************************************************
  5110*                   C H A N G E   L O G
  5111*
  5112* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5113*-----------------------------------------------------------------
  5114*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5115* EFFECTIVE    NUMBER
  5116*-----------------------------------------------------------------
  5117* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  5118******************************************************************
  5119*
  5120 01  STATE-FILE.
  5121     12  SF-RECORD-ID                       PIC XX.
  5122         88  VALID-CF-ID                        VALUE 'SF'.
  5123
  5124     12  SF-CONTROL-PRIMARY.
  5125         16  SF-COMPANY-ID                  PIC XXX.
  5126         16  SF-CARRIER-CODE                PIC X.
  5127         16  SF-GROUPING                    PIC X(6).
  5128         16  SF-STATE-CODE                  PIC XX.
  5129         16  SF-EXPIRE-DATE                 PIC 9(8).
  5130
  5131****************************************************************
  5132*             STATE CONTROLS
  5133****************************************************************
  5134
  5135     12  SF-LAST-MAINT-DT                   PIC XX.
  5136     12  SF-LAST-MAINT-BY                   PIC X(4).
  5137     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5138
  5139     12  SF-STATE-RT-CONTROLS.
  5140         16  SF-ST-RT-CALC                  PIC X.
  5141
  5142     12  SF-ST-TAX-CONTROLS.
  5143         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5144         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5145         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5146
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  94
* EL517.cbl (/apps/prod/cid1p/copy/ELCSTATE)
  5147     12  SF-ST-REFUND-OPTIONS.
  5148         16  SF-ST-RF-LR-CALC               PIC X.
  5149         16  SF-ST-RF-LL-CALC               PIC X.
  5150         16  SF-ST-RF-LN-CALC               PIC X.
  5151         16  SF-ST-RF-AH-CALC               PIC X.
  5152         16  SF-ST-RF-CP-CALC               PIC X.
  5153
  5154     12  SF-ST-UNEARN-PREM-OPTIONS.
  5155         16  SF-ST-LUEP-R78                 PIC X.
  5156         16  SF-ST-LUEP-PRO                 PIC X.
  5157         16  SF-ST-LUEP-ST                  PIC X.
  5158         16  SF-ST-LUEP-DOM                 PIC X.
  5159         16  SF-ST-AUEP-R78                 PIC X.
  5160         16  SF-ST-AUEP-PRO                 PIC X.
  5161         16  SF-ST-AUEP-ST                  PIC X.
  5162         16  SF-ST-AUEP-DOM                 PIC X.
  5163         16  SF-ST-CUEP-R78                 PIC X.
  5164         16  SF-ST-CUEP-PRO                 PIC X.
  5165         16  SF-ST-CUEP-ST                  PIC X.
  5166         16  SF-ST-CUEP-DOM                 PIC X.
  5167
  5168     12  SF-ST-EARN-PREM-OPTIONS.
  5169         16  SF-ST-LEP-R78                  PIC X.
  5170         16  SF-ST-LEP-PRO                  PIC X.
  5171         16  SF-ST-LEP-ST                   PIC X.
  5172         16  SF-ST-LEP-DOM                  PIC X.
  5173         16  SF-ST-AEP-R78                  PIC X.
  5174         16  SF-ST-AEP-PRO                  PIC X.
  5175         16  SF-ST-AEP-ST                   PIC X.
  5176         16  SF-ST-AEP-DOM                  PIC X.
  5177         16  SF-ST-CEP-R78                  PIC X.
  5178         16  SF-ST-CEP-PRO                  PIC X.
  5179         16  SF-ST-CEP-ST                   PIC X.
  5180         16  SF-ST-CEP-DOM                  PIC X.
  5181
  5182     12  SF-FOR-FUTURE-USE                  PIC X(179).
  5183
  5184 FD  ELCRTO.
  5185
* 5186                                 COPY ELCCRTO.
  5187******************************************************************
  5188*                                                                *
  5189*                            ELCCRTO.                            *
  5190*                                                                *
  5191*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5192*                                                                *
  5193*   FILE TYPE = VSAM,KSDS                                        *
  5194*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5195*                                                                *
  5196*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5197*                                                                *
  5198*   LOG = YES                                                    *
  5199*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5200******************************************************************
  5201*                   C H A N G E   L O G
  5202*
  5203* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5204*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  95
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5205*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5206* EFFECTIVE    NUMBER
  5207*-----------------------------------------------------------------
  5208* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5209* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5210* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5211* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5212* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5213******************************************************************
  5214
  5215 01  ORIGINAL-CERTIFICATE.
  5216     12  OC-RECORD-ID                      PIC XX.
  5217         88  VALID-OC-ID                      VALUE 'OC'.
  5218
  5219     12  OC-CONTROL-PRIMARY.
  5220         16  OC-COMPANY-CD                 PIC X.
  5221         16  OC-CARRIER                    PIC X.
  5222         16  OC-GROUPING                   PIC X(6).
  5223         16  OC-STATE                      PIC XX.
  5224         16  OC-ACCOUNT                    PIC X(10).
  5225         16  OC-CERT-EFF-DT                PIC XX.
  5226         16  OC-CERT-NO.
  5227             20  OC-CERT-PRIME             PIC X(10).
  5228             20  OC-CERT-SFX               PIC X.
  5229         16  OC-RECORD-TYPE                PIC X.
  5230         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5231
  5232     12  OC-LAST-MAINT-DT                  PIC XX.
  5233     12  OC-LAST-MAINT-BY                  PIC X(4).
  5234     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5235
  5236     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5237     12  FILLER                            PIC X(49).
  5238
  5239     12  OC-ORIG-REC.
  5240         16  OC-INS-LAST-NAME              PIC X(15).
  5241         16  OC-INS-FIRST-NAME             PIC X(10).
  5242         16  OC-INS-MIDDLE-INIT            PIC X.
  5243         16  OC-INS-AGE                    PIC S999     COMP-3.
  5244         16  OC-JNT-LAST-NAME              PIC X(15).
  5245         16  OC-JNT-FIRST-NAME             PIC X(10).
  5246         16  OC-JNT-MIDDLE-INIT            PIC X.
  5247         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5248         16  OC-LF-BENCD                   PIC XX.
  5249         16  OC-LF-TERM                    PIC S999      COMP-3.
  5250         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5251         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5252         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5253         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5254         16  OC-LF-EXP-DT                  PIC XX.
  5255         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5256         16  OC-LF-CANCEL-DT               PIC XX.
  5257         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5258         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5259         16  OC-AH-BENCD                   PIC XX.
  5260         16  OC-AH-TERM                    PIC S999      COMP-3.
  5261         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5262         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  96
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5263         16  OC-AH-EXP-DT                  PIC XX.
  5264         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5265         16  OC-AH-CP                      PIC 99.
  5266         16  OC-AH-CANCEL-DT               PIC XX.
  5267         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5268         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5269         16  OC-CRED-BENE-NAME             PIC X(25).
  5270         16  OC-1ST-PMT-DT                 PIC XX.
  5271         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5272         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5273         16  OC-ISSUE-TRAN-IND             PIC X.
  5274         16  OC-CANCEL-TRAN-IND            PIC X.
  5275         16  FILLER                        PIC X(211).
  5276
  5277     12  FILLER                            PIC X(50).
  5278
  5279******************************************************************
  5280
  5281 WORKING-STORAGE SECTION.
  5282 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  5283 77  FILLER   PIC X(32) VALUE '********************************'.
  5284 77  FILLER   PIC X(32) VALUE '**   EL517 WORKING STORAGE    **'.
  5285 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.040 *********'.
  5286
  5287 77  ELCNTL-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5288 77  ERPLAN-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5289 77  ERACCT-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5290 77  ERFORM-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5291
  5292 77  WS-ZERO                PIC S9        COMP-3   VALUE ZERO.
  5293 77  WS-RETURN-CODE         PIC S9(4)     COMP     VALUE ZERO.
  5294 77  WS-ABEND-MESSAGE       PIC X(80)              VALUE SPACES.
  5295 77  WS-ABEND-FILE-STATUS   PIC XX                 VALUE ZERO.
  5296 77  PGM-SUB                PIC S9(4)     COMP     VALUE +517.
  5297 77  SUB-X                  PIC S9(4)     COMP     VALUE   +0.
  5298 77  X                      PIC X                  VALUE ' '.
  5299 77  OLC-REPORT-NAME        PIC X(6)               VALUE 'EL517 '.
  5300
  5301 01  TRAN-CT                PIC 9(5)               VALUE 0.
  5302 01  TRAN-CX REDEFINES TRAN-CT.
  5303     12  FILLER             PIC XX.
  5304     12  TCX                PIC 999.
  5305 01  SEQ-NO                 PIC 9999               VALUE 0.
  5306 01  RPND                   PIC 9(5)               VALUE 0.
  5307 01  WPND                   PIC 9(5)               VALUE 0.
  5308 01  RREI                   PIC 9(5)               VALUE 0.
  5309 01  RCTB                   PIC 9(5)               VALUE 0.
  5310 01  RACC                   PIC 9(5)               VALUE 0.
  5311 01  RCER                   PIC 9(5)               VALUE 0.
  5312 01  RCNT                   PIC 9(5)               VALUE 0.
  5313 01  WCER                   PIC 9(5)               VALUE 0.
  5314 01  ERPNDM-OPEN            PIC X                  VALUE SPACES.
  5315 01  ERMAIL-OPEN            PIC X                  VALUE SPACES.
  5316 01  ELMSTR-OPEN            PIC X                  VALUE SPACES.
  5317 01  ELCRTT-OPEN            PIC X                  VALUE SPACES.
  5318 01  ELCRTO-OPEN            PIC X                  VALUE SPACES.
  5319 01  WS-AH-CLAIM-RESCINDED  PIC X                  VALUE 'N'.
  5320 01  EMSG.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  97
* EL517.cbl
  5321     12  WS-FILE-ERROR-MESSAGE.
  5322         16  FILLER              PIC X(24)   VALUE
  5323             'ERROR OCCURED OPENING - '.
  5324         16  WS-FEM-FILE-NAME    PIC X(8).
  5325
  5326 01  CMSG.
  5327     12  WS-FILE-ERROR-MESSAGE.
  5328         16  FILLER              PIC X(24)   VALUE
  5329             'ERROR OCCURED CLOSING - '.
  5330         16  WS-CEM-FILE-NAME    PIC X(8).
  5331
  5332 01  RMSG.
  5333     12  WS-FILE-ERROR-MESSAGE.
  5334         16  FILLER              PIC X(24)   VALUE
  5335             'ERROR OCCURED READING - '.
  5336         16  WS-REM-FILE-NAME    PIC X(8).
  5337
  5338 01  HDG1.
  5339     12  FILLER                  PIC X(50)       VALUE ' '.
  5340     12  FILLER                  PIC X(28)       VALUE
  5341                   'PENDING BUSINESS FILE EDIT '.
  5342     12  ER-ONLY                 PIC X(47)       VALUE
  5343          'NEW ITEMS AND FATAL ERRORS ONLY'.
  5344     12  FILLER                  PIC X(7)        VALUE 'EL517A'.
  5345
  5346 01  HDG2.
  5347     12  FILLER              PIC X(52)              VALUE SPACE.
  5348     12  H2-COMP             PIC X(30).
  5349     12  FILLER              PIC X(42)              VALUE SPACE.
  5350     12  H2-DATE             PIC X(8).
  5351
  5352 01  HDG3.
  5353     12  FILLER              PIC X(54)              VALUE SPACE.
  5354     12  H3-DATE             PIC X(18).
  5355     12  FILLER              PIC X(49)              VALUE SPACE.
  5356
  5357 01  SUM1.
  5358     12  FILLER              PIC XX                 VALUE ' '.
  5359     12  SUM-TOT             PIC ZZ,ZZZ.
  5360     12  FILLER              PIC X(3)               VALUE SPACE.
  5361     12  FILLER              PIC X(30)              VALUE
  5362          'ITEMS EDITED'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  98
* EL517.cbl
  5364
  5365 01  WX-AREA.
  5366     12  PH-COBOL            PIC X.
  5367     12  HOLD-ELCNTL         PIC X(750) OCCURS 11 TIMES.
  5368
  5369 01  STATUS-SWITCH.
  5370     12  ELCNTL-FILE-STATUS       PIC XX VALUE SPACES.
  5371     12  ERPNDB-FILE-STATUS       PIC XX VALUE SPACES.
  5372     12  ERREIN-FILE-STATUS       PIC XX VALUE SPACES.
  5373     12  ELCERT-FILE-STATUS       PIC XX VALUE SPACES.
  5374     12  ELMSTR-FILE-STATUS       PIC XX VALUE SPACES.
  5375     12  ERMAIL-FILE-STATUS       PIC XX VALUE SPACES.
  5376     12  ERPLAN-FILE-STATUS       PIC XX VALUE SPACES.
  5377     12  ERFORM-FILE-STATUS       PIC XX VALUE SPACES.
  5378     12  ERPNDM-FILE-STATUS       PIC XX VALUE SPACES.
  5379     12  ERCTBL-FILE-STATUS       PIC XX VALUE SPACES.
  5380     12  ERACCT-FILE-STATUS.
  5381         16  ERACCT-FILE-STAT-1   PIC X  VALUE ' '.
  5382         16  ERACCT-FILE-STAT-2   PIC X  VALUE ' '.
  5383     12  ELCERR-FILE-STATUS       PIC XX VALUE SPACES.
  5384     12  ERRESS-FILE-STATUS       PIC XX VALUE SPACES.
  5385     12  ERRESC-FILE-STATUS       PIC XX VALUE SPACES.
  5386     12  ERCOMP-FILE-STATUS       PIC XX VALUE SPACES.
  5387     12  ERLOFC-FILE-STATUS       PIC XX VALUE SPACES.
  5388     12  ERBXRF-FILE-STATUS       PIC XX VALUE SPACES.
  5389     12  ERAGTC-FILE-STATUS       PIC XX VALUE SPACES.
  5390     12  ELCRTT-FILE-STATUS       PIC XX VALUE SPACES.
  5391     12  ERPDEF-FILE-STATUS       PIC XX VALUE SPACES.
  5392     12  ELSTAT-FILE-STATUS       PIC XX VALUE SPACES.
  5393     12  ELCRTO-FILE-STATUS       PIC XX VALUE SPACES.
  5394
  5395     12  EMI-WARNING-CTR          PIC S999  COMP-3  VALUE +0.
  5396     12  EMI-FORCABLE-CTR         PIC S999  COMP-3  VALUE +0.
  5397     12  EMI-FATAL-CTR            PIC S999  COMP-3  VALUE +0.
  5398     12  WS-SW-1                  PIC X  VALUE ' '.
  5399     12  WS-SW-2                  PIC X  VALUE ' '.
  5400
  5401     12  WS-COMPUTED-TOTALS      COMP-3.
  5402         16  WS-LF-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5403         16  WS-LF-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5404         16  WS-AH-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5405         16  WS-AH-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5406         16  WS-LF-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5407         16  WS-LF-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5408         16  WS-AH-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5409         16  WS-AH-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5410         16  WS-ISSUE-CNT        PIC 9(5)      VALUE ZEROS COMP-3.
  5411         16  WS-CANCEL-CNT       PIC 9(5)      VALUE ZEROS COMP-3.
  5412     12  WS-LGX-CLAIM-USER       PIC X         VALUE SPACES.
  5413         88  CO-HAS-CLAIMS                     VALUE '2'.
  5414
  5415     12  EIBDATE                 PIC S9(7)     COMP-3.
  5416
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page  99
* EL517.cbl
  5418
  5419* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
* 5420     COPY ELC50W1.
  5421******************************************************************04/19/98
  5422*                                                                *ELC50W1
  5423*                                                                *ELC50W1
  5424*                             ELC50W1                            *   LV005
  5425*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  5426*                            VMOD=2.004                          *   CL**5
  5427*                                                                *ELC50W1
  5428*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *ELC50W1
  5429*                                                                *ELC50W1
  5430*                                                                *ELC50W1
  5431******************************************************************ELC50W1
  5432                                                                  ELC50W1
  5433     12  WK-WORK-AREA.                                            ELC50W1
  5434         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.          ELC50W1
  5435         16  WK-LAST-CARRIER          PIC X   VALUE ' '.          ELC50W1
  5436         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.          ELC50W1
  5437         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.          ELC50W1
  5438         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5439         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5440         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5441         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5442         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5443         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5444         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.          ELC50W1
  5445         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.          ELC50W1
  5446         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.          ELC50W1
  5447         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.          ELC50W1
  5448         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE. ELC50W1
  5449         16  WK-CREDIT-EDIT-CONTROLS.                             ELC50W1
  5450             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.       ELC50W1
  5451             20  WK-MIN-AGE           PIC 99  VALUE 00.           ELC50W1
  5452             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.           ELC50W1
  5453             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5454             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5455             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.           ELC50W1
  5456         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.     ELC50W1
  5457         16  WK-SAVE-REIN-DATA.                                   ELC50W1
  5458             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.      ELC50W1
  5459             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.      ELC50W1
  5460             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.      ELC50W1
  5461         16  WK-ENTRY-SW              PIC X    VALUE ' '.         ELC50W1
  5462             88  ENTRY-FROM-EL6311       VALUE '6'.               ELC50W1
  5463         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.         ELC50W1
  5464         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.      ELC50W1
  5465     12  WK-RECORD-ADDRESSES.                                     ELC50W1
  5466         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5467         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5468         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5469         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5470         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5471         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5472         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5473         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5474     12  WK-OVER-SHORT-AREA.                                      ELC50W1
  5475         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.   CL**2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 100
* EL517.cbl (/apps/prod/cid1p/copy/ELC50W1)
  5476         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.   CL**2
  5477         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  5478             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  5479         16  FILLER                   PIC X(5) VALUE SPACES.         CL**3
  5480
  5481         16  WK-CONV-GREG.
  5482             24  WCG-CENT             PIC XX.
  5483             24  WCG-REST             PIC X(4).
  5484         16  WORK-GREGORIAN-DATE.
  5485             24  WK-GREG-CENT         PIC XX.
  5486             24  WK-GREG-DATE-YYMMDD.
  5487                 28  WK-GREG-YYMM     PIC X(4).
  5488                 28  WK-GREG-DD       PIC XX.
  5489
  5490         16  WORK-SELECT-DATE.
  5491             24  WK-SELECT-CENT           PIC XX.
  5492             24  WK-SELECT-DATE-YYMMDD.
  5493                 28  WK-SELECT-GREG-YYMM  PIC X(4).
  5494                 28  FILLER               PIC XX.
  5495
  5496         16  WK-FORM-NO.
  5497             24  WK-FORM-BANK-ID       PIC X(5).
  5498             24  WK-FORM-UNDRWRTR      PIC X(1).
  5499             24  WK-FORM-MASTER-POL-NO PIC X(6).
  5500
  5501         16  WK-MEMBER-NO.
  5502             24  WK-MEMBER-1-6        PIC X(6).
  5503             24  WK-MEMBER-7-12       PIC X(6).
  5504
  5505         16  WK-FULL-CERT-NO.
  5506             24  WK-CERT-POS-1-2      PIC X(2).
  5507             24  WK-CERT-POS-3        PIC X(1).
  5508             24  WK-CERT-POS-4        PIC X(1).
  5509             24  WK-CERT-POS-5-6      PIC X(2).
  5510             24  WK-CERT-POS-7        PIC X(1).
  5511             24  WK-CERT-POS-8-11     PIC X(4).
  5512
  5513         16  WK-VALID-RATE-CODE      PIC X VALUE ' '.
  5514             88  VALID-RATE-CODE     VALUE 'Y'.
  5515             88  FOUND-TO-BE-INVALID VALUE 'N'.
  5516
  5517     12  WK-BATCH-NO.
  5518         16  WK-BATCH-PREFIX          PIC XXX       VALUE SPACES.
  5519         16  FILLER                   PIC XXX       VALUE SPACES.
  5520
* 5521                                  COPY ELCEDITC.
  5522******************************************************************04/15/98
  5523*                                                                *ELCEDITC
  5524*                                                                *ELCEDITC
  5525*                            ELCEDITC                            *   LV002
  5526*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5527*                            VMOD=2.012                          *   CL**2
  5528*                                                                *ELCEDITC
  5529*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *ELCEDITC
  5530*                     EL6313, EL050 AND EL517.                   *ELCEDITC
  5531*                                                                *ELCEDITC
  5532******************************************************************ELCEDITC
  5533******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 101
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5534*                   C H A N G E   L O G
  5535*
  5536* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5537*-----------------------------------------------------------------
  5538*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5539* EFFECTIVE    NUMBER
  5540*-----------------------------------------------------------------
  5541* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5542******************************************************************
  5543                                                                  ELCEDITC
  5544     12  EDIT-CRITERIA-DATA.                                      ELCEDITC
  5545         16  EC-CO-MONTH-END-DT       PIC XX.                     ELCEDITC
  5546         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5547         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
  5548         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5549         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5550         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.       ELCEDITC
  5551         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.       ELCEDITC
  5552         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5553         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5554         16  EC-CO-REM-TERM-CALC      PIC X.                      ELCEDITC
  5555               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.     ELCEDITC
  5556               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.     ELCEDITC
  5557               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.     ELCEDITC
  5558               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.     ELCEDITC
  5559                                                                  ELCEDITC
  5560         16  EC-BR-LF-EARNINGS-CALC    PIC X.                     ELCEDITC
  5561               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5562               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5563               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5564               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.    ELCEDITC
  5565               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.    ELCEDITC
  5566               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5567               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5568               88  EC-BR-LF-EARN-MEAN               VALUE '8'.    ELCEDITC
  5569               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.    ELCEDITC
  5570               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5571                                                                  ELCEDITC
  5572         16  EC-BR-AH-EARNINGS-CALC    PIC X.                     ELCEDITC
  5573               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5574               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5575               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5576               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.    ELCEDITC
  5577               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5578               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5579               88  EC-BR-AH-EARN-MEAN               VALUE '8'.    ELCEDITC
  5580               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5581                                                                  ELCEDITC
  5582         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5583                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5584                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5585                                                                  ELCEDITC
  5586         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5587                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5588                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.  ELCEDITC
  5589                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.  ELCEDITC
  5590                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.  ELCEDITC
  5591                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.  ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 102
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5592                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.  ELCEDITC
  5593                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5594                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.  ELCEDITC
  5595                                                                  ELCEDITC
  5596         16  EC-BR-LF-COVERAGE-TYPE    PIC X.                     ELCEDITC
  5597               88  EC-BR-REDUCING                   VALUE 'R'.    ELCEDITC
  5598               88  EC-BR-LEVEL                      VALUE 'L' 'P'.ELCEDITC
  5599                                                                  ELCEDITC
  5600         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).                  ELCEDITC
  5601         16  EC-BR-LF-DESC             PIC X(10).                 ELCEDITC
  5602         16  EC-BR-AH-DESC             PIC X(10).                 ELCEDITC
  5603         16  EC-BR-LF-COMMENT          PIC X(10).                 ELCEDITC
  5604         16  EC-BR-AH-COMMENT          PIC X(10).                 ELCEDITC
  5605                                                                  ELCEDITC
  5606         16  EC-BR-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5607               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5608               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5609               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5610               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5611                                                                  ELCEDITC
  5612         16  EC-BR-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5613               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5614               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5615               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5616               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5617                                                                  ELCEDITC
  5618         16  EC-BR-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5619                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5620                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5621                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5622                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5623                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5624                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5625                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5626                                                                  ELCEDITC
  5627         16  EC-BR-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5628                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5629                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5630                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5631                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5632                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5633                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5634                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5635                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5636                                                                  ELCEDITC
  5637         16  EC-BR-LF-BEN-I-G-CD       PIC X.                     ELCEDITC
  5638                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5639                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5640                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5641                                                                  ELCEDITC
  5642         16  EC-BR-AH-BEN-I-G-CD       PIC X.                     ELCEDITC
  5643                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5644                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5645                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5646                                                                  ELCEDITC
  5647         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5648         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5649         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 103
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5650         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5651                                                                  ELCEDITC
  5652         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.       ELCEDITC
  5653         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.                      ELCEDITC
  5654                 88  EC-ST-EXT-NO-CHG               VALUE ' '.    ELCEDITC
  5655                 88  EC-ST-EXT-CHG-LF               VALUE '1'.    ELCEDITC
  5656                 88  EC-ST-EXT-CHG-AH               VALUE '2'.    ELCEDITC
  5657                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.    ELCEDITC
  5658                                                                  ELCEDITC
  5659         16  EC-ST-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5660               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5661               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5662               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5663               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5664               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5665                                                                  ELCEDITC
  5666         16  EC-ST-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5667               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5668               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5669               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5670               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5671               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5672                                                                  ELCEDITC
  5673         16  EC-ST-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5674                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5675                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5676                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5677                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5678                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5679                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5680                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5681                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5682                                                                  ELCEDITC
  5683         16  EC-ST-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5684                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5685                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5686                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5687                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5688                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5689                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5690                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5691                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5692                                                                  ELCEDITC
  5693         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5694         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5695         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5696         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5697         16  EC-AM-EXPIRATION-DT       PIC XX.                    ELCEDITC
  5698         16  EC-AM-EFFECTIVE-DT        PIC XX.                    ELCEDITC
  5699         16  EC-AM-CLASS-CD            PIC XX.                    ELCEDITC
  5700         16  EC-AM-LF-DEVIATION        PIC XXX.                   ELCEDITC
  5701         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5702         16  EC-AM-AH-DEVIATION        PIC XXX.                   ELCEDITC
  5703         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5704         16  EC-AM-PHONE-NO            PIC X(10).                 ELCEDITC
  5705                                                                  ELCEDITC
  5706         16  EC-AM-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5707                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 104
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5708                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5709                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5710                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5711                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5712                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5713                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5714                                                                  ELCEDITC
  5715         16  EC-AM-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5716                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5717                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5718                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5719                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.    ELCEDITC
  5720                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5721                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5722                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5723                                                                  ELCEDITC
  5724         16  EC-AM-BEN-I-G-CD          PIC X.                     ELCEDITC
  5725                 88  WK-AM-I-G-NOT-USED             VALUE ' '.    ELCEDITC
  5726                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.    ELCEDITC
  5727                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.    ELCEDITC
  5728                                                                  ELCEDITC
  5729         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5730         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5731         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5732         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5733         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5734         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5735         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5736         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5737         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5738                                                                  ELCEDITC
  5739         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5740         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5741         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5742         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5743         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5744         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5745         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5746         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5747         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5748         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5749         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5750         16  EC-RT-LF-NSP-ST           PIC XX.                    ELCEDITC
  5751         16  EC-RT-AH-NSP-ST           PIC XX.                    ELCEDITC
  5752         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5753         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5754                                                                  ELCEDITC
  5755         16  EC-CM-LF-PRIOR-STATUS     PIC X.                     ELCEDITC
  5756             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5757                                             'M' '5' '9' '2'.     ELCEDITC
  5758             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5759             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5760             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5761             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5762             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5763             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5764             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5765             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 105
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5766             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5767             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5768                                                                  ELCEDITC
  5769         16  EC-CM-AH-PRIOR-STATUS     PIC X.                     ELCEDITC
  5770             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5771                                             'M' '5' '9' '2'.     ELCEDITC
  5772             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5773             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5774             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5775             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5776             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5777             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5778             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5779             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
  5780             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5781             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5782                                                                  ELCEDITC
  5783         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5784         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5785         16  EC-CM-LF-CANCEL-DT        PIC XX.                    ELCEDITC
  5786         16  EC-CM-AH-CANCEL-DT        PIC XX.                    ELCEDITC
  5787         16  EC-CM-DEATH-DT            PIC XX.                    ELCEDITC
  5788                                                                  ELCEDITC
  5789*DMD CUSTOM CODING FIELDS BELOW                                   ELCEDITC
  5790*POPULATED BY CF-RATING-SWITCH AT EL050 TIME                      ELCEDITC
  5791         16  EC-BR-DMD-RATING-SW       PIC X.                     ELCEDITC
  5792                 88  EC-DMD-AH-RATING            VALUE 'Y'.       ELCEDITC
  5793                 88  EC-DMD-LF-RATING            VALUE 'Y'.       ELCEDITC
  5794                 88  NO-DMD-RATING               VALUE 'N'.       ELCEDITC
  5795                                                                  ELCEDITC
  5796         16  EC-NEW-CERT               PIC X(11).                 ELCEDITC
  5797         16  EC-NEW-STATE              PIC XX.                    ELCEDITC
  5798         16  FILLER                    PIC X.                     ELCEDITC
  5799*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.                 ELCEDITC
  5800         16  OVER-SHORT-EDIT-FIELDS.                              ELCEDITC
  5801             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5802             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5803             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5804             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5805             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5806             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5807             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5808             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5809             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5810         16  FILLER                    PIC X(71).                 ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 106
* EL517.cbl
* 5812                                  COPY ELC50WS.
  5813*****************************************************************
  5814*                                                               *
  5815*                            ELC50WS.                           *
  5816*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5817*                            VMOD=2.061.                        *
  5818*                                                               *
  5819*   THIS IS THE WORKING STORAGE FOR EL050                       *
  5820*                                   EL517                       *
  5821*****************************************************************
  5822******************************************************************
  5823*                   C H A N G E   L O G
  5824*
  5825* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5826*-----------------------------------------------------------------
  5827*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5828* EFFECTIVE    NUMBER
  5829*-----------------------------------------------------------------
  5830* 123102                   PEMA  ADD DCC PROCESSING
  5831* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
  5832* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
  5833* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5834* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5835* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  5836* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  5837* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  5838* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
  5839* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  5840* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  5841* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
  5842* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  5843* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  5844* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  5845* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  5846* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
  5847* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5848* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
  5849* 030309  CR2009021700001  PEMA  ADD ER-2883
  5850* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
  5851* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5852* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  5853* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  5854* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
  5855* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  5856* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  5857* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  5858* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5859* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  5860* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  5861* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  5862* 061412  CR2011022800001  AJRA  NAPERSOFT
  5863* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5864* 012213  CR2013011600001  PEMA  ADD ERROR 3058
  5865* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  5866*-----------------------------------------------------------------
  5867
  5868 01  WORK-AREAS.
  5869
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 107
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  5870*****************************************************************
  5871*        WORKING STORAGE AREA FOR CLIENT-MON                    *
  5872*****************************************************************
  5873
  5874     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
  5875     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
  5876     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
  5877     12  WS-NAME-EDIT-WORK-AREA.
  5878         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
  5879         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
  5880             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
  5881         16  WS-WORK-NAME.
  5882             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
  5883             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
  5884             20  FILLER           PIC X(10)     VALUE SPACES.
  5885         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
  5886             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
  5887
  5888*****************************************************************
  5889*        END OF WORKING STORAGE FOR CLIENT-MON                  *
  5890*****************************************************************
  5891
  5892     12  WS-ERRESC-KEY.
  5893         16 WS-ERRESC-SEARCH-KEY.
  5894             20  WS-ERRESC-COMPANY-CD PIC  X.
  5895             20  WS-ERRESC-CARRIER    PIC  X.
  5896             20  WS-ERRESC-GROUP      PIC X(6).
  5897             20  WS-ERRESC-STATE      PIC XX.
  5898             20  WS-ERRESC-ACCOUNT    PIC X(10).
  5899         16 WS-ERRESC-RESIDUAL-KEY.
  5900             20  WS-ERRESC-AGENT      PIC X(10).
  5901             20  WS-ERRESC-RES-STATE  PIC XX.
  5902             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  5903*                                          YYYYMMDD
  5904     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  5905     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
  5906
  5907*RESIDENT STATE TAX MASTER(ERRESS)
  5908*
  5909     12  WS-ERRESS-KEY.
  5910         16  WS-ERRESS-COMPANY-CD      PIC  X.
  5911         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
  5912         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
  5913         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
  5914*                                          YYYYMMDD
  5915
  5916     12  WS-CONTRACT-DATE              PIC 9(8).
  5917*                                          YYYYMMDD
  5918     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
  5919     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
  5920         16 WS-YEAR-YY                 PIC   9999.
  5921         16 FILLER                     PIC 9(4).
  5922*                                          YYYYMMDD
  5923     12  WS-SAVE-ERRESS-KEY            PIC X(9).
  5924     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
  5925     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
  5926     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
  5927
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 108
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  5928     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
  5929         88  DPRB-1ST-TIME                      VALUE ' '.
  5930
  5931*****************************************************************
  5932*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
  5933*****************************************************************
  5934
  5935     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
  5936     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
  5937     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
  5938     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
  5939     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
  5940     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
  5941     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
  5942     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
  5943     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
  5944     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
  5945         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
  5946         88 NO-AH-COVERAGE           VALUE '  ' '00'.
  5947     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
  5948         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
  5949         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
  5950     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
  5951
  5952     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
  5953     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
  5954
  5955     12  WS-R78-METHOD            PIC X         VALUE SPACES.
  5956     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
  5957     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  5958     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  5959     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  5960     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  5961     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  5962     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  5963     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  5964     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  5965     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  5966     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  5967     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
  5968     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
  5969     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
  5970     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
  5971     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  5972     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  5973     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  5974     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  5975     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  5976     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  5977     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  5978     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  5979     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  5980     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  5981     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  5982     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  5983     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  5984     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  5985     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 109
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  5986     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  5987     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  5988     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  5989     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
  5990     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
  5991     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
  5992     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
  5993     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
  5994     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
  5995     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
  5996     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
  5997     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
  5998     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
  5999     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
  6000     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
  6001     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
  6002     12  WS-IG-OVRD               PIC X         VALUE SPACES.
  6003     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
  6004     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
  6005     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
  6006     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
  6007     12  WS-2671-SW               PIC X         VALUE SPACE.
  6008     12  WS-2672-SW               PIC X         VALUE SPACE.
  6009     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
  6010         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
  6011     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
  6012         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
  6013     12  W-BROWSE-SW              PIC X         VALUE SPACE.
  6014
  6015     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
  6016         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
  6017         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
  6018         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
  6019         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
  6020
  6021     12  WS-CREDIT-EDIT-CONTROLS.
  6022         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
  6023         16  WS-MIN-AGE           PIC 99                VALUE  0.
  6024         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
  6025         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6026         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6027         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
  6028
  6029     12  WS-AGE-FIELDS.
  6030         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
  6031         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
  6032         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
  6033         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
  6034
  6035     12  WS-SAVE-ALLOWABLE-BENEFIT.
  6036         16  WS-SAVE-BENEFIT-CODE       PIC XX.
  6037         16  WS-SAVE-BENEFIT-TYPE       PIC X.
  6038         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
  6039         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
  6040         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
  6041         16  FILLER                      PIC XX.
  6042
  6043     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 110
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6044     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
  6045     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
  6046     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
  6047     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
  6048     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
  6049     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
  6050     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
  6051     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6052     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6053
  6054     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
  6055     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
  6056     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6057     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
  6058     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
  6059     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
  6060     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
  6061     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
  6062         88  WS-REDUCING              VALUE 'R'.
  6063         88  WS-LEVEL                 VALUE 'L' 'P'.
  6064     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
  6065
  6066     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
  6067     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
  6068     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6069     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
  6070     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
  6071     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
  6072     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
  6073     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
  6074     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
  6075
  6076     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
  6077     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
  6078     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
  6079     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6080     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
  6081     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6082     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
  6083     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
  6084     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
  6085     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
  6086     12  WS-ACCT-SIG-SW.
  6087         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
  6088         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
  6089     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6090     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6091     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
  6092     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
  6093     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
  6094     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6095     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
  6096     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6097     12  WS-INITIALS.
  6098         16  WS-INIT-1            PIC X         VALUE SPACES.
  6099         16  WS-INIT-2            PIC X         VALUE SPACES.
  6100
  6101     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 111
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6102     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
  6103     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
  6104     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
  6105     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
  6106*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
  6107     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
  6108     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
  6109     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
  6110     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6111     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6112     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
  6113     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
  6114     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
  6115     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
  6116     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
  6117     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
  6118     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
  6119     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
  6120     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6121     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6122     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
  6123     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6124     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6125     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6126     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6127     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6128     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6129******** FLA
  6130     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6131     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6132     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6133     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6134     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6135********
  6136     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
  6137     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
  6138     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
  6139     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
  6140     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
  6141     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
  6142     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
  6143     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
  6144     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
  6145     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
  6146
  6147     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
  6148         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
  6149                                         '0' THRU '9'.
  6150
  6151     12  NUMBER-OF-MONTHS.
  6152         16  SK-MO OCCURS 12 TIMES PIC X.
  6153
  6154     12  WS-WORK-DATE.
  6155         16  WS-YEAR            PIC 99    VALUE 00.
  6156         16  WS-MONTH           PIC 99    VALUE 00.
  6157         16  WS-DAY             PIC 99    VALUE 00.
  6158
  6159     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 112
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6160     12  WS-WORK-CRIT-DEV       REDEFINES
  6161         WS-WORK-LF-CRIT-PER    PIC X(03).
  6162
  6163     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
  6164     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
  6165
  6166     12  WS-WORK-DATE-FROM.
  6167         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
  6168         16  FILLER             PIC X  VALUE SPACE.
  6169         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
  6170         16  FILLER             PIC X         VALUE SPACE.
  6171         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
  6172
  6173     12  WS-WORK-DATE-THRU.
  6174         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
  6175         16  FILLER             PIC X         VALUE SPACE.
  6176         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
  6177         16  FILLER             PIC X         VALUE SPACE.
  6178         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
  6179
  6180     12  WS-LF-INPUT-CD.
  6181         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
  6182         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
  6183
  6184     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
  6185     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
  6186         16  WS-AH-INPUT-CD-1   PIC X.
  6187         16  WS-AH-INPUT-CD-2-3 PIC XX.
  6188
  6189     12  WS-SWITCHES.
  6190         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
  6191         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
  6192             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
  6193         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
  6194             88  BANK-ACCT-FOUND          VALUE 'Y'.
  6195         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
  6196             88  AGENT-MASTER-FOUND       VALUE 'Y'.
  6197         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
  6198             88  BXRF-MASTER-FOUND        VALUE 'Y'.
  6199         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
  6200             88  COMP-MASTER-FOUND        VALUE 'Y'.
  6201         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
  6202             88  LOFC-MASTER-FOUND        VALUE 'Y'.
  6203         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
  6204             88  PDEF-MASTER-FOUND        VALUE 'Y'.
  6205         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
  6206             88  STAT-MASTER-FOUND        VALUE 'Y'.
  6207         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
  6208             88  PLAN-MASTER-FOUND        VALUE 'Y'.
  6209         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
  6210             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
  6211         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
  6212             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
  6213         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
  6214             88  FORM-MASTER-FOUND        VALUE 'Y'.
  6215         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
  6216             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
  6217         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 113
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6218             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
  6219         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
  6220             88  PROCESS-FORM-EDITS       VALUE 'Y'.
  6221         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
  6222             88  NO-BENEFIT-FOUND         VALUE 'N'.
  6223         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
  6224             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
  6225         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
  6226             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
  6227         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6228             88  AH-BENEFIT-FOUND         VALUE ' '.
  6229             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
  6230         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6231             88  LF-BENEFIT-FOUND         VALUE ' '.
  6232             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
  6233         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
  6234             88  NO-STATE-RECORD          VALUE '1'.
  6235         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
  6236             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
  6237         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
  6238             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
  6239         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
  6240             88  CERT-WAS-FOUND           VALUE ' '.
  6241             88  CERT-WAS-NOT-FOUND       VALUE '1'.
  6242         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
  6243             88  BROWSE-STARTED           VALUE 'Y'.
  6244         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
  6245             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
  6246         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
  6247             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
  6248         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
  6249             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
  6250         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
  6251             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
  6252         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
  6253             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
  6254         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
  6255             88  APP-CERT-USED            VALUE 'Y' 'A'.
  6256         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
  6257             88  CTBL-TABLE-FOUND         VALUE 'Y'.
  6258             88  FIRST-TIME-THROUGH       VALUE '1'.
  6259             88  CTBL-NOT-FOUND           VALUE '2'.
  6260
  6261         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
  6262             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
  6263
  6264         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
  6265             88  DLO-ERROR-FOUND          VALUE 'Y'.
  6266
  6267********FLA
  6268     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
  6269     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
  6270********
  6271     12  RC-SW-1                  PIC X           VALUE '0'.
  6272     12  RC-SW-2                  PIC X           VALUE '0'.
  6273     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
  6274     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
  6275     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 114
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6276     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
  6277     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
  6278     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
  6279     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
  6280     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
  6281     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
  6282     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
  6283     12  LIT-SPACES               PIC X           VALUE SPACES.
  6284     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
  6285     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
  6286     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
  6287     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
  6288     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6289     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6290     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
  6291         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
  6292         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
  6293     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
  6294         88  SKIP-ADDR-EDIT         VALUE 'Y'.
  6295
  6296 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
  6297     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
  6298     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
  6299 01  WS-CRI-SSN-WORK-AREA.
  6300     05  WS-CRI-SOC-SEC-NO.
  6301         10  WS-SS-REPT-CD       PIC X(5).
  6302         10  WS-SS-LAST-NAME     PIC X(5).
  6303         10  WS-SS-INITIAL       PIC X.
  6304
  6305     05  WS-CRI-REPORT-CODE.
  6306         10  FILLER              PIC X(5).
  6307         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
  6308
  6309     05  WS-CRI-LAST-NAME.
  6310         10  WS-CRI-NAME-MOVE    PIC X(5).
  6311         10  FILLER              PIC X(10).
  6312
  6313 01  WS-NUM-TABLE                PIC X(26)  VALUE
  6314     '12345678012345070923456789'.
  6315 01  FILLER REDEFINES WS-NUM-TABLE.
  6316     05  WS-NUM OCCURS 26        PIC 9.
  6317 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
  6318 01  V1                          PIC S999 COMP-3.
  6319 01  V2                          PIC S999 COMP-3.
  6320 01  V3                          PIC S999 COMP-3.
  6321 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
  6322 01  FILLER REDEFINES WS-WORK-VIN.
  6323     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
  6324 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
  6325 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
  6326 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
  6327 01  WS-HEX-WORK.
  6328     05  FILLER                  PIC X  VALUE LOW-VALUES.
  6329     05  WS-HEX-BYTE             PIC X.
  6330 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
  6331 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
  6332
  6333 01  WS-WORK-HIN-ROW-B.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 115
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6334     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
  6335
  6336 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
  6337 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
  6338     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
  6339 01  WS-ROW-D-TABLE.
  6340     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
  6341
  6342 01  WS-HIN-TABLE-B.
  6343     05  F                       PIC XX VALUE 'A2'.
  6344     05  F                       PIC XX VALUE 'B3'.
  6345     05  F                       PIC XX VALUE 'C4'.
  6346     05  F                       PIC XX VALUE 'D5'.
  6347     05  F                       PIC XX VALUE 'E6'.
  6348     05  F                       PIC XX VALUE 'F7'.
  6349     05  F                       PIC XX VALUE 'G8'.
  6350     05  F                       PIC XX VALUE 'H9'.
  6351     05  F                       PIC XX VALUE 'I1'.
  6352     05  F                       PIC XX VALUE 'J2'.
  6353     05  F                       PIC XX VALUE 'K3'.
  6354     05  F                       PIC XX VALUE 'L4'.
  6355     05  F                       PIC XX VALUE 'M5'.
  6356     05  F                       PIC XX VALUE 'N6'.
  6357     05  F                       PIC XX VALUE 'O0'.
  6358     05  F                       PIC XX VALUE 'P7'.
  6359     05  F                       PIC XX VALUE 'Q0'.
  6360     05  F                       PIC XX VALUE 'R8'.
  6361     05  F                       PIC XX VALUE 'S9'.
  6362     05  F                       PIC XX VALUE 'T2'.
  6363     05  F                       PIC XX VALUE 'U3'.
  6364     05  F                       PIC XX VALUE 'V4'.
  6365     05  F                       PIC XX VALUE 'W5'.
  6366     05  F                       PIC XX VALUE 'X6'.
  6367     05  F                       PIC XX VALUE 'Y7'.
  6368     05  F                       PIC XX VALUE 'Z8'.
  6369 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
  6370     05  WS-VAL-IN               PIC X.
  6371     05  WS-VAL-OUT              PIC 9.
  6372 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
  6373
  6374 01  WS-COMPARE-BINARY-DATES.
  6375     05  WS-971231                PIC XX VALUE X'92FF'.
  6376     05  WS-931231                PIC XX VALUE X'8CFF'.
  6377     05  WS-791231                PIC XX VALUE X'77FF'.
  6378     05  WS-771001                PIC XX VALUE X'74A1'.
  6379     05  WS-820301                PIC XX VALUE X'7B41'.
  6380     05  WS-831031                PIC XX VALUE X'7DBF'.
  6381     05  WS-831231                PIC XX VALUE X'7DFF'.
  6382     05  WS-810831                PIC XX VALUE X'7A7F'.
  6383     05  WS-830901                PIC XX VALUE X'7D81'.
  6384
  6385 01  FILE-ACCESS-IDS.
  6386     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
  6387     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
  6388     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
  6389     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
  6390     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
  6391     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 116
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6392     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
  6393     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
  6394     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
  6395     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
  6396     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
  6397     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
  6398     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
  6399     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
  6400     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
  6401     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
  6402     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
  6403
  6404 01  DD-IU-SW                    PIC X   VALUE ' '.
  6405     88  DD-IU-PRESENT                 VALUE 'Y'.
  6406
  6407 01  ACCESS-KEYS.
  6408     12  ELMSTR-KEY.
  6409         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
  6410         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
  6411     12  W-CLAIM-KEY.
  6412         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
  6413         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
  6414
  6415     12  ELCNTL-KEY.
  6416         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
  6417         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
  6418         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
  6419         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
  6420
  6421     12  ELCERT-KEY.
  6422         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
  6423         16  CERT-CARRIER         PIC X       VALUE SPACE.
  6424         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
  6425         16  CERT-STATE           PIC XX      VALUE SPACES.
  6426         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
  6427         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
  6428         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
  6429
  6430     12  ELCERT2-KEY.
  6431         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
  6432         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
  6433
  6434     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
  6435
  6436     12  ELCERT-SAVE.
  6437         16  FILLER                      PIC XX    VALUE SPACES.
  6438
  6439         16  WCS-CONTROL-PRIMARY.
  6440             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
  6441             20  WCS-CARRIER             PIC X     VALUE SPACE.
  6442             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
  6443             20  WCS-STATE               PIC XX    VALUE SPACES.
  6444             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
  6445             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
  6446             20  WCS-CERT-NO.
  6447                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
  6448                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
  6449
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 117
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6450         16  CS-CONTROL-BY-NAME.
  6451             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
  6452             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
  6453             20  CS-INSURED-INITIALS.
  6454                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
  6455                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
  6456
  6457         16  CS-CONTROL-BY-SSN.
  6458             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
  6459             20  CS-SOC-SEC-NO.
  6460                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
  6461                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
  6462                 24  CS-SSN-LN3.
  6463                     28 CS-INSURED-INITIALS-A2   PIC XX
  6464                                     VALUE SPACES.
  6465                     28 CS-PART-LAST-NAME-A2     PIC X
  6466                                     VALUE SPACE.
  6467
  6468         16  CS-CONTROL-BY-CERT-NO.
  6469             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
  6470             20  CS-CERT-NO-A4           PIC X(11)
  6471                                     VALUE SPACES.
  6472
  6473         16  CS-CONTROL-BY-MEMB.
  6474             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
  6475             20  CS-MEMBER-NO.
  6476                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
  6477                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
  6478                 24  CS-MEMB-LN4.
  6479                     28 CS-INSURED-INITIALS-A5   PIC XX
  6480                                      VALUE SPACES.
  6481                     28 CS-PART-LAST-NAME-A5     PIC XX
  6482                                      VALUE SPACES.
  6483
  6484         16  FILLER              PIC X(360) VALUE SPACES.
  6485
  6486     12  ERACCT-KEY.
  6487         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
  6488         16  ACCT-CARRIER         PIC X     VALUE SPACES.
  6489         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
  6490         16  ACCT-STATE           PIC X(02) VALUE SPACES.
  6491         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
  6492         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
  6493
  6494     12  ERCOMP-KEY.
  6495         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
  6496         16  COMP-CARRIER         PIC X     VALUE SPACES.
  6497         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
  6498         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
  6499         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
  6500         16  COMP-TYPE            PIC X     VALUE SPACES.
  6501
  6502     12  ERLOFC-KEY.
  6503         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6504         16  LOFC-CARRIER         PIC X     VALUE SPACES.
  6505         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
  6506         16  LOFC-STATE           PIC XX    VALUE SPACES.
  6507         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 118
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6508         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
  6509
  6510     12  WS-ELCRTT-KEY.
  6511         16  WS-ELCRTT-PRIMARY       PIC X(33).
  6512         16  WS-ELCRTT-REC-TYPE      PIC X(1).
  6513
  6514     12  ERBXRF-KEY.
  6515         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
  6516         16  BXRF-CARRIER         PIC X     VALUE SPACES.
  6517         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
  6518         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
  6519
  6520     12  ERAGTC-KEY.
  6521         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6522         16  AGTC-CARRIER         PIC X     VALUE SPACES.
  6523         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
  6524         16  AGTC-BANK            PIC X(10) VALUE SPACES.
  6525         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
  6526         16  AGTC-TYPE            PIC X     VALUE SPACES.
  6527
  6528     12  ERPLAN-KEY.
  6529         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6530         16  PLAN-CARRIER         PIC X     VALUE SPACES.
  6531         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
  6532         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
  6533         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
  6534         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
  6535         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
  6536         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
  6537
  6538     12  ERFORM-KEY.
  6539         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6540         16  FORM-STATE           PIC X(2)  VALUE SPACES.
  6541         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
  6542         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
  6543
  6544     12  ERREIN-KEY.
  6545         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
  6546         16  REIN-TYPE            PIC X     VALUE SPACES.
  6547         16  REIN-TABLE-CO.
  6548             20  REIN-CODE-1      PIC X     VALUE SPACE.
  6549             20  REIN-CODE-2      PIC X     VALUE SPACE.
  6550             20  REIN-CODE-3      PIC X     VALUE SPACE.
  6551         16  FILLER               PIC X(3)  VALUE SPACES.
  6552
  6553     12  ERCTBL-KEY.
  6554         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6555         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
  6556         16  CTBL-CNTRL-2.
  6557             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
  6558             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
  6559
  6560     12  ELCRTO-KEY.
  6561         16  ELCRTO-COMPANY-CD       PIC X.
  6562         16  ELCRTO-CARRIER          PIC X.
  6563         16  ELCRTO-GROUPING         PIC X(6).
  6564         16  ELCRTO-STATE            PIC XX.
  6565         16  ELCRTO-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 119
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6566         16  ELCRTO-CERT-EFF-DT      PIC XX.
  6567         16  ELCRTO-CERT-NO.
  6568             20  ELCRTO-CERT-PRIME   PIC X(10).
  6569             20  ELCRTO-CERT-SFX     PIC X.
  6570         16  ELCRTO-RECORD-TYPE      PIC X.
  6571         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
  6572
  6573
  6574     12  WS-ACCESS.
  6575         16  FILLER               PIC XX    VALUE SPACES.
  6576         16  WS-BEN-CD            PIC XX    VALUE SPACES.
  6577
  6578     12  WS-CARR-ACCESS.
  6579         16  FILLER               PIC X(3)  VALUE SPACES.
  6580         16  WS-CARR              PIC X     VALUE SPACE.
  6581*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
  6582*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
  6583     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
  6584         88  WS-DMD-LF-RATING   VALUE 'Y'.
  6585         88  WS-DMD-AH-RATING   VALUE 'Y'.
  6586         88  WS-DMD-NO-RATING   VALUE 'N'.
  6587
  6588
  6589     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
  6590         88  WS-LF-CASH            VALUE 'MJ' 'MS'
  6591                                         'NJ' 'NL'
  6592                                         'PJ' 'PL'
  6593                                         'SJ' 'SL'.
  6594     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
  6595         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
  6596                                         'NI' 'NJ' 'NL' 'NU'
  6597                                         'PJ' 'PL' 'PI' 'PU'
  6598                                         'SI' 'SJ' 'SL' 'SU'
  6599                                         'MX' 'MY' 'MZ'.
  6600
  6601 01  ERPDEF-KEY-SAVE             PIC X(18).
  6602 01  ERPDEF-KEY.
  6603     12  ERPDEF-COMPANY-CD       PIC X.
  6604     12  ERPDEF-STATE            PIC XX.
  6605     12  ERPDEF-PROD-CD          PIC XXX.
  6606     12  F                       PIC X(7).
  6607     12  ERPDEF-BEN-TYPE         PIC X.
  6608     12  ERPDEF-BEN-CODE         PIC XX.
  6609     12  ERPDEF-EXP-DT           PIC XX.
  6610
  6611 01  ELSTAT-KEY-SAVE             PIC X(20).
  6612 01  ELSTAT-KEY.
  6613     12  ELSTAT-COMPANY-ID       PIC XXX.
  6614     12  ELSTAT-CARRIER          PIC X.
  6615     12  ELSTAT-GROUP            PIC X(6).
  6616     12  ELSTAT-STATE            PIC XX.
  6617     12  ELSTAT-EXP-DT           PIC 9(8).
  6618
  6619 01  WS-ERROR-VALUES.
  6620     12  ER-1570                     PIC S9(4)   VALUE +1570.
  6621     12  ER-1571                     PIC S9(4)   VALUE +1571.
  6622     12  ER-1575                     PIC S9(4)   VALUE +1575.
  6623     12  ER-1891                     PIC S9(4)   VALUE +1891.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 120
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6624     12  ER-1892                     PIC S9(4)   VALUE +1892.
  6625     12  ER-1893                     PIC S9(4)   VALUE +1893.
  6626     12  ER-1894                     PIC S9(4)   VALUE +1894.
  6627     12  ER-1895                     PIC S9(4)   VALUE +1895.
  6628     12  ER-1896                     PIC S9(4)   VALUE +1896.
  6629     12  ER-1897                     PIC S9(4)   VALUE +1897.
  6630     12  ER-1898                     PIC S9(4)   VALUE +1898.
  6631     12  ER-1899                     PIC S9(4)   VALUE +1899.
  6632     12  ER-1900                     PIC S9(4)   VALUE +1900.
  6633     12  ER-1901                     PIC S9(4)   VALUE +1901.
  6634     12  ER-1902                     PIC S9(4)   VALUE +1902.
  6635     12  ER-1903                     PIC S9(4)   VALUE +1903.
  6636     12  ER-1904                     PIC S9(4)   VALUE +1904.
  6637     12  ER-1905                     PIC S9(4)   VALUE +1905.
  6638     12  ER-1906                     PIC S9(4)   VALUE +1906.
  6639     12  ER-1907                     PIC S9(4)   VALUE +1907.
  6640     12  ER-1909                     PIC S9(4)   VALUE +1909.
  6641     12  ER-1910                     PIC S9(4)   VALUE +1910.
  6642     12  ER-1911                     PIC S9(4)   VALUE +1911.
  6643     12  ER-1912                     PIC S9(4)   VALUE +1912.
  6644     12  ER-1913                     PIC S9(4)   VALUE +1913.
  6645     12  ER-1914                     PIC S9(4)   VALUE +1914.
  6646     12  ER-1915                     PIC S9(4)   VALUE +1915.
  6647     12  ER-1916                     PIC S9(4)   VALUE +1916.
  6648     12  ER-1917                     PIC S9(4)   VALUE +1917.
  6649     12  ER-1918                     PIC S9(4)   VALUE +1918.
  6650     12  ER-1919                     PIC S9(4)   VALUE +1919.
  6651     12  ER-1920                     PIC S9(4)   VALUE +1920.
  6652     12  ER-1921                     PIC S9(4)   VALUE +1921.
  6653     12  ER-1922                     PIC S9(4)   VALUE +1922.
  6654     12  ER-1923                     PIC S9(4)   VALUE +1923.
  6655     12  ER-1924                     PIC S9(4)   VALUE +1924.
  6656     12  ER-1925                     PIC S9(4)   VALUE +1925.
  6657     12  ER-1926                     PIC S9(4)   VALUE +1926.
  6658     12  ER-1927                     PIC S9(4)   VALUE +1927.
  6659     12  ER-2393                     PIC S9(4)   VALUE +2393.
  6660     12  ER-2600                     PIC S9(4)   VALUE +2600.
  6661     12  ER-2601                     PIC S9(4)   VALUE +2601.
  6662     12  ER-2602                     PIC S9(4)   VALUE +2602.
  6663     12  ER-2603                     PIC S9(4)   VALUE +2603.
  6664     12  ER-2604                     PIC S9(4)   VALUE +2604.
  6665     12  ER-2605                     PIC S9(4)   VALUE +2605.
  6666     12  ER-2606                     PIC S9(4)   VALUE +2606.
  6667     12  ER-2607                     PIC S9(4)   VALUE +2607.
  6668     12  ER-2608                     PIC S9(4)   VALUE +2608.
  6669     12  ER-2609                     PIC S9(4)   VALUE +2609.
  6670     12  ER-2610                     PIC S9(4)   VALUE +2610.
  6671     12  ER-2611                     PIC S9(4)   VALUE +2611.
  6672     12  ER-2612                     PIC S9(4)   VALUE +2612.
  6673     12  ER-2613                     PIC S9(4)   VALUE +2613.
  6674     12  ER-2614                     PIC S9(4)   VALUE +2614.
  6675     12  ER-2615                     PIC S9(4)   VALUE +2615.
  6676     12  ER-2616                     PIC S9(4)   VALUE +2616.
  6677     12  ER-2617                     PIC S9(4)   VALUE +2617.
  6678     12  ER-2618                     PIC S9(4)   VALUE +2618.
  6679     12  ER-2619                     PIC S9(4)   VALUE +2619.
  6680     12  ER-2620                     PIC S9(4)   VALUE +2620.
  6681     12  ER-2621                     PIC S9(4)   VALUE +2621.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 121
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6682     12  ER-2622                     PIC S9(4)   VALUE +2622.
  6683     12  ER-2623                     PIC S9(4)   VALUE +2623.
  6684     12  ER-2624                     PIC S9(4)   VALUE +2624.
  6685     12  ER-2625                     PIC S9(4)   VALUE +2625.
  6686     12  ER-2626                     PIC S9(4)   VALUE +2626.
  6687     12  ER-2627                     PIC S9(4)   VALUE +2627.
  6688     12  ER-2628                     PIC S9(4)   VALUE +2628.
  6689     12  ER-2629                     PIC S9(4)   VALUE +2629.
  6690     12  ER-2630                     PIC S9(4)   VALUE +2630.
  6691     12  ER-2631                     PIC S9(4)   VALUE +2631.
  6692     12  ER-2632                     PIC S9(4)   VALUE +2632.
  6693     12  ER-2633                     PIC S9(4)   VALUE +2633.
  6694     12  ER-2634                     PIC S9(4)   VALUE +2634.
  6695     12  ER-2635                     PIC S9(4)   VALUE +2635.
  6696     12  ER-2636                     PIC S9(4)   VALUE +2636.
  6697     12  ER-2637                     PIC S9(4)   VALUE +2637.
  6698     12  ER-2638                     PIC S9(4)   VALUE +2638.
  6699     12  ER-2639                     PIC S9(4)   VALUE +2639.
  6700     12  ER-2640                     PIC S9(4)   VALUE +2640.
  6701     12  ER-2641                     PIC S9(4)   VALUE +2641.
  6702     12  ER-2642                     PIC S9(4)   VALUE +2642.
  6703     12  ER-2643                     PIC S9(4)   VALUE +2643.
  6704     12  ER-2644                     PIC S9(4)   VALUE +2644.
  6705     12  ER-2645                     PIC S9(4)   VALUE +2645.
  6706     12  ER-2646                     PIC S9(4)   VALUE +2646.
  6707     12  ER-2647                     PIC S9(4)   VALUE +2647.
  6708     12  ER-2648                     PIC S9(4)   VALUE +2648.
  6709     12  ER-2649                     PIC S9(4)   VALUE +2649.
  6710     12  ER-2650                     PIC S9(4)   VALUE +2650.
  6711     12  ER-2651                     PIC S9(4)   VALUE +2651.
  6712     12  ER-2652                     PIC S9(4)   VALUE +2652.
  6713     12  ER-2653                     PIC S9(4)   VALUE +2653.
  6714     12  ER-2654                     PIC S9(4)   VALUE +2654.
  6715     12  ER-2655                     PIC S9(4)   VALUE +2655.
  6716     12  ER-2656                     PIC S9(4)   VALUE +2656.
  6717     12  ER-2657                     PIC S9(4)   VALUE +2657.
  6718     12  ER-2658                     PIC S9(4)   VALUE +2658.
  6719     12  ER-2659                     PIC S9(4)   VALUE +2659.
  6720     12  ER-2660                     PIC S9(4)   VALUE +2660.
  6721     12  ER-2661                     PIC S9(4)   VALUE +2661.
  6722     12  ER-2662                     PIC S9(4)   VALUE +2662.
  6723     12  ER-2663                     PIC S9(4)   VALUE +2663.
  6724     12  ER-2664                     PIC S9(4)   VALUE +2664.
  6725     12  ER-2665                     PIC S9(4)   VALUE +2665.
  6726     12  ER-2666                     PIC S9(4)   VALUE +2666.
  6727     12  ER-2667                     PIC S9(4)   VALUE +2667.
  6728     12  ER-2668                     PIC S9(4)   VALUE +2668.
  6729     12  ER-2669                     PIC S9(4)   VALUE +2669.
  6730     12  ER-2670                     PIC S9(4)   VALUE +2670.
  6731     12  ER-2671                     PIC S9(4)   VALUE +2671.
  6732     12  ER-2672                     PIC S9(4)   VALUE +2672.
  6733     12  ER-2673                     PIC S9(4)   VALUE +2673.
  6734     12  ER-2674                     PIC S9(4)   VALUE +2674.
  6735     12  ER-2675                     PIC S9(4)   VALUE +2675.
  6736     12  ER-2676                     PIC S9(4)   VALUE +2676.
  6737     12  ER-2677                     PIC S9(4)   VALUE +2677.
  6738     12  ER-2678                     PIC S9(4)   VALUE +2678.
  6739     12  ER-2679                     PIC S9(4)   VALUE +2679.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 122
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6740     12  ER-2680                     PIC S9(4)   VALUE +2680.
  6741     12  ER-2681                     PIC S9(4)   VALUE +2681.
  6742     12  ER-2682                     PIC S9(4)   VALUE +2682.
  6743     12  ER-2683                     PIC S9(4)   VALUE +2683.
  6744     12  ER-2684                     PIC S9(4)   VALUE +2684.
  6745     12  ER-2685                     PIC S9(4)   VALUE +2685.
  6746     12  ER-2686                     PIC S9(4)   VALUE +2686.
  6747     12  ER-2687                     PIC S9(4)   VALUE +2687.
  6748     12  ER-2688                     PIC S9(4)   VALUE +2688.
  6749     12  ER-2689                     PIC S9(4)   VALUE +2689.
  6750     12  ER-2690                     PIC S9(4)   VALUE +2690.
  6751     12  ER-2691                     PIC S9(4)   VALUE +2691.
  6752     12  ER-2692                     PIC S9(4)   VALUE +2692.
  6753     12  ER-2693                     PIC S9(4)   VALUE +2693.
  6754     12  ER-2694                     PIC S9(4)   VALUE +2694.
  6755     12  ER-2695                     PIC S9(4)   VALUE +2695.
  6756     12  ER-2696                     PIC S9(4)   VALUE +2696.
  6757     12  ER-2697                     PIC S9(4)   VALUE +2697.
  6758     12  ER-2698                     PIC S9(4)   VALUE +2698.
  6759     12  ER-2699                     PIC S9(4)   VALUE +2699.
  6760     12  ER-2700                     PIC S9(4)   VALUE +2700.
  6761     12  ER-2701                     PIC S9(4)   VALUE +2701.
  6762     12  ER-2702                     PIC S9(4)   VALUE +2702.
  6763     12  ER-2703                     PIC S9(4)   VALUE +2703.
  6764     12  ER-2704                     PIC S9(4)   VALUE +2704.
  6765     12  ER-2707                     PIC S9(4)   VALUE +2707.
  6766     12  ER-2720                     PIC S9(4)   VALUE +2720.
  6767     12  ER-2709                     PIC S9(4)   VALUE +2709.
  6768     12  ER-2717                     PIC S9(4)   VALUE +2717.
  6769     12  ER-2718                     PIC S9(4)   VALUE +2718.
  6770     12  ER-2719                     PIC S9(4)   VALUE +2719.
  6771     12  ER-2721                     PIC S9(4)   VALUE +2721.
  6772     12  ER-2722                     PIC S9(4)   VALUE +2722.
  6773     12  ER-2723                     PIC S9(4)   VALUE +2723.
  6774     12  ER-2724                     PIC S9(4)   VALUE +2724.
  6775     12  ER-2725                     PIC S9(4)   VALUE +2725.
  6776     12  ER-2726                     PIC S9(4)   VALUE +2726.
  6777     12  ER-2727                     PIC S9(4)   VALUE +2727.
  6778     12  ER-2728                     PIC S9(4)   VALUE +2728.
  6779     12  ER-2729                     PIC S9(4)   VALUE +2729.
  6780     12  ER-2730                     PIC S9(4)   VALUE +2730.
  6781     12  ER-2731                     PIC S9(4)   VALUE +2731.
  6782     12  ER-2732                     PIC S9(4)   VALUE +2732.
  6783     12  ER-2733                     PIC S9(4)   VALUE +2733.
  6784     12  ER-2734                     PIC S9(4)   VALUE +2734.
  6785     12  ER-2735                     PIC S9(4)   VALUE +2735.
  6786     12  ER-2736                     PIC S9(4)   VALUE +2736.
  6787     12  ER-2737                     PIC S9(4)   VALUE +2737.
  6788     12  ER-2738                     PIC S9(4)   VALUE +2738.
  6789     12  ER-2739                     PIC S9(4)   VALUE +2739.
  6790     12  ER-2740                     PIC S9(4)   VALUE +2740.
  6791     12  ER-2741                     PIC S9(4)   VALUE +2741.
  6792     12  ER-2742                     PIC S9(4)   VALUE +2742.
  6793     12  ER-2743                     PIC S9(4)   VALUE +2743.
  6794     12  ER-2744                     PIC S9(4)   VALUE +2744.
  6795     12  ER-2745                     PIC S9(4)   VALUE +2745.
  6796     12  ER-2746                     PIC S9(4)   VALUE +2746.
  6797     12  ER-2747                     PIC S9(4)   VALUE +2747.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 123
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6798     12  ER-2748                     PIC S9(4)   VALUE +2748.
  6799     12  ER-2749                     PIC S9(4)   VALUE +2749.
  6800     12  ER-2750                     PIC S9(4)   VALUE +2750.
  6801     12  ER-2751                     PIC S9(4)   VALUE +2751.
  6802     12  ER-2752                     PIC S9(4)   VALUE +2752.
  6803     12  ER-2753                     PIC S9(4)   VALUE +2753.
  6804     12  ER-2754                     PIC S9(4)   VALUE +2754.
  6805     12  ER-2755                     PIC S9(4)   VALUE +2755.
  6806     12  ER-2756                     PIC S9(4)   VALUE +2756.
  6807     12  ER-2757                     PIC S9(4)   VALUE +2757.
  6808     12  ER-2758                     PIC S9(4)   VALUE +2758.
  6809     12  ER-2759                     PIC S9(4)   VALUE +2759.
  6810     12  ER-2760                     PIC S9(4)   VALUE +2760.
  6811     12  ER-2761                     PIC S9(4)   VALUE +2761.
  6812     12  ER-2762                     PIC S9(4)   VALUE +2762.
  6813     12  ER-2763                     PIC S9(4)   VALUE +2763.
  6814     12  ER-2764                     PIC S9(4)   VALUE +2764.
  6815     12  ER-2765                     PIC S9(4)   VALUE +2765.
  6816     12  ER-2766                     PIC S9(4)   VALUE +2766.
  6817     12  ER-2767                     PIC S9(4)   VALUE +2767.
  6818     12  ER-2768                     PIC S9(4)   VALUE +2768.
  6819     12  ER-2769                     PIC S9(4)   VALUE +2769.
  6820     12  ER-2770                     PIC S9(4)   VALUE +2770.
  6821     12  ER-2771                     PIC S9(4)   VALUE +2771.
  6822     12  ER-2772                     PIC S9(4)   VALUE +2772.
  6823     12  ER-2773                     PIC S9(4)   VALUE +2773.
  6824     12  ER-2774                     PIC S9(4)   VALUE +2774.
  6825     12  ER-2775                     PIC S9(4)   VALUE +2775.
  6826     12  ER-2776                     PIC S9(4)   VALUE +2776.
  6827     12  ER-2777                     PIC S9(4)   VALUE +2777.
  6828     12  ER-2778                     PIC S9(4)   VALUE +2778.
  6829     12  ER-2779                     PIC S9(4)   VALUE +2779.
  6830     12  ER-2780                     PIC S9(4)   VALUE +2780.
  6831     12  ER-2781                     PIC S9(4)   VALUE +2781.
  6832     12  ER-2782                     PIC S9(4)   VALUE +2782.
  6833     12  ER-2783                     PIC S9(4)   VALUE +2783.
  6834     12  ER-2786                     PIC S9(4)   VALUE +2786.
  6835     12  ER-2787                     PIC S9(4)   VALUE +2787.
  6836     12  ER-2788                     PIC S9(4)   VALUE +2788.
  6837     12  ER-2789                     PIC S9(4)   VALUE +2789.
  6838     12  ER-2792                     PIC S9(4)   VALUE +2792.
  6839     12  ER-2793                     PIC S9(4)   VALUE +2793.
  6840     12  ER-2794                     PIC S9(4)   VALUE +2794.
  6841     12  ER-2795                     PIC S9(4)   VALUE +2795.
  6842     12  ER-2796                     PIC S9(4)   VALUE +2796.
  6843     12  ER-2798                     PIC S9(4)   VALUE +2798.
  6844     12  ER-2799                     PIC S9(4)   VALUE +2799.
  6845     12  ER-2869                     PIC S9(4)   VALUE +2869.
  6846     12  ER-2879                     PIC S9(4)   VALUE +2879.
  6847     12  ER-2881                     PIC S9(4)   VALUE +2881.
  6848     12  ER-2883                     PIC S9(4)   VALUE +2883.
  6849     12  ER-2882                     PIC S9(4)   VALUE +2882.
  6850     12  ER-2884                     PIC S9(4)   VALUE +2884.
  6851     12  ER-2885                     PIC S9(4)   VALUE +2885.
  6852     12  ER-2886                     PIC S9(4)   VALUE +2886.
  6853     12  ER-2887                     PIC S9(4)   VALUE +2887.
  6854     12  ER-2888                     PIC S9(4)   VALUE +2888.
  6855     12  ER-2889                     PIC S9(4)   VALUE +2889.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 124
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6856     12  ER-2890                     PIC S9(4)   VALUE +2890.
  6857     12  ER-2891                     PIC S9(4)   VALUE +2891.
  6858     12  ER-2892                     PIC S9(4)   VALUE +2892.
  6859     12  ER-2963                     PIC S9(4)   VALUE +2963.
  6860     12  ER-2964                     PIC S9(4)   VALUE +2964.
  6861     12  ER-2965                     PIC S9(4)   VALUE +2965.
  6862     12  ER-2969                     PIC S9(4)   VALUE +2969.
  6863     12  ER-3006                     PIC S9(4)   VALUE +3006.
  6864     12  ER-3049                     PIC S9(4)   VALUE +3049.
  6865     12  ER-3050                     PIC S9(4)   VALUE +3050.
  6866     12  ER-3052                     PIC S9(4)   VALUE +3052.
  6867     12  ER-3054                     PIC S9(4)   VALUE +3054.
  6868     12  ER-3057                     PIC S9(4)   VALUE +3057.
  6869     12  ER-3058                     PIC S9(4)   VALUE +3058.
  6870     12  ER-3780                     PIC S9(4)   VALUE +3780.
  6871     12  ER-3781                     PIC S9(4)   VALUE +3781.
  6872     12  ER-3782                     PIC S9(4)   VALUE +3782.
  6873     12  ER-3789                     PIC S9(4)   VALUE +3789.
  6874     12  ER-3790                     PIC S9(4)   VALUE +3790.
  6875     12  ER-3825                     PIC S9(4)   VALUE +3825.
  6876     12  ER-3826                     PIC S9(4)   VALUE +3826.
  6877     12  ER-3843                     PIC S9(4)   VALUE +3843.
  6878     12  ER-7812                     PIC S9(4)   VALUE +7812.
  6879     12  ER-7813                     PIC S9(4)   VALUE +7813.
  6880     12  ER-7814                     PIC S9(4)   VALUE +7814.
  6881     12  ER-7815                     PIC S9(4)   VALUE +7815.
  6882     12  ER-7816                     PIC S9(4)   VALUE +7816.
  6883     12  ER-7817                     PIC S9(4)   VALUE +7817.
  6884     12  ER-7818                     PIC S9(4)   VALUE +7818.
  6885     12  ER-7819                     PIC S9(4)   VALUE +7819.
  6886     12  ER-7820                     PIC S9(4)   VALUE +7820.
  6887     12  ER-7823                     PIC S9(4)   VALUE +7823.
  6888     12  ER-7825                     PIC S9(4)   VALUE +7825.
  6889     12  ER-8002                     PIC S9(4)   VALUE +8002.
  6890     12  ER-8030                     PIC S9(4)   VALUE +8030.
  6891     12  ER-8036                     PIC S9(4)   VALUE +8036.
  6892     12  ER-8037                     PIC S9(4)   VALUE +8037.
  6893     12  ER-8038                     PIC S9(4)   VALUE +8038.
  6894     12  ER-8039                     PIC S9(4)   VALUE +8039.
  6895     12  ER-8040                     PIC S9(4)   VALUE +8040.
  6896     12  ER-8041                     PIC S9(4)   VALUE +8041.
  6897     12  ER-8042                     PIC S9(4)   VALUE +8042.
  6898     12  ER-8043                     PIC S9(4)   VALUE +8043.
  6899     12  ER-8044                     PIC S9(4)   VALUE +8044.
  6900     12  ER-8045                     PIC S9(4)   VALUE +8045.
  6901     12  ER-8046                     PIC S9(4)   VALUE +8046.
  6902     12  ER-8050                     PIC S9(4)   VALUE +8050.
  6903     12  ER-8067                     PIC S9(4)   VALUE +8067.
  6904     12  ER-8068                     PIC S9(4)   VALUE +8068.
  6905     12  ER-8069                     PIC S9(4)   VALUE +8069.
  6906     12  ER-8070                     PIC S9(4)   VALUE +8070.
  6907     12  ER-8071                     PIC S9(4)   VALUE +8071.
  6908     12  ER-8072                     PIC S9(4)   VALUE +8072.
  6909     12  ER-8074                     PIC S9(4)   VALUE +8074.
  6910     12  ER-8075                     PIC S9(4)   VALUE +8075.
  6911     12  ER-8076                     PIC S9(4)   VALUE +8076.
  6912     12  ER-8077                     PIC S9(4)   VALUE +8077.
  6913     12  ER-8078                     PIC S9(4)   VALUE +8078.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 125
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6914     12  ER-8079                     PIC S9(4)   VALUE +8079.
  6915     12  ER-8080                     PIC S9(4)   VALUE +8080.
  6916     12  ER-8081                     PIC S9(4)   VALUE +8081.
  6917     12  ER-8082                     PIC S9(4)   VALUE +8082.
  6918     12  ER-8083                     PIC S9(4)   VALUE +8083.
  6919     12  ER-8084                     PIC S9(4)   VALUE +8084.
  6920     12  ER-8085                     PIC S9(4)   VALUE +8085.
  6921     12  ER-8086                     PIC S9(4)   VALUE +8086.
  6922     12  ER-8087                     PIC S9(4)   VALUE +8087.
  6923     12  ER-8088                     PIC S9(4)   VALUE +8088.
  6924     12  ER-8089                     PIC S9(4)   VALUE +8089.
  6925     12  ER-8090                     PIC S9(4)   VALUE +8090.
  6926     12  ER-8091                     PIC S9(4)   VALUE +8091.
  6927     12  ER-8092                     PIC S9(4)   VALUE +8092.
  6928     12  ER-8093                     PIC S9(4)   VALUE +8093.
  6929     12  ER-8094                     PIC S9(4)   VALUE +8094.
  6930     12  ER-8095                     PIC S9(4)   VALUE +8095.
  6931     12  ER-8096                     PIC S9(4)   VALUE +8096.
  6932     12  ER-8097                     PIC S9(4)   VALUE +8097.
  6933     12  ER-8098                     PIC S9(4)   VALUE +8098.
  6934     12  ER-8099                     PIC S9(4)   VALUE +8099.
  6935     12  ER-8109                     PIC S9(4)   VALUE +8109.
  6936     12  ER-8110                     PIC S9(4)   VALUE +8110.
  6937     12  ER-8111                     PIC S9(4)   VALUE +8111.
  6938     12  ER-8112                     PIC S9(4)   VALUE +8112.
  6939     12  ER-8113                     PIC S9(4)   VALUE +8113.
  6940     12  ER-8114                     PIC S9(4)   VALUE +8114.
  6941     12  ER-8116                     PIC S9(4)   VALUE +8116.
  6942     12  ER-8148                     PIC S9(4)   VALUE +8148.
  6943     12  ER-8152                     PIC S9(4)   VALUE +8152.
  6944     12  ER-8300                     PIC S9(4)   VALUE +8300.
  6945     12  ER-8301                     PIC S9(4)   VALUE +8301.
  6946     12  ER-8302                     PIC S9(4)   VALUE +8302.
  6947     12  ER-8303                     PIC S9(4)   VALUE +8303.
  6948     12  ER-8304                     PIC S9(4)   VALUE +8304.
  6949     12  ER-8310                     PIC S9(4)   VALUE +8310.
  6950     12  ER-8311                     PIC S9(4)   VALUE +8311.
  6951     12  ER-8312                     PIC S9(4)   VALUE +8312.
  6952     12  ER-8313                     PIC S9(4)   VALUE +8313.
  6953     12  ER-8314                     PIC S9(4)   VALUE +8314.
  6954     12  ER-8315                     PIC S9(4)   VALUE +8315.
  6955     12  ER-8316                     PIC S9(4)   VALUE +8316.
  6956     12  ER-8317                     PIC S9(4)   VALUE +8317.
  6957     12  ER-9236                     PIC S9(4)   VALUE +9236.
  6958     12  ER-9501                     PIC S9(4)   VALUE +9501.
  6959     12  ER-9503                     PIC S9(4)   VALUE +9503.
  6960     12  ER-9263                     PIC S9(4)   VALUE +9263.
  6961     12  ER-9999                     PIC S9(4)   VALUE +9999.
  6962******************************************************************
  6963***************   END OF ELC50WS     ****************************
  6964******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 126
* EL517.cbl
  6966 01  HOLD-WORK     PIC X(2000)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 127
* EL517.cbl
  6968*DLB001
  6969 01  WS-DLB-MASTER-POLICY-FORM.
  6970     12  DMPF-PROCESS-TYPE         PIC X.
  6971         88  DMPF-OPEN-FILES                   VALUE 'O'.
  6972         88  DMPF-REG-PROCESS                  VALUE 'P'.
  6973         88  DMPF-CLOSE-FILES                  VALUE 'C'.
  6974     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  6975     12  DMPF-RETURN-CODE          PIC XX.
  6976         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  6977         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  6978         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  6979         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  6980         88  DMPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  6981         88  DMPF-OPEN-ERROR                   VALUE 'Z2'.
  6982         88  DMPF-CLOSE-ERROR                  VALUE 'Z3'.
  6983
  6984*DLB002
  6985 01  WS-DLB-INTERNAL-POLICY-FORM.
  6986     12  DIPF-PROCESS-TYPE         PIC X.
  6987         88  DIPF-OPEN-FILES                   VALUE 'O'.
  6988         88  DIPF-REG-PROCESS                  VALUE 'P'.
  6989         88  DIPF-CLOSE-FILES                  VALUE 'C'.
  6990     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  6991     12  DIPF-RETURN-CODE          PIC XX.
  6992         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  6993         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  6994         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  6995         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  6996         88  DIPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  6997         88  DIPF-OPEN-ERROR                   VALUE 'Z2'.
  6998         88  DIPF-CLOSE-ERROR                  VALUE 'Z3'.
  6999
  7000*DLB003
  7001 01  WS-DLB-VALID-BANK-ID.
  7002     12  DVBI-PROCESS-TYPE         PIC X.
  7003         88  DVBI-OPEN-FILES                   VALUE 'O'.
  7004         88  DVBI-REG-PROCESS                  VALUE 'P'.
  7005         88  DVBI-CLOSE-FILES                  VALUE 'C'.
  7006     12  DVBI-BANK-ID              PIC X(5).
  7007     12  DVBI-BANK-ID-TYPE         PIC X.
  7008         88  DVBI-BILLING-BANK                 VALUE 'B'.
  7009         88  DVBI-PLAN-BANK                    VALUE 'P'.
  7010         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  7011         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  7012         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  7013     12  DVBI-RETURN-CODE          PIC XX.
  7014         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  7015         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  7016         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  7017         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  7018         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  7019         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  7020         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  7021         88  DVBI-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7022         88  DVBI-OPEN-ERROR                   VALUE 'Z2'.
  7023         88  DVBI-CLOSE-ERROR                  VALUE 'Z3'.
  7024
  7025*DLB007
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 128
* EL517.cbl
  7026 01  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  7027     12  DCUA-PROCESS-TYPE         PIC X.
  7028         88  DCUA-OPEN-FILES                   VALUE 'O'.
  7029         88  DCUA-REG-PROCESS                  VALUE 'P'.
  7030         88  DCUA-CLOSE-FILES                  VALUE 'C'.
  7031     12  DCUA-RES-STATE            PIC XX.
  7032     12  DCUA-BEN-TYPE             PIC XX.
  7033     12  DCUA-SYS-IDENT            PIC X.
  7034         88  DCUA-CLAIM                        VALUE 'C'.
  7035         88  DCUA-PREMIUM                      VALUE 'P'.
  7036     12  DCUA-COVERAGE-RULE        PIC X.
  7037     12  DCUA-CLIENT-ID            PIC X(10).
  7038     12  DCUA-EFF-DATE             PIC X(8).
  7039     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  7040     12  DCUA-RETURN-CODE          PIC XX.
  7041         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7042         88  DCUA-OPEN-ERROR                   VALUE 'Z2'.
  7043         88  DCUA-CLOSE-ERROR                  VALUE 'Z3'.
  7044     12  DCUA-CERT-NUMBER          PIC X(11).
  7045     12  DCUA-UNDRWRTR-CODE        PIC XX.
  7046     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  7047
  7048*DLB011
  7049 01  WS-DLB-PREM-RATES-BEN-TYPE.
  7050     12  DPRB-PROCESS-TYPE         PIC X.
  7051         88  DPRB-OPEN-FILES                   VALUE 'O'.
  7052         88  DPRB-REG-PROCESS                  VALUE 'P'.
  7053         88  DPRB-CLOSE-FILES                  VALUE 'C'.
  7054     12  DPRB-RATE-CODE            PIC X(4).
  7055     12  DPRB-COVERAGE-CATEG       PIC X.
  7056     12  DPRB-RETURN-CODE          PIC XX.
  7057         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7058         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  7059         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  7060         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  7061         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  7062         88  DPRB-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7063         88  DPRB-OPEN-ERROR                   VALUE 'Z2'.
  7064         88  DPRB-CLOSE-ERROR                  VALUE 'Z3'.
  7065     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  7066     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  7067     12  DPRB-BEN-TYPE             PIC XX.
  7068
  7069*DLB017
  7070 01  WS-DLB-VALID-RATE-CODE.
  7071     12  DVRC-PROCESS-TYPE         PIC X.
  7072         88  DVRC-OPEN-FILES                   VALUE 'O'.
  7073         88  DVRC-REG-PROCESS                  VALUE 'P'.
  7074         88  DVRC-CLOSE-FILES                  VALUE 'C'.
  7075     12  DVRC-RATE-CODE            PIC X(4).
  7076     12  DVRC-RETURN-CODE          PIC XX.
  7077         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7078         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  7079         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  7080         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  7081         88  DVRC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7082         88  DVRC-OPEN-ERROR                   VALUE 'Z2'.
  7083         88  DVRC-CLOSE-ERROR                  VALUE 'Z3'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 129
* EL517.cbl
  7084
  7085*DLB019
  7086 01  WS-DLB-ORIG-COV-CAT.
  7087     12  DOCC-PROCESS-TYPE         PIC X.
  7088         88  DOCC-OPEN-FILES                   VALUE 'O'.
  7089         88  DOCC-REG-PROCESS                  VALUE 'P'.
  7090         88  DOCC-CLOSE-FILES                  VALUE 'C'.
  7091     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  7092     12  DOCC-RETURN-CODE          PIC XX.
  7093     12  DOCC-ORIG-COV-CAT         PIC X.
  7094     12  DOCC-UNDERWRITER          PIC XX.
  7095     12  DOCC-UNDW-GROUP-CODE      PIC X.
  7096     12  DOCC-CREDIT-IND           PIC X.
  7097     12  DOCC-PRODUCT-CD           PIC XX.
  7098     12  DOCC-TERM                 PIC XXX.
  7099
  7100*DLB021
  7101 01  WS-DLB-VALID-LOAN-OFFICER.
  7102     12  DVLO-LOAN-OFFICER         PIC X(3).
  7103     12  THIS REDEFINES DVLO-LOAN-OFFICER.
  7104         16  DVLO-BILL-TYPE        PIC X.
  7105         16  DVLO-BILL-SOURCE      PIC X.
  7106         16  DVLO-BATCH-TYPE       PIC X.
  7107     12  DVLO-RETURN-CODE          PIC XX.
  7108         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  7109         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  7110         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  7111         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  7112         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  7113         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  7114
  7115*DLB022
  7116 01  WS-DLB-VALID-STATE-CODE.
  7117     12  DVSC-PROCESS-TYPE         PIC X.
  7118         88  DVSC-OPEN-FILES                   VALUE 'O'.
  7119         88  DVSC-REG-PROCESS                  VALUE 'P'.
  7120         88  DVSC-CLOSE-FILES                  VALUE 'C'.
  7121     12  DVSC-STATE-CODE           PIC XX.
  7122     12  DVSC-RETURN-CODE          PIC XX.
  7123         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7124         88  DVSC-NO-STATE-INPUT               VALUE '01'.
  7125         88  DVSC-STATE-NOT-FOUND              VALUE '02'.
  7126         88  DVSC-STATE-INACTIVE               VALUE '03'.
  7127         88  DVSC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7128         88  DVSC-OPEN-ERROR                   VALUE 'Z2'.
  7129         88  DVSC-CLOSE-ERROR                  VALUE 'Z3'.
  7130
  7131*DLB023
  7132 01  WS-DLB-VALID-CODE-VALUES.
  7133     12  DVCV-PROCESS-TYPE         PIC X.
  7134         88  DVCV-OPEN-FILES                   VALUE 'O'.
  7135         88  DVCV-REG-PROCESS                  VALUE 'P'.
  7136         88  DVCV-CLOSE-FILES                  VALUE 'C'.
  7137     12  DVCV-SYSTEM-ID            PIC XX.
  7138         88  DVCV-CLAIMS                       VALUE 'CL'.
  7139         88  DVCV-CREDIT                       VALUE 'CR'.
  7140     12  DVCV-RECORD-TYPE          PIC XX.
  7141         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 130
* EL517.cbl
  7142         88  DVCV-EOB-CODE                     VALUE 'EO'.
  7143         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  7144         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  7145         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  7146         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  7147         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  7148         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  7149     12  DVCV-RECORD-KEY           PIC X(6).
  7150     12  DVCV-RETURN-CODE          PIC XX.
  7151         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  7152         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  7153         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  7154         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  7155         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  7156         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  7157         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  7158         88  DVCV-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7159         88  DVCV-OPEN-ERROR                   VALUE 'Z2'.
  7160         88  DVCV-CLOSE-ERROR                  VALUE 'Z3'.
  7161     12  DVCV-CODE-DESC            PIC X(60).
  7162     12  DVCV-GEN-DESC-1           PIC X(20).
  7163     12  DVCV-GEN-DESC-2           PIC X(20).
  7164     12  DVCV-GEN-DESC-3           PIC X(20).
  7165
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 131
* EL517.cbl
  7167
  7168 01  PARMLIST.
  7169     02  ELCNTL-POINTER            PIC S9(4)  COMP VALUE +0.
  7170     02  ERACCT-POINTER            PIC S9(4)  COMP VALUE +0.
  7171     02  ERCTBL-POINTER            PIC S9(4)  COMP VALUE +0.
  7172**9/17/98: COMMENT OUT ERPLAN-POINTER.  NO LONGER USED BY LOGIC.
  7173**
  7174**   02  ERPLAN-POINTER            PIC S9(4)  COMP VALUE +0.
  7175     02  ERFORM-POINTER            PIC S9(4)  COMP VALUE +0.
  7176
  7177 01  PLAN-RECORDS.
  7178     12  LINK-LIFE-PLAN-RECORD    PIC X(420) VALUE SPACES.
  7179     12  LINK-AH-PLAN-RECORD      PIC X(420) VALUE SPACES.
  7180
* 7181                                  COPY ELCDATE.
  7182******************************************************************06/11/98
  7183*                                                                *ELCDATE
  7184*                                                                *ELCDATE
  7185*                            ELCDATE.                            *   LV023
  7186*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  7187*                            VMOD=2.003                           ELCDATE
  7188*                                                                *ELCDATE
  7189*                                                                *ELCDATE
  7190*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  7191*                 LENGTH = 200                                   *   CL*19
  7192******************************************************************ELCDATE
  7193                                                                  ELCDATE
  7194 01  DATE-CONVERSION-DATA.                                        ELCDATE
  7195     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  7196     12  DC-OPTION-CODE                PIC X.                        CL*15
  7197         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  7198         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  7199         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  7200         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  7201         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  7202         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  7203         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  7204         88  FIND-CENTURY               VALUE '7'.                   CL*22
  7205         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  7206         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  7207         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  7208         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  7209         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  7210         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  7211         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  7212         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  7213         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  7214         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  7215         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  7216         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  7217         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  7218         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  7219         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  7220         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  7221         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  7222         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  7223         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  7224         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 132
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7225         88  THREE-CHARACTER-BIN                                  ELCDATE
  7226                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  7227         88  GREGORIAN-TO-BIN                                        CL**2
  7228                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  7229         88  BIN-TO-GREGORIAN                                        CL**2
  7230                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  7231         88  JULIAN-TO-BINARY                                        CL**2
  7232                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  7233     12  DC-ERROR-CODE                 PIC X.                        CL*15
  7234         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  7235         88  DATE-CONVERSION-ERROR                                ELCDATE
  7236                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  7237         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  7238         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  7239         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  7240         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  7241         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  7242         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  7243         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  7244         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  7245         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  7246         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  7247     12  DC-END-OF-MONTH               PIC X.                        CL*15
  7248         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  7249     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  7250         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  7251         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  7252         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  7253     12  FILLER                        PIC X.                        CL*15
  7254     12  DC-CONVERSION-DATES.                                        CL*15
  7255         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  7256         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  7257         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  7258         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  7259                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  7260             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  7261             20  SLASH1-1              PIC X.                        CL*15
  7262             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  7263             20  SLASH1-2              PIC X.                        CL*15
  7264             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  7265         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  7266         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  7267                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  7268             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  7269             20  SLASH2-1              PIC X.                        CL*15
  7270             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  7271             20  SLASH2-2              PIC X.                        CL*15
  7272             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  7273         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  7274         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  7275                     DC-GREG-DATE-1-YMD.                          ELCDATE
  7276             20  DC-YMD-YEAR           PIC 99.                       CL*15
  7277             20  DC-YMD-MONTH          PIC 99.                       CL*15
  7278             20  DC-YMD-DAY            PIC 99.                       CL*15
  7279         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  7280         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  7281                      DC-GREG-DATE-1-MDY.                         ELCDATE
  7282             20  DC-MDY-MONTH          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 133
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7283             20  DC-MDY-DAY            PIC 99.                       CL*15
  7284             20  DC-MDY-YEAR           PIC 99.                       CL*15
  7285         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  7286             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  7287             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  7288             20  FILLER                PIC XX.                       CL*15
  7289             20  DC-ALPHA-CENTURY.                                   CL*15
  7290                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  7291             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  7292         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  7293         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  7294         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  7295         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  7296         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  7297                                       PIC 9(05).                    CL*20
  7298         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  7299             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  7300             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  7301         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  7302         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  7303         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  7304     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  7305         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  7306         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  7307             20  FILLER                PIC 9(3).                     CL*15
  7308             20  HOLD-CEN-1-CCYY.                                    CL*15
  7309                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  7310                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  7311             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  7312             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  7313         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  7314             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  7315             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  7316             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  7317                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  7318                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  7319             20  FILLER                PIC 9(3).                     CL*15
  7320         16  HOLD-CENTURY-1-X.                                       CL*15
  7321             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  7322             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  7323                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  7324                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  7325             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  7326             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  7327         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  7328             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  7329             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  7330             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  7331                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  7332                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  7333             20  FILLER                PIC XXX.                      CL*23
  7334         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  7335         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  7336         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  7337         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  7338             20  DC-JULIAN-1-CCYY.                                   CL*15
  7339                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  7340                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 134
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7341             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  7342         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  7343         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  7344             20  DC-JULIAN-2-CCYY.                                   CL*15
  7345                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  7346                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  7347             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  7348         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  7349             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  7350             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  7351             20  DC-EDITA-DAY          PIC 99.                       CL*15
  7352             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  7353             20  DC-EDITA-CCYY.                                      CL*15
  7354                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  7355                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  7356         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  7357             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  7358             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  7359             20  DC-EDITB-DAY          PIC 99.                       CL*15
  7360             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  7361             20  DC-EDITB-CCYY.                                      CL*15
  7362                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  7363                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  7364         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  7365         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  7366                              DC-GREG-DATE-CYMD.                  ELCDATE
  7367             20  DC-CYMD-CEN           PIC 99.                       CL*15
  7368             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  7369             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  7370             20  DC-CYMD-DAY           PIC 99.                       CL*15
  7371         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  7372         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  7373                              DC-GREG-DATE-MDCY.                  ELCDATE
  7374             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  7375             20  DC-MDCY-DAY           PIC 99.                       CL*15
  7376             20  DC-MDCY-CEN           PIC 99.                       CL*15
  7377             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  7378    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  7379        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  7380    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  7381    12  FILLER                         PIC X(28).                    CL*26
  7382
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 135
* EL517.cbl
* 7384                                  COPY ELCCALC.
  7385******************************************************************04/15/98
  7386*                                                                *ELCCALC
  7387*                           ELCCALC.                            *    LV003
  7388*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7389*                            VMOD=2.025                          *   CL**3
  7390*                                                                *   CL**2
  7391*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  7392*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  7393*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  7394*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  7395*                                                                *   CL**2
  7396*  PASSED TO ELRTRM                                              *   CL**2
  7397*  -----------------                                             *   CL**2
  7398*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  7399*  ORIGINAL TERM                                                 *   CL**2
  7400*  BEGINNING DATE                                                *   CL**2
  7401*  ENDING DATE                                                   *   CL**2
  7402*  COMPANY I.D.                                                  *   CL**2
  7403*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  7404*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  7405*  FREE LOOK DAYS                                                *   CL**2
  7406*                                                                *   CL**2
  7407*  RETURNED FROM ELRTRM                                          *   CL**2
  7408*  ---------------------                                         *   CL**2
  7409*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  7410*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  7411*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  7412*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  7413*----------------------------------------------------------------*   CL**2
  7414*  PASSED TO ELRAMT                                              *   CL**2
  7415*  ----------------                                              *   CL**2
  7416*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  7417*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7418*  ORIGINAL AMOUNT                                               *   CL**2
  7419*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  7420*  A.P.R. - NET PAY ONLY                                         *   CL**2
  7421*  METHOD                                                            CL**2
  7422*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  7423*  COMPANY I.D.                                                  *   CL**2
  7424*  BENEFIT TYPE                                                  *   CL**2
  7425*                                                                *   CL**2
  7426*  RETURNED FROM ELRAMT                                          *   CL**2
  7427*  --------------------                                          *   CL**2
  7428*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  7429*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  7430*  REMAINING AMOUNT FACTOR                                           CL**2
  7431*----------------------------------------------------------------*   CL**2
  7432*  PASSED TO ELRESV                                              *   CL**2
  7433*  -----------------                                             *   CL**2
  7434*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  7435*  VALUATION DATE                                                *   CL**2
  7436*  PAID THRU DATE                                                *   CL**2
  7437*  BENEFIT                                                       *   CL**2
  7438*  INCURRED DATE                                                 *   CL**2
  7439*  REPORTED DATE                                                 *   CL**2
  7440*  ISSUE AGE                                                     *   CL**2
  7441*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 136
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7442*  CDT PERCENT                                                   *   CL**2
  7443*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  7444* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  7445* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  7446* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  7447*                                                                *   CL**2
  7448*  RETURNED FROM ELRESV                                          *   CL**2
  7449*  --------------------                                          *   CL**2
  7450*  CDT TABLE USED                                                *   CL**2
  7451*  CDT FACTOR USED                                               *   CL**2
  7452*  PAY TO CURRENT RESERVE                                        *   CL**2
  7453*  I.B.N.R. - A/H ONLY                                           *   CL**2
  7454*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  7455*----------------------------------------------------------------*   CL**2
  7456*  PASSED TO ELRATE                                              *   CL**2
  7457*  ----------------                                              *   CL**2
  7458*  CERT ISSUE DATE                                               *   CL**2
  7459*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7460*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7461*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  7462*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7463*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7464*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7465*  DEVIATION CODE                                                *   CL**2
  7466*  ISSUE AGE                                                     *   CL**2
  7467*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7468*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7469*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  7470*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7471*  A.P.R.                                                        *   CL**2
  7472*  METHOD                                                            CL**2
  7473*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7474*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7475*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7476*  BENEFIT CODE                                                  *   CL**2
  7477*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7478*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  7479*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  7480*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  7481*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  7482*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  7483*                                                                *   CL**2
  7484*  RETURNED FROM ELRATE                                          *   CL**2
  7485*  --------------------                                          *   CL**2
  7486*  CALCULATED PREMIUM                                            *   CL**2
  7487*  PREMIUM RATE                                                  *   CL**2
  7488*  MORTALITY CODE                                                *   CL**2
  7489*  MAX ATTAINED AGE                                              *   CL**2
  7490*  MAX AGE                                                       *   CL**2
  7491*  MAX TERM                                                      *   CL**2
  7492*  MAX MONTHLY BENEFIT                                           *   CL**2
  7493*  MAX TOTAL BENIFIT                                             *   CL**2
  7494*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  7495*----------------------------------------------------------------*   CL**2
  7496*  PASSED TO ELRFND                                              *   CL**2
  7497*  ----------------                                              *   CL**2
  7498*  CERT ISSUE DATE                                               *   CL**2
  7499*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 137
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7500*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7501*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7502*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7503*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7504*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7505*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7506*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7507*  DEVIATION CODE                                                *   CL**2
  7508*  ISSUE AGE                                                     *   CL**2
  7509*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7510*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7511*  PROCESS TYPE (CANCEL)                                         *   CL**2
  7512*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7513*  A.P.R.                                                        *   CL**2
  7514*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  7515*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  7516*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7517*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7518*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7519*  BENEFIT CODE                                                  *   CL**2
  7520*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7521*                                                                *   CL**2
  7522*  RETURNED FROM ELRFND                                          *   CL**2
  7523*  --------------------                                          *   CL**2
  7524*  CALCULATED REFUND                                             *   CL**2
  7525*----------------------------------------------------------------*   CL**2
  7526*  PASSED TO ELEARN                                              *   CL**2
  7527*  ----------------                                              *   CL**2
  7528*  CERT ISSUE DATE                                               *   CL**2
  7529*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7530*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7531*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7532*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7533*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7534*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7535*  DEVIATION CODE                                                *   CL**2
  7536*  ISSUE AGE                                                     *   CL**2
  7537*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7538*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7539*  A.P.R.                                                        *   CL**2
  7540*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  7541*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7542*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7543*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7544*  BENEFIT CODE                                                  *   CL**2
  7545*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7546*                                                                *   CL**2
  7547*  RETURNED FROM ELEARN                                          *   CL**2
  7548*  --------------------                                          *   CL**2
  7549*  INDICATED  EARNINGS                                           *   CL**2
  7550*----------------------------------------------------------------*   CL**2
  7551*                 LENGTH = 450                                   *   CL**2
  7552*                                                                *   CL**2
  7553******************************************************************   CL**2
  7554******************************************************************
  7555*                   C H A N G E   L O G
  7556*
  7557* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 138
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7558*-----------------------------------------------------------------
  7559*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7560* EFFECTIVE    NUMBER
  7561*-----------------------------------------------------------------
  7562* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  7563* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7564* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  7565* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  7566* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  7567* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7568* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  7569* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  7570* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7571******************************************************************
  7572                                                                     CL**2
  7573 01  CALCULATION-PASS-AREA.                                          CL**2
  7574     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  7575                                     COMP.                           CL**2
  7576                                                                     CL**2
  7577     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  7578       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  7579       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  7580                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  7581       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  7582       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  7583       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  7584       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  7585       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  7586       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  7587       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  7588       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  7589       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  7590       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  7591       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  7592       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  7593       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  7594       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  7595       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  7596       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  7597       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  7598                                                                     CL**2
  7599     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  7600       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  7601***********************  INPUT AREAS ****************************    CL**2
  7602                                                                     CL**2
  7603     12  CP-CALCULATION-AREA.                                        CL**2
  7604         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  7605         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  7606         16  CP-VALUATION-DT       PIC XX.                           CL**2
  7607         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  7608         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  7609           88  CP-AH                               VALUE 'A' 'D'     CL**2
  7610                                                   'I' 'U'.          CL**2
  7611           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  7612           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  7613         16  CP-INCURRED-DT        PIC XX.                           CL**2
  7614         16  CP-REPORTED-DT        PIC XX.                           CL**2
  7615         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 139
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7616         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  7617         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  7618                                     COMP-3.                         CL**2
  7619         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  7620                                     COMP-3.                         CL**2
  7621         16  CP-CDT-METHOD         PIC X.                            CL**2
  7622           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  7623           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  7624           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  7625         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  7626           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  7627           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  7628         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  7629                                     COMP-3.                         CL**2
  7630         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  7631                                     COMP-3.                         CL**2
  7632         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  7633                                     COMP-3.                         CL**2
  7634         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  7635                                     COMP-3.                         CL**2
  7636         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7637                                     COMP-3.                         CL**2
  7638         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  7639                                     COMP-3.                         CL**2
  7640         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  7641                                     COMP-3.                         CL**2
  7642         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  7643           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  7644           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  7645           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  7646           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  7647           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  7648           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  7649           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  7650         16  CP-EARNING-METHOD     PIC X.                            CL**2
  7651           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  7652           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  7653           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7654           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7655           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7656           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7657           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  7658           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7659           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  7660           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7661           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  7662           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  7663           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  7664           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  7665         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  7666           88  CP-CLAIM                            VALUE '1'.        CL**2
  7667           88  CP-CANCEL                           VALUE '2'.        CL**2
  7668           88  CP-ISSUE                            VALUE '3'.        CL**2
  7669         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  7670           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  7671           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  7672           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  7673           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 140
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7674           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  7675           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  7676           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  7677           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  7678           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  7679           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  7680           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  7681           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  7682           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  7683           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  7684           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  7685           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  7686           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  7687           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  7688                                                     'W' 'X'.        CL**2
  7689           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  7690           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  7691           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  7692           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  7693           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  7694           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  7695           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  7696           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  7697           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  7698           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  7699           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  7700           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  7701           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  7702                                                                     CL**2
  7703         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  7704                                     COMP-3.                         CL**2
  7705         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  7706         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  7707         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  7708         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  7709         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  7710           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  7711               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  7712         16  CP-R78-OPTION         PIC X.                            CL**2
  7713           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  7714           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  7715                                                                     CL**2
  7716         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  7717         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  7718         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  7719         16  CP-RATE-FILE          PIC X.                            CL**2
  7720         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  7721                                     COMP-3.                         CL**2
  7722                                                                     CL**2
  7723         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  7724         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  7725                                                                     CL**2
  7726         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  7727                                     COMP-3.
  7728         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  7729                                   PIC S9(5)V99 COMP-3.
  7730         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  7731                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 141
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7732         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7733                                     COMP-3.                         CL**2
  7734         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  7735                                     COMP-3.
  7736         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  7737                                  PIC S9(7)V99 COMP-3.
  7738                                                                     CL**2
  7739         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  7740         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  7741         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  7742           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  7743           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  7744           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  7745           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  7746         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  7747         16  CP-CARRIER            PIC X.                            CL**2
  7748         16  CP-REIN-FLAG          PIC X.                            CL**2
  7749         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  7750           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  7751                      '2' '3' '4' '5'.                               CL**2
  7752           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  7753           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  7754           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  7755           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  7756           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  7757           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  7758           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  7759           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  7760         16  CP-SIG-SWITCH         PIC X.                            CL**2
  7761         16  CP-RATING-METHOD      PIC X.                            CL**2
  7762           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  7763           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  7764           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7765           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7766           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7767           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7768           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  7769           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7770           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7771         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  7772                                     COMP-3.                         CL**2
  7773         16  CP-BEN-CATEGORY       PIC X.
  7774         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7775         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  7776                                   PIC S99V9(5) COMP-3.
  7777         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7778         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  7779                                   PIC S99V9(5) COMP-3.
  7780         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  7781         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  7782         16  CP-EXPIRE-DT          PIC XX.
  7783         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  7784         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  7785         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  7786         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  7787         16  CP-DDF-SPEC-CALC      PIC X.
  7788             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  7789             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 142
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7790         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  7791         16  CP-CANCEL-REASON      PIC X.
  7792         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  7793         16  CP-PMT-MODE           PIC X.
  7794         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  7795         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  7796         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  7797         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  7798         16  FILLER                PIC X.
  7799                                                                     CL**2
  7800***************    OUTPUT FROM ELRESV   ************************     CL**2
  7801                                                                     CL**2
  7802         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  7803                                                                     CL**2
  7804         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  7805                                     COMP-3.                         CL**2
  7806         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  7807                                     COMP-3.                         CL**2
  7808         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  7809                                     COMP-3.                         CL**2
  7810         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  7811                                     COMP-3.                         CL**2
  7812         16  FILLER                PIC X(09).                        CL**2
  7813***************    OUTPUT FROM ELRTRM   *************************    CL**2
  7814                                                                     CL**2
  7815         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  7816                                     COMP-3.                         CL**2
  7817         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  7818                                     COMP-3.                         CL**2
  7819         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  7820                                     COMP-3.                         CL**2
  7821         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  7822                                     COMP-3.                         CL**2
  7823         16  FILLER                PIC X(12).                        CL**2
  7824                                                                     CL**2
  7825***************    OUTPUT FROM ELRAMT   *************************    CL**2
  7826                                                                     CL**2
  7827         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  7828                                     COMP-3.                         CL**2
  7829         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  7830                                     COMP-3.                         CL**2
  7831         16  FILLER                PIC X(12).                        CL**2
  7832                                                                     CL**2
  7833***************    OUTPUT FROM ELRATE   *************************    CL**2
  7834                                                                     CL**2
  7835         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  7836                                     COMP-3.                         CL**2
  7837         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  7838                                     COMP-3.                         CL**2
  7839         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  7840         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  7841             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  7842         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  7843                                     COMP-3.                         CL**2
  7844         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  7845         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  7846         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  7847                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 143
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7848         16  FILLER                PIC X(07).                        CL**2
  7849                                                                     CL**2
  7850***************    OUTPUT FROM ELRFND   *************************    CL**2
  7851                                                                     CL**2
  7852         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  7853                                     COMP-3.                         CL**2
  7854         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  7855           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  7856           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  7857           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  7858           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  7859           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7860           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  7861           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  7862           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  7863           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7864           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  7865           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  7866           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  7867           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  7868           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  7869         16  FILLER                PIC X(12).                        CL**2
  7870                                                                     CL**2
  7871***************    OUTPUT FROM ELEARN   *************************    CL**2
  7872                                                                     CL**2
  7873         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  7874                                     COMP-3.                         CL**2
  7875         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  7876                                     COMP-3.                         CL**2
  7877         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  7878                                     COMP-3.                         CL**2
  7879         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  7880                                     COMP-3.                         CL**2
  7881         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  7882                                     COMP-3.                         CL**2
  7883         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  7884                                     COMP-3.                         CL**2
  7885         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  7886           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  7887           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  7888           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  7889           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  7890           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7891           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  7892           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  7893           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  7894           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7895         16  FILLER                PIC X(12).                        CL**2
  7896                                                                     CL**2
  7897***************    OUTPUT FROM ELPMNT   *************************    CL**2
  7898                                                                     CL**2
  7899         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  7900                                     COMP-3.                         CL**2
  7901         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  7902                                     COMP-3.                         CL**2
  7903         16  FILLER                PIC X(12).                        CL**2
  7904                                                                     CL**2
  7905***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 144
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7906         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  7907                                     COMP-3.                         CL**2
  7908         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  7909                                     COMP-3.                         CL**2
  7910         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  7911                                     COMP-3.                         CL**2
  7912         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  7913                                     COMP-3.                         CL**2
  7914         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7915                                     COMP-3.                         CL**2
  7916         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7917                                     COMP-3.                         CL**2
  7918         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  7919             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  7920             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  7921             88  IO-ERROR                         VALUE 'E'.         CL**2
  7922                                                                     CL**2
  7923         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  7924                                                                     CL**2
  7925         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  7926                                                                     CL**2
  7927         16  CP-RESERVE-REMAINING-TERM                               CL**2
  7928                                   PIC S9(4)V9    VALUE ZERO         CL**2
  7929                                     COMP-3.                         CL**2
  7930                                                                     CL**2
  7931         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  7932                                                                     CL**2
  7933         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  7934                                     COMP-3.                         CL**2
  7935                                                                     CL**2
  7936         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  7937                                     COMP-3.                         CL**2
  7938                                                                     CL**2
  7939         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  7940                                     COMP-3.                         CL**2
  7941                                                                     CL**2
  7942         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  7943                                     COMP-3.                         CL**2
  7944                                                                     CL**2
  7945         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  7946                                     COMP-3.                         CL**2
  7947                                                                     CL**2
  7948         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  7949                                     COMP-3.                         CL**2
  7950                                                                     CL**2
  7951         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  7952                                     COMP-3.                         CL**2
  7953                                                                     CL**2
  7954         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  7955             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  7956                                                                     CL**2
  7957         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  7958                                     COMP-3.                         CL**2
  7959         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  7960                                     COMP-3.
  7961         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  7962         16  FILLER                PIC X(15).                        CL**2
  7963******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 145
* EL517.cbl
  7964
* 7965                                  COPY ELCDTECX.
  7966******************************************************************06/05/98
  7967*                                                                *ELCDTECX
  7968*                            ELCDTECX.                           *   LV005
  7969*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7970*                            VMOD=2.015                          *ELCDTECX
  7971*                                                                *ELCDTECX
  7972*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  7973*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  7974*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  7975*                                                                *ELCDTECX
  7976******************************************************************ELCDTECX
  7977******************************************************************
  7978*                   C H A N G E   L O G
  7979*
  7980* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7981*-----------------------------------------------------------------
  7982*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7983* EFFECTIVE    NUMBER
  7984*-----------------------------------------------------------------
  7985* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  7986*                                  BENEFIT CODES FROM 300 TO 900
  7987* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  7988* 051304    2003080800002  SMVA  ADD REFUND METHOD
  7989******************************************************************
  7990 01  DATE-CARD.                                                   ELCDTECX
  7991     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  7992     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  7993     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  7994     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  7995     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  7996     12  EP-SW                       PIC  X.                      ELCDTECX
  7997         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  7998     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  7999         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  8000     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  8001     12  RUN-CENTURY.                                             ELCDTECX
  8002         16 RUN-CENTURY-N            PIC  99.                        CL**4
  8003     12  FILLER                      PIC  X.                         CL**4
  8004     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  8005     12  FILLER                      PIC  XXX.                    ELCDTECX
  8006     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  8007                                                                  ELCDTECX
  8008 01  FILLER                          PIC  X(7)                       CL**6
  8009                                          VALUE 'OPTIONS'.        ELCDTECX
  8010 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  8011     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  8012     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  8013     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  8014         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  8015         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  8016     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  8017     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  8018     12  FILLER                      PIC  X.                      ELCDTECX
  8019     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  8020     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  8021     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 146
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8022     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  8023     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  8024     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  8025     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  8026     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  8027     12  FILLER                      PIC  X.                      ELCDTECX
  8028     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  8029     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  8030     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  8031     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  8032     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  8033     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  8034     12  FILLER                      PIC  X.                      ELCDTECX
  8035     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  8036     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  8037     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  8038     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  8039     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  8040     12  DTE-R78                     PIC  X.                      ELCDTECX
  8041     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  8042     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  8043     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  8044     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  8045     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  8046     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  8047     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  8048                                     PIC  X.                      ELCDTECX
  8049         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  8050                                                 ' '.             ELCDTECX
  8051         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  8052         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  8053     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  8054         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  8055         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  8056     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  8057     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  8058                                     PIC  9.                         CL**4
  8059     12  DTE-SYSTEM.                                              ELCDTECX
  8060         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  8061         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  8062         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  8063         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  8064         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  8065         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  8066         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  8067         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  8068         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  8069         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  8070         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  8071         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  8072         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  8073         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  8074         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  8075         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  8076         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  8077         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  8078         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  8079         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 147
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8080         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  8081         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  8082         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  8083         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  8084         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  8085         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  8086     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  8087         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  8088                                     PIC  X.                      ELCDTECX
  8089     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  8090                                                                  ELCDTECX
  8091 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  8092     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  8093     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  8094     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  8095*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  8096     12  FILLER                      PIC  X.                      ELCDTECX
  8097     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  8098     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  8099     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  8100     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  8101     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  8102     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  8103     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  8104                                                                  ELCDTECX
  8105     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  8106     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  8107     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  8108     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  8109                                                                  ELCDTECX
  8110     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  8111     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  8112     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  8113     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  8114                                                                  ELCDTECX
  8115     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  8116     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  8117                                                                  ELCDTECX
  8118     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  8119     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  8120                                                                  ELCDTECX
  8121     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  8122                                                                  ELCDTECX
  8123 01  DATE-CARD-FACTORS.                                           ELCDTECX
  8124     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  8125     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  8126     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  8127     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  8128     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  8129     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  8130     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  8131                                                                  ELCDTECX
  8132 01  FILLER                          PIC  X(12)                   ELCDTECX
  8133                                          VALUE 'COMPANY NAME'.   ELCDTECX
  8134 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  8135     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  8136         16  CNT-ID                  PIC  X.                      ELCDTECX
  8137         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 148
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8138                                                                  ELCDTECX
  8139 01  FILLER                          PIC  X(11)                   ELCDTECX
  8140                                          VALUE 'STATE NAMES'.    ELCDTECX
  8141 01  STATE-NAMES.                                                 ELCDTECX
  8142     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  8143         16  STATE-SUB               PIC  XX.                     ELCDTECX
  8144         16  STATE-PIC1.                                          ELCDTECX
  8145             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  8146             20  FILLER              PIC  XXX.                    ELCDTECX
  8147             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  8148             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  8149             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  8150             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  8151                                                                  ELCDTECX
  8152 01  FILLER                          PIC  X(13)                   ELCDTECX
  8153                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  8154 01  CARRIER-NAMES.                                               ELCDTECX
  8155     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  8156         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  8157         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  8158         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  8159         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8160         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8161         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8162*        16  FILLER                  PIC  X.                      ELCDTECX
  8163         16  CARRIER-SEC-PAY         PIC  X.
  8164             88  SEC-PAY-CARRIER          VALUE 'Y'.
  8165                                                                  ELCDTECX
  8166 01  FILLER                          PIC  X(9)                       CL**6
  8167                                          VALUE 'INS TYPES'.      ELCDTECX
  8168 01  CLAS-INS-TYPES.                                              ELCDTECX
  8169*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  8170     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  8171         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  8172         16  CLAS-I-AB3.                                          ELCDTECX
  8173             20  FILLER              PIC  X.                      ELCDTECX
  8174             20  CLAS-I-AB2.                                      ELCDTECX
  8175                 24  FILLER          PIC  X.                      ELCDTECX
  8176                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  8177         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  8178             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  8179             20  FILLER              PIC  X.                         CL**4
  8180         16  CLAS-I-AB10.                                         ELCDTECX
  8181             20  FILLER              PIC  X(9).                   ELCDTECX
  8182             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  8183         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  8184         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  8185         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  8186         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  8187             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  8188         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  8189         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  8190         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  8191         16  CLAS-I-BEN-CATEGORY     PIC  X.
  8192         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  8193         16  FILLER                  PIC  X(05).
  8194                                                                  ELCDTECX
  8195 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 149
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8196                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  8197 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  8198     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  8199                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  8200         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  8201         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  8202         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  8203         16  CLAS-MORT-DESC.                                      ELCDTECX
  8204             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  8205             20  FILLER              PIC  XX.                        CL**5
  8206             20  CLAS-YEAR           PIC  X(4).                      CL**6
  8207             20  FILLER              PIC  X.                         CL**5
  8208             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  8209             20  FILLER              PIC  X.                         CL**5
  8210             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  8211             20  FILLER              PIC  X.                         CL**5
  8212             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  8213             20  FILLER              PIC  X(5).                      CL**6
  8214                                                                  ELCDTECX
  8215 01  FILLER                          PIC  X(15)                   ELCDTECX
  8216                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  8217 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  8218     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  8219         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  8220         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  8221         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  8222         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  8223         16  FILLER                  PIC  X(4).                      CL**6
  8224                                                                  ELCDTECX
  8225 01  FILLER                          PIC  X(7)                       CL**6
  8226                                     VALUE 'INDEXES'.             ELCDTECX
  8227 01  CLAS-INDEX-TBL.                                              ELCDTECX
  8228     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  8229     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  8230     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  8231     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  8232     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  8233     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  8234     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  8235     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  8236     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  8237     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  8238     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  8239     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  8240     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  8241     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  8242     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  8243     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  8244     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  8245                                                                  ELCDTECX
  8246 01  CLAS-TYPE-MISC.                                              ELCDTECX
  8247     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  8248     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  8249     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  8250     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  8251     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  8252     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  8253     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 150
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8254     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  8255     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  8256     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  8257     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  8258                                                                  ELCDTECX
  8259 01  FILLER                          PIC  X(13)                   ELCDTECX
  8260                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  8261 01  CLAS-MISC.                                                   ELCDTECX
  8262     12  DTE-FICH                    PIC  X.                      ELCDTECX
  8263         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  8264         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  8265         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  8266     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  8267     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  8268     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  8269     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  8270     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  8271     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  8272     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  8273     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  8274     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  8275     12  STATE-L                     PIC  XX.                     ELCDTECX
  8276     12  CLAS-CN                     PIC  99.                     ELCDTECX
  8277     12  CLAS-CO                     PIC  99.                     ELCDTECX
  8278     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  8279         16  DTE-F-1                 PIC  X.                      ELCDTECX
  8280         16  DTE-F-2                 PIC  X.                      ELCDTECX
  8281     12  DTE-ABEND-WORK.                                          ELCDTECX
  8282         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  8283         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  8284                                                                  ELCDTECX
  8285 01  FILLER                          PIC  X(12)                   ELCDTECX
  8286                                     VALUE 'WORKING DATE'.        ELCDTECX
  8287 01  WS-DATE-AND-TIME.                                            ELCDTECX
  8288     12  WS-ACCEPT-DATE.                                          ELCDTECX
  8289         16  WS-AD-YY                PIC  99.                     ELCDTECX
  8290         16  WS-AD-MM                PIC  99.                     ELCDTECX
  8291         16  WS-AD-DD                PIC  99.                     ELCDTECX
  8292     12  WS-CURRENT-DATE.                                         ELCDTECX
  8293         16  WS-CD-MM                PIC  99.                     ELCDTECX
  8294         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8295         16  WS-CD-DD                PIC  99.                     ELCDTECX
  8296         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8297         16  WS-CD-YY                PIC  99.                     ELCDTECX
  8298     12  WS-TIME-OF-DAY.                                          ELCDTECX
  8299         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  8300         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  8301                                                                  ELCDTECX
  8302 01  FILLER                          PIC  X(12)                   ELCDTECX
  8303                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  8304 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  8305     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  8306         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  8307         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  8308         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  8309                                                                  ELCDTECX
  8310 01  FILLER                          PIC  X(10)                   ELCDTECX
  8311                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 151
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8312 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  8313     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  8314         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  8315         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  8316                                                                  ELCDTECX
  8317 01  FILLER                          PIC  X(13)                   ELCDTECX
  8318                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  8319 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  8320     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  8321         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  8322                                                                  ELCDTECX
  8323 01  FILLER                          PIC  X(13)                   ELCDTECX
  8324                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  8325 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  8326     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  8327     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  8328     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  8329                                     PIC  X.                         CL**5
  8330     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  8331     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  8332     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  8333     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  8334     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  8335     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  8336     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  8337     12  FILLER                      PIC  X(75).                  ELCDTECX
  8338******************************************************************ELCDTECX
  8339*01  MISC-CARR-PCT-DATA.                                          00001521
  8340*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8341*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8342*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8343*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8344*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8345*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8346******************************************************************ELCDTECX
  8347
* 8348                                  COPY ELCDTEVR.
  8349***************************************************************** 04/15/98
  8350*                                                                *ELCDTEVR
  8351*                                                                *ELCDTEVR
  8352*                            ELCDTEVR.                           *   LV003
  8353*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8354*                            VMOD=2.001                          *   CL**2
  8355*                                                                *ELCDTEVR
  8356*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  8357*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  8358*                                                                *ELCDTEVR
  8359******************************************************************ELCDTEVR
  8360 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  8361     05  WS-RUN-DATE.                                             ELCDTEVR
  8362         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8363         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  8364         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  8365             15  RUN-CC              PIC  99.                     ELCDTEVR
  8366             15  RUN-YR              PIC  99.                     ELCDTEVR
  8367         10  RUN-MO                  PIC  99.                     ELCDTEVR
  8368         10  RUN-DA                  PIC  99.                     ELCDTEVR
  8369     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 152
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8370            WS-RUN-DATE              PIC 9(11).                      CL**2
  8371     05  WS-EP-DT.                                                ELCDTEVR
  8372         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8373         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  8374         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  8375             15  EP-CC               PIC  99.                     ELCDTEVR
  8376             15  EP-YR               PIC  99.                     ELCDTEVR
  8377         10  EP-MO                   PIC  99.                     ELCDTEVR
  8378         10  EP-DA                   PIC  99.                     ELCDTEVR
  8379     05  WS-EP-DT-N REDEFINES                                        CL**2
  8380            WS-EP-DT                 PIC 9(11).                      CL**2
  8381     05  WS-DTE-CONV-DT.                                             CL**4
  8382         10  FILLER                  PIC  9(03).                     CL**4
  8383         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  8384         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  8385             15  DTE-CONV-CC         PIC  99.                        CL**4
  8386             15  DTE-CONV-YR         PIC  99.                        CL**4
  8387         10  DTE-CONV-MO             PIC  99.                        CL**4
  8388         10  DTE-CONV-DA             PIC  99.                        CL**4
  8389     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  8390            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  8391 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  8392     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  8393         10  FILLER                            PIC 999.           ELCDTEVR
  8394         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  8395         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  8396             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  8397             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  8398         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  8399         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  8400     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  8401            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  8402     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  8403         10  FILLER                            PIC 999.           ELCDTEVR
  8404         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  8405         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  8406         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  8407         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  8408     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  8409            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  8410 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  8411     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  8412         10  FILLER                            PIC 999.           ELCDTEVR
  8413         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  8414         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  8415             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  8416             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  8417         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  8418         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  8419     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  8420            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  8421     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  8422         10  FILLER                            PIC 999.           ELCDTEVR
  8423         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  8424         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  8425             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  8426             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  8427         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 153
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8428         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  8429     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  8430            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  8431     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  8432         10  FILLER                            PIC 999.           ELCDTEVR
  8433         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  8434         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  8435             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  8436             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  8437         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  8438         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  8439     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  8440            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  8441 01  WS-RATE-RECORD.                                              ELCDTEVR
  8442         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  8443             10  FILLER                        PIC 999.           ELCDTEVR
  8444             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  8445             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  8446                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  8447                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  8448             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  8449             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  8450         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  8451                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  8452
* 8453                                  COPY ELCREINV.
  8454******************************************************************04/18/98
  8455*                                                                *ELCREINV
  8456*                                                                *ELCREINV
  8457*                            ELCREINV                            *   LV003
  8458*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8459*                            VMOD=2.001                          *ELCREINV
  8460*                                                                *ELCREINV
  8461*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  8462*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  8463*                                                                *ELCREINV
  8464******************************************************************ELCREINV
  8465                                                                  ELCREINV
  8466 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  8467     05  WS-RE-LO-DATE.                                              CL**3
  8468         10 FILLER                     PIC 999.                      CL**3
  8469         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  8470         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  8471            15 RE-LO-CC                PIC 99.                       CL**3
  8472            15 RE-LO-YR                PIC 99.                       CL**3
  8473         10 RE-LO-MO                   PIC 99.                       CL**3
  8474         10 RE-LO-DA                   PIC 99.                       CL**3
  8475     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  8476            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  8477     05  WS-RE-HI-DATE.                                              CL**3
  8478         10 FILLER                     PIC 999.                      CL**3
  8479         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  8480         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  8481            15 RE-HI-CC                PIC 99.                       CL**3
  8482            15 RE-HI-YR                PIC 99.                       CL**3
  8483         10 RE-HI-MO                   PIC 99.                       CL**3
  8484         10 RE-HI-DA                   PIC 99.                       CL**3
  8485     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 154
* EL517.cbl (/apps/prod/cid1p/copy/ELCREINV)
  8486            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  8487     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  8488         10 FILLER                     PIC 999.                   ELCREINV
  8489         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  8490         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  8491            15 RE-CLM-CC               PIC 99.                    ELCREINV
  8492            15 RE-CLM-YR               PIC 99.                    ELCREINV
  8493         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  8494         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  8495     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  8496            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  8497     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  8498         10  FILLER                    PIC 999.                   ELCREINV
  8499         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  8500         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  8501             15  RE-EARN-CC            PIC 99.                    ELCREINV
  8502             15  RE-EARN-YR            PIC 99.                    ELCREINV
  8503         10  RE-EARN-MO                PIC 99.                    ELCREINV
  8504         10  RE-EARN-DA                PIC 99.                    ELCREINV
  8505     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  8506            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  8507     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  8508         10  FILLER                    PIC 999.                   ELCREINV
  8509         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  8510         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  8511             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  8512             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  8513         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  8514         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  8515     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  8516            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  8517
* 8518                                  COPY ELCACCTV.
  8519******************************************************************04/14/98
  8520*                                                                *ELCACCTV
  8521*                            ELCACCTV                            *   LV002
  8522*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8523*                            VMOD=2.001                          *ELCACCTV
  8524*                                                                *ELCACCTV
  8525*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  8526*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  8527*                                                                *ELCACCTV
  8528*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  8529*                                                                *ELCACCTV
  8530******************************************************************ELCACCTV
  8531                                                                  ELCACCTV
  8532 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  8533                                                                  ELCACCTV
  8534     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  8535         10  FILLER            PIC 999.                           ELCACCTV
  8536         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  8537         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  8538             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  8539             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  8540         10  AM-EXP-MO         PIC 99.                               CL**5
  8541         10  AM-EXP-DA         PIC 99.                               CL**5
  8542     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  8543            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 155
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8544     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  8545         10  FILLER                    PIC 999.                   ELCACCTV
  8546         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  8547         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  8548             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  8549             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  8550         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  8551         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  8552     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  8553            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  8554     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  8555         10  FILLER                    PIC 999.                   ELCACCTV
  8556         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  8557         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  8558             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  8559             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  8560         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  8561         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  8562     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  8563            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  8564     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  8565         10 FILLER                     PIC 999.                   ELCACCTV
  8566         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  8567         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  8568            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  8569            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  8570         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  8571         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  8572     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  8573            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  8574     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  8575         10 FILLER                     PIC 999.                   ELCACCTV
  8576         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  8577         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  8578            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  8579            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  8580         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  8581         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  8582     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  8583            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  8584     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  8585         10  FILLER                    PIC 999.                   ELCACCTV
  8586         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  8587         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  8588             15  AM-AN-CC              PIC 99.                    ELCACCTV
  8589             15  AM-AN-YR              PIC 99.                    ELCACCTV
  8590         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  8591         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  8592     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  8593            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  8594     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  8595         10  FILLER                    PIC 999.                   ELCACCTV
  8596         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  8597         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  8598             15  AM-HI-CC              PIC 99.                    ELCACCTV
  8599             15  AM-HI-YR              PIC 99.                    ELCACCTV
  8600         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  8601         10  AM-HI-DA                  PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 156
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8602     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  8603            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  8604     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  8605         10  FILLER                    PIC 999.                   ELCACCTV
  8606         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  8607         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  8608             15  AM-LO-CC              PIC 99.                    ELCACCTV
  8609             15  AM-LO-YR              PIC 99.                    ELCACCTV
  8610         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  8611         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  8612     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  8613            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  8614     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  8615         10  FILLER                    PIC 999.                   ELCACCTV
  8616         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  8617         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  8618             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  8619             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  8620         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  8621         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  8622     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  8623            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 157
* EL517.cbl
* 8625                                  COPY ELCDIFRD.
  8626******************************************************************04/15/98
  8627*                                                                *ELCDIFRD
  8628*                                                                *ELCDIFRD
  8629*                            ELCDIFRD.                           *   LV003
  8630*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8631*                            VMOD=2.004                          *   CL**3
  8632*                                                                *ELCDIFRD
  8633*   WORKING STORAGE FOR REFUND DIFFERENCES                       *ELCDIFRD
  8634*                                                                *ELCDIFRD
  8635******************************************************************ELCDIFRD
  8636*                                                                 ELCDIFRD
  8637  01  WS-DIFFERENCE-CALCULATION.                                  ELCDIFRD
  8638        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8639        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8640        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8641        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8642        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8643        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8644        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8645        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8646        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8647        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8648        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 158
* EL517.cbl
* 8650                                  COPY ELCERRWS.
  8651******************************************************************04/15/98
  8652*                                                                *ELCERRWS
  8653*                                                                *ELCERRWS
  8654*                            ELCERRWS                            *   LV002
  8655*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8656*                            VMOD=2.005                          *   CL**2
  8657*                                                                *ELCERRWS
  8658*                                                                *ELCERRWS
  8659*    WORKING STORAGE FOR ERROR MESSAGES ROUTINE ELCERRPD         *ELCERRWS
  8660*                                                                *ELCERRWS
  8661******************************************************************ELCERRWS
  8662                                                                  ELCERRWS
  8663 01  W-ERROR-WORK.                                                ELCERRWS
  8664     12  E-CLIENT-ID             PIC X(03)   VALUE SPACES.        ELCERRWS
  8665     12  CLIENT-ABL              PIC X(03)   VALUE 'ABL'.         ELCERRWS
  8666     12  CLIENT-AIG              PIC X(03)   VALUE 'AIG'.         ELCERRWS
  8667     12  CLIENT-AUK              PIC X(03)   VALUE 'AUK'.         ELCERRWS
  8668     12  CLIENT-CIG              PIC X(03)   VALUE 'CIG'.         ELCERRWS
  8669     12  CLIENT-CUK              PIC X(03)   VALUE 'CUK'.         ELCERRWS
  8670     12  CLIENT-LAP              PIC X(03)   VALUE 'LAP'.         ELCERRWS
  8671     12  CLIENT-NCB              PIC X(03)   VALUE 'NCB'.         ELCERRWS
  8672     12  CLIENT-TIC              PIC X(03)   VALUE 'TIC'.         ELCERRWS
  8673     12  CLIENT-TMS              PIC X(03)   VALUE 'TMS'.         ELCERRWS
  8674     12  CLIENT-LBL              PIC X(03)   VALUE 'LBL'.         ELCERRWS
  8675     12  CLIENT-HAN              PIC X(03)   VALUE 'HAN'.         ELCERRWS
  8676     12  CLIENT-JHL              PIC X(03)   VALUE 'JHL'.         ELCERRWS
  8677     12  CLIENT-HER              PIC X(03)   VALUE 'HER'.         ELCERRWS
  8678     12  CLIENT-NCX              PIC X(03)   VALUE 'NCX'.         ELCERRWS
  8679     12  CLIENT-DCC              PIC X(03)   VALUE 'DCC'.
  8680     12  CLIENT-CID              PIC X(03)   VALUE 'CID'.
  8681                                                                  ELCERRWS
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 159
* EL517.cbl
  8683
  8684 PROCEDURE DIVISION.
  8685
  8686 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  8687******************************************************************04/15/98
  8688*                                                                *ELCDTERX
  8689*                                                                *ELCDTERX
  8690*                            ELCDTERX.                           *   LV002
  8691*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8692*                            VMOD=2.007                          *ELCDTERX
  8693*                                                                *ELCDTERX
  8694*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  8695*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  8696*      = ELCDTEFD)                                               *ELCDTERX
  8697*                                                                *ELCDTERX
  8698******************************************************************ELCDTERX
  8699                                                                  ELCDTERX
  8700     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  8701                                                                  ELCDTERX
  8702     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  8703     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  8704     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  8705                                                                  ELCDTERX
  8706     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  8707                                                                  ELCDTERX
  8708******************************************************************ELCDTERX
  8709*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  8710*          WARNING MESSAGES.                                      ELCDTERX
  8711******************************************************************ELCDTERX
  8712     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  8713         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  8714                                                                  ELCDTERX
  8715     OPEN INPUT DISK-DATE.                                        ELCDTERX
  8716                                                                  ELCDTERX
  8717     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  8718                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  8719                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  8720                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  8721                   CLAX-ID           CLAS-MISC                    ELCDTERX
  8722                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  8723                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  8724                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  8725                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  8726                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  8727                                                                  ELCDTERX
  8728     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  8729                                                                  ELCDTERX
  8730     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  8731                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  8732                                                                  ELCDTERX
  8733     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  8734     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  8735     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  8736     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  8737                                                                  ELCDTERX
  8738     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  8739         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 160
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8740     ELSE                                                         ELCDTERX
  8741         ADD +1                 TO CLAS-CN.                       ELCDTERX
  8742                                                                  ELCDTERX
  8743     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  8744         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  8745     ELSE                                                         ELCDTERX
  8746         ADD +1                 TO CLAS-CO.                       ELCDTERX
  8747                                                                  ELCDTERX
  8748 0005-READ--CARD.                                                 ELCDTERX
  8749     READ DISK-DATE                                               ELCDTERX
  8750         AT END CLOSE DISK-DATE                                   ELCDTERX
  8751             GO TO 0060-READ--TEST.                               ELCDTERX
  8752                                                                  ELCDTERX
  8753     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  8754                                                                  ELCDTERX
  8755     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  8756         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  8757         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  8758         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  8759         GO TO 0005-READ--CARD.                                   ELCDTERX
  8760                                                                  ELCDTERX
  8761     IF DD-ID = 'CLAD'                                            ELCDTERX
  8762         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  8763         GO TO 0005-READ--CARD.                                   ELCDTERX
  8764                                                                  ELCDTERX
  8765     IF DD-ID = 'CLAX'                                            ELCDTERX
  8766         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  8767         GO TO 0005-READ--CARD.                                   ELCDTERX
  8768                                                                  ELCDTERX
  8769     IF DD-ID = 'CLAF'                                            ELCDTERX
  8770         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  8771         GO TO 0005-READ--CARD.                                   ELCDTERX
  8772                                                                  ELCDTERX
  8773     IF DD-ID = 'CLAC'                                            ELCDTERX
  8774         GO TO 0010-READ--CLAC.                                   ELCDTERX
  8775                                                                  ELCDTERX
  8776     IF DD-ID = 'CARR'                                            ELCDTERX
  8777         GO TO 0015-READ--CARR.                                   ELCDTERX
  8778                                                                  ELCDTERX
  8779     IF DD-ID = 'STAT'                                            ELCDTERX
  8780         GO TO 0020-READ--STAT.                                   ELCDTERX
  8781                                                                  ELCDTERX
  8782     IF DD-ID = 'BUSC'                                            ELCDTERX
  8783         GO TO 0025-READ--BUSC.                                   ELCDTERX
  8784                                                                  ELCDTERX
  8785     IF DD-ID = 'MORT'                                            ELCDTERX
  8786         GO TO 0030-READ--MORT.                                   ELCDTERX
  8787                                                                  ELCDTERX
  8788     IF DD-ID = 'CLAI'                                            ELCDTERX
  8789         GO TO 0040-READ--CLAI.                                   ELCDTERX
  8790                                                                  ELCDTERX
  8791     IF DD-ID = 'COLC'                                            ELCDTERX
  8792         GO TO 0065-READ--COLC.                                   ELCDTERX
  8793                                                                  ELCDTERX
  8794     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8795        DD-IDA = 'CL'                                             ELCDTERX
  8796         GO TO 0035-READ--CLXX.                                   ELCDTERX
  8797                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 161
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8798     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8799        DD-IDA = 'PO'                                             ELCDTERX
  8800         GO TO 0050-READ--POXX.                                   ELCDTERX
  8801                                                                  ELCDTERX
  8802     IF DD-ID = 'OPCA'                                            ELCDTERX
  8803         GO TO 0070-READ--OPCA.                                   ELCDTERX
  8804                                                                  ELCDTERX
  8805     IF DD-ID = 'OPST'                                            ELCDTERX
  8806         GO TO 0072-READ--OPST.                                   ELCDTERX
  8807                                                                  ELCDTERX
  8808     IF DD-ID = 'OPBS'                                            ELCDTERX
  8809         GO TO 0074-READ--OPBS.                                   ELCDTERX
  8810                                                                  ELCDTERX
  8811     IF DD-ID = 'OPMS'                                            ELCDTERX
  8812         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  8813                                                                  ELCDTERX
  8814     GO TO 0005-READ--CARD.                                       ELCDTERX
  8815                                                                  ELCDTERX
  8816 0010-READ--CLAC.                                                 ELCDTERX
  8817     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8818     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8819     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8820     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8821     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8822     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8823     GO TO 0005-READ--CARD.                                       ELCDTERX
  8824                                                                  ELCDTERX
  8825 0015-READ--CARR.                                                 ELCDTERX
  8826     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8827     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8828        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  8829        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8830        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  8831        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8832        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8833        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8834        MOVE DD-CARR1-SECPAY-SW
  8835                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8836     END-IF
  8837                                                                  ELCDTERX
  8838     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8839     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8840        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  8841        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8842        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  8843        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8844        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8845        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8846        MOVE DD-CARR2-SECPAY-SW
  8847                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8848     END-IF
  8849                                                                  ELCDTERX
  8850                                                                  ELCDTERX
  8851     GO TO 0005-READ--CARD.                                       ELCDTERX
  8852                                                                  ELCDTERX
  8853 0020-READ--STAT.                                                 ELCDTERX
  8854     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8855     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 162
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8856        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8857         GO TO 0005-READ--CARD.                                   ELCDTERX
  8858                                                                  ELCDTERX
  8859     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  8860     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  8861     GO TO 0020-READ--STAT.                                       ELCDTERX
  8862                                                                  ELCDTERX
  8863 0025-READ--BUSC.                                                 ELCDTERX
  8864     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8865     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  8866        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8867         GO TO 0005-READ--CARD.                                   ELCDTERX
  8868                                                                  ELCDTERX
  8869     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  8870     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  8871     GO TO 0025-READ--BUSC.                                       ELCDTERX
  8872                                                                  ELCDTERX
  8873 0030-READ--MORT.                                                 ELCDTERX
  8874     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8875     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8876        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  8877         GO TO 0005-READ--CARD.                                   ELCDTERX
  8878                                                                  ELCDTERX
  8879     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  8880     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  8881     GO TO 0030-READ--MORT.                                       ELCDTERX
  8882                                                                  ELCDTERX
  8883 0035-READ--CLXX.                                                 ELCDTERX
  8884     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  8885          GO TO 0005-READ--CARD.                                  ELCDTERX
  8886                                                                  ELCDTERX
  8887     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  8888         DISPLAY '***********************************************'ELCDTERX
  8889         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  8890         DISPLAY '***********************************************'ELCDTERX
  8891         GO TO 0055-READ--STOP.                                   ELCDTERX
  8892                                                                  ELCDTERX
  8893     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  8894        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  8895         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  8896                                                                  ELCDTERX
  8897     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  8898        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  8899         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  8900                                                                  ELCDTERX
  8901*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  8902     GO TO 0005-READ--CARD.                                       ELCDTERX
  8903                                                                  ELCDTERX
  8904 0040-READ--CLAI.                                                 ELCDTERX
  8905     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8906     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8907        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  8908         GO TO 0005-READ--CARD.                                   ELCDTERX
  8909                                                                  ELCDTERX
  8910     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  8911     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  8912     GO TO 0040-READ--CLAI.                                       ELCDTERX
  8913                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 163
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8914 0045-READ--DUMP.                                                 ELCDTERX
  8915     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  8916     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  8917                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  8918     PERFORM ABEND-PGM.                                           ELCDTERX
  8919                                                                  ELCDTERX
  8920 0050-READ--POXX.                                                 ELCDTERX
  8921     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  8922         GO TO 0005-READ--CARD.                                   ELCDTERX
  8923                                                                  ELCDTERX
  8924     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  8925         DISPLAY '***********************************************'ELCDTERX
  8926         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  8927         DISPLAY '***********************************************'ELCDTERX
  8928         GO TO 0055-READ--STOP.                                   ELCDTERX
  8929                                                                  ELCDTERX
  8930     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  8931     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  8932     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  8933     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  8934                                                                  ELCDTERX
  8935     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  8936         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  8937     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  8938         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  8939                                                                  ELCDTERX
  8940     GO TO 0005-READ--CARD.                                       ELCDTERX
  8941                                                                  ELCDTERX
  8942 0055-READ--STOP.                                                 ELCDTERX
  8943     GOBACK.                                                      ELCDTERX
  8944                                                                  ELCDTERX
  8945 0060-READ--TEST.                                                 ELCDTERX
  8946     IF DATX-COD        = SPACE  OR                               ELCDTERX
  8947        CLAX-ID         = SPACE  OR                               ELCDTERX
  8948        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  8949         GO TO 0045-READ--DUMP.                                   ELCDTERX
  8950                                                                  ELCDTERX
  8951     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  8952     GO TO 0079-READ--EXIT.                                       ELCDTERX
  8953                                                                  ELCDTERX
  8954 0065-READ--COLC.                                                 ELCDTERX
  8955     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  8956     GO TO 0005-READ--CARD.                                       ELCDTERX
  8957                                                                  ELCDTERX
  8958 0070-READ--OPCA.                                                 ELCDTERX
  8959                                                                  ELCDTERX
  8960     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8961                                                                  ELCDTERX
  8962     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  8963             OR                                                   ELCDTERX
  8964         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  8965         GO TO 0005-READ--CARD.                                   ELCDTERX
  8966                                                                  ELCDTERX
  8967     ADD 1                       TO INDEXCA.                      ELCDTERX
  8968     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  8969                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  8970     GO TO 0070-READ--OPCA.                                       ELCDTERX
  8971                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 164
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8972 0072-READ--OPST.                                                 ELCDTERX
  8973                                                                  ELCDTERX
  8974     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8975                                                                  ELCDTERX
  8976     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  8977             OR                                                   ELCDTERX
  8978         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8979         GO TO 0005-READ--CARD.                                   ELCDTERX
  8980                                                                  ELCDTERX
  8981     ADD 1                       TO INDEXST.                      ELCDTERX
  8982     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  8983                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  8984     GO TO 0072-READ--OPST.                                       ELCDTERX
  8985                                                                  ELCDTERX
  8986 0074-READ--OPBS.                                                 ELCDTERX
  8987                                                                  ELCDTERX
  8988     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8989                                                                  ELCDTERX
  8990     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  8991             OR                                                   ELCDTERX
  8992         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8993         GO TO 0005-READ--CARD.                                   ELCDTERX
  8994                                                                  ELCDTERX
  8995     ADD 1                       TO INDEXBS.                      ELCDTERX
  8996     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  8997     GO TO 0074-READ--OPBS.                                       ELCDTERX
  8998                                                                  ELCDTERX
  8999 0079-READ--EXIT.                                                 ELCDTERX
  9000*    EXIT.                                                        ELCDTERX
  9001******************************************************************ELCDTERX
  9002
  9003     MOVE DTE-CLIENT TO E-CLIENT-ID.
  9004
  9005     MOVE WS-CD-YY               TO DC-MDY-YEAR.
  9006     MOVE WS-CD-DD               TO DC-MDY-DAY.
  9007     MOVE WS-CD-MM               TO DC-MDY-MONTH.
  9008
  9009     MOVE 4                      TO DC-OPTION-CODE.
  9010     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9011     MOVE DC-JULIAN-DATE         TO EIBDATE.
  9012     MOVE LOW-VALUES             TO WK-RECORD-ADDRESSES.
  9013     MOVE WORK-AREAS             TO HOLD-WORK.
  9014
  9015     IF DTE-PRC-OPT = '2'
  9016         MOVE 'FULL FILE EDIT' TO ER-ONLY.
  9017
  9018     OPEN INPUT ELCNTL.
  9019     IF ELCNTL-FILE-STATUS   = '00' OR '97'
  9020         NEXT SENTENCE
  9021       ELSE
  9022         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9023         MOVE 'ELCNTL'           TO WS-FEM-FILE-NAME
  9024         MOVE EMSG               TO WS-ABEND-MESSAGE
  9025         GO TO ABEND-PGM.
  9026
  9027     OPEN  I-O ERPNDB.
  9028     IF ERPNDB-FILE-STATUS   = '00' OR '97'
  9029         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 165
* EL517.cbl
  9030       ELSE
  9031         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9032         MOVE 'ERPNDB'           TO WS-FEM-FILE-NAME
  9033         MOVE EMSG               TO WS-ABEND-MESSAGE
  9034         GO TO ABEND-PGM.
  9035
  9036     MOVE LOW-VALUES            TO PB-CONTROL-PRIMARY.
  9037     MOVE DTE-CLASIC-COMPANY-CD TO PB-COMPANY-CD.
  9038
  9039     START ERPNDB KEY NOT LESS THAN PB-CONTROL-PRIMARY.
  9040
  9041     IF ERPNDB-FILE-STATUS NOT = '00'
  9042         GO TO 9999-DONE.
  9043
  9044     OPEN INPUT ERREIN.
  9045     IF ERREIN-FILE-STATUS   = '00' OR '97'
  9046         NEXT SENTENCE
  9047       ELSE
  9048         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9049         MOVE 'ERREIN'           TO WS-FEM-FILE-NAME
  9050         MOVE EMSG               TO WS-ABEND-MESSAGE
  9051         GO TO ABEND-PGM.
  9052
  9053     IF DTE-CLIENT = 'DCC'
  9054        OPEN INPUT ERPDEF ELSTAT
  9055        IF ERPDEF-FILE-STATUS   = '00' OR '97'
  9056           CONTINUE
  9057        ELSE
  9058           MOVE ERPDEF-FILE-STATUS
  9059                                 TO WS-ABEND-FILE-STATUS
  9060           MOVE 'ERPDEF'         TO WS-FEM-FILE-NAME
  9061           MOVE EMSG             TO WS-ABEND-MESSAGE
  9062           GO TO ABEND-PGM
  9063        END-IF
  9064        IF ELSTAT-FILE-STATUS   = '00' OR '97'
  9065           CONTINUE
  9066        ELSE
  9067           MOVE ELSTAT-FILE-STATUS
  9068                                 TO WS-ABEND-FILE-STATUS
  9069           MOVE 'ELSTAT'         TO WS-FEM-FILE-NAME
  9070           MOVE EMSG             TO WS-ABEND-MESSAGE
  9071           GO TO ABEND-PGM
  9072        END-IF
  9073     END-IF
  9074
  9075     OPEN I-O   ELCERT.
  9076******************************************************************
  9077*                                                                *
  9078*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  9079*    REVIEW AND CORRRECTION SUB-SYSTEM.                          *
  9080*                                                                *
  9081*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  9082*                                                                *
  9083*               EL631 - EL6311 - EL6312 - EL6313                 *
  9084*                                                                *
  9085******************************************************************
  9086
  9087     IF ELCERT-FILE-STATUS  = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 166
* EL517.cbl
  9088         NEXT SENTENCE
  9089       ELSE
  9090         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9091         MOVE 'ELCERT'              TO WS-FEM-FILE-NAME
  9092         MOVE EMSG                  TO WS-ABEND-MESSAGE
  9093         GO TO ABEND-PGM.
  9094
  9095     OPEN INPUT ERCTBL.
  9096     IF ERCTBL-FILE-STATUS   = '00' OR '97'
  9097         NEXT SENTENCE
  9098       ELSE
  9099         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9100         MOVE 'ERCTBL'           TO WS-FEM-FILE-NAME
  9101         MOVE EMSG               TO WS-ABEND-MESSAGE
  9102         GO TO ABEND-PGM.
  9103
  9104     OPEN INPUT ERACCT.
  9105     IF ERACCT-FILE-STATUS   = '00' OR '97'
  9106         NEXT SENTENCE
  9107       ELSE
  9108         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9109         MOVE 'ERACCT'           TO WS-FEM-FILE-NAME
  9110         MOVE EMSG               TO WS-ABEND-MESSAGE
  9111         GO TO ABEND-PGM.
  9112
  9113     OPEN INPUT ERCOMP.
  9114     IF ERCOMP-FILE-STATUS   = '00' OR '97'
  9115         NEXT SENTENCE
  9116       ELSE
  9117         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9118         MOVE 'ERCOMP'           TO WS-FEM-FILE-NAME
  9119         MOVE EMSG               TO WS-ABEND-MESSAGE
  9120         GO TO ABEND-PGM.
  9121
  9122     OPEN INPUT ERLOFC
  9123     IF ERLOFC-FILE-STATUS   = '00' OR '97'
  9124        CONTINUE
  9125     ELSE
  9126        MOVE ERLOFC-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9127        MOVE 'ERLOFC'            TO WS-FEM-FILE-NAME
  9128        MOVE EMSG                TO WS-ABEND-MESSAGE
  9129        GO TO ABEND-PGM
  9130     END-IF
  9131
  9132     OPEN INPUT ERBXRF.
  9133     IF ERBXRF-FILE-STATUS   = '00' OR '97'
  9134         NEXT SENTENCE
  9135       ELSE
  9136         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9137         MOVE 'ERBXRF'           TO WS-FEM-FILE-NAME
  9138         MOVE EMSG               TO WS-ABEND-MESSAGE
  9139         GO TO ABEND-PGM.
  9140
  9141     OPEN INPUT ERAGTC.
  9142     IF ERAGTC-FILE-STATUS   = '00' OR '97'
  9143         NEXT SENTENCE
  9144       ELSE
  9145         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 167
* EL517.cbl
  9146         MOVE 'ERAGTC'           TO WS-FEM-FILE-NAME
  9147         MOVE EMSG               TO WS-ABEND-MESSAGE
  9148         GO TO ABEND-PGM.
  9149
  9150     OPEN INPUT ERPLAN.
  9151     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  9152        NEXT SENTENCE
  9153     ELSE
  9154        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9155        MOVE 'ERPLAN '           TO WS-FEM-FILE-NAME
  9156        MOVE EMSG                TO WS-ABEND-MESSAGE
  9157        GO TO ABEND-PGM.
  9158
  9159     OPEN INPUT ERFORM.
  9160     IF ERFORM-FILE-STATUS  = '00' OR '97' OR '9+'
  9161        OR '9%'
  9162        NEXT SENTENCE
  9163     ELSE
  9164        MOVE ERFORM-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9165        MOVE 'ERFORM '           TO WS-FEM-FILE-NAME
  9166        MOVE EMSG                TO WS-ABEND-MESSAGE
  9167        GO TO ABEND-PGM.
  9168
  9169     OPEN INPUT ELCERR.
  9170     IF ELCERR-FILE-STATUS   = '00' OR '97'
  9171         NEXT SENTENCE
  9172       ELSE
  9173         MOVE ELCERR-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9174         MOVE 'ELCERR'           TO WS-FEM-FILE-NAME
  9175         MOVE EMSG               TO WS-ABEND-MESSAGE
  9176         GO TO ABEND-PGM.
  9177
  9178     MOVE 'R'                     TO CP-RATE-FILE.
  9179     MOVE 'O'                     TO CP-IO-FUNCTION.
  9180     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9181
  9182     IF IO-ERROR
  9183        MOVE SPACE                TO WS-ABEND-FILE-STATUS
  9184        MOVE 'ELRATE'             TO WS-FEM-FILE-NAME
  9185        MOVE EMSG                 TO WS-ABEND-MESSAGE
  9186        GO TO ABEND-PGM.
  9187
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 168
* EL517.cbl
  9189*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  9190*
  9191     IF DTE-CLIENT NOT = 'DMD'
  9192         GO TO 0100-READ-PENDING.
  9193
  9194     OPEN INPUT ERRESS ERRESC.
  9195
  9196     IF ERRESS-FILE-STATUS   = '00' OR '97'
  9197         NEXT SENTENCE
  9198     ELSE
  9199         MOVE ERRESS-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9200         MOVE 'ERRESS'           TO WS-FEM-FILE-NAME
  9201         MOVE EMSG               TO WS-ABEND-MESSAGE
  9202         GO TO ABEND-PGM.
  9203
  9204     IF ERRESC-FILE-STATUS   = '00' OR '97'
  9205         NEXT SENTENCE
  9206     ELSE
  9207         MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9208         MOVE 'ERRESC'           TO WS-FEM-FILE-NAME
  9209         MOVE EMSG               TO WS-ABEND-MESSAGE
  9210         GO TO ABEND-PGM.
  9211
  9212     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
  9213     MOVE 'O'                    TO DMPF-PROCESS-TYPE.
  9214     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
  9215     IF DMPF-RETURN-CODE EQUAL 'Z2'
  9216         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9217         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
  9218         MOVE EMSG               TO WS-ABEND-MESSAGE
  9219         GO TO ABEND-PGM.
  9220
  9221     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
  9222     MOVE 'O'                    TO DIPF-PROCESS-TYPE.
  9223     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
  9224     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9225         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9226         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
  9227         MOVE EMSG               TO WS-ABEND-MESSAGE
  9228         GO TO ABEND-PGM.
  9229
  9230     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
  9231     MOVE 'O'                    TO DVBI-PROCESS-TYPE.
  9232     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
  9233     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9234         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9235         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
  9236         MOVE EMSG               TO WS-ABEND-MESSAGE
  9237         GO TO ABEND-PGM.
  9238
  9239     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9240     MOVE 'O'                    TO DCUA-PROCESS-TYPE.
  9241     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9242     IF DCUA-RETURN-CODE EQUAL 'Z2'
  9243         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9244         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
  9245         MOVE EMSG               TO WS-ABEND-MESSAGE
  9246         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 169
* EL517.cbl
  9247
  9248     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
  9249     MOVE 'O'                    TO DPRB-PROCESS-TYPE.
  9250     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
  9251     IF DPRB-RETURN-CODE EQUAL 'Z2'
  9252         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9253         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
  9254         MOVE EMSG               TO WS-ABEND-MESSAGE
  9255         GO TO ABEND-PGM.
  9256
  9257     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
  9258     MOVE 'O'                    TO DVRC-PROCESS-TYPE.
  9259     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
  9260     IF DVRC-RETURN-CODE EQUAL 'Z2'
  9261         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9262         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
  9263         MOVE EMSG               TO WS-ABEND-MESSAGE
  9264         GO TO ABEND-PGM.
  9265
  9266     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
  9267     MOVE 'O'                    TO DVSC-PROCESS-TYPE.
  9268     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
  9269     IF DVSC-RETURN-CODE EQUAL 'Z2'
  9270         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9271         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
  9272         MOVE EMSG               TO WS-ABEND-MESSAGE
  9273         GO TO ABEND-PGM.
  9274
  9275*
  9276*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  9277*
  9278 0100-READ-PENDING.
  9279
  9280     MOVE HOLD-WORK TO WORK-AREAS.
  9281
  9282     MOVE ZEROS                  TO EMI-WARNING-CTR
  9283                                    EMI-FORCABLE-CTR
  9284                                    EMI-FATAL-CTR.
  9285 0101-READ-PENDING.
  9286     READ ERPNDB.
  9287     ADD 1 TO RPND.
  9288
  9289     IF DTE-CLASIC-COMPANY-CD NOT = PB-COMPANY-CD-A1
  9290         GO TO 9999-DONE.
  9291
  9292     IF ERPNDB-FILE-STATUS NOT = '00'
  9293         GO TO 9999-DONE.
  9294
  9295     MOVE LIFE-OVERRIDE-L1       TO PB-LIFE-OVERRIDE-L1.
  9296     MOVE AH-OVERRIDE-L1         TO PB-AH-OVERRIDE-L1.
  9297     MOVE PB-ENTRY-BATCH         TO WK-BATCH-NO.
  9298
  9299     IF PB-BATCH-TRAILER
  9300         GO TO 9999-REWRITE-RECORD.
  9301
  9302     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  9303        GO TO 0100-READ-PENDING.
  9304
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 170
* EL517.cbl
  9305     IF PB-BILLED-DT NOT EQUAL LOW-VALUES
  9306        PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9307        GO TO 0100-READ-PENDING.
  9308
  9309     IF WK-BATCH-PREFIX = '#CL'
  9310        GO TO 0100-READ-PENDING.
  9311
  9312     IF DTE-PRC-OPT = '2'
  9313         NEXT SENTENCE
  9314     ELSE
  9315         IF NOT PB-FATAL-ERRORS
  9316             PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9317             GO TO 0100-READ-PENDING.
  9318
  9319     ADD 1 TO TRAN-CT.
  9320
  9322 0000-PROCEDURE-DIV.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 171
* EL517.cbl
*                           COPY ELC50PD.
  9323******************************************************************04/22/98
  9324*                                                                *ELC50PD
  9325*                            ELC50PD                             *   LV012
  9326*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
  9327*                            VMOD=2.188                          *   CL**7
  9328*                                                                *ELC50PD
  9329******************************************************************
  9330*                   C H A N G E   L O G
  9331*
  9332* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9333*-----------------------------------------------------------------
  9334*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9335* EFFECTIVE    NUMBER
  9336*-----------------------------------------------------------------
  9337* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  9338* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  9339* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  9340*                             2709 AND 2718
  9341* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  9342* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  9343* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  9344* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  9345* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  9346*                                IS OPEN OR CNC DT < PD THRU
  9347* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  9348* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  9349* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  9350* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  9351* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  9352* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  9353* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  9354* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
  9355* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  9356* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  9357* 020906                   PEMA  EXPAND LOAN OFFICER
  9358* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  9359* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  9360* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  9361* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  9362* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  9363* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  9364* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  9365* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  9366* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  9367* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  9368* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  9369* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  9370* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  9371* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  9372* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  9373* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  9374* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  9375* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  9376* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  9377* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST PMT
  9378* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUMS
  9379* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 172
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9380* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  9381* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  9382* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  9383*                                UPDATE VIN ON CERT TRAILER
  9384* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  9385* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISAB ONLY
  9386* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  9387* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  9388* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9389* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  9390* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONLY
  9391* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  9392* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  9393* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  9394* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  9395* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  9396* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  9397* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  9398* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  9399* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  9400* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  9401* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  9402* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  9403* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  9404* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  9405* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  9406* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  9407* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9408* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  9409* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  9410* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  9411* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  9412* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  9413* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  9414* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  9415* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  9416* 032912  CR2011110200001  PEMA  AHL CHANGES
  9417* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  9418* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  9419* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  9420* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  9421* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  9422* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  9423* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  9424* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  9425* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  9426* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  9427* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  9428* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  9429* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  9430******************************************************************ELC50PD
  9431************* PROCEDURE DIVISION FOR EL050 & EL517 ***************ELC50PD
  9432******************************************************************ELC50PD
  9433                                                                  ELC50PD
  9434     INITIALIZE  WS-CRI-SSN-WORK-AREA.                            ELC50PD
  9435                                                                  ELC50PD
  9436     MOVE SPACES                 TO PB-FATAL-FLAG                 ELC50PD
  9437                                    PB-FORCE-ER-CD                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 173
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9438                                    PB-WARN-ER-CD                 ELC50PD
  9439                                    PB-OUT-BAL-CD.                ELC50PD
  9440                                                                  ELC50PD
  9441     MOVE SPACE                  TO WS-IG-OVRD-AH                 ELC50PD
  9442                                    WS-IG-OVRD-LF                 ELC50PD
  9443                                    WS-IG-OVRD-AM                 ELC50PD
  9444                                    WS-IG-OVRD                    ELC50PD
  9445                                    WS-IG-OVRD-AH-PL              ELC50PD
  9446                                    WS-IG-OVRD-LF-PL              ELC50PD
  9447                                    WS-IG-OVRD-AH-BEN             ELC50PD
  9448                                    WS-IG-OVRD-LF-BEN.            ELC50PD
  9449                                                                  ELC50PD
  9450******************************************************************ELC50PD
  9451*************       INITIALIZE COMMON ERRORS       ***************ELC50PD
  9452******************************************************************ELC50PD
  9453                                                                  ELC50PD
  9454     MOVE +0                     TO PB-NO-OF-ERRORS.              ELC50PD
  9455     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.             ELC50PD
  9456                                                                  ELC50PD
  9457******************************************************************ELC50PD
  9458                                                                  ELC50PD
  9459     MOVE EIBDATE                TO DC-JULIAN-DATE.               ELC50PD
  9460     SET JULIAN-TO-BIN           TO TRUE.                         ELC50PD
  9461*    MOVE 5                      TO DC-OPTION-CODE.               ELC50PD
  9462     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
  9463     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.            ELC50PD
  9464                                                                  ELC50PD
  9465     MOVE ZERO                   TO  SUB4.                        ELC50PD
  9466                                                                  ELC50PD
  9467 0040-INITIALIZE-GA-BILL-DT.                                      ELC50PD
  9468                                                                  ELC50PD
  9469     ADD +1                      TO  SUB4.                        ELC50PD
  9470                                                                  ELC50PD
  9471     IF  SUB4 GREATER THAN +5                                     ELC50PD
  9472         GO TO 0050-CHECK-CNTL-FOUND.                             ELC50PD
  9473                                                                  ELC50PD
  9474     IF  PB-GA-BILL-DT (SUB4) = SPACES                            ELC50PD
  9475         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).        ELC50PD
  9476                                                                  ELC50PD
  9477     GO TO 0040-INITIALIZE-GA-BILL-DT.                            ELC50PD
  9478                                                                  ELC50PD
  9479 0050-CHECK-CNTL-FOUND.                                           ELC50PD
  9480                                                                  ELC50PD
  9481     IF WK-CNTL-RECORD-FOUND-SW = 'Y'                             ELC50PD
  9482        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC      ELC50PD
  9483                                         WS-AH-REM-TERM-CALC      ELC50PD
  9484                                         EC-CO-REM-TERM-CALC      ELC50PD
  9485        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD            ELC50PD
  9486        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP          ELC50PD
  9487        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM          ELC50PD
  9488                                         WS-TOL-AH-CLAIM          ELC50PD
  9489        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM           ELC50PD
  9490                                         WS-TOL-AH-PREM           ELC50PD
  9491                                         EC-CO-TOL-PREM           ELC50PD
  9492        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND         ELC50PD
  9493                                         WS-TOL-AH-REFUND         ELC50PD
  9494                                         EC-CO-TOL-REFUND         ELC50PD
  9495        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 174
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9496                                         WS-AH-REFUND-OVS-AMT     ELC50PD
  9497                                         EC-CO-OVR-SHT-AMT        ELC50PD
  9498        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT       ELC50PD
  9499                                         WS-TOL-AH-PREM-PCT       ELC50PD
  9500                                         EC-CO-TOL-PREM-PCT       ELC50PD
  9501        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT     ELC50PD
  9502                                         WS-TOL-AH-REFUND-PCT     ELC50PD
  9503                                         EC-CO-TOL-REFUND-PCT     ELC50PD
  9504        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT     ELC50PD
  9505                                         WS-AH-REFUND-OVS-PCT     ELC50PD
  9506                                         EC-CO-OVR-SHT-PCT        ELC50PD
  9507        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW         ELC50PD
  9508        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW        ELC50PD
  9509        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS  ELC50PD
  9510        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM        ELC50PD
  9511        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM           ELC50PD
  9512        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM           ELC50PD
  9513        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE            ELC50PD
  9514        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR           ELC50PD
  9515        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG       ELC50PD
  9516        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG        ELC50PD
  9517        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION   ELC50PD
  9518        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END     ELC50PD
  9519                                         EC-CO-MONTH-END-DT       ELC50PD
  9520        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT        ELC50PD
  9521          GO TO 0100-READ-ACCT.                                   ELC50PD
  9522                                                                  ELC50PD
  9523     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
  9524     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
  9525     MOVE '1'                    TO CNTL-REC-TYPE.                ELC50PD
  9526     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
  9527                                                                  ELC50PD
  9528     MOVE '1' TO RC-SW-1.                                         ELC50PD
  9529     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
  9530     IF NOT CF-COMPANY-MASTER                                     ELC50PD
  9531         MOVE ZEROS             TO WK-CO-TOL-PREM                 ELC50PD
  9532                                   WK-CO-TOL-CLAIM                ELC50PD
  9533                                   WK-CO-TOL-REFUND               ELC50PD
  9534                                   WK-REFUND-OVS-AMT              ELC50PD
  9535                                   WK-REFUND-OVS-PCT              ELC50PD
  9536                                   WK-CO-TOL-PREM-PCT             ELC50PD
  9537                                   WK-CO-TOL-REFUND-PCT           ELC50PD
  9538                                   WK-DEFAULT-APR                 ELC50PD
  9539                                   WK-CO-MAX-CAP                  ELC50PD
  9540        MOVE SPACES             TO WK-CR-REM-TERM-CALC            ELC50PD
  9541                                   WK-CR-R78-METHOD               ELC50PD
  9542                                   WK-CO-REF-REJECT-SW            ELC50PD
  9543                                   WK-CO-PREM-REJECT-SW           ELC50PD
  9544                                   WK-REM-TRM-CALC-OPTION         ELC50PD
  9545                                   WK-BIRTH-DATE-INPUT            ELC50PD
  9546                                   WK-JOINT-AGE-INPUT             ELC50PD
  9547        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT              ELC50PD
  9548        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS        ELC50PD
  9549        INITIALIZE    WK-CREDIT-EDIT-CONTROLS                     ELC50PD
  9550        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW        ELC50PD
  9551          GO TO 0099-COMPANY-NOT-FOUND.                           ELC50PD
  9552                                                                  ELC50PD
  9553     IF CF-CO-TOL-PREM-PCT NOT NUMERIC                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 175
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9554        MOVE +0                    TO CF-CO-TOL-PREM-PCT.         ELC50PD
  9555     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC                          ELC50PD
  9556        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.       ELC50PD
  9557     IF CF-CO-TOL-CAP NOT NUMERIC                                 ELC50PD
  9558        MOVE +0                    TO CF-CO-TOL-CAP.              ELC50PD
  9559     IF CF-DEFAULT-APR NOT NUMERIC                                ELC50PD
  9560        MOVE +0                    TO CF-DEFAULT-APR.             ELC50PD
  9561                                                                  ELC50PD
  9562     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.        ELC50PD
  9563     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.           ELC50PD
  9564     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.              ELC50PD
  9565     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.            ELC50PD
  9566     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.             ELC50PD
  9567     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.           ELC50PD
  9568     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.       ELC50PD
  9569     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.         ELC50PD
  9570     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.        ELC50PD
  9571     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.       ELC50PD
  9572     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.    ELC50PD
  9573     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.             ELC50PD
  9574                                                                  ELC50PD
  9575     IF CF-CO-OVR-SHT-AMT NUMERIC AND                             ELC50PD
  9576          CF-CO-OVR-SHT-AMT > +0                                  ELC50PD
  9577        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.            ELC50PD
  9578                                                                  ELC50PD
  9579     IF CF-CO-OVR-SHT-PCT NUMERIC AND                             ELC50PD
  9580          CF-CO-OVR-SHT-PCT > +0                                  ELC50PD
  9581        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.            ELC50PD
  9582                                                                  ELC50PD
  9583     IF CF-VALID-REM-TRM-OPTION                                   ELC50PD
  9584         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION    ELC50PD
  9585     ELSE                                                         ELC50PD
  9586         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.     ELC50PD
  9587                                                                  ELC50PD
  9588     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.        ELC50PD
  9589     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.         ELC50PD
  9590     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.          ELC50PD
  9591     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.    ELC50PD
  9592                                                                  ELC50PD
  9593     GO TO 0050-CHECK-CNTL-FOUND.                                 ELC50PD
  9594                                                                  ELC50PD
  9595 0099-COMPANY-NOT-FOUND.                                          ELC50PD
  9596                                                                  ELC50PD
  9597     MOVE ER-2616                TO WS-ERROR.                     ELC50PD
  9598     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
  9599                                                                  ELC50PD
  9600 0100-READ-ACCT.                                                  ELC50PD
  9601                                                                  ELC50PD
  9602     MOVE SPACES                 TO DATE-RANGE-SW.                ELC50PD
  9603                                                                  ELC50PD
  9604     IF WK-ACCT-ADDR = ZEROS                                      ELC50PD
  9605        GO TO 0102-ACCT-GETMAIN.                                  ELC50PD
  9606                                                                  ELC50PD
  9607     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.               ELC50PD
  9608     SET ERACCT-FILE-ADDRESSED   TO TRUE.                         ELC50PD
  9609     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
  9610                                                                  ELC50PD
  9611     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 176
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9612        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9613        GO TO 0105-READ-ACCT
  9614     END-IF
  9615                                                                  ELC50PD
  9616     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9617        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9618           GO TO 0105-READ-ACCT.                                  ELC50PD
  9619                                                                  ELC50PD
  9620     IF PB-STATE NOT = SPACES                                     ELC50PD
  9621        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9622           GO TO 0105-READ-ACCT.                                  ELC50PD
  9623                                                                  ELC50PD
  9624     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9625        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9626           GO TO 0105-READ-ACCT.                                  ELC50PD
  9627                                                                  ELC50PD
  9628     MOVE 'X'                 TO DATE-RANGE-SW.                   ELC50PD
  9629                                                                  ELC50PD
  9630     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9631        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9632        GO TO 0105-READ-ACCT.                                     ELC50PD
  9633                                                                  ELC50PD
  9634     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9635        GO TO 0105-READ-ACCT.                                     ELC50PD
  9636                                                                  ELC50PD
  9637     GO TO 0180-ACCOUNT-FOUND.                                    ELC50PD
  9638                                                                  ELC50PD
  9639 0102-ACCT-GETMAIN.                                               ELC50PD
  9640     PERFORM 8560-GETMAIN THRU 8560-EXIT.                         ELC50PD
  9641     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.                 ELC50PD
  9642                                                                  ELC50PD
  9643 0105-READ-ACCT.                                                  ELC50PD
  9644     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.                 ELC50PD
  9645     MOVE PB-CARRIER             TO ACCT-CARRIER.                 ELC50PD
  9646     MOVE PB-GROUPING            TO ACCT-GROUPING.                ELC50PD
  9647     MOVE PB-STATE               TO ACCT-STATE.                   ELC50PD
  9648     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.                 ELC50PD
  9649     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.                  ELC50PD
  9650                                                                  ELC50PD
  9651     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.            ELC50PD
  9652                                                                  ELC50PD
  9653     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.         ELC50PD
  9654                                                                  ELC50PD
  9655 0110-FIND-ACCT-TOLERANCES-LOOP.                                  ELC50PD
  9656
  9657     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.             ELC50PD
  9658                                                                  ELC50PD
  9659     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9660        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9661        GO TO 0199-ACCT-NOT-FOUND
  9662     END-IF
  9663     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9664        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9665           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9666                                                                  ELC50PD
  9667     IF PB-STATE NOT = SPACES                                     ELC50PD
  9668        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9669           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 177
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9670                                                                  ELC50PD
  9671     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9672        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9673           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9674                                                                  ELC50PD
  9675     MOVE 'X'                    TO DATE-RANGE-SW.                ELC50PD
  9676                                                                  ELC50PD
  9677     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9678        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9679        GO TO 0199-ACCT-NOT-FOUND.                                ELC50PD
  9680                                                                  ELC50PD
  9681     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9682        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.                     ELC50PD
  9683                                                                  ELC50PD
  9684 0180-ACCOUNT-FOUND.                                              ELC50PD
  9685
  9686     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9687     MOVE AM-CARRIER             TO PB-SV-CARRIER.                ELC50PD
  9688     MOVE AM-STATE               TO PB-SV-STATE.                  ELC50PD
  9689     MOVE AM-GROUPING            TO PB-SV-GROUPING.               ELC50PD
  9690                                                                  ELC50PD
  9691     IF AM-CANCEL-FEE  NOT NUMERIC                                ELC50PD
  9692        MOVE ZEROS TO AM-CANCEL-FEE.                              ELC50PD
  9693                                                                  ELC50PD
  9694     IF AM-MAX-MON-BEN NOT NUMERIC                                ELC50PD
  9695        MOVE ZEROS TO AM-MAX-MON-BEN.                             ELC50PD
  9696                                                                  ELC50PD
  9697     IF AM-MAX-TOT-BEN NOT NUMERIC                                ELC50PD
  9698        MOVE ZEROS TO AM-MAX-TOT-BEN.                             ELC50PD
  9699                                                                  ELC50PD
  9700     IF AM-CLP-TOL-PCT NOT NUMERIC
  9701        MOVE +0                  TO AM-CLP-TOL-PCT
  9702     END-IF
  9703     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9704        MOVE +0                  TO AM-SPP-LEASE-COMM
  9705     END-IF
  9706     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9707        MOVE ER-2611             TO   WS-ERROR                    ELC50PD
  9708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9709                                                                  ELC50PD
  9710     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9711        MOVE ER-2621             TO   WS-ERROR                    ELC50PD
  9712        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9713                                                                  ELC50PD
  9714     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)                      ELC50PD
  9715        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)               ELC50PD
  9716        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)                    ELC50PD
  9717        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)                      ELC50PD
  9718         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.            ELC50PD
  9719                                                                  ELC50PD
  9720     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.         ELC50PD
  9721     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.           ELC50PD
  9722     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.         ELC50PD
  9723     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.           ELC50PD
  9724     IF AM-CLP-TOL-PCT NOT = ZEROS
  9725        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  9726     END-IF
  9727     IF AM-SPP-LEASE-COMM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 178
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9728        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  9729     END-IF
  9730
  9731
  9732
  9733
  9734*    IF PB-COMPANY-ID = 'DCC'
  9735*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  9736*                                   WS-ADMIN-FEES
  9737*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  9738*          (SUB5 > +10)
  9739*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9740*             AND (AM-A-COM (SUB5) NUMERIC)
  9741*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9742*                + (AM-A-COM (SUB5) * 1000)
  9743*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  9744*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  9745*                + (AM-A-COM (SUB5) * 1000)
  9746*             END-IF
  9747*             IF AM-COM-TYP (SUB5) = 'N'
  9748*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  9749*                + (AM-A-COM (SUB5) * 1000)
  9750*             END-IF
  9751*          END-IF
  9752*       END-PERFORM
  9753*    END-IF
  9754
  9755     IF (PB-COMPANY-ID = 'DCC')
  9756        AND (PB-ISSUE)
  9757        MOVE +0                  TO WS-ACCT-ADDL-CLP
  9758        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9759           (SUB5 > +10)
  9760           MOVE +0 TO WS-WK-RATE
  9761           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9762              IF (AM-A-COM (SUB5) NUMERIC)
  9763                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9764                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9765              ELSE
  9766                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  9767                 IF PB-ISSUE
  9768                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9769                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9770                 ELSE
  9771                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9772                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  9773                 END-IF
  9774                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  9775                 MOVE ZEROS             TO WS-SUB1
  9776                                           WS-COMMISSION
  9777                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  9778                 MOVE '0530'               TO CTBL-SW
  9779                 MOVE ' '                  TO WS-CTBL-READ-SW
  9780                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9781                 IF FIRST-TIME-THROUGH
  9782                    MOVE 'AA'              TO CTBL-BEN-CODE
  9783                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9784                 END-IF
  9785                 IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 179
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9786                    IF PB-ISSUE
  9787                       COMPUTE WS-COMM-CK-AMT =
  9788                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9789                    ELSE
  9790                       COMPUTE WS-COMM-CK-AMT =
  9791                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9792                    END-IF
  9793                    PERFORM 8800-GET-COMP-RATE
  9794                              THRU 8800-EXIT
  9795                 END-IF
  9796              END-IF
  9797              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9798                + (WS-WK-RATE * 1000)
  9799           END-IF
  9800        END-PERFORM
  9801     END-IF
  9802
  9803     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
  9804         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.           ELC50PD
  9805                                                                  ELC50PD
  9806     IF PB-COMPANY-ID EQUAL 'NCL'                                 ELC50PD
  9807         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  9808     END-IF
  9809                                                                  ELC50PD
  9810     GO TO 0200-READ-CERT.                                        ELC50PD
  9811                                                                  ELC50PD
  9812 0199-ACCT-NOT-FOUND.                                             ELC50PD
  9813                                                                  ELC50PD
  9814     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9815                                                                  ELC50PD
  9816     IF DATE-RANGE-SW NOT = SPACES                                ELC50PD
  9817        MOVE ER-2601             TO WS-ERROR                      ELC50PD
  9818        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9819     ELSE                                                         ELC50PD
  9820        MOVE ER-2619             TO WS-ERROR                      ELC50PD
  9821        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9822                                                                  ELC50PD
  9823     GO TO 9990-RETURN.                                           ELC50PD
  9824                                                                  ELC50PD
  9825 0200-READ-CERT.                                                  ELC50PD
  9826                                                                  ELC50PD
  9827     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.                 ELC50PD
  9828     MOVE PB-SV-CARRIER          TO CERT-CARRIER.                 ELC50PD
  9829     MOVE PB-SV-GROUPING         TO CERT-GROUPING.                ELC50PD
  9830     MOVE PB-SV-STATE            TO CERT-STATE.                   ELC50PD
  9831     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.                 ELC50PD
  9832     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.                  ELC50PD
  9833     MOVE PB-CERT-NO             TO CERT-CERT-NO.                 ELC50PD
  9834                                                                  ELC50PD
  9835     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.                ELC50PD
  9836                                                                  ELC50PD
  9837     IF CERT-WAS-NOT-FOUND                                        ELC50PD
  9838        GO TO 0299-CERT-NOT-FOUND.                                ELC50PD
  9839                                                                  ELC50PD
  9840     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION            ELC50PD
  9841        MOVE ER-2759             TO WS-ERROR                      ELC50PD
  9842        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9843        GO TO 0298-UNLOCK-RETURN.                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 180
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9844                                                                  ELC50PD
  9845     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION                   ELC50PD
  9846         MOVE ER-2758            TO WS-ERROR                      ELC50PD
  9847         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
  9848         GO TO 0298-UNLOCK-RETURN.                                ELC50PD
  9849                                                                  ELC50PD
  9850     IF PB-ISSUE                                                  ELC50PD
  9851        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')           ELC50PD
  9852           IF CERT-WAS-CREATED-FOR-CLAIM                          ELC50PD
  9853              NEXT SENTENCE                                       ELC50PD
  9854            ELSE                                                  ELC50PD
  9855              MOVE ER-2626       TO WS-ERROR                      ELC50PD
  9856              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
  9857              GO TO 0298-UNLOCK-RETURN.                           ELC50PD
  9858                                                                  ELC50PD
  9859     IF NOT PB-CANCELLATION                                       ELC50PD
  9860        GO TO 0300-CONTINUE-EDIT.                                 ELC50PD
  9861                                                                  ELC50PD
  9862     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.             ELC50PD
  9863     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.              ELC50PD
  9864     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  9865     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.           ELC50PD
  9866     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.           ELC50PD
  9867     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.            ELC50PD
  9868                                                                  ELC50PD
  9869     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.               ELC50PD
  9870     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.         ELC50PD
  9871     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.        ELC50PD
  9872     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.        ELC50PD
  9873     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.    ELC50PD
  9874     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.    ELC50PD
  9875     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.           ELC50PD
  9876     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.           ELC50PD
  9877     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.       ELC50PD
  9878                                                                  ELC50PD
  9879     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.               ELC50PD
  9880     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.         ELC50PD
  9881     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.        ELC50PD
  9882     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.        ELC50PD
  9883     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.           ELC50PD
  9884     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.           ELC50PD
  9885     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.       ELC50PD
  9886                                                                  ELC50PD
  9887     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.            ELC50PD
  9888     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.               ELC50PD
  9889                                                                  ELC50PD
  9890     MOVE CM-CREDIT-INTERFACE-SW-1                                ELC50PD
  9891                                  TO PB-CI-CREDIT-INTERFACE-SW-1. ELC50PD
  9892     MOVE CM-CREDIT-INTERFACE-SW-2                                ELC50PD
  9893                                  TO PB-CI-CREDIT-INTERFACE-SW-2. ELC50PD
  9894                                                                  ELC50PD
  9895     IF CM-O-B-COVERAGE                                           ELC50PD
  9896         MOVE 'B'                 TO PB-CI-OB-FLAG.               ELC50PD
  9897                                                                  ELC50PD
  9898     IF CM-LIVES NOT NUMERIC                                      ELC50PD
  9899         MOVE ZERO                TO CM-LIVES.                    ELC50PD
  9900                                                                  ELC50PD
  9901     IF CM-BILLED NOT NUMERIC                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 181
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9902         MOVE ZERO                TO CM-BILLED.                   ELC50PD
  9903                                                                  ELC50PD
  9904     IF CM-CREDIT-INTERFACE-SW-2 = SPACE                          ELC50PD
  9905         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS      ELC50PD
  9906         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS      ELC50PD
  9907         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT    ELC50PD
  9908         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT    ELC50PD
  9909         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT         ELC50PD
  9910         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.        ELC50PD
  9911         MOVE CM-LIVES             TO PB-CI-LIVES                 ELC50PD
  9912*The next line causes a problem with my change  I dont think it is needed
  9913*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.     ELC50PD
  9914                                                                  ELC50PD
  9915     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.      ELC50PD
  9916     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.      ELC50PD
  9917     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.      ELC50PD
  9918     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.      ELC50PD
  9919     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.         ELC50PD
  9920     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.         ELC50PD
  9921                                                                  ELC50PD
  9922     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.             ELC50PD
  9923     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.             ELC50PD
  9924     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.     ELC50PD
  9925     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.      ELC50PD
  9926                                                                  ELC50PD
  9927     IF CM-LIFE-COMM-PCT NUMERIC                                  ELC50PD
  9928         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION         ELC50PD
  9929     ELSE                                                         ELC50PD
  9930         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.        ELC50PD
  9931                                                                  ELC50PD
  9932     IF CM-AH-COMM-PCT NUMERIC                                    ELC50PD
  9933         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION           ELC50PD
  9934     ELSE                                                         ELC50PD
  9935         MOVE ZEROS              TO PB-CI-AH-COMMISSION.          ELC50PD
  9936                                                                  ELC50PD
  9937     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.         ELC50PD
  9938                                                                  ELC50PD
  9939     IF CM-LOAN-APR       NOT NUMERIC                             ELC50PD
  9940           MOVE ZERO               TO CM-LOAN-APR.                ELC50PD
  9941                                                                  ELC50PD
  9942     IF CM-PAY-FREQUENCY  NOT NUMERIC                             ELC50PD
  9943           MOVE ZERO               TO CM-PAY-FREQUENCY.           ELC50PD
  9944                                                                  ELC50PD
  9945     IF CM-LOAN-TERM      NOT NUMERIC                             ELC50PD
  9946           MOVE ZERO               TO CM-LOAN-TERM.               ELC50PD
  9947                                                                  ELC50PD
  9948     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC                          ELC50PD
  9949           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.         ELC50PD
  9950                                                                  ELC50PD
  9951     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC                        ELC50PD
  9952           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.      ELC50PD
  9953                                                                  ELC50PD
  9954     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.        ELC50PD
  9955     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.             ELC50PD
  9956     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.            ELC50PD
  9957     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.         ELC50PD
  9958     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.       ELC50PD
  9959     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 182
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9960     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.         ELC50PD
  9961     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.      ELC50PD
  9962     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.             ELC50PD
  9963     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.          ELC50PD
  9964     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.         ELC50PD
  9965     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD           ELC50PD
  9966                                                                  ELC50PD
  9967     IF CM-STATE = CM-SSN-STATE                                   ELC50PD
  9968         MOVE SPACES               TO PB-CI-SOC-SEC-NO.           ELC50PD
  9969                                                                  ELC50PD
  9970     IF CM-STATE NOT = CM-MEMB-STATE                              ELC50PD
  9971         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.            ELC50PD
  9972                                                                  ELC50PD
  9973     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.         ELC50PD
  9974                                                                  ELC50PD
  9975     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  9976        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  9977        IF CM-ADDL-CLP NOT NUMERIC
  9978           MOVE +0               TO CM-ADDL-CLP
  9979        END-IF
  9980        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  9981        IF AM-DCC-PRODUCT-CODE = 'DDF'
  9982           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  9983        END-IF
  9984     END-IF
  9985
  9986     IF PB-COMPANY-ID = 'DCC'
  9987        MOVE +0                  TO WS-ADMIN-FEES
  9988                                    WS-CSO-ADMIN-FEE
  9989                                    WS-COMM-AND-MFEE
  9990                                    WS-1ST-YR-ALLOW
  9991        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9992           (SUB5 > +10)
  9993           MOVE +0 TO WS-WK-RATE
  9994           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9995              IF (AM-A-COM (SUB5) NUMERIC)
  9996                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9997                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9998              ELSE
  9999                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
 10000                 IF PB-ISSUE
 10001                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10002                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10003                 ELSE
 10004                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10005                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
 10006                 END-IF
 10007                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10008                 MOVE ZEROS             TO WS-SUB1
 10009                                           WS-COMMISSION
 10010                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
 10011                 MOVE '0530'               TO CTBL-SW
 10012                 MOVE ' '                  TO WS-CTBL-READ-SW
 10013                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10014                 IF FIRST-TIME-THROUGH
 10015                    MOVE 'AA'              TO CTBL-BEN-CODE
 10016                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10017                 END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 183
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10018                 IF CTBL-TABLE-FOUND
 10019                    IF PB-ISSUE
 10020                       COMPUTE WS-COMM-CK-AMT =
 10021                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
 10022                    ELSE
 10023                       COMPUTE WS-COMM-CK-AMT =
 10024                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
 10025                    END-IF
 10026                    PERFORM 8800-GET-COMP-RATE
 10027                              THRU 8800-EXIT
 10028                 END-IF
 10029              END-IF
 10030              IF AM-COM-TYP (SUB5) = 'I'
 10031                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 10032                   + (WS-WK-RATE * 1000)
 10033              END-IF
 10034              IF AM-COM-TYP (SUB5) = 'N'
 10035                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
 10036                   + (WS-WK-RATE * 1000)
 10037              END-IF
 10038              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
 10039                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
 10040                   + (WS-WK-RATE * 1000)
 10041              END-IF
 10042              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
 10043                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 10044                   + (WS-WK-RATE * 1000)
 10045              END-IF
 10046           END-IF
 10047        END-PERFORM
 10048     END-IF
 10049
 10050     GO TO 0300-CONTINUE-EDIT.                                    ELC50PD
 10051                                                                  ELC50PD
 10052 0298-UNLOCK-RETURN.                                              ELC50PD
 10053      PERFORM 9250-UNLOCK-RETURN                                  ELC50PD
 10054      GO TO 9990-RETURN.                                          ELC50PD
 10055                                                                  ELC50PD
 10056 0299-CERT-NOT-FOUND.                                             ELC50PD
 10057                                                                  ELC50PD
 10058     MOVE '1'                     TO CERT-STATUS-SW.              ELC50PD
 10059                                                                  ELC50PD
 10060     IF PB-COMPANY-ID = 'UCL'                                     ELC50PD
 10061         IF WS-ERROR = ER-2799                                    ELC50PD
 10062             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 10063                                                                  ELC50PD
 10064     IF NOT PB-CANCELLATION                                       ELC50PD
 10065         GO TO 0300-CONTINUE-EDIT.                                ELC50PD
 10066                                                                  ELC50PD
 10067     MOVE ER-2726                  TO  WS-ERROR.                  ELC50PD
 10068     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.                ELC50PD
 10069     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.        ELC50PD
 10070     MOVE ZEROS                  TO PB-CI-INSURED-AGE             ELC50PD
 10071                                    PB-CI-LF-TERM                 ELC50PD
 10072                                    PB-C-LF-REM-TERM              ELC50PD
 10073                                    PB-CI-AH-TERM                 ELC50PD
 10074                                    PB-C-AH-REM-TERM              ELC50PD
 10075                                    PB-CI-LF-BENEFIT-CD           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 184
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10076                                    PB-CI-LF-BENEFIT-AMT          ELC50PD
 10077                                    PB-CI-LF-ALT-BENEFIT-AMT      ELC50PD
 10078                                    PB-CI-LF-PREMIUM-AMT          ELC50PD
 10079                                    PB-CI-LF-ALT-PREMIUM-AMT      ELC50PD
 10080                                    PB-CI-AH-BENEFIT-CD           ELC50PD
 10081                                    PB-CI-AH-BENEFIT-AMT          ELC50PD
 10082                                    PB-CI-AH-PREMIUM-AMT          ELC50PD
 10083                                    PB-CI-PAY-FREQUENCY           ELC50PD
 10084                                    PB-CI-LOAN-APR                ELC50PD
 10085                                    PB-CI-LOAN-TERM               ELC50PD
 10086                                    PB-CI-LIFE-COMMISSION         ELC50PD
 10087                                    PB-CI-AH-COMMISSION           ELC50PD
 10088                                    PB-CI-CURR-SEQ                ELC50PD
 10089                                    PB-CI-AH-CANCEL-AMT           ELC50PD
 10090                                    PB-CI-LF-CANCEL-AMT           ELC50PD
 10091                                    PB-CI-RATE-DEV-PCT-LF         ELC50PD
 10092                                    PB-CI-RATE-DEV-PCT-AH         ELC50PD
 10093                                    PB-CI-EXTENTION-DAYS          ELC50PD
 10094                                    PB-CI-TERM-IN-DAYS            ELC50PD
 10095                                    PB-CI-LIVES                   ELC50PD
 10096                                    PB-CI-LF-CRIT-PER             ELC50PD
 10097                                    PB-CI-AH-CRIT-PER
 10098                                    PB-CI-ADDL-CLP
 10099                                    PB-CI-DDF-IU-RATE-UP.
 10100                                                                  ELC50PD
 10101     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT         ELC50PD
 10102                                    PB-CI-AH-SETTLEMENT-DT        ELC50PD
 10103                                    PB-CI-DEATH-DT                ELC50PD
 10104                                    PB-CI-LF-PRIOR-CANCEL-DT      ELC50PD
 10105                                    PB-CI-AH-PRIOR-CANCEL-DT      ELC50PD
 10106                                    PB-CI-ENTRY-DT                ELC50PD
 10107                                    PB-CI-LF-EXPIRE-DT            ELC50PD
 10108                                    PB-CI-AH-EXPIRE-DT            ELC50PD
 10109                                    PB-CI-LOAN-1ST-PMT-DT.        ELC50PD
 10110                                                                  ELC50PD
 10111     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 10112        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT               ELC50PD
 10113        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.              ELC50PD
 10114                                                                  ELC50PD
 10115     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 10116                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 185
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10118                                                                  ELC50PD
 10119 0300-CONTINUE-EDIT.                                              ELC50PD
 10120                                                                  ELC50PD
 10121     IF PB-ISSUE                                                  ELC50PD
 10122        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10123            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.       ELC50PD
 10124                                                                  ELC50PD
 10125     IF PB-ISSUE                                                  ELC50PD
 10126        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10127            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.       ELC50PD
 10128                                                                  ELC50PD
 10129     IF PB-ISSUE                                                  ELC50PD
 10130       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR                     ELC50PD
 10131          (AM-NO-AH-ONLY)                                         ELC50PD
 10132           IF PB-I-AH-BENEFIT-CD NOT = ZEROS                      ELC50PD
 10133               IF PB-I-LIFE-BENEFIT-CD = ZEROS                    ELC50PD
 10134                   MOVE ER-2679 TO WS-ERROR                       ELC50PD
 10135                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 10136                                                                  ELC50PD
 10137     IF PB-ISSUE                                                  ELC50PD
 10138        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD            ELC50PD
 10139        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD            ELC50PD
 10140        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT              ELC50PD
 10141     ELSE                                                         ELC50PD
 10142        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD            ELC50PD
 10143        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD            ELC50PD
 10144        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.             ELC50PD
 10145                                                                  ELC50PD
 10146     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10147                                    PLAN-MASTER-LIFE-SW           ELC50PD
 10148                                    FORM-MASTER-SW                ELC50PD
 10149                                    WS-APP-CERT-SW.               ELC50PD
 10150                                                                  ELC50PD
 10151     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM             ELC50PD
 10152                                    WS-PL-TOL-LF-REFUND           ELC50PD
 10153                                    WS-PL-REF-OVS-AMT             ELC50PD
 10154                                    WS-PL-TOL-LF-PREM-PCT         ELC50PD
 10155                                    WS-PL-TOL-LF-REFUND-PCT       ELC50PD
 10156                                    WS-PL-REF-OVS-PCT             ELC50PD
 10157                                    WS-PL-TOL-LF-CLAIM.           ELC50PD
 10158                                                                  ELC50PD
 10159     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10160       IF PB-ISSUE                                                ELC50PD
 10161         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS          ELC50PD
 10162             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT           ELC50PD
 10163             IF FORM-MASTER-FOUND                                 ELC50PD
 10164                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.       ELC50PD
 10165                                                                  ELC50PD
 10166     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10167        GO TO 0310-FIND-AH-BENEFIT-RECORD.                        ELC50PD
 10168                                                                  ELC50PD
 10169********************** MON CODE **********************            ELC50PD
 10170     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 10171     IF PB-ISSUE                                                  ELC50PD
 10172     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26') ELC50PD
 10173        AND (PB-I-LOAN-APR NOT NUMERIC OR                         ELC50PD
 10174             PB-I-LOAN-APR = ZERO)                                ELC50PD
 10175               MOVE 14.0         TO PB-I-LOAN-APR.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 186
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10176******************************************************            ELC50PD
 10177                                                                  ELC50PD
 10178     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10179       IF PB-ISSUE                                                ELC50PD
 10180           IF FORM-MASTER-FOUND                                   ELC50PD
 10181             IF FO-DISMEMBERMENT-CD = 'Y'  AND                    ELC50PD
 10182                AM-DISMBR-COVERAGE                                ELC50PD
 10183                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD         ELC50PD
 10184                 IF WS-LF-INPUT-CD-1 NOT = 'B'                    ELC50PD
 10185                   MOVE '8'            TO  WS-LF-INPUT-CD-1       ELC50PD
 10186                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD       ELC50PD
 10187                                           PB-I-LIFE-BENEFIT-CD.  ELC50PD
 10188                                                                  ELC50PD
 10189     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10190                                                                  ELC50PD
 10191     IF WK-LIFE-BEN-ADDR NOT = ZEROS                              ELC50PD
 10192         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 10193         SET ELCNTL-FILE-ADDRESSED   TO TRUE                      ELC50PD
 10194         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10195         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT          ELC50PD
 10196         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10197           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10198             GO TO 0301-LIFE-BENEFIT-SEARCH                       ELC50PD
 10199         ELSE                                                     ELC50PD
 10200             NEXT SENTENCE                                        ELC50PD
 10201     ELSE                                                         ELC50PD
 10202         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10203                                                                  ELC50PD
 10204     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10205     MOVE '4'                    TO CNTL-REC-TYPE.                ELC50PD
 10206     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10207     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10208                                                                  ELC50PD
 10209     MOVE '1' TO RC-SW-2.                                         ELC50PD
 10210     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10211                                                                  ELC50PD
 10212     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10213        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10214         GO TO 0305-BENEFIT-NOT-FOUND.                            ELC50PD
 10215                                                                  ELC50PD
 10216     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.             ELC50PD
 10217                                                                  ELC50PD
 10218 0301-LIFE-BENEFIT-SEARCH.                                        ELC50PD
 10219                                                                  ELC50PD
 10220     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10221                                                                  ELC50PD
 10222     IF NO-BENEFIT-FOUND                                          ELC50PD
 10223        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10224                                                                  ELC50PD
 10225     IF WS-BEN-CD = '99'                                          ELC50PD
 10226        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10227                                                                  ELC50PD
 10228     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10229         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10230             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10231                                                                  ELC50PD
 10232     MOVE +1                     TO SUB5.                         ELC50PD
 10233     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 187
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10234                                                                  ELC50PD
 10235* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10236* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10237     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10238         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10239                                                                  ELC50PD
 10240 0302-EDIT-ACCT-LF-BENEFITS.                                      ELC50PD
 10241                                                                  ELC50PD
 10242     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1          ELC50PD
 10243        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)                 ELC50PD
 10244           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10245                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10246           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10247                                                                  ELC50PD
 10248     IF SUB5 LESS THAN +20                                        ELC50PD
 10249        ADD +1                   TO SUB5                          ELC50PD
 10250        GO TO 0302-EDIT-ACCT-LF-BENEFITS.                         ELC50PD
 10251                                                                  ELC50PD
 10252     MOVE +1                     TO SUB5.                         ELC50PD
 10253                                                                  ELC50PD
 10254     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10255        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10256                                                                  ELC50PD
 10257 0303-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10258                                                                  ELC50PD
 10259     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1      ELC50PD
 10260        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)             ELC50PD
 10261           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10262                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10263           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10264                                                                  ELC50PD
 10265     IF SUB5 LESS THAN +30                                        ELC50PD
 10266        ADD +1                   TO SUB5                          ELC50PD
 10267        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10268                                                                  ELC50PD
 10269     MOVE +1                     TO SUB5.                         ELC50PD
 10270                                                                  ELC50PD
 10271 03XX-EDIT-FOR-NINETY-LF.                                         ELC50PD
 10272                                                                  ELC50PD
 10273***************************************************************   ELC50PD
 10274*                                                             *   ELC50PD
 10275*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10276*                                                             *   ELC50PD
 10277*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10278*      92 = ALL GROUP REDUCING BENEFITS                       *   ELC50PD
 10279*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *   ELC50PD
 10280*      94 = ALL GROUP LEVEL BENEFITS                          *   ELC50PD
 10281*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10282*           BENEFIT CONTROLS.                                 *   ELC50PD
 10283*      99 = ALL BENEFITS                                      *   ELC50PD
 10284*                                                             *   ELC50PD
 10285***************************************************************   ELC50PD
 10286                                                                  ELC50PD
 10287     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10288                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10289                                                                  ELC50PD
 10290     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10291       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 188
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10292        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10293        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10294                                                                  ELC50PD
 10295     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')                       ELC50PD
 10296       AND                                                        ELC50PD
 10297        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10298        IF CF-REDUCING (SUB3)                                     ELC50PD
 10299           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10300              OR                                                  ELC50PD
 10301           ((AM-IG = '1') AND                                     ELC50PD
 10302           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10303              OR                                                  ELC50PD
 10304           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10305           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10306           (AM-IG NOT = '2'))                                     ELC50PD
 10307              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10308                                                                  ELC50PD
 10309     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')                       ELC50PD
 10310       AND                                                        ELC50PD
 10311        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10312        IF CF-REDUCING (SUB3)                                     ELC50PD
 10313           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10314              OR                                                  ELC50PD
 10315           ((AM-IG = '2') AND                                     ELC50PD
 10316           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10317              OR                                                  ELC50PD
 10318           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10319           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10320           (AM-IG NOT = '1'))                                     ELC50PD
 10321              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10322                                                                  ELC50PD
 10323     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')                       ELC50PD
 10324       AND                                                        ELC50PD
 10325        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10326        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10327           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10328              OR                                                  ELC50PD
 10329           ((AM-IG = '1') AND                                     ELC50PD
 10330           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10331              OR                                                  ELC50PD
 10332           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10333           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10334            (AM-IG NOT = '2'))                                    ELC50PD
 10335              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10336                                                                  ELC50PD
 10337     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')                       ELC50PD
 10338       AND                                                        ELC50PD
 10339        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10340        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10341           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10342              OR                                                  ELC50PD
 10343           ((AM-IG = '2') AND                                     ELC50PD
 10344           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10345              OR                                                  ELC50PD
 10346           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10347           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10348           (AM-IG NOT = '1'))                                     ELC50PD
 10349              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 189
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10350                                                                  ELC50PD
 10351     IF SUB5 LESS THAN +20                                        ELC50PD
 10352        ADD +1                   TO SUB5                          ELC50PD
 10353        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10354                                                                  ELC50PD
 10355     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10356                                                                  ELC50PD
 10357     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10358        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.                       ELC50PD
 10359                                                                  ELC50PD
 10360     MOVE +1                     TO SUB5.                         ELC50PD
 10361                                                                  ELC50PD
 10362 03XX-EDIT-DMD-EXTRA-NINETY-LF.                                   ELC50PD
 10363                                                                  ELC50PD
 10364     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10365                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10366                                                                  ELC50PD
 10367     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10368       AND                                                        ELC50PD
 10369        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10370        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10371                                                                  ELC50PD
 10372     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')                   ELC50PD
 10373       AND                                                        ELC50PD
 10374        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10375        IF CF-REDUCING (SUB3)                                     ELC50PD
 10376           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10377              OR                                                  ELC50PD
 10378           ((AM-IG = '1') AND                                     ELC50PD
 10379           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10380              OR                                                  ELC50PD
 10381           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10382           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10383           (AM-IG NOT = '2'))                                     ELC50PD
 10384              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10385                                                                  ELC50PD
 10386     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')                   ELC50PD
 10387       AND                                                        ELC50PD
 10388        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10389        IF CF-REDUCING (SUB3)                                     ELC50PD
 10390           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10391              OR                                                  ELC50PD
 10392           ((AM-IG = '2') AND                                     ELC50PD
 10393           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10394              OR                                                  ELC50PD
 10395           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10396           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10397           (AM-IG NOT = '1'))                                     ELC50PD
 10398              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10399                                                                  ELC50PD
 10400     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')                   ELC50PD
 10401       AND                                                        ELC50PD
 10402        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10403        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10404           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10405              OR                                                  ELC50PD
 10406           ((AM-IG = '1') AND                                     ELC50PD
 10407           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 190
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10408              OR                                                  ELC50PD
 10409           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10410           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10411            (AM-IG NOT = '2'))                                    ELC50PD
 10412              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10413                                                                  ELC50PD
 10414     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')                   ELC50PD
 10415       AND                                                        ELC50PD
 10416        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10417        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10418           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10419              OR                                                  ELC50PD
 10420           ((AM-IG = '2') AND                                     ELC50PD
 10421           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10422              OR                                                  ELC50PD
 10423           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10424           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10425           (AM-IG NOT = '1'))                                     ELC50PD
 10426              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10427                                                                  ELC50PD
 10428     IF SUB5 LESS THAN +30                                        ELC50PD
 10429        ADD +1                   TO SUB5                          ELC50PD
 10430        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.                      ELC50PD
 10431                                                                  ELC50PD
 10432     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10433                                                                  ELC50PD
 10434 03XX-EDIT-FOR-NINETY-LF-CONT.                                    ELC50PD
 10435                                                                  ELC50PD
 10436     MOVE +99                    TO SUB5.                         ELC50PD
 10437                                                                  ELC50PD
 10438     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10439        IF PB-ISSUE                                               ELC50PD
 10440           MOVE ER-1924          TO  WS-ERROR                     ELC50PD
 10441           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10442                                                                  ELC50PD
 10443     GO TO 0304-LIFE-BENEFIT-FOUND.                               ELC50PD
 10444                                                                  ELC50PD
 10445 03XX-GET-LIFE-ERPLAN.                                            ELC50PD
 10446                                                                  ELC50PD
 10447     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10448        GO TO 03XX-ERPLAN-LIFE-GETMAIN.                           ELC50PD
 10449                                                                  ELC50PD
 10450     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10451     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10452     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10453     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 10454     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10455                                    PLAN-MASTER-LIFE-SW.          ELC50PD
 10456     GO TO XXXX-CHECK-LF-PLAN-KEY.                                ELC50PD
 10457                                                                  ELC50PD
 10458 03XX-ERPLAN-LIFE-GETMAIN.                                        ELC50PD
 10459                                                                  ELC50PD
 10460     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10461     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10462                                                                  ELC50PD
 10463 03XX-ERPLAN-LIFE-READ.                                           ELC50PD
 10464                                                                  ELC50PD
 10465     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 191
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10466     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10467     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10468     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10469     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10470     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.            ELC50PD
 10471     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10472     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10473                                 TO PLAN-REVISION-NO.             ELC50PD
 10474                                                                  ELC50PD
 10475     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10476     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.          ELC50PD
 10477                                                                  ELC50PD
 10478     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10479       IF NOT LF-PLAN-MASTER-FOUND                                ELC50PD
 10480         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10481            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10482             MOVE  ER-1921         TO  WS-ERROR                   ELC50PD
 10483             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10484             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10485                                                                  ELC50PD
 10486     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 10487        GO TO 0304-LIFE-BENEFIT-FOUND.                            ELC50PD
 10488                                                                  ELC50PD
 10489 XXXX-CHECK-LF-PLAN-KEY.                                          ELC50PD
 10490                                                                  ELC50PD
 10491     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10492        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10493        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10494        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10495        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10496        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR        ELC50PD
 10497        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10498        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10499        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10500          GO TO 03XX-ERPLAN-LIFE-READ.                            ELC50PD
 10501                                                                  ELC50PD
 10502     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.          ELC50PD
 10503                                                                  ELC50PD
 10504     IF  PB-CANCELLATION                                          ELC50PD
 10505         GO TO  0303-LF-ACCT-BEN-FOUND.                           ELC50PD
 10506                                                                  ELC50PD
 10507     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10508        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND        ELC50PD
 10509           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)       ELC50PD
 10510           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO        ELC50PD
 10511              MOVE ER-2644             TO WS-ERROR                ELC50PD
 10512              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10513           ELSE                                                   ELC50PD
 10514              NEXT SENTENCE                                       ELC50PD
 10515        ELSE                                                      ELC50PD
 10516           IF PB-COMPANY-ID NOT = 'NCL'                           ELC50PD
 10517              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS          ELC50PD
 10518                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.    ELC50PD
 10519                                                                  ELC50PD
 10520 0303-LF-ACCT-BEN-FOUND.                                          ELC50PD
 10521                                                                  ELC50PD
 10522     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.             ELC50PD
 10523                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 192
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10524     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10525        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.         ELC50PD
 10526                                                                  ELC50PD
 10527     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10528        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10529        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.           ELC50PD
 10530                                                                  ELC50PD
 10531     IF PL-TOL-PREM-AMT GREATER THAN +0                           ELC50PD
 10532        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.            ELC50PD
 10533                                                                  ELC50PD
 10534     IF PL-TOL-REF-AMT GREATER THAN +0                            ELC50PD
 10535        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.          ELC50PD
 10536                                                                  ELC50PD
 10537     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10538        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.        ELC50PD
 10539                                                                  ELC50PD
 10540     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10541        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.      ELC50PD
 10542                                                                  ELC50PD
 10543     IF PL-TOL-CLM-AMT GREATER THAN +0                            ELC50PD
 10544        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.           ELC50PD
 10545                                                                  ELC50PD
 10546     IF PL-OVER-SHORT-AMT NUMERIC  AND                            ELC50PD
 10547                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10548        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.            ELC50PD
 10549                                                                  ELC50PD
 10550     IF PL-OVER-SHORT-PCT NUMERIC  AND                            ELC50PD
 10551                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10552        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.            ELC50PD
 10553                                                                  ELC50PD
 10554     IF PL-SALES-TAX NUMERIC AND                                  ELC50PD
 10555                          PL-SALES-TAX > +0                       ELC50PD
 10556         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.              ELC50PD
 10557                                                                  ELC50PD
 10558     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10559        MOVE PL-IG               TO WS-IG-OVRD-LF-PL              ELC50PD
 10560                                    WS-IG-OVRD-AM.                ELC50PD
 10561                                                                  ELC50PD
 10562 0304-LIFE-BENEFIT-FOUND.                                         ELC50PD
 10563                                                                  ELC50PD
 10564     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.     ELC50PD
 10565                                                                  ELC50PD
 10566     IF PB-ISSUE                                                  ELC50PD
 10567        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR             ELC50PD
 10568     ELSE                                                         ELC50PD
 10569        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.           ELC50PD
 10570                                                                  ELC50PD
 10571     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.     ELC50PD
 10572     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.   ELC50PD
 10573     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.   ELC50PD
 10574     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.       ELC50PD
 10575     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC      ELC50PD
 10576                                         WS-LF-REFUND-CALC.       ELC50PD
 10577                                                                  ELC50PD
 10578     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10579        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.    ELC50PD
 10580                                                                  ELC50PD
 10581     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 193
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10582        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.  ELC50PD
 10583
 10584     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
 10585                                                                  ELC50PD
 10586     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.  ELC50PD
 10587     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.ELC50PD
 10588     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.     ELC50PD
 10589     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.  ELC50PD
 10590     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.    ELC50PD
 10591     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10592                                                                  ELC50PD
 10593     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10594        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10595         NEXT SENTENCE                                            ELC50PD
 10596     ELSE                                                         ELC50PD
 10597         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10598            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'              ELC50PD
 10599               MOVE WS-SAVE-BENEFIT-REM-TERM                      ELC50PD
 10600                                      TO WS-AM-LF-BENE-REM-TERM   ELC50PD
 10601                                         EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10602                                                                  ELC50PD
 10603     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.        ELC50PD
 10604     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.           ELC50PD
 10605                                                                  ELC50PD
 10606     GO TO 0310-FIND-AH-BENEFIT-RECORD.                           ELC50PD
 10607                                                                  ELC50PD
 10608 0305-BENEFIT-NOT-FOUND.                                          ELC50PD
 10609                                                                  ELC50PD
 10610     MOVE '1'                    TO LF-BENEFIT-ERROR.             ELC50PD
 10611     MOVE ER-2604                TO WS-ERROR.                     ELC50PD
 10612     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 10613                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 194
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10615                                                                  ELC50PD
 10616 0310-FIND-AH-BENEFIT-RECORD.                                     ELC50PD
 10617                                                                  ELC50PD
 10618     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10619                                    PLAN-MASTER-AH-SW.            ELC50PD
 10620                                                                  ELC50PD
 10621     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM             ELC50PD
 10622                                    WS-PL-TOL-AH-REFUND           ELC50PD
 10623                                    WS-AH-PL-REF-OVS-AMT          ELC50PD
 10624                                    WS-PL-TOL-AH-PREM-PCT         ELC50PD
 10625                                    WS-PL-TOL-AH-REFUND-PCT       ELC50PD
 10626                                    WS-AH-PL-REF-OVS-PCT          ELC50PD
 10627                                    WS-PL-TOL-AH-CLAIM.           ELC50PD
 10628     MOVE ' '                    TO WS-AH-DCC-TRUNC
 10629                                                                  ELC50PD
 10630                                                                  ELC50PD
 10631     if pb-issue
 10632        IF PB-I-AH-INPUT-CD EQUAL ZEROS
 10633           MOVE SPACES              TO PB-I-AH-INPUT-CD
 10634        end-if
 10635        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
 10636           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
 10637           GO TO 0399-BENEFIT-NOT-FOUND
 10638        end-if
 10639     end-if
 10640                                                                  ELC50PD
 10641     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10642        GO TO 0400-FIND-CARRIER.                                  ELC50PD
 10643                                                                  ELC50PD
 10644     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10645                                                                  ELC50PD
 10646     IF WK-AH-BEN-ADDR NOT = ZEROS                                ELC50PD
 10647         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 10648         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 10649         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10650         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10651           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10652             GO TO 0311-AH-BENEFIT-SEARCH                         ELC50PD
 10653         ELSE                                                     ELC50PD
 10654             NEXT SENTENCE                                        ELC50PD
 10655     ELSE                                                         ELC50PD
 10656         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10657                                                                  ELC50PD
 10658     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10659     MOVE '5'                    TO CNTL-REC-TYPE.                ELC50PD
 10660     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10661     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10662                                                                  ELC50PD
 10663     MOVE '2' TO RC-SW-2.                                         ELC50PD
 10664     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10665                                                                  ELC50PD
 10666     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10667        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10668          GO TO 0399-BENEFIT-NOT-FOUND.                           ELC50PD
 10669                                                                  ELC50PD
 10670     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.               ELC50PD
 10671                                                                  ELC50PD
 10672 0311-AH-BENEFIT-SEARCH.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 195
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10673                                                                  ELC50PD
 10674     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10675                                                                  ELC50PD
 10676     IF NO-BENEFIT-FOUND                                          ELC50PD
 10677         GO TO 0399-BENEFIT-NOT-FOUND.                            ELC50PD
 10678                                                                  ELC50PD
 10679     IF WS-BEN-CD = '99'                                          ELC50PD
 10680        GO TO 0399-BENEFIT-NOT-FOUND.                             ELC50PD
 10681                                                                  ELC50PD
 10682     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 10683         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10684             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10685                                                                  ELC50PD
 10686     MOVE +1                     TO SUB5.                         ELC50PD
 10687     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10688                                                                  ELC50PD
 10689* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10690* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10691     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10692         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10693                                                                  ELC50PD
 10694 0312-EDIT-ACCT-AH-BENEFITS.                                      ELC50PD
 10695                                                                  ELC50PD
 10696     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1                ELC50PD
 10697        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)                     ELC50PD
 10698           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10699                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10700           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10701                                                                  ELC50PD
 10702     IF SUB5 LESS THAN +20                                        ELC50PD
 10703        ADD +1                   TO SUB5                          ELC50PD
 10704        GO TO 0312-EDIT-ACCT-AH-BENEFITS.                         ELC50PD
 10705                                                                  ELC50PD
 10706     MOVE +1                     TO SUB5.                         ELC50PD
 10707                                                                  ELC50PD
 10708     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10709        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10710                                                                  ELC50PD
 10711 0313-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10712                                                                  ELC50PD
 10713     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1            ELC50PD
 10714        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)                 ELC50PD
 10715           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10716                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10717           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10718                                                                  ELC50PD
 10719     IF SUB5 LESS THAN +30                                        ELC50PD
 10720        ADD +1                   TO SUB5                          ELC50PD
 10721        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10722                                                                  ELC50PD
 10723     MOVE +1                     TO SUB5.                         ELC50PD
 10724                                                                  ELC50PD
 10725 03XX-EDIT-FOR-NINETY-AH.                                         ELC50PD
 10726                                                                  ELC50PD
 10727***************************************************************   ELC50PD
 10728*                                                             *   ELC50PD
 10729*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10730*                                                             *   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 196
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10731*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10732*      92 = ALL GROUP REDUCING BENEFITS.                      *   ELC50PD
 10733*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10734*           BENEFIT CONTROLS.                                 *   ELC50PD
 10735*      99 = ALL BENEFITS.                                     *   ELC50PD
 10736*                                                             *   ELC50PD
 10737***************************************************************   ELC50PD
 10738                                                                  ELC50PD
 10739     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10740                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10741                                                                  ELC50PD
 10742     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10743       AND                                                        ELC50PD
 10744        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10745        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10746                                                                  ELC50PD
 10747     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'                         ELC50PD
 10748       AND                                                        ELC50PD
 10749        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10750           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10751              OR                                                  ELC50PD
 10752           ((AM-IG = '1') AND                                     ELC50PD
 10753           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10754              OR                                                  ELC50PD
 10755           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10756           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10757           (AM-IG NOT = '2'))                                     ELC50PD
 10758              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10759                                                                  ELC50PD
 10760     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'                         ELC50PD
 10761       AND                                                        ELC50PD
 10762        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10763           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10764              OR                                                  ELC50PD
 10765           ((AM-IG = '2') AND                                     ELC50PD
 10766           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10767              OR                                                  ELC50PD
 10768           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10769           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10770           (AM-IG NOT = '1'))                                     ELC50PD
 10771              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10772                                                                  ELC50PD
 10773     IF SUB5 LESS THAN +20                                        ELC50PD
 10774        ADD +1                   TO SUB5                          ELC50PD
 10775        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10776                                                                  ELC50PD
 10777     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10778        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.                       ELC50PD
 10779                                                                  ELC50PD
 10780     MOVE +1                    TO SUB5.                          ELC50PD
 10781                                                                  ELC50PD
 10782 03XX-EDIT-DMD-EXTRA-NINETY-AH.                                   ELC50PD
 10783                                                                  ELC50PD
 10784     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10785                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10786                                                                  ELC50PD
 10787     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10788       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 197
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10789        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10790        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10791                                                                  ELC50PD
 10792     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'                     ELC50PD
 10793       AND                                                        ELC50PD
 10794        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10795           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10796              OR                                                  ELC50PD
 10797           ((AM-IG = '1') AND                                     ELC50PD
 10798           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10799              OR                                                  ELC50PD
 10800           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10801           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10802           (AM-IG NOT = '2'))                                     ELC50PD
 10803              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10804                                                                  ELC50PD
 10805     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'                     ELC50PD
 10806       AND                                                        ELC50PD
 10807        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10808           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10809              OR                                                  ELC50PD
 10810           ((AM-IG = '2') AND                                     ELC50PD
 10811           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10812              OR                                                  ELC50PD
 10813           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10814           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10815           (AM-IG NOT = '1'))                                     ELC50PD
 10816              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10817                                                                  ELC50PD
 10818     IF SUB5 LESS THAN +30                                        ELC50PD
 10819        ADD +1                   TO SUB5                          ELC50PD
 10820        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.                      ELC50PD
 10821                                                                  ELC50PD
 10822 03XX-EDIT-FOR-NINETY-AH-CONT.                                    ELC50PD
 10823                                                                  ELC50PD
 10824     MOVE +99                    TO SUB5.                         ELC50PD
 10825                                                                  ELC50PD
 10826     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10827                                                                  ELC50PD
 10828     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10829        IF PB-ISSUE                                               ELC50PD
 10830           MOVE ER-1925          TO  WS-ERROR                     ELC50PD
 10831           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10832                                                                  ELC50PD
 10833     GO TO 0314-A-H-BENEFIT-FOUND.                                ELC50PD
 10834                                                                  ELC50PD
 10835 03XX-GET-AH-ERPLAN.                                              ELC50PD
 10836                                                                  ELC50PD
 10837     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10838         GO TO 03XX-ERPLAN-AH-GETMAIN.                            ELC50PD
 10839                                                                  ELC50PD
 10840     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10841     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10842     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10843     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 10844     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10845                                    PLAN-MASTER-AH-SW.            ELC50PD
 10846*****GO TO XXXX-CHECK-AH-PLAN-KEY.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 198
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10847     GO TO 03XX-ERPLAN-AH-READ.                                   ELC50PD
 10848                                                                  ELC50PD
 10849 03XX-ERPLAN-AH-GETMAIN.                                          ELC50PD
 10850                                                                  ELC50PD
 10851     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10852     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10853                                                                  ELC50PD
 10854 03XX-ERPLAN-AH-READ.                                             ELC50PD
 10855                                                                  ELC50PD
 10856     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10857     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10858     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10859     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10860     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10861     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.            ELC50PD
 10862     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10863     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10864                                 TO PLAN-REVISION-NO.             ELC50PD
 10865                                                                  ELC50PD
 10866     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10867     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.            ELC50PD
 10868                                                                  ELC50PD
 10869     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10870       IF NOT AH-PLAN-MASTER-FOUND                                ELC50PD
 10871         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10872            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10873             MOVE  ER-1922         TO  WS-ERROR                   ELC50PD
 10874             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10875             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10876                                                                  ELC50PD
 10877     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 10878        GO TO 0314-A-H-BENEFIT-FOUND.                             ELC50PD
 10879                                                                  ELC50PD
 10880 XXXX-CHECK-AH-PLAN-KEY.                                          ELC50PD
 10881                                                                  ELC50PD
 10882     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10883        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10884        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10885        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10886        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10887        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR          ELC50PD
 10888        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10889        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10890        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10891          GO TO 03XX-ERPLAN-AH-READ.                              ELC50PD
 10892                                                                  ELC50PD
 10893     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.            ELC50PD
 10894                                                                  ELC50PD
 10895     IF  PB-CANCELLATION                                          ELC50PD
 10896         GO TO  0313-AH-ACCT-BEN-FOUND.                           ELC50PD
 10897                                                                  ELC50PD
 10898     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10899       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND         ELC50PD
 10900          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)        ELC50PD
 10901          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO         ELC50PD
 10902             MOVE ER-2644             TO WS-ERROR                 ELC50PD
 10903             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 10904          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 199
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10905             NEXT SENTENCE                                        ELC50PD
 10906       ELSE                                                       ELC50PD
 10907          IF PB-COMPANY-ID NOT = 'NCL'                            ELC50PD
 10908             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS           ELC50PD
 10909                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.     ELC50PD
 10910                                                                  ELC50PD
 10911 0313-AH-ACCT-BEN-FOUND.                                          ELC50PD
 10912                                                                  ELC50PD
 10913     MOVE PL-REVISION-NO         TO WS-AH-REVISION.               ELC50PD
 10914                                                                  ELC50PD
 10915     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10916        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.         ELC50PD
 10917                                                                  ELC50PD
 10918     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10919        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10920        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.           ELC50PD
 10921                                                                  ELC50PD
 10922     IF PL-TOL-PREM-AMT NOT EQUAL +0                              ELC50PD
 10923        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.            ELC50PD
 10924                                                                  ELC50PD
 10925     IF PL-TOL-REF-AMT NOT EQUAL +0                               ELC50PD
 10926        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.          ELC50PD
 10927                                                                  ELC50PD
 10928     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10929        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.        ELC50PD
 10930                                                                  ELC50PD
 10931     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10932        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.      ELC50PD
 10933                                                                  ELC50PD
 10934     IF PL-TOL-CLM-AMT NOT EQUAL +0                               ELC50PD
 10935        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.           ELC50PD
 10936                                                                  ELC50PD
 10937     IF PL-OVER-SHORT-AMT NUMERIC AND                             ELC50PD
 10938                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10939        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.         ELC50PD
 10940                                                                  ELC50PD
 10941     IF PL-OVER-SHORT-PCT NUMERIC AND                             ELC50PD
 10942                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10943        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.           ELC50PD
 10944                                                                  ELC50PD
 10945     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10946        MOVE PL-IG               TO WS-IG-OVRD-AH-PL              ELC50PD
 10947        IF WS-IG-OVRD-AM EQUAL SPACES                             ELC50PD
 10948            MOVE PL-IG           TO WS-IG-OVRD-AM.                ELC50PD
 10949                                                                  ELC50PD
 10950 0314-A-H-BENEFIT-FOUND.                                          ELC50PD
 10951                                                                  ELC50PD
 10952     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.     ELC50PD
 10953                                                                  ELC50PD
 10954     IF PB-ISSUE                                                  ELC50PD
 10955        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR             ELC50PD
 10956       ELSE                                                       ELC50PD
 10957        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.           ELC50PD
 10958                                                                  ELC50PD
 10959     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.   ELC50PD
 10960     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.   ELC50PD
 10961     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.       ELC50PD
 10962     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 200
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10963                                         WS-AH-REFUND-CALC.       ELC50PD
 10964                                                                  ELC50PD
 10965     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10966        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.    ELC50PD
 10967                                                                  ELC50PD
 10968     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 10969        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.  ELC50PD
 10970
 10971     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
 10972                                                                  ELC50PD
 10973     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.  ELC50PD
 10974     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.ELC50PD
 10975     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.     ELC50PD
 10976     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.  ELC50PD
 10977     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.    ELC50PD
 10978     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.  ELC50PD
 10979                                                                  ELC50PD
 10980     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10981        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10982         NEXT SENTENCE                                            ELC50PD
 10983     ELSE                                                         ELC50PD
 10984         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10985            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'             ELC50PD
 10986                MOVE WS-SAVE-BENEFIT-REM-TERM                     ELC50PD
 10987                                      TO WS-AM-AH-BENE-REM-TERM   ELC50PD
 10988                                         EC-BR-AH-REM-TERM-CALC.  ELC50PD
 10989                                                                  ELC50PD
 10990     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.        ELC50PD
 10991     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.           ELC50PD
 10992                                                                  ELC50PD
 10993     GO TO 0400-FIND-CARRIER.                                     ELC50PD
 10994                                                                  ELC50PD
 10995 0399-BENEFIT-NOT-FOUND.                                          ELC50PD
 10996                                                                  ELC50PD
 10997     MOVE '1'                    TO AH-BENEFIT-ERROR.             ELC50PD
 10998     MOVE ER-2605                TO WS-ERROR.                     ELC50PD
 10999     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11000                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 201
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11002                                                                  ELC50PD
 11003 0400-FIND-CARRIER.                                               ELC50PD
 11004                                                                  ELC50PD
 11005     MOVE PB-SV-CARRIER          TO WS-CARR.                      ELC50PD
 11006                                                                  ELC50PD
 11007     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11008     MOVE ZEROS                  TO CNTL-SEQ-NO.                  ELC50PD
 11009     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  ELC50PD
 11010     MOVE '6'                    TO CNTL-REC-TYPE.                ELC50PD
 11011                                                                  ELC50PD
 11012*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD                   ELC50PD
 11013     MOVE SPACE                  TO WS-DMD-RATING-SW              ELC50PD
 11014                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11015                                                                  ELC50PD
 11016     MOVE '2'                    TO RC-SW-1.                      ELC50PD
 11017     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
 11018                                                                  ELC50PD
 11019     IF NOT CF-CARRIER-MASTER                                     ELC50PD
 11020        GO TO 0400-CARRIER-NOT-FOUND.                             ELC50PD
 11021                                                                  ELC50PD
 11022 0400-BUILD-CARR-TOL.                                             ELC50PD
 11023                                                                  ELC50PD
 11024     IF CF-CR-TOL-PREM NUMERIC AND                                ELC50PD
 11025        CF-CR-TOL-PREM GREATER THAN +0                            ELC50PD
 11026        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11027                                    WS-TOL-AH-PREM.               ELC50PD
 11028                                                                  ELC50PD
 11029     IF CF-CR-TOL-REFUND NUMERIC AND                              ELC50PD
 11030        CF-CR-TOL-REFUND GREATER THAN +0                          ELC50PD
 11031        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND              ELC50PD
 11032                                    WS-TOL-AH-REFUND.             ELC50PD
 11033                                                                  ELC50PD
 11034     IF CF-CR-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11035        CF-CR-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11036        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11037                                    WS-AH-REFUND-OVS-AMT.         ELC50PD
 11038                                                                  ELC50PD
 11039     IF CF-CR-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11040        CF-CR-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11041        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11042                                    WS-AH-REFUND-OVS-PCT.         ELC50PD
 11043                                                                  ELC50PD
 11044     IF CF-CR-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11045        CF-CR-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11046        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT            ELC50PD
 11047                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11048                                                                  ELC50PD
 11049     IF CF-CR-TOL-REFUND-PCT NUMERIC AND                          ELC50PD
 11050        CF-CR-TOL-REFUND-PCT GREATER THAN +0                      ELC50PD
 11051        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT         ELC50PD
 11052                                     WS-TOL-AH-REFUND-PCT.        ELC50PD
 11053                                                                  ELC50PD
 11054     IF CF-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 11055         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW              ELC50PD
 11056                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11057                                                                  ELC50PD
 11058     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
 11059     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 202
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11060        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
 11061     END-IF
 11062     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
 11063        MOVE +0                  TO CF-CARRIER-LEASE-COMM
 11064     END-IF
 11065     IF WS-TOL-CLP-PCT = ZEROS
 11066        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
 11067     END-IF
 11068
 11069     IF WS-SPP-LEASE-COMM = ZEROS
 11070        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
 11071     END-IF
 11072
 11073     GO TO 0400-FIND-ERPDEF.
 11074                                                                  ELC50PD
 11075 0400-CARRIER-NOT-FOUND.                                          ELC50PD
 11076                                                                  ELC50PD
 11077     MOVE ER-2602                TO WS-ERROR.                     ELC50PD
 11078     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11079                                                                  ELC50PD
 11080 0400-FIND-ERPDEF.
 11081
 11082     IF PB-COMPANY-ID = 'DCC'
 11083        AND AM-DCC-PRODUCT-CODE = 'DDF'
 11084        CONTINUE
 11085     ELSE
 11086        GO TO 0400-FIND-ERCOMP
 11087     END-IF
 11088
 11089     MOVE ' '                    TO PDEF-MASTER-SW
 11090     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
 11091     MOVE PB-STATE               TO ERPDEF-STATE
 11092     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
 11093     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 11094     IF PB-ISSUE
 11095        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
 11096     ELSE
 11097        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 11098     END-IF
 11099     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
 11100     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 11101     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
 11102     IF PDEF-MASTER-FOUND
 11103        MOVE 'N'                 TO PDEF-MASTER-SW
 11104        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11105        IF PDEF-MASTER-FOUND
 11106           IF (ERPDEF-KEY-SAVE (1:16) =
 11107                        PD-CONTROL-PRIMARY (1:16))
 11108              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11109              CONTINUE
 11110           ELSE
 11111              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11112              IF (ERPDEF-KEY-SAVE (1:16) =
 11113                        PD-CONTROL-PRIMARY (1:16))
 11114                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11115                 CONTINUE
 11116              ELSE
 11117                 MOVE 'N'        TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 203
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11118              END-IF
 11119           END-IF
 11120        END-IF
 11121        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 11122     END-IF
 11123     IF PDEF-MASTER-FOUND
 11124        IF PD-TRUNCATED = 'Y'
 11125           MOVE 'T'              TO WS-AH-DCC-TRUNC
 11126        END-IF
 11127     END-IF
 11128
 11129     .
 11130 0400-FIND-ERCOMP.
 11131
 11132     IF PB-COMPANY-ID = 'DCC'
 11133        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11134           (WS-SUB1 > +10)
 11135           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
 11136                 OR 'A' OR 'N'
 11137              MOVE PB-COMPANY-CD TO COMP-COMP-CD
 11138              MOVE PB-CARRIER    TO COMP-CARRIER
 11139              MOVE PB-GROUPING   TO COMP-GROUPING
 11140              MOVE LOW-VALUES    TO COMP-ACCOUNT
 11141              MOVE AM-AGT (WS-SUB1)
 11142                                 TO COMP-FIN-RESP
 11143              MOVE 'G'           TO COMP-TYPE
 11144              PERFORM 8582-READ-COMPENSATION-MASTER
 11145                                 THRU 8582-EXIT
 11146              IF COMP-MASTER-FOUND
 11147                 IF CO-GA-INACTIVE
 11148                    MOVE ER-2763 TO WS-ERROR
 11149                    PERFORM 9900-ERROR-FORMAT
 11150                                 THRU 9900-EXIT
 11151                    MOVE +11     TO WS-SUB1
 11152                 END-IF
 11153                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11154                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11155                    MOVE ER-2788 TO WS-ERROR
 11156                    PERFORM 9900-ERROR-FORMAT
 11157                                 THRU 9900-EXIT
 11158                    MOVE +11     TO WS-SUB1
 11159                 END-IF
 11160              END-IF
 11161           END-IF
 11162        END-PERFORM
 11163     END-IF
 11164
 11165     IF PB-COMPANY-ID = 'DCC'
 11166        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
 11167           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
 11168                                    WS-CLP-STATE
 11169        ELSE
 11170           MOVE SPACES           TO PB-I-CLP-STATE
 11171                                    WS-CLP-STATE
 11172        END-IF
 11173     END-IF
 11174
 11175     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 204
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11176        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
 11177        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 11178        CONTINUE
 11179     ELSE
 11180        GO TO 0400-FIND-STATE-RECORD
 11181     END-IF
 11182
 11183     MOVE SPACES                 TO WS-CLP-STATE
 11184     MOVE +0                     TO WS-BANK-FEE
 11185                                    WS-BANK-LFEE
 11186                                    WS-BANK-NOCHRGB
 11187
 11188     MOVE LOW-VALUES             TO COMP-FIN-RESP
 11189
 11190     IF (PB-ISSUE)
 11191        AND (PB-I-BANK-NUMBER NOT =
 11192            SPACES AND ZEROS AND LOW-VALUES)
 11193        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
 11194     ELSE
 11195        IF (PB-CANCELLATION)
 11196           AND (PB-CI-BANK-NUMBER NOT =
 11197                SPACES AND ZEROS AND LOW-VALUES)
 11198           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
 11199        END-IF
 11200     END-IF
 11201
 11202     IF COMP-FIN-RESP NOT = LOW-VALUES
 11203        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
 11204        MOVE PB-CARRIER          TO COMP-CARRIER
 11205        MOVE PB-GROUPING         TO COMP-GROUPING
 11206        MOVE LOW-VALUES          TO COMP-ACCOUNT
 11207        MOVE 'B'                 TO COMP-TYPE
 11208        PERFORM 8582-READ-COMPENSATION-MASTER
 11209                                 THRU 8582-EXIT
 11210        IF COMP-MASTER-FOUND
 11211           IF CO-MAX-BANK-FEE NOT NUMERIC
 11212              MOVE +0            TO CO-MAX-BANK-FEE
 11213           END-IF
 11214           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
 11215              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
 11216           END-IF
 11217           IF CO-GA-INACTIVE
 11218              MOVE ER-2763       TO WS-ERROR
 11219              PERFORM 9900-ERROR-FORMAT
 11220                                 THRU 9900-EXIT
 11221           END-IF
 11222           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11223              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11224              MOVE ER-2788 TO WS-ERROR
 11225              PERFORM 9900-ERROR-FORMAT
 11226                                 THRU 9900-EXIT
 11227              MOVE +11     TO WS-SUB1
 11228           END-IF
 11229           IF WS-AH-BEN-CATEGORY = 'G'
 11230              MOVE CO-MAX-BANK-FEE
 11231                                 TO WS-BANK-FEE
 11232                                    PB-I-BANK-FEE
 11233           ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 205
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11234              MOVE CO-MAX-BANK-FEE-LEASE
 11235                                 TO WS-BANK-LFEE
 11236                                    PB-I-BANK-FEE
 11237           END-IF
 11238           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
 11239              AND (WS-AH-REFUND-CALC = 'G'))
 11240                        OR
 11241              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
 11242              AND (WS-AH-REFUND-CALC NOT = 'G'))
 11243              CONTINUE
 11244           ELSE
 11245              MOVE ER-2789 TO WS-ERROR
 11246              PERFORM 9900-ERROR-FORMAT
 11247                                 THRU 9900-EXIT
 11248           END-IF
 11249           MOVE CO-CLP-STATE     TO WS-CLP-STATE
 11250                                    PB-I-CLP-STATE
 11251           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
 11252           MOVE CO-CARRIER       TO BXRF-CARRIER
 11253           MOVE CO-GROUPING      TO BXRF-GROUPING
 11254           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
 11255           MOVE BXRF-MAX-REC-LENGTH
 11256                                 TO BXRF-REC-LENGTH
 11257           PERFORM 8584-READ-BANK-CROSS-REF
 11258                                 THRU 8584-EXIT
 11259           IF BXRF-MASTER-FOUND
 11260              MOVE ' '           TO BANK-ACCT-SW
 11261              MOVE BK-BANK-POINTER-CNT
 11262                                 TO BK-BANK-POINTER-CNT
 11263              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11264                 (WS-SUB1 > BK-BANK-POINTER-CNT)
 11265                 OR (BANK-ACCT-FOUND)
 11266                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
 11267                    AND (BK-AM-EXP-DT (WS-SUB1)
 11268                                 > PB-CERT-EFF-DT)
 11269                    AND (BK-AM-EFF-DT (WS-SUB1)
 11270                                 NOT > PB-CERT-EFF-DT)
 11271                    SET BANK-ACCT-FOUND TO TRUE
 11272                 END-IF
 11273              END-PERFORM
 11274              IF NOT BANK-ACCT-FOUND
 11275                 MOVE ZEROS      TO WS-BANK-FEE
 11276                                    WS-BANK-LFEE
 11277                 MOVE ER-2869    TO WS-ERROR
 11278                 PERFORM 9900-ERROR-FORMAT
 11279                                 THRU 9900-EXIT
 11280              ELSE
 11281                 PERFORM 5000-PROCESS-REPS
 11282                                 THRU 5000-EXIT
 11283                 IF AGENT-MASTER-FOUND
 11284                    MOVE +0      TO WS-BANK-FEE
 11285                                    WS-BANK-LFEE
 11286*                   MOVE AG-SPP-FEES (1)
 11287*                                TO PB-I-BANK-FEE
 11288*                                   WS-BANK-FEE
 11289                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11290                       (WS-SUB1 > +10)
 11291                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 206
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11292                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
 11293                       END-IF
 11294                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
 11295                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
 11296                       END-IF
 11297                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
 11298                          AG-SPP-FEES (WS-SUB1)
 11299                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
 11300                          AG-SPP-LFEES (WS-SUB1)
 11301                    END-PERFORM
 11302                    IF WS-AH-BEN-CATEGORY = 'G'
 11303                       MOVE WS-BANK-FEE
 11304                                 TO PB-I-BANK-FEE
 11305                    ELSE
 11306                       MOVE WS-BANK-LFEE
 11307                                 TO PB-I-BANK-FEE
 11308                    END-IF
 11309                 END-IF
 11310              END-IF
 11311           END-IF
 11312        ELSE
 11313           MOVE ER-2879          TO WS-ERROR
 11314           PERFORM 9900-ERROR-FORMAT
 11315                                 THRU 9900-EXIT
 11316        END-IF
 11317     ELSE
 11318        MOVE ER-2879             TO WS-ERROR
 11319        PERFORM 9900-ERROR-FORMAT
 11320                                 THRU 9900-EXIT
 11321     END-IF
 11322
 11323     IF WS-AH-BEN-CATEGORY = 'G'
 11324        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11325        + WS-BANK-FEE
 11326     ELSE
 11327        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11328        + WS-BANK-LFEE
 11329     END-IF
 11330
 11331     .
 11332 0400-FIND-STATE-RECORD.                                          ELC50PD
 11333                                                                  ELC50PD
 11334     IF WK-STATE-ADDR NOT = ZEROS                                 ELC50PD
 11335         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP                ELC50PD
 11336         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 11337         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 11338         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT           CL**2
 11339         IF PB-SV-STATE = CF-STATE-CODE                           ELC50PD
 11340             GO TO 0405-CONTINUE-EDIT                             ELC50PD
 11341         ELSE                                                     ELC50PD
 11342             NEXT SENTENCE                                        ELC50PD
 11343     ELSE                                                         ELC50PD
 11344         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 11345                                                                  ELC50PD
 11346     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11347     MOVE PB-SV-STATE            TO CNTL-ACCESS.                  ELC50PD
 11348     MOVE '3'                    TO CNTL-REC-TYPE.                ELC50PD
 11349     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 207
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11350                                                                  ELC50PD
 11351     MOVE '3'                    TO RC-SW-2.                      ELC50PD
 11352     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 11353                                                                  ELC50PD
 11354     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR                    ELC50PD
 11355        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR                     ELC50PD
 11356        PB-SV-STATE   NOT = CF-STATE-CODE)                        ELC50PD
 11357        MOVE ZEROS               TO WS-TOL-LF-CLAIM               ELC50PD
 11358                                    WS-TOL-AH-CLAIM               ELC50PD
 11359                                    WS-MINIMUM-REFUND             ELC50PD
 11360                                    WS-TOL-LF-PREM                ELC50PD
 11361                                    WS-TOL-AH-PREM                ELC50PD
 11362                                    WS-TOL-LF-REFUND              ELC50PD
 11363                                    WS-TOL-AH-REFUND              ELC50PD
 11364                                    EC-ST-TOL-PREM-PCT            ELC50PD
 11365                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11366                                    WS-TOL-AH-PREM-PCT            ELC50PD
 11367                                    EC-ST-TOL-REFUND-PCT          ELC50PD
 11368                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11369                                    WS-TOL-AH-REFUND-PCT          ELC50PD
 11370                                    EC-ST-TOL-PREM                ELC50PD
 11371                                    EC-ST-TOL-REFUND              ELC50PD
 11372                                    EC-ST-FST-PMT-DAYS-MAX        ELC50PD
 11373                                    WS-FREE-LOOK-PERIOD           ELC50PD
 11374                                    WS-ST-LF-PREM-TAX
 11375                                    WS-ST-AH-PREM-TAX-I
 11376                                    WS-ST-AH-PREM-TAX-G
 11377                                    WS-BANK-FEE
 11378                                    WS-BANK-LFEE
 11379                                    WS-TOL-CLP-PCT
 11380                                    WS-SPP-LEASE-COMM
 11381        MOVE SPACES              TO WS-STATE-ABBREVIATION         ELC50PD
 11382                                    EC-ST-FST-PMT-DAYS-CHG        ELC50PD
 11383                                    WS-LF-REM-TERM-CALC           ELC50PD
 11384                                    WS-LF-REFUND-CALC             ELC50PD
 11385                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11386                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11387                                    WS-AH-REM-TERM-CALC           ELC50PD
 11388                                    WS-AH-REFUND-CALC
 11389                                    WS-LF-BEN-CATEGORY
 11390                                    WS-AH-BEN-CATEGORY
 11391                                    WS-CLP-STATE
 11392                                    WS-ST-REFUND-CLAIM-FLAG
 11393                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11394                                    EC-ST-AH-REFUND-CALC          ELC50PD
 11395          GO TO 0499-STATE-NOT-FOUND.                             ELC50PD
 11396                                                                  ELC50PD
 11397     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.                ELC50PD
 11398                                                                  ELC50PD
 11399 0405-CONTINUE-EDIT.                                              ELC50PD
 11400
 11401     if pb-company-id = 'AHL'
 11402        continue
 11403     else
 11404        IF PB-CERT-PRIME NOT NUMERIC
 11405           MOVE ER-2722          TO WS-ERROR
 11406           PERFORM 9900-ERROR-FORMAT
 11407                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 208
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11408        end-if
 11409     END-IF
 11410
 11411*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11412*       MOVE +0                  TO SUB3
 11413*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
 11414*       IF SUB3 > +0
 11415*          MOVE ER-2722          TO WS-ERROR
 11416*          PERFORM 9900-ERROR-FORMAT
 11417*                                THRU 9900-EXIT
 11418*       END-IF
 11419*    END-IF
 11420
 11421
 11422*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11423*       IF PB-CERT-PRIME NOT NUMERIC
 11424*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
 11425*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
 11426*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
 11427*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
 11428*
 11429*          MOVE ER-2722          TO WS-ERROR
 11430*          PERFORM 9900-ERROR-FORMAT
 11431*                                THRU 9900-EXIT
 11432*       END-IF
 11433*    END-IF
 11434
 11435     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.        ELC50PD
 11436                                                                  ELC50PD
 11437     IF CF-ST-TOL-CLAIM NOT = ZEROS                               ELC50PD
 11438        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM               ELC50PD
 11439                                    WS-TOL-AH-CLAIM.              ELC50PD
 11440                                                                  ELC50PD
 11441     IF CF-ST-REFUND-MIN NOT NUMERIC                              ELC50PD
 11442        MOVE ZEROS               TO CF-ST-REFUND-MIN.             ELC50PD
 11443                                                                  ELC50PD
 11444     IF CF-ST-REFUND-MIN NOT = ZEROS                              ELC50PD
 11445        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.            ELC50PD
 11446                                                                  ELC50PD
 11447     IF CF-ST-TOL-PREM  NOT = ZEROS                               ELC50PD
 11448        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11449                                    WS-TOL-AH-PREM                ELC50PD
 11450        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.           ELC50PD
 11451                                                                  ELC50PD
 11452     IF CF-ST-TOL-REFUND NOT = ZEROS                              ELC50PD
 11453        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND              ELC50PD
 11454                                    WS-TOL-AH-REFUND              ELC50PD
 11455        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.             ELC50PD
 11456                                                                  ELC50PD
 11457     IF CF-ST-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11458        CF-ST-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11459        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11460                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11461                                    EC-ST-OVR-SHT-AMT.            ELC50PD
 11462                                                                  ELC50PD
 11463     IF CF-ST-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11464        CF-ST-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11465        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 209
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11466                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11467                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11468                                                                  ELC50PD
 11469     IF CF-ST-TOL-REF-PCT NUMERIC AND                             ELC50PD
 11470        CF-ST-TOL-REF-PCT GREATER THAN +0                         ELC50PD
 11471        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT          ELC50PD
 11472                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11473                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11474                                                                  ELC50PD
 11475     IF CF-ST-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11476        CF-ST-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11477        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11478                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11479                                    EC-ST-OVR-SHT-PCT.            ELC50PD
 11480                                                                  ELC50PD
 11481     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.               ELC50PD
 11482     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.             ELC50PD
 11483                                                                  ELC50PD
 11484     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC                        ELC50PD
 11485          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11486                                                                  ELC50PD
 11487     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11488     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.       ELC50PD
 11489
 11490     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.          ELC50PD
 11491                                                                  ELC50PD
 11492     IF CF-ST-LF-PREM-TAX NUMERIC
 11493        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11494     END-IF
 11495     IF CF-ST-AH-PREM-TAX-I NUMERIC
 11496        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11497     END-IF
 11498     IF CF-ST-AH-PREM-TAX-G NUMERIC
 11499        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11500     END-IF
 11501
 11502     IF CF-ST-REF-AH-DEATH-IND > SPACES
 11503         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 11504     END-IF.
 11505
 11506     IF WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 11507        GO TO 0410-CHECK-AH.                                      ELC50PD
 11508                                                                  ELC50PD
 11509     IF CF-ST-RT-CALC NOT = SPACES
 11510        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11511                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11512     END-IF
 11513
 11514     IF WS-LF-COVERAGE-TYPE = 'R'
 11515        IF WS-LF-EARNINGS-CALC = '5'
 11516           IF CF-ST-RF-LN-CALC > '0'
 11517              MOVE CF-ST-RF-LN-CALC
 11518                                 TO WS-LF-REFUND-CALC
 11519                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11520           END-IF
 11521        ELSE
 11522           IF CF-ST-RF-LR-CALC > '0'
 11523              MOVE CF-ST-RF-LR-CALC
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 210
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11524                                 TO WS-LF-REFUND-CALC
 11525                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11526           END-IF
 11527        END-IF
 11528     ELSE
 11529        IF CF-ST-RF-LL-CALC > '0'
 11530           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 11531                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11532        END-IF
 11533     END-IF
 11534
 11535     IF CF-ST-RT-CALC NOT = SPACES
 11536        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11537                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11538     END-IF
 11539
 11540     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11541     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.               ELC50PD
 11542                                                                  ELC50PD
 11543     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11544                                                                  ELC50PD
 11545     IF NO-BENEFIT-FOUND                                          ELC50PD
 11546        GO TO 0410-CHECK-AH.                                      ELC50PD
 11547                                                                  ELC50PD
 11548     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11549        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 11550                                 TO EC-ST-LF-REM-TERM-CALC
 11551                                    WS-LF-REM-TERM-CALC           ELC50PD
 11552     END-IF
 11553                                                                  ELC50PD
 11554     IF CF-ST-REFUND-CALC (SUB3) > '0'                            ELC50PD
 11555        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11556                                 TO WS-LF-REFUND-CALC             ELC50PD
 11557                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11558     END-IF
 11559*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.  ELC50PD
 11560                                                                  ELC50PD
 11561     .                                                            ELC50PD
 11562 0410-CHECK-AH.                                                   ELC50PD
 11563                                                                  ELC50PD
 11564     IF WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 11565        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11566                                                                  ELC50PD
 11567     IF CF-ST-RT-CALC NOT = SPACES
 11568        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 11569                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11570     END-IF
 11571
 11572     IF WS-AH-SPECIAL-CALC-CD = 'C'
 11573        IF CF-ST-RF-CP-CALC > '0'
 11574           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 11575                                    EC-ST-AH-REFUND-CALC
 11576        END-IF
 11577     ELSE
 11578        IF CF-ST-RF-AH-CALC > '0'
 11579           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 11580                                    EC-ST-AH-REFUND-CALC
 11581        END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 211
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11582     END-IF
 11583     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11584     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE                ELC50PD
 11585                                                                  ELC50PD
 11586     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11587                                                                  ELC50PD
 11588     IF NO-BENEFIT-FOUND                                          ELC50PD
 11589        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11590                                                                  ELC50PD
 11591     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11592        MOVE CF-ST-REM-TERM-CALC (SUB3)                           ELC50PD
 11593                                 TO WS-AH-REM-TERM-CALC           ELC50PD
 11594                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11595     END-IF
 11596                                                                  ELC50PD
 11597     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'                   ELC50PD
 11598        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11599                                 TO WS-AH-REFUND-CALC             ELC50PD
 11600                                    EC-ST-AH-REFUND-CALC
 11601     END-IF
 11602                                                                  ELC50PD
 11603*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.  ELC50PD
 11604                                                                  ELC50PD
 11605     GO TO 0500-SET-ACCOUNT.                                      ELC50PD
 11606                                                                  ELC50PD
 11607 0499-STATE-NOT-FOUND.                                            ELC50PD
 11608                                                                  ELC50PD
 11609     MOVE ER-2603                TO WS-ERROR.                     ELC50PD
 11610     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11611                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 212
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11613                                                                  ELC50PD
 11614 0500-SET-ACCOUNT.                                                ELC50PD
 11615
 11616*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 11617
 11618     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11619        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 11620        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 11621        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 11622        MOVE '3'                 TO CNTL-REC-TYPE
 11623        MOVE +0                  TO CNTL-SEQ-NO
 11624
 11625        MOVE '3'                 TO RC-SW-2
 11626        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 11627
 11628        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 11629           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 11630           WS-CLP-STATE  NOT = CF-STATE-CODE)
 11631           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 11632                                    WS-ST-AH-PREM-TAX-I
 11633                                    WS-ST-AH-PREM-TAX-G
 11634        ELSE
 11635           IF CF-ST-LF-PREM-TAX NUMERIC
 11636              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11637           END-IF
 11638           IF CF-ST-AH-PREM-TAX-I NUMERIC
 11639              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11640           END-IF
 11641           IF CF-ST-AH-PREM-TAX-G NUMERIC
 11642              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11643           END-IF
 11644        END-IF
 11645        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 11646     END-IF
 11647
 11648*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 11649*  FOR DCC ONLY
 11650
 11651     IF PB-COMPANY-ID = 'DCC'
 11652
 11653     MOVE ' '                    TO STAT-MASTER-SW
 11654     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 11655     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 11656     MOVE PB-GROUPING            TO ELSTAT-GROUP
 11657     MOVE PB-STATE               TO ELSTAT-STATE
 11658     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11659        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 11660     END-IF
 11661
 11662     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11663     SET BIN-TO-GREG             TO TRUE
 11664     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 11665     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 11666     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 11667
 11668     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 11669     IF STAT-MASTER-FOUND
 11670        MOVE 'N'                 TO STAT-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 213
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11671        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11672        IF STAT-MASTER-FOUND
 11673           IF (ELSTAT-KEY-SAVE (1:12) =
 11674                        SF-CONTROL-PRIMARY (1:12))
 11675              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11676                 MOVE 'F'        TO STAT-MASTER-SW
 11677              ELSE
 11678                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11679                 IF (STAT-MASTER-FOUND)
 11680                    AND (ELSTAT-KEY-SAVE (1:12) =
 11681                        SF-CONTROL-PRIMARY (1:12))
 11682                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11683                    MOVE 'F'     TO STAT-MASTER-SW
 11684                 END-IF
 11685              END-IF
 11686           END-IF
 11687        END-IF
 11688     END-IF
 11689
 11690     IF STAT-MASTER-SW = 'F'
 11691        IF SF-ST-LF-PREM-TAX NUMERIC
 11692           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11693        END-IF
 11694        IF SF-ST-AH-PREM-TAX-I NUMERIC
 11695           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11696        END-IF
 11697        IF SF-ST-AH-PREM-TAX-G NUMERIC
 11698           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11699        END-IF
 11700     END-IF
 11701
 11702     END-IF
 11703
 11704     IF (PB-COMPANY-ID = 'DCC')
 11705        AND (PB-ISSUE)
 11706        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11707        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 11708        AND (AM-GPCD = 06)
 11709        MOVE 'Y'                 TO WS-GOOD-HIN
 11710        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11711           MOVE PB-I-VIN         TO WS-WORK-VIN
 11712           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11713              (V1 > 16)
 11714              IF WS-WORK-VIN (V1:1) NUMERIC
 11715                 MOVE WS-WORK-VIN-N (V1)
 11716                                 TO WS-ROW-B-VAL (V1)
 11717              ELSE
 11718                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 11719                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 11720                    OR (V2 > 26)
 11721                 END-PERFORM
 11722                 IF V2 < 27
 11723                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 11724                 ELSE
 11725                    MOVE 'N'     TO WS-GOOD-HIN
 11726                 END-IF
 11727              END-IF
 11728              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 214
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11729                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 11730              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 11731                 WS-ROW-D-VAL (V1)
 11732           END-PERFORM
 11733           MOVE ZEROS            TO WS-VIN-REMAINDER
 11734           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 11735             REMAINDER WS-VIN-REMAINDER
 11736           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 11737              CONTINUE
 11738           ELSE
 11739              MOVE 'N'           TO WS-GOOD-HIN
 11740           END-IF
 11741        ELSE
 11742           MOVE 'N'              TO WS-GOOD-HIN
 11743        END-IF
 11744        IF WS-GOOD-HIN NOT = 'Y'
 11745           MOVE ER-3826           TO WS-ERROR
 11746           PERFORM 9900-ERROR-FORMAT
 11747                                 THRU 9900-EXIT
 11748        END-IF
 11749     END-IF
 11750
 11751     IF (PB-COMPANY-ID = 'DCC')
 11752        AND (PB-ISSUE)
 11753        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11754        AND (AM-GPCD NOT = 06)
 11755        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11756          MOVE PB-I-VIN          TO WS-WORK-VIN
 11757          MOVE +8                TO V2
 11758          MOVE ZEROS             TO WS-VIN-TOTAL
 11759          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11760           (V1 > 17)
 11761             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 11762                MOVE ER-3825     TO WS-ERROR
 11763                PERFORM 9900-ERROR-FORMAT
 11764                                 THRU 9900-EXIT
 11765             ELSE
 11766                IF V1 = 8
 11767                   MOVE 10       TO V2
 11768                END-IF
 11769                IF V1 = 9
 11770                   MOVE 0        TO V2
 11771                END-IF
 11772                IF V1 = 10
 11773                   MOVE 9        TO V2
 11774                END-IF
 11775                IF WS-WORK-VIN (V1:1) NUMERIC
 11776                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11777                    + (WS-WORK-VIN-N (V1) * V2)
 11778                ELSE
 11779                   MOVE WS-WORK-VIN (V1:1)
 11780                                 TO WS-HEX-BYTE
 11781                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 11782                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11783                    + (WS-NUM (V3) * V2)
 11784                END-IF
 11785                COMPUTE V2 = V2 - 1
 11786             END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 215
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11787          END-PERFORM
 11788          MOVE ZEROS TO WS-VIN-REMAINDER
 11789          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 11790             REMAINDER WS-VIN-REMAINDER
 11791          IF ((WS-WORK-VIN (9:1) = 'X')
 11792             AND (WS-VIN-REMAINDER = 10))
 11793                     OR
 11794             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 11795             CONTINUE
 11796          ELSE
 11797             MOVE ER-3826        TO WS-ERROR
 11798             PERFORM 9900-ERROR-FORMAT
 11799                                 THRU 9900-EXIT
 11800          END-IF
 11801        ELSE
 11802          MOVE ER-3826           TO WS-ERROR
 11803          PERFORM 9900-ERROR-FORMAT
 11804                                 THRU 9900-EXIT
 11805        END-IF
 11806     END-IF
 11807
 11808
 11809
 11810******************************************************************ELC50PD
 11811******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM       ELC50PD
 11812******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND    ELC50PD
 11813******* METHODS.                                                  ELC50PD
 11814******************************************************************ELC50PD
 11815     IF PB-COMPANY-ID EQUAL TO 'NCL'                              ELC50PD
 11816        IF PB-CANCELLATION                                        ELC50PD
 11817           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)       ELC50PD
 11818              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))    ELC50PD
 11819                PERFORM 3350-GET-ERFORM THRU 3350-EXIT            ELC50PD
 11820                IF FORM-MASTER-FOUND                              ELC50PD
 11821                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.   ELC50PD
 11822******************************************************************ELC50PD
 11823                                                                  ELC50PD
 11824     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.               ELC50PD
 11825     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.               ELC50PD
 11826                                                                  ELC50PD
 11827     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.          ELC50PD
 11828     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.           ELC50PD
 11829     MOVE AM-STATUS              TO WS-ACCT-STATUS.               ELC50PD
 11830     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.          ELC50PD
 11831                                                                  ELC50PD
 11832                                                                  ELC50PD
 11833     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.        ELC50PD
 11834     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.               ELC50PD
 11835     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.          ELC50PD
 11836                                                                  ELC50PD
 11837     IF AM-LF-OB-RATE NOT NUMERIC                                 ELC50PD
 11838         MOVE ZERO               TO AM-LF-OB-RATE.                ELC50PD
 11839                                                                  ELC50PD
 11840     IF AM-LF-OB-RATE-JNT NOT NUMERIC                             ELC50PD
 11841         MOVE ZERO               TO AM-LF-OB-RATE-JNT.            ELC50PD
 11842                                                                  ELC50PD
 11843     IF AM-AH-OB-RATE NOT NUMERIC                                 ELC50PD
 11844         MOVE ZERO               TO AM-AH-OB-RATE.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 216
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11845                                                                  ELC50PD
 11846     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 11847         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT              ELC50PD
 11848     ELSE                                                         ELC50PD
 11849         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.             ELC50PD
 11850                                                                  ELC50PD
 11851     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.             ELC50PD
 11852                                                                  ELC50PD
 11853     IF WS-IG-OVRD-AM  EQUAL SPACE                                ELC50PD
 11854         MOVE AM-IG              TO WS-IG-OVRD-AM.                ELC50PD
 11855                                                                  ELC50PD
 11856     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE                          ELC50PD
 11857         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH              ELC50PD
 11858                                       WS-IG-OVRD                 ELC50PD
 11859     ELSE                                                         ELC50PD
 11860         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE                     ELC50PD
 11861             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH              ELC50PD
 11862                                       WS-IG-OVRD                 ELC50PD
 11863         ELSE                                                     ELC50PD
 11864             MOVE AM-IG             TO WS-IG-OVRD-AH              ELC50PD
 11865                                       WS-IG-OVRD.                ELC50PD
 11866                                                                  ELC50PD
 11867     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE                          ELC50PD
 11868         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF              ELC50PD
 11869                                       WS-IG-OVRD                 ELC50PD
 11870     ELSE                                                         ELC50PD
 11871         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE                     ELC50PD
 11872             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF              ELC50PD
 11873                                       WS-IG-OVRD                 ELC50PD
 11874         ELSE                                                     ELC50PD
 11875             MOVE AM-IG             TO WS-IG-OVRD-LF              ELC50PD
 11876                                       WS-IG-OVRD.                ELC50PD
 11877                                                                  ELC50PD
 11878     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11879     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11880     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11881     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.         ELC50PD
 11882     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 11883                                                                  ELC50PD
 11884     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.               ELC50PD
 11885     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.               ELC50PD
 11886     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.           ELC50PD
 11887     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.         ELC50PD
 11888                                                                  ELC50PD
 11889     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.           ELC50PD
 11890     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.         ELC50PD
 11891     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.             ELC50PD
 11892     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.           ELC50PD
 11893     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.          ELC50PD
 11894     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.                ELC50PD
 11895     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.                ELC50PD
 11896                                                                  ELC50PD
 11897     IF WS-ACCT-AH-DEV-PCT > +0                                   ELC50PD
 11898        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT       ELC50PD
 11899     ELSE                                                         ELC50PD
 11900        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.      ELC50PD
 11901                                                                  ELC50PD
 11902     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 217
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11903        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.      ELC50PD
 11904     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
 11905        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.      ELC50PD
 11906                                                                  ELC50PD
 11907        IF AM-EARN-METHOD-L = 'S'                                 ELC50PD
 11908            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11909                                        WS-LF-REFUND-CALC.        ELC50PD
 11910                                                                  ELC50PD
 11911        IF AM-EARN-METHOD-R = 'S'                                 ELC50PD
 11912            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11913                                        WS-LF-REFUND-CALC.        ELC50PD
 11914                                                                  ELC50PD
 11915     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11916         IF AM-EARN-METHOD-R = 'R'                                ELC50PD
 11917            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11918                                    WS-LF-REFUND-CALC.            ELC50PD
 11919     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11920         IF AM-EARN-METHOD-R = 'P'                                ELC50PD
 11921            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11922                                    WS-LF-REFUND-CALC.            ELC50PD
 11923     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11924         IF AM-EARN-METHOD-L = 'R'                                ELC50PD
 11925            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11926                                    WS-LF-REFUND-CALC.            ELC50PD
 11927     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11928         IF AM-EARN-METHOD-L = 'P'                                ELC50PD
 11929            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11930                                    WS-LF-REFUND-CALC.            ELC50PD
 11931     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11932         IF AM-EARN-METHOD-R = 'A'                                ELC50PD
 11933            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11934                                    WS-LF-REFUND-CALC.            ELC50PD
 11935     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11936         IF AM-EARN-METHOD-R = 'M'                                ELC50PD
 11937            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11938                                    WS-LF-REFUND-CALC.            ELC50PD
 11939     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11940         IF AM-EARN-METHOD-L = 'A'                                ELC50PD
 11941            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11942                                    WS-LF-REFUND-CALC.            ELC50PD
 11943     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11944         IF AM-EARN-METHOD-L = 'M'                                ELC50PD
 11945            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11946                                    WS-LF-REFUND-CALC.            ELC50PD
 11947                                                                  ELC50PD
 11948     IF AM-EARN-METHOD-A = 'R'                                    ELC50PD
 11949        MOVE '1'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11950                                    WS-AH-REFUND-CALC.            ELC50PD
 11951     IF AM-EARN-METHOD-A = 'P'                                    ELC50PD
 11952        MOVE '2'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11953                                    WS-AH-REFUND-CALC.            ELC50PD
 11954     IF AM-EARN-METHOD-A = 'C'                                    ELC50PD
 11955        MOVE '3'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11956                                    WS-AH-REFUND-CALC.            ELC50PD
 11957     IF AM-EARN-METHOD-A = 'A'                                    ELC50PD
 11958        MOVE '6'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11959                                    WS-AH-REFUND-CALC.            ELC50PD
 11960     IF AM-EARN-METHOD-A = 'M'                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 218
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11961        MOVE '8'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11962                                    WS-AH-REFUND-CALC.            ELC50PD
 11963     IF AM-EARN-METHOD-A = 'N'                                    ELC50PD
 11964        MOVE '5'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11965                                    WS-AH-REFUND-CALC.            ELC50PD
 11966     IF AM-EARN-METHOD-A = 'S'                                    ELC50PD
 11967        MOVE '9'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 11968                                    WS-AH-REFUND-CALC.            ELC50PD
 11969                                                                  ELC50PD
 11970     IF AM-TOL-PREM NOT = ZEROS                                   ELC50PD
 11971        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM                ELC50PD
 11972                                    WS-TOL-AH-PREM.               ELC50PD
 11973                                                                  ELC50PD
 11974     IF AM-OVR-SHT-AMT NUMERIC AND                                ELC50PD
 11975                  AM-OVR-SHT-AMT > 0                              ELC50PD
 11976        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11977                                    EC-AM-LF-OVR-SHT-AMT          ELC50PD
 11978                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11979                                    EC-AM-AH-OVR-SHT-AMT.         ELC50PD
 11980                                                                  ELC50PD
 11981     IF AM-OVR-SHT-PCT NUMERIC AND                                ELC50PD
 11982                    AM-OVR-SHT-PCT > 0                            ELC50PD
 11983        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11984                                    EC-AM-LF-OVR-SHT-PCT          ELC50PD
 11985                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11986                                    EC-AM-AH-OVR-SHT-PCT.         ELC50PD
 11987                                                                  ELC50PD
 11988     IF AM-TOL-REF-PCT NUMERIC AND                                ELC50PD
 11989                  AM-TOL-REF-PCT > 0                              ELC50PD
 11990        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT          ELC50PD
 11991                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11992                                                                  ELC50PD
 11993     IF AM-TOL-REF  NOT = ZEROS  AND                              ELC50PD
 11994                  AM-TOL-REF NUMERIC                              ELC50PD
 11995        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND              ELC50PD
 11996                                    EC-AM-LF-TOL-REFUND           ELC50PD
 11997                                    WS-TOL-AH-REFUND              ELC50PD
 11998                                    EC-AM-AH-TOL-REFUND.          ELC50PD
 11999                                                                  ELC50PD
 12000     IF AM-TOL-CLM  NOT = ZEROS                                   ELC50PD
 12001        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM               ELC50PD
 12002                                    WS-TOL-AH-CLAIM.              ELC50PD
 12003                                                                  ELC50PD
 12004     IF AM-CLP-TOL-PCT NOT NUMERIC
 12005        MOVE +0                  TO AM-CLP-TOL-PCT
 12006     END-IF
 12007
 12008     IF AM-SPP-LEASE-COMM NOT NUMERIC
 12009        MOVE +0                  TO AM-SPP-LEASE-COMM
 12010     END-IF
 12011
 12012     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0                        ELC50PD
 12013        MOVE WS-PL-TOL-LF-PREM-PCT                                ELC50PD
 12014                                 TO WS-TOL-LF-PREM-PCT.           ELC50PD
 12015                                                                  ELC50PD
 12016     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0                        ELC50PD
 12017        MOVE WS-PL-TOL-AH-PREM-PCT                                ELC50PD
 12018                                 TO WS-TOL-AH-PREM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 219
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12019                                                                  ELC50PD
 12020     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12021        MOVE WS-PL-TOL-LF-REFUND-PCT                              ELC50PD
 12022                                 TO WS-TOL-LF-REFUND-PCT.         ELC50PD
 12023                                                                  ELC50PD
 12024     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12025        MOVE WS-PL-TOL-AH-REFUND-PCT                              ELC50PD
 12026                                 TO WS-TOL-AH-REFUND-PCT.         ELC50PD
 12027                                                                  ELC50PD
 12028     IF WS-PL-REF-OVS-AMT > +0                                    ELC50PD
 12029        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.           ELC50PD
 12030                                                                  ELC50PD
 12031     IF WS-PL-REF-OVS-PCT > +0                                    ELC50PD
 12032        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT            ELC50PD
 12033                                                                  ELC50PD
 12034     IF WS-PL-TOL-LF-PREM NOT EQUAL +0                            ELC50PD
 12035        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.               ELC50PD
 12036     IF WS-PL-TOL-AH-PREM NOT EQUAL +0                            ELC50PD
 12037        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.               ELC50PD
 12038     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0                          ELC50PD
 12039        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.             ELC50PD
 12040     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0                          ELC50PD
 12041        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.             ELC50PD
 12042     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0                           ELC50PD
 12043        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.              ELC50PD
 12044     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0                           ELC50PD
 12045        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.              ELC50PD
 12046                                                                  ELC50PD
 12047     IF WS-AH-PL-REF-OVS-AMT > +0                                 ELC50PD
 12048        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.        ELC50PD
 12049                                                                  ELC50PD
 12050     IF WS-AH-PL-REF-OVS-PCT > +0                                 ELC50PD
 12051        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.        ELC50PD
 12052                                                                  ELC50PD
 12053     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.            ELC50PD
 12054     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.            ELC50PD
 12055                                                                  ELC50PD
 12056     IF PB-CANCELLATION                                           ELC50PD
 12057        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12058                                                                  ELC50PD
 12059     MOVE +1 TO SUB1.                                             ELC50PD
 12060     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.                ELC50PD
 12061     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.                ELC50PD
 12062                                                                  ELC50PD
 12063     IF CF-COMPANY-ID = 'DMD'                                     ELC50PD
 12064       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES                 ELC50PD
 12065         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD                 ELC50PD
 12066        ELSE                                                      ELC50PD
 12067         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.                ELC50PD
 12068                                                                  ELC50PD
 12069  0525-FIND-ACCT-COMM.                                            ELC50PD
 12070     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'              ELC50PD
 12071        NEXT SENTENCE                                             ELC50PD
 12072      ELSE                                                        ELC50PD
 12073         ADD +1 TO SUB1                                           ELC50PD
 12074         IF SUB1 LESS +11                                         ELC50PD
 12075            GO TO 0525-FIND-ACCT-COMM                             ELC50PD
 12076          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 220
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12077             GO TO 0560-EDIT-CONTINUE.                            ELC50PD
 12078                                                                  ELC50PD
 12079     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.              ELC50PD
 12080     MOVE ZERO                   TO PB-I-AH-COMMISSION            ELC50PD
 12081                                    PB-I-LIFE-COMMISSION.         ELC50PD
 12082***  IF PB-COMPANY-ID = 'CRI'                                        CL**9
 12083     IF PB-PREM-ACCTNG-ONLY                                          CL**9
 12084         GO TO 0560-EDIT-CONTINUE.                                   CL**9
 12085                                                                  ELC50PD
 12086     MOVE '0530' TO CTBL-SW.                                      ELC50PD
 12087     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12088                                                                  ELC50PD
 12089                                                                  ELC50PD
 12090 0530-GET-AH-COMP.                                                ELC50PD
 12091     IF NO-AH-COVERAGE  OR                                        ELC50PD
 12092        NO-AH-BENEFIT-MATCH                                       ELC50PD
 12093           GO TO 0540-NEXT-READ-STEP.                             ELC50PD
 12094                                                                  ELC50PD
 12095     IF AM-A-COM (SUB1) NUMERIC                                   ELC50PD
 12096        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12097         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION                 ELC50PD
 12098         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE                 ELC50PD
 12099         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT      ELC50PD
 12100         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION            ELC50PD
 12101     ELSE                                                         ELC50PD
 12102          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE                 ELC50PD
 12103          MOVE PB-I-AH-TERM      TO WS-WORK-TERM                  ELC50PD
 12104          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE                 ELC50PD
 12105          MOVE ZEROS             TO WS-SUB1                       ELC50PD
 12106                                    WS-COMMISSION                 ELC50PD
 12107          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT     ELC50PD
 12108          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE                    ELC50PD
 12109          IF WS-COMMISSION > ZEROS                                ELC50PD
 12110             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION            ELC50PD
 12111             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12112          END-IF                                                  ELC50PD
 12113          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT             ELC50PD
 12114          IF CTBL-TABLE-FOUND                                     ELC50PD
 12115             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *       ELC50PD
 12116                                        PB-I-AH-TERM              ELC50PD
 12117             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT            ELC50PD
 12118             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION         ELC50PD
 12119             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12120          ELSE                                                    ELC50PD
 12121             IF FIRST-TIME-THROUGH                                ELC50PD
 12122                 GO TO 0530-GET-AH-COMP                           ELC50PD
 12123             ELSE                                                 ELC50PD
 12124                 MOVE ER-2609                TO WS-ERROR          ELC50PD
 12125                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           CL**2
 12126                                                                  ELC50PD
 12127 0540-NEXT-READ-STEP.                                             ELC50PD
 12128     MOVE '0540' TO CTBL-SW.                                      ELC50PD
 12129     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12130                                                                  ELC50PD
 12131 0540-GET-LF-COMP.                                                ELC50PD
 12132     IF NO-LIFE-COVERAGE  OR                                      ELC50PD
 12133        NO-LF-BENEFIT-MATCH                                       ELC50PD
 12134           GO TO 0560-EDIT-CONTINUE.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 221
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12135                                                                  ELC50PD
 12136     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12137        IF AM-J-COM (SUB1) NUMERIC                                ELC50PD
 12138           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 12139           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12140           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12141           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12142           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12143        ELSE                                                      ELC50PD
 12144           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12145           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12146           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12147           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12148                                        WS-COMMISSION             ELC50PD
 12149           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12150           IF WS-COMMISSION > ZEROS                               ELC50PD
 12151              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12152              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12153           END-IF                                                 ELC50PD
 12154           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12155           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12156           IF CTBL-TABLE-FOUND                                    ELC50PD
 12157              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12158              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12159              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
 12160              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12161           ELSE                                                   ELC50PD
 12162              IF FIRST-TIME-THROUGH                               ELC50PD
 12163                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12164              ELSE                                                ELC50PD
 12165                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12166                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
 12167                  GO TO 0560-EDIT-CONTINUE.                          CL**2
 12168                                                                  ELC50PD
 12169     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'                        ELC50PD
 12170        IF AM-L-COM (SUB1) NUMERIC                                ELC50PD
 12171           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 12172           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12173           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12174           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12175           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12176        ELSE                                                      ELC50PD
 12177           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12178           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12179           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12180           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12181                                        WS-COMMISSION             ELC50PD
 12182           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12183           IF WS-COMMISSION IS GREATER THAN ZEROS                 ELC50PD
 12184              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12185              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12186           END-IF                                                 ELC50PD
 12187           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12188           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12189           IF CTBL-TABLE-FOUND                                    ELC50PD
 12190              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12191              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12192              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 222
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12193              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12194           ELSE                                                   ELC50PD
 12195              IF FIRST-TIME-THROUGH                               ELC50PD
 12196                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12197              ELSE                                                ELC50PD
 12198                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12199                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          CL**2
 12200                                                                  ELC50PD
 12201*    GO TO 0560-EDIT-CONTINUE.                                    ELC50PD
 12202                                                                  ELC50PD
 12203 0560-EDIT-CONTINUE.                                              ELC50PD
 12204
 12205     MOVE ZEROS                  TO WS-LF-PMF-COMM
 12206                                    WS-AH-PMF-COMM
 12207*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 12208*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 12209
 12210     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 12211        (SUB1 > +10)
 12212        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 12213           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 12214           MOVE '0530'           TO CTBL-SW
 12215           MOVE ' '              TO WS-CTBL-READ-SW
 12216           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 12217           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 12218           MOVE '0540'           TO CTBL-SW
 12219           MOVE ' '              TO WS-CTBL-READ-SW
 12220           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 12221        END-IF
 12222     END-PERFORM
 12223
 12224     GO TO 0564-EDIT-CONTINUE
 12225
 12226     .
 12227 0561-CHECK-AH.
 12228
 12229     IF (NO-AH-COVERAGE)
 12230        OR (NO-AH-BENEFIT-MATCH)
 12231        CONTINUE
 12232     ELSE
 12233        IF (AM-A-COM (SUB1) NUMERIC)
 12234           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12235           IF (AM-COM-TYP (SUB1) = 'A')
 12236              AND (WS-AH-PMF-COMM = ZEROS)
 12237              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 12238           END-IF
 12239           CONTINUE
 12240        ELSE
 12241           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 12242           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 12243           MOVE PB-AH-OVERRIDE-L1
 12244                                 TO CTBL-BEN-TYPE
 12245           MOVE ZEROS            TO WS-SUB1
 12246                                    WS-COMMISSION
 12247           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 12248           PERFORM 8300-READ-CTBL-TABLE
 12249                                 THRU 8300-EXIT
 12250           IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 223
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12251              IF (AM-COM-TYP (SUB1) = 'A')
 12252                 AND (WS-AH-PMF-COMM = ZEROS)
 12253                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 12254                                        PB-I-AH-TERM
 12255                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12256                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 12257              END-IF
 12258              CONTINUE
 12259           ELSE
 12260              IF FIRST-TIME-THROUGH
 12261                 GO TO 0561-CHECK-AH
 12262              ELSE
 12263                 MOVE ER-2609    TO WS-ERROR
 12264                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12265              END-IF
 12266           END-IF
 12267        END-IF
 12268     END-IF
 12269
 12270     .
 12271 0561-EXIT.
 12272     EXIT.
 12273
 12274 0563-CHECK-LF.
 12275
 12276     IF (NO-LIFE-COVERAGE)
 12277        OR (NO-LF-BENEFIT-MATCH)
 12278        CONTINUE
 12279     ELSE
 12280        IF WS-LF-JOINT-INDICATOR = 'J'
 12281           IF AM-J-COM (SUB1) NUMERIC
 12282              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12283              IF (AM-COM-TYP (SUB1) = 'A')
 12284                 AND (WS-LF-PMF-COMM = ZEROS)
 12285                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 12286              END-IF
 12287              CONTINUE
 12288           ELSE
 12289              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12290              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12291              MOVE PB-LIFE-OVERRIDE-L1
 12292                                 TO CTBL-BEN-TYPE
 12293              MOVE ZEROS         TO WS-SUB1
 12294                                    WS-COMMISSION
 12295              MOVE AM-J-COMA (SUB1)
 12296                                 TO CTBL-TABLE
 12297              PERFORM 8300-READ-CTBL-TABLE
 12298                                 THRU 8300-EXIT
 12299              IF CTBL-TABLE-FOUND
 12300                 IF (AM-COM-TYP (SUB1) = 'A')
 12301                    AND (WS-LF-PMF-COMM = ZEROS)
 12302                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 12303                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12304                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 12305                 END-IF
 12306                 CONTINUE
 12307              ELSE
 12308                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 224
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12309                    GO TO 0563-CHECK-LF
 12310                 ELSE
 12311                    MOVE ER-2609 TO WS-ERROR
 12312                    PERFORM 9900-ERROR-FORMAT
 12313                                 THRU 9900-EXIT
 12314*                   GO TO 0560-EDIT-CONTINUE
 12315                 END-IF
 12316              END-IF
 12317           END-IF
 12318        ELSE
 12319           IF AM-L-COM (SUB1) NUMERIC
 12320              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12321              IF (AM-COM-TYP (SUB1) = 'A')
 12322                 AND (WS-LF-PMF-COMM = ZEROS)
 12323                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 12324              END-IF
 12325              CONTINUE
 12326           ELSE
 12327              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12328              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12329              MOVE PB-LIFE-OVERRIDE-L1
 12330                                 TO CTBL-BEN-TYPE
 12331              MOVE ZEROS         TO WS-SUB1
 12332                                    WS-COMMISSION
 12333              MOVE AM-L-COMA (SUB1)
 12334                                 TO CTBL-TABLE
 12335              PERFORM 8300-READ-CTBL-TABLE
 12336                                 THRU 8300-EXIT
 12337              IF CTBL-TABLE-FOUND
 12338                 CONTINUE
 12339              ELSE
 12340                 IF FIRST-TIME-THROUGH
 12341                    GO TO 0563-CHECK-LF
 12342                 ELSE
 12343                    MOVE ER-2609 TO WS-ERROR
 12344                    PERFORM 9900-ERROR-FORMAT
 12345                                 THRU 9900-EXIT
 12346                 END-IF
 12347              END-IF
 12348           END-IF
 12349        END-IF
 12350     END-IF
 12351
 12352     .
 12353 0563-EXIT.
 12354     EXIT.
 12355
 12356 0564-EDIT-CONTINUE.
 12357                                                                  ELC50PD
 12358     IF  PB-COMPANY-ID EQUAL 'DMD'                                ELC50PD
 12359         IF PB-I-NUM-BILLED EQUAL ZEROS                           ELC50PD
 12360            MOVE ER-8148       TO WS-ERROR                        ELC50PD
 12361            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12362                                                                  ELC50PD
 12363*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE                     ELC50PD
 12364*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1                  ELC50PD
 12365*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2                  ELC50PD
 12366*         SET ELAPSED-BETWEEN-BIN TO TRUE                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 225
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12367*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 12368*         IF NO-CONVERSION-ERROR                                  ELC50PD
 12369*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12        ELC50PD
 12370*         ELSE                                                    ELC50PD
 12371*             IF PB-COMPANY-ID EQUAL 'HAN'                        ELC50PD
 12372*                 MOVE ZEROS     TO PB-I-AGE.                     ELC50PD
 12373
 12374     IF PB-I-BIRTHDAY > LOW-VALUES
 12375        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 12376        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12377        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12378        PERFORM 8500-DATE-CONVERT
 12379                                 THRU 8500-EXIT
 12380        IF NO-CONVERSION-ERROR
 12381           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12382           IF PB-I-AGE > ZEROS
 12383              IF WS-WORK-AGE NOT = PB-I-AGE
 12384                 MOVE ER-9501    TO WS-ERROR
 12385                 PERFORM 9900-ERROR-FORMAT
 12386                                 THRU 9900-EXIT
 12387              END-IF
 12388           ELSE
 12389              MOVE WS-WORK-AGE   TO PB-I-AGE
 12390           END-IF
 12391        END-IF
 12392     END-IF
 12393
 12394     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 12395                                   WS-INS-AGE-SET
 12396     IF PB-I-AGE = ZEROS                                          ELC50PD
 12397        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'                  ELC50PD
 12398           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 12399                                   WS-INS-AGE-SET
 12400           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.                      ELC50PD
 12401                                                                  ELC50PD
 12402     MOVE PB-I-AGE              TO WS-EDIT-AGE                    ELC50PD
 12403                                   WS-AH-EDIT-AGE.                ELC50PD
 12404                                                                  ELC50PD
 12405     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12406        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 12407        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12408        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12409        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12410        IF NO-CONVERSION-ERROR
 12411           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12412           IF PB-I-JOINT-AGE > 0
 12413              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 12414                 MOVE ER-9503    TO WS-ERROR
 12415                 PERFORM 9900-ERROR-FORMAT
 12416                                 THRU 9900-EXIT
 12417              END-IF
 12418           ELSE
 12419              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 12420           END-IF
 12421        ELSE
 12422           MOVE ZEROS            TO PB-I-JOINT-AGE
 12423        END-IF
 12424     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 226
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12425
 12426     IF PB-I-JOINT-AGE NOT NUMERIC                                ELC50PD
 12427        MOVE ZERO               TO PB-I-JOINT-AGE.                ELC50PD
 12428                                                                  ELC50PD
 12429     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 12430                                   WS-JNT-AGE-SET
 12431     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 12432        IF (WS-LF-JOINT-INDICATOR = 'J')  OR                      ELC50PD
 12433           (WS-AH-JOINT-INDICATOR = 'J')                          ELC50PD
 12434           IF PB-I-JOINT-AGE = ZEROS                              ELC50PD
 12435               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 12436                                          WS-JNT-AGE-SET
 12437               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 12438           END-IF
 12439        END-IF
 12440     END-IF
 12441                                                                  ELC50PD
 12442     MOVE ' ' TO PB-I-LIFE-INDICATOR
 12443     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12444        MOVE 'J'                TO PB-I-LIFE-INDICATOR            ELC50PD
 12445        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12446            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12447                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12448                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12449            ELSE                                                  ELC50PD
 12450                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12451                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE            ELC50PD
 12452                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12453                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12454                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12455                                                                  ELC50PD
 12456     IF WS-AH-JOINT-INDICATOR = 'J'                               ELC50PD
 12457        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12458            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12459                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12460                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12461            ELSE                                                  ELC50PD
 12462                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12463                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE         ELC50PD
 12464                                           WS-EDIT-AGE
 12465                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12466                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12467                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12468                                                                  ELC50PD
 12469******************************************************************ELC50PD
 12470*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS         ELC50PD
 12471******************************************************************ELC50PD
 12472                                                                  ELC50PD
 12473     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12474        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12475        NEXT SENTENCE                                             ELC50PD
 12476     ELSE                                                         ELC50PD
 12477        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR                      ELC50PD
 12478          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND               ELC50PD
 12479           (WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12480            WS-AH-JOINT-INDICATOR = 'J')  AND                     ELC50PD
 12481           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                      ELC50PD
 12482            MOVE ER-2627             TO WS-ERROR                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 227
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12483            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12484                                                                  ELC50PD
 12485     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12486        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12487         NEXT SENTENCE                                            ELC50PD
 12488     ELSE                                                         ELC50PD
 12489         IF WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12490            WS-AH-JOINT-INDICATOR = 'J'                           ELC50PD
 12491             IF PB-I-JOINT-INSURED = SPACES                       ELC50PD
 12492                 IF PB-COMPANY-ID NOT = 'JAL'                     ELC50PD
 12493                     MOVE ER-2696    TO WS-ERROR                  ELC50PD
 12494                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.    ELC50PD
 12495                                                                  ELC50PD
 12496     IF PB-COMPANY-ID NOT = 'BOA'                                 ELC50PD
 12497        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12498           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12499           IF (PB-I-JOINT-AGE NOT = ZEROS OR                      ELC50PD
 12500               PB-I-JOINT-INSURED NOT = SPACES)                   ELC50PD
 12501                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12502                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12503                                                                  ELC50PD
 12504     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 12505        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12506           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12507            IF PB-I-JOINT-AGE NOT = ZEROS                         ELC50PD
 12508                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12509                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12510                                                                  ELC50PD
 12511     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12512        IF PB-I-SIG-SW = 'J'                                      ELC50PD
 12513           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND                ELC50PD
 12514              WS-AH-JOINT-INDICATOR NOT = 'J'                     ELC50PD
 12515              MOVE ER-2675       TO WS-ERROR                      ELC50PD
 12516              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12517                                                                  ELC50PD
 12518     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12519        IF PB-I-SIG-SW = 'S'                                      ELC50PD
 12520           IF WS-LF-JOINT-INDICATOR = 'J'  OR                     ELC50PD
 12521              WS-AH-JOINT-INDICATOR = 'J'                         ELC50PD
 12522              MOVE ER-2676       TO WS-ERROR                      ELC50PD
 12523              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12524                                                                  ELC50PD
 12525     IF PB-COMPANY-ID = 'CVL'                                     ELC50PD
 12526         IF (WS-AH-JOINT-INDICATOR = 'J') AND                     ELC50PD
 12527            (WS-LF-JOINT-INDICATOR NOT = 'J')                     ELC50PD
 12528              MOVE ER-2783           TO WS-ERROR                  ELC50PD
 12529              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12530
 12531     IF (WS-LF-JOINT-INDICATOR = 'J')
 12532        AND (WS-AH-JOINT-INDICATOR = 'J')
 12533        AND (PB-I-LF-TERM > 120)
 12534        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 12535        MOVE ER-2783             TO WS-ERROR
 12536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12537     END-IF
 12538
 12539     MOVE SPACE                  TO PB-I-INDV-GRP-CD.             ELC50PD
 12540                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 228
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12541     IF PB-I-INDV-GRP-OVRD = 'I'                                  ELC50PD
 12542        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12543        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12544        MOVE 'I'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12545                                                                  ELC50PD
 12546     IF PB-I-INDV-GRP-OVRD = 'G'                                  ELC50PD
 12547        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12548        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12549        MOVE 'G'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12550                                                                  ELC50PD
 12551     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'                           ELC50PD
 12552        NEXT SENTENCE                                             ELC50PD
 12553     ELSE                                                         ELC50PD
 12554        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.             ELC50PD
 12555                                                                  ELC50PD
 12556     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD                           ELC50PD
 12557        IF WS-ERROR = ER-2666                                     ELC50PD
 12558           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)        ELC50PD
 12559           SUBTRACT +1           FROM PB-NO-OF-ERRORS.            ELC50PD
 12560
 12561     IF PB-COMPANY-ID = 'CID'
 12562        IF PB-STATE = 'UT' OR 'MO'
 12563           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 12564                 OR '76' OR '77')
 12565                      OR
 12566               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 12567                   OR '41' OR '42' OR '63' OR '64' OR '65'
 12568                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 12569                   OR '2K' OR '2L'))
 12570              AND PB-I-INDV-GRP-CD = 'I'
 12571              MOVE ER-2721             TO WS-ERROR
 12572              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12573           END-IF
 12574        END-IF
 12575     END-IF
 12576                                                                  ELC50PD
 12577     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 12578     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 12579        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 12580     ELSE
 12581        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 12582     END-IF
 12583
 12584*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 12585*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 12586     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW            ELC50PD
 12587                                    ACCOUNT-AH-CK-SW.             ELC50PD
 12588                                                                  ELC50PD
 12589     IF PB-REISSUED-CERT       OR                                 ELC50PD
 12590        PB-REIN-ONLY-CERT      OR                                 ELC50PD
 12591        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 12592        PB-POLICY-IS-VOIDED                                       ELC50PD
 12593*       OR PB-MONTHLY-CERT
 12594         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12595                                                                  ELC50PD
 12596     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12597        IF WS-EDIT-AGE           > +65
 12598           MOVE ER-2709          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 229
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12599           PERFORM 9900-ERROR-FORMAT
 12600                                 THRU 9900-EXIT
 12601        ELSE
 12602           IF WS-EDIT-AGE        > +55
 12603              MOVE ER-2718       TO WS-ERROR
 12604              PERFORM 9900-ERROR-FORMAT
 12605                                 THRU 9900-EXIT
 12606           END-IF
 12607        END-IF
 12608
 12609     IF PB-COMPANY-ID = 'DCC'
 12610        IF WS-EDIT-AGE           > +65
 12611           MOVE ER-2709          TO WS-ERROR
 12612           PERFORM 9900-ERROR-FORMAT
 12613                                 THRU 9900-EXIT
 12614        END-IF
 12615     END-IF
 12616     .
 12617
 12618 0565-LIFE-PLAN-LIMIT-EDITS.                                      ELC50PD
 12619                                                                  ELC50PD
 12620     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 12621        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 12622                                    EC-AM-LF-MAX-TOT-BEN
 12623        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12624                                                                  ELC50PD
 12625     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 12626                                                                  ELC50PD
 12627     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12628         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12629             GO TO 0580-AH-PLAN-LIMIT-EDITS.                      ELC50PD
 12630                                                                  ELC50PD
 12631     IF NO-LF-BENEFIT-MATCH          OR                           ELC50PD
 12632        WS-LF-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12633        WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12634        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12635                                                                  ELC50PD
 12636     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.           ELC50PD
 12637     MOVE +1                     TO SUB2.                         ELC50PD
 12638                                                                  ELC50PD
 12639     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12640        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
 12641           MOVE +5   TO SUB2                                      ELC50PD
 12642           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12643              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12644              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12645              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW                    ELC50PD
 12646              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12647                                                                  ELC50PD
 12648     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 12649                                                                  ELC50PD
 12650     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 12651                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 12652                                                                  ELC50PD
 12653 0568-CHECK-LIFE-ATT-AGE.                                         ELC50PD
 12654                                                                  ELC50PD
 12655
 12656     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 230
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12657        PL-ATT-AGE > +0
 12658        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 12659     END-IF
 12660
 12661
 12662
 12663*    IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12664*       PL-ATT-AGE > +0
 12665*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE          ELC50PD
 12666*       IF PB-I-BIRTHDAY > LOW-VALUES
 12667*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12668*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 12669*          MOVE ZERO             TO DC-ELAPSED-DAYS
 12670*          SET BIN-PLUS-ELAPSED  TO TRUE
 12671*          PERFORM 8500-DATE-CONVERT
 12672*                                THRU 8500-EXIT
 12673*          IF NO-CONVERSION-ERROR
 12674*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 12675*             MOVE ER-2669       TO WS-ERROR
 12676*             PERFORM 9900-ERROR-FORMAT
 12677*                                THRU 9900-EXIT
 12678*          END-IF
 12679*       ELSE
 12680*          IF WS-ATT-AGE >= PL-ATT-AGE
 12681*             MOVE ER-2669       TO WS-ERROR                      ELC50PD
 12682*             PERFORM 9900-ERROR-FORMAT
 12683*                                THRU 9900-EXIT
 12684*          END-IF
 12685*       END-IF
 12686*    END-IF
 12687
 12688     .
 12689 0570-CHECK-LIFE-LIMITS.                                          ELC50PD
 12690                                                                  ELC50PD
 12691     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12692        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12693           IF SUB2 GREATER THAN +4                                ELC50PD
 12694              MOVE ER-2637 TO WS-ERROR                            ELC50PD
 12695              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12696              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12697                                                                  ELC50PD
 12698     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12699        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12700            SUB2 GREATER THAN +8                                  ELC50PD
 12701             MOVE 'U'         TO PB-BATCH-ENTRY                   ELC50PD
 12702             MOVE ER-2637     TO WS-ERROR                         ELC50PD
 12703             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12704             GO TO 0575-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12705                                                                  ELC50PD
 12706     IF SUB2 > +8
 12707        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12708           AND (PB-I-SIG-SW = 'Y')
 12709           CONTINUE
 12710        ELSE
 12711           MOVE ER-2637          TO WS-ERROR
 12712           PERFORM 9900-ERROR-FORMAT
 12713                                 THRU 9900-EXIT
 12714        END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 231
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12715        GO TO 0580-AH-PLAN-LIMIT-EDITS
 12716     END-IF
 12717
 12718     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.                ELC50PD
 12719     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.               ELC50PD
 12720     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.            ELC50PD
 12721                                                                  ELC50PD
 12722     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)               ELC50PD
 12723        ADD +1  TO SUB2                                           ELC50PD
 12724        GO TO 0570-CHECK-LIFE-LIMITS.                             ELC50PD
 12725                                                                  ELC50PD
 12726     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12727         GO TO 0570-CHECK-NCL-LIFE-LIMITS.                        ELC50PD
 12728                                                                  ELC50PD
 12729     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 12730        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 12731        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12732           AND (PB-I-SIG-SW = 'Y')
 12733           CONTINUE
 12734        ELSE
 12735           MOVE ER-2637          TO WS-ERROR
 12736           PERFORM 9900-ERROR-FORMAT
 12737                                 THRU 9900-EXIT
 12738        END-IF
 12739     END-IF
 12740
 12741     GO TO 0580-AH-PLAN-LIMIT-EDITS.                              ELC50PD
 12742                                                                  ELC50PD
 12743                                                                  ELC50PD
 12744 0570-CHECK-NCL-LIFE-LIMITS.                                      ELC50PD
 12745                                                                  ELC50PD
 12746     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND      ELC50PD
 12747        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)      ELC50PD
 12748         GO TO 0575-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12749                                                                  ELC50PD
 12750     IF APP-CERT-USED                                             ELC50PD
 12751         IF SUB2  LESS THAN  +5                                   ELC50PD
 12752             MOVE +5          TO SUB2                             ELC50PD
 12753             GO TO 0570-CHECK-LIFE-LIMITS.                        ELC50PD
 12754                                                                  ELC50PD
 12755     MOVE ER-2637             TO WS-ERROR.                        ELC50PD
 12756     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12757                                                                  ELC50PD
 12758     MOVE 'U'                 TO PB-BATCH-ENTRY.                  ELC50PD
 12759                                                                  ELC50PD
 12760 0575-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12761                                                                  ELC50PD
 12762     IF NOT APP-CERT-USED                                         ELC50PD
 12763         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12764                                                                  ELC50PD
 12765     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12766        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12767        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12768        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12769         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12770                                                                  ELC50PD
 12771     IF SUB2 GREATER THAN +4                                      ELC50PD
 12772         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 232
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12773            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12774            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12775            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12776             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12777             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12778             GO TO 0580-AH-PLAN-LIMIT-EDITS                       ELC50PD
 12779         ELSE                                                     ELC50PD
 12780             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12781                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12782                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12783                                                                  ELC50PD
 12784     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12785       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12786          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12787           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12788           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12789           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12790                                                                  ELC50PD
 12791                                                                  ELC50PD
 12792 0580-AH-PLAN-LIMIT-EDITS.                                        ELC50PD
 12793                                                                  ELC50PD
 12794     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12795        IF PB-I-AH-BENEFIT-AMT > +1250
 12796           MOVE ER-2702          TO WS-ERROR
 12797           PERFORM 9900-ERROR-FORMAT
 12798                                 THRU 9900-EXIT
 12799        END-IF
 12800     END-IF
 12801
 12802     IF (PB-COMPANY-ID = 'DCC')
 12803        AND (PB-MONTHLY-CERT)
 12804        IF PB-I-AH-BENEFIT-AMT > +3000
 12805           MOVE ER-2881          TO WS-ERROR
 12806           PERFORM 9900-ERROR-FORMAT
 12807                                 THRU 9900-EXIT
 12808        END-IF
 12809     END-IF
 12810
 12811     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 12812        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 12813        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12814                                                                  ELC50PD
 12815     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 12816                                                                  ELC50PD
 12817     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12818         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12819             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 12820                                                                  ELC50PD
 12821     IF NO-AH-BENEFIT-MATCH          OR                           ELC50PD
 12822        WS-AH-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12823        WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12824        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12825                                                                  ELC50PD
 12826     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.             ELC50PD
 12827     MOVE +1                     TO SUB2.                         ELC50PD
 12828                                                                  ELC50PD
 12829     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12830        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 233
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12831           MOVE +5 TO SUB2                                        ELC50PD
 12832           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12833              (PL-LM-MOA (SUB2) EQUAL +0) AND                     ELC50PD
 12834              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12835              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12836              MOVE 'NO ' TO ACCOUNT-AH-CK-SW                      ELC50PD
 12837              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12838                                                                  ELC50PD
 12839     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 12840                                                                  ELC50PD
 12841 0590-CHECK-AH-ATT-AGE.                                           ELC50PD
 12842                                                                  ELC50PD
 12843     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12844        PL-ATT-AGE GREATER THAN +0                                ELC50PD
 12845        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 12846     END-IF
 12847*       IF WS-ATT-AGE >= PL-ATT-AGE
 12848*          MOVE ER-3054          TO WS-ERROR                      ELC50PD
 12849*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 12850     .
 12851 0597-CHECK-AH-LIMITS.                                            ELC50PD
 12852                                                                  ELC50PD
 12853     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12854        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12855           IF SUB2 GREATER THAN +4                                ELC50PD
 12856              MOVE ER-2638       TO WS-ERROR                      ELC50PD
 12857              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12858              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12859                                                                  ELC50PD
 12860     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12861        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12862            SUB2 GREATER THAN +8                                  ELC50PD
 12863             MOVE 'U'            TO PB-BATCH-ENTRY                ELC50PD
 12864             MOVE ER-2638        TO WS-ERROR                      ELC50PD
 12865             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12866             GO TO 0599-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12867                                                                  ELC50PD
 12868     IF SUB2 > +8
 12869        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12870           AND (PB-I-SIG-SW = 'Y')
 12871           CONTINUE
 12872        ELSE
 12873           MOVE ER-2638          TO WS-ERROR
 12874           PERFORM 9900-ERROR-FORMAT
 12875                                 THRU 9900-EXIT
 12876        END-IF
 12877        GO TO 3000-CONTINUE-EDIT
 12878     END-IF
 12879                                                                  ELC50PD
 12880     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12881        IF WS-ERROR = ER-2638                                     ELC50PD
 12882           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12883                                                                  ELC50PD
 12884     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.             ELC50PD
 12885     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.            ELC50PD
 12886     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.         ELC50PD
 12887     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.         ELC50PD
 12888                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 234
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12889     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)            ELC50PD
 12890        ADD +1                   TO SUB2                          ELC50PD
 12891        GO TO 0597-CHECK-AH-LIMITS.                               ELC50PD
 12892                                                                  ELC50PD
 12893     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12894         GO TO 0597-CHECK-NCL-AH-LIMITS.                          ELC50PD
 12895                                                                  ELC50PD
 12896     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 12897        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 12898        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12899                                 > PL-LM-AMT (SUB2))
 12900        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12901           AND (PB-I-SIG-SW = 'Y')
 12902           CONTINUE
 12903        ELSE
 12904           MOVE ER-2638          TO WS-ERROR
 12905           PERFORM 9900-ERROR-FORMAT
 12906                                 THRU 9900-EXIT
 12907        END-IF
 12908     END-IF
 12909                                                                  ELC50PD
 12910     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 12911         IF  WS-ERROR    EQUAL    ER-2638                         ELC50PD
 12912             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2) ELC50PD
 12913                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT   ELC50PD
 12914                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)  ELC50PD
 12915                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS              ELC50PD
 12916                MOVE  ER-1910    TO  WS-ERROR                     ELC50PD
 12917                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 12918                                                                  ELC50PD
 12919     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12920        IF WS-ERROR = ER-2638                                     ELC50PD
 12921            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)      ELC50PD
 12922            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS                  ELC50PD
 12923            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12924                                                                  ELC50PD
 12925     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 12926                                                                  ELC50PD
 12927 0597-CHECK-NCL-AH-LIMITS.                                        ELC50PD
 12928                                                                  ELC50PD
 12929     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND     ELC50PD
 12930        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  ANDELC50PD
 12931        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                     ELC50PD
 12932                            NOT GREATER THAN PL-LM-AMT (SUB2))    ELC50PD
 12933         GO TO 0599-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12934                                                                  ELC50PD
 12935     IF APP-CERT-USED                                             ELC50PD
 12936         IF SUB2  LESS THAN  +5                                   ELC50PD
 12937             MOVE +5             TO SUB2                          ELC50PD
 12938             GO TO 0597-CHECK-AH-LIMITS.                          ELC50PD
 12939                                                                  ELC50PD
 12940     MOVE ER-2638                TO WS-ERROR.                     ELC50PD
 12941     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12942                                                                  ELC50PD
 12943     MOVE 'U'                    TO PB-BATCH-ENTRY.               ELC50PD
 12944                                                                  ELC50PD
 12945 0599-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12946                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 235
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12947     IF NOT APP-CERT-USED                                         ELC50PD
 12948         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12949                                                                  ELC50PD
 12950     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12951        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12952        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12953        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12954         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12955                                                                  ELC50PD
 12956     IF SUB2 GREATER THAN +4                                      ELC50PD
 12957         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
 12958            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12959            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12960            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12961             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12962             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12963             GO TO 3000-CONTINUE-EDIT                             ELC50PD
 12964         ELSE                                                     ELC50PD
 12965             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12966                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12967                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12968                                                                  ELC50PD
 12969     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12970       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12971          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12972           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12973           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12974           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12975                                                                  ELC50PD
 12976******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 236
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12978                                                                  ELC50PD
 12979 3000-CONTINUE-EDIT.                                              ELC50PD
 12980                                                                  ELC50PD
 12981     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.            ELC50PD
 12982     MOVE AM-CSR-CODE            TO PB-CSR-ID.                    ELC50PD
 12983     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.           ELC50PD
 12984     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.          ELC50PD
 12985     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.      ELC50PD
 12986                                                                  ELC50PD
 12987     IF BROWSE-STARTED                                            ELC50PD
 12988        PERFORM 9990-RETURN THRU 9990-EXIT                        ELC50PD
 12989        MOVE SPACES              TO WS-BROWSE-STARTED-SW.         ELC50PD
 12990                                                                  ELC50PD
 12991     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT                  ELC50PD
 12992        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1                 ELC50PD
 12993        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2                 ELC50PD
 12994        SET ELAPSED-BETWEEN-BIN  TO TRUE                          ELC50PD
 12995*       MOVE 1                   TO DC-OPTION-CODE                ELC50PD
 12996        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 12997        IF DATE-CONVERSION-ERROR                                  ELC50PD
 12998           MOVE ER-2622          TO WS-ERROR                      ELC50PD
 12999           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13000        ELSE                                                      ELC50PD
 13001           IF DC-ELAPSED-MONTHS   GREATER THAN +2                 ELC50PD
 13002              MOVE ER-2623       TO WS-ERROR                      ELC50PD
 13003              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13004           ELSE                                                   ELC50PD
 13005              MOVE ER-2622       TO WS-ERROR                      ELC50PD
 13006              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 13007                                                                  ELC50PD
 13008     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.                ELC50PD
 13009     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.                ELC50PD
 13010     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13011*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13012     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13013     IF DATE-CONVERSION-ERROR                                     ELC50PD
 13014        GO TO 3005-EDIT-CONTINUE                                  ELC50PD
 13015     ELSE                                                         ELC50PD
 13016        IF DC-ELAPSED-DAYS GREATER +180                           ELC50PD
 13017           MOVE ER-2613          TO WS-ERROR                      ELC50PD
 13018           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13019        ELSE                                                      ELC50PD
 13020           IF DC-ELAPSED-DAYS GREATER +90                         ELC50PD
 13021              MOVE ER-2612       TO WS-ERROR                      ELC50PD
 13022              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13023           ELSE                                                   ELC50PD
 13024             IF DC-ELAPSED-DAYS GREATER +60                       ELC50PD
 13025                MOVE ER-2614     TO WS-ERROR                      ELC50PD
 13026                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 13027                                                                  ELC50PD
 13028 3005-EDIT-CONTINUE.                                              ELC50PD
 13029                                                                  ELC50PD
 13030     IF PB-CANCELLATION                                           ELC50PD
 13031         GO TO 3700-EDIT-CANCEL.                                     CL**2
 13032                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 237
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13034******************************************************************ELC50PD
 13035*                  E D I T   I S S U E                           *ELC50PD
 13036******************************************************************ELC50PD
 13037                                                                  ELC50PD
 13038 3020-EDIT-ISSUE.                                                 ELC50PD
 13039                                                                  ELC50PD
 13040      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.           ELC50PD
 13041      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.      ELC50PD
 13042      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.        ELC50PD
 13043      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.        ELC50PD
 13044      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.                  ELC50PD
 13045                                                                  ELC50PD
 13046     IF PB-ISSUE-FORCE
 13047        OR PB-ISSUE-DATE-FORCED
 13048        OR PB-FORCE-OFF
 13049        OR PB-OVERCHARGE-FORCE
 13050        CONTINUE
 13051     ELSE
 13052        MOVE ER-2670             TO WS-ERROR
 13053        PERFORM 9900-ERROR-FORMAT
 13054                                 THRU 9900-EXIT
 13055     END-IF
 13056
 13057     .
 13058 3022-SET-POLICY-STATUS.                                          ELC50PD
 13059                                                                  ELC50PD
 13060     MOVE '2'                    TO PB-I-ENTRY-STATUS.            ELC50PD
 13061                                                                  ELC50PD
 13062     IF (PB-REISSUED-CERT)
 13063             OR
 13064        ((PB-COMPANY-ID NOT = 'DCC')
 13065         AND (PB-MONTHLY-CERT))
 13066         MOVE '5'                TO PB-I-ENTRY-STATUS
 13067         MOVE 'E'                TO PB-BATCH-ENTRY
 13068     END-IF
 13069
 13070     IF PB-COMPANY-ID = 'DCC'
 13071        IF PB-MONTHLY-CERT
 13072           MOVE 'M'              TO PB-I-ENTRY-STATUS
 13073        END-IF
 13074     END-IF
 13075     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 13076         MOVE 'D'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13077     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 13078         MOVE 'V'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13079     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 13080         MOVE 'U'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13081     IF PB-REIN-ONLY-CERT                                         ELC50PD
 13082         MOVE '9'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13083     IF PB-PREM-ACCTNG-ONLY                                       ELC50PD
 13084         MOVE 'P'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13085                                                                  ELC50PD
 13086     MOVE SPACE                  TO PB-I-OB-FLAG.                 ELC50PD
 13087                                                                  ELC50PD
 13088     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE                 ELC50PD
 13089         MOVE ER-2665            TO WS-ERROR                      ELC50PD
 13090         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13091         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 238
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13092                                                                  ELC50PD
 13093     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 13094        AND WS-AH-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13095           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13096                                                                  ELC50PD
 13097     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 13098        AND WS-LF-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13099           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13100                                                                  ELC50PD
 13101     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13102         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF     ELC50PD
 13103         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH     ELC50PD
 13104         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF       ELC50PD
 13105         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH       ELC50PD
 13106         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE         ELC50PD
 13107         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 13108         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 13109     END-IF
 13110                                                                  ELC50PD
 13111     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13112        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)                ELC50PD
 13113         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.            ELC50PD
 13114                                                                  ELC50PD
 13115     IF (ACCOUNT-MAST-FOUND)
 13116        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 13117        IF PB-REISSUED-CERT
 13118           CONTINUE
 13119        ELSE
 13120           MOVE ER-2608          TO WS-ERROR
 13121           PERFORM 9900-ERROR-FORMAT
 13122                                 THRU 9900-EXIT
 13123         END-IF
 13124     END-IF
 13125                                                                  ELC50PD
 13126     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 13127        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER           ELC50PD
 13128        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.       ELC50PD
 13129                                                                  ELC50PD
 13130**********   DMD CUSTOM CODE FOLLOWS  **********                  ELC50PD
 13131 3024-EDIT-DMD-FIELDS.                                            ELC50PD
 13132     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 13133        GO TO 3025-EDIT-REINSURANCE.                              ELC50PD
 13134                                                                  ELC50PD
 13135*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE          ELC50PD
 13136*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL      ELC50PD
 13137*** ERROR IF THEY ARE NOT EQUAL.                                  ELC50PD
 13138                                                                  ELC50PD
 13139     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.              ELC50PD
 13140     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13141     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13142     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.              CL**3
 13143**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.         CL**3
 13144                                                                  ELC50PD
 13145     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.              ELC50PD
 13146     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13147     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13148     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.           CL**3
 13149**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.           CL**3
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 239
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13150                                                                  ELC50PD
 13151     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM               ELC50PD
 13152        MOVE ER-8116               TO WS-ERROR                    ELC50PD
 13153        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13154                                                                  ELC50PD
 13155     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.             ELC50PD
 13156                                                                  ELC50PD
 13157     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER       ELC50PD
 13158                                      WK-FULL-CERT-NO.            ELC50PD
 13159     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.             ELC50PD
 13160                                                                  ELC50PD
 13161     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.             ELC50PD
 13162                                                                  ELC50PD
 13163     IF PB-VALID-LIFE                                             ELC50PD
 13164        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE               ELC50PD
 13165     ELSE                                                         ELC50PD
 13166        IF PB-VALID-AH                                            ELC50PD
 13167          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.              ELC50PD
 13168                                                                  ELC50PD
 13169                                                                  ELC50PD
 13170     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.         ELC50PD
 13171     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.              ELC50PD
 13172     MOVE SPACES                   TO DCUA-CERT-NUMBER            ELC50PD
 13173                                      DCUA-UNDRWRTR-CODE          ELC50PD
 13174                                      DCUA-UNDRWRTR-GROUP-CODE    ELC50PD
 13175                                      DCUA-RETURN-CODE.           ELC50PD
 13176                                                                  ELC50PD
 13177****************************************************************  ELC50PD
 13178*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***  ELC50PD
 13179***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***  ELC50PD
 13180***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***  ELC50PD
 13181***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***  ELC50PD
 13182***   TO THIS RECORD.                                        ***  ELC50PD
 13183****************************************************************  ELC50PD
 13184     MOVE ' '                      TO WS-DLO-ERROR-SW.            ELC50PD
 13185     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.                        ELC50PD
 13186     IF DCUA-SUCCESSFUL-PROCESS                                   ELC50PD
 13187        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13188                                                                  ELC50PD
 13189     IF DCUA-RETURN-CODE EQUAL '01'                               ELC50PD
 13190        MOVE ER-8110               TO WS-ERROR                    ELC50PD
 13191        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13192        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13193        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13194                                                                  ELC50PD
 13195     IF DCUA-RETURN-CODE EQUAL '02'                               ELC50PD
 13196        MOVE ER-8111               TO WS-ERROR                    ELC50PD
 13197        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13198        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13199        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13200                                                                  ELC50PD
 13201     IF DCUA-RETURN-CODE EQUAL '03'                               ELC50PD
 13202        MOVE ER-8074               TO WS-ERROR                    ELC50PD
 13203        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13204        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13205        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13206                                                                  ELC50PD
 13207     IF DCUA-RETURN-CODE EQUAL '04'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 240
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13208        MOVE ER-8075               TO WS-ERROR                    ELC50PD
 13209        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13210        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13211        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13212                                                                  ELC50PD
 13213     IF DCUA-RETURN-CODE EQUAL '05'                               ELC50PD
 13214        MOVE ER-8076               TO WS-ERROR                    ELC50PD
 13215        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13217        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13218                                                                  ELC50PD
 13219     IF DCUA-RETURN-CODE EQUAL '06'                               ELC50PD
 13220        MOVE ER-8077               TO WS-ERROR                    ELC50PD
 13221        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13222        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13223        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13224                                                                  ELC50PD
 13225     IF DCUA-RETURN-CODE EQUAL '07'                               ELC50PD
 13226        MOVE ER-8078               TO WS-ERROR                    ELC50PD
 13227        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13229        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13230                                                                  ELC50PD
 13231     IF DCUA-RETURN-CODE EQUAL 'E1'                               ELC50PD
 13232        MOVE ER-8079               TO WS-ERROR                    ELC50PD
 13233        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13234        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13235        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13236                                                                  ELC50PD
 13237     IF DCUA-RETURN-CODE EQUAL 'E2'                               ELC50PD
 13238        MOVE ER-8080               TO WS-ERROR                    ELC50PD
 13239        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13240        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13241        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13242                                                                  ELC50PD
 13243     IF DCUA-RETURN-CODE EQUAL 'E3'                               ELC50PD
 13244        MOVE ER-8098               TO WS-ERROR                    ELC50PD
 13245        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13246        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13247        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13248                                                                  ELC50PD
 13249     IF DCUA-RETURN-CODE EQUAL 'C1'                               ELC50PD
 13250        MOVE ER-8099               TO WS-ERROR                    ELC50PD
 13251        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13252        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13253        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13254                                                                  ELC50PD
 13255     IF DCUA-RETURN-CODE EQUAL 'U1'                               ELC50PD
 13256        MOVE ER-8109               TO WS-ERROR                    ELC50PD
 13257        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13258        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13259        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13260                                                                  ELC50PD
 13261     IF DCUA-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13262        MOVE ER-8112               TO WS-ERROR                    ELC50PD
 13263        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13264        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13265        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 241
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13266                                                                  ELC50PD
 13267     IF DCUA-RETURN-CODE EQUAL 'N2'                               ELC50PD
 13268        MOVE ER-8113               TO WS-ERROR                    ELC50PD
 13269        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13270        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13271        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13272                                                                  ELC50PD
 13273     IF DCUA-RETURN-CODE EQUAL 'N3'                               ELC50PD
 13274        MOVE ER-8114               TO WS-ERROR                    ELC50PD
 13275        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13277        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13278                                                                  ELC50PD
 13279     MOVE 'Y'                      TO WS-DLO-ERROR-SW.            ELC50PD
 13280     MOVE ER-8097                  TO WS-ERROR.                   ELC50PD
 13281     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.                  ELC50PD
 13282     GO TO 3024-EDIT-DL7-CONT.                                    ELC50PD
 13283                                                                  ELC50PD
 13284 3024-EDIT-DL7-CONT.                                              ELC50PD
 13285                                                                  ELC50PD
 13286     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.               ELC50PD
 13287     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.                ELC50PD
 13288     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE                          ELC50PD
 13289        NEXT SENTENCE                                             ELC50PD
 13290     ELSE                                                         ELC50PD
 13291        MOVE ER-9263               TO WS-ERROR                    ELC50PD
 13292        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13293                                                                  ELC50PD
 13294******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS      ELC50PD
 13295******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...              ELC50PD
 13296     IF DCUA-CERT-NUMBER = PB-CERT-NO                             ELC50PD
 13297        NEXT SENTENCE                                             ELC50PD
 13298     ELSE                                                         ELC50PD
 13299        MOVE ER-8039               TO WS-ERROR                    ELC50PD
 13300        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13301                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 242
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13303****************************************************************  ELC50PD
 13304*** VALIDATE STATE  : DLO022                                 ***  ELC50PD
 13305****************************************************************  ELC50PD
 13306     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.            ELC50PD
 13307     MOVE SPACES                   TO DVSC-RETURN-CODE.           ELC50PD
 13308                                                                  ELC50PD
 13309     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.                       ELC50PD
 13310     IF DVSC-SUCCESSFUL-EDIT                                      ELC50PD
 13311        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13312                                                                  ELC50PD
 13313     IF DVSC-RETURN-CODE EQUAL '01'                               ELC50PD
 13314        MOVE ER-8300               TO WS-ERROR                    ELC50PD
 13315        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13316        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13317                                                                  ELC50PD
 13318     IF DVSC-RETURN-CODE EQUAL '02'                               ELC50PD
 13319        MOVE ER-8301               TO WS-ERROR                    ELC50PD
 13320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13321        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13322                                                                  ELC50PD
 13323     IF DVSC-RETURN-CODE EQUAL '03'                               ELC50PD
 13324        MOVE ER-8302               TO WS-ERROR                    ELC50PD
 13325        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13326        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13327                                                                  ELC50PD
 13328     IF DVSC-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13329        MOVE ER-8304               TO WS-ERROR                    ELC50PD
 13330        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13331        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13332                                                                  ELC50PD
 13333     MOVE ER-8303                  TO WS-ERROR                    ELC50PD
 13334     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13335                                                                  ELC50PD
 13336 3024-EDIT-DL22-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 243
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13338****************************************************************  ELC50PD
 13339*** VALIDATE LOAN OFFICER : DLO021                           ***  ELC50PD
 13340****************************************************************  ELC50PD
 13341                                                                  ELC50PD
 13342     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.         ELC50PD
 13343     MOVE SPACES                    TO DVLO-RETURN-CODE.          ELC50PD
 13344     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.                       ELC50PD
 13345     IF DVLO-SUCCESSFUL-EDIT                                      ELC50PD
 13346        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13347                                                                  ELC50PD
 13348     IF DVLO-RETURN-CODE EQUAL '01'                               ELC50PD
 13349        MOVE ER-8081               TO WS-ERROR                    ELC50PD
 13350        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13351        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13352                                                                  ELC50PD
 13353     IF DVLO-RETURN-CODE EQUAL '02'                               ELC50PD
 13354        MOVE ER-8082               TO WS-ERROR                    ELC50PD
 13355        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13356        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13357                                                                  ELC50PD
 13358     IF DVLO-RETURN-CODE EQUAL '03'                               ELC50PD
 13359        MOVE ER-8083               TO WS-ERROR                    ELC50PD
 13360        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13361        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13362                                                                  ELC50PD
 13363     IF DVLO-RETURN-CODE EQUAL '04'                               ELC50PD
 13364        MOVE ER-8084               TO WS-ERROR                    ELC50PD
 13365        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13366        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13367                                                                  ELC50PD
 13368     IF DVLO-RETURN-CODE EQUAL '05'                               ELC50PD
 13369        MOVE ER-8085               TO WS-ERROR                    ELC50PD
 13370        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13371        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13372                                                                  ELC50PD
 13373     MOVE ER-7825                  TO WS-ERROR                    ELC50PD
 13374     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13375     GO TO 3024-EDIT-DL21-CONT.                                   ELC50PD
 13376                                                                  ELC50PD
 13377 3024-EDIT-DL21-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 244
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13379                                                                  ELC50PD
 13380****************************************************************  ELC50PD
 13381*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***  ELC50PD
 13382****************************************************************  ELC50PD
 13383                                                                  ELC50PD
 13384     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.                 ELC50PD
 13385     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.      ELC50PD
 13386     MOVE SPACES                 TO DIPF-RETURN-CODE.             ELC50PD
 13387     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.                       ELC50PD
 13388     IF DIPF-SUCCESSFUL-EDIT                                      ELC50PD
 13389        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13390                                                                  ELC50PD
 13391     IF DIPF-RETURN-CODE EQUAL '01'                               ELC50PD
 13392        MOVE ER-8086               TO WS-ERROR                    ELC50PD
 13393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13394        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13395                                                                  ELC50PD
 13396     IF DIPF-RETURN-CODE EQUAL '02'                               ELC50PD
 13397        MOVE ER-8087               TO WS-ERROR                    ELC50PD
 13398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13399        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13400                                                                  ELC50PD
 13401     IF DIPF-RETURN-CODE EQUAL '03'                               ELC50PD
 13402        MOVE ER-8088               TO WS-ERROR                    ELC50PD
 13403        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13404        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13405                                                                  ELC50PD
 13406     MOVE ER-8095                  TO WS-ERROR                    ELC50PD
 13407     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13408     GO TO 3024-EDIT-DL02-CONT.                                   ELC50PD
 13409                                                                  ELC50PD
 13410 3024-EDIT-DL02-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 245
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13412                                                                  ELC50PD
 13413****************************************************************  ELC50PD
 13414*** VALIDATE BANK ID : DLO003                                ***  ELC50PD
 13415****************************************************************  ELC50PD
 13416                                                                  ELC50PD
 13417     MOVE WK-GREG-CENT           TO WCG-CENT.                     ELC50PD
 13418     MOVE WK-GREG-YYMM           TO WCG-REST.                     ELC50PD
 13419     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG                         ELC50PD
 13420        MOVE ER-8040               TO WS-ERROR                    ELC50PD
 13421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13422                                                                  ELC50PD
 13423     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.                  ELC50PD
 13424     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.                ELC50PD
 13425     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.           ELC50PD
 13426     MOVE SPACES                 TO  DVBI-RETURN-CODE.            ELC50PD
 13427     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.                  ELC50PD
 13428     IF DVBI-SUCCESSFUL-EDIT                                      ELC50PD
 13429        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13430                                                                  ELC50PD
 13431     IF DVBI-RETURN-CODE EQUAL '01'                               ELC50PD
 13432        MOVE ER-8089               TO WS-ERROR                    ELC50PD
 13433        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13434        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13435                                                                  ELC50PD
 13436     IF DVBI-RETURN-CODE EQUAL '02'                               ELC50PD
 13437        MOVE ER-8090               TO WS-ERROR                    ELC50PD
 13438        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13439        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13440                                                                  ELC50PD
 13441     IF DVBI-RETURN-CODE EQUAL '03'                               ELC50PD
 13442        MOVE ER-8091               TO WS-ERROR                    ELC50PD
 13443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13444        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13445                                                                  ELC50PD
 13446     IF DVBI-RETURN-CODE EQUAL '04'                               ELC50PD
 13447        MOVE ER-8092               TO WS-ERROR                    ELC50PD
 13448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13449        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13450                                                                  ELC50PD
 13451     IF DVBI-RETURN-CODE EQUAL '05'                               ELC50PD
 13452        MOVE ER-8093               TO WS-ERROR                    ELC50PD
 13453        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13454        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13455                                                                  ELC50PD
 13456     IF DVBI-RETURN-CODE EQUAL '06'                               ELC50PD
 13457        MOVE ER-8094               TO WS-ERROR                    ELC50PD
 13458        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13459        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13460                                                                  ELC50PD
 13461     MOVE ER-8096                  TO WS-ERROR                    ELC50PD
 13462     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13463     GO TO 3024-EDIT-DL03-CONT.                                   ELC50PD
 13464                                                                  ELC50PD
 13465 3024-EDIT-DL03-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 246
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13467                                                                  ELC50PD
 13468     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR               ELC50PD
 13469        NEXT SENTENCE                                             ELC50PD
 13470     ELSE                                                         ELC50PD
 13471        MOVE ER-8042               TO WS-ERROR                    ELC50PD
 13472        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13473                                                                  ELC50PD
 13474     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.     ELC50PD
 13475     MOVE SPACES                 TO  DMPF-RETURN-CODE.            ELC50PD
 13476     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.                       ELC50PD
 13477                                                                  ELC50PD
 13478     IF DMPF-RETURN-CODE = '01'                                   ELC50PD
 13479        MOVE ER-8067               TO WS-ERROR                    ELC50PD
 13480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13481        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13482                                                                  ELC50PD
 13483     IF DMPF-RETURN-CODE = '02'                                   ELC50PD
 13484        MOVE ER-8068               TO WS-ERROR                    ELC50PD
 13485        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13486        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13487                                                                  ELC50PD
 13488     IF DMPF-RETURN-CODE = '03'                                   ELC50PD
 13489        MOVE ER-8069               TO WS-ERROR                    ELC50PD
 13490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13491        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13492                                                                  ELC50PD
 13493     IF DMPF-RETURN-CODE = 'E1'                                   ELC50PD
 13494        MOVE ER-8070               TO WS-ERROR                    ELC50PD
 13495        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13496        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13497                                                                  ELC50PD
 13498     IF DMPF-RETURN-CODE = 'N1'                                   ELC50PD
 13499        MOVE ER-8071               TO WS-ERROR                    ELC50PD
 13500        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13501        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13502                                                                  ELC50PD
 13503     IF DMPF-RETURN-CODE NOT = 'OK'                               ELC50PD
 13504        MOVE ER-8072               TO WS-ERROR                    ELC50PD
 13505        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13506                                                                  ELC50PD
 13507 3024-EDIT-DL01-CONT.                                             ELC50PD
 13508******************************************************************ELC50PD
 13509***  VALIDATES RATE CODES : DLO017                             ***ELC50PD
 13510******************************************************************ELC50PD
 13511                                                                  ELC50PD
 13512      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.            ELC50PD
 13513      MOVE SPACES                   TO DVRC-RETURN-CODE.          ELC50PD
 13514      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.                      ELC50PD
 13515      IF DVRC-SUCCESSFUL-EDIT                                     ELC50PD
 13516        MOVE 'Y'                   TO WK-VALID-RATE-CODE          ELC50PD
 13517        GO TO 3024-CHECK-VALID-RATE.                              ELC50PD
 13518                                                                  ELC50PD
 13519      MOVE 'N'                     TO WK-VALID-RATE-CODE.         ELC50PD
 13520                                                                  ELC50PD
 13521      IF DVRC-RETURN-CODE EQUAL '01'                              ELC50PD
 13522         MOVE ER-7817                   TO WS-ERROR               ELC50PD
 13523         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13524         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 247
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13525                                                                  ELC50PD
 13526      IF DVRC-RETURN-CODE EQUAL '02'                              ELC50PD
 13527         MOVE ER-7818                   TO WS-ERROR               ELC50PD
 13528         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13529         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13530                                                                  ELC50PD
 13531      IF DVRC-RETURN-CODE EQUAL '03'                              ELC50PD
 13532         MOVE ER-7819                   TO WS-ERROR               ELC50PD
 13533         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13534         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13535                                                                  ELC50PD
 13536       MOVE ER-7820                     TO WS-ERROR.              ELC50PD
 13537       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13538       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13539                                                                  ELC50PD
 13540******************************************************************ELC50PD
 13541***  GET PREMIUM RATES : DLO011                                ***ELC50PD
 13542******************************************************************ELC50PD
 13543                                                                  ELC50PD
 13544 3024-CHECK-VALID-RATE.                                           ELC50PD
 13545                                                                  ELC50PD
 13546     IF VALID-RATE-CODE                                           ELC50PD
 13547        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE              ELC50PD
 13548        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG         ELC50PD
 13549        MOVE SPACES                TO DPRB-RETURN-CODE            ELC50PD
 13550        PERFORM 7740-CALL-DL11 THRU 7740-EXIT                     ELC50PD
 13551     ELSE                                                         ELC50PD
 13552         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13553                                                                  ELC50PD
 13554      IF DPRB-SUCCESSFUL-PROCESS                                  ELC50PD
 13555         IF PB-VALID-LIFE                                         ELC50PD
 13556             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE           ELC50PD
 13557             GO TO 3025-EDIT-REINSURANCE                          ELC50PD
 13558         ELSE                                                     ELC50PD
 13559             IF PB-VALID-AH                                       ELC50PD
 13560                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE           ELC50PD
 13561                 GO TO 3025-EDIT-REINSURANCE.                     ELC50PD
 13562                                                                  ELC50PD
 13563      IF DPRB-RETURN-CODE EQUAL '01'                              ELC50PD
 13564         MOVE ER-7812                   TO WS-ERROR               ELC50PD
 13565         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13566         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13567                                                                  ELC50PD
 13568      IF DPRB-RETURN-CODE EQUAL '02'                              ELC50PD
 13569         MOVE ER-7813                   TO WS-ERROR               ELC50PD
 13570         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13571         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13572                                                                  ELC50PD
 13573      IF DPRB-RETURN-CODE EQUAL '03'                              ELC50PD
 13574         MOVE ER-7814                   TO WS-ERROR               ELC50PD
 13575         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13576         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13577                                                                  ELC50PD
 13578      IF DPRB-RETURN-CODE EQUAL '04'                              ELC50PD
 13579         IF NOT DPRB-1ST-TIME                                     ELC50PD
 13580            MOVE ER-7815                   TO WS-ERROR            ELC50PD
 13581            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 13582            GO TO 3025-EDIT-REINSURANCE                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 248
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13583          ELSE                                                    ELC50PD
 13584         IF PB-VALID-LIFE                                         ELC50PD
 13585            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13586          ELSE                                                    ELC50PD
 13587            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13588         END-IF                                                   ELC50PD
 13589         MOVE SPACES                TO DOCC-RETURN-CODE           ELC50PD
 13590         MOVE 'X'                   TO DPRB-1ST-TIME-SW           ELC50PD
 13591         PERFORM 7755-CALL-DL19 THRU 7755-EXIT                    ELC50PD
 13592         IF DOCC-RETURN-CODE = 'OK'                               ELC50PD
 13593             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4          ELC50PD
 13594             GO TO 3024-CHECK-VALID-RATE                          ELC50PD
 13595           ELSE                                                   ELC50PD
 13596             MOVE ER-7823               TO WS-ERROR               ELC50PD
 13597             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT            ELC50PD
 13598             GO TO 3025-EDIT-REINSURANCE.                         ELC50PD
 13599                                                                  ELC50PD
 13600       MOVE ER-7816                     TO WS-ERROR.              ELC50PD
 13601       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13602       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13603                                                                  ELC50PD
 13604**********   DMD CUSTOM CODE ABOVE    **********                  ELC50PD
 13605                                                                  ELC50PD
 13606 3025-EDIT-REINSURANCE.                                           ELC50PD
 13607     IF PB-I-SPECIAL-REIN-CODE = SPACE                            ELC50PD
 13608         GO TO 3027-EDIT-CONTINUE.                                ELC50PD
 13609                                                                  ELC50PD
 13610     MOVE LOW-VALUES               TO ERREIN-KEY.                 ELC50PD
 13611     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.               ELC50PD
 13612     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1                 ELC50PD
 13613                                      REIN-CODE-2                 ELC50PD
 13614                                      REIN-CODE-3.                ELC50PD
 13615     MOVE 'A'                      TO REIN-TYPE.                  ELC50PD
 13616                                                                  ELC50PD
 13617     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.            ELC50PD
 13618                                                                  ELC50PD
 13619     MOVE '3026' TO REIN-SW.                                      ELC50PD
 13620     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13621                                                                  ELC50PD
 13622     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13623     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13624         GO TO 3026-NO-SPEC-TABLE.                                ELC50PD
 13625                                                                  ELC50PD
 13626     MOVE RE-TABLE              TO WK-REIN-TABLE.                 ELC50PD
 13627     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13628                                   WS-NSP-ST-CD-LF.               ELC50PD
 13629     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13630                                   WS-NSP-ST-CD-AH.               ELC50PD
 13631                                                                  ELC50PD
 13632     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13633                                                                  ELC50PD
 13634 3026-NO-SPEC-TABLE.                                              ELC50PD
 13635                                                                  ELC50PD
 13636     MOVE ER-2664                TO WS-ERROR.                     ELC50PD
 13637     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13638     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13639                                                                  ELC50PD
 13640 3027-EDIT-CONTINUE.                                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 249
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13641                                                                  ELC50PD
 13642     IF PB-I-REIN-TABLE = SPACES                                  ELC50PD
 13643       GO TO 3040-EDIT-CONTINUE.                                  ELC50PD
 13644                                                                  ELC50PD
 13645     IF PB-I-REIN-TABLE = WK-REIN-TABLE                           ELC50PD
 13646          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF               ELC50PD
 13647          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH               ELC50PD
 13648           GO TO 3040-EDIT-CONTINUE.                              ELC50PD
 13649                                                                  ELC50PD
 13650     MOVE LOW-VALUES            TO ERREIN-KEY.                    ELC50PD
 13651     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.                  ELC50PD
 13652     MOVE 'A'                   TO REIN-TYPE.                     ELC50PD
 13653     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.                 ELC50PD
 13654                                                                  ELC50PD
 13655     MOVE '3028'                TO REIN-SW.                       ELC50PD
 13656     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13657                                                                  ELC50PD
 13658     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13659     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13660         GO TO 3028-NO-REIN-TABLE.                                ELC50PD
 13661                                                                  ELC50PD
 13662     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.                 ELC50PD
 13663     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13664                                   WS-NSP-ST-CD-LF.               ELC50PD
 13665     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13666                                   WS-NSP-ST-CD-AH.               ELC50PD
 13667                                                                  ELC50PD
 13668     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13669                                                                  ELC50PD
 13670 3028-NO-REIN-TABLE.                                              ELC50PD
 13671                                                                  ELC50PD
 13672     MOVE ER-2615                TO WS-ERROR.                     ELC50PD
 13673     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13674     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13675                                                                  ELC50PD
 13676 3040-EDIT-CONTINUE.                                              ELC50PD
 13677                                                                  ELC50PD
 13678     IF PB-I-LF-PREM-CALC NOT NUMERIC                             ELC50PD
 13679         MOVE ZEROS              TO PB-I-LF-PREM-CALC.            ELC50PD
 13680                                                                  ELC50PD
 13681     IF PB-I-AH-PREM-CALC NOT NUMERIC                             ELC50PD
 13682         MOVE ZEROS              TO PB-I-AH-PREM-CALC.            ELC50PD
 13683                                                                  ELC50PD
 13684     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13685        AND (NOT PB-MONTHLY-CERT)
 13686        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')     ELC50PD
 13687            MOVE '001'           TO PB-I-LF-TERM                  ELC50PD
 13688            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13689                                                                  ELC50PD
 13690     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13691        AND (NOT PB-MONTHLY-CERT)
 13692        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')     ELC50PD
 13693            MOVE '001'           TO PB-I-AH-TERM                  ELC50PD
 13694            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13695                                                                  ELC50PD
 13696 3040-EDIT-1ST-PMT-DT.                                            ELC50PD
 13697
 13698     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 250
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13699     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 13700         MOVE ZEROS TO PB-I-EXTENTION-DAYS.                       ELC50PD
 13701                                                                  ELC50PD
 13702******************************************************************ELC50PD
 13703*                                                                *ELC50PD
 13704*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *ELC50PD
 13705*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *ELC50PD
 13706*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *ELC50PD
 13707*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *ELC50PD
 13708*                                                                *ELC50PD
 13709******************************************************************ELC50PD
 13710                                                                  ELC50PD
 13711     IF PB-EFF-DT-PROCESSING                                      ELC50PD
 13712        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13713                                    PB-I-LF-EXPIRE-DT             ELC50PD
 13714                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13715        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13716        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1                 ELC50PD
 13717        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13718        MOVE +1                  TO DC-ELAPSED-MONTHS             ELC50PD
 13719        SET BIN-PLUS-ELAPSED     TO TRUE                          ELC50PD
 13720*       MOVE 6                   TO DC-OPTION-CODE                ELC50PD
 13721        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13722        IF NO-CONVERSION-ERROR                                    ELC50PD
 13723           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.              ELC50PD
 13724                                                                  ELC50PD
 13725******************************************************************ELC50PD
 13726*                                                                *ELC50PD
 13727*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *ELC50PD
 13728*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *ELC50PD
 13729*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13730*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *ELC50PD
 13731*                                                                *ELC50PD
 13732******************************************************************ELC50PD
 13733                                                                  ELC50PD
 13734     IF PB-EXT-DAYS-PROCESSING                                    ELC50PD
 13735          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT          ELC50PD
 13736                                         PB-I-LF-EXPIRE-DT        ELC50PD
 13737                                         PB-I-AH-EXPIRE-DT        ELC50PD
 13738          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1            ELC50PD
 13739          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13740          MOVE +1                     TO DC-ELAPSED-MONTHS        ELC50PD
 13741          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS          ELC50PD
 13742          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13743*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 13744          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13745          IF NO-CONVERSION-ERROR                                  ELC50PD
 13746             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.         ELC50PD
 13747                                                                  ELC50PD
 13748******************************************************************ELC50PD
 13749*                                                                *ELC50PD
 13750*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *ELC50PD
 13751*        BASED ON THE OLDEST EXPIRE DATE.                        *ELC50PD
 13752*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13753*        (EXPIRE DATE - (TERM -1))  *  -1.                        ELC50PD
 13754*                                                                *ELC50PD
 13755******************************************************************ELC50PD
 13756                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 251
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13757     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13758        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT       ELC50PD
 13759           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13760              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13761              MOVE PB-I-AH-TERM      TO WS-TERM                   ELC50PD
 13762           ELSE                                                   ELC50PD
 13763              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13764              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13765        ELSE                                                      ELC50PD
 13766           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13767              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13768              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13769           ELSE                                                   ELC50PD
 13770              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13771              MOVE PB-I-AH-TERM      TO WS-TERM.                  ELC50PD
 13772                                                                  ELC50PD
 13773     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13774        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13775        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13776        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1                 ELC50PD
 13777        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13778                                    DC-ODD-DAYS-OVER              ELC50PD
 13779          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1          ELC50PD
 13780          SET BIN-PLUS-ELAPSED    TO TRUE                         ELC50PD
 13781*         MOVE 6                  TO DC-OPTION-CODE               ELC50PD
 13782          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13783          IF NO-CONVERSION-ERROR                                  ELC50PD
 13784             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.            ELC50PD
 13785                                                                  ELC50PD
 13786******************************************************************ELC50PD
 13787*                                                                *ELC50PD
 13788*            1ST PAYMENT DATE PROCESSING                         *ELC50PD
 13789*                                                                *ELC50PD
 13790******************************************************************ELC50PD
 13791                                                                  ELC50PD
 13792     IF PB-1ST-PMT-DT-PROCESSING                                  ELC50PD
 13793        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT             ELC50PD
 13794                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13795        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.          ELC50PD
 13796                                                                  ELC50PD
 13797     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT              ELC50PD
 13798         NEXT SENTENCE                                            ELC50PD
 13799     ELSE                                                         ELC50PD
 13800         MOVE ER-2680                 TO WS-ERROR                 ELC50PD
 13801         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13802         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 13803                                                                  ELC50PD
 13804     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 13805     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.                ELC50PD
 13806     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13807*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13808     MOVE ZEROS                  TO DC-ELAPSED-MONTHS             ELC50PD
 13809                                    DC-ELAPSED-DAYS               ELC50PD
 13810                                    DC-ODD-DAYS-OVER.             ELC50PD
 13811                                                                  ELC50PD
 13812     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13813                                                                  ELC50PD
 13814     IF DATE-CONVERSION-ERROR                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 252
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13815        GO TO 3060-ORIG-TERM-CHECK.                               ELC50PD
 13816                                                                  ELC50PD
 13817     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 13818
 13819     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13820        AND (WS-LF-COVERAGE-TYPE = 'L')
 13821        IF (DC-ELAPSED-MONTHS > 1)
 13822                      OR
 13823           ((DC-ELAPSED-MONTHS = 1)
 13824           AND (DC-ODD-DAYS-OVER > 0))
 13825           MOVE ER-2882          TO WS-ERROR
 13826           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13827        END-IF
 13828     END-IF
 13829
 13830     if dc-elapsed-months > 0
 13831        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 13832        + dc-odd-days-over
 13833     end-if
 13834
 13835     IF PB-EXT-DAYS-PROCESSING
 13836        CONTINUE
 13837     ELSE
 13838        IF DC-ELAPSED-MONTHS = +0
 13839           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 13840        ELSE
 13841           IF (WS-LF-EARNINGS-CALC = '4')
 13842              AND (DC-ELAPSED-MONTHS > ZERO)
 13843              AND (DC-ELAPSED-DAYS > ZERO)
 13844              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 13845           ELSE
 13846              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 13847                                 THRU 6499-EXIT
 13848              MOVE WS-ODD-DAYS-OVER
 13849                                 TO PB-I-EXTENTION-DAYS
 13850           END-IF
 13851        END-IF
 13852     END-IF
 13853
 13854******************************************************************ELC50PD
 13855*                                                                *ELC50PD
 13856*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *ELC50PD
 13857*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *ELC50PD
 13858*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *ELC50PD
 13859*            AND ANY ODD DAYS.                                   *ELC50PD
 13860*                                                                *ELC50PD
 13861******************************************************************ELC50PD
 13862                                                                  ELC50PD
 13863     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -                  ELC50PD
 13864                              (EC-ST-FST-PMT-DAYS-MAX + 32)       ELC50PD
 13865     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13866        IF DC-ELAPSED-DAYS > ZEROS
 13867           MOVE ER-2681          TO WS-ERROR
 13868           PERFORM 9900-ERROR-FORMAT
 13869                                 THRU 9900-EXIT
 13870        END-IF
 13871     END-IF
 13872                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 253
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13873     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13874        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX     ELC50PD
 13875           MOVE ER-2681          TO WS-ERROR                      ELC50PD
 13876           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 13877                                                                  ELC50PD
 13878     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13879        (PB-I-LF-TERM NOT = ZERO) AND                             ELC50PD
 13880         NOT NO-LIFE-COVERAGE                                     ELC50PD
 13881          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1                 ELC50PD
 13882          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1           ELC50PD
 13883          IF WS-LF-EARNINGS-CALC = '4'
 13884             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 13885             PB-I-PAY-FREQUENCY
 13886          END-IF
 13887          MOVE ZERO              TO DC-ELAPSED-DAYS               ELC50PD
 13888                                    DC-ODD-DAYS-OVER              ELC50PD
 13889          MOVE 1                 TO DC-END-OF-MONTH               ELC50PD
 13890          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13891*         MOVE 6                 TO DC-OPTION-CODE                ELC50PD
 13892          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13893          IF NO-CONVERSION-ERROR                                  ELC50PD
 13894             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT        ELC50PD
 13895             IF (WS-LF-EARNINGS-CALC = 'B') AND                   ELC50PD
 13896                (WS-LF-SPECIAL-CALC-CD = 'L')                     ELC50PD
 13897                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1         ELC50PD
 13898                  MOVE ZERO           TO DC-ELAPSED-DAYS          ELC50PD
 13899                  MOVE +1             TO DC-ELAPSED-MONTHS        ELC50PD
 13900                  SET BIN-PLUS-ELAPSED  TO TRUE                   ELC50PD
 13901*                 MOVE 6              TO DC-OPTION-CODE           ELC50PD
 13902                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT        ELC50PD
 13903                  IF NO-CONVERSION-ERROR                          ELC50PD
 13904                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.     ELC50PD
 13905                                                                  ELC50PD
 13906* okay, i had to move the new att age edit down here because the
 13907* expiration date could get recalculated and i need the exp date
 13908
 13909
 13910     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 13911        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 13912        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13913        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13914           AND ZEROS
 13915           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13916           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13917           SET ELAPSED-BETWEEN-BIN TO TRUE
 13918           PERFORM 8500-DATE-CONVERT
 13919                                 THRU 8500-EXIT
 13920           IF NO-CONVERSION-ERROR
 13921              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13922                 MOVE ER-2669       TO WS-ERROR
 13923*                PERFORM 9900-ERROR-FORMAT
 13924*                                THRU 9900-EXIT
 13925              END-IF
 13926           END-IF
 13927        ELSE
 13928           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13929           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 13930              MOVE ER-2669       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 254
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13931*             PERFORM 9900-ERROR-FORMAT
 13932*                                THRU 9900-EXIT
 13933           ELSE
 13934              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 13935                 MOVE ER-1570    TO WS-ERROR
 13936                 PERFORM 9900-ERROR-FORMAT
 13937                                 THRU 9900-EXIT
 13938              END-IF
 13939           END-IF
 13940        END-IF
 13941
 13942        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13943           AND ZEROS
 13944           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 13945           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13946           SET ELAPSED-BETWEEN-BIN TO TRUE
 13947           PERFORM 8500-DATE-CONVERT
 13948                                 THRU 8500-EXIT
 13949           IF NO-CONVERSION-ERROR
 13950              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13951                 MOVE ER-2669       TO WS-ERROR
 13952*                PERFORM 9900-ERROR-FORMAT
 13953*                                THRU 9900-EXIT
 13954              END-IF
 13955           END-IF
 13956        ELSE
 13957           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13958             (PB-I-LF-TERM / 12)
 13959           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 13960              MOVE ER-2669       TO WS-ERROR
 13961*             PERFORM 9900-ERROR-FORMAT
 13962*                                THRU 9900-EXIT
 13963           ELSE
 13964              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 13965                 MOVE ER-1571    TO WS-ERROR
 13966                 PERFORM 9900-ERROR-FORMAT
 13967                                 THRU 9900-EXIT
 13968              END-IF
 13969           END-IF
 13970        END-IF
 13971        IF WS-ERROR = ER-2669
 13972           PERFORM 9900-ERROR-FORMAT
 13973                                 THRU 9900-EXIT
 13974        END-IF
 13975
 13976     END-IF
 13977
 13978     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13979        (PB-I-AH-TERM NOT = ZERO) AND                             ELC50PD
 13980         NOT NO-AH-COVERAGE                                       ELC50PD
 13981          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 13982             AND (PB-COMPANY-ID = 'DCC')
 13983             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 13984             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 13985          ELSE
 13986             IF WS-LF-EARNINGS-CALC = '4'
 13987                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 13988                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 255
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13989                PB-I-PAY-FREQUENCY
 13990             ELSE
 13991                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 13992                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 13993             END-IF
 13994          END-IF
 13995          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13996                                         DC-ODD-DAYS-OVER         ELC50PD
 13997          MOVE 1                      TO DC-END-OF-MONTH          ELC50PD
 13998          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13999*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 14000          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 14001          IF NO-CONVERSION-ERROR                                  ELC50PD
 14002             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.       ELC50PD
 14003
 14004     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 14005        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 14006        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14007        IF PB-I-BIRTHDAY > LOW-VALUES
 14008           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14009           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14010           SET ELAPSED-BETWEEN-BIN TO TRUE
 14011           PERFORM 8500-DATE-CONVERT
 14012                                 THRU 8500-EXIT
 14013           IF NO-CONVERSION-ERROR
 14014              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14015                 MOVE ER-3054       TO WS-ERROR
 14016*                PERFORM 9900-ERROR-FORMAT
 14017*                                THRU 9900-EXIT
 14018              END-IF
 14019           END-IF
 14020        ELSE
 14021           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14022           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 14023              MOVE ER-3054       TO WS-ERROR
 14024*             PERFORM 9900-ERROR-FORMAT
 14025*                                THRU 9900-EXIT
 14026           END-IF
 14027        END-IF
 14028
 14029        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14030           AND ZEROS
 14031           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14032           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14033           SET ELAPSED-BETWEEN-BIN TO TRUE
 14034           PERFORM 8500-DATE-CONVERT
 14035                                 THRU 8500-EXIT
 14036           IF NO-CONVERSION-ERROR
 14037              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14038                 MOVE ER-3054       TO WS-ERROR
 14039*                PERFORM 9900-ERROR-FORMAT
 14040*                                THRU 9900-EXIT
 14041              END-IF
 14042           END-IF
 14043        ELSE
 14044           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14045             (PB-I-AH-TERM / 12)
 14046           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 256
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14047              MOVE ER-3054       TO WS-ERROR
 14048*             PERFORM 9900-ERROR-FORMAT
 14049*                                THRU 9900-EXIT
 14050           END-IF
 14051        END-IF
 14052        IF WS-ERROR = ER-3054
 14053           PERFORM 9900-ERROR-FORMAT
 14054                                 THRU 9900-EXIT
 14055        END-IF
 14056
 14057     END-IF
 14058
 14059     MOVE SPACE                       TO DC-END-OF-MONTH.         ELC50PD
 14060                                                                  ELC50PD
 14061     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14062        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14063                                                                     CL**6
 14064     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14065       AND                                                        ELC50PD
 14066        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14067        NEXT SENTENCE                                             ELC50PD
 14068     ELSE                                                            CL**6
 14069        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14070                                                                     CL**6
 14071     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT             ELC50PD
 14072        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14073        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2                 ELC50PD
 14074     ELSE                                                         ELC50PD
 14075        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14076        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.                ELC50PD
 14077                                                                  ELC50PD
 14078     SET ELAPSED-BETWEEN-BIN TO TRUE.                             ELC50PD
 14079*    MOVE '1'      TO DC-OPTION-CODE                              ELC50PD
 14080     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                     ELC50PD
 14081     IF (NO-CONVERSION-ERROR)
 14082        AND (DC-ELAPSED-MONTHS > +1)
 14083        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 14084        MOVE ER-2668   TO WS-ERROR                                ELC50PD
 14085        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14086                                                                  ELC50PD
 14087 3040-EDIT-EXTENSION-DAYS.                                        ELC50PD
 14088                                                                  ELC50PD
 14089     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 14090        AND (PB-COMPANY-ID NOT EQUAL 'CSL')                       ELC50PD
 14091         GO TO 3050-EDIT-TERM-IN-DAYS                             ELC50PD
 14092     ELSE                                                         ELC50PD
 14093         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.             ELC50PD
 14094                                                                  ELC50PD
 14095     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 14096         MOVE ZEROS             TO PB-I-EXTENTION-DAYS            ELC50PD
 14097     ELSE                                                         ELC50PD
 14098        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)         ELC50PD
 14099           AND (WS-LF-EARNINGS-CALC NOT = '4')                    ELC50PD
 14100           MOVE ER-2681         TO WS-ERROR                       ELC50PD
 14101           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14102                                                                  ELC50PD
 14103     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR                        ELC50PD
 14104        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 257
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14105        (PB-I-AH-EXPIRE-DT = LOW-VALUES)                          ELC50PD
 14106         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 14107                                                                  ELC50PD
 14108     GO TO 3060-ORIG-TERM-CHECK.                                  ELC50PD
 14109                                                                  ELC50PD
 14110 3050-EDIT-TERM-IN-DAYS.                                          ELC50PD
 14111                                                                  ELC50PD
 14112     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.          ELC50PD
 14113                                                                  ELC50PD
 14114     IF PB-I-TERM-IN-DAYS NOT NUMERIC                             ELC50PD
 14115         MOVE ZEROS              TO PB-I-TERM-IN-DAYS             ELC50PD
 14116     ELSE                                                         ELC50PD
 14117         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO               ELC50PD
 14118            MOVE ER-2682         TO WS-ERROR                      ELC50PD
 14119            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14120                                                                  ELC50PD
 14121     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM        ELC50PD
 14122                                       REMAINDER WS-WORK-TERM.    ELC50PD
 14123     IF WS-WORK-TERM GREATER THAN ZERO                            ELC50PD
 14124         ADD +1 TO PB-I-LF-TERM.                                  ELC50PD
 14125                                                                  ELC50PD
 14126     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14127         MOVE ER-2684            TO WS-ERROR                      ELC50PD
 14128         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14129                                                                  ELC50PD
 14130                                                                  ELC50PD
 14131 3060-ORIG-TERM-CHECK.                                            ELC50PD
 14132                                                                  ELC50PD
 14133******************************************************************ELC50PD
 14134*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS                ELC50PD
 14135******************************************************************ELC50PD
 14136                                                                  ELC50PD
 14137     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14138        NEXT SENTENCE                                             ELC50PD
 14139     ELSE                                                         ELC50PD
 14140        IF NOT NO-LIFE-COVERAGE                                   ELC50PD
 14141           IF PB-I-LF-TERM NUMERIC                                ELC50PD
 14142              AND (PB-I-LF-TERM GREATER THAN ZERO)                ELC50PD
 14143              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)     ELC50PD
 14144              AND (PB-I-LF-TERM NOT GREATER THAN +360)            ELC50PD
 14145                  NEXT SENTENCE                                   ELC50PD
 14146           ELSE                                                   ELC50PD
 14147              MOVE ER-2647       TO WS-ERROR                      ELC50PD
 14148              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14149                                                                  ELC50PD
 14150     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14151         IF PB-I-AH-TERM NUMERIC                                  ELC50PD
 14152            AND (PB-I-AH-TERM GREATER THAN ZERO)                  ELC50PD
 14153            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)       ELC50PD
 14154            AND (PB-I-AH-TERM NOT GREATER THAN +360)              ELC50PD
 14155             NEXT SENTENCE                                        ELC50PD
 14156          ELSE                                                    ELC50PD
 14157              MOVE ER-2658       TO WS-ERROR                      ELC50PD
 14158              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14159                                                                  ELC50PD
 14160     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14161        GO TO 3070-LOAN-TERM-CHECK.                                  CL**6
 14162                                                                     CL**6
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 258
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14163     IF POLICY-HAS-AH                                             ELC50PD
 14164       AND                                                        ELC50PD
 14165        POLICY-HAS-LIFE                                           ELC50PD
 14166       AND                                                        ELC50PD
 14167        PB-I-LF-TERM NUMERIC                                      ELC50PD
 14168       AND                                                        ELC50PD
 14169        PB-I-AH-TERM NUMERIC                                      ELC50PD
 14170        NEXT SENTENCE                                             ELC50PD
 14171     ELSE                                                         ELC50PD
 14172        GO TO 3070-LOAN-TERM-CHECK.                               ELC50PD
 14173                                                                  ELC50PD
 14174     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).   ELC50PD
 14175     IF WS-TEX-FACT-2 LESS THAN +0                                ELC50PD
 14176        MULTIPLY +1 BY WS-TEX-FACT-2.                             ELC50PD
 14177                                                                  ELC50PD
 14178     IF WS-TEX-FACT-2 GREATER THAN +1                             ELC50PD
 14179        MOVE ER-2668             TO WS-ERROR                      ELC50PD
 14180        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14181                                                                  ELC50PD
 14182 3070-LOAN-TERM-CHECK.                                            ELC50PD
 14183                                                                  ELC50PD
 14184     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14185         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14186            GO TO 3125-EDIT-PMT-FREQ.                             ELC50PD
 14187
 14188*    IF PB-COMPANY-ID NOT = 'DCC'
 14189*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 14190*          AND 'V' AND 'W' AND 'X'
 14191*          GO TO 3125-EDIT-PMT-FREQ
 14192*       END-IF
 14193*    ELSE
 14194*       IF WS-AH-DCC-TRUNC = 'T'
 14195*          CONTINUE
 14196*       ELSE
 14197*          GO TO 3125-EDIT-PMT-FREQ
 14198*       END-IF
 14199*    END-IF
 14200
 14201
 14202
 14203     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14204                    OR
 14205        ((PB-COMPANY-ID = 'DCC')
 14206        AND (WS-AH-DCC-TRUNC = 'T'))
 14207        CONTINUE
 14208     ELSE
 14209        GO TO 3125-EDIT-PMT-FREQ
 14210     END-IF
 14211
 14212     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 14213         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 14214                                                                  ELC50PD
 14215     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND          ELC50PD
 14216        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND          ELC50PD
 14217*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND          ELC50PD
 14218        PB-I-LOAN-TERM NOT GREATER THAN +360                      ELC50PD
 14219         NEXT SENTENCE                                            ELC50PD
 14220     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 259
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14221         MOVE ER-2648            TO WS-ERROR                      ELC50PD
 14222         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14223                                                                  ELC50PD
 14224     if  PB-I-LOAN-TERM > WS-MAX-TERM
 14225        MOVE ER-3058             TO WS-ERROR
 14226        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14227     end-if
 14228                                                                  ELC50PD
 14229     IF WS-STATE-ABBREVIATION = 'NC'
 14230        IF PB-I-LOAN-TERM > +59
 14231           CONTINUE
 14232        ELSE
 14233           MOVE ER-2792          TO WS-ERROR
 14234           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50
 14235        END-IF
 14236     END-IF
 14237                                                                  ELC50PD
 14238     .
 14239 3125-EDIT-PMT-FREQ.                                              ELC50PD
 14240
 14241     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14242         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14243            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14244
 14245     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14246                    OR
 14247        ((PB-COMPANY-ID = 'DCC')
 14248        AND (WS-AH-DCC-TRUNC = 'T'))
 14249                    OR
 14250         (PB-COMPANY-ID = 'AHL')
 14251        CONTINUE
 14252     ELSE
 14253        IF (PB-I-LOAN-TERM > ZEROS)
 14254           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 14255           MOVE ER-1575          TO WS-ERROR
 14256           PERFORM 9900-ERROR-FORMAT
 14257                                 THRU 9900-EXIT
 14258        END-IF
 14259     END-IF
 14260
 14261     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 14262         IF PB-I-PAY-FREQUENCY  NOT = ZEROS                       ELC50PD
 14263            MOVE ER-2653         TO WS-ERROR                      ELC50PD
 14264            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14265            GO TO 3127-EDIT-LOAN-OFFICER                          ELC50PD
 14266         ELSE                                                     ELC50PD
 14267            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14268                                                                  ELC50PD
 14269     IF PB-I-PAY-FREQUENCY = ZERO OR 1                            ELC50PD
 14270         MOVE ER-2655            TO WS-ERROR                      ELC50PD
 14271         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14272         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14273                                                                  ELC50PD
 14274     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM              ELC50PD
 14275         MOVE ER-2654            TO WS-ERROR                      ELC50PD
 14276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14277         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14278                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 260
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14279     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY                    ELC50PD
 14280         GIVING WS-TEX-FACT-2                                     ELC50PD
 14281             REMAINDER WS-TEX-FACT-3.                             ELC50PD
 14282                                                                  ELC50PD
 14283*    IF WS-TEX-FACT-3 NOT = ZERO                                  ELC50PD
 14284*       MOVE ER-2654             TO WS-ERROR                      ELC50PD
 14285*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14286                                                                  ELC50PD
 14287                                                                  ELC50PD
 14288 3127-EDIT-LOAN-OFFICER.                                          ELC50PD
 14289                                                                  ELC50PD
 14290     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 14291        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 14292           MOVE ER-2690          TO WS-ERROR
 14293           PERFORM 9900-ERROR-FORMAT
 14294                                 THRU 9900-EXIT
 14295        ELSE
 14296           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 14297           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 14298           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 14299           MOVE PB-SV-STATE      TO LOFC-STATE
 14300           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 14301           MOVE PB-I-LOAN-OFFICER
 14302                                 TO LOFC-CODE
 14303           PERFORM 8586-READ-LOAN-OFFICER
 14304                                 THRU 8586-EXIT
 14305           IF (NOT LOFC-MASTER-FOUND)
 14306              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 14307              MOVE ER-3006       TO WS-ERROR
 14308              PERFORM 9900-ERROR-FORMAT
 14309                                 THRU 9900-EXIT
 14310           END-IF
 14311        END-IF
 14312     END-IF
 14313
 14314     .
 14315 3129-EDIT-APR.                                                   ELC50PD
 14316                                                                  ELC50PD
 14317     IF (WS-LF-BENEFIT-CD = ZERO)
 14318        OR (NO-LF-BENEFIT-MATCH)
 14319        IF PB-COMPANY-ID NOT = 'DCC'
 14320           GO TO 3130-EDIT-AGE
 14321*       ELSE
 14322*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14323*             GO TO 3130-EDIT-AGE
 14324*          END-IF
 14325        END-IF
 14326     END-IF
 14327                                                                  ELC50PD
 14328     IF (WS-STATE-ABBREVIATION = 'OH')                            ELC50PD
 14329         AND (PB-I-RATE-CLASS NOT = 'L ')
 14330         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14331         AND (PB-CERT-EFF-DT GREATER WS-831031)                   ELC50PD
 14332         GO TO 3129-APR-CONT.                                     ELC50PD
 14333                                                                  ELC50PD
 14334     IF (WS-STATE-ABBREVIATION = 'RI')                            ELC50PD
 14335         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14336         AND (PB-CERT-EFF-DT GREATER WS-831231)                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 261
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14337         GO TO 3129-APR-CONT.                                     ELC50PD
 14338                                                                  ELC50PD
 14339     IF (WS-STATE-ABBREVIATION = 'UT')                            ELC50PD
 14340         AND (PB-I-LF-TERM GREATER THAN 62)                       ELC50PD
 14341         AND (PB-CERT-EFF-DT GREATER WS-810831)                   ELC50PD
 14342         AND (PB-CERT-EFF-DT LESS WS-830901)                      ELC50PD
 14343         GO TO 3129-APR-CONT.                                     ELC50PD
 14344                                                                  ELC50PD
 14345     IF PB-COMPANY-ID = 'LAP'                                     ELC50PD
 14346        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'                 ELC50PD
 14347           IF PB-I-LOAN-APR GREATER THAN ZEROS                    ELC50PD
 14348              MOVE ER-2656         TO WS-ERROR                    ELC50PD
 14349              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14350              GO TO 3130-EDIT-AGE.                                ELC50PD
 14351                                                                  ELC50PD
 14352     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14353        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14354        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 14355        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14356        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 14357        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 14358         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14359                                                                  ELC50PD
 14360 3129-APR-CONT.                                                   ELC50PD
 14361     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR                         ELC50PD
 14362         (WS-LF-SPECIAL-CALC-CD = 'M'))                           ELC50PD
 14363         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14364                                                                  ELC50PD
 14365     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 14366         WS-AH-BENEFIT-CD (1:1) = 'S')
 14367        AND (PB-COMPANY-ID = 'DCC')
 14368        AND (PB-I-LOAN-APR = ZERO)
 14369        MOVE ER-2657             TO WS-ERROR
 14370        PERFORM 9900-ERROR-FORMAT
 14371                                 THRU 9900-EXIT
 14372        GO TO 3130-EDIT-AGE
 14373     END-IF
 14374
 14375     IF PB-I-LOAN-APR = ZERO
 14376        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 14377     END-IF
 14378                                                                  ELC50PD
 14379     IF PB-I-LOAN-APR = ZERO                                      ELC50PD
 14380        MOVE ER-2656             TO WS-ERROR                      ELC50PD
 14381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 14382        GO TO 3130-EDIT-AGE.                                      ELC50PD
 14383                                                                  ELC50PD
 14384*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 14385     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000            ELC50PD
 14386        MOVE ER-2657             TO WS-ERROR                      ELC50PD
 14387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14388                                                                  ELC50PD
 14389 3130-EDIT-AGE.                                                   ELC50PD
 14390                                                                  ELC50PD
 14391******************************************************************ELC50PD
 14392*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *ELC50PD
 14393******************************************************************ELC50PD
 14394                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 262
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14395     IF NOT NO-LIFE-COVERAGE                                      ELC50PD
 14396        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14397           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99     ELC50PD
 14398               MOVE ER-2628             TO WS-ERROR               ELC50PD
 14399               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14400                                                                  ELC50PD
 14401     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14402        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14403           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99  ELC50PD
 14404               MOVE ER-2628         TO WS-ERROR                   ELC50PD
 14405               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14406                                                                  ELC50PD
 14407 3133-SEX-CODE.                                                   ELC50PD
 14408     IF PB-I-INSURED-SEX = SPACE OR ZERO                          ELC50PD
 14409         IF WS-DEFAULT-SEX = 'M'                                  ELC50PD
 14410             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX              ELC50PD
 14411          ELSE                                                    ELC50PD
 14412             IF WS-DEFAULT-SEX = 'F'                              ELC50PD
 14413             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.             ELC50PD
 14414                                                                  ELC50PD
 14415     IF PB-I-INSURED-SEX = '1'                                    ELC50PD
 14416         MOVE 'M' TO PB-I-INSURED-SEX.                            ELC50PD
 14417                                                                  ELC50PD
 14418     IF PB-I-INSURED-SEX = '2'                                    ELC50PD
 14419         MOVE 'F' TO PB-I-INSURED-SEX.                            ELC50PD
 14420                                                                  ELC50PD
 14421 3134-SIG-SW-EDIT.                                                ELC50PD
 14422     IF PB-I-SIG-SW = SPACE                                       ELC50PD
 14423         MOVE 'N'                TO  PB-I-SIG-SW.                 ELC50PD
 14424                                                                  ELC50PD
 14425     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 14426         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '         ELC50PD
 14427             NEXT SENTENCE                                        ELC50PD
 14428         ELSE                                                     ELC50PD
 14429             MOVE ER-1923        TO  WS-ERROR                     ELC50PD
 14430             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14431     ELSE                                                         ELC50PD
 14432     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14433         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '                ELC50PD
 14434             NEXT SENTENCE                                        ELC50PD
 14435         ELSE                                                     ELC50PD
 14436             MOVE ER-2606        TO  WS-ERROR                     ELC50PD
 14437             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14438     ELSE                                                         ELC50PD
 14439     IF PB-COMPANY-ID = 'TMS'                                     ELC50PD
 14440         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'                       ELC50PD
 14441             NEXT SENTENCE                                        ELC50PD
 14442         ELSE                                                     ELC50PD
 14443             MOVE ER-2689        TO  WS-ERROR                     ELC50PD
 14444             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14445     ELSE                                                         ELC50PD
 14446         IF PB-I-SIG-SW = 'Y' OR 'N'                              ELC50PD
 14447             NEXT SENTENCE                                        ELC50PD
 14448         ELSE                                                     ELC50PD
 14449             MOVE ER-2651        TO  WS-ERROR                     ELC50PD
 14450             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14451                                                                  ELC50PD
 14452     IF PB-COMPANY-ID = 'FLA'                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 263
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14453         IF (WS-EDIT-AGE GREATER 54  OR                           ELC50PD
 14454             WS-AH-EDIT-AGE GREATER 54)  AND                      ELC50PD
 14455            PB-I-SIG-SW = 'N'                                     ELC50PD
 14456            MOVE ER-2651         TO  WS-ERROR                     ELC50PD
 14457            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14458                                                                  ELC50PD
 14459 3135-NAME-EDIT.                                                  ELC50PD
 14460                                                                  ELC50PD
 14461     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 14462        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 14463        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 14464           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 14465                                 TO PB-I-JOINT-FIRST-NAME
 14466        END-PERFORM
 14467     END-IF
 14468
 14469     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 14470        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 14471        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 14472           MOVE PB-I-JOINT-LAST-NAME (2:14)
 14473                                 TO PB-I-JOINT-LAST-NAME
 14474        END-PERFORM
 14475     END-IF
 14476
 14477     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 14478        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 14479        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 14480           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 14481                                 TO PB-I-INSURED-FIRST-NAME
 14482        END-PERFORM
 14483     END-IF
 14484
 14485     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 14486        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 14487        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 14488           MOVE PB-I-INSURED-LAST-NAME (2:14)
 14489                                 TO PB-I-INSURED-LAST-NAME
 14490        END-PERFORM
 14491     END-IF
 14492
 14493     IF PB-I-INSURED-LAST-NAME = SPACES                           ELC50PD
 14494       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14495       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14496           MOVE ER-2660    TO WS-ERROR                            ELC50PD
 14497           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14498                                                                  ELC50PD
 14499 3136-EDIT-SEX.                                                   ELC50PD
 14500                                                                  ELC50PD
 14501******************************************************************ELC50PD
 14502*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *ELC50PD
 14503******************************************************************ELC50PD
 14504                                                                  ELC50PD
 14505     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 14506        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 14507        NEXT SENTENCE                                             ELC50PD
 14508     ELSE                                                         ELC50PD
 14509        IF PB-I-INSURED-SEX = 'M' OR 'F'                          ELC50PD
 14510           NEXT SENTENCE                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 264
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14511        ELSE                                                      ELC50PD
 14512           MOVE ER-2629            TO WS-ERROR                    ELC50PD
 14513           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14514                                                                  ELC50PD
 14515 3137-EDIT-EFF-DATE.                                              ELC50PD
 14516                                                                  ELC50PD
 14517     IF PB-REISSUED-CERT       OR                                 ELC50PD
 14518        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14519        PB-POLICY-IS-VOIDED                                       ELC50PD
 14520         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14521                                                                  ELC50PD
 14522     MOVE SPACE                  TO WS-2671-SW                    ELC50PD
 14523                                    WS-2672-SW.                   ELC50PD
 14524                                                                  ELC50PD
 14525     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')             ELC50PD
 14526         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END      ELC50PD
 14527             MOVE ER-2703        TO WS-ERROR                      ELC50PD
 14528             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14529             GO TO 3139-EDIT-COVERAGE-CODES.                      ELC50PD
 14530                                                                  ELC50PD
 14531     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END         ELC50PD
 14532         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14533                                                                  ELC50PD
 14534     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 14535     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.                ELC50PD
 14536*    MOVE '1'                    TO DC-OPTION-CODE.               ELC50PD
 14537     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 14538     MOVE +0                     TO DC-ELAPSED-MONTHS             ELC50PD
 14539                                    DC-ELAPSED-DAYS.              ELC50PD
 14540     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 14541                                                                  ELC50PD
 14542     IF DATE-CONVERSION-ERROR                                     ELC50PD
 14543         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14544                                                                  ELC50PD
 14545     IF DC-ELAPSED-DAYS GREATER +180                              ELC50PD
 14546         MOVE ER-2672            TO WS-ERROR                      ELC50PD
 14547         MOVE 'Y'                TO WS-2672-SW                    ELC50PD
 14548         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14549     END-IF
 14550                                                                  ELC50PD
 14551     IF WS-ERROR = ER-2671  AND                                   ELC50PD
 14552        PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 14553        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)          ELC50PD
 14554        MOVE SPACE               TO WS-2671-SW                    ELC50PD
 14555        SUBTRACT +1            FROM PB-NO-OF-ERRORS.              ELC50PD
 14556                                                                  ELC50PD
 14557     IF PB-ISSUE-DATE-FORCED  AND                                 ELC50PD
 14558      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))      ELC50PD
 14559         SUBTRACT +1           FROM PB-NO-OF-ERRORS               ELC50PD
 14560         MOVE ER-2673            TO WS-ERROR                      ELC50PD
 14561         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14562         MOVE SPACE              TO WS-2671-SW                    ELC50PD
 14563                                    WS-2672-SW.                   ELC50PD
 14564                                                                  ELC50PD
 14565     IF DC-ELAPSED-MONTHS IS GREATER THAN +9                      ELC50PD
 14566         IF PB-ISSUE-DATE-FORCED                                  ELC50PD
 14567             MOVE ER-2600          TO  WS-ERROR                   ELC50PD
 14568             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 265
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14569         ELSE                                                     ELC50PD
 14570             MOVE ER-2692          TO  WS-ERROR                   ELC50PD
 14571             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14572                                                                  ELC50PD
 14573                                                                  ELC50PD
 14574 3139-EDIT-COVERAGE-CODES.                                        ELC50PD
 14575                                                                  ELC50PD
 14576     if pb-company-id not = 'AHL'
 14577        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 14578           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 14579           MOVE ER-2787          TO WS-ERROR
 14580           PERFORM 9900-ERROR-FORMAT
 14581                                 THRU 9900-EXIT
 14582        END-IF
 14583     end-if
 14584
 14585     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 14586        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 14587                                 > 250000.00
 14588           MOVE ER-2719          TO WS-ERROR
 14589           PERFORM 9900-ERROR-FORMAT
 14590                                 THRU 9900-EXIT
 14591        END-IF
 14592     END-IF
 14593
 14594     IF PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14595        PB-POLICY-IS-VOIDED                                       ELC50PD
 14596         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14597                                                                  ELC50PD
 14598     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND             ELC50PD
 14599        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)                  ELC50PD
 14600         MOVE ER-2630                TO WS-ERROR                  ELC50PD
 14601         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14602                                                                  ELC50PD
 14603     IF PB-I-LF-BENEFIT-CD = ZERO  AND                            ELC50PD
 14604        PB-I-LF-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14605        PB-I-LF-PREMIUM-AMT = ZERO                                ELC50PD
 14606         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14607                                                                  ELC50PD
 14608     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14609        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14610        PB-I-LF-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14611         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14612                                                                  ELC50PD
 14613     IF (PB-I-LF-BENEFIT-CD = ZERO)
 14614        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14615        MOVE ER-2631             TO WS-ERROR
 14616        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14617     END-IF
 14618                                                                  ELC50PD
 14619                                                                  ELC50PD
 14620******************************************************************ELC50PD
 14621*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS        ELC50PD
 14622******************************************************************ELC50PD
 14623                                                                  ELC50PD
 14624     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14625        NEXT SENTENCE                                             ELC50PD
 14626     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 266
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14627        IF PB-I-LF-BENEFIT-AMT = ZERO                             ELC50PD
 14628           MOVE ER-2632             TO WS-ERROR                   ELC50PD
 14629           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14630                                                                  ELC50PD
 14631                                                                  ELC50PD
 14632******************************************************************ELC50PD
 14633*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14634******************************************************************ELC50PD
 14635                                                                  ELC50PD
 14636     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14637        CONTINUE                                                  ELC50PD
 14638     ELSE                                                         ELC50PD
 14639        IF PB-I-LF-PREMIUM-AMT = ZERO                             ELC50PD
 14640           IF (NOT PB-COMP-LF-PREM)
 14641              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14642              MOVE ER-2633       TO WS-ERROR
 14643              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14644           END-IF
 14645        END-IF
 14646     END-IF
 14647
 14648     .                                                            ELC50PD
 14649 3140-CHECK-AH-FOR-ZERO.                                          ELC50PD
 14650                                                                  ELC50PD
 14651     IF PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14652        PB-I-AH-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14653        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14654         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14655                                                                  ELC50PD
 14656     IF PB-COMPANY-ID = 'CSL'  AND                                ELC50PD
 14657        PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14658        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14659        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14660         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14661                                                                  ELC50PD
 14662     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14663        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14664        PB-I-AH-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14665         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14666                                                                  ELC50PD
 14667     IF PB-I-AH-BENEFIT-CD = ZERO                                 ELC50PD
 14668         MOVE ER-2634            TO WS-ERROR                      ELC50PD
 14669         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14670                                                                  ELC50PD
 14671******************************************************************ELC50PD
 14672*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14673******************************************************************ELC50PD
 14674                                                                  ELC50PD
 14675     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14676        NEXT SENTENCE                                             ELC50PD
 14677     ELSE                                                         ELC50PD
 14678        IF PB-I-AH-BENEFIT-AMT = ZERO                             ELC50PD
 14679           MOVE ER-2635             TO WS-ERROR                   ELC50PD
 14680           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14681                                                                  ELC50PD
 14682******************************************************************ELC50PD
 14683*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14684******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 267
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14685                                                                  ELC50PD
 14686     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14687        NEXT SENTENCE                                             ELC50PD
 14688     ELSE                                                         ELC50PD
 14689        IF PB-I-AH-PREMIUM-AMT = ZERO                             ELC50PD
 14690            IF NOT PB-COMP-AH-PREM                                ELC50PD
 14691                MOVE ER-2636    TO WS-ERROR                       ELC50PD
 14692                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14693                                                                  ELC50PD
 14694                                                                  ELC50PD
 14695 3140-EDIT-MAX-AMT-SIZES.                                         ELC50PD
 14696* CUSTOM CODE FOR CLIENT    'DMD'                                 ELC50PD
 14697     MOVE ZEROS                   TO WS-RES-STATE-TAX             ELC50PD
 14698                                     WS-RES-MUNI-TAX              ELC50PD
 14699                                     PB-I-STATE-TAX               ELC50PD
 14700                                     PB-I-MUNI-TAX.               ELC50PD
 14701                                                                  ELC50PD
 14702     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.         ELC50PD
 14703                                                                  ELC50PD
 14704     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14705        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14706                                                                  ELC50PD
 14707     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14708        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14709                                                                  ELC50PD
 14710     IF WS-LF-EARNINGS-CALC EQUAL '5'                             ELC50PD
 14711        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14712                                                                  ELC50PD
 14713     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'     ELC50PD
 14714                             OR 'RIC')                            ELC50PD
 14715        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14716                                                                  ELC50PD
 14717     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'                        ELC50PD
 14718        IF PB-I-LOAN-APR GREATER THAN ZEROS                       ELC50PD
 14719            GO TO 3150-RATE-OUTSTAND-BAL                          ELC50PD
 14720        ELSE                                                      ELC50PD
 14721           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'                ELC50PD
 14722               GO TO 3150-RATE-OUTSTAND-BAL.                      ELC50PD
 14723                                                                  ELC50PD
 14724     IF NOT PB-NO-MONTHS-SKIPPED                                  ELC50PD
 14725        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14726                                                                  ELC50PD
 14727     IF PB-I-LF-TERM NOT = PB-I-AH-TERM                           ELC50PD
 14728        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14729                                                                  ELC50PD
 14730     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)                          ELC50PD
 14731        IF PB-I-AH-BENEFIT-AMT NOT = ZERO                         ELC50PD
 14732           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -   ELC50PD
 14733             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                 ELC50PD
 14734           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA            ELC50PD
 14735           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM        ELC50PD
 14736              MOVE ER-2693     TO WS-ERROR                        ELC50PD
 14737              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14738              GO TO 3150-RATE-OUTSTAND-BAL                        ELC50PD
 14739           ELSE                                                   ELC50PD
 14740              GO TO 3150-RATE-OUTSTAND-BAL.                       ELC50PD
 14741                                                                  ELC50PD
 14742 3150-RATE-OUTSTAND-BAL.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 268
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14743                                                                  ELC50PD
 14744* DMD RATING TEST                                                 ELC50PD
 14745     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 14746         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14747         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14748         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 14749         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14750         MOVE 'B'                     TO PB-I-OB-FLAG             ELC50PD
 14751         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 14752                                                                  ELC50PD
 14753     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 14754         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14755             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'                 ELC50PD
 14756                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14757                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14758                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14759                                                                  ELC50PD
 14760     IF  PB-COMPANY-ID   EQUAL    'CDL'                           ELC50PD
 14761         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14762             IF WS-STATE-ABBREVIATION EQUAL 'NC'                  ELC50PD
 14763                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14764                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14765                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14766                                                                  ELC50PD
 14767     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14768        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14769            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14770              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)ELC50PD
 14771                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT  ELC50PD
 14772                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14773                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14774                 MOVE  ER-1910           TO  WS-ERROR             ELC50PD
 14775                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 14776                                                                  ELC50PD
 14777     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14778        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14779            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)  ELC50PD
 14780               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT    ELC50PD
 14781               MOVE  ER-1910           TO  WS-ERROR               ELC50PD
 14782               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 14783                                                                  ELC50PD
 14784     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14785        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14786            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14787                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)      ELC50PD
 14788                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14789                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14790                 MOVE  +0       TO  WS-ERROR.                     ELC50PD
 14791                                                                  ELC50PD
 14792     IF WS-ERROR = ER-2693                                        ELC50PD
 14793        IF PB-COMPANY-ID = 'JAL' AND                              ELC50PD
 14794           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'      ELC50PD
 14795           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14796           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14797                                                                  ELC50PD
 14798     IF WS-ERROR = ER-2693                                        ELC50PD
 14799        IF PB-COMPANY-ID = 'NCL'  AND                             ELC50PD
 14800           PB-I-AH-BENEFIT-CD = 'OA'                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 269
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14801           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14802           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14803                                                                  ELC50PD
 14804     IF WS-ERROR = ER-2693                                        ELC50PD
 14805        IF PB-COMPANY-ID = 'CNL' AND                              ELC50PD
 14806           PB-I-LF-BENEFIT-CD = '71' OR '72'                      ELC50PD
 14807           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14808           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14809                                                                  ELC50PD
 14810     IF WS-ERROR = ER-2693                                        ELC50PD
 14811        IF PB-COMPANY-ID = 'HER'                                  ELC50PD
 14812           IF WS-LEVEL                                            ELC50PD
 14813              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14814              SUBTRACT +1    FROM PB-NO-OF-ERRORS.                ELC50PD
 14815                                                                  ELC50PD
 14816     IF ((LF-BENEFIT-FOUND) AND                                   ELC50PD
 14817         (NOT NO-LIFE-COVERAGE)  AND                              ELC50PD
 14818         (WS-LF-SPECIAL-CALC-CD = 'O'))                           ELC50PD
 14819       OR   ((AH-BENEFIT-FOUND) AND                               ELC50PD
 14820             (NOT NO-AH-COVERAGE)    AND                          ELC50PD
 14821             (WS-AH-SPECIAL-CALC-CD = 'O'))                       ELC50PD
 14822         NEXT SENTENCE                                            ELC50PD
 14823     ELSE                                                         ELC50PD
 14824         GO TO 3215-EDIT-RATES.                                   ELC50PD
 14825                                                                  ELC50PD
 14826     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 14827        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14828           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14829           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14830           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14831                                                                  ELC50PD
 14832     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 14833        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14834           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14835           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14836           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14837                                                                  ELC50PD
 14838     MOVE 'B'                    TO PB-I-OB-FLAG.                 ELC50PD
 14839                                                                  ELC50PD
 14840     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14841         NEXT SENTENCE                                            ELC50PD
 14842     ELSE                                                         ELC50PD
 14843         IF NOT NO-LIFE-COVERAGE                                  ELC50PD
 14844             IF WS-ACCT-LF-OB-RT = ZERO                           ELC50PD
 14845                MOVE ER-2641    TO WS-ERROR                       ELC50PD
 14846                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14847                                                                  ELC50PD
 14848     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14849       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE               ELC50PD
 14850         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14851         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14852         IF WS-ERROR = ER-2675                                    ELC50PD
 14853            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14854            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14855            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14856         ELSE                                                     ELC50PD
 14857            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14858            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 270
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14859                                                                  ELC50PD
 14860                                                                  ELC50PD
 14861     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14862         NEXT SENTENCE                                            ELC50PD
 14863     ELSE                                                         ELC50PD
 14864       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14865            NEXT SENTENCE
 14866       ELSE
 14867         IF NOT NO-AH-COVERAGE                                    ELC50PD
 14868             IF WS-ACCT-AH-OB-RT = ZERO                           ELC50PD
 14869                MOVE ER-2642    TO WS-ERROR                       ELC50PD
 14870                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14871                                                                  ELC50PD
 14872     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14873       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                 ELC50PD
 14874         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC        ELC50PD
 14875         IF WS-ERROR = ER-2676                                    ELC50PD
 14876            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14877            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14878            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14879         ELSE                                                     ELC50PD
 14880            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14881            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14882                                                                  ELC50PD
 14883     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14884         COMPUTE PB-I-LF-PREM-CALC ROUNDED =                      ELC50PD
 14885            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000       ELC50PD
 14886     ELSE                                                         ELC50PD
 14887         IF PB-I-LF-PREM-CALC = ZEROS                             ELC50PD
 14888             COMPUTE PB-I-LF-PREM-CALC ROUNDED =                  ELC50PD
 14889                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.  ELC50PD
 14890                                                                  ELC50PD
 14891     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14892         COMPUTE PB-I-AH-PREM-CALC ROUNDED =                      ELC50PD
 14893            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000       ELC50PD
 14894     ELSE                                                         ELC50PD
 14895         IF PB-I-AH-PREM-CALC = ZEROS                             ELC50PD
 14896             COMPUTE PB-I-AH-PREM-CALC ROUNDED =                  ELC50PD
 14897                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.  ELC50PD
 14898                                                                  ELC50PD
 14899     MOVE ZEROS TO PB-I-MORT-CODE.                                ELC50PD
 14900                                                                  ELC50PD
 14901     GO TO 3260-EDIT-CONTINUE.                                    ELC50PD
 14902                                                                  ELC50PD
 14903                                                                  ELC50PD
 14904 3215-EDIT-RATES.                                                 ELC50PD
 14905     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 14906         NEXT SENTENCE                                            ELC50PD
 14907     ELSE                                                         ELC50PD
 14908         GO TO 3999-END-EDIT.                                     ELC50PD
 14909                                                                  ELC50PD
 14910 3220-CHECK-LF-RATES.                                             ELC50PD
 14911                                                                  ELC50PD
 14912     IF PB-COMPANY-ID = 'DCC'
 14913        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14914        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14915        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14916           AND (NOT WS-LF-CASH))
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 271
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14917                           OR
 14918           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14919           AND (NOT WS-AH-CASH)))
 14920                       AND
 14921           (PB-I-ENTRY-STATUS NOT = '5')
 14922           MOVE 'M'              TO PB-BATCH-ENTRY
 14923                                    PB-I-ENTRY-STATUS
 14924        END-IF
 14925     END-IF
 14926
 14927
 14928
 14929     MOVE ZEROS                  TO PB-I-LF-PREM-CALC             ELC50PD
 14930                                    PB-I-AH-PREM-CALC             ELC50PD
 14931                                    PB-I-LF-ALT-PREM-CALC         ELC50PD
 14932                                    PB-I-LF-ALT-RATE              ELC50PD
 14933                                    PB-I-LF-REI-RATE              ELC50PD
 14934                                    PB-I-LF-ALT-REI-RATE          ELC50PD
 14935                                    PB-I-AH-REI-RATE
 14936                                    PB-I-TOT-FEES-CALC.
 14937                                                                  ELC50PD
 14938     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 14939        NEXT SENTENCE                                             ELC50PD
 14940     ELSE                                                         ELC50PD
 14941        MOVE ZEROS               TO PB-I-LF-RATE                  ELC50PD
 14942                                    PB-I-AH-RATE.                 ELC50PD
 14943                                                                  ELC50PD
 14944     IF PB-I-TOT-FEES NOT NUMERIC
 14945        MOVE ZEROS               TO PB-I-TOT-FEES
 14946     END-IF
 14947
 14948     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 14949         MOVE ZERO               TO PB-I-LIVES.                   ELC50PD
 14950                                                                  ELC50PD
 14951     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 14952         MOVE ZERO               TO PB-I-NUM-BILLED.              ELC50PD
 14953                                                                  ELC50PD
 14954     IF PB-I-LF-PREM-TAX NOT NUMERIC                              ELC50PD
 14955        MOVE +0                  TO PB-I-LF-PREM-TAX              ELC50PD
 14956     END-IF
 14957                                                                  ELC50PD
 14958     IF PB-I-AH-PREM-TAX NOT NUMERIC                              ELC50PD
 14959        MOVE +0                  TO PB-I-AH-PREM-TAX              ELC50PD
 14960     END-IF
 14961                                                                  ELC50PD
 14962     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR                         ELC50PD
 14963        PB-I-PAY-FREQUENCY = ZEROS                                ELC50PD
 14964            MOVE 12 TO CP-PAY-FREQUENCY                           ELC50PD
 14965     ELSE                                                         ELC50PD
 14966            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.          ELC50PD
 14967                                                                  ELC50PD
 14968     IF PB-I-STATE-TAX NOT NUMERIC                                ELC50PD
 14969         MOVE ZEROS               TO PB-I-STATE-TAX.              ELC50PD
 14970                                                                  ELC50PD
 14971     IF PB-I-MUNI-TAX NOT NUMERIC                                 ELC50PD
 14972         MOVE ZEROS               TO PB-I-MUNI-TAX.               ELC50PD
 14973                                                                  ELC50PD
 14974     MOVE SPACES                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 272
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14975     IF PB-COMPANY-ID  = 'CSL'  AND                               ELC50PD
 14976        PB-I-LF-TERM NOT = ZERO                                   ELC50PD
 14977        COMPUTE WS-PAYMENT-AMT =                                  ELC50PD
 14978             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM                   ELC50PD
 14979        COMPUTE WS-CSL-AMT1 =                                     ELC50PD
 14980             PB-I-LF-TERM * AM-MAX-MON-BEN                        ELC50PD
 14981        COMPUTE WS-CSL-AMT2 =                                     ELC50PD
 14982             WS-PAYMENT-AMT * PB-I-LF-TERM                        ELC50PD
 14983        IF CP-PAY-FREQUENCY NOT = 12                              ELC50PD
 14984           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT          ELC50PD
 14985           MOVE '8' TO WS-CSL-CALC-CD                             ELC50PD
 14986        ELSE                                                      ELC50PD
 14987           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND      ELC50PD
 14988              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN    ELC50PD
 14989               AM-MAX-TOT-BEN                                     ELC50PD
 14990               MOVE '6' TO WS-CSL-CALC-CD                         ELC50PD
 14991           ELSE                                                   ELC50PD
 14992              IF (WS-CSL-AMT1  GREATER THAN                       ELC50PD
 14993                 AM-MAX-TOT-BEN) AND                              ELC50PD
 14994                 (WS-CSL-AMT2  GREATER THAN                       ELC50PD
 14995                 AM-MAX-TOT-BEN)                                  ELC50PD
 14996                 MOVE '7' TO WS-CSL-CALC-CD                       ELC50PD
 14997              ELSE                                                ELC50PD
 14998                 MOVE '5' TO WS-CSL-CALC-CD.                      ELC50PD
 14999                                                                  ELC50PD
 15000     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND               ELC50PD
 15001         NEXT SENTENCE                                            ELC50PD
 15002     ELSE                                                         ELC50PD
 15003         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15004                                                                  ELC50PD
 15005*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****        ELC50PD
 15006                                                                  ELC50PD
 15007     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15008        IF (PB-I-LF-CRIT-PER    EQUAL +0)                         ELC50PD
 15009              OR                                                  ELC50PD
 15010           (PB-I-PAYMENT-AMOUNT EQUAL +0)                         ELC50PD
 15011           MOVE ER-2618          TO WS-ERROR                      ELC50PD
 15012           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15013           GO TO 3300-CHECK-AH-RATES.                             ELC50PD
 15014                                                                  ELC50PD
 15015     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15016           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL                   ELC50PD
 15017                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.        ELC50PD
 15018                                                                  ELC50PD
 15019     IF WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15020         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15021         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15022         MOVE 'Z000'              TO PB-I-MORT-CODE               ELC50PD
 15023         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC            ELC50PD
 15024         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15025                                                                  ELC50PD
 15026     IF WS-LF-SPECIAL-CALC-CD = 'Z'                               ELC50PD
 15027        IF PB-I-LIVES = ZERO                                      ELC50PD
 15028           MOVE ER-2688          TO WS-ERROR                      ELC50PD
 15029           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 15030                                                                  ELC50PD
 15031     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15032                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 273
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15033     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15034     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 15035     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 15036     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 15037     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15038     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15039     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 15040     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15041     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15042     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 15043                                                                  ELC50PD
 15044******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15045     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15046         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15047            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15048             IF PB-CERT-EFF-DT GREATER  WS-931231                 ELC50PD
 15049                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15050*******                                                           ELC50PD
 15051                                                                  ELC50PD
 15052     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15053     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15054     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 15055     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 15056     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15057     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15058                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15059     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15060         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15061                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15062     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 15063     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 15064     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 15065     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15066     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15067     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15068     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15069     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 15070     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15071                                    CP-REMAINING-TERM             ELC50PD
 15072                                    CP-LOAN-TERM.                 ELC50PD
 15073                                                                  ELC50PD
 15074     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
 15075         NEXT SENTENCE                                            ELC50PD
 15076     ELSE                                                         ELC50PD
 15077         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 15078             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15079                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 15080                                                                  ELC50PD
 15081     IF PB-COMPANY-ID EQUAL 'CSL'                                 ELC50PD
 15082        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD) ELC50PD
 15083           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -    ELC50PD
 15084                                         PB-I-LF-PREMIUM-AMT.     ELC50PD
 15085                                                                  ELC50PD
 15086     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15087         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15088            CP-EARN-AS-NET-PAY                                    ELC50PD
 15089             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15090                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 274
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15091                                                                  ELC50PD
 15092     IF (CP-TRUNCATED-LIFE)                                       ELC50PD
 15093        or ((pb-company-id = 'AHL')
 15094           and (pb-i-loan-term > pb-i-lf-term))
 15095        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 15096                                                                  ELC50PD
 15097     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15098        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15099                                                                  ELC50PD
 15100     IF CP-TERM-IS-DAYS                                           ELC50PD
 15101         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 15102     ELSE                                                         ELC50PD
 15103         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15104
 15105     IF PB-COMPANY-ID = 'DCC'
 15106        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15107        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15108        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15109        IF WS-LF-BEN-CATEGORY = 'D'
 15110           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 15111           MOVE PB-I-LIFE-COMMISSION
 15112                                 TO CP-DCC-ACT-COMM
 15113           MOVE WS-LF-BEN-CATEGORY
 15114                                 TO CP-BEN-CATEGORY
 15115        END-IF
 15116        IF (CP-BENEFIT-CD (1:1) = 'P')
 15117           AND (PB-I-LOAN-TERM NOT = ZEROS)
 15118           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 15119           add pb-i-ah-premium-amt to cp-original-premium
 15120        END-IF
 15121     END-IF
 15122
 15123     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15124         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT       ELC50PD
 15125         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15126         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.        ELC50PD
 15127                                                                  ELC50PD
 15128     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15129        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.           ELC50PD
 15130                                                                  ELC50PD
 15131     IF (CP-SPECIAL-CALC-CD = 'H')
 15132        OR (PB-COMPANY-ID = 'DCC')
 15133         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 15134                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 15135         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 15136                                                                  ELC50PD
 15137
 15138     IF (PB-COMPANY-ID = 'CID')
 15139        AND (WS-LF-EARNINGS-CALC = 'B')
 15140        AND (CP-STATE-STD-ABBRV = 'MN')
 15141        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15142                                 TO CP-ALTERNATE-BENEFIT
 15143        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 15144     END-IF
 15145
 15146     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 15147     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15148     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 275
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15149                                                                  ELC50PD
 15150     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15151        MOVE ER-2641            TO WS-ERROR                       ELC50PD
 15152        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 15153        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15154                                                                  ELC50PD
 15155     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15156        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15157           IF NOT ACCOUNT-LIFE-CHECKED                            ELC50PD
 15158              MOVE ER-2607      TO WS-ERROR                       ELC50PD
 15159              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 15160                                                                  ELC50PD
 15161
 15162******************************************************************ELC50PD
 15163*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *ELC50PD
 15164*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15165******************************************************************ELC50PD
 15166                                                                  ELC50PD
 15167* CALC LIFE AGE AT EXPIRATION.                                    00031342
 15168                                                                  00031343
 15169     COMPUTE WS-AGE-AT-EXPIRE =                                   00031344
 15170          ((PB-I-LF-TERM / 12) + PB-I-AGE).                       00031345
 15171                                                                  00031346
 15172*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15173*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15174*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15175*        MOVE ER-2709        TO WS-ERROR                          00031349
 15176*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15177*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15178                                                                  00031352
 15179*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031347
 15180*        MOVE 'X'            TO PB-FATAL-FLAG                     00031348
 15181*        MOVE ER-2718        TO WS-ERROR                          00031349
 15182*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15183*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15184                                                                  00031352
 15185* CALC A & H AGE AT EXPIRATION.                                   00031353
 15186                                                                  00031354
 15187     COMPUTE WS-AGE-AT-EXPIRE =                                   00031355
 15188          ((PB-I-AH-TERM / 12) + PB-I-AGE).                       00031356
 15189                                                                  00031357
 15190*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15191*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15192*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15193*        MOVE ER-2709        TO WS-ERROR                          00031349
 15194*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15195*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15196                                                                  00031352
 15197*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031358
 15198*        MOVE 'X'            TO PB-FATAL-FLAG                     00031359
 15199*        MOVE ER-2718        TO WS-ERROR                          00031360
 15200*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031361
 15201*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031362
 15202
 15203     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED              ELC50PD
 15204        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15205                                                                  ELC50PD
 15206     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 276
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15207        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15208                                                                  ELC50PD
 15209     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15210        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15211                                                                  ELC50PD
 15212     IF CP-ERROR-AMT-OUTSIDE-LIMIT                                ELC50PD
 15213         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS             ELC50PD
 15214         MOVE ER-2639        TO WS-ERROR                          ELC50PD
 15215         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15216                                                                  ELC50PD
 15217                                                                  00031363
 15218******************************************************************ELC50PD
 15219*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15220******************************************************************ELC50PD
 15221                                                                  ELC50PD
 15222 PREMIUM-EDITING-IS-BYPASSED.
 15223
 15224     IF (CP-R-MAX-ATT-AGE NUMERIC)
 15225        AND (CP-R-MAX-ATT-AGE > +0)
 15226        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 15227        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15228           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 15229           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15230           MOVE '1'              TO DC-OPTION-CODE
 15231           PERFORM 8500-DATE-CONVERT
 15232                                 THRU 8500-EXIT
 15233           IF NO-CONVERSION-ERROR
 15234              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15235                 MOVE ER-2661       TO WS-ERROR
 15236*                PERFORM 9900-ERROR-FORMAT
 15237*                                THRU 9900-EXIT
 15238              END-IF
 15239           END-IF
 15240        ELSE
 15241           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 15242           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15243              MOVE ER-2661       TO WS-ERROR
 15244*             PERFORM 9900-ERROR-FORMAT
 15245*                                THRU 9900-EXIT
 15246           ELSE
 15247              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15248                 MOVE ER-1570    TO WS-ERROR
 15249                 PERFORM 9900-ERROR-FORMAT
 15250                                 THRU 9900-EXIT
 15251              END-IF
 15252           END-IF
 15253        END-IF
 15254
 15255        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15256           MOVE PB-I-JOINT-BIRTHDAY
 15257                                 TO DC-BIN-DATE-1
 15258           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15259           MOVE '1'              TO DC-OPTION-CODE
 15260           PERFORM 8500-DATE-CONVERT
 15261                                 THRU 8500-EXIT
 15262           IF NO-CONVERSION-ERROR
 15263              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15264                 MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 277
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15265*                PERFORM 9900-ERROR-FORMAT
 15266*                                THRU 9900-EXIT
 15267              END-IF
 15268           ELSE
 15269              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 15270           END-IF
 15271        ELSE
 15272           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 15273             (PB-I-LF-TERM / 12)
 15274           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15275              MOVE ER-2661       TO WS-ERROR
 15276*             PERFORM 9900-ERROR-FORMAT
 15277*                                THRU 9900-EXIT
 15278           ELSE
 15279              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15280                 MOVE ER-1571    TO WS-ERROR
 15281                 PERFORM 9900-ERROR-FORMAT
 15282                                 THRU 9900-EXIT
 15283              END-IF
 15284           END-IF
 15285        END-IF
 15286        IF WS-ERROR = ER-2661
 15287           PERFORM 9900-ERROR-FORMAT
 15288                                 THRU 9900-EXIT
 15289        END-IF
 15290     END-IF
 15291
 15292*    IF CP-ERROR-ATT-OUTSIDE-LIMIT                                ELC50PD
 15293*       MOVE ER-2661             TO WS-ERROR                      ELC50PD
 15294*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15295                                                                  ELC50PD
 15296     IF CP-ERROR-AGE-OUTSIDE-LIMIT                                ELC50PD
 15297        MOVE ER-2662             TO WS-ERROR                      ELC50PD
 15298        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15299                                                                  ELC50PD
 15300     IF CP-ERROR-TERM-OUTSIDE-LIMIT                               ELC50PD
 15301        MOVE ER-2677             TO WS-ERROR                      ELC50PD
 15302        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15303                                                                  ELC50PD
 15304     IF CP-ERROR-LOAN-TERM                                        ELC50PD
 15305        MOVE ER-2648             TO WS-ERROR                      ELC50PD
 15306        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15307                                                                  ELC50PD
 15308 3221-CHECK-ERROR-RATE-OPEN.                                      ELC50PD
 15309                                                                  ELC50PD
 15310     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 15311         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 15312                                                                  ELC50PD
 15313     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 15314        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE                ELC50PD
 15315     END-IF
 15316
 15317     .
 15318 3221-CONTINUE.                                                   ELC50PD
 15319     MOVE ZEROS                  TO WS-DCC-LF-RATE
 15320                                    WS-DCC-AH-RATE
 15321
 15322     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 278
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15323        IF WS-LF-BEN-CATEGORY = 'D'
 15324           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 15325              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 15326        END-IF
 15327     END-IF
 15328
 15329     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.            ELC50PD
 15330
 15331*   X'A4FF' = 12/31/2009
 15332     IF (PB-COMPANY-ID = 'CID')
 15333        AND (WS-LF-EARNINGS-CALC = 'B')
 15334        AND (CP-STATE-STD-ABBRV = 'MN')
 15335        AND (PB-CERT-EFF-DT > X'A4FF')
 15336        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 15337     END-IF
 15338
 15339     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.           ELC50PD
 15340                                                                  ELC50PD
 15341     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.                ELC50PD
 15342     IF (PB-COMPANY-ID = 'DCC')
 15343        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15344        AND (PB-I-POLICY-IS-MONTHLY)
 15345        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 15346        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 15347     END-IF
 15348     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.         ELC50PD
 15349     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.             ELC50PD
 15350     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.            ELC50PD
 15351     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15352
 15353     IF (PB-COMPANY-ID = 'DCC')
 15354        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 15355        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 15356        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 15357        MOVE ER-2786             TO WS-ERROR
 15358        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15359     END-IF
 15360                                                                  ELC50PD
 15361     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.               ELC50PD
 15362                                                                  ELC50PD
 15363******************************************************************ELC50PD
 15364*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15365******************************************************************ELC50PD
 15366     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15367        GO TO 3225-CHECK-ALT-LIFE-RATE.                           ELC50PD
 15368                                                                  ELC50PD
 15369     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15370        GO TO 3225-CHECK-ALT-LIFE-RATE                            ELC50PD
 15371     ELSE                                                         ELC50PD
 15372       IF PB-I-LF-RATE = ZERO                                     ELC50PD
 15373          MOVE ER-2641          TO WS-ERROR                       ELC50PD
 15374          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15375                                                                  ELC50PD
 15376 3225-CHECK-ALT-LIFE-RATE.                                        ELC50PD
 15377                                                                  ELC50PD
 15378     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15379        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15380        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 279
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15381         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.                     ELC50PD
 15382                                                                  ELC50PD
 15383     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 15384         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 15385             AND PB-COMPANY-ID NOT = 'DCC')
 15386                   OR
 15387
 15388              (PB-I-LF-ALT-PREMIUM-AMT > +0
 15389              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 15390              AND PB-COMPANY-ID NOT = 'DCC')
 15391             MOVE ER-2720        TO  WS-ERROR                     ELC50PD
 15392             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 15393             GO TO 3225-RATING-CONT                               ELC50PD
 15394         ELSE                                                     ELC50PD
 15395             GO TO 3225-RATING-CONT.                              ELC50PD
 15396
 15397     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 15398        AND (AM-GPCD = 01 OR 06 OR 15)
 15399        MOVE ER-2798             TO WS-ERROR
 15400        PERFORM 9900-ERROR-FORMAT
 15401                                 THRU 9900-EXIT
 15402*       GO TO 3225-RATING-CONT
 15403     END-IF
 15404
 15405     IF (PB-COMPANY-ID = 'CID')
 15406        AND (WS-LF-EARNINGS-CALC = 'B')
 15407        AND (CP-STATE-STD-ABBRV = 'MN')
 15408        AND (PB-CERT-EFF-DT > X'A4FF')
 15409        GO TO 3225-RATING-CONT
 15410     END-IF
 15411
 15412     IF PB-COMPANY-ID = 'DCC'
 15413        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15414           AND (PB-I-POLICY-IS-MONTHLY)
 15415           GO TO 3225-RATING-CONT
 15416        END-IF
 15417     END-IF
 15418
 15419     IF PB-COMPANY-ID EQUAL 'WDS' AND                             ELC50PD
 15420        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND            ELC50PD
 15421        CP-EARN-AS-REG-BALLOON                                    ELC50PD
 15422        NEXT SENTENCE                                             ELC50PD
 15423     ELSE                                                         ELC50PD
 15424        MOVE '2'                 TO CP-EARNING-METHOD.            ELC50PD
 15425                                                                  ELC50PD
 15426 3225-SET-ALT-LIFE-RATE-LOOKUP.                                   ELC50PD
 15427                                                                  ELC50PD
 15428     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15429                                                                  ELC50PD
 15430     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15431        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15432        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15433         NEXT SENTENCE                                            ELC50PD
 15434     ELSE                                                         ELC50PD
 15435         MOVE SPACE              TO CP-SPECIAL-CALC-CD.           ELC50PD
 15436                                                                  ELC50PD
 15437     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15438     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 280
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15439     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15440                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15441     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15442         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15443                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15444
 15445     IF PB-COMPANY-ID = 'DCC'
 15446        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15447     END-IF
 15448
 15449     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15450     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15451     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15452                                    CP-REMAINING-TERM             ELC50PD
 15453                                    CP-LOAN-TERM.                 ELC50PD
 15454     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15455        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15456                                    CP-REMAINING-TERM             ELC50PD
 15457                                    CP-LOAN-TERM.                 ELC50PD
 15458                                                                  ELC50PD
 15459     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15460     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15461                                                                  ELC50PD
 15462     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15463         MOVE ER-2641            TO WS-ERROR                      ELC50PD
 15464         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15465         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15466                                                                  ELC50PD
 15467     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.             ELC50PD
 15468     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.        ELC50PD
 15469                                                                  ELC50PD
 15470     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN      ELC50PD
 15471         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15472                                                                  ELC50PD
 15473     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 15474                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 15475                                                                  ELC50PD
 15476     IF ACCOUNT-LIFE-CHECKED  OR                                  ELC50PD
 15477        PB-POLICY-IS-VOIDED   OR                                  ELC50PD
 15478        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')                    ELC50PD
 15479        GO TO 3225-CONTINUE.                                      ELC50PD
 15480                                                                  ELC50PD
 15481     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15482        GO TO 3225-CONTINUE.                                      ELC50PD
 15483                                                                  ELC50PD
 15484     IF WS-LF-BENEFIT-AMT  GREATER THAN                           ELC50PD
 15485                             EC-RT-LF-MAX-TOT-BEN                 ELC50PD
 15486        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS               ELC50PD
 15487        MOVE ER-2639       TO WS-ERROR                            ELC50PD
 15488        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15489                                                                  ELC50PD
 15490 3225-CONTINUE.                                                   ELC50PD
 15491     IF PB-I-LF-ALT-RATE = ZERO                                   ELC50PD
 15492         MOVE ER-2659            TO WS-ERROR                      ELC50PD
 15493         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15494                                                                  ELC50PD
 15495     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR                         ELC50PD
 15496        PB-I-LF-ALT-PREMIUM-AMT = ZERO                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 281
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15497        MOVE ER-2698             TO WS-ERROR                      ELC50PD
 15498        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15499                                                                  ELC50PD
 15500 3225-RATING-CONT.                                                ELC50PD
 15501                                                                  ELC50PD
 15502     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15503         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15504         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15505         IF (PB-COMPANY-ID = 'DCC')
 15506            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15507            CONTINUE
 15508         ELSE
 15509            MOVE ER-2687         TO WS-ERROR
 15510            PERFORM 9900-ERROR-FORMAT
 15511                                 THRU 9900-EXIT
 15512         END-IF
 15513         GO TO 3290-EDIT-LF-REIN-RATE
 15514     END-IF
 15515                                                                  ELC50PD
 15516* DMD RATING TEST                                                 ELC50PD
 15517     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15518         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15519         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15520         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 15521         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15522         GO TO 3290-EDIT-LF-REIN-RATE.                            ELC50PD
 15523                                                                  ELC50PD
 15524 3230-CLIENT-MORT-CD-SPECIALS.                                    ELC50PD
 15525                                                                  ELC50PD
 15526     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.                   ELC50PD
 15527     SET BIN-TO-GREG          TO TRUE.                            ELC50PD
 15528*    MOVE ' '                 TO DC-OPTION-CODE.                  ELC50PD
 15529     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15530     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.                    ELC50PD
 15531                                                                  ELC50PD
 15532 C-POS-3230-MORT-CD.                                              ELC50PD
 15533     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15534        PB-SV-CARRIER = '2'                                       ELC50PD
 15535         NEXT SENTENCE                                            ELC50PD
 15536     ELSE                                                         ELC50PD
 15537         GO TO C-POS-3240-MORT-CD.                                ELC50PD
 15538                                                                  ELC50PD
 15539     IF PB-SV-GROUPING = '030'                                    ELC50PD
 15540        AND PB-CERT-EFF-DT GREATER THAN WS-791231                 ELC50PD
 15541         MOVE '2350' TO PB-I-MORT-CODE                            ELC50PD
 15542      ELSE                                                        ELC50PD
 15543         MOVE '3300' TO PB-I-MORT-CODE.                           ELC50PD
 15544                                                                  ELC50PD
 15545                                                                  ELC50PD
 15546 C-POS-3240-MORT-CD.                                              ELC50PD
 15547     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15548        PB-SV-CARRIER = '1'                                       ELC50PD
 15549         NEXT SENTENCE                                            ELC50PD
 15550     ELSE                                                         ELC50PD
 15551         GO TO 3230-CONTINUE.                                     ELC50PD
 15552                                                                  ELC50PD
 15553     IF PB-SV-STATE = '45' OR '47'                                ELC50PD
 15554        OR PB-CERT-EFF-DT LESS THAN WS-771001                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 282
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15555         MOVE '5200' TO PB-I-MORT-CODE                            ELC50PD
 15556     ELSE                                                         ELC50PD
 15557         MOVE '8300' TO PB-I-MORT-CODE.                           ELC50PD
 15558                                                                  ELC50PD
 15559 3230-CONTINUE.                                                   ELC50PD
 15560
 15561     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'                       00033064
 15562        GO TO 3240-CONTINUE                                       00033065
 15563     END-IF
 15564
 15565     IF PB-CERT-EFF-DT > WS-971231
 15566        GO TO 3240-CONTINUE                                       00033065
 15567     END-IF
 15568
 15569     IF LF-BENEFIT-FOUND AND                                      00033066
 15570        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'                     00033067
 15571         MOVE 'F250'       TO PB-I-MORT-CODE                      00033068
 15572     ELSE                                                         00033069
 15573         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'                      00033070
 15574             MOVE '7250'   TO PB-I-MORT-CODE                      00033071
 15575         ELSE                                                     00033072
 15576             MOVE '4251'   TO PB-I-MORT-CODE                      00033073
 15577         END-IF
 15578     END-IF
 15579                                                                  00033074
 15580     .
 15581 3240-CONTINUE.                                                   ELC50PD
 15582
 15583     IF PB-COMPANY-ID NOT = 'GNL'                                 ELC50PD
 15584         GO TO 3256-CONTINUE.                                     ELC50PD
 15585                                                                  ELC50PD
 15586     IF PB-CERT-EFF-DT  LESS THAN WS-820301                       ELC50PD
 15587         MOVE 'A300' TO PB-I-MORT-CODE                            ELC50PD
 15588     ELSE                                                         ELC50PD
 15589         MOVE '8350' TO PB-I-MORT-CODE.                           ELC50PD
 15590                                                                  ELC50PD
 15591 3256-CONTINUE.                                                   ELC50PD
 15592     IF PB-COMPANY-ID NOT = 'ABL'                                 ELC50PD
 15593         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 15594                                                                  ELC50PD
 15595     IF PB-I-LF-TERM GREATER THAN 59                              ELC50PD
 15596         MOVE 'F550' TO PB-I-MORT-CODE                            ELC50PD
 15597     ELSE                                                         ELC50PD
 15598         MOVE 'E550' TO PB-I-MORT-CODE.                           ELC50PD
 15599                                                                  ELC50PD
 15600 3260-EDIT-CONTINUE.                                              ELC50PD
 15601     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.                       ELC50PD
 15602                                                                  ELC50PD
 15603 3290-EDIT-LF-REIN-RATE.                                          ELC50PD
 15604     IF LF-REIN-NSP-NOT-USED                                      ELC50PD
 15605         GO TO 3290-RATING-CONT.                                  ELC50PD
 15606                                                                  ELC50PD
 15607     IF PB-COMPANY-ID = 'DCC'
 15608        GO TO 3290-RATING-CONT.
 15609
 15610     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.         ELC50PD
 15611     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 15612     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 283
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15613     MOVE '3'                   TO CP-PROCESS-TYPE.               ELC50PD
 15614     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 15615                                                                  ELC50PD
 15616******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15617     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15618         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15619            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15620             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1                 ELC50PD
 15621*            MOVE SPACE          TO DC-OPTION-CODE                ELC50PD
 15622             SET BIN-TO-GREG     TO TRUE                          ELC50PD
 15623             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT             ELC50PD
 15624***  Y2K PROJ 7744                                                   CL*11
 15625             IF DC-GREG-DATE-CYMD GREATER 19931231                   CL*10
 15626                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15627***  Y2K PROJ 7744                                                   CL*11
 15628*******                                                           ELC50PD
 15629                                                                  ELC50PD
 15630     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 15631     MOVE PB-SV-STATE           TO CP-STATE.                      ELC50PD
 15632     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.                 ELC50PD
 15633     MOVE ZERO                  TO CP-DEVIATION-CODE              ELC50PD
 15634                                   CP-RATE-DEV-PCT.               ELC50PD
 15635     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                 ELC50PD
 15636     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT            ELC50PD
 15637                                   CP-RATING-BENEFIT-AMT.         ELC50PD
 15638                                                                  ELC50PD
 15639************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA     ELC50PD
 15640     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15641         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15642            CP-EARN-AS-NET-PAY                                    ELC50PD
 15643             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15644                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15645************                                                      ELC50PD
 15646                                                                  ELC50PD
 15647     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15648         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15649                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15650     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.           ELC50PD
 15651     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.                  ELC50PD
 15652     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.                ELC50PD
 15653     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.                 ELC50PD
 15654     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.                 ELC50PD
 15655     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.                   ELC50PD
 15656     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.            ELC50PD
 15657     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM               ELC50PD
 15658                                   CP-REMAINING-TERM              ELC50PD
 15659                                   CP-LOAN-TERM.                  ELC50PD
 15660     IF CP-TRUNCATED-LIFE                                         ELC50PD
 15661        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.                  ELC50PD
 15662                                                                  ELC50PD
 15663     IF CP-TERM-IS-DAYS                                           ELC50PD
 15664         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS         ELC50PD
 15665     ELSE                                                         ELC50PD
 15666         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15667                                                                  ELC50PD
 15668
 15669     IF PB-COMPANY-ID = 'DCC'
 15670        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 284
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15671     END-IF
 15672
 15673     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 15674          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 15675                                                                  ELC50PD
 15676     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.                         ELC50PD
 15677                                                                  ELC50PD
 15678     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15679     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15680                                                                  ELC50PD
 15681     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15682        IF PB-I-OB                                                ELC50PD
 15683           MOVE ER-2625      TO WS-ERROR                          ELC50PD
 15684           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15685           GO TO 3299-EDIT-CONTINUE                               ELC50PD
 15686        ELSE                                                      ELC50PD
 15687           MOVE ER-2643      TO WS-ERROR                          ELC50PD
 15688           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15689           GO TO 3299-EDIT-CONTINUE.                              ELC50PD
 15690                                                                  ELC50PD
 15691     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.                 ELC50PD
 15692                                                                  ELC50PD
 15693     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.                ELC50PD
 15694     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.                  ELC50PD
 15695                                                                  ELC50PD
 15696     IF PB-I-LF-REI-RATE = ZERO                                   ELC50PD
 15697         MOVE ER-2643        TO WS-ERROR                          ELC50PD
 15698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15699                                                                  ELC50PD
 15700 3290-CHECK-ALT-REIN-RATE.                                        ELC50PD
 15701                                                                  ELC50PD
 15702     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 15703        GO TO 3290-RATING-CONT.                                   ELC50PD
 15704                                                                  ELC50PD
 15705     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15706     MOVE '2'                    TO CP-EARNING-METHOD.            ELC50PD
 15707     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15708     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15709     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15710     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15711                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15712     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15713         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15714                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15715
 15716     IF PB-COMPANY-ID = 'DCC'
 15717        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15718     END-IF
 15719
 15720     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15721     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15722     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15723                                    CP-REMAINING-TERM             ELC50PD
 15724                                    CP-LOAN-TERM.                 ELC50PD
 15725     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15726        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15727                                    CP-REMAINING-TERM             ELC50PD
 15728                                    CP-LOAN-TERM.                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 285
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15729                                                                  ELC50PD
 15730     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15731     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15732                                                                  ELC50PD
 15733     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.         ELC50PD
 15734                                                                  ELC50PD
 15735     IF PB-I-LF-ALT-REI-RATE = ZERO                               ELC50PD
 15736         MOVE ER-2643            TO WS-ERROR                      ELC50PD
 15737         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15738                                                                  ELC50PD
 15739 3290-RATING-CONT.                                                ELC50PD
 15740                                                                  ELC50PD
 15741     IF PB-I-OB                                                   ELC50PD
 15742*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15743        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15744                                                                  ELC50PD
 15745 3299-EDIT-CONTINUE.                                              ELC50PD
 15746                                                                  ELC50PD
 15747     IF  PB-I-MORT-CODE GREATER THAN SPACES                       ELC50PD
 15748         NEXT SENTENCE                                            ELC50PD
 15749     ELSE                                                         ELC50PD
 15750         MOVE ER-2620           TO WS-ERROR                       ELC50PD
 15751         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15752                                                                  ELC50PD
 15753 3300-CHECK-AH-RATES.                                             ELC50PD
 15754     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND                 ELC50PD
 15755         NEXT SENTENCE                                            ELC50PD
 15756     ELSE                                                         ELC50PD
 15757         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 15758                                                                  ELC50PD
 15759     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR                        ELC50PD
 15760        ((CF-COMPANY-ID = 'DMD') AND                              ELC50PD
 15761                (NO-DMD-RATING))                                  ELC50PD
 15762         IF (PB-COMPANY-ID = 'DCC')
 15763            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15764            CONTINUE
 15765         ELSE
 15766            MOVE ER-2687         TO WS-ERROR
 15767            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15768         END-IF
 15769         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 15770         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 15771     END-IF
 15772                                                                  ELC50PD
 15773     IF PB-I-OB                                                   ELC50PD
 15774        GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15775                                                                  ELC50PD
 15776     IF WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15777         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15778         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15779         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC            ELC50PD
 15780         GO TO 3999-END-EDIT.                                     ELC50PD
 15781                                                                  ELC50PD
 15782*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****        ELC50PD
 15783                                                                  ELC50PD
 15784     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15785        IF PB-I-AH-CRIT-PER = ZERO
 15786           IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 286
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15787              AND AM-DCC-PRODUCT-CODE = 'DDF'
 15788              CONTINUE
 15789           ELSE
 15790              MOVE ER-2618       TO WS-ERROR
 15791              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15792              GO TO 3999-END-EDIT
 15793           END-IF
 15794        END-IF
 15795     END-IF
 15796
 15797     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15798     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15799     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15800     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15801     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15802     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15803     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15804     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.            ELC50PD
 15805     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.              ELC50PD
 15806*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15807     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 15808     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15809     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15810     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15811                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15812     IF PB-COMPANY-ID = 'CID'
 15813               OR
 15814        CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15815         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 15816                                         PB-I-AH-TERM.            ELC50PD
 15817     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 15818        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 15819           AND (PB-I-POLICY-IS-MONTHLY)
 15820           MOVE PB-I-LF-BENEFIT-AMT
 15821                                 TO CP-NET-BENEFIT-AMT
 15822           move pb-i-ah-premium-amt to cp-original-premium
 15823           add pb-i-lf-premium-amt to cp-original-premium
 15824        END-IF
 15825     END-IF
 15826
 15827     MOVE SPACES                 TO CP-BEN-CATEGORY
 15828
 15829     IF PB-COMPANY-ID = 'DCC'
 15830        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 15831        EVALUATE TRUE
 15832           WHEN (WS-AH-BEN-CATEGORY = 'G')
 15833              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15834              MOVE PB-I-LF-BENEFIT-AMT
 15835                                 TO CP-RATING-BENEFIT-AMT
 15836              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 15837           WHEN WS-AH-BEN-CATEGORY = 'G'
 15838              MOVE PB-I-UNPAID-CASH-PRICE
 15839                                 TO CP-RATING-BENEFIT-AMT
 15840           WHEN WS-AH-BEN-CATEGORY = 'D'
 15841              MOVE WS-AH-PMF-COMM
 15842                                 TO CP-DCC-PMF-COMM
 15843              MOVE PB-I-AH-COMMISSION
 15844                                 TO CP-DCC-ACT-COMM
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 287
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15845        END-EVALUATE
 15846     END-IF
 15847
 15848     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 15849     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15850     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15851     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15852     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15853     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.           ELC50PD
 15854     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15855                                    CP-REMAINING-TERM             ELC50PD
 15856                                    WS-WORK-TERM.                 ELC50PD
 15857     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.          ELC50PD
 15858                                                                  ELC50PD
 15859     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 15860     SET BIN-TO-GREG             TO TRUE.                         ELC50PD
 15861*    MOVE ' '                    TO DC-OPTION-CODE.               ELC50PD
 15862     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15863     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.                 ELC50PD
 15864                                                                  ELC50PD
 15865     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.           ELC50PD
 15866     IF NOT VALID-SKIP-CODE                                       ELC50PD
 15867         MOVE ER-2683            TO WS-ERROR                      ELC50PD
 15868         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15869         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15870                                                                  ELC50PD
 15871     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 15872         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15873                                                                  ELC50PD
 15874     MOVE SPACE TO NUMBER-OF-MONTHS.                              ELC50PD
 15875                                                                  ELC50PD
 15876     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'                        ELC50PD
 15877         MOVE 'S'                TO SK-MO (6).                    ELC50PD
 15878     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'          ELC50PD
 15879         MOVE 'S'                TO SK-MO (7).                    ELC50PD
 15880     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'   ELC50PD
 15881         MOVE 'S'                TO SK-MO (8).                    ELC50PD
 15882     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'                 ELC50PD
 15883         MOVE 'S'                TO SK-MO (9).                    ELC50PD
 15884     IF PB-I-SKIP-CODE = 'A'                                      ELC50PD
 15885         MOVE 'S'                TO SK-MO (10).                   ELC50PD
 15886                                                                  ELC50PD
 15887     MOVE 1                      TO SUB2.                         ELC50PD
 15888     MOVE PB-I-AH-TERM           TO SUB3.                         ELC50PD
 15889     MOVE WS-MONTH               TO SUB1.                         ELC50PD
 15890     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.       ELC50PD
 15891     GO TO 3320-RATE-CONTINUE.                                    ELC50PD
 15892                                                                  ELC50PD
 15893 3310-GET-SKIP-MO.                                                ELC50PD
 15894     IF SUB1 = 13                                                 ELC50PD
 15895         MOVE 1                  TO SUB1.                         ELC50PD
 15896                                                                  ELC50PD
 15897     IF SK-MO (SUB1) = 'S'                                        ELC50PD
 15898         SUBTRACT 1 FROM WS-WORK-TERM.                            ELC50PD
 15899                                                                  ELC50PD
 15900     ADD 1 TO SUB2                                                ELC50PD
 15901              SUB1.                                               ELC50PD
 15902                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 288
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15903 3320-RATE-CONTINUE.                                              ELC50PD
 15904                                                                  ELC50PD
 15905     IF WS-WORK-TERM = ZERO                                       ELC50PD
 15906         MOVE 1                  TO WS-WORK-TERM.                 ELC50PD
 15907                                                                  ELC50PD
 15908     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM              ELC50PD
 15909                                    CP-LOAN-TERM.                 ELC50PD
 15910                                                                  ELC50PD
 15911     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15912         NEXT SENTENCE                                            ELC50PD
 15913     ELSE                                                         ELC50PD
 15914         MOVE ZERO               TO PB-I-AH-RATE                  ELC50PD
 15915                                    PB-I-AH-REI-RATE.             ELC50PD
 15916                                                                  ELC50PD
 15917                                                                  ELC50PD
 15918     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15919        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15920                                                                  ELC50PD
 15921     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15922         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN              ELC50PD
 15923         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN              ELC50PD
 15924         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15925         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.               ELC50PD
 15926                                                                  ELC50PD
 15927     IF PB-COMPANY-ID = 'DCC'
 15928        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15929           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15930              PB-I-RATE-DEV-PCT-LF
 15931        END-IF
 15932        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15933                                 TO CP-ALTERNATE-BENEFIT
 15934        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15935        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15936        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15937     END-IF
 15938
 15939     IF (PB-COMPANY-ID = 'CID')
 15940        AND (WS-LF-EARNINGS-CALC = 'B')
 15941        AND (CP-STATE-STD-ABBRV = 'MN')
 15942        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 15943     ELSE
 15944        MOVE ' '                 TO CP-AH-BALLOON-SW
 15945     END-IF
 15946
 15947     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 15948     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15949     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15950                                                                  ELC50PD
 15951     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15952        IF PB-I-OB                                                ELC50PD
 15953           MOVE ER-2624          TO WS-ERROR                      ELC50PD
 15954           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15955           GO TO 3340-CALCULATE-PREMIUM-AMT                       ELC50PD
 15956        ELSE                                                      ELC50PD
 15957          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 15958              NEXT SENTENCE
 15959          ELSE
 15960           MOVE ER-2642          TO WS-ERROR                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 289
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15961           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15962           GO TO 3340-CALCULATE-PREMIUM-AMT.                      ELC50PD
 15963                                                                  ELC50PD
 15964     IF PB-COMPANY-ID EQUAL 'CSL' AND                             ELC50PD
 15965        CP-ERROR-DIV-BY-ZERO                                      ELC50PD
 15966           MOVE ER-3782          TO WS-ERROR                      ELC50PD
 15967           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 15968                                                                  ELC50PD
 15969     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15970        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15971           IF NOT ACCOUNT-AH-CHECKED                              ELC50PD
 15972              MOVE ER-2607          TO WS-ERROR                   ELC50PD
 15973              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 15974                                                                  ELC50PD
 15975     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 15976        NEXT SENTENCE                                             ELC50PD
 15977     ELSE                                                         ELC50PD
 15978       IF CP-ERROR-AMT-OUTSIDE-LIMIT                              ELC50PD
 15979          MOVE ER-2640           TO WS-ERROR                      ELC50PD
 15980          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15981                                                                  ELC50PD
 15982     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 15983         IF WS-ERROR = ER-2640                                    ELC50PD
 15984             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 15985
 15986     IF ACCOUNT-AH-CHECKED
 15987        CONTINUE
 15988     ELSE
 15989        IF (CP-R-MAX-ATT-AGE NUMERIC)
 15990           AND (CP-R-MAX-ATT-AGE > +0)
 15991           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 15992           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 15993              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 15994              MOVE PB-I-AH-EXPIRE-DT
 15995                                 TO DC-BIN-DATE-2
 15996              MOVE '1'           TO DC-OPTION-CODE
 15997              PERFORM 8500-DATE-CONVERT
 15998                                 THRU 8500-EXIT
 15999              IF NO-CONVERSION-ERROR
 16000                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16001                    MOVE ER-2661       TO WS-ERROR
 16002*                   PERFORM 9900-ERROR-FORMAT
 16003*                                THRU 9900-EXIT
 16004                 END-IF
 16005              END-IF
 16006           ELSE
 16007              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 16008              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16009                 MOVE ER-2661    TO WS-ERROR
 16010*                PERFORM 9900-ERROR-FORMAT
 16011*                                THRU 9900-EXIT
 16012              ELSE
 16013                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16014                    MOVE ER-1570 TO WS-ERROR
 16015                    PERFORM 9900-ERROR-FORMAT
 16016                                 THRU 9900-EXIT
 16017                 END-IF
 16018              END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 290
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16019           END-IF
 16020
 16021           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 16022              MOVE PB-I-JOINT-BIRTHDAY
 16023                                    TO DC-BIN-DATE-1
 16024              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 16025              MOVE '1'              TO DC-OPTION-CODE
 16026              PERFORM 8500-DATE-CONVERT
 16027                                    THRU 8500-EXIT
 16028              IF NO-CONVERSION-ERROR
 16029                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16030                    MOVE ER-2661       TO WS-ERROR
 16031*                   PERFORM 9900-ERROR-FORMAT
 16032*                                   THRU 9900-EXIT
 16033                 END-IF
 16034              END-IF
 16035           ELSE
 16036              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 16037                (PB-I-AH-TERM / 12)
 16038              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16039                 MOVE ER-2661       TO WS-ERROR
 16040*                PERFORM 9900-ERROR-FORMAT
 16041*                                   THRU 9900-EXIT
 16042              ELSE
 16043                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16044                    MOVE ER-1571 TO WS-ERROR
 16045                    PERFORM 9900-ERROR-FORMAT
 16046                                 THRU 9900-EXIT
 16047                 END-IF
 16048              END-IF
 16049           END-IF
 16050           IF WS-ERROR = ER-2661
 16051              PERFORM 9900-ERROR-FORMAT
 16052                                    THRU 9900-EXIT
 16053           END-IF
 16054        END-IF
 16055     END-IF
 16056
 16057*    IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16058*       NEXT SENTENCE                                             ELC50PD
 16059*    ELSE                                                         ELC50PD
 16060*       IF CP-ERROR-ATT-OUTSIDE-LIMIT                             ELC50PD
 16061*          MOVE ER-2661          TO WS-ERROR                      ELC50PD
 16062*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16063                                                                  ELC50PD
 16064     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16065        NEXT SENTENCE                                             ELC50PD
 16066     ELSE                                                         ELC50PD
 16067        IF CP-ERROR-AGE-OUTSIDE-LIMIT                             ELC50PD
 16068           MOVE ER-2663          TO WS-ERROR                      ELC50PD
 16069           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16070                                                                  ELC50PD
 16071     IF ACCOUNT-AH-CHECKED OR                                     ELC50PD
 16072        (WS-AH-SPECIAL-CALC-CD = 'Z') OR                          ELC50PD
 16073         PB-POLICY-IS-VOIDED                                      ELC50PD
 16074        NEXT SENTENCE                                             ELC50PD
 16075     ELSE                                                         ELC50PD
 16076        IF CP-ERROR-TOT-OUTSIDE-LIMIT                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 291
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16077           MOVE ER-2667            TO WS-ERROR                    ELC50PD
 16078           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16079                                                                  ELC50PD
 16080     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16081         IF WS-ERROR = ER-2667                                    ELC50PD
 16082             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16083                                                                  ELC50PD
 16084     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16085        NEXT SENTENCE                                             ELC50PD
 16086     ELSE                                                         ELC50PD
 16087        IF CP-ERROR-TERM-OUTSIDE-LIMIT                            ELC50PD
 16088           MOVE ER-2678            TO WS-ERROR                    ELC50PD
 16089           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16090                                                                  ELC50PD
 16091     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 16092         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 16093                                                                  ELC50PD
 16094 3321-CONTINUE.                                                   ELC50PD
 16095     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.                 ELC50PD
 16096     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.            ELC50PD
 16097
 16098     IF (PB-COMPANY-ID = 'DCC')
 16099        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16100        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 16101                                    PB-I-LF-ALT-PREM-CALC
 16102        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 16103        IF WS-AH-BEN-CATEGORY = 'G'
 16104           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16105           + PB-I-ADDL-CLP)
 16106           * (1 + WS-TOL-CLP-PCT)
 16107*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 16108        ELSE
 16109           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16110           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 16111*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 16112        END-IF
 16113        MOVE WS-TOL-LF-HIGH-PREM-AMT
 16114                                 TO PB-I-AH-PREM-CALC
 16115        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 16116           MOVE ER-8152          TO WS-ERROR
 16117           PERFORM 9900-ERROR-FORMAT
 16118                                 THRU 9900-EXIT
 16119        ELSE
 16120           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 16121                 PB-I-ADDL-CLP)
 16122              MOVE ER-8148       TO WS-ERROR
 16123              PERFORM 9900-ERROR-FORMAT
 16124                                 THRU 9900-EXIT
 16125           END-IF
 16126        END-IF
 16127     END-IF
 16128     IF (PB-COMPANY-ID = 'DCC')
 16129        AND (PB-I-POLICY-IS-MONTHLY)
 16130        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16131        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 16132        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 16133           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 16134        END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 292
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16135     END-IF
 16136
 16137     IF (PB-COMPANY-ID = 'DCC')
 16138        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 16139        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 16140        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 16141        MOVE ER-2786             TO WS-ERROR
 16142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16143     END-IF
 16144
 16145     MOVE +0                     TO PB-I-AH-CLP
 16146     IF PB-COMPANY-ID = 'DCC'
 16147        IF WS-AH-BEN-CATEGORY = 'D'
 16148           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 16149              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 16150        ELSE
 16151           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 16152              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 16153           END-IF
 16154        END-IF
 16155     END-IF
 16156
 16157     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.           ELC50PD
 16158                                                                  ELC50PD
 16159     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC                           ELC50PD
 16160         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16161                                                                  ELC50PD
 16162     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC                           ELC50PD
 16163         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.          ELC50PD
 16164                                                                  ELC50PD
 16165     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16166         IF PB-I-NO-OF-PAYMENTS = ZERO  OR                        ELC50PD
 16167            PB-I-PAYMENT-AMOUNT = ZERO                            ELC50PD
 16168             NEXT SENTENCE                                        ELC50PD
 16169         ELSE                                                     ELC50PD
 16170             COMPUTE PB-I-AH-PREM-CALC =                          ELC50PD
 16171                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *    ELC50PD
 16172                 (CP-PREMIUM-RATE / 100)                          ELC50PD
 16173             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO                   ELC50PD
 16174                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *  ELC50PD
 16175                                             PB-I-RATE-DEV-PCT-AH.ELC50PD
 16176                                                                  ELC50PD
 16177     IF PB-I-AH-RATE  = ZERO                                      ELC50PD
 16178       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16179           NEXT SENTENCE
 16180       ELSE
 16181         MOVE ER-2642            TO WS-ERROR                      ELC50PD
 16182         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16183                                                                  ELC50PD
 16184     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.                ELC50PD
 16185     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.         ELC50PD
 16186     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.             ELC50PD
 16187     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.            ELC50PD
 16188     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.         ELC50PD
 16189     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.         ELC50PD
 16190                                                                  ELC50PD
 16191     IF (PB-COMPANY-ID = 'DCC')
 16192        AND (WS-AH-BEN-CATEGORY = 'G')
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 293
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16193        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16194        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 16195        IF CP-DEVIATION-CODE NOT = '000'
 16196           MOVE '000'            TO CP-DEVIATION-CODE
 16197           PERFORM 7000-GET-RATE THRU 7000-EXIT
 16198           IF NO-CP-ERROR
 16199              COMPUTE PB-I-DDF-IU-RATE-UP =
 16200              PB-I-AH-CLP - CP-CALC-PREMIUM
 16201           ELSE
 16202              MOVE ER-3057        TO WS-ERROR
 16203              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16204           END-IF
 16205        END-IF
 16206     END-IF
 16207
 16208     .
 16209 3335-EDIT-AH-REIN-NSP-RATE.                                      ELC50PD
 16210     IF AH-REIN-NSP-NOT-USED                                      ELC50PD
 16211         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16212                                                                  ELC50PD
 16213     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.                       ELC50PD
 16214     IF PB-COMPANY-ID = 'DCC'
 16215         GO TO 3340-CALCULATE-PREMIUM-AMT.
 16216
 16217     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 16218     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 16219     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 16220     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16221     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16222     MOVE ZERO                   TO CP-DEVIATION-CODE             ELC50PD
 16223                                    CP-RATE-DEV-PCT.              ELC50PD
 16224*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 16225     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 16226     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16227     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16228     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16229                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16230     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16231         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 16232                                         PB-I-AH-TERM.            ELC50PD
 16233     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 16234     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16235     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16236     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16237     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16238     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16239                                    CP-REMAINING-TERM             ELC50PD
 16240                                    WS-WORK-TERM.                 ELC50PD
 16241     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.           ELC50PD
 16242
 16243     IF PB-COMPANY-ID = 'DCC'
 16244        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16245     END-IF
 16246
 16247     IF  PB-COMPANY-ID = 'TIC'                                    ELC50PD
 16248         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'             ELC50PD
 16249            MOVE ZERO TO CP-CLASS-CODE.                           ELC50PD
 16250                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 294
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16251     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 16252          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 16253                                                                  ELC50PD
 16254     MOVE ZERO               TO CP-DEVIATION-CODE.                ELC50PD
 16255                                                                  ELC50PD
 16256     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.                         ELC50PD
 16257                                                                  ELC50PD
 16258     MOVE ZERO               TO PB-I-AH-REI-RATE.                 ELC50PD
 16259                                                                  ELC50PD
 16260     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16261     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16262                                                                  ELC50PD
 16263     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16264         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 16266         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16267                                                                  ELC50PD
 16268     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.                 ELC50PD
 16269                                                                  ELC50PD
 16270     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.                ELC50PD
 16271     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.                  ELC50PD
 16272                                                                  ELC50PD
 16273     IF PB-I-AH-REI-RATE = ZERO                                   ELC50PD
 16274         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16276                                                                  ELC50PD
 16277                                                                  ELC50PD
 16278 3340-CALCULATE-PREMIUM-AMT.                                      ELC50PD
 16279                                                                  ELC50PD
 16280     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 16281         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR                      ELC50PD
 16282             WS-AH-SPECIAL-CALC-CD = 'O')                         ELC50PD
 16283             GO TO 3999-END-EDIT.                                 ELC50PD
 16284                                                                  ELC50PD
 16285     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR       ELC50PD
 16286                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR       ELC50PD
 16287                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'          ELC50PD
 16288                         OR 'AHL'
 16289         NEXT SENTENCE                                            ELC50PD
 16290     ELSE                                                         ELC50PD
 16291         IF WS-STATE-ABBREVIATION = 'CT'                          ELC50PD
 16292             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND ELC50PD
 16293                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)       ELC50PD
 16294                 COMPUTE PB-I-LF-PREM-CALC =                      ELC50PD
 16295                                     PB-I-LF-PREM-CALC * .90      ELC50PD
 16296                 COMPUTE PB-I-LF-ALT-PREM-CALC =                  ELC50PD
 16297                                     PB-I-LF-ALT-PREM-CALC * .90  ELC50PD
 16298                 COMPUTE PB-I-AH-PREM-CALC =                      ELC50PD
 16299                                     PB-I-AH-PREM-CALC * .90.     ELC50PD
 16300                                                                  ELC50PD
 16301     IF PB-COMP-LF-PREM                                           ELC50PD
 16302        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT       ELC50PD
 16303        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.  ELC50PD
 16304                                                                  ELC50PD
 16305     IF PB-COMP-AH-PREM                                           ELC50PD
 16306        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.      ELC50PD
 16307                                                                  ELC50PD
 16308 3340-CHECK-DCC-TOT-FEES.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 295
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16309
 16310     IF (PB-COMPANY-ID = 'DCC')
 16311        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 16312        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16313        AND (PB-I-POLICY-IS-MONTHLY)
 16314        CONTINUE
 16315     ELSE
 16316        GO TO 3340-EDIT-LF-AH-TOL
 16317     END-IF
 16318
 16319     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 16320     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 16321
 16322     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16323        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16324           PB-I-RATE-DEV-PCT-LF
 16325     END-IF
 16326     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 16327        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 16328           PB-I-RATE-DEV-PCT-AH
 16329     END-IF
 16330     MOVE 'N'                    TO CP-BEN-CATEGORY
 16331
 16332     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 16333                                                                  ELC50PD
 16334     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 16335     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 16336     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 16337     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 16338     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 16339     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 16340     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 16341     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16342     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 16343     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 16344                                                                  ELC50PD
 16345     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16346     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16347     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 16348     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 16349     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16350     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16351                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16352     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16353         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 16354                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 16355     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 16356     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 16357     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 16358     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16359     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16360     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16361     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16362     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 16363     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16364                                    CP-REMAINING-TERM             ELC50PD
 16365                                    CP-LOAN-TERM.                 ELC50PD
 16366     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 296
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16367         NEXT SENTENCE                                            ELC50PD
 16368     ELSE                                                         ELC50PD
 16369         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 16370             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 16371                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 16372                                                                  ELC50PD
 16373     IF CP-TRUNCATED-LIFE                                         ELC50PD
 16374        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 16375                                                                  ELC50PD
 16376     IF CP-TERM-IS-DAYS                                           ELC50PD
 16377         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 16378     ELSE                                                         ELC50PD
 16379         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 16380                                                                  ELC50PD
 16381
 16382     IF PB-COMPANY-ID = 'DCC'
 16383        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16384     END-IF
 16385
 16386     IF CP-SPECIAL-CALC-CD = 'H'                                  ELC50PD
 16387         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 16388                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 16389         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 16390
 16391     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 16392     MOVE 'R'                    TO CP-RATE-FILE
 16393     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 16394
 16395     IF NOT CP-ERROR-RATE-NOT-FOUND
 16396        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 16397        IF (CP-DCC-LF-RATE NOT = ZEROS)
 16398           AND (CP-BENEFIT-CD (1:1) = 'S')
 16399           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 16400                                    PB-I-LF-PREMIUM-AMT
 16401        END-IF
 16402     ELSE
 16403        MOVE +0                  TO PB-I-TOT-FEES-CALC
 16404     END-IF
 16405
 16406     .
 16407 3340-EDIT-LF-AH-TOL.                                             ELC50PD
 16408                                                                  ELC50PD
 16409***    UNSIGN-WRK1    =    LIFE DIFFERENCE                        ELC50PD
 16410***    UNSIGN-WRK2    =    AH   DIFFERENCE                        ELC50PD
 16411***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE                   ELC50PD
 16412***                                                               ELC50PD
 16413     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT            ELC50PD
 16414         PB-I-AH-PREMIUM-AMT                                      ELC50PD
 16415          GIVING WS-CALC-WORK.                                    ELC50PD
 16416                                                                  ELC50PD
 16417     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM                     ELC50PD
 16418        AND WS-CALC-WORK NOT = ZERO                               ELC50PD
 16419         MOVE ER-2649            TO WS-ERROR                      ELC50PD
 16420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16421                                                                  ELC50PD
 16422     SUBTRACT PB-I-LF-PREM-CALC                                      CL**2
 16423             FROM PB-I-LF-PREMIUM-AMT                             ELC50PD
 16424                 GIVING WS-UNSIGN-WRK1.                              CL**2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 297
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16425                                                                     CL**2
 16426     SUBTRACT PB-I-LF-ALT-PREM-CALC                                  CL**2
 16427             FROM PB-I-LF-ALT-PREMIUM-AMT                         ELC50PD
 16428                 GIVING WS-UNSIGN-WRK4.                              CL**2
 16429                                                                     CL**2
 16430     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1                         CL**2
 16431                                + WS-UNSIGN-WRK4.                    CL**2
 16432                                                                     CL**2
 16433     SUBTRACT PB-I-AH-PREM-CALC                                      CL**2
 16434             FROM PB-I-AH-PREMIUM-AMT                             ELC50PD
 16435                 GIVING WS-UNSIGN-WRK2.                           ELC50PD
 16436                                                                  ELC50PD
 16437******************************************************************ELC50PD
 16438*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *ELC50PD
 16439******************************************************************ELC50PD
 16440                                                                  ELC50PD
 16441     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 16442         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 16443                                                                  ELC50PD
 16444     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 16445         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 16446                                                                  ELC50PD
 16447     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2                               CL**2
 16448             GIVING WS-UNSIGN-WRK3.                               ELC50PD
 16449                                                                  ELC50PD
 16450 3342-CONTINUE.                                                   ELC50PD
 16451                                                                  ELC50PD
 16452     IF (PB-I-LF-RATE = ZERO  AND                                 ELC50PD
 16453         PB-I-AH-RATE = ZERO)                                     ELC50PD
 16454         IF WS-LF-SPECIAL-CALC-CD = 'O' OR                        ELC50PD
 16455            WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 16456              NEXT SENTENCE                                       ELC50PD
 16457         ELSE                                                     ELC50PD
 16458             GO TO 3345-EDIT-CONTINUE.                            ELC50PD
 16459                                                                  ELC50PD
 16460     IF  PB-RECORD-BILL   =  'B' OR  'L'                          ELC50PD
 16461         NEXT SENTENCE                                            ELC50PD
 16462     ELSE                                                         ELC50PD
 16463     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'                        ELC50PD
 16464        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM             ELC50PD
 16465           IF (PB-REISSUED-CERT         OR                        ELC50PD
 16466               PB-POLICY-IS-DECLINED    OR                        ELC50PD
 16467               PB-POLICY-IS-VOIDED)                               ELC50PD
 16468              NEXT SENTENCE                                       ELC50PD
 16469           ELSE                                                   ELC50PD
 16470              IF WS-PREM-REJECT-SW = SPACE                        ELC50PD
 16471                 MOVE ER-2652    TO WS-ERROR                      ELC50PD
 16472                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16473                 GO TO 3344-CHECK-AH                              ELC50PD
 16474              ELSE                                                ELC50PD
 16475                 MOVE ER-2650    TO WS-ERROR                      ELC50PD
 16476                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16477                 GO TO 3344-CHECK-AH.                             ELC50PD
 16478                                                                  ELC50PD
 16479***                                                               ELC50PD
 16480***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES                ELC50PD
 16481***                                                               ELC50PD
 16482                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 298
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16483     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16484         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =                        ELC50PD
 16485            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16486             (1 + WS-TOL-LF-PREM-PCT)                             ELC50PD
 16487         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =                        ELC50PD
 16488            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16489             (1 - WS-TOL-LF-PREM-PCT)                             ELC50PD
 16490     ELSE                                                         ELC50PD
 16491         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 16492         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16493                                                                  ELC50PD
 16494***                                                               ELC50PD
 16495***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES                 ELC50PD
 16496***                                                               ELC50PD
 16497                                                                  ELC50PD
 16498     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL                        ELC50PD
 16499         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +              ELC50PD
 16500          WS-TOL-LF-PREM.                                         ELC50PD
 16501                                                                  ELC50PD
 16502     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL                         ELC50PD
 16503         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -            ELC50PD
 16504          WS-TOL-LF-PREM.                                         ELC50PD
 16505                                                                  ELC50PD
 16506     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16507        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.       ELC50PD
 16508                                                                  ELC50PD
 16509     IF PB-REISSUED-CERT
 16510        or PB-POLICY-IS-DECLINED
 16511        or PB-POLICY-IS-VOIDED
 16512        continue
 16513     ELSE
 16514        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16515              > WS-TOL-LF-HIGH-PREM-AMT)
 16516           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16517              < WS-TOL-LF-LOW-PREM-AMT))
 16518                      or
 16519           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16520              > WS-TOL-LF-HIGH-PREM-PCT)
 16521           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16522              < WS-TOL-LF-LOW-PREM-PCT))
 16523           IF WS-PREM-REJECT-SW = SPACE
 16524              MOVE ER-2652       TO WS-ERROR
 16525              PERFORM 9900-ERROR-FORMAT
 16526                                 THRU 9900-EXIT
 16527           ELSE
 16528              MOVE ER-2650       TO WS-ERROR
 16529              PERFORM 9900-ERROR-FORMAT
 16530                                 THRU 9900-EXIT
 16531           end-if
 16532        end-if
 16533     end-if
 16534                                                                  ELC50PD
 16535*    IF  WS-ERROR  =  ER-2650  OR  ER-2652                        ELC50PD
 16536*        IF  PB-RECORD-BILL   =  'B' OR  'L'                      ELC50PD
 16537*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16538*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16539                                                                  ELC50PD
 16540     IF WS-ERROR  =  ER-2650  OR  ER-2652
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 299
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16541        IF (PB-RECORD-BILL   =  'B' OR  'L')
 16542                      OR
 16543           ((PB-COMPANY-ID = 'DCC')
 16544           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 16545           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 16546           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 16547        END-IF
 16548     END-IF
 16549                                                                  ELC50PD
 16550     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16551        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16552           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16553              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16554                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16555                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16556                 NEXT SENTENCE                                    ELC50PD
 16557              ELSE                                                ELC50PD
 16558                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16559                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16560                                                                  ELC50PD
 16561 3344-CVL-TOLERANCE-CHECK.                                        ELC50PD
 16562                                                                  ELC50PD
 16563      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'                    ELC50PD
 16564          GO TO 3344-CHECK-AH.                                    ELC50PD
 16565                                                                  ELC50PD
 16566      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS              ELC50PD
 16567          GO TO 3344-CHECK-AH.                                    ELC50PD
 16568                                                                  ELC50PD
 16569      MOVE ZERO                  TO  WS-UNSIGN-WRK5               ELC50PD
 16570                                     WS-UNSIGN-WRK6.              ELC50PD
 16571                                                                  ELC50PD
 16572      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO               ELC50PD
 16573          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5                 ELC50PD
 16574                                 + PB-I-LF-PREMIUM-AMT            ELC50PD
 16575                                 - PB-I-LF-PREM-CALC.             ELC50PD
 16576                                                                  ELC50PD
 16577      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO           ELC50PD
 16578          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6                 ELC50PD
 16579                                 + PB-I-LF-ALT-PREMIUM-AMT        ELC50PD
 16580                                 - PB-I-LF-ALT-PREM-CALC.         ELC50PD
 16581                                                                  ELC50PD
 16582      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO                    ELC50PD
 16583          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16584              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16585                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16586                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16587              ELSE                                                ELC50PD
 16588                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16589                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16590                                                                  ELC50PD
 16591      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO                    ELC50PD
 16592          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16593              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16594                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16595                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16596              ELSE                                                ELC50PD
 16597                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16598                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 300
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16599                                                                  ELC50PD
 16600 3344-CHECK-AH.                                                   ELC50PD
 16601                                                                  ELC50PD
 16602****************************************************************  ELC50PD
 16603***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES                  ELC50PD
 16604***                                                               ELC50PD
 16605                                                                  ELC50PD
 16606     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16607         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *    ELC50PD
 16608             (1 + WS-TOL-AH-PREM-PCT)                             ELC50PD
 16609         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *    ELC50PD
 16610             (1 - WS-TOL-AH-PREM-PCT)                             ELC50PD
 16611     ELSE                                                         ELC50PD
 16612         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 16613         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16614                                                                  ELC50PD
 16615***                                                               ELC50PD
 16616***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES                   ELC50PD
 16617***                                                               ELC50PD
 16618                                                                  ELC50PD
 16619     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL                        ELC50PD
 16620         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.                      ELC50PD
 16621                                                                  ELC50PD
 16622     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL                         ELC50PD
 16623         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.                      ELC50PD
 16624                                                                  ELC50PD
 16625     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16626        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.       ELC50PD
 16627                                                                  ELC50PD
 16628     IF (PB-REISSUED-CERT)
 16629        OR (PB-POLICY-IS-DECLINED)
 16630        OR (PB-POLICY-IS-VOIDED)
 16631        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 16632        CONTINUE
 16633     ELSE
 16634        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 16635              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 16636                          or
 16637           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 16638              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 16639           IF WS-PREM-REJECT-SW = SPACE
 16640              MOVE ER-3052       TO WS-ERROR
 16641              PERFORM 9900-ERROR-FORMAT
 16642                                 THRU 9900-EXIT
 16643           ELSE
 16644              MOVE ER-3050       TO WS-ERROR
 16645              PERFORM 9900-ERROR-FORMAT
 16646                                 THRU 9900-EXIT
 16647           END-IF
 16648        END-IF
 16649     END-IF
 16650
 16651     if (pb-company-id = 'DCC')
 16652        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 16653        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 16654        and (pb-i-policy-is-monthly)
 16655        compute ws-tol-ah-high-prem-amt =
 16656           pb-i-tot-fees-calc + ws-tol-ah-prem
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 301
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16657        compute ws-tol-ah-low-prem-amt =
 16658           pb-i-tot-fees-calc - ws-tol-ah-prem
 16659        if ws-tol-ah-prem-pct > zeros
 16660           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 16661              (1 + ws-tol-ah-prem-pct)
 16662           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 16663              (1 - ws-tol-ah-prem-pct)
 16664        else
 16665           move +9999999.99      to ws-tol-ah-high-prem-pct
 16666           move +0               to ws-tol-ah-low-prem-pct
 16667        end-if
 16668        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 16669            or
 16670           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 16671                          or
 16672           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 16673           or
 16674           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 16675            move er-3049         to ws-error
 16676           perform 9900-error-format
 16677                                 thru 9900-exit
 16678
 16679        end-if
 16680     end-if
 16681
 16682     IF  WS-ERROR  =  ER-3050   OR   ER-3052                      ELC50PD
 16683         IF  PB-RECORD-BILL   =  'B' OR 'A'                       ELC50PD
 16684             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16685             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16686                                                                  ELC50PD
 16687     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16688        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16689           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16690              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16691                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16692                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16693                 NEXT SENTENCE                                    ELC50PD
 16694              ELSE                                                ELC50PD
 16695                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16696                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16697                                                                  ELC50PD
 16698     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR              ELC50PD
 16699        (WS-COMP-MAX-CAP EQUAL +0)                                ELC50PD
 16700           GO TO 3345-EDIT-CONTINUE.                              ELC50PD
 16701                                                                  ELC50PD
 16702     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)  ELC50PD
 16703        GREATER THAN WS-COMP-MAX-CAP                              ELC50PD
 16704           MOVE ER-2646          TO  WS-ERROR                     ELC50PD
 16705           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16706                                                                  ELC50PD
 16707 3345-EDIT-CONTINUE.                                              ELC50PD
 16708                                                                  ELC50PD
 16709*    IF PB-COMPANY-ID    EQUAL    'NCL'                           ELC50PD
 16710*       IF PB-ENTRY-BATCH   NUMERIC                               ELC50PD
 16711*          IF PB-ISSUE                                            ELC50PD
 16712*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO         ELC50PD
 16713*          ELSE                                                   ELC50PD
 16714*              IF PB-CANCELLATION                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 302
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16715*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.      ELC50PD
 16716                                                                  ELC50PD
 16717*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 16718*        IF  PB-I-MICROFILM-NO     NUMERIC    AND                 ELC50PD
 16719*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS                  ELC50PD
 16720*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO     ELC50PD
 16721*        ELSE                                                     ELC50PD
 16722*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 16723*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.         ELC50PD
 16724                                                                  ELC50PD
 16725     IF PB-I-POLICY-ACCEPTED                                      ELC50PD
 16726        IF PB-POLICY-IS-DECLINED  OR                              ELC50PD
 16727           PB-REISSUED-CERT  OR                                   ELC50PD
 16728           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16729           PB-POLICY-IS-VOIDED                                    ELC50PD
 16730            MOVE  ER-1891         TO  WS-ERROR                    ELC50PD
 16731            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16732        ELSE                                                      ELC50PD
 16733            MOVE SPACE            TO  PB-BATCH-ENTRY              ELC50PD
 16734            MOVE '2'              TO  PB-I-ENTRY-STATUS.          ELC50PD
 16735                                                                  ELC50PD
 16736     IF PB-I-POLICY-DECLINED                                      ELC50PD
 16737        IF PB-REISSUED-CERT  OR                                   ELC50PD
 16738           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16739           PB-POLICY-IS-VOIDED                                    ELC50PD
 16740            MOVE  ER-1906         TO  WS-ERROR                    ELC50PD
 16741            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16742        ELSE                                                      ELC50PD
 16743            MOVE  'D'             TO  PB-BATCH-ENTRY              ELC50PD
 16744                                      PB-I-ENTRY-STATUS.          ELC50PD
 16745                                                                  ELC50PD
 16746     IF PB-I-NEEDS-UNDERWRITING                                   ELC50PD
 16747        IF PB-POLICY-IS-DECLINED OR                               ELC50PD
 16748           PB-REISSUED-CERT  OR                                   ELC50PD
 16749           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16750           PB-POLICY-IS-VOIDED                                    ELC50PD
 16751            MOVE  ER-1907         TO  WS-ERROR                    ELC50PD
 16752            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16753        ELSE                                                      ELC50PD
 16754            MOVE 'U'              TO  PB-BATCH-ENTRY              ELC50PD
 16755                                      PB-I-ENTRY-STATUS.          ELC50PD
 16756                                                                  ELC50PD
 16757     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 16758        MOVE  ER-1901             TO  WS-ERROR                    ELC50PD
 16759        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16760
 16761     IF PB-COMPANY-ID = 'DCC'
 16762        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 16763        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 16764        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16765           AND (NOT WS-LF-CASH))
 16766                           OR
 16767           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16768           AND (NOT WS-AH-CASH)))
 16769                       AND
 16770           (PB-I-ENTRY-STATUS NOT = '5')
 16771           MOVE 'M'              TO PB-BATCH-ENTRY
 16772                                    PB-I-ENTRY-STATUS
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 303
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16773        END-IF
 16774     END-IF
 16775
 16776     IF  PB-COMPANY-ID NOT = 'NCL'                                ELC50PD
 16777         GO TO 3999-END-EDIT.                                     ELC50PD
 16778                                                                  ELC50PD
 16779     IF PB-REISSUED-CERT  OR                                      ELC50PD
 16780        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 16781        PB-POLICY-IS-VOIDED  OR                                   ELC50PD
 16782        PB-I-OB                                                   ELC50PD
 16783         GO TO 3999-END-EDIT.                                     ELC50PD
 16784                                                                  ELC50PD
 16785     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS                   ELC50PD
 16786         MOVE  ER-2644            TO  WS-ERROR                    ELC50PD
 16787         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 16788         GO TO 3999-END-EDIT.                                     ELC50PD
 16789                                                                  ELC50PD
 16790     MOVE 'N'                     TO  FORM-MASTER-SW.             ELC50PD
 16791     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.                   ELC50PD
 16792                                                                  ELC50PD
 16793     IF NOT FORM-MASTER-FOUND                                     ELC50PD
 16794         GO TO 3999-END-EDIT.                                     ELC50PD
 16795                                                                  ELC50PD
 16796     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW         ELC50PD
 16797                                      FORM-MASTER-AH-SW.          ELC50PD
 16798                                                                  ELC50PD
 16799     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES            ELC50PD
 16800         MOVE  +1                 TO SUB6                         ELC50PD
 16801         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.      ELC50PD
 16802                                                                  ELC50PD
 16803     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES               ELC50PD
 16804         MOVE  +1                 TO SUB6                         ELC50PD
 16805         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.      ELC50PD
 16806                                                                  ELC50PD
 16807     IF LF-FORM-MASTER-FOUND  OR                                  ELC50PD
 16808        AH-FORM-MASTER-FOUND                                      ELC50PD
 16809         GO TO 3360-CHECK-FORM-LIMITS                             ELC50PD
 16810     ELSE                                                         ELC50PD
 16811         GO TO 3999-END-EDIT.                                     ELC50PD
 16812                                                                  ELC50PD
 16813******************************************************************ELC50PD
 16814*                  3350-GET-ERFORM                               *ELC50PD
 16815*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *ELC50PD
 16816*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *ELC50PD
 16817******************************************************************ELC50PD
 16818                                                                  ELC50PD
 16819 3350-GET-ERFORM.                                                 ELC50PD
 16820                                                                  ELC50PD
 16821     IF  WK-FORM-ADDR      EQUAL    ZEROS                         ELC50PD
 16822         GO TO  3350-ERFORM-GETMAIN.                              ELC50PD
 16823                                                                  ELC50PD
 16824     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.             ELC50PD
 16825     SET ERFORM-FILE-ADDRESSED    TO  TRUE.                       ELC50PD
 16826     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 16827     MOVE 'Y'                     TO FORM-MASTER-SW.              ELC50PD
 16828                                                                  ELC50PD
 16829     IF PB-CANCELLATION                                           ELC50PD
 16830         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 304
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16831            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16832            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID               ELC50PD
 16833              GO TO 3350-EXIT                                     ELC50PD
 16834         ELSE                                                     ELC50PD
 16835             NEXT SENTENCE                                        ELC50PD
 16836     ELSE                                                         ELC50PD
 16837         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16838            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16839            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID               ELC50PD
 16840              GO TO 3350-EXIT.                                    ELC50PD
 16841                                                                  ELC50PD
 16842 3350-ERFORM-GETMAIN.                                             ELC50PD
 16843                                                                  ELC50PD
 16844     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.           ELC50PD
 16845     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.               ELC50PD
 16846                                                                  ELC50PD
 16847 3350-ERFORM-READ.                                                ELC50PD
 16848                                                                  ELC50PD
 16849     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.            ELC50PD
 16850     MOVE  PB-SV-STATE            TO  FORM-STATE.                 ELC50PD
 16851     IF PB-CANCELLATION                                           ELC50PD
 16852         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID            ELC50PD
 16853     ELSE                                                         ELC50PD
 16854         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.           ELC50PD
 16855     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.           ELC50PD
 16856                                                                  ELC50PD
 16857     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.             ELC50PD
 16858                                                                  ELC50PD
 16859     IF FORM-MASTER-FOUND                                         ELC50PD
 16860       IF PB-CANCELLATION                                         ELC50PD
 16861          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16862             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16863             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID              ELC50PD
 16864              GO  TO 3350-EXIT                                    ELC50PD
 16865          ELSE                                                    ELC50PD
 16866              NEXT SENTENCE                                       ELC50PD
 16867       ELSE                                                       ELC50PD
 16868          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16869             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16870             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID              ELC50PD
 16871              GO  TO 3350-EXIT.                                   ELC50PD
 16872                                                                  ELC50PD
 16873     MOVE  'N'                    TO  FORM-MASTER-SW.             ELC50PD
 16874     MOVE  ER-1895                TO  WS-ERROR.                   ELC50PD
 16875     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.                 ELC50PD
 16876                                                                  ELC50PD
 16877 3350-EXIT.                                                       ELC50PD
 16878      EXIT.                                                       ELC50PD
 16879                                                                  ELC50PD
 16880******************************************************************ELC50PD
 16881*                  3355-EDIT-FORM-LF-BENEFITS                    *ELC50PD
 16882*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *ELC50PD
 16883*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16884******************************************************************ELC50PD
 16885                                                                  ELC50PD
 16886 3355-EDIT-FORM-LF-BENEFITS.                                      ELC50PD
 16887                                                                  ELC50PD
 16888     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 305
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16889        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)                 ELC50PD
 16890         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW         ELC50PD
 16891         GO TO   3355-EXIT.                                       ELC50PD
 16892                                                                  ELC50PD
 16893     IF  SUB6    LESS THAN   +40                                  ELC50PD
 16894         ADD  +1      TO  SUB6                                    ELC50PD
 16895         GO TO  3355-EDIT-FORM-LF-BENEFITS.                       ELC50PD
 16896                                                                  ELC50PD
 16897     MOVE  ER-1896         TO  WS-ERROR.                          ELC50PD
 16898     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16899                                                                  ELC50PD
 16900 3355-EXIT.                                                       ELC50PD
 16901      EXIT.                                                       ELC50PD
 16902                                                                  ELC50PD
 16903******************************************************************ELC50PD
 16904*                  3356-EDIT-FORM-AH-BENEFITS                    *ELC50PD
 16905*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *ELC50PD
 16906*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16907******************************************************************ELC50PD
 16908                                                                  ELC50PD
 16909 3356-EDIT-FORM-AH-BENEFITS.                                      ELC50PD
 16910                                                                  ELC50PD
 16911     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND            ELC50PD
 16912        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)                   ELC50PD
 16913         MOVE  'Y'                TO  FORM-MASTER-AH-SW           ELC50PD
 16914         GO TO  3356-EXIT.                                        ELC50PD
 16915                                                                  ELC50PD
 16916      IF  SUB6    LESS THAN     +40                               ELC50PD
 16917          ADD  +1      TO  SUB6                                   ELC50PD
 16918          GO TO  3356-EDIT-FORM-AH-BENEFITS.                      ELC50PD
 16919                                                                  ELC50PD
 16920     MOVE  ER-1897         TO  WS-ERROR.                          ELC50PD
 16921     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16922                                                                  ELC50PD
 16923 3356-EXIT.                                                       ELC50PD
 16924      EXIT.                                                       ELC50PD
 16925                                                                  ELC50PD
 16926******************************************************************ELC50PD
 16927*                  3357-BENEFIT-SEARCH                           *ELC50PD
 16928*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *ELC50PD
 16929*   CANCELLATIONS ONLY.                                          *ELC50PD
 16930******************************************************************ELC50PD
 16931 3357-BENEFIT-SEARCH.                                             ELC50PD
 16932     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 16933         MOVE +1                          TO SUB6                 ELC50PD
 16934         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.         ELC50PD
 16935                                                                  ELC50PD
 16936     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 16937         MOVE +1                          TO SUB6                 ELC50PD
 16938         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.         ELC50PD
 16939                                                                  ELC50PD
 16940 3357-EXIT.                                                       ELC50PD
 16941     EXIT.                                                        ELC50PD
 16942                                                                  ELC50PD
 16943******************************************************************ELC50PD
 16944*                  3358-BENEFIT-LIFE-SEARCH                      *ELC50PD
 16945*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 16946*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 306
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16947*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 16948******************************************************************ELC50PD
 16949 3358-BENEFIT-LIFE-SEARCH.                                        ELC50PD
 16950     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)      ELC50PD
 16951       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)         ELC50PD
 16952         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 16953           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 16954              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 16955                     IS GREATER THAN SPACES                       ELC50PD
 16956                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 16957                                          WS-LF-REFUND-CALC       ELC50PD
 16958                 GO TO 3358-EXIT.                                 ELC50PD
 16959                                                                  ELC50PD
 16960     IF SUB6 LESS THAN +40                                        ELC50PD
 16961         ADD +1                 TO SUB6                           ELC50PD
 16962         GO TO 3358-BENEFIT-LIFE-SEARCH.                          ELC50PD
 16963                                                                  ELC50PD
 16964 3358-EXIT.                                                       ELC50PD
 16965     EXIT.                                                        ELC50PD
 16966******************************************************************ELC50PD
 16967*                  3359-BENEFIT-AH-SEARCH                        *ELC50PD
 16968*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 16969*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 16970*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 16971******************************************************************ELC50PD
 16972 3359-BENEFIT-AH-SEARCH.                                          ELC50PD
 16973     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)       ELC50PD
 16974       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)        ELC50PD
 16975         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 16976           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 16977              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 16978                      IS GREATER THAN SPACES                      ELC50PD
 16979                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 16980                                          WS-AH-REFUND-CALC       ELC50PD
 16981                 GO TO 3359-EXIT.                                 ELC50PD
 16982                                                                  ELC50PD
 16983     IF SUB6 LESS THAN +40                                        ELC50PD
 16984         ADD +1                 TO SUB6                           ELC50PD
 16985         GO TO 3359-BENEFIT-AH-SEARCH.                            ELC50PD
 16986                                                                  ELC50PD
 16987 3359-EXIT.                                                       ELC50PD
 16988     EXIT.                                                        ELC50PD
 16989                                                                  ELC50PD
 16990******************************************************************ELC50PD
 16991*                  3360-CHECK-FORM-LIMITS                        *ELC50PD
 16992*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 16993*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 16994******************************************************************ELC50PD
 16995                                                                  ELC50PD
 16996 3360-CHECK-FORM-LIMITS.                                          ELC50PD
 16997                                                                  ELC50PD
 16998     IF FO-IND-GRP-CD = 'I'  OR  'G'                              ELC50PD
 16999         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.             ELC50PD
 17000                                                                  ELC50PD
 17001     IF NOT LF-FORM-MASTER-FOUND                                  ELC50PD
 17002         GO TO 3360-CHECK-FORM-AH-LIMITS.                         ELC50PD
 17003                                                                  ELC50PD
 17004 3360-CHECK-FORM-LF-MIN-ISS-AGE.                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 307
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17005                                                                  ELC50PD
 17006     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR              ELC50PD
 17007       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND       ELC50PD
 17008        WS-LF-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17009        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17010         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17011            MOVE  ER-1911          TO  WS-ERROR                   ELC50PD
 17012            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17013         ELSE                                                     ELC50PD
 17014            MOVE  ER-1892          TO  WS-ERROR                   ELC50PD
 17015            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17016                                                                  ELC50PD
 17017 3360-CHECK-FORM-LF-ATT-AGE.                                      ELC50PD
 17018                                                                  ELC50PD
 17019     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 17020                                                                  ELC50PD
 17021     IF  FO-MAX-ATT-AGE     NUMERIC  AND                          ELC50PD
 17022         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17023         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE          ELC50PD
 17024            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17025                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17026                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17027            ELSE                                                  ELC50PD
 17028                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17029                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17030                                                                  ELC50PD
 17031 3360-CHECK-FORM-LF-MAX-ISS-AGE.                                  ELC50PD
 17032                                                                  ELC50PD
 17033     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND                      ELC50PD
 17034         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS               ELC50PD
 17035         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE       ELC50PD
 17036            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17037                MOVE  ER-1914      TO  WS-ERROR                   ELC50PD
 17038                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT      ELC50PD
 17039            ELSE                                                  ELC50PD
 17040                MOVE  ER-1899      TO  WS-ERROR                   ELC50PD
 17041                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.     ELC50PD
 17042                                                                  ELC50PD
 17043 3360-CHECK-FORM-LF-TERM-BAMT.                                    ELC50PD
 17044                                                                  ELC50PD
 17045     IF  FO-LF-MAX-TERM   NUMERIC   AND                           ELC50PD
 17046         FO-LF-MAX-TERM   GREATER THAN   ZEROS                    ELC50PD
 17047         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM          ELC50PD
 17048           IF  PB-COMPANY-ID = 'NCL'                              ELC50PD
 17049               MOVE  ER-1916       TO  WS-ERROR                   ELC50PD
 17050               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17051           ELSE                                                   ELC50PD
 17052               MOVE  ER-1902       TO  WS-ERROR                   ELC50PD
 17053               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17054                                                                  ELC50PD
 17055     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +        ELC50PD
 17056                                    PB-I-LF-ALT-BENEFIT-AMT.      ELC50PD
 17057                                                                  ELC50PD
 17058     IF  FO-MAX-LF-AMT   NUMERIC   AND                            ELC50PD
 17059         FO-MAX-LF-AMT   GREATER THAN   ZEROS                     ELC50PD
 17060         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT      ELC50PD
 17061             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17062                 MOVE  ER-1918     TO  WS-ERROR                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 308
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17063                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17064             ELSE                                                 ELC50PD
 17065                 MOVE  ER-1904     TO  WS-ERROR                   ELC50PD
 17066                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17067                                                                  ELC50PD
 17068******************************************************************ELC50PD
 17069*                  3360-CHECK-FORM-AH-LIMITS                     *ELC50PD
 17070*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17071*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17072******************************************************************ELC50PD
 17073                                                                  ELC50PD
 17074 3360-CHECK-FORM-AH-LIMITS.                                       ELC50PD
 17075                                                                  ELC50PD
 17076     IF NOT AH-FORM-MASTER-FOUND                                  ELC50PD
 17077         GO TO 3999-END-EDIT.                                     ELC50PD
 17078                                                                  ELC50PD
 17079 3360-CHECK-FORM-AH-MIN-ISS-AGE.                                  ELC50PD
 17080                                                                  ELC50PD
 17081     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR              ELC50PD
 17082       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND       ELC50PD
 17083        WS-AH-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17084        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17085         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17086            MOVE  ER-1912          TO  WS-ERROR                   ELC50PD
 17087            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17088         ELSE                                                     ELC50PD
 17089            MOVE  ER-1893          TO  WS-ERROR                   ELC50PD
 17090            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17091                                                                  ELC50PD
 17092 3360-CHECK-FORM-AH-ATT-AGE.                                      ELC50PD
 17093                                                                  ELC50PD
 17094     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 17095                                                                  ELC50PD
 17096     IF  FO-MAX-ATT-AGE     NUMERIC     AND                       ELC50PD
 17097         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17098         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE            ELC50PD
 17099            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17100                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17101                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 17102            ELSE                                                  ELC50PD
 17103                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17104                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 17105                                                                  ELC50PD
 17106 3360-CHECK-FORM-AH-MAX-ISS-AGE.                                  ELC50PD
 17107                                                                  ELC50PD
 17108     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND                     ELC50PD
 17109         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0                  ELC50PD
 17110         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE    ELC50PD
 17111            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17112                MOVE  ER-1915      TO  WS-ERROR                   ELC50PD
 17113                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17114            ELSE                                                  ELC50PD
 17115                MOVE  ER-1900      TO  WS-ERROR                   ELC50PD
 17116                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17117                                                                  ELC50PD
 17118 3360-CHECK-FORM-AH-TERM-BAMT.                                    ELC50PD
 17119                                                                  ELC50PD
 17120     IF  FO-AH-MAX-TERM    NUMERIC   AND                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 309
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17121         FO-AH-MAX-TERM    GREATER THAN  +0                       ELC50PD
 17122         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM      ELC50PD
 17123             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17124                 MOVE  ER-1917     TO  WS-ERROR                   ELC50PD
 17125                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT     ELC50PD
 17126             ELSE                                                 ELC50PD
 17127                  MOVE  ER-1903    TO  WS-ERROR                   ELC50PD
 17128                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.   ELC50PD
 17129                                                                  ELC50PD
 17130     IF  FO-MAX-AH-AMT    NUMERIC   AND                           ELC50PD
 17131         FO-MAX-AH-AMT    GREATER THAN  +0                        ELC50PD
 17132         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT   ELC50PD
 17133             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17134                 MOVE  ER-1919     TO  WS-ERROR                   ELC50PD
 17135                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17136             ELSE                                                 ELC50PD
 17137                 MOVE  ER-1905     TO  WS-ERROR                   ELC50PD
 17138                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17139                                                                  ELC50PD
 17140     GO TO 3999-END-EDIT.                                         ELC50PD
 17141                                                                  ELC50PD
 17142******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 310
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17144******************************************************************ELC50PD
 17145*                  E D I T   C A N C E L                         *ELC50PD
 17146******************************************************************ELC50PD
 17147                                                                  ELC50PD
 17148 3700-EDIT-CANCEL.                                                ELC50PD
 17149     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 17150         MOVE ZEROS                   TO WS-RES-STATE-TAX         ELC50PD
 17151                                         WS-RES-MUNI-TAX          ELC50PD
 17152                                         PB-CI-STATE-TAX          ELC50PD
 17153                                         PB-CI-MUNI-TAX           ELC50PD
 17154         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.     ELC50PD
 17155                                                                  ELC50PD
 17156*    IF PB-COMPANY-ID  EQUAL  'NCL'                               ELC50PD
 17157*       IF PB-ENTRY-BATCH  NUMERIC                                ELC50PD
 17158*          IF PB-CANCELLATION                                     ELC50PD
 17159*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO      ELC50PD
 17160*          ELSE                                                   ELC50PD
 17161*             IF PB-ISSUE                                         ELC50PD
 17162*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.     ELC50PD
 17163                                                                  ELC50PD
 17164     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 17165        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 17166     END-IF
 17167
 17168*    IF PB-C-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 17169*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.           ELC50PD
 17170                                                                  ELC50PD
 17171     IF CM-ENTRY-STATUS = 'V'                                     ELC50PD
 17172        MOVE ER-2780             TO WS-ERROR                      ELC50PD
 17173        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17174        GO TO 3999-END-EDIT.                                      ELC50PD
 17175                                                                  ELC50PD
 17176     IF CM-ENTRY-STATUS = 'D'                                     ELC50PD
 17177        MOVE ER-2781             TO WS-ERROR                      ELC50PD
 17178        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17179        GO TO 3999-END-EDIT.                                      ELC50PD
 17180                                                                  ELC50PD
 17181     IF CM-ENTRY-STATUS = 'U'                                     ELC50PD
 17182        MOVE ER-2782             TO WS-ERROR                      ELC50PD
 17183        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17184                                                                  ELC50PD
 17185***************************************************************   ELC50PD
 17186*                                                             *   ELC50PD
 17187*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *   ELC50PD
 17188*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *   ELC50PD
 17189*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *   ELC50PD
 17190*   OF ANOTHER COVERAGE.                                      *   ELC50PD
 17191*                                                             *   ELC50PD
 17192***************************************************************   ELC50PD
 17193                                                                  ELC50PD
 17194     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17195                                    PB-C-AH-CANCEL-VOID-SW.       ELC50PD
 17196                                                                  ELC50PD
 17197     IF PB-C-LF-CANCEL-AMT = ZERO                                 ELC50PD
 17198        NEXT SENTENCE                                             ELC50PD
 17199     ELSE                                                         ELC50PD
 17200        IF (PB-C-LF-CANCEL-AMT NEGATIVE)                          ELC50PD
 17201           AND                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 311
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17202           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)    ELC50PD
 17203               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17204               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17205               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17206                                                                  ELC50PD
 17207     IF PB-C-AH-CANCEL-AMT = ZERO                                 ELC50PD
 17208        NEXT SENTENCE                                             ELC50PD
 17209     ELSE                                                         ELC50PD
 17210        IF (PB-C-AH-CANCEL-AMT NEGATIVE)                          ELC50PD
 17211           AND                                                    ELC50PD
 17212           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)      ELC50PD
 17213               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW        ELC50PD
 17214               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17215               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17216                                                                  ELC50PD
 17217     IF WS-LF-EARNINGS-CALC = '4'                                 ELC50PD
 17218        MOVE '4'                   TO WS-LF-REFUND-CALC.          ELC50PD
 17219                                                                  ELC50PD
 17220     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.          ELC50PD
 17221     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.     ELC50PD
 17222     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.     ELC50PD
 17223     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.     ELC50PD
 17224     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.          ELC50PD
 17225     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.          ELC50PD
 17226                                                                  ELC50PD
 17227     MOVE ZERO                     TO PB-C-LF-REF-CALC            ELC50PD
 17228                                      PB-C-AH-REF-CALC.           ELC50PD
 17229     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.                 ELC50PD
 17230                                                                  ELC50PD
 17231******************************************************************ELC50PD
 17232*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *ELC50PD
 17233*             TO VALIDATE COVERAGE.                              *ELC50PD
 17234******************************************************************ELC50PD
 17235                                                                  ELC50PD
 17236     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND                        ELC50PD
 17237        PB-C-LF-CANCEL-AMT = ZEROS                                ELC50PD
 17238          MOVE 'N'                 TO WS-LF-CANCEL-SW             ELC50PD
 17239      ELSE                                                        ELC50PD
 17240          MOVE 'Y'                 TO WS-LF-CANCEL-SW.            ELC50PD
 17241                                                                  ELC50PD
 17242     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND                        ELC50PD
 17243        PB-C-AH-CANCEL-AMT = ZEROS                                ELC50PD
 17244          MOVE 'N'                 TO WS-AH-CANCEL-SW             ELC50PD
 17245      ELSE                                                        ELC50PD
 17246          MOVE 'Y'                 TO WS-AH-CANCEL-SW.            ELC50PD
 17247                                                                  ELC50PD
 17248     EVALUATE TRUE                                                ELC50PD
 17249         WHEN PB-CANCEL-FORCE             OR                      ELC50PD
 17250              PB-CANCEL-DATE-FORCED       OR                      ELC50PD
 17251              PB-FORCE-OFF                                        ELC50PD
 17252                  IF PB-COMPANY-ID = 'ACE'                        ELC50PD
 17253                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE     ELC50PD
 17254                  END-IF                                          ELC50PD
 17255         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR                   ELC50PD
 17256               PB-ALL-CANCEL-FORCED-NO-FEE)  AND                  ELC50PD
 17257              (PB-COMPANY-ID = 'ACE' )                            ELC50PD
 17258                  MOVE ZEROES TO PB-CI-CANCEL-FEE                 ELC50PD
 17259         WHEN OTHER                                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 312
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17260              IF PB-COMPANY-ID = 'ACE'                            ELC50PD
 17261                 MOVE ER-2794              TO WS-ERROR            ELC50PD
 17262              ELSE                                                ELC50PD
 17263                 MOVE ER-2749              TO WS-ERROR            ELC50PD
 17264              END-IF                                              ELC50PD
 17265              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 17266     END-EVALUATE.                                                ELC50PD
 17267                                                                  ELC50PD
 17268                                                                  ELC50PD
 17269*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 17270*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS              ELC50PD
 17271*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 17272*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT          ELC50PD
 17273*        ELSE                                                     ELC50PD
 17274*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.    ELC50PD
 17275                                                                  ELC50PD
 17276     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 17277     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 17278        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 17279     ELSE
 17280        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 17281     END-IF
 17282     .
 17283 3705-EDIT-CANCEL-DT.                                             ELC50PD
 17284                                                                  ELC50PD
 17285     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17286        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17287         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17288         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17289                                 TO DC-BIN-DATE-2                 ELC50PD
 17290         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17291*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17292         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17293         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17294            NEXT SENTENCE                                         ELC50PD
 17295          ELSE                                                    ELC50PD
 17296             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17297                IF PB-CANCEL-DATE-FORCED  OR                      ELC50PD
 17298                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17299                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17300                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17301                 ELSE                                             ELC50PD
 17302                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17303                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17304                                                                  ELC50PD
 17305     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17306        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17307         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17308         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17309                                 TO DC-BIN-DATE-2                 ELC50PD
 17310         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17311*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17312         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17313         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17314            NEXT SENTENCE                                         ELC50PD
 17315          ELSE                                                    ELC50PD
 17316             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17317                IF PB-CANCEL-DATE-FORCED OR                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 313
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17318                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17319                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17320                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17321                 ELSE                                             ELC50PD
 17322                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17323                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17324                                                                  ELC50PD
 17325     IF WS-ERROR = ER-2752                                        ELC50PD
 17326        AND (PB-COMPANY-ID = 'ABL'                                ELC50PD
 17327         OR  PB-COMPANY-ID = 'FGL'                                ELC50PD
 17328         OR  PB-COMPANY-ID = 'IST'                                ELC50PD
 17329         OR  PB-COMPANY-ID = 'JHL'                                ELC50PD
 17330         OR  PB-COMPANY-ID = 'LAP'                                ELC50PD
 17331         OR  PB-COMPANY-ID = 'LBL'                                ELC50PD
 17332         OR  PB-COMPANY-ID = 'NCB'                                ELC50PD
 17333         OR  PB-COMPANY-ID = 'NLI'                                ELC50PD
 17334         OR  PB-COMPANY-ID = 'OFI'                                ELC50PD
 17335         OR  PB-COMPANY-ID = 'PLI'                                ELC50PD
 17336         OR  PB-COMPANY-ID = 'TAO'                                ELC50PD
 17337         OR  PB-COMPANY-ID = 'TIC'                                ELC50PD
 17338         OR  PB-COMPANY-ID = 'HER'                                ELC50PD
 17339         OR  WS-LF-SPECIAL-CALC-CD = 'Z'                          ELC50PD
 17340         OR  WS-AH-SPECIAL-CALC-CD = 'Z')                         ELC50PD
 17341            SUBTRACT +1          FROM PB-NO-OF-ERRORS             ELC50PD
 17342            MOVE ER-2762     TO WS-ERROR                          ELC50PD
 17343            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17344                                                                  ELC50PD
 17345     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17346        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17347        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17348             MOVE ER-2733         TO WS-ERROR                     ELC50PD
 17349             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17350                                                                  ELC50PD
 17351     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17352        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17353        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17354              MOVE ER-2733        TO WS-ERROR                     ELC50PD
 17355              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17356                                                                  ELC50PD
 17357     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND                ELC50PD
 17358        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)                     ELC50PD
 17359        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND            ELC50PD
 17360           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)                 ELC50PD
 17361            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT         ELC50PD
 17362              IF PB-COMPANY-ID NOT = 'LAP'                        ELC50PD
 17363               MOVE ER-2704            TO WS-ERROR                ELC50PD
 17364               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.        ELC50PD
 17365                                                                  ELC50PD
 17366     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 17367         GO TO 3999-END-EDIT.                                     ELC50PD
 17368                                                                  ELC50PD
 17369     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17370        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 17371           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17372            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17373            MOVE PB-C-LF-CANCEL-DT                                ELC50PD
 17374                                 TO DC-BIN-DATE-2                 ELC50PD
 17375            SET ELAPSED-BETWEEN-BIN TO TRUE                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 314
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17376*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17377            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17378            IF DATE-CONVERSION-ERROR                              ELC50PD
 17379               NEXT SENTENCE                                      ELC50PD
 17380             ELSE                                                 ELC50PD
 17381                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17382                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.      ELC50PD
 17383                                                                  ELC50PD
 17384     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17385        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 17386           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17387            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17388            MOVE PB-C-AH-CANCEL-DT                                ELC50PD
 17389                                 TO DC-BIN-DATE-2                 ELC50PD
 17390            MOVE +0              TO DC-ELAPSED-DAYS               ELC50PD
 17391                                    DC-ELAPSED-MONTHS             ELC50PD
 17392            SET ELAPSED-BETWEEN-BIN  TO TRUE                      ELC50PD
 17393*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17394            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17395            IF DATE-CONVERSION-ERROR                              ELC50PD
 17396               NEXT SENTENCE                                      ELC50PD
 17397             ELSE                                                 ELC50PD
 17398                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17399                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.      ELC50PD
 17400                                                                  ELC50PD
 17401     MOVE +0                     TO DC-ELAPSED-DAYS               ELC50PD
 17402                                    DC-ELAPSED-MONTHS.            ELC50PD
 17403                                                                  ELC50PD
 17404     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR                         ELC50PD
 17405        (WS-AH-SPECIAL-CALC-CD = 'Z')                             ELC50PD
 17406          MOVE 'Z'                TO PB-CI-OB-FLAG                ELC50PD
 17407          MOVE ER-2767            TO WS-ERROR                     ELC50PD
 17408          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 17409          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC             ELC50PD
 17410          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC             ELC50PD
 17411          GO TO 3775-OVER-REF-CHK                                 ELC50PD
 17412        ELSE                                                      ELC50PD
 17413          MOVE ZEROS              TO PB-CI-LIVES                  ELC50PD
 17414                                     PB-C-LIVES                   ELC50PD
 17415          IF PB-CI-OB-FLAG NOT = 'B'                              ELC50PD
 17416             MOVE SPACE           TO PB-CI-OB-FLAG.               ELC50PD
 17417                                                                  ELC50PD
 17418     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 17419         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS          ELC50PD
 17420     ELSE                                                         ELC50PD
 17421         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.           ELC50PD
 17422                                                                  ELC50PD
 17423     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)         ELC50PD
 17424        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')     ELC50PD
 17425            MOVE ER-2760         TO WS-ERROR                      ELC50PD
 17426            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17427                                                                  ELC50PD
 17428     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17429        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17430         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17431            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17432               MOVE ER-2774       TO WS-ERROR                     ELC50PD
 17433               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 315
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17434                                                                  ELC50PD
 17435     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17436        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17437         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17438            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17439               MOVE ER-2775       TO WS-ERROR                     ELC50PD
 17440               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17441                                                                  ELC50PD
 17442     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17443        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17444         IF PB-C-LF-CANCEL-DT = LOW-VALUES                        ELC50PD
 17445            MOVE ER-2776         TO WS-ERROR                      ELC50PD
 17446            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17447                                                                  ELC50PD
 17448     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17449        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17450         IF PB-C-AH-CANCEL-DT = LOW-VALUES                        ELC50PD
 17451            MOVE ER-2777         TO WS-ERROR                      ELC50PD
 17452            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17453                                                                  ELC50PD
 17454     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17455        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17456         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17457         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17458         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17459*        MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17460         SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17461         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17462         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17463            NEXT SENTENCE                                         ELC50PD
 17464          ELSE                                                    ELC50PD
 17465            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17466              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17467                             OR  'FIA'                            ELC50PD
 17468                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT       ELC50PD
 17469               ELSE                                               ELC50PD
 17470                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW      ELC50PD
 17471                MOVE ER-2731       TO WS-ERROR                    ELC50PD
 17472                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17473                                                                  ELC50PD
 17474 3705-EDIT-AH-CANCEL-DT.                                          ELC50PD
 17475                                                                  ELC50PD
 17476     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17477        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17478         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17479         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17480         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17481*        MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17482         SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17483         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17484         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17485            NEXT SENTENCE                                         ELC50PD
 17486          ELSE                                                    ELC50PD
 17487            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17488              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17489                              OR 'FIA'                            ELC50PD
 17490                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT        ELC50PD
 17491              ELSE                                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 316
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17492               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW       ELC50PD
 17493               MOVE ER-2771       TO WS-ERROR                     ELC50PD
 17494               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17495                                                                  ELC50PD
 17496 3705-EDIT-CONTINUED.                                             ELC50PD
 17497                                                                  ELC50PD
 17498*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17499*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17500*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT  ELC50PD
 17501*            MOVE ER-2727         TO WS-ERROR                     ELC50PD
 17502*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17503*                                                                 ELC50PD
 17504*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17505*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17506*        IF PB-COMPANY-ID = 'ACE'                                 ELC50PD
 17507*           MOVE ER-2727        TO WS-ERROR                       ELC50PD
 17508*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 17509*        ELSE                                                     ELC50PD
 17510*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DTELC50PD
 17511*              MOVE ER-2727     TO WS-ERROR                       ELC50PD
 17512*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17513                                                                  ELC50PD
 17514     IF PB-COMPANY-ID = 'ACE'                                     ELC50PD
 17515       IF AH-COVERAGE-CANCELLED                                   ELC50PD
 17516         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                 ELC50PD
 17517           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT   ELC50PD
 17518              MOVE ER-2732      TO WS-ERROR                       ELC50PD
 17519              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17520                                                                  ELC50PD
 17521     IF PB-COMPANY-ID      EQUAL   'HER'                          ELC50PD
 17522        IF WS-ERROR        EQUAL   ER-2727                        ELC50PD
 17523            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS          ELC50PD
 17524            MOVE  ER-2725          TO  WS-ERROR                   ELC50PD
 17525            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17526                                                                  ELC50PD
 17527     IF PB-C-CLAIM-CREATED-CANCEL                                 ELC50PD
 17528            MOVE ER-2748         TO WS-ERROR                      ELC50PD
 17529            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17530                                                                  ELC50PD
 17531     IF PB-C-LAST-NAME NOT = SPACES                               ELC50PD
 17532         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME                  ELC50PD
 17533            MOVE ER-2747         TO WS-ERROR                      ELC50PD
 17534            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17535                                                                  ELC50PD
 17536 3710-EDIT-LUMP-SUM-PRIOR.                                        ELC50PD
 17537                                                                  ELC50PD
 17538     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17539         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17540             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT    ELC50PD
 17541                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17542                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17543                                                                  ELC50PD
 17544     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17545         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17546             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT    ELC50PD
 17547                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17548                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17549                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 317
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17550 3710-EDIT-PRIOR-DEATH.                                           ELC50PD
 17551                                                                  ELC50PD
 17552*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17553*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17554*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17555*           (NOT PB-CI-OB)                                        ELC50PD
 17556*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT           ELC50PD
 17557*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT    ELC50PD
 17558*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17559*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17560*                                                                 ELC50PD
 17561*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17562*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17563*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17564*           (NOT PB-CI-OB)                                        ELC50PD
 17565*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT           ELC50PD
 17566*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT    ELC50PD
 17567*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17568*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17569                                                                  ELC50PD
 17570     IF PB-CI-DEATH-DT NOT = LOW-VALUES                           ELC50PD
 17571         IF (PB-C-LF-CANCEL-AMT = ZERO) AND                       ELC50PD
 17572            (NOT PB-COMP-LF-CANCEL)                               ELC50PD
 17573             NEXT SENTENCE                                        ELC50PD
 17574         ELSE                                                     ELC50PD
 17575           IF PB-C-LF-CANCEL-VOIDED                               ELC50PD
 17576              NEXT SENTENCE                                       ELC50PD
 17577           ELSE                                                   ELC50PD
 17578              MOVE ER-2753      TO WS-ERROR                       ELC50PD
 17579              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17580                                                                  ELC50PD
 17581     IF CANCEL-FUTURE-DT                                          ELC50PD
 17582         GO TO 3999-END-EDIT.                                     ELC50PD
 17583                                                                  ELC50PD
 17584 3715-GET-REMAIN-TERM-LF.                                         ELC50PD
 17585                                                                  ELC50PD
 17586     IF NO-LF-BENEFIT-MATCH  OR                                   ELC50PD
 17587        WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 17588        GO TO 3730-GET-AH-REMAIN-TERM.                            ELC50PD
 17589                                                                  ELC50PD
 17590     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 17591     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17592     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17593     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17594     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17595     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17596     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 17597     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17598     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17599     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17600     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17601     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17602
 17603     IF (PB-COMPANY-ID = 'CID')
 17604        AND (CP-STATE-STD-ABBRV = 'WI')
 17605        MOVE '7'                 TO CP-REM-TERM-METHOD
 17606        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17607     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 318
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17608        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17609        MOVE WS-REM-TRM-CALC-OPTION
 17610                                 TO CP-REM-TRM-CALC-OPTION
 17611     END-IF
 17612
 17613**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 17614     IF (PB-COMPANY-ID = 'CID')
 17615        AND (CP-STATE-STD-ABBRV = 'MO')
 17616        AND (PB-CERT-EFF-DT >= X'9B41')
 17617        AND (PB-CERT-EFF-DT <= X'A2FB')
 17618        MOVE '7'                 TO CP-REM-TERM-METHOD
 17619        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17620     END-IF
 17621
 17622     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17623                                    CP-LOAN-TERM.                 ELC50PD
 17624     IF CP-TRUNCATED-LIFE                                         ELC50PD
 17625        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.                 ELC50PD
 17626                                                                  ELC50PD
 17627     IF CP-TERM-IS-DAYS                                           ELC50PD
 17628         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS        ELC50PD
 17629     ELSE                                                         ELC50PD
 17630         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17631                                                                  ELC50PD
 17632     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.                ELC50PD
 17633                                                                  ELC50PD
 17634     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17635                                                                  ELC50PD
 17636     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17637        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17638        NEXT SENTENCE                                             ELC50PD
 17639      ELSE                                                        ELC50PD
 17640          GO TO 3730-GET-AH-REMAIN-TERM.                          ELC50PD
 17641                                                                  ELC50PD
 17642 3720-GET-LF-REFUND.                                              ELC50PD
 17643                                                                  ELC50PD
 17644     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 17645        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 17646        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 17647                                                                  ELC50PD
 17648     IF PB-COMPANY-ID EQUAL 'BOA'                                 ELC50PD
 17649         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17650         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17651         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17652                                                                  ELC50PD
 17653     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR                          ELC50PD
 17654        (WS-AH-SPECIAL-CALC-CD = 'M')                             ELC50PD
 17655         MOVE ER-2767            TO WS-ERROR                      ELC50PD
 17656         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 17657         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17658         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17659         GO TO 3780-UPDATE-CANCEL-CERT.                           ELC50PD
 17660                                                                  ELC50PD
 17661     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 17662                                                                     CL**2
 17663     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 17664     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.          ELC50PD
 17665     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 319
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17666     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 17667     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 17668     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 17669
 17670     IF (PB-COMPANY-ID = 'DCC')
 17671        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17672
 17673        IF PDEF-MASTER-FOUND
 17674           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17675              (V1 > +8)
 17676              OR (PD-PROD-CODE (V1) = 'L')
 17677           END-PERFORM
 17678           IF V1 < +9
 17679              MOVE PD-MAX-AMT (V1)
 17680                           TO CP-R-MAX-TOT-BEN
 17681                              EC-AM-LF-MAX-TOT-BEN
 17682           END-IF
 17683        ELSE
 17684
 17685        MOVE ' '                 TO PDEF-MASTER-SW
 17686        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17687        MOVE PB-STATE            TO ERPDEF-STATE
 17688        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17689        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17690        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17691        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17692        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17693        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17694        IF PDEF-MASTER-FOUND
 17695           MOVE 'N'              TO PDEF-MASTER-SW
 17696           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17697           IF PDEF-MASTER-FOUND
 17698              IF (ERPDEF-KEY-SAVE (1:16) =
 17699                           PD-CONTROL-PRIMARY (1:16))
 17700                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17701                 CONTINUE
 17702              ELSE
 17703                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17704                 IF (ERPDEF-KEY-SAVE (1:16) =
 17705                           PD-CONTROL-PRIMARY (1:16))
 17706                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17707                    CONTINUE
 17708                 ELSE
 17709                    MOVE 'N'     TO PDEF-MASTER-SW
 17710                 END-IF
 17711              END-IF
 17712              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 17713
 17714              IF PDEF-MASTER-FOUND
 17715                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17716                    (V1 > +8)
 17717                    OR (PD-PROD-CODE (V1) = 'L')
 17718                 END-PERFORM
 17719                 IF V1 < +9
 17720                    MOVE PD-MAX-AMT (V1)
 17721                                 TO CP-R-MAX-TOT-BEN
 17722                                    EC-AM-LF-MAX-TOT-BEN
 17723                 END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 320
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17724              END-IF
 17725           END-IF
 17726           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17727        END-IF
 17728        END-IF
 17729     END-IF
 17730
 17731     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.               ELC50PD
 17732                                                                  ELC50PD
 17733     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.         ELC50PD
 17734                                                                  ELC50PD
 17735     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM                CL**2
 17736                                    PB-C-LF-REM-TERM.                CL**2
 17737                                                                     CL**2
 17738     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17739     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17740                                                                  ELC50PD
 17741     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17742        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17743           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK       ELC50PD
 17744           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT   ELC50PD
 17745                    + PB-CI-LF-ALT-PREMIUM-AMT)                   ELC50PD
 17746                    - CM-LF-ITD-DEATH-AMT                         ELC50PD
 17747           IF PB-C-LF-REF-CALC LESS THAN +0                       ELC50PD
 17748              MOVE +0            TO PB-C-LF-REF-CALC              ELC50PD
 17749              GO TO 3730-GET-AH-REMAIN-TERM                       ELC50PD
 17750           ELSE                                                   ELC50PD
 17751              GO TO 3730-GET-AH-REMAIN-TERM.                      ELC50PD
 17752                                                                  ELC50PD
 17753     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17754                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17755                            OR '9' OR 'G'
 17756        MOVE PB-C-LF-REFUND-OVERRIDE                              ELC50PD
 17757                                 TO CP-EARNING-METHOD.            ELC50PD
 17758                                                                  ELC50PD
 17759     if pb-company-id = 'AHL'
 17760        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 17761        if cp-class-code = spaces
 17762           move zeros            to cp-class-code
 17763        end-if
 17764     ELSE
 17765        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17766     END-IF
 17767
 17768*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17769     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17770     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17771                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17772     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17773         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17774                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17775     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17776     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
 17777     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 17778     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.            ELC50PD
 17779     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.              ELC50PD
 17780     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17781     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 321
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17782     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 17783         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 17784                                                                  ELC50PD
 17785****   N O T E   ****
 17786*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 17787*      THE OH HARD CODING IN ELCRFNDP
 17788
 17789     IF PB-COMPANY-ID = 'CID'
 17790        IF CP-STATE-STD-ABBRV = 'OH'
 17791           MOVE WS-LF-EARNINGS-CALC
 17792                                 TO CP-EARNING-METHOD
 17793        END-IF
 17794     END-IF
 17795
 17796****   N O T E   ****
 17797
 17798     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 17799         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 17800            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 17801                MOVE WS-DEFAULT-APR                               ELC50PD
 17802                                 TO  CP-LOAN-APR                  ELC50PD
 17803                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 17804                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17805            ELSE                                                  ELC50PD
 17806                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 17807                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17808
 17809     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 17810
 17811     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17812                                                                  ELC50PD
 17813     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 17814         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.           ELC50PD
 17815                                                                  ELC50PD
 17816     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17817        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17818        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17819        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17820                                                                  ELC50PD
 17821     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17822        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17823        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17824                                                                  ELC50PD
 17825     IF PB-COMPANY-ID = 'DCC'
 17826        AND PB-CI-ENTRY-STATUS = 'M'
 17827        MOVE +0                  TO PB-C-LF-REF-CALC
 17828     ELSE
 17829        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 17830     END-IF
 17831                                                                  ELC50PD
 17832     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 17833         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17834                                                                  ELC50PD
 17835*    IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 17836*       ADD +1                   TO PB-C-LF-REM-TERM              ELC50PD
 17837*                                   CP-REMAINING-TERM             ELC50PD
 17838*                                   CP-ORIGINAL-TERM.             ELC50PD
 17839                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 322
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17840     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 17841     MOVE '2'                    TO CP-EARNING-METHOD             ELC50PD
 17842                                    CP-RATING-METHOD.             ELC50PD
 17843
 17844     IF PB-COMPANY-ID = 'CID'
 17845        IF (CP-STATE-STD-ABBRV = 'MN')
 17846           AND (PB-CERT-EFF-DT > X'A4FF')
 17847           AND (WS-LF-EARNINGS-CALC = 'B')
 17848           MOVE '5'              TO CP-EARNING-METHOD
 17849           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 17850        END-IF
 17851     END-IF
 17852
 17853     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT       ELC50PD
 17854                                        CP-REMAINING-BENEFIT      ELC50PD
 17855                                        CP-RATING-BENEFIT-AMT.    ELC50PD
 17856     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17857         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17858                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17859     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.      ELC50PD
 17860     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 17861                                                                  ELC50PD
 17862     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17863                                                                  ELC50PD
 17864     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17865        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17866        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17867        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17868                                                                  ELC50PD
 17869     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17870        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17871        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17872                                                                  ELC50PD
 17873     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.             ELC50PD
 17874                                                                  ELC50PD
 17875******************************************************************ELC50PD
 17876                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 323
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17878 3730-GET-AH-REMAIN-TERM.                                         ELC50PD
 17879     IF NO-AH-BENEFIT-MATCH  OR                                   ELC50PD
 17880        WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 17881         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 17882                                                                  ELC50PD
 17883     IF PB-CI-AH-LUMP-SUM-DISAB                                   ELC50PD
 17884         IF  PB-C-AH-CANCEL-AMT = ZERO                            ELC50PD
 17885            IF NOT PB-COMP-AH-CANCEL                              ELC50PD
 17886             GO TO 3770-CHECK-REFUNDS.                            ELC50PD
 17887                                                                  ELC50PD
 17888     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 17889     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17890     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17891     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17892     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17893     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17894     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 17895     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17896     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17897     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17898     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17899     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17900
 17901     IF (PB-COMPANY-ID = 'CID')
 17902        AND (CP-STATE-STD-ABBRV = 'WI')
 17903        MOVE '7'                 TO CP-REM-TERM-METHOD
 17904        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17905     ELSE
 17906        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17907        MOVE WS-REM-TRM-CALC-OPTION
 17908                                 TO CP-REM-TRM-CALC-OPTION
 17909     END-IF
 17910
 17911     IF (PB-COMPANY-ID = 'CID')
 17912        AND (CP-STATE-STD-ABBRV = 'MO')
 17913        AND (PB-CERT-EFF-DT >= X'9B41')
 17914        AND (PB-CERT-EFF-DT <= X'A2FB')
 17915        MOVE '7'                 TO CP-REM-TERM-METHOD
 17916        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17917     END-IF
 17918
 17919     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17920                                    CP-LOAN-TERM.                 ELC50PD
 17921     IF NOT CP-TERM-IS-DAYS                                       ELC50PD
 17922         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17923                                                                  ELC50PD
 17924     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.                 ELC50PD
 17925                                                                  ELC50PD
 17926     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17927                                                                  ELC50PD
 17928     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17929        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17930        NEXT SENTENCE                                             ELC50PD
 17931      ELSE                                                        ELC50PD
 17932         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 17933                                                                  ELC50PD
 17934 3740-GET-AH-REFUND.                                              ELC50PD
 17935                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 324
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17936     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 17937        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 17938        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 17939                                                                  ELC50PD
 17940     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 17941         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17942         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 17943                                                                  ELC50PD
 17944     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1                 ELC50PD
 17945*    MOVE ' '                    TO DC-OPTION-CODE                ELC50PD
 17946     SET BIN-TO-GREG             TO TRUE                          ELC50PD
 17947     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 17948     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM             ELC50PD
 17949                                    PB-C-AH-REM-TERM.             ELC50PD
 17950     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17951     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17952                                                                  ELC50PD
 17953     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17954        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17955           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK       ELC50PD
 17956           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT   ELC50PD
 17957                    - CM-AH-ITD-AH-PMT)                           ELC50PD
 17958           IF PB-C-AH-REF-CALC LESS THAN +0                       ELC50PD
 17959              MOVE +0            TO PB-C-AH-REF-CALC              ELC50PD
 17960              GO TO 3770-CHECK-REFUNDS                            ELC50PD
 17961           ELSE                                                   ELC50PD
 17962              GO TO 3770-CHECK-REFUNDS.                           ELC50PD
 17963                                                                  ELC50PD
 17964     IF PB-COMPANY-ID = 'DCC'
 17965        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17966            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 17967           MOVE 'S'              TO CP-EARNING-METHOD
 17968        END-IF
 17969     END-IF
 17970
 17971     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17972                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17973                            OR '9' OR 'G' OR 'S'
 17974        MOVE PB-C-AH-REFUND-OVERRIDE                              ELC50PD
 17975                                 TO CP-EARNING-METHOD.            ELC50PD
 17976                                                                  ELC50PD
 17977     if pb-company-id = 'AHL'
 17978        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 17979        if cp-class-code = spaces
 17980           move zeros            to cp-class-code
 17981        end-if
 17982     ELSE
 17983        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17984     END-IF
 17985*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17986     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17987     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17988                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17989     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17990         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *   ELC50PD
 17991                                         PB-CI-AH-TERM.           ELC50PD
 17992     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17993     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 325
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17994     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 17995     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.            ELC50PD
 17996     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.              ELC50PD
 17997     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17998                                                                  ELC50PD
 17999     IF CP-STATE-STD-ABBRV = 'OH'                                 ELC50PD
 18000        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'     ELC50PD
 18001                                AND 'CID' AND 'DCC' AND 'AHL')
 18002           IF (CP-ORIGINAL-TERM GREATER 60) AND                   ELC50PD
 18003              (DC-GREG-DATE-CYMD GREATER 19831101) AND               CL**4
 18004              (PB-CI-LF-BENEFIT-CD NOT = ZERO)                    ELC50PD
 18005              MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18006           END-IF
 18007        END-IF
 18008        IF PB-COMPANY-ID = 'CID'
 18009           IF NO-LIFE-COVERAGE
 18010              IF CP-CRITICAL-PERIOD
 18011                 MOVE '2'       TO CP-EARNING-METHOD
 18012              ELSE
 18013                 MOVE '6'       TO CP-EARNING-METHOD
 18014              END-IF
 18015           ELSE
 18016              IF WS-LF-COVERAGE-TYPE = 'L'
 18017                 MOVE '2'       TO CP-EARNING-METHOD
 18018              ELSE
 18019                 IF (PB-CI-LF-TERM > +60) OR                      ELC50PD
 18020                    (WS-LF-EARNINGS-CALC = '5')
 18021                    IF CP-CRITICAL-PERIOD
 18022                       MOVE '2'  TO CP-EARNING-METHOD
 18023                    ELSE
 18024                       MOVE '6'  TO CP-EARNING-METHOD
 18025                    END-IF
 18026                 ELSE
 18027                    MOVE '1'     TO CP-EARNING-METHOD
 18028                 END-IF
 18029              END-IF
 18030           END-IF
 18031        END-IF
 18032     END-IF
 18033                                                                  ELC50PD
 18034*    IF CP-STATE-STD-ABBRV = 'VA'                                 ELC50PD
 18035*       IF DC-GREG-DATE-CYMD GREATER 19921231                        CL**4
 18036*          IF CP-ORIGINAL-TERM GREATER 61                         ELC50PD
 18037*             MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18038*          ELSE                                                   ELC50PD
 18039*             MOVE '1' TO CP-EARNING-METHOD.                      ELC50PD
 18040                                                                  ELC50PD
 18041     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 18042         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 18043                                                                  ELC50PD
 18044     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 18045         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 18046            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 18047                MOVE WS-DEFAULT-APR                               ELC50PD
 18048                                 TO  CP-LOAN-APR                  ELC50PD
 18049                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 18050                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 18051            ELSE                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 326
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18052                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 18053                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 18054
 18055     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 18056
 18057
 18058     IF PB-COMPANY-ID = 'DCC'
 18059        AND CP-CANCEL-REASON = 'R'
 18060        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18061        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 18062     END-IF
 18063
 18064     IF PB-COMPANY-ID = 'DCC'
 18065        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18066        AND (CP-EARNING-METHOD = 'D')
 18067        AND (CP-CANCEL-REASON NOT = 'R')
 18068        CONTINUE
 18069     ELSE
 18070        GO TO 3750-CONTINUE
 18071     END-IF
 18072
 18073     MOVE ' '                    TO DD-IU-SW
 18074     IF NOT PDEF-MASTER-FOUND
 18075        MOVE ' '                 TO PDEF-MASTER-SW
 18076        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 18077        MOVE PB-STATE            TO ERPDEF-STATE
 18078        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 18079        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 18080        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 18081        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 18082        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 18083        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 18084        IF PDEF-MASTER-FOUND
 18085           MOVE 'N'              TO PDEF-MASTER-SW
 18086           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18087           IF PDEF-MASTER-FOUND
 18088              IF (ERPDEF-KEY-SAVE (1:16) =
 18089                           PD-CONTROL-PRIMARY (1:16))
 18090                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18091                 CONTINUE
 18092              ELSE
 18093                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18094                 IF (ERPDEF-KEY-SAVE (1:16) =
 18095                           PD-CONTROL-PRIMARY (1:16))
 18096                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18097                    CONTINUE
 18098                 ELSE
 18099                    MOVE ER-2740 TO WS-ERROR
 18100                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18101                    GO TO 3770-CHECK-REFUNDS
 18102                 END-IF
 18103              END-IF
 18104           END-IF
 18105           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 18106        END-IF
 18107     END-IF
 18108
 18109     IF PDEF-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 327
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18110        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 18111           (V1 > +8)
 18112           OR (PD-PROD-CODE (V1) = 'I')
 18113        END-PERFORM
 18114        IF V1 < +9
 18115           SET DD-IU-PRESENT        TO TRUE
 18116        END-IF
 18117        IF WS-AH-DCC-TRUNC = 'T'
 18118           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 18119        ELSE
 18120           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 18121        END-IF
 18122        EVALUATE TRUE
 18123           WHEN WS-TERM > +168
 18124              MOVE 15               TO V1
 18125           WHEN WS-TERM > +156
 18126              MOVE 14               TO V1
 18127           WHEN WS-TERM > +144
 18128              MOVE 13               TO V1
 18129           WHEN WS-TERM > +132
 18130              MOVE 12               TO V1
 18131           WHEN WS-TERM > +120
 18132              MOVE 11               TO V1
 18133           WHEN WS-TERM > +108
 18134              MOVE 10               TO V1
 18135           WHEN WS-TERM > +96
 18136              MOVE 9                TO V1
 18137           WHEN WS-TERM > +84
 18138              MOVE 8                TO V1
 18139           WHEN WS-TERM > +72
 18140              MOVE 7                TO V1
 18141           WHEN WS-TERM > +60
 18142              MOVE 6                TO V1
 18143           WHEN WS-TERM > +48
 18144              MOVE 5                TO V1
 18145           WHEN WS-TERM > +36
 18146              MOVE 4                TO V1
 18147           WHEN WS-TERM > +24
 18148              MOVE 3                TO V1
 18149           WHEN WS-TERM > +12
 18150              MOVE 2                TO V1
 18151           WHEN OTHER
 18152              MOVE 1                TO V1
 18153        END-EVALUATE
 18154
 18155        EVALUATE TRUE
 18156*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 18157*             < +13)
 18158*             AND (DD-IU-PRESENT)
 18159*             MOVE 2                TO V2
 18160*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 18161*             MOVE 1                TO V2
 18162           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 18163              MOVE 2                TO V2
 18164           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 18165              MOVE 3                TO V2
 18166           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 18167              MOVE 4                TO V2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 328
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18168           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 18169              MOVE 5                TO V2
 18170           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 18171              MOVE 6                TO V2
 18172           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 18173              MOVE 7                TO V2
 18174           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 18175              MOVE 8                TO V2
 18176           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 18177              MOVE 9                TO V2
 18178           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 18179              MOVE 10               TO V2
 18180           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 18181              MOVE 11               TO V2
 18182           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 18183              MOVE 12               TO V2
 18184           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 18185              MOVE 13               TO V2
 18186           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 18187              MOVE 14               TO V2
 18188           WHEN OTHER
 18189              MOVE 15               TO V2
 18190        END-EVALUATE
 18191
 18192        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 18193                                 TO CP-DDF-LO-FACT
 18194        MOVE PD-UEP-FACTOR (V1 V2)
 18195                                 TO CP-DDF-HI-FACT
 18196
 18197        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 18198        MOVE CM-AH-CLP     TO CP-DDF-CLP
 18199
 18200        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 18201           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 18202        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 18203        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 18204
 18205        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 18206           + PD-1ST-YR-ADMIN-ALLOW
 18207
 18208        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18209*       IF PI-CLP-YN = 'Y'
 18210*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 18211*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 18212*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 18213*       END-IF
 18214
 18215        IF DD-IU-PRESENT
 18216           MOVE 'I'              TO CP-EARNING-METHOD
 18217        END-IF
 18218        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18219                                     CP-CLP-RATE-UP
 18220        IF CP-IU-RATE-UP NOT = ZEROS
 18221           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 18222              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 18223           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 18224              / (1 - WS-WORK-FACT)
 18225        END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 329
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18226     END-IF
 18227
 18228     .
 18229 3750-CONTINUE.
 18230
 18231     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 18232                                                                  ELC50PD
 18233     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 18234         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.           ELC50PD
 18235                                                                  ELC50PD
 18236     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18237        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18238        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18240                                                                  ELC50PD
 18241     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18242        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18243        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18244
 18245     IF PB-COMPANY-ID = 'DCC'
 18246        AND PB-CI-ENTRY-STATUS = 'M'
 18247        MOVE +0                  TO PB-C-AH-REF-CALC
 18248     ELSE
 18249        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 18250     END-IF
 18251
 18252     IF PB-COMPANY-ID = 'DCC'
 18253        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18254        AND (CP-EARNING-METHOD = 'D' OR 'I')
 18255        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18256        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 18257        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 18258        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 18259        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 18260        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 18261        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 18262     END-IF
 18263
 18264     GO TO 3770-CHECK-REFUNDS.                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 330
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18266                                                                  ELC50PD
 18267 3770-CHECK-REFUNDS.                                              ELC50PD
 18268                                                                  ELC50PD
 18269     IF PB-CI-LF-CANCEL-AMT NOT = ZERO                            ELC50PD
 18270        IF PB-C-LF-CANCEL-VOID-SW = SPACE                         ELC50PD
 18271           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18272           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18273           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC     ELC50PD
 18274           IF PB-C-LF-REF-CALC LESS THAN ZERO                     ELC50PD
 18275              MOVE ZEROS         TO PB-C-LF-REF-CALC.             ELC50PD
 18276                                                                  ELC50PD
 18277     IF PB-CI-AH-CANCEL-AMT NOT = ZERO                            ELC50PD
 18278        IF PB-C-AH-CANCEL-VOID-SW = SPACE                         ELC50PD
 18279           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18280           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18281           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC     ELC50PD
 18282           IF PB-C-AH-REF-CALC LESS THAN ZERO                     ELC50PD
 18283              MOVE ZEROS         TO PB-C-AH-REF-CALC.             ELC50PD
 18284                                                                  ELC50PD
 18285     IF PB-COMP-LF-CANCEL                                         ELC50PD
 18286        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT            ELC50PD
 18287        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18288           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18289              MOVE +0            TO  PB-C-LF-CANCEL-AMT.          ELC50PD
 18290                                                                  ELC50PD
 18291     IF PB-COMP-AH-CANCEL                                         ELC50PD
 18292        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT            ELC50PD
 18293        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18294           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18295              MOVE +0            TO  PB-C-AH-CANCEL-AMT.          ELC50PD
 18296                                                                  ELC50PD
 18297     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT               CL**2
 18298             GIVING WS-UNSIGN-WRK1                                ELC50PD
 18299     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT               CL**2
 18300             GIVING WS-UNSIGN-WRK2.                               ELC50PD
 18301                                                                  ELC50PD
 18302     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18303         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 18304                                                                  ELC50PD
 18305     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 18306         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 18307                                                                  ELC50PD
 18308     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.        CL**2
 18309                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 331
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18311                                                                  ELC50PD
 18312 3772-CONTINUE.                                                   ELC50PD
 18313                                                                  ELC50PD
 18314**********************************                                ELC50PD
 18315*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE  ELC50PD
 18316*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE     ELC50PD
 18317*** DOUBLES THE TOLERANCE AMOUNT.                                 ELC50PD
 18318***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL. ELC50PD
 18319**********************************                                ELC50PD
 18320     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 18321     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND              ELC50PD
 18322         IF WS-REF-REJECT-SW = SPACE                              ELC50PD
 18323             MOVE ER-2754        TO WS-ERROR                      ELC50PD
 18324             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 18325           ELSE                                                   ELC50PD
 18326             MOVE ER-2736        TO WS-ERROR                      ELC50PD
 18327             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18328**********************************                                ELC50PD
 18329                                                                  ELC50PD
 18330 3773-CONTINUE.                                                   ELC50PD
 18331                                                                  ELC50PD
 18332     IF PB-C-LF-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18333        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18334           MOVE ER-2723          TO WS-ERROR                      ELC50PD
 18335           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18336                                                                  ELC50PD
 18337     IF PB-C-AH-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18338        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18339           MOVE ER-2724          TO WS-ERROR                      ELC50PD
 18340           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18341                                                                  ELC50PD
 18342     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18343         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *     ELC50PD
 18344             (1 + WS-LF-REFUND-OVS-PCT)                           ELC50PD
 18345     ELSE                                                         ELC50PD
 18346         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.     ELC50PD
 18347                                                                  ELC50PD
 18348     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS                ELC50PD
 18349         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *     ELC50PD
 18350             (1 - WS-TOL-LF-REFUND-PCT)                           ELC50PD
 18351     ELSE                                                         ELC50PD
 18352         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
 18353                                                                  ELC50PD
 18354     IF (PB-COMPANY-ID = 'DCC')
 18355        AND (PB-CI-ENTRY-STATUS = 'M')
 18356        AND (PB-C-LF-CANCEL-AMT > +0)
 18357        MOVE ER-3843             TO WS-ERROR
 18358        PERFORM 9900-ERROR-FORMAT
 18359                                 THRU 9900-EXIT
 18360     END-IF
 18361     EVALUATE TRUE                                                ELC50PD
 18362        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18363           CONTINUE                                               ELC50PD
 18364        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18365                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18366           CONTINUE                                               ELC50PD
 18367        WHEN WS-LF-REFUND-OVS-AMT = 0                             ELC50PD
 18368                 AND WS-TOL-LF-REFUND = 0                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 332
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18369           CONTINUE                                               ELC50PD
 18370        WHEN OTHER                                                ELC50PD
 18371           IF WS-TOL-LF-REFUND  = +0                              ELC50PD
 18372              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND           ELC50PD
 18373           END-IF                                                 ELC50PD
 18374           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18375                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <          ELC50PD
 18376                          (PB-C-LF-CANCEL-AMT))                   ELC50PD
 18377              CONTINUE                                            ELC50PD
 18378           ELSE                                                   ELC50PD
 18379              IF WS-LF-REFUND-OVS-AMT = +0                        ELC50PD
 18380                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT    ELC50PD
 18381              END-IF                                              ELC50PD
 18382              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18383                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >     ELC50PD
 18384                                       PB-C-LF-CANCEL-AMT)        ELC50PD
 18385                 CONTINUE                                         ELC50PD
 18386              ELSE                                                ELC50PD
 18387                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18388                   MOVE ER-2754   TO  WS-ERROR                    ELC50PD
 18389                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 18390                 ELSE                                             ELC50PD
 18391                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18392                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18393                 END-IF                                           ELC50PD
 18394              END-IF                                              ELC50PD
 18395           END-IF                                                 ELC50PD
 18396     END-EVALUATE.                                                ELC50PD
 18397                                                                  ELC50PD
 18398     EVALUATE TRUE                                                ELC50PD
 18399        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18400           CONTINUE                                               ELC50PD
 18401        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18402                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18403           CONTINUE                                               ELC50PD
 18404        WHEN OTHER                                                ELC50PD
 18405           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18406               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))     ELC50PD
 18407              CONTINUE                                            ELC50PD
 18408           ELSE                                                   ELC50PD
 18409              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18410               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))    ELC50PD
 18411                CONTINUE                                          ELC50PD
 18412              ELSE                                                ELC50PD
 18413                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18414                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18415                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18416                 ELSE                                             ELC50PD
 18417                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18418                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18419                 END-IF                                           ELC50PD
 18420              END-IF                                              ELC50PD
 18421           END-IF                                                 ELC50PD
 18422     END-EVALUATE.                                                ELC50PD
 18423                                                                  ELC50PD
 18424     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18425         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *     ELC50PD
 18426             (1 + WS-AH-REFUND-OVS-PCT)                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 333
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18427     ELSE                                                         ELC50PD
 18428         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.     ELC50PD
 18429                                                                  ELC50PD
 18430     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS                   ELC50PD
 18431         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *     ELC50PD
 18432             (1 - WS-TOL-AH-REFUND-PCT)                           ELC50PD
 18433     ELSE                                                         ELC50PD
 18434         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
 18435                                                                  ELC50PD
 18436     IF (PB-COMPANY-ID = 'DCC')
 18437        AND (PB-CI-ENTRY-STATUS = 'M')
 18438        AND (PB-C-AH-CANCEL-AMT > +0)
 18439        MOVE ER-3843             TO WS-ERROR
 18440        PERFORM 9900-ERROR-FORMAT
 18441                                 THRU 9900-EXIT
 18442     END-IF
 18443     EVALUATE TRUE                                                ELC50PD
 18444        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
 18445           CONTINUE                                               ELC50PD
 18446*       WHEN PB-C-AH-REF-CALC = +0 AND                            ELC50PD
 18447*                  PB-C-AH-CANCEL-AMT > +0                        ELC50PD
 18448        WHEN PB-C-AH-CANCEL-AMT = +0 AND                          ELC50PD
 18449                   PB-C-AH-REF-CALC > +0                          ELC50PD
 18450           CONTINUE                                               ELC50PD
 18451        WHEN WS-AH-REFUND-OVS-AMT = +0                            ELC50PD
 18452                AND WS-TOL-AH-REFUND = +0                         ELC50PD
 18453           CONTINUE                                               ELC50PD
 18454        WHEN OTHER                                                ELC50PD
 18455           IF WS-TOL-AH-REFUND = +0                               ELC50PD
 18456              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND           ELC50PD
 18457           END-IF                                                 ELC50PD
 18458           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND        ELC50PD
 18459               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <            ELC50PD
 18460                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18461              CONTINUE                                            ELC50PD
 18462           ELSE                                                   ELC50PD
 18463              IF WS-AH-REFUND-OVS-AMT = +0                        ELC50PD
 18464                 MOVE +9999999.99 TO                              ELC50PD
 18465                         WS-AH-REFUND-OVS-AMT                     ELC50PD
 18466              END-IF                                              ELC50PD
 18467              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18468                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >     ELC50PD
 18469                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18470                 CONTINUE                                         ELC50PD
 18471              ELSE                                                ELC50PD
 18472                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18473                    MOVE ER-2754   TO  WS-ERROR                   ELC50PD
 18474                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18475                 ELSE                                             ELC50PD
 18476                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18477                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18478                 END-IF                                           ELC50PD
 18479              END-IF                                              ELC50PD
 18480           END-IF                                                 ELC50PD
 18481     END-EVALUATE.                                                ELC50PD
 18482                                                                  ELC50PD
 18483     EVALUATE TRUE                                                ELC50PD
 18484        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 334
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18485           CONTINUE                                               ELC50PD
 18486*       WHEN PB-C-AH-REF-CALC > +0 AND                            ELC50PD
 18487*                  PB-C-AH-CANCEL-AMT = +0                        ELC50PD
 18488        WHEN PB-C-AH-CANCEL-AMT > +0 AND                          ELC50PD
 18489                   PB-C-AH-REF-CALC = +0                          ELC50PD
 18490           CONTINUE                                               ELC50PD
 18491        WHEN OTHER                                                ELC50PD
 18492           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND       ELC50PD
 18493               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))     ELC50PD
 18494              CONTINUE                                            ELC50PD
 18495           ELSE                                                   ELC50PD
 18496              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18497                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))   ELC50PD
 18498                 CONTINUE                                         ELC50PD
 18499              ELSE                                                ELC50PD
 18500                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18501                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18502                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18503                 ELSE                                             ELC50PD
 18504                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18505                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18506                 END-IF                                           ELC50PD
 18507              END-IF                                              ELC50PD
 18508           END-IF                                                 ELC50PD
 18509     END-EVALUATE.                                                ELC50PD
 18510                                                                  ELC50PD
 18511     IF (PB-C-LF-CANCEL-AMT = ZERO)
 18512        AND (PB-C-AH-CANCEL-AMT = ZERO)
 18513        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 18514           AND  PB-C-LF-REF-CALC < +1.00
 18515           AND  PB-C-AH-REF-CALC < +1.00
 18516           CONTINUE
 18517        ELSE
 18518           IF (PB-COMPANY-ID = 'DCC')
 18519              AND (PB-CI-ENTRY-STATUS = 'M')
 18520              CONTINUE
 18521           ELSE
 18522              MOVE ER-2741       TO WS-ERROR
 18523              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18524           END-IF
 18525        END-IF
 18526     END-IF
 18527                                                                  ELC50PD
 18528     IF (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18529        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18530        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED                      ELC50PD
 18531        AND PB-C-LF-REF-CALC NOT = ZERO)                          ELC50PD
 18532        OR                                                        ELC50PD
 18533        (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18534        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18535        AND PB-C-LF-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18536             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18537                AND PB-C-LF-REF-CALC LESS THAN +1.00              ELC50PD
 18538                NEXT SENTENCE                                     ELC50PD
 18539             ELSE                                                 ELC50PD
 18540                MOVE ER-2739        TO WS-ERROR                   ELC50PD
 18541                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18542                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 335
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18543     IF (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18544        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18545        AND NOT PB-CI-AH-LUMP-SUM-DISAB                           ELC50PD
 18546        AND PB-C-AH-REF-CALC NOT = ZERO)                          ELC50PD
 18547        OR                                                        ELC50PD
 18548        (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18549        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18550        AND PB-C-AH-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18551             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18552                AND PB-C-AH-REF-CALC LESS THAN +1.00              ELC50PD
 18553                NEXT SENTENCE                                     ELC50PD
 18554             ELSE                                                 ELC50PD
 18555                MOVE ER-2738        TO WS-ERROR                   ELC50PD
 18556                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18557                                                                  ELC50PD
 18558 3775-OVER-REF-CHK.                                               ELC50PD
 18559                                                                  ELC50PD
 18560     IF PB-CI-ENTRY-STATUS = '5'                                  ELC50PD
 18561        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18562                                                                  ELC50PD
 18563     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +              ELC50PD
 18564                              PB-CI-LF-ALT-PREMIUM-AMT.           ELC50PD
 18565                                                                  ELC50PD
 18566     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18567        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18568                                 PB-C-LF-REF-CALC                 ELC50PD
 18569      ELSE                                                        ELC50PD
 18570        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18571                                 PB-C-LF-CANCEL-AMT.              ELC50PD
 18572                                                                  ELC50PD
 18573     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18574        MOVE ER-2755             TO WS-ERROR                      ELC50PD
 18575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18576                                                                  ELC50PD
 18577     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.               ELC50PD
 18578                                                                  ELC50PD
 18579     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 18580        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18581                                 PB-C-AH-REF-CALC                 ELC50PD
 18582      ELSE                                                        ELC50PD
 18583        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18584                                 PB-C-AH-CANCEL-AMT.              ELC50PD
 18585                                                                  ELC50PD
 18586     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18587        MOVE ER-2778             TO WS-ERROR                      ELC50PD
 18588        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18589                                                                  ELC50PD
 18590     IF PB-CI-OB-FLAG NOT = 'Z'                                   ELC50PD
 18591        NEXT SENTENCE                                             ELC50PD
 18592       ELSE                                                       ELC50PD
 18593         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                  ELC50PD
 18594            MOVE ER-2757           TO WS-ERROR                    ELC50PD
 18595            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 18596                                                                  ELC50PD
 18597 3780-UPDATE-CANCEL-CERT.                                         ELC50PD
 18598                                                                  ELC50PD
 18599     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'                         ELC50PD
 18600        MOVE ER-2728              TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 336
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18602                                                                  ELC50PD
 18603     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'                         ELC50PD
 18604         MOVE ER-2729              TO WS-ERROR                    ELC50PD
 18605         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 18606                                                                  ELC50PD
 18607     IF PB-CI-LF-BENEFIT-CD = ZERO                                ELC50PD
 18608         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18609                                                                  ELC50PD
 18610     IF PB-C-LF-CANCEL-DT = LOW-VALUE                             ELC50PD
 18611         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18612                                                                  ELC50PD
 18613     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18614       AND                                                        ELC50PD
 18615        (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18616       AND                                                        ELC50PD
 18617        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18618       AND                                                        ELC50PD
 18619        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)       ELC50PD
 18620            NEXT SENTENCE                                         ELC50PD
 18621       ELSE                                                       ELC50PD
 18622        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18623          AND                                                     ELC50PD
 18624***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18625***       AND                                                     ELC50PD
 18626           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)     ELC50PD
 18627            IF PB-C-LF-CANCEL-VOID-SW = SPACE                     ELC50PD
 18628               MOVE ER-2730      TO WS-ERROR                      ELC50PD
 18629               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18630               GO TO 3999-END-EDIT                                ELC50PD
 18631            ELSE                                                  ELC50PD
 18632               GO TO 3999-END-EDIT                                ELC50PD
 18633        ELSE                                                      ELC50PD
 18634            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT       ELC50PD
 18635               MOVE ER-2765           TO WS-ERROR                 ELC50PD
 18636               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18637               GO TO 3785-CHECK-NH.
 18638*              GO TO 3999-END-EDIT.                               ELC50PD
 18639                                                                  ELC50PD
 18640 3780-UPDATE-CONT-1.                                              ELC50PD
 18641     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 18642                                                                  ELC50PD
 18643     IF PB-CI-AH-BENEFIT-CD = ZERO                                ELC50PD
 18644         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18645                                                                  ELC50PD
 18646     IF PB-C-AH-CANCEL-DT = LOW-VALUE                             ELC50PD
 18647         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18648
 18649     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 18650                                                                  ELC50PD
 18651     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18652       AND                                                        ELC50PD
 18653        (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18654       AND                                                        ELC50PD
 18655        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18656       AND                                                        ELC50PD
 18657        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)       ELC50PD
 18658            NEXT SENTENCE                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 337
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18659       ELSE                                                       ELC50PD
 18660        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18661          AND                                                     ELC50PD
 18662***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18663***       AND                                                     ELC50PD
 18664           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)     ELC50PD
 18665           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 18666            IF PB-C-AH-CANCEL-VOID-SW = SPACE                     ELC50PD
 18667               MOVE ER-2773      TO WS-ERROR                      ELC50PD
 18668               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18669               GO TO 3999-END-EDIT                                ELC50PD
 18670            ELSE                                                  ELC50PD
 18671               GO TO 3999-END-EDIT                                ELC50PD
 18672            END-IF
 18673           ELSE
 18674             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18675                MOVE ER-2890 TO WS-ERROR
 18676                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18677                GO TO 3999-END-EDIT
 18678             ELSE
 18679                GO TO 3785-CHECK-NH
 18680             END-IF
 18681           END-IF
 18682          ELSE                                                    ELC50PD
 18683            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT       ELC50PD
 18684              IF WS-AH-CLAIM-RESCINDED = 'Y'
 18685                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18686                   MOVE ER-2890 TO WS-ERROR
 18687                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18688                   GO TO 3999-END-EDIT
 18689                ELSE
 18690                   MOVE ER-2765 TO WS-ERROR
 18691                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18692                   GO TO 3785-CHECK-NH
 18693                END-IF
 18694              ELSE
 18695               MOVE ER-2765      TO WS-ERROR                      ELC50PD
 18696               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18697               GO TO 3785-CHECK-NH.
 18698*              GO TO 3999-END-EDIT.                               ELC50PD
 18699                                                                  ELC50PD
 18700 3780-UPDATE-CONT-2.                                              ELC50PD
 18701                                                                  ELC50PD
 18702     IF PB-C-LF-CANCEL-AMT NOT = ZERO                             ELC50PD
 18703        AND WS-LF-BENEFIT-CD = ZERO                               ELC50PD
 18704           MOVE ER-2743           TO WS-ERROR                     ELC50PD
 18705           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18706                                                                  ELC50PD
 18707     IF PB-C-AH-CANCEL-AMT NOT = ZERO                             ELC50PD
 18708        AND WS-AH-BENEFIT-CD = ZERO                               ELC50PD
 18709           MOVE ER-2744           TO WS-ERROR                     ELC50PD
 18710           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18711                                                                  ELC50PD
 18712     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR                         ELC50PD
 18713        (PB-C-AH-CANCEL-AMT NEGATIVE))                            ELC50PD
 18714        AND                                                       ELC50PD
 18715        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR                 ELC50PD
 18716         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 338
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18717           MOVE ER-2746           TO WS-ERROR                     ELC50PD
 18718           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18719                                                                  ELC50PD
 18720     IF (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18721       AND                                                        ELC50PD
 18722        (PB-C-LF-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18723             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18724             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18725                                                                  ELC50PD
 18726     IF (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18727       AND                                                        ELC50PD
 18728        (PB-C-AH-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18729             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18730             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18731                                                                  ELC50PD
 18732     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0                       ELC50PD
 18733         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 18734             OR 'CID' OR 'DCC' OR 'AHL'
 18735             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT      ELC50PD
 18736         ELSE                                                     ELC50PD
 18737             IF PB-COMPANY-ID = 'FIA' OR 'MTL'                       CL**2
 18738                 MOVE ER-2768    TO WS-ERROR                      ELC50PD
 18739                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 18740             ELSE                                                 ELC50PD
 18741                 MOVE ER-2756    TO WS-ERROR                      ELC50PD
 18742                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 18743                                                                  ELC50PD
 18744     IF CERT-PEND-ISSUE-RETURNED                                  ELC50PD
 18745        MOVE ER-2772             TO WS-ERROR                      ELC50PD
 18746        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18747
 18748 3785-CHECK-NH.
 18749
 18750     IF PB-STATE NOT = 'NH'
 18751        GO TO 3999-END-EDIT
 18752     END-IF
 18753
 18754     MOVE ER-2796                TO WS-ERROR
 18755     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 18756
 18757     IF (PB-C-REF-INTERFACE-SW = 'Y')
 18758        OR (CM-NH-INTERFACE-SW = 'Y')
 18759        MOVE ER-2793             TO WS-ERROR
 18760        PERFORM 9900-ERROR-FORMAT
 18761                                 THRU 9900-EXIT
 18762     END-IF
 18763
 18764     MOVE +0                     TO WS-PAYMENT-AMT
 18765     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 18766        GO TO 3999-END-EDIT
 18767     END-IF
 18768
 18769     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 18770        GO TO 3999-END-EDIT
 18771     END-IF
 18772
 18773     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 18774     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 339
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18775
 18776     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 18777        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 18778     END-IF
 18779     MOVE '1'                    TO DC-OPTION-CODE
 18780     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18781     IF NO-CONVERSION-ERROR
 18782        IF DC-ELAPSED-DAYS < +16
 18783           GO TO 3999-END-EDIT
 18784        END-IF
 18785     END-IF
 18786
 18787     MOVE +0                     TO DC-ELAPSED-DAYS
 18788     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 18789     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 18790     MOVE '1'                    TO DC-OPTION-CODE
 18791     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18792     IF NO-CONVERSION-ERROR
 18793        IF DC-ELAPSED-DAYS > +30
 18794           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 18795        ELSE
 18796           GO TO 3999-END-EDIT
 18797        END-IF
 18798     ELSE
 18799        GO TO 3999-END-EDIT
 18800     END-IF
 18801
 18802     COMPUTE WS-PAYMENT-AMT ROUNDED =
 18803        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 18804           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 18805
 18806     IF WS-PAYMENT-AMT < 600.00
 18807        GO TO 3999-END-EDIT
 18808     END-IF
 18809
 18810     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18811                                                                  ELC50PD
 18812     IF (ERMAIL-FOUND = ' ')
 18813         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 18814         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 18815        GO TO 3999-END-EDIT
 18816     END-IF
 18817
 18818     MOVE ER-2795                TO WS-ERROR
 18819     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18820                                                                  ELC50PD
 18821     GO TO 3999-END-EDIT.                                         ELC50PD
 18822******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 340
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18824 3990-FILES-NOT-OPEN.                                             ELC50PD
 18825                                                                  ELC50PD
 18826     MOVE ER-2617                TO WS-ERROR.                     ELC50PD
 18827     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 18828     GO TO 9990-RETURN.                                           ELC50PD
 18829                                                                  ELC50PD
 18830 3999-END-EDIT.                                                   ELC50PD
 18831
 18832                                                                  ELC50PD
 18833     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.                   ELC50PD
 18834                                                                  ELC50PD
 18835     IF PB-CANCELLATION AND CERT-WAS-FOUND                        ELC50PD
 18836         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT        ELC50PD
 18837         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18838             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18839             GO TO 9990-RETURN                                    ELC50PD
 18840          ELSE                                                    ELC50PD
 18841             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT             ELC50PD
 18842             GO TO 9990-RETURN.                                   ELC50PD
 18843                                                                  ELC50PD
 18844     IF PB-CANCELLATION                                           ELC50PD
 18845          GO TO 9990-RETURN.                                      ELC50PD
 18846                                                                  ELC50PD
 18847     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 18848        MOVE SPACES              TO CERTIFICATE-MASTER.           ELC50PD
 18849                                                                  ELC50PD
 18850     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.                 ELC50PD
 18851                                                                  ELC50PD
 18852     IF CERT-WAS-FOUND                                            ELC50PD
 18853         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18854             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18855          ELSE                                                    ELC50PD
 18856            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT              ELC50PD
 18857      ELSE                                                        ELC50PD
 18858         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.                  ELC50PD
 18859
 18860     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 18861        IF PB-COMPANY-ID = 'DCC' AND
 18862           (PB-CARRIER = '2' OR '4' OR '6')
 18863              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 18864        END-IF
 18865     END-IF.
 18866
 18867     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 18868         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 18869     END-IF.
 18870                                                                  ELC50PD
 18871     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18872     IF ((PB-COMPANY-ID = 'DCC')
 18873        AND (WS-NO-SECURE-PAY))
 18874                  OR
 18875        (WS-LF-SPECIAL-CALC-CD = 'O'
 18876        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18877        SET SKIP-ADDR-EDIT       TO TRUE
 18878     END-IF
 18879
 18880     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18881        AND (NOT SKIP-ADDR-EDIT)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 341
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18882        MOVE ER-2963             TO WS-ERROR
 18883        PERFORM 9900-ERROR-FORMAT
 18884                                 THRU 9900-EXIT
 18885        GO TO 9990-RETURN
 18886     END-IF
 18887
 18888     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.                     ELC50PD
 18889
 18890     IF ERPNDM-FOUND NOT = 'X'
 18891        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18892           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 18893           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 18894           AND (NOT SKIP-ADDR-EDIT)
 18895           MOVE ER-2694          TO WS-ERROR
 18896           PERFORM 9900-ERROR-FORMAT
 18897                                 THRU 9900-EXIT
 18898        END-IF
 18899        MOVE ' '                 TO STATE-RECORD-ERROR
 18900        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18901        MOVE PM-STATE            TO CNTL-ACCESS
 18902        MOVE '3'                 TO CNTL-REC-TYPE
 18903        MOVE +0                  TO CNTL-SEQ-NO
 18904        MOVE '0'                 TO RC-SW-2
 18905        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18906        IF (NO-STATE-RECORD)
 18907           OR (CF-RECORD-TYPE NOT = '3')
 18908           OR (PM-STATE NOT = CF-STATE-CODE)
 18909           IF (PM-STATE = SPACES)
 18910              AND (SKIP-ADDR-EDIT)
 18911              CONTINUE
 18912           ELSE
 18913              MOVE ER-2963       TO WS-ERROR
 18914              PERFORM 9900-ERROR-FORMAT
 18915                                 THRU 9900-EXIT
 18916           END-IF
 18917        END-IF
 18918        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18919           MOVE ER-2883          TO WS-ERROR
 18920           PERFORM 9900-ERROR-FORMAT
 18921                                 THRU 9900-EXIT
 18922        END-IF
 18923        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18924           MOVE ' '                 TO STATE-RECORD-ERROR
 18925           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18926           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18927           MOVE '3'                 TO CNTL-REC-TYPE
 18928           MOVE +0                  TO CNTL-SEQ-NO
 18929           MOVE '0'                 TO RC-SW-2
 18930           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18931           IF NO-STATE-RECORD
 18932              OR (CF-RECORD-TYPE NOT = '3')
 18933              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18934              MOVE ER-2964          TO WS-ERROR
 18935              PERFORM 9900-ERROR-FORMAT
 18936                                    THRU 9900-EXIT
 18937           END-IF
 18938        END-IF
 18939     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 342
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18940        IF NOT SKIP-ADDR-EDIT
 18941           MOVE ER-2393          TO WS-ERROR
 18942           PERFORM 9900-ERROR-FORMAT
 18943                                 THRU 9900-EXIT
 18944        END-IF
 18945     END-IF
 18946                                                                  ELC50PD
 18947     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18948                                                                  ELC50PD
 18949     IF (ERMAIL-FOUND = ' ' AND                                   ELC50PD
 18950        ERPNDM-FOUND = ' ')                                       ELC50PD
 18951        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND             ELC50PD
 18952           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18953           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18954          OR                                                      ELC50PD
 18955           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)       ELC50PD
 18956          OR                                                      ELC50PD
 18957           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND               ELC50PD
 18958           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)ELC50PD
 18959           GO TO 3999-UNLOCK-ERMAIL.                              ELC50PD
 18960                                                                  ELC50PD
 18961
 18962     IF ERPNDM-FOUND = 'X'                                        ELC50PD
 18963        GO TO 3999-UNLOCK-ERMAIL.                                 ELC50PD
 18964                                                                  ELC50PD
 18965     IF PM-INSURED-LAST-NAME      = SPACES
 18966        AND PM-INSURED-FIRST-NAME = SPACES
 18967        AND PM-ADDRESS-LINE-1     = SPACES
 18968        AND PM-ADDRESS-LINE-2     = SPACES
 18969        AND PM-CITY-STATE         = SPACES
 18970        AND PM-CRED-BENE-NAME     = SPACES
 18971        AND PM-CRED-BENE-ADDR     = SPACES
 18972        AND PM-CRED-BENE-CTYST    = SPACES
 18973        GO TO 3999-UNLOCK-ERMAIL
 18974     END-IF
 18975                                                                  ELC50PD
 18976     MOVE SPACES                 TO MAILING-DATA.                 ELC50PD
 18977                                                                  ELC50PD
 18978     MOVE 'MA'                   TO MA-RECORD-ID.                 ELC50PD
 18979     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.           ELC50PD
 18980     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.            ELC50PD
 18981     MOVE PB-SV-CARRIER          TO MA-CARRIER.                   ELC50PD
 18982     MOVE PB-SV-GROUPING         TO MA-GROUPING.                  ELC50PD
 18983     MOVE PB-SV-STATE            TO MA-STATE.                     ELC50PD
 18984     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18985     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18986                                                                  ELC50PD
 18987     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT              ELC50PD
 18988     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY              ELC50PD
 18989                                                                  ELC50PD
 18990     IF ERMAIL-FOUND = ' '                                        ELC50PD
 18991        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT                ELC50PD
 18992     ELSE                                                         ELC50PD
 18993        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT              ELC50PD
 18994        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY            ELC50PD
 18995        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.                 ELC50PD
 18996                                                                  ELC50PD
 18997
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 343
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18998     GO TO 9990-RETURN.                                           ELC50PD
 18999                                                                  ELC50PD
 19000 3999-UNLOCK-ERMAIL.                                              ELC50PD
 19001     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19002        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.                ELC50PD
 19003                                                                  ELC50PD
 19004     GO TO 9990-RETURN.                                           ELC50PD
 19005******************************************************************ELC50PD
 19006                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 344
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19008 4000-UPDATE-CANCELLED-CERT.                                      ELC50PD
 19009     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 19010        GO TO 4299-EXIT.                                          ELC50PD
 19011                                                                  ELC50PD
 19012*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.         ELC50PD
 19013
 19014     IF PB-C-NH-INT-ON-REFS > ZEROS
 19015        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 19016     END-IF
 19017     IF PB-C-REF-INTERFACE-SW = 'Y'
 19018        MOVE PB-C-REF-INTERFACE-SW
 19019                                 TO CM-NH-INTERFACE-SW
 19020     END-IF
 19021
 19022     IF PB-C-POST-CARD-IND = 'Y'
 19023        MOVE +8                  TO SUB
 19024        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 19025        IF ERMAIL-FOUND = ' '
 19026           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 19027              (SUB > +7)
 19028              OR (MA-MAIL-STATUS (SUB) = '1')
 19029           END-PERFORM
 19030        END-IF
 19031        IF (SUB > +7)
 19032           OR (ERMAIL-FOUND = 'X')
 19033           MOVE ER-3789          TO WS-ERROR
 19034           PERFORM 9900-ERROR-FORMAT
 19035                                 THRU 9900-EXIT
 19036        END-IF
 19037     ELSE
 19038        MOVE 'N'                 TO PB-C-POST-CARD-IND
 19039     END-IF
 19040
 19041     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 19042                                                                  ELC50PD
 19043     IF PB-CI-OB-FLAG = 'Z'                                       ELC50PD
 19044        GO TO 4150-SUMMARY-CERT-CANCEL.                           ELC50PD
 19045                                                                  ELC50PD
 19046     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19047         PERFORM 4200-REVERSE-LF-CANCEL.                          ELC50PD
 19048     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19049         PERFORM 4200-REVERSE-AH-CANCEL.                          ELC50PD
 19050                                                                  ELC50PD
 19051 4100-APPLY-LF-CANCEL.                                            ELC50PD
 19052                                                                  ELC50PD
 19053     MOVE +0                     TO WS-SUB.                       ELC50PD
 19054                                                                  ELC50PD
 19055 4100-CHECK-LF-ERRORS.                                            ELC50PD
 19056                                                                  ELC50PD
 19057     ADD +1                       TO WS-SUB.                      ELC50PD
 19058                                                                  ELC50PD
 19059     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19060        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 19061           GO TO 4100-LF-CANCEL-CONT                              ELC50PD
 19062        ELSE                                                      ELC50PD
 19063           GO TO 4100-UPDATE-LF-COVERAGE.                         ELC50PD
 19064                                                                  ELC50PD
 19065     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 345
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19066                                   ER-2729 OR                     ELC50PD
 19067                                   ER-2730 OR                     ELC50PD
 19068                                   ER-2731 OR                     ELC50PD
 19069                                   ER-2732 OR                     ELC50PD
 19070                                   ER-2737 OR                     ELC50PD
 19071                                   ER-2740 OR                     ELC50PD
 19072                                   ER-2743 OR                     ELC50PD
 19073                                   ER-2749 OR                     ELC50PD
 19074                                   ER-2750 OR                     ELC50PD
 19075                                   ER-2755 OR                     ELC50PD
 19076                                   ER-2757 OR                     ELC50PD
 19077                                   ER-2760 OR                     ELC50PD
 19078                                   ER-2772 OR                     ELC50PD
 19079                                   ER-2774 OR                     ELC50PD
 19080                                   ER-2776 OR                     ELC50PD
 19081                                   ER-2794                        ELC50PD
 19082        GO TO 4100-UPDATE-LF-COVERAGE.                            ELC50PD
 19083                                                                  ELC50PD
 19084     GO TO 4100-CHECK-LF-ERRORS.                                  ELC50PD
 19085                                                                  ELC50PD
 19086 4100-UPDATE-LF-COVERAGE.                                         ELC50PD
 19087                                                                  ELC50PD
 19088     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT     ELC50PD
 19089     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT          ELC50PD
 19090     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 19091        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 19092     END-IF
 19093     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19094                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19095     IF CM-LF-CANCEL-DT = LOW-VALUE                               ELC50PD
 19096         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.    ELC50PD
 19097                                                                  ELC50PD
 19098     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19099         MOVE SPACES                  TO CM-LF-EXIT-BATCH         ELC50PD
 19100                                         CM-LF-STATUS-AT-CANCEL.  ELC50PD
 19101                                                                  ELC50PD
 19102     GO TO 4100-APPLY-AH-CANCEL.                                  ELC50PD
 19103                                                                  ELC50PD
 19104 4100-LF-CANCEL-CONT.                                             ELC50PD
 19105     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19106         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19107                                                                  ELC50PD
 19108     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19109         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19110                                                                  ELC50PD
 19111     IF PB-C-LF-CANCEL-AMT GREATER ZERO                           ELC50PD
 19112        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                   ELC50PD
 19113           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT        ELC50PD
 19114        ELSE                                                      ELC50PD
 19115           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.       ELC50PD
 19116                                                                  ELC50PD
 19117     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.            ELC50PD
 19118     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.       ELC50PD
 19119                                                                  ELC50PD
 19120     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19121         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.           ELC50PD
 19122                                                                  ELC50PD
 19123     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 346
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19124        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 19125         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL      ELC50PD
 19126         MOVE '8'                  TO CM-LF-CURRENT-STATUS.       ELC50PD
 19127                                                                  ELC50PD
 19128     IF PB-RECORD-RETURNED                                        ELC50PD
 19129        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19130      ELSE                                                        ELC50PD
 19131        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19132                                                                  ELC50PD
 19133 4100-APPLY-AH-CANCEL.                                            ELC50PD
 19134                                                                  ELC50PD
 19135     MOVE +0                      TO WS-SUB.                      ELC50PD
 19136                                                                  ELC50PD
 19137 4100-CHECK-AH-ERRORS.                                            ELC50PD
 19138                                                                  ELC50PD
 19139     ADD +1                       TO WS-SUB.                      ELC50PD
 19140                                                                  ELC50PD
 19141     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19142        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 19143           GO TO 4100-AH-CANCEL-CONT                              ELC50PD
 19144        ELSE                                                      ELC50PD
 19145           GO TO 4100-UPDATE-AH-COVERAGE.                         ELC50PD
 19146                                                                  ELC50PD
 19147     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19148                                   ER-2729 OR                     ELC50PD
 19149                                   ER-2732 OR                     ELC50PD
 19150                                   ER-2737 OR                     ELC50PD
 19151                                   ER-2740 OR                     ELC50PD
 19152                                   ER-2744 OR                     ELC50PD
 19153                                   ER-2749 OR                     ELC50PD
 19154                                   ER-2750 OR                     ELC50PD
 19155                                   ER-2755 OR                     ELC50PD
 19156                                   ER-2757 OR                     ELC50PD
 19157                                   ER-2760 OR                     ELC50PD
 19158                                   ER-2771 OR                     ELC50PD
 19159                                   ER-2772 OR                     ELC50PD
 19160                                   ER-2773 OR                     ELC50PD
 19161                                   ER-2775 OR                     ELC50PD
 19162                                   ER-2777 OR                     ELC50PD
 19163                                   ER-2794                        ELC50PD
 19164        GO TO 4100-UPDATE-AH-COVERAGE.                            ELC50PD
 19165                                                                  ELC50PD
 19166     GO TO 4100-CHECK-AH-ERRORS.                                  ELC50PD
 19167                                                                  ELC50PD
 19168 4100-UPDATE-AH-COVERAGE.                                         ELC50PD
 19169                                                                  ELC50PD
 19170     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT     ELC50PD
 19171     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT          ELC50PD
 19172     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS     ELC50PD
 19173     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19174                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19175     IF CM-AH-CANCEL-DT = LOW-VALUE                               ELC50PD
 19176         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.    ELC50PD
 19177                                                                  ELC50PD
 19178     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19179         MOVE SPACES                  TO CM-AH-EXIT-BATCH         ELC50PD
 19180                                         CM-AH-STATUS-AT-CANCEL.  ELC50PD
 19181                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 347
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19182     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 19183         IF PB-RECORD-RETURNED                                    ELC50PD
 19184              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2 ELC50PD
 19185          ELSE                                                    ELC50PD
 19186              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19187                                                                  ELC50PD
 19188     GO TO 4299-EXIT.                                             ELC50PD
 19189                                                                  ELC50PD
 19190 4100-AH-CANCEL-CONT.                                             ELC50PD
 19191     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19192         GO TO 4299-EXIT.                                         ELC50PD
 19193                                                                  ELC50PD
 19194     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19195         GO TO 4299-EXIT.                                         ELC50PD
 19196                                                                  ELC50PD
 19197     IF PB-C-AH-CANCEL-AMT GREATER ZERO                           ELC50PD
 19198        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                     ELC50PD
 19199           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT      ELC50PD
 19200        ELSE                                                      ELC50PD
 19201           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.     ELC50PD
 19202                                                                  ELC50PD
 19203     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.              ELC50PD
 19204     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.         ELC50PD
 19205                                                                  ELC50PD
 19206     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19207         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.             ELC50PD
 19208                                                                  ELC50PD
 19209     IF CM-AH-STATUS-AT-CANCEL = SPACE                            ELC50PD
 19210         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL      ELC50PD
 19211         MOVE '8'                TO CM-AH-CURRENT-STATUS.         ELC50PD
 19212                                                                  ELC50PD
 19213     IF PB-RECORD-RETURNED                                        ELC50PD
 19214        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2      ELC50PD
 19215      ELSE                                                        ELC50PD
 19216        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19217                                                                  ELC50PD
 19218     GO TO 4299-EXIT.                                             ELC50PD
 19219                                                                  ELC50PD
 19220 4150-SUMMARY-CERT-CANCEL.                                        ELC50PD
 19221     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19222                                                                  ELC50PD
 19223     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19224        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19225                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC      ELC50PD
 19226     ELSE                                                         ELC50PD
 19227        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19228                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.  ELC50PD
 19229                                                                  ELC50PD
 19230     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 19231        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19232                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC     ELC50PD
 19233     ELSE                                                         ELC50PD
 19234        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19235                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.  ELC50PD
 19236                                                                  ELC50PD
 19237     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                      ELC50PD
 19238        NEXT SENTENCE                                             ELC50PD
 19239     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 348
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19240        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.              ELC50PD
 19241                                                                  ELC50PD
 19242     GO TO 4299-EXIT.                                             ELC50PD
 19243                                                                  ELC50PD
 19244 4200-REVERSE-LF-CANCEL.                                          ELC50PD
 19245     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.            ELC50PD
 19246                                                                  ELC50PD
 19247     IF CM-LF-CANCEL-APPLIED                                      ELC50PD
 19248        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT        ELC50PD
 19249        MOVE SPACES                TO CM-LF-EXIT-BATCH            ELC50PD
 19250        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.      ELC50PD
 19251                                                                  ELC50PD
 19252     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.     ELC50PD
 19253                                                                  ELC50PD
 19254     IF PB-RECORD-RETURNED                                        ELC50PD
 19255        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19256       ELSE                                                       ELC50PD
 19257        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19258                                                                  ELC50PD
 19259 4200-REVERSE-LF-EXIT.                                            ELC50PD
 19260       EXIT.                                                      ELC50PD
 19261                                                                  ELC50PD
 19262 4200-REVERSE-AH-CANCEL.                                          ELC50PD
 19263     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.            ELC50PD
 19264                                                                  ELC50PD
 19265     IF CM-AH-CANCEL-APPLIED                                      ELC50PD
 19266        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT        ELC50PD
 19267        MOVE SPACES                TO CM-AH-EXIT-BATCH            ELC50PD
 19268        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.      ELC50PD
 19269                                                                  ELC50PD
 19270     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.     ELC50PD
 19271                                                                  ELC50PD
 19272     IF PB-RECORD-RETURNED                                        ELC50PD
 19273        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19274       ELSE                                                       ELC50PD
 19275        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19276                                                                  ELC50PD
 19277 4200-REVERSE-AH-EXIT.                                            ELC50PD
 19278       EXIT.                                                      ELC50PD
 19279                                                                  ELC50PD
 19280 4299-EXIT.                                                       ELC50PD
 19281       EXIT.                                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 349
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19283                                                                  ELC50PD
 19284 4500-UPDATE-NEW-CERT.                                            ELC50PD
 19285     IF CERT-WAS-FOUND                                            ELC50PD
 19286         NEXT SENTENCE                                            ELC50PD
 19287       ELSE                                                       ELC50PD
 19288         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19289                                                                  ELC50PD
 19290     IF  CLASIC-CREATED-CERT                                      ELC50PD
 19291         GO TO 4999-EXIT.                                         ELC50PD
 19292                                                                  ELC50PD
 19293     IF  CERT-WAS-CREATED-FOR-CLAIM                               ELC50PD
 19294         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19295                                                                  ELC50PD
 19296     IF CERT-ADDED-BATCH                                          ELC50PD
 19297        IF CM-RECORD-ID = 'CM'                                    ELC50PD
 19298            GO TO 4999-EXIT.                                      ELC50PD
 19299                                                                  ELC50PD
 19300 4520-BUILD-NEW-KEY.                                              ELC50PD
 19301* BUILD CONTROL PRIMARY                                           ELC50PD
 19302                                                                  ELC50PD
 19303     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD              ELC50PD
 19304                                       CM-COMPANY-CD-A1           ELC50PD
 19305                                       CM-COMPANY-CD-A2           ELC50PD
 19306                                       CM-COMPANY-CD-A4           ELC50PD
 19307                                       CM-COMPANY-CD-A5.          ELC50PD
 19308                                                                  ELC50PD
 19309     MOVE PB-SV-CARRIER             TO CM-CARRIER.                ELC50PD
 19310     MOVE PB-SV-GROUPING            TO CM-GROUPING.               ELC50PD
 19311     MOVE PB-SV-STATE               TO CM-STATE.                  ELC50PD
 19312     MOVE PB-ACCOUNT                TO CM-ACCOUNT.                ELC50PD
 19313     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.             ELC50PD
 19314     MOVE PB-CERT-SFX               TO CM-CERT-SFX.               ELC50PD
 19315     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.            ELC50PD
 19316                                                                  ELC50PD
 19317     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.             ELC50PD
 19318                                                                  ELC50PD
 19319     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.      ELC50PD
 19320     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.      ELC50PD
 19321     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.     ELC50PD
 19322     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.    ELC50PD
 19323                                                                  ELC50PD
 19324     IF PB-I-SOC-SEC-NO EQUAL '000000000  '                       ELC50PD
 19325        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.          ELC50PD
 19326                                                                  ELC50PD
 19327     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO                        ELC50PD
 19328         MOVE PB-SV-STATE            TO CM-SSN-STATE              ELC50PD
 19329         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT            ELC50PD
 19330         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2      ELC50PD
 19331         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2    ELC50PD
 19332     ELSE                                                         ELC50PD
 19333         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.            ELC50PD
 19334                                                                  ELC50PD
 19335     IF PB-COMPANY-ID   EQUAL  'CRI'                              ELC50PD
 19336         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME         ELC50PD
 19337         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD            ELC50PD
 19338         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME          ELC50PD
 19339         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL            ELC50PD
 19340         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 350
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19341                                                                  ELC50PD
 19342     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND                  ELC50PD
 19343        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19344         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.   ELC50PD
 19345                                                                  ELC50PD
 19346     IF PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 19347        IF PB-I-JOINT-COVERAGE                                    ELC50PD
 19348            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO           ELC50PD
 19349                                           PB-I-MEMBER-NO         ELC50PD
 19350            GO TO 4550-CONT-CERT-PROCESS.                         ELC50PD
 19351                                                                  ELC50PD
 19352     IF PB-COMPANY-ID  = 'MON' OR 'PEM'                           ELC50PD
 19353        NEXT SENTENCE                                             ELC50PD
 19354     ELSE                                                         ELC50PD
 19355        GO TO 4540-BUILD-MEMBER-NO.                               ELC50PD
 19356                                                                  ELC50PD
 19357******************************************************************ELC50PD
 19358*                                                                *ELC50PD
 19359*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *ELC50PD
 19360*    FOR 'MON'.                                                  *ELC50PD
 19361*                                                                *ELC50PD
 19362******************************************************************ELC50PD
 19363                                                                  ELC50PD
 19364     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.                 ELC50PD
 19365     MOVE SPACES                 TO WS-WORK-MEMB-NAME.            ELC50PD
 19366     MOVE +1                     TO WS-SUB1                       ELC50PD
 19367                                    WS-SUB2.                      ELC50PD
 19368                                                                  ELC50PD
 19369 4530-EDIT-MEMB-NAME.                                             ELC50PD
 19370                                                                  ELC50PD
 19371     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO       ELC50PD
 19372        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)  ELC50PD
 19373        ADD +1                       TO WS-SUB2.                  ELC50PD
 19374                                                                  ELC50PD
 19375     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7            ELC50PD
 19376        ADD +1                       TO WS-SUB1                   ELC50PD
 19377        GO TO 4530-EDIT-MEMB-NAME.                                ELC50PD
 19378                                                                  ELC50PD
 19379     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.          ELC50PD
 19380     MOVE PB-SV-STATE                TO CM-MEMB-STATE.            ELC50PD
 19381     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.            ELC50PD
 19382*    MOVE SPACE                      TO DC-OPTION-CODE.           ELC50PD
 19383     SET  BIN-TO-GREG                TO TRUE.                     ELC50PD
 19384     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 19385     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.              ELC50PD
 19386                                                                  ELC50PD
 19387     GO TO 4550-CONT-CERT-PROCESS.                                ELC50PD
 19388                                                                  ELC50PD
 19389******************************************************************ELC50PD
 19390*    END FOR 'MON' CODE FOR MEMBER NO.                           *ELC50PD
 19391******************************************************************ELC50PD
 19392                                                                  ELC50PD
 19393 4540-BUILD-MEMBER-NO.                                            ELC50PD
 19394                                                                  ELC50PD
 19395     IF PB-I-MEMBER-NO  = SPACES OR ZERO                          ELC50PD
 19396         MOVE PB-SV-STATE            TO CM-MEMB-STATE             ELC50PD
 19397         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT           ELC50PD
 19398         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 351
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19399         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5    ELC50PD
 19400     ELSE                                                         ELC50PD
 19401         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.             ELC50PD
 19402                                                                  ELC50PD
 19403     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND                    ELC50PD
 19404        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19405         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.   ELC50PD
 19406                                                                  ELC50PD
 19407 4550-CONT-CERT-PROCESS.                                          ELC50PD
 19408                                                                  ELC50PD
 19409*    IF PB-I-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 19410*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO          ELC50PD
 19411*    ELSE                                                         ELC50PD
 19412*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.         ELC50PD
 19413                                                                  ELC50PD
 19414     IF CERT-WAS-CREATED-FOR-CLAIM                                ELC50PD
 19415        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19416        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.   ELC50PD
 19417                                                                  ELC50PD
 19418     IF CERT-AND-CLAIM-ONLINE                                     ELC50PD
 19419        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19420        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.  ELC50PD
 19421                                                                  ELC50PD
 19422     MOVE 'CM'                     TO CM-RECORD-ID.               ELC50PD
 19423     MOVE LOW-VALUES               TO CM-STATUS-DATA.             ELC50PD
 19424                                                                  ELC50PD
 19425     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE             ELC50PD
 19426        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW     ELC50PD
 19427        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT   ELC50PD
 19428     ELSE                                                         ELC50PD
 19429        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW        ELC50PD
 19430        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.     ELC50PD
 19431                                                                  ELC50PD
 19432     MOVE ZERO                     TO CM-LOAN-BALANCE.            ELC50PD
 19433     MOVE '1'                      TO CM-PREMIUM-TYPE.            ELC50PD
 19434     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.       ELC50PD
 19435     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.       ELC50PD
 19436     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.      ELC50PD
 19437     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.             ELC50PD
 19438     MOVE ZEROS                    TO CM-LF-REMAINING-AMT         ELC50PD
 19439                                      CM-LF-ITD-CANCEL-AMT        ELC50PD
 19440                                      CM-LF-ITD-DEATH-AMT         ELC50PD
 19441                                      CM-AH-ITD-AH-PMT            ELC50PD
 19442                                      CM-AH-ITD-LUMP-PMT          ELC50PD
 19443                                      CM-AH-ITD-CANCEL-AMT        ELC50PD
 19444                                      CM-LF-NSP-PREMIUM-AMT       ELC50PD
 19445                                      CM-AH-NSP-PREMIUM-AMT.      ELC50PD
 19446*                                     CM-CLAIM-DEDUCT-WITHHELD    ELC50PD
 19447*                                     CM-CANCEL-DEDUCT-WITHHELD.  ELC50PD
 19448     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.                ELC50PD
 19449     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.           ELC50PD
 19450     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.              ELC50PD
 19451     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.                ELC50PD
 19452     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.             ELC50PD
 19453     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.             ELC50PD
 19454     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.              ELC50PD
 19455     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.              ELC50PD
 19456     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 352
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19457     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.             ELC50PD
 19458     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.               ELC50PD
 19459     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.         ELC50PD
 19460                                                                  ELC50PD
 19461     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 19462         MOVE ZERO                 TO PB-I-LIVES.                 ELC50PD
 19463                                                                  ELC50PD
 19464     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 19465         MOVE ZERO                 TO PB-I-NUM-BILLED.            ELC50PD
 19466                                                                  ELC50PD
 19467     MOVE PB-I-LIVES               TO CM-LIVES.                   ELC50PD
 19468     MOVE PB-I-NUM-BILLED          TO CM-BILLED.                  ELC50PD
 19469                                                                  ELC50PD
 19470     IF PB-COMPANY-ID EQUAL  'DMD'                                ELC50PD
 19471         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE       ELC50PD
 19472         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.           ELC50PD
 19473                                                                  ELC50PD
 19474     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.           ELC50PD
 19475     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.            ELC50PD
 19476     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.      ELC50PD
 19477     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.          ELC50PD
 19478     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.      ELC50PD
 19479     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 19480                                                                  ELC50PD
 19481     IF PB-I-LF-POLICY-FEE NUMERIC                                ELC50PD
 19482        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE            ELC50PD
 19483     ELSE                                                         ELC50PD
 19484        MOVE +0                    TO CM-LF-POLICY-FEE.           ELC50PD
 19485                                                                  ELC50PD
 19486     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19487        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT           ELC50PD
 19488        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT       ELC50PD
 19489     ELSE                                                         ELC50PD
 19490        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.          ELC50PD
 19491                                                                  ELC50PD
 19492     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.        ELC50PD
 19493     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.    ELC50PD
 19494     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.        ELC50PD
 19495     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.      ELC50PD
 19496     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.       ELC50PD
 19497     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.           ELC50PD
 19498     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.            ELC50PD
 19499     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.          ELC50PD
 19500     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 19501                                                                  ELC50PD
 19502     IF PB-I-AH-POLICY-FEE NUMERIC                                ELC50PD
 19503        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE            ELC50PD
 19504     ELSE                                                         ELC50PD
 19505        MOVE +0                    TO CM-AH-POLICY-FEE.           ELC50PD
 19506                                                                  ELC50PD
 19507     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 19508        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT           ELC50PD
 19509     ELSE                                                         ELC50PD
 19510        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.          ELC50PD
 19511                                                                  ELC50PD
 19512     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.      ELC50PD
 19513     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.       ELC50PD
 19514                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 353
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19515     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT          ELC50PD
 19516                                      CM-LF-DEATH-EXIT-DT         ELC50PD
 19517                                      CM-AH-SETTLEMENT-EXIT-DT.   ELC50PD
 19518                                                                  ELC50PD
 19519*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR                ELC50PD
 19520*                       'TIH' OR 'OFL' OR 'FLA' OR                ELC50PD
 19521*                       'TII' OR 'TMS' OR 'CRI' OR                ELC50PD
 19522*                       'NCL'                                     ELC50PD
 19523     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 19524                                                                  ELC50PD
 19525     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND                 ELC50PD
 19526         IF WS-LF-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19527            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19528                                                                  ELC50PD
 19529     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND                   ELC50PD
 19530         IF WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19531            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19532                                                                  ELC50PD
 19533     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 19534         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS         ELC50PD
 19535     ELSE                                                         ELC50PD
 19536         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS         ELC50PD
 19537         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.     ELC50PD
 19538                                                                  ELC50PD
 19539     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.           ELC50PD
 19540     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.           ELC50PD
 19541     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.         ELC50PD
 19542     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.            ELC50PD
 19543     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.            ELC50PD
 19544     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.             ELC50PD
 19545     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.      ELC50PD
 19546     MOVE SPACE                     TO CM-PAYMENT-MODE.           ELC50PD
 19547                                                                  ELC50PD
 19548     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 19549         MOVE SPACE                 TO CM-SKIP-CODE               ELC50PD
 19550     ELSE                                                         ELC50PD
 19551         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.              ELC50PD
 19552                                                                  ELC50PD
 19553     MOVE '2'                       TO CM-LF-CURRENT-STATUS.      ELC50PD
 19554     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH      ELC50PD
 19555                                       CM-LF-STATUS-AT-CANCEL.    ELC50PD
 19556                                                                  ELC50PD
 19557     MOVE '2'                       TO CM-AH-CURRENT-STATUS.      ELC50PD
 19558     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT ELC50PD
 19559                                       CM-AH-STATUS-AT-CANCEL.    ELC50PD
 19560                                                                  ELC50PD
 19561     MOVE '1'                       TO CM-ENTRY-STATUS.           ELC50PD
 19562                                                                  ELC50PD
 19563     IF PB-REISSUED-CERT                                          ELC50PD
 19564        MOVE '5'                    TO CM-ENTRY-STATUS.           ELC50PD
 19565                                                                  ELC50PD
 19566     IF PB-MONTHLY-CERT                                           ELC50PD
 19567        MOVE 'M'                    TO CM-ENTRY-STATUS.           ELC50PD
 19568                                                                  ELC50PD
 19569     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 19570     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 19571     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 19572        MOVE 'D'                    TO CM-ENTRY-STATUS.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 354
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19573                                                                  ELC50PD
 19574     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 19575        MOVE 'V'                    TO CM-ENTRY-STATUS.           ELC50PD
 19576                                                                  ELC50PD
 19577     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 19578        MOVE 'U'                    TO CM-ENTRY-STATUS.           ELC50PD
 19579                                                                  ELC50PD
 19580     IF PB-REIN-ONLY-CERT                                         ELC50PD
 19581        MOVE '9'                    TO CM-ENTRY-STATUS.           ELC50PD
 19582                                                                  ELC50PD
 19583     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'                  ELC50PD
 19584         MOVE 'Y'                   TO CM-UNDERWRITING-CODE       ELC50PD
 19585     ELSE                                                         ELC50PD
 19586         MOVE SPACE                 TO CM-UNDERWRITING-CODE.      ELC50PD
 19587                                                                  ELC50PD
 19588     IF PB-RECORD-RETURNED                                        ELC50PD
 19589        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1   ELC50PD
 19590      ELSE                                                        ELC50PD
 19591        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.  ELC50PD
 19592                                                                  ELC50PD
 19593     IF PB-I-MAIL-ADDRS-PRESENT                                   ELC50PD
 19594        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.     ELC50PD
 19595                                                                  ELC50PD
 19596     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END          ELC50PD
 19597                                       CM-ENTRY-DT.               ELC50PD
 19598                                                                  ELC50PD
 19599 4999-EXIT.                                                       ELC50PD
 19600     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 355
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19602                                                                  ELC50PD
 19603 5000-PROCESS-REPS.
 19604
 19605     MOVE ' '                    TO AGTC-MASTER-SW
 19606     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 19607     MOVE CO-TYPE                TO AGTC-TYPE
 19608     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 19609     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 19610
 19611     IF (AGTC-MASTER-SW NOT = 'N')
 19612        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 19613        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 19614        PERFORM 8583-READ-ERAGTC-NEXT
 19615                                 THRU 8583-EXIT
 19616     END-IF
 19617
 19618     IF AGTC-MASTER-SW = 'N'
 19619        CONTINUE
 19620     ELSE
 19621        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 19622           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 19623              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 19624              MOVE 'Y'           TO AGTC-MASTER-SW
 19625           END-IF
 19626        END-IF
 19627     END-IF
 19628
 19629     .
 19630 5000-EXIT.
 19631     EXIT.
 19632
 19633
 19634 6370-EDIT-INPUT-LF-CODE.                                         ELC50PD
 19635     IF WK-LIFE-EDIT-ADDR NOT = ZEROS                             ELC50PD
 19636        MOVE +1                  TO SUB                           ELC50PD
 19637        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 19638        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19639        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19640        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19641        GO TO 6370-SEARCH-LOOP.                                   ELC50PD
 19642                                                                  ELC50PD
 19643     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19644                                                                  ELC50PD
 19645     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19646     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19647*    MOVE 'L'                    TO CNTL-REC-TYPE.                ELC50PD
 19648     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.                ELC50PD
 19649     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19650     MOVE '4' TO RC-SW-2.                                         ELC50PD
 19651     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19652                                                                  ELC50PD
 19653     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19654        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19655        GO TO 6370-NO-LF-FOUND.                                   ELC50PD
 19656                                                                  ELC50PD
 19657     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.            ELC50PD
 19658     MOVE +1                     TO SUB.                          ELC50PD
 19659                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 356
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19660 6370-SEARCH-LOOP.                                                ELC50PD
 19661     IF CF-LIFE-CODE-OUT (SUB) = ZEROS                            ELC50PD
 19662         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19663                                                                  ELC50PD
 19664     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)                  ELC50PD
 19665         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD        ELC50PD
 19666         GO TO 6370-HER-NET-PAY-CHECK.                            ELC50PD
 19667                                                                  ELC50PD
 19668     ADD 1   TO SUB.                                              ELC50PD
 19669*    IF SUB GREATER 120                                           ELC50PD
 19670     IF SUB GREATER 200                                           ELC50PD
 19671         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19672                                                                  ELC50PD
 19673     GO TO 6370-SEARCH-LOOP.                                      ELC50PD
 19674                                                                  ELC50PD
 19675 6370-NO-LF-FOUND.                                                ELC50PD
 19676                                                                  ELC50PD
 19677     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19678                                                                  ELC50PD
 19679 6370-HER-NET-PAY-CHECK.                                          ELC50PD
 19680                                                                  ELC50PD
 19681     IF PB-COMPANY-ID = 'CID'
 19682        IF PB-SV-STATE = 'CA' OR 'MN'
 19683           IF PB-I-LF-BENEFIT-CD = '02'
 19684              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19685           ELSE
 19686              IF PB-I-LF-BENEFIT-CD = '04'
 19687                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19688              END-IF
 19689           END-IF
 19690        END-IF
 19691     END-IF
 19692
 19693     IF PB-COMPANY-ID NOT = 'HER'                                 ELC50PD
 19694         GO TO 6370-EXIT.                                         ELC50PD
 19695                                                                  ELC50PD
 19696     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'                  ELC50PD
 19697         GO TO 6370-EXIT.                                         ELC50PD
 19698                                                                  ELC50PD
 19699     IF PB-I-LF-TERM NOT NUMERIC                                  ELC50PD
 19700         MOVE ZEROS              TO PB-I-LF-TERM.                 ELC50PD
 19701                                                                  ELC50PD
 19702     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 19703         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 19704                                                                  ELC50PD
 19705     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM                  ELC50PD
 19706         GO TO 6370-EXIT.                                         ELC50PD
 19707                                                                  ELC50PD
 19708     IF PB-I-LF-BENEFIT-CD = '33'                                 ELC50PD
 19709         MOVE '31'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19710                                                                  ELC50PD
 19711     IF PB-I-LF-BENEFIT-CD = '34'                                 ELC50PD
 19712         MOVE '32'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19713                                                                  ELC50PD
 19714 6370-EXIT.                                                       ELC50PD
 19715     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 357
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19717                                                                  ELC50PD
 19718 6380-EDIT-INPUT-AH-CODE.                                         ELC50PD
 19719     IF WK-AH-EDIT-ADDR NOT = ZEROS                               ELC50PD
 19720        MOVE +1                  TO SUB                           ELC50PD
 19721        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 19722        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19723        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19724        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19725        GO TO 6380-SEARCH-LOOP.                                   ELC50PD
 19726                                                                  ELC50PD
 19727     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19728                                                                  ELC50PD
 19729     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19730     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19731     MOVE 'A'                    TO CNTL-REC-TYPE.                ELC50PD
 19732*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.                ELC50PD
 19733     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19734     MOVE '5' TO RC-SW-2.                                         ELC50PD
 19735     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19736                                                                  ELC50PD
 19737     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19738        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19739        GO TO 6380-NO-AH-FOUND.                                   ELC50PD
 19740                                                                  ELC50PD
 19741     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.              ELC50PD
 19742     MOVE +1 TO SUB.                                              ELC50PD
 19743                                                                  ELC50PD
 19744 6380-SEARCH-LOOP.                                                ELC50PD
 19745     IF CF-AH-CODE-OUT (SUB) = ZEROS                              ELC50PD
 19746         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19747                                                                  ELC50PD
 19748     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)                    ELC50PD
 19749         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD          ELC50PD
 19750         GO TO 6380-CSO-AH-ONLY-CHECKS.                           ELC50PD
 19751                                                                  ELC50PD
 19752     ADD 1   TO SUB.                                              ELC50PD
 19753     IF SUB GREATER THAN 96                                       ELC50PD
 19754*    IF SUB GREATER THAN 300                                      ELC50PD
 19755         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19756                                                                  ELC50PD
 19757     GO TO 6380-SEARCH-LOOP.                                      ELC50PD
 19758                                                                  ELC50PD
 19759 6380-NO-AH-FOUND.                                                ELC50PD
 19760                                                                  ELC50PD
 19761     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.               ELC50PD
 19762                                                                  ELC50PD
 19763     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE                        ELC50PD
 19764         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD            ELC50PD
 19765     ELSE                                                         ELC50PD
 19766         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.           ELC50PD
 19767                                                                  ELC50PD
 19768 6380-CSO-AH-ONLY-CHECKS.                                         ELC50PD
 19769                                                                  ELC50PD
 19770     IF PB-COMPANY-ID = 'CSO' OR 'CID'                            ELC50PD
 19771        NEXT SENTENCE                                             ELC50PD
 19772      ELSE                                                        ELC50PD
 19773        GO TO 6380-EXIT.                                          ELC50PD
 19774                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 358
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19775     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS                 ELC50PD
 19776         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.                      ELC50PD
 19777                                                                  ELC50PD
 19778                                                                  00041198
 19779     GO TO 6380-EXIT                                              00041198
 19780     .
 19781 6380-CSO-LIFE-WITH-AH-CHECKS.                                    00041202
 19782                                                                  00041203
 19783                                                                  ELC50PD
 19784     .                                                            ELC50PD
 19785 6380-EXIT.                                                       ELC50PD
 19786     EXIT.                                                        ELC50PD
 19787                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 359
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19789                                                                  ELC50PD
 19790 6400-COMPUTE-EXTENSION-DAYS.                                     ELC50PD
 19791                                                                  ELC50PD
 19792******************************************************************ELC50PD
 19793*                                                                *ELC50PD
 19794*                   COMPUTE EXTENSION DAYS                       *ELC50PD
 19795*                                                                *ELC50PD
 19796*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *ELC50PD
 19797*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *ELC50PD
 19798*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *ELC50PD
 19799*    THE EXTENSION DAYS.                                         *ELC50PD
 19800*                                                                *ELC50PD
 19801******************************************************************ELC50PD
 19802                                                                  ELC50PD
 19803     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.            ELC50PD
 19804     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.            ELC50PD
 19805                                                                  ELC50PD
 19806******************************************************************ELC50PD
 19807*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *ELC50PD
 19808*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*ELC50PD
 19809******************************************************************ELC50PD
 19810                                                                  ELC50PD
 19811     IF DC-ELAPSED-MONTHS GREATER THAN +0                         ELC50PD
 19812        COMPUTE WS-ODD-DAYS-OVER =                                ELC50PD
 19813               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER  ELC50PD
 19814     ELSE                                                         ELC50PD
 19815        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.             ELC50PD
 19816                                                                  ELC50PD
 19817     IF WS-ODD-DAYS-OVER = ZEROS                                  ELC50PD
 19818           GO TO 6499-EXIT                                        ELC50PD
 19819     ELSE                                                         ELC50PD
 19820        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY                     ELC50PD
 19821           IF WS-WDF-MONTH = 02                                   ELC50PD
 19822              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT         ELC50PD
 19823              ADD 2       TO  WS-ODD-DAYS-OVER                    ELC50PD
 19824              GO TO 6499-EXIT                                     ELC50PD
 19825           ELSE                                                   ELC50PD
 19826              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31    ELC50PD
 19827                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER                 ELC50PD
 19828                 GO TO 6499-EXIT                                  ELC50PD
 19829               ELSE                                               ELC50PD
 19830                 GO TO 6499-EXIT                                  ELC50PD
 19831        ELSE                                                      ELC50PD
 19832           GO TO 6499-EXIT.                                       ELC50PD
 19833                                                                  ELC50PD
 19834 6412-CHECK-TO-DAY.                                               ELC50PD
 19835                                                                  ELC50PD
 19836        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0         ELC50PD
 19837           IF WS-WDT-DAY = 28                                     ELC50PD
 19838              ADD 2              TO WS-ODD-DAYS-OVER              ELC50PD
 19839           ELSE                                                   ELC50PD
 19840              IF WS-WDT-DAY = 29                                  ELC50PD
 19841                 ADD 1           TO WS-ODD-DAYS-OVER              ELC50PD
 19842              ELSE                                                ELC50PD
 19843                 NEXT SENTENCE                                    ELC50PD
 19844        ELSE                                                      ELC50PD
 19845           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0        ELC50PD
 19846              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 360
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19847                                                                  ELC50PD
 19848     GO TO 6499-EXIT.                                             ELC50PD
 19849                                                                  ELC50PD
 19850                                                                  ELC50PD
 19851 6415-CHECK-LEAP-YEAR.                                            ELC50PD
 19852                                                                  ELC50PD
 19853     IF DC-DAYS-IN-MONTH = 29                                     ELC50PD
 19854        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.                         ELC50PD
 19855                                                                  ELC50PD
 19856 6415-EXIT.                                                       ELC50PD
 19857     EXIT.                                                        ELC50PD
 19858                                                                  ELC50PD
 19859 6499-EXIT.                                                       ELC50PD
 19860      EXIT.                                                       ELC50PD
 19861                                                                  ELC50PD
 19862 6500-END.                                                        ELC50PD
 19863     EXIT.
 19864
 19865                                                                  ELC50PD
 19866******************************************************************ELC50PD
 19867************* PROCEDURE DIVISION FOR EL050 ***********************ELC50PD
 19868********************** ELC50PD END *******************************ELC50PD
 19869                                                                  ELC50PD
 19870*
 19871*
 19872**START***********************************************************
 19873*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 19874*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT
 19875******************************************************************
 19876*
 19877 6600-GET-STATE-MUNICIPAL-TAX.
 19878
 19879     IF PB-COMPANY-ID NOT = 'DMD'
 19880         GO TO 6640-EXIT.
 19881
 19882     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19883     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19884     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19885
 19886*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19887     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19888     MOVE SPACES TO DC-ALPHA-CENTURY.
 19889     SET BIN-TO-GREG          TO TRUE.
 19890     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19891
 19892     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 19893     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 19894
 19895     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19896     MOVE WS-ERRESS-KEY       TO ERRESS-PRIMARY-KEY
 19897                                 WS-SAVE-ERRESS-KEY.
 19898
 19899*POSITION FILE AT STARTING KEY RECORD(COMPANY, STATE, CATEGORY)
 19900*WANT RECORD WITH RES-EXPIRE-DT GREATER THAN PB-CERT-EFF-DT
 19901
 19902     START ERRESS KEY NOT LESS THAN ERRESS-PRIMARY-KEY.
 19903
 19904     IF ERRESS-FILE-STATUS NOT EQUAL '00'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 361
* EL517.cbl
 19905         MOVE ER-8002        TO WS-ERROR
 19906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19907         GO TO 6640-EXIT.
 19908
 19909*GET RECORD WHERE POSITIONED
 19910
 19911 6600-READ-ERRESS-NEXT.
 19912     READ ERRESS NEXT RECORD.
 19913
 19914     IF ERRESS-FILE-STATUS NOT EQUAL '00'
 19915         MOVE ER-8002        TO WS-ERROR
 19916         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19917         GO TO 6640-EXIT.
 19918
 19919*GOT GOOD RECORD ??    FIRST 4 POSITIONS MUST MATCH
 19920
 19921     IF ERRESS-PRIMARY-KEY (1:4) = WS-SAVE-ERRESS-KEY (1:4)
 19922        NEXT SENTENCE
 19923     ELSE
 19924        MOVE ER-8002        TO WS-ERROR
 19925        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19926        GO TO 6640-EXIT.
 19927
 19928     IF WS-CONTRACT-DATE LESS THAN RES-EXPIRE-DATE
 19929        NEXT SENTENCE
 19930     ELSE
 19931        GO TO 6600-READ-ERRESS-NEXT.
 19932
 19933*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19934*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA
 19935
 19936     MOVE +2                     TO WS-SUB1.
 19937
 19938     IF PB-CANCELLATION
 19939        IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19940           MOVE +1               TO WS-SUB1.
 19941
 19942     IF PB-ISSUE
 19943        IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19944           MOVE +1               TO WS-SUB1.
 19945
 19946*
 19947*CONVERT ANNIVERSARY DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19948*
 19949     MOVE AM-AN-MO            TO WS-NEXT-CONTRACT-DATE (5:2).
 19950     MOVE AM-AN-DA            TO WS-NEXT-CONTRACT-DATE (7:2).
 19951     MOVE AM-AN-YR            TO WS-NEXT-CONTRACT-DATE (3:2).
 19952     MOVE AM-AN-CC            TO WS-NEXT-CONTRACT-DATE (1:2).
 19953
 19954
 19955*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19956*TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19957*TEST IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APPLIES
 19958
 19959     ADD 1                    TO WS-YEAR-YY.
 19960
 19961     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19962         MOVE RES-REN-STATE-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 362
* EL517.cbl
 19963                              TO WS-RES-STATE-TAX
 19964         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
 19965                              TO WS-RES-MUNI-TAX
 19966     ELSE
 19967         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19968                              TO WS-RES-STATE-TAX
 19969         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19970                              TO WS-RES-MUNI-TAX.
 19971
 19972*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19973
 19974     IF PB-CANCELLATION
 19975         GO TO 6640-CANCEL-TAX.
 19976
 19977     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19978          COMPUTE PB-I-STATE-TAX ROUNDED =
 19979                                    PB-I-LF-PREMIUM-AMT
 19980                                  * WS-RES-STATE-TAX
 19981          COMPUTE PB-I-MUNI-TAX ROUNDED =
 19982                                    PB-I-LF-PREMIUM-AMT
 19983                                  * WS-RES-MUNI-TAX
 19984     ELSE
 19985     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19986          COMPUTE PB-I-STATE-TAX ROUNDED =
 19987                                    PB-I-AH-PREMIUM-AMT
 19988                                  * WS-RES-STATE-TAX
 19989          COMPUTE PB-I-MUNI-TAX ROUNDED =
 19990                                    PB-I-AH-PREMIUM-AMT
 19991                                  * WS-RES-MUNI-TAX.
 19992
 19993     GO TO 6640-EXIT.
 19994
 19995 6640-CANCEL-TAX.
 19996     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19997
 19998     IF PB-C-LF-CANCEL-AMT > ZEROS
 19999          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20000                                    PB-C-LF-CANCEL-AMT
 20001                                  * WS-RES-STATE-TAX
 20002          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20003                                    PB-C-LF-CANCEL-AMT
 20004                                  * WS-RES-MUNI-TAX
 20005     ELSE
 20006     IF PB-C-AH-CANCEL-AMT > ZEROS
 20007          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20008                                    PB-C-AH-CANCEL-AMT
 20009                                  * WS-RES-STATE-TAX
 20010          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20011                                    PB-C-AH-CANCEL-AMT
 20012                                  * WS-RES-MUNI-TAX.
 20013
 20014 6640-EXIT.
 20015     EXIT.
 20016
 20017 6650-GET-RES-STATE-COMM.
 20018
 20019     IF PB-COMPANY-ID NOT = 'DMD'
 20020         GO TO 6700-COMM-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 363
* EL517.cbl
 20021
 20022     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 20023     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 20024     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 20025     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 20026     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 20027     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 20028     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 20029
 20030*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20031
 20032     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20033     MOVE SPACES              TO DC-ALPHA-CENTURY.
 20034     SET BIN-TO-GREG          TO TRUE.
 20035     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20036
 20037     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20038     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20039
 20040     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 20041
 20042*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, ST,
 20043*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 20044*VALUE OF PB-CERT-EFF-DT
 20045
 20046     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
 20047     START ERRESC KEY NOT LESS THAN ERRESC-RECORD-KEY.
 20048
 20049     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20050         GO TO 6700-COMM-EXIT.
 20051
 20052*GET RECORD WHERE POSITIONED
 20053
 20054 6650-READ-ERRESC-NEXT.
 20055     READ ERRESC NEXT RECORD.
 20056
 20057     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20058         GO TO 6700-COMM-EXIT.
 20059
 20060     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 20061        NEXT SENTENCE
 20062     ELSE
 20063         GO TO 6700-COMM-EXIT.
 20064
 20065     IF WS-CONTRACT-DATE IS LESS THAN RESC-EXPIRE-DATE
 20066         NEXT SENTENCE
 20067       ELSE
 20068         GO TO 6650-READ-ERRESC-NEXT.
 20069
 20070*CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT ST
 20071*COMMISSION RECORD'S EFFECTIVE TIME PERIOD??
 20072
 20073     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
 20074         GO TO 6700-COMM-EXIT.
 20075
 20076* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 20077
 20078     MOVE ZEROS               TO WS-SUB WS-SUB1.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 364
* EL517.cbl
 20079
 20080     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 20081
 20082     IF WS-SUB1 > ZERO
 20083         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
 20084             PERFORM 6680-SET-COMMISSION
 20085         ELSE
 20086             PERFORM 6680-SET-TABLE-CODE.
 20087
 20088     GO TO 6700-COMM-EXIT.
 20089
 20090 6680-SET-TABLE-CODE.
 20091     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20092        MOVE ZEROS             TO WS-SUB1
 20093     ELSE
 20094* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20095* TO COMPUTE AH COMMISSION.
 20096        MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 20097        MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 20098        MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 20099        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 20100        PERFORM 6680-READ-CTBL-TABLE
 20101        IF ERCTBL-FILE-STATUS NOT = '00'
 20102           MOVE ZEROS          TO WS-SUB1.
 20103
 20104 6680-READ-CTBL-TABLE.
 20105*
 20106* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 20107* TO COMPUTE LIFE COMMISSION
 20108
 20109     IF CTBL-SW = '0540'
 20110        MOVE WS-LF-COMP-CD     TO CTBL-BEN-CODE
 20111        MOVE PB-I-LF-TERM      TO WS-WORK-TERM
 20112        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 20113
 20114     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 20115
 20116     IF CTBL-TABLE-FOUND
 20117        IF CTBL-SW = '0530'
 20118             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 20119                                        PB-I-AH-TERM
 20120             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20121             MOVE WS-WK-RATE        TO WS-COMMISSION
 20122                                       PB-I-AH-COMMISSION
 20123        ELSE
 20124             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 20125             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20126             MOVE WS-WK-RATE        TO WS-COMMISSION
 20127                                       PB-I-LIFE-COMMISSION
 20128     ELSE
 20129        IF FIRST-TIME-THROUGH
 20130            GO TO 6680-READ-CTBL-TABLE
 20131        ELSE
 20132            MOVE ZEROS         TO WS-SUB1.
 20133
 20134 6680-SET-COMMISSION.
 20135     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20136           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 365
* EL517.cbl
 20137       ELSE
 20138           MOVE RESC-COMMISSION-PER (WS-SUB)
 20139                             TO WS-COMMISSION
 20140           IF CTBL-SW = '0540'
 20141               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION
 20142           ELSE
 20143               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION.
 20144
 20145 6680-SEARCH-CATEGORY.
 20146     ADD +1                   TO WS-SUB.
 20147     IF WS-SUB > +12
 20148         GO TO 6680-EXIT.
 20149
 20150     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20151          MOVE WS-SUB         TO WS-SUB1
 20152          GO TO 6680-EXIT.
 20153
 20154     GO TO 6680-SEARCH-CATEGORY.
 20155
 20156 6680-EXIT.
 20157     EXIT.
 20158
 20159 6700-COMM-EXIT.
 20160     EXIT.
 20161**END*************************************************************
 20162*      CUSTOM CODING FOR CLIENT "DMD"
 20163******************************************************************
 20164*
 20165 7000-GET-RATE.
 20166     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20167
 20168 7000-EXIT.
 20169     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 366
* EL517.cbl
 20171
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 367
* EL517.cbl
 20173 7100-FIND-BENEFIT-IN-STATE.
 20174     MOVE 'N'                    TO BEN-SEARCH-SW.
 20175
 20176     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 20177         VARYING SUB3 FROM 1 BY 1 UNTIL
 20178            ((SUB3 GREATER 50) OR
 20179              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 20180               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 20181
 20182     IF SUB3 NOT = 51
 20183         IF CF-ST-BENEFIT-CD (SUB3) NOT = '00'
 20184             MOVE 'Y'            TO BEN-SEARCH-SW.
 20185
 20186     GO TO 7199-EXIT.
 20187
 20188 7100-BENEFIT-DUMMY.
 20189
 20190 7100-DUMMY-EXIT.
 20191     EXIT.
 20192
 20193 7199-EXIT.
 20194     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 368
* EL517.cbl
 20196 7200-FIND-BENEFIT.
 20197     MOVE 'N'                    TO BEN-SEARCH-SW.
 20198
 20199     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 20200         VARYING SUB3 FROM 1 BY 1 UNTIL
 20201            ((SUB3 GREATER 8) OR
 20202            (CF-BENEFIT-CODE (SUB3) = WS-BEN-CD)).
 20203
 20204     IF SUB3 NOT = 9
 20205         MOVE 'Y'                TO BEN-SEARCH-SW.
 20206
 20207     GO TO 7200-EXIT.
 20208
 20209 7200-BENEFIT-DUMMY.
 20210
 20211     EXIT.
 20212 7200-DUMMY-EXIT.
 20213     EXIT.
 20214
 20215 7200-EXIT.
 20216     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 369
* EL517.cbl
 20218 7250-LOOK-FOR-RESCINDED-CLAIM.
 20219
 20220     IF ELMSTR-OPEN = ' '
 20221         OPEN INPUT ELMSTR
 20222         MOVE 'X'                TO ELMSTR-OPEN
 20223         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20224             NEXT SENTENCE
 20225         ELSE
 20226             MOVE ELMSTR-FILE-STATUS
 20227                                 TO WS-ABEND-FILE-STATUS
 20228             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20229             MOVE EMSG           TO WS-ABEND-MESSAGE
 20230             GO TO ABEND-PGM.
 20231
 20232     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20233                                    W-CL-COMP-CD.
 20234     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20235                                    W-CL-CERT-NO.
 20236     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20237
 20238     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20239
 20240     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20241         GO TO 7250-EXIT.
 20242
 20243     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20244         GO TO 7250-CLAIMS-ERROR.
 20245
 20246 7250-NEXT-CLAIM.
 20247
 20248     READ ELMSTR NEXT.
 20249
 20250     IF ELMSTR-FILE-STATUS = '10'
 20251         GO TO 7250-EXIT.
 20252
 20253     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20254         GO TO 7250-CLAIMS-ERROR.
 20255
 20256     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20257        MSTR-CERT-NO NOT = CL-CERT-NO-A4
 20258         GO TO 7250-EXIT.
 20259
 20260     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20261        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20262        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20263        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20264        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20265         GO TO 7250-NEXT-CLAIM.
 20266
 20267     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20268        OR (CL-CLAIM-TYPE = 'I')
 20269        OR (CL-CLAIM-TYPE = 'G')
 20270          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20271              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 20272              GO TO 7250-EXIT
 20273          END-IF
 20274     END-IF.
 20275
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 370
* EL517.cbl
 20276     GO TO 7250-NEXT-CLAIM.
 20277
 20278 7250-CLAIMS-ERROR.
 20279
 20280     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20281     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20282     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20283     GO TO ABEND-PGM.
 20284
 20285 7250-EXIT.
 20286     EXIT.
 20287 7300-CHECK-FOR-OPEN-CLMS.
 20288
 20289     IF ELMSTR-OPEN = ' '
 20290         OPEN INPUT ELMSTR
 20291         MOVE 'X'                TO ELMSTR-OPEN
 20292         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20293             NEXT SENTENCE
 20294         ELSE
 20295             MOVE ELMSTR-FILE-STATUS
 20296                                 TO WS-ABEND-FILE-STATUS
 20297             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20298             MOVE EMSG           TO WS-ABEND-MESSAGE
 20299             GO TO ABEND-PGM.
 20300
 20301     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20302                                    W-CL-COMP-CD.
 20303     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20304                                    W-CL-CERT-NO.
 20305     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20306
 20307     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20308
 20309     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20310         GO TO 7300-EXIT.
 20311
 20312     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20313         GO TO 7300-CLAIMS-ERROR.
 20314
 20315     MOVE 'Y'                    TO W-BROWSE-SW.
 20316
 20317 7300-NEXT-CLAIM.
 20318
 20319     READ ELMSTR NEXT.
 20320
 20321     IF ELMSTR-FILE-STATUS = '10'
 20322         GO TO 7300-EXIT.
 20323
 20324     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20325         GO TO 7300-CLAIMS-ERROR.
 20326
 20327     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20328        MSTR-CERT-NO NOT = CL-CERT-NO-A4
 20329         GO TO 7300-EXIT.
 20330
 20331     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20332        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20333        PB-SV-STATE    NOT = CL-CERT-STATE    OR
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 371
* EL517.cbl
 20334        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20335        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20336         GO TO 7300-NEXT-CLAIM.
 20337
 20338     IF CL-CLAIM-TYPE = AH-OVERRIDE-L1
 20339        OR 'I' OR 'G'
 20340        IF CLAIM-IS-OPEN
 20341           EVALUATE TRUE
 20342             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20343                 MOVE ER-2884      TO WS-ERROR
 20344             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20345                 MOVE ER-2887      TO WS-ERROR
 20346             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20347                 MOVE ER-2886      TO WS-ERROR
 20348             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20349                 MOVE ER-2888      TO WS-ERROR
 20350             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20351                 MOVE ER-2885      TO WS-ERROR
 20352             WHEN OTHER
 20353                 MOVE ER-2768      TO WS-ERROR
 20354           END-EVALUATE
 20355           IF PB-C-AH-CANCEL-VOIDED OR
 20356              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20357                NOT AH-COVERAGE-CANCELLED)
 20358               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20359               MOVE ER-2768      TO WS-ERROR
 20360           END-IF
 20361           PERFORM 9900-ERROR-FORMAT
 20362                                 THRU 9900-EXIT
 20363           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20364              PB-FORCE-CODE NOT EQUAL '8'
 20365               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20366           END-IF
 20367           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20368           GO TO 7300-EXIT
 20369        ELSE
 20370           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20371*****THIS IS A RESCISSION OR REFORMATION
 20372              IF (AH-COVERAGE-CANCELLED AND
 20373                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 20374                    MOVE ER-2890 TO WS-ERROR
 20375                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20376                    GO TO 7300-EXIT
 20377              END-IF
 20378           ELSE
 20379              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20380               AND PB-C-AH-CANCEL-DT > SPACES
 20381                 MOVE ER-2756       TO WS-ERROR
 20382                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20383                 GO TO 7300-EXIT
 20384              END-IF
 20385           END-IF
 20386        END-IF
 20387     ELSE
 20388        IF CL-CLAIM-TYPE = LIFE-OVERRIDE-L1
 20389           IF CLAIM-IS-OPEN
 20390              MOVE ER-2889    TO WS-ERROR
 20391              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 372
* EL517.cbl
 20392              GO TO 7300-EXIT
 20393           ELSE
 20394              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20395*****THIS IS A RESCISSION OR REFORMATION
 20396                 IF (LF-COVERAGE-CANCELLED AND
 20397                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20398                       MOVE ER-2890 TO WS-ERROR
 20399                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20400                       GO TO 7300-EXIT
 20401                 END-IF
 20402              ELSE
 20403                 IF (AH-COVERAGE-CANCELLED AND
 20404                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 20405                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 20406                    (LF-COVERAGE-CANCELLED AND
 20407                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 20408                     WS-ST-REFUND-CLAIM-FLAG = '4')
 20409                       MOVE ER-2965 TO WS-ERROR
 20410                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20411                       GO TO 7300-EXIT
 20412                 END-IF
 20413                 IF LF-COVERAGE-CANCELLED
 20414                  IF CL-TOTAL-PAID-AMT > 0
 20415                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20416                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20417                        MOVE ER-2891 TO WS-ERROR
 20418                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20419                        GO TO 7300-EXIT
 20420                      END-IF
 20421                    ELSE
 20422                      MOVE ER-2892 TO WS-ERROR
 20423                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20424                      GO TO 7300-EXIT
 20425                    END-IF
 20426                  END-IF
 20427                 END-IF
 20428              END-IF
 20429           END-IF
 20430        END-IF
 20431     END-IF
 20432
 20433     GO TO 7300-NEXT-CLAIM.
 20434
 20435 7300-CLAIMS-ERROR.
 20436
 20437     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20438     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20439     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20440     GO TO ABEND-PGM.
 20441
 20442 7300-EXIT.
 20443     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 373
* EL517.cbl
 20445
 20446 7400-GET-REMAIN-TERM.
 20447     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20448
 20449 7400-EXIT.
 20450     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 374
* EL517.cbl
 20452
 20453 7500-GET-REMAIN-AMOUNT.
 20454     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 20455
 20456 7500-EXIT.
 20457     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 375
* EL517.cbl
 20459
 20460 7600-GET-REFUND.
 20461     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 20462
 20463 7600-EXIT.
 20464     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 376
* EL517.cbl
 20466
 20467 7700-CALL-DL1.
 20468     MOVE 'P'                    TO DMPF-PROCESS-TYPE.
 20469     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 20470
 20471 7700-EXIT.
 20472     EXIT.
 20473
 20474 7710-CALL-DL2.
 20475     MOVE 'P'                    TO DIPF-PROCESS-TYPE.
 20476     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 20477
 20478 7710-EXIT.
 20479     EXIT.
 20480
 20481 7720-CALL-DL3.
 20482     MOVE 'P'                    TO DVBI-PROCESS-TYPE.
 20483     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 20484
 20485 7720-EXIT.
 20486     EXIT.
 20487
 20488 7730-CALL-DL7.
 20489     MOVE 'P'                    TO DCUA-PROCESS-TYPE.
 20490     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 20491
 20492 7730-EXIT.
 20493     EXIT.
 20494
 20495 7740-CALL-DL11.
 20496     MOVE 'P'                    TO DPRB-PROCESS-TYPE.
 20497     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 20498
 20499 7740-EXIT.
 20500     EXIT.
 20501
 20502 7750-CALL-DL17.
 20503     MOVE 'P'                    TO DVRC-PROCESS-TYPE.
 20504     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 20505
 20506 7750-EXIT.
 20507     EXIT.
 20508
 20509 7755-CALL-DL19.
 20510     MOVE 'P'                    TO DOCC-PROCESS-TYPE.
 20511     CALL 'DLB019' USING  WS-DLB-ORIG-COV-CAT.
 20512
 20513 7755-EXIT.
 20514     EXIT.
 20515
 20516 7760-CALL-DL21.
 20517     CALL 'DLB021' USING  WS-DLB-VALID-LOAN-OFFICER.
 20518
 20519 7760-EXIT.
 20520     EXIT.
 20521
 20522 7770-CALL-DL22.
 20523     MOVE 'P'                    TO DVSC-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 377
* EL517.cbl
 20524     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 20525
 20526 7770-EXIT.
 20527     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 378
* EL517.cbl
 20529
 20530 7800-REWRITE-CERT.
 20531     REWRITE CERTIFICATE-MASTER.
 20532     ADD 1 TO WCER.
 20533
 20534 7800-EXIT.
 20535      EXIT.
 20536     EXIT.
 20537
 20538 8000-WRITE-CERT.
 20539
 20540     WRITE CERTIFICATE-MASTER.
 20541     ADD 1 TO WCER.
 20542     IF ELCERT-FILE-STATUS NOT = '00'
 20543         GO TO 8000-FREE-MAIN.
 20544
 20545 8000-FREE-MAIN.
 20546
 20547 8000-EXIT.
 20548     EXIT.
 20549      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 379
* EL517.cbl
 20551
 20552 8100-READ-ERPNDM.
 20553     IF ERPNDM-OPEN = ' '
 20554        OPEN INPUT ERPNDM
 20555        MOVE 'X' TO ERPNDM-OPEN
 20556        IF ERPNDM-FILE-STATUS = '00' OR '97'
 20557           NEXT SENTENCE
 20558        ELSE
 20559           MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20560           MOVE 'ERPNDM'              TO WS-FEM-FILE-NAME
 20561           MOVE EMSG TO WS-ABEND-MESSAGE
 20562           GO TO ABEND-PGM.
 20563
 20564     MOVE SPACES                 TO ERPNDM-FOUND.
 20565     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20566     READ ERPNDM.
 20567
 20568     IF ERPNDM-FILE-STATUS  = '00'
 20569        CONTINUE
 20570     ELSE
 20571        MOVE 'X'                 TO ERPNDM-FOUND
 20572        MOVE ER-2694             TO WS-ERROR
 20573        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20574        MOVE ER-2883             TO WS-ERROR
 20575        PERFORM 9900-ERROR-FORMAT
 20576                                 THRU 9900-EXIT
 20577     END-IF
 20578
 20579     .
 20580 8100-EXIT.
 20581     EXIT.
 20582
 20583 8110-READ-ERMAIL.
 20584     IF ERMAIL-OPEN = ' '
 20585        OPEN  I-O ERMAIL
 20586        MOVE 'X' TO ERMAIL-OPEN
 20587        IF ERMAIL-FILE-STATUS = '00' OR '97'
 20588           NEXT SENTENCE
 20589        ELSE
 20590            MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20591            MOVE 'ERMAIL'              TO WS-FEM-FILE-NAME
 20592            MOVE EMSG TO WS-ABEND-MESSAGE
 20593            GO TO ABEND-PGM.
 20594
 20595     MOVE SPACES                 TO ERMAIL-FOUND.
 20596     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20597     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20598     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20599     MOVE PB-SV-STATE            TO MA-STATE.
 20600
 20601     READ ERMAIL.
 20602
 20603     IF ERMAIL-FILE-STATUS  = '00'
 20604         NEXT SENTENCE
 20605       ELSE
 20606        MOVE 'X'                 TO ERMAIL-FOUND.
 20607
 20608 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 380
* EL517.cbl
 20609     EXIT.
 20610
 20611 8120-REWRITE-ERMAIL.
 20612     REWRITE MAILING-DATA.
 20613
 20614 8120-EXIT.
 20615     EXIT.
 20616
 20617 8130-WRITE-ERMAIL.
 20618     WRITE MAILING-DATA.
 20619
 20620 8130-EXIT.
 20621     EXIT.
 20622
 20623 8140-UNLOCK-ERMAIL.
 20624     MOVE SPACES                 TO ERMAIL-FOUND.
 20625
 20626 8140-EXIT.
 20627     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 381
* EL517.cbl
 20629
 20630 8180-UPDATE-VIN-NUMBER.
 20631
 20632     IF ELCRTT-OPEN = ' '
 20633         OPEN I-O ELCRTT
 20634         MOVE 'X' TO ELCRTT-OPEN
 20635         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20636             NEXT SENTENCE
 20637         ELSE
 20638             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20639             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20640             MOVE EMSG               TO WS-ABEND-MESSAGE
 20641             GO TO ABEND-PGM
 20642         END-IF
 20643     END-IF.
 20644
 20645     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20646     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20647     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20648
 20649     READ ELCRTT.
 20650
 20651     IF ELCRTT-FILE-STATUS  = '00'
 20652        CONTINUE
 20653     ELSE
 20654        GO TO 8180-NOTFND
 20655     END-IF.
 20656
 20657     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20658         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20659         REWRITE CERTIFICATE-TRAILERS
 20660     END-IF.
 20661
 20662     GO TO 8180-EXIT.
 20663
 20664 8180-NOTFND.
 20665
 20666     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20667     MOVE 'CS'         TO CS-RECORD-ID.
 20668     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20669     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20670     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20671     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20672     WRITE CERTIFICATE-TRAILERS.
 20673
 20674 8180-EXIT.
 20675     EXIT.
 20676
 20677 8190-UPDATE-REFUND-CLAIM-FLAG.
 20678
 20679     IF ELCRTT-OPEN = ' '
 20680         OPEN I-O ELCRTT
 20681         MOVE 'X' TO ELCRTT-OPEN
 20682         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20683             NEXT SENTENCE
 20684         ELSE
 20685             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20686             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 382
* EL517.cbl
 20687             MOVE EMSG               TO WS-ABEND-MESSAGE
 20688             GO TO ABEND-PGM
 20689         END-IF
 20690     END-IF.
 20691
 20692     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20693     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20694     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20695
 20696     READ ELCRTT.
 20697
 20698     IF ELCRTT-FILE-STATUS  = '00'
 20699        CONTINUE
 20700     ELSE
 20701        GO TO 8190-NOTFND
 20702     END-IF.
 20703
 20704     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20705     REWRITE CERTIFICATE-TRAILERS.
 20706
 20707     GO TO 8190-EXIT.
 20708
 20709 8190-NOTFND.
 20710
 20711     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20712     MOVE 'CS'         TO CS-RECORD-ID.
 20713     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20714     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20715     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20716     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20717     WRITE CERTIFICATE-TRAILERS.
 20718
 20719 8190-EXIT.
 20720     EXIT.
 20721
 20722 8195-UPDATE-AGE-FLAGS.
 20723     IF ELCRTT-OPEN = ' '
 20724         OPEN I-O ELCRTT
 20725         MOVE 'X' TO ELCRTT-OPEN
 20726         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20727             NEXT SENTENCE
 20728         ELSE
 20729             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20730             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20731             MOVE EMSG               TO WS-ABEND-MESSAGE
 20732             GO TO ABEND-PGM
 20733         END-IF
 20734     END-IF.
 20735
 20736     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20737     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20738     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20739
 20740     READ ELCRTT.
 20741
 20742     IF ELCRTT-FILE-STATUS  = '00'
 20743        CONTINUE
 20744     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 383
* EL517.cbl
 20745        GO TO 8195-NOTFND
 20746     END-IF.
 20747
 20748     IF WS-INS-AGE-SET = 'Y'
 20749        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20750     END-IF
 20751     IF WS-JNT-AGE-SET = 'Y'
 20752        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20753     END-IF
 20754
 20755     REWRITE CERTIFICATE-TRAILERS.
 20756
 20757     GO TO 8195-EXIT.
 20758
 20759 8195-NOTFND.
 20760
 20761     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20762     MOVE 'CS'         TO CS-RECORD-ID.
 20763     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20764     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20765     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20766     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20767     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20768     WRITE CERTIFICATE-TRAILERS.
 20769
 20770 8195-EXIT.
 20771     EXIT.
 20772
 20773 8200-READ-REIN-TABLE.
 20774     MOVE ERREIN-KEY TO RE-CONTROL-PRIMARY.
 20775     READ ERREIN.
 20776     ADD 1 TO RREI.
 20777
 20778     IF RE-CODE NOT = 'A'
 20779        PERFORM REIN-DATE-LOAD.
 20780
 20781     IF ERREIN-FILE-STATUS NOT = '00'
 20782          GO TO 8200-NOTFND.
 20783
 20784     GO TO 8200-EXIT.
 20785
 20786 8200-NOTFND.
 20787     MOVE 'N'                TO WS-REIN-READ-SW.
 20788
 20789 8200-EXIT.
 20790     EXIT.
 20791      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 384
* EL517.cbl
 20793
 20794 8300-READ-CTBL-TABLE.
 20795     MOVE ERCTBL-KEY TO CT-CONTROL-PRIMARY.
 20796     READ ERCTBL.
 20797     ADD 1 TO RCTB.
 20798
 20799     IF ERCTBL-FILE-STATUS NOT = '00'
 20800         GO TO 8300-NOTFND.
 20801
 20802     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20803
 20804     GO TO 8300-EXIT.
 20805
 20806 8300-NOTFND.
 20807     IF CTBL-SW = '0530'
 20808         MOVE 'AA'                     TO WS-AH-COMP-CD
 20809         MOVE '0550'                   TO CTBL-SW
 20810         MOVE '1'                      TO WS-CTBL-READ-SW
 20811         GO TO 8300-EXIT.
 20812
 20813     IF CTBL-SW = '0540'
 20814         MOVE 'AA'                     TO WS-LF-COMP-CD
 20815         MOVE '0550'                   TO CTBL-SW
 20816         MOVE '1'                      TO WS-CTBL-READ-SW
 20817         GO TO 8300-EXIT.
 20818
 20819     IF CTBL-SW = '0550'
 20820         MOVE '2'                      TO WS-CTBL-READ-SW
 20821         GO TO 8300-EXIT.
 20822
 20823 8300-EXIT.
 20824      EXIT.
 20825     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 385
* EL517.cbl
 20827
 20828 8400-GETMAIN-ERFORM.
 20829*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 20830     EXIT.
 20831 8400-EXIT.
 20832     EXIT.
 20833
 20834 8450-READ-FORM-MASTER.
 20835
 20836     MOVE ERFORM-KEY             TO FO-CONTROL-PRIMARY
 20837
 20838     START ERFORM KEY NOT LESS THAN FO-CONTROL-PRIMARY.
 20839
 20840     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 20841        GO TO 8450-FORM-NOT-FOUND.
 20842
 20843     READ ERFORM NEXT.
 20844
 20845     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 20846        GO TO 8450-FORM-NOT-FOUND.
 20847
 20848     MOVE 'Y'                    TO FORM-MASTER-SW.
 20849     GO TO 8450-EXIT.
 20850
 20851 8450-FORM-NOT-FOUND.
 20852
 20853     MOVE 'N'                    TO FORM-MASTER-SW.
 20854
 20855 8450-EXIT.
 20856     EXIT.
 20857
 20858 8500-DATE-CONVERT.
 20859     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 20860
 20861 8500-EXIT.
 20862     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 386
* EL517.cbl
 20864
 20865 8555-RELOAD-CONTROL-FILE.
 20866     MOVE HOLD-ELCNTL (ELCNTL-POINTER) TO  CONTROL-FILE.
 20867
 20868 8555-EXIT.
 20869     EXIT.
 20870
 20871 8557-GETMAIN-ERPLAN.
 20872*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 20873     EXIT.
 20874 8557-EXIT.
 20875     EXIT.
 20876
 20877 8560-GETMAIN.
 20878      MOVE 999 TO ERACCT-POINTER.
 20879
 20880 8560-EXIT.
 20881     EXIT.
 20882
 20883 8570-START-ACCOUNT-MASTER.
 20884     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 20885
 20886 8570-EXIT.
 20887     EXIT.
 20888
 20889 8580-READ-ACCOUNT-MASTER.
 20890     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 20891
 20892     IF WS-BROWSE-STARTED-SW = 'Y'
 20893         START ERACCT KEY NOT LESS THAN AM-CONTROL-BY-VAR-GRP.
 20894
 20895     IF ERACCT-FILE-STATUS = '23'
 20896         MOVE HIGH-VALUE TO ERACCT-KEY
 20897         GO TO 8580-EXIT.
 20898
 20899     IF ERACCT-FILE-STAT-1 = '9'
 20900         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20901         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 20902         MOVE RMSG TO WS-ABEND-MESSAGE
 20903         GO TO ABEND-PGM.
 20904
 20905     MOVE SPACE TO WS-BROWSE-STARTED-SW.
 20906
 20907     READ ERACCT NEXT.
 20908     ADD 1 TO RACC.
 20909
*20910     COPY ELCACCTI.
 20911******************************************************************04/14/98
 20912*                                                                *ELCACCTI
 20913*                            ELCACCTI                            *   LV003
 20914*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 20915*                            VMOD=2.001                          *ELCACCTI
 20916*                                                                *ELCACCTI
 20917*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
 20918*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
 20919*                                                                *ELCACCTI
 20920*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
 20921*                                                                *ELCACCTI
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 387
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTI)
 20922******************************************************************ELCACCTI
 20923     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
 20924     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
 20925     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
 20926     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
 20927     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
 20928     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
 20929     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
 20930     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
 20931     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
 20932
 20933     IF ERACCT-FILE-STAT-1 = '9'
 20934         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20935         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 20936         MOVE RMSG TO WS-ABEND-MESSAGE
 20937         GO TO ABEND-PGM.
 20938
 20939     IF ERACCT-FILE-STATUS NOT = '00'
 20940         MOVE HIGH-VALUE TO ERACCT-KEY
 20941         GO TO 8580-EXIT.
 20942
 20943     MOVE AM-CONTROL-BY-VAR-GRP TO ERACCT-KEY.
 20944
 20945 8580-EXIT.
 20946     EXIT.
 20947
 20948 8582-READ-COMPENSATION-MASTER.
 20949     MOVE ERCOMP-KEY TO CO-CONTROL-PRIMARY
 20950
 20951     READ ERCOMP
 20952
 20953     IF ERCOMP-FILE-STATUS NOT = '00'
 20954        GO TO 8582-COMP-NOT-FOUND
 20955     END-IF
 20956
 20957     MOVE 'Y'                    TO COMP-MASTER-SW.
 20958     GO TO 8582-EXIT
 20959     .
 20960 8582-COMP-NOT-FOUND.
 20961
 20962     MOVE 'N'                    TO COMP-MASTER-SW.
 20963
 20964 8582-EXIT.
 20965     EXIT.
 20966
 20967 8583-READ-ERAGTC.
 20968
 20969     MOVE ERAGTC-KEY TO AG-CONTROL-PRIMARY
 20970
 20971     START ERAGTC KEY IS NOT < AG-CONTROL-PRIMARY
 20972
 20973     IF ERAGTC-FILE-STATUS NOT = '00'
 20974        GO TO 8583-AGTC-NOT-FOUND
 20975     END-IF
 20976
 20977     .
 20978 8583-READ-ERAGTC-NEXT.
 20979
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 388
* EL517.cbl
 20980     READ ERAGTC NEXT RECORD
 20981
 20982     IF ERAGTC-FILE-STATUS NOT = '00'
 20983        GO TO 8583-AGTC-NOT-FOUND
 20984     END-IF
 20985
 20986*    MOVE 'Y'                    TO AGTC-MASTER-SW.
 20987     GO TO 8583-EXIT
 20988     .
 20989 8583-AGTC-NOT-FOUND.
 20990
 20991     MOVE 'N'                    TO AGTC-MASTER-SW.
 20992
 20993 8583-EXIT.
 20994     EXIT.
 20995
 20996 8584-READ-BANK-CROSS-REF.
 20997     MOVE ERBXRF-KEY TO BK-CONTROL-PRIMARY
 20998
 20999     READ ERBXRF
 21000
 21001     IF ERBXRF-FILE-STATUS NOT = '00'
 21002        GO TO 8584-BXRF-NOT-FOUND
 21003     END-IF
 21004
 21005     MOVE 'Y'                    TO BXRF-MASTER-SW.
 21006     GO TO 8584-EXIT
 21007     .
 21008 8584-BXRF-NOT-FOUND.
 21009
 21010     MOVE 'N'                    TO BXRF-MASTER-SW.
 21011
 21012 8584-EXIT.
 21013     EXIT.
 21014
 21015 8585-READ-PLAN-MASTER.
 21016
 21017     MOVE ERPLAN-KEY             TO PL-CONTROL-PRIMARY.
 21018
 21019     READ ERPLAN.
 21020
 21021     IF ERPLAN-FILE-STATUS NOT EQUAL '00'
 21022        GO TO 8585-PLAN-NOT-FOUND.
 21023
 21024     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21025     GO TO 8585-EXIT.
 21026
 21027 8585-PLAN-NOT-FOUND.
 21028
 21029     MOVE 'N'                    TO PLAN-MASTER-SW.
 21030
 21031 8585-EXIT.
 21032     EXIT.
 21033
 21034 8586-READ-LOAN-OFFICER.
 21035
 21036     MOVE ERLOFC-KEY             TO LO-CONTROL-PRIMARY
 21037
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 389
* EL517.cbl
 21038     READ ERLOFC
 21039
 21040     IF ERLOFC-FILE-STATUS NOT = '00'
 21041        MOVE 'N'                 TO LOFC-MASTER-SW
 21042     ELSE
 21043        MOVE 'Y'                 TO LOFC-MASTER-SW
 21044     END-IF
 21045
 21046     .
 21047 8586-EXIT.
 21048     EXIT.
 21049
 21050
 21051 8587-START-ERPDEF.
 21052
 21053     MOVE ERPDEF-KEY             TO PD-CONTROL-PRIMARY
 21054
 21055     START ERPDEF KEY >= PD-CONTROL-PRIMARY
 21056     IF ERPDEF-FILE-STATUS NOT = '00'
 21057        MOVE 'N'                 TO PDEF-MASTER-SW
 21058     ELSE
 21059        MOVE 'Y'                 TO PDEF-MASTER-SW
 21060     END-IF
 21061
 21062
 21063     .
 21064 8587-EXIT.
 21065     EXIT.
 21066
 21067 8588-READ-ERPDEF.
 21068
 21069     READ ERPDEF NEXT RECORD
 21070
 21071     IF ERPDEF-FILE-STATUS NOT = '00'
 21072        MOVE 'N'                 TO PDEF-MASTER-SW
 21073     ELSE
 21074        MOVE 'Y'                 TO PDEF-MASTER-SW
 21075     END-IF
 21076
 21077     .
 21078 8588-EXIT.
 21079     EXIT.
 21080
 21081 8589-ENDBR-ERPDEF.
 21082
 21083     .
 21084 8589-EXIT.
 21085     EXIT.
 21086
 21087 8590-READ-CERT-MASTER.
 21088     MOVE ELCERT-KEY TO CM-CONTROL-PRIMARY.
 21089     READ ELCERT.
 21090     ADD 1 TO RCER.
 21091
 21092     IF ELCERT-FILE-STATUS NOT = '00'
 21093         NEXT SENTENCE
 21094     ELSE
 21095         GO TO 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 390
* EL517.cbl
 21096
 21097     MOVE '1'                     TO CERT-STATUS-SW.
 21098
 21099     IF PB-COMPANY-ID = 'UCL'
 21100         IF WS-ERROR = ER-2799
 21101             GO TO 8590-EXIT.
 21102
 21103     IF PB-CANCELLATION
 21104        MOVE ER-2726              TO  WS-ERROR
 21105        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 21106        IF ACCOUNT-MAST-FOUND
 21107           MOVE AM-EXPIRATION-DT  TO  PB-ACCT-EXP-DT
 21108           MOVE AM-EFFECTIVE-DT   TO  PB-ACCT-EFF-DT
 21109           GO TO 8590-EXIT
 21110        ELSE
 21111           GO TO 8590-EXIT.
 21112
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 391
* EL517.cbl
 21114
 21115 8590-EXIT.
 21116     EXIT.
 21117
 21118 8750-START-ELSTAT.
 21119
 21120     MOVE ELSTAT-KEY             TO SF-CONTROL-PRIMARY
 21121
 21122     START ELSTAT KEY >= SF-CONTROL-PRIMARY
 21123     IF ELSTAT-FILE-STATUS NOT = '00'
 21124        MOVE 'N'                 TO STAT-MASTER-SW
 21125     ELSE
 21126        MOVE 'Y'                 TO STAT-MASTER-SW
 21127     END-IF
 21128
 21129     .
 21130 8750-EXIT.
 21131     EXIT.
 21132
 21133 8752-READ-ELSTAT.
 21134
 21135     READ ELSTAT NEXT RECORD
 21136
 21137     IF ELSTAT-FILE-STATUS NOT = '00'
 21138        MOVE 'N'                 TO STAT-MASTER-SW
 21139     ELSE
 21140        MOVE 'Y'                 TO STAT-MASTER-SW
 21141     END-IF
 21142
 21143     .
 21144 8752-EXIT.
 21145     EXIT.
 21146
 21147 8800-GET-COMP-RATE.
 21148     MOVE +1 TO IB.
 21149     IF WS-COMM-CK-AMT > CT-TBF (1)
 21150         ADD +9 TO IB
 21151         IF WS-COMM-CK-AMT > CT-TBF (2)
 21152             ADD +9 TO IB
 21153             IF WS-COMM-CK-AMT > CT-TBF (3)
 21154                MOVE ZEROS       TO WS-WK-RATE
 21155                GO TO 8800-EXIT.
 21156
 21157     IF PB-I-AGE > CT-AGE (1)
 21158         ADD +3 TO IB
 21159         IF PB-I-AGE > CT-AGE (2)
 21160             ADD +3 TO IB
 21161             IF PB-I-AGE > CT-AGE (3)
 21162                MOVE ZEROS       TO WS-WK-RATE
 21163                GO TO 8800-EXIT.
 21164
 21165     IF WS-WORK-TERM > CT-TRM (1)
 21166         ADD +1 TO IB
 21167         IF WS-WORK-TERM > CT-TRM (2)
 21168             ADD +1 TO IB
 21169             IF WS-WORK-TERM > CT-TRM (3)
 21170                MOVE ZEROS       TO WS-WK-RATE
 21171                GO TO 8800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 392
* EL517.cbl
 21172
 21173     IF CT-RT (IB) NOT NUMERIC
 21174         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21175         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21176         GO TO 8800-GET-COMP-RATE.
 21177
 21178     MOVE CT-RT (IB) TO WS-WK-RATE.
 21179
 21180 8800-EXIT.
 21181     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 393
* EL517.cbl
 21183
 21184 8900-ADDRESS-FILE.
 21185     EXIT.
 21186 8900-ADDRESS-EXIT.
 21187     EXIT.
 21188
 21189 9000-READ-CONTROL.
 21190     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21191     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21192
 21193     IF ELCNTL-FILE-STATUS NOT = '00'
 21194         GO TO 9000-NOTFND.
 21195
 21196     READ ELCNTL NEXT.
 21197     ADD 1 TO RCNT.
 21198
 21199     IF ELCNTL-FILE-STATUS NOT = '00'
 21200         GO TO 9000-NOTFND.
 21201
 21202     IF CNTL-REC-TYPE = '1'
 21203         MOVE CONTROL-FILE TO HOLD-ELCNTL (1)
 21204         MOVE 1            TO ELCNTL-POINTER.
 21205
 21206     IF CNTL-REC-TYPE = '6'
 21207         MOVE CONTROL-FILE TO HOLD-ELCNTL (6)
 21208         MOVE 6            TO ELCNTL-POINTER.
 21209
 21210     GO TO 9000-EXIT.
 21211
 21212 9000-NOTFND.
 21213     IF RC-SW-1 = '1'
 21214         MOVE ER-2616             TO WS-ERROR
 21215         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21216         GO TO 9000-EXIT.
 21217
 21218     IF RC-SW-1 = '2'
 21219         MOVE ER-2602             TO WS-ERROR
 21220         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21221         GO TO 9000-EXIT.
 21222
 21223     GO TO 9000-EXIT.
 21224
 21225 9000-EXIT.
 21226     EXIT.
 21227      EXIT.
 21228
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 394
* EL517.cbl
 21230 9100-READ-CONTROL.
 21231     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21232     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21233
 21234     IF ELCNTL-FILE-STATUS NOT = '00'
 21235         GO TO 9100-NOTFND.
 21236
 21237     READ ELCNTL NEXT.
 21238     ADD 1 TO RCNT.
 21239
 21240     IF ELCNTL-FILE-STATUS NOT = '00'
 21241         GO TO 9100-NOTFND.
 21242
 21243     IF CNTL-REC-TYPE = '3'
 21244         MOVE CONTROL-FILE TO HOLD-ELCNTL (3)
 21245         MOVE 3            TO ELCNTL-POINTER
 21246         GO TO 9100-EXIT.
 21247
 21248     IF CNTL-REC-TYPE = '4'
 21249         MOVE CONTROL-FILE TO HOLD-ELCNTL (4)
 21250         MOVE 4            TO ELCNTL-POINTER
 21251         GO TO 9100-EXIT.
 21252
 21253     IF CNTL-REC-TYPE = '5'
 21254         MOVE CONTROL-FILE TO HOLD-ELCNTL (5)
 21255         MOVE 5            TO ELCNTL-POINTER
 21256         GO TO 9100-EXIT.
 21257
 21258     IF CNTL-REC-TYPE = 'L'
 21259         MOVE CONTROL-FILE TO HOLD-ELCNTL (10)
 21260         MOVE 10           TO ELCNTL-POINTER
 21261         GO TO 9100-EXIT.
 21262
 21263     IF CNTL-REC-TYPE = 'A'
 21264         MOVE CONTROL-FILE TO HOLD-ELCNTL (11)
 21265         MOVE 11           TO ELCNTL-POINTER
 21266         GO TO 9100-EXIT.
 21267
 21268 9100-NOTFND.
 21269     DISPLAY 'CTL FILE NOT FOUND ' RC-SW-2 ' KEY='  ELCNTL-KEY.
 21270
 21271     IF RC-SW-2 = '1'
 21272        MOVE '1'                 TO LF-BENEFIT-ERROR
 21273        MOVE ER-2604             TO WS-ERROR
 21274        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21275        GO TO 9100-EXIT.
 21276
 21277     IF RC-SW-2 = '2'
 21278        MOVE '1'                 TO AH-BENEFIT-ERROR
 21279        MOVE ER-2605             TO WS-ERROR
 21280        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21281        GO TO 9100-EXIT.
 21282
 21283     IF RC-SW-2 = '3'
 21284        MOVE ER-2603             TO WS-ERROR
 21285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21286        GO TO 9100-EXIT.
 21287
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 395
* EL517.cbl
 21288     IF RC-SW-2 = '4'
 21289         MOVE PB-I-LF-INPUT-CD   TO PB-I-LF-BENEFIT-CD
 21290         GO TO 9100-EXIT.
 21291
 21292     IF RC-SW-2 = '5'
 21293         MOVE PB-I-AH-INPUT-CD   TO WS-AH-INPUT-CD
 21294         IF WS-AH-INPUT-CD-1 = SPACE
 21295             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21296         ELSE
 21297             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21298
 21299 9100-EXIT.
 21300     EXIT.
 21301      EXIT.
 21302
 21303 9200-CONTROL-GETMAIN.
 21304*    ESTABLISH LINKAGE AREA FOR CONTROL FILE.
 21305     EXIT.
 21306 9200-EXIT.
 21307     EXIT.
 21308
 21309 9250-UNLOCK-RETURN.
 21310*  DUMMIED IN THE BATCH EL517 ....
 21311     EXIT.
 21312 9250-UNLOCK-EXIT.
 21313     EXIT.
 21314      EXIT.
 21315
 21316 9300-ACCUM-BATCH-TOTALS.
 21317         IF PB-ISSUE
 21318             ADD PB-I-LF-PREM-CALC       TO WS-LF-ISS-COMPUTED
 21319             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21320             ADD PB-I-LF-PREMIUM-AMT     TO WS-LF-ISS-ENTERED
 21321             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21322             ADD PB-I-AH-PREM-CALC       TO WS-AH-ISS-COMPUTED
 21323             ADD PB-I-AH-PREMIUM-AMT     TO WS-AH-ISS-ENTERED
 21324             ADD 1                       TO WS-ISSUE-CNT
 21325         ELSE
 21326             ADD PB-C-LF-REF-CALC        TO WS-LF-CAN-COMPUTED
 21327             ADD PB-C-LF-CANCEL-AMT      TO WS-LF-CAN-ENTERED
 21328             ADD PB-C-AH-REF-CALC        TO WS-AH-CAN-COMPUTED
 21329             ADD PB-C-AH-CANCEL-AMT      TO WS-AH-CAN-ENTERED
 21330             ADD 1                       TO WS-CANCEL-CNT.
 21331
 21332 9400-EXIT.
 21333     EXIT.
 21334
 21335 9990-RETURN.
 21336*    END BROUSE OF ACCOUNT FILE
 21337     EXIT.
 21338
 21339 9990-EXIT.
 21340     EXIT.
 21341
 21342
 21343****Check for CRTO record, add one if not found.
 21344 9991-CHECK-FOR-ELCRTO.
 21345     IF ELCRTO-OPEN = ' '
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 396
* EL517.cbl
 21346         OPEN I-O ELCRTO
 21347         MOVE 'X' TO ELCRTO-OPEN
 21348         IF ELCRTO-FILE-STATUS   = '00' OR '97'
 21349             NEXT SENTENCE
 21350         ELSE
 21351             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21352             MOVE 'ELCRTO'           TO WS-FEM-FILE-NAME
 21353             MOVE EMSG               TO WS-ABEND-MESSAGE
 21354             GO TO ABEND-PGM
 21355         END-IF
 21356     END-IF.
 21357     IF ELCRTT-OPEN = ' '
 21358         OPEN I-O ELCRTT
 21359         MOVE 'X' TO ELCRTT-OPEN
 21360         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 21361             NEXT SENTENCE
 21362         ELSE
 21363             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21364             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 21365             MOVE EMSG               TO WS-ABEND-MESSAGE
 21366             GO TO ABEND-PGM
 21367         END-IF
 21368     END-IF.
 21369     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21370     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21371     MOVE +0                     TO ELCRTO-SEQ-NO
 21372     MOVE ELCRTO-KEY             TO OC-CONTROL-PRIMARY
 21373
 21374     START ELCRTO KEY NOT LESS THAN OC-CONTROL-PRIMARY.
 21375
 21376     IF ELCRTO-FILE-STATUS NOT = '00'
 21377         GO TO 9991-CRTO-NOT-FOUND
 21378     END-IF.
 21379
 21380     READ ELCRTO NEXT.
 21381     IF ELCRTO-FILE-STATUS = '00'
 21382        AND (OC-CONTROL-PRIMARY (1:33) =
 21383                 PB-CONTROL-BY-ACCOUNT (1:33))
 21384        AND (OC-RECORD-TYPE = 'I')
 21385           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21386               GO TO 9991-CHECK-INDICATORS
 21387           ELSE
 21388               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21389               GO TO 9991-CRTO-ADD-REC
 21390           END-IF
 21391     END-IF.
 21392
 21393 9991-CRTO-NOT-FOUND.
 21394
 21395     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21396     MOVE 'OC'                TO OC-RECORD-ID
 21397     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21398                              TO OC-CONTROL-PRIMARY (1:33)
 21399     MOVE +4096               TO OC-KEY-SEQ-NO.
 21400
 21401 9991-CRTO-ADD-REC.
 21402
 21403     MOVE 'E517'              TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 397
* EL517.cbl
 21404     MOVE '120000'            TO OC-LAST-MAINT-HHMMSS
 21405     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21406     MOVE 'I'                 TO OC-RECORD-TYPE
 21407     IF PB-ISSUE
 21408         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21409         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21410         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21411         MOVE PB-I-AGE               TO OC-INS-AGE
 21412         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21413         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21414         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21415         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21416         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21417         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21418         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21419         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21420         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21421         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21422         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21423         IF PB-I-JOINT-COMMISSION > +0
 21424             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21425         ELSE
 21426             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21427         END-IF
 21428         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21429         MOVE +0                     TO OC-LF-CANCEL-AMT
 21430                                        OC-LF-ITD-CANCEL-AMT
 21431         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21432         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21433         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21434         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21435         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21436         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21437         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21438         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21439         MOVE +0                     TO OC-AH-CANCEL-AMT
 21440                                        OC-AH-ITD-CANCEL-AMT
 21441         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21442         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21443         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21444     ELSE
 21445         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21446         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21447         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21448         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21449         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21450         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21451         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21452         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21453         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21454          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21455             MOVE SPACES             TO OC-LF-BENCD
 21456             MOVE ZEROS              TO OC-LF-TERM
 21457                                        OC-LF-BEN-AMT
 21458                                        OC-LF-PRM-AMT
 21459                                        OC-LF-ALT-BEN-AMT
 21460                                        OC-LF-ALT-PRM-AMT
 21461                                        OC-LF-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 398
* EL517.cbl
 21462                                        OC-LF-CANCEL-AMT
 21463             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21464             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21465         ELSE
 21466             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21467             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21468             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21469             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21470             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21471             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21472             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21473             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21474             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21475             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21476         END-IF
 21477         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21478         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21479          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21480             MOVE SPACES             TO OC-AH-BENCD
 21481             MOVE ZEROS              TO OC-AH-TERM
 21482                                        OC-AH-BEN-AMT
 21483                                        OC-AH-PRM-AMT
 21484                                        OC-AH-COMM-PCT
 21485                                        OC-AH-CANCEL-AMT
 21486                                        OC-AH-CP
 21487             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21488             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21489         ELSE
 21490             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21491             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21492             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21493             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21494             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21495             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21496             MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 21497             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21498             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21499         END-IF
 21500         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21501         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21502         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21503         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21504     END-IF
 21505     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21506
 21507     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21508     IF ERMAIL-FOUND = ' '
 21509         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21510     END-IF.
 21511
 21512     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21513     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21514     MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY.
 21515
 21516     READ ELCRTT
 21517
 21518     IF ELCRTT-FILE-STATUS  = '00'
 21519         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 399
* EL517.cbl
 21520         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21521     END-IF.
 21522
 21523     WRITE ORIGINAL-CERTIFICATE.
 21524
 21525     GO TO 9991-EXIT.
 21526
 21527 9991-CHECK-INDICATORS.
 21528
 21529     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21530         GO TO 9991-EXIT
 21531     END-IF.
 21532
 21533     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21534         GO TO 9991-EXIT
 21535     END-IF.
 21536
 21537     IF PB-ISSUE
 21538        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21539        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21540        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21541        MOVE PB-I-AGE               TO OC-INS-AGE
 21542        MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21543        MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21544        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21545        MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21546        MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21547        MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21548        MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21549        MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21550        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21551        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21552        MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21553        IF PB-I-JOINT-COMMISSION > +0
 21554            MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21555        ELSE
 21556            MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21557        END-IF
 21558        MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21559        MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21560        MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21561        MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21562        MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21563        MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21564        MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21565        MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21566        MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21567
 21568        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21569        IF ERMAIL-FOUND = ' '
 21570           MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21571        END-IF
 21572
 21573        MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21574        MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21575        MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY
 21576        READ ELCRTT
 21577        IF ELCRTT-FILE-STATUS  = '00'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 400
* EL517.cbl
 21578           MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21579           MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21580        END-IF
 21581
 21582     ELSE
 21583        IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21584           MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21585           MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21586           MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21587        END-IF
 21588        IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21589           MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21590           MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21591           MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21592        END-IF
 21593        MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21594     END-IF
 21595
 21596     REWRITE ORIGINAL-CERTIFICATE.
 21597
 21598 9991-EXIT.
 21599     EXIT.
 21600
 21601
 21602 9999-SET-PNDB-ERROR-FLAGS.
 21603
 21604     IF PB-BATCH-TRAILER
 21605        GO TO 9999-REWRITE-RECORD.
 21606
 21607     IF PB-COMMON-ERRORS = LOW-VALUES
 21608        GO TO 9999-SET-ERROR-FLAGS.
 21609
 21610 9999-FORMAT-ERRORS.
 21611
 21612     MOVE +0                     TO SUB1.
 21613
 21614 9999-ERROR-LOOP.
 21615
 21616     ADD +1                      TO SUB1.
 21617
 21618     IF SUB1 GREATER THAN PB-NO-OF-ERRORS
 21619        GO TO 9999-SET-ERROR-FLAGS.
 21620
 21621     MOVE PB-COMMON-ERROR (SUB1) TO EM-MESSAGE-NUMBER.
 21622
 21623     READ ELCERR.
 21624
 21625     IF ELCERR-FILE-STATUS NOT = '00'
 21626        ADD +1                       TO EMI-FATAL-CTR
 21627        GO TO  9999-ERROR-LOOP.
 21628
*21629                                 COPY ELCERRPD.
 21630******************************************************************04/15/98
 21631*                                                                *ELCERRPD
 21632*                                                                *ELCERRPD
 21633*                            ELCERRPD                            *   LV002
 21634*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 21635*                            VMOD=2.005                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 401
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21636*                                                                *ELCERRPD
 21637*    CLIENT CODED ERROR MESSAGES                                 *ELCERRPD
 21638*                                                                *ELCERRPD
 21639******************************************************************ELCERRPD
 21640                                                                  ELCERRPD
 21641     IF EM-MESSAGE-NUMBER NOT NUMERIC                             ELCERRPD
 21642         MOVE ZEROS TO EM-MESSAGE-NUMBER.                         ELCERRPD
 21643                                                                  ELCERRPD
 21644     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK                ELCERRPD
 21645                         OR CLIENT-CIG OR CLIENT-CUK              ELCERRPD
 21646        IF EM-MESSAGE-NUMBER EQUAL 0541                           ELCERRPD
 21647            MOVE 'X' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21648                                                                  ELCERRPD
 21649     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21650        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909                     ELCERRPD
 21651            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21652                                                                  ELCERRPD
 21653     IF E-CLIENT-ID EQUAL CLIENT-LAP                              ELCERRPD
 21654        IF EM-MESSAGE-NUMBER EQUAL 2656                           ELCERRPD
 21655            MOVE 'F' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21656                                                                  ELCERRPD
 21657     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB                        ELCERRPD
 21658        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671                     ELCERRPD
 21659            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21660                                                                  ELCERRPD
 21661     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC          ELCERRPD
 21662        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672                     ELCERRPD
 21663            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21664                                                                  ELCERRPD
 21665     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21666        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693                     ELCERRPD
 21667            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21668                                                                  ELCERRPD
 21669     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS                        ELCERRPD
 21670        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696                     ELCERRPD
 21671            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21672                                                                  ELCERRPD
 21673     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21674        IF EM-MESSAGE-NUMBER EQUAL 2738                           ELCERRPD
 21675            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21676                                                                  ELCERRPD
 21677     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21678        IF EM-MESSAGE-NUMBER EQUAL 2739                           ELCERRPD
 21679            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21680                                                                  ELCERRPD
 21681     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21682        IF EM-MESSAGE-NUMBER EQUAL 2741                           ELCERRPD
 21683            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21684                                                                  ELCERRPD
 21685     IF  E-CLIENT-ID EQUAL CLIENT-HAN                             ELCERRPD
 21686             OR                                                   ELCERRPD
 21687         E-CLIENT-ID EQUAL CLIENT-JHL                             ELCERRPD
 21688                                                                  ELCERRPD
 21689         IF  EM-MESSAGE-NUMBER EQUAL 2756                         ELCERRPD
 21690             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21691                                                                  ELCERRPD
 21692     IF E-CLIENT-ID = CLIENT-NCX                                  ELCERRPD
 21693         IF EM-MESSAGE-NUMBER = 9895                              ELCERRPD
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 402
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21694             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21695
 21696     IF E-CLIENT-ID = CLIENT-DCC
 21697        IF EM-MESSAGE-NUMBER = 2719
 21698           MOVE 'W'              TO EM-ERROR-SEVERITY
 21699        END-IF
 21700     END-IF
 21701
 21702     .
 21703
 21704     IF EM-ERROR-SEVERITY = 'W'
 21705        ADD +1                   TO EMI-WARNING-CTR
 21706        GO TO  9999-ERROR-LOOP.
 21707
 21708     IF EM-ERROR-SEVERITY = 'F'
 21709        ADD +1                   TO EMI-FORCABLE-CTR
 21710        GO TO  9999-ERROR-LOOP.
 21711
 21712     IF EM-ERROR-SEVERITY = 'X'
 21713        ADD +1                   TO EMI-FATAL-CTR.
 21714
 21715     GO TO 9999-ERROR-LOOP.
 21716
 21717 9999-SET-ERROR-FLAGS.
 21718
 21719     IF EMI-FATAL-CTR NOT = ZEROS
 21720        MOVE 'X'                 TO PB-FATAL-FLAG
 21721        GO TO 9999-CONT-SET-ERROR-FLAGS.
 21722
 21723     IF EMI-FORCABLE-CTR NOT = ZEROS
 21724        IF PB-ISSUE
 21725           IF PB-ISSUE-FORCE
 21726              MOVE 'F'           TO PB-FORCE-ER-CD
 21727             ELSE
 21728              MOVE 'X'           TO PB-FORCE-ER-CD
 21729          ELSE
 21730           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 21731              MOVE 'F'           TO PB-FORCE-ER-CD
 21732             ELSE
 21733              MOVE 'X'           TO PB-FORCE-ER-CD.
 21734
 21735 9999-CONT-SET-ERROR-FLAGS.
 21736
 21737     IF EMI-WARNING-CTR NOT = ZEROS
 21738        MOVE 'W'                 TO PB-WARN-ER-CD.
 21739
 21740     IF PB-UNFORCED-ERRORS OR
 21741        PB-FATAL-ERRORS    OR
 21742        PB-RECORD-ON-HOLD  OR
 21743        PB-RECORD-RETURNED
 21744*        OR
 21745*       PB-CANCELLATION
 21746          NEXT SENTENCE
 21747        ELSE
 21748          GO TO 9999-REWRITE-RECORD.
 21749
 21750     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 21751     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 403
* EL517.cbl
 21752     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
 21753     MOVE PB-SV-STATE            TO CERT-STATE.
 21754
 21755     READ ELCERT.
 21756
 21757     IF PB-ISSUE
 21758     IF CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE
 21759        GO TO 9999-REWRITE-CERT-MASTER.
 21760
 21761     IF PB-ISSUE
 21762        IF PB-RECORD-RETURNED
 21763            MOVE '4'             TO CM-CREDIT-INTERFACE-SW-1
 21764        ELSE
 21765             MOVE '2'            TO CM-CREDIT-INTERFACE-SW-1.
 21766
 21767     IF PB-CANCELLATION
 21768        IF PB-RECORD-RETURNED
 21769            MOVE '7'             TO CM-CREDIT-INTERFACE-SW-2
 21770        ELSE
 21771            IF PB-C-LF-CANCEL-VOIDED OR PB-C-AH-CANCEL-VOIDED
 21772               MOVE '6'          TO CM-CREDIT-INTERFACE-SW-2
 21773            ELSE
 21774               MOVE '4'          TO CM-CREDIT-INTERFACE-SW-2.
 21775
 21776 9999-REWRITE-CERT-MASTER.
 21777
 21778     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 21779        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 21780        GO TO 9999-REWRITE-RECORD.
 21781
 21782     REWRITE CERTIFICATE-MASTER.
 21783     ADD 1 TO WCER.
 21784
 21785 9999-REWRITE-RECORD.
 21786     IF NOT PB-BATCH-TRAILER
 21787         IF PB-ISSUE
 21788             ADD PB-I-LF-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21789             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21790             ADD PB-I-LF-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21791             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21792             ADD PB-I-AH-PREM-CALC   TO WS-AH-ISS-COMPUTED
 21793             ADD PB-I-AH-PREMIUM-AMT TO WS-AH-ISS-ENTERED
 21794             ADD 1                   TO WS-ISSUE-CNT
 21795         ELSE
 21796             ADD PB-C-LF-REF-CALC    TO WS-LF-CAN-COMPUTED
 21797             ADD PB-C-LF-CANCEL-AMT  TO WS-LF-CAN-ENTERED
 21798             ADD PB-C-AH-REF-CALC    TO WS-AH-CAN-COMPUTED
 21799             ADD PB-C-AH-CANCEL-AMT  TO WS-AH-CAN-ENTERED
 21800             ADD 1                   TO WS-CANCEL-CNT
 21801     ELSE
 21802         MOVE WS-LF-ISS-COMPUTED     TO PB-B-LF-ISS-PRM-COMPUTED
 21803         MOVE WS-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED
 21804         MOVE WS-AH-ISS-COMPUTED     TO PB-B-AH-ISS-PRM-COMPUTED
 21805         MOVE WS-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED
 21806         MOVE WS-LF-CAN-COMPUTED     TO PB-B-LF-CAN-PRM-COMPUTED
 21807         MOVE WS-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED
 21808         MOVE WS-AH-CAN-COMPUTED     TO PB-B-AH-CAN-PRM-COMPUTED
 21809         MOVE WS-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 404
* EL517.cbl
 21810         MOVE WS-ISSUE-CNT           TO PB-B-ISSUE-CNT-ENTERED
 21811         MOVE WS-CANCEL-CNT          TO PB-B-CANCEL-CNT-ENTERED
 21812         MOVE ZEROS                  TO WS-LF-ISS-COMPUTED
 21813                                        WS-LF-ISS-ENTERED
 21814                                        WS-AH-ISS-COMPUTED
 21815                                        WS-AH-ISS-ENTERED
 21816                                        WS-LF-CAN-COMPUTED
 21817                                        WS-LF-CAN-ENTERED
 21818                                        WS-AH-CAN-COMPUTED
 21819                                        WS-AH-CAN-ENTERED
 21820                                        WS-ISSUE-CNT
 21821                                        WS-CANCEL-CNT
 21822         MOVE SPACE                  TO PB-FATAL-FLAG.
 21823
 21824     IF PB-BATCH-TRAILER
 21825         IF PB-B-LF-ISS-PRM-REMITTED =
 21826            PB-B-LF-ISS-PRM-ENTERED   AND
 21827            PB-B-LF-CAN-PRM-REMITTED =
 21828            PB-B-LF-CAN-PRM-ENTERED   AND
 21829            PB-B-AH-ISS-PRM-REMITTED =
 21830            PB-B-AH-ISS-PRM-ENTERED   AND
 21831            PB-B-AH-CAN-PRM-REMITTED =
 21832            PB-B-AH-CAN-PRM-ENTERED   AND
 21833            PB-B-ISSUE-CNT-REMITTED  =
 21834            PB-B-ISSUE-CNT-ENTERED    AND
 21835            PB-B-CANCEL-CNT-REMITTED =
 21836            PB-B-CANCEL-CNT-ENTERED
 21837             MOVE SPACE          TO PB-OUT-BAL-CD
 21838           ELSE
 21839             MOVE 'O'            TO PB-OUT-BAL-CD.
 21840
 21841     REWRITE PENDING-BUSINESS.
 21842
 21843     ADD 1 TO WPND.
 21844
 21845     GO TO 0100-READ-PENDING.
 21846
 21847 9999-EXIT.
 21848     EXIT.
 21849
 21850******************************************************************
 21851*                                                                *
 21852*            E R R O R   F O R M A T   R O U T I N E             *
 21853*                                                                *
 21854******************************************************************
 21855
 21856 9900-ERROR-FORMAT.
 21857
 21858     IF WS-ERROR = PB-COMMON-ERROR (1)  OR
 21859                   PB-COMMON-ERROR (2)  OR
 21860                   PB-COMMON-ERROR (3)  OR
 21861                   PB-COMMON-ERROR (4)  OR
 21862                   PB-COMMON-ERROR (5)  OR
 21863                   PB-COMMON-ERROR (6)  OR
 21864                   PB-COMMON-ERROR (7)  OR
 21865                   PB-COMMON-ERROR (8)  OR
 21866                   PB-COMMON-ERROR (9)  OR
 21867                   PB-COMMON-ERROR (10)
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 405
* EL517.cbl
 21868        GO TO 9900-EXIT.
 21869
 21870     IF PB-NO-OF-ERRORS = +10
 21871        GO TO 9900-EXIT.
 21872
 21873     ADD +1                      TO PB-NO-OF-ERRORS.
 21874     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21875                                       (PB-NO-OF-ERRORS).
 21876
 21877
 21878 9900-EXIT.
 21879     EXIT.
 21880
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 406
* EL517.cbl
 21882 9999-DONE.
 21883*START*************CUSTOM CODE FOR CLIENT "DMD"*************
 21884
 21885     IF DTE-CLIENT NOT EQUAL 'DMD'
 21886          GO TO 9999-DONE-CONT.
 21887
 21888     CLOSE ERRESS
 21889           ERRESC.
 21890
 21891     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
 21892     MOVE 'C'                    TO DMPF-PROCESS-TYPE.
 21893     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 21894     IF DMPF-RETURN-CODE EQUAL 'Z3'
 21895         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21896         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
 21897         MOVE CMSG               TO WS-ABEND-MESSAGE
 21898         GO TO ABEND-PGM.
 21899
 21900     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
 21901     MOVE 'C'                    TO DIPF-PROCESS-TYPE.
 21902     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 21903     IF DIPF-RETURN-CODE EQUAL 'Z3'
 21904         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21905         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
 21906         MOVE CMSG               TO WS-ABEND-MESSAGE
 21907         GO TO ABEND-PGM.
 21908
 21909     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
 21910     MOVE 'C'                    TO DVBI-PROCESS-TYPE.
 21911     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 21912     IF DIPF-RETURN-CODE EQUAL 'Z3'
 21913         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21914         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
 21915         MOVE CMSG               TO WS-ABEND-MESSAGE
 21916         GO TO ABEND-PGM.
 21917
 21918     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
 21919     MOVE 'C'                    TO DCUA-PROCESS-TYPE.
 21920     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 21921     IF DCUA-RETURN-CODE EQUAL 'Z3'
 21922         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21923         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
 21924         MOVE CMSG               TO WS-ABEND-MESSAGE
 21925         GO TO ABEND-PGM.
 21926
 21927     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
 21928     MOVE 'C'                    TO DPRB-PROCESS-TYPE.
 21929     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 21930     IF DPRB-RETURN-CODE EQUAL 'Z3'
 21931         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21932         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
 21933         MOVE CMSG               TO WS-ABEND-MESSAGE
 21934         GO TO ABEND-PGM.
 21935
 21936     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
 21937     MOVE 'C'                    TO DVRC-PROCESS-TYPE.
 21938     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 21939     IF DVRC-RETURN-CODE EQUAL 'Z3'
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 407
* EL517.cbl
 21940         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21941         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
 21942         MOVE CMSG               TO WS-ABEND-MESSAGE
 21943         GO TO ABEND-PGM.
 21944
 21945     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
 21946     MOVE 'C'                    TO DVSC-PROCESS-TYPE.
 21947     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 21948     IF DVSC-RETURN-CODE EQUAL 'Z3'
 21949         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 21950         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
 21951         MOVE CMSG               TO WS-ABEND-MESSAGE
 21952         GO TO ABEND-PGM.
 21953
 21954*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 21955
 21956 9999-DONE-CONT.
 21957
 21958     IF ERPNDM-OPEN = 'X'
 21959        CLOSE ERPNDM.
 21960
 21961     IF ERMAIL-OPEN = 'X'
 21962        CLOSE ERMAIL.
 21963
 21964     IF ELMSTR-OPEN = 'X'
 21965        CLOSE ELMSTR.
 21966
 21967     IF ELCRTT-OPEN = 'X'
 21968        CLOSE ELCRTT
 21969     END-IF.
 21970
 21971     IF ELCRTO-OPEN = 'X'
 21972        CLOSE ELCRTO
 21973     END-IF.
 21974
 21975     CLOSE      ELCNTL
 21976                ELCERR
 21977                ERPNDB
 21978                ERREIN
 21979                ELCERT
 21980                ERCTBL
 21981                ERPLAN
 21982                ERACCT
 21983                ERBXRF
 21984                ERAGTC
 21985                ERCOMP.
 21986
 21987     IF DTE-CLIENT = 'DCC'
 21988        CLOSE ERPDEF ELSTAT
 21989        IF ERPDEF-FILE-STATUS NOT = '00'
 21990            MOVE ERPDEF-FILE-STATUS
 21991                                 TO WS-ABEND-FILE-STATUS
 21992            MOVE 'ERPDEF'        TO WS-CEM-FILE-NAME
 21993            MOVE CMSG            TO WS-ABEND-MESSAGE
 21994            GO TO ABEND-PGM
 21995        END-IF
 21996        IF ELSTAT-FILE-STATUS NOT = '00'
 21997            MOVE ELSTAT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 408
* EL517.cbl
 21998                                 TO WS-ABEND-FILE-STATUS
 21999            MOVE 'ELSTAT'        TO WS-CEM-FILE-NAME
 22000            MOVE CMSG            TO WS-ABEND-MESSAGE
 22001            GO TO ABEND-PGM
 22002        END-IF
 22003     END-IF
 22004
 22005     IF ELCNTL-FILE-STATUS NOT = '00'
 22006         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22007         MOVE 'ELCNTL'              TO WS-CEM-FILE-NAME
 22008         MOVE CMSG TO WS-ABEND-MESSAGE
 22009         GO TO ABEND-PGM.
 22010
 22011     IF ERPNDB-FILE-STATUS NOT = '00'
 22012         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22013         MOVE 'ERPNDB'              TO WS-CEM-FILE-NAME
 22014         MOVE CMSG TO WS-ABEND-MESSAGE
 22015         GO TO ABEND-PGM.
 22016
 22017     IF ERREIN-FILE-STATUS NOT = '00'
 22018         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22019         MOVE 'ERREIN'              TO WS-CEM-FILE-NAME
 22020         MOVE CMSG TO WS-ABEND-MESSAGE
 22021         GO TO ABEND-PGM.
 22022
 22023     IF ELCERT-FILE-STATUS NOT = '00'
 22024         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22025         MOVE 'ELCERT'              TO WS-CEM-FILE-NAME
 22026         MOVE CMSG TO WS-ABEND-MESSAGE
 22027         GO TO ABEND-PGM.
 22028
 22029     IF ERMAIL-OPEN   = 'X'
 22030       IF ERMAIL-FILE-STATUS NOT = '00'
 22031           MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22032           MOVE 'ERMAIL'              TO WS-CEM-FILE-NAME
 22033           MOVE CMSG TO WS-ABEND-MESSAGE
 22034           GO TO ABEND-PGM.
 22035
 22036     IF ERPNDM-OPEN   = 'X'
 22037       IF ERPNDM-FILE-STATUS NOT = '00'
 22038            MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22039            MOVE 'ERPNDM'              TO WS-CEM-FILE-NAME
 22040            MOVE CMSG TO WS-ABEND-MESSAGE
 22041            GO TO ABEND-PGM.
 22042
 22043     IF ELCRTT-OPEN = 'X'
 22044         IF ELCRTT-FILE-STATUS NOT = '00'
 22045             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22046             MOVE 'ELCRTT'              TO WS-CEM-FILE-NAME
 22047             MOVE CMSG TO WS-ABEND-MESSAGE
 22048             GO TO ABEND-PGM
 22049         END-IF
 22050     END-IF.
 22051
 22052     IF ELCRTO-OPEN = 'X'
 22053         IF ELCRTO-FILE-STATUS NOT = '00'
 22054             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22055             MOVE 'ELCRTO'              TO WS-CEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 409
* EL517.cbl
 22056             MOVE CMSG TO WS-ABEND-MESSAGE
 22057             GO TO ABEND-PGM
 22058         END-IF
 22059     END-IF.
 22060
 22061     IF ERCTBL-FILE-STATUS NOT = '00'
 22062         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22063         MOVE 'ERCTBL'              TO WS-CEM-FILE-NAME
 22064         MOVE CMSG TO WS-ABEND-MESSAGE
 22065         GO TO ABEND-PGM.
 22066
 22067     IF ERPLAN-FILE-STATUS NOT = '00'
 22068        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
 22069        MOVE 'ERPLAN '           TO WS-CEM-FILE-NAME
 22070        MOVE CMSG TO WS-ABEND-MESSAGE
 22071        GO TO ABEND-PGM.
 22072
 22073     IF ERACCT-FILE-STATUS NOT = '00'
 22074         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22075         MOVE 'ERACCT'              TO WS-CEM-FILE-NAME
 22076         MOVE CMSG TO WS-ABEND-MESSAGE
 22077         GO TO ABEND-PGM.
 22078
 22079     IF ERCOMP-FILE-STATUS NOT = '00'
 22080         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22081         MOVE 'ERCOMP'              TO WS-CEM-FILE-NAME
 22082         MOVE CMSG TO WS-ABEND-MESSAGE
 22083         GO TO ABEND-PGM.
 22084
 22085     IF ERBXRF-FILE-STATUS NOT = '00'
 22086         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22087         MOVE 'ERBXRF'              TO WS-CEM-FILE-NAME
 22088         MOVE CMSG TO WS-ABEND-MESSAGE
 22089         GO TO ABEND-PGM.
 22090
 22091     IF ERAGTC-FILE-STATUS NOT = '00'
 22092         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22093         MOVE 'ERAGTC'              TO WS-CEM-FILE-NAME
 22094         MOVE CMSG TO WS-ABEND-MESSAGE
 22095         GO TO ABEND-PGM.
 22096
 22097     IF ELCERR-FILE-STATUS NOT = '00'
 22098         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22099         MOVE 'ELCERR'              TO WS-CEM-FILE-NAME
 22100         MOVE CMSG TO WS-ABEND-MESSAGE
 22101         GO TO ABEND-PGM.
 22102
 22103     MOVE 'C'                     TO CP-IO-FUNCTION.
 22104     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22105
 22106     IF IO-ERROR
 22107        MOVE SPACE                TO WS-ABEND-FILE-STATUS
 22108        MOVE 'ELRATE'             TO WS-CEM-FILE-NAME
 22109        MOVE CMSG                 TO WS-ABEND-MESSAGE
 22110        GO TO ABEND-PGM.
 22111
 22112     OPEN OUTPUT PRINT-FILE.
 22113
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 410
* EL517.cbl
 22114     MOVE CF-CL-MAIL-TO-NAME     TO H2-COMP.
 22115     MOVE WS-CURRENT-DATE        TO H2-DATE.
 22116     MOVE ALPH-DATE              TO H3-DATE.
 22117     MOVE TRAN-CT                TO SUM-TOT.
 22118
 22119 7000-PRT-HDG.
 22120     MOVE HDG1 TO PRT   MOVE '1' TO X.
 22121     PERFORM 7000-PRINT-LINE.
 22122     MOVE HDG2 TO PRT   MOVE ' ' TO X.
 22123     PERFORM 7000-PRINT-LINE.
 22124     MOVE HDG3 TO PRT   MOVE ' ' TO X.
 22125     PERFORM 7000-PRINT-LINE.
 22126     MOVE SUM1 TO PRT   MOVE '0' TO X.
 22127     PERFORM 7000-PRINT-LINE.
 22128     GO TO 9999-END-JOB.
 22129
 22130 7000-HDG-XIT.
 22131     EXIT.
 22132
 22133 7000-PRINT-LINE.
*22134                     COPY ELCPRT2X.
 22135******************************************************************04/15/98
 22136*                                                                *ELCPRT2X
 22137*                                                                *ELCPRT2X
 22138*                            ELCPRT2X.                           *   LV002
 22139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22140*                            VMOD=2.002                          *   CL**2
 22141*                                                                *ELCPRT2X
 22142*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
 22143*                                                                *ELCPRT2X
 22144*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
 22145*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
 22146*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
 22147*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
 22148*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
 22149*                                                                *ELCPRT2X
 22150*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
 22151*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
 22152******************************************************************ELCPRT2X
 22153                                                                  ELCPRT2X
 22154     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
 22155         FICH-OPEN   = SPACE                                      ELCPRT2X
 22156         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
 22157         OPEN OUTPUT FICH.                                        ELCPRT2X
 22158                                                                  ELCPRT2X
 22159     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22160         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
 22161             OPEN I-O ELREPT                                      ELCPRT2X
 22162             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
 22163                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
 22164                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
 22165                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
 22166                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
 22167                 GO TO ABEND-PGM                                  ELCPRT2X
 22168             ELSE                                                 ELCPRT2X
 22169                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
 22170                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22171                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 411
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22172                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22173                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22174                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22175                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22176                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22177                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
 22178                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22179                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22180                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22181                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22182                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22183                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
 22184                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22185                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
 22186                                                                  ELCPRT2X
 22187     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
 22188        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
 22189         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
 22190         GO TO ABEND-PGM.                                         ELCPRT2X
 22191                                                                  ELCPRT2X
 22192     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22193         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
 22194         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
 22195             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
 22196                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
 22197                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
 22198                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
 22199                     INVALID KEY                                  ELCPRT2X
 22200                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
 22201                         CLOSE ELREPT                             ELCPRT2X
 22202                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
 22203                                                                  ELCPRT2X
 22204     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
 22205         MOVE X                      TO  P-CTL                    ELCPRT2X
 22206         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
 22207                                                                  ELCPRT2X
 22208     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
 22209       MOVE X                        TO  P-CTL                    ELCPRT2X
 22210       IF P-CTL = ' '                                             ELCPRT2X
 22211         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
 22212       ELSE                                                       ELCPRT2X
 22213         IF P-CTL = '0'                                           ELCPRT2X
 22214           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
 22215         ELSE                                                     ELCPRT2X
 22216           IF P-CTL = '-'                                         ELCPRT2X
 22217             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
 22218           ELSE                                                   ELCPRT2X
 22219             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
 22220                                                                  ELCPRT2X
 22221     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
 22222                                                                  ELCPRT2X
 22223 DTE-REPORT-DELETE.                                               ELCPRT2X
 22224     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
 22225         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
 22226         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
 22227                                                                  ELCPRT2X
 22228     READ ELREPT   NEXT RECORD                                    ELCPRT2X
 22229           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 412
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22230                                                                  ELCPRT2X
 22231     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
 22232        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
 22233         DELETE ELREPT RECORD                                     ELCPRT2X
 22234         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
 22235                                                                  ELCPRT2X
 22236 DTE-DELETE-EXIT.                                                 ELCPRT2X
 22237     EXIT.                                                        ELCPRT2X
 22238                                                                  ELCPRT2X
 22239 DTE-PRINT-EXIT.                                                  ELCPRT2X
 22240     EXIT.                                                        ELCPRT2X
 22241******************************************************************ELCPRT2X
 22242
 22243 REIN-DATE-LOAD.
*22244     COPY ELCRENM1.
 22245******************************************************************04/15/98
 22246*                                                                *ELCRENM1
 22247*                                                                *ELCRENM1
 22248*                            ELCRENM1                            *   LV002
 22249*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22250*                            VMOD=2.001                          *ELCRENM1
 22251*                                                                *ELCRENM1
 22252*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRENM1
 22253*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRENM1
 22254*                                                                *ELCRENM1
 22255******************************************************************ELCRENM1
 22256     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.       CL**2
 22257     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.       CL**2
 22258     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.        CL**2
 22259                                                                  ELCRENM1
 22260
 22261 7000-PRINT-LINE-XIT.
 22262      EXIT.
 22263
 22264 9999-END-JOB.
 22265     CLOSE PRINT-FILE.
*22266             COPY ELCPRTCX.
 22267******************************************************************04/15/98
 22268*                                                                *ELCPRTCX
 22269*                                                                *ELCPRTCX
 22270*                            ELCPRTCX.                           *   LV003
 22271*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22272*                            VMOD=2.003                          *   CL**3
 22273*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
 22274*                                                                *ELCPRTCX
 22275* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 22276******************************************************************ELCPRTCX
 22277                                                                  ELCPRTCX
 22278      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
 22279          CLOSE FICH.                                             ELCPRTCX
 22280                                                                  ELCPRTCX
 22281      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
 22282          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
 22283          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
 22284          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
 22285          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
 22286          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
 22287          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 413
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
 22288          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
 22289          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
 22290              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22291              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22292              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22293                  UPON CONSOLE                                    ELCPRTCX
 22294              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22295                  UPON CONSOLE                                    ELCPRTCX
 22296            ELSE                                                  ELCPRTCX
 22297              DISPLAY '***************************************'   ELCPRTCX
 22298              DISPLAY '***************************************'   ELCPRTCX
 22299              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
 22300              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
 22301              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
 22302              DISPLAY '**                                   **'   ELCPRTCX
 22303              DISPLAY '***************************************'   ELCPRTCX
 22304              DISPLAY '***************************************'   ELCPRTCX
 22305              CLOSE ELREPT.                                       ELCPRTCX
 22306                                                                  ELCPRTCX
 22307      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
 22308          DISPLAY '***************************************'       ELCPRTCX
 22309          DISPLAY '***************************************'       ELCPRTCX
 22310          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22311          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
 22312          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
 22313          DISPLAY '**                                   **'       ELCPRTCX
 22314          DISPLAY '***************************************'       ELCPRTCX
 22315          DISPLAY '***************************************'       ELCPRTCX
 22316          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22317                                                                  ELCPRTCX
 22318      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
 22319          DISPLAY '***************************************'       ELCPRTCX
 22320          DISPLAY '***************************************'       ELCPRTCX
 22321          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22322          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
 22323          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
 22324          DISPLAY '**                                   **'       ELCPRTCX
 22325          DISPLAY '***************************************'       ELCPRTCX
 22326          DISPLAY '***************************************'       ELCPRTCX
 22327          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22328                                                                  ELCPRTCX
 22329                                                                  ELCPRTCX
 22330******************************************************************ELCPRTCX
 22331
 22332     GOBACK.
 22333
 22334 ABEND-PGM.
*                   COPY ELCABEND.
 22335***************************************************************** 04/14/98
 22336*                                                               * ELCABEND
 22337*                            ELCABEND.                          *    LV003
 22338*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22339*                            VMOD 2.002                              CL**2
 22340*                                                               * ELCABEND
 22341*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22342*            AND THEN ABENDS.                                   * ELCABEND
 22343*                                                               * ELCABEND
 22344*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 20-Mar-13 08:46 Page 414
* EL517.cbl (/apps/prod/cid1p/copy/ELCABEND)
 22345*                                                               * ELCABEND
 22346***************************************************************** ELCABEND
 22347*APS-010.                                                         ELCABEND
 22348     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22349     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22350                                                                  ELCABEND
 22351     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22352         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22353         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22354                                 UPON CONSOLE.                    ELCABEND
 22355                                                                  ELCABEND
 22356     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22357         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22358         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22359                                 UPON CONSOLE.                    ELCABEND
 22360                                                                  ELCABEND
 22361     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22362     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22363                                 UPON CONSOLE.                    ELCABEND
 22364                                                                  ELCABEND
 22365     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22366     CALL 'ABORTME'.
 22367                                                                  ELCABEND
 22368 APS-EXIT.                                                        ELCABEND
 22369     EXIT.                                                        ELCABEND
 22370
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116640     Code:       91125
