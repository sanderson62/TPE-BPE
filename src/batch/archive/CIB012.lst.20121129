* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* CIB012.cbl
* Options: int("CIB012.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CIB012.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CIB012.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"CIB012.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. CIB012.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 02-Nov-12 23:16.
     6*REMARKS.
     7*        THIS PROGRAM READS THE FICHE FILE OUT OF CIB002 (SYS011)
     8*        AND SEPARATES THE REMIT STATEMENTS FROM ALL THE OTHERS
     9*        AND PLACES COVER SHEET INFO  IN FRONT OF EACH REMIT
    10*        STMT. THE NON REMIT STATEMENTS JUST GET PASSED TO
    11*        THE NEXT STEP IN THE JOB.
    12*        REMIT STMTS ARE DEFINED AS FOLLOWS
    13*            IF (CO-BILL-SW = 'B' OR 'C')
    14*                AND (CO-CURRENT-END-BAL IS POSITIVE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* CIB012.cbl
    16******************************************************************
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 100808  CR2007100800003  PEMA  NEW PROGRAM
    25* 112508  CR2008111000002  PEMA  SEVERAL CHANGES SEE CR
    26* 051810  CR2010042900001  PEMA  SPEARATE CITY AND STATE
    27* 041912  CR2011110200001  PEMA  ADD UNIQUE CHARACTER TO BARCODE
    28* 060812  IR2012050400001  PEMA  CHG BARCD ON COVERSHEET ONLY
    29* 082012  CR2012042700005  PEMA  ADD OVER 120 DAYS TO AGEING
    30******************************************************************
    31 ENVIRONMENT DIVISION.
    32 INPUT-OUTPUT SECTION.
    33 FILE-CONTROL.
    34
    35     SELECT ERCOMP    ASSIGN TO ERCOMP
    36            ORGANIZATION IS INDEXED
    37            ACCESS IS DYNAMIC
    38            RECORD KEY IS CO-CONTROL-PRIMARY
    39            FILE STATUS IS ERCOMP-FILE-STATUS.
    40
    41     SELECT ERACCT    ASSIGN TO ERACCT
    42            ORGANIZATION IS INDEXED
    43            ACCESS IS DYNAMIC
    44            RECORD KEY IS AM-CONTROL-PRIMARY
    45            FILE STATUS IS ERACCT-FILE-STATUS.
    46
    47     SELECT FORMDEFS  ASSIGN TO FORMDEFS
    48            ORGANIZATION IS INDEXED
    49            ACCESS IS DYNAMIC
    50            RECORD KEY IS fd-form-key
    51            FILE STATUS IS FORMDEFS-FILE-STATUS.
    52
    53     SELECT BILLING-STATEMENTS ASSIGN TO SYS010.
    54
    55     SELECT DISK-DATE          ASSIGN TO SYS019.
    56
    57     SELECT OTHER-STATEMENTS   ASSIGN TO SYS011.
    58
    59     SELECT REMIT-STMTS        ASSIGN TO SYS012.
    60
    61     SELECT SCAN-EXT         ASSIGN TO SCANOT
    62                             ORGANIZATION LINE SEQUENTIAL.
    63
    64 DATA DIVISION.
    65
    66 FILE SECTION.
    67
    68 FD  BILLING-STATEMENTS
    69     LABEL RECORDS ARE STANDARD
    70     RECORDING MODE IS F
    71     BLOCK CONTAINS 0 RECORDS.
    72 01  STMT-RECORD                 PIC X(133).
    73
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* CIB012.cbl
    74 FD  ERCOMP.
*   75                                 COPY ERCCOMP.
    76******************************************************************
    77*                                                                *
    78*                                                                *
    79*                            ERCCOMP                             *
    80*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    81*                            VMOD=2.019                          *
    82*                                                                *
    83*   ONLINE CREDIT SYSTEM                                         *
    84*                                                                *
    85*   FILE DESCRIPTION = COMPENSATION MASTER                       *
    86*                                                                *
    87*   FILE TYPE = VSAM,KSDS                                        *
    88*   RECORD SIZE = 700   RECFORM = FIXED                          *
    89*                                                                *
    90*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
    91*       ALTERNATE PATH = NONE                                    *
    92*                                                                *
    93*   LOG = NO                                                     *
    94*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
    95*                                                                *
    96******************************************************************
    97*                   C H A N G E   L O G
    98*
    99* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   100*-----------------------------------------------------------------
   101*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   102* EFFECTIVE    NUMBER
   103*-----------------------------------------------------------------
   104* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   105* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   106* 092205    2005050300006  PEMA  ADD LEASE FEE
   107* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   108* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   109* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   110* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   111* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   112* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
   113******************************************************************
   114
   115 01  COMPENSATION-MASTER.
   116     12  CO-RECORD-ID                          PIC XX.
   117         88  VALID-CO-ID                          VALUE 'CO'.
   118
   119     12  CO-CONTROL-PRIMARY.
   120         16  CO-COMPANY-CD                     PIC X.
   121         16  CO-CONTROL.
   122             20  CO-CTL-1.
   123                 24  CO-CARR-GROUP.
   124                     28  CO-CARRIER            PIC X.
   125                     28  CO-GROUPING.
   126                         32  CO-GROUP-PREFIX   PIC XXX.
   127                         32  CO-GROUP-PRIME    PIC XXX.
   128                 24  CO-RESP-NO.
   129                     28  CO-RESP-PREFIX        PIC X(4).
   130                     28  CO-RESP-PRIME         PIC X(6).
   131             20  CO-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* CIB012.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   132                 24  CO-ACCOUNT.
   133                     28  CO-ACCT-PREFIX        PIC X(4).
   134                     28  CO-ACCT-PRIME         PIC X(6).
   135         16  CO-TYPE                           PIC X.
   136             88  CO-COMPANY-TYPE                  VALUE 'C'.
   137             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   138             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   139
   140     12  CO-MAINT-INFORMATION.
   141         16  CO-LAST-MAINT-DT                  PIC XX.
   142         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   143         16  CO-LAST-MAINT-USER                PIC X(4).
   144     12  FILLER                                PIC XX.
   145     12  CO-STMT-TYPE                          PIC XXX.
   146     12  CO-COMP-TYPE                          PIC X.
   147         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   148     12  CO-STMT-OWNER                         PIC X(4).
   149     12  CO-BALANCE-CONTROL                    PIC X.
   150         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   151         88  CO-NO-BALANCE                        VALUE 'N'.
   152
   153     12  CO-INTERNAL-CONTROL-1                 PIC X.
   154         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   155         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   156         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   157
   158     12  CO-INTERNAL-CONTROL-2                 PIC X.
   159         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   160         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   161
   162     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   163     12  CO-GA-DIRECT-DEP                      PIC X.
   164     12  CO-FUTURE-SPACE                       PIC X.
   165         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   166
   167     12  CO-ACCT-NAME                          PIC X(30).
   168     12  CO-MAIL-NAME                          PIC X(30).
   169     12  CO-ADDR-1                             PIC X(30).
   170     12  CO-ADDR-2                             PIC X(30).
   171     12  CO-ADDR-3.
   172         16  CO-ADDR-CITY                      PIC X(27).
   173         16  CO-ADDR-STATE                     PIC XX.
   174     12  CO-CSO-1099                           PIC X.
   175     12  CO-ZIP.
   176         16  CO-ZIP-PRIME.
   177             20  CO-ZIP-PRI-1ST                PIC X.
   178                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   179             20  FILLER                        PIC X(4).
   180         16  CO-ZIP-PLUS4                      PIC X(4).
   181     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   182         16  CO-CAN-POSTAL-1                   PIC XXX.
   183         16  CO-CAN-POSTAL-2                   PIC XXX.
   184         16  FILLER                            PIC XXX.
   185     12  CO-SOC-SEC                            PIC X(13).
   186     12  CO-TELEPHONE.
   187         16  CO-AREA-CODE                      PIC XXX.
   188         16  CO-PREFIX                         PIC XXX.
   189         16  CO-PHONE                          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* CIB012.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   190
   191     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   192
   193     12  CO-AR-BAL-LEVEL                       PIC X.
   194         88  CO-AR-REF-LVL                        VALUE '1'.
   195         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   196         88  CO-AR-BILL-LVL                       VALUE '2'.
   197         88  CO-AR-AGT-LVL                        VALUE '3'.
   198         88  CO-AR-FR-LVL                         VALUE '4'.
   199
   200     12  CO-AR-NORMAL-PRINT                    PIC X.
   201         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   202         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   203
   204     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   205
   206     12  CO-AR-REPORTING                       PIC X.
   207         88  CO-AR-NET-REPORT                     VALUE 'N'.
   208         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   209
   210     12  CO-AR-PULL-CHECK                      PIC X.
   211         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   212         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   213
   214     12  CO-AR-BALANCE-PRINT                   PIC X.
   215         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   216
   217     12  CO-AR-LAST-RUN-CODE                   PIC X.
   218         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   219         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   220         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   221
   222     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   223
   224     12  CO-USER-CODE                          PIC X.
   225     12  CO-REPORT-GROUP-ID                    PIC X(12).
   226
   227******************************************************************
   228*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   229*    THE LAST MONTH END RUN.
   230******************************************************************
   231
   232     12  CO-LAST-ACTIVITY-DATE.
   233         16  CO-ACT-YEAR                       PIC 99.
   234         16  CO-ACT-MONTH                      PIC 99.
   235         16  CO-ACT-DAY                        PIC 99.
   236
   237     12  CO-LAST-STMT-DT.
   238         16  CO-LAST-STMT-YEAR                 PIC 99.
   239         16  CO-LAST-STMT-MONTH                PIC 99.
   240         16  CO-LAST-STMT-DAY                  PIC 99.
   241
   242     12  CO-MO-END-TOTALS.
   243         16  CO-MONTHLY-TOTALS.
   244             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   245             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   246             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   247             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* CIB012.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   248             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   249
   250         16  CO-AGING-TOTALS.
   251             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   252             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   253             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   254             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   255
   256         16  CO-YTD-TOTALS.
   257             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   258             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   259
   260         16  CO-OVER-UNDER-TOTALS.
   261             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   262             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   263
   264     12  CO-MISCELLANEOUS-TOTALS.
   265         16  CO-FICA-TOTALS.
   266             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   267             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   268
   269         16  CO-CLAIM-TOTALS.
   270             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   271             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   272
   273******************************************************************
   274*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   275*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   276******************************************************************
   277
   278     12  CO-CURRENT-TOTALS.
   279         16  CO-CURRENT-LAST-STMT-DT.
   280             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   281             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   282             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   283
   284         16  CO-CURRENT-MONTHLY-TOTALS.
   285             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   286             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
   287             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   288             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   289             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
   290
   291         16  CO-CURRENT-AGING-TOTALS.
   292             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   293             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   294             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   295             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
   296
   297         16  CO-CURRENT-YTD-TOTALS.
   298             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   299             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   300
   301     12  CO-PAID-COMM-TOTALS.
   302         16  CO-YTD-PAID-COMMS.
   303             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   304             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   305
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* CIB012.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   306     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
   307         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   308         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   309
   310     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   311         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   312         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   313         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   314         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   315         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   316         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   317         88  CO-FINAL-LETTER                  VALUE 'F'.
   318         88  CO-RECONCILING                   VALUE 'R'.
   319         88  CO-PHONE-CALL                    VALUE 'P'.
   320         88  CO-LEGAL                         VALUE 'L'.
   321         88  CO-COLLECTION-AGENCY             VALUE 'C'.
   322         88  CO-WRITE-OFF                     VALUE 'W'.
   323         88  CO-NO-ACTION                     VALUE 'N' ' '.
   324
   325     12  CO-CSR-CODE                       PIC X(4).
   326
   327     12  CO-GA-STATUS-INFO.
   328         16  CO-GA-EFFECTIVE-DT            PIC XX.
   329         16  CO-GA-TERMINATION-DT          PIC XX.
   330         16  CO-GA-STATUS-CODE             PIC X.
   331             88  CO-GA-ACTIVE                 VALUE 'A'.
   332             88  CO-GA-INACTIVE               VALUE 'I'.
   333             88  CO-GA-PENDING                VALUE 'P'.
   334         16  CO-GA-COMMENTS.
   335             20  CO-GA-COMMENT-1           PIC X(40).
   336             20  CO-GA-COMMENT-2           PIC X(40).
   337             20  CO-GA-COMMENT-3           PIC X(40).
   338             20  CO-GA-COMMENT-4           PIC X(40).
   339
   340     12  CO-RPTCD2                         PIC X(10).
   341     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
   342         16  CO-OV120                      PIC S9(7)V99   COMP-3.
   343         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
   344
   345     12  CO-TYPE-AGENT                     PIC X(01).
   346         88  CO-CORPORATION                   VALUE 'C'.
   347         88  CO-PARTNERSHIP                   VALUE 'P'.
   348         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
   349         88  CO-TRUST                         VALUE 'T'.
   350         88  CO-UNKNOWN                       VALUE ' ' 'X'.
   351
   352     12  CO-FAXNO.
   353         16  CO-FAX-AREA-CODE                  PIC XXX.
   354         16  CO-FAX-PREFIX                     PIC XXX.
   355         16  CO-FAX-PHONE                      PIC X(4).
   356
   357     12  CO-BANK-INFORMATION.
   358         16  CO-BANK-TRANSIT-NO                PIC X(8).
   359         16  CO-BANK-TRANSIT-NON REDEFINES
   360             CO-BANK-TRANSIT-NO                PIC 9(8).
   361
   362         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
   363     12  CO-MISC-DEDUCT-INFO REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* CIB012.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   364                  CO-BANK-INFORMATION.
   365         16  CO-MD-GL-ACCT                     PIC X(10).
   366         16  CO-MD-DIV                         PIC XX.
   367         16  CO-MD-CENTER                      PIC X(4).
   368         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
   369         16  CO-CREATE-AP-CHECK                PIC X.
   370         16  CO-DELIVER-CK-TO-MEL              PIC X.
   371         16  FILLER                            PIC XXX.
   372     12  CO-ACH-STATUS                         PIC X.
   373         88  CO-ACH-ACTIVE                         VALUE 'A'.
   374         88  CO-ACH-PENDING                        VALUE 'P'.
   375
   376     12  CO-BILL-SW                            PIC X.
   377     12  CO-CONTROL-NAME                       PIC X(30).
   378     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
   379     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
   380     12  CO-CLP-STATE                          PIC XX.
   381     12  CO-FIRST-WRITTEN-DT                   PIC XX.
   382     12  CO-SPP-REFUND-EDIT                    PIC X.
   383
   384******************************************************************
   385
   386 FD  ERACCT.
*  387                                 COPY ERCACCT.
   388******************************************************************04/19/98
   389*                                                                *ERCACCT
   390*                                                                *ERCACCT
   391*                            ERCACCT                             *   LV031
   392*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   393*                            VMOD=2.031                          *ERCACCT
   394*                                                                *ERCACCT
   395*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   396*                                                                *ERCACCT
   397*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   398*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   399*                                                                *ERCACCT
   400*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   401*                                                                *ERCACCT
   402*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   403*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   404*                                                                *ERCACCT
   405*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   406*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   407*                                                                *ERCACCT
   408*   LOG = NO                                                     *ERCACCT
   409*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   410*                                                                *ERCACCT
   411*                                                                *ERCACCT
   412******************************************************************ERCACCT
   413*                   C H A N G E   L O G
   414*
   415* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   416*-----------------------------------------------------------------
   417*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   418* EFFECTIVE    NUMBER
   419*-----------------------------------------------------------------
   420* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   421* 092705    2005050300006  PEMA  ADD SPP LEASES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* CIB012.cbl (/apps/prod/cid1p/copy/ERCACCT)
   422* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   423* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   424* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   425* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   426* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   427******************************************************************
   428                                                                  ERCACCT
   429 01  ACCOUNT-MASTER.                                              ERCACCT
   430     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   431         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   432                                                                  ERCACCT
   433     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   434         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   435         16  AM-MSTR-CNTRL.                                       ERCACCT
   436             20  AM-CONTROL-A.                                    ERCACCT
   437                 24  AM-CARRIER            PIC X.                 ERCACCT
   438                 24  AM-GROUPING.                                 ERCACCT
   439                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   440                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   441                 24  AM-STATE              PIC XX.                ERCACCT
   442                 24  AM-ACCOUNT.                                  ERCACCT
   443                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   444                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   445             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   446                                           PIC X(19).             ERCACCT
   447             20  AM-CNTRL-B.                                      ERCACCT
   448                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   449                 24  FILLER                PIC X(4).              ERCACCT
   450             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   451                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   452                                                                  ERCACCT
   453     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   454         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   455         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   456         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   457         16  AM-VG-STATE                   PIC XX.                ERCACCT
   458         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   459         16  AM-VG-DATE.                                          ERCACCT
   460             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   461             20  FILLER                    PIC X(4).              ERCACCT
   462         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   463                                           PIC 9(11)      COMP-3. ERCACCT
   464     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   465         16  FILLER                        PIC X(10).
   466         16  AM-VG-KEY3.
   467             20  AM-VG3-ACCOUNT            PIC X(10).
   468             20  AM-VG3-EXP-DT             PIC XX.
   469         16  FILLER                        PIC X(4).
   470     12  AM-MAINT-INFORMATION.                                    ERCACCT
   471         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   472         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   473         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   474         16  FILLER                        PIC XX.                ERCACCT
   475                                                                  ERCACCT
   476     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   477     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   478                                                                  ERCACCT
   479     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* CIB012.cbl (/apps/prod/cid1p/copy/ERCACCT)
   480         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   481         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   482                                                                  ERCACCT
   483     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   484     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   485                                                                  ERCACCT
   486     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   487     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   488                                                                  ERCACCT
   489     12  AM-NAME                           PIC X(30).             ERCACCT
   490     12  AM-PERSON                         PIC X(30).             ERCACCT
   491     12  AM-ADDRS                          PIC X(30).             ERCACCT
   492     12  AM-CITY.
   493         16  AM-ADDR-CITY                  PIC X(28).
   494         16  AM-ADDR-STATE                 PIC XX.
   495     12  AM-ZIP.                                                  ERCACCT
   496         16  AM-ZIP-PRIME.                                        ERCACCT
   497             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   498                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   499             20  FILLER                    PIC X(4).              ERCACCT
   500         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   501     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   502         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   503         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   504         16  FILLER                        PIC XXX.               ERCACCT
   505     12  AM-TEL-NO.                                               ERCACCT
   506         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   507         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   508         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   509     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   510         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   511         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   512                                                                  ERCACCT
   513     12  AM-COMM-STRUCTURE.                                       ERCACCT
   514         16  AM-DEFN-1.                                           ERCACCT
   515             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   516                 24  AM-AGT.                                      ERCACCT
   517                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   518                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   519                 24  AM-COM-TYP            PIC X.                 ERCACCT
   520                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   521                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   522                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   523                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   524                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   525                 24  AM-GL-CODES           PIC X.                 ERCACCT
   526                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   527                 24  FILLER                PIC X(01).             ERCACCT
   528         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   529             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   530                 24  FILLER                PIC X(11).             ERCACCT
   531                 24  AM-L-COMA             PIC XXX.               ERCACCT
   532                 24  AM-J-COMA             PIC XXX.               ERCACCT
   533                 24  AM-A-COMA             PIC XXX.               ERCACCT
   534                 24  FILLER                PIC X(6).              ERCACCT
   535                                                                  ERCACCT
   536     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   537         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* CIB012.cbl (/apps/prod/cid1p/copy/ERCACCT)
   538                                                                  ERCACCT
   539     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   540                                                                  ERCACCT
   541     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   542         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   543         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   544     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   545         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   546         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   547     12  AM-GPCD                           PIC 99.                ERCACCT
   548     12  AM-IG                             PIC X.                 ERCACCT
   549         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   550         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   551     12  AM-STATUS                         PIC X.                 ERCACCT
   552         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   553         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   554         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   555         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   556         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   557         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   558     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   559     12  AM-ID-NO                          PIC X(11).             ERCACCT
   560                                                                  ERCACCT
   561     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   562     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   563     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   564     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   565     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   566     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   567     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   568     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   569     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   570                                                                  ERCACCT
   571     12  AM-USER-FIELDS.                                          ERCACCT
   572         16  AM-FLD-1                      PIC XX.                ERCACCT
   573         16  AM-FLD-2                      PIC XX.                ERCACCT
   574         16  AM-FLD-3                      PIC XX.                ERCACCT
   575         16  AM-FLD-4                      PIC XX.                ERCACCT
   576         16  AM-FLD-5                      PIC XX.                ERCACCT
   577                                                                  ERCACCT
   578     12  AM-1ST-PROD-DATE.                                        ERCACCT
   579         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   580         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   581         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   582     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   583     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   584         16  AM-PUR-YR                     PIC XX.                ERCACCT
   585         16  AM-PUR-MO                     PIC XX.                ERCACCT
   586         16  AM-PUR-DA                     PIC XX.                ERCACCT
   587     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   588     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   589     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   590     12  AM-INACTIVE-DATE.                                        ERCACCT
   591         16  AM-INA-MO                     PIC 99.                ERCACCT
   592         16  AM-INA-DA                     PIC 99.                ERCACCT
   593         16  AM-INA-YR                     PIC 99.                ERCACCT
   594     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   595                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* CIB012.cbl (/apps/prod/cid1p/copy/ERCACCT)
   596     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   597     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   598                                                                  ERCACCT
   599     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   600         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   601         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   602         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   603         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   604                                                                  ERCACCT
   605     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   606         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   607         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   608                                                                  ERCACCT
   609     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   610                                                                  ERCACCT
   611     12  AM-OVER-SHORT.                                           ERCACCT
   612         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   613         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   614                                                                  ERCACCT
   615     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   616     12  AM-DCC-CLP-STATE                  PIC XX.
   617                                                                  ERCACCT
   618     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   619     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   620                                                                  ERCACCT
   621     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   622     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   623     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   624     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   625     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   626     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   627     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   628     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   629     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   630     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   631     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   632     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   633     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   634     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   635     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   636     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   637                                                                  ERCACCT
   638     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   639                                                                  ERCACCT
   640     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   641     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   642                                                                  ERCACCT
   643     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   644     12  AM-EARN-METHODS.                                         ERCACCT
   645         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   646             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   647             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   648             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   649             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   650         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   651             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   652             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   653             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* CIB012.cbl (/apps/prod/cid1p/copy/ERCACCT)
   654             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   655         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   656             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   657             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   658             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   659             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   660             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   661             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   662                                                                  ERCACCT
   663     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   664     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   665     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   666                                                                  ERCACCT
   667     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   668     12  AM-RET-P-E                        PIC X.                 ERCACCT
   669     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   670     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   671     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   672     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   673         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   674         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   675     12  AM-RETRO-EARNINGS.                                       ERCACCT
   676         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   677         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   678         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   679     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   680         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   681         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   682     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   683         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   684         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   685         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   686     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   687     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   688                                                                  ERCACCT
   689     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   690         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   691         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   692         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   693         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   694         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   695                                                                  ERCACCT
   696     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   697                                                                  ERCACCT
   698     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   699                                                                  ERCACCT
   700     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   701         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   702                                                                  ERCACCT
   703     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   704         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   705         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   706                                                                  ERCACCT
   707     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   708         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   709                                                                  ERCACCT
   710     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   711         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* CIB012.cbl (/apps/prod/cid1p/copy/ERCACCT)
   712         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   713                                                                  ERCACCT
   714     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   715                                                                  ERCACCT
   716     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   717     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   718     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   719     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   720     12  AM-DCC-UEF-STATE                  PIC XX.
   721     12  FILLER                            PIC XXX.
   722     12  AM-REPORT-CODE-3                  PIC X(10).
   723*    12  FILLER                            PIC X(22).             ERCACCT
   724                                                                  ERCACCT
   725     12  AM-RESERVE-DATE.                                         ERCACCT
   726         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   727         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   728         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   729                                                                  ERCACCT
   730     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   731     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   732         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   733         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   734         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   735         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   736                                                                  ERCACCT
   737     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   738         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   739         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   740         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   741         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   742                                                                  ERCACCT
   743     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   744         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   745             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   746             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   747             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   748             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   749             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   750             20  FILLER                    PIC XX.                ERCACCT
   751         16  FILLER                        PIC X(80).             ERCACCT
   752                                                                  ERCACCT
   753     12  AM-TRANSFER-DATA.                                        ERCACCT
   754         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   755             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   756             20  AM-TRNFROM-GROUPING.                             ERCACCT
   757                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   758                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   759             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   760             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   761                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   762                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   763             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   764         16  AM-TRANSFERRED-TO.                                   ERCACCT
   765             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   766             20  AM-TRNTO-GROUPING.                               ERCACCT
   767                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   768                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   769             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* CIB012.cbl (/apps/prod/cid1p/copy/ERCACCT)
   770             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   771                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   772                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   773             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   774         16  FILLER                        PIC X(10).             ERCACCT
   775                                                                  ERCACCT
   776     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   777                                                                  ERCACCT
   778     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   779         16  AM-DEFN-1-SAVED.                                     ERCACCT
   780             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   781                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   782                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   783                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   784                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   785                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   786                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   787                 24  FILLER                PIC X.                 ERCACCT
   788                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   789                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   790                 24  FILLER                PIC X.                 ERCACCT
   791         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   792             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   793                 24  FILLER                PIC X(11).             ERCACCT
   794                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   795                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   796                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   797                 24  FILLER                PIC X(6).              ERCACCT
   798                                                                  ERCACCT
   799     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   800         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   801            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   802            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   803            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   804                                                                  ERCACCT
   805     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   806     12  FILLER                            PIC X(120).            ERCACCT
   807                                                                  ERCACCT
   808     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   809         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   810         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   811             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   812             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   813                                                          COMP-3. ERCACCT
   814             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   815                                                          COMP-3. ERCACCT
   816         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   817             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   818             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   819                                                          COMP-3. ERCACCT
   820             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   821                                                          COMP-3. ERCACCT
   822                                                                  ERCACCT
   823     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   824         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   825         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   826         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   827         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* CIB012.cbl (/apps/prod/cid1p/copy/ERCACCT)
   828             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   829                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   830                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   831             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   832                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   833                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   834             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   835                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   836                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   837         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   838             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   839                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   840                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   841                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   842             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   843                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   844                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   845             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   846                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   847                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   848                                                                  ERCACCT
   849     12  AM-COMMENTS.                                             ERCACCT
   850         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   851                                                                  ERCACCT
   852     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   853         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   854         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   855         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   856         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   857         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   858             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   859             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   860             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   861             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   862         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   863             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   864             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   865             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   866         16  FILLER                        PIC X(102).            ERCACCT
   867                                                                  ERCACCT
   868     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   869         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   870             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   871             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   872             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   873             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   874             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   875         16  FILLER                          PIC X(10).           ERCACCT
   876******************************************************************ERCACCT
   877
   878 FD  FORMDEFS.
   879 01  FORM-DEF-IN-REC.
   880     05  fd-form-key.
   881         10  fd-form-name        pic x(10).
   882         10  fd-form-month       pic 99.
   883     05  f                       pic x(888).
   884
   885 FD  DISK-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* CIB012.cbl
*  886                                 COPY ELCDTEFD.
   887******************************************************************04/15/98
   888*                                                                *ELCDTEFD
   889*                                                                *ELCDTEFD
   890*                            ELCDTEFD.                           *   LV002
   891*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   892*                            VMOD=2.007                          *   CL**2
   893*                                                                *ELCDTEFD
   894******************************************************************ELCDTEFD
   895     BLOCK CONTAINS 0 RECORDS
   896     RECORDING MODE F.                                            ELCDTEFD
   897                                                                  ELCDTEFD
   898 01  DATE-DISK.                                                   ELCDTEFD
   899     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   900     12  FILLER                      PIC  X(14).                  ELCDTEFD
   901     12  DD-CR1                      PIC  9.                      ELCDTEFD
   902     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   903     12  DD-CR2                      PIC  9.                      ELCDTEFD
   904     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   905     12  FILLER                      PIC  X(20).                  ELCDTEFD
   906                                                                  ELCDTEFD
   907 01  DATE-DISK-R.                                                 ELCDTEFD
   908     12  FILLER                      PIC  X(4).                   ELCDTEFD
   909     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   910                                     PIC  X(32).                  ELCDTEFD
   911                                                                  ELCDTEFD
   912 01  DATE-DISK-T.                                                 ELCDTEFD
   913     12  FILLER                      PIC  X(4).                   ELCDTEFD
   914     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   915                                     PIC  X(48).                  ELCDTEFD
   916                                                                  ELCDTEFD
   917 01  DATE-DISK-M.                                                 ELCDTEFD
   918     12  FILLER                      PIC  X(4).                   ELCDTEFD
   919     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   920                                     PIC  X(48).                  ELCDTEFD
   921                                                                  ELCDTEFD
   922 01  DATE-DISK-P.                                                 ELCDTEFD
   923     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   924     12  DD-IDX                      PIC  99.                     ELCDTEFD
   925     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   926     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   927         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   928                                     PIC  X.                      ELCDTEFD
   929         16  FILLER                  PIC  X(46).                  ELCDTEFD
   930     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   931         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   932             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   933             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   934             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   935             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   936         16  FILLER                  PIC  X(16).                  ELCDTEFD
   937                                                                  ELCDTEFD
   938 01  DATE-DISK-E.                                                 ELCDTEFD
   939     12  FILLER                      PIC  X(4).                   ELCDTEFD
   940     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   941                                     PIC  X(4).                   ELCDTEFD
   942                                                                  ELCDTEFD
   943 01  DATE-DISK-C.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   944     12  FILLER                      PIC  X(7).                   ELCDTEFD
   945     12  DD-CARR1-SECPAY-SW          PIC  X.
   946     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   947     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   948     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   949     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   950     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   951     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   952     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   953     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   954     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   955     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   956     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   957     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   958     12  DD-CARR2-SECPAY-SW          PIC  X.
   959     12  FILLER                      PIC  X(7).                   ELCDTEFD
   960                                                                  ELCDTEFD
   961 01  DATE-DISK-OPT.                                               ELCDTEFD
   962     12  FILLER                      PIC  X(04).                  ELCDTEFD
   963     12  DD-TLR-DATA.                                             ELCDTEFD
   964         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   965                                     PIC  X(03).                  ELCDTEFD
   966     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   967         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   968                                     PIC  X(06).                  ELCDTEFD
   969     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   970         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   971                                     PIC  X(07).                  ELCDTEFD
   972         16  FILLER                  PIC  X(05).                  ELCDTEFD
   973     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   974                                     PIC  X(96).                  ELCDTEFD
   975******************************************************************ELCDTEFD
   976
   977 FD  OTHER-STATEMENTS
   978     LABEL RECORDS ARE STANDARD
   979     RECORDING MODE IS F
   980     BLOCK CONTAINS 0 RECORDS.
   981 01  OTHER-STMT-REC              PIC X(133).
   982
   983 FD  REMIT-STMTS
   984     LABEL RECORDS ARE STANDARD
   985     RECORDING MODE IS F
   986     BLOCK CONTAINS 0 RECORDS.
   987 01  REMIT-STMT-REC                  PIC X(133).
   988
   989 FD  SCAN-EXT
   990     BLOCK CONTAINS 0 RECORDS
   991     RECORDING MODE F.
   992
   993 01  SCAN-EXT-RECORD             PIC X(55).
   994
   995
   996 WORKING-STORAGE SECTION.
*  997 copy "ctypes.cpy".
   998 77  char                   pic s9(2)  comp-5 is typedef.
   999 77  uns-char               pic  9(2)  comp-5 is typedef.
  1000 77  short                  pic s9(4)  comp-5 is typedef.
  1001 77  uns-short              pic  9(4)  comp-5 is typedef.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* CIB012.cbl (/apps/prod/cid1p/copy/ctypes.cpy)
  1002 77  int                    pic s9(9)  comp-5 is typedef.
  1003 77  uns-int                pic  9(9)  comp-5 is typedef.
  1004$IF P64 set
  1005X77  long                   pic s9(18) comp-5 is typedef.
  1006X77  uns-long               pic  9(18) comp-5 is typedef.
  1007$ELSE
  1008 77  long                   pic s9(9)  comp-5 is typedef.
  1009 77  uns-long               pic  9(9)  comp-5 is typedef.
  1010$END
  1011 77  l-long                 pic s9(18) comp-5 is typedef.
  1012 77  uns-l-long             pic  9(18) comp-5 is typedef.
  1013 77  d-l-float                         comp-2 is typedef.
  1014 77  d-float                           comp-2 is typedef.
  1015 77  float                             comp-1 is typedef.
  1016 77  proc-pointer           procedure-pointer is typedef.
  1017 77  data-pointer                     pointer is typedef.
  1018 77  void                   pic  9(2)  comp-5 is typedef.
  1019 78  default-convention-val value   0.
  1020 78  cdecl-convention-val   value   0.
  1021 78  pascal-convention-val  value  11.
  1022 78  fast-convention-val    value   2.
  1023 78  std-convention-val     value  74.
  1024 78  sys-convention-val     value  16.
  1025 78  opt-convention-val     value   0.
  1026 78  pasc16-convention-val  value  35.
  1027 78  cdec16-convention-val  value  32.
  1028
  1029 77  WS-HEADING-SW               PIC X   VALUE SPACES.
  1030     88  WS-HEADING                  VALUE 'Y'.
  1031 77  WS-REMIT-STMT-SW            PIC X   VALUE SPACES.
  1032     88  WS-REMIT-STMT               VALUE 'Y'.
  1033 77  WS-NEW-ACCT-SW              PIC X   VALUE SPACES.
  1034     88  WS-NEW-ACCT                 VALUE 'Y'.
  1035 77  WS-EOF-SW                   PIC X   VALUE SPACES.
  1036     88  END-OF-INPUT                VALUE 'Y'.
  1037 77  ERCOMP-FILE-STATUS          PIC XX  VALUE LOW-VALUES.
  1038 77  ERACCT-FILE-STATUS          PIC XX  VALUE LOW-VALUES.
  1039 77  FORMDEFS-FILE-STATUS        PIC XX  VALUE LOW-VALUES.
  1040 77  WS-IN-CNT                   PIC 9(7)  VALUE ZEROS.
  1041 77  WS-OUT-CNT                  PIC 9(7)  VALUE ZEROS.
  1042 77  A1                          PIC S999  VALUE +0 COMP-3.
  1043 77  WS-SAVE-STATE               PIC XX   VALUE SPACES.
  1044 77  WS-USER-SELECT-2            PIC X(10)  VALUE SPACES.
  1045 77  WS-REPORT-CODE-1            PIC X(10)  VALUE SPACES.
  1046 77  WS-ACCOUNT-FOUND-SW         PIC X    VALUE SPACES.
  1047     88  FOUND-ACCOUNT              VALUE 'Y'.
  1048 77  WS-SAVE-ERACCT-KEY          PIC X(19)  VALUE LOW-VALUES.
  1049 77  WS-DATE-RANGE-FOUND-SW      PIC X   VALUE SPACES.
  1050    88  DATE-RANGE-FOUND            VALUE 'Y'.
  1051 77  WS-ADDR-SEQ-NO              PIC 9(7)  VALUE ZEROS.
  1052 77  WS-DIS-ADDR-SEQ-NO          PIC ZZZZZZ9  BLANK WHEN ZERO.
  1053 77  WS-DISPLAY-AMT              PIC ---,--9.99.
  1054 01  WS-COMPARE-KEY.
  1055     05  WS-CK-CARRIER           PIC X.
  1056     05  WS-CK-GROUP             PIC X(6).
  1057     05  WS-CK-RESP              PIC X(10).
  1058     05  WS-CK-ACCOUNT           PIC X(10).
  1059 01  WS-PREV-KEY                 PIC X(27)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* CIB012.cbl
  1060 01  WS-MISC.
  1061     05  WS-SUMMARY-SW           PIC X   VALUE SPACES.
  1062         88  LAST-PAGE-SUMMARY          VALUE 'Y'.
  1063         88  LAST-PAGE-DETAIL           VALUE 'D'.
  1064     05  WS-SRCH-STATE           PIC X(30)  VALUE SPACES.
  1065     05  WS-HOLD-HEAD  OCCURS 4  PIC X(133).
  1066
  1067 01  WS-COVER-SHEET.
  1068     05  PD-CC               PIC X.
  1069     05  PD-ID               PIC X(4).
  1070     05  PD-DATE1            PIC X(18).
  1071     05  PD-CUR              PIC ---,--9.99.
  1072     05  PD-OV30             PIC ----,--9.99.
  1073     05  PD-OV60             PIC ----,--9.99.
  1074     05  PD-OV90             PIC ----,--9.99.
  1075     05  PD-END-BAL          PIC ----,--9.99.
  1076     05  PD-ACCOUNT          PIC X(10).
  1077     05  PD-PMT              PIC ----,--9.99.
  1078     05  PD-BAL-FWD          PIC ----,--9.99.
  1079     05  PD-USER-SELECT-2    PIC X(14).
  1080     05  filler redefines pd-user-select-2.
  1081         10  pd-ahl-ov120    PIC ----,--9.99.
  1082         10  filler          pic xxx.
  1083     05  PD-REPORT-CODE-1    PIC X(10).
  1084 01  REDEFINES WS-COVER-SHEET.
  1085     05  FILLER              PIC X.
  1086     05  PD-BARCODE1         PIC X(50).
  1087     05  FILLER              PIC X(10).
  1088     05  PD-BARCODE2         PIC X(25).
  1089 01  REDEFINES WS-COVER-SHEET.
  1090     05  FILLER           PIC X.
  1091     05  PD-ADDRESS       PIC X(132).
  1092 01  REDEFINES WS-COVER-SHEET.
  1093     05  FILLER           PIC X.
  1094     05  PD-SPEC-NOTES    PIC X(132).
  1095
  1096 01  FILLER.
  1097     05  ws-ahl-pd-date1         PIC X(18)   VALUE SPACE.
  1098     05  SAVE-BARCODE1       PIC X(50)   VALUE SPACE.
  1099     05  SAVE-BARCODE2       PIC X(25)   VALUE SPACE.
  1100     05  WS-WORK-DATE            PIC 9(11)  VALUE ZEROS.
  1101     05  WS-WORK-DATER REDEFINES WS-WORK-DATE.
  1102         10  FILLER              PIC XXX.
  1103         10  WS-SCAN-CCYYMM      PIC X(6).
  1104         10  FILLER              PIC XX.
  1105     05  WS-RETURN-CODE          PIC S9(4)  COMP  VALUE ZEROS.
  1106     05  WS-ZERO                 PIC S9     VALUE +0  COMP-3.
  1107     05  WS-ABEND-MESSAGE        PIC X(80)  VALUE SPACES.
  1108     05  WS-ABEND-FILE-STATUS    PIC XX     VALUE ZEROS.
  1109     05  PGM-SUB             PIC S999   COMP-3  VALUE +061.
  1110     05  S0C7                PIC X       VALUE SPACE.
  1111     05  FORCE-DUMP REDEFINES S0C7 PIC S9 COMP-3.
  1112     05  ERCOMP-STATUS       PIC X(2)    VALUE SPACE.
  1113     05  PREV-CO-CONTROL     PIC X(29)   VALUE SPACE.
  1114     05  REMIT-PAGE-NO       PIC 9(6)    VALUE ZERO.
  1115     05  WS-DATE             PIC 9(8)    VALUE ZERO.
  1116     05  WS-HDG  OCCURS 4 TIMES PIC X(133).
  1117     05  WK-ADDR OCCURS 7 TIMES PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* CIB012.cbl
  1118     05  WK-AMT              PIC ZZZ,ZZZ,ZZZ.99/.
  1119
  1120 01  FILLER               COMP-3.
  1121     05  STRT             PIC S9(3)   VALUE +0.
  1122     05  S1               PIC S9(3)   VALUE +0.
  1123     05  WK1              PIC S9(7)   VALUE +0.
  1124     05  WK2              PIC S9(7)   VALUE +0.
  1125
* 1126                                 COPY FORMREC.
  1127******************************************************************
  1128*                                                                *
  1129*                                                                *
  1130*                            FORMREC                             *
  1131*                            VMOD=2.031                          *
  1132*                                                                *
  1133*   Billing system file for verbaige in overlays                 *
  1134*                                                                *
  1135*   FILE DESCRIPTION = FORM DEFINITION FILE                      *
  1136*                                                                *
  1137*   FILE TYPE = VSAM,KSDS                                        *
  1138*   RECORD SIZE = 900   RECFORM = FIX                            *
  1139*                                                                *
  1140*   BASE CLUSTER NAME = FORMDEFS                  RKP=0,LEN=12   *
  1141*                                                                *
  1142*   LOG = NO                                                     *
  1143*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1144*                                                                *
  1145*                                                                *
  1146******************************************************************
  1147*                   C H A N G E   L O G
  1148*
  1149* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1150*-----------------------------------------------------------------
  1151*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1152* EFFECTIVE    NUMBER
  1153*-----------------------------------------------------------------
  1154* 092312  CR2012040900002  PEMA  NEW FILE AND COPYBOOK
  1155*****************************************************************
  1156  01  form-record.
  1157      03  form-key.
  1158          05  form-name           pic x(10).
  1159          05  form-month          pic 99.
  1160      03  form-desc               pic x(30).
  1161      03  special-notes occurs 8  pic x(75).
  1162      03  comment-1               pic x(95).
  1163      03  comment-2               pic x(95).
  1164      03  filler                  pic x(68).
  1165
  1166 01  WS-SAVE-SCAN-REC        PIC X(55).
  1167 01  CID-SCAN-REC.
  1168     05  SAV-CID-CC              PIC 99.
  1169     05  SAV-CID-YY              PIC 99.
  1170     05  SAV-CID-MM              PIC 99.
  1171     05  sav-comp-indicator      pic 9.
  1172     05  CID-SCAN-SEQ-NO         PIC 9(6).
  1173     05  SR-DEL1                 PIC X.
  1174     05  CID-CARRIER             PIC X.
  1175     05  SR-DEL2                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* CIB012.cbl
  1176     05  CID-GROUP               PIC X(6).
  1177     05  SR-DEL3                 PIC X.
  1178     05  CID-FIN-RESP            PIC X(10).
  1179     05  SR-DEL4                 PIC X.
  1180     05  CID-ACCOUNT             PIC X(10).
  1181     05  SR-DEL5                 PIC X.
  1182     05  CID-AMT-DUE             PIC 9(7).99.
  1183
  1184*****************************************************************
  1185*  BARCODE ROUTINE                                              *
  1186*****************************************************************
  1187 01  AGEB16-WORKAREA.
  1188*     05  AGEB16-LEN       PIC 9(4)    VALUE ZERO.
  1189     05  AGEB16-LEN       short.
  1190     05  AGEB16-INPUT     PIC X(28)   VALUE SPACE.
  1191     05  AGEB16-OUTPUT    PIC X(128)  VALUE SPACE.
  1192
  1193 01  BARCODE1.
  1194     05  BC-ENCL-CODE        PIC X(2)    VALUE ZERO.
  1195     05  BC-MAIL-CODE        PIC X       VALUE '1'.
  1196     05  BC-DIV-CODE         PIC X       VALUE '1'.
  1197     05  BC-ACCT-NO.
  1198         10  BC-CARR         PIC X(07)   VALUE ZERO.
  1199         10  BC-ACCT         PIC X(10)   VALUE ZERO.
  1200     05  BC-SEQ-NO           PIC 9(4)    VALUE ZERO.
  1201
  1202 01  BARCODE2.
  1203     05  BC1-DATE            PIC X(6).
  1204     05  bc2-fill            pic x value '0'.
  1205     05  BC1-SEQ-NO          PIC 9(6)    VALUE ZERO.
  1206
  1207
* 1208                                 COPY ELCDATE.
  1209******************************************************************06/11/98
  1210*                                                                *ELCDATE
  1211*                                                                *ELCDATE
  1212*                            ELCDATE.                            *   LV023
  1213*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1214*                            VMOD=2.003                           ELCDATE
  1215*                                                                *ELCDATE
  1216*                                                                *ELCDATE
  1217*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1218*                 LENGTH = 200                                   *   CL*19
  1219******************************************************************ELCDATE
  1220                                                                  ELCDATE
  1221 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1222     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1223     12  DC-OPTION-CODE                PIC X.                        CL*15
  1224         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1225         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1226         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1227         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1228         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1229         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1230         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1231         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1232         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1233         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1234         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1235         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1236         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1237         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1238         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1239         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1240         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1241         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1242         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1243         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1244         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1245         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1246         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1247         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1248         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1249         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1250         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1251         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1252         88  THREE-CHARACTER-BIN                                  ELCDATE
  1253                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1254         88  GREGORIAN-TO-BIN                                        CL**2
  1255                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1256         88  BIN-TO-GREGORIAN                                        CL**2
  1257                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1258         88  JULIAN-TO-BINARY                                        CL**2
  1259                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1260     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1261         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1262         88  DATE-CONVERSION-ERROR                                ELCDATE
  1263                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1264         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1265         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1266         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1267         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1268         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1269         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1270         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1271         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1272         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1273         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1274     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1275         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1276     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1277         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1278         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1279         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1280     12  FILLER                        PIC X.                        CL*15
  1281     12  DC-CONVERSION-DATES.                                        CL*15
  1282         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1283         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1284         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1285         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1286                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1287             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1288             20  SLASH1-1              PIC X.                        CL*15
  1289             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1290             20  SLASH1-2              PIC X.                        CL*15
  1291             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1292         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1293         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1294                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1295             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1296             20  SLASH2-1              PIC X.                        CL*15
  1297             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1298             20  SLASH2-2              PIC X.                        CL*15
  1299             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1300         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1301         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1302                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1303             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1304             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1305             20  DC-YMD-DAY            PIC 99.                       CL*15
  1306         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1307         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1308                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1309             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1310             20  DC-MDY-DAY            PIC 99.                       CL*15
  1311             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1312         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1313             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1314             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1315             20  FILLER                PIC XX.                       CL*15
  1316             20  DC-ALPHA-CENTURY.                                   CL*15
  1317                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1318             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1319         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1320         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1321         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1322         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1323         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1324                                       PIC 9(05).                    CL*20
  1325         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1326             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1327             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1328         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1329         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1330         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1331     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1332         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1333         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1334             20  FILLER                PIC 9(3).                     CL*15
  1335             20  HOLD-CEN-1-CCYY.                                    CL*15
  1336                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1337                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1338             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1339             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1340         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1341             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1342             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1343             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1344                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1345                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1346             20  FILLER                PIC 9(3).                     CL*15
  1347         16  HOLD-CENTURY-1-X.                                       CL*15
  1348             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1349             20  HOLD-CEN-1-X-CCYY.                                  CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1350                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1351                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1352             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1353             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1354         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1355             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1356             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1357             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1358                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1359                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1360             20  FILLER                PIC XXX.                      CL*23
  1361         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1362         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1363         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1364         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1365             20  DC-JULIAN-1-CCYY.                                   CL*15
  1366                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1367                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1368             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1369         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1370         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1371             20  DC-JULIAN-2-CCYY.                                   CL*15
  1372                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1373                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1374             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1375         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1376             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1377             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1378             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1379             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1380             20  DC-EDITA-CCYY.                                      CL*15
  1381                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1382                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1383         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1384             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1385             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1386             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1387             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1388             20  DC-EDITB-CCYY.                                      CL*15
  1389                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1390                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1391         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1392         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1393                              DC-GREG-DATE-CYMD.                  ELCDATE
  1394             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1395             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1396             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1397             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1398         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1399         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1400                              DC-GREG-DATE-MDCY.                  ELCDATE
  1401             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1402             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1403             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1404             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1405    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1406        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1407    12  DC-EL310-DATE                  PIC X(21).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* CIB012.cbl
  1408    12  FILLER                         PIC X(28).                    CL*26
* 1409                                 COPY ELCDTECX.
  1410******************************************************************06/05/98
  1411*                                                                *ELCDTECX
  1412*                            ELCDTECX.                           *   LV005
  1413*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1414*                            VMOD=2.015                          *ELCDTECX
  1415*                                                                *ELCDTECX
  1416*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1417*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1418*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1419*                                                                *ELCDTECX
  1420******************************************************************ELCDTECX
  1421******************************************************************
  1422*                   C H A N G E   L O G
  1423*
  1424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1425*-----------------------------------------------------------------
  1426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1427* EFFECTIVE    NUMBER
  1428*-----------------------------------------------------------------
  1429* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1430*                                  BENEFIT CODES FROM 300 TO 900
  1431* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1432* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1433******************************************************************
  1434 01  DATE-CARD.                                                   ELCDTECX
  1435     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1436     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1437     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1438     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1439     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1440     12  EP-SW                       PIC  X.                      ELCDTECX
  1441         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1442     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1443         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1444     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1445     12  RUN-CENTURY.                                             ELCDTECX
  1446         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1447     12  FILLER                      PIC  X.                         CL**4
  1448     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1449     12  FILLER                      PIC  XXX.                    ELCDTECX
  1450     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1451                                                                  ELCDTECX
  1452 01  FILLER                          PIC  X(7)                       CL**6
  1453                                          VALUE 'OPTIONS'.        ELCDTECX
  1454 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1455     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1456     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1457     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1458         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1459         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1460     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1461     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1462     12  FILLER                      PIC  X.                      ELCDTECX
  1463     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1464     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1465     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1466     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1467     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1468     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1469     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1470     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1471     12  FILLER                      PIC  X.                      ELCDTECX
  1472     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1473     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1474     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1475     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1476     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1477     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1478     12  FILLER                      PIC  X.                      ELCDTECX
  1479     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1480     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1481     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1482     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1483     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1484     12  DTE-R78                     PIC  X.                      ELCDTECX
  1485     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1486     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1487     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1488     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1489     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1490     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1491     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1492                                     PIC  X.                      ELCDTECX
  1493         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1494                                                 ' '.             ELCDTECX
  1495         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1496         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1497     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1498         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1499         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1500     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1501     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1502                                     PIC  9.                         CL**4
  1503     12  DTE-SYSTEM.                                              ELCDTECX
  1504         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1505         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1506         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1507         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1508         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1509         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1510         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1511         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1512         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1513         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1514         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1515         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1516         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1517         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1518         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1519         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1520         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1521         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1522         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1523         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1524         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1525         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1526         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1527         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1528         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1529         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1530     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1531         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1532                                     PIC  X.                      ELCDTECX
  1533     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1534                                                                  ELCDTECX
  1535 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1536     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1537     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1538     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1539*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1540     12  FILLER                      PIC  X.                      ELCDTECX
  1541     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1542     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1543     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1544     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1545     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1546     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1547     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1548                                                                  ELCDTECX
  1549     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1550     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1551     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1552     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1553                                                                  ELCDTECX
  1554     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1555     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1556     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1557     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1558                                                                  ELCDTECX
  1559     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1560     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1561                                                                  ELCDTECX
  1562     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1563     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1564                                                                  ELCDTECX
  1565     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1566                                                                  ELCDTECX
  1567 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1568     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1569     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1570     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1571     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1572     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1573     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1574     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1575                                                                  ELCDTECX
  1576 01  FILLER                          PIC  X(12)                   ELCDTECX
  1577                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1578 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1579     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1580         16  CNT-ID                  PIC  X.                      ELCDTECX
  1581         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1582                                                                  ELCDTECX
  1583 01  FILLER                          PIC  X(11)                   ELCDTECX
  1584                                          VALUE 'STATE NAMES'.    ELCDTECX
  1585 01  STATE-NAMES.                                                 ELCDTECX
  1586     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1587         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1588         16  STATE-PIC1.                                          ELCDTECX
  1589             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1590             20  FILLER              PIC  XXX.                    ELCDTECX
  1591             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1592             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1593             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1594             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1595                                                                  ELCDTECX
  1596 01  FILLER                          PIC  X(13)                   ELCDTECX
  1597                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1598 01  CARRIER-NAMES.                                               ELCDTECX
  1599     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1600         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1601         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1602         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1603         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1604         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1605         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1606*        16  FILLER                  PIC  X.                      ELCDTECX
  1607         16  CARRIER-SEC-PAY         PIC  X.
  1608             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1609                                                                  ELCDTECX
  1610 01  FILLER                          PIC  X(9)                       CL**6
  1611                                          VALUE 'INS TYPES'.      ELCDTECX
  1612 01  CLAS-INS-TYPES.                                              ELCDTECX
  1613*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1614     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1615         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1616         16  CLAS-I-AB3.                                          ELCDTECX
  1617             20  FILLER              PIC  X.                      ELCDTECX
  1618             20  CLAS-I-AB2.                                      ELCDTECX
  1619                 24  FILLER          PIC  X.                      ELCDTECX
  1620                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1621         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1622             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1623             20  FILLER              PIC  X.                         CL**4
  1624         16  CLAS-I-AB10.                                         ELCDTECX
  1625             20  FILLER              PIC  X(9).                   ELCDTECX
  1626             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1627         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1628         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1629         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1630         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1631             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1632         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1633         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1634         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1635         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1636         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  1637         16  FILLER                  PIC  X(05).
  1638                                                                  ELCDTECX
  1639 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1640                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1641 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1642     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1643                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1644         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1645         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1646         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1647         16  CLAS-MORT-DESC.                                      ELCDTECX
  1648             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1649             20  FILLER              PIC  XX.                        CL**5
  1650             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1651             20  FILLER              PIC  X.                         CL**5
  1652             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1653             20  FILLER              PIC  X.                         CL**5
  1654             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1655             20  FILLER              PIC  X.                         CL**5
  1656             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1657             20  FILLER              PIC  X(5).                      CL**6
  1658                                                                  ELCDTECX
  1659 01  FILLER                          PIC  X(15)                   ELCDTECX
  1660                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1661 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1662     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1663         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1664         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1665         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1666         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1667         16  FILLER                  PIC  X(4).                      CL**6
  1668                                                                  ELCDTECX
  1669 01  FILLER                          PIC  X(7)                       CL**6
  1670                                     VALUE 'INDEXES'.             ELCDTECX
  1671 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1672     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1673     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1674     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1675     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1676     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1677     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1678     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1679     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1680     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1681     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1682     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1683     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1684     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1685     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1686     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1687     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1688     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1689                                                                  ELCDTECX
  1690 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1691     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1692     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1693     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1694     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1695     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1696     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1697     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1698     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1699     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1700     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1701     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1702                                                                  ELCDTECX
  1703 01  FILLER                          PIC  X(13)                   ELCDTECX
  1704                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1705 01  CLAS-MISC.                                                   ELCDTECX
  1706     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1707         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1708         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1709         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1710     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1711     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1712     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1713     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1714     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1715     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1716     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1717     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1718     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1719     12  STATE-L                     PIC  XX.                     ELCDTECX
  1720     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1721     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1722     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1723         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1724         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1725     12  DTE-ABEND-WORK.                                          ELCDTECX
  1726         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1727         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1728                                                                  ELCDTECX
  1729 01  FILLER                          PIC  X(12)                   ELCDTECX
  1730                                     VALUE 'WORKING DATE'.        ELCDTECX
  1731 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1732     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1733         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1734         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1735         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1736     12  WS-CURRENT-DATE.                                         ELCDTECX
  1737         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1738         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1739         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1740         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1741         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1742     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1743         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1744         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1745                                                                  ELCDTECX
  1746 01  FILLER                          PIC  X(12)                   ELCDTECX
  1747                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1748 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1749     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1750         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1751         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1752         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1753                                                                  ELCDTECX
  1754 01  FILLER                          PIC  X(10)                   ELCDTECX
  1755                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1756 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1757     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1758         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1759         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1760                                                                  ELCDTECX
  1761 01  FILLER                          PIC  X(13)                   ELCDTECX
  1762                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1763 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1764     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1765         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1766                                                                  ELCDTECX
  1767 01  FILLER                          PIC  X(13)                   ELCDTECX
  1768                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1769 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1770     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1771     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1772     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1773                                     PIC  X.                         CL**5
  1774     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1775     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1776     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1777     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1778     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1779     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1780     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1781     12  FILLER                      PIC  X(75).                  ELCDTECX
  1782******************************************************************ELCDTECX
  1783*01  MISC-CARR-PCT-DATA.                                          00001521
  1784*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1785*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1786*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1787*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1788*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1789*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1790******************************************************************ELCDTECX
  1791
* 1792                                 COPY ELCDTEVR.
  1793***************************************************************** 04/15/98
  1794*                                                                *ELCDTEVR
  1795*                                                                *ELCDTEVR
  1796*                            ELCDTEVR.                           *   LV003
  1797*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1798*                            VMOD=2.001                          *   CL**2
  1799*                                                                *ELCDTEVR
  1800*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1801*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1802*                                                                *ELCDTEVR
  1803******************************************************************ELCDTEVR
  1804 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1805     05  WS-RUN-DATE.                                             ELCDTEVR
  1806         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1807         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1808         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1809             15  RUN-CC              PIC  99.                     ELCDTEVR
  1810             15  RUN-YR              PIC  99.                     ELCDTEVR
  1811         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1812         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1813     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1814            WS-RUN-DATE              PIC 9(11).                      CL**2
  1815     05  WS-EP-DT.                                                ELCDTEVR
  1816         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1817         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1818         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1819             15  EP-CC               PIC  99.                     ELCDTEVR
  1820             15  EP-YR               PIC  99.                     ELCDTEVR
  1821         10  EP-MO                   PIC  99.                     ELCDTEVR
  1822         10  EP-DA                   PIC  99.                     ELCDTEVR
  1823     05  WS-EP-DT-N REDEFINES                                        CL**2
  1824            WS-EP-DT                 PIC 9(11).                      CL**2
  1825     05  WS-DTE-CONV-DT.                                             CL**4
  1826         10  FILLER                  PIC  9(03).                     CL**4
  1827         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1828         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1829             15  DTE-CONV-CC         PIC  99.                        CL**4
  1830             15  DTE-CONV-YR         PIC  99.                        CL**4
  1831         10  DTE-CONV-MO             PIC  99.                        CL**4
  1832         10  DTE-CONV-DA             PIC  99.                        CL**4
  1833     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1834            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1835 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1836     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1837         10  FILLER                            PIC 999.           ELCDTEVR
  1838         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1839         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1840             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1841             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1842         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1843         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1844     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1845            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1846     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1847         10  FILLER                            PIC 999.           ELCDTEVR
  1848         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1849         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1850         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1851         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1852     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1853            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1854 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1855     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1856         10  FILLER                            PIC 999.           ELCDTEVR
  1857         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1858         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1859             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1860             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1861         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1862         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1863     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1864            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1865     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1866         10  FILLER                            PIC 999.           ELCDTEVR
  1867         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1868         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1869             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1870             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1871         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1872         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1873     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1874            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1875     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1876         10  FILLER                            PIC 999.           ELCDTEVR
  1877         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1878         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1879             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1880             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1881         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1882         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1883     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1884            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1885 01  WS-RATE-RECORD.                                              ELCDTEVR
  1886         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1887             10  FILLER                        PIC 999.           ELCDTEVR
  1888             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1889             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1890                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1891                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1892             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1893             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1894         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1895                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1896
  1897 PROCEDURE DIVISION.
  1898
* 1899                                 COPY ELCDTERX.
  1900******************************************************************04/15/98
  1901*                                                                *ELCDTERX
  1902*                                                                *ELCDTERX
  1903*                            ELCDTERX.                           *   LV002
  1904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1905*                            VMOD=2.007                          *ELCDTERX
  1906*                                                                *ELCDTERX
  1907*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1908*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1909*      = ELCDTEFD)                                               *ELCDTERX
  1910*                                                                *ELCDTERX
  1911******************************************************************ELCDTERX
  1912                                                                  ELCDTERX
  1913     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1914                                                                  ELCDTERX
  1915     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1916     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1917     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1918                                                                  ELCDTERX
  1919     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1920                                                                  ELCDTERX
  1921******************************************************************ELCDTERX
  1922*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1923*          WARNING MESSAGES.                                      ELCDTERX
  1924******************************************************************ELCDTERX
  1925     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1926         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1927                                                                  ELCDTERX
  1928     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1929                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1930     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1931                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1932                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1933                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1934                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1935                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1936                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1937                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1938                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1939                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1940                                                                  ELCDTERX
  1941     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1942                                                                  ELCDTERX
  1943     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1944                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1945                                                                  ELCDTERX
  1946     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1947     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1948     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1949     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1950                                                                  ELCDTERX
  1951     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1952         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1953     ELSE                                                         ELCDTERX
  1954         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1955                                                                  ELCDTERX
  1956     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1957         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1958     ELSE                                                         ELCDTERX
  1959         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1960                                                                  ELCDTERX
  1961 0005-READ--CARD.                                                 ELCDTERX
  1962     READ DISK-DATE                                               ELCDTERX
  1963         AT END CLOSE DISK-DATE                                   ELCDTERX
  1964             GO TO 0060-READ--TEST.                               ELCDTERX
  1965                                                                  ELCDTERX
  1966     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1967                                                                  ELCDTERX
  1968     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1969         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1970         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1971         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1972         GO TO 0005-READ--CARD.                                   ELCDTERX
  1973                                                                  ELCDTERX
  1974     IF DD-ID = 'CLAD'                                            ELCDTERX
  1975         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1976         GO TO 0005-READ--CARD.                                   ELCDTERX
  1977                                                                  ELCDTERX
  1978     IF DD-ID = 'CLAX'                                            ELCDTERX
  1979         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1980         GO TO 0005-READ--CARD.                                   ELCDTERX
  1981                                                                  ELCDTERX
  1982     IF DD-ID = 'CLAF'                                            ELCDTERX
  1983         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1984         GO TO 0005-READ--CARD.                                   ELCDTERX
  1985                                                                  ELCDTERX
  1986     IF DD-ID = 'CLAC'                                            ELCDTERX
  1987         GO TO 0010-READ--CLAC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1988                                                                  ELCDTERX
  1989     IF DD-ID = 'CARR'                                            ELCDTERX
  1990         GO TO 0015-READ--CARR.                                   ELCDTERX
  1991                                                                  ELCDTERX
  1992     IF DD-ID = 'STAT'                                            ELCDTERX
  1993         GO TO 0020-READ--STAT.                                   ELCDTERX
  1994                                                                  ELCDTERX
  1995     IF DD-ID = 'BUSC'                                            ELCDTERX
  1996         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1997                                                                  ELCDTERX
  1998     IF DD-ID = 'MORT'                                            ELCDTERX
  1999         GO TO 0030-READ--MORT.                                   ELCDTERX
  2000                                                                  ELCDTERX
  2001     IF DD-ID = 'CLAI'                                            ELCDTERX
  2002         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2003                                                                  ELCDTERX
  2004     IF DD-ID = 'COLC'                                            ELCDTERX
  2005         GO TO 0065-READ--COLC.                                   ELCDTERX
  2006                                                                  ELCDTERX
  2007     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2008        DD-IDA = 'CL'                                             ELCDTERX
  2009         GO TO 0035-READ--CLXX.                                   ELCDTERX
  2010                                                                  ELCDTERX
  2011     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2012        DD-IDA = 'PO'                                             ELCDTERX
  2013         GO TO 0050-READ--POXX.                                   ELCDTERX
  2014                                                                  ELCDTERX
  2015     IF DD-ID = 'OPCA'                                            ELCDTERX
  2016         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2017                                                                  ELCDTERX
  2018     IF DD-ID = 'OPST'                                            ELCDTERX
  2019         GO TO 0072-READ--OPST.                                   ELCDTERX
  2020                                                                  ELCDTERX
  2021     IF DD-ID = 'OPBS'                                            ELCDTERX
  2022         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2023                                                                  ELCDTERX
  2024     IF DD-ID = 'OPMS'                                            ELCDTERX
  2025         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2026                                                                  ELCDTERX
  2027     GO TO 0005-READ--CARD.                                       ELCDTERX
  2028                                                                  ELCDTERX
  2029 0010-READ--CLAC.                                                 ELCDTERX
  2030     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2031     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2032     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2033     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2034     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2035     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2036     GO TO 0005-READ--CARD.                                       ELCDTERX
  2037                                                                  ELCDTERX
  2038 0015-READ--CARR.                                                 ELCDTERX
  2039     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2040     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2041        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2042        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2043        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2044        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2045        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2046        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2047        MOVE DD-CARR1-SECPAY-SW
  2048                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2049     END-IF
  2050                                                                  ELCDTERX
  2051     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2052     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2053        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2054        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2055        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2056        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2057        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2058        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2059        MOVE DD-CARR2-SECPAY-SW
  2060                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2061     END-IF
  2062                                                                  ELCDTERX
  2063                                                                  ELCDTERX
  2064     GO TO 0005-READ--CARD.                                       ELCDTERX
  2065                                                                  ELCDTERX
  2066 0020-READ--STAT.                                                 ELCDTERX
  2067     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2068     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2069        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2070         GO TO 0005-READ--CARD.                                   ELCDTERX
  2071                                                                  ELCDTERX
  2072     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2073     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2074     GO TO 0020-READ--STAT.                                       ELCDTERX
  2075                                                                  ELCDTERX
  2076 0025-READ--BUSC.                                                 ELCDTERX
  2077     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2078     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2079        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2080         GO TO 0005-READ--CARD.                                   ELCDTERX
  2081                                                                  ELCDTERX
  2082     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2083     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2084     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2085                                                                  ELCDTERX
  2086 0030-READ--MORT.                                                 ELCDTERX
  2087     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2088     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2089        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2090         GO TO 0005-READ--CARD.                                   ELCDTERX
  2091                                                                  ELCDTERX
  2092     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2093     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2094     GO TO 0030-READ--MORT.                                       ELCDTERX
  2095                                                                  ELCDTERX
  2096 0035-READ--CLXX.                                                 ELCDTERX
  2097     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2098          GO TO 0005-READ--CARD.                                  ELCDTERX
  2099                                                                  ELCDTERX
  2100     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2101         DISPLAY '***********************************************'ELCDTERX
  2102         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2103         DISPLAY '***********************************************'ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2104         GO TO 0055-READ--STOP.                                   ELCDTERX
  2105                                                                  ELCDTERX
  2106     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2107        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2108         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2109                                                                  ELCDTERX
  2110     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2111        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2112         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2113                                                                  ELCDTERX
  2114*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2115     GO TO 0005-READ--CARD.                                       ELCDTERX
  2116                                                                  ELCDTERX
  2117 0040-READ--CLAI.                                                 ELCDTERX
  2118     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2119     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2120        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2121         GO TO 0005-READ--CARD.                                   ELCDTERX
  2122                                                                  ELCDTERX
  2123     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2124     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2125     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2126                                                                  ELCDTERX
  2127 0045-READ--DUMP.                                                 ELCDTERX
  2128     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2129     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2130                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2131     PERFORM ABEND-PGM.                                           ELCDTERX
  2132                                                                  ELCDTERX
  2133 0050-READ--POXX.                                                 ELCDTERX
  2134     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2135         GO TO 0005-READ--CARD.                                   ELCDTERX
  2136                                                                  ELCDTERX
  2137     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2138         DISPLAY '***********************************************'ELCDTERX
  2139         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2140         DISPLAY '***********************************************'ELCDTERX
  2141         GO TO 0055-READ--STOP.                                   ELCDTERX
  2142                                                                  ELCDTERX
  2143     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2144     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2145     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2146     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2147                                                                  ELCDTERX
  2148     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2149         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2150     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2151         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2152                                                                  ELCDTERX
  2153     GO TO 0005-READ--CARD.                                       ELCDTERX
  2154                                                                  ELCDTERX
  2155 0055-READ--STOP.                                                 ELCDTERX
  2156     GOBACK.                                                      ELCDTERX
  2157                                                                  ELCDTERX
  2158 0060-READ--TEST.                                                 ELCDTERX
  2159     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2160        CLAX-ID         = SPACE  OR                               ELCDTERX
  2161        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* CIB012.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2162         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2163                                                                  ELCDTERX
  2164     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2165     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2166                                                                  ELCDTERX
  2167 0065-READ--COLC.                                                 ELCDTERX
  2168     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2169     GO TO 0005-READ--CARD.                                       ELCDTERX
  2170                                                                  ELCDTERX
  2171 0070-READ--OPCA.                                                 ELCDTERX
  2172                                                                  ELCDTERX
  2173     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2174                                                                  ELCDTERX
  2175     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2176             OR                                                   ELCDTERX
  2177         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2178         GO TO 0005-READ--CARD.                                   ELCDTERX
  2179                                                                  ELCDTERX
  2180     ADD 1                       TO INDEXCA.                      ELCDTERX
  2181     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2182                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2183     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2184                                                                  ELCDTERX
  2185 0072-READ--OPST.                                                 ELCDTERX
  2186                                                                  ELCDTERX
  2187     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2188                                                                  ELCDTERX
  2189     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2190             OR                                                   ELCDTERX
  2191         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2192         GO TO 0005-READ--CARD.                                   ELCDTERX
  2193                                                                  ELCDTERX
  2194     ADD 1                       TO INDEXST.                      ELCDTERX
  2195     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2196                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2197     GO TO 0072-READ--OPST.                                       ELCDTERX
  2198                                                                  ELCDTERX
  2199 0074-READ--OPBS.                                                 ELCDTERX
  2200                                                                  ELCDTERX
  2201     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2202                                                                  ELCDTERX
  2203     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2204             OR                                                   ELCDTERX
  2205         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2206         GO TO 0005-READ--CARD.                                   ELCDTERX
  2207                                                                  ELCDTERX
  2208     ADD 1                       TO INDEXBS.                      ELCDTERX
  2209     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2210     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2211                                                                  ELCDTERX
  2212 0079-READ--EXIT.                                                 ELCDTERX
  2213*    EXIT.                                                        ELCDTERX
  2214******************************************************************ELCDTERX
  2215
  2216     PERFORM 0010-OPEN-FILES     THRU 0010-EXIT
  2217     PERFORM 0020-INIT           THRU 0020-EXIT
  2218
  2219     PERFORM 0050-PROCESS-INPUT  THRU 0050-EXIT UNTIL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* CIB012.cbl
  2220        END-OF-INPUT
  2221
  2222     PERFORM 4000-CLOSE-FILES    THRU 4000-EXIT
  2223     GOBACK
  2224
  2225     .
  2226 0010-OPEN-FILES.
  2227
  2228     OPEN INPUT BILLING-STATEMENTS
  2229
  2230     OPEN INPUT ERCOMP
  2231     IF ERCOMP-FILE-STATUS NOT = '00' AND '97'
  2232        DISPLAY ' ERROR - ERCOMP - OPEN ' ERCOMP-FILE-STATUS
  2233        PERFORM ABEND-PGM
  2234     END-IF
  2235
  2236     OPEN INPUT ERACCT
  2237     IF ERACCT-FILE-STATUS NOT = '00' AND '97'
  2238        DISPLAY ' ERROR - ERACCT - OPEN ' ERACCT-FILE-STATUS
  2239        PERFORM ABEND-PGM
  2240     END-IF
  2241
  2242     OPEN INPUT FORMDEFS
  2243     IF FORMDEFS-FILE-STATUS NOT = '00' AND '97'
  2244        DISPLAY ' ERROR - FORMDEFS - OPEN ' FORMDEFS-FILE-STATUS
  2245        PERFORM ABEND-PGM
  2246     END-IF
  2247
  2248     OPEN OUTPUT OTHER-STATEMENTS SCAN-EXT
  2249                 REMIT-STMTS
  2250
  2251     .
  2252 0010-EXIT.
  2253     EXIT.
  2254
  2255 0020-INIT.
  2256
  2257     MOVE RUN-DATE               TO WS-WORK-DATE
  2258     MOVE SPACES                 TO WS-COVER-SHEET
  2259
  2260     MOVE SPACES                 TO CID-SCAN-REC
  2261     MOVE RUN-DATE               TO WS-WORK-DATE
  2262     MOVE WS-SCAN-CCYYMM         TO BC1-DATE
  2263                                    CID-SCAN-REC (1:6)
  2264     if dte-client = 'AHL'
  2265        move 9                   to sav-comp-indicator
  2266     else
  2267        move 0                   to sav-comp-indicator
  2268     end-if
  2269     MOVE ZEROS                  TO CID-SCAN-SEQ-NO
  2270     MOVE ZEROS                  TO CID-AMT-DUE
  2271     MOVE ';'                    TO SR-DEL1
  2272                                    SR-DEL2
  2273                                    SR-DEL3
  2274                                    SR-DEL4
  2275                                    SR-DEL5
  2276     MOVE CID-SCAN-REC           TO WS-SAVE-SCAN-REC
  2277
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* CIB012.cbl
  2278     if dte-client = 'AHL'
  2279        move 'AHO010'            to fd-form-name
  2280     else
  2281        move 'CIO010'            to fd-form-name
  2282     end-if
  2283     move run-mo                 to fd-form-month
  2284*    move 11                     to fd-form-month
  2285     read FORMDEFS
  2286     evaluate true
  2287        when formdefs-file-status = '00'
  2288           move form-def-in-rec  to form-record
  2289        when formdefs-file-status = '23'
  2290           move 01               to fd-form-month
  2291           read FORMDEFS
  2292           if formdefs-file-status = '00'
  2293              move form-def-in-rec
  2294                                 to form-record
  2295           else
  2296              move spaces        to form-record
  2297           end-if
  2298        when other
  2299           move spaces           to form-record
  2300     end-evaluate
  2301
  2302     close FORMDEFS
  2303
  2304     PERFORM 0040-READ-INPUT     THRU 0040-EXIT
  2305
  2306     if dte-client not = 'AHL'
  2307        go to 0020-exit
  2308     end-if
  2309
  2310     move '9'                    to bc2-fill
  2311     move +0                     to strt
  2312
  2313     move ws-accept-date         to dc-greg-date-1-ymd-r
  2314     move '3'                    to dc-option-code
  2315     perform 8500-date-convert   thru 8500-exit
  2316     if not no-conversion-error
  2317        display ' error - dtecnvrt - accept date ' ws-accept-date
  2318           ' ' dc-error-code
  2319        perform abend-pgm
  2320     end-if
  2321     inspect dc-greg-date-1-alpha tallying strt for leading ' '
  2322     move dc-greg-date-1-alpha(strt + 1:)
  2323                                 to ws-ahl-pd-date1
  2324
  2325     .
  2326 0020-EXIT.
  2327     EXIT.
  2328
  2329 0040-READ-INPUT.
  2330
  2331     READ BILLING-STATEMENTS AT END
  2332        SET END-OF-INPUT         TO TRUE
  2333     END-READ
  2334
  2335     IF NOT END-OF-INPUT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* CIB012.cbl
  2336        ADD 1                    TO WS-IN-CNT
  2337     END-IF
  2338
  2339     .
  2340 0040-EXIT.
  2341     EXIT.
  2342
  2343 0050-PROCESS-INPUT.
  2344
  2345     IF STMT-RECORD (1:1) = '1'
  2346        SET WS-HEADING TO TRUE
  2347        PERFORM 0060-PROCESS-HEADING THRU 0060-EXIT
  2348     END-IF
  2349
  2350     IF STMT-RECORD (4:17) = 'PLEASE RETURN ONE'
  2351        SET LAST-PAGE-SUMMARY    TO TRUE
  2352     END-IF
  2353
  2354     IF WS-REMIT-STMT
  2355        PERFORM 0080-WRITE-REMIT-STMT THRU 0080-EXIT
  2356     ELSE
  2357        PERFORM 0090-WRITE-OTHER-STMT THRU 0090-EXIT
  2358     END-IF
  2359
  2360     PERFORM 0040-READ-INPUT     THRU 0040-EXIT
  2361
  2362     .
  2363 0050-EXIT.
  2364     EXIT.
  2365
  2366 0060-PROCESS-HEADING.
  2367
  2368     IF WS-REMIT-STMT
  2369         DISPLAY ' YES REMIT STMT ' CO-CARRIER ' ' CO-RESP-NO ' '
  2370            CO-ACCOUNT
  2371     MOVE SPACES                 TO WS-COVER-SHEET
  2372     IF LAST-PAGE-SUMMARY
  2373        DISPLAY ' YES LAST PAGE SUMMARY ' CO-CARRIER ' '
  2374           CO-RESP-NO ' ' CO-ACCOUNT
  2375        SET LAST-PAGE-DETAIL     TO TRUE
  2376        MOVE 'C'                 TO PD-CC
  2377        MOVE SAVE-BARCODE2       TO PD-BARCODE2
  2378     END-IF
  2379*    MOVE WS-HOLD-HEAD (3)(126:6) TO REMIT-PAGE-NO
  2380*    DIVIDE REMIT-PAGE-NO BY 2 GIVING WK1 REMAINDER WK2
  2381*    IF WK2 = 1
  2382*       MOVE 'C'                 TO PD-CC
  2383*       PERFORM 2100-BUILD-BARCODE1 THRU 2100-EXIT
  2384*       MOVE SAVE-BARCODE1       TO PD-BARCODE1
  2385*    END-IF
  2386     IF WS-COVER-SHEET NOT = SPACES
  2387        WRITE REMIT-STMT-REC         FROM WS-COVER-SHEET
  2388     END-IF
  2389     END-IF
  2390
  2391     MOVE STMT-RECORD            TO WS-HOLD-HEAD (1)
  2392     PERFORM 0040-READ-INPUT     THRU 0040-EXIT
  2393     MOVE STMT-RECORD            TO WS-HOLD-HEAD (2)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* CIB012.cbl
  2394     PERFORM 0040-READ-INPUT     THRU 0040-EXIT
  2395     MOVE STMT-RECORD            TO WS-HOLD-HEAD (3)
  2396     PERFORM 0040-READ-INPUT     THRU 0040-EXIT
  2397     MOVE STMT-RECORD            TO WS-HOLD-HEAD (4)
  2398     PERFORM 0040-READ-INPUT     THRU 0040-EXIT
  2399
  2400     IF WS-HOLD-HEAD (1) (61:13) = 'OVERALL RECAP'
  2401        GO TO 0060-EXIT
  2402     END-IF
  2403
  2404     MOVE WS-HOLD-HEAD (4)(16:01)
  2405                                 TO WS-CK-CARRIER
  2406     MOVE WS-HOLD-HEAD (4)(17:06)
  2407                                 TO WS-CK-GROUP
  2408     MOVE WS-HOLD-HEAD (4)(90:10)
  2409                                 TO WS-CK-RESP
  2410     MOVE WS-HOLD-HEAD (4)(24:10)
  2411                                 TO WS-CK-ACCOUNT
  2412
  2413     IF WS-COMPARE-KEY NOT = WS-PREV-KEY
  2414        SET WS-NEW-ACCT          TO TRUE
  2415        PERFORM 0070-READ-ERCOMP THRU 0070-EXIT
  2416        MOVE WS-COMPARE-KEY      TO WS-PREV-KEY
  2417     ELSE
  2418        MOVE ' '                 TO WS-NEW-ACCT-SW
  2419     END-IF
  2420
  2421     .
  2422 0060-EXIT.
  2423     EXIT.
  2424
  2425 0070-READ-ERCOMP.
  2426
  2427     MOVE DTE-CLASIC-COMPANY-CD  TO CO-COMPANY-CD
  2428
  2429     MOVE WS-HOLD-HEAD (4)(16:01) TO CO-CARRIER
  2430     MOVE WS-HOLD-HEAD (4)(17:06) TO CO-GROUPING
  2431     MOVE WS-HOLD-HEAD (4)(90:10) TO CO-RESP-NO
  2432     MOVE WS-HOLD-HEAD (4)(24:10) TO CO-ACCOUNT
  2433     MOVE 'A'                    TO CO-TYPE
  2434
  2435     IF CO-RESP-NO = SPACES
  2436        MOVE CO-ACCOUNT          TO CO-RESP-NO
  2437     END-IF
  2438
  2439     IF CO-CONTROL-PRIMARY = PREV-CO-CONTROL
  2440        GO TO 0070-EXIT
  2441     END-IF
  2442
  2443     IF (CO-CARRIER = SPACES)
  2444        AND (CO-GROUPING = SPACES)
  2445        GO TO 0070-EXIT
  2446     END-IF
  2447
  2448     READ ERCOMP
  2449     IF ERCOMP-FILE-STATUS NOT = '00'
  2450        DISPLAY ' ERROR - ERCOMP - READ ' ERCOMP-FILE-STATUS
  2451           ' KEY=' CO-CONTROL-PRIMARY (2:27)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* CIB012.cbl
  2452        PERFORM ABEND-PGM
  2453     END-IF
  2454
  2455     MOVE CO-CONTROL-PRIMARY     TO PREV-CO-CONTROL
  2456
  2457     IF (CO-BILL-SW = 'B' OR 'C')
  2458        AND (CO-CURRENT-END-BAL IS POSITIVE)
  2459        MOVE CO-CURRENT-END-BAL TO WS-DISPLAY-AMT
  2460        DISPLAY ' REMIT STMT ' CO-CARRIER ' ' CO-RESP-NO ' '
  2461           CO-ACCOUNT ' ' CO-BILL-SW ' ' WS-DISPLAY-AMT
  2462        SET WS-REMIT-STMT  TO TRUE
  2463     ELSE
  2464        MOVE ' '                 TO WS-REMIT-STMT-SW
  2465        MOVE CO-CURRENT-END-BAL TO WS-DISPLAY-AMT
  2466        DISPLAY ' NOT REMIT STMT ' CO-CARRIER ' ' CO-RESP-NO ' '
  2467           CO-ACCOUNT ' ' CO-BILL-SW ' ' WS-DISPLAY-AMT
  2468     END-IF
  2469
  2470*    IF (CO-CARRIER = '9')
  2471*       AND (CO-RESP-NO = '0000016480')
  2472*       SET END-OF-INPUT TO TRUE
  2473*    END-IF
  2474
  2475     .
  2476 0070-EXIT.
  2477     EXIT.
  2478
  2479 0080-WRITE-REMIT-STMT.
  2480
  2481     IF WS-HEADING
  2482        IF WS-NEW-ACCT
  2483           PERFORM 0100-PRINT-COVER-SHEET
  2484                                 THRU 0100-EXIT
  2485        END-IF
  2486        WRITE REMIT-STMT-REC         FROM WS-HOLD-HEAD (1)
  2487        WRITE REMIT-STMT-REC         FROM WS-HOLD-HEAD (2)
  2488        WRITE REMIT-STMT-REC         FROM WS-HOLD-HEAD (3)
  2489        WRITE REMIT-STMT-REC         FROM WS-HOLD-HEAD (4)
  2490        MOVE ' ' TO WS-HEADING-SW
  2491     END-IF
  2492
  2493     WRITE REMIT-STMT-REC            FROM STMT-RECORD
  2494
  2495     .
  2496 0080-EXIT.
  2497     EXIT.
  2498
  2499 0090-WRITE-OTHER-STMT.
  2500
  2501     IF WS-HEADING
  2502        WRITE OTHER-STMT-REC FROM WS-HOLD-HEAD (1)
  2503        WRITE OTHER-STMT-REC FROM WS-HOLD-HEAD (2)
  2504        WRITE OTHER-STMT-REC FROM WS-HOLD-HEAD (3)
  2505        WRITE OTHER-STMT-REC FROM WS-HOLD-HEAD (4)
  2506        MOVE ' ' TO WS-HEADING-SW
  2507     END-IF
  2508
  2509     WRITE OTHER-STMT-REC FROM STMT-RECORD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* CIB012.cbl
  2510
  2511     .
  2512 0090-EXIT.
  2513     EXIT.
  2514
  2515 0100-PRINT-COVER-SHEET.
  2516
  2517     SET LAST-PAGE-DETAIL TO TRUE
  2518     PERFORM 0200-GET-ERACCT     THRU 0200-EXIT
  2519
  2520     MOVE '1'                    TO PD-CC
  2521     MOVE 'PDUE'                 TO PD-ID
  2522
  2523     if dte-client = 'AHL'
  2524        move ws-ahl-pd-date1     to pd-date1
  2525     else
  2526        MOVE +0                  TO STRT
  2527        INSPECT ALPH-DATE TALLYING STRT FOR LEADING ' '
  2528        MOVE ALPH-DATE(STRT + 1:)
  2529                                 TO PD-DATE1
  2530     end-if
  2531     MOVE CO-ACCOUNT             TO PD-ACCOUNT
  2532     MOVE CO-CUR                 TO PD-CUR
  2533     MOVE CO-OV30                TO PD-OV30
  2534     MOVE CO-OV60                TO PD-OV60
  2535     MOVE CO-OV90                TO PD-OV90
  2536     MOVE CO-END-BAL             TO PD-END-BAL
  2537     MOVE CO-CUR-PMT             TO PD-PMT
  2538     MOVE CO-BAL-FWD             TO PD-BAL-FWD
  2539     IF WS-USER-SELECT-2 NOT = SPACES
  2540        move spaces              to pd-user-select-2
  2541        STRING 'CC: ' WS-USER-SELECT-2 DELIMITED BY SIZE
  2542           INTO PD-USER-SELECT-2
  2543        END-STRING
  2544     ELSE
  2545        MOVE SPACES              TO PD-USER-SELECT-2
  2546     END-IF
  2547     if dte-client = 'AHL'
  2548        move co-ov120            to pd-ahl-ov120
  2549     end-if
  2550     IF WS-REPORT-CODE-1 NOT = SPACES
  2551        MOVE WS-REPORT-CODE-1    TO PD-REPORT-CODE-1
  2552     ELSE
  2553        MOVE SPACES              TO PD-REPORT-CODE-1
  2554     END-IF
  2555
  2556     WRITE REMIT-STMT-REC            FROM WS-COVER-SHEET
  2557
  2558     MOVE SPACES                 TO WS-COVER-SHEET
  2559     PERFORM 2100-BUILD-BARCODE1 THRU 2100-EXIT
  2560     MOVE SAVE-BARCODE1          TO PD-BARCODE1
  2561     PERFORM 2150-BUILD-BARCODE2 THRU 2150-EXIT
  2562     MOVE SAVE-BARCODE2          TO PD-BARCODE2
  2563     WRITE REMIT-STMT-REC        FROM WS-COVER-SHEET
  2564
  2565*    MOVE SPACES                 TO WS-COVER-SHEET
  2566*    PERFORM 2150-BUILD-BARCODE2 THRU 2150-EXIT
  2567*    MOVE SAVE-BARCODE2          TO PD-BARCODE2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* CIB012.cbl
  2568*    WRITE REMIT-STMT-REC            FROM WS-COVER-SHEET
  2569
  2570
  2571     MOVE SPACES                 TO WS-COVER-SHEET
  2572     ADD 1                       TO WS-ADDR-SEQ-NO
  2573     MOVE WS-ADDR-SEQ-NO         TO WS-DIS-ADDR-SEQ-NO
  2574     MOVE WS-DIS-ADDR-SEQ-NO     TO WK-ADDR (1)
  2575     MOVE CO-CONTROL-NAME        TO WK-ADDR(2)
  2576     MOVE CO-ACCT-NAME           TO WK-ADDR(3)
  2577     MOVE CO-ADDR-1              TO WK-ADDR(4)
  2578     MOVE CO-ADDR-2              TO WK-ADDR(5)
  2579     MOVE SPACES                 TO WK-ADDR(6)
  2580     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  2581        DELIMITED BY '  ' INTO WK-ADDR (6)
  2582     END-STRING
  2583     IF CO-ZIP-PLUS4 = SPACE
  2584        MOVE CO-ZIP-PRIME        TO WK-ADDR(6)(26:5)
  2585     ELSE
  2586        MOVE CO-ZIP              TO WK-ADDR(6)(22:9)
  2587     END-IF
  2588
  2589     IF WK-ADDR(2) = WK-ADDR(3)
  2590        MOVE SPACES TO WK-ADDR(3)
  2591     END-IF
  2592
  2593     PERFORM 2 TIMES
  2594
  2595     IF WK-ADDR(1) = SPACES
  2596        MOVE WK-ADDR(2) TO WK-ADDR(1)
  2597        MOVE WK-ADDR(3) TO WK-ADDR(2)
  2598        MOVE WK-ADDR(4) TO WK-ADDR(3)
  2599        MOVE WK-ADDR(5) TO WK-ADDR(4)
  2600        MOVE WK-ADDR(6) TO WK-ADDR(5)
  2601        MOVE WK-ADDR(7) TO WK-ADDR(6)
  2602        MOVE SPACES     TO WK-ADDR(7)
  2603     END-IF
  2604
  2605     IF WK-ADDR(2) = SPACES
  2606        MOVE WK-ADDR(3) TO WK-ADDR(2)
  2607        MOVE WK-ADDR(4) TO WK-ADDR(3)
  2608        MOVE WK-ADDR(5) TO WK-ADDR(4)
  2609        MOVE WK-ADDR(6) TO WK-ADDR(5)
  2610        MOVE WK-ADDR(7) TO WK-ADDR(6)
  2611        MOVE SPACES     TO WK-ADDR(7)
  2612     END-IF
  2613
  2614     IF WK-ADDR(3) = SPACES
  2615        MOVE WK-ADDR(4) TO WK-ADDR(3)
  2616        MOVE WK-ADDR(5) TO WK-ADDR(4)
  2617        MOVE WK-ADDR(6) TO WK-ADDR(5)
  2618        MOVE WK-ADDR(7) TO WK-ADDR(6)
  2619        MOVE SPACES     TO WK-ADDR(7)
  2620     END-IF
  2621
  2622     IF WK-ADDR(4) = SPACES
  2623        MOVE WK-ADDR(5) TO WK-ADDR(4)
  2624        MOVE WK-ADDR(6) TO WK-ADDR(5)
  2625        MOVE WK-ADDR(7) TO WK-ADDR(6)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* CIB012.cbl
  2626        MOVE SPACES     TO WK-ADDR(7)
  2627     END-IF
  2628
  2629     IF WK-ADDR(5) = SPACES
  2630        MOVE WK-ADDR(6) TO WK-ADDR(5)
  2631        MOVE WK-ADDR(7) TO WK-ADDR(6)
  2632        MOVE SPACES     TO WK-ADDR(7)
  2633     END-IF
  2634
  2635     END-PERFORM
  2636
  2637     PERFORM VARYING A1 FROM 1 BY 1 UNTIL A1 > 7
  2638        MOVE WK-ADDR(A1)         TO PD-ADDRESS
  2639        WRITE REMIT-STMT-REC         FROM WS-COVER-SHEET
  2640     END-PERFORM
  2641
  2642     move spaces                 to ws-cover-sheet
  2643     perform varying a1 from 1 by 1 until a1 > 8
  2644        move special-notes (a1)  to pd-spec-notes
  2645        write remit-stmt-rec from ws-cover-sheet
  2646     end-perform
  2647     move comment-1              to pd-spec-notes
  2648     write remit-stmt-rec from ws-cover-sheet
  2649     move comment-2              to pd-spec-notes
  2650     write remit-stmt-rec from ws-cover-sheet
  2651
  2652     MOVE WS-SAVE-SCAN-REC       TO CID-SCAN-REC
  2653     MOVE BC1-SEQ-NO             TO CID-SCAN-SEQ-NO
  2654     MOVE CO-CARRIER             TO CID-CARRIER
  2655     MOVE CO-GROUPING            TO CID-GROUP
  2656     MOVE CO-RESP-NO             TO CID-FIN-RESP
  2657     MOVE CO-ACCOUNT             TO CID-ACCOUNT
  2658     MOVE CO-CURRENT-END-BAL     TO CID-AMT-DUE
  2659     WRITE SCAN-EXT-RECORD       FROM CID-SCAN-REC
  2660
  2661     .
  2662 0100-EXIT.
  2663     EXIT.
  2664
  2665 0200-GET-ERACCT.
  2666
  2667     MOVE SPACES                 TO WS-ACCOUNT-FOUND-SW
  2668                                    WS-USER-SELECT-2
  2669                                    WS-REPORT-CODE-1
  2670
  2671     MOVE LOW-VALUES             TO AM-CONTROL-PRIMARY
  2672     MOVE DTE-CLASIC-COMPANY-CD  TO AM-COMPANY-CD
  2673     MOVE CO-CARRIER             TO AM-CARRIER
  2674     MOVE CO-GROUPING            TO AM-GROUPING
  2675     MOVE CO-ACCOUNT             TO AM-ACCOUNT
  2676     MOVE LOW-VALUES             TO AM-EXPIRATION-DT
  2677
  2678*    PERFORM 0210-GET-STATE      THRU 0210-EXIT
  2679*    MOVE WS-SAVE-STATE          TO AM-STATE
  2680     MOVE CO-ADDR-STATE          TO AM-STATE
  2681
  2682     MOVE AM-CONTROL-A           TO WS-SAVE-ERACCT-KEY
  2683     START ERACCT KEY >= AM-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* CIB012.cbl
  2684     IF ERACCT-FILE-STATUS NOT = '00'
  2685        DISPLAY ' ERROR - ERACCT - START ' ERACCT-FILE-STATUS
  2686           ' KEY=' AM-CONTROL-PRIMARY (2:19)
  2687        PERFORM ABEND-PGM
  2688     END-IF
  2689
  2690     MOVE SPACES                 TO WS-DATE-RANGE-FOUND-SW
  2691     PERFORM UNTIL DATE-RANGE-FOUND
  2692        READ ERACCT NEXT
  2693        IF ERACCT-FILE-STATUS NOT = '00'
  2694           DISPLAY ' ERROR - ERACCT - READ ' ERACCT-FILE-STATUS
  2695              ' KEY=' AM-CONTROL-PRIMARY (2:19)
  2696           PERFORM ABEND-PGM
  2697        END-IF
  2698
  2699        IF (AM-CONTROL-A = WS-SAVE-ERACCT-KEY)
  2700           SET FOUND-ACCOUNT        TO TRUE
  2701           MOVE AM-USER-SELECT-2    TO WS-USER-SELECT-2
  2702           MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  2703        ELSE
  2704           SET DATE-RANGE-FOUND     TO TRUE
  2705           DISPLAY ' ERACCT = ' AM-CONTROL-PRIMARY (2:19)
  2706              ' ERCOMP = ' CO-CONTROL-PRIMARY (2:27)
  2707              ' STATE = ' WS-SAVE-STATE
  2708        END-IF
  2709     END-PERFORM
  2710
  2711     .
  2712 0200-EXIT.
  2713     EXIT.
  2714
  2715 0210-GET-STATE.
  2716
  2717*  WE REALLY DON'T NEED THIS PARA BECAUSE THE STATE
  2718*  IS SEPARATE NOW, BUT I LEFT IT IN ANYWAY
  2719     MOVE CO-ADDR-3              TO WS-SRCH-STATE
  2720
  2721     PERFORM VARYING S1 FROM +29 BY -1 UNTIL
  2722        (S1 < +1) OR
  2723        ((WS-SRCH-STATE (S1:2) ALPHABETIC) AND
  2724        (WS-SRCH-STATE (S1:2) NOT = SPACES AND LOW-VALUES)
  2725        AND
  2726        (WS-SRCH-STATE (S1 + 1:1) NOT = ' ' AND ',' AND
  2727                 '.' AND LOW-VALUES) AND
  2728        (WS-SRCH-STATE (S1:1) NOT = ' ' AND ',' AND
  2729                 '.' AND LOW-VALUES))
  2730     END-PERFORM
  2731
  2732     IF S1 NOT < +1
  2733        MOVE WS-SRCH-STATE (S1:2)
  2734                                 TO WS-SAVE-STATE
  2735     ELSE
  2736        MOVE SPACES              TO WS-SAVE-STATE
  2737     END-IF
  2738
  2739     .
  2740 0210-EXIT.
  2741     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* CIB012.cbl
  2742
  2743
  2744 2100-BUILD-BARCODE1.
  2745
  2746     MOVE CO-CARR-GROUP          TO BC-CARR
  2747     MOVE CO-ACCOUNT             TO BC-ACCT
  2748     ADD 1                       TO BC-SEQ-NO
  2749     MOVE 28                     TO AGEB16-LEN
  2750     MOVE BARCODE1               TO AGEB16-INPUT
  2751     MOVE SPACES                 TO AGEB16-OUTPUT
  2752
  2753     CALL 'AGEB16'   USING AGEB16-LEN
  2754                           AGEB16-INPUT
  2755                           AGEB16-OUTPUT
  2756
  2757     IF AGEB16-LEN = +128
  2758        DISPLAY 'AGEB16 - BARCODE ROUTINE ERROR'
  2759     ELSE
  2760        MOVE AGEB16-OUTPUT       TO SAVE-BARCODE1
  2761     END-IF
  2762*    DISPLAY  BARCODE1
  2763
  2764     .
  2765 2100-EXIT.
  2766     EXIT.
  2767
  2768 2150-BUILD-BARCODE2.
  2769
  2770     ADD 1                       TO BC1-SEQ-NO
  2771     MOVE 13                     TO AGEB16-LEN
  2772     MOVE BARCODE2               TO AGEB16-INPUT
  2773     MOVE SPACES                 TO AGEB16-OUTPUT
  2774
  2775     display ' barcode 2 ahl ' barcode2
  2776
  2777     CALL 'AGEB16' USING AGEB16-LEN
  2778                         AGEB16-INPUT
  2779                         AGEB16-OUTPUT
  2780     IF AGEB16-LEN = +128
  2781        DISPLAY 'AGEB16 - BARCODE ROUTINE ERROR'
  2782     ELSE
  2783        MOVE AGEB16-OUTPUT       TO SAVE-BARCODE2
  2784     END-IF
  2785
  2786     .
  2787 2150-EXIT.
  2788     EXIT.
  2789
  2790 4000-CLOSE-FILES.
  2791
  2792     CLOSE BILLING-STATEMENTS ERCOMP ERACCT SCAN-EXT
  2793        OTHER-STATEMENTS REMIT-STMTS
  2794
  2795     .
  2796 4000-EXIT.
  2797     EXIT.
  2798
  2799 8500-DATE-CONVERT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* CIB012.cbl
  2800
  2801     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2802
  2803     .
  2804 8500-EXIT.
  2805     EXIT.
  2806
  2807 ABEND-PGM.
* 2808                     COPY ELCABEND.
  2809***************************************************************** 04/14/98
  2810*                                                               * ELCABEND
  2811*                            ELCABEND.                          *    LV003
  2812*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2813*                            VMOD 2.002                              CL**2
  2814*                                                               * ELCABEND
  2815*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2816*            AND THEN ABENDS.                                   * ELCABEND
  2817*                                                               * ELCABEND
  2818*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2819*                                                               * ELCABEND
  2820***************************************************************** ELCABEND
  2821*APS-010.                                                         ELCABEND
  2822     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2823     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2824                                                                  ELCABEND
  2825     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2826         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2827         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2828                                 UPON CONSOLE.                    ELCABEND
  2829                                                                  ELCABEND
  2830     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2831         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2832         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2833                                 UPON CONSOLE.                    ELCABEND
  2834                                                                  ELCABEND
  2835     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2836     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2837                                 UPON CONSOLE.                    ELCABEND
  2838                                                                  ELCABEND
  2839     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2840     CALL 'ABORTME'.
  2841                                                                  ELCABEND
  2842 APS-EXIT.                                                        ELCABEND
  2843     EXIT.                                                        ELCABEND
  2844
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       56308     Code:        8610
