* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* SQLGETENC.cbl
* Options: int("SQLGETENC.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("SQLGETENC.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SQLGETENC.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "SQLGETENC.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2****************************************************************
     3 IDENTIFICATION DIVISION.
     4 PROGRAM-ID. SQLGETENC.
     5
     6*AUTHOR.     Pablo
     7*            Colleyville, TX.
     8*DATE-COMPILED.
     9
    10*SECURITY.   *****************************************************
    11*            *                                                   *
    12*            *   THIS PROGRAM IS THE PROPERTY OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* SQLGETENC.cbl
    14*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    15*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    16*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    17*            *                                                   *
    18*            *****************************************************
    19
    20*REMARKS. This program populates the Logic ELENCC file.
    21
    22 ENVIRONMENT DIVISION.
    23 CONFIGURATION SECTION.
    24 INPUT-OUTPUT SECTION.
    25 FILE-CONTROL.
    26
    27     SELECT ELENCC       ASSIGN TO ELENCC
    28                         ACCESS IS DYNAMIC
    29                         ORGANIZATION IS INDEXED
    30                         FILE STATUS IS ELENCC-FILE-STATUS
    31                         RECORD KEY IS NC-CONTROL-PRIMARY.
    32
    33     SELECT DISK-DATE    ASSIGN TO SYS019.
    34
    35 DATA DIVISION.
    36 FILE SECTION.
    37
    38 FD  ELENCC.
*   39                                 COPY ELCENCC.
    40******************************************************************
    41*                                                                *
    42*                                                                *
    43*                            ELCENCC                             *
    44*                            VMOD=2.001                          *
    45*                                                                *
    46*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
    47*                                                                *
    48*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
    49*   A NAPERSOFT DOCUMENT                                         *
    50*                                                                *
    51*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
    52*                                                                *
    53*   FILE TYPE = VSAM,KSDS                                        *
    54*   RECORD SIZE = 400   RECFORM = FIX                            *
    55*                                                                *
    56*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
    57*                                                                *
    58*   LOG = NO                                                     *
    59*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
    60*                                                                *
    61*                                                                *
    62******************************************************************
    63*                   C H A N G E   L O G
    64*
    65* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    66*-----------------------------------------------------------------
    67*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    68* EFFECTIVE    NUMBER
    69*-----------------------------------------------------------------
    70* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
    71******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCENCC)
    72
    73 01  ENCLOSURE-CODES.
    74     12  NC-RECORD-ID                      PIC XX.
    75         88  VALID-NC-ID                      VALUE 'NC'.
    76
    77     12  NC-CONTROL-PRIMARY.
    78         16  NC-COMPANY-CD                 PIC X.
    79         16  NC-REC-TYPE                   PIC X.
    80             88  NC-CLAIMS                   VALUE '1'.
    81             88  NC-ADMIN                    VALUE '2'.
    82         16  NC-ENC-CODE                   PIC X(5).
    83         16  FILLER                        PIC X(09).
    84
    85     12  NC-MAINT-INFORMATION.
    86         16  NC-LAST-MAINT-DT              PIC XX.
    87         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
    88         16  NC-LAST-MAINT-USER            PIC X(4).
    89         16  FILLER                        PIC XX.
    90
    91     12  NC-OUTPUT-STACK                   PIC XXX.
    92     12  NC-ENCLOSURE-LINE                 PIC X(100).
    93     12  NC-ATTACHMENTS                    PIC X(100).
    94     12  NC-FUTURE                         PIC X(50).
    95     12  FILLER                            PIC X(117).
    96******************************************************************
    97 FD  DISK-DATE
*   98                                 COPY ELCDTEFD.
    99******************************************************************04/15/98
   100*                                                                *ELCDTEFD
   101*                                                                *ELCDTEFD
   102*                            ELCDTEFD.                           *   LV002
   103*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   104*                            VMOD=2.007                          *   CL**2
   105*                                                                *ELCDTEFD
   106******************************************************************ELCDTEFD
   107     BLOCK CONTAINS 0 RECORDS
   108     RECORDING MODE F.                                            ELCDTEFD
   109                                                                  ELCDTEFD
   110 01  DATE-DISK.                                                   ELCDTEFD
   111     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   112     12  FILLER                      PIC  X(14).                  ELCDTEFD
   113     12  DD-CR1                      PIC  9.                      ELCDTEFD
   114     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   115     12  DD-CR2                      PIC  9.                      ELCDTEFD
   116     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   117     12  FILLER                      PIC  X(20).                  ELCDTEFD
   118                                                                  ELCDTEFD
   119 01  DATE-DISK-R.                                                 ELCDTEFD
   120     12  FILLER                      PIC  X(4).                   ELCDTEFD
   121     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   122                                     PIC  X(32).                  ELCDTEFD
   123                                                                  ELCDTEFD
   124 01  DATE-DISK-T.                                                 ELCDTEFD
   125     12  FILLER                      PIC  X(4).                   ELCDTEFD
   126     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   127                                     PIC  X(48).                  ELCDTEFD
   128                                                                  ELCDTEFD
   129 01  DATE-DISK-M.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   130     12  FILLER                      PIC  X(4).                   ELCDTEFD
   131     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   132                                     PIC  X(48).                  ELCDTEFD
   133                                                                  ELCDTEFD
   134 01  DATE-DISK-P.                                                 ELCDTEFD
   135     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   136     12  DD-IDX                      PIC  99.                     ELCDTEFD
   137     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   138     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   139         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   140                                     PIC  X.                      ELCDTEFD
   141         16  FILLER                  PIC  X(46).                  ELCDTEFD
   142     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   143         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   144             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   145             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   146             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   147             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   148         16  FILLER                  PIC  X(16).                  ELCDTEFD
   149                                                                  ELCDTEFD
   150 01  DATE-DISK-E.                                                 ELCDTEFD
   151     12  FILLER                      PIC  X(4).                   ELCDTEFD
   152     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   153                                     PIC  X(4).                   ELCDTEFD
   154                                                                  ELCDTEFD
   155 01  DATE-DISK-C.                                                 ELCDTEFD
   156     12  FILLER                      PIC  X(7).                   ELCDTEFD
   157     12  DD-CARR1-SECPAY-SW          PIC  X.
   158     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   159     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   160     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   161     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   162     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   163     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   164     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   165     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   166     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   167     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   168     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   169     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   170     12  DD-CARR2-SECPAY-SW          PIC  X.
   171     12  FILLER                      PIC  X(7).                   ELCDTEFD
   172                                                                  ELCDTEFD
   173 01  DATE-DISK-OPT.                                               ELCDTEFD
   174     12  FILLER                      PIC  X(04).                  ELCDTEFD
   175     12  DD-TLR-DATA.                                             ELCDTEFD
   176         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   177                                     PIC  X(03).                  ELCDTEFD
   178     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   179         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   180                                     PIC  X(06).                  ELCDTEFD
   181     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   182         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   183                                     PIC  X(07).                  ELCDTEFD
   184         16  FILLER                  PIC  X(05).                  ELCDTEFD
   185     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   186                                     PIC  X(96).                  ELCDTEFD
   187******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* SQLGETENC.cbl
   188
   189 working-storage section.
   190
*  191 EXEC SQL
*  192    INCLUDE SQLCA
*  193 END-EXEC
   194 01 SQLCA.
   195     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   196     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   197     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   198     05  SQLERRM.
   199         49  SQLERRML    PIC S9(4) COMP-5.
   200         49  SQLERRMC    PIC X(70).
   201     05  SQLERRP         PIC X(8).
   202     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   203     05  SQLWARN.
   204         10  SQLWARN0    PIC X.
   205         10  SQLWARN1    PIC X.
   206         10  SQLWARN2    PIC X.
   207         10  SQLWARN3    PIC X.
   208         10  SQLWARN4    PIC X.
   209         10  SQLWARN5    PIC X.
   210         10  SQLWARN6    PIC X.
   211         10  SQLWARN7    PIC X.
   212     05  SQLEXT.
   213         10  SQLWARN8    PIC X.
   214         10  SQLWARN9    PIC X.
   215         10  SQLWARN10   PIC X.
   216         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   217     05  SQLSTATE    PIC X(5).
   218
   219 77  ws-recs-out                 pic 9(7) value zeros.
   220 77  ws-recs-in                  pic 9(7) value zeros.
   221 77  eof-sw                      pic x value ' '.
   222     88  end-of-input               value 'Y'.
   223 77  ws-del-elencc               pic 9(5) value zeros.
   224 01  elencc-file-status          pic xx  value low-values.
   225 01  PGM-SUB                     PIC S999 COMP  VALUE +158.
   226 01  WS-ABEND-AREA.
   227     05  WS-ABEND-FILE-STATUS    PIC X(02).
   228     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
   229     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
   230     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
   231 01 f.
   232    05  ws-comp-cd.
   233        10  filler                   pic x  value low-values.
   234        10  ws-company-cd            pic x.
   235    05  ws-company-cd-num redefines ws-comp-cd
   236                                 pic s9(4) comp.
   237
   238 EXEC SQL
   239    BEGIN DECLARE SECTION
   240 END-EXEC
   241
   242 01  svr                         pic x(32).
   243 01  usr                         pic x(32).
   244 01  pass                        pic x(32).
   245 01  usr-pass                    pic x(64).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* SQLGETENC.cbl
   246 01  ws-disp-code                pic s9(11).
   247
   248 01  table-data.
   249     12  tb-flag                 PIC X.
   250     12  tb-group                PIC X.
   251     12  tb-ins-code             PIC X(10).
   252     12  tb-stack                PIC XXX.
   253     12  tb-encloser             PIC X(100).
   254     12  tb-attachments          PIC X(100).
   255     12  tb-id                   PIC XXX.
   256
   257 EXEC SQL
   258    END DECLARE SECTION
   259 END-EXEC
*  260                                 COPY ELCDTECX.
   261******************************************************************06/05/98
   262*                                                                *ELCDTECX
   263*                            ELCDTECX.                           *   LV005
   264*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   265*                            VMOD=2.015                          *ELCDTECX
   266*                                                                *ELCDTECX
   267*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   268*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   269*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   270*                                                                *ELCDTECX
   271******************************************************************ELCDTECX
   272******************************************************************
   273*                   C H A N G E   L O G
   274*
   275* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   276*-----------------------------------------------------------------
   277*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   278* EFFECTIVE    NUMBER
   279*-----------------------------------------------------------------
   280* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   281*                                  BENEFIT CODES FROM 300 TO 900
   282* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   283* 051304    2003080800002  SMVA  ADD REFUND METHOD
   284* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   285******************************************************************
   286 01  DATE-CARD.                                                   ELCDTECX
   287     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   288     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   289     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   290     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   291     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   292     12  EP-SW                       PIC  X.                      ELCDTECX
   293         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   294     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   295         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   296     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   297     12  RUN-CENTURY.                                             ELCDTECX
   298         16 RUN-CENTURY-N            PIC  99.                        CL**4
   299     12  FILLER                      PIC  X.                         CL**4
   300     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   301     12  FILLER                      PIC  XXX.                    ELCDTECX
   302     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   303                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   304 01  FILLER                          PIC  X(7)                       CL**6
   305                                          VALUE 'OPTIONS'.        ELCDTECX
   306 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   307     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   308     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   309     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   310         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   311         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   312     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   313     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   314     12  FILLER                      PIC  X.                      ELCDTECX
   315     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   316     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   317     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   318     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   319     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   320     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   321     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   322     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   323     12  FILLER                      PIC  X.                      ELCDTECX
   324     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   325     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   326     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   327     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   328     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   329     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   330     12  FILLER                      PIC  X.                      ELCDTECX
   331     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   332     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   333     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   334     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   335     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   336     12  DTE-R78                     PIC  X.                      ELCDTECX
   337     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   338     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   339     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   340     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   341     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   342     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   343     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   344                                     PIC  X.                      ELCDTECX
   345         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   346                                                 ' '.             ELCDTECX
   347         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   348         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   349     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   350         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   351         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   352     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   353     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   354                                     PIC  9.                         CL**4
   355     12  DTE-SYSTEM.                                              ELCDTECX
   356         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   357         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   358         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   359         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   360         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   361         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   362         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   363         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   364         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   365         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   366         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   367         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   368         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   369         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   370         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   371         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   372         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   373         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   374         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   375         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   376         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   377         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   378         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   379         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   380         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   381         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   382     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   383         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   384                                     PIC  X.                      ELCDTECX
   385     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   386                                                                  ELCDTECX
   387 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   388     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   389     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   390     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   391*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   392     12  FILLER                      PIC  X.                      ELCDTECX
   393     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   394     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   395     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   396     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   397     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   398     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   399     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   400                                                                  ELCDTECX
   401     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   402     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   403     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   404     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   405                                                                  ELCDTECX
   406     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   407     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   408     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   409     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   410                                                                  ELCDTECX
   411     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   412     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   413                                                                  ELCDTECX
   414     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   415     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   416                                                                  ELCDTECX
   417     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   418                                                                  ELCDTECX
   419 01  DATE-CARD-FACTORS.                                           ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   420     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   421     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   422     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   423     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   424     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   425     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   426     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   427                                                                  ELCDTECX
   428 01  FILLER                          PIC  X(12)                   ELCDTECX
   429                                          VALUE 'COMPANY NAME'.   ELCDTECX
   430 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   431     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   432         16  CNT-ID                  PIC  X.                      ELCDTECX
   433         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   434                                                                  ELCDTECX
   435 01  FILLER                          PIC  X(11)                   ELCDTECX
   436                                          VALUE 'STATE NAMES'.    ELCDTECX
   437 01  STATE-NAMES.                                                 ELCDTECX
   438     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   439         16  STATE-SUB               PIC  XX.                     ELCDTECX
   440         16  STATE-PIC1.                                          ELCDTECX
   441             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   442             20  FILLER              PIC  XXX.                    ELCDTECX
   443             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   444             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   445             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   446             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   447                                                                  ELCDTECX
   448 01  FILLER                          PIC  X(13)                   ELCDTECX
   449                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   450 01  CARRIER-NAMES.                                               ELCDTECX
   451     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   452         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   453         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   454         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   455         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   456         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   457         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   458*        16  FILLER                  PIC  X.                      ELCDTECX
   459         16  CARRIER-SEC-PAY         PIC  X.
   460             88  SEC-PAY-CARRIER          VALUE 'Y'.
   461                                                                  ELCDTECX
   462 01  FILLER                          PIC  X(9)                       CL**6
   463                                          VALUE 'INS TYPES'.      ELCDTECX
   464 01  CLAS-INS-TYPES.                                              ELCDTECX
   465*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   466     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   467         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   468         16  CLAS-I-AB3.                                          ELCDTECX
   469             20  FILLER              PIC  X.                      ELCDTECX
   470             20  CLAS-I-AB2.                                      ELCDTECX
   471                 24  FILLER          PIC  X.                      ELCDTECX
   472                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   473         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   474             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   475             20  FILLER              PIC  X.                         CL**4
   476         16  CLAS-I-AB10.                                         ELCDTECX
   477             20  FILLER              PIC  X(9).                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   478             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   479         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   480         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   481         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   482         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   483             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   484         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   485         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   486         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   487         16  CLAS-I-BEN-CATEGORY     PIC  X.
   488         16  CLAS-I-REFUND-METHOD    PIC  X.
   489         16  CLAS-I-MAX-BENEFITS     PIC 99.
   490         16  FILLER                  PIC  XXX.
   491                                                                  ELCDTECX
   492 01  FILLER                          PIC  X(16)                   ELCDTECX
   493                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   494 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   495     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   496                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   497         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   498         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   499         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   500         16  CLAS-MORT-DESC.                                      ELCDTECX
   501             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   502             20  FILLER              PIC  XX.                        CL**5
   503             20  CLAS-YEAR           PIC  X(4).                      CL**6
   504             20  FILLER              PIC  X.                         CL**5
   505             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   506             20  FILLER              PIC  X.                         CL**5
   507             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   508             20  FILLER              PIC  X.                         CL**5
   509             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   510             20  FILLER              PIC  X(5).                      CL**6
   511                                                                  ELCDTECX
   512 01  FILLER                          PIC  X(15)                   ELCDTECX
   513                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   514 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   515     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   516         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   517         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   518         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   519         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   520         16  FILLER                  PIC  X(4).                      CL**6
   521                                                                  ELCDTECX
   522 01  FILLER                          PIC  X(7)                       CL**6
   523                                     VALUE 'INDEXES'.             ELCDTECX
   524 01  CLAS-INDEX-TBL.                                              ELCDTECX
   525     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   526     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   527     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   528     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   529     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   530     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   531     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   532     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   533     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   534     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   535     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   536     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   537     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   538     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   539     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   540     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   541     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   542                                                                  ELCDTECX
   543 01  CLAS-TYPE-MISC.                                              ELCDTECX
   544     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   545     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   546     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   547     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   548     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   549     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   550     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   551     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   552     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   553     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   554     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   555                                                                  ELCDTECX
   556 01  FILLER                          PIC  X(13)                   ELCDTECX
   557                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   558 01  CLAS-MISC.                                                   ELCDTECX
   559     12  DTE-FICH                    PIC  X.                      ELCDTECX
   560         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   561         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   562         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   563     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   564     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   565     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   566     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   567     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   568     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   569     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   570     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   571     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   572     12  STATE-L                     PIC  XX.                     ELCDTECX
   573     12  CLAS-CN                     PIC  99.                     ELCDTECX
   574     12  CLAS-CO                     PIC  99.                     ELCDTECX
   575     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   576         16  DTE-F-1                 PIC  X.                      ELCDTECX
   577         16  DTE-F-2                 PIC  X.                      ELCDTECX
   578     12  DTE-ABEND-WORK.                                          ELCDTECX
   579         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   580         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   581                                                                  ELCDTECX
   582 01  FILLER                          PIC  X(12)                   ELCDTECX
   583                                     VALUE 'WORKING DATE'.        ELCDTECX
   584 01  WS-DATE-AND-TIME.                                            ELCDTECX
   585     12  WS-ACCEPT-DATE.                                          ELCDTECX
   586         16  WS-AD-YY                PIC  99.                     ELCDTECX
   587         16  WS-AD-MM                PIC  99.                     ELCDTECX
   588         16  WS-AD-DD                PIC  99.                     ELCDTECX
   589     12  WS-CURRENT-DATE.                                         ELCDTECX
   590         16  WS-CD-MM                PIC  99.                     ELCDTECX
   591         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   592         16  WS-CD-DD                PIC  99.                     ELCDTECX
   593         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   594         16  WS-CD-YY                PIC  99.                     ELCDTECX
   595     12  WS-TIME-OF-DAY.                                          ELCDTECX
   596         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   597         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   598                                                                  ELCDTECX
   599 01  FILLER                          PIC  X(12)                   ELCDTECX
   600                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   601 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   602     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   603         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   604         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   605         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   606                                                                  ELCDTECX
   607 01  FILLER                          PIC  X(10)                   ELCDTECX
   608                                     VALUE 'STATE TLRS'.          ELCDTECX
   609 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   610     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   611         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   612         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   613                                                                  ELCDTECX
   614 01  FILLER                          PIC  X(13)                   ELCDTECX
   615                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   616 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   617     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   618         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   619                                                                  ELCDTECX
   620 01  FILLER                          PIC  X(13)                   ELCDTECX
   621                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   622 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   623     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   624     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   625     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   626                                     PIC  X.                         CL**5
   627     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   628     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   629     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   630     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   631     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   632     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   633     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   634     12  FILLER                      PIC  X(75).                  ELCDTECX
   635******************************************************************ELCDTECX
   636*01  MISC-CARR-PCT-DATA.                                          00001521
   637*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   638*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   639*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   640*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   641*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   642*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   643******************************************************************ELCDTECX
*  644                                 COPY ELCDTEVR.
   645***************************************************************** 04/15/98
   646*                                                                *ELCDTEVR
   647*                                                                *ELCDTEVR
   648*                            ELCDTEVR.                           *   LV003
   649*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   650*                            VMOD=2.001                          *   CL**2
   651*                                                                *ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   652*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   653*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   654*                                                                *ELCDTEVR
   655******************************************************************ELCDTEVR
   656 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   657     05  WS-RUN-DATE.                                             ELCDTEVR
   658         10  FILLER                  PIC  9(03).                  ELCDTEVR
   659         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   660         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   661             15  RUN-CC              PIC  99.                     ELCDTEVR
   662             15  RUN-YR              PIC  99.                     ELCDTEVR
   663         10  RUN-MO                  PIC  99.                     ELCDTEVR
   664         10  RUN-DA                  PIC  99.                     ELCDTEVR
   665     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   666            WS-RUN-DATE              PIC 9(11).                      CL**2
   667     05  WS-EP-DT.                                                ELCDTEVR
   668         10  FILLER                  PIC  9(03).                  ELCDTEVR
   669         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   670         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   671             15  EP-CC               PIC  99.                     ELCDTEVR
   672             15  EP-YR               PIC  99.                     ELCDTEVR
   673         10  EP-MO                   PIC  99.                     ELCDTEVR
   674         10  EP-DA                   PIC  99.                     ELCDTEVR
   675     05  WS-EP-DT-N REDEFINES                                        CL**2
   676            WS-EP-DT                 PIC 9(11).                      CL**2
   677     05  WS-DTE-CONV-DT.                                             CL**4
   678         10  FILLER                  PIC  9(03).                     CL**4
   679         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   680         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   681             15  DTE-CONV-CC         PIC  99.                        CL**4
   682             15  DTE-CONV-YR         PIC  99.                        CL**4
   683         10  DTE-CONV-MO             PIC  99.                        CL**4
   684         10  DTE-CONV-DA             PIC  99.                        CL**4
   685     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   686            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   687 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   688     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   689         10  FILLER                            PIC 999.           ELCDTEVR
   690         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   691         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   692             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   693             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   694         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   695         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   696     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   697            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   698     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   699         10  FILLER                            PIC 999.           ELCDTEVR
   700         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   701         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   702         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   703         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   704     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   705            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   706 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   707     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   708         10  FILLER                            PIC 999.           ELCDTEVR
   709         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   710         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   711             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   712             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   713         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   714         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   715     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   716            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   717     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   718         10  FILLER                            PIC 999.           ELCDTEVR
   719         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   720         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   721             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   722             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   723         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   724         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   725     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   726            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   727     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   728         10  FILLER                            PIC 999.           ELCDTEVR
   729         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   730         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   731             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   732             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   733         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   734         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   735     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   736            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   737 01  WS-RATE-RECORD.                                              ELCDTEVR
   738         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   739             10  FILLER                        PIC 999.           ELCDTEVR
   740             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   741             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   742                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   743                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   744             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   745             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   746         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   747                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
   748
   749 PROCEDURE DIVISION.
*  750                                 COPY ELCDTERX.
   751******************************************************************04/15/98
   752*                                                                *ELCDTERX
   753*                                                                *ELCDTERX
   754*                            ELCDTERX.                           *   LV002
   755*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   756*                            VMOD=2.007                          *ELCDTERX
   757*                                                                *ELCDTERX
   758*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
   759*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
   760*      = ELCDTEFD)                                               *ELCDTERX
   761*                                                                *ELCDTERX
   762******************************************************************ELCDTERX
   763                                                                  ELCDTERX
   764     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
   765                                                                  ELCDTERX
   766     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
   767     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   768     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
   769                                                                  ELCDTERX
   770     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
   771                                                                  ELCDTERX
   772******************************************************************ELCDTERX
   773*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
   774*          WARNING MESSAGES.                                      ELCDTERX
   775******************************************************************ELCDTERX
   776     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
   777         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
   778                                                                  ELCDTERX
   779     OPEN INPUT DISK-DATE.                                        ELCDTERX
   780                                                                  ELCDTERX
   781     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
   782                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
   783                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
   784                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
   785                   CLAX-ID           CLAS-MISC                    ELCDTERX
   786                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
   787                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
   788                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
   789                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
   790                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
   791                                                                  ELCDTERX
   792     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
   793                                                                  ELCDTERX
   794     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
   795                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
   796                                                                  ELCDTERX
   797     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
   798     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
   799     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
   800     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
   801                                                                  ELCDTERX
   802     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
   803         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
   804     ELSE                                                         ELCDTERX
   805         ADD +1                 TO CLAS-CN.                       ELCDTERX
   806                                                                  ELCDTERX
   807     IF CLAS-INDEXON = ZERO                                       ELCDTERX
   808         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
   809     ELSE                                                         ELCDTERX
   810         ADD +1                 TO CLAS-CO.                       ELCDTERX
   811                                                                  ELCDTERX
   812 0005-READ--CARD.                                                 ELCDTERX
   813     READ DISK-DATE                                               ELCDTERX
   814         AT END CLOSE DISK-DATE                                   ELCDTERX
   815             GO TO 0060-READ--TEST.                               ELCDTERX
   816                                                                  ELCDTERX
   817     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
   818                                                                  ELCDTERX
   819     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
   820         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
   821         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
   822         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
   823         GO TO 0005-READ--CARD.                                   ELCDTERX
   824                                                                  ELCDTERX
   825     IF DD-ID = 'CLAD'                                            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   826         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
   827         GO TO 0005-READ--CARD.                                   ELCDTERX
   828                                                                  ELCDTERX
   829     IF DD-ID = 'CLAX'                                            ELCDTERX
   830         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
   831         GO TO 0005-READ--CARD.                                   ELCDTERX
   832                                                                  ELCDTERX
   833     IF DD-ID = 'CLAF'                                            ELCDTERX
   834         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
   835         GO TO 0005-READ--CARD.                                   ELCDTERX
   836                                                                  ELCDTERX
   837     IF DD-ID = 'CLAC'                                            ELCDTERX
   838         GO TO 0010-READ--CLAC.                                   ELCDTERX
   839                                                                  ELCDTERX
   840     IF DD-ID = 'CARR'                                            ELCDTERX
   841         GO TO 0015-READ--CARR.                                   ELCDTERX
   842                                                                  ELCDTERX
   843     IF DD-ID = 'STAT'                                            ELCDTERX
   844         GO TO 0020-READ--STAT.                                   ELCDTERX
   845                                                                  ELCDTERX
   846     IF DD-ID = 'BUSC'                                            ELCDTERX
   847         GO TO 0025-READ--BUSC.                                   ELCDTERX
   848                                                                  ELCDTERX
   849     IF DD-ID = 'MORT'                                            ELCDTERX
   850         GO TO 0030-READ--MORT.                                   ELCDTERX
   851                                                                  ELCDTERX
   852     IF DD-ID = 'CLAI'                                            ELCDTERX
   853         GO TO 0040-READ--CLAI.                                   ELCDTERX
   854                                                                  ELCDTERX
   855     IF DD-ID = 'COLC'                                            ELCDTERX
   856         GO TO 0065-READ--COLC.                                   ELCDTERX
   857                                                                  ELCDTERX
   858     IF DD-IDX NUMERIC AND                                        ELCDTERX
   859        DD-IDA = 'CL'                                             ELCDTERX
   860         GO TO 0035-READ--CLXX.                                   ELCDTERX
   861                                                                  ELCDTERX
   862     IF DD-IDX NUMERIC AND                                        ELCDTERX
   863        DD-IDA = 'PO'                                             ELCDTERX
   864         GO TO 0050-READ--POXX.                                   ELCDTERX
   865                                                                  ELCDTERX
   866     IF DD-ID = 'OPCA'                                            ELCDTERX
   867         GO TO 0070-READ--OPCA.                                   ELCDTERX
   868                                                                  ELCDTERX
   869     IF DD-ID = 'OPST'                                            ELCDTERX
   870         GO TO 0072-READ--OPST.                                   ELCDTERX
   871                                                                  ELCDTERX
   872     IF DD-ID = 'OPBS'                                            ELCDTERX
   873         GO TO 0074-READ--OPBS.                                   ELCDTERX
   874                                                                  ELCDTERX
   875     IF DD-ID = 'OPMS'                                            ELCDTERX
   876         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
   877                                                                  ELCDTERX
   878     GO TO 0005-READ--CARD.                                       ELCDTERX
   879                                                                  ELCDTERX
   880 0010-READ--CLAC.                                                 ELCDTERX
   881     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
   882     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
   883     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   884     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
   885     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
   886     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
   887     GO TO 0005-READ--CARD.                                       ELCDTERX
   888                                                                  ELCDTERX
   889 0015-READ--CARR.                                                 ELCDTERX
   890     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
   891     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
   892        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
   893        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
   894        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
   895        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
   896        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
   897        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
   898        MOVE DD-CARR1-SECPAY-SW
   899                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
   900     END-IF
   901                                                                  ELCDTERX
   902     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
   903     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
   904        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
   905        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
   906        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
   907        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
   908        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
   909        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
   910        MOVE DD-CARR2-SECPAY-SW
   911                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
   912     END-IF
   913                                                                  ELCDTERX
   914                                                                  ELCDTERX
   915     GO TO 0005-READ--CARD.                                       ELCDTERX
   916                                                                  ELCDTERX
   917 0020-READ--STAT.                                                 ELCDTERX
   918     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   919     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
   920        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
   921         GO TO 0005-READ--CARD.                                   ELCDTERX
   922                                                                  ELCDTERX
   923     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
   924     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
   925     GO TO 0020-READ--STAT.                                       ELCDTERX
   926                                                                  ELCDTERX
   927 0025-READ--BUSC.                                                 ELCDTERX
   928     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   929     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
   930        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
   931         GO TO 0005-READ--CARD.                                   ELCDTERX
   932                                                                  ELCDTERX
   933     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
   934     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
   935     GO TO 0025-READ--BUSC.                                       ELCDTERX
   936                                                                  ELCDTERX
   937 0030-READ--MORT.                                                 ELCDTERX
   938     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   939     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
   940        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
   941         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   942                                                                  ELCDTERX
   943     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
   944     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
   945     GO TO 0030-READ--MORT.                                       ELCDTERX
   946                                                                  ELCDTERX
   947 0035-READ--CLXX.                                                 ELCDTERX
   948     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
   949          GO TO 0005-READ--CARD.                                  ELCDTERX
   950                                                                  ELCDTERX
   951     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
   952         DISPLAY '***********************************************'ELCDTERX
   953         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
   954         DISPLAY '***********************************************'ELCDTERX
   955         GO TO 0055-READ--STOP.                                   ELCDTERX
   956                                                                  ELCDTERX
   957     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
   958        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
   959         MOVE '1'                TO DTE-FICH.                     ELCDTERX
   960                                                                  ELCDTERX
   961     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
   962        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
   963         MOVE '2'                TO DTE-FICH.                     ELCDTERX
   964                                                                  ELCDTERX
   965*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
   966     GO TO 0005-READ--CARD.                                       ELCDTERX
   967                                                                  ELCDTERX
   968 0040-READ--CLAI.                                                 ELCDTERX
   969     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   970     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
   971        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
   972         GO TO 0005-READ--CARD.                                   ELCDTERX
   973                                                                  ELCDTERX
   974     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
   975     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
   976     GO TO 0040-READ--CLAI.                                       ELCDTERX
   977                                                                  ELCDTERX
   978 0045-READ--DUMP.                                                 ELCDTERX
   979     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
   980     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
   981                                 TO  WS-ABEND-MESSAGE             ELCDTERX
   982     PERFORM ABEND-PGM.                                           ELCDTERX
   983                                                                  ELCDTERX
   984 0050-READ--POXX.                                                 ELCDTERX
   985     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
   986         GO TO 0005-READ--CARD.                                   ELCDTERX
   987                                                                  ELCDTERX
   988     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
   989         DISPLAY '***********************************************'ELCDTERX
   990         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
   991         DISPLAY '***********************************************'ELCDTERX
   992         GO TO 0055-READ--STOP.                                   ELCDTERX
   993                                                                  ELCDTERX
   994     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
   995     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
   996     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
   997     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
   998                                                                  ELCDTERX
   999     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1000         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1001     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1002         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1003                                                                  ELCDTERX
  1004     GO TO 0005-READ--CARD.                                       ELCDTERX
  1005                                                                  ELCDTERX
  1006 0055-READ--STOP.                                                 ELCDTERX
  1007     GOBACK.                                                      ELCDTERX
  1008                                                                  ELCDTERX
  1009 0060-READ--TEST.                                                 ELCDTERX
  1010     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1011        CLAX-ID         = SPACE  OR                               ELCDTERX
  1012        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1013         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1014                                                                  ELCDTERX
  1015     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1016     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1017                                                                  ELCDTERX
  1018 0065-READ--COLC.                                                 ELCDTERX
  1019     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1020     GO TO 0005-READ--CARD.                                       ELCDTERX
  1021                                                                  ELCDTERX
  1022 0070-READ--OPCA.                                                 ELCDTERX
  1023                                                                  ELCDTERX
  1024     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1025                                                                  ELCDTERX
  1026     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1027             OR                                                   ELCDTERX
  1028         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1029         GO TO 0005-READ--CARD.                                   ELCDTERX
  1030                                                                  ELCDTERX
  1031     ADD 1                       TO INDEXCA.                      ELCDTERX
  1032     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1033                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1034     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1035                                                                  ELCDTERX
  1036 0072-READ--OPST.                                                 ELCDTERX
  1037                                                                  ELCDTERX
  1038     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1039                                                                  ELCDTERX
  1040     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1041             OR                                                   ELCDTERX
  1042         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1043         GO TO 0005-READ--CARD.                                   ELCDTERX
  1044                                                                  ELCDTERX
  1045     ADD 1                       TO INDEXST.                      ELCDTERX
  1046     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1047                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1048     GO TO 0072-READ--OPST.                                       ELCDTERX
  1049                                                                  ELCDTERX
  1050 0074-READ--OPBS.                                                 ELCDTERX
  1051                                                                  ELCDTERX
  1052     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1053                                                                  ELCDTERX
  1054     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1055             OR                                                   ELCDTERX
  1056         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1057         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* SQLGETENC.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1058                                                                  ELCDTERX
  1059     ADD 1                       TO INDEXBS.                      ELCDTERX
  1060     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1061     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1062                                                                  ELCDTERX
  1063 0079-READ--EXIT.                                                 ELCDTERX
  1064*    EXIT.                                                        ELCDTERX
  1065******************************************************************ELCDTERX
  1066
  1067 0000-begin.
  1068
  1069     display ' Begin Program '
  1070     perform 0010-init           thru 0010-exit
  1071     perform 0020-connect        thru 0020-exit
  1072
  1073     EXEC SQL
  1074        SET AUTOCOMMIT OFF
  1075     END-EXEC
  1076
  1077     perform 0025-open-files     thru 0025-exit
  1078     perform 0026-zap-elencc     thru 0026-exit
  1079     perform 0030-open-cursor    thru 0030-exit
  1080     perform 0040-process-input  thru 0040-exit until
  1081        end-of-input
  1082*      or ws-recs-in > 10000
  1083
  1084     perform 0060-finish-up      thru 0060-exit
  1085     display ' End Program '
  1086     display ' elencc recs deleted ' ws-del-elencc
  1087     display ' records inserted    ' ws-recs-out
  1088     display ' table records read  ' ws-recs-in
  1089     goback
  1090
  1091     .
  1092 0010-init.
  1093
  1094     move 'NTCSO2_Logic'         to svr
  1095     move 'sa'                   to usr
  1096     move 'ntcso2'               to pass
  1097
  1098*    move 'NTCSO2TST_Logic'      to svr
  1099*    move 'sa'                   to usr
  1100*    move 'ntcso2'               to pass
  1101
  1102*    move 'NTSQLTST2'            to svr
  1103*    move 'sa'                   to usr
  1104*    move 'sql2008r2'            to pass
  1105
  1106     .
  1107 0010-exit.
  1108     exit.
  1109
  1110 0020-connect.
  1111
  1112     display 'Begin connect to DB '
  1113     string
  1114         usr delimited space
  1115         "." delimited size
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* SQLGETENC.cbl
  1116         pass delimited space into usr-pass
  1117     end-string
  1118
  1119*    display ' svr usr pass ' svr ' ' usr-pass
  1120
  1121     EXEC SQL
  1122        CONNECT TO :svr USER :usr-pass
  1123     END-EXEC
  1124
  1125     if sqlcode not = 0
  1126        display "Error: cannot connect "
  1127        display sqlcode
  1128        display sqlerrmc
  1129        perform abend-pgm
  1130     end-if
  1131
  1132     display " connect to DB successful "
  1133
  1134     .
  1135 0020-exit.
  1136     exit.
  1137
  1138 0025-open-files.
  1139
  1140     open i-o ELENCC
  1141     if elencc-file-status not = '00'
  1142        display ' error-elencc-open ' elencc-file-status
  1143        perform abend-pgm
  1144     end-if
  1145
  1146     .
  1147 0025-exit.
  1148     exit.
  1149
  1150 0026-zap-elencc.
  1151
  1152     move dte-clasic-company-cd  to ws-company-cd
  1153     display ' processing company ' DTE-CLIENT ' '
  1154        ws-company-cd-num
  1155     move low-values             TO nc-CONTROL-PRIMARY
  1156     move dte-clasic-company-cd  to nc-company-cd
  1157     START ELencc KEY >= nc-CONTROL-PRIMARY
  1158     IF ELencc-FILE-STATUS = '00'
  1159        PERFORM UNTIL ELencc-FILE-STATUS NOT = '00'
  1160           READ ELencc NEXT RECORD
  1161           IF Elencc-FILE-STATUS = '00'
  1162              if nc-company-cd = dte-clasic-company-cd
  1163*                display ' about to delete '
  1164*                   nc-control-primary (2:6)
  1165                 delete elencc
  1166                 if elencc-file-status = '00'
  1167                    add 1 to ws-del-elencc
  1168                 else
  1169                    display ' error-elencc-delete '
  1170                    elencc-file-status
  1171                    ' ' nc-control-primary (2:15)
  1172                 end-if
  1173              end-if
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* SQLGETENC.cbl
  1174           end-if
  1175        end-perform
  1176     end-if
  1177
  1178     .
  1179 0026-exit.
  1180     exit.
  1181
  1182 0030-open-cursor.
  1183
  1184     display ' declare cursor '
  1185
  1186     evaluate true
  1187        when dte-client = 'CID'
  1188           EXEC SQL
  1189              declare cidcodes cursor for
  1190                 select * from NaperProdInsertionCodes_CPS
  1191           END-EXEC
  1192        when dte-client = 'DCC'
  1193           EXEC SQL
  1194              declare dcccodes cursor for
  1195                 select * from NaperProdInsertionCodes_DCC
  1196           END-EXEC
  1197        when dte-client = 'AHL'
  1198           EXEC SQL
  1199              declare ahlcodes cursor for
  1200                 select * from NaperProdInsertionCodes_AHL
  1201           END-EXEC
  1202     end-evaluate
  1203
  1204     if sqlcode not = 0
  1205        display "Error: cannot declare cursor "
  1206        display ' sql retrun code ' sqlcode
  1207        display ' sql err mess    ' sqlerrmc
  1208        perform abend-pgm
  1209     end-if
  1210
  1211     display ' open cursor '
  1212
  1213     evaluate true
  1214        when dte-client = 'CID'
  1215           EXEC SQL
  1216               open cidcodes
  1217           END-EXEC
  1218        when dte-client = 'DCC'
  1219           EXEC SQL
  1220               open dcccodes
  1221           END-EXEC
  1222        when dte-client = 'AHL'
  1223           EXEC SQL
  1224               open ahlcodes
  1225           END-EXEC
  1226     end-evaluate
  1227
  1228     if sqlcode not = 0
  1229        display "Error: cannot open cursor "
  1230        display ' sql retrun code ' sqlcode
  1231        display ' sql err mess    ' sqlerrmc
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* SQLGETENC.cbl
  1232        perform abend-pgm
  1233     end-if
  1234
  1235     .
  1236 0030-exit.
  1237     exit.
  1238
  1239 0040-process-input.
  1240
  1241     perform until sqlcode not = 0
  1242      evaluate true
  1243        when dte-client = 'CID'
  1244         EXEC SQL
  1245           fetch cidcodes into :tb-flag,
  1246                               :tb-group,
  1247                               :tb-ins-code,
  1248                               :tb-stack,
  1249                               :tb-encloser,
  1250                               :tb-attachments,
  1251                               :tb-id
  1252         END-EXEC
  1253        when dte-client = 'DCC'
  1254         EXEC SQL
  1255           fetch dcccodes into :tb-flag,
  1256                               :tb-group,
  1257                               :tb-ins-code,
  1258                               :tb-stack,
  1259                               :tb-encloser,
  1260                               :tb-attachments,
  1261                               :tb-id
  1262         END-EXEC
  1263        when dte-client = 'AHL'
  1264         EXEC SQL
  1265           fetch ahlcodes into :tb-flag,
  1266                               :tb-group,
  1267                               :tb-ins-code,
  1268                               :tb-stack,
  1269                               :tb-encloser,
  1270                               :tb-attachments,
  1271                               :tb-id
  1272         END-EXEC
  1273      end-evaluate
  1274      if sqlcode not = 0 and 100
  1275           display "Error: cannot read row "
  1276           display ' sql retrun code ' sqlcode
  1277           display ' sql err mess    ' sqlerrmc
  1278           goback
  1279      end-if
  1280      if sqlcode = 0
  1281         add 1                 to ws-recs-in
  1282         perform 0045-create-rec
  1283                                 thru 0045-exit
  1284      end-if
  1285     end-perform
  1286
  1287     if sqlcode = 100
  1288        display ' Normal end of record set '
  1289        display ' number of records        ' ws-recs-in
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* SQLGETENC.cbl
  1290     end-if
  1291
  1292     set end-of-input            to true
  1293
  1294     evaluate true
  1295        when dte-client = 'CID'
  1296           EXEC SQL
  1297               close cidcodes
  1298           END-EXEC
  1299        when dte-client = 'DCC'
  1300           EXEC SQL
  1301               close dcccodes
  1302           END-EXEC
  1303        when dte-client = 'AHL'
  1304           EXEC SQL
  1305               close ahlcodes
  1306           END-EXEC
  1307     end-evaluate
  1308
  1309     if sqlcode not = 0
  1310        display "Error: cannot close cursor "
  1311        display ' sql retrun code ' sqlcode
  1312        display ' sql err mess    ' sqlerrmc
  1313        goback
  1314     end-if
  1315
  1316     .
  1317 0040-exit.
  1318     exit.
  1319
  1320 0045-create-rec.
  1321
  1322*    display tb-group ' ' tb-ins-code ' ' tb-stack
  1323*    go to 0045-exit
  1324     MOVE 'NC'                   TO ENCLOSURE-CODES
  1325     MOVE DTE-CLASIC-COMPANY-CD  TO NC-COMPANY-CD
  1326     MOVE tb-group               TO NC-REC-TYPE
  1327     MOVE FUNCTION UPPER-CASE(tb-ins-code)
  1328                                 TO NC-ENC-CODE
  1329     MOVE tb-stack               TO NC-OUTPUT-STACK
  1330     MOVE tb-encloser            TO NC-ENCLOSURE-LINE
  1331     MOVE tb-attachments         TO NC-ATTACHMENTS
  1332
  1333     MOVE 'AUTO'                 TO NC-LAST-MAINT-USER
  1334     MOVE +180000                TO NC-LAST-MAINT-HHMMSS
  1335     MOVE bin-run-date           TO NC-LAST-MAINT-DT
  1336
  1337     PERFORM 0050-WRITE-ELENCC   THRU 0050-EXIT
  1338
  1339     .
  1340 0045-EXIT.
  1341     EXIT.
  1342
  1343 0050-WRITE-ELENCC.
  1344
  1345     WRITE ENCLOSURE-CODES
  1346
  1347     IF ELENCC-FILE-STATUS  = '00'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* SQLGETENC.cbl
  1348        ADD 1                    TO WS-recs-OUT
  1349     ELSE
  1350        DISPLAY ' BAD WRITE FOR ELENCC ' ELENCC-FILE-STATUS
  1351        PERFORM ABEND-PGM
  1352     END-IF
  1353
  1354     .
  1355 0050-EXIT.
  1356     EXIT.
  1357
  1358 0060-finish-up.
  1359
  1360     display ' Begin Disconnect '
  1361     EXEC SQL
  1362         commit work release
  1363     END-EXEC
  1364     if sqlcode not = 0
  1365        display "Error: commit release "
  1366        display ' sql return code ' sqlcode
  1367        display ' sql err mess    ' sqlerrmc
  1368     end-if
  1369
  1370     close elencc
  1371     if elencc-file-status not = '00'
  1372        display ' error-elencc-close ' elencc-file-status
  1373     end-if
  1374
  1375     .
  1376 0060-exit.
  1377     exit.
  1378
  1379 abend-pgm.
  1380
  1381     call 'ABORTME'
  1382     goback.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      113656     Code:        9719
