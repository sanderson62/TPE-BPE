* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page   1
* FNB169.cbl
* Options: int("FNB169.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB169.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB169.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB169.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    FNB169.
     3
     4******************************************************************
     5*                                                                *
     6*            FREEDOM INTERFACE FOR DCC CONTRACT FEES             *
     7*                                                                *
     8******************************************************************
     9*                   C H A N G E   L O G
    10*
    11* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    12*-----------------------------------------------------------------
    13*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page   2
* FNB169.cbl
    14* EFFECTIVE    NUMBER
    15*-----------------------------------------------------------------
    16* 050704    2003080800002  SMVA  NEW PROGRAM FOR SECURE PAY
    17* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
    18* 021009  IR2009020900001  PEMA  ADD AGT TYPE J AS INCENTIVE
    19* 022009    2008050500001  AJRA  ADD PROCESSING FOR CCC
    20* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    21* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    22* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    23* 080212  IR2012080100002  PEMA  CORRECT AGT TYPE N
    24* 082912  IR2012080700001  PEMA  CORRECT REF ADMIN FEE
    25* 080612  IR2013080500001  PEMA  CORRECT REF CSO ADMIN FEE
    26* 100413  IR2013100100001  PEMA  INCREASE PDEF OCCURS
    27******************************************************************
    28
    29 ENVIRONMENT DIVISION.
    30 INPUT-OUTPUT SECTION.
    31 FILE-CONTROL.
    32
    33     SELECT DETEXTR              ASSIGN TO SYS010
    34                                 FILE STATUS IS DETEXT-STATUS.
    35     SELECT FREEDOM-EXTRACT      ASSIGN TO SYS011
    36                                 ORGANIZATION IS LINE SEQUENTIAL.
    37
    38     SELECT CSI-FREEDOM-EXTRACT  ASSIGN TO SYS012
    39                                 ORGANIZATION IS LINE SEQUENTIAL.
    40
    41     SELECT CCC-FREEDOM-EXTRACT  ASSIGN TO SYS013
    42                                 ORGANIZATION IS LINE SEQUENTIAL.
    43
    44     SELECT ERACCT               ASSIGN TO ERACCT
    45                                 ORGANIZATION IS INDEXED
    46                                 ACCESS IS DYNAMIC
    47                                 RECORD KEY IS AM-CONTROL-PRIMARY
    48                                 FILE STATUS IS ERACCT-STATUS.
    49
    50     SELECT ERPDEF           ASSIGN TO ERPDEF
    51                             ACCESS IS DYNAMIC
    52                             ORGANIZATION IS INDEXED
    53                             FILE STATUS IS ERPDEF-FILE-STATUS
    54                             RECORD KEY IS PD-CONTROL-PRIMARY.
    55
    56     SELECT DISK-DATE            ASSIGN TO SYS019.
    57
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page   3
* FNB169.cbl
    59 DATA DIVISION.
    60 FILE SECTION.
    61
    62 FD  DETEXTR
    63     LABEL RECORDS ARE STANDARD
    64     RECORDING MODE IS F
    65     RECORD CONTAINS 510 CHARACTERS
    66     BLOCK CONTAINS 0 RECORDS.
*   67     COPY ECSEXT01.
    68******************************************************************04/29/98
    69*                                                                *ECSEXT01
    70*                            ECSEXT01                            *   LV015
    71*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
    72*                            VMOD=2.015                          *ECSEXT01
    73*                                                                *ECSEXT01
    74*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
    75*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
    76*                                                                *ECSEXT01
    77*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
    78*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
    79*                                                                *ECSEXT01
    80*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
    81*                                                                *ECSEXT01
    82******************************************************************ECSEXT01
    83******************************************************************
    84*                   C H A N G E   L O G
    85*
    86* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    87*-----------------------------------------------------------------
    88*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    89* EFFECTIVE    NUMBER
    90*-----------------------------------------------------------------
    91* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    92* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
    93* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    94* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
    95* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    96* 032612  CR2011110200001  PEMA  AHL CHANGES
    97******************************************************************
    98                                                                  ECSEXT01
    99 01  DETAIL-EXTRACT.                                              ECSEXT01
   100     02 DETAIL-FILE.                                              ECSEXT01
   101     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
   102         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
   103                                                                  ECSEXT01
   104     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
   105                                                                  ECSEXT01
   106     12  DE-REIN                           PIC X.                 ECSEXT01
   107                                                                  ECSEXT01
   108     12  DE-CONTROL.                                              ECSEXT01
   109         16  DE-CNTRL1.                                           ECSEXT01
   110             20  DE-CARRIER                PIC X.                 ECSEXT01
   111             20  DE-GROUPING.                                     ECSEXT01
   112                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
   113                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
   114             20  DE-STATE                  PIC XX.                ECSEXT01
   115             20  DE-ACCOUNT.                                      ECSEXT01
   116                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page   4
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   117                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
   118         16  DE-CNTRL2.                                           ECSEXT01
   119             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
   120             20  DE-CERT.                                         ECSEXT01
   121                 24 DE-CERT-NO.                                   ECSEXT01
   122                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
   123                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
   124                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
   125                                                                  ECSEXT01
   126     12  DE-TRANS                          PIC X.                 ECSEXT01
   127         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
   128         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
   129         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
   130         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
   131         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
   132         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
   133         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
   134         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
   135         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
   136         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
   137                                                                  ECSEXT01
   138     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
   139     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
   140                                                                  ECSEXT01
   141     12  DE-NAME.                                                 ECSEXT01
   142         16  DE-LNAME                      PIC X(15).             ECSEXT01
   143         16  DE-FNAME.                                            ECSEXT01
   144             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
   145             20  FILLER                    PIC X(9).              ECSEXT01
   146         16  DE-INIT                       PIC X.                 ECSEXT01
   147     12  DE-AGE                            PIC 99.                ECSEXT01
   148     12  DE-SEX                            PIC X.                 ECSEXT01
   149     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
   150                                                                  ECSEXT01
   151     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
   152     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
   153     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
   154     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
   155     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   156     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
   157     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
   158     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
   159     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   160                                                                  ECSEXT01
   161     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
   162     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
   163     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
   164     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
   165                                                                  ECSEXT01
   166     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
   167     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
   168     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
   169     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   170     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   171                                                                  ECSEXT01
   172     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
   173     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
   174     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page   5
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   175     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
   176                                                                  ECSEXT01
   177     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
   178     12  DE-ADDL-CLP REDEFINES DE-LIVES
   179                                           PIC S9(5)V99   COMP-3.
   180     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
   181     12  FILLER REDEFINES DE-NUM-BILLED.
   182         16  DE-CLP-STATE                  PIC XX.
   183         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
   184     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
   185     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
   186                                                                  ECSEXT01
   187     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
   188     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
   189     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
   190     12  DE-IG                             PIC X.                 ECSEXT01
   191     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
   192*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
   193     12  DE-MEMBER-NO.                                            ECSEXT01
   194         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
   195         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
   196         16  FILLER                        PIC X(03).             ECSEXT01
   197     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
   198                                                                  ECSEXT01
   199     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
   200         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
   201                                                                  ECSEXT01
   202     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
   203     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
   204                                                                  ECSEXT01
   205     12  DE-REI-AREA.                                             ECSEXT01
   206         16  DE-REI-COMP.                                         ECSEXT01
   207             20  DE-REINCO                 PIC XXX.               ECSEXT01
   208             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
   209         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   210         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   211         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   212         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
   213         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   214         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   215         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   216                                                                  ECSEXT01
   217     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   218     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
   219         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
   220         16  F                             PIC X.
   221*    12  FILLER                            PIC X(5).              ECSEXT01
   222                                                                  ECSEXT01
   223     12  DE-BILLED-AREA.                                          ECSEXT01
   224         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
   225             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
   226                                                                  ECSEXT01
   227         16  DE-BILL-SW                    PIC X.                 ECSEXT01
   228             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
   229             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
   230             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
   231             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
   232             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page   6
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   233             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
   234                                                                  ECSEXT01
   235         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
   236             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
   237                                                                  ECSEXT01
   238         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   239         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   240         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   241         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   242                                                                  ECSEXT01
   243         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
   244*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
   245*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
   246                                                                  ECSEXT01
   247     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
   248         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
   249         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
   250         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
   251                                                                  ECSEXT01
   252     12  DE-REVERSE-REASONS.                                      ECSEXT01
   253         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
   254         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
   255     12  DE-CANCEL-REASON                  PIC X.
   256                                                                  ECSEXT01
   257     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
   258     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
   259                                                                  ECSEXT01
   260     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
   261         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   262             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
   263         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   264             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
   265                                                                  ECSEXT01
   266     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
   267         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
   268                                                                  ECSEXT01
   269     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
   270     12  FILLER REDEFINES DE-NCL-POOL-CODE.
   271         16  DE-LOAN-TERM                  PIC S999 COMP-3.
   272         16  FILLER                        PIC X.
   273                                                                  ECSEXT01
   274****************************************************************  ECSEXT01
   275**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
   276****************************************************************  ECSEXT01
   277     12  DE-COMM-LEVELS.                                          ECSEXT01
   278         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
   279             20  DE-AGT.                                          ECSEXT01
   280                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
   281                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
   282             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
   283             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   284             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   285                                                                  ECSEXT01
   286     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
   287****************************************************************  ECSEXT01
   288*******                 CLAIM EXTRACT                      *****  ECSEXT01
   289****************************************************************  ECSEXT01
   290     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page   7
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   291     12  FILLER                            PIC X(334).            ECSEXT01
   292     12  DE-TYPE                           PIC X.                 ECSEXT01
   293         88  DE-DTH                           VALUE '1'.          ECSEXT01
   294         88  DE-AH                            VALUE '2'.          ECSEXT01
   295         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
   296         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
   297         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
   298         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
   299                                                                  ECSEXT01
   300     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
   301     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   302                                                                  ECSEXT01
   303     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
   304     12  DE-REPORTED.                                             ECSEXT01
   305         16  DE-RPT-YR                     PIC 99.                ECSEXT01
   306         16  DE-RPT-MO                     PIC 99.                ECSEXT01
   307         16  DE-RPT-DA                     PIC 99.                ECSEXT01
   308     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
   309     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
   310                                                                  ECSEXT01
   311     12  DE-CNUM                           PIC X(7).              ECSEXT01
   312     12  DE-CHECK                          PIC X(7).              ECSEXT01
   313     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
   314     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
   315     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
   316     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
   317         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
   318         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
   319         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
   320         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
   321         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
   322         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
   323         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
   324                                                                  ECSEXT01
   325     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
   326                                                                  ECSEXT01
   327     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
   328     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   329     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   330     12  FILLER                            PIC XX.                ECSEXT01
   331     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
   332                                                                  ECSEXT01
   333     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
   334     12  DE-BENEFICIARY                    PIC X(10).
   335     12  filler redefines de-beneficiary.
   336         16  de-birth-date                 pic 9(11)  comp-3.
   337         16  f                             pic x(4).
   338     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
   339     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
   340     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
   341     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
   342     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
   343     12  DE-CLM-CLASS                      PIC XX.
   344     12  DE-CLM-DEV                        PIC XXX.
   345     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
   346     12  de-xycor-cert-seq                 pic x(3).
   347     12  DE-XYCOR-CHECK-NO                 PIC X(8).
   348     12  DE-XYCOR-ACTION-CD                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page   8
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   349     12  DE-XYCOR-STATUS                   PIC X.
   350     12  FILLER                            PIC X(4).              ECSEXT01
   351                                                                  ECSEXT01
   352     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   353                                                                  ECSEXT01
   354****************************************************************  ECSEXT01
   355*******               RESERVE EXTRACT                      *****  ECSEXT01
   356****************************************************************  ECSEXT01
   357     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
   358     12  FILLER                            PIC X(334).            ECSEXT01
   359                                                                  ECSEXT01
   360     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
   361         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
   362         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
   363                                                                  ECSEXT01
   364     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
   365     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
   366     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
   367                                                                  ECSEXT01
   368     12  DE-CLMNO                          PIC X(7).              ECSEXT01
   369                                                                  ECSEXT01
   370     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
   371     12  DE-RSV-REPORTED.                                         ECSEXT01
   372         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
   373         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
   374         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
   375     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
   376                                                                  ECSEXT01
   377     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
   378     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
   379     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
   380                                                                  ECSEXT01
   381     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
   382     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   383     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   384                                                                  ECSEXT01
   385     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
   386                                                                  ECSEXT01
   387     12  DE-RATE-CLASS                     PIC XX.
   388     12  DE-DEV-CODE                       PIC XXX.
   389     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
   390     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
   391     12  FILLER                            PIC X(58).             ECSEXT01
   392                                                                  ECSEXT01
   393     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   394******************************************************************ECSEXT01
   395
   396 FD  FREEDOM-EXTRACT
   397     LABEL RECORDS ARE STANDARD
   398     RECORDING MODE IS F
   399     BLOCK CONTAINS 0 RECORDS.
   400 01  EXTRACT-RECORD      PIC X(250).
   401
   402 FD  CSI-FREEDOM-EXTRACT
   403     LABEL RECORDS ARE STANDARD
   404     RECORDING MODE IS F
   405     BLOCK CONTAINS 0 RECORDS.
   406 01  CSI-EXTRACT-RECORD          PIC X(250).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page   9
* FNB169.cbl
   407
   408 FD  CCC-FREEDOM-EXTRACT
   409     LABEL RECORDS ARE STANDARD
   410     RECORDING MODE IS F
   411     BLOCK CONTAINS 0 RECORDS.
   412 01  CCC-EXTRACT-RECORD          PIC X(250).
   413
   414 FD  ERACCT.
*  415     COPY ERCACCT.
   416******************************************************************04/19/98
   417*                                                                *ERCACCT
   418*                                                                *ERCACCT
   419*                            ERCACCT                             *   LV031
   420*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   421*                            VMOD=2.031                          *ERCACCT
   422*                                                                *ERCACCT
   423*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   424*                                                                *ERCACCT
   425*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   426*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   427*                                                                *ERCACCT
   428*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   429*                                                                *ERCACCT
   430*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   431*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   432*                                                                *ERCACCT
   433*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   434*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   435*                                                                *ERCACCT
   436*   LOG = NO                                                     *ERCACCT
   437*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   438*                                                                *ERCACCT
   439*                                                                *ERCACCT
   440******************************************************************ERCACCT
   441*                   C H A N G E   L O G
   442*
   443* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   444*-----------------------------------------------------------------
   445*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   446* EFFECTIVE    NUMBER
   447*-----------------------------------------------------------------
   448* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   449* 092705    2005050300006  PEMA  ADD SPP LEASES
   450* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   451* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   452* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   453* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   454* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   455******************************************************************
   456                                                                  ERCACCT
   457 01  ACCOUNT-MASTER.                                              ERCACCT
   458     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   459         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   460                                                                  ERCACCT
   461     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   462         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   463         16  AM-MSTR-CNTRL.                                       ERCACCT
   464             20  AM-CONTROL-A.                                    ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  10
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   465                 24  AM-CARRIER            PIC X.                 ERCACCT
   466                 24  AM-GROUPING.                                 ERCACCT
   467                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   468                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   469                 24  AM-STATE              PIC XX.                ERCACCT
   470                 24  AM-ACCOUNT.                                  ERCACCT
   471                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   472                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   473             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   474                                           PIC X(19).             ERCACCT
   475             20  AM-CNTRL-B.                                      ERCACCT
   476                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   477                 24  FILLER                PIC X(4).              ERCACCT
   478             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   479                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   480                                                                  ERCACCT
   481     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   482         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   483         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   484         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   485         16  AM-VG-STATE                   PIC XX.                ERCACCT
   486         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   487         16  AM-VG-DATE.                                          ERCACCT
   488             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   489             20  FILLER                    PIC X(4).              ERCACCT
   490         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   491                                           PIC 9(11)      COMP-3. ERCACCT
   492     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   493         16  FILLER                        PIC X(10).
   494         16  AM-VG-KEY3.
   495             20  AM-VG3-ACCOUNT            PIC X(10).
   496             20  AM-VG3-EXP-DT             PIC XX.
   497         16  FILLER                        PIC X(4).
   498     12  AM-MAINT-INFORMATION.                                    ERCACCT
   499         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   500         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   501         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   502         16  FILLER                        PIC XX.                ERCACCT
   503                                                                  ERCACCT
   504     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   505     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   506                                                                  ERCACCT
   507     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   508         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   509         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   510                                                                  ERCACCT
   511     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   512     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   513                                                                  ERCACCT
   514     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   515     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   516                                                                  ERCACCT
   517     12  AM-NAME                           PIC X(30).             ERCACCT
   518     12  AM-PERSON                         PIC X(30).             ERCACCT
   519     12  AM-ADDRS                          PIC X(30).             ERCACCT
   520     12  AM-CITY.
   521         16  AM-ADDR-CITY                  PIC X(28).
   522         16  AM-ADDR-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  11
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   523     12  AM-ZIP.                                                  ERCACCT
   524         16  AM-ZIP-PRIME.                                        ERCACCT
   525             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   526                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   527             20  FILLER                    PIC X(4).              ERCACCT
   528         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   529     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   530         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   531         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   532         16  FILLER                        PIC XXX.               ERCACCT
   533     12  AM-TEL-NO.                                               ERCACCT
   534         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   535         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   536         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   537     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   538         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   539         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   540                                                                  ERCACCT
   541     12  AM-COMM-STRUCTURE.                                       ERCACCT
   542         16  AM-DEFN-1.                                           ERCACCT
   543             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   544                 24  AM-AGT.                                      ERCACCT
   545                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   546                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   547                 24  AM-COM-TYP            PIC X.                 ERCACCT
   548                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   549                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   550                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   551                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   552                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   553                 24  AM-GL-CODES           PIC X.                 ERCACCT
   554                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   555                 24  FILLER                PIC X(01).             ERCACCT
   556         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   557             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   558                 24  FILLER                PIC X(11).             ERCACCT
   559                 24  AM-L-COMA             PIC XXX.               ERCACCT
   560                 24  AM-J-COMA             PIC XXX.               ERCACCT
   561                 24  AM-A-COMA             PIC XXX.               ERCACCT
   562                 24  FILLER                PIC X(6).              ERCACCT
   563                                                                  ERCACCT
   564     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   565         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   566                                                                  ERCACCT
   567     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   568                                                                  ERCACCT
   569     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   570         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   571         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   572     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   573         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   574         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   575     12  AM-GPCD                           PIC 99.                ERCACCT
   576     12  AM-IG                             PIC X.                 ERCACCT
   577         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   578         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   579     12  AM-STATUS                         PIC X.                 ERCACCT
   580         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  12
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   581         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   582         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   583         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   584         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   585         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   586     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   587     12  AM-ID-NO                          PIC X(11).             ERCACCT
   588                                                                  ERCACCT
   589     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   590     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   591     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   592     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   593     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   594     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   595     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   596     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   597     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   598                                                                  ERCACCT
   599     12  AM-USER-FIELDS.                                          ERCACCT
   600         16  AM-FLD-1                      PIC XX.                ERCACCT
   601         16  AM-FLD-2                      PIC XX.                ERCACCT
   602         16  AM-FLD-3                      PIC XX.                ERCACCT
   603         16  AM-FLD-4                      PIC XX.                ERCACCT
   604         16  AM-FLD-5                      PIC XX.                ERCACCT
   605                                                                  ERCACCT
   606     12  AM-1ST-PROD-DATE.                                        ERCACCT
   607         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   608         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   609         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   610     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   611     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   612         16  AM-PUR-YR                     PIC XX.                ERCACCT
   613         16  AM-PUR-MO                     PIC XX.                ERCACCT
   614         16  AM-PUR-DA                     PIC XX.                ERCACCT
   615     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   616     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   617     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   618     12  AM-INACTIVE-DATE.                                        ERCACCT
   619         16  AM-INA-MO                     PIC 99.                ERCACCT
   620         16  AM-INA-DA                     PIC 99.                ERCACCT
   621         16  AM-INA-YR                     PIC 99.                ERCACCT
   622     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   623                                                                  ERCACCT
   624     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   625     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   626                                                                  ERCACCT
   627     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   628         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   629         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   630         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   631         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   632                                                                  ERCACCT
   633     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   634         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   635         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   636                                                                  ERCACCT
   637     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   638                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  13
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   639     12  AM-OVER-SHORT.                                           ERCACCT
   640         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   641         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   642                                                                  ERCACCT
   643     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   644     12  AM-DCC-CLP-STATE                  PIC XX.
   645                                                                  ERCACCT
   646     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   647     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   648                                                                  ERCACCT
   649     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   650     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   651     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   652     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   653     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   654     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   655     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   656     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   657     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   658     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   659     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   660     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   661     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   662     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   663     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   664     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   665                                                                  ERCACCT
   666     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   667                                                                  ERCACCT
   668     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   669     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   670                                                                  ERCACCT
   671     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   672     12  AM-EARN-METHODS.                                         ERCACCT
   673         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   674             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   675             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   676             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   677             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   678         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   679             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   680             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   681             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   682             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   683         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   684             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   685             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   686             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   687             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   688             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   689             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   690                                                                  ERCACCT
   691     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   692     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   693     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   694                                                                  ERCACCT
   695     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   696     12  AM-RET-P-E                        PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  14
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   697     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   698     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   699     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   700     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   701         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   702         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   703     12  AM-RETRO-EARNINGS.                                       ERCACCT
   704         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   705         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   706         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   707     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   708         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   709         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   710     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   711         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   712         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   713         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   714     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   715     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   716                                                                  ERCACCT
   717     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   718         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   719         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   720         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   721         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   722         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   723                                                                  ERCACCT
   724     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   725                                                                  ERCACCT
   726     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   727                                                                  ERCACCT
   728     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   729         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   730                                                                  ERCACCT
   731     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   732         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   733         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   734                                                                  ERCACCT
   735     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   736         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   737                                                                  ERCACCT
   738     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   739         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   740         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   741                                                                  ERCACCT
   742     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   743                                                                  ERCACCT
   744     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   745     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   746     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   747     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   748     12  AM-DCC-UEF-STATE                  PIC XX.
   749     12  FILLER                            PIC XXX.
   750     12  AM-REPORT-CODE-3                  PIC X(10).
   751*    12  FILLER                            PIC X(22).             ERCACCT
   752                                                                  ERCACCT
   753     12  AM-RESERVE-DATE.                                         ERCACCT
   754         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  15
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   755         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   756         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   757                                                                  ERCACCT
   758     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   759     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   760         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   761         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   762         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   763         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   764                                                                  ERCACCT
   765     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   766         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   767         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   768         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   769         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   770                                                                  ERCACCT
   771     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   772         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   773             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   774             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   775             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   776             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   777             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   778             20  FILLER                    PIC XX.                ERCACCT
   779         16  FILLER                        PIC X(80).             ERCACCT
   780                                                                  ERCACCT
   781     12  AM-TRANSFER-DATA.                                        ERCACCT
   782         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   783             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   784             20  AM-TRNFROM-GROUPING.                             ERCACCT
   785                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   786                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   787             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   788             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   789                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   790                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   791             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   792         16  AM-TRANSFERRED-TO.                                   ERCACCT
   793             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   794             20  AM-TRNTO-GROUPING.                               ERCACCT
   795                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   796                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   797             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   798             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   799                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   800                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   801             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   802         16  FILLER                        PIC X(10).             ERCACCT
   803                                                                  ERCACCT
   804     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   805                                                                  ERCACCT
   806     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   807         16  AM-DEFN-1-SAVED.                                     ERCACCT
   808             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   809                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   810                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   811                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   812                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  16
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   813                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   814                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   815                 24  FILLER                PIC X.                 ERCACCT
   816                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   817                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   818                 24  FILLER                PIC X.                 ERCACCT
   819         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   820             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   821                 24  FILLER                PIC X(11).             ERCACCT
   822                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   823                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   824                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   825                 24  FILLER                PIC X(6).              ERCACCT
   826                                                                  ERCACCT
   827     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   828         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   829            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   830            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   831            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   832                                                                  ERCACCT
   833     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   834     12  FILLER                            PIC X(120).            ERCACCT
   835                                                                  ERCACCT
   836     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   837         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   838         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   839             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   840             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   841                                                          COMP-3. ERCACCT
   842             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   843                                                          COMP-3. ERCACCT
   844         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   845             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   846             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   847                                                          COMP-3. ERCACCT
   848             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   849                                                          COMP-3. ERCACCT
   850                                                                  ERCACCT
   851     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   852         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   853         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   854         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   855         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   856             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   857                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   858                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   859             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   860                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   861                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   862             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   863                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   864                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   865         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   866             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   867                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   868                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   869                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   870             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  17
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   871                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   872                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   873             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   874                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   875                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   876                                                                  ERCACCT
   877     12  AM-COMMENTS.                                             ERCACCT
   878         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   879                                                                  ERCACCT
   880     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   881         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   882         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   883         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   884         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   885         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   886             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   887             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   888             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   889             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   890         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   891             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   892             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   893             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   894         16  FILLER                        PIC X(102).            ERCACCT
   895                                                                  ERCACCT
   896     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   897         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   898             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   899             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   900             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   901             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   902             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   903         16  FILLER                          PIC X(10).           ERCACCT
   904******************************************************************ERCACCT
   905
   906 FD  ERPDEF.
   907
*  908                             COPY ERCPDEF.
   909******************************************************************
   910*                                                                *
   911*                                                                *
   912*                            ERCPDEF.                            *
   913*                                                                *
   914*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   915*                                                                *
   916*    FILE TYPE = VSAM,KSDS                                       *
   917*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   918*                                                                *
   919*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   920*                                                                *
   921*    LOG = YES                                                   *
   922*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   923******************************************************************
   924 01  PRODUCT-MASTER.
   925    12  PD-RECORD-ID                 PIC X(02).
   926        88  VALID-PD-ID                  VALUE 'PD'.
   927
   928    12  PD-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  18
* FNB169.cbl (/apps/prod/cid1p/copy/ERCPDEF)
   929        16  PD-COMPANY-CD            PIC X.
   930        16  PD-STATE                 PIC XX.
   931        16  PD-PRODUCT-CD            PIC XXX.
   932        16  PD-FILLER                PIC X(7).
   933        16  PD-BEN-TYPE              PIC X.
   934        16  PD-BEN-CODE              PIC XX.
   935        16  PD-PROD-EXP-DT           PIC XX.
   936
   937    12  FILLER                       PIC X(50).
   938
   939    12  PD-PRODUCT-DATA OCCURS 8.
   940        16  PD-PROD-CODE             PIC X.
   941            88  PD-PROD-LIFE           VALUE 'L'.
   942            88  PD-PROD-PROP           VALUE 'P'.
   943            88  PD-PROD-AH             VALUE 'A'.
   944            88  PD-PROD-IU             VALUE 'I'.
   945            88  PD-PROD-GAP            VALUE 'G'.
   946        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   947        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   948        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   949        16  PD-MAX-TERM              PIC S999        COMP-3.
   950        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   951        16  FILLER                   PIC X.
   952        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   953        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   954        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   955        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   956        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   957        16  PD-REC-CRIT-PERIOD       PIC X.
   958        16  PD-RTW-MOS               PIC 99.
   959        16  FILLER                   PIC X(5).
   960
   961    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   962
   963    12  PD-TERM-LIMITS OCCURS 15.
   964        16  PD-LOW-TERM              PIC S999        COMP-3.
   965        16  PD-HI-TERM               PIC S999        COMP-3.
   966
   967*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   968    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   969        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   970        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   971
   972    12  PD-EARN-FACTORS.
   973        16  FILLER OCCURS 15.
   974            20  FILLER OCCURS 15.
   975                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   976
   977    12  PD-PRODUCT-DESC              PIC X(80).
   978    12  PD-TRUNCATED                 PIC X.
   979    12  FILLER                       PIC X(59).
   980
   981    12  PD-MAINT-INFORMATION.
   982        16  PD-LAST-MAINT-DT         PIC X(02).
   983        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   984        16  PD-LAST-MAINT-BY         PIC X(04).
   985
   986 FD  DISK-DATE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  19
* FNB169.cbl
*  987     COPY ELCDTEFD.
   988******************************************************************04/15/98
   989*                                                                *ELCDTEFD
   990*                                                                *ELCDTEFD
   991*                            ELCDTEFD.                           *   LV002
   992*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   993*                            VMOD=2.007                          *   CL**2
   994*                                                                *ELCDTEFD
   995******************************************************************ELCDTEFD
   996     BLOCK CONTAINS 0 RECORDS
   997     RECORDING MODE F.                                            ELCDTEFD
   998                                                                  ELCDTEFD
   999 01  DATE-DISK.                                                   ELCDTEFD
  1000     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1001     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1002     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1003     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1004     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1005     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1006     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1007                                                                  ELCDTEFD
  1008 01  DATE-DISK-R.                                                 ELCDTEFD
  1009     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1010     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1011                                     PIC  X(32).                  ELCDTEFD
  1012                                                                  ELCDTEFD
  1013 01  DATE-DISK-T.                                                 ELCDTEFD
  1014     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1015     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1016                                     PIC  X(48).                  ELCDTEFD
  1017                                                                  ELCDTEFD
  1018 01  DATE-DISK-M.                                                 ELCDTEFD
  1019     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1020     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1021                                     PIC  X(48).                  ELCDTEFD
  1022                                                                  ELCDTEFD
  1023 01  DATE-DISK-P.                                                 ELCDTEFD
  1024     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1025     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1026     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1027     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1028         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1029                                     PIC  X.                      ELCDTEFD
  1030         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1031     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1032         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1033             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1034             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1035             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1036             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1037         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1038                                                                  ELCDTEFD
  1039 01  DATE-DISK-E.                                                 ELCDTEFD
  1040     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1041     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1042                                     PIC  X(4).                   ELCDTEFD
  1043                                                                  ELCDTEFD
  1044 01  DATE-DISK-C.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  20
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1045     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1046     12  DD-CARR1-SECPAY-SW          PIC  X.
  1047     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1048     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1049     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1050     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1051     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1052     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1053     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1054     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1055     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1056     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1057     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1058     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1059     12  DD-CARR2-SECPAY-SW          PIC  X.
  1060     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1061                                                                  ELCDTEFD
  1062 01  DATE-DISK-OPT.                                               ELCDTEFD
  1063     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1064     12  DD-TLR-DATA.                                             ELCDTEFD
  1065         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1066                                     PIC  X(03).                  ELCDTEFD
  1067     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1068         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1069                                     PIC  X(06).                  ELCDTEFD
  1070     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1071         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1072                                     PIC  X(07).                  ELCDTEFD
  1073         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1074     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1075                                     PIC  X(96).                  ELCDTEFD
  1076******************************************************************ELCDTEFD
  1077
  1078
  1079 WORKING-STORAGE SECTION.
  1080
  1081 77  B-SUB                   PIC S9(4)   COMP.
  1082 77  D1                      PIC S9(5) COMP-3 VALUE +0.
  1083 77  P1                      PIC S999 COMP-3 VALUE +0.
  1084 77  P2                      PIC S999 COMP-3 VALUE +0.
  1085 77  CNC-WK                  PIC S9(7)V99 COMP-3 VALUE +0.
  1086 77  WS-MONTH                PIC S999     COMP-3 VALUE +0.
  1087 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  1088 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  1089 77  DD-IU-SW                    PIC X   VALUE ' '.
  1090     88  DD-IU-PRESENT                 VALUE 'Y'.
  1091 77  WS-FACT-CERT            PIC X(11) VALUE SPACES.
  1092 77  A-OW                        PIC S9(7)V99 COMP-3 VALUE +0.
  1093 77  W-FACTOR            PIC S9(09)V9(08) COMP-3 VALUE +0.
  1094 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  1095 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  1096 77  WS-DDF-TERM             PIC S999 COMP-3 VALUE +0.
  1097
  1098 01  WS-DCC-PRODUCT-CODE         PIC XXX  VALUE SPACES.
  1099 01  AGT-LEVEL                 COMP   PIC 9(04).
  1100 01  WS-CNC-FACT               COMP-3 PIC S9(03)V9(07) VALUE +0.
  1101 01  WS-LF-CNC-FACT            COMP-3 PIC S9(03)V9(07) VALUE +0.
  1102 01  WS-WORK-AMT               COMP-3 PIC S9(7)V99 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  21
* FNB169.cbl
  1103 01  WS-LF-WORK                  PIC S9(7)V99 VALUE +0 COMP-3.
  1104 01  WS-AH-WORK                  PIC S9(7)V99 VALUE +0 COMP-3.
  1105 01  TEST-DISP-FX-AMT PIC ZZZZZZZZ9.99.
  1106 01  TEST-DISP-L-PC PIC ZZ.ZZZZZ.
  1107 01  TEST-DISP-A-PC PIC ZZ.ZZZZZ.
  1108 01  FILLER.
  1109     05  WS-ZERO               COMP-3 PIC S9(03) VALUE +0.
  1110     05  WS-ABEND-MESSAGE             PIC X(80)  VALUE SPACES.
  1111     05  PGM-SUB               COMP   PIC S9(04) VALUE +310.
  1112     05  WS-RETURN-CODE        COMP-3 PIC S9(03) VALUE +0.
  1113
  1114     05  DETEXT-STATUS                PIC X(02)  VALUE '00'.
  1115         88  EOF-DETEXT                          VALUE '10'.
  1116
  1117     05  DATE-SW                      PIC X(01)  VALUE ' '.
  1118         88  VALID-DATE                          VALUE 'V'.
  1119
  1120     05  VALID-RECORD-SW              PIC X(01)  VALUE '0'.
  1121         88  VALID-RECORD                        VALUE '1'.
  1122
  1123     05  END-OF-SEARCH-SW             PIC X(01)  VALUE '0'.
  1124         88  END-OF-SEARCH                       VALUE '1'.
  1125
  1126     05  ERACCT-STATUS                PIC X(02)  VALUE '00'.
  1127     05  ERPDEF-FILE-STATUS           PIC XX     VALUE '00'.
  1128
  1129
  1130 01  max-pdef                    pic s9(5) comp-3 value +2000.
  1131 01  DCC-DDF-WORK-AREA.
  1132     05  F OCCURS 2000.
  1133         10  DD-STATE                 PIC XX.
  1134         10  DD-PRODUCT-CD            PIC XXX.
  1135         10  DD-FILLER                PIC X(7).
  1136         10  DD-BEN-TYPE              PIC X.
  1137         10  DD-BEN-CODE              PIC XX.
  1138         10  DD-PROD-EXP-DT           PIC XX.
  1139         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  1140         10  DD-PROD-DATA OCCURS 8.
  1141             15  DD-PROD-CODE         PIC X.
  1142         10  DD-EARN-FACTORS.
  1143             15  F OCCURS 15.
  1144                 20  F OCCURS 15.
  1145                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1146         10  DD-TRUNCATED             PIC X.
  1147
  1148 01  WS-EXTRACT-RECORD.
* 1149     COPY FNC022.
  1150     05  FX-COMMON-SECTION.                                       00010001
  1151         10  FX-SYSTEM             PIC X(10).                     00020001
  1152         10  FX-SOURCE-CODE        PIC X(6).                      00030001
  1153         10  FX-DIVISION           PIC X(2).                      00040001
  1154         10  FX-TRAN-TYPE          PIC X(2).                      00050001
  1155         10  FX-SUB-TYPE           PIC X(2).                      00060001
  1156         10  FX-CLM-RES            PIC X(2).                      00070001
  1157         10  FX-ANN-STMT           PIC X(3).                      00080001
  1158         10  FX-PLAN-CODE          PIC X(6).                      00090001
  1159         10  FX-FORM               PIC X(3).                      00091001
  1160         10  FX-JOURNAL-DATE       PIC X(8).                      00092001
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  22
* FNB169.cbl (/apps/prod/cid1p/copy/FNC022)
  1161         10  FX-POSTING-DATE       PIC X(8).                      00093001
  1162         10  FX-POLICY-NO          PIC X(10).                     00094001
  1163         10  FX-CITY               PIC X(30).                     00095002
  1164         10  FX-STATE              PIC X(2).                      00095102
  1165         10  FX-ZIP-CODE           PIC X(9).                      00096001
  1166         10  FX-LOC-CODE           PIC X.                         00096102
  1167         10  FX-FY-REN             PIC X.                         00097001
  1168         10  FX-AGENT-01           PIC X(9).                      00098001
  1169         10  FX-AGENT-50           PIC X(9).                      00099001
  1170         10  FX-COST-CENTER        PIC X(4).                      00100001
  1171         10  FX-TAXABLE            PIC X.                         00110004
  1172         10  FX-DISTR              PIC X(2).                      00120001
  1173         10  FX-SOURCE-ACCT        PIC X(10).                     00130001
  1174         10  FX-DESCRIPTION        PIC X(30).                     00140001
  1175         10  FX-REFERENCE          PIC X(10).                     00150001
  1176         10  FX-SUSPENSE           PIC X(15).                     00151002
  1177         10  FX-AMOUNT             PIC S9(10)V99                  00160001
  1178                                   SIGN IS TRAILING SEPARATE.     00170001
  1179                                                                  00180001
  1180     05  FX-CLAIM-SECTION.                                        00190001
  1181         10  FX-CLAIM-NO           PIC X(10).                     00200001
  1182         10  FX-CLAIM-TYPE         PIC X.                         00210001
  1183         10  FX-DRAFT-NO           PIC X(10).                     00220001
  1184         10  FX-DRAFT-STATUS       PIC X.                         00230001
  1185         10  FX-TAX-ID             PIC X(10).                     00240001
  1186         10  FILLER                PIC X(10).                     00250003
  1187                                                                  00290001
  1188
  1189
  1190 01  FNX001-PARMS.
  1191     05  FNX001-DATA                  PIC X(50).
  1192     05  FNX001-CITY                  PIC X(30).
  1193     05  FNX001-STATE                 PIC X(02).
  1194     05  FNX001-ZIP                   PIC X(09).
  1195
  1196 01  SYSTEM-DATE.
  1197     05  SYS-MO                       PIC 9(02).
  1198     05  SYS-DA                       PIC 9(02).
  1199     05  SYS-CCYY                     PIC 9(04).
  1200
  1201***** FUNCTION-DATE COPYBOOK
* 1202 COPY ELCFUNDT.
  1203***************************************************************** 12/03/98
  1204*                                                               * ELCFUNDT
  1205*                            ELCFUNDT.                          *    LV004
  1206*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  1207*                            VMOD=2.001                         * ELCFUNDT
  1208*                                                               * ELCFUNDT
  1209*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  1210*                                                               * ELCFUNDT
  1211***************************************************************** ELCFUNDT
  1212                                                                  ELCFUNDT
  1213                                                                  ELCFUNDT
  1214 01  FUNCTION-DATE.                                                  CL**2
  1215     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  1216     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  1217         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  1218         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  23
* FNB169.cbl (/apps/prod/cid1p/copy/ELCFUNDT)
  1219             15  WS-FN-CC          PIC 99.                           CL**3
  1220             15  WS-FN-YR          PIC 99.                           CL**3
  1221         10  WS-FN-MO              PIC 99.                           CL**3
  1222         10  WS-FN-DA              PIC 99.                           CL**3
  1223     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  1224     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  1225     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  1226     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  1227     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  1228         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  1229         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  1230         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  1231     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  1232     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
  1233
  1234
  1235***** STATE EDIT TABLE
* 1236 COPY FNC018.
  1237***************************************************************** 00020002
  1238*                                                               * 00030002
  1239*                     STATE CODE TABLE                          * 00040002
  1240*                                                               * 00050002
  1241*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     * 00060002
  1242*            SEARCH VERB WILL NOT WORK PROPERLY !               * 00070002
  1243*                                                               * 00080002
  1244***************************************************************** 00090002
  1245*                                                                 00100002
  1246 01  STATE-VALUES.                                                00110002
  1247     05  PIC X(24)  VALUE 'AKAKALASKA              '.             00120002
  1248     05  PIC X(24)  VALUE 'ALALALABAMA             '.             00130002
  1249     05  PIC X(24)  VALUE 'ARARARKANSAS            '.             00140002
  1250     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.             00150002
  1251     05  PIC X(24)  VALUE 'AZAZARIZONA             '.             00160002
  1252     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.             00170002
  1253     05  PIC X(24)  VALUE 'CDCNCANADA              '.             00180002
  1254     05  PIC X(24)  VALUE 'CNCNCANADA              '.             00190002
  1255     05  PIC X(24)  VALUE 'COCOCOLORADO            '.             00200002
  1256     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.             00210002
  1257     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.             00220002
  1258     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.             00230002
  1259     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.             00240002
  1260     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.             00250002
  1261     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.             00260002
  1262     05  PIC X(24)  VALUE 'GUGUGUAM                '.             00270002
  1263     05  PIC X(24)  VALUE 'HIHIHAWAII              '.             00280002
  1264     05  PIC X(24)  VALUE 'IAIAIOWA                '.             00290002
  1265     05  PIC X(24)  VALUE 'IDIDIDAHO               '.             00300002
  1266     05  PIC X(24)  VALUE 'ILILILLINOIS            '.             00310002
  1267     05  PIC X(24)  VALUE 'INININDIANA             '.             00320002
  1268     05  PIC X(24)  VALUE 'KSKSKANSAS              '.             00330002
  1269     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.             00340002
  1270     05  PIC X(24)  VALUE 'LALALOUISIANA           '.             00350002
  1271     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.             00360002
  1272     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.             00370002
  1273     05  PIC X(24)  VALUE 'MEMEMAINE               '.             00380002
  1274     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.             00390002
  1275     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.             00400002
  1276     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.             00410002
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  24
* FNB169.cbl (/apps/prod/cid1p/copy/FNC018)
  1277     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.             00420002
  1278     05  PIC X(24)  VALUE 'MTMTMONTANA             '.             00430002
  1279     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.             00440002
  1280     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.             00450002
  1281     05  PIC X(24)  VALUE 'NENENEBRASKA            '.             00460002
  1282     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.             00470002
  1283     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.             00480002
  1284     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.             00490002
  1285     05  PIC X(24)  VALUE 'NVNVNEVADA              '.             00500002
  1286     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.             00510002
  1287     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.             00520002
  1288     05  PIC X(24)  VALUE 'OHOHOHIO                '.             00530002
  1289     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.             00540002
  1290     05  PIC X(24)  VALUE 'OROROREGON              '.             00550002
  1291     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.             00560002
  1292     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.             00570002
  1293     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.             00580002
  1294     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.             00590002
  1295     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.             00600002
  1296     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.             00610002
  1297     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.             00620002
  1298     05  PIC X(24)  VALUE 'TXTXTEXAS               '.             00630002
  1299     05  PIC X(24)  VALUE 'UTUTUTAH                '.             00640002
  1300     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.             00650002
  1301     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.             00660002
  1302     05  PIC X(24)  VALUE 'VTVTVERMONT             '.             00670002
  1303     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.             00680002
  1304     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.             00690002
  1305     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.             00700002
  1306     05  PIC X(24)  VALUE 'WYWYWYOMING             '.             00710002
  1307                                                                  00720002
  1308 01  FILLER REDEFINES STATE-VALUES.                               00730002
  1309     05  STATE-TABLE                                              00740002
  1310             OCCURS 60 TIMES                                      00750002
  1311             ASCENDING KEY IS ST-STATE                            00760002
  1312             INDEXED BY ST-INDEX.                                 00770002
  1313         10  ST-STATE          PIC XX.                            00780002
  1314         10  ST-ALT-STATE      PIC XX.                            00790002
  1315         10  ST-NAME           PIC X(20).                         00800002
  1316                                                                  00810002
  1318
* 1319 COPY ELCDTECX.
  1320******************************************************************06/05/98
  1321*                                                                *ELCDTECX
  1322*                            ELCDTECX.                           *   LV005
  1323*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1324*                            VMOD=2.015                          *ELCDTECX
  1325*                                                                *ELCDTECX
  1326*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1327*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1328*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1329*                                                                *ELCDTECX
  1330******************************************************************ELCDTECX
  1331******************************************************************
  1332*                   C H A N G E   L O G
  1333*
  1334* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1335*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  25
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1336*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1337* EFFECTIVE    NUMBER
  1338*-----------------------------------------------------------------
  1339* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1340*                                  BENEFIT CODES FROM 300 TO 900
  1341* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1342* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1343******************************************************************
  1344 01  DATE-CARD.                                                   ELCDTECX
  1345     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1346     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1347     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1348     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1349     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1350     12  EP-SW                       PIC  X.                      ELCDTECX
  1351         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1352     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1353         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1354     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1355     12  RUN-CENTURY.                                             ELCDTECX
  1356         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1357     12  FILLER                      PIC  X.                         CL**4
  1358     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1359     12  FILLER                      PIC  XXX.                    ELCDTECX
  1360     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1361                                                                  ELCDTECX
  1362 01  FILLER                          PIC  X(7)                       CL**6
  1363                                          VALUE 'OPTIONS'.        ELCDTECX
  1364 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1365     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1366     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1367     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1368         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1369         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1370     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1371     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1372     12  FILLER                      PIC  X.                      ELCDTECX
  1373     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1374     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1375     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1376     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1377     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1378     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1379     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1380     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1381     12  FILLER                      PIC  X.                      ELCDTECX
  1382     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1383     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1384     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1385     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1386     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1387     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1388     12  FILLER                      PIC  X.                      ELCDTECX
  1389     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1390     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1391     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1392     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1393     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  26
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1394     12  DTE-R78                     PIC  X.                      ELCDTECX
  1395     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1396     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1397     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1398     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1399     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1400     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1401     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1402                                     PIC  X.                      ELCDTECX
  1403         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1404                                                 ' '.             ELCDTECX
  1405         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1406         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1407     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1408         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1409         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1410     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1411     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1412                                     PIC  9.                         CL**4
  1413     12  DTE-SYSTEM.                                              ELCDTECX
  1414         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1415         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1416         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1417         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1418         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1419         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1420         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1421         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1422         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1423         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1424         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1425         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1426         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1427         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1428         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1429         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1430         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1431         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1432         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1433         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1434         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1435         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1436         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1437         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1438         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1439         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1440     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1441         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1442                                     PIC  X.                      ELCDTECX
  1443     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1444                                                                  ELCDTECX
  1445 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1446     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1447     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1448     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1449*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1450     12  FILLER                      PIC  X.                      ELCDTECX
  1451     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  27
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1452     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1453     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1454     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1455     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1456     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1457     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1458                                                                  ELCDTECX
  1459     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1460     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1461     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1462     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1463                                                                  ELCDTECX
  1464     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1465     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1466     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1467     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1468                                                                  ELCDTECX
  1469     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1470     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1471                                                                  ELCDTECX
  1472     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1473     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1474                                                                  ELCDTECX
  1475     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1476                                                                  ELCDTECX
  1477 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1478     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1479     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1480     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1481     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1482     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1483     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1484     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1485                                                                  ELCDTECX
  1486 01  FILLER                          PIC  X(12)                   ELCDTECX
  1487                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1488 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1489     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1490         16  CNT-ID                  PIC  X.                      ELCDTECX
  1491         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1492                                                                  ELCDTECX
  1493 01  FILLER                          PIC  X(11)                   ELCDTECX
  1494                                          VALUE 'STATE NAMES'.    ELCDTECX
  1495 01  STATE-NAMES.                                                 ELCDTECX
  1496     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1497         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1498         16  STATE-PIC1.                                          ELCDTECX
  1499             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1500             20  FILLER              PIC  XXX.                    ELCDTECX
  1501             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1502             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1503             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1504             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1505                                                                  ELCDTECX
  1506 01  FILLER                          PIC  X(13)                   ELCDTECX
  1507                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1508 01  CARRIER-NAMES.                                               ELCDTECX
  1509     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  28
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1510         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1511         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1512         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1513         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1514         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1515         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1516*        16  FILLER                  PIC  X.                      ELCDTECX
  1517         16  CARRIER-SEC-PAY         PIC  X.
  1518             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1519                                                                  ELCDTECX
  1520 01  FILLER                          PIC  X(9)                       CL**6
  1521                                          VALUE 'INS TYPES'.      ELCDTECX
  1522 01  CLAS-INS-TYPES.                                              ELCDTECX
  1523*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1524     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1525         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1526         16  CLAS-I-AB3.                                          ELCDTECX
  1527             20  FILLER              PIC  X.                      ELCDTECX
  1528             20  CLAS-I-AB2.                                      ELCDTECX
  1529                 24  FILLER          PIC  X.                      ELCDTECX
  1530                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1531         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1532             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1533             20  FILLER              PIC  X.                         CL**4
  1534         16  CLAS-I-AB10.                                         ELCDTECX
  1535             20  FILLER              PIC  X(9).                   ELCDTECX
  1536             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1537         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1538         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1539         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1540         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1541             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1542         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1543         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1544         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1545         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1546         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  1547         16  FILLER                  PIC  X(05).
  1548                                                                  ELCDTECX
  1549 01  FILLER                          PIC  X(16)                   ELCDTECX
  1550                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1551 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1552     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1553                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1554         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1555         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1556         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1557         16  CLAS-MORT-DESC.                                      ELCDTECX
  1558             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1559             20  FILLER              PIC  XX.                        CL**5
  1560             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1561             20  FILLER              PIC  X.                         CL**5
  1562             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1563             20  FILLER              PIC  X.                         CL**5
  1564             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1565             20  FILLER              PIC  X.                         CL**5
  1566             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1567             20  FILLER              PIC  X(5).                      CL**6
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  29
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1568                                                                  ELCDTECX
  1569 01  FILLER                          PIC  X(15)                   ELCDTECX
  1570                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1571 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1572     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1573         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1574         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1575         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1576         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1577         16  FILLER                  PIC  X(4).                      CL**6
  1578                                                                  ELCDTECX
  1579 01  FILLER                          PIC  X(7)                       CL**6
  1580                                     VALUE 'INDEXES'.             ELCDTECX
  1581 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1582     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1583     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1584     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1585     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1586     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1587     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1588     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1589     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1590     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1591     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1592     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1593     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1594     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1595     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1596     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1597     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1598     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1599                                                                  ELCDTECX
  1600 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1601     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1602     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1603     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1604     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1605     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1606     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1607     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1608     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1609     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1610     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1611     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1612                                                                  ELCDTECX
  1613 01  FILLER                          PIC  X(13)                   ELCDTECX
  1614                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1615 01  CLAS-MISC.                                                   ELCDTECX
  1616     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1617         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1618         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1619         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1620     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1621     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1622     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1623     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1624     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1625     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  30
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1626     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1627     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1628     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1629     12  STATE-L                     PIC  XX.                     ELCDTECX
  1630     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1631     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1632     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1633         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1634         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1635     12  DTE-ABEND-WORK.                                          ELCDTECX
  1636         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1637         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1638                                                                  ELCDTECX
  1639 01  FILLER                          PIC  X(12)                   ELCDTECX
  1640                                     VALUE 'WORKING DATE'.        ELCDTECX
  1641 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1642     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1643         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1644         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1645         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1646     12  WS-CURRENT-DATE.                                         ELCDTECX
  1647         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1648         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1649         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1650         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1651         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1652     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1653         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1654         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1655                                                                  ELCDTECX
  1656 01  FILLER                          PIC  X(12)                   ELCDTECX
  1657                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1658 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1659     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1660         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1661         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1662         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1663                                                                  ELCDTECX
  1664 01  FILLER                          PIC  X(10)                   ELCDTECX
  1665                                     VALUE 'STATE TLRS'.          ELCDTECX
  1666 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1667     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1668         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1669         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1670                                                                  ELCDTECX
  1671 01  FILLER                          PIC  X(13)                   ELCDTECX
  1672                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1673 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1674     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1675         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1676                                                                  ELCDTECX
  1677 01  FILLER                          PIC  X(13)                   ELCDTECX
  1678                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1679 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1680     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1681     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1682     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1683                                     PIC  X.                         CL**5
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  31
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1684     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1685     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1686     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1687     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1688     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1689     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1690     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1691     12  FILLER                      PIC  X(75).                  ELCDTECX
  1692******************************************************************ELCDTECX
  1693*01  MISC-CARR-PCT-DATA.                                          00001521
  1694*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1695*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1696*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1697*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1698*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1699*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1700******************************************************************ELCDTECX
* 1701 COPY ELCDTEVR.
  1702***************************************************************** 04/15/98
  1703*                                                                *ELCDTEVR
  1704*                                                                *ELCDTEVR
  1705*                            ELCDTEVR.                           *   LV003
  1706*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1707*                            VMOD=2.001                          *   CL**2
  1708*                                                                *ELCDTEVR
  1709*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1710*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1711*                                                                *ELCDTEVR
  1712******************************************************************ELCDTEVR
  1713 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1714     05  WS-RUN-DATE.                                             ELCDTEVR
  1715         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1716         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1717         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1718             15  RUN-CC              PIC  99.                     ELCDTEVR
  1719             15  RUN-YR              PIC  99.                     ELCDTEVR
  1720         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1721         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1722     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1723            WS-RUN-DATE              PIC 9(11).                      CL**2
  1724     05  WS-EP-DT.                                                ELCDTEVR
  1725         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1726         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1727         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1728             15  EP-CC               PIC  99.                     ELCDTEVR
  1729             15  EP-YR               PIC  99.                     ELCDTEVR
  1730         10  EP-MO                   PIC  99.                     ELCDTEVR
  1731         10  EP-DA                   PIC  99.                     ELCDTEVR
  1732     05  WS-EP-DT-N REDEFINES                                        CL**2
  1733            WS-EP-DT                 PIC 9(11).                      CL**2
  1734     05  WS-DTE-CONV-DT.                                             CL**4
  1735         10  FILLER                  PIC  9(03).                     CL**4
  1736         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1737         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1738             15  DTE-CONV-CC         PIC  99.                        CL**4
  1739             15  DTE-CONV-YR         PIC  99.                        CL**4
  1740         10  DTE-CONV-MO             PIC  99.                        CL**4
  1741         10  DTE-CONV-DA             PIC  99.                        CL**4
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  32
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1742     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1743            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1744 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1745     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1746         10  FILLER                            PIC 999.           ELCDTEVR
  1747         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1748         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1749             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1750             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1751         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1752         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1753     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1754            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1755     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1756         10  FILLER                            PIC 999.           ELCDTEVR
  1757         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1758         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1759         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1760         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1761     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1762            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1763 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1764     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1765         10  FILLER                            PIC 999.           ELCDTEVR
  1766         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1767         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1768             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1769             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1770         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1771         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1772     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1773            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1774     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1775         10  FILLER                            PIC 999.           ELCDTEVR
  1776         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1777         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1778             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1779             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1780         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1781         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1782     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1783            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1784     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1785         10  FILLER                            PIC 999.           ELCDTEVR
  1786         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1787         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1788             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1789             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1790         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1791         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1792     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1793            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1794 01  WS-RATE-RECORD.                                              ELCDTEVR
  1795         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1796             10  FILLER                        PIC 999.           ELCDTEVR
  1797             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1798             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1799                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  33
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1800                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1801             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1802             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1803         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1804                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1805
  1806 LINKAGE SECTION.
  1807
  1808 01  PARM.
  1809     05  PARM-LENGTH                  PIC S9(04) COMP.
  1810     05  CYCLE-DATE                   PIC X(08).
  1811
  1812
  1813
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  34
* FNB169.cbl
  1815
  1816 PROCEDURE DIVISION USING PARM.
  1817
  1818*************************************************************
* 1819 COPY ELCDTERX.
  1820******************************************************************04/15/98
  1821*                                                                *ELCDTERX
  1822*                                                                *ELCDTERX
  1823*                            ELCDTERX.                           *   LV002
  1824*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1825*                            VMOD=2.007                          *ELCDTERX
  1826*                                                                *ELCDTERX
  1827*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1828*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1829*      = ELCDTEFD)                                               *ELCDTERX
  1830*                                                                *ELCDTERX
  1831******************************************************************ELCDTERX
  1832                                                                  ELCDTERX
  1833     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1834                                                                  ELCDTERX
  1835     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1836     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1837     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1838                                                                  ELCDTERX
  1839     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1840                                                                  ELCDTERX
  1841******************************************************************ELCDTERX
  1842*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1843*          WARNING MESSAGES.                                      ELCDTERX
  1844******************************************************************ELCDTERX
  1845     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1846         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1847                                                                  ELCDTERX
  1848     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1849                                                                  ELCDTERX
  1850     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1851                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1852                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1853                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1854                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1855                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1856                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1857                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1858                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1859                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1860                                                                  ELCDTERX
  1861     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1862                                                                  ELCDTERX
  1863     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1864                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1865                                                                  ELCDTERX
  1866     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1867     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1868     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1869     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1870                                                                  ELCDTERX
  1871     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1872         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  35
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1873     ELSE                                                         ELCDTERX
  1874         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1875                                                                  ELCDTERX
  1876     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1877         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1878     ELSE                                                         ELCDTERX
  1879         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1880                                                                  ELCDTERX
  1881 0005-READ--CARD.                                                 ELCDTERX
  1882     READ DISK-DATE                                               ELCDTERX
  1883         AT END CLOSE DISK-DATE                                   ELCDTERX
  1884             GO TO 0060-READ--TEST.                               ELCDTERX
  1885                                                                  ELCDTERX
  1886     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1887                                                                  ELCDTERX
  1888     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1889         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1890         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1891         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1892         GO TO 0005-READ--CARD.                                   ELCDTERX
  1893                                                                  ELCDTERX
  1894     IF DD-ID = 'CLAD'                                            ELCDTERX
  1895         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1896         GO TO 0005-READ--CARD.                                   ELCDTERX
  1897                                                                  ELCDTERX
  1898     IF DD-ID = 'CLAX'                                            ELCDTERX
  1899         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1900         GO TO 0005-READ--CARD.                                   ELCDTERX
  1901                                                                  ELCDTERX
  1902     IF DD-ID = 'CLAF'                                            ELCDTERX
  1903         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1904         GO TO 0005-READ--CARD.                                   ELCDTERX
  1905                                                                  ELCDTERX
  1906     IF DD-ID = 'CLAC'                                            ELCDTERX
  1907         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1908                                                                  ELCDTERX
  1909     IF DD-ID = 'CARR'                                            ELCDTERX
  1910         GO TO 0015-READ--CARR.                                   ELCDTERX
  1911                                                                  ELCDTERX
  1912     IF DD-ID = 'STAT'                                            ELCDTERX
  1913         GO TO 0020-READ--STAT.                                   ELCDTERX
  1914                                                                  ELCDTERX
  1915     IF DD-ID = 'BUSC'                                            ELCDTERX
  1916         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1917                                                                  ELCDTERX
  1918     IF DD-ID = 'MORT'                                            ELCDTERX
  1919         GO TO 0030-READ--MORT.                                   ELCDTERX
  1920                                                                  ELCDTERX
  1921     IF DD-ID = 'CLAI'                                            ELCDTERX
  1922         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1923                                                                  ELCDTERX
  1924     IF DD-ID = 'COLC'                                            ELCDTERX
  1925         GO TO 0065-READ--COLC.                                   ELCDTERX
  1926                                                                  ELCDTERX
  1927     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1928        DD-IDA = 'CL'                                             ELCDTERX
  1929         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1930                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  36
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1931     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1932        DD-IDA = 'PO'                                             ELCDTERX
  1933         GO TO 0050-READ--POXX.                                   ELCDTERX
  1934                                                                  ELCDTERX
  1935     IF DD-ID = 'OPCA'                                            ELCDTERX
  1936         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1937                                                                  ELCDTERX
  1938     IF DD-ID = 'OPST'                                            ELCDTERX
  1939         GO TO 0072-READ--OPST.                                   ELCDTERX
  1940                                                                  ELCDTERX
  1941     IF DD-ID = 'OPBS'                                            ELCDTERX
  1942         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1943                                                                  ELCDTERX
  1944     IF DD-ID = 'OPMS'                                            ELCDTERX
  1945         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1946                                                                  ELCDTERX
  1947     GO TO 0005-READ--CARD.                                       ELCDTERX
  1948                                                                  ELCDTERX
  1949 0010-READ--CLAC.                                                 ELCDTERX
  1950     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1951     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1952     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1953     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1954     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1955     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1956     GO TO 0005-READ--CARD.                                       ELCDTERX
  1957                                                                  ELCDTERX
  1958 0015-READ--CARR.                                                 ELCDTERX
  1959     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1960     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1961        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1962        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1963        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1964        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1965        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1966        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1967        MOVE DD-CARR1-SECPAY-SW
  1968                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1969     END-IF
  1970                                                                  ELCDTERX
  1971     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1972     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1973        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1974        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1975        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1976        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1977        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1978        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1979        MOVE DD-CARR2-SECPAY-SW
  1980                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1981     END-IF
  1982                                                                  ELCDTERX
  1983                                                                  ELCDTERX
  1984     GO TO 0005-READ--CARD.                                       ELCDTERX
  1985                                                                  ELCDTERX
  1986 0020-READ--STAT.                                                 ELCDTERX
  1987     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1988     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  37
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1989        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1990         GO TO 0005-READ--CARD.                                   ELCDTERX
  1991                                                                  ELCDTERX
  1992     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1993     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1994     GO TO 0020-READ--STAT.                                       ELCDTERX
  1995                                                                  ELCDTERX
  1996 0025-READ--BUSC.                                                 ELCDTERX
  1997     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1998     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1999        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2000         GO TO 0005-READ--CARD.                                   ELCDTERX
  2001                                                                  ELCDTERX
  2002     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2003     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2004     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2005                                                                  ELCDTERX
  2006 0030-READ--MORT.                                                 ELCDTERX
  2007     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2008     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2009        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2010         GO TO 0005-READ--CARD.                                   ELCDTERX
  2011                                                                  ELCDTERX
  2012     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2013     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2014     GO TO 0030-READ--MORT.                                       ELCDTERX
  2015                                                                  ELCDTERX
  2016 0035-READ--CLXX.                                                 ELCDTERX
  2017     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2018          GO TO 0005-READ--CARD.                                  ELCDTERX
  2019                                                                  ELCDTERX
  2020     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2021         DISPLAY '***********************************************'ELCDTERX
  2022         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2023         DISPLAY '***********************************************'ELCDTERX
  2024         GO TO 0055-READ--STOP.                                   ELCDTERX
  2025                                                                  ELCDTERX
  2026     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2027        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2028         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2029                                                                  ELCDTERX
  2030     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2031        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2032         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2033                                                                  ELCDTERX
  2034*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2035     GO TO 0005-READ--CARD.                                       ELCDTERX
  2036                                                                  ELCDTERX
  2037 0040-READ--CLAI.                                                 ELCDTERX
  2038     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2039     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2040        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2041         GO TO 0005-READ--CARD.                                   ELCDTERX
  2042                                                                  ELCDTERX
  2043     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2044     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2045     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2046                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  38
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2047 0045-READ--DUMP.                                                 ELCDTERX
  2048     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2049     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2050                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2051     PERFORM ABEND-PGM.                                           ELCDTERX
  2052                                                                  ELCDTERX
  2053 0050-READ--POXX.                                                 ELCDTERX
  2054     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2055         GO TO 0005-READ--CARD.                                   ELCDTERX
  2056                                                                  ELCDTERX
  2057     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2058         DISPLAY '***********************************************'ELCDTERX
  2059         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2060         DISPLAY '***********************************************'ELCDTERX
  2061         GO TO 0055-READ--STOP.                                   ELCDTERX
  2062                                                                  ELCDTERX
  2063     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2064     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2065     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2066     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2067                                                                  ELCDTERX
  2068     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2069         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2070     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2071         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2072                                                                  ELCDTERX
  2073     GO TO 0005-READ--CARD.                                       ELCDTERX
  2074                                                                  ELCDTERX
  2075 0055-READ--STOP.                                                 ELCDTERX
  2076     GOBACK.                                                      ELCDTERX
  2077                                                                  ELCDTERX
  2078 0060-READ--TEST.                                                 ELCDTERX
  2079     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2080        CLAX-ID         = SPACE  OR                               ELCDTERX
  2081        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2082         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2083                                                                  ELCDTERX
  2084     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2085     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2086                                                                  ELCDTERX
  2087 0065-READ--COLC.                                                 ELCDTERX
  2088     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2089     GO TO 0005-READ--CARD.                                       ELCDTERX
  2090                                                                  ELCDTERX
  2091 0070-READ--OPCA.                                                 ELCDTERX
  2092                                                                  ELCDTERX
  2093     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2094                                                                  ELCDTERX
  2095     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2096             OR                                                   ELCDTERX
  2097         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2098         GO TO 0005-READ--CARD.                                   ELCDTERX
  2099                                                                  ELCDTERX
  2100     ADD 1                       TO INDEXCA.                      ELCDTERX
  2101     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2102                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2103     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2104                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  39
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2105 0072-READ--OPST.                                                 ELCDTERX
  2106                                                                  ELCDTERX
  2107     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2108                                                                  ELCDTERX
  2109     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2110             OR                                                   ELCDTERX
  2111         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2112         GO TO 0005-READ--CARD.                                   ELCDTERX
  2113                                                                  ELCDTERX
  2114     ADD 1                       TO INDEXST.                      ELCDTERX
  2115     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2116                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2117     GO TO 0072-READ--OPST.                                       ELCDTERX
  2118                                                                  ELCDTERX
  2119 0074-READ--OPBS.                                                 ELCDTERX
  2120                                                                  ELCDTERX
  2121     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2122                                                                  ELCDTERX
  2123     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2124             OR                                                   ELCDTERX
  2125         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2126         GO TO 0005-READ--CARD.                                   ELCDTERX
  2127                                                                  ELCDTERX
  2128     ADD 1                       TO INDEXBS.                      ELCDTERX
  2129     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2130     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2131                                                                  ELCDTERX
  2132 0079-READ--EXIT.                                                 ELCDTERX
  2133*    EXIT.                                                        ELCDTERX
  2134******************************************************************ELCDTERX
  2135*************************************************************
  2136     PERFORM 0000-HOUSEKEEPING       THRU 0000-EXIT
  2137
  2138     PERFORM 1000-PROCESS            THRU 1000-EXIT
  2139         UNTIL EOF-DETEXT
  2140
  2141     CLOSE DETEXTR
  2142           FREEDOM-EXTRACT
  2143           CSI-FREEDOM-EXTRACT
  2144           CCC-FREEDOM-EXTRACT
  2145           ERACCT
  2146     GOBACK.
  2147
  2148
  2149 1000-PROCESS.
  2150
  2151     PERFORM 1100-GET-LOGIC-RECORD   THRU 1100-EXIT
  2152          WITH TEST AFTER
  2153              UNTIL VALID-RECORD OR EOF-DETEXT
  2154
  2155     IF EOF-DETEXT
  2156         GO TO 1000-EXIT
  2157     END-IF
  2158
  2159*    IF DE-ADDL-CLP = +0
  2160*        GO TO 1000-EXIT
  2161*    END-IF
  2162
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  40
* FNB169.cbl
  2163     MOVE SPACES                     TO WS-EXTRACT-RECORD
  2164
  2165     MOVE 'LOGIC '                   TO FX-SOURCE-CODE
  2166     MOVE '11'                       TO FX-DIVISION
  2167     MOVE ' '                        TO FX-FY-REN
  2168
  2169     MOVE CYCLE-DATE                 TO FX-POSTING-DATE
  2170     MOVE DE-CERT                    TO FX-POLICY-NO
  2171
  2172     IF DE-CLP-STATE = SPACES
  2173        MOVE DE-STATE                TO DE-CLP-STATE
  2174     END-IF
  2175     MOVE DE-CLP-STATE               TO FX-STATE
  2176*    MOVE DE-STATE                   TO FX-STATE
  2177     MOVE 'Y'                        TO FX-LOC-CODE
  2178
  2179     PERFORM 1300-GET-ADDR           THRU 1300-EXIT
  2180
  2181*    DISPLAY ' CARRIER = ' DE-CARRIER
  2182*    MOVE '3'                    TO DE-CARRIER
  2183
  2184     IF DE-CARRIER = '3' OR '4'
  2185        MOVE 'CSIDCCFEES'        TO FX-SYSTEM
  2186     ELSE
  2187       IF DE-CARRIER = '5' OR '6'
  2188          MOVE 'CCCDCCFEES'      TO FX-SYSTEM
  2189          MOVE '50'              TO FX-DIVISION
  2190       ELSE
  2191        MOVE 'LPAC LOGIC'        TO FX-SYSTEM
  2192       END-IF
  2193     END-IF
  2194
  2195     MOVE DE-ACCT-PRIME              TO FX-AGENT-01
  2196     MOVE '6211'                     TO FX-COST-CENTER
  2197     MOVE ' '                        TO FX-DISTR
  2198     MOVE ' '                        TO FX-SOURCE-ACCT
  2199     MOVE ' '                        TO FX-REFERENCE
  2200
  2201     MOVE +1                         TO AGT-LEVEL
  2202
  2203
  2204     PERFORM UNTIL AGT-LEVEL > +10
  2205
  2206*    DISPLAY 'DE CERT ' DE-CERT
  2207*    DISPLAY 'AGT LEVEL ' AGT-LEVEL
  2208*    DISPLAY 'DE-AGT ' DE-AGT (AGT-LEVEL)
  2209*    DISPLAY 'DE-AGT-TYPE ' DE-AGT-TYPE (AGT-LEVEL)
  2210*    DISPLAY 'DE-TRAN ' DE-TRANS
  2211     MOVE DE-L-PC (AGT-LEVEL) TO TEST-DISP-L-PC
  2212*    DISPLAY 'DE-L-PC ' TEST-DISP-L-PC
  2213     MOVE DE-A-PC (AGT-LEVEL) TO TEST-DISP-A-PC
  2214*    DISPLAY 'DE-A-PC ' TEST-DISP-A-PC
  2215
  2216         EVALUATE DE-TRANS
  2217          WHEN 'I'
  2218            EVALUATE TRUE
  2219              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2220                MOVE 'ISSUE INCENTIVE'     TO FX-DESCRIPTION
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  41
* FNB169.cbl
  2221                MOVE '01'                  TO FX-SUB-TYPE
  2222                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2223                                    * -1
  2224                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2225                MOVE '70'                  TO FX-TRAN-TYPE
  2226                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2227                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2228                MOVE '90'                  TO FX-TRAN-TYPE
  2229                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2230
  2231              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2232                MOVE 'ISSUE LMBA FEE'      TO FX-DESCRIPTION
  2233                MOVE '01'                  TO FX-SUB-TYPE
  2234                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2235                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2236                                    * -1
  2237                ELSE
  2238                   COMPUTE WS-LF-WORK ROUNDED = DE-REI-LFPRM *
  2239                      DE-L-PC (AGT-LEVEL)
  2240                   COMPUTE WS-AH-WORK ROUNDED = DE-REI-AHPRM *
  2241                      DE-A-PC (AGT-LEVEL)
  2242                   COMPUTE FX-AMOUNT ROUNDED = (WS-LF-WORK +
  2243                      WS-AH-WORK) * -1
  2244                END-IF
  2245                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2246                MOVE '75'                  TO FX-TRAN-TYPE
  2247                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2248                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2249                MOVE '95'                  TO FX-TRAN-TYPE
  2250                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2251
  2252              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2253                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2254                MOVE 'ISSUE CONTRACT FEE'  TO FX-DESCRIPTION
  2255                MOVE '01'                  TO FX-SUB-TYPE
  2256                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2257                                    * -1
  2258                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2259                MOVE '72'                  TO FX-TRAN-TYPE
  2260                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2261                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2262                MOVE '92'                  TO FX-TRAN-TYPE
  2263                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2264
  2265              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'N')
  2266                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2267                MOVE 'ISSUE CSO ADMIN FEE'  TO FX-DESCRIPTION
  2268                MOVE '01'                  TO FX-SUB-TYPE
  2269                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2270                                    * -1
  2271                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2272                MOVE '77'                  TO FX-TRAN-TYPE
  2273                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2274                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2275                MOVE '97'                  TO FX-TRAN-TYPE
  2276                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2277            END-EVALUATE
  2278          WHEN '8'
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  42
* FNB169.cbl
  2279            EVALUATE TRUE
  2280              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2281                MOVE 'ISSUE RC-L INCENTIVE'
  2282                                           TO FX-DESCRIPTION
  2283                MOVE '01'                  TO FX-SUB-TYPE
  2284                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2285                                    * -1
  2286                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2287                MOVE '70'                  TO FX-TRAN-TYPE
  2288                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2289                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2290                MOVE '90'                  TO FX-TRAN-TYPE
  2291                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2292
  2293              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2294                MOVE 'ISSUE RC-L LMBA FEE' TO FX-DESCRIPTION
  2295                MOVE '01'                  TO FX-SUB-TYPE
  2296                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2297                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2298                                    * -1
  2299                ELSE
  2300                   COMPUTE FX-AMOUNT ROUNDED = ((DE-REI-LFPRM
  2301                      * DE-L-PC (AGT-LEVEL)) + (DE-REI-AHPRM
  2302                      * DE-A-PC (AGT-LEVEL))) * -1
  2303                END-IF
  2304                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2305                MOVE '75'                  TO FX-TRAN-TYPE
  2306                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2307                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2308                MOVE '95'                  TO FX-TRAN-TYPE
  2309                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2310
  2311              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2312                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2313                MOVE 'ISSUE RC-L CONTRACT FEE'
  2314                                           TO FX-DESCRIPTION
  2315                MOVE '01'                  TO FX-SUB-TYPE
  2316                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2317                                    * -1
  2318                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2319                MOVE '72'                  TO FX-TRAN-TYPE
  2320                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2321                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2322                MOVE '92'                  TO FX-TRAN-TYPE
  2323                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2324
  2325            END-EVALUATE
  2326          WHEN 'C'
  2327            EVALUATE TRUE
  2328              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I'
  2329                MOVE 'CANCEL MGT FEE  '    TO FX-DESCRIPTION
  2330                MOVE '01'                  TO FX-SUB-TYPE
  2331                COMPUTE A-OW = DE-A-PC (AGT-LEVEL) * 1000
  2332                PERFORM 2530-CALC-DDF-FEES THRU 2530-EXIT
  2333                move cnc-wk to fx-amount
  2334                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2335                MOVE '70'                  TO FX-TRAN-TYPE
  2336                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  43
* FNB169.cbl
  2337                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2338                MOVE '90'                  TO FX-TRAN-TYPE
  2339                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2340              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'J'
  2341                MOVE 'CANCEL SLS MKT  '    TO FX-DESCRIPTION
  2342                MOVE '01'                  TO FX-SUB-TYPE
  2343                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2344                IF DE-CANCEL-REASON = 'R'
  2345                   MOVE +1      TO WS-CNC-FACT
  2346                END-IF
  2347                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2348                                    * WS-CNC-FACT
  2349                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2350                MOVE '70'                  TO FX-TRAN-TYPE
  2351                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2352                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2353                MOVE '90'                  TO FX-TRAN-TYPE
  2354                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2355
  2356              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2357                MOVE 'CANCEL LMBA FEE'     TO FX-DESCRIPTION
  2358                MOVE '01'                  TO FX-SUB-TYPE
  2359                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2360                   IF DE-AH-PRM NOT = ZEROS
  2361                      COMPUTE WS-CNC-FACT ROUNDED = DE-AH-RFND /
  2362                         DE-AH-PRM
  2363                      IF DE-CANCEL-REASON = 'R'
  2364                         MOVE +1 TO WS-CNC-FACT
  2365                      END-IF
  2366                      COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL)
  2367                         * 1000 * WS-CNC-FACT
  2368                   END-IF
  2369                ELSE
  2370                   MOVE ZEROS   TO WS-WORK-AMT
  2371                   IF DE-LF-PRM NOT = ZEROS
  2372                      COMPUTE WS-CNC-FACT ROUNDED = DE-LF-RFND /
  2373                         DE-LF-PRM
  2374                      COMPUTE WS-WORK-AMT ROUNDED =
  2375                        (DE-L-PC (AGT-LEVEL) * DE-REI-LFPRM)
  2376                          * WS-CNC-FACT
  2377                   END-IF
  2378                   IF DE-AH-PRM NOT = ZEROS
  2379                      COMPUTE WS-CNC-FACT ROUNDED = DE-AH-RFND /
  2380                         DE-AH-PRM
  2381                      COMPUTE WS-WORK-AMT ROUNDED = WS-WORK-AMT +
  2382                     ((DE-A-PC (AGT-LEVEL) * DE-REI-AHPRM)
  2383                        * WS-CNC-FACT)
  2384                   END-IF
  2385                   MOVE WS-WORK-AMT TO FX-AMOUNT
  2386                END-IF
  2387                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2388                MOVE '75'                  TO FX-TRAN-TYPE
  2389                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2390                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2391                MOVE '95'                  TO FX-TRAN-TYPE
  2392                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2393
  2394              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  44
* FNB169.cbl
  2395                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2396                MOVE 'CANCEL CONTRACT FEE' TO FX-DESCRIPTION
  2397                MOVE '01'                  TO FX-SUB-TYPE
  2398                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2399                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2400                                    * WS-CNC-FACT
  2401                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2402                MOVE '72'                  TO FX-TRAN-TYPE
  2403                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2404                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2405                MOVE '92'                  TO FX-TRAN-TYPE
  2406                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2407
  2408              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'N')
  2409                AND (DE-A-PC (AGT-LEVEL) NOT = ZEROS)
  2410                MOVE 'CANCEL CSO ADMIN FEE' TO FX-DESCRIPTION
  2411                MOVE '01'                  TO FX-SUB-TYPE
  2412
  2413                COMPUTE A-OW = DE-A-PC (AGT-LEVEL) * 1000
  2414                PERFORM 2530-CALC-DDF-FEES THRU 2530-EXIT
  2415
  2416                MOVE CNC-WK      TO FX-AMOUNT
  2417                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2418                MOVE '77'                  TO FX-TRAN-TYPE
  2419                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2420                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2421                MOVE '97'                  TO FX-TRAN-TYPE
  2422                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2423
  2424            END-EVALUATE
  2425          WHEN '7'
  2426            EVALUATE TRUE
  2427              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2428                MOVE 'CANCEL RC-L INCENTIVE'
  2429                                           TO FX-DESCRIPTION
  2430                MOVE '01'                  TO FX-SUB-TYPE
  2431                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2432                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2433                                    * WS-CNC-FACT
  2434                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2435                MOVE '70'                  TO FX-TRAN-TYPE
  2436                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2437                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2438                MOVE '90'                  TO FX-TRAN-TYPE
  2439                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2440
  2441              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2442                MOVE 'CANCEL RC-L LMBA FEE'
  2443                                           TO FX-DESCRIPTION
  2444                MOVE '01'                  TO FX-SUB-TYPE
  2445                IF DE-AH-PRM NOT = ZEROS
  2446                   COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2447                ELSE
  2448                   MOVE ZEROS   TO WS-CNC-FACT
  2449                END-IF
  2450                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2451                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2452                                    * WS-CNC-FACT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  45
* FNB169.cbl
  2453                ELSE
  2454                   COMPUTE WS-WORK-AMT = (DE-A-PC (AGT-LEVEL) *
  2455                      DE-REI-AHPRM)  * WS-CNC-FACT
  2456                   IF DE-LF-PRM NOT = ZEROS
  2457                      COMPUTE WS-LF-CNC-FACT = DE-LF-RFND /
  2458                         DE-LF-PRM
  2459                      COMPUTE FX-AMOUNT ROUNDED = WS-WORK-AMT +
  2460                       ((DE-L-PC (AGT-LEVEL) * DE-REI-LFPRM)
  2461                          * WS-LF-CNC-FACT)
  2462                   END-IF
  2463                END-IF
  2464                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2465                MOVE '75'                  TO FX-TRAN-TYPE
  2466                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2467                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2468                MOVE '95'                  TO FX-TRAN-TYPE
  2469                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2470
  2471              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2472                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2473                MOVE 'CANCEL RC-L CONTRACT FEE'
  2474                                           TO FX-DESCRIPTION
  2475                MOVE '01'                  TO FX-SUB-TYPE
  2476                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2477                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2478                                    * WS-CNC-FACT
  2479                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2480                MOVE '72'                  TO FX-TRAN-TYPE
  2481                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2482                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2483                MOVE '92'                  TO FX-TRAN-TYPE
  2484                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2485            END-EVALUATE
  2486         END-EVALUATE
  2487         MOVE FX-AMOUNT TO TEST-DISP-FX-AMT
  2488*        DISPLAY 'FX AMT ' TEST-DISP-FX-AMT
  2489*        DISPLAY ' '
  2490
  2491         ADD +1                      TO AGT-LEVEL
  2492     END-PERFORM
  2493
  2494     .
  2495 1000-EXIT.
  2496     EXIT.
  2497
  2498 1010-WRITE-EXTRACT.
  2499
  2500     IF DE-CARRIER = '3' OR '4'
  2501        WRITE CSI-EXTRACT-RECORD
  2502                     FROM WS-EXTRACT-RECORD
  2503     ELSE
  2504       IF DE-CARRIER = '5' OR '6'
  2505          WRITE CCC-EXTRACT-RECORD FROM
  2506                WS-EXTRACT-RECORD
  2507       ELSE
  2508        WRITE EXTRACT-RECORD
  2509                     FROM WS-EXTRACT-RECORD
  2510       END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  46
* FNB169.cbl
  2511     END-IF
  2512
  2513     .
  2514 1010-EXIT.
  2515     EXIT.
  2516
  2517 1100-GET-LOGIC-RECORD.
  2518
  2519     MOVE '0'                        TO VALID-RECORD-SW
  2520     READ DETEXTR
  2521         AT END GO TO 1100-EXIT
  2522     END-READ
  2523
  2524     IF DE-REIN NOT = SPACE
  2525         GO TO 1100-EXIT
  2526     END-IF
  2527
  2528     IF DE-TRANS = 'I' OR 'C' OR '7' OR '8'
  2529         CONTINUE
  2530     ELSE
  2531         GO TO 1100-EXIT
  2532     END-IF
  2533
  2534     IF DE-ENTRY-STATUS = 'M'
  2535        GO TO 1100-EXIT
  2536     END-IF
  2537
  2538     IF (DE-TRANS = 'I' OR '8')
  2539       AND (DE-ENTRY-STATUS = '3' OR '5')
  2540         GO TO 1100-EXIT
  2541     END-IF
  2542
  2543     IF (DE-LF-TYPE = ZERO)  AND
  2544        (DE-AH-TYPE = ZERO)
  2545           GO TO 1100-EXIT
  2546     END-IF
  2547
  2548     SET VALID-RECORD TO TRUE
  2549
  2550     .
  2551 1100-EXIT.
  2552     EXIT.
  2553
  2554
  2555 1300-GET-ADDR.
  2556
  2557     MOVE DE-COMPANY-CD          TO AM-COMPANY-CD
  2558     MOVE DE-CNTRL1              TO AM-CNTRL-1
  2559     MOVE DE-EFF                 TO AM-EXPIRE-DT
  2560
  2561     START ERACCT KEY >= AM-CONTROL-PRIMARY
  2562
  2563     IF ERACCT-STATUS NOT = '00'
  2564         DISPLAY 'ERROR ON ERACCT START ' ERACCT-STATUS
  2565         GO TO 1300-EXIT
  2566     END-IF
  2567
  2568     MOVE '0' TO END-OF-SEARCH-SW
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  47
* FNB169.cbl
  2569     MOVE ' '                    TO WS-DCC-PRODUCT-CODE
  2570
  2571     PERFORM UNTIL END-OF-SEARCH
  2572        READ ERACCT NEXT
  2573
  2574        IF ERACCT-STATUS = '00'
  2575           IF (AM-COMPANY-CD = DE-COMPANY-CD)
  2576              AND (AM-CNTRL-1 = DE-CNTRL1)
  2577              MOVE SPACES        TO FX-CITY
  2578              STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  2579                DELIMITED BY '  ' INTO FX-CITY
  2580              END-STRING
  2581              MOVE AM-ZIP        TO FX-ZIP-CODE
  2582              IF (DE-EFF >= AM-EFFECT-DT)
  2583                 AND (DE-EFF < AM-EXPIRE-DT)
  2584                 MOVE AM-DCC-PRODUCT-CODE
  2585                                 TO WS-DCC-PRODUCT-CODE
  2586              END-IF
  2587           ELSE
  2588              SET END-OF-SEARCH  TO TRUE
  2589           END-IF
  2590        ELSE
  2591           DISPLAY 'ERACCT READ NEXT STATUS ' ERACCT-STATUS
  2592           SET END-OF-SEARCH     TO TRUE
  2593        END-IF
  2594     END-PERFORM
  2595
  2596     MOVE FX-CITY                    TO FNX001-DATA
  2597     CALL 'FNX001' USING FNX001-PARMS
  2598     MOVE FNX001-CITY                TO FX-CITY
  2599
  2600     .
  2601 1300-EXIT.
  2602     EXIT.
  2603
  2604
  2605 1400-OTHER-FX-DATA.
  2606
  2607     IF FX-STATE NOT= SPACES
  2608         SEARCH ALL STATE-TABLE
  2609             AT END DISPLAY 'INVALID STATE CODE: ' FX-STATE
  2610             WHEN ST-STATE (ST-INDEX) = FX-STATE
  2611                 MOVE ST-ALT-STATE (ST-INDEX) TO FX-STATE
  2612         END-SEARCH
  2613     END-IF
  2614
  2615     MOVE SYSTEM-DATE                TO FX-JOURNAL-DATE
  2616
  2617**** THE '*' IN POSITION 250 ENSURES A 250 BYTE RECORD IS PASSED
  2618**** TO FREEDOM - PREVENTS TRUNCATION OF BLANK FIELDS
  2619     MOVE '*'                        TO WS-EXTRACT-RECORD(250:1)
  2620
  2621     .
  2622 1400-EXIT.
  2623     EXIT.
  2624
  2625 2520-REF-CSO-ADMIN-FEE.
  2626
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  48
* FNB169.cbl
  2627     IF DE-CERT-NO = WS-FACT-CERT
  2628        CONTINUE
  2629     ELSE
  2630        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2631     END-IF
  2632
  2633     MOVE ZEROS                  TO CNC-WK
  2634
  2635     EVALUATE TRUE
  2636        WHEN (DE-DCC-DDF-REM-TRM3 = 0)
  2637           OR (DE-CANCEL-REASON = 'R')
  2638           DISPLAY ' REM TERM = 0 OR REPO'
  2639           MOVE 0                TO CNC-WK
  2640
  2641        when de-ah-rfnd = de-ah-prm
  2642           display ' full refund '
  2643           move a-ow             to cnc-wk
  2644        WHEN DE-DCC-DDF-REM-TRM3 = DE-AH-TERM
  2645           DISPLAY ' REM TERM  = ORIG TERM '
  2646           MOVE A-OW             TO CNC-WK
  2647
  2648        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4
  2649           DISPLAY ' ORIG TERM - REM TRM < 4 '
  2650           COMPUTE W-FACTOR ROUNDED = A-OW -
  2651              (DD-1ST-YR-ALLOW (D1)
  2652              * WS-MONTH / 3) - (A-OW - DD-1ST-YR-ALLOW (D1))
  2653              * (1 - WS-HI-UEF) * WS-MONTH / 12
  2654           COMPUTE CNC-WK = W-FACTOR * 1
  2655
  2656**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
  2657
  2658        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13
  2659           DISPLAY ' ORIG TERM - REM TRM < 13 '
  2660           COMPUTE W-FACTOR ROUNDED = (a-ow -
  2661              DD-1ST-YR-ALLOW (D1))
  2662              - (a-ow - DD-1ST-YR-ALLOW (D1))
  2663              * (1 - WS-hi-UEF) * ws-MONTH / 12
  2664           COMPUTE CNC-WK = W-FACTOR * 1
  2665
  2666****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
  2667
  2668        WHEN OTHER
  2669           DISPLAY ' OTHER '
  2670           COMPUTE W-FACTOR ROUNDED = (a-ow -
  2671              DD-1ST-YR-ALLOW (D1))
  2672              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
  2673              * ws-MONTH / 12)
  2674           COMPUTE CNC-WK = W-FACTOR * 1
  2675     END-EVALUATE
  2676
  2677     .
  2678 2520-EXIT.
  2679     EXIT.
  2680
  2681 2530-CALC-DDF-FEES.
  2682
  2683*****   THIS PARA IS ONLY FOR COMM TYPES N AND I
  2684*****   DCC DDF REFUNDS ONLY
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  49
* FNB169.cbl
  2685
  2686     IF DE-CERT-NO = WS-FACT-CERT
  2687        CONTINUE
  2688     ELSE
  2689        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2690     END-IF
  2691
  2692     COMPUTE WS-MONTH =
  2693        FUNCTION REM(DE-AH-TERM - DE-DCC-DDF-REM-TRM3, 12)
  2694     IF WS-MONTH = 0
  2695        MOVE 12 TO WS-MONTH
  2696     END-IF
  2697     DISPLAY ' WS MONTH ' WS-MONTH
  2698
  2699     EVALUATE TRUE
  2700        WHEN DE-AGT-TYPE (AGT-LEVEL) = 'N'
  2701           PERFORM 2520-REF-CSO-ADMIN-FEE
  2702                                 THRU 2520-EXIT
  2703        WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'I')
  2704           AND (DE-CANCEL-REASON = 'R')
  2705              MOVE A-OW TO CNC-WK
  2706        WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'I')
  2707           EVALUATE TRUE
  2708              WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4)
  2709                 OR (NOT DD-IU-PRESENT)
  2710                 COMPUTE WS-CNC-FACT = DE-REI-AHRFND /
  2711                   DE-REI-AHPRM
  2712                 COMPUTE CNC-WK ROUNDED = WS-CNC-FACT * A-OW
  2713               WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13)
  2714                  AND (DD-IU-PRESENT)
  2715                  COMPUTE WS-CLP-MO3 = DE-REI-AHPRM -
  2716                     (DE-REI-AHPRM -
  2717                     DE-IU-RATE-UP) * (WS-HI-UEF -
  2718                     WS-LO-UEF) * 3 / 12
  2719                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
  2720                  COMPUTE WS-CNC-FACT = WS-CLP-MO3 / DE-REI-AHPRM
  2721                  COMPUTE WS-COMM-MO3 ROUNDED = WS-CNC-FACT
  2722                   * A-OW
  2723                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
  2724                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
  2725                    A-OW * WS-HI-UEF) * (WS-MONTH - 3) / 9
  2726              WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) > 12
  2727                 COMPUTE CNC-WK = A-OW *
  2728                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
  2729                    WS-MONTH / 12)
  2730           END-EVALUATE
  2731           DISPLAY ' CSO REF MGT FEE ' DE-CERT-NO ' ' CNC-WK
  2732     END-EVALUATE
  2733
  2734     .
  2735 2530-EXIT.
  2736     EXIT.
  2737
  2738 2540-CALC-DDF-COMM.
  2739
  2740     IF DE-CERT-NO = WS-FACT-CERT
  2741        DISPLAY ' FACTORS ALREADY BUILT IN 2540 ' DE-CERT-NO
  2742     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  50
* FNB169.cbl
  2743        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2744     END-IF
  2745
  2746     COMPUTE WS-MONTH =
  2747        FUNCTION REM(DE-AH-TERM - DE-DCC-DDF-REM-TRM3, 12)
  2748     IF WS-MONTH = 0
  2749        MOVE 12 TO WS-MONTH
  2750     END-IF
  2751     DISPLAY ' WS MONTH ' WS-MONTH
  2752
  2753     EVALUATE TRUE
  2754        WHEN DE-CANCEL-REASON = 'R'
  2755           MOVE A-OW             TO CNC-WK
  2756        WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4)
  2757           OR (NOT DD-IU-PRESENT)
  2758              COMPUTE WS-CNC-FACT = DE-REI-AHRFND / DE-REI-AHPRM
  2759              COMPUTE CNC-WK = WS-CNC-FACT * A-OW
  2760        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13
  2761            COMPUTE WS-CLP-MO3 = DE-REI-AHPRM - (DE-REI-AHPRM -
  2762               DE-IU-RATE-UP) * (WS-HI-UEF -
  2763               WS-LO-UEF) * 3 / 12
  2764            DISPLAY ' UECLPMO3 ' WS-CLP-MO3
  2765            COMPUTE WS-CNC-FACT = WS-CLP-MO3 / DE-REI-AHPRM
  2766            COMPUTE WS-COMM-MO3 ROUNDED = WS-CNC-FACT * A-OW
  2767            DISPLAY ' UECOMMO3 ' WS-COMM-MO3
  2768            COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
  2769              A-OW * WS-HI-UEF) * (WS-MONTH - 3) / 9
  2770        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) > 12
  2771           COMPUTE CNC-WK = a-ow * (WS-HI-UEF - (WS-HI-UEF -
  2772              WS-LO-UEF) * ws-MONTH / 12)
  2773     END-EVALUATE
  2774
  2775     DISPLAY ' CSO REF comm    ' DE-CERT-NO ' ' CNC-WK
  2776
  2777     .
  2778 2540-EXIT.
  2779     EXIT.
  2780
  2781 2550-GET-DDF-FACTORS.
  2782
  2783     MOVE ZEROS                  TO CNC-WK
  2784                                    WS-LO-UEF WS-HI-UEF
  2785     move ' '                    to dd-iu-sw
  2786
  2787     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
  2788        ((DE-STATE = DD-STATE (D1))
  2789        and (WS-DCC-PRODUCT-CODE = dd-product-cd (d1))
  2790*       AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
  2791        AND ('A'           = DD-BEN-TYPE   (D1))
  2792        AND (DE-AH-TYPE    = DD-BEN-CODE   (D1))
  2793        AND (DE-EFF        < DD-PROD-EXP-DT (D1)))
  2794                        OR
  2795        D1 > max-pdef
  2796     END-PERFORM
  2797     IF D1 > max-pdef
  2798        DISPLAY ' COULD NOT FIND UEP FACTORS '
  2799        GO TO 2550-EXIT
  2800     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  51
* FNB169.cbl
  2801
  2802     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  2803        (P1 > +8)
  2804        OR (DD-PROD-CODE (D1 P1) = 'I')
  2805     END-PERFORM
  2806     IF P1 < +9
  2807        display ' setting iu present to true '
  2808        SET DD-IU-PRESENT        TO TRUE
  2809     END-IF
  2810
  2811     MOVE DE-AH-TERM             TO WS-DDF-TERM
  2812
  2813     IF (DE-LOAN-TERM > WS-DDF-TERM)
  2814        AND (DD-TRUNCATED (D1) = 'Y')
  2815        MOVE DE-LOAN-TERM        TO WS-DDF-TERM
  2816        DISPLAY ' FOUND TRUNCATED ' DE-CERT-NO
  2817     END-IF
  2818
  2819     EVALUATE TRUE
  2820        WHEN WS-DDF-TERM > +168
  2821           MOVE 15               TO P1
  2822        WHEN WS-DDF-TERM > +156
  2823           MOVE 14               TO P1
  2824        WHEN WS-DDF-TERM > +144
  2825           MOVE 13               TO P1
  2826        WHEN WS-DDF-TERM > +132
  2827           MOVE 12               TO P1
  2828        WHEN WS-DDF-TERM > +120
  2829           MOVE 11               TO P1
  2830        WHEN WS-DDF-TERM > +108
  2831           MOVE 10               TO P1
  2832        WHEN WS-DDF-TERM > +96
  2833           MOVE 9                TO P1
  2834        WHEN WS-DDF-TERM > +84
  2835           MOVE 8                TO P1
  2836        WHEN WS-DDF-TERM > +72
  2837           MOVE 7                TO P1
  2838        WHEN WS-DDF-TERM > +60
  2839           MOVE 6                TO P1
  2840        WHEN WS-DDF-TERM > +48
  2841           MOVE 5                TO P1
  2842        WHEN WS-DDF-TERM > +36
  2843           MOVE 4                TO P1
  2844        WHEN WS-DDF-TERM > +24
  2845           MOVE 3                TO P1
  2846        WHEN WS-DDF-TERM > +12
  2847           MOVE 2                TO P1
  2848        WHEN OTHER
  2849           MOVE 1                TO P1
  2850     END-EVALUATE
  2851
  2852     EVALUATE TRUE
  2853*       WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +13)
  2854*          and (dd-iu-present)
  2855*          MOVE 2                TO P2
  2856*       WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +13
  2857*          MOVE 1                TO P2
  2858        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +25
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  52
* FNB169.cbl
  2859           MOVE 2                TO P2
  2860        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +37
  2861           MOVE 3                TO P2
  2862        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +49
  2863           MOVE 4                TO P2
  2864        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +61
  2865           MOVE 5                TO P2
  2866        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +73
  2867           MOVE 6                TO P2
  2868        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +85
  2869           MOVE 7                TO P2
  2870        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +97
  2871           MOVE 8                TO P2
  2872        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +109
  2873           MOVE 9                TO P2
  2874        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +121
  2875           MOVE 10               TO P2
  2876        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +133
  2877           MOVE 11               TO P2
  2878        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +145
  2879           MOVE 12               TO P2
  2880        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +157
  2881           MOVE 13               TO P2
  2882        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +169
  2883           MOVE 14               TO P2
  2884        WHEN OTHER
  2885           MOVE 15               TO P2
  2886     END-EVALUATE
  2887
  2888     MOVE DE-CERT-NO             TO WS-FACT-CERT
  2889     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
  2890                                 TO WS-LO-UEF
  2891     MOVE DD-UEP-FACTOR (D1 P1 P2)
  2892                                 TO WS-HI-UEF
  2893
  2894     .
  2895 2550-EXIT.
  2896     EXIT.
  2897
  2898 0000-HOUSEKEEPING.
  2899
  2900     CALL 'DATEEDIT' USING CYCLE-DATE,  DATE-SW
  2901     IF NOT VALID-DATE
  2902         DISPLAY 'INVALID DATE PARAMETER: ' CYCLE-DATE
  2903         PERFORM ABEND-PGM           THRU ABEND-EXIT
  2904     END-IF
  2905
  2906     MOVE FUNCTION CURRENT-DATE      TO FUNCTION-DATE
  2907     MOVE WS-FN-MO                   TO SYS-MO
  2908     MOVE WS-FN-DA                   TO SYS-DA
  2909     MOVE WS-FN-CCYR                 TO SYS-CCYY
  2910
  2911     OPEN INPUT  ERACCT ERPDEF
  2912                 DETEXTR
  2913          OUTPUT FREEDOM-EXTRACT CSI-FREEDOM-EXTRACT
  2914                 CCC-FREEDOM-EXTRACT
  2915
  2916     IF ERACCT-STATUS = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  53
* FNB169.cbl
  2917         CONTINUE
  2918     ELSE
  2919         DISPLAY 'OPEN ERROR ' ERACCT-STATUS ' ON ERACCT'
  2920     END-IF
  2921
  2922     IF ERPDEF-FILE-STATUS = '00' OR '97'
  2923         CONTINUE
  2924     ELSE
  2925         DISPLAY 'OPEN ERROR ' ERPDEF-FILE-STATUS ' ON ERPDEF'
  2926     END-IF
  2927
  2928     IF DTE-CLIENT = 'DCC'
  2929        MOVE 0 TO B-SUB
  2930        MOVE DTE-CLASIC-COMPANY-CD
  2931                                 TO PD-CONTROL-PRIMARY
  2932        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  2933        IF ERPDEF-FILE-STATUS = '00'
  2934           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  2935              READ ERPDEF NEXT RECORD
  2936              IF ERPDEF-FILE-STATUS = '00'
  2937                 ADD 1 TO B-SUB
  2938                 IF B-SUB > max-pdef
  2939                    DISPLAY ' DDF UEP TABLE BLEW '
  2940                    GO TO ABEND-PGM
  2941                 END-IF
  2942                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  2943                 MOVE PD-PRODUCT-CD
  2944                                 TO DD-PRODUCT-CD (B-SUB)
  2945                 MOVE PD-BEN-TYPE
  2946                                 TO DD-BEN-TYPE (B-SUB)
  2947                 MOVE PD-BEN-CODE
  2948                                 TO DD-BEN-CODE (B-SUB)
  2949                 MOVE PD-PROD-EXP-DT
  2950                                 TO DD-PROD-EXP-DT (B-SUB)
  2951                 MOVE PD-1ST-YR-ADMIN-ALLOW
  2952                                 TO DD-1ST-YR-ALLOW (B-SUB)
  2953                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  2954                    P2 > +8
  2955                    MOVE PD-PROD-CODE (P2)
  2956                                 TO DD-PROD-CODE (B-SUB P2)
  2957                 END-PERFORM
  2958                 MOVE PD-EARN-FACTORS
  2959                                 TO DD-EARN-FACTORS (B-SUB)
  2960                 move pd-truncated to dd-truncated (b-sub)
  2961              END-IF
  2962           END-PERFORM
  2963        DISPLAY ' DCC PRODUCT DEF TABLE LOADED SUCCESSFULLY '
  2964        END-IF
  2965        CLOSE ERPDEF
  2966     END-IF
  2967
  2968     .
  2969 0000-EXIT.
  2970     EXIT.
  2971
  2972
  2973 ABEND-PGM SECTION.
  2974     DIVIDE WS-ZERO BY WS-ZERO       GIVING WS-ZERO.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:58 Page  54
* FNB169.cbl
  2975 ABEND-EXIT.
  2976
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:     1463132     Code:       11774
