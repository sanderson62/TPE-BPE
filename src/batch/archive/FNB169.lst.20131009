* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page   1
* FNB169.cbl
* Options: int("FNB169.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB169.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB169.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB169.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    FNB169.
     3
     4******************************************************************
     5*                                                                *
     6*            FREEDOM INTERFACE FOR DCC CONTRACT FEES             *
     7*                                                                *
     8******************************************************************
     9*                   C H A N G E   L O G
    10*
    11* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    12*-----------------------------------------------------------------
    13*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page   2
* FNB169.cbl
    14* EFFECTIVE    NUMBER
    15*-----------------------------------------------------------------
    16* 050704    2003080800002  SMVA  NEW PROGRAM FOR SECURE PAY
    17* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
    18* 021009  IR2009020900001  PEMA  ADD AGT TYPE J AS INCENTIVE
    19* 022009    2008050500001  AJRA  ADD PROCESSING FOR CCC
    20* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    21* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    22* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    23* 080212  IR2012080100002  PEMA  CORRECT AGT TYPE N
    24* 082912  IR2012080700001  PEMA  CORRECT REF ADMIN FEE
    25* 080612  IR2013080500001  PEMA  CORRECT REF CSO ADMIN FEE
    26******************************************************************
    27
    28 ENVIRONMENT DIVISION.
    29 INPUT-OUTPUT SECTION.
    30 FILE-CONTROL.
    31
    32     SELECT DETEXTR              ASSIGN TO SYS010
    33                                 FILE STATUS IS DETEXT-STATUS.
    34     SELECT FREEDOM-EXTRACT      ASSIGN TO SYS011
    35                                 ORGANIZATION IS LINE SEQUENTIAL.
    36
    37     SELECT CSI-FREEDOM-EXTRACT  ASSIGN TO SYS012
    38                                 ORGANIZATION IS LINE SEQUENTIAL.
    39
    40     SELECT CCC-FREEDOM-EXTRACT  ASSIGN TO SYS013
    41                                 ORGANIZATION IS LINE SEQUENTIAL.
    42
    43     SELECT ERACCT               ASSIGN TO ERACCT
    44                                 ORGANIZATION IS INDEXED
    45                                 ACCESS IS DYNAMIC
    46                                 RECORD KEY IS AM-CONTROL-PRIMARY
    47                                 FILE STATUS IS ERACCT-STATUS.
    48
    49     SELECT ERPDEF           ASSIGN TO ERPDEF
    50                             ACCESS IS DYNAMIC
    51                             ORGANIZATION IS INDEXED
    52                             FILE STATUS IS ERPDEF-FILE-STATUS
    53                             RECORD KEY IS PD-CONTROL-PRIMARY.
    54
    55     SELECT DISK-DATE            ASSIGN TO SYS019.
    56
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page   3
* FNB169.cbl
    58 DATA DIVISION.
    59 FILE SECTION.
    60
    61 FD  DETEXTR
    62     LABEL RECORDS ARE STANDARD
    63     RECORDING MODE IS F
    64     RECORD CONTAINS 510 CHARACTERS
    65     BLOCK CONTAINS 0 RECORDS.
*   66     COPY ECSEXT01.
    67******************************************************************04/29/98
    68*                                                                *ECSEXT01
    69*                            ECSEXT01                            *   LV015
    70*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
    71*                            VMOD=2.015                          *ECSEXT01
    72*                                                                *ECSEXT01
    73*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
    74*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
    75*                                                                *ECSEXT01
    76*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
    77*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
    78*                                                                *ECSEXT01
    79*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
    80*                                                                *ECSEXT01
    81******************************************************************ECSEXT01
    82******************************************************************
    83*                   C H A N G E   L O G
    84*
    85* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    86*-----------------------------------------------------------------
    87*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    88* EFFECTIVE    NUMBER
    89*-----------------------------------------------------------------
    90* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    91* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
    92* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    93* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
    94* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    95* 032612  CR2011110200001  PEMA  AHL CHANGES
    96******************************************************************
    97                                                                  ECSEXT01
    98 01  DETAIL-EXTRACT.                                              ECSEXT01
    99     02 DETAIL-FILE.                                              ECSEXT01
   100     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
   101         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
   102                                                                  ECSEXT01
   103     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
   104                                                                  ECSEXT01
   105     12  DE-REIN                           PIC X.                 ECSEXT01
   106                                                                  ECSEXT01
   107     12  DE-CONTROL.                                              ECSEXT01
   108         16  DE-CNTRL1.                                           ECSEXT01
   109             20  DE-CARRIER                PIC X.                 ECSEXT01
   110             20  DE-GROUPING.                                     ECSEXT01
   111                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
   112                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
   113             20  DE-STATE                  PIC XX.                ECSEXT01
   114             20  DE-ACCOUNT.                                      ECSEXT01
   115                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page   4
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   116                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
   117         16  DE-CNTRL2.                                           ECSEXT01
   118             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
   119             20  DE-CERT.                                         ECSEXT01
   120                 24 DE-CERT-NO.                                   ECSEXT01
   121                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
   122                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
   123                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
   124                                                                  ECSEXT01
   125     12  DE-TRANS                          PIC X.                 ECSEXT01
   126         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
   127         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
   128         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
   129         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
   130         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
   131         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
   132         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
   133         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
   134         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
   135         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
   136                                                                  ECSEXT01
   137     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
   138     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
   139                                                                  ECSEXT01
   140     12  DE-NAME.                                                 ECSEXT01
   141         16  DE-LNAME                      PIC X(15).             ECSEXT01
   142         16  DE-FNAME.                                            ECSEXT01
   143             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
   144             20  FILLER                    PIC X(9).              ECSEXT01
   145         16  DE-INIT                       PIC X.                 ECSEXT01
   146     12  DE-AGE                            PIC 99.                ECSEXT01
   147     12  DE-SEX                            PIC X.                 ECSEXT01
   148     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
   149                                                                  ECSEXT01
   150     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
   151     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
   152     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
   153     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
   154     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   155     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
   156     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
   157     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
   158     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   159                                                                  ECSEXT01
   160     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
   161     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
   162     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
   163     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
   164                                                                  ECSEXT01
   165     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
   166     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
   167     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
   168     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   169     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   170                                                                  ECSEXT01
   171     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
   172     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
   173     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page   5
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   174     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
   175                                                                  ECSEXT01
   176     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
   177     12  DE-ADDL-CLP REDEFINES DE-LIVES
   178                                           PIC S9(5)V99   COMP-3.
   179     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
   180     12  FILLER REDEFINES DE-NUM-BILLED.
   181         16  DE-CLP-STATE                  PIC XX.
   182         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
   183     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
   184     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
   185                                                                  ECSEXT01
   186     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
   187     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
   188     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
   189     12  DE-IG                             PIC X.                 ECSEXT01
   190     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
   191*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
   192     12  DE-MEMBER-NO.                                            ECSEXT01
   193         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
   194         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
   195         16  FILLER                        PIC X(03).             ECSEXT01
   196     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
   197                                                                  ECSEXT01
   198     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
   199         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
   200                                                                  ECSEXT01
   201     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
   202     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
   203                                                                  ECSEXT01
   204     12  DE-REI-AREA.                                             ECSEXT01
   205         16  DE-REI-COMP.                                         ECSEXT01
   206             20  DE-REINCO                 PIC XXX.               ECSEXT01
   207             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
   208         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   209         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   210         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   211         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
   212         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   213         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   214         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   215                                                                  ECSEXT01
   216     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   217     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
   218         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
   219         16  F                             PIC X.
   220*    12  FILLER                            PIC X(5).              ECSEXT01
   221                                                                  ECSEXT01
   222     12  DE-BILLED-AREA.                                          ECSEXT01
   223         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
   224             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
   225                                                                  ECSEXT01
   226         16  DE-BILL-SW                    PIC X.                 ECSEXT01
   227             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
   228             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
   229             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
   230             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
   231             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page   6
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   232             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
   233                                                                  ECSEXT01
   234         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
   235             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
   236                                                                  ECSEXT01
   237         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   238         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   239         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   240         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   241                                                                  ECSEXT01
   242         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
   243*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
   244*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
   245                                                                  ECSEXT01
   246     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
   247         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
   248         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
   249         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
   250                                                                  ECSEXT01
   251     12  DE-REVERSE-REASONS.                                      ECSEXT01
   252         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
   253         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
   254     12  DE-CANCEL-REASON                  PIC X.
   255                                                                  ECSEXT01
   256     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
   257     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
   258                                                                  ECSEXT01
   259     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
   260         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   261             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
   262         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   263             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
   264                                                                  ECSEXT01
   265     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
   266         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
   267                                                                  ECSEXT01
   268     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
   269     12  FILLER REDEFINES DE-NCL-POOL-CODE.
   270         16  DE-LOAN-TERM                  PIC S999 COMP-3.
   271         16  FILLER                        PIC X.
   272                                                                  ECSEXT01
   273****************************************************************  ECSEXT01
   274**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
   275****************************************************************  ECSEXT01
   276     12  DE-COMM-LEVELS.                                          ECSEXT01
   277         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
   278             20  DE-AGT.                                          ECSEXT01
   279                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
   280                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
   281             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
   282             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   283             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   284                                                                  ECSEXT01
   285     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
   286****************************************************************  ECSEXT01
   287*******                 CLAIM EXTRACT                      *****  ECSEXT01
   288****************************************************************  ECSEXT01
   289     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page   7
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   290     12  FILLER                            PIC X(334).            ECSEXT01
   291     12  DE-TYPE                           PIC X.                 ECSEXT01
   292         88  DE-DTH                           VALUE '1'.          ECSEXT01
   293         88  DE-AH                            VALUE '2'.          ECSEXT01
   294         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
   295         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
   296         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
   297         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
   298                                                                  ECSEXT01
   299     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
   300     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   301                                                                  ECSEXT01
   302     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
   303     12  DE-REPORTED.                                             ECSEXT01
   304         16  DE-RPT-YR                     PIC 99.                ECSEXT01
   305         16  DE-RPT-MO                     PIC 99.                ECSEXT01
   306         16  DE-RPT-DA                     PIC 99.                ECSEXT01
   307     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
   308     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
   309                                                                  ECSEXT01
   310     12  DE-CNUM                           PIC X(7).              ECSEXT01
   311     12  DE-CHECK                          PIC X(7).              ECSEXT01
   312     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
   313     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
   314     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
   315     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
   316         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
   317         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
   318         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
   319         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
   320         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
   321         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
   322         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
   323                                                                  ECSEXT01
   324     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
   325                                                                  ECSEXT01
   326     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
   327     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   328     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   329     12  FILLER                            PIC XX.                ECSEXT01
   330     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
   331                                                                  ECSEXT01
   332     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
   333     12  DE-BENEFICIARY                    PIC X(10).
   334     12  filler redefines de-beneficiary.
   335         16  de-birth-date                 pic 9(11)  comp-3.
   336         16  f                             pic x(4).
   337     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
   338     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
   339     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
   340     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
   341     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
   342     12  DE-CLM-CLASS                      PIC XX.
   343     12  DE-CLM-DEV                        PIC XXX.
   344     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
   345     12  de-xycor-cert-seq                 pic x(3).
   346     12  DE-XYCOR-CHECK-NO                 PIC X(8).
   347     12  DE-XYCOR-ACTION-CD                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page   8
* FNB169.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   348     12  DE-XYCOR-STATUS                   PIC X.
   349     12  FILLER                            PIC X(4).              ECSEXT01
   350                                                                  ECSEXT01
   351     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   352                                                                  ECSEXT01
   353****************************************************************  ECSEXT01
   354*******               RESERVE EXTRACT                      *****  ECSEXT01
   355****************************************************************  ECSEXT01
   356     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
   357     12  FILLER                            PIC X(334).            ECSEXT01
   358                                                                  ECSEXT01
   359     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
   360         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
   361         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
   362                                                                  ECSEXT01
   363     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
   364     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
   365     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
   366                                                                  ECSEXT01
   367     12  DE-CLMNO                          PIC X(7).              ECSEXT01
   368                                                                  ECSEXT01
   369     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
   370     12  DE-RSV-REPORTED.                                         ECSEXT01
   371         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
   372         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
   373         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
   374     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
   375                                                                  ECSEXT01
   376     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
   377     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
   378     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
   379                                                                  ECSEXT01
   380     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
   381     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   382     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   383                                                                  ECSEXT01
   384     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
   385                                                                  ECSEXT01
   386     12  DE-RATE-CLASS                     PIC XX.
   387     12  DE-DEV-CODE                       PIC XXX.
   388     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
   389     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
   390     12  FILLER                            PIC X(58).             ECSEXT01
   391                                                                  ECSEXT01
   392     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   393******************************************************************ECSEXT01
   394
   395 FD  FREEDOM-EXTRACT
   396     LABEL RECORDS ARE STANDARD
   397     RECORDING MODE IS F
   398     BLOCK CONTAINS 0 RECORDS.
   399 01  EXTRACT-RECORD      PIC X(250).
   400
   401 FD  CSI-FREEDOM-EXTRACT
   402     LABEL RECORDS ARE STANDARD
   403     RECORDING MODE IS F
   404     BLOCK CONTAINS 0 RECORDS.
   405 01  CSI-EXTRACT-RECORD          PIC X(250).
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page   9
* FNB169.cbl
   406
   407 FD  CCC-FREEDOM-EXTRACT
   408     LABEL RECORDS ARE STANDARD
   409     RECORDING MODE IS F
   410     BLOCK CONTAINS 0 RECORDS.
   411 01  CCC-EXTRACT-RECORD          PIC X(250).
   412
   413 FD  ERACCT.
*  414     COPY ERCACCT.
   415******************************************************************04/19/98
   416*                                                                *ERCACCT
   417*                                                                *ERCACCT
   418*                            ERCACCT                             *   LV031
   419*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   420*                            VMOD=2.031                          *ERCACCT
   421*                                                                *ERCACCT
   422*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   423*                                                                *ERCACCT
   424*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   425*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   426*                                                                *ERCACCT
   427*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   428*                                                                *ERCACCT
   429*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   430*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   431*                                                                *ERCACCT
   432*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   433*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   434*                                                                *ERCACCT
   435*   LOG = NO                                                     *ERCACCT
   436*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   437*                                                                *ERCACCT
   438*                                                                *ERCACCT
   439******************************************************************ERCACCT
   440*                   C H A N G E   L O G
   441*
   442* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   443*-----------------------------------------------------------------
   444*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   445* EFFECTIVE    NUMBER
   446*-----------------------------------------------------------------
   447* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   448* 092705    2005050300006  PEMA  ADD SPP LEASES
   449* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   450* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   451* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   452* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   453* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   454******************************************************************
   455                                                                  ERCACCT
   456 01  ACCOUNT-MASTER.                                              ERCACCT
   457     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   458         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   459                                                                  ERCACCT
   460     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   461         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   462         16  AM-MSTR-CNTRL.                                       ERCACCT
   463             20  AM-CONTROL-A.                                    ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  10
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   464                 24  AM-CARRIER            PIC X.                 ERCACCT
   465                 24  AM-GROUPING.                                 ERCACCT
   466                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   467                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   468                 24  AM-STATE              PIC XX.                ERCACCT
   469                 24  AM-ACCOUNT.                                  ERCACCT
   470                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   471                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   472             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   473                                           PIC X(19).             ERCACCT
   474             20  AM-CNTRL-B.                                      ERCACCT
   475                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   476                 24  FILLER                PIC X(4).              ERCACCT
   477             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   478                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   479                                                                  ERCACCT
   480     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   481         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   482         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   483         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   484         16  AM-VG-STATE                   PIC XX.                ERCACCT
   485         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   486         16  AM-VG-DATE.                                          ERCACCT
   487             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   488             20  FILLER                    PIC X(4).              ERCACCT
   489         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   490                                           PIC 9(11)      COMP-3. ERCACCT
   491     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   492         16  FILLER                        PIC X(10).
   493         16  AM-VG-KEY3.
   494             20  AM-VG3-ACCOUNT            PIC X(10).
   495             20  AM-VG3-EXP-DT             PIC XX.
   496         16  FILLER                        PIC X(4).
   497     12  AM-MAINT-INFORMATION.                                    ERCACCT
   498         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   499         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   500         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   501         16  FILLER                        PIC XX.                ERCACCT
   502                                                                  ERCACCT
   503     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   504     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   505                                                                  ERCACCT
   506     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   507         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   508         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   509                                                                  ERCACCT
   510     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   511     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   512                                                                  ERCACCT
   513     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   514     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   515                                                                  ERCACCT
   516     12  AM-NAME                           PIC X(30).             ERCACCT
   517     12  AM-PERSON                         PIC X(30).             ERCACCT
   518     12  AM-ADDRS                          PIC X(30).             ERCACCT
   519     12  AM-CITY.
   520         16  AM-ADDR-CITY                  PIC X(28).
   521         16  AM-ADDR-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  11
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   522     12  AM-ZIP.                                                  ERCACCT
   523         16  AM-ZIP-PRIME.                                        ERCACCT
   524             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   525                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   526             20  FILLER                    PIC X(4).              ERCACCT
   527         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   528     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   529         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   530         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   531         16  FILLER                        PIC XXX.               ERCACCT
   532     12  AM-TEL-NO.                                               ERCACCT
   533         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   534         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   535         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   536     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   537         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   538         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   539                                                                  ERCACCT
   540     12  AM-COMM-STRUCTURE.                                       ERCACCT
   541         16  AM-DEFN-1.                                           ERCACCT
   542             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   543                 24  AM-AGT.                                      ERCACCT
   544                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   545                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   546                 24  AM-COM-TYP            PIC X.                 ERCACCT
   547                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   548                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   549                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   550                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   551                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   552                 24  AM-GL-CODES           PIC X.                 ERCACCT
   553                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   554                 24  FILLER                PIC X(01).             ERCACCT
   555         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   556             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   557                 24  FILLER                PIC X(11).             ERCACCT
   558                 24  AM-L-COMA             PIC XXX.               ERCACCT
   559                 24  AM-J-COMA             PIC XXX.               ERCACCT
   560                 24  AM-A-COMA             PIC XXX.               ERCACCT
   561                 24  FILLER                PIC X(6).              ERCACCT
   562                                                                  ERCACCT
   563     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   564         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   565                                                                  ERCACCT
   566     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   567                                                                  ERCACCT
   568     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   569         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   570         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   571     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   572         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   573         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   574     12  AM-GPCD                           PIC 99.                ERCACCT
   575     12  AM-IG                             PIC X.                 ERCACCT
   576         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   577         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   578     12  AM-STATUS                         PIC X.                 ERCACCT
   579         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  12
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   580         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   581         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   582         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   583         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   584         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   585     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   586     12  AM-ID-NO                          PIC X(11).             ERCACCT
   587                                                                  ERCACCT
   588     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   589     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   590     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   591     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   592     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   593     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   594     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   595     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   596     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   597                                                                  ERCACCT
   598     12  AM-USER-FIELDS.                                          ERCACCT
   599         16  AM-FLD-1                      PIC XX.                ERCACCT
   600         16  AM-FLD-2                      PIC XX.                ERCACCT
   601         16  AM-FLD-3                      PIC XX.                ERCACCT
   602         16  AM-FLD-4                      PIC XX.                ERCACCT
   603         16  AM-FLD-5                      PIC XX.                ERCACCT
   604                                                                  ERCACCT
   605     12  AM-1ST-PROD-DATE.                                        ERCACCT
   606         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   607         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   608         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   609     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   610     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   611         16  AM-PUR-YR                     PIC XX.                ERCACCT
   612         16  AM-PUR-MO                     PIC XX.                ERCACCT
   613         16  AM-PUR-DA                     PIC XX.                ERCACCT
   614     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   615     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   616     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   617     12  AM-INACTIVE-DATE.                                        ERCACCT
   618         16  AM-INA-MO                     PIC 99.                ERCACCT
   619         16  AM-INA-DA                     PIC 99.                ERCACCT
   620         16  AM-INA-YR                     PIC 99.                ERCACCT
   621     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   622                                                                  ERCACCT
   623     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   624     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   625                                                                  ERCACCT
   626     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   627         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   628         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   629         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   630         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   631                                                                  ERCACCT
   632     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   633         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   634         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   635                                                                  ERCACCT
   636     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   637                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  13
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   638     12  AM-OVER-SHORT.                                           ERCACCT
   639         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   640         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   641                                                                  ERCACCT
   642     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   643     12  AM-DCC-CLP-STATE                  PIC XX.
   644                                                                  ERCACCT
   645     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   646     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   647                                                                  ERCACCT
   648     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   649     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   650     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   651     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   652     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   653     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   654     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   655     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   656     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   657     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   658     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   659     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   660     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   661     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   662     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   663     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   664                                                                  ERCACCT
   665     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   666                                                                  ERCACCT
   667     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   668     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   669                                                                  ERCACCT
   670     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   671     12  AM-EARN-METHODS.                                         ERCACCT
   672         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   673             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   674             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   675             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   676             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   677         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   678             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   679             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   680             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   681             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   682         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   683             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   684             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   685             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   686             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   687             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   688             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   689                                                                  ERCACCT
   690     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   691     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   692     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   693                                                                  ERCACCT
   694     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   695     12  AM-RET-P-E                        PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  14
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   696     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   697     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   698     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   699     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   700         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   701         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   702     12  AM-RETRO-EARNINGS.                                       ERCACCT
   703         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   704         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   705         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   706     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   707         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   708         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   709     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   710         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   711         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   712         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   713     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   714     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   715                                                                  ERCACCT
   716     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   717         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   718         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   719         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   720         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   721         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   722                                                                  ERCACCT
   723     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   724                                                                  ERCACCT
   725     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   726                                                                  ERCACCT
   727     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   728         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   729                                                                  ERCACCT
   730     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   731         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   732         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   733                                                                  ERCACCT
   734     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   735         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   736                                                                  ERCACCT
   737     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   738         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   739         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   740                                                                  ERCACCT
   741     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   742                                                                  ERCACCT
   743     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   744     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   745     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   746     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   747     12  AM-DCC-UEF-STATE                  PIC XX.
   748     12  FILLER                            PIC XXX.
   749     12  AM-REPORT-CODE-3                  PIC X(10).
   750*    12  FILLER                            PIC X(22).             ERCACCT
   751                                                                  ERCACCT
   752     12  AM-RESERVE-DATE.                                         ERCACCT
   753         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  15
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   754         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   755         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   756                                                                  ERCACCT
   757     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   758     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   759         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   760         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   761         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   762         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   763                                                                  ERCACCT
   764     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   765         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   766         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   767         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   768         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   769                                                                  ERCACCT
   770     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   771         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   772             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   773             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   774             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   775             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   776             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   777             20  FILLER                    PIC XX.                ERCACCT
   778         16  FILLER                        PIC X(80).             ERCACCT
   779                                                                  ERCACCT
   780     12  AM-TRANSFER-DATA.                                        ERCACCT
   781         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   782             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   783             20  AM-TRNFROM-GROUPING.                             ERCACCT
   784                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   785                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   786             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   787             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   788                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   789                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   790             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   791         16  AM-TRANSFERRED-TO.                                   ERCACCT
   792             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   793             20  AM-TRNTO-GROUPING.                               ERCACCT
   794                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   795                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   796             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   797             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   798                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   799                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   800             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   801         16  FILLER                        PIC X(10).             ERCACCT
   802                                                                  ERCACCT
   803     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   804                                                                  ERCACCT
   805     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   806         16  AM-DEFN-1-SAVED.                                     ERCACCT
   807             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   808                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   809                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   810                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   811                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  16
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   812                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   813                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   814                 24  FILLER                PIC X.                 ERCACCT
   815                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   816                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   817                 24  FILLER                PIC X.                 ERCACCT
   818         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   819             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   820                 24  FILLER                PIC X(11).             ERCACCT
   821                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   822                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   823                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   824                 24  FILLER                PIC X(6).              ERCACCT
   825                                                                  ERCACCT
   826     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   827         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   828            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   829            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   830            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   831                                                                  ERCACCT
   832     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   833     12  FILLER                            PIC X(120).            ERCACCT
   834                                                                  ERCACCT
   835     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   836         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   837         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   838             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   839             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   840                                                          COMP-3. ERCACCT
   841             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   842                                                          COMP-3. ERCACCT
   843         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   844             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   845             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   846                                                          COMP-3. ERCACCT
   847             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   848                                                          COMP-3. ERCACCT
   849                                                                  ERCACCT
   850     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   851         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   852         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   853         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   854         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   855             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   856                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   857                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   858             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   859                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   860                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   861             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   862                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   863                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   864         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   865             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   866                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   867                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   868                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   869             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  17
* FNB169.cbl (/apps/prod/cid1p/copy/ERCACCT)
   870                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   871                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   872             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   873                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   874                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   875                                                                  ERCACCT
   876     12  AM-COMMENTS.                                             ERCACCT
   877         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   878                                                                  ERCACCT
   879     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   880         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   881         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   882         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   883         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   884         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   885             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   886             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   887             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   888             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   889         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   890             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   891             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   892             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   893         16  FILLER                        PIC X(102).            ERCACCT
   894                                                                  ERCACCT
   895     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   896         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   897             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   898             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   899             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   900             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   901             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   902         16  FILLER                          PIC X(10).           ERCACCT
   903******************************************************************ERCACCT
   904
   905 FD  ERPDEF.
   906
*  907                             COPY ERCPDEF.
   908******************************************************************
   909*                                                                *
   910*                                                                *
   911*                            ERCPDEF.                            *
   912*                                                                *
   913*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   914*                                                                *
   915*    FILE TYPE = VSAM,KSDS                                       *
   916*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   917*                                                                *
   918*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   919*                                                                *
   920*    LOG = YES                                                   *
   921*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   922******************************************************************
   923 01  PRODUCT-MASTER.
   924    12  PD-RECORD-ID                 PIC X(02).
   925        88  VALID-PD-ID                  VALUE 'PD'.
   926
   927    12  PD-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  18
* FNB169.cbl (/apps/prod/cid1p/copy/ERCPDEF)
   928        16  PD-COMPANY-CD            PIC X.
   929        16  PD-STATE                 PIC XX.
   930        16  PD-PRODUCT-CD            PIC XXX.
   931        16  PD-FILLER                PIC X(7).
   932        16  PD-BEN-TYPE              PIC X.
   933        16  PD-BEN-CODE              PIC XX.
   934        16  PD-PROD-EXP-DT           PIC XX.
   935
   936    12  FILLER                       PIC X(50).
   937
   938    12  PD-PRODUCT-DATA OCCURS 8.
   939        16  PD-PROD-CODE             PIC X.
   940            88  PD-PROD-LIFE           VALUE 'L'.
   941            88  PD-PROD-PROP           VALUE 'P'.
   942            88  PD-PROD-AH             VALUE 'A'.
   943            88  PD-PROD-IU             VALUE 'I'.
   944            88  PD-PROD-GAP            VALUE 'G'.
   945        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   946        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   947        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   948        16  PD-MAX-TERM              PIC S999        COMP-3.
   949        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   950        16  FILLER                   PIC X.
   951        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   952        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   953        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   954        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   955        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   956        16  PD-REC-CRIT-PERIOD       PIC X.
   957        16  PD-RTW-MOS               PIC 99.
   958        16  FILLER                   PIC X(5).
   959
   960    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   961
   962    12  PD-TERM-LIMITS OCCURS 15.
   963        16  PD-LOW-TERM              PIC S999        COMP-3.
   964        16  PD-HI-TERM               PIC S999        COMP-3.
   965
   966*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   967    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   968        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   969        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   970
   971    12  PD-EARN-FACTORS.
   972        16  FILLER OCCURS 15.
   973            20  FILLER OCCURS 15.
   974                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   975
   976    12  PD-PRODUCT-DESC              PIC X(80).
   977    12  PD-TRUNCATED                 PIC X.
   978    12  FILLER                       PIC X(59).
   979
   980    12  PD-MAINT-INFORMATION.
   981        16  PD-LAST-MAINT-DT         PIC X(02).
   982        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   983        16  PD-LAST-MAINT-BY         PIC X(04).
   984
   985 FD  DISK-DATE
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  19
* FNB169.cbl
*  986     COPY ELCDTEFD.
   987******************************************************************04/15/98
   988*                                                                *ELCDTEFD
   989*                                                                *ELCDTEFD
   990*                            ELCDTEFD.                           *   LV002
   991*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   992*                            VMOD=2.007                          *   CL**2
   993*                                                                *ELCDTEFD
   994******************************************************************ELCDTEFD
   995     BLOCK CONTAINS 0 RECORDS
   996     RECORDING MODE F.                                            ELCDTEFD
   997                                                                  ELCDTEFD
   998 01  DATE-DISK.                                                   ELCDTEFD
   999     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1000     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1001     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1002     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1003     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1004     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1005     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1006                                                                  ELCDTEFD
  1007 01  DATE-DISK-R.                                                 ELCDTEFD
  1008     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1009     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1010                                     PIC  X(32).                  ELCDTEFD
  1011                                                                  ELCDTEFD
  1012 01  DATE-DISK-T.                                                 ELCDTEFD
  1013     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1014     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1015                                     PIC  X(48).                  ELCDTEFD
  1016                                                                  ELCDTEFD
  1017 01  DATE-DISK-M.                                                 ELCDTEFD
  1018     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1019     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1020                                     PIC  X(48).                  ELCDTEFD
  1021                                                                  ELCDTEFD
  1022 01  DATE-DISK-P.                                                 ELCDTEFD
  1023     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1024     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1025     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1026     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1027         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1028                                     PIC  X.                      ELCDTEFD
  1029         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1030     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1031         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1032             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1033             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1034             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1035             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1036         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1037                                                                  ELCDTEFD
  1038 01  DATE-DISK-E.                                                 ELCDTEFD
  1039     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1040     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1041                                     PIC  X(4).                   ELCDTEFD
  1042                                                                  ELCDTEFD
  1043 01  DATE-DISK-C.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  20
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1044     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1045     12  DD-CARR1-SECPAY-SW          PIC  X.
  1046     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1047     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1048     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1049     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1050     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1051     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1052     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1053     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1054     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1055     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1056     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1057     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1058     12  DD-CARR2-SECPAY-SW          PIC  X.
  1059     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1060                                                                  ELCDTEFD
  1061 01  DATE-DISK-OPT.                                               ELCDTEFD
  1062     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1063     12  DD-TLR-DATA.                                             ELCDTEFD
  1064         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1065                                     PIC  X(03).                  ELCDTEFD
  1066     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1067         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1068                                     PIC  X(06).                  ELCDTEFD
  1069     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1070         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1071                                     PIC  X(07).                  ELCDTEFD
  1072         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1073     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1074                                     PIC  X(96).                  ELCDTEFD
  1075******************************************************************ELCDTEFD
  1076
  1077
  1078 WORKING-STORAGE SECTION.
  1079
  1080 77  B-SUB                   PIC S9(4)   COMP.
  1081 77  D1                      PIC S999 COMP-3 VALUE +0.
  1082 77  P1                      PIC S999 COMP-3 VALUE +0.
  1083 77  P2                      PIC S999 COMP-3 VALUE +0.
  1084 77  CNC-WK                  PIC S9(7)V99 COMP-3 VALUE +0.
  1085 77  WS-MONTH                PIC S999     COMP-3 VALUE +0.
  1086 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  1087 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  1088 77  DD-IU-SW                    PIC X   VALUE ' '.
  1089     88  DD-IU-PRESENT                 VALUE 'Y'.
  1090 77  WS-FACT-CERT            PIC X(11) VALUE SPACES.
  1091 77  A-OW                        PIC S9(7)V99 COMP-3 VALUE +0.
  1092 77  W-FACTOR            PIC S9(09)V9(08) COMP-3 VALUE +0.
  1093 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  1094 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  1095 77  WS-DDF-TERM             PIC S999 COMP-3 VALUE +0.
  1096
  1097 01  WS-DCC-PRODUCT-CODE         PIC XXX  VALUE SPACES.
  1098 01  AGT-LEVEL                 COMP   PIC 9(04).
  1099 01  WS-CNC-FACT               COMP-3 PIC S9(03)V9(07) VALUE +0.
  1100 01  WS-LF-CNC-FACT            COMP-3 PIC S9(03)V9(07) VALUE +0.
  1101 01  WS-WORK-AMT               COMP-3 PIC S9(7)V99 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  21
* FNB169.cbl
  1102 01  WS-LF-WORK                  PIC S9(7)V99 VALUE +0 COMP-3.
  1103 01  WS-AH-WORK                  PIC S9(7)V99 VALUE +0 COMP-3.
  1104 01  TEST-DISP-FX-AMT PIC ZZZZZZZZ9.99.
  1105 01  TEST-DISP-L-PC PIC ZZ.ZZZZZ.
  1106 01  TEST-DISP-A-PC PIC ZZ.ZZZZZ.
  1107 01  FILLER.
  1108     05  WS-ZERO               COMP-3 PIC S9(03) VALUE +0.
  1109     05  WS-ABEND-MESSAGE             PIC X(80)  VALUE SPACES.
  1110     05  PGM-SUB               COMP   PIC S9(04) VALUE +310.
  1111     05  WS-RETURN-CODE        COMP-3 PIC S9(03) VALUE +0.
  1112
  1113     05  DETEXT-STATUS                PIC X(02)  VALUE '00'.
  1114         88  EOF-DETEXT                          VALUE '10'.
  1115
  1116     05  DATE-SW                      PIC X(01)  VALUE ' '.
  1117         88  VALID-DATE                          VALUE 'V'.
  1118
  1119     05  VALID-RECORD-SW              PIC X(01)  VALUE '0'.
  1120         88  VALID-RECORD                        VALUE '1'.
  1121
  1122     05  END-OF-SEARCH-SW             PIC X(01)  VALUE '0'.
  1123         88  END-OF-SEARCH                       VALUE '1'.
  1124
  1125     05  ERACCT-STATUS                PIC X(02)  VALUE '00'.
  1126     05  ERPDEF-FILE-STATUS           PIC XX     VALUE '00'.
  1127
  1128
  1129 01  DCC-DDF-WORK-AREA.
  1130     05  F OCCURS 800.
  1131         10  DD-STATE                 PIC XX.
  1132         10  DD-PRODUCT-CD            PIC XXX.
  1133         10  DD-FILLER                PIC X(7).
  1134         10  DD-BEN-TYPE              PIC X.
  1135         10  DD-BEN-CODE              PIC XX.
  1136         10  DD-PROD-EXP-DT           PIC XX.
  1137         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  1138         10  DD-PROD-DATA OCCURS 8.
  1139             15  DD-PROD-CODE         PIC X.
  1140         10  DD-EARN-FACTORS.
  1141             15  F OCCURS 15.
  1142                 20  F OCCURS 15.
  1143                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1144         10  DD-TRUNCATED             PIC X.
  1145
  1146 01  WS-EXTRACT-RECORD.
* 1147     COPY FNC022.
  1148     05  FX-COMMON-SECTION.                                       00010001
  1149         10  FX-SYSTEM             PIC X(10).                     00020001
  1150         10  FX-SOURCE-CODE        PIC X(6).                      00030001
  1151         10  FX-DIVISION           PIC X(2).                      00040001
  1152         10  FX-TRAN-TYPE          PIC X(2).                      00050001
  1153         10  FX-SUB-TYPE           PIC X(2).                      00060001
  1154         10  FX-CLM-RES            PIC X(2).                      00070001
  1155         10  FX-ANN-STMT           PIC X(3).                      00080001
  1156         10  FX-PLAN-CODE          PIC X(6).                      00090001
  1157         10  FX-FORM               PIC X(3).                      00091001
  1158         10  FX-JOURNAL-DATE       PIC X(8).                      00092001
  1159         10  FX-POSTING-DATE       PIC X(8).                      00093001
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  22
* FNB169.cbl (/apps/prod/cid1p/copy/FNC022)
  1160         10  FX-POLICY-NO          PIC X(10).                     00094001
  1161         10  FX-CITY               PIC X(30).                     00095002
  1162         10  FX-STATE              PIC X(2).                      00095102
  1163         10  FX-ZIP-CODE           PIC X(9).                      00096001
  1164         10  FX-LOC-CODE           PIC X.                         00096102
  1165         10  FX-FY-REN             PIC X.                         00097001
  1166         10  FX-AGENT-01           PIC X(9).                      00098001
  1167         10  FX-AGENT-50           PIC X(9).                      00099001
  1168         10  FX-COST-CENTER        PIC X(4).                      00100001
  1169         10  FX-TAXABLE            PIC X.                         00110004
  1170         10  FX-DISTR              PIC X(2).                      00120001
  1171         10  FX-SOURCE-ACCT        PIC X(10).                     00130001
  1172         10  FX-DESCRIPTION        PIC X(30).                     00140001
  1173         10  FX-REFERENCE          PIC X(10).                     00150001
  1174         10  FX-SUSPENSE           PIC X(15).                     00151002
  1175         10  FX-AMOUNT             PIC S9(10)V99                  00160001
  1176                                   SIGN IS TRAILING SEPARATE.     00170001
  1177                                                                  00180001
  1178     05  FX-CLAIM-SECTION.                                        00190001
  1179         10  FX-CLAIM-NO           PIC X(10).                     00200001
  1180         10  FX-CLAIM-TYPE         PIC X.                         00210001
  1181         10  FX-DRAFT-NO           PIC X(10).                     00220001
  1182         10  FX-DRAFT-STATUS       PIC X.                         00230001
  1183         10  FX-TAX-ID             PIC X(10).                     00240001
  1184         10  FILLER                PIC X(10).                     00250003
  1185                                                                  00290001
  1186
  1187
  1188 01  FNX001-PARMS.
  1189     05  FNX001-DATA                  PIC X(50).
  1190     05  FNX001-CITY                  PIC X(30).
  1191     05  FNX001-STATE                 PIC X(02).
  1192     05  FNX001-ZIP                   PIC X(09).
  1193
  1194 01  SYSTEM-DATE.
  1195     05  SYS-MO                       PIC 9(02).
  1196     05  SYS-DA                       PIC 9(02).
  1197     05  SYS-CCYY                     PIC 9(04).
  1198
  1199***** FUNCTION-DATE COPYBOOK
* 1200 COPY ELCFUNDT.
  1201***************************************************************** 12/03/98
  1202*                                                               * ELCFUNDT
  1203*                            ELCFUNDT.                          *    LV004
  1204*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  1205*                            VMOD=2.001                         * ELCFUNDT
  1206*                                                               * ELCFUNDT
  1207*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  1208*                                                               * ELCFUNDT
  1209***************************************************************** ELCFUNDT
  1210                                                                  ELCFUNDT
  1211                                                                  ELCFUNDT
  1212 01  FUNCTION-DATE.                                                  CL**2
  1213     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  1214     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  1215         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  1216         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  1217             15  WS-FN-CC          PIC 99.                           CL**3
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  23
* FNB169.cbl (/apps/prod/cid1p/copy/ELCFUNDT)
  1218             15  WS-FN-YR          PIC 99.                           CL**3
  1219         10  WS-FN-MO              PIC 99.                           CL**3
  1220         10  WS-FN-DA              PIC 99.                           CL**3
  1221     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  1222     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  1223     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  1224     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  1225     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  1226         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  1227         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  1228         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  1229     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  1230     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
  1231
  1232
  1233***** STATE EDIT TABLE
* 1234 COPY FNC018.
  1235***************************************************************** 00020002
  1236*                                                               * 00030002
  1237*                     STATE CODE TABLE                          * 00040002
  1238*                                                               * 00050002
  1239*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     * 00060002
  1240*            SEARCH VERB WILL NOT WORK PROPERLY !               * 00070002
  1241*                                                               * 00080002
  1242***************************************************************** 00090002
  1243*                                                                 00100002
  1244 01  STATE-VALUES.                                                00110002
  1245     05  PIC X(24)  VALUE 'AKAKALASKA              '.             00120002
  1246     05  PIC X(24)  VALUE 'ALALALABAMA             '.             00130002
  1247     05  PIC X(24)  VALUE 'ARARARKANSAS            '.             00140002
  1248     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.             00150002
  1249     05  PIC X(24)  VALUE 'AZAZARIZONA             '.             00160002
  1250     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.             00170002
  1251     05  PIC X(24)  VALUE 'CDCNCANADA              '.             00180002
  1252     05  PIC X(24)  VALUE 'CNCNCANADA              '.             00190002
  1253     05  PIC X(24)  VALUE 'COCOCOLORADO            '.             00200002
  1254     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.             00210002
  1255     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.             00220002
  1256     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.             00230002
  1257     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.             00240002
  1258     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.             00250002
  1259     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.             00260002
  1260     05  PIC X(24)  VALUE 'GUGUGUAM                '.             00270002
  1261     05  PIC X(24)  VALUE 'HIHIHAWAII              '.             00280002
  1262     05  PIC X(24)  VALUE 'IAIAIOWA                '.             00290002
  1263     05  PIC X(24)  VALUE 'IDIDIDAHO               '.             00300002
  1264     05  PIC X(24)  VALUE 'ILILILLINOIS            '.             00310002
  1265     05  PIC X(24)  VALUE 'INININDIANA             '.             00320002
  1266     05  PIC X(24)  VALUE 'KSKSKANSAS              '.             00330002
  1267     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.             00340002
  1268     05  PIC X(24)  VALUE 'LALALOUISIANA           '.             00350002
  1269     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.             00360002
  1270     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.             00370002
  1271     05  PIC X(24)  VALUE 'MEMEMAINE               '.             00380002
  1272     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.             00390002
  1273     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.             00400002
  1274     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.             00410002
  1275     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.             00420002
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  24
* FNB169.cbl (/apps/prod/cid1p/copy/FNC018)
  1276     05  PIC X(24)  VALUE 'MTMTMONTANA             '.             00430002
  1277     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.             00440002
  1278     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.             00450002
  1279     05  PIC X(24)  VALUE 'NENENEBRASKA            '.             00460002
  1280     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.             00470002
  1281     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.             00480002
  1282     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.             00490002
  1283     05  PIC X(24)  VALUE 'NVNVNEVADA              '.             00500002
  1284     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.             00510002
  1285     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.             00520002
  1286     05  PIC X(24)  VALUE 'OHOHOHIO                '.             00530002
  1287     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.             00540002
  1288     05  PIC X(24)  VALUE 'OROROREGON              '.             00550002
  1289     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.             00560002
  1290     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.             00570002
  1291     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.             00580002
  1292     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.             00590002
  1293     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.             00600002
  1294     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.             00610002
  1295     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.             00620002
  1296     05  PIC X(24)  VALUE 'TXTXTEXAS               '.             00630002
  1297     05  PIC X(24)  VALUE 'UTUTUTAH                '.             00640002
  1298     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.             00650002
  1299     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.             00660002
  1300     05  PIC X(24)  VALUE 'VTVTVERMONT             '.             00670002
  1301     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.             00680002
  1302     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.             00690002
  1303     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.             00700002
  1304     05  PIC X(24)  VALUE 'WYWYWYOMING             '.             00710002
  1305                                                                  00720002
  1306 01  FILLER REDEFINES STATE-VALUES.                               00730002
  1307     05  STATE-TABLE                                              00740002
  1308             OCCURS 60 TIMES                                      00750002
  1309             ASCENDING KEY IS ST-STATE                            00760002
  1310             INDEXED BY ST-INDEX.                                 00770002
  1311         10  ST-STATE          PIC XX.                            00780002
  1312         10  ST-ALT-STATE      PIC XX.                            00790002
  1313         10  ST-NAME           PIC X(20).                         00800002
  1314                                                                  00810002
  1316
* 1317 COPY ELCDTECX.
  1318******************************************************************06/05/98
  1319*                                                                *ELCDTECX
  1320*                            ELCDTECX.                           *   LV005
  1321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1322*                            VMOD=2.015                          *ELCDTECX
  1323*                                                                *ELCDTECX
  1324*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1325*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1326*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1327*                                                                *ELCDTECX
  1328******************************************************************ELCDTECX
  1329******************************************************************
  1330*                   C H A N G E   L O G
  1331*
  1332* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1333*-----------------------------------------------------------------
  1334*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  25
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1335* EFFECTIVE    NUMBER
  1336*-----------------------------------------------------------------
  1337* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1338*                                  BENEFIT CODES FROM 300 TO 900
  1339* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1340* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1341******************************************************************
  1342 01  DATE-CARD.                                                   ELCDTECX
  1343     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1344     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1345     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1346     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1347     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1348     12  EP-SW                       PIC  X.                      ELCDTECX
  1349         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1350     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1351         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1352     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1353     12  RUN-CENTURY.                                             ELCDTECX
  1354         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1355     12  FILLER                      PIC  X.                         CL**4
  1356     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1357     12  FILLER                      PIC  XXX.                    ELCDTECX
  1358     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1359                                                                  ELCDTECX
  1360 01  FILLER                          PIC  X(7)                       CL**6
  1361                                          VALUE 'OPTIONS'.        ELCDTECX
  1362 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1363     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1364     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1365     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1366         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1367         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1368     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1369     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1370     12  FILLER                      PIC  X.                      ELCDTECX
  1371     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1372     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1373     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1374     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1375     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1376     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1377     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1378     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1379     12  FILLER                      PIC  X.                      ELCDTECX
  1380     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1381     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1382     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1383     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1384     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1385     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1386     12  FILLER                      PIC  X.                      ELCDTECX
  1387     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1388     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1389     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1390     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1391     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1392     12  DTE-R78                     PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  26
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1393     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1394     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1395     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1396     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1397     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1398     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1399     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1400                                     PIC  X.                      ELCDTECX
  1401         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1402                                                 ' '.             ELCDTECX
  1403         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1404         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1405     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1406         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1407         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1408     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1409     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1410                                     PIC  9.                         CL**4
  1411     12  DTE-SYSTEM.                                              ELCDTECX
  1412         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1413         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1414         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1415         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1416         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1417         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1418         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1419         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1420         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1421         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1422         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1423         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1424         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1425         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1426         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1427         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1428         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1429         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1430         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1431         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1432         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1433         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1434         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1435         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1436         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1437         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1438     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1439         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1440                                     PIC  X.                      ELCDTECX
  1441     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1442                                                                  ELCDTECX
  1443 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1444     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1445     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1446     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1447*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1448     12  FILLER                      PIC  X.                      ELCDTECX
  1449     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1450     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  27
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1451     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1452     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1453     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1454     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1455     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1456                                                                  ELCDTECX
  1457     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1458     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1459     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1460     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1461                                                                  ELCDTECX
  1462     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1463     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1464     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1465     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1466                                                                  ELCDTECX
  1467     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1468     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1469                                                                  ELCDTECX
  1470     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1471     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1472                                                                  ELCDTECX
  1473     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1474                                                                  ELCDTECX
  1475 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1476     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1477     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1478     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1479     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1480     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1481     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1482     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1483                                                                  ELCDTECX
  1484 01  FILLER                          PIC  X(12)                   ELCDTECX
  1485                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1486 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1487     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1488         16  CNT-ID                  PIC  X.                      ELCDTECX
  1489         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1490                                                                  ELCDTECX
  1491 01  FILLER                          PIC  X(11)                   ELCDTECX
  1492                                          VALUE 'STATE NAMES'.    ELCDTECX
  1493 01  STATE-NAMES.                                                 ELCDTECX
  1494     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1495         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1496         16  STATE-PIC1.                                          ELCDTECX
  1497             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1498             20  FILLER              PIC  XXX.                    ELCDTECX
  1499             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1500             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1501             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1502             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1503                                                                  ELCDTECX
  1504 01  FILLER                          PIC  X(13)                   ELCDTECX
  1505                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1506 01  CARRIER-NAMES.                                               ELCDTECX
  1507     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1508         16  CARRIER-SUB             PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  28
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1509         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1510         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1511         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1512         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1513         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1514*        16  FILLER                  PIC  X.                      ELCDTECX
  1515         16  CARRIER-SEC-PAY         PIC  X.
  1516             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1517                                                                  ELCDTECX
  1518 01  FILLER                          PIC  X(9)                       CL**6
  1519                                          VALUE 'INS TYPES'.      ELCDTECX
  1520 01  CLAS-INS-TYPES.                                              ELCDTECX
  1521*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1522     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1523         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1524         16  CLAS-I-AB3.                                          ELCDTECX
  1525             20  FILLER              PIC  X.                      ELCDTECX
  1526             20  CLAS-I-AB2.                                      ELCDTECX
  1527                 24  FILLER          PIC  X.                      ELCDTECX
  1528                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1529         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1530             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1531             20  FILLER              PIC  X.                         CL**4
  1532         16  CLAS-I-AB10.                                         ELCDTECX
  1533             20  FILLER              PIC  X(9).                   ELCDTECX
  1534             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1535         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1536         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1537         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1538         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1539             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1540         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1541         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1542         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1543         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1544         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  1545         16  FILLER                  PIC  X(05).
  1546                                                                  ELCDTECX
  1547 01  FILLER                          PIC  X(16)                   ELCDTECX
  1548                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1549 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1550     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1551                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1552         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1553         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1554         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1555         16  CLAS-MORT-DESC.                                      ELCDTECX
  1556             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1557             20  FILLER              PIC  XX.                        CL**5
  1558             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1559             20  FILLER              PIC  X.                         CL**5
  1560             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1561             20  FILLER              PIC  X.                         CL**5
  1562             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1563             20  FILLER              PIC  X.                         CL**5
  1564             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1565             20  FILLER              PIC  X(5).                      CL**6
  1566                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  29
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1567 01  FILLER                          PIC  X(15)                   ELCDTECX
  1568                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1569 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1570     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1571         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1572         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1573         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1574         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1575         16  FILLER                  PIC  X(4).                      CL**6
  1576                                                                  ELCDTECX
  1577 01  FILLER                          PIC  X(7)                       CL**6
  1578                                     VALUE 'INDEXES'.             ELCDTECX
  1579 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1580     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1581     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1582     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1583     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1584     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1585     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1586     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1587     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1588     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1589     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1590     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1591     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1592     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1593     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1594     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1595     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1596     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1597                                                                  ELCDTECX
  1598 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1599     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1600     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1601     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1602     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1603     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1604     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1605     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1606     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1607     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1608     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1609     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1610                                                                  ELCDTECX
  1611 01  FILLER                          PIC  X(13)                   ELCDTECX
  1612                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1613 01  CLAS-MISC.                                                   ELCDTECX
  1614     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1615         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1616         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1617         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1618     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1619     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1620     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1621     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1622     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1623     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1624     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  30
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1625     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1626     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1627     12  STATE-L                     PIC  XX.                     ELCDTECX
  1628     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1629     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1630     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1631         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1632         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1633     12  DTE-ABEND-WORK.                                          ELCDTECX
  1634         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1635         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1636                                                                  ELCDTECX
  1637 01  FILLER                          PIC  X(12)                   ELCDTECX
  1638                                     VALUE 'WORKING DATE'.        ELCDTECX
  1639 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1640     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1641         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1642         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1643         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1644     12  WS-CURRENT-DATE.                                         ELCDTECX
  1645         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1646         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1647         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1648         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1649         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1650     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1651         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1652         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1653                                                                  ELCDTECX
  1654 01  FILLER                          PIC  X(12)                   ELCDTECX
  1655                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1656 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1657     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1658         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1659         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1660         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1661                                                                  ELCDTECX
  1662 01  FILLER                          PIC  X(10)                   ELCDTECX
  1663                                     VALUE 'STATE TLRS'.          ELCDTECX
  1664 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1665     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1666         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1667         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1668                                                                  ELCDTECX
  1669 01  FILLER                          PIC  X(13)                   ELCDTECX
  1670                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1671 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1672     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1673         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1674                                                                  ELCDTECX
  1675 01  FILLER                          PIC  X(13)                   ELCDTECX
  1676                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1677 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1678     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1679     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1680     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1681                                     PIC  X.                         CL**5
  1682     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  31
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1683     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1684     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1685     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1686     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1687     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1688     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1689     12  FILLER                      PIC  X(75).                  ELCDTECX
  1690******************************************************************ELCDTECX
  1691*01  MISC-CARR-PCT-DATA.                                          00001521
  1692*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1693*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1694*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1695*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1696*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1697*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1698******************************************************************ELCDTECX
* 1699 COPY ELCDTEVR.
  1700***************************************************************** 04/15/98
  1701*                                                                *ELCDTEVR
  1702*                                                                *ELCDTEVR
  1703*                            ELCDTEVR.                           *   LV003
  1704*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1705*                            VMOD=2.001                          *   CL**2
  1706*                                                                *ELCDTEVR
  1707*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1708*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1709*                                                                *ELCDTEVR
  1710******************************************************************ELCDTEVR
  1711 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1712     05  WS-RUN-DATE.                                             ELCDTEVR
  1713         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1714         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1715         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1716             15  RUN-CC              PIC  99.                     ELCDTEVR
  1717             15  RUN-YR              PIC  99.                     ELCDTEVR
  1718         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1719         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1720     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1721            WS-RUN-DATE              PIC 9(11).                      CL**2
  1722     05  WS-EP-DT.                                                ELCDTEVR
  1723         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1724         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1725         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1726             15  EP-CC               PIC  99.                     ELCDTEVR
  1727             15  EP-YR               PIC  99.                     ELCDTEVR
  1728         10  EP-MO                   PIC  99.                     ELCDTEVR
  1729         10  EP-DA                   PIC  99.                     ELCDTEVR
  1730     05  WS-EP-DT-N REDEFINES                                        CL**2
  1731            WS-EP-DT                 PIC 9(11).                      CL**2
  1732     05  WS-DTE-CONV-DT.                                             CL**4
  1733         10  FILLER                  PIC  9(03).                     CL**4
  1734         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1735         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1736             15  DTE-CONV-CC         PIC  99.                        CL**4
  1737             15  DTE-CONV-YR         PIC  99.                        CL**4
  1738         10  DTE-CONV-MO             PIC  99.                        CL**4
  1739         10  DTE-CONV-DA             PIC  99.                        CL**4
  1740     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  32
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1741            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1742 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1743     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1744         10  FILLER                            PIC 999.           ELCDTEVR
  1745         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1746         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1747             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1748             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1749         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1750         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1751     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1752            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1753     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1754         10  FILLER                            PIC 999.           ELCDTEVR
  1755         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1756         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1757         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1758         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1759     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1760            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1761 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1762     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1763         10  FILLER                            PIC 999.           ELCDTEVR
  1764         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1765         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1766             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1767             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1768         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1769         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1770     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1771            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1772     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1773         10  FILLER                            PIC 999.           ELCDTEVR
  1774         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1775         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1776             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1777             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1778         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1779         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1780     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1781            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1782     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1783         10  FILLER                            PIC 999.           ELCDTEVR
  1784         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1785         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1786             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1787             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1788         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1789         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1790     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1791            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1792 01  WS-RATE-RECORD.                                              ELCDTEVR
  1793         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1794             10  FILLER                        PIC 999.           ELCDTEVR
  1795             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1796             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1797                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1798                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  33
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1799             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1800             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1801         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1802                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1803
  1804 LINKAGE SECTION.
  1805
  1806 01  PARM.
  1807     05  PARM-LENGTH                  PIC S9(04) COMP.
  1808     05  CYCLE-DATE                   PIC X(08).
  1809
  1810
  1811
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  34
* FNB169.cbl
  1813
  1814 PROCEDURE DIVISION USING PARM.
  1815
  1816*************************************************************
* 1817 COPY ELCDTERX.
  1818******************************************************************04/15/98
  1819*                                                                *ELCDTERX
  1820*                                                                *ELCDTERX
  1821*                            ELCDTERX.                           *   LV002
  1822*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1823*                            VMOD=2.007                          *ELCDTERX
  1824*                                                                *ELCDTERX
  1825*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1826*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1827*      = ELCDTEFD)                                               *ELCDTERX
  1828*                                                                *ELCDTERX
  1829******************************************************************ELCDTERX
  1830                                                                  ELCDTERX
  1831     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1832                                                                  ELCDTERX
  1833     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1834     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1835     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1836                                                                  ELCDTERX
  1837     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1838                                                                  ELCDTERX
  1839******************************************************************ELCDTERX
  1840*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1841*          WARNING MESSAGES.                                      ELCDTERX
  1842******************************************************************ELCDTERX
  1843     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1844         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1845                                                                  ELCDTERX
  1846     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1847                                                                  ELCDTERX
  1848     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1849                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1850                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1851                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1852                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1853                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1854                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1855                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1856                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1857                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1858                                                                  ELCDTERX
  1859     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1860                                                                  ELCDTERX
  1861     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1862                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1863                                                                  ELCDTERX
  1864     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1865     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1866     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1867     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1868                                                                  ELCDTERX
  1869     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1870         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  35
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1871     ELSE                                                         ELCDTERX
  1872         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1873                                                                  ELCDTERX
  1874     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1875         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1876     ELSE                                                         ELCDTERX
  1877         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1878                                                                  ELCDTERX
  1879 0005-READ--CARD.                                                 ELCDTERX
  1880     READ DISK-DATE                                               ELCDTERX
  1881         AT END CLOSE DISK-DATE                                   ELCDTERX
  1882             GO TO 0060-READ--TEST.                               ELCDTERX
  1883                                                                  ELCDTERX
  1884     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1885                                                                  ELCDTERX
  1886     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1887         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1888         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1889         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1890         GO TO 0005-READ--CARD.                                   ELCDTERX
  1891                                                                  ELCDTERX
  1892     IF DD-ID = 'CLAD'                                            ELCDTERX
  1893         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1894         GO TO 0005-READ--CARD.                                   ELCDTERX
  1895                                                                  ELCDTERX
  1896     IF DD-ID = 'CLAX'                                            ELCDTERX
  1897         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1898         GO TO 0005-READ--CARD.                                   ELCDTERX
  1899                                                                  ELCDTERX
  1900     IF DD-ID = 'CLAF'                                            ELCDTERX
  1901         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1902         GO TO 0005-READ--CARD.                                   ELCDTERX
  1903                                                                  ELCDTERX
  1904     IF DD-ID = 'CLAC'                                            ELCDTERX
  1905         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1906                                                                  ELCDTERX
  1907     IF DD-ID = 'CARR'                                            ELCDTERX
  1908         GO TO 0015-READ--CARR.                                   ELCDTERX
  1909                                                                  ELCDTERX
  1910     IF DD-ID = 'STAT'                                            ELCDTERX
  1911         GO TO 0020-READ--STAT.                                   ELCDTERX
  1912                                                                  ELCDTERX
  1913     IF DD-ID = 'BUSC'                                            ELCDTERX
  1914         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1915                                                                  ELCDTERX
  1916     IF DD-ID = 'MORT'                                            ELCDTERX
  1917         GO TO 0030-READ--MORT.                                   ELCDTERX
  1918                                                                  ELCDTERX
  1919     IF DD-ID = 'CLAI'                                            ELCDTERX
  1920         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1921                                                                  ELCDTERX
  1922     IF DD-ID = 'COLC'                                            ELCDTERX
  1923         GO TO 0065-READ--COLC.                                   ELCDTERX
  1924                                                                  ELCDTERX
  1925     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1926        DD-IDA = 'CL'                                             ELCDTERX
  1927         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1928                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  36
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1929     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1930        DD-IDA = 'PO'                                             ELCDTERX
  1931         GO TO 0050-READ--POXX.                                   ELCDTERX
  1932                                                                  ELCDTERX
  1933     IF DD-ID = 'OPCA'                                            ELCDTERX
  1934         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1935                                                                  ELCDTERX
  1936     IF DD-ID = 'OPST'                                            ELCDTERX
  1937         GO TO 0072-READ--OPST.                                   ELCDTERX
  1938                                                                  ELCDTERX
  1939     IF DD-ID = 'OPBS'                                            ELCDTERX
  1940         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1941                                                                  ELCDTERX
  1942     IF DD-ID = 'OPMS'                                            ELCDTERX
  1943         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1944                                                                  ELCDTERX
  1945     GO TO 0005-READ--CARD.                                       ELCDTERX
  1946                                                                  ELCDTERX
  1947 0010-READ--CLAC.                                                 ELCDTERX
  1948     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1949     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1950     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1951     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1952     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1953     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1954     GO TO 0005-READ--CARD.                                       ELCDTERX
  1955                                                                  ELCDTERX
  1956 0015-READ--CARR.                                                 ELCDTERX
  1957     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1958     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1959        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1960        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1961        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1962        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1963        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1964        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1965        MOVE DD-CARR1-SECPAY-SW
  1966                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1967     END-IF
  1968                                                                  ELCDTERX
  1969     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1970     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1971        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1972        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1973        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1974        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1975        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1976        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1977        MOVE DD-CARR2-SECPAY-SW
  1978                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1979     END-IF
  1980                                                                  ELCDTERX
  1981                                                                  ELCDTERX
  1982     GO TO 0005-READ--CARD.                                       ELCDTERX
  1983                                                                  ELCDTERX
  1984 0020-READ--STAT.                                                 ELCDTERX
  1985     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1986     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  37
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1987        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1988         GO TO 0005-READ--CARD.                                   ELCDTERX
  1989                                                                  ELCDTERX
  1990     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1991     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1992     GO TO 0020-READ--STAT.                                       ELCDTERX
  1993                                                                  ELCDTERX
  1994 0025-READ--BUSC.                                                 ELCDTERX
  1995     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1996     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1997        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1998         GO TO 0005-READ--CARD.                                   ELCDTERX
  1999                                                                  ELCDTERX
  2000     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2001     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2002     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2003                                                                  ELCDTERX
  2004 0030-READ--MORT.                                                 ELCDTERX
  2005     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2006     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2007        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2008         GO TO 0005-READ--CARD.                                   ELCDTERX
  2009                                                                  ELCDTERX
  2010     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2011     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2012     GO TO 0030-READ--MORT.                                       ELCDTERX
  2013                                                                  ELCDTERX
  2014 0035-READ--CLXX.                                                 ELCDTERX
  2015     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2016          GO TO 0005-READ--CARD.                                  ELCDTERX
  2017                                                                  ELCDTERX
  2018     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2019         DISPLAY '***********************************************'ELCDTERX
  2020         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2021         DISPLAY '***********************************************'ELCDTERX
  2022         GO TO 0055-READ--STOP.                                   ELCDTERX
  2023                                                                  ELCDTERX
  2024     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2025        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2026         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2027                                                                  ELCDTERX
  2028     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2029        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2030         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2031                                                                  ELCDTERX
  2032*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2033     GO TO 0005-READ--CARD.                                       ELCDTERX
  2034                                                                  ELCDTERX
  2035 0040-READ--CLAI.                                                 ELCDTERX
  2036     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2037     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2038        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2039         GO TO 0005-READ--CARD.                                   ELCDTERX
  2040                                                                  ELCDTERX
  2041     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2042     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2043     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2044                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  38
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2045 0045-READ--DUMP.                                                 ELCDTERX
  2046     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2047     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2048                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2049     PERFORM ABEND-PGM.                                           ELCDTERX
  2050                                                                  ELCDTERX
  2051 0050-READ--POXX.                                                 ELCDTERX
  2052     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2053         GO TO 0005-READ--CARD.                                   ELCDTERX
  2054                                                                  ELCDTERX
  2055     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2056         DISPLAY '***********************************************'ELCDTERX
  2057         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2058         DISPLAY '***********************************************'ELCDTERX
  2059         GO TO 0055-READ--STOP.                                   ELCDTERX
  2060                                                                  ELCDTERX
  2061     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2062     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2063     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2064     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2065                                                                  ELCDTERX
  2066     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2067         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2068     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2069         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2070                                                                  ELCDTERX
  2071     GO TO 0005-READ--CARD.                                       ELCDTERX
  2072                                                                  ELCDTERX
  2073 0055-READ--STOP.                                                 ELCDTERX
  2074     GOBACK.                                                      ELCDTERX
  2075                                                                  ELCDTERX
  2076 0060-READ--TEST.                                                 ELCDTERX
  2077     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2078        CLAX-ID         = SPACE  OR                               ELCDTERX
  2079        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2080         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2081                                                                  ELCDTERX
  2082     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2083     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2084                                                                  ELCDTERX
  2085 0065-READ--COLC.                                                 ELCDTERX
  2086     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2087     GO TO 0005-READ--CARD.                                       ELCDTERX
  2088                                                                  ELCDTERX
  2089 0070-READ--OPCA.                                                 ELCDTERX
  2090                                                                  ELCDTERX
  2091     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2092                                                                  ELCDTERX
  2093     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2094             OR                                                   ELCDTERX
  2095         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2096         GO TO 0005-READ--CARD.                                   ELCDTERX
  2097                                                                  ELCDTERX
  2098     ADD 1                       TO INDEXCA.                      ELCDTERX
  2099     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2100                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2101     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2102                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  39
* FNB169.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2103 0072-READ--OPST.                                                 ELCDTERX
  2104                                                                  ELCDTERX
  2105     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2106                                                                  ELCDTERX
  2107     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2108             OR                                                   ELCDTERX
  2109         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2110         GO TO 0005-READ--CARD.                                   ELCDTERX
  2111                                                                  ELCDTERX
  2112     ADD 1                       TO INDEXST.                      ELCDTERX
  2113     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2114                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2115     GO TO 0072-READ--OPST.                                       ELCDTERX
  2116                                                                  ELCDTERX
  2117 0074-READ--OPBS.                                                 ELCDTERX
  2118                                                                  ELCDTERX
  2119     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2120                                                                  ELCDTERX
  2121     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2122             OR                                                   ELCDTERX
  2123         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2124         GO TO 0005-READ--CARD.                                   ELCDTERX
  2125                                                                  ELCDTERX
  2126     ADD 1                       TO INDEXBS.                      ELCDTERX
  2127     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2128     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2129                                                                  ELCDTERX
  2130 0079-READ--EXIT.                                                 ELCDTERX
  2131*    EXIT.                                                        ELCDTERX
  2132******************************************************************ELCDTERX
  2133*************************************************************
  2134     PERFORM 0000-HOUSEKEEPING       THRU 0000-EXIT
  2135
  2136     PERFORM 1000-PROCESS            THRU 1000-EXIT
  2137         UNTIL EOF-DETEXT
  2138
  2139     CLOSE DETEXTR
  2140           FREEDOM-EXTRACT
  2141           CSI-FREEDOM-EXTRACT
  2142           CCC-FREEDOM-EXTRACT
  2143           ERACCT
  2144     GOBACK.
  2145
  2146
  2147 1000-PROCESS.
  2148
  2149     PERFORM 1100-GET-LOGIC-RECORD   THRU 1100-EXIT
  2150          WITH TEST AFTER
  2151              UNTIL VALID-RECORD OR EOF-DETEXT
  2152
  2153     IF EOF-DETEXT
  2154         GO TO 1000-EXIT
  2155     END-IF
  2156
  2157*    IF DE-ADDL-CLP = +0
  2158*        GO TO 1000-EXIT
  2159*    END-IF
  2160
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  40
* FNB169.cbl
  2161     MOVE SPACES                     TO WS-EXTRACT-RECORD
  2162
  2163     MOVE 'LOGIC '                   TO FX-SOURCE-CODE
  2164     MOVE '11'                       TO FX-DIVISION
  2165     MOVE ' '                        TO FX-FY-REN
  2166
  2167     MOVE CYCLE-DATE                 TO FX-POSTING-DATE
  2168     MOVE DE-CERT                    TO FX-POLICY-NO
  2169
  2170     IF DE-CLP-STATE = SPACES
  2171        MOVE DE-STATE                TO DE-CLP-STATE
  2172     END-IF
  2173     MOVE DE-CLP-STATE               TO FX-STATE
  2174*    MOVE DE-STATE                   TO FX-STATE
  2175     MOVE 'Y'                        TO FX-LOC-CODE
  2176
  2177     PERFORM 1300-GET-ADDR           THRU 1300-EXIT
  2178
  2179*    DISPLAY ' CARRIER = ' DE-CARRIER
  2180*    MOVE '3'                    TO DE-CARRIER
  2181
  2182     IF DE-CARRIER = '3' OR '4'
  2183        MOVE 'CSIDCCFEES'        TO FX-SYSTEM
  2184     ELSE
  2185       IF DE-CARRIER = '5' OR '6'
  2186          MOVE 'CCCDCCFEES'      TO FX-SYSTEM
  2187          MOVE '50'              TO FX-DIVISION
  2188       ELSE
  2189        MOVE 'LPAC LOGIC'        TO FX-SYSTEM
  2190       END-IF
  2191     END-IF
  2192
  2193     MOVE DE-ACCT-PRIME              TO FX-AGENT-01
  2194     MOVE '6211'                     TO FX-COST-CENTER
  2195     MOVE ' '                        TO FX-DISTR
  2196     MOVE ' '                        TO FX-SOURCE-ACCT
  2197     MOVE ' '                        TO FX-REFERENCE
  2198
  2199     MOVE +1                         TO AGT-LEVEL
  2200
  2201
  2202     PERFORM UNTIL AGT-LEVEL > +10
  2203
  2204*    DISPLAY 'DE CERT ' DE-CERT
  2205*    DISPLAY 'AGT LEVEL ' AGT-LEVEL
  2206*    DISPLAY 'DE-AGT ' DE-AGT (AGT-LEVEL)
  2207*    DISPLAY 'DE-AGT-TYPE ' DE-AGT-TYPE (AGT-LEVEL)
  2208*    DISPLAY 'DE-TRAN ' DE-TRANS
  2209     MOVE DE-L-PC (AGT-LEVEL) TO TEST-DISP-L-PC
  2210*    DISPLAY 'DE-L-PC ' TEST-DISP-L-PC
  2211     MOVE DE-A-PC (AGT-LEVEL) TO TEST-DISP-A-PC
  2212*    DISPLAY 'DE-A-PC ' TEST-DISP-A-PC
  2213
  2214         EVALUATE DE-TRANS
  2215          WHEN 'I'
  2216            EVALUATE TRUE
  2217              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2218                MOVE 'ISSUE INCENTIVE'     TO FX-DESCRIPTION
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  41
* FNB169.cbl
  2219                MOVE '01'                  TO FX-SUB-TYPE
  2220                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2221                                    * -1
  2222                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2223                MOVE '70'                  TO FX-TRAN-TYPE
  2224                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2225                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2226                MOVE '90'                  TO FX-TRAN-TYPE
  2227                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2228
  2229              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2230                MOVE 'ISSUE LMBA FEE'      TO FX-DESCRIPTION
  2231                MOVE '01'                  TO FX-SUB-TYPE
  2232                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2233                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2234                                    * -1
  2235                ELSE
  2236                   COMPUTE WS-LF-WORK ROUNDED = DE-REI-LFPRM *
  2237                      DE-L-PC (AGT-LEVEL)
  2238                   COMPUTE WS-AH-WORK ROUNDED = DE-REI-AHPRM *
  2239                      DE-A-PC (AGT-LEVEL)
  2240                   COMPUTE FX-AMOUNT ROUNDED = (WS-LF-WORK +
  2241                      WS-AH-WORK) * -1
  2242                END-IF
  2243                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2244                MOVE '75'                  TO FX-TRAN-TYPE
  2245                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2246                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2247                MOVE '95'                  TO FX-TRAN-TYPE
  2248                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2249
  2250              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2251                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2252                MOVE 'ISSUE CONTRACT FEE'  TO FX-DESCRIPTION
  2253                MOVE '01'                  TO FX-SUB-TYPE
  2254                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2255                                    * -1
  2256                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2257                MOVE '72'                  TO FX-TRAN-TYPE
  2258                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2259                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2260                MOVE '92'                  TO FX-TRAN-TYPE
  2261                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2262
  2263              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'N')
  2264                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2265                MOVE 'ISSUE CSO ADMIN FEE'  TO FX-DESCRIPTION
  2266                MOVE '01'                  TO FX-SUB-TYPE
  2267                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2268                                    * -1
  2269                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2270                MOVE '77'                  TO FX-TRAN-TYPE
  2271                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2272                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2273                MOVE '97'                  TO FX-TRAN-TYPE
  2274                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2275            END-EVALUATE
  2276          WHEN '8'
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  42
* FNB169.cbl
  2277            EVALUATE TRUE
  2278              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2279                MOVE 'ISSUE RC-L INCENTIVE'
  2280                                           TO FX-DESCRIPTION
  2281                MOVE '01'                  TO FX-SUB-TYPE
  2282                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2283                                    * -1
  2284                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2285                MOVE '70'                  TO FX-TRAN-TYPE
  2286                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2287                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2288                MOVE '90'                  TO FX-TRAN-TYPE
  2289                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2290
  2291              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2292                MOVE 'ISSUE RC-L LMBA FEE' TO FX-DESCRIPTION
  2293                MOVE '01'                  TO FX-SUB-TYPE
  2294                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2295                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2296                                    * -1
  2297                ELSE
  2298                   COMPUTE FX-AMOUNT ROUNDED = ((DE-REI-LFPRM
  2299                      * DE-L-PC (AGT-LEVEL)) + (DE-REI-AHPRM
  2300                      * DE-A-PC (AGT-LEVEL))) * -1
  2301                END-IF
  2302                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2303                MOVE '75'                  TO FX-TRAN-TYPE
  2304                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2305                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2306                MOVE '95'                  TO FX-TRAN-TYPE
  2307                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2308
  2309              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2310                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2311                MOVE 'ISSUE RC-L CONTRACT FEE'
  2312                                           TO FX-DESCRIPTION
  2313                MOVE '01'                  TO FX-SUB-TYPE
  2314                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2315                                    * -1
  2316                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2317                MOVE '72'                  TO FX-TRAN-TYPE
  2318                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2319                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2320                MOVE '92'                  TO FX-TRAN-TYPE
  2321                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2322
  2323            END-EVALUATE
  2324          WHEN 'C'
  2325            EVALUATE TRUE
  2326              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I'
  2327                MOVE 'CANCEL MGT FEE  '    TO FX-DESCRIPTION
  2328                MOVE '01'                  TO FX-SUB-TYPE
  2329                COMPUTE A-OW = DE-A-PC (AGT-LEVEL) * 1000
  2330                PERFORM 2530-CALC-DDF-FEES THRU 2530-EXIT
  2331                move cnc-wk to fx-amount
  2332                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2333                MOVE '70'                  TO FX-TRAN-TYPE
  2334                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  43
* FNB169.cbl
  2335                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2336                MOVE '90'                  TO FX-TRAN-TYPE
  2337                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2338              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'J'
  2339                MOVE 'CANCEL SLS MKT  '    TO FX-DESCRIPTION
  2340                MOVE '01'                  TO FX-SUB-TYPE
  2341                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2342                IF DE-CANCEL-REASON = 'R'
  2343                   MOVE +1      TO WS-CNC-FACT
  2344                END-IF
  2345                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2346                                    * WS-CNC-FACT
  2347                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2348                MOVE '70'                  TO FX-TRAN-TYPE
  2349                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2350                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2351                MOVE '90'                  TO FX-TRAN-TYPE
  2352                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2353
  2354              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2355                MOVE 'CANCEL LMBA FEE'     TO FX-DESCRIPTION
  2356                MOVE '01'                  TO FX-SUB-TYPE
  2357                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2358                   IF DE-AH-PRM NOT = ZEROS
  2359                      COMPUTE WS-CNC-FACT ROUNDED = DE-AH-RFND /
  2360                         DE-AH-PRM
  2361                      IF DE-CANCEL-REASON = 'R'
  2362                         MOVE +1 TO WS-CNC-FACT
  2363                      END-IF
  2364                      COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL)
  2365                         * 1000 * WS-CNC-FACT
  2366                   END-IF
  2367                ELSE
  2368                   MOVE ZEROS   TO WS-WORK-AMT
  2369                   IF DE-LF-PRM NOT = ZEROS
  2370                      COMPUTE WS-CNC-FACT ROUNDED = DE-LF-RFND /
  2371                         DE-LF-PRM
  2372                      COMPUTE WS-WORK-AMT ROUNDED =
  2373                        (DE-L-PC (AGT-LEVEL) * DE-REI-LFPRM)
  2374                          * WS-CNC-FACT
  2375                   END-IF
  2376                   IF DE-AH-PRM NOT = ZEROS
  2377                      COMPUTE WS-CNC-FACT ROUNDED = DE-AH-RFND /
  2378                         DE-AH-PRM
  2379                      COMPUTE WS-WORK-AMT ROUNDED = WS-WORK-AMT +
  2380                     ((DE-A-PC (AGT-LEVEL) * DE-REI-AHPRM)
  2381                        * WS-CNC-FACT)
  2382                   END-IF
  2383                   MOVE WS-WORK-AMT TO FX-AMOUNT
  2384                END-IF
  2385                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2386                MOVE '75'                  TO FX-TRAN-TYPE
  2387                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2388                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2389                MOVE '95'                  TO FX-TRAN-TYPE
  2390                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2391
  2392              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  44
* FNB169.cbl
  2393                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2394                MOVE 'CANCEL CONTRACT FEE' TO FX-DESCRIPTION
  2395                MOVE '01'                  TO FX-SUB-TYPE
  2396                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2397                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2398                                    * WS-CNC-FACT
  2399                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2400                MOVE '72'                  TO FX-TRAN-TYPE
  2401                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2402                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2403                MOVE '92'                  TO FX-TRAN-TYPE
  2404                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2405
  2406              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'N')
  2407                AND (DE-A-PC (AGT-LEVEL) NOT = ZEROS)
  2408                MOVE 'CANCEL CSO ADMIN FEE' TO FX-DESCRIPTION
  2409                MOVE '01'                  TO FX-SUB-TYPE
  2410
  2411                COMPUTE A-OW = DE-A-PC (AGT-LEVEL) * 1000
  2412                PERFORM 2530-CALC-DDF-FEES THRU 2530-EXIT
  2413
  2414                MOVE CNC-WK      TO FX-AMOUNT
  2415                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2416                MOVE '77'                  TO FX-TRAN-TYPE
  2417                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2418                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2419                MOVE '97'                  TO FX-TRAN-TYPE
  2420                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2421
  2422            END-EVALUATE
  2423          WHEN '7'
  2424            EVALUATE TRUE
  2425              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'I' OR 'J'
  2426                MOVE 'CANCEL RC-L INCENTIVE'
  2427                                           TO FX-DESCRIPTION
  2428                MOVE '01'                  TO FX-SUB-TYPE
  2429                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2430                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2431                                    * WS-CNC-FACT
  2432                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2433                MOVE '70'                  TO FX-TRAN-TYPE
  2434                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2435                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2436                MOVE '90'                  TO FX-TRAN-TYPE
  2437                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2438
  2439              WHEN DE-AGT-TYPE (AGT-LEVEL) = 'L' OR 'A'
  2440                MOVE 'CANCEL RC-L LMBA FEE'
  2441                                           TO FX-DESCRIPTION
  2442                MOVE '01'                  TO FX-SUB-TYPE
  2443                IF DE-AH-PRM NOT = ZEROS
  2444                   COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2445                ELSE
  2446                   MOVE ZEROS   TO WS-CNC-FACT
  2447                END-IF
  2448                IF DE-AGT-TYPE (AGT-LEVEL) = 'L'
  2449                   COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2450                                    * WS-CNC-FACT
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  45
* FNB169.cbl
  2451                ELSE
  2452                   COMPUTE WS-WORK-AMT = (DE-A-PC (AGT-LEVEL) *
  2453                      DE-REI-AHPRM)  * WS-CNC-FACT
  2454                   IF DE-LF-PRM NOT = ZEROS
  2455                      COMPUTE WS-LF-CNC-FACT = DE-LF-RFND /
  2456                         DE-LF-PRM
  2457                      COMPUTE FX-AMOUNT ROUNDED = WS-WORK-AMT +
  2458                       ((DE-L-PC (AGT-LEVEL) * DE-REI-LFPRM)
  2459                          * WS-LF-CNC-FACT)
  2460                   END-IF
  2461                END-IF
  2462                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2463                MOVE '75'                  TO FX-TRAN-TYPE
  2464                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2465                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2466                MOVE '95'                  TO FX-TRAN-TYPE
  2467                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2468
  2469              WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'B')
  2470                AND (DE-A-PC (AGT-LEVEL) NOT = +0)
  2471                MOVE 'CANCEL RC-L CONTRACT FEE'
  2472                                           TO FX-DESCRIPTION
  2473                MOVE '01'                  TO FX-SUB-TYPE
  2474                COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2475                COMPUTE FX-AMOUNT = DE-A-PC (AGT-LEVEL) * 1000
  2476                                    * WS-CNC-FACT
  2477                PERFORM 1400-OTHER-FX-DATA THRU 1400-EXIT
  2478                MOVE '72'                  TO FX-TRAN-TYPE
  2479                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2480                MULTIPLY FX-AMOUNT BY -1   GIVING FX-AMOUNT
  2481                MOVE '92'                  TO FX-TRAN-TYPE
  2482                PERFORM 1010-WRITE-EXTRACT THRU 1010-EXIT
  2483            END-EVALUATE
  2484         END-EVALUATE
  2485         MOVE FX-AMOUNT TO TEST-DISP-FX-AMT
  2486*        DISPLAY 'FX AMT ' TEST-DISP-FX-AMT
  2487*        DISPLAY ' '
  2488
  2489         ADD +1                      TO AGT-LEVEL
  2490     END-PERFORM
  2491
  2492     .
  2493 1000-EXIT.
  2494     EXIT.
  2495
  2496 1010-WRITE-EXTRACT.
  2497
  2498     IF DE-CARRIER = '3' OR '4'
  2499        WRITE CSI-EXTRACT-RECORD
  2500                     FROM WS-EXTRACT-RECORD
  2501     ELSE
  2502       IF DE-CARRIER = '5' OR '6'
  2503          WRITE CCC-EXTRACT-RECORD FROM
  2504                WS-EXTRACT-RECORD
  2505       ELSE
  2506        WRITE EXTRACT-RECORD
  2507                     FROM WS-EXTRACT-RECORD
  2508       END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  46
* FNB169.cbl
  2509     END-IF
  2510
  2511     .
  2512 1010-EXIT.
  2513     EXIT.
  2514
  2515 1100-GET-LOGIC-RECORD.
  2516
  2517     MOVE '0'                        TO VALID-RECORD-SW
  2518     READ DETEXTR
  2519         AT END GO TO 1100-EXIT
  2520     END-READ
  2521
  2522     IF DE-REIN NOT = SPACE
  2523         GO TO 1100-EXIT
  2524     END-IF
  2525
  2526     IF DE-TRANS = 'I' OR 'C' OR '7' OR '8'
  2527         CONTINUE
  2528     ELSE
  2529         GO TO 1100-EXIT
  2530     END-IF
  2531
  2532     IF DE-ENTRY-STATUS = 'M'
  2533        GO TO 1100-EXIT
  2534     END-IF
  2535
  2536     IF (DE-TRANS = 'I' OR '8')
  2537       AND (DE-ENTRY-STATUS = '3' OR '5')
  2538         GO TO 1100-EXIT
  2539     END-IF
  2540
  2541     IF (DE-LF-TYPE = ZERO)  AND
  2542        (DE-AH-TYPE = ZERO)
  2543           GO TO 1100-EXIT
  2544     END-IF
  2545
  2546     SET VALID-RECORD TO TRUE
  2547
  2548     .
  2549 1100-EXIT.
  2550     EXIT.
  2551
  2552
  2553 1300-GET-ADDR.
  2554
  2555     MOVE DE-COMPANY-CD          TO AM-COMPANY-CD
  2556     MOVE DE-CNTRL1              TO AM-CNTRL-1
  2557     MOVE DE-EFF                 TO AM-EXPIRE-DT
  2558
  2559     START ERACCT KEY >= AM-CONTROL-PRIMARY
  2560
  2561     IF ERACCT-STATUS NOT = '00'
  2562         DISPLAY 'ERROR ON ERACCT START ' ERACCT-STATUS
  2563         GO TO 1300-EXIT
  2564     END-IF
  2565
  2566     MOVE '0' TO END-OF-SEARCH-SW
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  47
* FNB169.cbl
  2567     MOVE ' '                    TO WS-DCC-PRODUCT-CODE
  2568
  2569     PERFORM UNTIL END-OF-SEARCH
  2570        READ ERACCT NEXT
  2571
  2572        IF ERACCT-STATUS = '00'
  2573           IF (AM-COMPANY-CD = DE-COMPANY-CD)
  2574              AND (AM-CNTRL-1 = DE-CNTRL1)
  2575              MOVE SPACES        TO FX-CITY
  2576              STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  2577                DELIMITED BY '  ' INTO FX-CITY
  2578              END-STRING
  2579              MOVE AM-ZIP        TO FX-ZIP-CODE
  2580              IF (DE-EFF >= AM-EFFECT-DT)
  2581                 AND (DE-EFF < AM-EXPIRE-DT)
  2582                 MOVE AM-DCC-PRODUCT-CODE
  2583                                 TO WS-DCC-PRODUCT-CODE
  2584              END-IF
  2585           ELSE
  2586              SET END-OF-SEARCH  TO TRUE
  2587           END-IF
  2588        ELSE
  2589           DISPLAY 'ERACCT READ NEXT STATUS ' ERACCT-STATUS
  2590           SET END-OF-SEARCH     TO TRUE
  2591        END-IF
  2592     END-PERFORM
  2593
  2594     MOVE FX-CITY                    TO FNX001-DATA
  2595     CALL 'FNX001' USING FNX001-PARMS
  2596     MOVE FNX001-CITY                TO FX-CITY
  2597
  2598     .
  2599 1300-EXIT.
  2600     EXIT.
  2601
  2602
  2603 1400-OTHER-FX-DATA.
  2604
  2605     IF FX-STATE NOT= SPACES
  2606         SEARCH ALL STATE-TABLE
  2607             AT END DISPLAY 'INVALID STATE CODE: ' FX-STATE
  2608             WHEN ST-STATE (ST-INDEX) = FX-STATE
  2609                 MOVE ST-ALT-STATE (ST-INDEX) TO FX-STATE
  2610         END-SEARCH
  2611     END-IF
  2612
  2613     MOVE SYSTEM-DATE                TO FX-JOURNAL-DATE
  2614
  2615**** THE '*' IN POSITION 250 ENSURES A 250 BYTE RECORD IS PASSED
  2616**** TO FREEDOM - PREVENTS TRUNCATION OF BLANK FIELDS
  2617     MOVE '*'                        TO WS-EXTRACT-RECORD(250:1)
  2618
  2619     .
  2620 1400-EXIT.
  2621     EXIT.
  2622
  2623 2520-REF-CSO-ADMIN-FEE.
  2624
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  48
* FNB169.cbl
  2625     IF DE-CERT-NO = WS-FACT-CERT
  2626        CONTINUE
  2627     ELSE
  2628        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2629     END-IF
  2630
  2631     MOVE ZEROS                  TO CNC-WK
  2632
  2633     EVALUATE TRUE
  2634        WHEN (DE-DCC-DDF-REM-TRM3 = 0)
  2635           OR (DE-CANCEL-REASON = 'R')
  2636           DISPLAY ' REM TERM = 0 OR REPO'
  2637           MOVE 0                TO CNC-WK
  2638
  2639        when de-ah-rfnd = de-ah-prm
  2640           display ' full refund '
  2641           move a-ow             to cnc-wk
  2642        WHEN DE-DCC-DDF-REM-TRM3 = DE-AH-TERM
  2643           DISPLAY ' REM TERM  = ORIG TERM '
  2644           MOVE A-OW             TO CNC-WK
  2645
  2646        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4
  2647           DISPLAY ' ORIG TERM - REM TRM < 4 '
  2648           COMPUTE W-FACTOR ROUNDED = A-OW -
  2649              (DD-1ST-YR-ALLOW (D1)
  2650              * WS-MONTH / 3) - (A-OW - DD-1ST-YR-ALLOW (D1))
  2651              * (1 - WS-HI-UEF) * WS-MONTH / 12
  2652           COMPUTE CNC-WK = W-FACTOR * 1
  2653
  2654**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
  2655
  2656        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13
  2657           DISPLAY ' ORIG TERM - REM TRM < 13 '
  2658           COMPUTE W-FACTOR ROUNDED = (a-ow -
  2659              DD-1ST-YR-ALLOW (D1))
  2660              - (a-ow - DD-1ST-YR-ALLOW (D1))
  2661              * (1 - WS-hi-UEF) * ws-MONTH / 12
  2662           COMPUTE CNC-WK = W-FACTOR * 1
  2663
  2664****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
  2665
  2666        WHEN OTHER
  2667           DISPLAY ' OTHER '
  2668           COMPUTE W-FACTOR ROUNDED = (a-ow -
  2669              DD-1ST-YR-ALLOW (D1))
  2670              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
  2671              * ws-MONTH / 12)
  2672           COMPUTE CNC-WK = W-FACTOR * 1
  2673     END-EVALUATE
  2674
  2675     .
  2676 2520-EXIT.
  2677     EXIT.
  2678
  2679 2530-CALC-DDF-FEES.
  2680
  2681*****   THIS PARA IS ONLY FOR COMM TYPES N AND I
  2682*****   DCC DDF REFUNDS ONLY
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  49
* FNB169.cbl
  2683
  2684     IF DE-CERT-NO = WS-FACT-CERT
  2685        CONTINUE
  2686     ELSE
  2687        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2688     END-IF
  2689
  2690     COMPUTE WS-MONTH =
  2691        FUNCTION REM(DE-AH-TERM - DE-DCC-DDF-REM-TRM3, 12)
  2692     IF WS-MONTH = 0
  2693        MOVE 12 TO WS-MONTH
  2694     END-IF
  2695     DISPLAY ' WS MONTH ' WS-MONTH
  2696
  2697     EVALUATE TRUE
  2698        WHEN DE-AGT-TYPE (AGT-LEVEL) = 'N'
  2699           PERFORM 2520-REF-CSO-ADMIN-FEE
  2700                                 THRU 2520-EXIT
  2701        WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'I')
  2702           AND (DE-CANCEL-REASON = 'R')
  2703              MOVE A-OW TO CNC-WK
  2704        WHEN (DE-AGT-TYPE (AGT-LEVEL) = 'I')
  2705           EVALUATE TRUE
  2706              WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4)
  2707                 OR (NOT DD-IU-PRESENT)
  2708                 COMPUTE WS-CNC-FACT = DE-REI-AHRFND /
  2709                   DE-REI-AHPRM
  2710                 COMPUTE CNC-WK ROUNDED = WS-CNC-FACT * A-OW
  2711               WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13)
  2712                  AND (DD-IU-PRESENT)
  2713                  COMPUTE WS-CLP-MO3 = DE-REI-AHPRM -
  2714                     (DE-REI-AHPRM -
  2715                     DE-IU-RATE-UP) * (WS-HI-UEF -
  2716                     WS-LO-UEF) * 3 / 12
  2717                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
  2718                  COMPUTE WS-CNC-FACT = WS-CLP-MO3 / DE-REI-AHPRM
  2719                  COMPUTE WS-COMM-MO3 ROUNDED = WS-CNC-FACT
  2720                   * A-OW
  2721                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
  2722                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
  2723                    A-OW * WS-HI-UEF) * (WS-MONTH - 3) / 9
  2724              WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) > 12
  2725                 COMPUTE CNC-WK = A-OW *
  2726                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
  2727                    WS-MONTH / 12)
  2728           END-EVALUATE
  2729           DISPLAY ' CSO REF MGT FEE ' DE-CERT-NO ' ' CNC-WK
  2730     END-EVALUATE
  2731
  2732     .
  2733 2530-EXIT.
  2734     EXIT.
  2735
  2736 2540-CALC-DDF-COMM.
  2737
  2738     IF DE-CERT-NO = WS-FACT-CERT
  2739        DISPLAY ' FACTORS ALREADY BUILT IN 2540 ' DE-CERT-NO
  2740     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  50
* FNB169.cbl
  2741        PERFORM 2550-GET-DDF-FACTORS THRU 2550-EXIT
  2742     END-IF
  2743
  2744     COMPUTE WS-MONTH =
  2745        FUNCTION REM(DE-AH-TERM - DE-DCC-DDF-REM-TRM3, 12)
  2746     IF WS-MONTH = 0
  2747        MOVE 12 TO WS-MONTH
  2748     END-IF
  2749     DISPLAY ' WS MONTH ' WS-MONTH
  2750
  2751     EVALUATE TRUE
  2752        WHEN DE-CANCEL-REASON = 'R'
  2753           MOVE A-OW             TO CNC-WK
  2754        WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 4)
  2755           OR (NOT DD-IU-PRESENT)
  2756              COMPUTE WS-CNC-FACT = DE-REI-AHRFND / DE-REI-AHPRM
  2757              COMPUTE CNC-WK = WS-CNC-FACT * A-OW
  2758        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < 13
  2759            COMPUTE WS-CLP-MO3 = DE-REI-AHPRM - (DE-REI-AHPRM -
  2760               DE-IU-RATE-UP) * (WS-HI-UEF -
  2761               WS-LO-UEF) * 3 / 12
  2762            DISPLAY ' UECLPMO3 ' WS-CLP-MO3
  2763            COMPUTE WS-CNC-FACT = WS-CLP-MO3 / DE-REI-AHPRM
  2764            COMPUTE WS-COMM-MO3 ROUNDED = WS-CNC-FACT * A-OW
  2765            DISPLAY ' UECOMMO3 ' WS-COMM-MO3
  2766            COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
  2767              A-OW * WS-HI-UEF) * (WS-MONTH - 3) / 9
  2768        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) > 12
  2769           COMPUTE CNC-WK = a-ow * (WS-HI-UEF - (WS-HI-UEF -
  2770              WS-LO-UEF) * ws-MONTH / 12)
  2771     END-EVALUATE
  2772
  2773     DISPLAY ' CSO REF comm    ' DE-CERT-NO ' ' CNC-WK
  2774
  2775     .
  2776 2540-EXIT.
  2777     EXIT.
  2778
  2779 2550-GET-DDF-FACTORS.
  2780
  2781     MOVE ZEROS                  TO CNC-WK
  2782                                    WS-LO-UEF WS-HI-UEF
  2783     move ' '                    to dd-iu-sw
  2784
  2785     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
  2786        ((DE-STATE = DD-STATE (D1))
  2787        and (WS-DCC-PRODUCT-CODE = dd-product-cd (d1))
  2788*       AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
  2789        AND ('A'           = DD-BEN-TYPE   (D1))
  2790        AND (DE-AH-TYPE    = DD-BEN-CODE   (D1))
  2791        AND (DE-EFF        < DD-PROD-EXP-DT (D1)))
  2792                        OR
  2793        D1 > +800
  2794     END-PERFORM
  2795     IF D1 > +800
  2796        DISPLAY ' COULD NOT FIND UEP FACTORS '
  2797        GO TO 2550-EXIT
  2798     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  51
* FNB169.cbl
  2799
  2800     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  2801        (P1 > +8)
  2802        OR (DD-PROD-CODE (D1 P1) = 'I')
  2803     END-PERFORM
  2804     IF P1 < +9
  2805        display ' setting iu present to true '
  2806        SET DD-IU-PRESENT        TO TRUE
  2807     END-IF
  2808
  2809     MOVE DE-AH-TERM             TO WS-DDF-TERM
  2810
  2811     IF (DE-LOAN-TERM > WS-DDF-TERM)
  2812        AND (DD-TRUNCATED (D1) = 'Y')
  2813        MOVE DE-LOAN-TERM        TO WS-DDF-TERM
  2814        DISPLAY ' FOUND TRUNCATED ' DE-CERT-NO
  2815     END-IF
  2816
  2817     EVALUATE TRUE
  2818        WHEN WS-DDF-TERM > +168
  2819           MOVE 15               TO P1
  2820        WHEN WS-DDF-TERM > +156
  2821           MOVE 14               TO P1
  2822        WHEN WS-DDF-TERM > +144
  2823           MOVE 13               TO P1
  2824        WHEN WS-DDF-TERM > +132
  2825           MOVE 12               TO P1
  2826        WHEN WS-DDF-TERM > +120
  2827           MOVE 11               TO P1
  2828        WHEN WS-DDF-TERM > +108
  2829           MOVE 10               TO P1
  2830        WHEN WS-DDF-TERM > +96
  2831           MOVE 9                TO P1
  2832        WHEN WS-DDF-TERM > +84
  2833           MOVE 8                TO P1
  2834        WHEN WS-DDF-TERM > +72
  2835           MOVE 7                TO P1
  2836        WHEN WS-DDF-TERM > +60
  2837           MOVE 6                TO P1
  2838        WHEN WS-DDF-TERM > +48
  2839           MOVE 5                TO P1
  2840        WHEN WS-DDF-TERM > +36
  2841           MOVE 4                TO P1
  2842        WHEN WS-DDF-TERM > +24
  2843           MOVE 3                TO P1
  2844        WHEN WS-DDF-TERM > +12
  2845           MOVE 2                TO P1
  2846        WHEN OTHER
  2847           MOVE 1                TO P1
  2848     END-EVALUATE
  2849
  2850     EVALUATE TRUE
  2851*       WHEN ((DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +13)
  2852*          and (dd-iu-present)
  2853*          MOVE 2                TO P2
  2854*       WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +13
  2855*          MOVE 1                TO P2
  2856        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +25
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  52
* FNB169.cbl
  2857           MOVE 2                TO P2
  2858        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +37
  2859           MOVE 3                TO P2
  2860        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +49
  2861           MOVE 4                TO P2
  2862        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +61
  2863           MOVE 5                TO P2
  2864        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +73
  2865           MOVE 6                TO P2
  2866        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +85
  2867           MOVE 7                TO P2
  2868        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +97
  2869           MOVE 8                TO P2
  2870        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +109
  2871           MOVE 9                TO P2
  2872        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +121
  2873           MOVE 10               TO P2
  2874        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +133
  2875           MOVE 11               TO P2
  2876        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +145
  2877           MOVE 12               TO P2
  2878        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +157
  2879           MOVE 13               TO P2
  2880        WHEN (DE-AH-TERM - DE-DCC-DDF-REM-TRM3) < +169
  2881           MOVE 14               TO P2
  2882        WHEN OTHER
  2883           MOVE 15               TO P2
  2884     END-EVALUATE
  2885
  2886     MOVE DE-CERT-NO             TO WS-FACT-CERT
  2887     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
  2888                                 TO WS-LO-UEF
  2889     MOVE DD-UEP-FACTOR (D1 P1 P2)
  2890                                 TO WS-HI-UEF
  2891
  2892     .
  2893 2550-EXIT.
  2894     EXIT.
  2895
  2896 0000-HOUSEKEEPING.
  2897
  2898     CALL 'DATEEDIT' USING CYCLE-DATE,  DATE-SW
  2899     IF NOT VALID-DATE
  2900         DISPLAY 'INVALID DATE PARAMETER: ' CYCLE-DATE
  2901         PERFORM ABEND-PGM           THRU ABEND-EXIT
  2902     END-IF
  2903
  2904     MOVE FUNCTION CURRENT-DATE      TO FUNCTION-DATE
  2905     MOVE WS-FN-MO                   TO SYS-MO
  2906     MOVE WS-FN-DA                   TO SYS-DA
  2907     MOVE WS-FN-CCYR                 TO SYS-CCYY
  2908
  2909     OPEN INPUT  ERACCT ERPDEF
  2910                 DETEXTR
  2911          OUTPUT FREEDOM-EXTRACT CSI-FREEDOM-EXTRACT
  2912                 CCC-FREEDOM-EXTRACT
  2913
  2914     IF ERACCT-STATUS = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  53
* FNB169.cbl
  2915         CONTINUE
  2916     ELSE
  2917         DISPLAY 'OPEN ERROR ' ERACCT-STATUS ' ON ERACCT'
  2918     END-IF
  2919
  2920     IF ERPDEF-FILE-STATUS = '00' OR '97'
  2921         CONTINUE
  2922     ELSE
  2923         DISPLAY 'OPEN ERROR ' ERPDEF-FILE-STATUS ' ON ERPDEF'
  2924     END-IF
  2925
  2926     IF DTE-CLIENT = 'DCC'
  2927        MOVE 0 TO B-SUB
  2928        MOVE DTE-CLASIC-COMPANY-CD
  2929                                 TO PD-CONTROL-PRIMARY
  2930        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  2931        IF ERPDEF-FILE-STATUS = '00'
  2932           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  2933              READ ERPDEF NEXT RECORD
  2934              IF ERPDEF-FILE-STATUS = '00'
  2935                 ADD 1 TO B-SUB
  2936                 IF B-SUB > 800
  2937                    DISPLAY ' DDF UEP TABLE BLEW '
  2938                    GO TO ABEND-PGM
  2939                 END-IF
  2940                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  2941                 MOVE PD-PRODUCT-CD
  2942                                 TO DD-PRODUCT-CD (B-SUB)
  2943                 MOVE PD-BEN-TYPE
  2944                                 TO DD-BEN-TYPE (B-SUB)
  2945                 MOVE PD-BEN-CODE
  2946                                 TO DD-BEN-CODE (B-SUB)
  2947                 MOVE PD-PROD-EXP-DT
  2948                                 TO DD-PROD-EXP-DT (B-SUB)
  2949                 MOVE PD-1ST-YR-ADMIN-ALLOW
  2950                                 TO DD-1ST-YR-ALLOW (B-SUB)
  2951                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  2952                    P2 > +8
  2953                    MOVE PD-PROD-CODE (P2)
  2954                                 TO DD-PROD-CODE (B-SUB P2)
  2955                 END-PERFORM
  2956                 MOVE PD-EARN-FACTORS
  2957                                 TO DD-EARN-FACTORS (B-SUB)
  2958                 move pd-truncated to dd-truncated (b-sub)
  2959              END-IF
  2960           END-PERFORM
  2961        DISPLAY ' DCC PRODUCT DEF TABLE LOADED SUCCESSFULLY '
  2962        END-IF
  2963        CLOSE ERPDEF
  2964     END-IF
  2965
  2966     .
  2967 0000-EXIT.
  2968     EXIT.
  2969
  2970
  2971 ABEND-PGM SECTION.
  2972     DIVIDE WS-ZERO BY WS-ZERO       GIVING WS-ZERO.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-13 10:29 Page  54
* FNB169.cbl
  2973 ABEND-EXIT.
  2974
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      618324     Code:       11777
