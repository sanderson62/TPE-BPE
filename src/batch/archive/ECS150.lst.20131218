* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* ECS150.cbl
* Options: int("ECS150.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS150.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS150.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS150.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS150.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 01/01/97 16:27:55.
     7*             PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.029.
     9*AUTHOR         LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*DATE-COMPILED.
    12
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* ECS150.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22
    23*REMARKS.
    24*        THIS PROGRAM PRODUCES THE EXTRACT RECORDS
    25*        NEEDED TO COMPLETE THE LIFE AND A/H ANNUAL REPORT.
    26*        DETAIL IS GENERATED IF REQUESTED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* ECS150.cbl
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 012610 IR2010010700001   PEMA  CORRECT IN FORCE COUNT AND AMT
    37* 121510 CR2009120700001   PEMA  FORCE BEGINNING TOTALS TO MATCH ENDING
    38* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 062712    2012062600003  PEMA  ADD PROCESSING FOR AHL
    40******************************************************************
    41 ENVIRONMENT DIVISION.
    42 CONFIGURATION SECTION.
    43 INPUT-OUTPUT SECTION.
    44 FILE-CONTROL.
    45
    46     SELECT SORT-WORK        ASSIGN TO SYS001-UT-2314-S-SORTWK1.
    47     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
    48     SELECT CERT-FILE        ASSIGN TO SYS011-UT-2400-S-SYS011.
    49     SELECT REINS-EXTRACT-2  ASSIGN TO SYS012-UT-2400-S-SYS012.
    50     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
    51                             ORGANIZATION IS INDEXED
    52                             ACCESS IS DYNAMIC
    53                             FILE STATUS IS ERRTBL-FILE-STATUS
    54                             RECORD KEY IS RE-CONTROL-PRIMARY.
    55     SELECT ERACCTT          ASSIGN TO SYS010-FBA1-ERACCTT
    56                             ORGANIZATION IS INDEXED
    57                             ACCESS IS SEQUENTIAL
    58                             FILE STATUS IS ACCT-FILE-STATUS
    59                             RECORD KEY IS AM-CONTROL-PRIMARY.
    60     SELECT REINS-EXTRACT-1  ASSIGN TO SYS018-UT-2400-S-SYS018.
    61     SELECT DISK-DATE        ASSIGN TO SYS019-UT-2314-S-SYS019.
    62     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
    63     SELECT CLAS150-A-EXTRACT ASSIGN TO SYS021-UT-2400-S-SYS021.
    64     SELECT CLAS150-B-EXTRACT ASSIGN TO SYS022-UT-2400-S-SYS022.
    65     SELECT CLAS150-C-EXTRACT ASSIGN TO SYS023-UT-2400-S-SYS023.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* ECS150.cbl
    67 DATA DIVISION.
    68 FILE SECTION.
    69
    70 SD  SORT-WORK.
    71*    RECORD CONTAINS 210 CHARACTERS
    72
    73 01  SORT-REC.
    74     12  SORT-KEY            PIC X(42).
    75     12  FILLER              PIC X(168).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* ECS150.cbl
    77 FD  PRINT-FILE
*   78                             COPY ELCPRTFD.
    79******************************************************************04/15/98
    80*                                                                *ELCPRTFD
    81*                                                                *ELCPRTFD
    82*                            ELCPRTFD.                           *   LV003
    83*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    84*                            VMOD=2.006                          *ELCPRTFD
    85******************************************************************ELCPRTFD
    86     RECORDING MODE F                                             ELCPRTFD
    87     LABEL RECORDS OMITTED                                        ELCPRTFD
    88     BLOCK CONTAINS 0 RECORDS
    89     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    90 01  PRT.                                                         ELCPRTFD
    91     12  P-CTL               PIC  X.                                 CL**2
    92     12  P-DATA              PIC  X(132).                         ELCPRTFD
    93******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* ECS150.cbl
    95 FD  CERT-FILE
*   96                             COPY ECSCRIFD.
    97******************************************************************07/10/97
    98*                                                                *ECSCRIFD
    99*                            ECSCRIFD                            *   LV001
   100*                            VMOD 2.005                          *ECSCRIFD
   101*                                                                *ECSCRIFD
   102*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   103*                                                                *ECSCRIFD
   104******************************************************************ECSCRIFD
   105     BLOCK CONTAINS 0 RECORDS
   106     RECORDING MODE F.                                            ECSCRIFD
   107                                                                  ECSCRIFD
   108 01  CERT-IN-RECORD.                                              ECSCRIFD
   109                                                                  ECSCRIFD
   110     12  FILLER                            PIC XXX.               ECSCRIFD
   111     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   112     12  FILLER                            PIC X(66).             ECSCRIFD
   113     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   114     12  FILLER                            PIC X(20).             ECSCRIFD
   115     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   116     12  FILLER                            PIC X(14).             ECSCRIFD
   117     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   118     12  FILLER                            PIC X(39).             ECSCRIFD
   119     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   120     12  FILLER                            PIC X(45).             ECSCRIFD
   121     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   122     12  FILLER                            PIC X(35).             ECSCRIFD
   123     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   124     12  FILLER                            PIC X(41).             ECSCRIFD
   125     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   126     12  FILLER                            PIC X(48).             ECSCRIFD
   127     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   128     12  FILLER                            PIC X(9).              ECSCRIFD
   129     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   130     12  FILLER                            PIC X(120).            ECSCRIFD
   131     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   132     12  FILLER                            PIC X(73).             ECSCRIFD
   133     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   134     12  FILLER                            PIC X(464).            ECSCRIFD
   135                                                                  ECSCRIFD
   136******************************************************************ECSCRIFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* ECS150.cbl
   138 FD  REINS-EXTRACT-2
   139     BLOCK CONTAINS 0 RECORDS
   140     RECORDING MODE IS F.
   141*    RECORD CONTAINS 210 CHARACTERS
   142
   143 01  RC-REC-2.
   144     12  RC-CONTRAL-2        PIC  X(210).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* ECS150.cbl
   146 FD  ERRTBL-IN
*  147                             COPY ECSRTFDD.
   148******************************************************************07/10/97
   149*                                                                *ECSRTFDD
   150*                            ECSRTFDD                            *   LV001
   151*                            VMOD=2.001                          *ECSRTFDD
   152*                                                                *ECSRTFDD
   153*  NO  CID  MODS  IN  COPYBOOK  ECSRTFDD                         *ECSRTFDD
   154*                                                                *ECSRTFDD
   155******************************************************************ECSRTFDD
   156     LABEL RECORDS STANDARD                                       ECSRTFDD
   157     RECORD CONTAINS 4000 CHARACTERS.                             ECSRTFDD
   158                                                                  ECSRTFDD
   159 01  RT-REC                  PIC  X(4000).                        ECSRTFDD
   160******************************************************************ECSRTFDD
   161
*  162                             COPY ERCREIN.
   163******************************************************************07/27/93
   164*                                                                *ERCREIN
   165*                            ERCREIN                             *   LV009
   166*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   167*                            VMOD=2.010                          *   CL**9
   168*                                                                *ERCREIN
   169*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   170*                                                                *ERCREIN
   171*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   172*                                                                *ERCREIN
   173*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   174*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   175*                                                                *ERCREIN
   176*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   177*       ALTERNATE PATH = NONE                                    *ERCREIN
   178*                                                                *ERCREIN
   179*   LOG = NO                                                     *ERCREIN
   180*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   181*                                                                *ERCREIN
   182******************************************************************ERCREIN
   183*                   C H A N G E   L O G
   184*
   185* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   186*-----------------------------------------------------------------
   187*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   188* EFFECTIVE    NUMBER
   189*-----------------------------------------------------------------
   190* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   191* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   192******************************************************************
   193 01  REINSURANCE-RECORD.                                          ERCREIN
   194     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   195         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   196                                                                  ERCREIN
   197     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   198         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   199         16  RE-KEY.                                              ERCREIN
   200             20  RE-CODE                   PIC X.                 ERCREIN
   201                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   202                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   203             20  RE-TABLE                  PIC XXX.               ERCREIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* ECS150.cbl (/apps/prod/cid1p/copy/ERCREIN)
   204             20  FILLER                    PIC XXX.               ERCREIN
   205         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   206             20  FILLER                    PIC X.                 ERCREIN
   207             20  RE-COMPANY.                                      ERCREIN
   208                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   209                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   210                                                                  ERCREIN
   211     12  RE-MAINT-INFORMATION.                                    ERCREIN
   212         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   213         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   214         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   215         16  FILLER                        PIC X(10).             ERCREIN
   216                                                                  ERCREIN
   217     12  RE-TABLE-DATA.                                           ERCREIN
   218         16  RE-100-COMP                   PIC 99.                ERCREIN
   219                                                                  ERCREIN
   220         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   221             20  RE-REI-COMP-NO.                                  ERCREIN
   222                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   223                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   224             20  RE-LF-QC                  PIC X.                 ERCREIN
   225             20  RE-AH-QC                  PIC X.                 ERCREIN
   226             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   227             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   228             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   229             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   230             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   231             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   232             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   233             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   234             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   235             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   236             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   237             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   238             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   239             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   240             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   241             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   242             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   243             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   244             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   245             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   246             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   247             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   248             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   249             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   250             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   251             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   252             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   253             20  RE-REMAINING              PIC X.                 ERCREIN
   254             20  RE-LF-RUNOFF-SW           PIC X.                      000
   255             20  RE-AH-RUNOFF-SW           PIC X.                      000
   256             20  FILLER                    PIC X(19).                  000
   257                                                                  ERCREIN
   258         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   259         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   260         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   261         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* ECS150.cbl (/apps/prod/cid1p/copy/ERCREIN)
   262             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   263                                                                  ERCREIN
   264         16  FILLER                        PIC X(27).             ERCREIN
   265                                                                  ERCREIN
   266     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   267         16  RE-NAME                       PIC X(30).             ERCREIN
   268         16  RE-LF-PE                      PIC X.                 ERCREIN
   269         16  RE-AH-PE                      PIC X.                 ERCREIN
   270         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   271         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   272         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   273         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   274         16  RE-PRT-ST                     PIC X.                 ERCREIN
   275         16  RE-PRT-OW                     PIC X.                 ERCREIN
   276         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   277         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   278         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   279         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   280         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   281         16  RE-LF-COMM                    PIC X.                 ERCREIN
   282         16  RE-AH-COMM                    PIC X.                 ERCREIN
   283         16  RE-LF-TAX                     PIC X.                 ERCREIN
   284         16  RE-AH-TAX                     PIC X.                 ERCREIN
   285         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   286         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   287         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   288                                                                  ERCREIN
   289         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   290             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   291                                                                  ERCREIN
   292         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   293             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   294                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   295                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   296                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   297                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   298             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   299                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   300                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   301                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   302                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   303                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   304                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   305                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   306                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   307             20  FILLER                    PIC XXX.               ERCREIN
   308             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   309                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   310                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   311                                                                  ERCREIN
   312         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   313             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   314                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   315                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   316                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   317                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   318             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   319                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* ECS150.cbl (/apps/prod/cid1p/copy/ERCREIN)
   320                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   321                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   322                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   323                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   324                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   325                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   326                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   327             20  FILLER                    PIC XXX.               ERCREIN
   328             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   329                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   330                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   331                                                                  ERCREIN
   332         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   333                                                                  ERCREIN
   334         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   335                                                                  ERCREIN
   336         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   337         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   338         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   339         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   340         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   341         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   342         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   343         16  RE-MORT-SW                    PIC X.                 ERCREIN
   344         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   345             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   346             88  RE-CEDED                          VALUE 'C'.        CL**2
   347             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   348             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   349                                                                  ERCREIN
   350         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   351             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   352         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   353             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   354         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   355             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   356         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   357             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   358         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   359             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   360                                                                     CL**3
   361         16  RE-PRT-CRSV                   PIC X.                    CL**5
   362                                                                     CL**5
   363         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   364                                                                     CL**8
   365         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   366                                                                     CL**8
   367         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   368                                                                     CL**9
   369         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   370             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   371             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   372
   373         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   374             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   375                                                                     CL**9
   376         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   377         16  FILLER                        PIC X(2281).              CL**9
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* ECS150.cbl (/apps/prod/cid1p/copy/ERCREIN)
   378                                                                  ERCREIN
   379         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   380                                                                  ERCREIN
   381******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* ECS150.cbl
   383 FD  ERACCTT.
*  384                             COPY ERCACCT.
   385******************************************************************04/19/98
   386*                                                                *ERCACCT
   387*                                                                *ERCACCT
   388*                            ERCACCT                             *   LV031
   389*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   390*                            VMOD=2.031                          *ERCACCT
   391*                                                                *ERCACCT
   392*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   393*                                                                *ERCACCT
   394*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   395*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   396*                                                                *ERCACCT
   397*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   398*                                                                *ERCACCT
   399*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   400*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   401*                                                                *ERCACCT
   402*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   403*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   404*                                                                *ERCACCT
   405*   LOG = NO                                                     *ERCACCT
   406*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   407*                                                                *ERCACCT
   408*                                                                *ERCACCT
   409******************************************************************ERCACCT
   410*                   C H A N G E   L O G
   411*
   412* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   413*-----------------------------------------------------------------
   414*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   415* EFFECTIVE    NUMBER
   416*-----------------------------------------------------------------
   417* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   418* 092705    2005050300006  PEMA  ADD SPP LEASES
   419* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   420* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   421* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   422* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   423* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   424******************************************************************
   425                                                                  ERCACCT
   426 01  ACCOUNT-MASTER.                                              ERCACCT
   427     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   428         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   429                                                                  ERCACCT
   430     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   431         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   432         16  AM-MSTR-CNTRL.                                       ERCACCT
   433             20  AM-CONTROL-A.                                    ERCACCT
   434                 24  AM-CARRIER            PIC X.                 ERCACCT
   435                 24  AM-GROUPING.                                 ERCACCT
   436                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   437                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   438                 24  AM-STATE              PIC XX.                ERCACCT
   439                 24  AM-ACCOUNT.                                  ERCACCT
   440                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   441                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   442             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   443                                           PIC X(19).             ERCACCT
   444             20  AM-CNTRL-B.                                      ERCACCT
   445                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   446                 24  FILLER                PIC X(4).              ERCACCT
   447             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   448                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   449                                                                  ERCACCT
   450     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   451         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   452         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   453         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   454         16  AM-VG-STATE                   PIC XX.                ERCACCT
   455         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   456         16  AM-VG-DATE.                                          ERCACCT
   457             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   458             20  FILLER                    PIC X(4).              ERCACCT
   459         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   460                                           PIC 9(11)      COMP-3. ERCACCT
   461     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   462         16  FILLER                        PIC X(10).
   463         16  AM-VG-KEY3.
   464             20  AM-VG3-ACCOUNT            PIC X(10).
   465             20  AM-VG3-EXP-DT             PIC XX.
   466         16  FILLER                        PIC X(4).
   467     12  AM-MAINT-INFORMATION.                                    ERCACCT
   468         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   469         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   470         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   471         16  FILLER                        PIC XX.                ERCACCT
   472                                                                  ERCACCT
   473     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   474     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   475                                                                  ERCACCT
   476     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   477         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   478         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   479                                                                  ERCACCT
   480     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   481     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   482                                                                  ERCACCT
   483     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   484     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   485                                                                  ERCACCT
   486     12  AM-NAME                           PIC X(30).             ERCACCT
   487     12  AM-PERSON                         PIC X(30).             ERCACCT
   488     12  AM-ADDRS                          PIC X(30).             ERCACCT
   489     12  AM-CITY.
   490         16  AM-ADDR-CITY                  PIC X(28).
   491         16  AM-ADDR-STATE                 PIC XX.
   492     12  AM-ZIP.                                                  ERCACCT
   493         16  AM-ZIP-PRIME.                                        ERCACCT
   494             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   495                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   496             20  FILLER                    PIC X(4).              ERCACCT
   497         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   498     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   499         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   500         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   501         16  FILLER                        PIC XXX.               ERCACCT
   502     12  AM-TEL-NO.                                               ERCACCT
   503         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   504         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   505         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   506     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   507         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   508         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   509                                                                  ERCACCT
   510     12  AM-COMM-STRUCTURE.                                       ERCACCT
   511         16  AM-DEFN-1.                                           ERCACCT
   512             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   513                 24  AM-AGT.                                      ERCACCT
   514                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   515                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   516                 24  AM-COM-TYP            PIC X.                 ERCACCT
   517                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   518                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   519                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   520                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   521                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   522                 24  AM-GL-CODES           PIC X.                 ERCACCT
   523                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   524                 24  FILLER                PIC X(01).             ERCACCT
   525         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   526             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   527                 24  FILLER                PIC X(11).             ERCACCT
   528                 24  AM-L-COMA             PIC XXX.               ERCACCT
   529                 24  AM-J-COMA             PIC XXX.               ERCACCT
   530                 24  AM-A-COMA             PIC XXX.               ERCACCT
   531                 24  FILLER                PIC X(6).              ERCACCT
   532                                                                  ERCACCT
   533     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   534         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   535                                                                  ERCACCT
   536     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   537                                                                  ERCACCT
   538     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   539         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   540         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   541     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   542         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   543         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   544     12  AM-GPCD                           PIC 99.                ERCACCT
   545     12  AM-IG                             PIC X.                 ERCACCT
   546         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   547         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   548     12  AM-STATUS                         PIC X.                 ERCACCT
   549         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   550         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   551         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   552         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   553         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   554         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   555     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   556     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   557                                                                  ERCACCT
   558     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   559     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   560     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   561     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   562     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   563     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   564     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   565     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   566     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   567                                                                  ERCACCT
   568     12  AM-USER-FIELDS.                                          ERCACCT
   569         16  AM-FLD-1                      PIC XX.                ERCACCT
   570         16  AM-FLD-2                      PIC XX.                ERCACCT
   571         16  AM-FLD-3                      PIC XX.                ERCACCT
   572         16  AM-FLD-4                      PIC XX.                ERCACCT
   573         16  AM-FLD-5                      PIC XX.                ERCACCT
   574                                                                  ERCACCT
   575     12  AM-1ST-PROD-DATE.                                        ERCACCT
   576         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   577         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   578         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   579     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   580     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   581         16  AM-PUR-YR                     PIC XX.                ERCACCT
   582         16  AM-PUR-MO                     PIC XX.                ERCACCT
   583         16  AM-PUR-DA                     PIC XX.                ERCACCT
   584     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   585     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   586     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   587     12  AM-INACTIVE-DATE.                                        ERCACCT
   588         16  AM-INA-MO                     PIC 99.                ERCACCT
   589         16  AM-INA-DA                     PIC 99.                ERCACCT
   590         16  AM-INA-YR                     PIC 99.                ERCACCT
   591     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   592                                                                  ERCACCT
   593     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   594     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   595                                                                  ERCACCT
   596     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   597         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   598         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   599         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   600         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   601                                                                  ERCACCT
   602     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   603         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   604         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   605                                                                  ERCACCT
   606     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   607                                                                  ERCACCT
   608     12  AM-OVER-SHORT.                                           ERCACCT
   609         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   610         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   611                                                                  ERCACCT
   612     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   613     12  AM-DCC-CLP-STATE                  PIC XX.
   614                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   615     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   616     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   617                                                                  ERCACCT
   618     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   619     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   620     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   621     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   622     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   623     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   624     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   625     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   626     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   627     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   628     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   629     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   630     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   631     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   632     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   633     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   634                                                                  ERCACCT
   635     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   636                                                                  ERCACCT
   637     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   638     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   639                                                                  ERCACCT
   640     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   641     12  AM-EARN-METHODS.                                         ERCACCT
   642         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   643             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   644             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   645             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   646             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   647         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   648             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   649             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   650             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   651             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   652         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   653             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   654             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   655             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   656             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   657             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   658             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   659                                                                  ERCACCT
   660     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   661     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   662     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   663                                                                  ERCACCT
   664     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   665     12  AM-RET-P-E                        PIC X.                 ERCACCT
   666     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   667     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   668     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   669     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   670         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   671         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   672     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   673         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   674         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   675         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   676     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   677         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   678         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   679     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   680         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   681         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   682         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   683     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   684     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   685                                                                  ERCACCT
   686     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   687         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   688         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   689         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   690         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   691         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   692                                                                  ERCACCT
   693     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   694                                                                  ERCACCT
   695     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   696                                                                  ERCACCT
   697     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   698         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   699                                                                  ERCACCT
   700     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   701         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   702         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   703                                                                  ERCACCT
   704     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   705         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   706                                                                  ERCACCT
   707     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   708         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   709         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   710                                                                  ERCACCT
   711     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   712                                                                  ERCACCT
   713     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   714     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   715     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   716     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   717     12  AM-DCC-UEF-STATE                  PIC XX.
   718     12  FILLER                            PIC XXX.
   719     12  AM-REPORT-CODE-3                  PIC X(10).
   720*    12  FILLER                            PIC X(22).             ERCACCT
   721                                                                  ERCACCT
   722     12  AM-RESERVE-DATE.                                         ERCACCT
   723         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   724         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   725         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   726                                                                  ERCACCT
   727     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   728     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   729         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   730         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   731         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   732         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   733                                                                  ERCACCT
   734     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   735         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   736         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   737         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   738         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   739                                                                  ERCACCT
   740     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   741         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   742             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   743             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   744             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   745             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   746             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   747             20  FILLER                    PIC XX.                ERCACCT
   748         16  FILLER                        PIC X(80).             ERCACCT
   749                                                                  ERCACCT
   750     12  AM-TRANSFER-DATA.                                        ERCACCT
   751         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   752             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   753             20  AM-TRNFROM-GROUPING.                             ERCACCT
   754                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   755                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   756             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   757             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   758                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   759                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   760             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   761         16  AM-TRANSFERRED-TO.                                   ERCACCT
   762             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   763             20  AM-TRNTO-GROUPING.                               ERCACCT
   764                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   765                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   766             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   767             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   768                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   769                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   770             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   771         16  FILLER                        PIC X(10).             ERCACCT
   772                                                                  ERCACCT
   773     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   774                                                                  ERCACCT
   775     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   776         16  AM-DEFN-1-SAVED.                                     ERCACCT
   777             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   778                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   779                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   780                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   781                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   782                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   783                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   784                 24  FILLER                PIC X.                 ERCACCT
   785                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   786                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   787                 24  FILLER                PIC X.                 ERCACCT
   788         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   789             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   790                 24  FILLER                PIC X(11).             ERCACCT
   791                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   792                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   793                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   794                 24  FILLER                PIC X(6).              ERCACCT
   795                                                                  ERCACCT
   796     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   797         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   798            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   799            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   800            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   801                                                                  ERCACCT
   802     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   803     12  FILLER                            PIC X(120).            ERCACCT
   804                                                                  ERCACCT
   805     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   806         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   807         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   808             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   809             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   810                                                          COMP-3. ERCACCT
   811             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   812                                                          COMP-3. ERCACCT
   813         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   814             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   815             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   816                                                          COMP-3. ERCACCT
   817             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   818                                                          COMP-3. ERCACCT
   819                                                                  ERCACCT
   820     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   821         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   822         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   823         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   824         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   825             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   826                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   827                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   828             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   829                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   830                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   831             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   832                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   833                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   834         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   835             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   836                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   837                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   838                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   839             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   840                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   841                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   842             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   843                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   844                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   845                                                                  ERCACCT
   846     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   847         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   848                                                                  ERCACCT
   849     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   850         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   851         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   852         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   853         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   854         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   855             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   856             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   857             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   858             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   859         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   860             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   861             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   862             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   863         16  FILLER                        PIC X(102).            ERCACCT
   864                                                                  ERCACCT
   865     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   866         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   867             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   868             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   869             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   870             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   871             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   872         16  FILLER                          PIC X(10).           ERCACCT
   873******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* ECS150.cbl
   875 FD  REINS-EXTRACT-1
   876     BLOCK CONTAINS 0 RECORDS
   877     RECORDING MODE IS F.
   878*    RECORD CONTAINS 210 CHARACTERS
   879
   880 01  RC-REC-1.
   881     12  RC-CONTRAL-1        PIC  X(210).
   882
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* ECS150.cbl
   884 FD  DISK-DATE
*  885                             COPY ELCDTEFD.
   886******************************************************************04/15/98
   887*                                                                *ELCDTEFD
   888*                                                                *ELCDTEFD
   889*                            ELCDTEFD.                           *   LV002
   890*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   891*                            VMOD=2.007                          *   CL**2
   892*                                                                *ELCDTEFD
   893******************************************************************ELCDTEFD
   894     BLOCK CONTAINS 0 RECORDS
   895     RECORDING MODE F.                                            ELCDTEFD
   896                                                                  ELCDTEFD
   897 01  DATE-DISK.                                                   ELCDTEFD
   898     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   899     12  FILLER                      PIC  X(14).                  ELCDTEFD
   900     12  DD-CR1                      PIC  9.                      ELCDTEFD
   901     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   902     12  DD-CR2                      PIC  9.                      ELCDTEFD
   903     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   904     12  FILLER                      PIC  X(20).                  ELCDTEFD
   905                                                                  ELCDTEFD
   906 01  DATE-DISK-R.                                                 ELCDTEFD
   907     12  FILLER                      PIC  X(4).                   ELCDTEFD
   908     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   909                                     PIC  X(32).                  ELCDTEFD
   910                                                                  ELCDTEFD
   911 01  DATE-DISK-T.                                                 ELCDTEFD
   912     12  FILLER                      PIC  X(4).                   ELCDTEFD
   913     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   914                                     PIC  X(48).                  ELCDTEFD
   915                                                                  ELCDTEFD
   916 01  DATE-DISK-M.                                                 ELCDTEFD
   917     12  FILLER                      PIC  X(4).                   ELCDTEFD
   918     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   919                                     PIC  X(48).                  ELCDTEFD
   920                                                                  ELCDTEFD
   921 01  DATE-DISK-P.                                                 ELCDTEFD
   922     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   923     12  DD-IDX                      PIC  99.                     ELCDTEFD
   924     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   925     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   926         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   927                                     PIC  X.                      ELCDTEFD
   928         16  FILLER                  PIC  X(46).                  ELCDTEFD
   929     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   930         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   931             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   932             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   933             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   934             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   935         16  FILLER                  PIC  X(16).                  ELCDTEFD
   936                                                                  ELCDTEFD
   937 01  DATE-DISK-E.                                                 ELCDTEFD
   938     12  FILLER                      PIC  X(4).                   ELCDTEFD
   939     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   940                                     PIC  X(4).                   ELCDTEFD
   941                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   942 01  DATE-DISK-C.                                                 ELCDTEFD
   943     12  FILLER                      PIC  X(7).                   ELCDTEFD
   944     12  DD-CARR1-SECPAY-SW          PIC  X.
   945     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   946     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   947     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   948     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   949     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   950     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   951     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   952     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   953     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   954     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   955     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   956     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   957     12  DD-CARR2-SECPAY-SW          PIC  X.
   958     12  FILLER                      PIC  X(7).                   ELCDTEFD
   959                                                                  ELCDTEFD
   960 01  DATE-DISK-OPT.                                               ELCDTEFD
   961     12  FILLER                      PIC  X(04).                  ELCDTEFD
   962     12  DD-TLR-DATA.                                             ELCDTEFD
   963         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   964                                     PIC  X(03).                  ELCDTEFD
   965     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   966         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   967                                     PIC  X(06).                  ELCDTEFD
   968     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   969         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   970                                     PIC  X(07).                  ELCDTEFD
   971         16  FILLER                  PIC  X(05).                  ELCDTEFD
   972     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   973                                     PIC  X(96).                  ELCDTEFD
   974******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* ECS150.cbl
   976 FD  FICH
   977     RECORDING MODE IS F.
   978
   979 01  FICH-REC                PIC X(133).
   980
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* ECS150.cbl
   982 FD  CLAS150-A-EXTRACT
   983     BLOCK CONTAINS 0 RECORDS
   984     RECORDING MODE IS F.
   985*    RECORD CONTAINS 2701 CHARACTERS
   986*
   987*  THIS EXTRACT FILE CONTAINS THE RECORDS
   988*  NEEDED TO PRINT THE CERTIFICATE ACTIVITY AND EXHIBIT
   989*  REPORT FOR THE 1ST INSURANCE COMPANY
   990*
   991*          ** RECORD TYPE AND SORT KEY DESCRIPTION **
   992******** SORT KEY ***************   ******** USAGE *********
   993*TYPE*CARR*COMP*STATE*ACCT*STATE*
   994* 01 * X  *  X *  X  * X  * LV  * - ACCT TOTAL-1ST INS.
   995* 02 * X  *  X *  X  * X  * LV  * - ACCT TOTAL-REINS
   996* 03 * X  *  X *  X  * HV * LV  * - ST TOT-1ST INS
   997* 04 * X  *  X *  X  * HV * LV  * - ST TOT-REINS
   998* 05 * X  *  X *  HV * HV * LV  * - ST TOT-1ST,ACCUM FOR CO TOTAL
   999* 06 * X  *  X *  HV * HV * LV  * - ST TOT-REINS,ACCUM FOR CO TOT
  1000* 07 * X  * HV *  X  * HV * LV  * - ST TOT-1ST,ACCUM FOR ST/CARR
  1001* 08 * X  * HV *  X  * HV * LV  * - ST TOT-REIN,ACCUM FOR ST/CARR
  1002* 09 * X  * HV *  HV * HV * LV  * - ST TOT-1ST,ACCUM FOR CARR TOT
  1003* 10 * X  * HV *  HV * HV * LV  * - ST TOT-REIN,ACCUM FOR CARR TOT
  1004* 11 * HV * HV *  HV * HV * LV  * - ST TOT-1ST,ACCUM FOR GRND TOT
  1005* 12 * HV * HV *  HV * HV * LV  * - ST TOT-REIN,ACCUM FOR GRND TOT
  1006* 13 * HV * HV *  HV * HV *  X  * - ST TOT-1ST,ACCUM FOR ST TOTAL
  1007* 14 * HV * HV *  HV * HV *  X  * - ST TOT-REIN,ACCUM FOR ST TOTAL
  1008*
  1009* X-INDICATES FIELD INITIALIZED WITH ACTUAL VALUE
  1010* LV - INDICATES FIELD WILL CONTAIN LOW-VALUE
  1011* HV - INDICATES FIELD WILL CONTAIN HIGH-VALUE
  1012*
  1013***NOTE - FIELD ER-REINS-CO IS SET TO LOW-VALUE FOR ALL RECORDS
  1014*         IN THIS FILE SINCE IT IS NOT USED FOR THIS REPORT
  1015
  1016 01  CLAS150-EXTRACT-RECORD-A    PIC X(2701).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* ECS150.cbl
  1018 FD  CLAS150-B-EXTRACT
  1019     BLOCK CONTAINS 0 RECORDS
  1020     RECORDING MODE IS F.
  1021*    RECORD CONTAINS 2701 CHARACTERS
  1022*
  1023*  THIS FILE CONTAINS THE RECORDS NEEDED TO
  1024*  PRINT THE CERTIFICATE ACTIVITY AND EXHIBIT
  1025*  REPORT FOR THE REINSURANCE COMPANY WITH THE
  1026*  EXCEPTION OF OVER STATE TOTALS.
  1027*
  1028*          ** RECORD TYPE AND SORT KEY DESCRIPTION **
  1029******* SORT KEY *********
  1030*RE-CO*CARR*COMP*STATE*ACCT*STATE*TYPE*
  1031*  X  * X  *  X *  X  * X  * LV  * 15 *   ACCT TOTAL
  1032*  X  * X  *  X *  X  * LV * LV  * 16 *   STATE TOTAL
  1033*  X  * X  *  X *  LV * LV * LV  * 17 *   COMPANY TOTAL
  1034*  X  * X  * LV *  LV * LV * LV  * 18 *   CARRIER TOTAL
  1035*  X  * LV * LV *  LV * LV * LV  * 19 *   REINS CO TOTAL
  1036*     *    *    *     *    *     *    *
  1037* X= INITIALIZED TO ACTUAL VALUE       * TOTAL RECORD TYPE 19
  1038* LV = INITIALIZED TO LOW-VALUE          FOR GRAND TOTALS
  1039
  1040 01  CLAS150-EXTRACT-RECORD-B    PIC X(2701).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* ECS150.cbl
  1042 FD  CLAS150-C-EXTRACT
  1043     BLOCK CONTAINS 0 RECORDS
  1044     RECORDING MODE IS F.
  1045*    RECORD CONTAINS 2701 CHARACTERS
  1046*
  1047*    THIS FILE CONTAINS THE RECORDS NEEDED TO PRINT
  1048*    THE REINSURANCE COMPANY - CERTIFICATE AND EXHIBIT
  1049*    REPORT - AT THE STATE LEVEL.
  1050*
  1051*    ALL RECORDS IN THIS FILE ARE TYPE 20
  1052*    ALL CONTROL FIELDS IN THE SORT KEY ARE SET TO
  1053*     LOW-VALUE WITH THE EXCEPTION OF THE STATE AND TYPE
  1054*     FIELDS.
  1055*
  1056*
  1057
  1058 01  CLAS150-EXTRACT-RECORD-C    PIC X(2701).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* ECS150.cbl
  1060 WORKING-STORAGE SECTION.
  1061 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  1062 77  FILLER  PIC X(32) VALUE '********************************'.
  1063 77  FILLER  PIC X(32) VALUE '     ECS150 WORKING STORAGE     '.
  1064 77  FILLER  PIC X(32) VALUE '******* VMOD=2.029 *************'.
  1065
  1066
  1067 77  LINE-CNT                PIC S9(3)      COMP-3 VALUE +56.
  1068 77  FACTOR-C                PIC S9(3)      COMP-3 VALUE +0.
  1069 77  MINUS-CNT               PIC S9(3)      COMP-3 VALUE +0.
  1070 77  PAGE-CNT                PIC S9(5)      COMP-3 VALUE +0.
  1071 77  EXPIRED-MONTHS          PIC S9(5)      COMP-3 VALUE +0.
  1072 77  UNEXPIRED-MONTHS        PIC S9(3)V99   COMP-3 VALUE +0.
  1073 77  HOLD-PREV-UNEXP         PIC S9(5)      COMP-3 VALUE +0.
  1074 77  HOLD-PREV-EXP           PIC S9(5)      COMP-3 VALUE +0.
  1075 77  HOLD-END-UNEXP          PIC S9(5)      COMP-3 VALUE +0.
  1076 77  HOLD-END-EXP            PIC S9(5)      COMP-3 VALUE +0.
  1077 77  TERM-WORK               PIC S9(5)      COMP-3 VALUE +0.
  1078 77  REINS-REC-CNT           PIC S9(7)      COMP-3 VALUE +0.
  1079 77  EXB-CNT                 PIC S9(7)      COMP-3 VALUE ZERO.
  1080 77  FACTOR-A                PIC S9(4)V9(11) COMP-3 VALUE +0.
  1081 77  FACTOR-B                PIC S9(4)V9(11) COMP-3 VALUE +0.
  1082 77  WS-TOTAL-FACE-AMT       PIC S9(7)V99   COMP-3 VALUE +0.
  1083 77  UNEARNED-AMT-LF         PIC S9(7)V99   COMP-3 VALUE +0.
  1084 77  UNEARNED-AMT-AH         PIC S9(7)V99   COMP-3 VALUE +0.
  1085 77  SUMMARY-AMT-LF          PIC S9(9)V99   COMP-3 VALUE +0.
  1086 77  SUMMARY-AMT-AH          PIC S9(9)V99   COMP-3 VALUE +0.
  1087 77  MINUS-AMT               PIC S9(7)V99   COMP-3 VALUE +0.
  1088 77  TEMP-RESULT             PIC S9(9)V99   COMP-3 VALUE +0.
  1089 77  SAVE-BGN-INFORCE        PIC S9(9)V99   COMP-3 VALUE +0.
  1090 77  SAVE-END-INFORCE        PIC S9(9)V99   COMP-3 VALUE +0.
  1091 77  TEMP-RESULT-L           PIC S9(9)V9(6) COMP-3 VALUE +0.
  1092 77  SAVE-REM-TERM           PIC S9(3)V99   COMP-3 VALUE +0.
  1093 77  X                       PIC X                 VALUE SPACE.
  1094 77  ERRTBL-FILE-STATUS      PIC XX              VALUE '00'.
  1095 77  ACCT-FILE-STATUS        PIC XX              VALUE '00'.
  1096
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* ECS150.cbl
  1098 01  WORK-AREAS.
  1099     12  sub3                       pic s9(5) value +0 comp-3.
  1100     12  WS-ZERO                    PIC S9     VALUE +0 COMP-3.
  1101     12  WS-RETURN-CODE             PIC S9(4)  VALUE +0 COMP-3.
  1102     12  WS-ABEND-MESSAGE           PIC X(80)  VALUE SPACES.
  1103     12  WS-ABEND-FILE-STATUS       PIC XX     VALUE ZERO.
  1104     12  INTERIM-YR                 PIC 99     VALUE 0.
  1105     12  WS-931231                  PIC XX     VALUE X'8CFF'.
  1106     12  WS-CR-DIS-CCYY             PIC 9(04)  VALUE 0.
  1107     12  WS-CR-CCYY                 PIC 9(04)  VALUE 0.
  1108
  1109 01  FILLER PIC X(16)  VALUE 'CONTROL SWITCHES'.
  1110 01  PROGRAM-CNTRL-SWITCHES.
  1111     12  PASS-TYPE           PIC 9               VALUE 0.
  1112         88  FIRST-INS-PASS                      VALUE 0.
  1113         88  REINSURANCE-PASS                    VALUE 1.
  1114     12  INFORCE-CNT-SW      PIC 9               VALUE 0.
  1115     12  RECORD-TYPE-SW      PIC 9               VALUE 0.
  1116         88  FIRST-INS-REC                       VALUE 0.
  1117         88  REINSURANCE-REC                     VALUE 1.
  1118     12  EFFECTIVE-CONTROL   PIC 9               VALUE 0.
  1119         88  EFFECTIVE-LAST-PER                  VALUE 1.
  1120         88  EFFECTIVE-THIS-PER                  VALUE 2.
  1121         88  EFFECTIVE-BOTH-PER                  VALUE 3.
  1122     12  CERT-STATUS         PIC 9               VALUE 0.
  1123         88  CERT-ACTIVE                         VALUE 0.
  1124         88  CERT-CANCELLED                      VALUE 1.
  1125         88  CERT-CLAIM                          VALUE 2.
  1126         88  LUMP-SUM                            VALUE 3.
  1127         88  CLAIM-OR-CANCEL                     VALUE 1 2 3.
  1128     12  REINSURANCE-FOUND   PIC 9               VALUE 0.
  1129         88  NO-REINSURANCE                      VALUE 0.
  1130     12  OB-SW               PIC 9               VALUE 0.
  1131         88  OB-COVERAGE                         VALUE 1.
  1132     12  SUMMARY-SW          PIC 9               VALUE 0.
  1133         88  SUMMARY-REC                         VALUE 1.
  1134     12  COUNT-CNTRL         PIC 9               VALUE 0.
  1135         88  ALREADY-COUNTED                     VALUE 1.
  1136     12  NEW-IN-EFFECT       PIC 9               VALUE 0.
  1137         88  ENTERED-THIS-PERIOD                 VALUE 1.
  1138     12  OLD-IN-EFFECT       PIC 9               VALUE 0.
  1139         88  ENTERED-PREV-PERIOD                 VALUE 1.
  1140     12  PRINT-CNTRL         PIC 9               VALUE 0.
  1141         88  FIRST-DETAIL-DONE                   VALUE 1.
  1142     12  INS-TYPE-SW         PIC 9               VALUE 0.
  1143         88  INDIVIDUAL-INS                      VALUE 1.
  1144         88  GROUP-INS                           VALUE 2.
  1145     12  LIFE-INS-SW         PIC 9               VALUE 0.
  1146         88  LEVEL-LIFE                          VALUE 1.
  1147         88  REDUCING-LIFE                       VALUE 2.
  1148     12  CANCEL-SW           PIC 9               VALUE 0.
  1149         88  CURRENT-CANCEL-ONLY                 VALUE 1.
  1150     12  CLAIM-SW            PIC 9               VALUE 0.
  1151         88  CURRENT-CLAIM-ONLY                  VALUE 1.
  1152     12  REINS-FILE-SW       PIC 9               VALUE 0.
  1153         88  REINS-FILE-CLOSED                   VALUE 0.
  1154         88  REINS-FILE-OPEN                     VALUE 1.
  1155     12  TEXAS-REG-SW        PIC 9               VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* ECS150.cbl
  1156         88  TEXAS-CERT                          VALUE 1.
  1157     12  NET-PAY-SW          PIC 9               VALUE 0.
  1158         88  NET-PAY-CERT                        VALUE 1.
  1159 01  FILLER PIC X(16)  VALUE 'PRINT   SWITCHES'.
  1160 01  PRINT-SWITCHES.
  1161     12  LF-REFUND-SW        PIC 9               VALUE 0.
  1162         88 PRT-LF-REFUND                        VALUE 1.
  1163     12  AH-REFUND-SW        PIC 9               VALUE 0.
  1164         88 PRT-AH-REFUND                        VALUE 1.
  1165     12  LF-ISSUE            PIC 9               VALUE 0.
  1166         88 PRT-LF-ISSUE                         VALUE 1.
  1167     12  LF-CANC             PIC 9               VALUE 0.
  1168         88 PRT-LF-CANC                          VALUE 1.
  1169     12  LF-DEATH            PIC 9               VALUE 0.
  1170         88 PRT-LF-DEATH                         VALUE 1.
  1171     12  LF-EXPIRY           PIC 9               VALUE 0.
  1172         88 PRT-LF-EXPIRY                        VALUE 1.
  1173     12  LF-DECR             PIC 9               VALUE 0.
  1174         88 PRT-LF-DECR                          VALUE 1.
  1175     12  LF-INCR             PIC 9               VALUE 0.
  1176         88 PRT-LF-INCR                          VALUE 1.
  1177     12  LF-LUMP             PIC 9               VALUE 0.
  1178         88 PRT-LF-LUMP                          VALUE 1.
  1179     12  AH-ISSUE            PIC 9               VALUE 0.
  1180         88 PRT-AH-ISSUE                         VALUE 1.
  1181     12  AH-CANC             PIC 9               VALUE 0.
  1182         88 PRT-AH-CANC                          VALUE 1.
  1183     12  AH-CLAIM            PIC 9               VALUE 0.
  1184         88 PRT-AH-CLAIM                         VALUE 1.
  1185 01  PRINT-AMOUNTS.
  1186     12  PRT-ISSUE-AMT-LF    PIC S9(11)V99 COMP-3   VALUE ZERO.
  1187     12  PRT-CANC-AMT-LF     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1188     12  PRT-DEATH-AMT-LF    PIC S9(11)V99 COMP-3   VALUE ZERO.
  1189     12  PRT-EXPIRY-AMT-LF   PIC S9(11)V99 COMP-3   VALUE ZERO.
  1190     12  PRT-DECR-AMT-LF     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1191     12  PRT-INCR-AMT-LF     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1192     12  PRT-ISSUE-AMT-AH    PIC S9(11)V99 COMP-3   VALUE ZERO.
  1193     12  PRT-CANC-AMT-AH     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1194     12  PRT-CLAIM-AMT-AH    PIC S9(11)V99 COMP-3   VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* ECS150.cbl
  1196 01  RC-REC.
  1197     12  RC-CONTROL.
  1198         16  RC-COMP            PIC X(6).
  1199         16  RC-CMCTL.
  1200             20  RC-CNTRL-1     PIC X(19).
  1201             20  RC-CNTRL-2     PIC X(17).
  1202     12  RC-ENTRY-STATUS        PIC X.
  1203     12  RC-LFTYP               PIC XX.
  1204     12  RC-LF-TERM             PIC S9(3)       COMP-3.
  1205     12  RC-LFAMT               PIC S9(9)V99    COMP-3.
  1206     12  RC-LFPRM               PIC S9(7)V99    COMP-3.
  1207     12  RC-LFRFND              PIC S9(7)V99    COMP-3.
  1208     12  RC-LF-CANCEL-STATUS    PIC X.
  1209     12  RC-LF-CLAIM-STATUS     PIC X.
  1210     12  RC-LF-CURRENT-STATUS   PIC X.
  1211     12  RC-AHTYP               PIC XX.
  1212     12  RC-AH-TERM             PIC S9(3)       COMP-3.
  1213     12  RC-AHAMT               PIC S9(7)V99    COMP-3.
  1214     12  RC-AHPRM               PIC S9(7)V99    COMP-3.
  1215     12  RC-AHRFND              PIC S9(7)V99    COMP-3.
  1216     12  RC-AH-CANCEL-STATUS    PIC X.
  1217     12  RC-AH-CLAIM-STATUS     PIC X.
  1218     12  RC-AH-CURRENT-STATUS   PIC X.
  1219     12  RC-DTHAMT              PIC S9(9)V99    COMP-3.
  1220     12  RC-DISAMT              PIC S9(9)V99    COMP-3.
  1221     12  RC-IND-GRP             PIC X.
  1222     12  RC-LF-CANC-DT          PIC 9(11)       COMP-3.
  1223     12  RC-AH-CANC-DT          PIC 9(11)       COMP-3.
  1224     12  RC-DIS-DT              PIC 9(11)       COMP-3.
  1225     12  RC-ENT-DT              PIC 9(11)       COMP-3.
  1226     12  RC-LF-CANC-EXIT        PIC 9(11)       COMP-3.
  1227     12  RC-AH-CANC-EXIT        PIC 9(11)       COMP-3.
  1228     12  RC-LF-CLAIM-EXIT       PIC 9(11)       COMP-3.
  1229     12  RC-AH-CLAIM-EXIT       PIC 9(11)       COMP-3.
  1230     12  RC-PMT-FREQ            PIC 9(2).
  1231     12  RC-APR                 PIC S9(3)V9(4)  COMP-3.
  1232     12  RC-LOAN-TERM           PIC S9(3)       COMP-3.
  1233     12  RC-I-LIVES             PIC S9(3)       COMP-3.
  1234     12  RC-C-LIVES-YTD         PIC S9(3)       COMP-3.
  1235     12  RC-C-LIVES-ITD         PIC S9(3)       COMP-3.
  1236     12  RC-LFRFND-YTD          PIC S9(7)V99    COMP-3.
  1237     12  RC-AHRFND-YTD          PIC S9(7)V99    COMP-3.
  1238     12  RC-LF-TERM-IN-DAYS     PIC S9(5)       COMP-3.
  1239     12  RC-LF-EXPIRE-DT        PIC 9(11)       COMP-3.
  1240     12  RC-AH-EXPIRE-DT        PIC 9(11)       COMP-3.
  1241     12  RC-LOAN-1ST-PMT-DT     PIC 9(6).
  1242     12  RC-ORIG-LFAMT          PIC S9(9)V99    COMP-3.
  1243     12  RC-LFAMT-ALT           PIC S9(9)V99    COMP-3.
  1244     12  RC-CEDE-FACT           PIC S9(1)V9(4)  COMP-3.
  1245     12  FILLER                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* ECS150.cbl
  1247 01  PROCESSING-CONTROL-DATES.
  1248     12  PERIOD-START        PIC XX.
  1249     12  PERIOD-START-9      PIC S9(5)    COMP-3.
  1250     12  PERIOD-END          PIC XX.
  1251     12  PERIOD-END-9        PIC S9(5)    COMP-3.
  1252     12  CERT-EFFECT-DT      PIC XX.
  1253     12  FIRST-PAY-DT        PIC XX.
  1254     12  CERT-EXPIRE-DATE    PIC XX.
  1255     12  CERT-EXPIRE-DATE-O  PIC XX.
  1256     12  CANCEL-EXIT-DATE    PIC XX.
  1257     12  CLAIM-EXIT-DATE     PIC XX.
  1258     12  VALUATION-DATE      PIC S9(5)    COMP-3.
  1259     12  CERT-ENTRY-DATE     PIC XX.
  1260     12  LOW-EXIT-DATE       PIC XX.
  1261     12  SUM-CANCEL-DATE     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* ECS150.cbl
  1263 01  SAVE-CONTROL-BREAKS                         VALUE SPACES.
  1264     12  LAST-REINS-CO       PIC X(6).
  1265     12  SAVE-CNTRL-GRP.
  1266         16  LAST-CARRIER    PIC X.
  1267         16  LAST-GROUPING   PIC X(6).
  1268         16  LAST-STATE      PIC XX.
  1269         16  LAST-ACCOUNT    PIC X(10).
  1270
  1271 01  SAVE-EXP-DT.
  1272     12  SE-YR             PIC 99.
  1273     12  SE-MO             PIC 99.
  1274     12  SE-DA             PIC 99.
  1275
  1276 01  REMAINING-TERM-WORK-FIELDS.
  1277     12  BGN-DT.
  1278         16  BGN-YR          PIC 99.
  1279         16  BGN-MO          PIC 99.
  1280         16  BGN-DA          PIC 99.
  1281     12  END-DT.
  1282         16  END-YR          PIC 99.
  1283         16  END-MO          PIC 99.
  1284         16  END-DA          PIC 99.
  1285     12  TEMP-1              PIC S9(9)V9(7)  COMP-3 VALUE +0.
  1286     12  TEMP-2              PIC S9(9)V9(7)  COMP-3 VALUE +0.
  1287     12  TEMP-3              PIC S9(9)V9(7)  COMP-3 VALUE +0.
  1288     12  TEMP-4              PIC S9V9(8)     COMP-3 VALUE +0.
  1289     12  TEMP-5              PIC S9V9(8)     COMP-3 VALUE +0.
  1290     12  LF-REM-TRM          PIC S9(3)V99    COMP-3 VALUE +0.
  1291     12  AH-REM-TRM          PIC S9(3)V99    COMP-3 VALUE +0.
  1292     12  LF-BAL-REMTRM       PIC S9(3)V99    COMP-3 VALUE +0.
  1293     12  REM-TRM1            PIC S9(3)V99    COMP-3 VALUE +0.
  1294     12  REM-TRM2            PIC S9(3)V99    COMP-3 VALUE +0.
  1295     12  TEM-TRM1            PIC S9(3)V99    COMP-3 VALUE +0.
  1296     12  HLD-TRM             PIC S9(3)V99    COMP-3 VALUE +0.
  1297     12  RUN-DATE-BIN        PIC XX.
  1298     12  EP-DT-BIN           PIC XX.
  1299     12  WS-CR-BIN-DATE      PIC XX.
  1300
  1301 01  TEXAS-REG-WORK-AREAS.
  1302     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
  1303     12  TEX-FACT-2          PIC S9(3)       COMP-3.
  1304     12  TEX-FACT-3          PIC S9(3)       COMP-3.
  1305     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  1306     12  TEX-FACT-5          PIC S9(3)       COMP-3.
  1307     12  TEX-FACT-6          PIC S9(3)       COMP-3.
  1308     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  1309     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  1310     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  1311
  1312 01  NET-PAY-INTERFACE.
  1313     12  NP-APR              PIC S9(3)V9(4)  COMP-3.
  1314     12  NP-ORIG             PIC S9(3)       COMP-3.
  1315     12  NP-REM              PIC S9(3)       COMP-3.
  1316     12  NP251-ORIG          PIC S9(3)V99    COMP-3.
  1317     12  NP251-REM           PIC S9(3)V99    COMP-3.
  1318     12  NP-SUB              PIC S9(3)       COMP-3.
  1319     12  NP-EFF-DT           PIC X(06).
  1320     12  NP-OPT              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* ECS150.cbl
  1321     12  NP-CAP              PIC S9(3)       COMP-3.
  1322     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  1323     12  NP-WORK1            PIC S9(6)V9(9)  COMP-3.
  1324     12  NP-WORK2            PIC S9(6)V9(9)  COMP-3.
  1325     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  1326     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  1327     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  1328     12  NP-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* ECS150.cbl
  1330** OTHER WORK FIELDS
  1331 01  SAVE-REINS-CERT         PIC X(210).
  1332
  1333 01  COUNT-WORK              PIC S9(3)   COMP-3  VALUE +0.
  1334
  1335 01  COUNT-SAVE              PIC S9(3)   COMP-3  VALUE +0.
  1336 01  INFORCE-DOLLARS         PIC S9(9)V99 COMP-3 VALUE +0.
  1337 01  DOLLAR-AMT              PIC S9(9)V99 COMP-3 VALUE +0.
  1338 01  DECREASING-DOLLAR       PIC S9(9)V99 COMP-3 VALUE +0.
  1339 01  WS-PR-UN-PREM           PIC S9(7)V99 COMP-3 VALUE +0.
  1340 01  WS-PR-UN-PREM-ALT       PIC S9(7)V99 COMP-3 VALUE +0.
  1341 01  WS-R78-UN-PREM          PIC S9(7)V99 COMP-3 VALUE +0.
  1342 01  WS-R78-UN-PREM-ALT      PIC S9(7)V99 COMP-3 VALUE +0.
  1343 01  WS-STATE-UN-PREM        PIC S9(7)V99 COMP-3 VALUE +0.
  1344 01  AH-EARN-METHOD          PIC X(01)           VALUE SPACE.
  1345*
  1346*
  1347* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* ECS150.cbl
  1349 01  ACTIVITY-TOTAL-TABLE.
  1350     12  CONTROL-LEVELS OCCURS 5 TIMES.
  1351*          **ON PASS FOR 1ST INSURANCE COMPANY
  1352*            1=  STATE TOTALS   - 1ST INSURANCE
  1353*            2=  ACCOUNT TOTALS - 1ST INSURANCE
  1354*            3=  STATE TOTALS   - REINSURANCE
  1355*            4=  ACCOUNT TOTALS - REINSURANCE
  1356*            5=  NOT USED
  1357*          **ON PASS FOR REINSURANCE COMPANY
  1358*            1=  REINSURANCE COMPANY TOTALS
  1359*            2=  CARRIER TOTALS
  1360*            3=  COMPANY TOTALS
  1361*            4=  STATE TOTALS
  1362*            5=  ACCOUNT TOTALS
  1363*
  1364         16  TERM-GROUPS OCCURS 3 TIMES.
  1365*            1=  0-60 MONTHS
  1366*            2=  61 - 120 MONTHS
  1367*            3=  OVER 120 MONTHS
  1368*
  1369             20  INSURANCE-TYPES OCCURS 10 TIMES.
  1370*                **  1-5 ARE GROUP
  1371*                    6-10 ARE INDIVIDUAL
  1372*                 1,6 =  LIFE(RED)
  1373*                 2,7 =  LIFE(LEV)
  1374*                 3,8 =  LIFE(OB)
  1375*                 4,9 =  AH
  1376*                 5,10=  AH(OB)
  1377                 24  ISSUE-CNT   PIC S9(13)    COMP-3.
  1378                 24  ISSUE-AMT   PIC S9(11)V99 COMP-3.
  1379                 24  ISSUE-PREM  PIC S9(11)V99 COMP-3.
  1380                 24  CANCEL-CNT  PIC S9(13)    COMP-3.
  1381                 24  CANCEL-AMT  PIC S9(11)V99 COMP-3.
  1382                 24  CANCEL-PREM PIC S9(11)V99 COMP-3.
  1383                 24  CLAIM-CNT   PIC S9(13)    COMP-3.
  1384                 24  CLAIM-AMT   PIC S9(11)V99 COMP-3.
  1385                 24  EARN-PREM   PIC S9(11)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* ECS150.cbl
  1387 01  EXHIBIT-TOTALS-TABLE.
  1388     12  E-CONTROL-LEVELS OCCURS 5 TIMES.
  1389*            * DEFINITION OF LEVELS SAME AS ACTIVITY-TOTAL-TABLE
  1390         16  E-TERM-GROUPS OCCURS 3 TIMES.
  1391*            * DEFINITION OF LEVELS SAME AS ACTIVITY-TOTAL-TABLE
  1392             20  EXHIBIT-GROUPS OCCURS 9 TIMES.
  1393*                1=  INFORCE END OF PREVIOUS PERIOD
  1394*                2=  ISSUED DURING PERIOD
  1395*                3=  TOTAL INFORCE (LEV 1 + LEV 2)
  1396*                4=  DEATHS IN PERIOD
  1397*                5=  EXPIRED
  1398*                6=  CANCELLED
  1399*                7=  DECREASES
  1400*                8=  TOTAL DEDUCTIONS (LEV 4+5+6+7)
  1401*                9=  TOTAL INFORCE AT END OF PERIOD (LEV 3-8)
  1402*
  1403                 24  GROUP-CNT   PIC S9(13)    COMP-3.
  1404                 24  GROUP-AMT   PIC S9(11)V99 COMP-3.
  1405                 24  IND-CNT     PIC S9(13)    COMP-3.
  1406                 24  IND-AMT     PIC S9(11)V99 COMP-3.
  1407
  1408 01  AH-PAID-TABLE.
  1409     12  A-CONTROL-LEVELS OCCURS 5 TIMES.
  1410*            * DEFINITION OF LEVELS SAME AS ACTIVITY-TOTAL-TABLE.
  1411         16  AH-PAID-THIS-YR     PIC S9(11)V99 COMP-3.
  1412         16  AH-PAID-LAST-YR     PIC S9(11)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* ECS150.cbl
  1414 01  TABLE-SUBSCRIPTS    COMP.
  1415*
  1416* CONTROL-LEVELS
  1417     12  CL                  PIC S9(4).
  1418* TERM-GROUPS
  1419     12  TG                  PIC S9(4).
  1420* DETAIL (EXHIBIT GROUPS)
  1421     12  EG                  PIC S9(4).
  1422* DETAIL (INSURANCE TYPES)
  1423     12  IY                  PIC S9(4).
  1424* CONTROL-LEVELS + 1 (USED TO ROLL TOTALS)
  1425     12  CLX                 PIC S9(4).
  1426* LAST-ADD-LEVEL.
  1427     12  LA                  PIC S9(4).
  1428
  1429     12  SAV-LF-TERM-CODE    PIC S9(4).
  1430
  1431 01  DATE-EDIT-AREAS.
  1432     12  FORMAT-DATE.
  1433         16  XMM             PIC 99.
  1434         16  FILLER          PIC X               VALUE '/'.
  1435         16  XDD             PIC 99.
  1436         16  FILLER          PIC X               VALUE '/'.
  1437         16  XYY             PIC 99.
  1438     12  EDITED-DATE REDEFINES
  1439         FORMAT-DATE         PIC X(8).
  1440     12  RAW-DATE.
  1441         16  XCC             PIC 99.
  1442         16  XYY             PIC 99.
  1443         16  XMM             PIC 99.
  1444         16  XDD             PIC 99.
  1445     12  DATE-WORK REDEFINES
  1446         RAW-DATE            PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* ECS150.cbl
  1448 01  HEAD-LINE-1.
  1449     12  FILLER              PIC X(12)           VALUE
  1450             '  CARRIER - '.
  1451     12  HL-CARRIER          PIC X               VALUE SPACES.
  1452     12  FILLER              PIC X(34)           VALUE SPACES.
  1453     12  HL-CO-NAME          PIC X(30)           VALUE SPACES.
  1454     12  FILLER              PIC X(42)           VALUE SPACES.
  1455     12  FILLER              PIC X(8)            VALUE 'ECS150'.
  1456
  1457 01  HEAD-LINE-2.
  1458     12  FILLER              PIC X(12)           VALUE
  1459             ' GROUPING - '.
  1460     12  HL-COMPANY          PIC X(6)            VALUE SPACES.
  1461     12  FILLER              PIC X(23)           VALUE SPACES.
  1462     12  FILLER              PIC X(49)           VALUE
  1463             'CERTIFICATE ACTIVITY - DETAIL AND SUMMARY TOTALS'.
  1464     12  FILLER              PIC X(29)           VALUE SPACES.
  1465     12  HL-DATE             PIC X(8).
  1466
  1467 01  HEAD-LINE-3.
  1468     12  FILLER              PIC X(12)           VALUE
  1469             '  STATE   - '.
  1470     12  HL-STATE            PIC X(20)           VALUE SPACES.
  1471     12  FILLER              PIC X(17)           VALUE SPACES.
  1472     12  FILLER              PIC X(11)           VALUE
  1473             'FOR PERIOD '.
  1474     12  HL-PER-START        PIC X(8).
  1475     12  FILLER              PIC X(6)            VALUE ' THRU '.
  1476     12  HL-PER-END          PIC X(8).
  1477     12  FILLER              PIC X(37)           VALUE SPACES.
  1478     12  FILLER              PIC X(5)            VALUE 'PAGE '.
  1479     12  HL-PAGENO           PIC ZZ,ZZ9.
  1480
  1481 01  HEAD-LINE-4.
  1482     12  FILLER              PIC X(12)           VALUE
  1483             '  ACCOUNT - '.
  1484     12  HL-ACCOUNT          PIC X(11)           VALUE SPACES.
  1485     12  FILLER              PIC X(109)          VALUE SPACES.
  1486
  1487 01  HEAD-LINE-5.
  1488     12  FILLER              PIC X(25)           VALUE
  1489             '  REINSURANCE COMPANY - '.
  1490     12  HL-REIN-CO          PIC X(6)            VALUE SPACES.
  1491     12  FILLER              PIC X(101)          VALUE SPACES.
  1492
  1493 01  HEAD-LINE-6.
  1494     12  FILLER              PIC X(7)    VALUE '  *****'.
  1495     12  HL-MESSAGE          PIC X(21)   VALUE SPACES.
  1496     12  FILLER              PIC X(5)    VALUE '*****'.
  1497     12  FILLER              PIC X(99)   VALUE SPACES.
  1498
  1499 01  HEAD-LINE-7A.
  1500     12  FILLER              PIC X(44)           VALUE
  1501             '          CERTIFICATE     ISSUE    TERM     '.
  1502     12  FILLER              PIC X(44)           VALUE
  1503             '       PLAN       ORIGINAL        PREMIUM AM'.
  1504     12  FILLER              PIC X(44)           VALUE
  1505             'OUNTS                                       '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* ECS150.cbl
  1506
  1507 01  HEAD-LINE-7B.
  1508     12  FILLER              PIC X(44)           VALUE
  1509             '            NUMBER        DATE     AH  LF   '.
  1510     12  FILLER              PIC X(44)           VALUE
  1511             'TYPE   CODE        AMOUNT          LIFE     '.
  1512     12  FILLER              PIC X(44)           VALUE
  1513             ' AH        ACTIVITY      AMOUNT             '.
  1514
  1515 01  HEAD-LINE-8A.
  1516     12  FILLER              PIC X(44)           VALUE
  1517             ' CLASSIFICATION         I S S U E D         '.
  1518     12  FILLER              PIC X(44)           VALUE
  1519             '                  C A N C E L L E D         '.
  1520     12  FILLER              PIC X(44)           VALUE
  1521             '          C L A I M S            E A R N E D'.
  1522
  1523 01  HEAD-LINE-8B.
  1524     12  FILLER              PIC X(44)           VALUE
  1525             '*************** ****************************'.
  1526     12  FILLER              PIC X(44)           VALUE
  1527             '********    ********************************'.
  1528     12  FILLER              PIC X(44)           VALUE
  1529             '****   *********************    ************'.
  1530
  1531 01  HEAD-LINE-8C.
  1532     12  FILLER              PIC X(44)           VALUE
  1533            ' TYPE    TERM   -COUNT- ----AMOUNT----  --PR'.
  1534     12  FILLER              PIC X(44)           VALUE
  1535            'EMIUM---    -COUNT- ----AMOUNT----  --PREMIU'.
  1536     12  FILLER              PIC X(44)           VALUE
  1537            'M---   -COUNT- ---AMOUNT----    ---AMOUNT---'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* ECS150.cbl
  1539 01  DETAIL-LINE-1.
  1540     12  FILLER              PIC X(8)            VALUE SPACES.
  1541     12  DL-CERT-NO          PIC X(10).
  1542     12  DL-CERT-SUFX        PIC X.
  1543     12  FILLER              PIC X(5)            VALUE SPACES.
  1544     12  DL-ISSUE-DT         PIC X(8).
  1545     12  FILLER              PIC XX              VALUE SPACES.
  1546     12  DL-AH-TERM          PIC ZZ9.
  1547     12  FILLER              PIC X               VALUE SPACES.
  1548     12  DL-LF-TERM          PIC ZZ9.
  1549     12  FILLER              PIC X(4)            VALUE SPACES.
  1550     12  DL-TYPE             PIC XXX.
  1551     12  FILLER              PIC X(4)            VALUE SPACES.
  1552     12  DL-PLAN             PIC XXX.
  1553     12  FILLER              PIC X(2)            VALUE SPACES.
  1554     12  DL-ORIG-AMT         PIC ZZZ,ZZZ,ZZ9.99.
  1555     12  FILLER              PIC X(5)            VALUE SPACES.
  1556     12  DL-LF-PREM          PIC ZZ,ZZ9.99.
  1557     12  DL-AH-PREM          PIC ZZ,ZZ9.99.
  1558     12  FILLER              PIC X(7)            VALUE SPACES.
  1559     12  DL-ACTIVITY         PIC X(5).
  1560     12  DL-RSRV-AMT         PIC ZZZ,ZZZ,ZZ9.99-.
  1561     12  FILLER              PIC X(14)           VALUE SPACES.
  1562
  1563 01  DETAIL-LINE-2.
  1564     12  DL-DESCRIP          PIC X(16)           VALUE SPACES.
  1565     12  DL-ISS-CNT          PIC ZZZ,ZZ9.
  1566     12  DL-ISS-AMT          PIC ZZZ,ZZZ,ZZ9.99-.
  1567     12  DL-ISS-PRM          PIC ZZ,ZZZ,ZZ9.99-.
  1568     12  FILLER              PIC XX              VALUE SPACES.
  1569     12  DL-CAN-CNT          PIC ZZZ,ZZ9.
  1570     12  FILLER              PIC X               VALUE SPACES.
  1571     12  DL-CAN-AMT          PIC ZZZ,ZZZ,ZZ9.99.
  1572     12  FILLER              PIC X               VALUE SPACES.
  1573     12  DL-CAN-PRM          PIC ZZ,ZZZ,ZZ9.99.
  1574     12  FILLER              PIC XXX             VALUE SPACES.
  1575     12  DL-CLM-CNT          PIC ZZZ,ZZ9.
  1576     12  FILLER              PIC X               VALUE SPACES.
  1577     12  DL-CLM-AMT          PIC ZZ,ZZZ,ZZ9.99.
  1578     12  FILLER              PIC XX              VALUE SPACES.
  1579     12  DL-EARN-AMT         PIC ZZ,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* ECS150.cbl
  1581 01  ABEND-CD.
  1582     12  ABEND-CODE.
  1583         16  ABEND-FILE-ID       PIC XX VALUE ZEROS.
  1584         16  ABEND-CODE-1 REDEFINES ABEND-FILE-ID
  1585                                 PIC XX.
  1586         16  ABEND-REASON        PIC XX VALUE ZEROS.
  1587         16  ABEND-CODE-2 REDEFINES ABEND-REASON
  1588                                 PIC XX.
  1589     12  ABEND-OPTION    PIC X          VALUE 'Y'.
  1590     12  PGM-SUB         PIC S999 COMP  VALUE +150.
  1591     12  R-EX-DT             PIC X(6).
  1592
  1593 01  KB-REIN.
  1594     12  CLM-INCUR-REIN-DATE PIC 9(6).
  1595     12  CLM-INCUR-REIN-DATE-R REDEFINES CLM-INCUR-REIN-DATE.
  1596         16  CIRD-CCYY.
  1597             20  CIRD-CC     PIC 99.
  1598             20  CIRD-YR     PIC 99.
  1599         16  CIRD-MO         PIC 99.
  1600     12  DTO-CC              PIC 99.
  1601     12  DTO-YR              PIC 99.
  1602     12  DTO-MO              PIC 99.
  1603     12  FLA-CLM-REIN-BASE   PIC S9(5)V99.
  1604     12  ADJ-FLA-REIN-BASE   PIC S9(5)V99.
  1605     12  REIN-RT-SW          PIC X               VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* ECS150.cbl
* 1607                             COPY ECSRITAB.
  1608******************************************************************04/29/98
  1609*                                                                *ECSRITAB
  1610*                            ECSRITAB                            *   LV015
  1611*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1612*                            VMOD=2.015                          *ECSRITAB
  1613*                                                                *ECSRITAB
  1614*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  1615*                                                                *ECSRITAB
  1616******************************************************************ECSRITAB
  1617 01  REIN-WORK-AREAS.                                             ECSRITAB
  1618     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1619     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1620     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1621     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1622     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1623     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1624     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1625     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1626     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1627     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1628     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  1629         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  1630             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  1631             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  1632             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  1633     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1634     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1635     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1636     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1637     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1638     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1639     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1640     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1641     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1642     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1643     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1644     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1645     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1646     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1647     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1648     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1649     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1650     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1651     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1652     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1653     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1654     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1655     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1656                                                                  ECSRITAB
  1657 01  REIN-HOLD-AREAS.                                             ECSRITAB
  1658     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  1659         16  REIN-COMP               PIC X(6).                    ECSRITAB
  1660         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  1661             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  1662             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  1663         16  REIN-WORK-FLDS.                                      ECSRITAB
  1664             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1665             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  1666             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  1667             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  1668             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  1669             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  1670             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  1671             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  1672             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  1673             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  1674             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  1675             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  1676             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  1677             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  1678             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1679             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1680             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  1681             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  1682             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  1683             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  1684             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1685             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1686             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  1687             20  REIN-REM-SW         PIC X.                       ECSRITAB
  1688             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  1689             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  1690             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  1691             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  1692     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  1693                                                                  ECSRITAB
  1694     12  RWF-FIELDS.                                              ECSRITAB
  1695         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  1696         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  1697         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  1698         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  1699         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  1700         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  1701         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  1702         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  1703         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  1704         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  1705         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  1706         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  1707         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  1708         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  1709         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1710         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1711         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  1712         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  1713         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  1714         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  1715         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1716         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1717         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  1718         16  RWF-REM-SW              PIC X.                       ECSRITAB
  1719         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  1720         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  1721         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  1722         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1723                                                                  ECSRITAB
  1724     12  WT-COMP-INFO.                                            ECSRITAB
  1725         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  1726         16  WT-LF-QC                PIC X.                       ECSRITAB
  1727         16  WT-AH-QC                PIC X.                       ECSRITAB
  1728         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  1729         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  1730         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  1731         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  1732         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
  1733         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  1734         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  1735         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  1736         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  1737         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  1738         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  1739         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  1740         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  1741         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  1742         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  1743         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  1744         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  1745         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  1746         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  1747         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  1748         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  1749         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  1750         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  1751         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  1752         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  1753         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  1754         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  1755         16  WT-REMAINING            PIC X.                       ECSRITAB
  1756         16  FILLER                  PIC X(21).                   ECSRITAB
  1757                                                                  ECSRITAB
  1758 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  1759     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  1760     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  1761     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  1762     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  1763     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  1764     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  1765     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1766     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1767     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  1768     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1769     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  1770     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  1771     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1772     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1773     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  1774     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  1775     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  1776     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  1777     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1778     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1779     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1780     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1781     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1782     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  1783                                                                  ECSRITAB
  1784     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  1785         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  1786     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  1787         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  1788     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  1789         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  1790     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  1791         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  1792     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  1793         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  1794     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  1795         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  1796                                                                  ECSRITAB
  1797     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  1798         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  1799         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  1800         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  1801         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  1802         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  1803         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  1804         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  1805         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  1806         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  1807         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  1808         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  1809         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  1810         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  1811         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  1812         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  1813         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  1814         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  1815         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  1816         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  1817         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  1818         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  1819         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  1820         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  1821     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  1822     12  REIN-SEARCH.                                             ECSRITAB
  1823         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  1824         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  1825         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  1826         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  1827     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  1828     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  1829     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  1830     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  1831     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  1832     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  1833     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1834     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  1835     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1836     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1837     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1838     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1839     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1840     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  1841     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1842     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1843     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1844     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  1845     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  1846     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  1847     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  1848     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
  1849     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  1850     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  1851     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  1852                                                                  ECSRITAB
  1853 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  1854* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  1855     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  1856         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  1857         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  1858         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  1859         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  1860         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  1861         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1862         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  1863         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1864         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  1865                                                                  ECSRITAB
  1866 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  1867     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  1868         16  RC2-REIN-CO.                                         ECSRITAB
  1869             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  1870             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  1871         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1872         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1873         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1874         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1875         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  1876         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  1877                                                                  ECSRITAB
  1878 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  1879     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  1880         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  1881         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  1882     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  1883                                                                  ECSRITAB
  1884 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  1885     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  1886         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  1887         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  1888         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  1889 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  1890     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  1891         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  1892                                                                  ECSRITAB
  1893 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  1894******************************************************************ECSRITAB
* 1895                             COPY ELCPSEVR.
  1896******************************************************************04/16/98
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* ECS150.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  1897*                                                                *ELCPSEVR
  1898*                                                                *ELCPSEVR
  1899*                            ELCPSEVR                            *   LV003
  1900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1901*                            VMOD=2.001                          *ELCPSEVR
  1902*                                                                *ELCPSEVR
  1903*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  1904*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  1905*                                                                *ELCPSEVR
  1906******************************************************************ELCPSEVR
  1907                                                                  ELCPSEVR
  1908 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  1909     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  1910         10  FILLER               PIC 999.                        ELCPSEVR
  1911         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  1912         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  1913             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  1914             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  1915         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  1916         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  1917     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  1918            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  1919     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  1920         10  FILLER              PIC 999.                         ELCPSEVR
  1921         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  1922         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  1923             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  1924             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  1925         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  1926         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  1927     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  1928            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  1929 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  1930     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  1931                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  1932         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  1933             15  FILLER              PIC 999.                     ELCPSEVR
  1934             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  1935             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  1936                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  1937                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  1938             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  1939             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  1940         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  1941                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  1942         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  1943             15  FILLER              PIC 999.                     ELCPSEVR
  1944             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  1945             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  1946                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  1947                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  1948             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  1949             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  1950         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  1951                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  1952         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  1953             15  FILLER              PIC 999.                     ELCPSEVR
  1954             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* ECS150.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  1955             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  1956                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  1957                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  1958             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  1959             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  1960         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  1961                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  1962     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  1963         10  FILLER              PIC 999.                         ELCPSEVR
  1964         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  1965         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  1966             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  1967             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  1968         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  1969         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  1970     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  1971            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  51
* ECS150.cbl
  1973 01  CLAS150-EXTRACT-RECORD.
  1974     12  ER-SORT-KEY.
  1975         16  ER-CONTROL.
  1976             20  ER-REINS-CO             PIC X(06).
  1977             20  ER-CARRIER              PIC X(01).
  1978             20  ER-COMPANY              PIC X(06).
  1979             20  ER-STATE                PIC X(02).
  1980             20  ER-ACCOUNT              PIC X(10).
  1981         16  ER-ST-SEQ                   PIC X(02).
  1982         16  ER-REC-TYPE                 PIC 99.
  1983     12  ER-PERIOD-START                 PIC 9(11)  COMP-3.
  1984     12  ER-PERIOD-END                   PIC 9(11)  COMP-3.
  1985     12  ER-ACTIVITY-TOTALS.
  1986         16  ER-TERM-GROUP OCCURS 3 TIMES.
  1987*                1= 0-60 MONTHS
  1988*                2= 61-120 MONTHS
  1989*                3= 121 AND OVER
  1990             20  ER-TYPE-GROUPS OCCURS 10 TIMES.
  1991*                1= LIFE(R-GP)       6= LIFE(R-IND)
  1992*                2= LIFE(L-GP)       7= LIFE(L-IND)
  1993*                3= LIFE(OB-GP)      8= LIFE(OB-IND)
  1994*                4= AH(GP)           9= AH(IND)
  1995*                5= AH(OB-GP)       10= AH(OB-IND)
  1996                 24  ER-DETAIL.
  1997                     28  ER-ISSUE-CNT    PIC S9(13)    COMP-3.
  1998                     28  ER-ISSUE-AMT    PIC S9(11)V99 COMP-3.
  1999                     28  ER-ISSUE-PREM   PIC S9(11)V99 COMP-3.
  2000                     28  ER-CANCEL-CNT   PIC S9(13)    COMP-3.
  2001                     28  ER-CANCEL-AMT   PIC S9(11)V99 COMP-3.
  2002                     28  ER-CANCEL-PREM  PIC S9(11)V99 COMP-3.
  2003                     28  ER-CLAIM-CNT    PIC S9(13)    COMP-3.
  2004                     28  ER-CLAIM-AMT    PIC S9(11)V99 COMP-3.
  2005                     28  ER-EARN-PREM    PIC S9(11)V99 COMP-3.
  2006     12  ER-EXHIBIT-TOTALS.
  2007         16  ER-TERM-GROUP-E OCCURS 3 TIMES.
  2008*                1= 0-60 MONTHS
  2009*                2= 61-120 MONTHS
  2010*                3= 121 AND OVER
  2011             20  ER-LINE-DETAIL OCCURS 9 TIMES.
  2012*                1= INFORCE PREVIOUS PER  6= CANCELED IN PERIOD
  2013*                2= ISSUED IN PERIOD      7= DECREASES IN PERIOD
  2014*                3= TOTAL INFORCE-START   8= TOTAL DEC IN PERIOD
  2015*                4= DEATHS IN PERIOD      9= TOTAL INFORCE AT END
  2016*                5= EXPIRED IN PERIOD
  2017                 24  ER-DETAIL-E.
  2018                     28  ER-GROUP-CNT    PIC S9(13)    COMP-3.
  2019                     28  ER-GROUP-AMT    PIC S9(11)V99 COMP-3.
  2020                     28  ER-IND-CNT      PIC S9(13)    COMP-3.
  2021                     28  ER-IND-AMT      PIC S9(11)V99 COMP-3.
  2022
  2023     12  ER-AH-PD-THIS                   PIC S9(11)V99 COMP-3.
  2024     12  ER-AH-PD-LAST                   PIC S9(11)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  52
* ECS150.cbl
* 2026                             COPY ECSCRT01.
  2027******************************************************************
  2028*                                                                *
  2029*                            ECSCRT01                            *
  2030*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2031*                            VMOD=2.016                          *
  2032*                                                                *
  2033*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  2034*                                                                *
  2035*   FILE TYPE = SEQUENTIAL
  2036*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  2037*                                                                *
  2038*   KEY DATA =                         START=4, LEN=36           *
  2039*                                                                *
  2040*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  2041*                                                                *
  2042******************************************************************
  2043******************************************************************
  2044*                   C H A N G E   L O G
  2045*
  2046* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2047*-----------------------------------------------------------------
  2048*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2049* EFFECTIVE    NUMBER
  2050*-----------------------------------------------------------------
  2051* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2052* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  2053* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2054* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  2055* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2056* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  2057* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2058* 032612  CR2011110200001  PEMA  AHL CHANGES
  2059******************************************************************
  2060
  2061 01  CERTIFICATE-RECORD.
  2062     12  CR-RECORD-ID                      PIC XX.
  2063         88  VALID-CR-ID                      VALUE 'CR'.
  2064
  2065     12  CR-COMPANY-CD                     PIC X.
  2066
  2067     12  CR-FULL-CONTROL.
  2068         16  CR-CONTROL-1.
  2069             20  CR-ACCT-CONTROL.
  2070                 24  CR-CARRIER            PIC X.
  2071                 24  CR-GROUPING.
  2072                     28  CR-GROUP-PREFIX   PIC XXX.
  2073                     28  CR-GROUP-PRIME    PIC XXX.
  2074                 24  CR-STATE              PIC XX.
  2075                 24  CR-ACCOUNT.
  2076                     28  CR-ACCT-PREFIX    PIC X(4).
  2077                     28  CR-ACCT-PRIME     PIC X(6).
  2078             20  CR-DT                     PIC 9(11)  COMP-3.
  2079         16  CR-CERT-NO.
  2080             20  CR-CERT.
  2081                 24  CR-CERT-PREFIX        PIC X(3).
  2082                 24  CR-CERT-PRIME         PIC X(7).
  2083             20  CR-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  53
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2084
  2085     12  CR-INSUREDS-PROFILE.
  2086         16  CR-NAME.
  2087             20  CR-LNAME                  PIC X(15).
  2088             20  CR-FNAME.
  2089                 24  CR-1ST-INITIAL        PIC X.
  2090                 24  FILLER                PIC X(9).
  2091             20  CR-INIT                   PIC X.
  2092         16  CR-AGE                        PIC 99.
  2093         16  CR-SEX                        PIC X.
  2094             88  CR-SEX-MALE                  VALUE 'M'.
  2095             88  CR-SEX-FEMALE                VALUE 'F'.
  2096         16  CR-SOC-SEC                    PIC X(11).
  2097         16  CR-JOINT-NAME.
  2098             20  CR-JT-LNAME               PIC X(15).
  2099             20  CR-JT-FNAME.
  2100                 24  CR-JT-1ST-INIT        PIC X.
  2101                 24  FILLER                PIC X(9).
  2102             20  CR-JT-INIT                PIC X.
  2103         16  CR-JOINT-AGE                  PIC 99.
  2104
  2105         16  cr-ahl-ah-claim-no            pic x(9).
  2106         16  cr-ahl-ah-cert-seq            pic x(3).
  2107         16  cr-hst-proc-lf                pic x.
  2108         16  f                             pic x(7).
  2109
  2110     12  CR-LF-COVERAGE-DATA.
  2111         16  CR-LFTYP                      PIC XX.
  2112         16  CR-LF-TERM                    PIC S999       COMP-3.
  2113         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  2114         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  2115         16  CR-LF-DEV-CODE                PIC XXX.
  2116         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  2117
  2118         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  2119         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  2120         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  2121         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  2122
  2123         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  2124         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  2125         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  2126         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  2127
  2128         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  2129         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  2130
  2131         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  2132         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  2133
  2134         16  CR-LF-REFUND-TYPE             PIC X.
  2135         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  2136
  2137         16  CR-LF-COMM-CHARGEBACK         PIC X.
  2138             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
  2139
  2140         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  2141
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  54
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2142         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  2143         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  2144         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  2145
  2146         16  cr-ahl-lf-claim-no            pic x(9).
  2147         16  cr-ahl-lf-cert-seq            pic x(3).
  2148         16  FILLER                        PIC XX.
  2149
  2150     12  CR-AH-COVERAGE-DATA.
  2151         16  CR-AHTYP                      PIC XX.
  2152         16  CR-AH-TERM                    PIC S999       COMP-3.
  2153         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  2154         16  CR-AH-DEV-CODE                PIC XXX.
  2155         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  2156
  2157         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  2158         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  2159         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  2160         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  2161
  2162         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  2163         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  2164
  2165         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  2166         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  2167
  2168         16  CR-AH-REFUND-TYPE             PIC X.
  2169         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  2170
  2171         16  CR-AH-COMM-CHARGEBACK         PIC X.
  2172             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  2173
  2174         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  2175
  2176         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  2177         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  2178         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  2179
  2180         16  FILLER                        PIC XX.
  2181*        16  FILLER                        PIC X(8).
  2182
  2183     12  CR-LOAN-DATA.
  2184         16  CR-LIVES                      PIC S9(7)      COMP-3.
  2185         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  2186                                           PIC S9(5)V99   COMP-3.
  2187         16  CR-BILLED                     PIC S9(7)      COMP-3.
  2188         16  CR-APR                        PIC S999V9(4)  COMP-3.
  2189         16  CR-PMT-FREQ                   PIC 99.
  2190         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  2191         16  CR-RATING-CLASS               PIC XX.
  2192         16  CR-POLICY-FORM-NO             PIC X(12).
  2193         16  CR-GRPTYP                     PIC XX.
  2194         16  CR-IND-GRP                    PIC X.
  2195             88  CR-INDIVIDUAL                VALUE '1'.
  2196             88  CR-GROUP                     VALUE '2'.
  2197         16  CR-SKIP                       PIC 99.
  2198             88  NO-MONTHS-SKIPPED            VALUE 00.
  2199             88  SKIP-JULY                    VALUE 01.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  55
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2200             88  SKIP-AUGUST                  VALUE 02.
  2201             88  SKIP-SEPTEMBER               VALUE 03.
  2202             88  SKIP-JULY-AUG                VALUE 04.
  2203             88  SKIP-AUG-SEPT                VALUE 05.
  2204             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  2205             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  2206             88  SKIP-JUNE                    VALUE 08.
  2207             88  SKIP-JUNE-JULY               VALUE 09.
  2208             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  2209             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  2210         16  CR-RESIDENT-STATE             PIC XX.
  2211         16  CR-RATE-CODE.
  2212             20  CR-LF-CLASS-CD            PIC XX.
  2213             20  CR-AH-CLASS-CD            PIC XX.
  2214         16  CR-MORT.
  2215             20  CR-TAB                    PIC X.
  2216             20  CR-INT                    PIC 99.
  2217             20  CR-GRP                    PIC X.
  2218         16  CR-MEMBER-NO                  PIC X(12).
  2219         16  CR-OLD-LOF                    PIC XXX.
  2220*        16  CR-LOAN-OFFICER               PIC XXX.
  2221         16  CR-REIN-TABLE                 PIC XXX.
  2222         16  CR-REIN-SPEC                  PIC X.
  2223         16  CR-LOAN-1ST-PMT-DT.
  2224             20  CR-1ST-PMT-YR             PIC 99.
  2225             20  CR-1ST-PMT-MO             PIC 99.
  2226             20  CR-1ST-PMT-DA             PIC 99.
  2227         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  2228         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  2229         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  2230         16  CR-LAST-ADD-ON-DT             PIC XX.
  2231
  2232         16  CR-UNDERWRITING-CODE          PIC X.
  2233             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2234
  2235         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  2236         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  2237         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  2238         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  2239
  2240     12  CR-STATUS-INFORMATION.
  2241         16  CR-ENTRY-STATUS               PIC X.
  2242             88  CR-NORMAL-ENTRY              VALUE '1'.
  2243             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  2244             88  CR-CONVERSION-ENTRY          VALUE '4'.
  2245             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  2246             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  2247             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  2248             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  2249             88  CR-POLICY-IS-VOID            VALUE 'V'.
  2250             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  2251             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  2252                                                    '5' '9' 'P'.
  2253         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  2254
  2255         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  2256         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  2257         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  56
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2258
  2259         16  CR-LF-STATUS-AT-DEATH         PIC X.
  2260         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  2261
  2262         16  CR-LF-CURRENT-STATUS          PIC X.
  2263             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  2264             88  CR-LF-POLICY-PENDING         VALUE '2'.
  2265             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  2266             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  2267             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  2268             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2269             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  2270             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2271             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  2272             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  2273             88  CR-LF-IS-DECLINED            VALUE 'D'.
  2274             88  CR-LF-IS-VOID                VALUE 'V'.
  2275             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2276                                                    '4' '5' '9'.
  2277
  2278         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  2279
  2280         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  2281         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  2282
  2283         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  2284         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  2285
  2286         16  CR-AH-CURRENT-STATUS          PIC X.
  2287             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  2288             88  CR-AH-POLICY-PENDING         VALUE '2'.
  2289             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  2290             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  2291             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  2292             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2293             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  2294             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2295             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  2296             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  2297             88  CR-AH-IS-DECLINED            VALUE 'D'.
  2298             88  CR-AH-IS-VOID                VALUE 'V'.
  2299             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2300                                                    '4' '5' '9'.
  2301         16  CR-LOAN-OFFICER               PIC X(5).
  2302         16  CR-CANCEL-REASON              PIC X.
  2303         16  cr-xycor-lf-cov-code          pic x(4).
  2304         16  cr-xycor-ah-cov-code          pic x(4).
  2305         16  FILLER                        PIC X(6).
  2306
  2307     12  CR-DEATH-CLAIM-DATA.
  2308         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  2309
  2310         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  2311         16  CR-DTH-RPT-DT.
  2312             20  CR-DTH-RPT-YR             PIC 99.
  2313             20  CR-DTH-RPT-MO             PIC 99.
  2314             20  CR-DTH-RPT-DA             PIC 99.
  2315         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  57
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2316
  2317         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  2318         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  2319         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  2320         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  2321         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  2322
  2323         16  CR-DTH-AGE                    PIC 99.
  2324         16  CR-DTH-PAY-CD                 PIC X.
  2325         16  CR-DEATH-CAUSE                PIC X(6).
  2326
  2327         16  FILLER                        PIC X(16).
  2328
  2329     12  CR-DISAB-CLAIM-DATA.
  2330         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  2331
  2332         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  2333         16  CR-DIS-RPT-DT.
  2334             20  CR-DIS-RPT-YR             PIC 99.
  2335             20  CR-DIS-RPT-MO             PIC 99.
  2336             20  CR-DIS-RPT-DA             PIC 99.
  2337         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  2338         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  2339
  2340         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  2341         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  2342         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  2343         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  2344         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  2345
  2346         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  2347         16  CR-DIS-PAY-CD                 PIC X.
  2348         16  FILLER                        PIC XX.
  2349
  2350         16  CR-DISAB-INCURRED-DETAIL.
  2351             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  2352**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  2353                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  2354                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  2355                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  2356
  2357         16  CR-DISAB-CAUSE                PIC X(6).
  2358         16  FILLER                        PIC X(14).
  2359
  2360     12  CR-REMIT-TO                       PIC 99.
  2361
  2362     12  CR-COMPENSATION-LEVELS.
  2363         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  2364             20  CR-COM-AGT.
  2365                 24  CR-COM-AGT-PREFIX     PIC X(4).
  2366                 24  CR-COM-AGT-PRIME      PIC X(6).
  2367             20  CR-AGT-TYPE               PIC X.
  2368             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  2369             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  2370
  2371     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  2372     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  2373     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  58
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2374     12  CR-CLP-STATE                      PIC XX.
  2375     12  CR-POST-CARD-IND                  PIC X.
  2376     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  2377     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  2378     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  2379     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  2380     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  2381     12  FILLER                            PIC X(07).
  2382
  2383     12  CR-CSR-CODE                       PIC XXX.
  2384
  2385     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  2386     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  2387
  2388     12  CR-MICROFILM-NUMBERS.
  2389*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  2390         16  FILLER                        PIC X(5).
  2391     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  2392
  2393     12  CR-USER-CODE                      PIC X.
  2394     12  CR-USER-FUTURE                    PIC X(9).
  2395
  2396     12  CR-BENEFICIARY.
  2397         16  CR-BANK-NO                    PIC X(10).
  2398         16  FILLER                        PIC X(15).
  2399
  2400     12  CR-ENTRY-BATCH                    PIC X(6).
  2401     12  CR-LF-EXIT-BATCH                  PIC X(6).
  2402     12  CR-AH-EXIT-BATCH                  PIC X(6).
  2403
  2404     12  CR-NOTE-SW                        PIC X.
  2405
  2406     12  CR-ORIGIN-INDICATOR               PIC X.
  2407         88  CR-ENTERED-MANUALLY              VALUE '1'.
  2408         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  2409
  2410     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  2411     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  2412     12  FILLER                            PIC X(33).
  2413
  2414******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  59
* ECS150.cbl
* 2416                             COPY ELCDATE.
  2417******************************************************************06/11/98
  2418*                                                                *ELCDATE
  2419*                                                                *ELCDATE
  2420*                            ELCDATE.                            *   LV023
  2421*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  2422*                            VMOD=2.003                           ELCDATE
  2423*                                                                *ELCDATE
  2424*                                                                *ELCDATE
  2425*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  2426*                 LENGTH = 200                                   *   CL*19
  2427******************************************************************ELCDATE
  2428                                                                  ELCDATE
  2429 01  DATE-CONVERSION-DATA.                                        ELCDATE
  2430     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  2431     12  DC-OPTION-CODE                PIC X.                        CL*15
  2432         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  2433         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  2434         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  2435         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  2436         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  2437         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  2438         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  2439         88  FIND-CENTURY               VALUE '7'.                   CL*22
  2440         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  2441         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  2442         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  2443         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  2444         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  2445         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  2446         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  2447         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  2448         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  2449         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  2450         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  2451         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  2452         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  2453         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  2454         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  2455         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  2456         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  2457         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  2458         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  2459         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  2460         88  THREE-CHARACTER-BIN                                  ELCDATE
  2461                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  2462         88  GREGORIAN-TO-BIN                                        CL**2
  2463                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  2464         88  BIN-TO-GREGORIAN                                        CL**2
  2465                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  2466         88  JULIAN-TO-BINARY                                        CL**2
  2467                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  2468     12  DC-ERROR-CODE                 PIC X.                        CL*15
  2469         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  2470         88  DATE-CONVERSION-ERROR                                ELCDATE
  2471                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  2472         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  2473         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  60
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2474         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  2475         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  2476         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  2477         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  2478         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  2479         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  2480         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  2481         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  2482     12  DC-END-OF-MONTH               PIC X.                        CL*15
  2483         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  2484     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  2485         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  2486         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  2487         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  2488     12  FILLER                        PIC X.                        CL*15
  2489     12  DC-CONVERSION-DATES.                                        CL*15
  2490         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  2491         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  2492         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  2493         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  2494                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  2495             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  2496             20  SLASH1-1              PIC X.                        CL*15
  2497             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  2498             20  SLASH1-2              PIC X.                        CL*15
  2499             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  2500         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  2501         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  2502                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  2503             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  2504             20  SLASH2-1              PIC X.                        CL*15
  2505             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  2506             20  SLASH2-2              PIC X.                        CL*15
  2507             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  2508         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  2509         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  2510                     DC-GREG-DATE-1-YMD.                          ELCDATE
  2511             20  DC-YMD-YEAR           PIC 99.                       CL*15
  2512             20  DC-YMD-MONTH          PIC 99.                       CL*15
  2513             20  DC-YMD-DAY            PIC 99.                       CL*15
  2514         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  2515         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  2516                      DC-GREG-DATE-1-MDY.                         ELCDATE
  2517             20  DC-MDY-MONTH          PIC 99.                       CL*15
  2518             20  DC-MDY-DAY            PIC 99.                       CL*15
  2519             20  DC-MDY-YEAR           PIC 99.                       CL*15
  2520         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  2521             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  2522             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  2523             20  FILLER                PIC XX.                       CL*15
  2524             20  DC-ALPHA-CENTURY.                                   CL*15
  2525                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  2526             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  2527         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  2528         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  2529         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  2530         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  2531         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  61
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2532                                       PIC 9(05).                    CL*20
  2533         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  2534             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  2535             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  2536         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  2537         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  2538         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  2539     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  2540         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  2541         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  2542             20  FILLER                PIC 9(3).                     CL*15
  2543             20  HOLD-CEN-1-CCYY.                                    CL*15
  2544                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  2545                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  2546             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  2547             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  2548         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  2549             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  2550             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  2551             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  2552                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  2553                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  2554             20  FILLER                PIC 9(3).                     CL*15
  2555         16  HOLD-CENTURY-1-X.                                       CL*15
  2556             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  2557             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  2558                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  2559                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  2560             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  2561             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  2562         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  2563             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  2564             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  2565             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  2566                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  2567                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  2568             20  FILLER                PIC XXX.                      CL*23
  2569         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  2570         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  2571         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  2572         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  2573             20  DC-JULIAN-1-CCYY.                                   CL*15
  2574                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  2575                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  2576             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  2577         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  2578         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  2579             20  DC-JULIAN-2-CCYY.                                   CL*15
  2580                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  2581                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  2582             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  2583         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  2584             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  2585             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  2586             20  DC-EDITA-DAY          PIC 99.                       CL*15
  2587             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  2588             20  DC-EDITA-CCYY.                                      CL*15
  2589                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  62
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2590                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  2591         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  2592             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  2593             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  2594             20  DC-EDITB-DAY          PIC 99.                       CL*15
  2595             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  2596             20  DC-EDITB-CCYY.                                      CL*15
  2597                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  2598                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  2599         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  2600         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  2601                              DC-GREG-DATE-CYMD.                  ELCDATE
  2602             20  DC-CYMD-CEN           PIC 99.                       CL*15
  2603             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  2604             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  2605             20  DC-CYMD-DAY           PIC 99.                       CL*15
  2606         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  2607         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  2608                              DC-GREG-DATE-MDCY.                  ELCDATE
  2609             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  2610             20  DC-MDCY-DAY           PIC 99.                       CL*15
  2611             20  DC-MDCY-CEN           PIC 99.                       CL*15
  2612             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  2613    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  2614        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  2615    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  2616    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  63
* ECS150.cbl
* 2618                             COPY ELCCALC.
  2619******************************************************************04/15/98
  2620*                                                                *ELCCALC
  2621*                           ELCCALC.                            *    LV003
  2622*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2623*                            VMOD=2.025                          *   CL**3
  2624*                                                                *   CL**2
  2625*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  2626*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  2627*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  2628*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  2629*                                                                *   CL**2
  2630*  PASSED TO ELRTRM                                              *   CL**2
  2631*  -----------------                                             *   CL**2
  2632*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  2633*  ORIGINAL TERM                                                 *   CL**2
  2634*  BEGINNING DATE                                                *   CL**2
  2635*  ENDING DATE                                                   *   CL**2
  2636*  COMPANY I.D.                                                  *   CL**2
  2637*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  2638*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  2639*  FREE LOOK DAYS                                                *   CL**2
  2640*                                                                *   CL**2
  2641*  RETURNED FROM ELRTRM                                          *   CL**2
  2642*  ---------------------                                         *   CL**2
  2643*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  2644*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  2645*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  2646*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  2647*----------------------------------------------------------------*   CL**2
  2648*  PASSED TO ELRAMT                                              *   CL**2
  2649*  ----------------                                              *   CL**2
  2650*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  2651*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2652*  ORIGINAL AMOUNT                                               *   CL**2
  2653*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  2654*  A.P.R. - NET PAY ONLY                                         *   CL**2
  2655*  METHOD                                                            CL**2
  2656*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  2657*  COMPANY I.D.                                                  *   CL**2
  2658*  BENEFIT TYPE                                                  *   CL**2
  2659*                                                                *   CL**2
  2660*  RETURNED FROM ELRAMT                                          *   CL**2
  2661*  --------------------                                          *   CL**2
  2662*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  2663*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  2664*  REMAINING AMOUNT FACTOR                                           CL**2
  2665*----------------------------------------------------------------*   CL**2
  2666*  PASSED TO ELRESV                                              *   CL**2
  2667*  -----------------                                             *   CL**2
  2668*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  2669*  VALUATION DATE                                                *   CL**2
  2670*  PAID THRU DATE                                                *   CL**2
  2671*  BENEFIT                                                       *   CL**2
  2672*  INCURRED DATE                                                 *   CL**2
  2673*  REPORTED DATE                                                 *   CL**2
  2674*  ISSUE AGE                                                     *   CL**2
  2675*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  64
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2676*  CDT PERCENT                                                   *   CL**2
  2677*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  2678* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  2679* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  2680* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  2681*                                                                *   CL**2
  2682*  RETURNED FROM ELRESV                                          *   CL**2
  2683*  --------------------                                          *   CL**2
  2684*  CDT TABLE USED                                                *   CL**2
  2685*  CDT FACTOR USED                                               *   CL**2
  2686*  PAY TO CURRENT RESERVE                                        *   CL**2
  2687*  I.B.N.R. - A/H ONLY                                           *   CL**2
  2688*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  2689*----------------------------------------------------------------*   CL**2
  2690*  PASSED TO ELRATE                                              *   CL**2
  2691*  ----------------                                              *   CL**2
  2692*  CERT ISSUE DATE                                               *   CL**2
  2693*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2694*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2695*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  2696*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2697*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2698*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2699*  DEVIATION CODE                                                *   CL**2
  2700*  ISSUE AGE                                                     *   CL**2
  2701*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2702*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2703*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  2704*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2705*  A.P.R.                                                        *   CL**2
  2706*  METHOD                                                            CL**2
  2707*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2708*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2709*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2710*  BENEFIT CODE                                                  *   CL**2
  2711*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2712*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  2713*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  2714*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  2715*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  2716*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  2717*                                                                *   CL**2
  2718*  RETURNED FROM ELRATE                                          *   CL**2
  2719*  --------------------                                          *   CL**2
  2720*  CALCULATED PREMIUM                                            *   CL**2
  2721*  PREMIUM RATE                                                  *   CL**2
  2722*  MORTALITY CODE                                                *   CL**2
  2723*  MAX ATTAINED AGE                                              *   CL**2
  2724*  MAX AGE                                                       *   CL**2
  2725*  MAX TERM                                                      *   CL**2
  2726*  MAX MONTHLY BENEFIT                                           *   CL**2
  2727*  MAX TOTAL BENIFIT                                             *   CL**2
  2728*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  2729*----------------------------------------------------------------*   CL**2
  2730*  PASSED TO ELRFND                                              *   CL**2
  2731*  ----------------                                              *   CL**2
  2732*  CERT ISSUE DATE                                               *   CL**2
  2733*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  65
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2734*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2735*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2736*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2737*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2738*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2739*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2740*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2741*  DEVIATION CODE                                                *   CL**2
  2742*  ISSUE AGE                                                     *   CL**2
  2743*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2744*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2745*  PROCESS TYPE (CANCEL)                                         *   CL**2
  2746*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2747*  A.P.R.                                                        *   CL**2
  2748*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  2749*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  2750*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2751*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2752*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2753*  BENEFIT CODE                                                  *   CL**2
  2754*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2755*                                                                *   CL**2
  2756*  RETURNED FROM ELRFND                                          *   CL**2
  2757*  --------------------                                          *   CL**2
  2758*  CALCULATED REFUND                                             *   CL**2
  2759*----------------------------------------------------------------*   CL**2
  2760*  PASSED TO ELEARN                                              *   CL**2
  2761*  ----------------                                              *   CL**2
  2762*  CERT ISSUE DATE                                               *   CL**2
  2763*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2764*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2765*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2766*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2767*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2768*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2769*  DEVIATION CODE                                                *   CL**2
  2770*  ISSUE AGE                                                     *   CL**2
  2771*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2772*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2773*  A.P.R.                                                        *   CL**2
  2774*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  2775*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2776*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2777*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2778*  BENEFIT CODE                                                  *   CL**2
  2779*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2780*                                                                *   CL**2
  2781*  RETURNED FROM ELEARN                                          *   CL**2
  2782*  --------------------                                          *   CL**2
  2783*  INDICATED  EARNINGS                                           *   CL**2
  2784*----------------------------------------------------------------*   CL**2
  2785*                 LENGTH = 450                                   *   CL**2
  2786*                                                                *   CL**2
  2787******************************************************************   CL**2
  2788******************************************************************
  2789*                   C H A N G E   L O G
  2790*
  2791* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  66
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2792*-----------------------------------------------------------------
  2793*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2794* EFFECTIVE    NUMBER
  2795*-----------------------------------------------------------------
  2796* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2797* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2798* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2799* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2800* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2801* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2802* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2803* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2804* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2805******************************************************************
  2806                                                                     CL**2
  2807 01  CALCULATION-PASS-AREA.                                          CL**2
  2808     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  2809                                     COMP.                           CL**2
  2810                                                                     CL**2
  2811     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  2812       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  2813       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  2814                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  2815       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  2816       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  2817       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  2818       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  2819       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  2820       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  2821       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  2822       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  2823       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  2824       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  2825       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  2826       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  2827       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  2828       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  2829       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  2830       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  2831       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  2832                                                                     CL**2
  2833     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  2834       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  2835***********************  INPUT AREAS ****************************    CL**2
  2836                                                                     CL**2
  2837     12  CP-CALCULATION-AREA.                                        CL**2
  2838         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  2839         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  2840         16  CP-VALUATION-DT       PIC XX.                           CL**2
  2841         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  2842         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  2843           88  CP-AH                               VALUE 'A' 'D'     CL**2
  2844                                                   'I' 'U'.          CL**2
  2845           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  2846           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  2847         16  CP-INCURRED-DT        PIC XX.                           CL**2
  2848         16  CP-REPORTED-DT        PIC XX.                           CL**2
  2849         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  67
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2850         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  2851         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  2852                                     COMP-3.                         CL**2
  2853         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  2854                                     COMP-3.                         CL**2
  2855         16  CP-CDT-METHOD         PIC X.                            CL**2
  2856           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  2857           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  2858           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  2859         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  2860           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  2861           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  2862         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  2863                                     COMP-3.                         CL**2
  2864         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  2865                                     COMP-3.                         CL**2
  2866         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  2867                                     COMP-3.                         CL**2
  2868         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  2869                                     COMP-3.                         CL**2
  2870         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2871                                     COMP-3.                         CL**2
  2872         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  2873                                     COMP-3.                         CL**2
  2874         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  2875                                     COMP-3.                         CL**2
  2876         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  2877           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  2878           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  2879           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  2880           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  2881           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  2882           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  2883           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  2884         16  CP-EARNING-METHOD     PIC X.                            CL**2
  2885           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  2886           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  2887           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  2888           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  2889           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  2890           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  2891           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  2892           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  2893           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  2894           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  2895           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2896           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2897           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2898           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2899         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  2900           88  CP-CLAIM                            VALUE '1'.        CL**2
  2901           88  CP-CANCEL                           VALUE '2'.        CL**2
  2902           88  CP-ISSUE                            VALUE '3'.        CL**2
  2903         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  2904           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  2905           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  2906           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  2907           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  68
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2908           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  2909           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  2910           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  2911           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  2912           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  2913           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  2914           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  2915           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  2916           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  2917           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  2918           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  2919           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  2920           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  2921           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  2922                                                     'W' 'X'.        CL**2
  2923           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  2924           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  2925           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  2926           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  2927           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  2928           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  2929           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  2930           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  2931           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  2932           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  2933           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  2934           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  2935           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  2936                                                                     CL**2
  2937         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  2938                                     COMP-3.                         CL**2
  2939         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  2940         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  2941         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  2942         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  2943         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  2944           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  2945               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  2946         16  CP-R78-OPTION         PIC X.                            CL**2
  2947           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  2948           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  2949                                                                     CL**2
  2950         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  2951         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  2952         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  2953         16  CP-RATE-FILE          PIC X.                            CL**2
  2954         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  2955                                     COMP-3.                         CL**2
  2956                                                                     CL**2
  2957         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  2958         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  2959                                                                     CL**2
  2960         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  2961                                     COMP-3.
  2962         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2963                                   PIC S9(5)V99 COMP-3.
  2964         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  2965                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  69
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2966         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2967                                     COMP-3.                         CL**2
  2968         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  2969                                     COMP-3.
  2970         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2971                                  PIC S9(7)V99 COMP-3.
  2972                                                                     CL**2
  2973         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  2974         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  2975         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  2976           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  2977           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  2978           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  2979           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  2980         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  2981         16  CP-CARRIER            PIC X.                            CL**2
  2982         16  CP-REIN-FLAG          PIC X.                            CL**2
  2983         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  2984           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  2985                      '2' '3' '4' '5'.                               CL**2
  2986           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  2987           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  2988           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  2989           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  2990           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  2991           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  2992           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  2993           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2994         16  CP-SIG-SWITCH         PIC X.                            CL**2
  2995         16  CP-RATING-METHOD      PIC X.                            CL**2
  2996           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  2997           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  2998           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  2999           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  3000           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  3001           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  3002           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  3003           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  3004           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  3005         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  3006                                     COMP-3.                         CL**2
  3007         16  CP-BEN-CATEGORY       PIC X.
  3008         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3009         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3010                                   PIC S99V9(5) COMP-3.
  3011         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3012         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3013                                   PIC S99V9(5) COMP-3.
  3014         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3015         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3016         16  CP-EXPIRE-DT          PIC XX.
  3017         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3018         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3019         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3020         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3021         16  CP-DDF-SPEC-CALC      PIC X.
  3022             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3023             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  70
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3024         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3025         16  CP-CANCEL-REASON      PIC X.
  3026         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3027         16  CP-PMT-MODE           PIC X.
  3028         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3029         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3030         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3031         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3032         16  FILLER                PIC X.
  3033                                                                     CL**2
  3034***************    OUTPUT FROM ELRESV   ************************     CL**2
  3035                                                                     CL**2
  3036         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  3037                                                                     CL**2
  3038         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  3039                                     COMP-3.                         CL**2
  3040         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  3041                                     COMP-3.                         CL**2
  3042         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  3043                                     COMP-3.                         CL**2
  3044         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  3045                                     COMP-3.                         CL**2
  3046         16  FILLER                PIC X(09).                        CL**2
  3047***************    OUTPUT FROM ELRTRM   *************************    CL**2
  3048                                                                     CL**2
  3049         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  3050                                     COMP-3.                         CL**2
  3051         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  3052                                     COMP-3.                         CL**2
  3053         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  3054                                     COMP-3.                         CL**2
  3055         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  3056                                     COMP-3.                         CL**2
  3057         16  FILLER                PIC X(12).                        CL**2
  3058                                                                     CL**2
  3059***************    OUTPUT FROM ELRAMT   *************************    CL**2
  3060                                                                     CL**2
  3061         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  3062                                     COMP-3.                         CL**2
  3063         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  3064                                     COMP-3.                         CL**2
  3065         16  FILLER                PIC X(12).                        CL**2
  3066                                                                     CL**2
  3067***************    OUTPUT FROM ELRATE   *************************    CL**2
  3068                                                                     CL**2
  3069         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  3070                                     COMP-3.                         CL**2
  3071         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  3072                                     COMP-3.                         CL**2
  3073         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  3074         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  3075             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  3076         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  3077                                     COMP-3.                         CL**2
  3078         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  3079         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3080         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3081                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  71
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3082         16  FILLER                PIC X(07).                        CL**2
  3083                                                                     CL**2
  3084***************    OUTPUT FROM ELRFND   *************************    CL**2
  3085                                                                     CL**2
  3086         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  3087                                     COMP-3.                         CL**2
  3088         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  3089           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  3090           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  3091           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  3092           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  3093           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  3094           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  3095           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  3096           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  3097           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  3098           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3099           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3100           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3101           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3102           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3103         16  FILLER                PIC X(12).                        CL**2
  3104                                                                     CL**2
  3105***************    OUTPUT FROM ELEARN   *************************    CL**2
  3106                                                                     CL**2
  3107         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  3108                                     COMP-3.                         CL**2
  3109         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  3110                                     COMP-3.                         CL**2
  3111         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  3112                                     COMP-3.                         CL**2
  3113         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  3114                                     COMP-3.                         CL**2
  3115         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  3116                                     COMP-3.                         CL**2
  3117         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  3118                                     COMP-3.                         CL**2
  3119         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  3120           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  3121           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  3122           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  3123           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  3124           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  3125           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  3126           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  3127           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  3128           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  3129         16  FILLER                PIC X(12).                        CL**2
  3130                                                                     CL**2
  3131***************    OUTPUT FROM ELPMNT   *************************    CL**2
  3132                                                                     CL**2
  3133         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  3134                                     COMP-3.                         CL**2
  3135         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  3136                                     COMP-3.                         CL**2
  3137         16  FILLER                PIC X(12).                        CL**2
  3138                                                                     CL**2
  3139***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  72
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3140         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  3141                                     COMP-3.                         CL**2
  3142         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  3143                                     COMP-3.                         CL**2
  3144         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  3145                                     COMP-3.                         CL**2
  3146         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  3147                                     COMP-3.                         CL**2
  3148         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  3149                                     COMP-3.                         CL**2
  3150         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  3151                                     COMP-3.                         CL**2
  3152         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  3153             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  3154             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  3155             88  IO-ERROR                         VALUE 'E'.         CL**2
  3156                                                                     CL**2
  3157         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  3158                                                                     CL**2
  3159         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  3160                                                                     CL**2
  3161         16  CP-RESERVE-REMAINING-TERM                               CL**2
  3162                                   PIC S9(4)V9    VALUE ZERO         CL**2
  3163                                     COMP-3.                         CL**2
  3164                                                                     CL**2
  3165         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  3166                                                                     CL**2
  3167         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  3168                                     COMP-3.                         CL**2
  3169                                                                     CL**2
  3170         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  3171                                     COMP-3.                         CL**2
  3172                                                                     CL**2
  3173         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  3174                                     COMP-3.                         CL**2
  3175                                                                     CL**2
  3176         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  3177                                     COMP-3.                         CL**2
  3178                                                                     CL**2
  3179         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  3180                                     COMP-3.                         CL**2
  3181                                                                     CL**2
  3182         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  3183                                     COMP-3.                         CL**2
  3184                                                                     CL**2
  3185         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  3186                                     COMP-3.                         CL**2
  3187                                                                     CL**2
  3188         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  3189             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  3190                                                                     CL**2
  3191         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  3192                                     COMP-3.                         CL**2
  3193         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3194                                     COMP-3.
  3195         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3196         16  FILLER                PIC X(15).                        CL**2
  3197******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  73
* ECS150.cbl
* 3199                             COPY ELCDTECX.
  3200******************************************************************06/05/98
  3201*                                                                *ELCDTECX
  3202*                            ELCDTECX.                           *   LV005
  3203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3204*                            VMOD=2.015                          *ELCDTECX
  3205*                                                                *ELCDTECX
  3206*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  3207*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  3208*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  3209*                                                                *ELCDTECX
  3210******************************************************************ELCDTECX
  3211******************************************************************
  3212*                   C H A N G E   L O G
  3213*
  3214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3215*-----------------------------------------------------------------
  3216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3217* EFFECTIVE    NUMBER
  3218*-----------------------------------------------------------------
  3219* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  3220*                                  BENEFIT CODES FROM 300 TO 900
  3221* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  3222* 051304    2003080800002  SMVA  ADD REFUND METHOD
  3223******************************************************************
  3224 01  DATE-CARD.                                                   ELCDTECX
  3225     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  3226     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  3227     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  3228     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  3229     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  3230     12  EP-SW                       PIC  X.                      ELCDTECX
  3231         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  3232     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  3233         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  3234     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  3235     12  RUN-CENTURY.                                             ELCDTECX
  3236         16 RUN-CENTURY-N            PIC  99.                        CL**4
  3237     12  FILLER                      PIC  X.                         CL**4
  3238     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  3239     12  FILLER                      PIC  XXX.                    ELCDTECX
  3240     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  3241                                                                  ELCDTECX
  3242 01  FILLER                          PIC  X(7)                       CL**6
  3243                                          VALUE 'OPTIONS'.        ELCDTECX
  3244 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  3245     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  3246     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  3247     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  3248         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  3249         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  3250     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  3251     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  3252     12  FILLER                      PIC  X.                      ELCDTECX
  3253     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  3254     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  3255     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  3256     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  74
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3257     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  3258     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  3259     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  3260     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  3261     12  FILLER                      PIC  X.                      ELCDTECX
  3262     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  3263     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  3264     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  3265     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  3266     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  3267     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  3268     12  FILLER                      PIC  X.                      ELCDTECX
  3269     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  3270     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  3271     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  3272     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  3273     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  3274     12  DTE-R78                     PIC  X.                      ELCDTECX
  3275     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  3276     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  3277     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  3278     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  3279     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  3280     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  3281     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  3282                                     PIC  X.                      ELCDTECX
  3283         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  3284                                                 ' '.             ELCDTECX
  3285         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  3286         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  3287     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  3288         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  3289         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  3290     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  3291     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  3292                                     PIC  9.                         CL**4
  3293     12  DTE-SYSTEM.                                              ELCDTECX
  3294         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  3295         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  3296         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  3297         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  3298         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  3299         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  3300         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  3301         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  3302         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  3303         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  3304         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  3305         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  3306         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  3307         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  3308         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  3309         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  3310         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  3311         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  3312         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  3313         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  3314         16  DTE-SYS-U               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  75
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3315         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  3316         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  3317         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  3318         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  3319         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  3320     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  3321         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  3322                                     PIC  X.                      ELCDTECX
  3323     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  3324                                                                  ELCDTECX
  3325 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  3326     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  3327     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  3328     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  3329*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  3330     12  FILLER                      PIC  X.                      ELCDTECX
  3331     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  3332     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  3333     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  3334     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  3335     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  3336     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  3337     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  3338                                                                  ELCDTECX
  3339     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  3340     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  3341     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  3342     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  3343                                                                  ELCDTECX
  3344     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  3345     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  3346     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  3347     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  3348                                                                  ELCDTECX
  3349     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  3350     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  3351                                                                  ELCDTECX
  3352     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  3353     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  3354                                                                  ELCDTECX
  3355     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  3356                                                                  ELCDTECX
  3357 01  DATE-CARD-FACTORS.                                           ELCDTECX
  3358     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  3359     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  3360     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  3361     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  3362     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  3363     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  3364     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  3365                                                                  ELCDTECX
  3366 01  FILLER                          PIC  X(12)                   ELCDTECX
  3367                                          VALUE 'COMPANY NAME'.   ELCDTECX
  3368 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  3369     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  3370         16  CNT-ID                  PIC  X.                      ELCDTECX
  3371         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  3372                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  76
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3373 01  FILLER                          PIC  X(11)                   ELCDTECX
  3374                                          VALUE 'STATE NAMES'.    ELCDTECX
  3375 01  STATE-NAMES.                                                 ELCDTECX
  3376     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  3377         16  STATE-SUB               PIC  XX.                     ELCDTECX
  3378         16  STATE-PIC1.                                          ELCDTECX
  3379             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  3380             20  FILLER              PIC  XXX.                    ELCDTECX
  3381             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  3382             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  3383             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  3384             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  3385                                                                  ELCDTECX
  3386 01  FILLER                          PIC  X(13)                   ELCDTECX
  3387                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  3388 01  CARRIER-NAMES.                                               ELCDTECX
  3389     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  3390         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  3391         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  3392         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  3393         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3394         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3395         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3396*        16  FILLER                  PIC  X.                      ELCDTECX
  3397         16  CARRIER-SEC-PAY         PIC  X.
  3398             88  SEC-PAY-CARRIER          VALUE 'Y'.
  3399                                                                  ELCDTECX
  3400 01  FILLER                          PIC  X(9)                       CL**6
  3401                                          VALUE 'INS TYPES'.      ELCDTECX
  3402 01  CLAS-INS-TYPES.                                              ELCDTECX
  3403*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  3404     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  3405         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  3406         16  CLAS-I-AB3.                                          ELCDTECX
  3407             20  FILLER              PIC  X.                      ELCDTECX
  3408             20  CLAS-I-AB2.                                      ELCDTECX
  3409                 24  FILLER          PIC  X.                      ELCDTECX
  3410                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  3411         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  3412             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  3413             20  FILLER              PIC  X.                         CL**4
  3414         16  CLAS-I-AB10.                                         ELCDTECX
  3415             20  FILLER              PIC  X(9).                   ELCDTECX
  3416             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  3417         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  3418         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  3419         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  3420         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  3421             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  3422         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  3423         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  3424         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  3425         16  CLAS-I-BEN-CATEGORY     PIC  X.
  3426         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  3427         16  FILLER                  PIC  X(05).
  3428                                                                  ELCDTECX
  3429 01  FILLER                          PIC  X(16)                   ELCDTECX
  3430                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  77
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3431 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  3432     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  3433                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  3434         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  3435         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  3436         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  3437         16  CLAS-MORT-DESC.                                      ELCDTECX
  3438             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  3439             20  FILLER              PIC  XX.                        CL**5
  3440             20  CLAS-YEAR           PIC  X(4).                      CL**6
  3441             20  FILLER              PIC  X.                         CL**5
  3442             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  3443             20  FILLER              PIC  X.                         CL**5
  3444             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  3445             20  FILLER              PIC  X.                         CL**5
  3446             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  3447             20  FILLER              PIC  X(5).                      CL**6
  3448                                                                  ELCDTECX
  3449 01  FILLER                          PIC  X(15)                   ELCDTECX
  3450                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  3451 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  3452     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  3453         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  3454         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  3455         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  3456         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  3457         16  FILLER                  PIC  X(4).                      CL**6
  3458                                                                  ELCDTECX
  3459 01  FILLER                          PIC  X(7)                       CL**6
  3460                                     VALUE 'INDEXES'.             ELCDTECX
  3461 01  CLAS-INDEX-TBL.                                              ELCDTECX
  3462     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  3463     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  3464     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  3465     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  3466     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  3467     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  3468     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  3469     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  3470     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  3471     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  3472     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  3473     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  3474     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  3475     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  3476     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  3477     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  3478     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  3479                                                                  ELCDTECX
  3480 01  CLAS-TYPE-MISC.                                              ELCDTECX
  3481     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  3482     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  3483     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  3484     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  3485     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  3486     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  3487     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  3488     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  78
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3489     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  3490     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  3491     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  3492                                                                  ELCDTECX
  3493 01  FILLER                          PIC  X(13)                   ELCDTECX
  3494                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  3495 01  CLAS-MISC.                                                   ELCDTECX
  3496     12  DTE-FICH                    PIC  X.                      ELCDTECX
  3497         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  3498         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  3499         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  3500     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  3501     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  3502     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  3503     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  3504     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  3505     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  3506     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  3507     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  3508     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  3509     12  STATE-L                     PIC  XX.                     ELCDTECX
  3510     12  CLAS-CN                     PIC  99.                     ELCDTECX
  3511     12  CLAS-CO                     PIC  99.                     ELCDTECX
  3512     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  3513         16  DTE-F-1                 PIC  X.                      ELCDTECX
  3514         16  DTE-F-2                 PIC  X.                      ELCDTECX
  3515     12  DTE-ABEND-WORK.                                          ELCDTECX
  3516         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  3517         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  3518                                                                  ELCDTECX
  3519 01  FILLER                          PIC  X(12)                   ELCDTECX
  3520                                     VALUE 'WORKING DATE'.        ELCDTECX
  3521 01  WS-DATE-AND-TIME.                                            ELCDTECX
  3522     12  WS-ACCEPT-DATE.                                          ELCDTECX
  3523         16  WS-AD-YY                PIC  99.                     ELCDTECX
  3524         16  WS-AD-MM                PIC  99.                     ELCDTECX
  3525         16  WS-AD-DD                PIC  99.                     ELCDTECX
  3526     12  WS-CURRENT-DATE.                                         ELCDTECX
  3527         16  WS-CD-MM                PIC  99.                     ELCDTECX
  3528         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3529         16  WS-CD-DD                PIC  99.                     ELCDTECX
  3530         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3531         16  WS-CD-YY                PIC  99.                     ELCDTECX
  3532     12  WS-TIME-OF-DAY.                                          ELCDTECX
  3533         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  3534         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  3535                                                                  ELCDTECX
  3536 01  FILLER                          PIC  X(12)                   ELCDTECX
  3537                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  3538 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  3539     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  3540         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  3541         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  3542         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  3543                                                                  ELCDTECX
  3544 01  FILLER                          PIC  X(10)                   ELCDTECX
  3545                                     VALUE 'STATE TLRS'.          ELCDTECX
  3546 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  79
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3547     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  3548         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  3549         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  3550                                                                  ELCDTECX
  3551 01  FILLER                          PIC  X(13)                   ELCDTECX
  3552                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  3553 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  3554     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  3555         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  3556                                                                  ELCDTECX
  3557 01  FILLER                          PIC  X(13)                   ELCDTECX
  3558                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  3559 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  3560     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  3561     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  3562     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  3563                                     PIC  X.                         CL**5
  3564     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  3565     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  3566     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  3567     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  3568     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  3569     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  3570     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  3571     12  FILLER                      PIC  X(75).                  ELCDTECX
  3572******************************************************************ELCDTECX
  3573*01  MISC-CARR-PCT-DATA.                                          00001521
  3574*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3575*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3576*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3577*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3578*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3579*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3580******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  80
* ECS150.cbl
* 3582                             COPY ELCDTEVR.
  3583***************************************************************** 04/15/98
  3584*                                                                *ELCDTEVR
  3585*                                                                *ELCDTEVR
  3586*                            ELCDTEVR.                           *   LV003
  3587*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3588*                            VMOD=2.001                          *   CL**2
  3589*                                                                *ELCDTEVR
  3590*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  3591*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  3592*                                                                *ELCDTEVR
  3593******************************************************************ELCDTEVR
  3594 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  3595     05  WS-RUN-DATE.                                             ELCDTEVR
  3596         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3597         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  3598         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  3599             15  RUN-CC              PIC  99.                     ELCDTEVR
  3600             15  RUN-YR              PIC  99.                     ELCDTEVR
  3601         10  RUN-MO                  PIC  99.                     ELCDTEVR
  3602         10  RUN-DA                  PIC  99.                     ELCDTEVR
  3603     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  3604            WS-RUN-DATE              PIC 9(11).                      CL**2
  3605     05  WS-EP-DT.                                                ELCDTEVR
  3606         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3607         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  3608         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  3609             15  EP-CC               PIC  99.                     ELCDTEVR
  3610             15  EP-YR               PIC  99.                     ELCDTEVR
  3611         10  EP-MO                   PIC  99.                     ELCDTEVR
  3612         10  EP-DA                   PIC  99.                     ELCDTEVR
  3613     05  WS-EP-DT-N REDEFINES                                        CL**2
  3614            WS-EP-DT                 PIC 9(11).                      CL**2
  3615     05  WS-DTE-CONV-DT.                                             CL**4
  3616         10  FILLER                  PIC  9(03).                     CL**4
  3617         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  3618         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  3619             15  DTE-CONV-CC         PIC  99.                        CL**4
  3620             15  DTE-CONV-YR         PIC  99.                        CL**4
  3621         10  DTE-CONV-MO             PIC  99.                        CL**4
  3622         10  DTE-CONV-DA             PIC  99.                        CL**4
  3623     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  3624            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  3625 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  3626     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  3627         10  FILLER                            PIC 999.           ELCDTEVR
  3628         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  3629         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  3630             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  3631             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  3632         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  3633         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  3634     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  3635            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  3636     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  3637         10  FILLER                            PIC 999.           ELCDTEVR
  3638         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  3639         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  81
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3640         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  3641         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  3642     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  3643            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  3644 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  3645     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  3646         10  FILLER                            PIC 999.           ELCDTEVR
  3647         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  3648         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  3649             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  3650             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  3651         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  3652         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  3653     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  3654            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  3655     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  3656         10  FILLER                            PIC 999.           ELCDTEVR
  3657         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  3658         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  3659             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  3660             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  3661         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  3662         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  3663     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  3664            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  3665     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  3666         10  FILLER                            PIC 999.           ELCDTEVR
  3667         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  3668         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  3669             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  3670             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  3671         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  3672         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  3673     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  3674            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  3675 01  WS-RATE-RECORD.                                              ELCDTEVR
  3676         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  3677             10  FILLER                        PIC 999.           ELCDTEVR
  3678             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  3679             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  3680                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  3681                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  3682             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  3683             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  3684         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  3685                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  82
* ECS150.cbl
* 3687                             COPY ELCCRTVR.
  3688***************************************************************** 04/24/98
  3689*                                                                *ELCCRTVR
  3690*                                                                *ELCCRTVR
  3691*                            ELCCRTVR                            *   LV003
  3692*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3693*                            VMOD=2.001                          *ELCCRTVR
  3694*                                                                *ELCCRTVR
  3695*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  3696*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  3697*                                                                *ELCCRTVR
  3698******************************************************************ELCCRTVR
  3699                                                                  ELCCRTVR
  3700 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  3701     05  WS-CR-DT.                                                ELCCRTVR
  3702         10  FILLER                PIC 999.                       ELCCRTVR
  3703         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  3704         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  3705             15  CR-CC             PIC 99.                        ELCCRTVR
  3706             15  CR-YR             PIC 99.                        ELCCRTVR
  3707         10  CR-MO                 PIC 99.                        ELCCRTVR
  3708         10  CR-DA                 PIC 99.                        ELCCRTVR
  3709     05  WS-CR-DT-N REDEFINES                                        CL**2
  3710            WS-CR-DT               PIC 9(11).                        CL**2
  3711     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  3712         10  FILLER                    PIC 999.                   ELCCRTVR
  3713         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3714         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  3715             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3716             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3717         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3718         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3719     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  3720            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  3721     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  3722         10  FILLER                    PIC 999.                   ELCCRTVR
  3723         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3724         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  3725             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3726             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3727         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3728         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3729     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  3730            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  3731     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  3732         10  FILLER                    PIC 999.                   ELCCRTVR
  3733         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  3734         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  3735             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  3736             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  3737         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  3738         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  3739     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  3740            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  3741     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  3742         10  FILLER                    PIC 999.                   ELCCRTVR
  3743         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3744         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  83
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3745             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  3746             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  3747         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  3748         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  3749     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  3750            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  3751     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  3752         10  FILLER                    PIC 999.                   ELCCRTVR
  3753         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3754         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  3755             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  3756             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  3757         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  3758         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  3759     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3760            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3761     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  3762         10  FILLER                    PIC 999.                   ELCCRTVR
  3763         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3764         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  3765             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  3766             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  3767         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  3768         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  3769     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  3770            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  3771     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  3772         10  FILLER                    PIC 999.                   ELCCRTVR
  3773         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3774         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  3775             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  3776             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  3777         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  3778         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  3779     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  3780            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  3781     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  3782         10  FILLER                    PIC 999.                   ELCCRTVR
  3783         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3784         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  3785             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  3786             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  3787         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  3788         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  3789     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3790            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3791     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  3792         10  FILLER                    PIC 999.                   ELCCRTVR
  3793         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3794         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  3795             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  3796             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  3797         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  3798         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  3799     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  3800          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  3801     05  WS-CR-DTH-DT.                                            ELCCRTVR
  3802         10  FILLER                    PIC 999.                   ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  84
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3803         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  3804         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  3805             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  3806             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  3807         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  3808         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  3809     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  3810            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  3811     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  3812         10  FILLER                    PIC 999.                   ELCCRTVR
  3813         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3814         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  3815             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  3816             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  3817         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  3818         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  3819     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  3820            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  3821     05  WS-CR-DIS-DT.                                            ELCCRTVR
  3822         10  FILLER                    PIC 999.                   ELCCRTVR
  3823         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  3824         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  3825             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  3826             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  3827         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  3828         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  3829     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  3830            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  3831     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  3832         10  FILLER                    PIC 999.                   ELCCRTVR
  3833         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3834         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  3835             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  3836             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  3837         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  3838         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  3839     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  3840            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  3841     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  3842         10  FILLER                    PIC 999.                   ELCCRTVR
  3843         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  3844         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  3845             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  3846             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  3847         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  3848         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  3849     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  3850            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  3851     05  COPY-NDX                      PIC 9.                        CL**6
  3852     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  3853         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  3854             15  FILLER                PIC 999.                   ELCCRTVR
  3855             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  3856             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  3857                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  3858                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  3859             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  3860             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  85
* ECS150.cbl
  3861         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  3862                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  86
* ECS150.cbl
* 3864                             COPY ELCACCTV.
  3865******************************************************************04/14/98
  3866*                                                                *ELCACCTV
  3867*                            ELCACCTV                            *   LV002
  3868*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3869*                            VMOD=2.001                          *ELCACCTV
  3870*                                                                *ELCACCTV
  3871*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  3872*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  3873*                                                                *ELCACCTV
  3874*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  3875*                                                                *ELCACCTV
  3876******************************************************************ELCACCTV
  3877                                                                  ELCACCTV
  3878 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  3879                                                                  ELCACCTV
  3880     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  3881         10  FILLER            PIC 999.                           ELCACCTV
  3882         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  3883         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  3884             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  3885             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  3886         10  AM-EXP-MO         PIC 99.                               CL**5
  3887         10  AM-EXP-DA         PIC 99.                               CL**5
  3888     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  3889            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  3890     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  3891         10  FILLER                    PIC 999.                   ELCACCTV
  3892         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  3893         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  3894             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  3895             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  3896         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  3897         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  3898     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  3899            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  3900     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  3901         10  FILLER                    PIC 999.                   ELCACCTV
  3902         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  3903         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  3904             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  3905             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  3906         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  3907         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  3908     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  3909            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  3910     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  3911         10 FILLER                     PIC 999.                   ELCACCTV
  3912         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  3913         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  3914            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  3915            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  3916         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  3917         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  3918     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  3919            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  3920     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  3921         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  87
* ECS150.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  3922         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  3923         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  3924            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  3925            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  3926         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  3927         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  3928     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  3929            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  3930     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  3931         10  FILLER                    PIC 999.                   ELCACCTV
  3932         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  3933         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  3934             15  AM-AN-CC              PIC 99.                    ELCACCTV
  3935             15  AM-AN-YR              PIC 99.                    ELCACCTV
  3936         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  3937         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  3938     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  3939            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  3940     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  3941         10  FILLER                    PIC 999.                   ELCACCTV
  3942         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  3943         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  3944             15  AM-HI-CC              PIC 99.                    ELCACCTV
  3945             15  AM-HI-YR              PIC 99.                    ELCACCTV
  3946         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  3947         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  3948     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  3949            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  3950     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  3951         10  FILLER                    PIC 999.                   ELCACCTV
  3952         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  3953         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  3954             15  AM-LO-CC              PIC 99.                    ELCACCTV
  3955             15  AM-LO-YR              PIC 99.                    ELCACCTV
  3956         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  3957         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  3958     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  3959            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  3960     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  3961         10  FILLER                    PIC 999.                   ELCACCTV
  3962         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  3963         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  3964             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  3965             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  3966         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  3967         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  3968     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  3969            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  88
* ECS150.cbl
* 3971                             COPY ELCREINV.
  3972******************************************************************04/18/98
  3973*                                                                *ELCREINV
  3974*                                                                *ELCREINV
  3975*                            ELCREINV                            *   LV003
  3976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3977*                            VMOD=2.001                          *ELCREINV
  3978*                                                                *ELCREINV
  3979*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3980*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3981*                                                                *ELCREINV
  3982******************************************************************ELCREINV
  3983                                                                  ELCREINV
  3984 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3985     05  WS-RE-LO-DATE.                                              CL**3
  3986         10 FILLER                     PIC 999.                      CL**3
  3987         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3988         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3989            15 RE-LO-CC                PIC 99.                       CL**3
  3990            15 RE-LO-YR                PIC 99.                       CL**3
  3991         10 RE-LO-MO                   PIC 99.                       CL**3
  3992         10 RE-LO-DA                   PIC 99.                       CL**3
  3993     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3994            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3995     05  WS-RE-HI-DATE.                                              CL**3
  3996         10 FILLER                     PIC 999.                      CL**3
  3997         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3998         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3999            15 RE-HI-CC                PIC 99.                       CL**3
  4000            15 RE-HI-YR                PIC 99.                       CL**3
  4001         10 RE-HI-MO                   PIC 99.                       CL**3
  4002         10 RE-HI-DA                   PIC 99.                       CL**3
  4003     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  4004            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  4005     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  4006         10 FILLER                     PIC 999.                   ELCREINV
  4007         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  4008         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  4009            15 RE-CLM-CC               PIC 99.                    ELCREINV
  4010            15 RE-CLM-YR               PIC 99.                    ELCREINV
  4011         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  4012         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  4013     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  4014            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  4015     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  4016         10  FILLER                    PIC 999.                   ELCREINV
  4017         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  4018         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  4019             15  RE-EARN-CC            PIC 99.                    ELCREINV
  4020             15  RE-EARN-YR            PIC 99.                    ELCREINV
  4021         10  RE-EARN-MO                PIC 99.                    ELCREINV
  4022         10  RE-EARN-DA                PIC 99.                    ELCREINV
  4023     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  4024            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  4025     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  4026         10  FILLER                    PIC 999.                   ELCREINV
  4027         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  4028         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  89
* ECS150.cbl (/apps/prod/cid1p/copy/ELCREINV)
  4029             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  4030             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  4031         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  4032         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  4033     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  4034            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  90
* ECS150.cbl
  4036 PROCEDURE DIVISION.
  4037******************************************************************
  4038*                                                                *
  4039*                *** SECTION DESCRIPTIONS ***                    *
  4040*  * SECTION NO. *                                               *
  4041*                                                                *
  4042*      1000      CLAS DATE LOAD, DATE EDITS, WORK AREA INIT      *
  4043*                                                                *
  4044*      2000      PERFORM LOOP FOR EXTRACT-A                      *
  4045*                                                                *
  4046*      3000      PERFORM LOOP FOR EXTRACT-B                      *
  4047*                                                                *
  4048*      4000      COMPUTATIONS FOR-RESERVES, CLAIMS, ISSUES,      *
  4049*                                 CANCELS, INCREASES/DECREASES   *
  4050*                                                                *
  4051*      5000      PRINT ROUTINES                                  *
  4052*                                                                *
  4053*      6000      REINSURANCE CALCULATIONS                        *
  4054*                                                                *
  4055*      7000      LEVEL BREAK PROCESSING                          *
  4056*                                                                *
  4057*      8000      MISCELANEOUS ROUTINES                           *
  4058*                                                                *
  4059*      9990      PROGRAM EXIT                                    *
  4060******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  91
* ECS150.cbl
  4062 0100-ININITIALIZATION       SECTION 49.
  4063
  4064 0110-CLAS-DATA-LOAD.
* 4065                             COPY ELCDTERX.
  4066******************************************************************04/15/98
  4067*                                                                *ELCDTERX
  4068*                                                                *ELCDTERX
  4069*                            ELCDTERX.                           *   LV002
  4070*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4071*                            VMOD=2.007                          *ELCDTERX
  4072*                                                                *ELCDTERX
  4073*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  4074*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  4075*      = ELCDTEFD)                                               *ELCDTERX
  4076*                                                                *ELCDTERX
  4077******************************************************************ELCDTERX
  4078                                                                  ELCDTERX
  4079     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  4080                                                                  ELCDTERX
  4081     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  4082     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  4083     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  4084                                                                  ELCDTERX
  4085     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  4086                                                                  ELCDTERX
  4087******************************************************************ELCDTERX
  4088*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  4089*          WARNING MESSAGES.                                      ELCDTERX
  4090******************************************************************ELCDTERX
  4091     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  4092         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  4093                                                                  ELCDTERX
  4094     OPEN INPUT DISK-DATE.                                        ELCDTERX
  4095                                                                  ELCDTERX
  4096     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  4097                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  4098                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  4099                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  4100                   CLAX-ID           CLAS-MISC                    ELCDTERX
  4101                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  4102                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  4103                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  4104                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  4105                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  4106                                                                  ELCDTERX
  4107     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  4108                                                                  ELCDTERX
  4109     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  4110                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  4111                                                                  ELCDTERX
  4112     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  4113     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  4114     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  4115     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  4116                                                                  ELCDTERX
  4117     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  4118         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  4119     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  92
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4120         ADD +1                 TO CLAS-CN.                       ELCDTERX
  4121                                                                  ELCDTERX
  4122     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  4123         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  4124     ELSE                                                         ELCDTERX
  4125         ADD +1                 TO CLAS-CO.                       ELCDTERX
  4126                                                                  ELCDTERX
  4127 0005-READ--CARD.                                                 ELCDTERX
  4128     READ DISK-DATE                                               ELCDTERX
  4129         AT END CLOSE DISK-DATE                                   ELCDTERX
  4130             GO TO 0060-READ--TEST.                               ELCDTERX
  4131                                                                  ELCDTERX
  4132     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  4133                                                                  ELCDTERX
  4134     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  4135         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  4136         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  4137         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  4138         GO TO 0005-READ--CARD.                                   ELCDTERX
  4139                                                                  ELCDTERX
  4140     IF DD-ID = 'CLAD'                                            ELCDTERX
  4141         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  4142         GO TO 0005-READ--CARD.                                   ELCDTERX
  4143                                                                  ELCDTERX
  4144     IF DD-ID = 'CLAX'                                            ELCDTERX
  4145         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  4146         GO TO 0005-READ--CARD.                                   ELCDTERX
  4147                                                                  ELCDTERX
  4148     IF DD-ID = 'CLAF'                                            ELCDTERX
  4149         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  4150         GO TO 0005-READ--CARD.                                   ELCDTERX
  4151                                                                  ELCDTERX
  4152     IF DD-ID = 'CLAC'                                            ELCDTERX
  4153         GO TO 0010-READ--CLAC.                                   ELCDTERX
  4154                                                                  ELCDTERX
  4155     IF DD-ID = 'CARR'                                            ELCDTERX
  4156         GO TO 0015-READ--CARR.                                   ELCDTERX
  4157                                                                  ELCDTERX
  4158     IF DD-ID = 'STAT'                                            ELCDTERX
  4159         GO TO 0020-READ--STAT.                                   ELCDTERX
  4160                                                                  ELCDTERX
  4161     IF DD-ID = 'BUSC'                                            ELCDTERX
  4162         GO TO 0025-READ--BUSC.                                   ELCDTERX
  4163                                                                  ELCDTERX
  4164     IF DD-ID = 'MORT'                                            ELCDTERX
  4165         GO TO 0030-READ--MORT.                                   ELCDTERX
  4166                                                                  ELCDTERX
  4167     IF DD-ID = 'CLAI'                                            ELCDTERX
  4168         GO TO 0040-READ--CLAI.                                   ELCDTERX
  4169                                                                  ELCDTERX
  4170     IF DD-ID = 'COLC'                                            ELCDTERX
  4171         GO TO 0065-READ--COLC.                                   ELCDTERX
  4172                                                                  ELCDTERX
  4173     IF DD-IDX NUMERIC AND                                        ELCDTERX
  4174        DD-IDA = 'CL'                                             ELCDTERX
  4175         GO TO 0035-READ--CLXX.                                   ELCDTERX
  4176                                                                  ELCDTERX
  4177     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  93
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4178        DD-IDA = 'PO'                                             ELCDTERX
  4179         GO TO 0050-READ--POXX.                                   ELCDTERX
  4180                                                                  ELCDTERX
  4181     IF DD-ID = 'OPCA'                                            ELCDTERX
  4182         GO TO 0070-READ--OPCA.                                   ELCDTERX
  4183                                                                  ELCDTERX
  4184     IF DD-ID = 'OPST'                                            ELCDTERX
  4185         GO TO 0072-READ--OPST.                                   ELCDTERX
  4186                                                                  ELCDTERX
  4187     IF DD-ID = 'OPBS'                                            ELCDTERX
  4188         GO TO 0074-READ--OPBS.                                   ELCDTERX
  4189                                                                  ELCDTERX
  4190     IF DD-ID = 'OPMS'                                            ELCDTERX
  4191         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  4192                                                                  ELCDTERX
  4193     GO TO 0005-READ--CARD.                                       ELCDTERX
  4194                                                                  ELCDTERX
  4195 0010-READ--CLAC.                                                 ELCDTERX
  4196     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4197     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4198     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4199     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4200     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4201     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4202     GO TO 0005-READ--CARD.                                       ELCDTERX
  4203                                                                  ELCDTERX
  4204 0015-READ--CARR.                                                 ELCDTERX
  4205     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4206     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4207        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  4208        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4209        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  4210        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4211        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4212        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4213        MOVE DD-CARR1-SECPAY-SW
  4214                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4215     END-IF
  4216                                                                  ELCDTERX
  4217     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4218     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4219        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  4220        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4221        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  4222        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4223        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4224        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4225        MOVE DD-CARR2-SECPAY-SW
  4226                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4227     END-IF
  4228                                                                  ELCDTERX
  4229                                                                  ELCDTERX
  4230     GO TO 0005-READ--CARD.                                       ELCDTERX
  4231                                                                  ELCDTERX
  4232 0020-READ--STAT.                                                 ELCDTERX
  4233     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4234     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4235        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  94
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4236         GO TO 0005-READ--CARD.                                   ELCDTERX
  4237                                                                  ELCDTERX
  4238     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  4239     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  4240     GO TO 0020-READ--STAT.                                       ELCDTERX
  4241                                                                  ELCDTERX
  4242 0025-READ--BUSC.                                                 ELCDTERX
  4243     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4244     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4245        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  4246         GO TO 0005-READ--CARD.                                   ELCDTERX
  4247                                                                  ELCDTERX
  4248     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  4249     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  4250     GO TO 0025-READ--BUSC.                                       ELCDTERX
  4251                                                                  ELCDTERX
  4252 0030-READ--MORT.                                                 ELCDTERX
  4253     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4254     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4255        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  4256         GO TO 0005-READ--CARD.                                   ELCDTERX
  4257                                                                  ELCDTERX
  4258     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  4259     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  4260     GO TO 0030-READ--MORT.                                       ELCDTERX
  4261                                                                  ELCDTERX
  4262 0035-READ--CLXX.                                                 ELCDTERX
  4263     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  4264          GO TO 0005-READ--CARD.                                  ELCDTERX
  4265                                                                  ELCDTERX
  4266     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  4267         DISPLAY '***********************************************'ELCDTERX
  4268         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  4269         DISPLAY '***********************************************'ELCDTERX
  4270         GO TO 0055-READ--STOP.                                   ELCDTERX
  4271                                                                  ELCDTERX
  4272     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  4273        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  4274         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  4275                                                                  ELCDTERX
  4276     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  4277        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  4278         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  4279                                                                  ELCDTERX
  4280*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  4281     GO TO 0005-READ--CARD.                                       ELCDTERX
  4282                                                                  ELCDTERX
  4283 0040-READ--CLAI.                                                 ELCDTERX
  4284     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4285     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4286        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  4287         GO TO 0005-READ--CARD.                                   ELCDTERX
  4288                                                                  ELCDTERX
  4289     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  4290     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  4291     GO TO 0040-READ--CLAI.                                       ELCDTERX
  4292                                                                  ELCDTERX
  4293 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  95
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4294     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  4295     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  4296                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  4297     PERFORM ABEND-PGM.                                           ELCDTERX
  4298                                                                  ELCDTERX
  4299 0050-READ--POXX.                                                 ELCDTERX
  4300     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  4301         GO TO 0005-READ--CARD.                                   ELCDTERX
  4302                                                                  ELCDTERX
  4303     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  4304         DISPLAY '***********************************************'ELCDTERX
  4305         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  4306         DISPLAY '***********************************************'ELCDTERX
  4307         GO TO 0055-READ--STOP.                                   ELCDTERX
  4308                                                                  ELCDTERX
  4309     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  4310     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  4311     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  4312     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  4313                                                                  ELCDTERX
  4314     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  4315         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  4316     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  4317         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  4318                                                                  ELCDTERX
  4319     GO TO 0005-READ--CARD.                                       ELCDTERX
  4320                                                                  ELCDTERX
  4321 0055-READ--STOP.                                                 ELCDTERX
  4322     GOBACK.                                                      ELCDTERX
  4323                                                                  ELCDTERX
  4324 0060-READ--TEST.                                                 ELCDTERX
  4325     IF DATX-COD        = SPACE  OR                               ELCDTERX
  4326        CLAX-ID         = SPACE  OR                               ELCDTERX
  4327        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  4328         GO TO 0045-READ--DUMP.                                   ELCDTERX
  4329                                                                  ELCDTERX
  4330     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  4331     GO TO 0079-READ--EXIT.                                       ELCDTERX
  4332                                                                  ELCDTERX
  4333 0065-READ--COLC.                                                 ELCDTERX
  4334     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  4335     GO TO 0005-READ--CARD.                                       ELCDTERX
  4336                                                                  ELCDTERX
  4337 0070-READ--OPCA.                                                 ELCDTERX
  4338                                                                  ELCDTERX
  4339     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4340                                                                  ELCDTERX
  4341     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  4342             OR                                                   ELCDTERX
  4343         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  4344         GO TO 0005-READ--CARD.                                   ELCDTERX
  4345                                                                  ELCDTERX
  4346     ADD 1                       TO INDEXCA.                      ELCDTERX
  4347     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  4348                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  4349     GO TO 0070-READ--OPCA.                                       ELCDTERX
  4350                                                                  ELCDTERX
  4351 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  96
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4352                                                                  ELCDTERX
  4353     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4354                                                                  ELCDTERX
  4355     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  4356             OR                                                   ELCDTERX
  4357         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4358         GO TO 0005-READ--CARD.                                   ELCDTERX
  4359                                                                  ELCDTERX
  4360     ADD 1                       TO INDEXST.                      ELCDTERX
  4361     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  4362                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  4363     GO TO 0072-READ--OPST.                                       ELCDTERX
  4364                                                                  ELCDTERX
  4365 0074-READ--OPBS.                                                 ELCDTERX
  4366                                                                  ELCDTERX
  4367     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4368                                                                  ELCDTERX
  4369     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  4370             OR                                                   ELCDTERX
  4371         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4372         GO TO 0005-READ--CARD.                                   ELCDTERX
  4373                                                                  ELCDTERX
  4374     ADD 1                       TO INDEXBS.                      ELCDTERX
  4375     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  4376     GO TO 0074-READ--OPBS.                                       ELCDTERX
  4377                                                                  ELCDTERX
  4378 0079-READ--EXIT.                                                 ELCDTERX
  4379*    EXIT.                                                        ELCDTERX
  4380******************************************************************ELCDTERX
  4381
  4382 0120-PERIOD-EDIT.
  4383**   MOVE 1 TO DTE-PGM-OPT.
  4384     IF EP-CCYY GREATER THAN RUN-CCYY OR
  4385        EP-MO GREATER THAN RUN-MO
  4386         GO TO 0130-CLEAR-WORK.
  4387
  4388     IF EP-DT = RUN-DATE
  4389         SUBTRACT +1 FROM RUN-CCYY
  4390         MOVE WS-RUN-DATE-N TO RUN-DATE
  4391         GO TO 0130-CLEAR-WORK.
  4392
  4393     DISPLAY 'PERIOD START IS AFTER PERIOD END-CHECK CLAS CARD'.
  4394     MOVE '0998'                 TO ABEND-CODE.
  4395     GO TO ABEND-PGM.
  4396
  4397 0130-CLEAR-WORK.
  4398     MOVE HIGH-VALUES            TO REIN-HOLD-AREAS.
  4399     MOVE SPACES                 TO REIN-LEVELS-END.
  4400     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT
  4401         VARYING CL FROM +1 BY +1
  4402             UNTIL CL GREATER THAN +5.
  4403
  4404 0140-OPEN-FILES.
  4405     OPEN INPUT ERACCTT  CERT-FILE
  4406          OUTPUT PRINT-FILE  CLAS150-A-EXTRACT.
  4407     MOVE LOW-VALUES             TO ACCOUNT-MASTER.
  4408
* 4409     COPY ELCACCTI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  97
* ECS150.cbl (/apps/prod/cid1p/copy/ELCACCTI)
  4410******************************************************************04/14/98
  4411*                                                                *ELCACCTI
  4412*                            ELCACCTI                            *   LV003
  4413*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4414*                            VMOD=2.001                          *ELCACCTI
  4415*                                                                *ELCACCTI
  4416*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  4417*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  4418*                                                                *ELCACCTI
  4419*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  4420*                                                                *ELCACCTI
  4421******************************************************************ELCACCTI
  4422     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  4423     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  4424     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  4425     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  4426     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  4427     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  4428     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  4429     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  4430     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  4431
  4432     IF ACCT-FILE-STATUS NOT = '00' AND '97'
  4433         MOVE ACCT-FILE-STATUS   TO WS-ABEND-FILE-STATUS
  4434         MOVE ' ERROR ACCOUNT MASTER OPEN '
  4435                                 TO WS-ABEND-MESSAGE
  4436         PERFORM ABEND-PGM.
  4437
  4438     MOVE 'R'                        TO  CP-RATE-FILE.
  4439     MOVE 'O'                        TO  CP-IO-FUNCTION.
  4440     PERFORM 8455-CALL-RATING-ROUTINE THRU 8499-EXIT.
  4441     IF IO-ERROR
  4442         MOVE 0302                   TO  WS-RETURN-CODE
  4443         MOVE 'ERROR OCCURED OPENING - ELRATE'
  4444                                     TO  WS-ABEND-MESSAGE
  4445         GO TO ABEND-PGM.
  4446
  4447 0150-SET-DATES.
  4448
  4449     MOVE RUN-DATE                   TO DC-GREG-DATE-CYMD.
  4450     MOVE 'L'                        TO DC-OPTION-CODE.
  4451     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  4452     MOVE DC-BIN-DATE-1              TO RUN-DATE-BIN PERIOD-START.
  4453
  4454     MOVE EP-DT                      TO DC-GREG-DATE-CYMD.
  4455     MOVE 'L'                        TO DC-OPTION-CODE.
  4456     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  4457     MOVE DC-BIN-DATE-1              TO PERIOD-END  EP-DT-BIN.
  4458
  4459     COMPUTE PERIOD-START-9 = (RUN-CCYY * 12) + RUN-MO.
  4460     COMPUTE PERIOD-END-9 = (EP-CCYY * 12) + EP-MO.
  4461
  4462
  4463
  4464     MOVE COMPANY-NAME           TO HL-CO-NAME.
  4465     MOVE WS-CURRENT-DATE        TO HL-DATE.
  4466     MOVE RUN-DATE               TO DATE-WORK.
  4467     MOVE CORRESPONDING RAW-DATE TO FORMAT-DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  98
* ECS150.cbl
  4468     MOVE FORMAT-DATE            TO HL-PER-START.
  4469     MOVE EP-DT                  TO DATE-WORK.
  4470     MOVE CORRESPONDING RAW-DATE TO FORMAT-DATE.
  4471     MOVE FORMAT-DATE            TO HL-PER-END.
  4472
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  99
* ECS150.cbl
  4474 1000-MAINLINE-CONTROL       SECTION 05.
  4475
  4476 1100-CREATE-EXTRACT-A.
  4477
  4478     PERFORM 2000-EXTRACT-A THRU 2000-EXIT
  4479         UNTIL CR-ACCT-CONTROL = HIGH-VALUES.
  4480     CLOSE ERACCTT CERT-FILE  CLAS150-A-EXTRACT.
  4481
  4482     IF REINS-FILE-OPEN
  4483         CLOSE REINS-EXTRACT-1.
  4484
  4485     IF REIN-OPEN-SW NOT = SPACE
  4486         MOVE SPACE              TO REIN-OPEN-SW
  4487         CLOSE ERRTBL-IN
  4488         IF ERRTBL-FILE-STATUS NOT = '00'
  4489             MOVE '22'           TO ABEND-FILE-ID
  4490             MOVE ERRTBL-FILE-STATUS
  4491                                 TO ABEND-REASON
  4492             GO TO ABEND-PGM.
  4493
  4494     IF NO-REINSURANCE
  4495         GO TO 9990-PROGRAM-END.
  4496
  4497 1200-CREATE-EXTRACT-BC.
  4498     SORT SORT-WORK  ASCENDING KEY SORT-KEY
  4499         USING REINS-EXTRACT-1
  4500             GIVING REINS-EXTRACT-2.
  4501 S1200-EXIT.
  4502     EXIT.
  4503
  4504 1200-CONTINUE.
  4505     OPEN INPUT  REINS-EXTRACT-2
  4506          OUTPUT CLAS150-B-EXTRACT  CLAS150-C-EXTRACT.
  4507     MOVE SPACES                 TO SAVE-CONTROL-BREAKS.
  4508     MOVE LOW-VALUES             TO CERTIFICATE-RECORD.
* 4509     COPY ELCCRTM1.
  4510******************************************************************04/15/98
  4511*                                                                *ELCCRTM1
  4512*                                                                *ELCCRTM1
  4513*                            ELCCRTM1                            *   LV003
  4514*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4515*                            VMOD=2.001                          *ELCCRTM1
  4516*                                                                *ELCCRTM1
  4517*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4518*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4519*                                                                *ELCCRTM1
  4520******************************************************************ELCCRTM1
  4521     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4522     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4523     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4524     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4525     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4526     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4527     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4528     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4529     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4530                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4531     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 100
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  4532                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4533     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4534     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4535     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4536     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4537     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4538     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4539           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4540                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4541     END-PERFORM.                                                 ELCCRTM1
  4542                                                                  ELCCRTM1
  4543     MOVE +1                     TO PASS-TYPE.
  4544     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT
  4545         VARYING CL FROM +1 BY +1
  4546             UNTIL CL GREATER +5.
  4547     PERFORM 3000-EXTRACT-BC THRU 3000-EXIT
  4548         UNTIL RC-CONTROL = HIGH-VALUES.
  4549     CLOSE CLAS150-B-EXTRACT  CLAS150-C-EXTRACT  REINS-EXTRACT-2.
  4550     GO TO 9990-PROGRAM-END.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 101
* ECS150.cbl
  4552
  4553 2000-EXTRACT-A          SECTION 10.
  4554 2100-READ-CERT-FILE.
  4555     READ CERT-FILE INTO CERTIFICATE-RECORD AT END
  4556         MOVE HIGH-VALUES        TO CR-ACCT-CONTROL.
  4557
* 4558     COPY ELCCRTM1.
  4559******************************************************************04/15/98
  4560*                                                                *ELCCRTM1
  4561*                                                                *ELCCRTM1
  4562*                            ELCCRTM1                            *   LV003
  4563*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4564*                            VMOD=2.001                          *ELCCRTM1
  4565*                                                                *ELCCRTM1
  4566*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4567*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4568*                                                                *ELCCRTM1
  4569******************************************************************ELCCRTM1
  4570     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4571     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4572     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4573     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4574     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4575     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4576     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4577     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4578     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4579                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4580     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  4581                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4582     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4583     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4584     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4585     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4586     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4587     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4588           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4589                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4590     END-PERFORM.                                                 ELCCRTM1
  4591                                                                  ELCCRTM1
  4592
  4593     IF CR-AH-CANC-DT NOT = ZEROS
  4594        IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  4595            MOVE CR-AH-CANC-DT TO CR-AH-CANCEL-EXIT-DATE
  4596                                  WS-CR-AH-CANCEL-EXIT-DATE.
  4597
  4598     IF CR-LF-CANC-DT NOT = ZEROS
  4599        IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  4600            MOVE CR-LF-CANC-DT TO CR-LF-CANCEL-EXIT-DATE
  4601                                  WS-CR-LF-CANCEL-EXIT-DATE.
  4602
  4603     IF CR-ACCT-CONTROL = HIGH-VALUES
  4604         GO TO 2210-CONTINUE.
  4605
  4606     IF CR-POLICY-IS-DECLINED OR
  4607        CR-POLICY-IS-VOID
  4608            DISPLAY 'CERT BYPASSED - VOID OR DECLINED '
  4609                                                CR-FULL-CONTROL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 102
* ECS150.cbl
  4610            GO TO 2100-READ-CERT-FILE.
  4611
  4612     IF (cr-carrier = '9')
  4613        and (cr-state = 'NE')
  4614        and (cr-account = '0000015860')
  4615        and (cr-cert-no = '1098173790 ')
  4616            DISPLAY 'CERT BYPASSED - the big one '
  4617                                                CR-FULL-CONTROL
  4618            GO TO 2100-READ-CERT-FILE.
  4619
  4620     IF CR-LFTYP NOT = '00'
  4621         IF CR-LF-TERM = 0
  4622             IF CR-AHTYP = '00'
  4623                 DISPLAY 'CERT BYPASSED DUE TO INVALID TERM '
  4624                                                 CR-FULL-CONTROL
  4625                 GO TO 2100-READ-CERT-FILE.
  4626
  4627     IF CR-AHTYP NOT EQUAL '00'
  4628         IF CR-AH-TERM = 0
  4629             IF CR-LFTYP = '00'
  4630                 DISPLAY 'CERT BYPASSED DUE TO INVALID TERM '
  4631                                                 CR-FULL-CONTROL
  4632                 GO TO 2100-READ-CERT-FILE.
  4633
  4634 2210-CONTINUE.
  4635
  4636     IF CR-LFTYP NOT EQUAL '00'
  4637         IF CR-LF-TERM = 0
  4638             DISPLAY 'INVALID TERM ON LIFE CVG ' CR-FULL-CONTROL
  4639             MOVE '00'             TO  CR-LFTYP.
  4640
  4641     IF CR-AHTYP NOT EQUAL '00'
  4642         IF CR-AH-TERM = 0
  4643             DISPLAY 'INVALID TERM ON AH CVG ' CR-FULL-CONTROL
  4644             MOVE '00'             TO  CR-AHTYP.
  4645
  4646     IF SAVE-CONTROL-BREAKS = SPACES
  4647         MOVE CR-CARRIER         TO LAST-CARRIER
  4648         MOVE CR-GROUPING        TO LAST-GROUPING
  4649         MOVE CR-STATE           TO LAST-STATE
  4650         MOVE CR-ACCOUNT         TO LAST-ACCOUNT.
  4651
  4652 2200-MATCH-ACCT-TO-CERT.
  4653
  4654     IF CR-ACCT-CONTROL EQUAL HIGH-VALUES
  4655         GO TO 2300-LEVEL-BREAK-CHECK.
  4656
  4657     IF AM-CONTROL-A LESS THAN CR-ACCT-CONTROL
  4658         PERFORM 2210-ACCT-MAST-READ THRU 2210-EXIT
  4659         GO TO 2200-MATCH-ACCT-TO-CERT.
  4660
  4661     IF AM-CONTROL-A GREATER THAN CR-ACCT-CONTROL
  4662         GO TO 2205-ACCT-CERT-MISMATCH.
  4663
  4664     IF CR-DT  NOT LESS THAN AM-EXPIRE-DT
  4665         PERFORM 2210-ACCT-MAST-READ THRU 2210-EXIT
  4666         GO TO 2200-MATCH-ACCT-TO-CERT.
  4667
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 103
* ECS150.cbl
  4668     IF CR-DT NOT LESS THAN AM-EFFECT-DT
  4669         GO TO 2300-LEVEL-BREAK-CHECK.
  4670
  4671 2205-ACCT-CERT-MISMATCH.
  4672     DISPLAY 'NO MATCHING ACCOUNT MASTER FOR CONTROL '
  4673              CR-ACCT-CONTROL.
  4674
  4675     IF DTE-CLIENT EQUAL 'FIA'
  4676                      OR 'CID' OR 'AHL'
  4677        GO TO 2100-READ-CERT-FILE
  4678     ELSE
  4679        MOVE '0302'              TO ABEND-CODE
  4680        GO TO ABEND-PGM.
  4681
  4682 2210-ACCT-MAST-READ.
  4683     READ ERACCTT AT END
  4684         MOVE HIGH-VALUES        TO ACCOUNT-MASTER.
  4685
* 4686     COPY ELCACCTI.
  4687******************************************************************04/14/98
  4688*                                                                *ELCACCTI
  4689*                            ELCACCTI                            *   LV003
  4690*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4691*                            VMOD=2.001                          *ELCACCTI
  4692*                                                                *ELCACCTI
  4693*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  4694*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  4695*                                                                *ELCACCTI
  4696*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  4697*                                                                *ELCACCTI
  4698******************************************************************ELCACCTI
  4699     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  4700     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  4701     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  4702     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  4703     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  4704     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  4705     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  4706     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  4707     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  4708
  4709 2210-EXIT.
  4710     EXIT.
  4711
  4712 2300-LEVEL-BREAK-CHECK.
  4713
  4714     IF (LAST-CARRIER NOT = CR-CARRIER) OR
  4715        (LAST-GROUPING NOT = CR-GROUPING)
  4716         PERFORM 7400-STATE-BREAK THRU 7400-EXIT
  4717         PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT
  4718         MOVE CR-ACCT-CONTROL   TO SAVE-CNTRL-GRP
  4719         GO TO 2400-VALIDATE-DATA.
  4720
  4721     IF LAST-STATE NOT EQUAL CR-STATE
  4722         PERFORM 7400-STATE-BREAK THRU 7400-EXIT
  4723         MOVE CR-ACCT-CONTROL    TO SAVE-CNTRL-GRP
  4724         GO TO 2400-VALIDATE-DATA.
  4725
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 104
* ECS150.cbl
  4726     IF LAST-ACCOUNT NOT EQUAL CR-ACCOUNT
  4727         PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT
  4728         MOVE CR-ACCT-CONTROL    TO SAVE-CNTRL-GRP.
  4729
  4730 2400-VALIDATE-DATA.
  4731     IF SAVE-CNTRL-GRP = HIGH-VALUES
  4732         GO TO 2000-EXIT.
  4733
  4734*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
  4735*        MOVE AM-EARN-METHOD-A   TO AH-EARN-METHOD
  4736*    ELSE
  4737     MOVE SPACES                 TO AH-EARN-METHOD
  4738
  4739     IF CR-IND-GRP NOT = '1' AND '2'
  4740         MOVE AM-IG              TO CR-IND-GRP.
  4741     IF CR-LFAMT-ALT NOT NUMERIC
  4742         MOVE ZEROS              TO CR-LFAMT-ALT.
  4743     IF CR-LFPRM-ALT NOT NUMERIC
  4744         MOVE ZEROS              TO CR-LFPRM-ALT.
  4745     IF CR-LFPRM-CALC NOT NUMERIC
  4746         MOVE ZEROES             TO CR-LFPRM-CALC.
  4747     IF CR-AHPRM-CALC NOT NUMERIC
  4748         MOVE ZEROES             TO CR-AHPRM-CALC.
  4749     IF CR-LFRFND-CALC NOT NUMERIC
  4750         MOVE ZEROES             TO CR-LFRFND-CALC.
  4751     IF CR-AHRFND-CALC NOT NUMERIC
  4752         MOVE ZEROES             TO CR-AHRFND-CALC.
  4753     IF CR-APR NOT NUMERIC
  4754         MOVE ZEROS              TO CR-APR.
  4755     IF CR-AGE NOT NUMERIC
  4756         MOVE ZEROS              TO CR-AGE.
  4757     IF CR-LIVES NOT NUMERIC
  4758         MOVE ZERO               TO CR-LIVES.
  4759     IF CR-SUM-CAN-CNT-ITD NOT NUMERIC
  4760         MOVE ZERO               TO CR-SUM-CAN-CNT-ITD.
  4761     IF CR-SUM-CAN-CNT-YTD NOT NUMERIC
  4762         MOVE ZERO               TO CR-SUM-CAN-CNT-YTD.
  4763     IF CR-DTHEXP-YTD NOT NUMERIC
  4764         MOVE ZERO               TO CR-DTHEXP-YTD.
  4765     IF CR-DTHAMT-YTD NOT NUMERIC
  4766         MOVE ZERO               TO CR-DTHAMT-YTD.
  4767     IF CR-DISAMT-YTD NOT NUMERIC
  4768         MOVE ZERO               TO CR-DISAMT-YTD.
  4769     IF CR-DISEXP-YTD NOT NUMERIC
  4770         MOVE ZERO               TO CR-DISEXP-YTD.
  4771
  4772     ADD CR-DTHEXP-YTD           TO CR-DTHAMT-YTD.
  4773     ADD CR-DISEXP-YTD           TO CR-DISAMT-YTD.
  4774
  4775     MOVE CR-DIS-CC              TO CR-DIS-INC-CC (1).
  4776     MOVE CR-DIS-YR              TO CR-DIS-INC-YR (1).
  4777     MOVE CR-DIS-MO              TO CR-DIS-INC-MO (1).
  4778     MOVE CR-DIS-DA              TO CR-DIS-INC-DA (1).
  4779     MOVE WS-CR-DIS-INCUR-DT(1)  TO CR-DIS-INCUR-DT (1).
  4780     MOVE CR-DISAMT-YTD          TO CR-INCUR-DISAMT (1).
  4781
  4782     MOVE ZEROS                  TO CR-INCUR-DISEXP (1)
  4783                                    CR-DIS-INCUR-DT (2)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 105
* ECS150.cbl
  4784                                    WS-CR-DIS-INCUR-DT(2)
  4785                                    CR-DIS-INCUR-DT (3)
  4786                                    WS-CR-DIS-INCUR-DT(3)
  4787                                    CR-DIS-INCUR-DT (4)
  4788                                    WS-CR-DIS-INCUR-DT(4)
  4789                                    CR-DIS-INCUR-DT (5)
  4790                                    WS-CR-DIS-INCUR-DT(5).
  4791
  4792 2500-CALC-1ST-INS.
  4793     MOVE 0                      TO RECORD-TYPE-SW.
  4794     PERFORM 4000-ACTIVITY-TOTALING THRU 4000-EXIT.
  4795
  4796 2600-CALC-REINSURANCE.
  4797     IF CR-REIN-TABLE = SPACES OR ZEROES
  4798         GO TO 2000-EXIT.
  4799
  4800     IF REINS-FILE-CLOSED
  4801         OPEN OUTPUT REINS-EXTRACT-1
  4802         MOVE 1                  TO REINS-FILE-SW.
  4803
  4804     PERFORM 6000-REINSURANCE-CALC THRU 6000-EXIT.
  4805     PERFORM 2700-REINS-EXTRACT THRU 2700-EXIT
  4806         VARYING SUB1 FROM +1 BY +1
  4807             UNTIL REIN-COMP (SUB1) = SPACES.
  4808     GO TO 2000-EXIT.
  4809
  4810 2700-REINS-EXTRACT.
  4811     IF REIN-LF-AH-FLGS (SUB1) = SPACES
  4812         GO TO 2700-EXIT.
  4813
  4814     IF REIN-REM-SW (SUB1) = 'Z'
  4815         GO TO 2700-EXIT.
  4816     perform varying sub3 from +1 by +1 until
  4817        (sub3 > +1500) or
  4818        (rein-comp (sub1) = rc2-rein-co (sub3))
  4819     end-perform
  4820     if sub3 > +1500
  4821        go to 2700-exit
  4822     else
  4823        if rc2-ecs152-rpt (sub3) = 'Y'
  4824           continue
  4825        else
  4826           go to 2700-exit
  4827        end-if
  4828     end-if
  4829
  4830
  4831     MOVE REIN-WORK-FLDS (SUB1)  TO RWF-FIELDS.
  4832     MOVE SAVE-REINS-CERT        TO RC-REC.
  4833     MOVE REIN-COMP (SUB1)       TO RC-COMP.
  4834     MOVE RC-AHTYP               TO CR-AHTYP.
  4835     MOVE RC-LFTYP               TO CR-LFTYP.
  4836     MOVE RC-PMT-FREQ            TO CR-PMT-FREQ.
  4837     MOVE RC-I-LIVES             TO CR-LIVES.
  4838     MOVE RC-C-LIVES-ITD         TO CR-SUM-CAN-CNT-ITD.
  4839     MOVE RC-C-LIVES-YTD         TO CR-SUM-CAN-CNT-YTD.
  4840     MOVE RC-AHRFND-YTD          TO CR-AHRFND-CALC.
  4841     MOVE RC-LFRFND-YTD          TO CR-LFRFND-CALC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 106
* ECS150.cbl
  4842     MOVE RC-LF-EXPIRE-DT        TO CR-LF-EXPIRE-DATE
  4843                                    WS-CR-LF-EXPIRE-DATE-N.
  4844     MOVE RC-AH-EXPIRE-DT        TO CR-AH-EXPIRE-DATE
  4845                                    WS-CR-AH-EXPIRE-DATE-N.
  4846     MOVE ZEROES                 TO RC-LFAMT   CR-LFAMT
  4847                                    RC-LFPRM   CR-LFPRM
  4848                                    cr-lfprm-alt
  4849                                    RC-AHAMT   CR-AHAMT
  4850                                    RC-AHPRM   CR-AHPRM
  4851                                    RC-LFRFND  CR-LFRFND
  4852                                    RC-AHRFND  CR-AHRFND
  4853                                    RC-DTHAMT  CR-DTHAMT-YTD
  4854                                    RC-DISAMT  CR-DISAMT-YTD
  4855                                    RC-CEDE-FACT.
  4856
  4857     IF REIN-LF-FLG (SUB1) = 'X'
  4858         MOVE RWF-LFAMT          TO RC-LFAMT   CR-LFAMT
  4859         MOVE RWF-LFPRM          TO RC-LFPRM   CR-LFPRM
  4860         MOVE RWF-LFRFND         TO RC-LFRFND  CR-LFRFND
  4861         MOVE RWF-LFCLM          TO RC-DTHAMT  CR-DTHAMT-YTD
  4862         IF (CR-LFAMT = ZEROS)
  4863            AND (CR-LFPRM = ZEROS)
  4864            MOVE '00'            TO CR-LFTYP
  4865                                    RC-LFTYP
  4866         END-IF
  4867     ELSE
  4868         MOVE ZERO               TO RC-LFTYP  CR-LFTYP.
  4869
  4870     COMPUTE WS-TOTAL-FACE-AMT = RC-ORIG-LFAMT + RC-LFAMT-ALT.
  4871
  4872     IF (REIN-LF-FLG (SUB1) = 'X')  AND
  4873        (CLAS-I-EP (CLAS-INDEXL) = 'B')
  4874         COMPUTE RC-CEDE-FACT = CR-LFAMT / WS-TOTAL-FACE-AMT.
  4875
  4876     IF REIN-AH-FLG (SUB1) = 'X'
  4877         MOVE RWF-AHAMT          TO RC-AHAMT   CR-AHAMT
  4878         MOVE RWF-AHPRM          TO RC-AHPRM   CR-AHPRM
  4879         MOVE RWF-AHRFND         TO RC-AHRFND  CR-AHRFND
  4880         MOVE RWF-AHCLM          TO RC-DISAMT  CR-DISAMT-YTD
  4881         IF (CR-AHAMT = ZEROS)
  4882            AND (CR-AHPRM = ZEROS)
  4883            MOVE '00'            TO CR-AHTYP
  4884                                    RC-AHTYP
  4885         END-IF
  4886     ELSE
  4887         MOVE ZERO               TO RC-AHTYP  CR-AHTYP.
  4888
  4889     ADD +1 TO REINS-REC-CNT.
  4890     MOVE 1                      TO REINSURANCE-FOUND.
  4891     WRITE RC-REC-1 FROM RC-REC.
  4892     .
  4893 2710-EVALUATE-REINS.
  4894     MOVE 1                      TO RECORD-TYPE-SW.
  4895     PERFORM 4000-ACTIVITY-TOTALING THRU 4000-EXIT.
  4896
  4897 2700-EXIT.
  4898     EXIT.
  4899
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 107
* ECS150.cbl
  4900 2000-EXIT.
  4901     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 108
* ECS150.cbl
  4903 3000-EXTRACT-BC     SECTION 15.
  4904
  4905 3100-READ-REINS-EXTRACT.
  4906     READ REINS-EXTRACT-2 INTO RC-REC AT END
  4907         MOVE HIGH-VALUES TO RC-CONTROL
  4908         GO TO 2150-CONTROL-BREAKS.
  4909     MOVE SPACES                 TO CERTIFICATE-RECORD.
  4910     MOVE RC-CMCTL               TO CR-FULL-CONTROL.
  4911     MOVE RC-ENTRY-STATUS        TO CR-ENTRY-STATUS.
  4912     MOVE RC-LFTYP               TO CR-LFTYP.
  4913     MOVE RC-LF-TERM             TO CR-LF-TERM.
  4914     MOVE RC-LF-TERM-IN-DAYS     TO CR-LF-TERM-IN-DAYS.
  4915     MOVE RC-LF-CANCEL-STATUS    TO CR-LF-STATUS-AT-CANCEL.
  4916     MOVE RC-LF-CLAIM-STATUS     TO CR-LF-STATUS-AT-DEATH.
  4917     MOVE RC-LF-CURRENT-STATUS   TO CR-LF-CURRENT-STATUS.
  4918     MOVE RC-AHTYP               TO CR-AHTYP.
  4919     MOVE RC-AH-TERM             TO CR-AH-TERM.
  4920     MOVE RC-AH-CANCEL-STATUS    TO CR-AH-STATUS-AT-CANCEL.
  4921     MOVE RC-AH-CLAIM-STATUS     TO CR-AH-STATUS-AT-SETTLEMENT.
  4922     MOVE RC-AH-CURRENT-STATUS   TO CR-AH-CURRENT-STATUS.
  4923     MOVE RC-AHAMT               TO CR-AHAMT.
  4924     MOVE RC-LFAMT               TO CR-LFAMT.
  4925     MOVE RC-LFAMT-ALT           TO CR-LFAMT-ALT.
  4926     MOVE RC-LFPRM               TO CR-LFPRM.
  4927     MOVE RC-AHPRM               TO CR-AHPRM.
  4928     MOVE RC-LFRFND              TO CR-LFRFND.
  4929     MOVE RC-AHRFND              TO CR-AHRFND.
  4930     MOVE RC-DTHAMT              TO CR-DTHAMT-YTD.
  4931     MOVE RC-DISAMT              TO CR-DISAMT-YTD.
  4932     MOVE RC-IND-GRP             TO CR-IND-GRP.
  4933     MOVE RC-LF-CANCEL-STATUS    TO CR-LF-STATUS-AT-CANCEL.
  4934     MOVE RC-LF-CLAIM-STATUS     TO CR-LF-STATUS-AT-DEATH.
  4935     MOVE RC-AH-CANCEL-STATUS    TO CR-AH-STATUS-AT-CANCEL.
  4936     MOVE RC-AH-CLAIM-STATUS     TO CR-AH-STATUS-AT-SETTLEMENT.
  4937     MOVE RC-LF-CANC-DT          TO CR-LF-CANC-DT.
  4938     MOVE RC-AH-CANC-DT          TO CR-AH-CANC-DT.
  4939     MOVE RC-DIS-DT              TO CR-DIS-DT.
  4940     MOVE RC-ENT-DT              TO CR-ENTRY-DATE.
  4941     MOVE RC-LF-CANC-EXIT        TO CR-LF-CANCEL-EXIT-DATE.
  4942     MOVE RC-AH-CANC-EXIT        TO CR-AH-CANCEL-EXIT-DATE.
  4943     MOVE RC-LF-CLAIM-EXIT       TO CR-LF-CLAIM-EXIT-DATE.
  4944     MOVE RC-AH-CLAIM-EXIT       TO CR-AH-SETTLEMENT-EXIT-DATE.
  4945     MOVE RC-PMT-FREQ            TO CR-PMT-FREQ.
  4946     MOVE RC-APR                 TO CR-APR.
  4947     MOVE RC-LOAN-TERM           TO CR-LOAN-TERM.
  4948     MOVE RC-I-LIVES             TO CR-LIVES.
  4949     MOVE RC-C-LIVES-ITD         TO CR-SUM-CAN-CNT-ITD.
  4950     MOVE RC-C-LIVES-YTD         TO CR-SUM-CAN-CNT-YTD.
  4951     MOVE RC-AHRFND-YTD          TO CR-AHRFND-CALC.
  4952     MOVE RC-LFRFND-YTD          TO CR-LFRFND-CALC.
  4953     MOVE RC-LF-EXPIRE-DT        TO CR-LF-EXPIRE-DATE.
  4954     MOVE RC-AH-EXPIRE-DT        TO CR-AH-EXPIRE-DATE.
  4955     MOVE RC-LOAN-1ST-PMT-DT     TO CR-LOAN-1ST-PMT-DT.
  4956
* 4957     COPY ELCCRTM1.
  4958******************************************************************04/15/98
  4959*                                                                *ELCCRTM1
  4960*                                                                *ELCCRTM1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 109
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  4961*                            ELCCRTM1                            *   LV003
  4962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4963*                            VMOD=2.001                          *ELCCRTM1
  4964*                                                                *ELCCRTM1
  4965*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4966*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4967*                                                                *ELCCRTM1
  4968******************************************************************ELCCRTM1
  4969     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4970     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4971     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4972     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4973     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4974     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4975     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4976     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4977     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4978                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4979     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  4980                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4981     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4982     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4983     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4984     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4985     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4986     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4987           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4988                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4989     END-PERFORM.                                                 ELCCRTM1
  4990                                                                  ELCCRTM1
  4991
  4992 2150-CONTROL-BREAKS.
  4993     IF SAVE-CONTROL-BREAKS = SPACES
  4994         MOVE CR-ACCT-CONTROL    TO SAVE-CNTRL-GRP
  4995         MOVE RC-COMP            TO LAST-REINS-CO.
  4996
  4997     IF LAST-REINS-CO NOT = RC-COMP
  4998         PERFORM 7100-REINS-CO-BREAK THRU 7100-EXIT
  4999         GO TO 3200-CALC-FOR-REINSURANCE.
  5000
  5001     IF LAST-CARRIER NOT = CR-CARRIER
  5002         PERFORM 7200-CARRIER-BREAK THRU 7200-EXIT
  5003         GO TO 3200-CALC-FOR-REINSURANCE.
  5004
  5005     IF LAST-GROUPING NOT = CR-GROUPING
  5006         PERFORM 7300-COMPANY-BREAK THRU 7300-EXIT
  5007         GO TO 3200-CALC-FOR-REINSURANCE.
  5008
  5009     IF LAST-STATE NOT = CR-STATE
  5010         PERFORM 7400-STATE-BREAK THRU 7400-EXIT
  5011         GO TO 3200-CALC-FOR-REINSURANCE.
  5012
  5013     IF LAST-ACCOUNT NOT = CR-ACCOUNT
  5014         PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT.
  5015
  5016 3200-CALC-FOR-REINSURANCE.
  5017     IF RC-CONTROL = HIGH-VALUES
  5018         GO TO 3000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 110
* ECS150.cbl
  5019
  5020     MOVE CR-ACCT-CONTROL        TO SAVE-CNTRL-GRP.
  5021     MOVE RC-COMP                TO LAST-REINS-CO.
  5022     PERFORM 4000-ACTIVITY-TOTALING THRU 4000-EXIT.
  5023
  5024 3000-EXIT.
  5025     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 111
* ECS150.cbl
  5027 4000-ACTIVITY-TOTALING  SECTION 25.
  5028
  5029 4100-ELIM-FUTURES.
  5030     MOVE  CR-ENTRY-DATE     TO  DC-GREG-DATE-CYMD.
  5031     MOVE 'L'                TO  DC-OPTION-CODE.
  5032     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5033     IF NO-CONVERSION-ERROR
  5034         MOVE DC-BIN-DATE-1  TO  CERT-ENTRY-DATE
  5035     ELSE
  5036         MOVE CR-DT          TO  DC-GREG-DATE-CYMD
  5037         MOVE 'L'            TO  DC-OPTION-CODE
  5038         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5039                                      8599-DATE-CONVERT-X
  5040         IF NO-CONVERSION-ERROR
  5041             MOVE DC-BIN-DATE-1  TO  CERT-ENTRY-DATE.
  5042
  5043     IF CERT-ENTRY-DATE GREATER THAN PERIOD-END
  5044         GO TO 4000-EXIT.
  5045
  5046     IF CR-ENTRY-STATUS = '9'
  5047         IF REINSURANCE-PASS OR REINSURANCE-REC
  5048             NEXT SENTENCE
  5049         ELSE
  5050             GO TO 4000-EXIT.
  5051
  5052 4110-FIND-CLAS-L-TYPE.
  5053     IF CR-LFTYP = ZERO
  5054         GO TO 4120-FIND-CLAS-A-TYPE.
  5055
  5056     MOVE CR-LFTYP               TO CLAS-LOOK.
  5057     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  5058
  5059 4115-LIFE-LOOKUP.
  5060     IF CLAS-INDEXL IS GREATER THAN CLAS-MAXL
  5061         DISPLAY 'INVALID LIFE TYPE' CLAS-LOOK
  5062         MOVE '0401'             TO ABEND-CODE
  5063         GO TO ABEND-PGM.
  5064
  5065     IF CLAS-I-BEN (CLAS-INDEXL) NOT = CLAS-LOOK
  5066         ADD +1 TO CLAS-INDEXL
  5067         GO TO 4115-LIFE-LOOKUP.
  5068
  5069 4120-FIND-CLAS-A-TYPE.
  5070     IF CR-AHTYP = ZERO
  5071         GO TO 4130-FIND-CLAS-STATE-ABBR.
  5072     MOVE CR-AHTYP               TO CLAS-LOOK.
  5073     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  5074
  5075 4125-AH-LOOKUP.
  5076     IF CLAS-INDEXA IS GREATER THAN CLAS-MAXA
  5077         DISPLAY 'INVALID AH TYPE' CLAS-LOOK
  5078         MOVE '0402'             TO ABEND-CODE
  5079         GO TO ABEND-PGM.
  5080
  5081     IF CLAS-I-BEN (CLAS-INDEXA) NOT = CLAS-LOOK
  5082         ADD +1 TO CLAS-INDEXA
  5083         GO TO 4125-AH-LOOKUP.
  5084
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 112
* ECS150.cbl
  5085     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
  5086
  5087*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
  5088*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
  5089
  5090 4130-FIND-CLAS-STATE-ABBR.
  5091     MOVE CLAS-STARTS TO CLAS-INDEXS.
  5092
  5093 4135-STATE-LOOK-UP.
  5094     IF CLAS-INDEXS IS GREATER THAN CLAS-MAXS
  5095         DISPLAY ' INVALID STATE CODE -' CR-STATE
  5096         MOVE '0301'             TO ABEND-CODE
  5097         GO TO ABEND-PGM.
  5098
  5099     IF STATE-SUB (CLAS-INDEXS) NOT = CR-STATE
  5100         ADD +1 TO CLAS-INDEXS
  5101         GO TO 4135-STATE-LOOK-UP.
  5102
  5103     IF (CR-LFTYP NOT = ZERO AND
  5104         CLAS-I-BAL (CLAS-INDEXL) = 'B')
  5105         OR
  5106        (CR-AHTYP NOT = ZERO AND
  5107         CLAS-I-BAL (CLAS-INDEXA) = 'B')
  5108          MOVE 1                 TO OB-SW
  5109     ELSE
  5110          MOVE 0                 TO OB-SW.
  5111
  5112     IF (CR-LFTYP NOT = ZERO AND
  5113         CLAS-I-BAL (CLAS-INDEXL) = 'Z')
  5114         OR
  5115        (CR-AHTYP NOT = ZERO AND
  5116         CLAS-I-BAL (CLAS-INDEXA) = 'Z')
  5117          MOVE 1                 TO SUMMARY-SW
  5118     ELSE
  5119          MOVE 0                 TO SUMMARY-SW.
  5120
  5121     IF CERT-ENTRY-DATE GREATER THAN PERIOD-START
  5122         MOVE 2                  TO EFFECTIVE-CONTROL
  5123     ELSE
  5124         MOVE 3                  TO EFFECTIVE-CONTROL.
  5125
  5126     MOVE ZEROS                  TO PRINT-SWITCHES.
  5127     MOVE ZEROS                  TO PRT-ISSUE-AMT-LF
  5128                                    PRT-CANC-AMT-LF
  5129                                    PRT-DEATH-AMT-LF
  5130                                    PRT-EXPIRY-AMT-LF
  5131                                    PRT-DECR-AMT-LF
  5132                                    PRT-INCR-AMT-LF
  5133                                    PRT-ISSUE-AMT-LF
  5134                                    PRT-CANC-AMT-LF
  5135                                    PRT-CLAIM-AMT-AH.
  5136     MOVE 1                      TO COUNT-WORK.
  5137
  5138     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  5139     MOVE 'L'                        TO DC-OPTION-CODE.
  5140     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5141     MOVE DC-BIN-DATE-1              TO CERT-EFFECT-DT.
  5142
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 113
* ECS150.cbl
  5143     IF REINSURANCE-PASS OR REINSURANCE-REC
  5144         MOVE CR-LOAN-1ST-PMT-DT TO DC-GREG-DATE-1-YMD
  5145         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5146                                        DC-ELAPSED-DAYS
  5147         MOVE '3' TO DC-OPTION-CODE
  5148         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5149                 8599-DATE-CONVERT-X
  5150         MOVE DC-BIN-DATE-1 TO FIRST-PAY-DT
  5151         GO TO 4137-SKIP-CALC.
  5152
  5153     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  5154         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  5155
  5156     MOVE LOW-VALUES             TO     FIRST-PAY-DT.
  5157
  5158     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5159         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  5160         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5161                                        DC-ELAPSED-DAYS
  5162         MOVE '3'                    TO DC-OPTION-CODE
  5163         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5164                 8599-DATE-CONVERT-X
  5165         IF NO-CONVERSION-ERROR
  5166             MOVE DC-BIN-DATE-1      TO FIRST-PAY-DT
  5167         ELSE
  5168             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  5169
  5170     IF FIRST-PAY-DT       LESS THAN  CERT-EFFECT-DT
  5171         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  5172
  5173     IF CR-LOAN-1ST-PMT-DT = ZEROS
  5174         MOVE CERT-EFFECT-DT         TO DC-BIN-DATE-1
  5175         MOVE +1                     TO DC-ELAPSED-MONTHS
  5176         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  5177         MOVE '6'                    TO DC-OPTION-CODE
  5178         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5179                 8599-DATE-CONVERT-X
  5180         MOVE DC-BIN-DATE-2          TO FIRST-PAY-DT
  5181         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  5182
  5183 4137-SKIP-CALC.
  5184
  5185     IF SUMMARY-REC
  5186         COMPUTE COUNT-WORK = CR-LIVES - CR-SUM-CAN-CNT-ITD.
  5187     IF OB-COVERAGE
  5188         MOVE ZERO               TO COUNT-WORK.
  5189
  5190     IF CR-ENTRY-STATUS = '3' OR '5'
  5191         MOVE ZERO               TO COUNT-WORK.
  5192
  5193     MOVE ZEROES                 TO DOLLAR-AMT
  5194                                    DECREASING-DOLLAR
  5195                                    TEXAS-REG-SW
  5196                                    NET-PAY-SW
  5197                                    NEW-IN-EFFECT
  5198                                    OLD-IN-EFFECT
  5199                                    SAVE-BGN-INFORCE
  5200                                    SAVE-END-INFORCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 114
* ECS150.cbl
  5201                                    INFORCE-CNT-SW
  5202                                    CANCEL-SW
  5203                                    CLAIM-SW
  5204                                    PRINT-CNTRL.
  5205
  5206     IF DTE-CLIENT EQUAL 'HAN'
  5207        MOVE '2' TO CR-IND-GRP.
  5208
  5209     IF CR-IND-GRP = '2'
  5210         MOVE 2                  TO INS-TYPE-SW
  5211     ELSE
  5212         MOVE 1                  TO INS-TYPE-SW.
  5213
  5214     IF REINSURANCE-PASS
  5215         MOVE +5                 TO CL
  5216     ELSE
  5217         IF FIRST-INS-REC
  5218             MOVE +2             TO CL
  5219         ELSE
  5220             MOVE +4             TO CL.
  5221
  5222     IF CR-LFTYP = ZERO
  5223         GO TO 4900-PROCESS-DISABILITY.
  5224
  5225     IF CR-LF-CURRENT-STATUS = '4'
  5226         IF CR-LF-CANCEL-EXIT-DATE IS GREATER THAN ZEROS
  5227             MOVE '8'            TO  CR-LF-CURRENT-STATUS.
  5228
  5229     IF CR-LF-CURRENT-STATUS = '6' OR '7' OR '8'
  5230         NEXT SENTENCE
  5231     ELSE
  5232         IF (CR-DTHAMT-YTD IS GREATER THAN +0) OR
  5233            (CR-DTHAMT-YTD IS LESS THAN +0)
  5234             MOVE '7'            TO  CR-LF-CURRENT-STATUS.
  5235
  5236     IF CR-LF-CURRENT-STATUS NOT = 6 AND 7 AND 8
  5237         MOVE 0                  TO CERT-STATUS.
  5238     IF CR-LF-CURRENT-STATUS = 7
  5239         MOVE 2                  TO CERT-STATUS.
  5240     IF CR-LF-CURRENT-STATUS = 8
  5241         MOVE 1                  TO CERT-STATUS.
  5242     IF CR-LF-CURRENT-STATUS = 6
  5243         MOVE 3                  TO CERT-STATUS.
  5244
  5245     MOVE CERT-EFFECT-DT             TO CP-CERT-EFF-DT.
  5246     MOVE FIRST-PAY-DT               TO CP-FIRST-PAY-DATE.
  5247     MOVE SPACES                     TO CP-ACCT-FLD-5.
  5248     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  5249     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
  5250     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  5251     MOVE '3'                        TO CP-PROCESS-TYPE.
  5252     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  5253     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  5254
  5255     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  5256     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  5257     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
  5258                                        CP-LOAN-TERM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 115
* ECS150.cbl
  5259
  5260     IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5261        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5262         ADD +1                      TO CP-ORIGINAL-TERM
  5263                                        CP-LOAN-TERM.
  5264
  5265     IF CP-TERM-IS-DAYS
  5266         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
  5267     ELSE
  5268         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
  5269
  5270     MOVE RUN-DATE-BIN       TO CP-VALUATION-DT.
  5271
  5272     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  5273
  5274     IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5275        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5276         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
  5277         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
  5278
  5279     MOVE CP-REMAINING-TERM-2  TO  SAVE-REM-TERM.
  5280
  5281     MOVE EP-DT-BIN          TO CP-VALUATION-DT.
  5282
  5283     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  5284
  5285     MOVE ZEROS TO LF-BAL-REMTRM.
  5286     IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5287        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5288         MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTRM
  5289         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
  5290         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
  5291
  5292     IF CP-REMAINING-TERM-2 GREATER THAN CR-LF-TERM
  5293         MOVE CR-LF-TERM TO CP-REMAINING-TERM-2
  5294                            CP-REMAINING-TERM-1.
  5295
  5296     MOVE CP-REMAINING-TERM-2 TO LF-REM-TRM.
  5297
  5298     MOVE CR-LF-EXPIRE-DATE TO DC-GREG-DATE-CYMD
  5299     MOVE 'L' TO DC-OPTION-CODE
  5300     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5301             8599-DATE-CONVERT-X
  5302     MOVE DC-BIN-DATE-1 TO CERT-EXPIRE-DATE-O
  5303
  5304     IF REINSURANCE-PASS OR REINSURANCE-REC
  5305         MOVE CR-LF-EXPIRE-DATE TO DC-GREG-DATE-CYMD
  5306         MOVE 'L' TO DC-OPTION-CODE
  5307         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5308                 8599-DATE-CONVERT-X
  5309         MOVE DC-BIN-DATE-1 TO CERT-EXPIRE-DATE
  5310         GO TO 4150-SKIP-CALC.
  5311
  5312     MOVE FIRST-PAY-DT            TO DC-BIN-DATE-1.
  5313
  5314     IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5315        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  5316         MOVE CR-LF-TERM          TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 116
* ECS150.cbl
  5317     ELSE
  5318         COMPUTE DC-ELAPSED-MONTHS = CR-LF-TERM - +1.
  5319
  5320     MOVE '6'                     TO DC-OPTION-CODE.
  5321     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5322             8599-DATE-CONVERT-X.
  5323     IF NO-CONVERSION-ERROR
  5324         MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  5325     ELSE
  5326         MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  5327
  5328     IF (CERT-EXPIRE-DATE = LOW-VALUES)
  5329        OR (DTE-REM-TRM-CALC-OPTION = '1' OR '2')
  5330        MOVE CERT-EFFECT-DT          TO DC-BIN-DATE-1
  5331        MOVE CR-LF-TERM              TO DC-ELAPSED-MONTHS
  5332        MOVE ZEROS                   TO DC-ELAPSED-DAYS
  5333        MOVE '6'                     TO DC-OPTION-CODE
  5334        PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5335                8599-DATE-CONVERT-X
  5336        IF NO-CONVERSION-ERROR
  5337           MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  5338        ELSE
  5339           MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  5340
  5341*    IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5342*       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5343*       MOVE CERT-EFFECT-DT          TO DC-BIN-DATE-1
  5344*       COMPUTE DC-ELAPSED-MONTHS = CR-LF-TERM + 1
  5345*       MOVE ZEROS                   TO DC-ELAPSED-DAYS
  5346*       MOVE '6'                     TO DC-OPTION-CODE
  5347*       PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5348*               8599-DATE-CONVERT-X
  5349*       IF NO-CONVERSION-ERROR
  5350*          MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  5351*       ELSE
  5352*          MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  5353
  5354     IF CP-REMAINING-TERM-2  GREATER THAN ZEROS
  5355         IF CERT-EXPIRE-DATE LESS THAN PERIOD-END
  5356            MOVE CERT-EXPIRE-DATE-O
  5357                              TO CERT-EXPIRE-DATE.
  5358*            MOVE PERIOD-END  TO  CERT-EXPIRE-DATE.
  5359
  5360     MOVE CERT-EXPIRE-DATE-O     TO CERT-EXPIRE-DATE
  5361     MOVE CERT-EXPIRE-DATE TO DC-BIN-DATE-1.
  5362     MOVE ' '                TO  DC-OPTION-CODE.
  5363     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5364     MOVE DC-GREG-DATE-CYMD  TO WS-CR-LF-EXPIRE-DATE-N
  5365                                CR-LF-EXPIRE-DATE.
  5366
  5367 4150-SKIP-CALC.
  5368
  5369     MOVE LOW-VALUES             TO LOW-EXIT-DATE.
  5370     MOVE CR-LF-DEX-CC           TO DC-ALPHA-CEN-N.
  5371     MOVE CR-LF-DEX-YR           TO DC-YMD-YEAR.
  5372     MOVE CR-LF-DEX-MO           TO DC-YMD-MONTH.
  5373     MOVE CR-LF-DEX-DA           TO DC-YMD-DAY.
  5374     MOVE '3'                TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 117
* ECS150.cbl
  5375     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5376     MOVE DC-BIN-DATE-1  TO  CLAIM-EXIT-DATE.
  5377
  5378     MOVE CR-LF-CANCEL-EXIT-DATE  TO DC-GREG-DATE-CYMD.
  5379     MOVE 'L'                TO  DC-OPTION-CODE.
  5380     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5381     MOVE DC-BIN-DATE-1  TO  CANCEL-EXIT-DATE.
  5382
  5383     MOVE CR-LF-CANC-DT      TO DC-GREG-DATE-CYMD.
  5384     MOVE 'L'                TO  DC-OPTION-CODE.
  5385     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5386     MOVE DC-BIN-DATE-1  TO  SUM-CANCEL-DATE.
  5387
  5388     IF CLAIM-EXIT-DATE = SPACES OR ZEROS
  5389         MOVE LOW-VALUES TO CLAIM-EXIT-DATE.
  5390
  5391     IF CANCEL-EXIT-DATE = SPACES OR ZEROS
  5392         MOVE LOW-VALUES TO CANCEL-EXIT-DATE.
  5393
  5394     IF CLAIM-EXIT-DATE = LOW-VALUES AND
  5395        CANCEL-EXIT-DATE = LOW-VALUES
  5396         GO TO 4300-SET-SUBSCRIPTS.
  5397
  5398     IF CLAIM-EXIT-DATE = LOW-VALUES
  5399         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE
  5400         GO TO 4300-SET-SUBSCRIPTS.
  5401
  5402     IF CANCEL-EXIT-DATE = LOW-VALUES
  5403         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  5404         GO TO 4300-SET-SUBSCRIPTS.
  5405
  5406     IF CLAIM-EXIT-DATE LESS THAN CANCEL-EXIT-DATE
  5407         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  5408     ELSE
  5409         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE.
  5410
  5411 4300-SET-SUBSCRIPTS.
  5412     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  5413         MOVE 1                  TO LIFE-INS-SW
  5414     ELSE
  5415         MOVE 2                  TO LIFE-INS-SW.
  5416
  5417     IF CR-LF-TERM LESS THAN +121
  5418         MOVE +2                 TO TG
  5419     ELSE
  5420         MOVE +3                 TO TG.
  5421
  5422     IF CR-LF-TERM LESS THAN +61
  5423         MOVE +1                 TO TG.
  5424     MOVE TG                     TO SAV-LF-TERM-CODE.
  5425
  5426 4410-INFORCE-PRIOR-PERIOD.
  5427     IF NOT EFFECTIVE-BOTH-PER
  5428         GO TO 4420-INFORCE-THIS-PERIOD.
  5429
  5430     IF CLAIM-EXIT-DATE NOT = LOW-VALUES  AND
  5431        CANCEL-EXIT-DATE NOT = LOW-VALUES
  5432         IF CLAIM-EXIT-DATE NOT GREATER THAN PERIOD-START AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 118
* ECS150.cbl
  5433            CANCEL-EXIT-DATE GREATER THAN PERIOD-START
  5434             MOVE 1              TO CANCEL-SW
  5435             MOVE 0              TO COUNT-WORK
  5436             GO TO 4700-COMPUTE-CANCEL
  5437         ELSE
  5438             IF CANCEL-EXIT-DATE NOT GREATER THAN PERIOD-START
  5439             AND
  5440             CLAIM-EXIT-DATE GREATER THAN PERIOD-START
  5441              MOVE 1             TO CLAIM-SW
  5442              MOVE 0             TO COUNT-WORK
  5443              GO TO 4750-COMPUTE-CLAIM.
  5444
  5445     IF CERT-CLAIM  AND
  5446        LOW-EXIT-DATE = LOW-VALUES
  5447         GO TO 4415-CONTINUE.
  5448
  5449     IF CLAIM-OR-CANCEL AND
  5450        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  5451            CR-DTHAMT-YTD NOT = ZERO
  5452                GO TO 4750-COMPUTE-CLAIM.
  5453
  5454     IF CLAIM-OR-CANCEL AND
  5455        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START
  5456         GO TO 4900-PROCESS-DISABILITY.
  5457
  5458 4415-CONTINUE.
  5459
  5460     IF (CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START) AND
  5461        NOT CLAIM-OR-CANCEL
  5462            GO TO 4900-PROCESS-DISABILITY.
  5463
  5464     MOVE 1                      TO OLD-IN-EFFECT.
  5465
  5466     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START
  5467         MOVE 0                  TO COUNT-WORK
  5468         GO TO 4420-INFORCE-THIS-PERIOD.
  5469
  5470     IF (CR-LFTYP = ZERO) OR
  5471        (CR-ENTRY-STATUS = '5') OR
  5472        (OB-COVERAGE)
  5473           MOVE ZERO             TO INFORCE-DOLLARS
  5474           GO TO 4420-INFORCE-THIS-PERIOD.
  5475
  5476     IF NOT SUMMARY-REC
  5477        NEXT SENTENCE
  5478      ELSE
  5479         IF (SUM-CANCEL-DATE GREATER PERIOD-START) OR
  5480            (CR-LFRFND = ZERO)
  5481             MOVE CR-LIVES       TO COUNT-WORK
  5482             MOVE CR-LFAMT       TO INFORCE-DOLLARS
  5483           ELSE
  5484             IF CR-LFPRM NOT GREATER CR-LFRFND
  5485                MOVE ZERO        TO INFORCE-DOLLARS
  5486                                    CR-LFPRM
  5487                                    CR-LFRFND
  5488              ELSE
  5489                COMPUTE TEMP-RESULT-L ROUNDED =
  5490                                     CR-LFRFND / CR-LFPRM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 119
* ECS150.cbl
  5491                COMPUTE INFORCE-DOLLARS ROUNDED = CR-LFAMT -
  5492                                    (CR-LFAMT * TEMP-RESULT-L).
  5493
  5494     PERFORM 8300-STARTING-INFORCE THRU 8300-EXIT.
  5495
  5496
  5497     IF DTE-CLIENT = 'HER'
  5498         MOVE CR-LFAMT TO INFORCE-DOLLARS
  5499         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  5500             ADD CR-LFAMT-ALT TO INFORCE-DOLLARS.
  5501
  5502     MOVE +1                     TO EG.
  5503     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT.
  5504
  5505     MOVE INFORCE-DOLLARS        TO SAVE-BGN-INFORCE.
  5506
  5507 4420-INFORCE-THIS-PERIOD.
  5508
  5509     IF CERT-CLAIM  AND
  5510        LOW-EXIT-DATE = LOW-VALUES
  5511         NEXT SENTENCE
  5512     ELSE
  5513        IF CLAIM-OR-CANCEL AND
  5514           LOW-EXIT-DATE <= PERIOD-END
  5515            GO TO 4500-COMPUTE-UNEARNED.
  5516
  5517     IF (CERT-EXPIRE-DATE < PERIOD-END)
  5518        OR (LF-REM-TRM = ZEROS)
  5519         GO TO 4500-COMPUTE-UNEARNED.
  5520
  5521     MOVE 1                      TO NEW-IN-EFFECT.
  5522
  5523     IF NOT REINSURANCE-PASS
  5524         ADD +1 TO EXB-CNT.
  5525
  5526     IF (CR-LFTYP = ZERO) OR
  5527        (CR-ENTRY-STATUS = '5') OR
  5528        (OB-COVERAGE)
  5529           MOVE ZERO             TO INFORCE-DOLLARS
  5530           GO TO 4500-COMPUTE-UNEARNED.
  5531
  5532     IF SUMMARY-REC
  5533         COMPUTE COUNT-WORK = CR-LIVES - CR-SUM-CAN-CNT-ITD
  5534         IF CR-LFPRM NOT GREATER CR-LFRFND
  5535            MOVE ZERO            TO INFORCE-DOLLARS
  5536                                    CR-LFPRM
  5537                                    CR-LFRFND
  5538          ELSE
  5539           IF CR-LFRFND = ZERO
  5540             MOVE CR-LFAMT       TO INFORCE-DOLLARS
  5541           ELSE
  5542                COMPUTE TEMP-RESULT-L ROUNDED =
  5543                                     CR-LFRFND / CR-LFPRM
  5544                COMPUTE INFORCE-DOLLARS ROUNDED = CR-LFAMT -
  5545                                    (CR-LFAMT * TEMP-RESULT-L).
  5546
  5547     PERFORM 8350-ENDING-INFORCE THRU 8300-EXIT.
  5548
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 120
* ECS150.cbl
  5549     IF DTE-CLIENT = 'HER'
  5550         MOVE CR-LFAMT TO INFORCE-DOLLARS
  5551         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  5552             ADD CR-LFAMT-ALT TO INFORCE-DOLLARS.
  5553
  5554     IF GROUP-INS
  5555         ADD COUNT-WORK TO GROUP-CNT (CL  TG  9)
  5556         ADD INFORCE-DOLLARS TO GROUP-AMT (CL  TG  9)
  5557     ELSE
  5558         ADD COUNT-WORK TO IND-CNT (CL  TG  9)
  5559         ADD INFORCE-DOLLARS TO IND-AMT (CL  TG  9).
  5560
  5561     MOVE 1                      TO INFORCE-CNT-SW.
  5562     MOVE INFORCE-DOLLARS        TO DECREASING-DOLLAR
  5563                                    SAVE-END-INFORCE.
  5564
  5565 4500-COMPUTE-UNEARNED.
  5566     IF CR-ENTRY-STATUS = ('3' OR '5')
  5567         GO TO 4600-COMPUTE-ISSUES.
  5568
  5569     IF OB-COVERAGE
  5570         GO TO 4600-COMPUTE-ISSUES.
  5571
  5572     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  5573     MOVE 'L'                        TO DC-OPTION-CODE.
  5574     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5575     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  5576
  5577     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  5578         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  5579
  5580     MOVE LOW-VALUES  TO  CP-FIRST-PAY-DATE.
  5581
  5582     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5583         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  5584         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5585                                        DC-ELAPSED-DAYS
  5586         MOVE '3'                    TO DC-OPTION-CODE
  5587         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5588                 8599-DATE-CONVERT-X
  5589         IF NO-CONVERSION-ERROR
  5590             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
  5591         ELSE
  5592             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  5593
  5594     IF CP-FIRST-PAY-DATE LESS THAN  CP-CERT-EFF-DT
  5595         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  5596
  5597     IF CR-LOAN-1ST-PMT-DT = ZEROS
  5598         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5599         MOVE +1                     TO DC-ELAPSED-MONTHS
  5600         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  5601         MOVE '6'                    TO DC-OPTION-CODE
  5602         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5603                 8599-DATE-CONVERT-X
  5604         MOVE DC-BIN-DATE-2          TO CP-FIRST-PAY-DATE
  5605         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  5606
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 121
* ECS150.cbl
  5607     IF ENTERED-PREV-PERIOD
  5608         MOVE RUN-DATE-BIN       TO CP-VALUATION-DT
  5609         MOVE +1                 TO FACTOR-C
  5610         PERFORM 4550-UNEARNED-CALC THRU 4550-EXIT
  5611         MOVE UNEXPIRED-MONTHS   TO HOLD-PREV-UNEXP
  5612         MOVE EXPIRED-MONTHS     TO HOLD-PREV-EXP.
  5613
  5614     IF ENTERED-PREV-PERIOD
  5615         IF CERT-CANCELLED
  5616             IF CANCEL-EXIT-DATE <= PERIOD-END
  5617                 GO TO 4700-COMPUTE-CANCEL.
  5618
  5619     IF ENTERED-THIS-PERIOD
  5620         IF CERT-CANCELLED
  5621             IF CANCEL-EXIT-DATE <= PERIOD-END
  5622                 GO TO 4600-COMPUTE-ISSUES.
  5623
  5624     IF ENTERED-THIS-PERIOD
  5625         MOVE EP-DT-BIN          TO CP-VALUATION-DT
  5626         MOVE -1                 TO FACTOR-C
  5627         PERFORM 4550-UNEARNED-CALC THRU 4550-EXIT
  5628         MOVE UNEXPIRED-MONTHS   TO HOLD-END-UNEXP
  5629         MOVE EXPIRED-MONTHS     TO HOLD-END-EXP.
  5630
  5631     GO TO 4600-COMPUTE-ISSUES.
  5632
  5633 4550-UNEARNED-CALC.
  5634
  5635     MOVE SPACES                     TO CP-ACCT-FLD-5.
  5636     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  5637     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
  5638     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  5639     MOVE '3'                        TO CP-PROCESS-TYPE.
  5640     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  5641     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  5642     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  5643     MOVE CLAS-I-BAL   (CLAS-INDEXL) TO CP-SPECIAL-CALC-CD.
  5644
  5645     IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5646        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  5647         ADD +1                      TO CP-ORIGINAL-TERM
  5648                                        CP-LOAN-TERM.
  5649
  5650     IF CP-TERM-IS-DAYS
  5651         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
  5652     ELSE
  5653         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
  5654
  5655     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  5656
  5657     IF NO-CP-ERROR
  5658         NEXT SENTENCE
  5659     ELSE
  5660         MOVE +0                     TO CP-REMAINING-TERM-1
  5661                                        CP-REMAINING-TERM-2.
  5662
  5663     IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5664        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 122
* ECS150.cbl
  5665         COMPUTE CP-REMAINING-TERM-1 = (CP-REMAINING-TERM-1 - +1).
  5666
  5667     IF CP-REMAINING-TERM-1 IS NEGATIVE
  5668         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
  5669     IF CP-REMAINING-TERM-2 IS NEGATIVE
  5670         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
  5671
  5672     IF CP-REMAINING-TERM-1 = ZEROS
  5673         IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5674            (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L') AND
  5675            (CP-REMAINING-TERM-2 IS GREATER THAN ZEROS)
  5676             NEXT SENTENCE
  5677         ELSE
  5678             GO TO 4550-EXIT.
  5679
  5680     MOVE CP-REMAINING-TERM-1        TO UNEXPIRED-MONTHS.
  5681     COMPUTE EXPIRED-MONTHS = CR-LF-TERM - UNEXPIRED-MONTHS.
  5682
  5683     IF CR-LFPRM NOT NUMERIC
  5684        MOVE +0 TO CR-LFPRM.
  5685
  5686     IF SUMMARY-REC
  5687         IF CR-LFRFND = +0
  5688             MOVE CR-LFPRM       TO CP-ORIGINAL-PREMIUM
  5689         ELSE
  5690             COMPUTE CP-ORIGINAL-PREMIUM ROUNDED =
  5691                     CR-LFPRM - CR-LFRFND
  5692     ELSE
  5693         MOVE CR-LFPRM           TO CP-ORIGINAL-PREMIUM.
  5694
  5695     IF CR-LFPRM-ALT NOT NUMERIC
  5696        MOVE +0 TO CR-LFPRM-ALT.
  5697     MOVE CR-LFPRM-ALT           TO CP-ALTERNATE-PREMIUM
  5698     IF CR-LF-TERM NOT NUMERIC
  5699        MOVE +0 TO CR-LF-TERM.
  5700     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  5701     MOVE UNEXPIRED-MONTHS       TO CP-REMAINING-TERM
  5702     MOVE CLAS-I-EP (CLAS-INDEXL)
  5703                                 TO CP-EARNING-METHOD
  5704     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  5705                                 TO CP-BENEFIT-TYPE
  5706     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  5707                                 TO CP-SPECIAL-CALC-CD
  5708     MOVE CR-LFTYP               TO CP-BENEFIT-CD
  5709     MOVE LIFE-OVERRIDE-L1       TO CP-LIFE-OVERRIDE-CODE
  5710     PERFORM 4945-CALC-UNEARNED-PREMIUM THRU 4945-AH-EXIT.
  5711
  5712     IF CP-ERROR-OCCURED
  5713        GO TO 4575-ERROR-LF.
  5714
  5715     MOVE CP-STATE-U-PRM         TO UNEARNED-AMT-LF
  5716
  5717     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  5718         MOVE '1'                TO  TEXAS-REG-SW.
  5719
  5720     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  5721         MOVE '1'                TO  NET-PAY-SW.
  5722
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 123
* ECS150.cbl
  5723 4552-LIFE-EARNINGS-CONT.
  5724
  5725     COMPUTE UNEARNED-AMT-LF = UNEARNED-AMT-LF * FACTOR-C.
  5726
  5727     IF LEVEL-LIFE
  5728         MOVE +2                 TO IY
  5729     ELSE
  5730         MOVE +1                 TO IY.
  5731
  5732     IF INDIVIDUAL-INS
  5733         ADD +5 TO IY.
  5734
  5735     ADD UNEARNED-AMT-LF TO EARN-PREM (CL  TG  IY).
  5736
  5737 4550-EXIT.
  5738     EXIT.
  5739
  5740 4575-ERROR-LF.
  5741
  5742     DISPLAY 'ERROR OCCURED IN LF UNEARNED ROUTINE'
  5743     DISPLAY 'CP RETURN CODE ...' CP-RETURN-CODE.
  5744     DISPLAY 'FULL CONTROL   ...' CR-FULL-CONTROL
  5745     GO TO ABEND-PGM.
  5746
  5747 4585-GET-REMAINING-TERM.
  5748
  5749     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
  5750
  5751     IF DTE-CLIENT = 'NCL'
  5752         MOVE CP-REMAINING-TERM-1 TO CP-REMAINING-TERM-2.
  5753
  5754 4585-EXIT.
  5755     EXIT.
  5756
  5757 4600-COMPUTE-ISSUES.
  5758     IF EFFECTIVE-BOTH-PER
  5759         GO TO 4700-COMPUTE-CANCEL.
  5760
  5761     IF CR-ENTRY-STATUS = '3' OR '5'
  5762         GO TO 4700-COMPUTE-CANCEL.
  5763
  5764     MOVE '1'                    TO LF-ISSUE.
  5765     MOVE CR-LFAMT               TO PRT-ISSUE-AMT-LF.
  5766     MOVE CR-LFAMT               TO TEMP-RESULT.
  5767
  5768
  5769     IF LEVEL-LIFE
  5770         MOVE +2                 TO IY
  5771     ELSE
  5772         MOVE +1                 TO IY.
  5773
  5774     IF OB-COVERAGE
  5775         MOVE +3                 TO IY.
  5776
  5777 4610-TOT-LF-ISSUES.
  5778     MOVE TEMP-RESULT            TO INFORCE-DOLLARS.
  5779
  5780     MOVE +2                     TO EG.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 124
* ECS150.cbl
  5781     IF SUMMARY-REC
  5782         MOVE CR-LIVES           TO COUNT-WORK.
  5783     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT.
  5784
  5785     MOVE 1                      TO INFORCE-CNT-SW.
  5786     ADD INFORCE-DOLLARS TO SAVE-BGN-INFORCE.
  5787
  5788     IF INDIVIDUAL-INS
  5789         ADD +5 TO IY.
  5790
  5791     IF CR-LFPRM-ALT NOT NUMERIC
  5792         MOVE ZEROS              TO  CR-LFPRM-ALT.
  5793
  5794     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  5795         ADD CR-LFPRM            TO  EARN-PREM  (CL  TG  IY)
  5796                                     ISSUE-PREM (CL  TG  IY)
  5797         ADD CR-LFPRM-ALT        TO  EARN-PREM  (CL  TG  IY)
  5798                                     ISSUE-PREM (CL  TG  IY)
  5799     ELSE
  5800         ADD CR-LFPRM            TO  EARN-PREM  (CL  TG  IY)
  5801                                     ISSUE-PREM (CL  TG  IY).
  5802
  5803     ADD TEMP-RESULT TO ISSUE-AMT (CL  TG  IY).
  5804     ADD COUNT-WORK TO ISSUE-CNT (CL  TG  IY).
  5805
  5806 4700-COMPUTE-CANCEL.
  5807*    NOTE *******************************************************
  5808*         *  EFFECTIVE AS OF VMOD 6.30 THE FOLLOWING TWO        *
  5809*         *  LINES OF CODE ARE DELETED. IF PRESENT, YOUR CANCEL *
  5810*         *  COUNT AND CLAIM COUNT WILL BE TOO LOW BECAUSE ONLY *
  5811*         *  POLICIES ISSUED IN CURRENT YEAR WILL BE COUNTED.   *
  5812*         *  THE AMOUNTS ARE CORRECT AND WILL BE UNAFFECTED.    *
  5813*         *******************************************************.
  5814*    IF INFORCE-CNT-SW NOT = 1
  5815*        MOVE 0 TO COUNT-WORK.
  5816******************************************************************
  5817     IF SUMMARY-REC AND
  5818        (SUM-CANCEL-DATE NOT GREATER PERIOD-END) AND
  5819        (SUM-CANCEL-DATE GREATER PERIOD-START) AND
  5820        (CR-SUM-CAN-CNT-YTD NOT = ZERO)
  5821         NEXT SENTENCE
  5822       ELSE
  5823        IF LUMP-SUM AND
  5824           (CLAIM-EXIT-DATE NOT GREATER PERIOD-END) AND
  5825           (CLAIM-EXIT-DATE NOT LESS PERIOD-START)
  5826            NEXT SENTENCE
  5827         ELSE
  5828            IF (CANCEL-EXIT-DATE = ZERO OR LOW-VALUES) OR
  5829               CANCEL-EXIT-DATE GREATER THAN PERIOD-END
  5830                GO TO 4750-COMPUTE-CLAIM.
  5831
  5832     SUBTRACT CR-CCYY FROM CR-LF-CNC-CCYY GIVING INTERIM-YR.
  5833*    SUBTRACT CR-YR FROM CR-LF-CNC-YR GIVING INTERIM-YR.
  5834     IF INTERIM-YR < 0
  5835        ADD 100 TO INTERIM-YR
  5836     END-IF.
  5837     COMPUTE TERM-WORK = (INTERIM-YR * 12)
  5838                        + (CR-LF-CNC-MO - CR-MO).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 125
* ECS150.cbl
  5839     IF CR-LF-CNC-DA LESS THAN CR-DA
  5840         SUBTRACT 1 FROM TERM-WORK.
  5841
  5842     IF LUMP-SUM
  5843         MOVE '1'                TO LF-LUMP
  5844     ELSE
  5845         MOVE '1'                TO LF-CANC.
  5846
  5847     MULTIPLY CR-LFRFND BY -1 GIVING UNEARNED-AMT-LF.
  5848     MOVE '1'                    TO LF-CANC.
  5849     MOVE CR-LFRFND              TO PRT-CANC-AMT-LF.
  5850
  5851     IF LEVEL-LIFE
  5852         MOVE +2                 TO IY
  5853     ELSE
  5854         MOVE +1                 TO IY.
  5855
  5856     IF OB-COVERAGE
  5857         MOVE +3                 TO IY.
  5858
  5859     IF INDIVIDUAL-INS
  5860         ADD +5 TO IY.
  5861
  5862     ADD UNEARNED-AMT-LF TO EARN-PREM (CL  TG  IY).
  5863
  5864     IF SUMMARY-REC
  5865         GO TO 4703-SUM-CANC.
  5866
  5867     IF LEVEL-LIFE
  5868         MOVE CR-LFAMT           TO DOLLAR-AMT
  5869         GO TO 4705-LF-CANCEL-GO.
  5870
  5871     IF OB-COVERAGE
  5872         MOVE CR-LFAMT           TO DOLLAR-AMT
  5873         GO TO 4705-LF-CANCEL-GO.
  5874
  5875     IF TERM-WORK NOT POSITIVE
  5876         MOVE CR-LFAMT           TO DOLLAR-AMT
  5877         GO TO 4705-LF-CANCEL-GO.
  5878
  5879     IF TEXAS-CERT
  5880         GO TO 4701-TEX-CANC.
  5881
  5882     IF NET-PAY-CERT
  5883         GO TO 4702-NET-PAY-CANC.
  5884
  5885 4700-REG-CANCEL.
  5886     COMPUTE DOLLAR-AMT = CR-LFAMT - ((TERM-WORK / CR-LF-TERM)
  5887                             * CR-LFAMT).
  5888     GO TO 4705-LF-CANCEL-GO.
  5889
  5890 4701-TEX-CANC.
  5891     DIVIDE CR-LFAMT BY CR-LF-TERM
  5892         GIVING TEX-FACT-1.
  5893     DIVIDE TERM-WORK BY CR-PMT-FREQ
  5894         GIVING TEX-FACT-2
  5895             REMAINDER TEX-FACT-3.
  5896     COMPUTE DOLLAR-AMT =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 126
* ECS150.cbl
  5897         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
  5898
  5899     GO TO 4705-LF-CANCEL-GO.
  5900
  5901 4702-NET-PAY-CANC.
  5902
  5903     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  5904     MOVE 'L'                    TO  DC-OPTION-CODE.
  5905     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5906     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  5907
  5908     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5909         MOVE CR-LOAN-1ST-PMT-DT TO  DC-GREG-DATE-1-YMD
  5910         MOVE '3'                TO  DC-OPTION-CODE
  5911         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5912             8599-DATE-CONVERT-X
  5913         MOVE DC-BIN-DATE-1      TO  CP-FIRST-PAY-DATE
  5914     ELSE
  5915         MOVE CP-CERT-EFF-DT     TO  DC-BIN-DATE-1
  5916         MOVE +1                 TO  DC-ELAPSED-MONTHS
  5917         MOVE +0                 TO  DC-ELAPSED-DAYS
  5918         MOVE '6'                TO  DC-OPTION-CODE
  5919         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5920             8599-DATE-CONVERT-X
  5921         MOVE DC-BIN-DATE-2      TO  CP-FIRST-PAY-DATE.
  5922
  5923     MOVE CR-LFAMT               TO  CP-ORIGINAL-BENEFIT.
  5924     MOVE CR-APR                 TO  CP-LOAN-APR.
  5925     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM.
  5926     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  5927     COMPUTE CP-REMAINING-TERM = CR-LF-TERM - TERM-WORK.
  5928     MOVE STATE-ABBR       (CLAS-INDEXS) TO  CP-STATE-STD-ABBRV.
  5929     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
  5930     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  5931     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
  5932
  5933     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  5934
  5935     IF SUMMARY-REC
  5936         COMPUTE DOLLAR-AMT ROUNDED = CP-REMAMT-FACTOR *
  5937                                      (TEMP-1 / +1000)
  5938         GO TO 4705-LF-CANCEL-GO.
  5939
  5940     IF CP-STATE-STD-ABBRV = 'NC'
  5941               AND
  5942*      DTE-CLIENT NOT = 'WDS'
  5943       (DTE-CLIENT NOT = 'WDS' AND 'CID')
  5944          IF CP-CERT-EFF-DT GREATER THAN WS-931231
  5945             MOVE CP-REMAINING-AMT
  5946                                  TO  DOLLAR-AMT
  5947             GO TO 4705-LF-CANCEL-GO.
  5948
  5949      COMPUTE DOLLAR-AMT ROUNDED = CP-REMAMT-FACTOR *
  5950                                      (CR-LFAMT / +1000).
  5951*    IF SUMMARY-REC
  5952*          COMPUTE DOLLAR-AMT ROUNDED =
  5953*                          CP-REMAMT-FACTOR * (TEMP-1 / +1000)
  5954*      ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 127
* ECS150.cbl
  5955*          COMPUTE DOLLAR-AMT ROUNDED =
  5956*                          CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
  5957
  5958     GO TO 4705-LF-CANCEL-GO.
  5959
  5960 4703-SUM-CANC.
  5961     IF CR-LFPRM NOT GREATER CR-LFRFND
  5962        MOVE ZERO                TO DOLLAR-AMT
  5963        GO TO 4705-LF-CANCEL-GO.
  5964
  5965     IF CR-LFRFND = ZERO
  5966        MOVE CR-LFAMT            TO TEMP-1
  5967      ELSE
  5968                COMPUTE TEMP-RESULT-L ROUNDED =
  5969                                     CR-LFRFND / CR-LFPRM
  5970                COMPUTE TEMP-1 ROUNDED = CR-LFAMT -
  5971                                    (CR-LFAMT * TEMP-RESULT-L).
  5972
  5973     IF NET-PAY-CERT
  5974         GO TO 4702-NET-PAY-CANC.
  5975
  5976     IF LEVEL-LIFE
  5977         MOVE TEMP-1             TO DOLLAR-AMT
  5978      ELSE
  5979         COMPUTE DOLLAR-AMT = TEMP-1 - ((TERM-WORK / CR-LF-TERM)
  5980                                                        * TEMP-1).
  5981
  5982 4705-LF-CANCEL-GO.
  5983     MOVE DOLLAR-AMT             TO DECREASING-DOLLAR.
  5984
  5985     IF DOLLAR-AMT NEGATIVE
  5986         MOVE ZERO               TO DOLLAR-AMT.
  5987
  5988 4710-TOT-LF-CANCEL.
  5989     MOVE +6                     TO EG.
  5990     MOVE DOLLAR-AMT             TO INFORCE-DOLLARS.
  5991     MOVE COUNT-WORK             TO COUNT-SAVE.
  5992
  5993     IF (CLAIM-EXIT-DATE NOT = ZERO AND LOW-VALUES) AND
  5994        (CLAIM-EXIT-DATE <= PERIOD-END) AND
  5995        (CLAIM-EXIT-DATE GREATER PERIOD-START) AND
  5996        (NOT LUMP-SUM)
  5997         MOVE ZERO               TO COUNT-WORK
  5998         MOVE ZERO               TO DOLLAR-AMT INFORCE-DOLLARS.
  5999
  6000     IF SUMMARY-REC
  6001         MOVE CR-SUM-CAN-CNT-YTD TO COUNT-WORK.
  6002
  6003     IF NOT CURRENT-CANCEL-ONLY
  6004         PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT
  6005         SUBTRACT INFORCE-DOLLARS FROM SAVE-BGN-INFORCE.
  6006
  6007     IF LEVEL-LIFE
  6008         MOVE +2                 TO IY
  6009     ELSE
  6010         MOVE +1                 TO IY.
  6011
  6012     IF OB-COVERAGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 128
* ECS150.cbl
  6013         MOVE +3                 TO IY.
  6014
  6015     IF INDIVIDUAL-INS
  6016         ADD +5 TO IY.
  6017
  6018     IF CR-LF-STATUS-AT-CANCEL NOT = SPACES
  6019         ADD COUNT-WORK TO CANCEL-CNT (CL  TG  IY).
  6020
  6021     ADD CR-LFRFND TO CANCEL-PREM (CL  TG  IY).
  6022     IF NOT CURRENT-CANCEL-ONLY
  6023        ADD DOLLAR-AMT TO CANCEL-AMT (CL  TG  IY).
  6024
  6025     MOVE COUNT-SAVE             TO COUNT-WORK.
  6026
  6027 4730-TOT-AH-CANCEL.
  6028     IF LUMP-SUM
  6029         GO TO 4900-PROCESS-DISABILITY.
  6030
  6031     IF (CANCEL-EXIT-DATE NOT = ZERO AND LOW-VALUES) AND
  6032        (CANCEL-EXIT-DATE <= PERIOD-END) AND
  6033        (CANCEL-EXIT-DATE GREATER PERIOD-START)
  6034          NEXT SENTENCE
  6035       ELSE
  6036         GO TO 4750-COMPUTE-CLAIM.
  6037
  6038     IF OB-COVERAGE
  6039         MOVE +5                 TO IY
  6040     ELSE
  6041         MOVE +4                 TO IY.
  6042
  6043     IF INDIVIDUAL-INS
  6044         ADD +5 TO IY.
  6045
  6046     IF SUMMARY-REC
  6047         MOVE CR-SUM-CAN-CNT-YTD TO COUNT-WORK.
  6048
  6049
  6050
  6051     IF CURRENT-CANCEL-ONLY
  6052         GO TO 4900-PROCESS-DISABILITY.
  6053     IF CLAIM-EXIT-DATE NOT = LOW-VALUES
  6054         GO TO 4750-COMPUTE-CLAIM.
  6055     IF CR-DTHAMT-YTD NOT = ZERO
  6056         GO TO 4750-COMPUTE-CLAIM.
  6057     IF CERT-ENTRY-DATE GREATER THAN PERIOD-START
  6058         GO TO 4820-COMPUTE-DECREASE.
  6059     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START
  6060         GO TO 4800-COMPUTE-INCREASE.
  6061
  6062     GO TO 4820-COMPUTE-DECREASE.
  6063
  6064 4750-COMPUTE-CLAIM.
  6065     IF CR-LFTYP = ZERO
  6066         GO TO 4820-COMPUTE-DECREASE.
  6067
  6068     IF LUMP-SUM
  6069         GO TO 4820-COMPUTE-DECREASE.
  6070
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 129
* ECS150.cbl
  6071     IF CLAIM-EXIT-DATE GREATER THAN PERIOD-END
  6072         GO TO 4770-COMPUTE-EXPIRE.
  6073
  6074     IF (CLAIM-EXIT-DATE = ZERO OR LOW-VALUES OR SPACES) AND
  6075         CR-DTHAMT-YTD = ZERO
  6076             GO TO 4770-COMPUTE-EXPIRE.
  6077
  6078     MOVE CR-DTHAMT-YTD          TO DECREASING-DOLLAR.
  6079     MOVE CR-DTHAMT-YTD          TO PRT-DEATH-AMT-LF.
  6080     MOVE '1'                    TO LF-DEATH.
  6081
  6082     IF LEVEL-LIFE
  6083         MOVE +2                 TO IY
  6084     ELSE
  6085         MOVE +1                 TO IY.
  6086
  6087     IF OB-COVERAGE
  6088         MOVE +3                 TO IY.
  6089
  6090     IF INDIVIDUAL-INS
  6091         ADD +5 TO IY.
  6092
  6093     ADD COUNT-WORK TO CLAIM-CNT (CL  TG  IY).
  6094     ADD CR-DTHAMT-YTD TO CLAIM-AMT (CL TG IY).
  6095     MOVE CR-DTHAMT-YTD TO INFORCE-DOLLARS.
  6096
  6097     IF OB-COVERAGE
  6098         MOVE +5                 TO IY
  6099     ELSE
  6100         MOVE +4                 TO IY.
  6101
  6102     IF INDIVIDUAL-INS
  6103         ADD +5 TO IY.
  6104
  6105     MOVE +4                     TO EG.
  6106     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT
  6107
  6108     IF CURRENT-CLAIM-ONLY
  6109         GO TO 4900-PROCESS-DISABILITY.
  6110
  6111     IF OB-COVERAGE
  6112         GO TO 4770-COMPUTE-EXPIRE.
  6113
  6114     SUBTRACT INFORCE-DOLLARS FROM SAVE-BGN-INFORCE.
  6115
  6116     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START AND
  6117        NOT LEVEL-LIFE
  6118         GO TO 4800-COMPUTE-INCREASE.
  6119
  6120     IF NOT LEVEL-LIFE
  6121         GO TO 4820-COMPUTE-DECREASE.
  6122
  6123     COMPUTE DOLLAR-AMT = CR-LFAMT - CR-DTHAMT-YTD.
  6124     MOVE '1'                    TO LF-DECR.
  6125     MOVE DOLLAR-AMT             TO PRT-DECR-AMT-LF.
  6126
  6127     IF GROUP-INS
  6128         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  7)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 130
* ECS150.cbl
  6129         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  8)
  6130     ELSE
  6131         ADD DOLLAR-AMT TO IND-AMT (CL  TG  7)
  6132         ADD DOLLAR-AMT TO IND-AMT (CL  TG  8).
  6133     SUBTRACT DOLLAR-AMT FROM SAVE-BGN-INFORCE.
  6134
  6135     IF CERT-EXPIRE-DATE GREATER THAN PERIOD-START
  6136         GO TO 4900-PROCESS-DISABILITY
  6137     ELSE
  6138         MOVE CR-LFAMT           TO DECREASING-DOLLAR
  6139         GO TO 4800-COMPUTE-INCREASE.
  6140
  6141 4770-COMPUTE-EXPIRE.
  6142     IF CR-ENTRY-STATUS = '3' OR '5'
  6143         GO TO 4900-PROCESS-DISABILITY.
  6144
  6145     IF CERT-EXPIRE-DATE >= PERIOD-END
  6146         GO TO 4820-COMPUTE-DECREASE.
  6147
  6148     IF CR-LFTYP = ZERO
  6149         GO TO 4900-PROCESS-DISABILITY.
  6150
  6151     IF (CLAS-I-EP (CLAS-INDEXL) = 'B'  AND
  6152         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'  AND
  6153         LF-BAL-REMTRM NOT GREATER THAN ZERO)
  6154                       OR
  6155        (CLAS-I-EP (CLAS-INDEXL) = 'B'  AND
  6156         CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'  AND
  6157         LF-REM-TRM NOT GREATER THAN ZERO)
  6158                       OR
  6159        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'  AND
  6160         LF-REM-TRM NOT GREATER ZERO)
  6161           NEXT SENTENCE
  6162         ELSE
  6163         GO TO 4900-PROCESS-DISABILITY.
  6164
  6165     IF SUMMARY-REC
  6166        COMPUTE COUNT-WORK = CR-LIVES - CR-SUM-CAN-CNT-ITD
  6167        IF CR-LFPRM NOT GREATER CR-LFRFND
  6168           MOVE ZERO TO INFORCE-DOLLARS
  6169         ELSE
  6170          IF CR-LFRFND = ZERO
  6171             MOVE CR-LFAMT TO INFORCE-DOLLARS
  6172           ELSE
  6173                COMPUTE TEMP-RESULT-L ROUNDED =
  6174                                     CR-LFRFND / CR-LFPRM
  6175                COMPUTE DOLLAR-AMT ROUNDED = CR-LFAMT -
  6176                                    (CR-LFAMT * TEMP-RESULT-L).
  6177
  6178     IF EFFECTIVE-BOTH-PER
  6179         PERFORM 8300-STARTING-INFORCE THRU 8300-EXIT
  6180         MOVE INFORCE-DOLLARS    TO DOLLAR-AMT
  6181     ELSE
  6182         MOVE CR-LFAMT           TO DOLLAR-AMT.
  6183
  6184     IF OB-COVERAGE AND CR-LFTYP NOT = ZERO
  6185         MOVE CR-LFAMT           TO DOLLAR-AMT.
  6186
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 131
* ECS150.cbl
  6187     MOVE '1'                    TO LF-EXPIRY.
  6188     MOVE DOLLAR-AMT             TO PRT-EXPIRY-AMT-LF.
  6189     MOVE DOLLAR-AMT             TO INFORCE-DOLLARS.
  6190     MOVE +5                     TO EG.
  6191     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT.
  6192
  6193     IF NOT OB-COVERAGE
  6194         SUBTRACT INFORCE-DOLLARS FROM SAVE-BGN-INFORCE.
  6195
  6196     GO TO 4900-PROCESS-DISABILITY.
  6197
  6198 4800-COMPUTE-INCREASE.
  6199     IF CR-ENTRY-STATUS = '3' OR '5'
  6200         GO TO 4900-PROCESS-DISABILITY.
  6201
  6202     IF NOT EFFECTIVE-BOTH-PER
  6203         GO TO 4900-PROCESS-DISABILITY.
  6204
  6205     IF CR-LFTYP = ZERO
  6206         GO TO 4900-PROCESS-DISABILITY.
  6207
  6208     IF OB-COVERAGE OR SUMMARY-REC
  6209         GO TO 4900-PROCESS-DISABILITY.
  6210
  6211     COMPUTE MINUS-AMT = DECREASING-DOLLAR * -1.
  6212     MOVE '1'                    TO LF-INCR.
  6213     MOVE MINUS-AMT              TO PRT-INCR-AMT-LF.
  6214
  6215     IF GROUP-INS
  6216         ADD MINUS-AMT TO GROUP-AMT (CL  TG  7)
  6217         ADD MINUS-AMT TO GROUP-AMT (CL  TG  8)
  6218     ELSE
  6219         ADD MINUS-AMT TO IND-AMT (CL  TG  7)
  6220         ADD MINUS-AMT TO IND-AMT (CL  TG  8).
  6221     ADD DECREASING-DOLLAR TO SAVE-BGN-INFORCE.
  6222
  6223     GO TO 4900-PROCESS-DISABILITY.
  6224
  6225 4820-COMPUTE-DECREASE.
  6226     IF CR-ENTRY-STATUS = '3' OR '5'
  6227         GO TO 4900-PROCESS-DISABILITY.
  6228
  6229     IF CR-LFTYP = ZERO
  6230         GO TO 4900-PROCESS-DISABILITY.
  6231
  6232     IF LEVEL-LIFE
  6233         GO TO 4900-PROCESS-DISABILITY.
  6234
  6235     IF OB-COVERAGE OR SUMMARY-REC
  6236         GO TO 4900-PROCESS-DISABILITY.
  6237
  6238     IF NOT EFFECTIVE-BOTH-PER
  6239         SUBTRACT DECREASING-DOLLAR FROM CR-LFAMT
  6240             GIVING DOLLAR-AMT.
  6241
  6242     IF EFFECTIVE-BOTH-PER
  6243         PERFORM 8300-STARTING-INFORCE THRU 8300-EXIT
  6244         MOVE INFORCE-DOLLARS    TO DOLLAR-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 132
* ECS150.cbl
  6245         SUBTRACT DECREASING-DOLLAR FROM DOLLAR-AMT.
  6246
  6247     MOVE '1'                    TO LF-DECR.
  6248     MOVE DOLLAR-AMT             TO PRT-DECR-AMT-LF.
  6249
  6250     IF GROUP-INS
  6251         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  7)
  6252         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  8)
  6253     ELSE
  6254         ADD DOLLAR-AMT TO IND-AMT (CL  TG  7)
  6255         ADD DOLLAR-AMT TO IND-AMT (CL  TG  8).
  6256     SUBTRACT DOLLAR-AMT FROM SAVE-BGN-INFORCE.
  6257
  6258 4900-PROCESS-DISABILITY.
  6259
  6260     IF CR-AHTYP = ZERO
  6261         GO TO 4999-PRINT.
  6262
  6263     MOVE ZERO                   TO CANCEL-SW.
  6264     MOVE ZERO                   TO CLAIM-SW.
  6265
  6266     IF CR-AH-CURRENT-STATUS NOT = 6 AND 7 AND 8
  6267         MOVE 0                  TO CERT-STATUS.
  6268     IF CR-AH-CURRENT-STATUS = 7
  6269         MOVE 2                  TO CERT-STATUS.
  6270     IF CR-AH-CURRENT-STATUS = 8
  6271         MOVE 1                  TO CERT-STATUS.
  6272     IF CR-AH-CURRENT-STATUS = 6
  6273         MOVE 3                  TO CERT-STATUS.
  6274
  6275     MOVE CERT-EFFECT-DT             TO CP-CERT-EFF-DT.
  6276     MOVE FIRST-PAY-DT               TO CP-FIRST-PAY-DATE.
  6277     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
  6278     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  6279     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  6280     MOVE '3'                        TO CP-PROCESS-TYPE.
  6281     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  6282     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  6283     MOVE ZEROS TO  CP-TERM-OR-EXT-DAYS.
  6284
  6285 AH-REM-TERM.
  6286
  6287     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  6288
  6289     MOVE CP-REMAINING-TERM-2 TO AH-REM-TRM.
  6290
  6291     IF REINSURANCE-PASS OR REINSURANCE-REC
  6292         MOVE CR-AH-EXPIRE-DATE TO DC-GREG-DATE-CYMD
  6293         MOVE 'L' TO DC-OPTION-CODE
  6294         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6295                 8599-DATE-CONVERT-X
  6296         MOVE DC-BIN-DATE-1 TO CERT-EXPIRE-DATE
  6297         GO TO 4910-SKIP-CALC.
  6298
  6299     MOVE FIRST-PAY-DT            TO DC-BIN-DATE-1.
  6300     COMPUTE DC-ELAPSED-MONTHS = CR-AH-TERM - +1.
  6301     MOVE '6'                     TO DC-OPTION-CODE.
  6302     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 133
* ECS150.cbl
  6303                 8599-DATE-CONVERT-X.
  6304     IF NO-CONVERSION-ERROR
  6305         MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  6306     ELSE
  6307         MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  6308
  6309     IF (CERT-EXPIRE-DATE = LOW-VALUES)     OR
  6310         (DTE-REM-TRM-CALC-OPTION = '1' OR '2')
  6311        MOVE CERT-EFFECT-DT          TO DC-BIN-DATE-1
  6312        MOVE CR-AH-TERM              TO DC-ELAPSED-MONTHS
  6313        MOVE ZEROS                   TO DC-ELAPSED-DAYS
  6314        MOVE '6'                     TO DC-OPTION-CODE
  6315        PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6316                8599-DATE-CONVERT-X
  6317        IF NO-CONVERSION-ERROR
  6318           MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  6319        ELSE
  6320           MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  6321
  6322     IF CP-REMAINING-TERM-2 NOT GREATER THAN ZEROS
  6323         IF CERT-EXPIRE-DATE >= PERIOD-END
  6324             MOVE PERIOD-END  TO  CERT-EXPIRE-DATE.
  6325
  6326     MOVE CERT-EXPIRE-DATE TO DC-BIN-DATE-1.
  6327     MOVE ' '                TO  DC-OPTION-CODE.
  6328     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6329     MOVE DC-GREG-DATE-CYMD TO WS-CR-AH-EXPIRE-DATE
  6330                               CR-AH-EXPIRE-DATE.
  6331
  6332 4910-SKIP-CALC.
  6333
  6334     MOVE LOW-VALUES             TO LOW-EXIT-DATE.
  6335     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO DC-GREG-DATE-CYMD.
  6336     MOVE 'L'                TO  DC-OPTION-CODE.
  6337     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6338     MOVE DC-BIN-DATE-1  TO  CLAIM-EXIT-DATE.
  6339
  6340     MOVE CR-AH-CANCEL-EXIT-DATE  TO DC-GREG-DATE-CYMD.
  6341     MOVE 'L'                TO  DC-OPTION-CODE.
  6342     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6343     MOVE DC-BIN-DATE-1  TO  CANCEL-EXIT-DATE.
  6344
  6345     MOVE CR-AH-CANC-DT      TO DC-GREG-DATE-CYMD.
  6346     MOVE 'L'                TO  DC-OPTION-CODE.
  6347     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6348     MOVE DC-BIN-DATE-1  TO  SUM-CANCEL-DATE.
  6349
  6350     MOVE LOW-VALUES             TO LOW-EXIT-DATE.
  6351
  6352     IF CLAIM-EXIT-DATE = SPACES OR ZEROS
  6353         MOVE LOW-VALUES TO CLAIM-EXIT-DATE.
  6354
  6355     IF CANCEL-EXIT-DATE = SPACES OR ZEROS
  6356         MOVE LOW-VALUES TO CANCEL-EXIT-DATE.
  6357
  6358     IF CLAIM-EXIT-DATE = LOW-VALUES AND
  6359        CANCEL-EXIT-DATE = LOW-VALUES
  6360         GO TO 4920-SET-SUBSCRIPTS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 134
* ECS150.cbl
  6361
  6362     IF CLAIM-EXIT-DATE = LOW-VALUES
  6363         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE
  6364         GO TO 4920-SET-SUBSCRIPTS.
  6365
  6366     IF CANCEL-EXIT-DATE = LOW-VALUES
  6367         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  6368         GO TO 4920-SET-SUBSCRIPTS.
  6369
  6370     IF CLAIM-EXIT-DATE LESS THAN CANCEL-EXIT-DATE
  6371         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  6372     ELSE
  6373         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE.
  6374
  6375 4920-SET-SUBSCRIPTS.
  6376
  6377     IF CR-AH-TERM LESS THAN +121
  6378         MOVE +2                 TO TG
  6379     ELSE
  6380         MOVE +3                 TO TG.
  6381
  6382     IF CR-AH-TERM LESS THAN +61
  6383         MOVE +1                 TO TG.
  6384
  6385     IF OB-COVERAGE
  6386         MOVE +5                 TO IY
  6387     ELSE
  6388         MOVE +4                 TO IY.
  6389
  6390     IF INDIVIDUAL-INS
  6391         ADD +5 TO IY.
  6392
  6393     IF NOT EFFECTIVE-BOTH-PER
  6394         GO TO 4925-CHECK-THIS-PER-ITEM.
  6395
  6396     IF CLAIM-EXIT-DATE NOT = LOW-VALUES AND
  6397        CANCEL-EXIT-DATE NOT = LOW-VALUES
  6398         IF CLAIM-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  6399            CANCEL-EXIT-DATE GREATER THAN PERIOD-START
  6400             MOVE 1              TO CANCEL-SW
  6401             MOVE 0              TO COUNT-WORK
  6402             GO TO 4970-CHECK-CANCEL
  6403         ELSE
  6404             IF CANCEL-EXIT-DATE NOT GREATER THAN PERIOD-START
  6405             AND
  6406             CLAIM-EXIT-DATE GREATER THAN PERIOD-START
  6407              MOVE 1             TO CLAIM-SW
  6408              MOVE 0             TO COUNT-WORK
  6409              GO TO 4980-CHECK-CLAIM.
  6410
  6411     IF CLAIM-OR-CANCEL AND
  6412        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  6413            CR-DISAMT-YTD NOT = ZERO
  6414                GO TO 4980-CHECK-CLAIM.
  6415
  6416     IF CLAIM-OR-CANCEL AND
  6417        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START
  6418         GO TO 4999-PRINT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 135
* ECS150.cbl
  6419
  6420     IF (CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START) AND
  6421        NOT CLAIM-OR-CANCEL
  6422            GO TO 4980-CHECK-CLAIM.
  6423
  6424     MOVE '1'                    TO OLD-IN-EFFECT.
  6425
  6426 4925-CHECK-THIS-PER-ITEM.
  6427
  6428     IF CLAIM-OR-CANCEL AND
  6429        LOW-EXIT-DATE <= PERIOD-END
  6430         GO TO 4930-COMPUTE-UNEARNED.
  6431
  6432     IF CERT-EXPIRE-DATE < PERIOD-END
  6433         GO TO 4930-COMPUTE-UNEARNED.
  6434
  6435     MOVE 1                      TO NEW-IN-EFFECT.
  6436
  6437 4930-COMPUTE-UNEARNED.
  6438     IF CR-ENTRY-STATUS = ('3' OR '5')
  6439         GO TO 4950-CHECK-AH-ISSUE.
  6440
  6441     IF SUMMARY-REC
  6442         IF CR-AHPRM IS NOT GREATER THAN CR-AHRFND
  6443             MOVE ZERO           TO  CR-AHPRM
  6444                                     CR-AHRFND.
  6445     IF OB-COVERAGE
  6446         GO TO 4950-CHECK-AH-ISSUE.
  6447
  6448     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  6449     MOVE 'L'                        TO DC-OPTION-CODE.
  6450     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6451     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  6452
  6453     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  6454         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  6455
  6456     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  6457         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  6458         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  6459                                        DC-ELAPSED-DAYS
  6460         MOVE '3'                    TO DC-OPTION-CODE
  6461         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6462                 8599-DATE-CONVERT-X
  6463         IF NO-CONVERSION-ERROR
  6464             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
  6465         ELSE
  6466             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  6467
  6468     IF CR-LOAN-1ST-PMT-DT = ZEROS
  6469         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  6470         MOVE +1                     TO DC-ELAPSED-MONTHS
  6471         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  6472         MOVE '6'                    TO DC-OPTION-CODE
  6473         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6474                 8599-DATE-CONVERT-X
  6475         MOVE DC-BIN-DATE-1          TO CP-FIRST-PAY-DATE.
  6476
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 136
* ECS150.cbl
  6477     IF ENTERED-PREV-PERIOD
  6478         MOVE RUN-DATE-BIN       TO CP-VALUATION-DT
  6479         MOVE +1                 TO FACTOR-C
  6480         PERFORM 4940-UNEARNED-CALC THRU 4940-EXIT.
  6481
  6482     IF ENTERED-PREV-PERIOD
  6483         IF CERT-CANCELLED
  6484             IF CANCEL-EXIT-DATE <= PERIOD-END
  6485                 GO TO 4970-CHECK-CANCEL.
  6486
  6487     IF ENTERED-THIS-PERIOD
  6488         IF CERT-CANCELLED
  6489             IF CANCEL-EXIT-DATE <= PERIOD-END
  6490                 GO TO 4950-CHECK-AH-ISSUE.
  6491
  6492     IF ENTERED-THIS-PERIOD
  6493         MOVE EP-DT-BIN          TO CP-VALUATION-DT
  6494         MOVE -1                 TO FACTOR-C
  6495         PERFORM 4940-UNEARNED-CALC THRU 4940-EXIT.
  6496
  6497     GO TO 4950-CHECK-AH-ISSUE.
  6498
  6499 4940-UNEARNED-CALC.
  6500
  6501     MOVE SPACES                     TO CP-ACCT-FLD-5.
  6502     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  6503     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
  6504     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  6505     MOVE '3'                        TO CP-PROCESS-TYPE.
  6506     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  6507     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  6508
  6509 4940-GET-REMAINING-TERM.
  6510
  6511     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  6512
  6513     MOVE CP-REMAINING-TERM-1        TO UNEXPIRED-MONTHS.
  6514     COMPUTE EXPIRED-MONTHS = CR-AH-TERM - UNEXPIRED-MONTHS.
  6515
  6516 4940-TERM-OK.
  6517     IF UNEXPIRED-MONTHS NOT GREATER ZERO
  6518         GO TO 4940-EXIT.
  6519
  6520     IF SUMMARY-REC
  6521         IF CR-AHRFND = +0
  6522             MOVE CR-AHPRM       TO CP-ORIGINAL-PREMIUM
  6523         ELSE
  6524             COMPUTE CP-ORIGINAL-PREMIUM ROUNDED =
  6525                 CR-AHPRM - CR-AHRFND
  6526     ELSE
  6527         MOVE CR-AHPRM           TO CP-ORIGINAL-PREMIUM.
  6528
  6529     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  6530     MOVE CR-AHAMT               TO CP-ORIGINAL-BENEFIT
  6531                                    CP-RATING-BENEFIT-AMT.
  6532     MOVE UNEXPIRED-MONTHS       TO CP-REMAINING-TERM
  6533
  6534     IF AH-EARN-METHOD = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 137
* ECS150.cbl
  6535         MOVE CLAS-I-EP (CLAS-INDEXA) TO  CP-EARNING-METHOD
  6536     ELSE
  6537         MOVE AH-EARN-METHOD          TO  CP-EARNING-METHOD.
  6538
  6539     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  6540                                 TO CP-BENEFIT-TYPE
  6541     MOVE ZEROS                  TO CP-ALTERNATE-PREMIUM
  6542     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA)
  6543                                 TO CP-SPECIAL-CALC-CD
  6544     MOVE AM-AH-DEVIATION        TO CP-DEVIATION-CODE
  6545     MOVE CR-AHTYP               TO CP-BENEFIT-CD
  6546     MOVE AH-OVERRIDE-L1         TO CP-AH-OVERRIDE-CODE
  6547
  6548     IF CR-PMT-EXTENSION-DAYS NOT NUMERIC
  6549        MOVE ZEROS               TO CP-TERM-OR-EXT-DAYS
  6550     ELSE
  6551        MOVE CR-PMT-EXTENSION-DAYS
  6552                                 TO CP-TERM-OR-EXT-DAYS.
  6553
  6554     PERFORM 4945-CALC-UNEARNED-PREMIUM THRU 4945-AH-EXIT.
  6555
  6556     IF CP-ERROR-OCCURED
  6557        GO TO 4945-ERROR-AH.
  6558
  6559     MOVE CP-STATE-U-PRM    TO UNEARNED-AMT-AH.
  6560
  6561     IF (STATE-ABBR (CLAS-INDEXS) = 'VA')      AND
  6562        (CR-AH-TERM GREATER THAN +61)  AND
  6563        (CR-DT GREATER THAN  19921231)
  6564          MOVE  'A'  TO  AH-EARN-METHOD.
  6565
  6566     IF (CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B' AND 'Z') AND
  6567        (AH-EARN-METHOD = 'A' OR 'C')
  6568         PERFORM 8450-RE-RATE-ROUTINE THRU 8499-EXIT
  6569         IF (CP-ERROR-RATE-NOT-FOUND OR
  6570             CP-ERROR-RATE-IS-ZERO OR
  6571             CP-ERROR-IN-DATES)
  6572             NEXT SENTENCE
  6573         ELSE
  6574             COMPUTE UNEARNED-AMT-AH ROUNDED =
  6575              ((UNEXPIRED-MONTHS * CR-AHAMT) / +100) *
  6576                CP-PREMIUM-RATE.
  6577
  6578     COMPUTE UNEARNED-AMT-AH ROUNDED =
  6579                           UNEARNED-AMT-AH * FACTOR-C.
  6580
  6581     IF GROUP-INS
  6582         ADD UNEARNED-AMT-AH TO EARN-PREM (CL  TG  4)
  6583     ELSE
  6584         ADD UNEARNED-AMT-AH TO EARN-PREM (CL  TG  9).
  6585 4940-EXIT.
  6586     EXIT.
  6587
  6588 4945-CALC-UNEARNED-PREMIUM.
  6589
  6590     MOVE CR-DT TO DC-GREG-DATE-CYMD.
  6591     MOVE 'L' TO DC-OPTION-CODE.
  6592     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 138
* ECS150.cbl
  6593                  8599-DATE-CONVERT-X.
  6594     MOVE DC-BIN-DATE-1 TO CP-CERT-EFF-DT
  6595     MOVE DTE-R78 TO CP-R78-OPTION
  6596     MOVE SPACES TO CP-ACCT-FLD-5
  6597     MOVE DTE-CLIENT TO CP-COMPANY-ID
  6598     IF CR-AGE NOT NUMERIC
  6599        MOVE +0 TO CR-AGE.
  6600     MOVE CR-AGE TO CP-ISSUE-AGE
  6601     IF CR-APR NOT NUMERIC
  6602        MOVE +0 TO CR-APR.
  6603     MOVE CR-APR TO CP-LOAN-APR
  6604
  6605     IF CR-PMT-FREQ IS NOT NUMERIC
  6606         MOVE ZEROS              TO  CP-PAY-FREQUENCY
  6607     ELSE
  6608         MOVE CR-PMT-FREQ        TO  CP-PAY-FREQUENCY.
  6609
  6610     IF CR-LOAN-TERM NOT NUMERIC
  6611        MOVE +0 TO CR-LOAN-TERM.
  6612     MOVE CR-LOAN-TERM TO CP-LOAN-TERM
  6613     MOVE SPACES         TO CP-DOMICILE-STATE
  6614     MOVE CR-CARRIER TO CP-CARRIER
  6615     IF CR-RATING-CLASS NOT = SPACES AND ZERO
  6616        MOVE CR-RATING-CLASS TO CP-CLASS-CODE
  6617     ELSE
  6618        MOVE AM-CAL-TABLE TO CP-CLASS-CODE.
  6619
  6620     MOVE STATE-SUB (CLAS-INDEXS) TO CP-STATE
  6621     MOVE STATE-ABBR (CLAS-INDEXS) TO CP-STATE-STD-ABBRV
  6622     MOVE DTE-CLASIC-COMPANY-CD TO CP-COMPANY-CD
  6623
  6624     CALL 'ELUPRMX'  USING CALCULATION-PASS-AREA.
  6625
  6626 4945-AH-EXIT.
  6627     EXIT.
  6628
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 139
* ECS150.cbl
  6630 4945-ERROR-AH.
  6631
  6632     DISPLAY 'ERROR OCCURED IN AH UNEARNED ROUTINE'
  6633     DISPLAY 'CP RETURN CODE ...' CP-RETURN-CODE.
  6634     GO TO ABEND-PGM.
  6635
  6636 4950-CHECK-AH-ISSUE.
  6637
  6638     IF EFFECTIVE-BOTH-PER
  6639         GO TO 4970-CHECK-CANCEL.
  6640
  6641     IF CR-ENTRY-STATUS = '3' OR '5'
  6642         GO TO 4970-CHECK-CANCEL.
  6643
  6644     IF SUMMARY-REC
  6645         MOVE CR-LIVES           TO COUNT-WORK.
  6646
  6647     MOVE '1'                    TO AH-ISSUE.
  6648     ADD COUNT-WORK TO ISSUE-CNT (CL  TG  IY).
  6649     ADD CR-AHPRM TO EARN-PREM (CL  TG  IY).
  6650     ADD CR-AHPRM TO ISSUE-PREM (CL  TG  IY).
  6651
  6652 4970-CHECK-CANCEL.
  6653     IF SUMMARY-REC AND
  6654        (SUM-CANCEL-DATE NOT GREATER PERIOD-END) AND
  6655        (SUM-CANCEL-DATE GREATER PERIOD-START) AND
  6656        (CR-SUM-CAN-CNT-YTD NOT = ZERO)
  6657         NEXT SENTENCE
  6658       ELSE
  6659        IF LUMP-SUM AND
  6660           (CLAIM-EXIT-DATE NOT GREATER PERIOD-END) AND
  6661           (CLAIM-EXIT-DATE NOT LESS PERIOD-START)
  6662            NEXT SENTENCE
  6663         ELSE
  6664            IF (CANCEL-EXIT-DATE = ZERO OR LOW-VALUES) OR
  6665               CANCEL-EXIT-DATE > PERIOD-END
  6666                GO TO 4980-CHECK-CLAIM.
  6667
  6668     MOVE '1'                TO AH-CANC.
  6669
  6670     MULTIPLY CR-AHRFND BY -1 GIVING UNEARNED-AMT-AH.
  6671     MOVE '1'                    TO AH-CANC.
  6672     MOVE CR-AHRFND              TO PRT-CANC-AMT-AH.
  6673     ADD UNEARNED-AMT-AH TO EARN-PREM (CL  TG  IY).
  6674
  6675     IF CR-AH-STATUS-AT-CANCEL NOT = SPACES
  6676         ADD COUNT-WORK TO     CANCEL-CNT (CL  TG  IY).
  6677
  6678     ADD CR-AHRFND TO     CANCEL-PREM (CL  TG  IY).
  6679
  6680 4980-CHECK-CLAIM.
  6681     IF CR-DISAMT-YTD = ZERO
  6682         GO TO 4999-PRINT.
  6683
  6684     MOVE '1'                    TO AH-CLAIM.
  6685     MOVE CR-DISAMT-YTD          TO PRT-CLAIM-AMT-AH.
  6686
  6687     MOVE CR-DIS-CC              TO WS-CR-DIS-CCYY(1:2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 140
* ECS150.cbl
  6688     MOVE CR-DIS-YR              TO WS-CR-DIS-CCYY(3:2).
  6689     ADD COUNT-WORK    TO CLAIM-CNT (CL TG IY).
  6690     ADD CR-DISAMT-YTD TO CLAIM-AMT (CL TG IY).
  6691     COMPUTE TERM-WORK = (WS-CR-DIS-CCYY * 12) + CR-DIS-MO.
  6692
  6693     IF TERM-WORK LESS THAN PERIOD-START-9
  6694         ADD CR-DISAMT-YTD TO AH-PAID-LAST-YR (CL)
  6695     ELSE
  6696         ADD CR-DISAMT-YTD TO AH-PAID-THIS-YR (CL).
  6697
  6698     MULTIPLY CR-AHRFND BY -1 GIVING UNEARNED-AMT-AH.
  6699
  6700 4999-PRINT.
  6701
  6702     IF PRT-LF-ISSUE OR
  6703        PRT-AH-ISSUE
  6704         MOVE 'ISSUE'            TO DL-ACTIVITY
  6705         MOVE PRT-ISSUE-AMT-LF   TO DL-RSRV-AMT
  6706         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6707
  6708     IF PRT-LF-DECR
  6709         MOVE 'DECR '            TO DL-ACTIVITY
  6710         MOVE PRT-DECR-AMT-LF    TO DL-RSRV-AMT
  6711         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6712
  6713     IF PRT-LF-CANC AND
  6714        PRT-AH-CANC
  6715             MOVE '1'                TO LF-REFUND-SW
  6716             MOVE 'CANC '            TO DL-ACTIVITY
  6717             MOVE '1'                TO AH-REFUND-SW
  6718             ADD PRT-CANC-AMT-AH     TO PRT-CANC-AMT-LF
  6719             MOVE PRT-CANC-AMT-LF    TO DL-RSRV-AMT
  6720             PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT
  6721             GO TO 4999-NEXT-PRINT.
  6722
  6723     IF PRT-LF-CANC
  6724             MOVE '1'                TO LF-REFUND-SW
  6725             MOVE 'CANC '            TO DL-ACTIVITY
  6726             MOVE PRT-CANC-AMT-LF    TO DL-RSRV-AMT
  6727             PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6728
  6729     IF PRT-AH-CANC
  6730             MOVE '1'                TO AH-REFUND-SW
  6731             MOVE 'CANC '            TO DL-ACTIVITY
  6732             MOVE PRT-CANC-AMT-AH    TO DL-RSRV-AMT
  6733             PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6734
  6735 4999-NEXT-PRINT.
  6736     IF PRT-LF-INCR
  6737         MOVE 'INCR '            TO DL-ACTIVITY
  6738         MOVE PRT-INCR-AMT-LF    TO DL-RSRV-AMT
  6739         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6740
  6741     IF PRT-LF-EXPIRY
  6742         MOVE 'EXP  '            TO DL-ACTIVITY
  6743         MOVE PRT-EXPIRY-AMT-LF   TO DL-RSRV-AMT
  6744         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6745
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 141
* ECS150.cbl
  6746     IF PRT-LF-DEATH
  6747         MOVE 'DEATH'            TO DL-ACTIVITY
  6748         MOVE PRT-DEATH-AMT-LF   TO DL-RSRV-AMT
  6749         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6750
  6751     IF PRT-LF-LUMP
  6752         MOVE 'LUMP '            TO DL-ACTIVITY
  6753         MOVE PRT-CANC-AMT-LF    TO DL-RSRV-AMT
  6754         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6755
  6756     IF PRT-AH-CLAIM
  6757         MOVE 'DISAB'            TO DL-ACTIVITY
  6758         MOVE PRT-CLAIM-AMT-AH   TO DL-RSRV-AMT
  6759         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6760
  6761 4999-ADVN-TOTALS.
  6762
  6763     IF CR-LFTYP = ZERO
  6764         GO TO 4000-EXIT.
  6765
  6766     MOVE SAV-LF-TERM-CODE       TO TG.
  6767
  6768     COMPUTE GROUP-CNT (CL TG 3) =
  6769                            GROUP-CNT (CL TG 1)
  6770                          + GROUP-CNT (CL TG 2).
  6771     COMPUTE GROUP-AMT (CL TG 3) =
  6772                            GROUP-AMT (CL TG 1)
  6773                          + GROUP-AMT (CL TG 2).
  6774     COMPUTE GROUP-AMT (CL TG 8) =
  6775                            GROUP-AMT (CL TG 3)
  6776                          - GROUP-AMT (CL TG 9).
  6777     COMPUTE GROUP-AMT (CL TG 7) =
  6778                            GROUP-AMT (CL TG 8)
  6779                          - GROUP-AMT (CL TG 4)
  6780                          - GROUP-AMT (CL TG 5)
  6781                          - GROUP-AMT (CL TG 6).
  6782
  6783     COMPUTE GROUP-CNT (CL TG 5) =
  6784                            GROUP-CNT (CL TG 3)
  6785                          - GROUP-CNT (CL TG 9)
  6786                          - GROUP-CNT (CL TG 4)
  6787                          - GROUP-CNT (CL TG 6).
  6788
  6789     IF GROUP-CNT (CL TG 5) GREATER THAN ZEROS
  6790         COMPUTE GROUP-AMT (CL TG 5) =
  6791                            GROUP-AMT (CL TG 3)
  6792                          - GROUP-AMT (CL TG 9)
  6793                          - GROUP-AMT (CL TG 4)
  6794                          - GROUP-AMT (CL TG 6)
  6795                          - GROUP-AMT (CL TG 7).
  6796
  6797     IF GROUP-CNT (CL TG 5) LESS THAN ZERO
  6798         MOVE ZEROS TO GROUP-CNT (CL TG 5).
  6799
  6800     COMPUTE GROUP-CNT (CL TG 8) =
  6801                            GROUP-CNT (CL TG 4)
  6802                          + GROUP-CNT (CL TG 5)
  6803                          + GROUP-CNT (CL TG 6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 142
* ECS150.cbl
  6804     COMPUTE IND-CNT (CL TG 3) =
  6805                            IND-CNT (CL TG 1)
  6806                          + IND-CNT (CL TG 2).
  6807     COMPUTE IND-AMT (CL TG 3) =
  6808                            IND-AMT (CL TG 1)
  6809                          + IND-AMT (CL TG 2).
  6810     COMPUTE IND-AMT (CL TG 8) =
  6811                            IND-AMT (CL TG 3)
  6812                          - IND-AMT (CL TG 9).
  6813     COMPUTE IND-AMT (CL TG 7) =
  6814                            IND-AMT (CL TG 8)
  6815                          - IND-AMT (CL TG 4)
  6816                          - IND-AMT (CL TG 5)
  6817                          - IND-AMT (CL TG 6).
  6818
  6819     COMPUTE IND-CNT (CL TG 5) =
  6820                            IND-CNT (CL TG 3)
  6821                          - IND-CNT (CL TG 9)
  6822                          - IND-CNT (CL TG 4)
  6823                          - IND-CNT (CL TG 6).
  6824     IF IND-CNT (CL TG 5) GREATER THAN ZEROS
  6825         COMPUTE IND-AMT (CL TG 5) =
  6826                            IND-AMT (CL TG 3)
  6827                          - IND-AMT (CL TG 9)
  6828                          - IND-AMT (CL TG 4)
  6829                          - IND-AMT (CL TG 6)
  6830                          - IND-AMT (CL TG 7).
  6831
  6832     IF IND-CNT (CL TG 5) LESS THAN ZERO
  6833         MOVE ZEROS TO IND-CNT (CL TG 5).
  6834
  6835     COMPUTE IND-CNT (CL TG 8) =
  6836                            IND-CNT (CL TG 4)
  6837                          + IND-CNT (CL TG 5)
  6838                          + IND-CNT (CL TG 6).
  6839 4000-EXIT.
  6840     EXIT.
  6841
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 143
* ECS150.cbl
  6843 5000-PRINT-ROUTINES     SECTION 30.
  6844
  6845 5100-PRINT-DETAIL.
  6846     IF DTE-PGM-OPT NOT = 1
  6847         GO TO 5100-EXIT.
  6848
  6849     IF FIRST-INS-PASS AND REINSURANCE-REC
  6850         GO TO 5100-EXIT.
  6851
  6852     IF LINE-CNT GREATER THAN +53
  6853         PERFORM 5500-PRINT-HEADING THRU 5500-EXIT.
  6854
  6855     IF FIRST-DETAIL-DONE
  6856         MOVE DETAIL-LINE-1      TO P-DATA
  6857         MOVE SPACE              TO X
  6858         PERFORM 5900-PRINT
  6859         MOVE SPACES             TO DETAIL-LINE-1
  6860         ADD +1 TO LINE-CNT
  6861         GO TO 5100-EXIT.
  6862
  6863     MOVE CR-CERT                TO DL-CERT-NO.
  6864     MOVE CR-CERT-SFX            TO DL-CERT-SUFX.
  6865     MOVE CR-DA                  TO XDD OF FORMAT-DATE.
  6866     MOVE CR-MO                  TO XMM OF FORMAT-DATE.
  6867     MOVE CR-YR                  TO XYY OF FORMAT-DATE.
  6868     MOVE EDITED-DATE            TO DL-ISSUE-DT.
  6869     MOVE CR-AH-TERM             TO DL-AH-TERM.
  6870     MOVE CR-LF-TERM             TO DL-LF-TERM.
  6871
  6872     IF CR-IND-GRP = '2'
  6873         MOVE 'GP '              TO DL-TYPE
  6874     ELSE
  6875         MOVE 'IND'              TO DL-TYPE.
  6876
  6877     MOVE SPACE                  TO DL-PLAN.
  6878     MOVE CLAS-I-AB3 (CLAS-INDEXL)
  6879                                 TO DL-PLAN.
  6880     MOVE CR-LFAMT               TO DL-ORIG-AMT.
  6881
  6882     IF OB-COVERAGE OR SUMMARY-REC
  6883          MOVE CR-LFAMT          TO DL-ORIG-AMT.
  6884
  6885     IF PRT-LF-REFUND
  6886         MOVE CR-LFRFND          TO DL-LF-PREM
  6887     ELSE
  6888         MOVE CR-LFPRM           TO DL-LF-PREM.
  6889
  6890     IF PRT-AH-REFUND
  6891         MOVE CR-AHRFND          TO DL-AH-PREM
  6892     ELSE
  6893         MOVE CR-AHPRM           TO DL-AH-PREM.
  6894
  6895     MOVE SPACE                  TO X.
  6896     MOVE DETAIL-LINE-1          TO P-DATA.
  6897     PERFORM 5900-PRINT.
  6898     MOVE SPACES                 TO DETAIL-LINE-1.
  6899     MOVE 1                      TO PRINT-CNTRL.
  6900     ADD +1 TO LINE-CNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 144
* ECS150.cbl
  6901
  6902 5100-EXIT.
  6903     EXIT.
  6904
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 145
* ECS150.cbl
  6906 5200-PRINT-SUMMARY-TOTALS    SECTION 40.
  6907     IF DTE-PGM-OPT NOT = 1
  6908         PERFORM 5500-PRINT-HEADING THRU 5500-EXIT
  6909     ELSE
  6910         IF LINE-CNT NOT LESS THAN +44
  6911             PERFORM 5500-PRINT-HEADING THRU 5500-EXIT.
  6912
  6913     ADD 60 TO LINE-CNT.
  6914     MOVE '    SUMMARY TOTALS   ' TO HL-MESSAGE.
  6915     MOVE HEAD-LINE-6            TO P-DATA.
  6916     MOVE '0'                    TO X.
  6917     PERFORM 5900-PRINT.
  6918
  6919     MOVE SPACE                  TO X.
  6920     MOVE HEAD-LINE-8A           TO P-DATA.
  6921     PERFORM 5900-PRINT.
  6922
  6923     MOVE HEAD-LINE-8B           TO P-DATA.
  6924     PERFORM 5900-PRINT.
  6925     MOVE HEAD-LINE-8C           TO P-DATA.
  6926     PERFORM 5900-PRINT.
  6927
  6928     IF REINSURANCE-PASS
  6929         MOVE +5                 TO CL
  6930     ELSE
  6931         MOVE +2                 TO CL.
  6932
  6933     PERFORM 5300-ADD-TERMS THRU 5300-EXIT
  6934         VARYING TG FROM +1 BY +1
  6935             UNTIL TG GREATER THAN +3.
  6936
  6937     MOVE 'GROUP   0-60    '     TO DL-DESCRIP.
  6938     MOVE 1                      TO TG.
  6939     MOVE 5                      TO IY.
  6940     PERFORM 5240-BUILD-SUMMARY.
  6941
  6942     MOVE 'GROUP   61-120  '     TO DL-DESCRIP.
  6943     MOVE 2                      TO TG.
  6944     PERFORM 5240-BUILD-SUMMARY.
  6945
  6946     MOVE 'GROUP   GTR 120 '     TO DL-DESCRIP.
  6947     MOVE 3                      TO TG
  6948     PERFORM 5240-BUILD-SUMMARY.
  6949
  6950     MOVE 1                      TO TG.
  6951     MOVE 10                     TO IY.
  6952     MOVE 'INDV    0-60    '     TO DL-DESCRIP.
  6953     PERFORM 5240-BUILD-SUMMARY
  6954
  6955     MOVE 2                      TO TG.
  6956     MOVE 'INDV    61-120  '     TO DL-DESCRIP.
  6957     PERFORM 5240-BUILD-SUMMARY.
  6958
  6959     MOVE 3                      TO TG.
  6960     MOVE 'INDV    GTR 120 '     TO DL-DESCRIP.
  6961     PERFORM 5240-BUILD-SUMMARY.
  6962
  6963 5200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 146
* ECS150.cbl
  6964     EXIT.
  6965
  6966 5240-BUILD-SUMMARY.
  6967     MOVE ISSUE-CNT   (CL  TG  IY) TO DL-ISS-CNT.
  6968     MOVE ISSUE-AMT   (CL  TG  IY) TO DL-ISS-AMT.
  6969     MOVE ISSUE-PREM  (CL  TG  IY) TO DL-ISS-PRM.
  6970     MOVE CANCEL-CNT  (CL  TG  IY) TO DL-CAN-CNT.
  6971     MOVE CANCEL-AMT  (CL  TG  IY) TO DL-CAN-AMT.
  6972     MOVE CANCEL-PREM (CL  TG  IY) TO DL-CAN-PRM.
  6973     MOVE CLAIM-CNT   (CL  TG  IY) TO DL-CLM-CNT.
  6974     MOVE CLAIM-AMT   (CL  TG  IY) TO DL-CLM-AMT.
  6975     MOVE EARN-PREM   (CL  TG  IY) TO DL-EARN-AMT.
  6976     MOVE DETAIL-LINE-2            TO P-DATA.
  6977     PERFORM 5900-PRINT.
  6978
  6979 5300-ADD-TERMS.
  6980     MOVE +5                     TO LA.
  6981
  6982     PERFORM 5350-ADD-GRPS THRU 5350-EXIT
  6983         VARYING IY FROM 1 BY 1
  6984             UNTIL IY GREATER THAN +4.
  6985
  6986     MOVE +10 TO LA.
  6987
  6988     PERFORM 5350-ADD-GRPS THRU 5350-EXIT
  6989         VARYING IY FROM 6 BY 1
  6990             UNTIL IY GREATER THAN +9.
  6991
  6992 5300-EXIT.
  6993     EXIT.
  6994
  6995 5350-ADD-GRPS.
  6996     ADD CORRESPONDING INSURANCE-TYPES (CL  TG  IY) TO
  6997                       INSURANCE-TYPES (CL  TG  LA).
  6998
  6999 5350-EXIT.
  7000     EXIT.
  7001
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 147
* ECS150.cbl
  7003 5500-PRINT-HEADING      SECTION 30.
  7004     MOVE 0                      TO LINE-CNT.
  7005     ADD +1 TO PAGE-CNT.
  7006     MOVE LAST-CARRIER           TO HL-CARRIER.
  7007     MOVE LAST-GROUPING          TO HL-COMPANY.
  7008     MOVE PAGE-CNT               TO HL-PAGENO.
  7009     MOVE LAST-ACCOUNT           TO HL-ACCOUNT.
  7010     MOVE LAST-REINS-CO          TO HL-REIN-CO.
  7011     MOVE LAST-STATE             TO STATE-L.
  7012
  7013 5510-STATE-LOOKUP.
* 7014                             COPY ECSSTLOK.
  7015******************************************************************07/10/97
  7016*                                                                *ECSSTLOK
  7017*                            ECSSTLOK                            *   LV001
  7018*                            VMOD=2.001                         * ECSSTLOK
  7019*                                                                *ECSSTLOK
  7020*  NO  CID  MODS  IN  COPYBOOK  ECSSTLOK                         *ECSSTLOK
  7021*                                                                *ECSSTLOK
  7022******************************************************************ECSSTLOK
  7023 STATE--START.                                                    ECSSTLOK
  7024     MOVE ZERO TO CLAS-INDEXS.                                    ECSSTLOK
  7025                                                                  ECSSTLOK
  7026 STATE--LOOP.                                                     ECSSTLOK
  7027     ADD 1 TO CLAS-INDEXS.                                        ECSSTLOK
  7028     IF CLAS-INDEXS IS GREATER THAN CLAS-MAXS                     ECSSTLOK
  7029         MOVE SPACE TO STATE-L                                    ECSSTLOK
  7030         GO TO STATE--EXIT.                                       ECSSTLOK
  7031                                                                  ECSSTLOK
  7032     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)                     ECSSTLOK
  7033         GO TO STATE--LOOP.                                       ECSSTLOK
  7034                                                                  ECSSTLOK
  7035 STATE--EXIT.                                                     ECSSTLOK
  7036     EXIT.
  7037******************************************************************ECSSTLOK
  7038
  7039     IF STATE-L = SPACE
  7040         MOVE SPACE              TO HL-STATE
  7041     ELSE
  7042         MOVE STATE-PIC (CLAS-INDEXS) TO HL-STATE.
  7043
  7044     MOVE '1'                    TO X.
  7045     MOVE HEAD-LINE-1            TO P-DATA.
  7046     PERFORM 5900-PRINT.
  7047
  7048     MOVE SPACE                  TO X.
  7049     MOVE HEAD-LINE-2            TO P-DATA.
  7050     PERFORM 5900-PRINT.
  7051
  7052     MOVE HEAD-LINE-3            TO P-DATA.
  7053     PERFORM 5900-PRINT.
  7054
  7055     MOVE HEAD-LINE-4            TO P-DATA.
  7056     PERFORM 5900-PRINT.
  7057
  7058     IF REINSURANCE-PASS
  7059         MOVE HEAD-LINE-5        TO P-DATA
  7060         PERFORM 5900-PRINT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 148
* ECS150.cbl
  7061
  7062     IF DTE-PGM-OPT NOT = 1
  7063         MOVE ' NO DETAIL GENERATED ' TO HL-MESSAGE
  7064         MOVE HEAD-LINE-6        TO P-DATA
  7065         PERFORM 5900-PRINT
  7066     ELSE
  7067         MOVE '0'                TO X
  7068         MOVE HEAD-LINE-7A       TO P-DATA
  7069         PERFORM 5900-PRINT
  7070         MOVE SPACE              TO X
  7071         MOVE HEAD-LINE-7B       TO P-DATA
  7072         PERFORM 5900-PRINT.
  7073
  7074 5500-EXIT.
  7075     EXIT.
  7076
  7077 5900-PRINT.
* 7078                             COPY ELCPRT2.
  7079******************************************************************04/15/98
  7080*                                                                *ELCPRT2
  7081*                                                                *ELCPRT2
  7082*                            ELCPRT2                             *   LV005
  7083*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  7084*                            VMOD=2.002                          *   CL**5
  7085*                                                                *   CL**4
  7086******************************************************************   CL**4
  7087                                                                     CL**4
  7088     IF DTE-FICH NOT = SPACE AND                                     CL**4
  7089        FICH-OPEN    = SPACE                                         CL**4
  7090         MOVE 'X'                TO  FICH-OPEN                       CL**4
  7091         OPEN OUTPUT FICH.                                           CL**4
  7092                                                                     CL**4
  7093     IF DTE-FICH NOT = SPACE                                         CL**4
  7094         MOVE X                  TO  P-CTL                           CL**4
  7095         WRITE FICH-REC FROM PRT.                                    CL**4
  7096                                                                     CL**4
  7097     IF DTE-FICH = SPACE OR '2'                                      CL**4
  7098       MOVE X                    TO  P-CTL                           CL**4
  7099       IF P-CTL = ' '                                                CL**4
  7100         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  7101       ELSE                                                          CL**4
  7102         IF P-CTL = '0'                                              CL**4
  7103           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  7104         ELSE                                                        CL**4
  7105           IF P-CTL = '-'                                            CL**4
  7106             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  7107           ELSE                                                      CL**4
  7108             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  7109                                                                     CL**4
  7110******************************************************************   CL**4
  7111
  7112 5900-EXIT.
  7113     EXIT.
  7114
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 149
* ECS150.cbl
  7116 6000-REINSURANCE-CALC   SECTION 35.
  7117     IF CR-REIN-TABLE = SPACES OR ZEROS
  7118         GO TO 6000-EXIT.
  7119
  7120     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
  7121     MOVE CR-REIN-TABLE          TO REIN-SRCH.
  7122
  7123*    IF REIN-SRCH = 'EBM'
  7124*       MOVE 'EBO'               TO REIN-SRCH
  7125*    END-IF
  7126*    IF REIN-SRCH = 'R01'
  7127*       MOVE 'R99'               TO REIN-SRCH
  7128*    END-IF
  7129
  7130     PERFORM RR-READ-REIN THRU RR-READ-REIN-X.
  7131
  7132 REINSURE-ROUTINE-GET-CALC.
* 7133                             COPY ECSRTPFM.
  7134******************************************************************07/10/97
  7135*                                                                *ECSRTPFM
  7136*                            ECSRTPFM                            *   LV001
  7137*                            VMOD=2.002                          *ECSRTPFM
  7138*                                                                *ECSRTPFM
  7139******************************************************************ECSRTPFM
  7140                                                                  ECSRTPFM
  7141     IF    CR-LFAMT  NUMERIC                                      00000072
  7142           NEXT SENTENCE                                          00000073
  7143        ELSE                                                      00000074
  7144           MOVE ZEROS TO CR-LFAMT.                                00000075
  7145                                                                  00000076
  7146     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
  7147           NEXT SENTENCE                                          00000078
  7148        ELSE                                                      00000079
  7149           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
  7150                                                                  00000081
  7151                                                                  00000082
  7152     IF    CR-LFPRM  NUMERIC                                      00000083
  7153           NEXT SENTENCE                                          00000084
  7154        ELSE                                                      00000085
  7155           MOVE ZEROS TO CR-LFPRM.                                00000086
  7156                                                                  00000087
  7157     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
  7158           NEXT SENTENCE                                          00000089
  7159        ELSE                                                      00000090
  7160           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
  7161                                                                  00000092
  7162                                                                  00000093
  7163     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
  7164           NEXT SENTENCE                                          00000095
  7165        ELSE                                                      00000096
  7166           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
  7167                                                                  00000098
  7168     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
  7169           NEXT SENTENCE                                          00000100
  7170        ELSE                                                      00000101
  7171           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
  7172                                                                  00000103
  7173     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 150
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
  7174           NEXT SENTENCE                                          00000105
  7175        ELSE                                                      00000106
  7176           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
  7177                                                                  00000108
  7178     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
  7179     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
  7180     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
  7181         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
  7182     ELSE                                                         ECSRTPFM
  7183         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
  7184     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
  7185                                                                  ECSRTPFM
  7186     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
  7187     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
  7188     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
  7189         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
  7190     ELSE                                                         ECSRTPFM
  7191         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
  7192     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
  7193                                                                  ECSRTPFM
  7194     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
  7195         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
  7196             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
  7197                                                                  ECSRTPFM
  7198
  7199 REINSURE-ROUTINE-SKIP-1.
  7200     PERFORM REINSURE-CANCEL THRU REINSURE-CANCEL-X.
  7201     PERFORM REINSURE-CLAIM THRU REINSURE-CLAIM-X.
  7202     MOVE SPACES                 TO RC-REC.
  7203     MOVE CR-FULL-CONTROL        TO RC-CMCTL.
  7204     MOVE CR-LFAMT               TO RC-ORIG-LFAMT.
  7205     MOVE CR-LFAMT-ALT           TO RC-LFAMT-ALT.
  7206     MOVE CR-LF-TERM             TO RC-LF-TERM.
  7207     MOVE CR-LF-TERM-IN-DAYS     TO RC-LF-TERM-IN-DAYS.
  7208     MOVE CR-AH-TERM             TO RC-AH-TERM.
  7209     MOVE CR-ENTRY-STATUS        TO RC-ENTRY-STATUS.
  7210     MOVE CR-LF-CURRENT-STATUS   TO RC-LF-CURRENT-STATUS.
  7211     MOVE CR-AH-CURRENT-STATUS   TO RC-AH-CURRENT-STATUS.
  7212     MOVE CR-LFTYP               TO RC-LFTYP.
  7213     MOVE CR-AHTYP               TO RC-AHTYP.
  7214     MOVE CR-IND-GRP             TO RC-IND-GRP.
  7215     MOVE CR-LF-CANC-DT          TO RC-LF-CANC-DT.
  7216     MOVE CR-AH-CANC-DT          TO RC-AH-CANC-DT.
  7217     MOVE CR-DIS-DT              TO RC-DIS-DT.
  7218     MOVE CR-ENTRY-DATE          TO RC-ENT-DT.
  7219     MOVE CR-LF-status-at-cancel TO RC-LF-cancel-status
  7220     MOVE CR-ah-status-at-cancel TO RC-ah-cancel-status
  7221     MOVE CR-LF-CANCEL-EXIT-DATE TO RC-LF-CANC-EXIT.
  7222     MOVE CR-AH-CANCEL-EXIT-DATE TO RC-AH-CANC-EXIT.
  7223     MOVE CR-LF-CLAIM-EXIT-DATE  TO RC-LF-CLAIM-EXIT.
  7224     MOVE CR-AH-SETTLEMENT-EXIT-DATE
  7225                                 TO RC-AH-CLAIM-EXIT.
  7226     MOVE CR-PMT-FREQ            TO RC-PMT-FREQ.
  7227     MOVE CR-APR                 TO RC-APR.
  7228     MOVE CR-LOAN-TERM           TO RC-LOAN-TERM.
  7229     MOVE CR-IND-GRP             TO RC-IND-GRP.
  7230     MOVE CR-LIVES               TO RC-I-LIVES.
  7231     MOVE CR-SUM-CAN-CNT-YTD     TO RC-C-LIVES-YTD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 151
* ECS150.cbl
  7232     MOVE CR-SUM-CAN-CNT-ITD     TO RC-C-LIVES-ITD.
  7233     MOVE CR-LFRFND-CALC         TO RC-LFRFND-YTD.
  7234     MOVE CR-AHRFND-CALC         TO RC-AHRFND-YTD.
  7235     MOVE CR-LF-EXPIRE-DATE      TO RC-LF-EXPIRE-DT.
  7236     MOVE CR-AH-EXPIRE-DATE      TO RC-AH-EXPIRE-DT.
  7237     MOVE CR-LOAN-1ST-PMT-DT     TO RC-LOAN-1ST-PMT-DT.
  7238     MOVE RC-REC                 TO SAVE-REINS-CERT.
  7239     GO TO 6000-EXIT.
  7240
  7241 RR-READ-REIN.
  7242     IF REIN-OPEN-SW = ' '
  7243         MOVE LOW-VALUES         TO RE-KEY
  7244         MOVE 'X'                TO REIN-OPEN-SW
  7245         MOVE 'A'                TO REIN-SRCH-CODE
  7246         OPEN INPUT ERRTBL-IN
  7247         IF ERRTBL-FILE-STATUS = '00' OR '97'
  7248             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
  7249          ELSE
  7250             MOVE '21'           TO ABEND-FILE-ID
  7251             MOVE ERRTBL-FILE-STATUS
  7252                                 TO ABEND-REASON
  7253             GO TO ABEND-PGM.
  7254
  7255     IF REIN-SRCH NOT = SAVE-REIN-SRCH
  7256         MOVE LOW-VALUES         TO RE-KEY
  7257         MOVE DTE-CLASIC-COMPANY-CD
  7258                                 TO RE-COMPANY-CD
  7259         MOVE REIN-SRCH          TO SAVE-REIN-SRCH
  7260                                    RE-TABLE
  7261         MOVE REIN-SRCH-CODE     TO RE-CODE
  7262         READ ERRTBL-IN
  7263         IF ERRTBL-FILE-STATUS NOT = '00'
  7264             DISPLAY 'INVALID REINSURANCE TABLE CODE - '
  7265                 RE-TABLE ' ' CR-ACCT-CONTROL
  7266             MOVE '24'            TO ABEND-FILE-ID
  7267             MOVE ERRTBL-FILE-STATUS
  7268                                 TO ABEND-REASON
  7269             GO TO ABEND-PGM.
  7270
  7271     IF RE-CODE NOT = 'A'
  7272        PERFORM REIN-DATE-LOAD.
  7273
  7274 RR-READ-REIN-X.
  7275     EXIT.
  7276
  7277 REINSURE-CANCEL.
  7278     IF REIN-COMP (1) = SPACES
  7279         GO TO REINSURE-CANCEL-X.
  7280
  7281     IF CR-LFRFND = ZERO AND
  7282        CR-AHRFND = ZERO
  7283         GO TO REINSURE-CANCEL-X.
  7284
  7285     PERFORM REINSURE-CALC-CANCEL
  7286             THRU REINSURE-CALC-CANCEL-X
  7287                 VARYING SUB1 FROM +1 BY +1
  7288                     UNTIL REIN-COMP (SUB1) = SPACES.
  7289
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 152
* ECS150.cbl
  7290 REINSURE-CANCEL-X.
  7291     EXIT.
  7292
  7293 REINSURE-CLAIM.
  7294     IF REIN-COMP (1) = SPACES
  7295         GO TO REINSURE-CLAIM-X.
  7296
  7297     MOVE CR-DTHAMT-YTD          TO RW-LFCLMWK.
  7298     MOVE CR-DISAMT-YTD          TO RW-AHCLMWK.
  7299     MOVE +0                     TO RW-LFCLM
  7300                                    RW-AHCLM.
  7301
  7302     IF RW-LFCLMWK = ZERO AND
  7303        RW-AHCLMWK = ZERO
  7304         GO TO REINSURE-CLAIM-X.
  7305
  7306     PERFORM REINSURE-CALC-CLAIM
  7307             THRU REINSURE-CALC-CLAIM-X
  7308                 VARYING SUB1 FROM +1 BY +1
  7309                     UNTIL REIN-COMP (SUB1) = SPACES.
  7310
  7311 REINSURE-CLAIM-X.
  7312     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 153
* ECS150.cbl
  7314
  7315 REINSURANCE-ROUTINES.
* 7316                             COPY ECSRIRTN.
  7317******************************************************************04/30/98
  7318*                                                                *ECSRIRTN
  7319*                            ECSRIRTN                            *   LV012
  7320*                            VMOD=2.025.                         *ECSRIRTN
  7321*                                                                *ECSRIRTN
  7322******************************************************************ECSRIRTN
  7323******************************************************************
  7324*                   C H A N G E   L O G
  7325*
  7326* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7327*-----------------------------------------------------------------
  7328*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7329* EFFECTIVE    NUMBER
  7330*-----------------------------------------------------------------
  7331* 062703                   PEMA  ADD DCC CLIENT ID TO
  7332*                                SPECIAL CEDED CLAIM CALC
  7333* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7334                                                                  ECSRIRTN
  7335 REINSURE-CALC.                                                   ECSRIRTN
  7336                                                                  ECSRIRTN
  7337     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
  7338     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  7339     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
  7340     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
  7341                                   REIN-REM-SW (SUB1).            ECSRIRTN
  7342                                                                  ECSRIRTN
  7343     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
  7344                                   WS-RWF-EP-STOP-DATE-N             CL*12
  7345                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
  7346                                                                  ECSRIRTN
  7347     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
  7348                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
  7349                                   RWF-AH-RUNOFF-SW               ECSRIRTN
  7350                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  7351                                                                  ECSRIRTN
  7352     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  7353        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  7354          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  7355          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  7356          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  7357                                                                  ECSRIRTN
  7358     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  7359        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  7360         GO TO CALC-CONTINUED.                                    ECSRIRTN
  7361                                                                  ECSRIRTN
  7362     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
  7363                                          WS-RWF-EP-STOP-DATE-N      CL*12
  7364                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
  7365                                                                  ECSRIRTN
  7366     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
  7367         GO TO CALC-CONTINUED.                                    ECSRIRTN
  7368                                                                  ECSRIRTN
  7369     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
  7370         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
  7371                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 154
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7372                                                                  ECSRIRTN
  7373     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
  7374         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
  7375                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  7376                                                                  ECSRIRTN
  7377 CALC-CONTINUED.                                                  ECSRIRTN
  7378                                                                  ECSRIRTN
  7379     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
  7380     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
  7381                                                                  ECSRIRTN
  7382     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
  7383         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
  7384     ELSE                                                         ECSRIRTN
  7385         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
  7386     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
  7387                                                                  ECSRIRTN
  7388     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
  7389     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
  7390     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
  7391         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
  7392     ELSE                                                         ECSRIRTN
  7393         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
  7394     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
  7395                                                                  ECSRIRTN
  7396     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
  7397         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
  7398         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
  7399         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
  7400         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
  7401         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
  7402         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
  7403                                                                  ECSRIRTN
  7404     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  7405         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
  7406                                                                  ECSRIRTN
  7407     IF CR-DT LESS WT-LO-DATE                                        CL**2
  7408         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  7409                                                                  ECSRIRTN
  7410     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
  7411         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  7412                                                                  ECSRIRTN
  7413     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
  7414     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
  7415                                                                  ECSRIRTN
  7416     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
  7417         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
  7418                                                                  ECSRIRTN
  7419     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
  7420       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  7421        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
  7422        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  7423           NEXT SENTENCE                                          ECSRIRTN
  7424       ELSE                                                       ECSRIRTN
  7425           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
  7426                       REIN-AH-FLG (SUB1).                        ECSRIRTN
  7427                                                                  ECSRIRTN
  7428     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  7429         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 155
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7430            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
  7431             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
  7432                                                                  ECSRIRTN
  7433     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  7434         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
  7435            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
  7436             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
  7437                                                                  ECSRIRTN
  7438     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
  7439         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
  7440             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
  7441                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
  7442             ELSE                                                 ECSRIRTN
  7443                 NEXT SENTENCE                                    ECSRIRTN
  7444         ELSE                                                     ECSRIRTN
  7445             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  7446                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  7447                                                                  ECSRIRTN
  7448     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
  7449         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
  7450             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
  7451                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
  7452             ELSE                                                 ECSRIRTN
  7453                 NEXT SENTENCE                                    ECSRIRTN
  7454         ELSE                                                     ECSRIRTN
  7455             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  7456                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  7457                                                                  ECSRIRTN
  7458     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
  7459         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
  7460                                                                  ECSRIRTN
  7461     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
  7462         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
  7463         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  7464                                                                  ECSRIRTN
  7465     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
  7466         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
  7467                                                                  ECSRIRTN
  7468     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
  7469         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
  7470         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
  7471                                                                  ECSRIRTN
  7472     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  7473         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  7474                                                                  ECSRIRTN
  7475     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  7476         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  7477                                                                  ECSRIRTN
  7478     GO TO REINSURE-CALC-X.                                       ECSRIRTN
  7479                                                                  ECSRIRTN
  7480 REINSURE-CK-LIFE.                                                ECSRIRTN
  7481                                                                  ECSRIRTN
  7482     IF CR-LFTYP = ZERO                                           ECSRIRTN
  7483         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7484                                                                  ECSRIRTN
  7485     IF WT-LF-PCT = ZERO                                          ECSRIRTN
  7486         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7487                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 156
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7488     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  7489         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
  7490             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7491                                                                  ECSRIRTN
  7492     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  7493                                                                  ECSRIRTN
  7494     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
  7495         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
  7496             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  7497         ELSE                                                     ECSRIRTN
  7498             NEXT SENTENCE                                        ECSRIRTN
  7499     ELSE                                                         ECSRIRTN
  7500         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
  7501             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7502                                                                  ECSRIRTN
  7503     IF CEDING-AD-D-ONLY                                          ECSRIRTN
  7504         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
  7505             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  7506         ELSE                                                     ECSRIRTN
  7507             NEXT SENTENCE                                        ECSRIRTN
  7508     ELSE                                                         ECSRIRTN
  7509         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
  7510             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7511                                                                  ECSRIRTN
  7512     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  7513         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
  7514             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7515                                                                  ECSRIRTN
  7516     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  7517         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
  7518            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7519                                                                  ECSRIRTN
  7520     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
  7521         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
  7522             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7523                                                                  ECSRIRTN
  7524     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
  7525         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
  7526            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7527                                                                  ECSRIRTN
  7528     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  7529         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  7530             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7531                                                                  ECSRIRTN
  7532     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
  7533         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  7534            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
  7535            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
  7536             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7537                                                                  ECSRIRTN
  7538     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
  7539         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  7540            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
  7541             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7542                                                                  ECSRIRTN
  7543     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  7544         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
  7545             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 157
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7546                                                                  ECSRIRTN
  7547     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  7548         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
  7549             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7550                                                                  ECSRIRTN
  7551     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
  7552        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
  7553           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
  7554            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7555                                                                  ECSRIRTN
  7556     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  7557         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  7558            CR-IND-GRP = '1'                                      ECSRIRTN
  7559             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7560                                                                  ECSRIRTN
  7561     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
  7562         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  7563            CR-IND-GRP = '1'                                      ECSRIRTN
  7564             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7565                                                                  ECSRIRTN
  7566     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
  7567         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  7568            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
  7569            CR-IND-GRP = '1'                                      ECSRIRTN
  7570             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7571                                                                  ECSRIRTN
  7572     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
  7573         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  7574            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  7575            CR-IND-GRP = '1'                                      ECSRIRTN
  7576             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7577                                                                  ECSRIRTN
  7578     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  7579         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
  7580            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7581                                                                  ECSRIRTN
  7582     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  7583        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
  7584                                                                  ECSRIRTN
  7585     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
  7586         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7587                                                                  ECSRIRTN
  7588     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
  7589         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7590                                                                  ECSRIRTN
  7591     IF CR-LF-TERM  NUMERIC                                       00002331
  7592        NEXT SENTENCE                                             00002332
  7593     ELSE                                                         00002333
  7594        MOVE ZEROS               TO CR-LF-TERM                    00002334
  7595     END-IF
  7596                                                                  00002335
  7597     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
  7598         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7599                                                                  ECSRIRTN
  7600     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
  7601         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7602                                                                  ECSRIRTN
  7603     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 158
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7604                                                                  ECSRIRTN
  7605     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
  7606         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7607                                                                  ECSRIRTN
  7608     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
  7609         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7610                                                                  ECSRIRTN
  7611     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  7612                                                                  ECSRIRTN
  7613 REINSURE-CK-LIFE-X.                                              ECSRIRTN
  7614     EXIT.                                                        ECSRIRTN
  7615                                                                  ECSRIRTN
  7616 REINSURE-CK-AH.                                                  ECSRIRTN
  7617                                                                  ECSRIRTN
  7618     IF CR-AHTYP = ZERO                                           ECSRIRTN
  7619         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7620                                                                  ECSRIRTN
  7621     IF WT-AH-PCT = ZERO                                          ECSRIRTN
  7622         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7623                                                                  ECSRIRTN
  7624     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  7625         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
  7626             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7627                                                                  ECSRIRTN
  7628     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  7629                                                                  ECSRIRTN
  7630     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
  7631         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
  7632             GO TO REINSURE-CK-AH-X                               ECSRIRTN
  7633         ELSE                                                     ECSRIRTN
  7634             NEXT SENTENCE                                        ECSRIRTN
  7635     ELSE                                                         ECSRIRTN
  7636         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
  7637             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7638                                                                  ECSRIRTN
  7639     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  7640         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
  7641             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7642                                                                  ECSRIRTN
  7643     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  7644         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
  7645             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7646                                                                  ECSRIRTN
  7647     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  7648         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
  7649             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7650                                                                  ECSRIRTN
  7651     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  7652         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  7653             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7654                                                                  ECSRIRTN
  7655     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  7656         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
  7657            CR-IND-GRP = '1'                                      ECSRIRTN
  7658             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7659                                                                  ECSRIRTN
  7660     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  7661         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 159
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7662             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7663                                                                  ECSRIRTN
  7664     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  7665         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
  7666            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  7667                                                                  ECSRIRTN
  7668     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
  7669         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
  7670            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  7671                                                                  ECSRIRTN
  7672     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
  7673         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
  7674             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7675                                                                  ECSRIRTN
  7676     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  7677        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
  7678                                                                  ECSRIRTN
  7679     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
  7680         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7681                                                                  ECSRIRTN
  7682     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
  7683         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7684                                                                  ECSRIRTN
  7685     IF CR-AH-TERM  NUMERIC                                       00002331
  7686        NEXT SENTENCE                                             00002332
  7687     ELSE                                                         00002333
  7688        MOVE ZEROS               TO CR-AH-TERM                    00002334
  7689     END-IF
  7690                                                                  00002335
  7691     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
  7692         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7693                                                                  ECSRIRTN
  7694     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
  7695         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7696                                                                  ECSRIRTN
  7697     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  7698                                                                  ECSRIRTN
  7699     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
  7700         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
  7701             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
  7702                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
  7703                                                                  ECSRIRTN
  7704     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
  7705         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
  7706             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
  7707                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
  7708                                                                  ECSRIRTN
  7709     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
  7710     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
  7711                                                                  ECSRIRTN
  7712     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
  7713         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
  7714                                                                  ECSRIRTN
  7715     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
  7716         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
  7717                                                                  ECSRIRTN
  7718     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
  7719                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 160
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7720     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  7721                                                                  ECSRIRTN
  7722     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
  7723         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7724                                                                  ECSRIRTN
  7725     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  7726         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7727                                                                  ECSRIRTN
  7728     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  7729                                                                  ECSRIRTN
  7730 REINSURE-CK-AH-X.                                                ECSRIRTN
  7731     EXIT.                                                        ECSRIRTN
  7732                                                                  ECSRIRTN
  7733 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
  7734                                                                  ECSRIRTN
  7735     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
  7736        RS-AH-BEN = ZERO                                          ECSRIRTN
  7737         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  7738                                                                  ECSRIRTN
  7739     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
  7740        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  7741         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  7742                                                                  ECSRIRTN
  7743     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
  7744                                    REIN-AH-FLG (SUB1).           ECSRIRTN
  7745                                                                  ECSRIRTN
  7746     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  7747         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  7748             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
  7749                                     WT-AHBEN-HI.                 ECSRIRTN
  7750     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  7751         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  7752             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
  7753                                     WT-AHMOA-HI.                 ECSRIRTN
  7754                                                                  ECSRIRTN
  7755     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  7756     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  7757                                                                  ECSRIRTN
  7758     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  7759         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
  7760                                                                  ECSRIRTN
  7761     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  7762         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
  7763                                                                  ECSRIRTN
  7764     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  7765                                                                  ECSRIRTN
  7766     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  7767         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
  7768                                                                  ECSRIRTN
  7769     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
  7770         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
  7771                                       / RW-AHWRK                 ECSRIRTN
  7772       ELSE                                                       ECSRIRTN
  7773         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
  7774                                                                  ECSRIRTN
  7775     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
  7776         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
  7777                                       / RS-LIFE-BEN              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 161
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7778       ELSE                                                       ECSRIRTN
  7779         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
  7780                                                                  ECSRIRTN
  7781     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
  7782        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
  7783          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  7784          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  7785                                      / CR-AH-TERM.               ECSRIRTN
  7786                                                                  ECSRIRTN
  7787     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  7788        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
  7789          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  7790          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  7791               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  7792            ELSE                                                  ECSRIRTN
  7793                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  7794                                                                  ECSRIRTN
  7795     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  7796        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
  7797        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
  7798          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  7799          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  7800                                      / CR-AH-TERM                ECSRIRTN
  7801         ELSE                                                     ECSRIRTN
  7802          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  7803          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  7804               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  7805            ELSE                                                  ECSRIRTN
  7806                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  7807                                                                  ECSRIRTN
  7808 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
  7809     EXIT.                                                        ECSRIRTN
  7810                                                                  ECSRIRTN
  7811                                                                  ECSRIRTN
  7812 REIN-CALC-LIFE.                                                  ECSRIRTN
  7813                                                                  ECSRIRTN
  7814     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
  7815         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
  7816     ELSE                                                         ECSRIRTN
  7817         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
  7818                                                                  ECSRIRTN
  7819     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
  7820         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
  7821     ELSE                                                         ECSRIRTN
  7822         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
  7823           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
  7824               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
  7825           ELSE                                                   ECSRIRTN
  7826               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
  7827                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
  7828                                                                  ECSRIRTN
  7829 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
  7830                                                                  ECSRIRTN
  7831     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
  7832                                                                  ECSRIRTN
  7833     IF WT-REMAINING = 'I'                                        ECSRIRTN
  7834         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
  7835                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 162
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7836     IF WT-REMAINING = 'L'                                        ECSRIRTN
  7837         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
  7838         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  7839                                                                  ECSRIRTN
  7840     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
  7841         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
  7842                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  7843         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
  7844                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  7845     ELSE                                                         ECSRIRTN
  7846         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  7847             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
  7848             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
  7849                                                                  ECSRIRTN
  7850     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
  7851         (WT-LF-QC = '2' AND                                         CL**8
  7852          PGM-SUB = +50  AND                                         CL**8
  7853          DTE-CLIENT = 'LAP'))                                       CL**8
  7854          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
  7855     ELSE                                                         ECSRIRTN
  7856         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
  7857                                                                  ECSRIRTN
  7858     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  7859         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
  7860         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
  7861         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
  7862                                                                  ECSRIRTN
  7863     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
  7864                                                                  ECSRIRTN
  7865 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
  7866                                                                  ECSRIRTN
  7867     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
  7868         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
  7869         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  7870                                                                  ECSRIRTN
  7871     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
  7872     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  7873     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
  7874                                       RW-LFPRM.                  ECSRIRTN
  7875                                                                  ECSRIRTN
  7876 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
  7877                                                                  ECSRIRTN
  7878     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
  7879                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  7880                                                                  ECSRIRTN
  7881     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  7882        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  7883                                                                  ECSRIRTN
  7884     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
  7885        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  7886         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
  7887     ELSE                                                         ECSRIRTN
  7888         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  7889         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
  7890                                                                  ECSRIRTN
  7891                                                                  ECSRIRTN
  7892 REIN-CALC-LIFE-X.                                                ECSRIRTN
  7893     EXIT.                                                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 163
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7894                                                                  ECSRIRTN
  7895 REIN-CALC-AH.                                                    ECSRIRTN
  7896                                                                  ECSRIRTN
  7897     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  7898         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  7899             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
  7900                                 WT-AHBEN-HI.                     ECSRIRTN
  7901                                                                  ECSRIRTN
  7902     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  7903         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  7904             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
  7905                                 WT-AHMOA-HI.                     ECSRIRTN
  7906                                                                  ECSRIRTN
  7907     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  7908     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  7909                                                                  ECSRIRTN
  7910     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  7911         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
  7912                                                                  ECSRIRTN
  7913     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  7914         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
  7915                                                                  ECSRIRTN
  7916     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  7917         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
  7918                                                                  ECSRIRTN
  7919     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
  7920         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
  7921     ELSE                                                         ECSRIRTN
  7922         IF WT-REMAINING = 'L'                                    ECSRIRTN
  7923             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
  7924         ELSE                                                     ECSRIRTN
  7925             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
  7926             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
  7927                                                                  ECSRIRTN
  7928 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
  7929                                                                  ECSRIRTN
  7930     IF WT-REMAINING = 'I'                                        ECSRIRTN
  7931         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
  7932                                                                  ECSRIRTN
  7933     IF WT-REMAINING = 'L'                                        ECSRIRTN
  7934         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
  7935         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  7936                                                                  ECSRIRTN
  7937     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
  7938         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
  7939                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  7940         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
  7941                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  7942     ELSE                                                         ECSRIRTN
  7943         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
  7944             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
  7945             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
  7946                                                                  ECSRIRTN
  7947     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
  7948         (WT-AH-QC = '2' AND                                         CL**8
  7949          PGM-SUB = +50  AND                                         CL**8
  7950          DTE-CLIENT = 'LAP'))                                       CL**8
  7951         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 164
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7952     ELSE                                                         ECSRIRTN
  7953         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
  7954                                                                  ECSRIRTN
  7955     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
  7956         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
  7957            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
  7958                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
  7959                                                                  ECSRIRTN
  7960     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  7961         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
  7962         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
  7963         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
  7964                                                                  ECSRIRTN
  7965     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
  7966                                                                  ECSRIRTN
  7967 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
  7968                                                                  ECSRIRTN
  7969     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  7970         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
  7971         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  7972                                                                  ECSRIRTN
  7973     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  7974     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  7975     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
  7976                                    RW-AHPRM.                     ECSRIRTN
  7977                                                                  ECSRIRTN
  7978 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
  7979                                                                  ECSRIRTN
  7980     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
  7981                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  7982                                                                  ECSRIRTN
  7983     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  7984                                                                  ECSRIRTN
  7985     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
  7986        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  7987         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
  7988     ELSE                                                         ECSRIRTN
  7989         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  7990         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
  7991                                                                  ECSRIRTN
  7992                                                                  ECSRIRTN
  7993 REIN-CALC-AH-X.                                                  ECSRIRTN
  7994     EXIT.                                                        ECSRIRTN
  7995                                                                  ECSRIRTN
  7996 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
  7997                                                                  ECSRIRTN
  7998     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
  7999     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
  8000     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
  8001     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
  8002                                                                  ECSRIRTN
  8003     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
  8004         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
  8005                                                                  ECSRIRTN
  8006     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
  8007        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
  8008           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  8009                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 165
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8010     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
  8011        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
  8012           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  8013                                                                  ECSRIRTN
  8014 REINSURE-CALC-X.                                                 ECSRIRTN
  8015                                                                  ECSRIRTN
  8016     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  8017         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  8018                                                                  ECSRIRTN
  8019     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  8020                                                                  ECSRIRTN
  8021 REINSURE-SUBTRACT.                                               ECSRIRTN
  8022                                                                  ECSRIRTN
  8023     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
  8024     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
  8025     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
  8026     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
  8027                                                                  ECSRIRTN
  8028 REINSURE-SUBTRACT-X.                                             ECSRIRTN
  8029     EXIT.                                                        ECSRIRTN
  8030                                                                  ECSRIRTN
  8031 REINSURE-CALC-CANCEL.                                            ECSRIRTN
  8032                                                                  ECSRIRTN
  8033     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  8034     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  8035                                                                  ECSRIRTN
  8036     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  8037         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
  8038                                                                  ECSRIRTN
  8039     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8040         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8041                                                                  ECSRIRTN
  8042     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
  8043         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
  8044             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
  8045                                                                  ECSRIRTN
  8046     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8047         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
  8048                                                                  ECSRIRTN
  8049     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8050         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
  8051         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8052                                                                  ECSRIRTN
  8053     IF CR-LFPRM = ZERO                                           ECSRIRTN
  8054        MOVE ZERO                TO REIN-FACTOR
  8055     ELSE                                                         ECSRIRTN
  8056        IF DTE-CLIENT = 'GIC'  AND
  8057           CLAS-I-BAL (CLAS-INDEXL) = 'B'
  8058           MOVE +1.0             TO REIN-FACTOR
  8059        ELSE
  8060           IF DTE-CLIENT = 'DCC'
  8061              COMPUTE REIN-FACTOR = CR-LFRFND /
  8062                 (CR-LFPRM + CR-LFPRM-ALT)
  8063           ELSE
  8064              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
  8065                 (CR-LFPRM + CR-LFPRM-ALT)
  8066            END-IF
  8067         END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 166
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8068     END-IF
  8069                                                                  ECSRIRTN
  8070     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  8071         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  8072             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  8073                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
  8074                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  8075             ELSE                                                 ECSRIRTN
  8076                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  8077                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  8078                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
  8079                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  8080         ELSE                                                     ECSRIRTN
  8081             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  8082                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *        ECSRIRTN
  8083                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT))   ECSRIRTN
  8084             ELSE                                                 ECSRIRTN
  8085*                COMPUTE RWF-LFRFND = REIN-FACTOR
  8086*                   * REIN-CALCED-LIFE *
  8087*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
  8088                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  8089                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  8090                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
  8091                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
  8092                                                                  ECSRIRTN
  8093     IF CR-LFAMT = ZERO                                           ECSRIRTN
  8094         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  8095             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  8096                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  8097                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
  8098             ELSE                                                 ECSRIRTN
  8099                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  8100                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  8101                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  8102                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
  8103                                                                  ECSRIRTN
  8104     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
  8105                                                                  ECSRIRTN
  8106                                                                  ECSRIRTN
  8107 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
  8108                                                                  ECSRIRTN
  8109     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  8110       (CR-LF-CANC-DT = ZEROS)                                       CL*10
  8111         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  8112         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8113                                                                  ECSRIRTN
  8114     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  8115       IF VOIDING-LF-CANCEL                                       ECSRIRTN
  8116           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
  8117           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
  8118       ELSE                                                       ECSRIRTN
  8119           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
  8120               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
  8121                                                                  ECSRIRTN
  8122     IF FLAT-CANCEL-LF                                            ECSRIRTN
  8123         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
  8124         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8125                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 167
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8126     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
  8127         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  8128         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8129                                                                  ECSRIRTN
  8130     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
  8131     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  8132     MOVE +0                          TO REIN-WORKA               ECSRIRTN
  8133                                         RW-LFRFND.               ECSRIRTN
  8134                                                                  ECSRIRTN
  8135 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
  8136                                                                  ECSRIRTN
  8137     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
  8138                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  8139                                                                  ECSRIRTN
  8140     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  8141        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  8142                                                                  ECSRIRTN
  8143     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
  8144        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  8145         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
  8146     ELSE                                                         ECSRIRTN
  8147         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  8148         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
  8149                                                                  ECSRIRTN
  8150                                                                  ECSRIRTN
  8151 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
  8152                                                                  ECSRIRTN
  8153     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8154         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8155                                                                  ECSRIRTN
  8156     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  8157         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
  8158             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
  8159                                                                  ECSRIRTN
  8160     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
  8161         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
  8162         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
  8163             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
  8164                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  8165         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8166                                                                  ECSRIRTN
  8167     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8168         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
  8169                                                                  ECSRIRTN
  8170     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8171         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
  8172         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8173                                                                  ECSRIRTN
  8174     IF CR-AHPRM = ZERO                                           ECSRIRTN
  8175        MOVE ZERO                TO REIN-FACTOR
  8176     ELSE
  8177        IF DTE-CLIENT = 'GIC'  AND
  8178           CLAS-I-BAL (CLAS-INDEXA) = 'B'
  8179            MOVE +1.0            TO REIN-FACTOR
  8180        ELSE
  8181           IF DTE-CLIENT = 'DCC'
  8182              COMPUTE REIN-FACTOR =
  8183                 CR-AHRFND / CR-AHPRM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 168
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8184           ELSE
  8185              COMPUTE REIN-FACTOR ROUNDED =
  8186                                CR-AHRFND-CALC / CR-AHPRM
  8187           END-IF
  8188        END-IF
  8189     END-IF
  8190
  8191     IF CR-AHAMT NOT = ZERO
  8192        IF (DTE-CLIENT = 'DCC')
  8193           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
  8194           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
  8195        ELSE
  8196           IF WT-AH-QC = ('1' OR '4')
  8197              COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND *
  8198                       RWF-AHAMT) / CR-AHAMT
  8199           ELSE
  8200              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
  8201              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
  8202                       RWF-AHAMT) / CR-AHAMT
  8203           END-IF
  8204        END-IF
  8205     ELSE
  8206        IF RWF-AH-LIMIT = ZERO
  8207           IF WT-AH-QC = ('1' OR '4')
  8208              COMPUTE RWF-AHRFND ROUNDED =
  8209                       CR-AHRFND * WT-AH-PCT
  8210           ELSE
  8211              COMPUTE RWF-AHRFND =
  8212                            REIN-FACTOR * REIN-CALCED-AH
  8213              COMPUTE RWF-AHRFND ROUNDED =
  8214                       RWF-AHRFND * WT-AH-PCT
  8215           END-IF
  8216        END-IF
  8217     END-IF
  8218
  8219     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
  8220                                                                  ECSRIRTN
  8221                                                                  ECSRIRTN
  8222 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
  8223                                                                  ECSRIRTN
  8224     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  8225       (CR-AH-CANC-DT = ZEROS)                                       CL*10
  8226         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
  8227         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8228                                                                  ECSRIRTN
  8229     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  8230       IF VOIDING-AH-CANCEL                                       ECSRIRTN
  8231           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
  8232           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
  8233       ELSE                                                       ECSRIRTN
  8234           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
  8235               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
  8236                                                                  ECSRIRTN
  8237     IF FLAT-CANCEL-AH                                            ECSRIRTN
  8238         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
  8239         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8240                                                                  ECSRIRTN
  8241     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 169
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8242         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
  8243         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8244                                                                  ECSRIRTN
  8245     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  8246     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  8247     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
  8248                                    RW-AHRFND.                    ECSRIRTN
  8249                                                                  ECSRIRTN
  8250 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
  8251                                                                  ECSRIRTN
  8252     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
  8253                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  8254                                                                  ECSRIRTN
  8255     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  8256                                                                  ECSRIRTN
  8257     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
  8258        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  8259         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
  8260     ELSE                                                         ECSRIRTN
  8261         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  8262         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
  8263                                                                  ECSRIRTN
  8264                                                                  ECSRIRTN
  8265 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
  8266                                                                  ECSRIRTN
  8267     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
  8268         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8269                                                                  ECSRIRTN
  8270     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
  8271         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8272                                                                  ECSRIRTN
  8273     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
  8274                                                                  ECSRIRTN
  8275 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
  8276                                                                  ECSRIRTN
  8277     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
  8278     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
  8279                                                                  ECSRIRTN
  8280     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
  8281         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
  8282             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
  8283                                                                  ECSRIRTN
  8284     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
  8285         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8286                                                                  ECSRIRTN
  8287     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
  8288         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8289                                                                  ECSRIRTN
  8290 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
  8291                                                                  ECSRIRTN
  8292     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  8293         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  8294                                                                  ECSRIRTN
  8295     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  8296                                                                  ECSRIRTN
  8297 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
  8298                                                                  ECSRIRTN
  8299     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 170
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8300     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
  8301                                                                  ECSRIRTN
  8302 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
  8303     EXIT.                                                        ECSRIRTN
  8304                                                                  ECSRIRTN
  8305 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
  8306                                                                  ECSRIRTN
  8307     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
  8308         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
  8309                                                                  ECSRIRTN
  8310 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
  8311     EXIT.                                                        ECSRIRTN
  8312                                                                  ECSRIRTN
  8313 REINSURE-CALC-CLAIM.                                             ECSRIRTN
  8314                                                                  ECSRIRTN
  8315     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  8316     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  8317                                                                  ECSRIRTN
  8318     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  8319         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
  8320                                                                  ECSRIRTN
  8321     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  8322        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  8323          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  8324          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  8325          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  8326                                                                  ECSRIRTN
  8327     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  8328        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  8329          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
  8330                                                                  ECSRIRTN
  8331     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
  8332                                  RWF-AHCLML.                     ECSRIRTN
  8333                                                                  ECSRIRTN
  8334     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8335         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8336                                                                  ECSRIRTN
  8337     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
  8338         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8339                                                                  ECSRIRTN
  8340     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8341         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
  8342             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
  8343                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
  8344                                                                  ECSRIRTN
  8345     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
  8346         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
  8347                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
  8348                                                                  ECSRIRTN
  8349     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8350         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
  8351                                                                  ECSRIRTN
  8352     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8353         IF REIN-RT-SW = 'X'                                      ECSRIRTN
  8354             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
  8355                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
  8356             ELSE                                                 ECSRIRTN
  8357                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 171
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8358         ELSE                                                     ECSRIRTN
  8359             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
  8360                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
  8361                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
  8362             ELSE                                                 ECSRIRTN
  8363                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
  8364                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
  8365                                                                  ECSRIRTN
  8366     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8367         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8368                                                                  ECSRIRTN
  8369     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  8370         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  8371            OR 'DCC'
  8372             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
  8373                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  8374         ELSE                                                     ECSRIRTN
  8375             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
  8376                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
  8377                                                                  ECSRIRTN
  8378     IF CR-LFAMT = ZERO                                           ECSRIRTN
  8379         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  8380             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
  8381                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
  8382                                                                  ECSRIRTN
  8383     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8384         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
  8385             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
  8386                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
  8387                                                                  ECSRIRTN
  8388     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8389         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
  8390             IF REIN-RT-SW = 'X'                                  ECSRIRTN
  8391               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
  8392                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
  8393                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
  8394                  ELSE                                            ECSRIRTN
  8395                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
  8396                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
  8397              ELSE                                                ECSRIRTN
  8398                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
  8399                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
  8400                     COMPUTE RWF-LFCLML =                         ECSRIRTN
  8401                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
  8402                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
  8403                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
  8404                                                                  ECSRIRTN
  8405     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
  8406                                                                  ECSRIRTN
  8407     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
  8408                                                                  ECSRIRTN
  8409                                                                  ECSRIRTN
  8410 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
  8411                                                                  ECSRIRTN
  8412     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
  8413         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8414                                                                  ECSRIRTN
  8415     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 172
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8416         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
  8417     ELSE                                                         ECSRIRTN
  8418         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
  8419                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
  8420                                                                  ECSRIRTN
  8421     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  8422         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8423                                                                  ECSRIRTN
  8424     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  8425         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
  8426             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
  8427         ELSE                                                     ECSRIRTN
  8428             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
  8429     ELSE                                                         ECSRIRTN
  8430         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
  8431             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
  8432             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
  8433         ELSE                                                     ECSRIRTN
  8434             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
  8435             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
  8436                                                                  ECSRIRTN
  8437                                                                  ECSRIRTN
  8438 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
  8439                                                                  ECSRIRTN
  8440     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8441         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
  8442                                                                  ECSRIRTN
  8443     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  8444         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8445                                                                  ECSRIRTN
  8446     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  8447         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
  8448                                                                  ECSRIRTN
  8449     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
  8450     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
  8451                                                                  ECSRIRTN
  8452     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
  8453             VARYING                                              ECSRIRTN
  8454         INC-SUB FROM +1 BY +1                                    ECSRIRTN
  8455             UNTIL                                                ECSRIRTN
  8456         INC-SUB GREATER THAN +5.                                 ECSRIRTN
  8457                                                                  ECSRIRTN
  8458     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  8459         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
  8460     ELSE                                                         ECSRIRTN
  8461         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
  8462                                                                  ECSRIRTN
  8463 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
  8464                                                                  ECSRIRTN
  8465     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
  8466         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8467                                                                  ECSRIRTN
  8468     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8469       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
  8470           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
  8471                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
  8472               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
  8473                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 173
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8474               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
  8475                                                                  ECSRIRTN
  8476     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  8477       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
  8478           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
  8479                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
  8480           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
  8481                                                                  ECSRIRTN
  8482     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
  8483         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
  8484                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
  8485                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
  8486         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8487                                                                  ECSRIRTN
  8488     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  8489         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8490                                                                  ECSRIRTN
  8491     IF INC-SUB = +1                                              ECSRIRTN
  8492         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8493     IF INC-SUB = +2                                              ECSRIRTN
  8494         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8495     IF INC-SUB = +3                                              ECSRIRTN
  8496         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8497     IF INC-SUB = +4                                              ECSRIRTN
  8498         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8499     IF INC-SUB = +5                                              ECSRIRTN
  8500         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8501                                                                  ECSRIRTN
  8502     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
  8503                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
  8504                                                                  ECSRIRTN
  8505     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  8506         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8507                                                                  ECSRIRTN
  8508     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
  8509              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
  8510         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
  8511     ELSE                                                         ECSRIRTN
  8512         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
  8513                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
  8514                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
  8515                                                                  ECSRIRTN
  8516 CHECK-DISABS-EXIT.                                               ECSRIRTN
  8517      EXIT.                                                       ECSRIRTN
  8518                                                                  ECSRIRTN
  8519 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
  8520                                                                  ECSRIRTN
  8521     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  8522         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8523                                                                  ECSRIRTN
  8524     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8525         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
  8526             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
  8527                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
  8528                                                                  ECSRIRTN
  8529     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  8530         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
  8531             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 174
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8532                                                                  ECSRIRTN
  8533 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
  8534                                                                  ECSRIRTN
  8535     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
  8536         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
  8537         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
  8538             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
  8539                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  8540         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
  8541         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8542                                                                  ECSRIRTN
  8543     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8544         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
  8545                                                                  ECSRIRTN
  8546     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8547         IF REIN-RT-SW = 'X'                                      ECSRIRTN
  8548             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
  8549                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
  8550             ELSE                                                 ECSRIRTN
  8551                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
  8552         ELSE                                                     ECSRIRTN
  8553             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
  8554                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
  8555                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
  8556             ELSE                                                 ECSRIRTN
  8557                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
  8558                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
  8559                                                                  ECSRIRTN
  8560     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8561         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8562                                                                  ECSRIRTN
  8563     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  8564         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
  8565                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
  8566     ELSE                                                         ECSRIRTN
  8567         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
  8568             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
  8569                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
  8570                                                                  ECSRIRTN
  8571     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8572         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
  8573             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
  8574                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
  8575                                                                  ECSRIRTN
  8576     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8577         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
  8578             IF REIN-RT-SW = 'X'                                  ECSRIRTN
  8579               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
  8580                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
  8581                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
  8582                  ELSE                                            ECSRIRTN
  8583                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
  8584                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
  8585              ELSE                                                ECSRIRTN
  8586                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
  8587                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
  8588                     COMPUTE RWF-AHCLML =                         ECSRIRTN
  8589                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 175
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8590                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
  8591                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
  8592                                                                  ECSRIRTN
  8593                                                                  ECSRIRTN
  8594     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
  8595        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
  8596                               '220000' OR '230000')              ECSRIRTN
  8597           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
  8598               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
  8599                                                                  ECSRIRTN
  8600     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
  8601                                                                  ECSRIRTN
  8602     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
  8603                                                                  ECSRIRTN
  8604                                                                  ECSRIRTN
  8605 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
  8606                                                                  ECSRIRTN
  8607     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  8608         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8609                                                                  ECSRIRTN
  8610     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  8611         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
  8612         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8613                                                                  ECSRIRTN
  8614     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
  8615                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
  8616                                                                  ECSRIRTN
  8617     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  8618         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8619                                                                  ECSRIRTN
  8620     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
  8621         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8622                                                                  ECSRIRTN
  8623     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
  8624                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
  8625         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
  8626                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
  8627         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
  8628     ELSE                                                         ECSRIRTN
  8629         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
  8630         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
  8631                                                                  ECSRIRTN
  8632                                                                  ECSRIRTN
  8633 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
  8634                                                                  ECSRIRTN
  8635     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
  8636         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8637                                                                  ECSRIRTN
  8638     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
  8639         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8640                                                                  ECSRIRTN
  8641     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
  8642                                                                  ECSRIRTN
  8643 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
  8644                                                                  ECSRIRTN
  8645     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
  8646     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
  8647                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 176
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8648     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
  8649         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
  8650             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
  8651                                                                  ECSRIRTN
  8652     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
  8653     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
  8654                                                                  ECSRIRTN
  8655     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
  8656         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8657                                                                  ECSRIRTN
  8658     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
  8659         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8660                                                                  ECSRIRTN
  8661 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
  8662                                                                  ECSRIRTN
  8663     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  8664         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  8665                                                                  ECSRIRTN
  8666     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  8667                                                                  ECSRIRTN
  8668 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
  8669                                                                  ECSRIRTN
  8670     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
  8671     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
  8672                                                                  ECSRIRTN
  8673 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
  8674     EXIT.                                                        ECSRIRTN
  8675                                                                  ECSRIRTN
  8676 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
  8677                                                                  ECSRIRTN
  8678     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
  8679         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
  8680                                                                  ECSRIRTN
  8681 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
  8682     EXIT.                                                        ECSRIRTN
  8683                                                                  ECSRIRTN
  8684                                                                  ECSRIRTN
  8685 CLEAR-REIN-HOLD.                                                 ECSRIRTN
  8686                                                                  ECSRIRTN
  8687     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
  8688     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
  8689     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
  8690     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
  8691                                                                  ECSRIRTN
  8692     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
  8693         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
  8694         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
  8695         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
  8696         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
  8697         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
  8698         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
  8699         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
  8700         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
  8701         REIN-AH-LIMIT (1).                                       ECSRIRTN
  8702                                                                  ECSRIRTN
  8703     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
  8704         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
  8705                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 177
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8706     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
  8707                                                                  ECSRIRTN
  8708 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
  8709                                                                  ECSRIRTN
  8710     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
  8711                                                                  ECSRIRTN
  8712 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
  8713     EXIT.                                                        ECSRIRTN
  8714                                                                  ECSRIRTN
  8715 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
  8716                                                                  ECSRIRTN
  8717     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
  8718                                                                  ECSRIRTN
  8719     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
  8720         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
  8721                                                                  ECSRIRTN
  8722     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  8723         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
  8724             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
  8725                                                                  ECSRIRTN
  8726     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  8727         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
  8728         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
  8729         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
  8730     ELSE                                                         ECSRIRTN
  8731         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
  8732         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
  8733         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
  8734                                                                  ECSRIRTN
  8735     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
  8736                                                                  ECSRIRTN
  8737     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
  8738        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
  8739         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
  8740                                                                  ECSRIRTN
  8741     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
  8742         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
  8743                                                                  ECSRIRTN
  8744 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
  8745     EXIT.                                                        ECSRIRTN
  8746                                                                  ECSRIRTN
  8747 REIN-FIND-CO-LOOP.                                               ECSRIRTN
  8748                                                                  ECSRIRTN
  8749     CONTINUE.                                                    ECSRIRTN
  8750*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
  8751 FIND-REI-CO-EXIT.                                                ECSRIRTN
  8752     EXIT.                                                        ECSRIRTN
  8753                                                                  ECSRIRTN
  8754 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
  8755                                                                  ECSRIRTN
  8756     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
  8757         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
  8758                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
  8759                                                                  ECSRIRTN
  8760     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
  8761         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
  8762                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
  8763                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 178
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8764     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
  8765                                                                  ECSRIRTN
  8766     START ERRTBL-IN                                              ECSRIRTN
  8767           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
  8768             INVALID KEY                                          ECSRIRTN
  8769               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
  8770                                                                  ECSRIRTN
  8771     MOVE 0 TO CO-SUB.                                            ECSRIRTN
  8772     MOVE 0 TO SUB1.                                              ECSRIRTN
  8773 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
  8774                                                                  ECSRIRTN
  8775     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
  8776                                                                  ECSRIRTN
  8777     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
  8778        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
  8779                                                                  ECSRIRTN
  8780     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
  8781        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
  8782        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
  8783                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  8784        GO TO ABEND-PGM.                                          ECSRIRTN
  8785                                                                  ECSRIRTN
  8786     IF RE-CODE NOT = 'B'                                         ECSRIRTN
  8787        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
  8788                                                                  ECSRIRTN
  8789     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
  8790        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
  8791                                                                  ECSRIRTN
  8792     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
  8793        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
  8794                                                                  ECSRIRTN
  8795     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
  8796        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
  8797                                                                  ECSRIRTN
  8798     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
  8799        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
  8800                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
  8801        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 178)**
**    Index-name belongs to different table - unexpected behaviour may occur
  8802                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
  8803        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 178)**
**    Index-name belongs to different table - unexpected behaviour may occur
  8804                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
  8805     END-PERFORM.                                                 ECSRIRTN
  8806     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
  8807                                                                  ECSRIRTN
  8808     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
  8809        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
  8810                                                                  ECSRIRTN
  8811     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
  8812        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
  8813                                                                  ECSRIRTN
  8814     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
  8815        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 179
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8816                                                                  ECSRIRTN
  8817     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
  8818        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
  8819                                                                  ECSRIRTN
  8820     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
  8821        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
  8822        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
  8823        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
  8824        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
  8825        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
  8826        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
  8827          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
  8828                                                                  ECSRIRTN
  8829     ADD +1 TO CO-SUB.                                            ECSRIRTN
  8830                                                                  ECSRIRTN
  8831     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
  8832        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
  8833        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
  8834        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
  8835        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
  8836                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  8837        GO TO ABEND-PGM.                                          ECSRIRTN
  8838                                                                  ECSRIRTN
  8839     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
  8840                                                                  ECSRIRTN
  8841     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
  8842                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
  8843     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
  8844                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
  8845     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
  8846                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
  8847                                                                  ECSRIRTN
  8848     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
  8849         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
  8850     ELSE                                                         ECSRIRTN
  8851         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
  8852                                                                  ECSRIRTN
  8853     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
  8854     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
  8855     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
  8856     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
  8857                                                                  ECSRIRTN
  8858 REIN-CO-BUILD-EPR.                                               ECSRIRTN
  8859                                                                  ECSRIRTN
  8860     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
  8861        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
  8862                                                                  ECSRIRTN
  8863     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
  8864        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
  8865                                                                  ECSRIRTN
  8866     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
  8867        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
  8868                                                                  ECSRIRTN
  8869     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
  8870        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
  8871                                                                  ECSRIRTN
  8872     ADD +1 TO SUB1.                                              ECSRIRTN
  8873                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 180
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8874     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
  8875        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
  8876        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
  8877                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  8878        GO TO ABEND-PGM.                                          ECSRIRTN
  8879                                                                  ECSRIRTN
  8880     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
  8881     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
  8882     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
  8883     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
  8884     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
  8885     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
  8886     if re-state-exhibit-opt-f = 'Y'
  8887        move 'Y'         to rc2-ecs152-rpt (sub1)
  8888     else
  8889        move 'N'         to rc2-ecs152-rpt (sub1)
  8890     end-if
  8891                                                                  ECSRIRTN
  8892     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
  8893                                                                  ECSRIRTN
  8894 REIN-BUILD-EXIT.                                                 ECSRIRTN
  8895     EXIT.                                                        ECSRIRTN
  8896                                                                  ECSRIRTN
  8897 ZERO-RCT-ENTRIES.                                                ECSRIRTN
  8898                                                                  ECSRIRTN
  8899     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
  8900                                                                  ECSRIRTN
  8901     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
  8902                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
  8903                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
  8904                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
  8905                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
  8906                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
  8907                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
  8908                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
  8909                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
  8910                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
  8911                                                                  ECSRIRTN
  8912 ZERO-RCT-EXIT.                                                   ECSRIRTN
  8913     EXIT.                                                        ECSRIRTN
  8914                                                                  ECSRIRTN
  8915 ZERO-RC2-ENTRIES.                                                ECSRIRTN
  8916                                                                  ECSRIRTN
  8917     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
  8918                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
  8919     move spaces      to rc2-ecs152-rpt (co-sub)
  8920                                                                  ECSRIRTN
  8921     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
  8922                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
  8923                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
  8924                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
  8925                                                                  ECSRIRTN
  8926 ZERO-RC2-EXIT.                                                   ECSRIRTN
  8927     EXIT.                                                        ECSRIRTN
  8928******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 181
* ECS150.cbl
  8930
  8931 REM-TRM-RTN.
  8932     SUBTRACT BGN-YR FROM END-YR GIVING REM-TRM1.
  8933
  8934     IF REM-TRM1 < 0
  8935       ADD 100 TO REM-TRM1.
  8936
  8937     MULTIPLY +12 BY REM-TRM1.
  8938     SUBTRACT BGN-MO FROM END-MO GIVING TEM-TRM1.
  8939     ADD TEM-TRM1 TO REM-TRM1.
  8940
  8941     IF DTE-REM-TRM = '2'
  8942         GO TO REM-TRM-2.
  8943
  8944     SUBTRACT BGN-DA FROM END-DA GIVING TEM-TRM1.
  8945
  8946     IF TEM-TRM1 = ZERO
  8947         GO TO REM-TRM-1.
  8948
  8949     IF TEM-TRM1 IS LESS THAN -15
  8950         SUBTRACT +1 FROM REM-TRM1
  8951         GO TO REM-TRM-1.
  8952
  8953     IF TEM-TRM1 IS GREATER THAN +15
  8954         ADD +1 TO REM-TRM1
  8955         GO TO REM-TRM-0.
  8956
  8957     IF TEM-TRM1 IS GREATER THAN ZERO
  8958         GO TO REM-TRM-1.
  8959
  8960 REM-TRM-0.
  8961     SUBTRACT REM-TRM1 FROM HLD-TRM GIVING REM-TRM1.
  8962     ADD +1   REM-TRM1 GIVING REM-TRM2.
  8963     GO TO REM-TRMX.
  8964
  8965 REM-TRM-1.
  8966     SUBTRACT REM-TRM1 FROM HLD-TRM GIVING REM-TRM1.
  8967     MOVE REM-TRM1               TO REM-TRM2.
  8968     GO TO REM-TRMX.
  8969
  8970 REM-TRM-2.
  8971     SUBTRACT REM-TRM1 FROM HLD-TRM GIVING REM-TRM2.
  8972     MOVE REM-TRM2               TO REM-TRM1.
  8973     IF REM-TRM2 NOT = +0
  8974         COMPUTE REM-TRM1 = REM-TRM2 - +.5.
  8975
  8976 REM-TRMX.
  8977     EXIT.
  8978
  8979 6000-EXIT.
  8980     EXIT.
  8981
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 182
* ECS150.cbl
  8983 7000-LEVEL-BREAK-PROCESSING SECTION 40.
  8984
  8985 7100-REINS-CO-BREAK.
  8986     PERFORM 7200-CARRIER-BREAK THRU 7200-EXIT.
  8987     MOVE 1                      TO CL.
  8988     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  8989     MOVE 19                     TO ER-REC-TYPE.
  8990     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  8991     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  8992     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  8993
  8994 7100-EXIT.
  8995     EXIT.
  8996
  8997 7200-CARRIER-BREAK.
  8998     PERFORM 7300-COMPANY-BREAK THRU 7300-EXIT.
  8999     MOVE +2                     TO CL.
  9000     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9001     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9002     MOVE 18                     TO ER-REC-TYPE
  9003     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  9004     MOVE LAST-CARRIER           TO ER-CARRIER.
  9005     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  9006     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9007
  9008 7200-EXIT.
  9009     EXIT.
  9010
  9011 7300-COMPANY-BREAK.
  9012     PERFORM 7400-STATE-BREAK THRU 7400-EXIT.
  9013     MOVE +3                     TO CL.
  9014     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9015     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9016     MOVE 17                     TO ER-REC-TYPE.
  9017     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  9018     MOVE LAST-CARRIER           TO ER-CARRIER.
  9019     MOVE LAST-GROUPING          TO ER-COMPANY.
  9020     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  9021     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9022
  9023 7300-EXIT.
  9024     EXIT.
  9025
  9026 7400-STATE-BREAK.
  9027     PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT.
  9028
  9029     IF FIRST-INS-PASS
  9030         GO TO 7450-STATE-BREAK-2.
  9031
  9032     MOVE +4                     TO CL.
  9033     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9034     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9035     MOVE 16                     TO ER-REC-TYPE.
  9036     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  9037     MOVE LAST-GROUPING          TO ER-COMPANY.
  9038     MOVE LAST-CARRIER           TO ER-CARRIER.
  9039     MOVE LAST-STATE             TO ER-STATE.
  9040     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 183
* ECS150.cbl
  9041     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9042     MOVE LOW-VALUES             TO ER-SORT-KEY
  9043     MOVE 20                     TO ER-REC-TYPE
  9044     MOVE LAST-REINS-CO          TO ER-REINS-CO
  9045     MOVE LAST-CARRIER           TO ER-CARRIER
  9046     MOVE LAST-GROUPING          TO ER-COMPANY
  9047     MOVE LAST-STATE             TO ER-STATE
  9048     WRITE CLAS150-EXTRACT-RECORD-C FROM CLAS150-EXTRACT-RECORD.
  9049     GO TO 7400-EXIT.
  9050
  9051 7450-STATE-BREAK-2.
  9052     MOVE +1                     TO CL.
  9053     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9054     MOVE 11                     TO ER-REC-TYPE.
  9055     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9056
  9057     MOVE 09                     TO ER-REC-TYPE.
  9058     MOVE LAST-CARRIER           TO ER-CARRIER.
  9059     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9060
  9061     MOVE 07                     TO ER-REC-TYPE.
  9062     MOVE LAST-STATE             TO ER-STATE.
  9063     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9064
  9065     MOVE 05                     TO ER-REC-TYPE.
  9066     MOVE HIGH-VALUE             TO ER-STATE.
  9067     MOVE LAST-GROUPING          TO ER-COMPANY.
  9068     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9069
  9070     MOVE LAST-STATE             TO ER-STATE.
  9071     MOVE 03                     TO ER-REC-TYPE.
  9072     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9073
  9074     MOVE HIGH-VALUES            TO ER-CONTROL.
  9075     MOVE LAST-STATE             TO ER-ST-SEQ.
  9076     MOVE 13 TO                  ER-REC-TYPE.
  9077     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9078
  9079     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9080     MOVE +3                     TO CL.
  9081     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9082     MOVE 12                     TO ER-REC-TYPE.
  9083     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9084
  9085     MOVE 10                     TO ER-REC-TYPE.
  9086     MOVE LAST-CARRIER           TO ER-CARRIER
  9087     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9088
  9089     MOVE 08                     TO ER-REC-TYPE.
  9090     MOVE LAST-STATE             TO ER-STATE.
  9091     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9092
  9093     MOVE 06                     TO ER-REC-TYPE.
  9094     MOVE HIGH-VALUE             TO ER-STATE.
  9095     MOVE LAST-GROUPING          TO ER-COMPANY.
  9096     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9097
  9098     MOVE 04                     TO ER-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 184
* ECS150.cbl
  9099     MOVE LAST-STATE             TO ER-STATE.
  9100     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9101
  9102     MOVE HIGH-VALUES            TO ER-CONTROL
  9103     MOVE LAST-STATE             TO ER-ST-SEQ.
  9104     MOVE 14                     TO ER-REC-TYPE.
  9105     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9106
  9107     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9108
  9109 7400-EXIT.
  9110     EXIT.
  9111
  9112 7460-WRITE-ST-EXTRACT.
  9113     WRITE CLAS150-EXTRACT-RECORD-A FROM CLAS150-EXTRACT-RECORD.
  9114
  9115 7460-EXIT.
  9116     EXIT.
  9117
  9118 7500-ACCOUNT-BREAK.
  9119     COMPUTE TERM-WORK = PERIOD-END-9 - PERIOD-START-9.
  9120
  9121     PERFORM 7505-ADJ-OB-TOTS THRU 7505-EXIT
  9122         VARYING TG FROM 1 BY 1
  9123             UNTIL TG GREATER +3.
  9124
  9125     GO TO 7510-ACCT-REIN-BREAK.
  9126
  9127 7505-ADJ-OB-TOTS.
  9128     IF REINSURANCE-PASS
  9129         MOVE +5                 TO CL
  9130         PERFORM 7507-OB-DIVIDE THRU 7507-EXIT
  9131     ELSE
  9132         MOVE +2                 TO CL
  9133         PERFORM 7507-OB-DIVIDE THRU 7507-EXIT
  9134         MOVE +4                 TO CL
  9135         PERFORM 7507-OB-DIVIDE THRU 7507-EXIT.
  9136
  9137 7505-EXIT.
  9138     EXIT.
  9139
  9140 7507-OB-DIVIDE.
  9141*    IF ISSUE-AMT (CL  TG  3) NOT = 0
  9142*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  3)
  9143*        MOVE +1                 TO ISSUE-CNT (CL  TG  3).
  9144*
  9145*    IF ISSUE-AMT (CL  TG  8) NOT = 0
  9146*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  8)
  9147*        MOVE +1                 TO ISSUE-CNT (CL  TG  8).
  9148*
  9149*    IF ISSUE-AMT (CL  TG  5) NOT = 0
  9150*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  5)
  9151*        MOVE +1                 TO ISSUE-CNT (CL  TG  5).
  9152*
  9153*    IF ISSUE-AMT (CL  TG  10) NOT = 0
  9154*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  10)
  9155*        MOVE +1                 TO ISSUE-CNT (CL  TG  10).
  9156
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 185
* ECS150.cbl
  9157 7507-EXIT.
  9158     EXIT.
  9159
  9160 7510-ACCT-REIN-BREAK.
  9161     IF FIRST-INS-PASS
  9162         GO TO 7550-ACCNT-BREAK-2.
  9163
  9164     MOVE +5                     TO CL.
  9165     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9166     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9167     MOVE SAVE-CONTROL-BREAKS    TO ER-CONTROL.
  9168     MOVE 15                     TO ER-REC-TYPE.
  9169     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  9170
  9171     IF DTE-PGM-OPT = 1
  9172         PERFORM 5200-PRINT-SUMMARY-TOTALS THRU 5200-EXIT.
  9173
  9174     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9175     GO TO 7500-EXIT.
  9176
  9177 7550-ACCNT-BREAK-2.
  9178     MOVE +2                     TO CL.
  9179     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9180     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9181     MOVE SAVE-CONTROL-BREAKS    TO ER-CONTROL.
  9182     MOVE 01                     TO ER-REC-TYPE.
  9183     WRITE CLAS150-EXTRACT-RECORD-A FROM CLAS150-EXTRACT-RECORD.
  9184
  9185     MOVE +4                     TO CL.
  9186     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9187     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9188     MOVE SAVE-CONTROL-BREAKS    TO ER-CONTROL.
  9189     MOVE 02                     TO ER-REC-TYPE.
  9190     WRITE CLAS150-EXTRACT-RECORD-A FROM CLAS150-EXTRACT-RECORD.
  9191
  9192     IF DTE-PGM-OPT = 1
  9193         PERFORM 5200-PRINT-SUMMARY-TOTALS THRU 5200-EXIT.
  9194     MOVE +4                     TO CL.
  9195     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9196     MOVE +2                     TO CL.
  9197     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9198
  9199 7500-EXIT.
  9200     EXIT.
  9201
  9202 7900-ROLL-TOTALS.
  9203     COMPUTE CLX = CL - 1.
  9204     ADD CORRESPONDING A-CONTROL-LEVELS (CL) TO
  9205                       A-CONTROL-LEVELS (CLX).
  9206     PERFORM 7910-TERM-LOOP THRU 7910-EXIT
  9207         VARYING TG FROM +1 BY +1
  9208             UNTIL TG GREATER +3.
  9209
  9210 7900-EXIT.
  9211     EXIT.
  9212
  9213 7910-TERM-LOOP.
  9214     PERFORM 7920-ROLL-ACTIVITY THRU 7920-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 186
* ECS150.cbl
  9215         VARYING IY FROM +1 BY +1
  9216             UNTIL IY GREATER +10.
  9217     PERFORM 7930-ROLL-EXHIBIT THRU 7930-EXIT
  9218         VARYING EG FROM +1 BY +1
  9219             UNTIL EG GREATER +9.
  9220
  9221 7910-EXIT.
  9222     EXIT.
  9223
  9224 7920-ROLL-ACTIVITY.
  9225     ADD CORRESPONDING INSURANCE-TYPES (CL  TG  IY) TO
  9226                       INSURANCE-TYPES (CLX  TG  IY).
  9227
  9228 7920-EXIT.
  9229     EXIT.
  9230
  9231 7930-ROLL-EXHIBIT.
  9232     ADD CORRESPONDING EXHIBIT-GROUPS (CL  TG  EG) TO
  9233                       EXHIBIT-GROUPS (CLX  TG  EG).
  9234
  9235 7930-EXIT.
  9236     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 187
* ECS150.cbl
  9238 8000-MISCELANEOUS-ROUTINES  SECTION 32.
  9239
  9240 8100-CLEAR-TABLES.
  9241     MOVE ZERO                   TO AH-PAID-THIS-YR (CL)
  9242                                    AH-PAID-LAST-YR (CL).
  9243
  9244     PERFORM 8110-ZERO-TERM-GROUPS THRU 8110-EXIT
  9245         VARYING TG FROM +1 BY +1
  9246             UNTIL TG GREATER THAN 3.
  9247
  9248 8100-EXIT.
  9249     EXIT.
  9250
  9251 8110-ZERO-TERM-GROUPS.
  9252     PERFORM 8120-ZERO-ACTIVITY THRU 8120-EXIT
  9253         VARYING IY FROM +1 BY +1
  9254             UNTIL IY GREATER +10.
  9255
  9256     PERFORM 8130-ZERO-EXHIBIT THRU 8130-EXIT
  9257         VARYING EG FROM +1 BY +1
  9258             UNTIL EG GREATER +9.
  9259
  9260 8110-EXIT.
  9261     EXIT.
  9262
  9263 8120-ZERO-ACTIVITY.
  9264     MOVE ZERO                  TO ISSUE-CNT   (CL  TG  IY)
  9265                                   ISSUE-AMT   (CL  TG  IY)
  9266                                   ISSUE-PREM  (CL  TG  IY)
  9267                                   CANCEL-CNT  (CL  TG  IY)
  9268                                   CANCEL-PREM (CL  TG  IY)
  9269                                   CANCEL-AMT  (CL  TG  IY)
  9270                                   CLAIM-CNT   (CL  TG  IY)
  9271                                   CLAIM-AMT   (CL  TG  IY)
  9272                                   EARN-PREM   (CL  TG  IY).
  9273
  9274 8120-EXIT.
  9275     EXIT.
  9276
  9277 8130-ZERO-EXHIBIT.
  9278     MOVE ZERO                  TO GROUP-CNT (CL  TG  EG)
  9279                                   GROUP-AMT (CL  TG  EG)
  9280                                   IND-CNT   (CL  TG  EG)
  9281                                   IND-AMT   (CL  TG  EG).
  9282
  9283 8130-EXIT.
  9284     EXIT.
  9285
  9286 8200-RECORD-SETUP.
  9287     MOVE LOW-VALUES             TO ER-SORT-KEY.
  9288     MOVE RUN-DATE               TO ER-PERIOD-START.
  9289     MOVE EP-DT                  TO ER-PERIOD-END.
  9290     MOVE CONTROL-LEVELS (CL)    TO ER-ACTIVITY-TOTALS.
  9291     MOVE E-CONTROL-LEVELS (CL)  TO ER-EXHIBIT-TOTALS.
  9292     MOVE AH-PAID-THIS-YR (CL)   TO ER-AH-PD-THIS.
  9293     MOVE AH-PAID-LAST-YR (CL)   TO ER-AH-PD-LAST.
  9294     MOVE HIGH-VALUES            TO ER-CONTROL.
  9295
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 188
* ECS150.cbl
  9296 8200-EXIT.
  9297     EXIT.
  9298
  9299 8300-STARTING-INFORCE.
  9300
  9301     IF CR-LFAMT-ALT NOT NUMERIC
  9302         MOVE ZEROS TO CR-LFAMT-ALT.
  9303
  9304     IF CR-ENTRY-STATUS = '3' OR '5'
  9305         MOVE ZERO               TO INFORCE-DOLLARS
  9306         GO TO 8300-EXIT.
  9307
  9308     IF SUMMARY-REC
  9309         NEXT SENTENCE
  9310       ELSE
  9311          MOVE CR-LFAMT          TO INFORCE-DOLLARS.
  9312
  9313     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  9314         GO TO 8390-OB-ADJ.
  9315
  9316     MOVE CR-CC                  TO WS-CR-CCYY (1:2).
  9317     MOVE CR-YR                  TO WS-CR-CCYY (3:2).
  9318
  9319     COMPUTE VALUATION-DATE = CR-LF-TERM -
  9320       (((RUN-CCYY * 12) + RUN-MO) -
  9321                            ((WS-CR-CCYY * 12) + CR-MO)).
  9322
  9323     MOVE SAVE-REM-TERM              TO UNEXPIRED-MONTHS.
  9324     COMPUTE EXPIRED-MONTHS = CR-LF-TERM - UNEXPIRED-MONTHS.
  9325
  9326     IF SAVE-REM-TERM  = CR-LF-TERM
  9327         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9328         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9329             ADD CR-LFAMT-ALT      TO INFORCE-DOLLARS
  9330             GO TO 8300-EXIT
  9331         ELSE
  9332             GO TO 8300-EXIT.
  9333
  9334     IF UNEXPIRED-MONTHS NOT GREATER ZERO
  9335         IF LF-BAL-REMTRM NOT GREATER THAN ZERO
  9336             MOVE ZEROS TO INFORCE-DOLLARS
  9337             GO TO 8300-EXIT.
  9338
  9339
  9340     if dte-client = 'AHL'
  9341        if cr-loan-term = zeros
  9342           move cr-lf-term       to cr-loan-term
  9343        end-if
  9344     end-if
  9345
  9346     IF SUMMARY-REC
  9347        COMPUTE TEMP-RESULT-L ROUNDED =
  9348                         INFORCE-DOLLARS / CR-LF-TERM
  9349     ELSE
  9350        if dte-client = 'AHL'
  9351           compute temp-result-l rounded =
  9352              cr-lfamt / cr-loan-term
  9353           compute unexpired-months = unexpired-months +
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 189
* ECS150.cbl
  9354              (cr-loan-term - cr-lf-term)
  9355        else
  9356           COMPUTE TEMP-RESULT-L ROUNDED =
  9357                         CR-LFAMT / CR-LF-TERM
  9358        end-if
  9359     end-if
  9360
  9361     IF REINSURANCE-PASS OR REINSURANCE-REC
  9362        IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9363            COMPUTE TEMP-RESULT-L ROUNDED  =
  9364            (RC-ORIG-LFAMT * RC-CEDE-FACT) / CR-LF-TERM.
  9365
  9366     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  9367         GO TO 8310-TEXAS-INFORCE.
  9368
  9369     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  9370         GO TO 8320-NET-PAY-INFORCE.
  9371
  9372     IF DTE-CLIENT EQUAL 'FLU'
  9373         GO TO 8325-FLU-INFORCE.
  9374
  9375     IF CR-LFTYP = 'QD'
  9376        MOVE +15.0               TO CR-APR
  9377        GO TO 8320-NET-PAY-INFORCE
  9378     END-IF
  9379
  9380*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  9381     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  9382        (CR-RATING-CLASS NOT = 'L ')
  9383         IF (CR-DT GREATER THAN 19831031) AND
  9384            (CR-LF-TERM GREATER THAN +60)  AND
  9385            (CR-APR GREATER THAN ZERO)
  9386             GO TO 8320-NET-PAY-INFORCE.
  9387
  9388     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  9389         IF (CR-DT GREATER THAN 19830318) AND
  9390            (CR-LF-TERM GREATER THAN +61)  AND
  9391            (CR-APR GREATER THAN ZERO)
  9392             GO TO 8320-NET-PAY-INFORCE.
  9393
  9394     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  9395         IF (CR-DT GREATER THAN 19810831) AND
  9396            (CR-DT LESS THAN 19830901) AND
  9397            (CR-LF-TERM GREATER THAN +62)  AND
  9398            (CR-APR GREATER THAN ZERO)
  9399             GO TO 8320-NET-PAY-INFORCE.
  9400
  9401     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  9402         IF (CR-DT GREATER THAN 19831231) AND
  9403            (CR-LF-TERM GREATER THAN +60)  AND
  9404            (CR-APR GREATER THAN ZERO)
  9405             GO TO 8320-NET-PAY-INFORCE.
  9406
  9407 8305-REG-INFORCE.
  9408
  9409     COMPUTE INFORCE-DOLLARS ROUNDED =
  9410         (TEMP-RESULT-L * UNEXPIRED-MONTHS) + CR-LFAMT-ALT.
  9411
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 190
* ECS150.cbl
  9412     IF REINSURANCE-PASS OR REINSURANCE-REC
  9413        IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9414         COMPUTE INFORCE-DOLLARS ROUNDED =
  9415          (TEMP-RESULT-L * UNEXPIRED-MONTHS) +
  9416          (CR-LFAMT-ALT * RC-CEDE-FACT).
  9417
  9418     GO TO 8390-OB-ADJ.
  9419
  9420 8310-TEXAS-INFORCE.
  9421     DIVIDE CR-LFAMT  BY  CR-LF-TERM
  9422         GIVING TEX-FACT-1.
  9423
  9424     DIVIDE UNEXPIRED-MONTHS  BY  CR-PMT-FREQ
  9425         GIVING TEX-FACT-2
  9426         REMAINDER TEX-FACT-3.
  9427
  9428     IF TEX-FACT-3 NOT ZERO
  9429         ADD +1 TO TEX-FACT-2.
  9430
  9431     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  9432         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9433     ELSE
  9434         COMPUTE INFORCE-DOLLARS ROUNDED =
  9435             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
  9436
  9437     GO TO 8390-OB-ADJ.
  9438
  9439 8320-NET-PAY-INFORCE.
  9440
  9441     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  9442     MOVE 'L'                    TO  DC-OPTION-CODE.
  9443     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9444             8599-DATE-CONVERT-X
  9445
  9446     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  9447
  9448     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  9449         MOVE CR-LOAN-1ST-PMT-DT TO  DC-GREG-DATE-1-YMD
  9450         MOVE '3'                TO  DC-OPTION-CODE
  9451         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9452                 8599-DATE-CONVERT-X
  9453         MOVE DC-BIN-DATE-1      TO  CP-FIRST-PAY-DATE
  9454     ELSE
  9455         MOVE CP-CERT-EFF-DT     TO  DC-BIN-DATE-1
  9456         MOVE +1                 TO  DC-ELAPSED-MONTHS
  9457         MOVE +0                 TO  DC-ELAPSED-DAYS
  9458         MOVE '6'                TO  DC-OPTION-CODE
  9459         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9460             8599-DATE-CONVERT-X
  9461         MOVE DC-BIN-DATE-2      TO  CP-FIRST-PAY-DATE.
  9462
  9463     MOVE CR-LFAMT               TO  CP-ORIGINAL-BENEFIT.
  9464     MOVE CR-APR                 TO  CP-LOAN-APR.
  9465     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM.
  9466     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  9467     MOVE SAVE-REM-TERM          TO  CP-REMAINING-TERM.
  9468     MOVE STATE-ABBR       (CLAS-INDEXS) TO  CP-STATE-STD-ABBRV.
  9469     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 191
* ECS150.cbl
  9470     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  9471     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
  9472
  9473     if dte-client = 'AHL'
  9474        move +14                 to cp-loan-apr
  9475     end-if
  9476
  9477     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  9478
  9479     IF SUMMARY-REC
  9480         COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9481                                      (INFORCE-DOLLARS / +1000)
  9482         GO TO 8390-OB-ADJ.
  9483
  9484     IF CP-STATE-STD-ABBRV = 'NC'
  9485               AND
  9486*      DTE-CLIENT NOT = 'WDS'
  9487       (DTE-CLIENT NOT = 'WDS' AND 'CID')
  9488         IF CP-CERT-EFF-DT GREATER THAN WS-931231
  9489             MOVE CP-REMAINING-AMT TO  INFORCE-DOLLARS
  9490             GO TO 8390-OB-ADJ.
  9491
  9492      COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9493                                      (CR-LFAMT / +1000).
  9494
  9495     GO TO 8390-OB-ADJ.
  9496
  9497 8325-FLU-INFORCE.
  9498     MOVE CR-APR                 TO NP-APR.
  9499     MOVE CR-LF-TERM             TO NP-ORIG  NP-CAP.
  9500     COMPUTE NP251-REM = CR-LF-TERM - TERM-WORK.
  9501     MOVE '1'                    TO NP-OPT.
  9502     MOVE CR-AHPRM               TO NP-AHPRM.
  9503     MOVE CR-ACCOUNT             TO NP-ACCOUNT.
  9504     MOVE CR-DT                  TO NP-EFF-DT.
  9505     MOVE CR-LFAMT               TO NP-BENEFIT.
  9506***  CALL 'IBKE251B'
  9507***      USING NP-ACCOUNT NP-EFF-DT NP-BENEFIT NP-AHPRM NP251-REM
  9508***            NP251-ORIG NP-SUB NP-REMAINING.
  9509     MOVE NP-REMAINING           TO INFORCE-DOLLARS.
  9510     GO TO 8390-OB-ADJ.
  9511
  9512 8350-ENDING-INFORCE.
  9513     IF CR-LFAMT-ALT NOT NUMERIC
  9514         MOVE ZEROS TO CR-LFAMT-ALT.
  9515
  9516     IF CR-ENTRY-STATUS = '3' OR '5'
  9517         MOVE ZERO               TO INFORCE-DOLLARS
  9518         GO TO 8300-EXIT.
  9519
  9520     IF SUMMARY-REC
  9521         NEXT SENTENCE
  9522       ELSE
  9523          MOVE CR-LFAMT          TO INFORCE-DOLLARS.
  9524
  9525     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  9526         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9527             ADD CR-LFAMT-ALT    TO INFORCE-DOLLARS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 192
* ECS150.cbl
  9528             GO TO 8390-OB-ADJ
  9529         ELSE
  9530             GO TO 8390-OB-ADJ.
  9531
  9532     MOVE CP-REMAINING-TERM-2        TO UNEXPIRED-MONTHS.
  9533     COMPUTE EXPIRED-MONTHS = CR-LF-TERM - UNEXPIRED-MONTHS.
  9534
  9535     IF CP-REMAINING-TERM-2 = CR-LF-TERM
  9536         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9537         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9538            IF REINSURANCE-PASS OR REINSURANCE-REC
  9539                NEXT SENTENCE
  9540            ELSE
  9541                ADD CR-LFAMT-ALT    TO INFORCE-DOLLARS
  9542                GO TO 8390-OB-ADJ
  9543         ELSE
  9544             GO TO 8300-EXIT.
  9545
  9546     IF UNEXPIRED-MONTHS NOT GREATER ZERO
  9547         IF LF-BAL-REMTRM NOT GREATER THAN ZERO
  9548             MOVE ZEROS TO INFORCE-DOLLARS
  9549             GO TO 8300-EXIT.
  9550
  9551     MOVE CR-CC                  TO WS-CR-CCYY (1:2).
  9552     MOVE CR-YR                  TO WS-CR-CCYY (3:2).
  9553     COMPUTE VALUATION-DATE = CR-LF-TERM -
  9554        (((EP-CCYY * 12) + EP-MO)
  9555                    - ((WS-CR-CCYY * 12) + CR-MO)).
  9556
  9557     if dte-client = 'AHL'
  9558        if cr-loan-term = zeros
  9559           move cr-lf-term       to cr-loan-term
  9560        end-if
  9561     end-if
  9562
  9563     IF SUMMARY-REC
  9564         COMPUTE TEMP-RESULT-L ROUNDED =
  9565                           INFORCE-DOLLARS / CR-LF-TERM
  9566     ELSE
  9567        if dte-client = 'AHL'
  9568           compute temp-result-l rounded =
  9569              cr-lfamt / cr-loan-term
  9570           compute unexpired-months = unexpired-months +
  9571              (cr-loan-term - cr-lf-term)
  9572        else
  9573           COMPUTE TEMP-RESULT-L ROUNDED =
  9574              CR-LFAMT / CR-LF-TERM
  9575        end-if
  9576     end-if
  9577
  9578     IF REINSURANCE-PASS OR REINSURANCE-REC
  9579        IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9580         COMPUTE TEMP-RESULT-L ROUNDED =
  9581          (RC-ORIG-LFAMT * RC-CEDE-FACT) / CR-LF-TERM.
  9582
  9583     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9584         GO TO 8355-NORMAL-ENDING.
  9585
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 193
* ECS150.cbl
  9586     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  9587         GO TO 8360-TEXAS-ENDING.
  9588
  9589     IF DTE-CLIENT = 'NCL'
  9590       IF CR-DT LESS 19910101
  9591         GO TO 8355-NORMAL-ENDING.
  9592
  9593     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  9594         GO TO 8370-NET-PAY-ENDING.
  9595
  9596     IF DTE-CLIENT = 'FLU'
  9597         GO TO 8375-FLU-ENDING.
  9598
  9599     IF CR-LFTYP = 'QD'
  9600        MOVE +15.0               TO CR-APR
  9601        GO TO 8370-NET-PAY-ENDING
  9602     END-IF
  9603
  9604*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  9605     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  9606        (CR-RATING-CLASS NOT = 'L ')
  9607         IF (CR-DT GREATER THAN 19831031) AND
  9608            (CR-LF-TERM GREATER THAN +60) AND
  9609            (CR-APR GREATER THAN ZERO)
  9610             GO TO 8370-NET-PAY-ENDING.
  9611
  9612     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  9613         IF (CR-DT GREATER THAN 19830318) AND
  9614            (CR-LF-TERM GREATER THAN +61) AND
  9615            (CR-APR GREATER THAN ZERO)
  9616             GO TO 8370-NET-PAY-ENDING.
  9617
  9618     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  9619         IF (CR-DT GREATER THAN 19810831 ) AND
  9620            (CR-DT LESS THAN 19830901 ) AND
  9621            (CR-LF-TERM GREATER THAN +62) AND
  9622            (CR-APR GREATER THAN ZERO)
  9623             GO TO 8370-NET-PAY-ENDING.
  9624
  9625     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  9626         IF (CR-DT GREATER THAN 19831231) AND
  9627            (CR-LF-TERM GREATER THAN +60) AND
  9628            (CR-APR GREATER THAN ZERO)
  9629             GO TO 8370-NET-PAY-ENDING.
  9630
  9631 8355-NORMAL-ENDING.
  9632
  9633     COMPUTE INFORCE-DOLLARS ROUNDED =
  9634        (TEMP-RESULT-L * UNEXPIRED-MONTHS) + CR-LFAMT-ALT.
  9635
  9636     IF REINSURANCE-PASS OR REINSURANCE-REC
  9637         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9638          COMPUTE INFORCE-DOLLARS ROUNDED =
  9639          (TEMP-RESULT-L * UNEXPIRED-MONTHS) +
  9640          (CR-LFAMT-ALT * RC-CEDE-FACT).
  9641
  9642     GO TO 8390-OB-ADJ.
  9643
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 194
* ECS150.cbl
  9644 8360-TEXAS-ENDING.
  9645     DIVIDE CR-LFAMT  BY  CR-LF-TERM
  9646         GIVING TEX-FACT-1.
  9647     DIVIDE UNEXPIRED-MONTHS  BY  CR-PMT-FREQ
  9648         GIVING TEX-FACT-2
  9649         REMAINDER TEX-FACT-3.
  9650     IF TEX-FACT-3 NOT ZERO
  9651         ADD +1 TO TEX-FACT-2.
  9652     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  9653         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9654     ELSE
  9655         COMPUTE INFORCE-DOLLARS ROUNDED =
  9656             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
  9657
  9658****************************************************************
  9659*    DIVIDE VALUATION-DATE BY CR-PMT-FREQ
  9660*        GIVING TEX-FACT-2
  9661*            REMAINDER TEX-FACT-3.
  9662*    IF TEX-FACT-3 NOT = ZERO
  9663*        ADD +1 TO TEX-FACT-2.
  9664*    COMPUTE INFORCE-DOLLARS =
  9665*         (TEMP-RESULT-L * (TEX-FACT-2 * CR-PMT-FREQ)).
  9666
  9667     GO TO 8390-OB-ADJ.
  9668
  9669 8370-NET-PAY-ENDING.
  9670
  9671     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  9672     MOVE 'L'                    TO  DC-OPTION-CODE.
  9673     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9674             8599-DATE-CONVERT-X.
  9675     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  9676
  9677     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  9678         MOVE CR-LOAN-1ST-PMT-DT TO  DC-GREG-DATE-1-YMD
  9679         MOVE '3'                TO  DC-OPTION-CODE
  9680         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9681                 8599-DATE-CONVERT-X
  9682         MOVE DC-BIN-DATE-1      TO  CP-FIRST-PAY-DATE
  9683     ELSE
  9684         MOVE CP-CERT-EFF-DT     TO  DC-BIN-DATE-1
  9685         MOVE +1                 TO  DC-ELAPSED-MONTHS
  9686         MOVE +0                 TO  DC-ELAPSED-DAYS
  9687         MOVE '6'                TO  DC-OPTION-CODE
  9688         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9689                 8599-DATE-CONVERT-X
  9690         MOVE DC-BIN-DATE-2      TO  CP-FIRST-PAY-DATE.
  9691
  9692     MOVE CR-LFAMT               TO  CP-ORIGINAL-BENEFIT.
  9693     MOVE CR-APR                 TO  CP-LOAN-APR.
  9694     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM.
  9695     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  9696     MOVE CP-REMAINING-TERM-2    TO  CP-REMAINING-TERM.
  9697     MOVE STATE-ABBR       (CLAS-INDEXS) TO  CP-STATE-STD-ABBRV.
  9698     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
  9699     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  9700     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
  9701
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 195
* ECS150.cbl
  9702
  9703     if dte-client = 'AHL'
  9704        move +14                 to cp-loan-apr
  9705     end-if
  9706
  9707     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  9708
  9709     IF SUMMARY-REC
  9710         COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9711                                      (INFORCE-DOLLARS / +1000)
  9712         GO TO 8390-OB-ADJ.
  9713
  9714     IF CP-STATE-STD-ABBRV = 'NC'
  9715               AND
  9716*      DTE-CLIENT NOT = 'WDS'
  9717       (DTE-CLIENT NOT = 'WDS' AND 'CID')
  9718         IF CP-CERT-EFF-DT GREATER THAN WS-931231
  9719             MOVE CP-REMAINING-AMT TO INFORCE-DOLLARS
  9720             GO TO 8390-OB-ADJ.
  9721
  9722      COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9723                                      (CR-LFAMT / +1000).
  9724
  9725     GO TO 8390-OB-ADJ.
  9726
  9727 8375-FLU-ENDING.
  9728     MOVE CR-APR                 TO NP-APR.
  9729     MOVE CR-LF-TERM             TO NP-ORIG  NP-CAP.
  9730     COMPUTE NP251-REM = CR-LF-TERM - TERM-WORK.
  9731     MOVE '1'                    TO NP-OPT.
  9732     MOVE CR-AHPRM               TO NP-AHPRM.
  9733     MOVE CR-ACCOUNT             TO NP-ACCOUNT.
  9734     MOVE CR-DT                  TO NP-EFF-DT.
  9735     MOVE CR-LFAMT               TO NP-BENEFIT.
  9736***  CALL 'IBKE251B'
  9737***      USING NP-ACCOUNT NP-EFF-DT NP-BENEFIT NP-AHPRM NP251-REM
  9738***            NP251-ORIG NP-SUB NP-REMAINING.
  9739     MOVE NP-REMAINING           TO INFORCE-DOLLARS.
  9740     GO TO 8390-OB-ADJ.
  9741
  9742 8390-OB-ADJ.
  9743     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9744         MOVE ZERO               TO INFORCE-DOLLARS.
  9745
  9746 8300-EXIT.
  9747     EXIT.
  9748
  9749 8400-ADD-TO-EXHIBIT.
  9750     IF GROUP-INS
  9751         ADD COUNT-WORK      TO GROUP-CNT (CL  TG  EG)
  9752         ADD INFORCE-DOLLARS TO GROUP-AMT (CL  TG  EG)
  9753     ELSE
  9754         ADD COUNT-WORK      TO IND-CNT (CL  TG  EG)
  9755         ADD INFORCE-DOLLARS TO IND-AMT (CL  TG  EG).
  9756
  9757 8400-EXIT.
  9758     EXIT.
  9759
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 196
* ECS150.cbl
  9761 8450-RE-RATE-ROUTINE.
  9762
  9763     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  9764     MOVE 'L'                    TO  DC-OPTION-CODE.
  9765     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  9766     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  9767     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO  CP-BENEFIT-TYPE.
  9768     MOVE SPACES                 TO  CP-ACCT-FLD-5.
  9769     MOVE DTE-CLIENT             TO  CP-COMPANY-ID.
  9770     MOVE STATE-SUB (CLAS-INDEXS)    TO  CP-STATE.
  9771     MOVE STATE-ABBR (CLAS-INDEXS)   TO  CP-STATE-STD-ABBRV.
  9772
  9773     IF CR-AGE IS NOT NUMERIC
  9774         MOVE ZEROS              TO  CP-ISSUE-AGE
  9775     ELSE
  9776         MOVE CR-AGE             TO  CP-ISSUE-AGE.
  9777
  9778     MOVE CP-REMAINING-TERM-1    TO  CP-ORIGINAL-TERM.
  9779     MOVE CR-AHAMT               TO  CP-ORIGINAL-BENEFIT
  9780                                     CP-RATING-BENEFIT-AMT.
  9781
  9782     IF CP-STATE-STD-ABBRV = 'OR'
  9783         COMPUTE CP-RATING-BENEFIT-AMT =
  9784                                CR-AHAMT * CP-REMAINING-TERM-1.
  9785
  9786     MOVE CR-APR                 TO  CP-LOAN-APR.
  9787
  9788     IF CR-PMT-FREQ IS NOT NUMERIC
  9789         MOVE ZEROS              TO  CP-PAY-FREQUENCY
  9790     ELSE
  9791         MOVE CR-PMT-FREQ        TO  CP-PAY-FREQUENCY.
  9792
  9793     IF AH-EARN-METHOD = SPACES
  9794         MOVE CLAS-I-EP (CLAS-INDEXA) TO  CP-EARNING-METHOD
  9795     ELSE
  9796         MOVE AH-EARN-METHOD          TO  CP-EARNING-METHOD.
  9797
  9798     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  9799         MOVE CR-RATING-CLASS    TO  CP-CLASS-CODE
  9800     ELSE
  9801         MOVE AM-CAL-TABLE       TO  CP-CLASS-CODE.
  9802
  9803     MOVE '3'                    TO  CP-PROCESS-TYPE.
  9804     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO  CP-SPECIAL-CALC-CD.
  9805     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  9806     MOVE AM-AH-DEVIATION        TO  CP-DEVIATION-CODE.
  9807     MOVE CR-AHTYP               TO  CP-BENEFIT-CD.
  9808     MOVE DTE-CLASIC-COMPANY-CD  TO  CP-COMPANY-CD.
  9809
  9810     IF CR-PMT-EXTENSION-DAYS IS NOT NUMERIC
  9811         MOVE ZEROS              TO  CP-TERM-OR-EXT-DAYS
  9812     ELSE
  9813         MOVE CR-PMT-EXTENSION-DAYS  TO  CP-TERM-OR-EXT-DAYS.
  9814
  9815     MOVE AH-OVERRIDE-L1         TO  CP-AH-OVERRIDE-CODE.
  9816
  9817     IF AM-AH-DEVIATION-PCT IS NOT NUMERIC
  9818         MOVE ZEROS              TO  CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 197
* ECS150.cbl
  9819     ELSE
  9820         MOVE AM-AH-DEVIATION-PCT TO CP-RATE-DEV-PCT.
  9821
  9822 8455-CALL-RATING-ROUTINE.
  9823
  9824     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9825
  9826 8499-EXIT.
  9827     EXIT.
  9828
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 198
* ECS150.cbl
  9830 8500-DATE-CONVERT-ROUTINE.
  9831
* 9832     COPY ELCDCS.
  9833****************************************************************  04/15/98
  9834*                                                              *  ELCDCS
  9835*                                                              *  ELCDCS
  9836*                            ELCDCS.                           *     LV003
  9837*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  9838*                            VMOD=2.002                        *     CL**3
  9839*                                                              *  ELCDCS
  9840*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  9841****************************************************************. ELCDCS
  9842                                                                  ELCDCS
  9843 8510-DATE-CONVERSION.                                            ELCDCS
  9844     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  9845                                                                  ELCDCS
  9846 8590-EXIT.                                                       ELCDCS
  9847     EXIT.                                                        ELCDCS
  9848                                                                  ELCDCS
  9849
  9850 8599-DATE-CONVERT-X.
  9851     EXIT.
  9852
  9853 REIN-DATE-LOAD.
  9854     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.
  9855     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.
  9856     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.
  9857
  9858 9990-PROGRAM-END            SECTION 45.
  9859
  9860 9999-CLOSE-FICH.
* 9861                             COPY ELCPRTC.
  9862******************************************************************04/15/98
  9863*                                                                *ELCPRTC
  9864*                                                                *ELCPRTC
  9865*                            ELCPRTC.                            *   LV003
  9866*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9867*                            VMOD=2.002                          *   CL**2
  9868*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  9869*                                                                *ELCPRTC
  9870* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  9871******************************************************************ELCPRTC
  9872                                                                  ELCPRTC
  9873      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  9874          CLOSE FICH.                                             ELCPRTC
  9875                                                                  ELCPRTC
  9876******************************************************************ELCPRTC
  9877
  9878     CLOSE PRINT-FILE.
  9879
  9880     IF REIN-OPEN-SW EQUAL 'X'
  9881            MOVE SPACE           TO REIN-OPEN-SW
  9882            CLOSE ERRTBL-IN
  9883            IF ERRTBL-FILE-STATUS = '00'
  9884               NEXT SENTENCE
  9885            ELSE
  9886               MOVE '22'         TO ABEND-FILE-ID
  9887               MOVE ERRTBL-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 199
* ECS150.cbl
  9888                                 TO ABEND-REASON
  9889               GO TO ABEND-PGM.
  9890*
  9891*
  9892* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
  9893
  9894     MOVE ZEROS  TO RETURN-CODE.
  9895     GOBACK.
  9896
  9897 9999-EXIT.
  9898     EXIT.
  9899
  9900 ABEND-PGM.
* 9901                                 COPY ELCABEND.
  9902***************************************************************** 04/14/98
  9903*                                                               * ELCABEND
  9904*                            ELCABEND.                          *    LV003
  9905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9906*                            VMOD 2.002                              CL**2
  9907*                                                               * ELCABEND
  9908*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  9909*            AND THEN ABENDS.                                   * ELCABEND
  9910*                                                               * ELCABEND
  9911*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  9912*                                                               * ELCABEND
  9913***************************************************************** ELCABEND
  9914*APS-010.                                                         ELCABEND
  9915     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  9916     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  9917                                                                  ELCABEND
  9918     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  9919         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  9920         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  9921                                 UPON CONSOLE.                    ELCABEND
  9922                                                                  ELCABEND
  9923     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  9924         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  9925         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  9926                                 UPON CONSOLE.                    ELCABEND
  9927                                                                  ELCABEND
  9928     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  9929     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  9930                                 UPON CONSOLE.                    ELCABEND
  9931                                                                  ELCABEND
  9932     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  9933     CALL 'ABORTME'.
  9934                                                                  ELCABEND
  9935 APS-EXIT.                                                        ELCABEND
  9936     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  178
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:      304388     Code:       47456
