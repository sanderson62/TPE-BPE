* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page   1
* ECS010.cbl
* Options: int("ECS010.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page   2
* ECS010.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66* 040109  CR2009031600001  AJRA  ADD VIN TO CERT TRLR.
    67* 093009  CR2009010500002  PEMA  CORRECT EARNED COMMISSION CALC
    68* 121609  CR2008112100001  AJRA  CORRECT AL, TX, VA STATE STAT EP
    69* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70* 042110  CR2010010400006  PEMA  ADD PC FIELDS FOR EMERALD 032
    71* 072810  CR2010010400004  PEMA  FACT IN ORG PREM FOR VA ROA
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page   3
* ECS010.cbl
    72* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    73* 101110  CR2010012700001  PEMA  ADD DDF REFUND/UEP PROCESSING
    74* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    75* 120511  IR2011112300001  PEMA  CORRECT JOINT AH ONLY ISSUE
    76* 012711  IR2012010500001  PEMA  CORRECT UEP-CLP-FACT
    77* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    78* 032612  CR2011110200001  PEMA  AHL CHANGES
    79* 071112  IR2012070600001  PEMA  SPP CORRECTIONS
    80* 072512  CR2012060400001  PEMA  ADD NEW EXTRACT FOR CU DIRECT
    81* 011013  IR2013010700002  PEMA  CORRECT INCURRED DATE ISSUE
    82* 100413  IR2013100100001  PEMA  INCREASE PDEF OCCURS
    83******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page   4
* ECS010.cbl
    85 ENVIRONMENT DIVISION.
    86 CONFIGURATION SECTION.
    87 SPECIAL-NAMES.
    88     C02 IS LCP-CH2
    89     C03 IS LCP-CH3
    90     C04 IS LCP-CH4
    91     C05 IS LCP-CH5
    92     C06 IS LCP-CH6
    93     C07 IS LCP-CH7
    94     C08 IS LCP-CH8
    95     C09 IS LCP-CH9
    96     C10 IS LCP-CH10
    97     C11 IS LCP-CH11
    98     C12 IS LCP-CH12
    99     S01 IS LCP-P01
   100     S02 IS LCP-P02.
   101
   102 INPUT-OUTPUT SECTION.
   103 FILE-CONTROL.
   104
   105     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
   106
   107     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
   108
   109     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
   110                             ACCESS IS SEQUENTIAL
   111                             ORGANIZATION IS INDEXED
   112                             FILE STATUS IS ERACCTT-FILE-STATUS
   113                             RECORD KEY IS AM-CONTROL-PRIMARY.
   114
   115     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
   116                             ACCESS IS DYNAMIC
   117                             ORGANIZATION IS INDEXED
   118                             FILE STATUS IS ERRTBL-FILE-STATUS
   119                             RECORD KEY IS RE-CONTROL-PRIMARY.
   120
   121     SELECT ERCTBL           ASSIGN TO ERCTBLT
   122                             ACCESS IS DYNAMIC
   123                             ORGANIZATION IS INDEXED
   124                             FILE STATUS IS ERCTBL-FILE-STATUS
   125                             RECORD KEY IS CT-CONTROL-PRIMARY.
   126
   127     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   128                             ORGANIZATION INDEXED
   129                             ACCESS DYNAMIC
   130                             RECORD KEY ME-CONTROL-PRIMARY
   131                             FILE STATUS ERMEBL-FILE-STATUS.
   132
   133     SELECT ERRESC-IN        ASSIGN TO ERRESC
   134                             ORGANIZATION IS INDEXED
   135                             ACCESS IS DYNAMIC
   136                             RECORD KEY IS ERRESC-RECORD-KEY
   137                             FILE STATUS IS ERRESC-FILE-STATUS.
   138
   139     SELECT ELCRTT           ASSIGN TO ELCRTT
   140                             ACCESS IS DYNAMIC
   141                             ORGANIZATION IS INDEXED
   142                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page   5
* ECS010.cbl
   143                             RECORD KEY IS CS-CONTROL-PRIMARY.
   144
   145     SELECT ERAGTC           ASSIGN TO ERAGTC
   146                             ACCESS IS DYNAMIC
   147                             ORGANIZATION IS INDEXED
   148                             FILE STATUS IS ERAGTC-FILE-STATUS
   149                             RECORD KEY IS AG-CONTROL-PRIMARY.
   150
   151     SELECT ERPDEF           ASSIGN TO ERPDEF
   152                             ACCESS IS DYNAMIC
   153                             ORGANIZATION IS INDEXED
   154                             FILE STATUS IS ERPDEF-FILE-STATUS
   155                             RECORD KEY IS PD-CONTROL-PRIMARY.
   156
   157     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   158
   159     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   160
   161     SELECT NEW-DETAIL-EXTR  ASSIGN TO SYS014.
   162
   163     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   164
   165
   166     SELECT ME-ECS010-BALANCE
   167                             ASSIGN TO SYS012
   168                             ORGANIZATION IS LINE SEQUENTIAL.
   169
   170     SELECT ME50-ECS010-BALANCE
   171                             ASSIGN TO SYS013
   172                             ORGANIZATION IS LINE SEQUENTIAL.
   173
   174     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   175
   176     SELECT DISK-DATE        ASSIGN TO SYS019.
   177
   178     SELECT PRINT-COPY       ASSIGN TO SYS008.
   179
   180     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   181
   182     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page   6
* ECS010.cbl
   184 DATA DIVISION.
   185 FILE SECTION.
   186
   187 FD  PENDING-EXTRACT
   188     BLOCK CONTAINS 0 RECORDS
   189     RECORDING MODE F.
   190
*  191                             COPY ERCEXTD.
   192******************************************************************04/29/98
   193*                                                                *ERCEXTD
   194*                                                                *ERCEXTD
   195*                            ERCEXTD                             *   LV002
   196*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   197*                            VMOD=2.002                          *   CL**2
   198*                                                                *ERCEXTD
   199*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   200*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   201*                                                                *ERCEXTD
   202*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   203*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   204*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   205*                                                                *ERCEXTD
   206*         RECORD                                                 *ERCEXTD
   207*          TYPE          PROGRAM USING                           *ERCEXTD
   208*        --------        --------------------------------        *ERCEXTD
   209*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   210*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   211*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   212*                                                                *ERCEXTD
   213* -------------------------------------------------------------- *ERCEXTD
   214*                                                                *ERCEXTD
   215*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   216*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   217*                                                                *ERCEXTD
   218*   FILENAME = EREXTD                                            *ERCEXTD
   219*                                                                *ERCEXTD
   220******************************************************************ERCEXTD
   221                                                                  ERCEXTD
   222 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   223     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   224         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   225                                                                  ERCEXTD
   226     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   227         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   228         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   229         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   230                                                                  ERCEXTD
   231     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   232                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page   7
* ECS010.cbl
   234 FD  CERT-MASTER-IN
*  235                             COPY ECSCRIFD.
   236******************************************************************07/10/97
   237*                                                                *ECSCRIFD
   238*                            ECSCRIFD                            *   LV001
   239*                            VMOD 2.005                          *ECSCRIFD
   240*                                                                *ECSCRIFD
   241*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   242*                                                                *ECSCRIFD
   243******************************************************************ECSCRIFD
   244     BLOCK CONTAINS 0 RECORDS
   245     RECORDING MODE F.                                            ECSCRIFD
   246                                                                  ECSCRIFD
   247 01  CERT-IN-RECORD.                                              ECSCRIFD
   248                                                                  ECSCRIFD
   249     12  FILLER                            PIC XXX.               ECSCRIFD
   250     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   251     12  FILLER                            PIC X(66).             ECSCRIFD
   252     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   253     12  FILLER                            PIC X(20).             ECSCRIFD
   254     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   255     12  FILLER                            PIC X(14).             ECSCRIFD
   256     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   257     12  FILLER                            PIC X(39).             ECSCRIFD
   258     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   259     12  FILLER                            PIC X(45).             ECSCRIFD
   260     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   261     12  FILLER                            PIC X(35).             ECSCRIFD
   262     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   263     12  FILLER                            PIC X(41).             ECSCRIFD
   264     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   265     12  FILLER                            PIC X(48).             ECSCRIFD
   266     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   267     12  FILLER                            PIC X(9).              ECSCRIFD
   268     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   269     12  FILLER                            PIC X(120).            ECSCRIFD
   270     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   271     12  FILLER                            PIC X(73).             ECSCRIFD
   272     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   273     12  FILLER                            PIC X(464).            ECSCRIFD
   274                                                                  ECSCRIFD
   275******************************************************************ECSCRIFD
   276
   277 01  CI-RECORD.
   278     12  FILLER          PIC  X(03).
   279     12  CI-ACCOUNT-CONTROL.
   280         16  CI-CARRIER      PIC  X(01).
   281         16  CI-GROUPING     PIC  X(06).
   282         16  CI-STATE        PIC  X(02).
   283         16  CI-ACCOUNT      PIC  X(10).
   284     12  FILLER          PIC  X(06).
   285     12  CI-CERT-NO.
   286         16  CI-CERT     PIC X(10).
   287         16  CI-CERT-SFX PIC X.
   288     12  FILLER          PIC  X(1017).
   289
   290******************************************************
   291*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page   8
* ECS010.cbl
   292*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   293*   COMMERCIAL FEDERAL BANK
   294******************************************************
   295 01  CF-RECORD.
   296     12  FILLER          PIC X(759).
   297     12  CF-THIRD-AGENT  PIC X(10).
   298     12  FILLER          PIC X(7).
   299     12  CF-FOURTH-AGENT PIC X(10).
   300     12  FILLER          PIC X(270).
   301
   302******************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page   9
* ECS010.cbl
   304 FD  ERACCTT-IN.
   305
*  306                             COPY ERCACCT.
   307******************************************************************04/19/98
   308*                                                                *ERCACCT
   309*                                                                *ERCACCT
   310*                            ERCACCT                             *   LV031
   311*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   312*                            VMOD=2.031                          *ERCACCT
   313*                                                                *ERCACCT
   314*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   315*                                                                *ERCACCT
   316*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   317*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   318*                                                                *ERCACCT
   319*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   320*                                                                *ERCACCT
   321*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   322*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   323*                                                                *ERCACCT
   324*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   325*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   326*                                                                *ERCACCT
   327*   LOG = NO                                                     *ERCACCT
   328*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   329*                                                                *ERCACCT
   330*                                                                *ERCACCT
   331******************************************************************ERCACCT
   332*                   C H A N G E   L O G
   333*
   334* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   335*-----------------------------------------------------------------
   336*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   337* EFFECTIVE    NUMBER
   338*-----------------------------------------------------------------
   339* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   340* 092705    2005050300006  PEMA  ADD SPP LEASES
   341* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   342* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   343* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   344* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   345* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   346******************************************************************
   347                                                                  ERCACCT
   348 01  ACCOUNT-MASTER.                                              ERCACCT
   349     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   350         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   351                                                                  ERCACCT
   352     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   353         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   354         16  AM-MSTR-CNTRL.                                       ERCACCT
   355             20  AM-CONTROL-A.                                    ERCACCT
   356                 24  AM-CARRIER            PIC X.                 ERCACCT
   357                 24  AM-GROUPING.                                 ERCACCT
   358                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   359                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   360                 24  AM-STATE              PIC XX.                ERCACCT
   361                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  10
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   362                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   363                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   364             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   365                                           PIC X(19).             ERCACCT
   366             20  AM-CNTRL-B.                                      ERCACCT
   367                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   368                 24  FILLER                PIC X(4).              ERCACCT
   369             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   370                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   371                                                                  ERCACCT
   372     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   373         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   374         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   375         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   376         16  AM-VG-STATE                   PIC XX.                ERCACCT
   377         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   378         16  AM-VG-DATE.                                          ERCACCT
   379             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   380             20  FILLER                    PIC X(4).              ERCACCT
   381         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   382                                           PIC 9(11)      COMP-3. ERCACCT
   383     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   384         16  FILLER                        PIC X(10).
   385         16  AM-VG-KEY3.
   386             20  AM-VG3-ACCOUNT            PIC X(10).
   387             20  AM-VG3-EXP-DT             PIC XX.
   388         16  FILLER                        PIC X(4).
   389     12  AM-MAINT-INFORMATION.                                    ERCACCT
   390         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   391         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   392         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   393         16  FILLER                        PIC XX.                ERCACCT
   394                                                                  ERCACCT
   395     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   396     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   397                                                                  ERCACCT
   398     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   399         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   400         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   401                                                                  ERCACCT
   402     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   403     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   404                                                                  ERCACCT
   405     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   406     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   407                                                                  ERCACCT
   408     12  AM-NAME                           PIC X(30).             ERCACCT
   409     12  AM-PERSON                         PIC X(30).             ERCACCT
   410     12  AM-ADDRS                          PIC X(30).             ERCACCT
   411     12  AM-CITY.
   412         16  AM-ADDR-CITY                  PIC X(28).
   413         16  AM-ADDR-STATE                 PIC XX.
   414     12  AM-ZIP.                                                  ERCACCT
   415         16  AM-ZIP-PRIME.                                        ERCACCT
   416             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   417                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   418             20  FILLER                    PIC X(4).              ERCACCT
   419         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  11
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   420     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   421         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   422         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   423         16  FILLER                        PIC XXX.               ERCACCT
   424     12  AM-TEL-NO.                                               ERCACCT
   425         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   426         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   427         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   428     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   429         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   430         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   431                                                                  ERCACCT
   432     12  AM-COMM-STRUCTURE.                                       ERCACCT
   433         16  AM-DEFN-1.                                           ERCACCT
   434             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   435                 24  AM-AGT.                                      ERCACCT
   436                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   437                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   438                 24  AM-COM-TYP            PIC X.                 ERCACCT
   439                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   440                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   441                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   442                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   443                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   444                 24  AM-GL-CODES           PIC X.                 ERCACCT
   445                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   446                 24  FILLER                PIC X(01).             ERCACCT
   447         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   448             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   449                 24  FILLER                PIC X(11).             ERCACCT
   450                 24  AM-L-COMA             PIC XXX.               ERCACCT
   451                 24  AM-J-COMA             PIC XXX.               ERCACCT
   452                 24  AM-A-COMA             PIC XXX.               ERCACCT
   453                 24  FILLER                PIC X(6).              ERCACCT
   454                                                                  ERCACCT
   455     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   456         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   457                                                                  ERCACCT
   458     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   459                                                                  ERCACCT
   460     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   461         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   462         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   463     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   464         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   465         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   466     12  AM-GPCD                           PIC 99.                ERCACCT
   467     12  AM-IG                             PIC X.                 ERCACCT
   468         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   469         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   470     12  AM-STATUS                         PIC X.                 ERCACCT
   471         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   472         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   473         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   474         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   475         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   476         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   477     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  12
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   478     12  AM-ID-NO                          PIC X(11).             ERCACCT
   479                                                                  ERCACCT
   480     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   481     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   482     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   483     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   484     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   485     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   486     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   487     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   488     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   489                                                                  ERCACCT
   490     12  AM-USER-FIELDS.                                          ERCACCT
   491         16  AM-FLD-1                      PIC XX.                ERCACCT
   492         16  AM-FLD-2                      PIC XX.                ERCACCT
   493         16  AM-FLD-3                      PIC XX.                ERCACCT
   494         16  AM-FLD-4                      PIC XX.                ERCACCT
   495         16  AM-FLD-5                      PIC XX.                ERCACCT
   496                                                                  ERCACCT
   497     12  AM-1ST-PROD-DATE.                                        ERCACCT
   498         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   499         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   500         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   501     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   502     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   503         16  AM-PUR-YR                     PIC XX.                ERCACCT
   504         16  AM-PUR-MO                     PIC XX.                ERCACCT
   505         16  AM-PUR-DA                     PIC XX.                ERCACCT
   506     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   507     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   508     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   509     12  AM-INACTIVE-DATE.                                        ERCACCT
   510         16  AM-INA-MO                     PIC 99.                ERCACCT
   511         16  AM-INA-DA                     PIC 99.                ERCACCT
   512         16  AM-INA-YR                     PIC 99.                ERCACCT
   513     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   514                                                                  ERCACCT
   515     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   516     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   517                                                                  ERCACCT
   518     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   519         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   520         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   521         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   522         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   523                                                                  ERCACCT
   524     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   525         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   526         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   527                                                                  ERCACCT
   528     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   529                                                                  ERCACCT
   530     12  AM-OVER-SHORT.                                           ERCACCT
   531         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   532         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   533                                                                  ERCACCT
   534     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   535     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  13
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   536                                                                  ERCACCT
   537     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   538     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   539                                                                  ERCACCT
   540     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   541     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   542     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   543     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   544     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   545     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   546     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   547     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   548     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   549     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   550     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   551     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   552     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   553     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   554     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   555     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   556                                                                  ERCACCT
   557     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   558                                                                  ERCACCT
   559     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   560     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   561                                                                  ERCACCT
   562     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   563     12  AM-EARN-METHODS.                                         ERCACCT
   564         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   565             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   566             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   567             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   568             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   569         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   570             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   571             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   572             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   573             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   574         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   575             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   576             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   577             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   578             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   579             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   580             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   581                                                                  ERCACCT
   582     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   583     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   584     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   585                                                                  ERCACCT
   586     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   587     12  AM-RET-P-E                        PIC X.                 ERCACCT
   588     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   589     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   590     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   591     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   592         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   593         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  14
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   594     12  AM-RETRO-EARNINGS.                                       ERCACCT
   595         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   596         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   597         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   598     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   599         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   600         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   601     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   602         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   603         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   604         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   605     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   606     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   607                                                                  ERCACCT
   608     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   609         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   610         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   611         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   612         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   613         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   614                                                                  ERCACCT
   615     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   616                                                                  ERCACCT
   617     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   618                                                                  ERCACCT
   619     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   620         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   621                                                                  ERCACCT
   622     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   623         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   624         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   625                                                                  ERCACCT
   626     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   627         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   628                                                                  ERCACCT
   629     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   630         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   631         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   632                                                                  ERCACCT
   633     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   634                                                                  ERCACCT
   635     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   636     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   637     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   638     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   639     12  AM-DCC-UEF-STATE                  PIC XX.
   640     12  FILLER                            PIC XXX.
   641     12  AM-REPORT-CODE-3                  PIC X(10).
   642*    12  FILLER                            PIC X(22).             ERCACCT
   643                                                                  ERCACCT
   644     12  AM-RESERVE-DATE.                                         ERCACCT
   645         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   646         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   647         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   648                                                                  ERCACCT
   649     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   650     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   651         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  15
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   652         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   653         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   654         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   655                                                                  ERCACCT
   656     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   657         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   658         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   659         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   660         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   661                                                                  ERCACCT
   662     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   663         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   664             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   665             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   666             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   667             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   668             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   669             20  FILLER                    PIC XX.                ERCACCT
   670         16  FILLER                        PIC X(80).             ERCACCT
   671                                                                  ERCACCT
   672     12  AM-TRANSFER-DATA.                                        ERCACCT
   673         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   674             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   675             20  AM-TRNFROM-GROUPING.                             ERCACCT
   676                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   677                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   678             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   679             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   680                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   681                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   682             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   683         16  AM-TRANSFERRED-TO.                                   ERCACCT
   684             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   685             20  AM-TRNTO-GROUPING.                               ERCACCT
   686                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   687                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   688             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   689             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   690                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   691                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   692             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   693         16  FILLER                        PIC X(10).             ERCACCT
   694                                                                  ERCACCT
   695     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   696                                                                  ERCACCT
   697     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   698         16  AM-DEFN-1-SAVED.                                     ERCACCT
   699             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   700                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   701                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   702                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   703                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   704                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   705                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   706                 24  FILLER                PIC X.                 ERCACCT
   707                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   708                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   709                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  16
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   710         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   711             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   712                 24  FILLER                PIC X(11).             ERCACCT
   713                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   714                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   715                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   716                 24  FILLER                PIC X(6).              ERCACCT
   717                                                                  ERCACCT
   718     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   719         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   720            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   721            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   722            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   723                                                                  ERCACCT
   724     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   725     12  FILLER                            PIC X(120).            ERCACCT
   726                                                                  ERCACCT
   727     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   728         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   729         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   730             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   731             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   732                                                          COMP-3. ERCACCT
   733             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   734                                                          COMP-3. ERCACCT
   735         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   736             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   737             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   738                                                          COMP-3. ERCACCT
   739             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   740                                                          COMP-3. ERCACCT
   741                                                                  ERCACCT
   742     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   743         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   744         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   745         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   746         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   747             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   748                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   749                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   750             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   751                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   752                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   753             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   754                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   755                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   756         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   757             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   758                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   759                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   760                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   761             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   762                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   763                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   764             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   765                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   766                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   767                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  17
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   768     12  AM-COMMENTS.                                             ERCACCT
   769         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   770                                                                  ERCACCT
   771     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   772         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   773         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   774         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   775         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   776         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   777             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   778             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   779             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   780             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   781         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   782             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   783             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   784             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   785         16  FILLER                        PIC X(102).            ERCACCT
   786                                                                  ERCACCT
   787     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   788         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   789             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   790             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   791             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   792             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   793             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   794         16  FILLER                          PIC X(10).           ERCACCT
   795******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  18
* ECS010.cbl
   797 FD  ERRTBL-IN.
   798
*  799                             COPY ERCREIN.
   800******************************************************************07/27/93
   801*                                                                *ERCREIN
   802*                            ERCREIN                             *   LV009
   803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   804*                            VMOD=2.010                          *   CL**9
   805*                                                                *ERCREIN
   806*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   807*                                                                *ERCREIN
   808*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   809*                                                                *ERCREIN
   810*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   811*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   812*                                                                *ERCREIN
   813*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   814*       ALTERNATE PATH = NONE                                    *ERCREIN
   815*                                                                *ERCREIN
   816*   LOG = NO                                                     *ERCREIN
   817*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   818*                                                                *ERCREIN
   819******************************************************************ERCREIN
   820*                   C H A N G E   L O G
   821*
   822* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   823*-----------------------------------------------------------------
   824*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   825* EFFECTIVE    NUMBER
   826*-----------------------------------------------------------------
   827* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   828* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   829******************************************************************
   830 01  REINSURANCE-RECORD.                                          ERCREIN
   831     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   832         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   833                                                                  ERCREIN
   834     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   835         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   836         16  RE-KEY.                                              ERCREIN
   837             20  RE-CODE                   PIC X.                 ERCREIN
   838                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   839                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   840             20  RE-TABLE                  PIC XXX.               ERCREIN
   841             20  FILLER                    PIC XXX.               ERCREIN
   842         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   843             20  FILLER                    PIC X.                 ERCREIN
   844             20  RE-COMPANY.                                      ERCREIN
   845                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   846                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   847                                                                  ERCREIN
   848     12  RE-MAINT-INFORMATION.                                    ERCREIN
   849         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   850         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   851         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   852         16  FILLER                        PIC X(10).             ERCREIN
   853                                                                  ERCREIN
   854     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  19
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   855         16  RE-100-COMP                   PIC 99.                ERCREIN
   856                                                                  ERCREIN
   857         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   858             20  RE-REI-COMP-NO.                                  ERCREIN
   859                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   860                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   861             20  RE-LF-QC                  PIC X.                 ERCREIN
   862             20  RE-AH-QC                  PIC X.                 ERCREIN
   863             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   864             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   865             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   866             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   867             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   868             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   869             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   870             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   871             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   872             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   873             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   874             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   875             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   876             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   877             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   878             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   879             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   880             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   881             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   882             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   883             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   884             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   885             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   886             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   887             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   888             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   889             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   890             20  RE-REMAINING              PIC X.                 ERCREIN
   891             20  RE-LF-RUNOFF-SW           PIC X.                      000
   892             20  RE-AH-RUNOFF-SW           PIC X.                      000
   893             20  FILLER                    PIC X(19).                  000
   894                                                                  ERCREIN
   895         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   896         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   897         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   898         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   899             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   900                                                                  ERCREIN
   901         16  FILLER                        PIC X(27).             ERCREIN
   902                                                                  ERCREIN
   903     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   904         16  RE-NAME                       PIC X(30).             ERCREIN
   905         16  RE-LF-PE                      PIC X.                 ERCREIN
   906         16  RE-AH-PE                      PIC X.                 ERCREIN
   907         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   908         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   909         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   910         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   911         16  RE-PRT-ST                     PIC X.                 ERCREIN
   912         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  20
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   913         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   914         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   915         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   916         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   917         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   918         16  RE-LF-COMM                    PIC X.                 ERCREIN
   919         16  RE-AH-COMM                    PIC X.                 ERCREIN
   920         16  RE-LF-TAX                     PIC X.                 ERCREIN
   921         16  RE-AH-TAX                     PIC X.                 ERCREIN
   922         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   923         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   924         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   925                                                                  ERCREIN
   926         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   927             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   928                                                                  ERCREIN
   929         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   930             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   931                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   932                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   933                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   934                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   935             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   936                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   937                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   938                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   939                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   940                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   941                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   942                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   943                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   944             20  FILLER                    PIC XXX.               ERCREIN
   945             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   946                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   947                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   948                                                                  ERCREIN
   949         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   950             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   951                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   952                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   953                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   954                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   955             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   956                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   957                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   958                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   959                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   960                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   961                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   962                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   963                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   964             20  FILLER                    PIC XXX.               ERCREIN
   965             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   966                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   967                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   968                                                                  ERCREIN
   969         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   970                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  21
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   971         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   972                                                                  ERCREIN
   973         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   974         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   975         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   976         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   977         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   978         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   979         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   980         16  RE-MORT-SW                    PIC X.                 ERCREIN
   981         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   982             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   983             88  RE-CEDED                          VALUE 'C'.        CL**2
   984             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   985             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   986                                                                  ERCREIN
   987         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   988             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   989         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   990             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   991         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   992             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   993         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   994             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   995         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   996             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   997                                                                     CL**3
   998         16  RE-PRT-CRSV                   PIC X.                    CL**5
   999                                                                     CL**5
  1000         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  1001                                                                     CL**8
  1002         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  1003                                                                     CL**8
  1004         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  1005                                                                     CL**9
  1006         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  1007             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  1008             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  1009
  1010         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  1011             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  1012                                                                     CL**9
  1013         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  1014         16  FILLER                        PIC X(2281).              CL**9
  1015                                                                  ERCREIN
  1016         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  1017                                                                  ERCREIN
  1018******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  22
* ECS010.cbl
  1020 FD  ERCTBL.
  1021
* 1022                             COPY ERCCTBL.
  1023******************************************************************04/29/98
  1024*                                                                *ERCCTBL
  1025*                                                                *ERCCTBL
  1026*                            ERCCTBL                             *   LV002
  1027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1028*                            VMOD=2.003                              CL**2
  1029*                                                                *ERCCTBL
  1030*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1031*                                                                *ERCCTBL
  1032*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1033*                                                                *ERCCTBL
  1034*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1035*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1036*                                                                *ERCCTBL
  1037*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1038*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1039*                                                                *ERCCTBL
  1040*   LOG = NO                                                     *ERCCTBL
  1041*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1042*                                                                *ERCCTBL
  1043*                                                                *ERCCTBL
  1044******************************************************************ERCCTBL
  1045                                                                  ERCCTBL
  1046 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1047     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1048         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1049                                                                  ERCCTBL
  1050     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1051         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1052         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1053         16  CT-CNTRL-2.                                          ERCCTBL
  1054             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1055             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1056                                                                  ERCCTBL
  1057     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1058         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1059         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1060         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1061         16  FILLER                        PIC X(31).             ERCCTBL
  1062                                                                  ERCCTBL
  1063     12  CT-LIMITS.                                               ERCCTBL
  1064         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1065                                                                  ERCCTBL
  1066         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1067                                                                  ERCCTBL
  1068         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1069                                                                  ERCCTBL
  1070     12  CT-RATES.                                                ERCCTBL
  1071         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1072             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1073             20  CT-RT-R   REDEFINES                              ERCCTBL
  1074                 CT-RT                     PIC XXX.               ERCCTBL
  1075                                                                  ERCCTBL
  1076     12  FILLER                            PIC  X(42).            ERCCTBL
  1077                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  23
* ECS010.cbl
  1078******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  24
* ECS010.cbl
  1080 FD  ERMEBL-INOUT.
  1081
* 1082                             COPY ERCMEBL.
  1083******************************************************************04/29/98
  1084*                                                                 ERCMEBL
  1085*                                                                 ERCMEBL
  1086*                            ERCMEBL                             *   LV004
  1087*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  1088*                            VMOD 2.004                          *   CL**2
  1089*                                                                *ERCMEBL
  1090*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  1091*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  1092*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  1093*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  1094*                                                                *ERCMEBL
  1095*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  1096*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  1097*                                                                *ERCMEBL
  1098*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  1099*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  1100*                                                                *ERCMEBL
  1101******************************************************************ERCMEBL
  1102                                                                  ERCMEBL
  1103 01  MONTH-END-BALANCES.                                          ERCMEBL
  1104     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  1105     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  1106         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  1107         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  1108     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1109     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1110     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1111     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1112     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1113     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1114     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1115     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1116     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1117     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1118     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1119     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1120     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  1121     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1122     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  1123     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  1124     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1125     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1126     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1127     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1128     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1129     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1130     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  1131     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  1132     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1133     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1134     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1135     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1136     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1137     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  25
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1138     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1139     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1140     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1141     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1142     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  1143     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  1144     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1145     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1146     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1147     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1148     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  1149     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  1150     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1151     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1152     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1153     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1154     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  1155     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  1156     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1157     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1158     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1159     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  1160     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  1161     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  1162     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1163     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1164     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1165     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1166     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  1167     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  1168     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1169     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1170     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1171     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  1172     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  1173     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1174     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1175     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1176     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  1177     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1178     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  1179     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1180     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1181     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1182     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  1183     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1184     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1185     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  1186     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1187     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1188     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  1189     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  1190     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1191     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  1192     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1193     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  1194     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  1195     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  26
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1196     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1197     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1198     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1199     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  1200     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  1201     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1202     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  1203     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1204     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  1205     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  1206     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1207     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  1208     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1209     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  1210     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  1211     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1212     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  1213     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1214     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  1215     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  1216     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1217     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  1218     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1219     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  1220     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  1221     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1222     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1223     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1224     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1225     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1226     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1227     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1228     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1229     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1230     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1231     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1232     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1233     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1234     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1235     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1236     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1237     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  1238     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  1239     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1240     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1241     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1242     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1243     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1244     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1245     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  1246     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  1247     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1248     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  1249     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1250     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  1251     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  1252     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1253     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  27
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1254     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1255     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1256     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  1257     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  1258     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1259     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  1260     12  FILLER                  PIC  X(88).                         CL**2
  1261******************************************************************ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  28
* ECS010.cbl
  1263 FD  CERT-MASTER-OUT
* 1264                             COPY ECSCROFD.
  1265******************************************************************07/10/97
  1266*                                                                *ECSCROFD
  1267*                            ECSCROFD                            *   LV001
  1268*                            VMOD=2.002                          *ECSCROFD
  1269*                                                                *ECSCROFD
  1270*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1271*                                                                *ECSCROFD
  1272******************************************************************ECSCROFD
  1273     RECORDING MODE F                                             ECSCROFD
  1274     LABEL RECORDS STANDARD                                       ECSCROFD
  1275     BLOCK CONTAINS 0 RECORDS
  1276     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1277 01  CERT-OUT-RECORD.                                             ECSCROFD
  1278     12  FILLER                            PIC  XXX.              ECSCROFD
  1279     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1280     12  FILLER                            PIC  X(1017).          ECSCROFD
  1281                                                                  ECSCROFD
  1282******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  29
* ECS010.cbl
  1284 FD  DETAIL-EXTR
  1285     BLOCK CONTAINS 0 RECORDS
  1286     RECORDING MODE F.
  1287
* 1288                             COPY ECSEXT01.
  1289******************************************************************04/29/98
  1290*                                                                *ECSEXT01
  1291*                            ECSEXT01                            *   LV015
  1292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1293*                            VMOD=2.015                          *ECSEXT01
  1294*                                                                *ECSEXT01
  1295*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1296*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1297*                                                                *ECSEXT01
  1298*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1299*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1300*                                                                *ECSEXT01
  1301*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1302*                                                                *ECSEXT01
  1303******************************************************************ECSEXT01
  1304******************************************************************
  1305*                   C H A N G E   L O G
  1306*
  1307* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1308*-----------------------------------------------------------------
  1309*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1310* EFFECTIVE    NUMBER
  1311*-----------------------------------------------------------------
  1312* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1313* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1314* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1315* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1316* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1317* 032612  CR2011110200001  PEMA  AHL CHANGES
  1318******************************************************************
  1319                                                                  ECSEXT01
  1320 01  DETAIL-EXTRACT.                                              ECSEXT01
  1321     02 DETAIL-FILE.                                              ECSEXT01
  1322     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1323         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1324                                                                  ECSEXT01
  1325     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1326                                                                  ECSEXT01
  1327     12  DE-REIN                           PIC X.                 ECSEXT01
  1328                                                                  ECSEXT01
  1329     12  DE-CONTROL.                                              ECSEXT01
  1330         16  DE-CNTRL1.                                           ECSEXT01
  1331             20  DE-CARRIER                PIC X.                 ECSEXT01
  1332             20  DE-GROUPING.                                     ECSEXT01
  1333                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1334                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1335             20  DE-STATE                  PIC XX.                ECSEXT01
  1336             20  DE-ACCOUNT.                                      ECSEXT01
  1337                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1338                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1339         16  DE-CNTRL2.                                           ECSEXT01
  1340             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1341             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  30
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1342                 24 DE-CERT-NO.                                   ECSEXT01
  1343                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1344                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1345                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1346                                                                  ECSEXT01
  1347     12  DE-TRANS                          PIC X.                 ECSEXT01
  1348         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1349         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1350         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1351         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1352         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1353         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1354         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1355         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1356         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1357         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1358                                                                  ECSEXT01
  1359     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1360     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1361                                                                  ECSEXT01
  1362     12  DE-NAME.                                                 ECSEXT01
  1363         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1364         16  DE-FNAME.                                            ECSEXT01
  1365             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1366             20  FILLER                    PIC X(9).              ECSEXT01
  1367         16  DE-INIT                       PIC X.                 ECSEXT01
  1368     12  DE-AGE                            PIC 99.                ECSEXT01
  1369     12  DE-SEX                            PIC X.                 ECSEXT01
  1370     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1371                                                                  ECSEXT01
  1372     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1373     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1374     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1375     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1376     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1377     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1378     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1379     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1380     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1381                                                                  ECSEXT01
  1382     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1383     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1384     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1385     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1386                                                                  ECSEXT01
  1387     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1388     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1389     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1390     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1391     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1392                                                                  ECSEXT01
  1393     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1394     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1395     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1396     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1397                                                                  ECSEXT01
  1398     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1399     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  31
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1400                                           PIC S9(5)V99   COMP-3.
  1401     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1402     12  FILLER REDEFINES DE-NUM-BILLED.
  1403         16  DE-CLP-STATE                  PIC XX.
  1404         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1405     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1406     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1407                                                                  ECSEXT01
  1408     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1409     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1410     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1411     12  DE-IG                             PIC X.                 ECSEXT01
  1412     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1413*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1414     12  DE-MEMBER-NO.                                            ECSEXT01
  1415         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1416         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1417         16  FILLER                        PIC X(03).             ECSEXT01
  1418     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1419                                                                  ECSEXT01
  1420     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1421         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1422                                                                  ECSEXT01
  1423     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1424     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1425                                                                  ECSEXT01
  1426     12  DE-REI-AREA.                                             ECSEXT01
  1427         16  DE-REI-COMP.                                         ECSEXT01
  1428             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1429             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1430         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1431         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1432         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1433         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1434         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1435         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1436         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1437                                                                  ECSEXT01
  1438     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1439     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1440         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1441         16  F                             PIC X.
  1442*    12  FILLER                            PIC X(5).              ECSEXT01
  1443                                                                  ECSEXT01
  1444     12  DE-BILLED-AREA.                                          ECSEXT01
  1445         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1446             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1447                                                                  ECSEXT01
  1448         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1449             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1450             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1451             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1452             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1453             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1454             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1455                                                                  ECSEXT01
  1456         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1457             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  32
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1458                                                                  ECSEXT01
  1459         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1460         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1461         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1462         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1463                                                                  ECSEXT01
  1464         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1465*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1466*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1467                                                                  ECSEXT01
  1468     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1469         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1470         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1471         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1472                                                                  ECSEXT01
  1473     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1474         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1475         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1476     12  DE-CANCEL-REASON                  PIC X.
  1477                                                                  ECSEXT01
  1478     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1479     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1480                                                                  ECSEXT01
  1481     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1482         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1483             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1484         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1485             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1486                                                                  ECSEXT01
  1487     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1488         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1489                                                                  ECSEXT01
  1490     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1491     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1492         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1493         16  FILLER                        PIC X.
  1494                                                                  ECSEXT01
  1495****************************************************************  ECSEXT01
  1496**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1497****************************************************************  ECSEXT01
  1498     12  DE-COMM-LEVELS.                                          ECSEXT01
  1499         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1500             20  DE-AGT.                                          ECSEXT01
  1501                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1502                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1503             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1504             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1505             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1506                                                                  ECSEXT01
  1507     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1508****************************************************************  ECSEXT01
  1509*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1510****************************************************************  ECSEXT01
  1511     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1512     12  FILLER                            PIC X(334).            ECSEXT01
  1513     12  DE-TYPE                           PIC X.                 ECSEXT01
  1514         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1515         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  33
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1516         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1517         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1518         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1519         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1520                                                                  ECSEXT01
  1521     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1522     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1523                                                                  ECSEXT01
  1524     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1525     12  DE-REPORTED.                                             ECSEXT01
  1526         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1527         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1528         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1529     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1530     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1531                                                                  ECSEXT01
  1532     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1533     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1534     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1535     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1536     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1537     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1538         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1539         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1540         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1541         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1542         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1543         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1544         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1545                                                                  ECSEXT01
  1546     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1547                                                                  ECSEXT01
  1548     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1549     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1550     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1551     12  FILLER                            PIC XX.                ECSEXT01
  1552     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1553                                                                  ECSEXT01
  1554     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1555     12  DE-BENEFICIARY                    PIC X(10).
  1556     12  filler redefines de-beneficiary.
  1557         16  de-birth-date                 pic 9(11)  comp-3.
  1558         16  f                             pic x(4).
  1559     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1560     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1561     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1562     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1563     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1564     12  DE-CLM-CLASS                      PIC XX.
  1565     12  DE-CLM-DEV                        PIC XXX.
  1566     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1567     12  de-xycor-cert-seq                 pic x(3).
  1568     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1569     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1570     12  DE-XYCOR-STATUS                   PIC X.
  1571     12  FILLER                            PIC X(4).              ECSEXT01
  1572                                                                  ECSEXT01
  1573     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  34
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1574                                                                  ECSEXT01
  1575****************************************************************  ECSEXT01
  1576*******               RESERVE EXTRACT                      *****  ECSEXT01
  1577****************************************************************  ECSEXT01
  1578     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1579     12  FILLER                            PIC X(334).            ECSEXT01
  1580                                                                  ECSEXT01
  1581     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1582         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1583         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1584                                                                  ECSEXT01
  1585     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1586     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1587     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1588                                                                  ECSEXT01
  1589     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1590                                                                  ECSEXT01
  1591     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1592     12  DE-RSV-REPORTED.                                         ECSEXT01
  1593         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1594         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1595         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1596     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1597                                                                  ECSEXT01
  1598     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1599     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1600     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1601                                                                  ECSEXT01
  1602     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1603     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1604     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1605                                                                  ECSEXT01
  1606     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1607                                                                  ECSEXT01
  1608     12  DE-RATE-CLASS                     PIC XX.
  1609     12  DE-DEV-CODE                       PIC XXX.
  1610     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1611     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1612     12  FILLER                            PIC X(58).             ECSEXT01
  1613                                                                  ECSEXT01
  1614     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1615******************************************************************ECSEXT01
  1616
  1617 FD  NEW-DETAIL-EXTR
  1618     BLOCK CONTAINS 0 RECORDS
  1619     RECORDING MODE F.
  1620
* 1621                                 COPY ECSEXX01.
  1622******************************************************************
  1623*                                                                *
  1624*                            ECSEXX01                            *
  1625*                            VMOD=2.015                          *
  1626*                                                                *
  1627*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *
  1628*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *
  1629*                                                                *
  1630*   FILE TYPE = SEQUENTIAL                                       *
  1631*   RECORD SIZE = 510  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  35
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1632*                                                                *
  1633*   KEY DATA =                                   START=5, LEN=36 *
  1634*                                                                *
  1635******************************************************************
  1636******************************************************************
  1637*                   C H A N G E   L O G
  1638*
  1639* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1640*-----------------------------------------------------------------
  1641*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1642* EFFECTIVE    NUMBER
  1643*-----------------------------------------------------------------
  1644*                                    TEMPORARY
  1645******************************************************************
  1646
  1647 01  NEW-DETAIL-EXTRACT.
  1648     02 NEW-DETAIL-FILE.
  1649     12  DX-RECORD-ID                      PIC XX.
  1650         88  VALID-DX-ID                      VALUE 'DX'.
  1651
  1652     12  DX-COMPANY-CD                     PIC X.
  1653
  1654     12  DX-REIN                           PIC X.
  1655
  1656     12  DX-CONTROL.
  1657         16  DX-CNTRL1.
  1658             20  DX-CARRIER                PIC X.
  1659             20  DX-GROUPING.
  1660                 24  DX-GROUP-PREFIX       PIC XXX.
  1661                 24  DX-GROUP-PRIME        PIC XXX.
  1662             20  DX-STATE                  PIC XX.
  1663             20  DX-ACCOUNT.
  1664                 24  DX-ACCT-PREFIX        PIC X(4).
  1665                 24  DX-ACCT-PRIME         PIC X(6).
  1666         16  DX-CNTRL2.
  1667             20  DX-EFF                    PIC 9(11)  COMP-3.
  1668             20  DX-CERT.
  1669                 24 DX-CERT-NO.
  1670                     28  DX-CRT-PREFIX     PIC XXX.
  1671                     28  DX-CRT-PRIME      PIC X(7).
  1672                 24  DX-CRT-SUF            PIC X.
  1673
  1674     12  DX-TRANS                          PIC X.
  1675         88  DX-ISSUE                         VALUE 'I'.
  1676         88  DX-RC-ISSUE                      VALUE '8'.
  1677         88  DX-CANCEL                        VALUE 'C'.
  1678         88  DX-RC-CANCEL                     VALUE '7'.
  1679         88  DX-CLAIM                         VALUE 'X'.
  1680         88  DX-RESTORE                       VALUE 'R'.
  1681         88  DX-RESERVE                       VALUE 'Y'.
  1682         88  DX-RR-RC-ISS                     VALUE 'J'.
  1683         88  DX-RR-RC-CNC                     VALUE 'K'.
  1684         88  DX-RR-RC-CLM                     VALUE 'L'.
  1685
  1686     12  DX-REPORT-CODX-1                  PIC X(10).
  1687     12  DX-REPORT-CODX-2                  PIC X(10).
  1688
  1689     12  DX-NAME.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  36
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1690         16  DX-LNAME                      PIC X(15).
  1691         16  DX-FNAME.
  1692             20  DX-1ST-INIT-FNAME         PIC X.
  1693             20  FILLER                    PIC X(9).
  1694         16  DX-INIT                       PIC X.
  1695     12  DX-AGE                            PIC 99.
  1696     12  DX-SEX                            PIC X.
  1697     12  DX-SOC-SEC-NO                     PIC X(11).
  1698
  1699     12  DX-LF-TYPE                        PIC XX.
  1700     12  DX-LF-TERM                        PIC 999        COMP-3.
  1701     12  DX-LF-BEN                         PIC S9(9)V99   COMP-3.
  1702     12  DX-LF-CNBEN                       PIC S9(9)V99   COMP-3.
  1703     12  DX-LF-PRM                         PIC S9(7)V99   COMP-3.
  1704     12  DX-LF-BEN-ALT                     PIC S9(9)V99   COMP-3.
  1705     12  DX-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3.
  1706     12  DX-LF-PRM-ALT                     PIC S9(7)V99   COMP-3.
  1707     12  DX-LF-RFND                        PIC S9(7)V99   COMP-3.
  1708
  1709     12  DX-LF-STAT-CDE                    PIC X.
  1710     12  DX-LF-PREV-STAT                   PIC X.
  1711     12  DX-LF-CANC-DTE                    PIC 9(11)      COMP-3.
  1712     12  DX-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3.
  1713
  1714     12  DX-AH-TYPE                        PIC XX.
  1715     12  DX-AH-TERM                        PIC 999        COMP-3.
  1716     12  DX-AH-BEN                         PIC S9(7)V99   COMP-3.
  1717     12  DX-AH-PRM                         PIC S9(7)V99   COMP-3.
  1718     12  DX-AH-RFND                        PIC S9(7)V99   COMP-3.
  1719
  1720     12  DX-AH-STAT-CDE                    PIC X.
  1721     12  DX-AH-PREV-STAT                   PIC X.
  1722     12  DX-AH-CANC-DTE                    PIC 9(11)  COMP-3.
  1723     12  DX-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.
  1724
  1725     12  DX-LIVES                          PIC S9(7)      COMP-3.
  1726     12  DX-ADDL-CLP REDEFINES DX-LIVES
  1727                                           PIC S9(5)V99   COMP-3.
  1728     12  DX-NUM-BILLED                     PIC S9(7)      COMP-3.
  1729     12  FILLER REDEFINES DX-NUM-BILLED.
  1730         16  DX-CLP-STATE                  PIC XX.
  1731         16  DX-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1732     12  DX-CANCEL-CNT-ITD                 PIC S999       COMP-3.
  1733     12  DX-CANCEL-CNT-YTD                 PIC S999       COMP-3.
  1734
  1735     12  DX-APR                            PIC S999V9(4)  COMP-3.
  1736     12  DX-PMT-FREQ                       PIC 99.
  1737     12  DX-ACC-GPCD                       PIC XX.
  1738     12  DX-IG                             PIC X.
  1739     12  DX-REMIT-TO                       PIC XX.
  1740*    12  DX-MEMBER-NO                      PIC X(12).
  1741     12  DX-MEMBER-NO.
  1742         16  DX-MASTER-POLICY              PIC X(06).
  1743         16  DX-ZIP                        PIC 9(05)    COMP-3.
  1744         16  FILLER                        PIC X(03).
  1745     12  DX-LN-OFFICER                     PIC XXX.
  1746
  1747     12  DX-AUTO-GEND-IND                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  37
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1748         88  DX-AUTO-GEND-REINS            VALUE 'R'.
  1749
  1750     12  DX-ENTRY-STATUS                   PIC X.
  1751     12  DX-ENTRY-DTE                      PIC 9(11)      COMP-3.
  1752
  1753     12  DX-REI-AREA.
  1754         16  DX-REI-COMP.
  1755             20  DX-REINCO                 PIC XXX.
  1756             20  DX-REINCO-SUB             PIC XXX.
  1757         16  DX-REI-LFAMT                  PIC S9(9)V99   COMP-3.
  1758         16  DX-REI-LFPRM                  PIC S9(7)V99   COMP-3.
  1759         16  DX-REI-LFRFND                 PIC S9(7)V99   COMP-3.
  1760         16  DX-REI-AHAMT                  PIC S9(7)V99   COMP-3.
  1761         16  DX-REI-AHPRM                  PIC S9(7)V99   COMP-3.
  1762         16  DX-REI-AHRFND                 PIC S9(7)V99   COMP-3.
  1763         16  DX-REI-CNAMT                  PIC S9(9)V99   COMP-3.
  1764
  1765     12  DX-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1766     12  FILLER REDEFINES DX-MOB-NET-TOT-FEES.
  1767         16  DX-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1768         16  F                             PIC X.
  1769*    12  FILLER                            PIC X(5).
  1770
  1771     12  DX-BILLED-AREA.
  1772         16  DX-GL-INTERFACE-CODES.
  1773             20  DX-GL-CODES               PIC X  OCCURS 10 TIMES.
  1774
  1775         16  DX-BILL-SW                    PIC X.
  1776             88  DX-RECORD-ON-HOLD            VALUE 'H'.
  1777             88  DX-RECORD-RETURNED           VALUE 'R'.
  1778             88  DX-RECORD-ENDORSED           VALUE 'E'.
  1779             88  DX-OVERRIDX-LIFE             VALUE 'L'.
  1780             88  DX-OVERRIDX-AH               VALUE 'A'.
  1781             88  DX-OVERRIDX-BOTH             VALUE 'B'.
  1782
  1783         16  DX-REFUND-SW                  PIC X.
  1784             88  DX-REFUND-CREATED            VALUE 'Y'.
  1785
  1786         16  DX-BILLED-LFPRM               PIC S9(7)V99   COMP-3.
  1787         16  DX-BILLED-LFRFND              PIC S9(7)V99   COMP-3.
  1788         16  DX-BILLED-AHPRM               PIC S9(7)V99   COMP-3.
  1789         16  DX-BILLED-AHRFND              PIC S9(7)V99   COMP-3.
  1790
  1791         16  DX-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES.
  1792*            88  DX-NO-PRE-BILL-GA            VALUE ' '.
  1793*            88  DX-BILLED-GA                 VALUE 'B'.
  1794
  1795     12  DX-BILL-STATUS                    PIC X.
  1796         88  DX-NO-PRE-BILL                   VALUE ' '.
  1797         88  DX-BILLED                        VALUE 'B'.
  1798         88  DX-REVERSE                       VALUE 'R'.
  1799
  1800     12  DX-REVERSE-REASONS.
  1801         16  DX-REVERSE-REASON-1           PIC X.
  1802         16  DX-REVERSE-REASON-2           PIC X.
  1803     12  DX-CANCEL-REASON                  PIC X.
  1804
  1805     12  DX-RECALC-CODE                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  38
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1806     12  DX-RECALC-TYPE                    PIC X.
  1807
  1808     12  DX-CHARGEBACK-CODES.
  1809         16  DX-LF-COMM-CHARGEBACK         PIC X.
  1810             88  DX-NO-LF-CHARGEBACK          VALUE 'N'.
  1811         16  DX-AH-COMM-CHARGEBACK         PIC X.
  1812             88  DX-NO-AH-CHARGEBACK          VALUE 'N'.
  1813
  1814     12  DX-UNDERWRITING-CODE              PIC X.
  1815         88  DX-POLICY-UNDERWRITTEN           VALUE 'Y'.
  1816
  1817     12  DX-NCL-POOL-CODE                  PIC XXX.
  1818     12  FILLER REDEFINES DX-NCL-POOL-CODE.
  1819         16  DX-LOAN-TERM                  PIC S999 COMP-3.
  1820         16  FILLER                        PIC X.
  1821
  1822****************************************************************
  1823**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT
  1824****************************************************************
  1825     12  DX-COMM-LEVELS.
  1826         16  DX-AGT-LEVELS     OCCURS  10  TIMES.
  1827             20  DX-AGT.
  1828                 24  DX-AGT-PREFIX         PIC X(4).
  1829                 24  DX-AGT-PRIME          PIC X(6).
  1830             20  DX-AGT-TYPE               PIC X.
  1831             20  DX-L-PC                   PIC S999V99    COMP-3.
  1832             20  DX-A-PC                   PIC S999V99    COMP-3.
  1833
  1834     12  DX-PROC-DT                        PIC 9(11)      COMP-3.
  1835****************************************************************
  1836*******                 CLAIM EXTRACT                      *****
  1837****************************************************************
  1838     02 DX-CLAIM-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1839     12  FILLER                            PIC X(334).
  1840     12  DX-TYPE                           PIC X.
  1841         88  DX-DTH                           VALUE '1'.
  1842         88  DX-AH                            VALUE '2'.
  1843         88  DX-OB-DTH                        VALUE '3'.
  1844         88  DX-OB-AH                         VALUE '4'.
  1845         88  DX-DEATH                         VALUES '1' '3'.
  1846         88  DX-DISABILITY                    VALUES '2' '4'.
  1847
  1848     12  DX-CLAIM-AMT                      PIC S9(9)V99   COMP-3.
  1849     12  DX-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3.
  1850
  1851     12  DX-INCUR                          PIC 9(11)      COMP-3.
  1852     12  DX-REPORTED.
  1853         16  DX-RPT-YR                     PIC 99.
  1854         16  DX-RPT-MO                     PIC 99.
  1855         16  DX-RPT-DA                     PIC 99.
  1856     12  DX-PAY                            PIC 9(11)      COMP-3.
  1857     12  DX-PAID-TO                        PIC 9(11)      COMP-3.
  1858
  1859     12  DX-CNUM                           PIC X(7).
  1860     12  DX-CHECK                          PIC X(7).
  1861     12  DX-PMT-TRAILER-SEQ                PIC S9(4)       COMP.
  1862     12  DX-DAYS-DISAB                     PIC 999.
  1863     12  DX-CLM-AGE                        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  39
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1864     12  DX-PAY-CODE                       PIC X.
  1865         88  DX-PARTIAL-PAYMENT               VALUE 'P'.
  1866         88  DX-FINAL-PAYMENT                 VALUE 'F'.
  1867         88  DX-LUMP-SUM-PAYMENT              VALUE 'S'.
  1868         88  DX-ADDITIONAL-PAYMENT            VALUE 'X'.
  1869         88  DX-CHARGEABLE-EXPENSE            VALUE 'E'.
  1870         88  DX-NON-CHARGEABLE-EXPENSE        VALUE 'E'.
  1871         88  DX-VOIDED-PAYMENT                VALUE 'V'.
  1872
  1873     12  DX-CLM-ERR                        PIC XX.
  1874
  1875     12  DX-ACC-NAME                       PIC X(30).
  1876     12  DX-ACC-EXP-DTE                    PIC 9(11)  COMP-3.
  1877     12  DX-ACC-EFF-DTE                    PIC 9(11)  COMP-3.
  1878     12  FILLER                            PIC XX.
  1879     12  DX-LOAN-OFFICER                   PIC XXX.
  1880
  1881     12  DX-LOAN-TYPE                      PIC X(02).
  1882     12  DX-BENEFICIARY                    PIC X(10).
  1883     12  filler redefines DX-beneficiary.
  1884         16  DX-birth-date                 pic 9(11)  comp-3.
  1885         16  f                             pic x(4).
  1886     12  DX-LOAN-CLASS                     PIC X(02).
  1887     12  DX-LOSS-CODE                      PIC X(06).
  1888     12  DX-ASSOCIATES                     PIC X(01).
  1889     12  DX-LEGAL-STATE                    PIC X(02).
  1890     12  DX-CLM-CAUSE                      PIC X(6).
  1891     12  DX-CLM-CLASS                      PIC XX.
  1892     12  DX-CLM-DEV                        PIC XXX.
  1893     12  DX-XYCOR-CLAIM-NO                 PIC X(9).
  1894     12  DX-xycor-cert-seq                 pic x(3).
  1895     12  DX-XYCOR-CHECK-NO                 PIC X(8).
  1896     12  DX-XYCOR-ACTION-CD                PIC XXX.
  1897     12  DX-XYCOR-STATUS                   PIC X.
  1898     12  FILLER                            PIC X(4).
  1899
  1900     12  DX-CLM-PROC-DT                    PIC 9(11)  COMP-3.
  1901
  1902****************************************************************
  1903*******               RESERVE EXTRACT                      *****
  1904****************************************************************
  1905     02 DX-RESERVE-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1906     12  FILLER                            PIC X(334).
  1907
  1908     12  DX-RESERVE-TYPE                   PIC X.
  1909         88  DX-LIFE-RSV                      VALUE '1' '3'.
  1910         88  DX-AH-RSV                        VALUE '2' '4'.
  1911
  1912     12  DX-IBNR                           PIC S9(7)V99   COMP-3.
  1913     12  DX-PAYCUR                         PIC S9(7)V99   COMP-3.
  1914     12  DX-FUTRSV                         PIC S9(7)V99   COMP-3.
  1915
  1916     12  DX-CLMNO                          PIC X(7).
  1917
  1918     12  DX-RSV-INCUR                      PIC 9(11)      COMP-3.
  1919     12  DX-RSV-REPORTED.
  1920         16  DX-RSV-RPT-YR                 PIC 99.
  1921         16  DX-RSV-RPT-MO                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  40
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1922         16  DX-RSV-RPT-DA                 PIC 99.
  1923     12  DX-RSV-PAYTO                      PIC 9(11)      COMP-3.
  1924
  1925     12  DX-REI-IBNR                       PIC S9(7)V99   COMP-3.
  1926     12  DX-REI-PAYCUR                     PIC S9(7)V99   COMP-3.
  1927     12  DX-REI-FUTRSV                     PIC S9(7)V99   COMP-3.
  1928
  1929     12  DX-RSV-ACC-NAME                   PIC X(30).
  1930     12  DX-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3.
  1931     12  DX-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3.
  1932
  1933     12  DX-MANUAL-RSV-SWITCH              PIC X.
  1934
  1935     12  DX-RATE-CLASS                     PIC XX.
  1936     12  DX-DEV-CODE                       PIC XXX.
  1937     12  DX-RSV-REM-TERM                   PIC S999       COMP-3.
  1938     12  DX-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1939     12  FILLER                            PIC X(58).
  1940
  1941     12  DX-RSV-PROC-DT                    PIC 9(11)  COMP-3.
  1942******************************************************************
  1943
  1944 FD  SUMMARY-EXTR
  1945     BLOCK CONTAINS 0 RECORDS
  1946     RECORDING MODE F.
  1947
* 1948                             COPY ECSEPC01.
  1949******************************************************************
  1950*                                                                *
  1951*                            ECSEPC01                            *
  1952*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1953*                            VMOD=2.008                          *
  1954*                                                                *
  1955*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1956*                                                                *
  1957*   FILE TYPE = SEQUENTIAL                                       *
  1958*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1959*                                                                *
  1960*   KEY DATA =                                  START=5, LEN=31  *
  1961*                                                                *
  1962*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1963*                                                                *
  1964******************************************************************
  1965
  1966 01  EP-RECORD.
  1967     02 EP-FILE.
  1968     12  EP-RECORD-ID                      PIC XX.
  1969         88  VALID-EP-ID                      VALUE 'EP'.
  1970
  1971     12  EP-COMPANY-CD                     PIC X.
  1972
  1973     12  EP-REIN                           PIC X.
  1974         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1975
  1976     12  EP-CONTROL.
  1977         16  EP-CNTRL-1.
  1978             20  EP-COMPANY.
  1979                 24  EP-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  41
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1980                 24  EP-GROUPING.
  1981                     28  EP-GROUP-PREFIX   PIC XXX.
  1982                     28  EP-GROUP-PRIME    PIC XXX.
  1983             20  EP-STATE                  PIC XX.
  1984             20  EP-ACCOUNT.
  1985                 24  EP-ACCT-PREFIX        PIC X(4).
  1986                 24  EP-ACCT-PRIME         PIC X(6).
  1987         16  EP-CNTRL-2.
  1988             20  EP-DATES.
  1989                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1990                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1991
  1992     12  EP-REI-CO.
  1993         16  EP-REINCO                     PIC XXX.
  1994         16  EP-REINCO-SUB                 PIC XXX.
  1995
  1996     12  EP-RCD-TYPE                       PIC X.
  1997         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  1998         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  1999         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  2000         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2001         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2002         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  2003     12  EP-BEN-CODE                       PIC XX.
  2004     12  FILLER                            PIC X.
  2005
  2006     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  2007     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  2008     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2009
  2010     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  2011     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  2012     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2013
  2014     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  2015     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2016     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  2017     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2018
  2019     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  2020     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  2021     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  2022
  2023     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  2024     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  2025     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  2026
  2027     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  2028     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  2029     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  2030     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  2031     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  2032
  2033     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  2034     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  2035     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  2036
  2037     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  42
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2038     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  2039     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  2040
  2041     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  2042         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  2043         16  EP-NEW-DATA-IND               PIC X(01).
  2044             88  EP-NEW-DATA                   VALUE 'Y'.
  2045         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  2046         16  FILLER                        PIC X(19).
  2047
  2048     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  2049     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  2050     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  2051
  2052     12  FILLER                            PIC XXX.
  2053
  2054     12  EP-UNDERWRITING-CODE              PIC X.
  2055         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  2056
  2057     12  EP-PRM-TAX                        PIC S9(5)V99   COMP-3.
  2058
  2059     12  FILLER                            PIC X(30).
  2060*    12  FILLER                            PIC X(34).
  2061
  2062     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  2063     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  2064     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  2065     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  2066     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  2067     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  2068
  2069     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  2070
  2071     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  2072     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  2073
  2074     12  EP-PURGE                          PIC X.
  2075         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2076
  2077     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  2078
  2079     02 EC-RECORD     REDEFINES     EP-FILE.
  2080     12  EC-RECORD-ID                      PIC XX.
  2081         88  VALID-EC-ID                      VALUE 'EC'.
  2082
  2083     12  EC-COMPANY-CD                     PIC X.
  2084
  2085     12  EC-REIN                           PIC X.
  2086         88  EC-REIN-EXTRACT                  VALUE 'R'.
  2087
  2088     12  EC-CONTROL.
  2089         16  EC-CARRIER                    PIC X.
  2090         16  EC-GROUPING.
  2091             20  EC-GROUP-PREFIX           PIC XXX.
  2092             20  EC-GROUP-PRIME            PIC XXX.
  2093         16  EC-STATE                      PIC XX.
  2094         16  EC-ACCOUNT.
  2095             20  EC-ACCT-PREFIX            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  43
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2096             20  EC-ACCT-PRIME             PIC X(6).
  2097         16  EC-DATES.
  2098             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  2099             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  2100
  2101     12  EC-REI-CO.
  2102         16  EC-REINCO                     PIC XXX.
  2103         16  EC-REINCO-SUB                 PIC XXX.
  2104
  2105     12  EC-RCD-TYPE                       PIC X.
  2106         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  2107         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  2108         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  2109         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2110         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2111     12  EC-BEN-CODE                       PIC XX.
  2112     12  EC-SEQ-NBR                        PIC X.
  2113         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  2114         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  2115
  2116     12  EC-AGENTS-DATA.
  2117         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
  2118             20  EC-AGT-NO.
  2119                 24  EC-AGT-PREFIX         PIC X(4).
  2120                 24  EC-AGT-PRIME          PIC X(6).
  2121             20  EC-AGT-TYPE               PIC X.
  2122             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  2123             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  2124             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  2125             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  2126             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  2127
  2128     12  EC-UNDERWRITING-CODE              PIC X.
  2129         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  2130
  2131     12  EC-AGENTS-DATA-II.
  2132         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  2133             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  2134             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  2135
  2136     12  FILLER                            PIC X(7).
  2137
  2138     12  EC-PURGE                          PIC X.
  2139         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2140
  2141     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  2142
  2143******************************************************************
  2144
  2145 FD  ERRESC-IN.
* 2146                             COPY ERCRESC.
  2147******************************************************************04/29/98
  2148*                                                                *ERCRESC
  2149*                            ERCRESC                             *   LV002
  2150*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2151*                            VMOD=2.003                          *   CL**2
  2152*                                                                *ERCRESC
  2153*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  44
* ECS010.cbl (/apps/prod/cid1p/copy/ERCRESC)
  2154*                                                                *ERCRESC
  2155*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  2156*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  2157*                                                                *ERCRESC
  2158*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  2159*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  2160*                                                                *ERCRESC
  2161*   LOG = NO                                                     *ERCRESC
  2162*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  2163*                                                                *ERCRESC
  2164******************************************************************ERCRESC
  2165                                                                  ERCRESC
  2166 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  2167                                                                  ERCRESC
  2168     10  ERRESC-RECORD-KEY.                                       ERCRESC
  2169         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  2170         15  RESC-CARRIER              PIC   X.                   ERCRESC
  2171         15  RESC-GROUP                PIC   X(6).                ERCRESC
  2172         15  RESC-STATE                PIC   XX.                  ERCRESC
  2173         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  2174         15  RESC-AGENT                PIC   X(10).               ERCRESC
  2175         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  2176         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  2177*                                           YYYYMMDD              ERCRESC
  2178     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  2179                                                                  ERCRESC
  2180     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  2181         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  2182             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  2183             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  2184             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  2185                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  2186                                                                  ERCRESC
  2187     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  2188     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  2189     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  2190*                                          YYYYMMDD               ERCRESC
  2191 FD  ELCRTT.
  2192
* 2193                             COPY ELCCRTT.
  2194******************************************************************
  2195*                                                                *ELCCRTT
  2196*                            ELCCRTT.                            *
  2197*                                                                *ELCCRTT
  2198*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  2199*                                                                *ELCCRTT
  2200*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  2201*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  2202*                                                                *ELCCRTT
  2203*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  2204*                                                                *ELCCRTT
  2205*   LOG = YES                                                    *ELCCRTT
  2206*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  2207******************************************************************
  2208*                   C H A N G E   L O G
  2209*
  2210* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2211*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  45
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  2212*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2213* EFFECTIVE    NUMBER
  2214*-----------------------------------------------------------------
  2215* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2216* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  2217* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  2218* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2219* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2220******************************************************************
  2221                                                                  ELCCRTT
  2222 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  2223     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  2224         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  2225                                                                  ELCCRTT
  2226     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  2227         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  2228         16  CS-CARRIER                    PIC X.                 ELCCRTT
  2229         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  2230         16  CS-STATE                      PIC XX.                ELCCRTT
  2231         16  CS-ACCOUNT                    PIC X(10).
  2232         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  2233         16  CS-CERT-NO.                                          ELCCRTT
  2234             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  2235             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  2236         16  CS-TRAILER-TYPE               PIC X.
  2237             88  COMM-TRLR           VALUE 'A'.
  2238             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2239             88  CERT-DATA-TRLR      VALUE 'C'.
  2240                                                                  ELCCRTT
  2241     12  CS-DATA-AREA                      PIC X(516).
  2242
  2243     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2244         16  CS-BANK-COMMISSION-AREA.
  2245             20  CS-BANK-COMMS       OCCURS 10.
  2246                 24  CS-AGT                PIC X(10).
  2247                 24  CS-COM-TYP            PIC X.
  2248                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2249                 24  CS-RECALC-LV-INDIC    PIC X.
  2250                 24  FILLER                PIC X(10).
  2251
  2252         16  FILLER                        PIC X(256).
  2253
  2254     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2255****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2256****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2257         16  CS-MB-CLAIM-DATA OCCURS 2.
  2258             20  FILLER OCCURS 10.
  2259                 24  CS-CLAIM-TYPE         PIC X.
  2260                     88  CS-AH-CLM           VALUE 'A'.
  2261                     88  CS-IU-CLM           VALUE 'I'.
  2262                     88  CS-GP-CLM           VALUE 'G'.
  2263                     88  CS-LF-CLM           VALUE 'L'.
  2264                     88  CS-PR-CLM           VALUE 'P'.
  2265                 24  CS-BANK               PIC S999 COMP-3.
  2266                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2267                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2268                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2269         16  FILLER                        PIC X(216).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  46
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  2270
  2271     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2272         16  CS-VIN-NUMBER                 PIC X(17).
  2273         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2274         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2275         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2276         16  FILLER                        PIC X(496).
  2277
  2278******************************************************************ELCCRTT
  2279
  2280 FD  ERAGTC.
  2281
* 2282                             COPY ERCAGTC.
  2283******************************************************************
  2284*                                                                *
  2285*                                                                *
  2286*                            ERCAGTC                             *
  2287*                            VMOD=2.001                          *
  2288*                                                                *
  2289*   ONLINE CREDIT SYSTEM                                         *
  2290*                                                                *
  2291*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2292*                                                                *
  2293*   FILE TYPE = VSAM,KSDS                                        *
  2294*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2295*                                                                *
  2296*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2297*       ALTERNATE PATH = NONE                                    *
  2298*                                                                *
  2299*   LOG = NO                                                     *
  2300*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2301*                                                                *
  2302******************************************************************
  2303*                   C H A N G E   L O G
  2304*
  2305* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2306*-----------------------------------------------------------------
  2307*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2308* EFFECTIVE    NUMBER
  2309*-----------------------------------------------------------------
  2310* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2311* 111004                         NEW FILE AND COPYBOOK
  2312* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2313******************************************************************
  2314
  2315 01  AGENT-COMMISSIONS.
  2316     12  AG-RECORD-ID                          PIC XX.
  2317         88  VALID-CO-ID                          VALUE 'AG'.
  2318
  2319     12  AG-CONTROL-PRIMARY.
  2320         16  AG-COMPANY-CD                     PIC X.
  2321         16  AG-CONTROL.
  2322             20  AG-CTL-1.
  2323                 24  AG-CARR-GROUP.
  2324                     28  AG-CARRIER            PIC X.
  2325                     28  AG-GROUPING           PIC X(6).
  2326                 24  AG-BANK                   PIC X(10).
  2327             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  47
* ECS010.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2328                 24  AG-EXP-DT                 PIC XX.
  2329         16  AG-TYPE                           PIC X.
  2330             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2331             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2332
  2333     12  AG-MAINT-INFORMATION.
  2334         16  AG-LAST-MAINT-DT                  PIC XX.
  2335         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2336         16  AG-LAST-MAINT-USER                PIC X(4).
  2337         16  FILLER                            PIC X(10).
  2338
  2339     12  AG-EFF-DT                             PIC XX.
  2340     12  AG-COMM-STRUCTURE.
  2341         16  AG-AGT-COMMS OCCURS 10.
  2342             20  AG-AGT                PIC X(10).
  2343             20  AG-COM-TYP            PIC X.
  2344             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2345             20  AG-RECALC-LV-INDIC    PIC X.
  2346             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2347             20  AG-LRCALC-LV-INDIC    PIC X.
  2348             20  FILLER                PIC X(05).
  2349
  2350     12  FILLER                  PIC X(145).
  2351******************************************************************
  2352
  2353 FD  ERPDEF.
  2354
* 2355                             COPY ERCPDEF.
  2356******************************************************************
  2357*                                                                *
  2358*                                                                *
  2359*                            ERCPDEF.                            *
  2360*                                                                *
  2361*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2362*                                                                *
  2363*    FILE TYPE = VSAM,KSDS                                       *
  2364*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2365*                                                                *
  2366*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2367*                                                                *
  2368*    LOG = YES                                                   *
  2369*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2370******************************************************************
  2371 01  PRODUCT-MASTER.
  2372    12  PD-RECORD-ID                 PIC X(02).
  2373        88  VALID-PD-ID                  VALUE 'PD'.
  2374
  2375    12  PD-CONTROL-PRIMARY.
  2376        16  PD-COMPANY-CD            PIC X.
  2377        16  PD-STATE                 PIC XX.
  2378        16  PD-PRODUCT-CD            PIC XXX.
  2379        16  PD-FILLER                PIC X(7).
  2380        16  PD-BEN-TYPE              PIC X.
  2381        16  PD-BEN-CODE              PIC XX.
  2382        16  PD-PROD-EXP-DT           PIC XX.
  2383
  2384    12  FILLER                       PIC X(50).
  2385
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  48
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  2386    12  PD-PRODUCT-DATA OCCURS 8.
  2387        16  PD-PROD-CODE             PIC X.
  2388            88  PD-PROD-LIFE           VALUE 'L'.
  2389            88  PD-PROD-PROP           VALUE 'P'.
  2390            88  PD-PROD-AH             VALUE 'A'.
  2391            88  PD-PROD-IU             VALUE 'I'.
  2392            88  PD-PROD-GAP            VALUE 'G'.
  2393        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2394        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2395        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2396        16  PD-MAX-TERM              PIC S999        COMP-3.
  2397        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2398        16  FILLER                   PIC X.
  2399        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2400        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2401        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2402        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2403        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2404        16  PD-REC-CRIT-PERIOD       PIC X.
  2405        16  PD-RTW-MOS               PIC 99.
  2406        16  FILLER                   PIC X(5).
  2407
  2408    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2409
  2410    12  PD-TERM-LIMITS OCCURS 15.
  2411        16  PD-LOW-TERM              PIC S999        COMP-3.
  2412        16  PD-HI-TERM               PIC S999        COMP-3.
  2413
  2414*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2415    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2416        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2417        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2418
  2419    12  PD-EARN-FACTORS.
  2420        16  FILLER OCCURS 15.
  2421            20  FILLER OCCURS 15.
  2422                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2423
  2424    12  PD-PRODUCT-DESC              PIC X(80).
  2425    12  PD-TRUNCATED                 PIC X.
  2426    12  FILLER                       PIC X(59).
  2427
  2428    12  PD-MAINT-INFORMATION.
  2429        16  PD-LAST-MAINT-DT         PIC X(02).
  2430        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2431        16  PD-LAST-MAINT-BY         PIC X(04).
  2432
  2433 FD  ME-ECS010-BALANCE
  2434     RECORDING MODE IS F
  2435     BLOCK CONTAINS 0 RECORDS.
  2436 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2437
  2438 FD  ME50-ECS010-BALANCE
  2439     RECORDING MODE IS F
  2440     BLOCK CONTAINS 0 RECORDS.
  2441 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2442
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  49
* ECS010.cbl
  2444 FD  DISK-DATE
* 2445                             COPY ELCDTEFD.
  2446******************************************************************04/15/98
  2447*                                                                *ELCDTEFD
  2448*                                                                *ELCDTEFD
  2449*                            ELCDTEFD.                           *   LV002
  2450*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2451*                            VMOD=2.007                          *   CL**2
  2452*                                                                *ELCDTEFD
  2453******************************************************************ELCDTEFD
  2454     BLOCK CONTAINS 0 RECORDS
  2455     RECORDING MODE F.                                            ELCDTEFD
  2456                                                                  ELCDTEFD
  2457 01  DATE-DISK.                                                   ELCDTEFD
  2458     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2459     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2460     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2461     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2462     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2463     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2464     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2465                                                                  ELCDTEFD
  2466 01  DATE-DISK-R.                                                 ELCDTEFD
  2467     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2468     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2469                                     PIC  X(32).                  ELCDTEFD
  2470                                                                  ELCDTEFD
  2471 01  DATE-DISK-T.                                                 ELCDTEFD
  2472     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2473     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2474                                     PIC  X(48).                  ELCDTEFD
  2475                                                                  ELCDTEFD
  2476 01  DATE-DISK-M.                                                 ELCDTEFD
  2477     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2478     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2479                                     PIC  X(48).                  ELCDTEFD
  2480                                                                  ELCDTEFD
  2481 01  DATE-DISK-P.                                                 ELCDTEFD
  2482     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2483     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2484     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2485     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2486         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2487                                     PIC  X.                      ELCDTEFD
  2488         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2489     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2490         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2491             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2492             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2493             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2494             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2495         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2496                                                                  ELCDTEFD
  2497 01  DATE-DISK-E.                                                 ELCDTEFD
  2498     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2499     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2500                                     PIC  X(4).                   ELCDTEFD
  2501                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  50
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2502 01  DATE-DISK-C.                                                 ELCDTEFD
  2503     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2504     12  DD-CARR1-SECPAY-SW          PIC  X.
  2505     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2506     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2507     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2508     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2509     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2510     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2511     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2512     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2513     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2514     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2515     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2516     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2517     12  DD-CARR2-SECPAY-SW          PIC  X.
  2518     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2519                                                                  ELCDTEFD
  2520 01  DATE-DISK-OPT.                                               ELCDTEFD
  2521     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2522     12  DD-TLR-DATA.                                             ELCDTEFD
  2523         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2524                                     PIC  X(03).                  ELCDTEFD
  2525     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2526         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2527                                     PIC  X(06).                  ELCDTEFD
  2528     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2529         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2530                                     PIC  X(07).                  ELCDTEFD
  2531         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2532     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2533                                     PIC  X(96).                  ELCDTEFD
  2534******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  51
* ECS010.cbl
  2536 FD  PRINT-COPY
* 2537                             COPY ELCPRTFD.
  2538******************************************************************04/15/98
  2539*                                                                *ELCPRTFD
  2540*                                                                *ELCPRTFD
  2541*                            ELCPRTFD.                           *   LV003
  2542*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2543*                            VMOD=2.006                          *ELCPRTFD
  2544******************************************************************ELCPRTFD
  2545     RECORDING MODE F                                             ELCPRTFD
  2546     LABEL RECORDS OMITTED                                        ELCPRTFD
  2547     BLOCK CONTAINS 0 RECORDS
  2548     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2549 01  PRT.                                                         ELCPRTFD
  2550     12  P-CTL               PIC  X.                                 CL**2
  2551     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2552******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  52
* ECS010.cbl
  2554 FD  MISMATCH-REPORT
  2555     RECORDING MODE F.
  2556
  2557 01  MISMATCH-RPT.
  2558     12  MR-CTL              PIC X.
  2559     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  53
* ECS010.cbl
  2561 FD  FICH
* 2562                             COPY ELCFCHFD.
  2563******************************************************************04/15/98
  2564*                                                                *ELCFCHFD
  2565*                            ELCFCHFD.                           *   LV003
  2566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2567*                            VMOD=2.004                          *   CL**3
  2568*                                                                *ELCFCHFD
  2569******************************************************************ELCFCHFD
  2570     BLOCK CONTAINS 0 RECORDS
  2571     RECORDING MODE F.                                            ELCFCHFD
  2572                                                                  ELCFCHFD
  2573 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2574******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  54
* ECS010.cbl
  2576 FD  DISPLAY-PRT
  2577     RECORDING MODE IS F
  2578     LABEL RECORDS ARE STANDARD
  2579     BLOCK CONTAINS 0 RECORDS
  2580     RECORD CONTAINS 133 CHARACTERS.
  2581
  2582 01  DISPLAY-REC.
  2583     05  DISPLAY-CC           PIC X.
  2584     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  55
* ECS010.cbl
  2586 WORKING-STORAGE SECTION.
  2587 77  LCP-ASA                       PIC X.
  2588 77  FILLER  PIC X(32)  VALUE '********************************'.
  2589 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2590 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2591
  2592 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2593 77  ws-dcc-cnc-flag         pic x  value ' '.
  2594 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2595 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2596 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2597 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2598 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2599 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2600 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2601 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2602 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2603 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2604 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2605 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2606 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2607 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2608 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2609 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2610 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2611 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2612 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2613 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2614 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2615 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2616 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2617 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2618 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2619 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2620 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2621 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2622 77  UECLP-CLP-FACT          PIC S9(3)V9(7) COMP-3 VALUE +0.
  2623 77  EC-FACT                 PIC S9(3)V9(9) COMP-3 VALUE +0.
  2624 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2625 77  X                       PIC X.
  2626 77  DD-FLG                  PIC X               VALUE SPACE.
  2627 77  AGT-SW                  PIC X               VALUE SPACE.
  2628 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2629 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2630 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2631 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2632 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2633 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2634 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2635 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2636 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2637 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2638 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2639 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2640 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2641 77  SV-TRD-CERT             PIC X(11).
  2642 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2643 77  SV-TRD-ISDT             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  56
* ECS010.cbl
  2644 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2645*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2646*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2647 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2648 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2649 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2650 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2651 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2652 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2653 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2654 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2655 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2656 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2657 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2658 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2659 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2660 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2661 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2662 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2663 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2664 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2665 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2666 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2667 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2668 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2669 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2670 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2671 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2672 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2673 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2674 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2675 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2676 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2677 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2678 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2679 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2680 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2681 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2682 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2683 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2684 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2685 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2686 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2687 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2688 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2689 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2690 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2691 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2692 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2693 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2694 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2695 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2696 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2697 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2698 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2699 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2700 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2701 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  57
* ECS010.cbl
  2702 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2703 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2704 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2705 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2706 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2707 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2708 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2709 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2710 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2711 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2712 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2713 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2714 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2715 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2716 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2717 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2718 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2719 77  RTOT-AH-PRMB            PIC S9(11)V99 COMP-3 VALUE +0.
  2720 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2721 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2722 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2723 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2724 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2725 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2726 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2727 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2728 77  D1                      PIC S9(5) COMP-3 VALUE +0.
  2729 77  P1                      PIC S999 COMP-3 VALUE +0.
  2730 77  P2                      PIC S999 COMP-3 VALUE +0.
  2731 77  DD-IU-SW                    PIC X   VALUE ' '.
  2732     88  DD-IU-PRESENT                 VALUE 'Y'.
  2733 77  WS-DDF-ADMIN-FEES       PIC S9(5)V99 VALUE +0 COMP-3.
  2734 77  WS-DDF-CSO-ADMIN-FEE    PIC S9(5)V99 VALUE +0 COMP-3.
  2735 77  WS-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
  2736 77  WS-DDF-1ST-YR-TOT-EXP   PIC S9(5)V99 VALUE +0 COMP-3.
  2737 77  WS-FACT-CERT            PIC X(11)   VALUE SPACES.
  2738 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  2739 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  2740 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  2741 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  2742 77  WS-DDF-TERM             PIC S999     COMP-3 VALUE +0.
  2743
  2744 01  MONTH-END-DATA.
  2745     12  ME-START-DATE.
  2746         16  ME-START-MO         PIC 99.
  2747         16  FILLER              PIC X.
  2748         16  ME-START-DA         PIC 99.
  2749         16  FILLER              PIC X.
  2750         16  ME-START-YR         PIC 99.
  2751     12  ME-CNDS-DATE            PIC 9(6).
  2752     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2753         16  ME-CNDS-MO          PIC 99.
  2754         16  ME-CNDS-DA          PIC 99.
  2755         16  ME-CNDS-YR          PIC 99.
  2756     12  ME-START-TIME           PIC 9(6).
  2757     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2758         88  ME-DO-UPDATE        VALUE 'Y'.
  2759         88  ME-NO-UPDATE        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  58
* ECS010.cbl
  2760     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2761
  2762 01  WS-HOLD-FOR-NEW-EXTR        PIC X(510)  VALUE SPACES.
  2763 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2764     'Life Claims Paid'.
  2765
  2766 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2767     'A&H Claims Paid'.
  2768
  2769 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2770     'Output Certificate Master Records Prior Month'.
  2771
  2772 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2773     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2774
  2775 01  WS-ME-BALANCE-REC.
  2776     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2777     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2778     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2779     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2780     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2781     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2782     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2783
  2784 01  WS-ME50-BALANCE-REC.
  2785     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2786     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2787     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2788     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2789     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2790     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2791     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2792     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2793     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2794
  2795 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2796 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2797 01  WS-BANK-COMMISSIONS.
  2798     12  WS-BANK-COMMS           OCCURS 10.
  2799         16  WS-BNK-AGT          PIC X(10).
  2800         16  WS-BNK-TYPE         PIC X.
  2801         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2802         16  WS-BNK-RECALC       PIC X.
  2803         16  FILLER              PIC X(10).
  2804
  2805 01  PENDING-MATCH-CONTROL.
  2806     12  PENDING-ACCOUNT-CONTROL.
  2807         16  PEND-MATCH-CARRIER    PIC X.
  2808         16  PEND-MATCH-GROUPING   PIC X(6).
  2809         16  PEND-MATCH-STATE      PIC XX.
  2810         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2811     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2812     12  PEND-MATCH-CERT-NO.
  2813         16  PEND-MATCH-CERT       PIC X(10).
  2814         16  PEND-MATCH-CERT-SFX   PIC X.
  2815 01  PENDING-RECORD-TYPE           PIC X.
  2816     88  ISSUE-TRANSACTION            VALUE '1'.
  2817     88  CANCEL-TRANSACTION           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  59
* ECS010.cbl
  2818     88  CLAIM-TRANSACTION            VALUE '3'.
  2819     88  RESERVE-TRANSACTION          VALUE '4'.
  2820     88  UPDATE-TRANSACTION           VALUE '5'.
  2821
  2822 01  CLM-INCUR-REIN-DATE.
  2823     12  CIRD-CCYY.
  2824         16  CIRD-CC         PIC 99.
  2825         16  CIRD-YR         PIC 99.
  2826     12  CIRD-MO             PIC 99.
  2827
  2828 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2829
  2830 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2831
  2832 01  REIN-BILLING-TABLE.
  2833     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2834         16  RB-COMPANY      PIC X(6).
  2835         16  RB-COUNT        PIC S9(5)   COMP-3.
  2836
  2837 01  B-SUB                   PIC S9(4)   COMP.
  2838
  2839 01  BINARY-COUNTERS     COMP      SYNC.
  2840     12  IA                  PIC S999            VALUE +0.
  2841     12  IB                  PIC S999            VALUE +0.
  2842     12  SUB                 PIC S999            VALUE +0.
  2843     12  SUBM                PIC S999            VALUE +0.
  2844     12  SUB3                PIC S999            VALUE +0.
  2845     12  SUB4                PIC S999            VALUE +0.
  2846     12  SUB5                PIC S999            VALUE +0.
  2847     12  SUB6                PIC S999            VALUE +0.
  2848     12  SUB7                PIC S999            VALUE +0.
  2849     12  SUB8                PIC S999            VALUE +0.
  2850     12  SUB9                PIC S999            VALUE +0.
  2851     12  SUB10               PIC S999            VALUE +0.
  2852     12  SUB11               PIC S999            VALUE +0.
  2853     12  SUB12               PIC S999            VALUE +0.
  2854     12  SUB13               PIC S999            VALUE +0.
  2855     12  SUB14               PIC S999            VALUE +0.
  2856     12  SUB15               PIC S999            VALUE +0.
  2857     12  SUB16               PIC S999            VALUE +0.
  2858     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2859 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2860
  2861 01  WS.
  2862     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2863     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2864     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2865     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2866
  2867     12  WS-ABEND-CODE         PIC 9(4).
  2868     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2869         16  ABEND-CODE-1    PIC XX.
  2870         16  ABEND-CODE-2.
  2871             20  AC2-ONE     PIC X.
  2872             20  AC2-TWO     PIC X.
  2873
  2874     12  CTBL-SEARCH.
  2875         16  CTBL-COMP-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  60
* ECS010.cbl
  2876         16  CTBL-TABLE-CD   PIC XXX.
  2877         16  CTBL-BEN-TYPE   PIC X.
  2878         16  CTBL-BEN-CODE   PIC XX.
  2879     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2880     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2881     12  WS-COMM-TERM        PIC S999            COMP-3.
  2882     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2883         88  CTBL-ERROR         VALUE '*'.
  2884
  2885     12  REIN-SPEC.
  2886         16  REIN-SPEC-A     PIC X.
  2887         16  REIN-SPEC-B     PIC X.
  2888         16  REIN-SPEC-C     PIC X.
  2889
  2890     12  WS-CHECK-NUMBER.
  2891         16  WS-CHECK-NO     PIC X(4).
  2892         16  FILLER          PIC XXX.
  2893
  2894     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2895         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2896         88  AH-EARN-NET                         VALUE 'N'.
  2897
  2898     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2899     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
  2900
  2901 01  max-pdef                    pic s9(5) comp-3 value +2000.
  2902 01  DCC-DDF-WORK-AREA.
  2903     05  F OCCURS 2000.
  2904         10  DD-STATE                 PIC XX.
  2905         10  DD-PRODUCT-CD            PIC XXX.
  2906         10  DD-FILLER                PIC X(7).
  2907         10  DD-BEN-TYPE              PIC X.
  2908         10  DD-BEN-CODE              PIC XX.
  2909         10  DD-PROD-EXP-DT           PIC XX.
  2910         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  2911         10  DD-PROD-DATA OCCURS 8.
  2912             15  DD-PROD-CODE         PIC X.
  2913             15  DD-MAX-BEN-AMT       PIC S9(7) COMP-3.
  2914         10  DD-EARN-FACTORS.
  2915             15  F OCCURS 15.
  2916                 20  F OCCURS 15.
  2917                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2918         10  DD-TRUNCATED        PIC X.
  2919
  2920 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2921 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2922 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2923 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2924 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2925 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2926 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2927 01  ERPDEF-FILE-STATUS      PIC XX VALUE ZEROS.
  2928
  2929 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2930 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2931 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  2932 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2933
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  61
* ECS010.cbl
  2934 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2935     12  WS-LF-CHARGEBACK-LEVELS.
  2936         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2937     12  WS-AH-CHARGEBACK-LEVELS.
  2938         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2939 01  WS-DCC-DDF-CB.
  2940     12  WS-DCC-DDF-CB-LEVELS.
  2941         16  WS-DDF-AH-CB         PIC X OCCURS 10.
  2942*****************************************************************
  2943*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2944*****************************************************************
  2945*RESIDENT STATE TAXES MASTER(ERRESC)
  2946*
  2947 01  WORK-AREAS.
  2948     12  WS-ERRESC-KEY.
  2949         16 WS-ERRESC-SEARCH-KEY.
  2950             20  WS-ERRESC-COMPANY-CD PIC  X.
  2951             20  WS-ERRESC-CARRIER    PIC  X.
  2952             20  WS-ERRESC-GROUP      PIC X(6).
  2953             20  WS-ERRESC-STATE      PIC XX.
  2954             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2955         16 WS-ERRESC-RESIDUAL-KEY.
  2956             20  WS-ERRESC-AGENT      PIC X(10).
  2957             20  WS-ERRESC-RES-STATE  PIC XX.
  2958             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2959*                                          YYYYMMDD
  2960     12  WS-YYYYMMDD-DT               PIC 9(8).
  2961     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2962     12  WS-SUB                       PIC    99  COMP-3.
  2963     12  WS-SUB1                      PIC    99  COMP-3.
  2964*****************************************************************
  2965*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2966*****************************************************************
  2967
  2968 01  COMM-WORK-AREAS.
  2969     12  FILLER              PIC  X(17)
  2970         VALUE 'COMMON WORK AREAS'.
  2971     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2972     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2973     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2974     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2975     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2976     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2977     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2978     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2979     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2980     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2981     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2982     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2983     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2984     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2985     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  2986     12  W-CERT-COUNT        PIC S9(08)  COMP.
  2987     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  2988     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  2989     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  2990
  2991     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  62
* ECS010.cbl
  2992                                         COMP-3 VALUE ZEROS.
  2993     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  2994                                         COMP-3 VALUE ZEROS.
  2995     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  2996                                         COMP-3 VALUE ZEROS.
  2997     12  W-EDIT-FIELD        PIC ----------9.
  2998     12  W-EDIT-FIELD2       PIC ----------9.99.
  2999     12  W-EDIT-7            PIC Z(06)9.
  3000     12  W-FACTOR            PIC S9(09)V9(08)
  3001                                         COMP-3 VALUE ZEROS.
  3002     12  W-IBNR-1            PIC S9(07)V9(02)
  3003                                         COMP-3 VALUE ZEROS.
  3004     12  W-IBNR-2            PIC S9(07)V9(02)
  3005                                         COMP-3 VALUE ZEROS.
  3006     12  W-ISS-BEN           PIC S9(11)V9(02)
  3007                                         COMP-3 VALUE ZEROS.
  3008     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  3009                                         COMP-3 VALUE ZEROS.
  3010     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  3011     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  3012     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  3013     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  3014     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  3015     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  3016     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3017     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  3018     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3019     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3020     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3021     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3022     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3023     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3024     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  3025     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  3026                                         COMP-3 VALUE ZEROS.
  3027     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  3028     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3029     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3030     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3031     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3032     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  3033     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  3034     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  3035     12  W-POLICY-INACTIVE-CTR
  3036                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3037     12  W-POLICY-REISSUE-CTR
  3038                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3039     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  3040     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  3041     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  3042                                         COMP-3 VALUE ZEROS.
  3043     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  3044     12  W-WK-IBNR           PIC S9(07)V9(02)
  3045                                         COMP-3 VALUE ZEROS.
  3046
  3047     12  W-CLAIM-TYPE        PIC  X(01).
  3048         88  W-A-H                              VALUE 'A'.
  3049         88  W-LIFE                             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  63
* ECS010.cbl
  3050     12  W-CUTOFF-DATE       PIC  9(08).
  3051     12  W-DIS-DT            PIC  XX.
  3052     12  W-DIS-PTO-DT        PIC  XX.
  3053     12  WK-LEVEL.
  3054         16  WK-AGT          PIC X(10).
  3055         16  WK-A-TYPE       PIC X.
  3056         16  WK-L-RT         PIC SV9(5)  COMP-3.
  3057         16  WK-J-RT         PIC SV9(5)  COMP-3.
  3058         16  WK-A-RT         PIC SV9(5)  COMP-3.
  3059         16  FILLER          PIC X(6).
  3060     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  3061         16  FILLER          PIC X(11).
  3062         16  WK-L-RTX        PIC X(3).
  3063         16  WK-J-RTX        PIC X(3).
  3064         16  WK-A-RTX        PIC X(3).
  3065         16  FILLER          PIC X(6).
  3066     12  WK-NEW-RATES.
  3067         16  WK-N-R      OCCURS 10.
  3068             20  WK-N-AGT    PIC X(10).
  3069             20  WK-N-TYPE   PIC X.
  3070             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  3071             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  3072     12  W-LIFE-YEARS-ZERO.
  3073         16  FILLER          PIC  X(06)         VALUE ZEROS.
  3074         16  FILLER          PIC  X(01)         VALUE SPACES.
  3075         16  FILLER          PIC  X(02)         VALUE ZEROS.
  3076         16  FILLER          PIC  X(01)         VALUE SPACES.
  3077         16  FILLER          PIC  X(01)         VALUE SPACES.
  3078         16  FILLER          PIC  X(01)         VALUE SPACES.
  3079         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3080         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3081         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3082         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3083         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3084         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3085         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3086         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3087         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3088         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3089         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3090         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3091         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3092         16  FILLER          PIC S9(09)V9(02) COMP-3
  3093                                                VALUE ZEROS.
  3094         16  FILLER          PIC S9(09)V9(02) COMP-3
  3095                                                VALUE ZEROS.
  3096         16  FILLER          PIC S9(09)V9(02) COMP-3
  3097                                                VALUE ZEROS.
  3098         16  FILLER          PIC S9(09)V9(02) COMP-3
  3099                                                VALUE ZEROS.
  3100         16  FILLER          PIC S9(11)V9(02) COMP-3
  3101                                                VALUE ZEROS.
  3102
  3103     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  3104         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  3105     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  3106         88  W-REIN-PROCESS                     VALUE 'Y'.
  3107         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  64
* ECS010.cbl
  3108     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  3109         88  W-SELECTION-ON                     VALUE 'Y'.
  3110         88  W-SELECTION-OFF                    VALUE SPACES.
  3111     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  3112         88  W-RTRM-0                           VALUE 'Y'.
  3113         88  W-RTRM-NOT-0                       VALUE SPACES.
  3114     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  3115     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  3116         88  W-TABLE-USED                       VALUE 'Y'.
  3117         88  W-TABLE-NOT-USED                   VALUE SPACES.
  3118     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  3119         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  3120
  3121     12  W-VAL-ERRORS.
  3122         16  FILLER          PIC  X(40)
  3123             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  3124         16  FILLER          PIC  X(40)
  3125             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  3126         16  FILLER          PIC  X(40)
  3127             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  3128         16  FILLER          PIC  X(40)
  3129             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  3130         16  FILLER          PIC  X(40)
  3131             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  3132         16  FILLER          PIC  X(40)
  3133             VALUE 'RUN DATE EPEC - A&H - '.
  3134         16  FILLER          PIC  X(40)
  3135             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  3136         16  FILLER          PIC  X(40)
  3137             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  3138         16  FILLER          PIC  X(40)
  3139             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  3140     12  FILLER REDEFINES W-VAL-ERRORS.
  3141         16  W-VAL-ERROR OCCURS 9 TIMES
  3142                             PIC  X(40).
  3143
  3144     12  W-WORK-DATE         PIC  X(02).
  3145     12  SAVE-WK-NEW-RATES.
  3146         16  FILLER          PIC X(170).
  3147
  3148***   The following data area is for NCL only
  3149*    12  W-WORK-OB-DATA OCCURS 300.
  3150*    12  W-WORK-OB-DATA OCCURS 220.
  3151     12  W-WORK-OB-DATA OCCURS 900.
  3152         16  WS-OB-REIN-CO       PIC X(06).
  3153         16  WS-OB-LF-AH         PIC X.
  3154         16  WS-OB-BENEFIT-CODE  PIC XX.
  3155         16  WS-OB-EARNED OCCURS 3.
  3156             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  3157
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  65
* ECS010.cbl
  3159 01  EPEC-WORK-AREAS.
  3160     12  WE-REIN-CO          PIC X(6).
  3161     12  WE-LF-AH            PIC X.
  3162     12  WE-BEN-TYPE         PIC XX.
  3163     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  3164     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  3165     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  3166     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  3167     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  3168     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  3169     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  3170     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  3171     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  3172     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  3173     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  3174     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  3175     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  3176     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  3177     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  3178     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  3179     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  3180     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  3181     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  3182     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  3183     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  3184     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  3185     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  3186     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  3187     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  3188     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  3189     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  3190     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  3191     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  3192     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  3193     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  3194     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  3195     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  3196     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  3197     12  EPR-R78             PIC S9(7)V99    COMP-3.
  3198     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  3199     12  EPR-ST              PIC S9(7)V99    COMP-3.
  3200     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  3201     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  3202     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  3203     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  3204     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  3205     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  3206     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  3207     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  3208     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  3209     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  3210     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  3211     12  WX-SETTLEMENT-EXIT-DATE
  3212                             PIC  9(11)      COMP-3.
  3213     12  WX-STATUS-AT-CANCEL PIC  X(1).
  3214     12  WX-STATUS-AT-DEATH  PIC  X(1).
  3215     12  WX-STATUS-AT-SETTLEMENT
  3216                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  66
* ECS010.cbl
  3217     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  3218
  3219 01  EPEC-WORK.
  3220     12  EW-REIN-CO          PIC X(6).
  3221     12  EW-SUB-KEY.
  3222         16  EW-LF-AH        PIC X.
  3223         16  EW-BEN-TYPE     PIC XX.
  3224     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  3225     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3226     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  3227     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3228     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  3229     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3230     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  3231     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3232     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  3233     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  3234     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  3235     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  3236     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  3237     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  3238     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  3239     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  3240     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  3241     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  3242     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  3243     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  3244     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  3245     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  3246     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  3247     12  EW-AGENTS       OCCURS 10.
  3248         16  EW-AGT-NO       PIC X(10).
  3249         16  EW-AGT-TYPE     PIC X.
  3250         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  3251         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  3252         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  3253         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  3254         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  3255         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  3256         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  3257     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  3258     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  3259     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  3260     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  3261     12  EW-AGE              PIC S9(9)       COMP-3.
  3262     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  3263     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  3264     12  EW-LEVEL-USED       PIC X.
  3265
  3266 01  EPEC-TOTALS.
  3267     12  EPEC-LEVELS     OCCURS 900.
  3268*    12  EPEC-LEVELS     OCCURS 220.
  3269*    12  EPEC-LEVELS     OCCURS 300.
  3270         16  EPEC-REIN-CO          PIC X(6).
  3271         16  EPEC-SUB-KEY.
  3272             24  EPEC-LF-AH        PIC X.
  3273             24  EPEC-BEN-TYPE     PIC XX.
  3274*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  67
* ECS010.cbl
  3275         16  FILLER                PIC X(699).
  3276     12  EPEC-LEVELS-END           PIC X(6).
  3277
  3278 01  EPEC-UNDERWRITTEN-TOTALS.
  3279     12  EPEC-LEVELS-II  OCCURS 900.
  3280*    12  EPEC-LEVELS-II  OCCURS 220.
  3281*    12  EPEC-LEVELS-II  OCCURS 300.
  3282         16  EPEC-REIN-CO-II       PIC X(6).
  3283         16  EPEC-SUB-KEY-II.
  3284             24  EPEC-LF-AH-II     PIC X.
  3285             24  EPEC-BEN-TYPE-II  PIC XX.
  3286*        16  FILLER                PIC X(694).
  3287         16  FILLER                PIC X(699).
  3288     12  EPEC-LEVELS-END-II        PIC X(6).
  3289
  3290
  3291 01  FILLER                      PIC  X(11)
  3292                                 VALUE 'OPT RSV TBL'.
  3293*
  3294* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  3295*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  3296*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  3297*      EPEC-OPT-GRP  (108)
  3298*
  3299*      300 X 108 = 32400.
  3300*
  3301 01  EPEC-OPT-DATA-TABLE.
  3302*    12  FILLER                  PIC X(32400).
  3303*    12  FILLER                  PIC X(23760).
  3304     12  FILLER                  PIC X(97200).
  3305
  3306 01  FILLER                      PIC  X(16)
  3307                                 VALUE 'OPT RSV TBL UNDW'.
  3308 01  EPEC-UNDW-OPT-DATA-TABLE.
  3309*    12  FILLER                  PIC X(32400).
  3310*    12  FILLER                  PIC X(23760).
  3311     12  FILLER                  PIC X(97200).
  3312
  3313 01  FILLER                      PIC  X(16)
  3314                                 VALUE 'OPT RSV TBL WORK'.
  3315 01  EPEC-OPT-WORK-TABLE.
  3316*    12  EPEC-OPT-GRP        OCCURS 300.
  3317*    12  EPEC-OPT-GRP        OCCURS 220.
  3318     12  EPEC-OPT-GRP        OCCURS 900.
  3319         16  EPEC-REIN-CO-OPT
  3320                             PIC  X(06).
  3321         16  EPEC-SUB-KEY-OPT.
  3322             24  EPEC-LF-AH-OPT
  3323                             PIC  X(01).
  3324             24  EPEC-BEN-TYPE-OPT
  3325                             PIC  X(02).
  3326         16  EPEC-OPT-DATA.
  3327             20  EPEC-REIN-ONLY-IND
  3328                             PIC  X(01).
  3329                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  3330             20  EPEC-LINE-NOT-USED-IND
  3331                             PIC  X(01).
  3332                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  68
* ECS010.cbl
  3333             20  EPEC-LIFE-CTR-USED-IND
  3334                             PIC  X(01).
  3335                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  3336                 88  EPEC-LIFE-CTR-NOT-USED
  3337                                           VALUE ' '.
  3338             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  3339                             PIC S9(09)       COMP-3.
  3340             20  EPEC-EARNED-PREMIUM-AH
  3341                             PIC S9(09)V9(02) COMP-3.
  3342             20  EPEC-CLAIMS-MADE-PAID
  3343                             PIC S9(09)V9(02) COMP-3.
  3344             20  EPEC-CLM-EXP
  3345                             PIC S9(09)V9(02) COMP-3.
  3346             20  EPEC-LIFE-IBNR
  3347                             PIC S9(09)V9(02) COMP-3.
  3348             20  EPEC-REIN-ISS-BEN
  3349                             PIC S9(11)V9(02) COMP-3.
  3350
  3351 01  FILLER                  PIC X(09)
  3352                                 VALUE 'EOM TABLE'.
  3353
  3354 01  EOM-DATE-TABLE.
  3355     12  EOM-DATE            OCCURS 13
  3356                             PIC 9(08).
  3357
  3358 01  EPEC-SUBS.
  3359     12  EPEC-SUB-LEVELS OCCURS 31.
  3360         16  EPEC-SUB-REIN   PIC X(6).
  3361         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  3362         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  3363     12  EPEC-SUBS-END       PIC X(6).
  3364
  3365 01  SAVE-REIN-WORK.
  3366     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  3367     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  3368     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  3369     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  3370     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  3371
  3372 01  SAVE-REIN-TABLE.
  3373     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  3374         16  SR-TIME         PIC 9(6).
  3375         16  SR-ENTRY.
  3376             20  FILLER      PIC XX.
  3377             20  SR-CONTROL  PIC X(8).
  3378             20  FILLER      PIC X(3990).
  3379
  3380
* 3381                             COPY ECSRITAB.
  3382******************************************************************04/29/98
  3383*                                                                *ECSRITAB
  3384*                            ECSRITAB                            *   LV015
  3385*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  3386*                            VMOD=2.015                          *ECSRITAB
  3387*                                                                *ECSRITAB
  3388*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  3389*                                                                *ECSRITAB
  3390******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  69
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3391 01  REIN-WORK-AREAS.                                             ECSRITAB
  3392     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3393     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3394     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3395     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3396     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3397     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3398     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3399     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3400     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3401     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3402     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  3403         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  3404             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3405             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3406             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3407     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3408     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3409     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3410     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3411     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3412     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3413     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3414     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3415     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3416     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3417     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3418     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3419     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3420     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3421     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3422     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3423     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3424     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3425     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3426     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3427     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3428     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3429     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3430                                                                  ECSRITAB
  3431 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3432     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3433         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3434         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3435             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3436             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3437         16  REIN-WORK-FLDS.                                      ECSRITAB
  3438             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3439             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3440             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3441             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3442             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3443             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3444             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3445             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3446             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3447             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3448             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  70
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3449             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3450             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3451             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3452             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3453             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3454             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3455             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3456             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3457             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3458             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3459             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3460             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3461             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3462             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3463             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3464             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3465             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3466     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3467                                                                  ECSRITAB
  3468     12  RWF-FIELDS.                                              ECSRITAB
  3469         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3470         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3471         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3472         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3473         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3474         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3475         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3476         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3477         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3478         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3479         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3480         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3481         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3482         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3483         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3484         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3485         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3486         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3487         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3488         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3489         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3490         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3491         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3492         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3493         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3494         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3495         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3496         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3497                                                                  ECSRITAB
  3498     12  WT-COMP-INFO.                                            ECSRITAB
  3499         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3500         16  WT-LF-QC                PIC X.                       ECSRITAB
  3501         16  WT-AH-QC                PIC X.                       ECSRITAB
  3502         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3503         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3504         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3505         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3506         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  71
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3507         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3508         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3509         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3510         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3511         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3512         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3513         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3514         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3515         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3516         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3517         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3518         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3519         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3520         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3521         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3522         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3523         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3524         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3525         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3526         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3527         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3528         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3529         16  WT-REMAINING            PIC X.                       ECSRITAB
  3530         16  FILLER                  PIC X(21).                   ECSRITAB
  3531                                                                  ECSRITAB
  3532 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3533     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3534     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3535     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3536     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3537     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3538     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3539     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3540     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3541     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3542     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3543     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3544     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3545     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3546     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3547     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3548     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3549     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3550     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3551     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3552     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3553     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3554     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3555     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3556     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3557                                                                  ECSRITAB
  3558     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3559         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3560     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3561         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3562     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3563         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3564     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  72
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3565         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3566     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3567         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3568     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3569         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3570                                                                  ECSRITAB
  3571     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3572         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3573         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3574         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3575         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3576         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3577         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3578         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3579         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3580         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3581         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3582         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3583         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3584         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3585         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3586         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3587         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3588         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3589         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3590         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3591         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3592         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3593         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3594         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3595     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3596     12  REIN-SEARCH.                                             ECSRITAB
  3597         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3598         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3599         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3600         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3601     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3602     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3603     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3604     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3605     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3606     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3607     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3608     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3609     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3610     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3611     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3612     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3613     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3614     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3615     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3616     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3617     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3618     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3619     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3620     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3621     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3622     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  73
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3623     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3624     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3625     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3626                                                                  ECSRITAB
  3627 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3628* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3629     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3630         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3631         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3632         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3633         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3634         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3635         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3636         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3637         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3638         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3639                                                                  ECSRITAB
  3640 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3641     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3642         16  RC2-REIN-CO.                                         ECSRITAB
  3643             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3644             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3645         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3646         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3647         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3648         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3649         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3650         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3651                                                                  ECSRITAB
  3652 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3653     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3654         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3655         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3656     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3657                                                                  ECSRITAB
  3658 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3659     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3660         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3661         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3662         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3663 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3664     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3665         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3666                                                                  ECSRITAB
  3667 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3668******************************************************************ECSRITAB
  3669
* 3670                             COPY ELCPSEVR.
  3671******************************************************************04/16/98
  3672*                                                                *ELCPSEVR
  3673*                                                                *ELCPSEVR
  3674*                            ELCPSEVR                            *   LV003
  3675*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3676*                            VMOD=2.001                          *ELCPSEVR
  3677*                                                                *ELCPSEVR
  3678*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3679*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3680*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  74
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3681******************************************************************ELCPSEVR
  3682                                                                  ELCPSEVR
  3683 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3684     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3685         10  FILLER               PIC 999.                        ELCPSEVR
  3686         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3687         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3688             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3689             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3690         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3691         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3692     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3693            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3694     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3695         10  FILLER              PIC 999.                         ELCPSEVR
  3696         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3697         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3698             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3699             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3700         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3701         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3702     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3703            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3704 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3705     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3706                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3707         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3708             15  FILLER              PIC 999.                     ELCPSEVR
  3709             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3710             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3711                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3712                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3713             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3714             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3715         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3716                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3717         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3718             15  FILLER              PIC 999.                     ELCPSEVR
  3719             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3720             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3721                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3722                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3723             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3724             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3725         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3726                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3727         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3728             15  FILLER              PIC 999.                     ELCPSEVR
  3729             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3730             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3731                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3732                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3733             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3734             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3735         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3736                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3737     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3738         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  75
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3739         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3740         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3741             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3742             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3743         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3744         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3745     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3746            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3747
* 3748                             COPY ELCEPCVR.
  3749******************************************************************05/15/98
  3750*                                                                *ELCEPCVR
  3751*                                                                *ELCEPCVR
  3752*                            ELCEPCVR                            *   LV003
  3753*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3754*                            VMOD=2.001                          *ELCEPCVR
  3755*                                                                *ELCEPCVR
  3756*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3757*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3758*                                                                *ELCEPCVR
  3759******************************************************************ELCEPCVR
  3760 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3761     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3762         10  FILLER            PIC 999.                           ELCEPCVR
  3763         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3764         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3765             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3766             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3767         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3768         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3769     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3770            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3771     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3772         10  FILLER            PIC 999.                              CL**5
  3773         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3774         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3775             15  EC-EXP-CC     PIC 99.                               CL**5
  3776             15  EC-EXP-YR     PIC 99.                               CL**5
  3777         10  EC-EXP-MO         PIC 99.                               CL**5
  3778         10  EC-EXP-DA         PIC 99.                               CL**5
  3779     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3780            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3781     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3782         10  FILLER            PIC 999.                           ELCEPCVR
  3783         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3784         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3785             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3786             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3787         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3788         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3789     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3790            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3791     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3792         10  FILLER            PIC 999.                              CL**5
  3793         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3794         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3795             15  EC-EFF-CC     PIC 99.                               CL**5
  3796             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  76
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3797         10  EC-EFF-MO         PIC 99.                               CL**5
  3798         10  EC-EFF-DA         PIC 99.                               CL**5
  3799     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3800            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3801     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3802         10  FILLER            PIC 999.                           ELCEPCVR
  3803         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3804         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3805             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3806             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3807         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3808         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3809     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3810            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3811     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3812         10  FILLER            PIC 999.                           ELCEPCVR
  3813         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3814         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3815             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3816             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3817         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3818         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3819     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3820            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3821     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3822         10  FILLER            PIC 999.                           ELCEPCVR
  3823         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3824         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3825             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3826             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3827         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3828         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3829     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3830            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3831     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3832         10  FILLER            PIC 999.                           ELCEPCVR
  3833         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3834         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3835             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3836             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3837         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3838         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3839     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3840            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3841     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3842         10  FILLER            PIC 999.                           ELCEPCVR
  3843         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3844         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3845             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3846             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3847         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3848         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3849     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3850            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3851
* 3852                             COPY ELCREINV.
  3853******************************************************************04/18/98
  3854*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  77
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3855*                                                                *ELCREINV
  3856*                            ELCREINV                            *   LV003
  3857*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3858*                            VMOD=2.001                          *ELCREINV
  3859*                                                                *ELCREINV
  3860*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3861*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3862*                                                                *ELCREINV
  3863******************************************************************ELCREINV
  3864                                                                  ELCREINV
  3865 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3866     05  WS-RE-LO-DATE.                                              CL**3
  3867         10 FILLER                     PIC 999.                      CL**3
  3868         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3869         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3870            15 RE-LO-CC                PIC 99.                       CL**3
  3871            15 RE-LO-YR                PIC 99.                       CL**3
  3872         10 RE-LO-MO                   PIC 99.                       CL**3
  3873         10 RE-LO-DA                   PIC 99.                       CL**3
  3874     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3875            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3876     05  WS-RE-HI-DATE.                                              CL**3
  3877         10 FILLER                     PIC 999.                      CL**3
  3878         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3879         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3880            15 RE-HI-CC                PIC 99.                       CL**3
  3881            15 RE-HI-YR                PIC 99.                       CL**3
  3882         10 RE-HI-MO                   PIC 99.                       CL**3
  3883         10 RE-HI-DA                   PIC 99.                       CL**3
  3884     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3885            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3886     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3887         10 FILLER                     PIC 999.                   ELCREINV
  3888         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3889         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3890            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3891            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3892         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3893         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3894     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3895            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3896     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3897         10  FILLER                    PIC 999.                   ELCREINV
  3898         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3899         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3900             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3901             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3902         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3903         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3904     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3905            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3906     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3907         10  FILLER                    PIC 999.                   ELCREINV
  3908         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3909         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3910             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3911             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3912         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  78
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3913         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3914     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3915            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3916
  3917 01  RC-REIN-HOLD-AREAS.
  3918     12  RC-REIN-LEVELS  OCCURS 30.
  3919         16  RC-REIN-COMP    PIC X(6).
  3920         16  RC-OLD-ISS      PIC X.
  3921         16  RC-NEW-ISS      PIC X.
  3922         16  RC-OLD-CNC      PIC X.
  3923         16  RC-NEW-CNC      PIC X.
  3924         16  RC-OLD-LF-CLM   PIC X.
  3925         16  RC-OLD-AH-CLM   PIC X.
  3926         16  RC-NEW-LF-CLM   PIC X.
  3927         16  RC-NEW-AH-CLM   PIC X.
  3928         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3929         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3930         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3931         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3932         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3933         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3934         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3935         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3936         16  RC-REIN-REM-SW  PIC X.
  3937     12  RC-REIN-LEVELS-END  PIC X(6).
  3938
  3939 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3940     12  TPC-COUNTERS    OCCURS 6.
  3941         16  TPL-ISS-PRM     PIC S9(9)V99.
  3942         16  TPA-ISS-PRM     PIC S9(9)V99.
  3943         16  TPL-CNC-PRM     PIC S9(9)V99.
  3944         16  TPA-CNC-PRM     PIC S9(9)V99.
  3945         16  TPL-ACCT-COM    PIC S9(9)V99.
  3946         16  TPA-ACCT-COM    PIC S9(9)V99.
  3947         16  TPL-CLAIMS      PIC S9(9)V99.
  3948         16  TPA-CLAIMS      PIC S9(9)V99.
  3949
  3950 01  HLD-DTS SYNC.
  3951     12  EOM-RUN-DATE        PIC 9(08).
  3952     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3953         16  EOM-CCYY.
  3954             20  EOM-CC      PIC 99.
  3955             20  EOM-YR      PIC 99.
  3956         16  EOM-MO          PIC 99.
  3957         16  EOM-DA          PIC 99.
  3958
  3959****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3960****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3961     12  OB-RUN-DATES OCCURS 2.
  3962         16  OB-CCYY         PIC 9(4).
  3963         16  OB-MO           PIC 99.
  3964         16  OB-DA           PIC 99.
  3965
  3966     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3967         88  OB-DATE-1-USED     VALUE '*'.
  3968     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3969         88  OB-DATE-2-USED     VALUE '*'.
  3970     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  79
* ECS010.cbl
  3971         88  OB-DATE-3-USED     VALUE '*'.
  3972     12  EARNING-START-DATE  PIC 9(08).
  3973     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3974         16  E-ERN-START-CC  PIC 99.
  3975         16  E-ERN-START-YR  PIC 99.
  3976         16  E-ERN-START-MO  PIC 99.
  3977         16  E-ERN-START-DA  PIC 99.
  3978     12  EARNING-STOP-DATE   PIC 9(08).
  3979     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  3980         16  E-ERN-STOP-CC   PIC 99.
  3981         16  E-ERN-STOP-YR   PIC 99.
  3982         16  E-ERN-STOP-MO   PIC 99.
  3983         16  E-ERN-STOP-DA   PIC 99.
  3984     12  STOP-LF-DATE        PIC 9(08).
  3985     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  3986         16  STOP-LF-CC      PIC 99.
  3987         16  STOP-LF-YR      PIC 99.
  3988         16  STOP-LF-MO      PIC 99.
  3989         16  STOP-LF-DA      PIC 99.
  3990     12  STOP-AH-DATE        PIC 9(08).
  3991     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  3992         16  STOP-AH-CC      PIC 99.
  3993         16  STOP-AH-YR      PIC 99.
  3994         16  STOP-AH-MO      PIC 99.
  3995         16  STOP-AH-DA      PIC 99.
  3996     12  BIN-VALUATION-DT    PIC XX.
  3997     12  BIN-EOM-RUN-DATE    PIC XX.
  3998     12  LAST-YRS-DATE       PIC 9(08).
  3999     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  4000         16  LYD-CCYY        PIC 9(04).
  4001         16  LYD-CCYR REDEFINES LYD-CCYY.
  4002             20  LYD-CC      PIC 99.
  4003             20  LYD-YR      PIC 99.
  4004         16  LYD-MO          PIC 99.
  4005         16  LYD-DA          PIC 99.
  4006     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  4007     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  4008         16  VAL-CC          PIC 99.
  4009         16  VAL-YR          PIC 99.
  4010         16  VAL-MO          PIC 99.
  4011         16  VAL-DA          PIC 99.
  4012     12  INCURRED-DATE       PIC 9(08).
  4013     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  4014         16  DTO-CC          PIC 99.
  4015         16  DTO-YR          PIC 99.
  4016         16  DTO-MO          PIC 99.
  4017         16  DTO-DA          PIC 99.
  4018     12  REPORTED-DATE.
  4019         16  RPT-YR          PIC 99.
  4020         16  RPT-MO          PIC 99.
  4021         16  RPT-DA          PIC 99.
  4022     12  PAYMENT-DATE        PIC 9(08).
  4023     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  4024         16  PAY-CC          PIC 99.
  4025         16  PAY-YR          PIC 99.
  4026         16  PAY-MO          PIC 99.
  4027         16  PAY-DA          PIC 99.
  4028     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  80
* ECS010.cbl
  4029     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  4030         16  PAYTO-CC        PIC 99.
  4031         16  PAYTO-YR        PIC 99.
  4032         16  PAYTO-MO        PIC 99.
  4033         16  PAYTO-DA        PIC 99.
  4034
  4035 01  AH-RES-STATE-TABLE.
  4036     12  FILLER              PIC X(42)       VALUE
  4037             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  4038     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  4039
  4040 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  4041     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  4042
  4043 01  BILLING-COUNTERS    COMP-3.
  4044     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  4045     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  4046     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  4047     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  4048     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  4049     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  4050     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  4051     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  4052     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  4053     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  4054     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  4055     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  4056     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  4057     12  BC-COMM             PIC S9(5)           VALUE +0.
  4058     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  4059     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  4060     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  4061     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  4062     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  4063     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  4064     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  4065     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  4066     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  4067     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  4068
  4069 01  FLAGS SYNC.
  4070     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  4071         88  CHECK-BILLED                        VALUE 'Y'.
  4072     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  4073         88  EOF-ON-TRANS                        VALUE '*'.
  4074     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  4075         88  EOF-ON-CERT                         VALUE '*'.
  4076     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  4077         88  PROCESSING-COMPLETED                VALUE '*'.
  4078     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  4079         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  4080     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  4081         88  PRINTING-CERT-CHANGES               VALUE '*'.
  4082     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  4083         88  STATUTORY-REQUIREMENT               VALUE '*'.
  4084     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  4085         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  4086     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  81
* ECS010.cbl
  4087         88  LIFE-FULLY-EARNED                   VALUE '*'.
  4088     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  4089         88  A-H-FULLY-EARNED                    VALUE '*'.
  4090     12  CNCL-FLG            PIC X               VALUE SPACE.
  4091     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  4092         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  4093         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  4094     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  4095         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  4096     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  4097         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  4098     12  EP-FLG              PIC X               VALUE SPACE.
  4099     12  END-FLG             PIC X               VALUE SPACE.
  4100     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  4101     12  PRIOR-CERT-IN-CNTRL.
  4102         16  PCIC-FIRST      PIC x(19)  value low-values.
  4103         16  pcic-dt         pic 9(11)  comp-3  value zeros.
  4104         16  pcic-cert-no    pic x(11)  value low-values.
  4105     12  ACCT-FLG            PIC X               VALUE SPACE.
  4106     12  STATE-FLG           PIC X               VALUE SPACE.
  4107     12  COMP-FLG            PIC X               VALUE SPACE.
  4108     12  CARR-FLG            PIC X               VALUE SPACE.
  4109     12  FINAL-FLG           PIC X               VALUE SPACE.
  4110     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  4111     12  REIN-FLG            PIC X               VALUE SPACE.
  4112     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  4113     12  REIN-RT-SW          PIC X               VALUE SPACE.
  4114
  4115 01  TEXAS-REG-WORK-AREAS   SYNC.
  4116     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  4117     12  TEX-FACT-2          PIC S999        COMP-3.
  4118     12  TEX-FACT-3          PIC S999        COMP-3.
  4119     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  4120     12  TEX-FACT-5          PIC S999        COMP-3.
  4121     12  TEX-FACT-6          PIC S999        COMP-3.
  4122     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  4123     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  4124     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  4125
  4126 01  NET-PAY-INTERFACE.
  4127     12  NP-APR              PIC S999V9(4)   COMP-3.
  4128     12  NP-ORIG             PIC S999        COMP-3.
  4129     12  NP-REM              PIC S999        COMP-3.
  4130     12  NP-OPT              PIC X.
  4131     12  NP-CAP              PIC S999        COMP-3.
  4132     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  4133     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  4134     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  4135     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  4136     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  4137     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  4138     12  NP-ACCOUNT          PIC X(10).
  4139
  4140 01  HOLDERS SYNC.
  4141     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  4142     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4143     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4144     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  82
* ECS010.cbl
  4145     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4146     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4147     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
  4148     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4149     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4150     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  4151     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  4152     12  TEMP-3              PIC S9(7)V99 COMP-3 VALUE +0.
  4153     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  4154     12  TEMP-5              PIC S9V9(9)  COMP-3 VALUE +0.
  4155     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  4156     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  4157     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  4158     12  REM-TRM1            PIC S999V99  COMP-3.
  4159     12  REM-TRM2            PIC S999V99  COMP-3.
  4160     12  REM-TRM3            PIC S999V99  COMP-3.
  4161     12  DCC-DDF-REM-TRM3    PIC S999V99  COMP-3.
  4162     12  TEM-TRM1            PIC S999V99  COMP-3.
  4163     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  4164     12  ORIG-TERM           PIC S999V99  COMP-3.
  4165     12  HLD-CONTROL.
  4166         16  HLD-CARRIER     PIC X               VALUE SPACES.
  4167         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  4168         16  HLD-STATE       PIC XX              VALUE SPACES.
  4169         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  4170     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  4171
  4172 01  DISPLAY-IBNR-LINE.
  4173     05  FILLER                  PIC X       VALUE SPACES.
  4174     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  4175     05  FILLER                  PIC XX      VALUE SPACES.
  4176     05  DIL-TYPE                PIC X       VALUE SPACES.
  4177     05  FILLER                  PIC X       VALUE SPACES.
  4178     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  4179     05  FILLER                  PIC XXX     VALUE SPACES.
  4180     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  4181
  4182 01  DISPLAY-HD-1.
  4183     05  FILLER      PIC X       VALUE SPACES.
  4184     05  FILLER      PIC X(50)   VALUE SPACES.
  4185     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  4186     05  FILLER      PIC X(51)   VALUE SPACES.
  4187     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4188
  4189 01  DISPLAY-HD-2.
  4190     05  FILLER                 PIC X       VALUE SPACE.
  4191     05  FILLER                 PIC X(57)   VALUE SPACES.
  4192     05  DIS-DATE               PIC X(8).
  4193     05  FILLER                 PIC X(66)   VALUE SPACES.
  4194
  4195 01  DISPLAY-LINE.
  4196     05  DL-FULL.
  4197         10  FILLER           PIC X       VALUE SPACE.
  4198         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  4199         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  4200
  4201 01  PRT-HDNGS SYNC.
  4202     12  TR-HD-1.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  83
* ECS010.cbl
  4203         16  FILLER      PIC X       VALUE '1'.
  4204         16  FILLER      PIC X(53)   VALUE SPACES.
  4205         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  4206         16  FILLER      PIC X(48)   VALUE SPACES.
  4207         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4208     12  TR-HD-2.
  4209         16  FILLER      PIC X       VALUE SPACE.
  4210         16  FILLER      PIC X(47)   VALUE SPACES.
  4211         16  TRHDNM      PIC X(30).
  4212         16  FILLER      PIC X(42)   VALUE SPACES.
  4213         16  TR-RN-DT    PIC X(8).
  4214     12  TR-HD-3.
  4215         16  FILLER      PIC X       VALUE SPACE.
  4216         16  FILLER      PIC X(53)   VALUE SPACES.
  4217         16  TR-MODAYR   PIC X(18).
  4218         16  FILLER      PIC X       VALUE SPACE.
  4219         16  TR-YRASK    PIC X       VALUE SPACE.
  4220         16  FILLER      PIC X(46)   VALUE SPACES.
  4221         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  4222         16  TR-PG       PIC ZZ,ZZ9.
  4223     12  TR-HD-4.
  4224         16  FILLER      PIC X       VALUE SPACE.
  4225         16  TR-AGCY     PIC X(30).
  4226     12  TR-HD-5.
  4227         16  FILLER      PIC X       VALUE SPACE.
  4228         16  TR-CARR     PIC X.
  4229         16  FILLER      PIC X       VALUE '-'.
  4230         16  TR-GROUP    PIC X(6).
  4231         16  FILLER      PIC X       VALUE '-'.
  4232         16  TR-ST-NO    PIC X(2).
  4233         16  FILLER      PIC X       VALUE '-'.
  4234         16  TR-AG-NO    PIC X(10).
  4235         16  FILLER      PIC X(23)   VALUE SPACES.
  4236         16  TR5-RP-TYP.
  4237             20  FILLER  PIC X(20)   VALUE
  4238                     '* * * * TRANSACTION '.
  4239             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  4240     12  TR-HD-6.
  4241         16  FILLER      PIC X       VALUE SPACE.
  4242         16  TR-CE-MO    PIC XX.
  4243         16  FILLER      PIC X       VALUE '-'.
  4244         16  TR-CE-DA    PIC XX.
  4245         16  FILLER      PIC X       VALUE '-'.
  4246         16  TR-CE-YR    PIC XX.
  4247         16  FILLER      PIC X(6)    VALUE '  TO  '.
  4248         16  TR-CX.
  4249             20  TR-CX-MO PIC XX.
  4250             20  HSHR1    PIC X.
  4251             20  TR-CX-DA PIC XX.
  4252             20  HSHR2    PIC X.
  4253             20  TR-CX-YR PIC XX.
  4254     12  TR-HD-7.
  4255         16  FILLER  PIC X      VALUE '0'.
  4256         16  FILLER  PIC X(24)  VALUE SPACES.
  4257         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  4258         16  TR-7-LF PIC X(6).
  4259         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  4260         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  84
* ECS010.cbl
  4261         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  4262         16  TR-7-AH PIC X(6).
  4263         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  4264         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  4265     12  TR-HD-8.
  4266         16  FILLER  PIC X      VALUE SPACE.
  4267         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  4268         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  4269         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  4270         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  4271         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  4272     12  TR-HD-9.
  4273         16  FILLER  PIC X      VALUE SPACE.
  4274         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  4275         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  4276         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  4277         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  4278         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  4279         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  4280     12  TR-TTL-HD.
  4281         16  FILLER      PIC X       VALUE '0'.
  4282         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  4283         16  FILLER      PIC XX      VALUE SPACES.
  4284         16  TTL-HD-DS   PIC X(60)   VALUE
  4285             'ECS010 CONTROL TOTALS'.
  4286
  4287 01  TR-DTL.
  4288     12  FILLER                  PIC X           VALUE SPACE.
  4289     12  TR-DTL1.
  4290         16  TRD-CERT            PIC X(11).
  4291         16  TRD-ISDT.
  4292             20  FILLER          PIC X           VALUE SPACE.
  4293             20  TRD-ISMO        PIC XX.
  4294             20  TRD-IS-S1       PIC X           VALUE '/'.
  4295             20  TRD-ISDA        PIC XX.
  4296             20  TRD-IS-S2       PIC X           VALUE '/'.
  4297             20  TRD-ISYR        PIC XX.
  4298             20  FILLER          PIC X           VALUE SPACE.
  4299         16  TRD-AGE             PIC XX.
  4300     12  TR-DTL2.
  4301         16  FILLER              PIC X           VALUE SPACE.
  4302         16  TRD-LFTYP           PIC XXX.
  4303         16  FILLER              PIC X           VALUE SPACE.
  4304         16  TRD-LFTRM           PIC ZZ9.
  4305         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4306         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4307         16  TRD-LFACTDT.
  4308             20  FILLER          PIC X           VALUE SPACE.
  4309             20  TRD-LFACTMO     PIC XX.
  4310             20  TRD-LF-S1       PIC X           VALUE '/'.
  4311             20  TRD-LFACTDA     PIC XX.
  4312             20  TRD-LF-S2       PIC X           VALUE '/'.
  4313             20  TRD-LFACTYR     PIC XX.
  4314             20  FILLER          PIC X           VALUE SPACE.
  4315         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  4316         16  FILLER              PIC X           VALUE SPACE.
  4317         16  TRD-LF-STATUS       PIC X.
  4318         16  FILLER              PIC X(4)        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  85
* ECS010.cbl
  4319         16  TRD-AHTYP           PIC XXX.
  4320         16  FILLER              PIC X           VALUE SPACE.
  4321         16  TRD-AHTRM           PIC ZZ9.
  4322         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4323         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4324         16  TRD-AHACTDT.
  4325             20  FILLER          PIC X           VALUE SPACE.
  4326             20  TRD-AHACTMO     PIC XX.
  4327             20  TRD-AH-S1       PIC X           VALUE '/'.
  4328             20  TRD-AHACTDA     PIC XX.
  4329             20  TRD-AH-S2       PIC X           VALUE '/'.
  4330             20  TRD-AHACTYR     PIC XX.
  4331             20  FILLER          PIC X           VALUE SPACE.
  4332         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  4333         16  FILLER              PIC X           VALUE SPACE.
  4334         16  TRD-AH-STATUS       PIC X.
  4335     12  TR-DTL3 REDEFINES TR-DTL2.
  4336         16  FILLER              PIC X(20).
  4337         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  4338         16  FILLER              PIC X.
  4339         16  TRD-IBNRX           PIC X(4).
  4340         16  FILLER              PIC X(2).
  4341         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  4342         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  4343                                 PIC X(11).
  4344         16  FILLER              PIC X.
  4345         16  TRD-PAYCURX         PIC X(8).
  4346         16  FILLER              PIC X(2).
  4347         16  TRD-FUTRSV-DATA.
  4348             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  4349             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  4350                                 PIC X(11).
  4351             20  FILLER          PIC X.
  4352             20  TRD-FUTRSVX     PIC X(6).
  4353         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  4354             20  TRD-BENEFIT-X   PIC X(10).
  4355             20  TRD-BENEFIT-CODE
  4356                                 PIC X(02).
  4357             20  FILLER          PIC X(06).
  4358         16  FILLER              PIC X(4).
  4359         16  TRD-RSV-DESC        PIC X(6).
  4360         16  TRD-RSV-ACTION      PIC X(21).
  4361
  4362 01  DET-PR-UREC.
  4363     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  4364     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  4365     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  4366     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  4367     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  4368     12  DET-SEX             PIC X.
  4369     12  FILLER              PIC X(9)     VALUE '   APR - '.
  4370     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  4371     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  4372     12  DET-PR-MEM          PIC X(12).
  4373     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  4374     12  DET-PR-SS           PIC X(11).
  4375     12  FILLER              PIC XXX      VALUE SPACES.
  4376     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  86
* ECS010.cbl
  4377
  4378 01  DET-PR-UREC-2.
  4379     12  FILLER              PIC X        VALUE SPACE.
  4380     12  DET-LF-DESC         PIC XX.
  4381     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4382     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4383     12  FILLER              PIC X(4)     VALUE ' TO '.
  4384     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4385     12  FILLER              PIC X        VALUE SPACE.
  4386     12  DET-AH-DESC         PIC XX.
  4387     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4388     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4389     12  FILLER              PIC X(4)     VALUE ' TO '.
  4390     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4391     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  4392     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4393     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  4394     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4395     12  FILLER              PIC X(5)     VALUE SPACES.
  4396     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4397
  4398 01  DET-PR-UREC-3.
  4399     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  4400     12  DET-IND-GRP         PIC X.
  4401     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  4402     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  4403     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  4404     12  DET-POL-FORM        PIC X(12).
  4405     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  4406     12  DET-LOAN-OFFICER    PIC XXX.
  4407     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  4408     12  DET-USER-CODE       PIC X.
  4409     12  FILLER              PIC X(8)     VALUE SPACES.
  4410     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4411
  4412 01  DET-PR-UREC-4.
  4413     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  4414     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4415     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  4416     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4417     12  FILLER              PIC X(37)    VALUE SPACES.
  4418     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4419
  4420 01  DET-PR-UREC-5.
  4421     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4422     12  DET-LF-BEN-CD       PIC XX.
  4423     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4424     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4425     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4426     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4427     12  FILLER              PIC X(30)    VALUE SPACES.
  4428     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4429
  4430 01  DET-PR-UREC-6.
  4431     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4432     12  DET-AH-BEN-CD       PIC XX.
  4433     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4434     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  87
* ECS010.cbl
  4435     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4436     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4437     12  FILLER              PIC X(30)    VALUE SPACES.
  4438     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4439
  4440 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4441     88  WS-CHANGE-REC              VALUE 'Y'.
  4442
  4443 01  TOTAL-PAGE-HD1.
  4444     12  FILLER              PIC X               VALUE SPACE.
  4445     12  TPH1-TYPE           PIC X(8).
  4446     12  TPH1-DESC.
  4447         16  TPH1-ST-CODE    PIC XX.
  4448         16  FILLER          PIC XXX.
  4449         16  TPH1-ST-DESC    PIC X(20).
  4450
  4451 01  TOTAL-PAGE-HD2.
  4452     12  FILLER              PIC X           VALUE SPACE.
  4453     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4454     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4455     12  FILLER              PIC X(9)        VALUE SPACES.
  4456     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4457     12  FILLER              PIC X(11)       VALUE SPACES.
  4458     12  FILLER              PIC X(3)        VALUE 'NET'.
  4459     12  FILLER              PIC X(11)       VALUE SPACES.
  4460     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4461     12  FILLER              PIC X(10)       VALUE SPACES.
  4462     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4463
  4464 01  TOTAL-PAGE-HD3.
  4465     12  FILLER              PIC X           VALUE SPACE.
  4466     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4467     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4468     12  FILLER              PIC X(10)       VALUE SPACES.
  4469     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4470     12  FILLER              PIC X(10)       VALUE SPACES.
  4471     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4472     12  FILLER              PIC X(7)        VALUE SPACES.
  4473     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4474     12  FILLER              PIC X(08)       VALUE SPACES.
  4475     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4476     12  FILLER              PIC X(11)       VALUE SPACES.
  4477     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4478
  4479 01  TOTAL-PAGE-DETAIL.
  4480     12  FILLER              PIC X(5).
  4481     12  TPD-DESC            PIC X(6).
  4482     12  FILLER              PIC X(3).
  4483     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4484     12  FILLER              PIC X(2).
  4485     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4486     12  FILLER              PIC X(2).
  4487     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4488     12  FILLER              PIC X(2).
  4489     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4490     12  FILLER              PIC X(2).
  4491     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4492     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  88
* ECS010.cbl
  4493     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4494     12  FILLER              PIC X(4).
  4495     12  TPD-LO-CERT         PIC X(6).
  4496     12  FILLER              PIC X(2).
  4497     12  TPD-HI-CERT         PIC X(6).
  4498*    12  FILLER              PIC X.
  4499*    12  TPD-LO-CERT         PIC X(8).
  4500*    12  FILLER              PIC X.
  4501*    12  TPD-HI-CERT         PIC X(8).
  4502
  4503 01  DUPE-CERT-TABLE.
  4504     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4505         16  DUPE-ENTRY      PIC X(36).
  4506         16  DUPE-STATUS     PIC X(01).
  4507         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4508         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4509
  4510 01  MISMATCH-HEADING-1.
  4511     12  FILLER              PIC X           VALUE '1'.
  4512     12  FILLER              PIC X(45)       VALUE SPACES.
  4513     12  FILLER              PIC X(42)       VALUE
  4514             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4515     12  FILLER              PIC X(35)       VALUE SPACES.
  4516     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4517
  4518 01  MISMATCH-HEADING-2.
  4519     12  FILLER              PIC X           VALUE '0'.
  4520     12  FILLER              PIC X(44)       VALUE
  4521             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4522     12  FILLER              PIC X(44)       VALUE
  4523             'YPE      CERT IN CONTROL                    '.
  4524     12  FILLER              PIC X(44)       VALUE
  4525             '        CERT OUT CONTROL           STATUS   '.
  4526
  4527 01  MISMATCH-DETAIL.
  4528     12  FILLER              PIC X           VALUE '0'.
  4529     12  FILLER              PIC X           VALUE SPACES.
  4530     12  DTL-MATCH-CONTROL   PIC X(36).
  4531     12  FILLER              PIC X(3)        VALUE SPACES.
  4532     12  DTL-REC-TYPE        PIC X.
  4533     12  FILLER              PIC X(2)        VALUE SPACES.
  4534     12  DTL-REC-TYPE-DESC   PIC X(3).
  4535     12  FILLER              PIC X(3)        VALUE SPACES.
  4536     12  DTL-CERT-IN-CONTROL
  4537                             PIC X(36).
  4538     12  FILLER              PIC X           VALUE SPACES.
  4539     12  DTL-CERT-OUT-CONTROL
  4540                             PIC X(36).
  4541     12  FILLER              PIC X           VALUE SPACES.
  4542     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4543     12  FILLER              PIC X(2)        VALUE SPACES.
  4544
  4545 01  MISMATCH-DETAIL-2.
  4546     12  FILLER              PIC X           VALUE ' '.
  4547     12  FILLER              PIC X           VALUE SPACES.
  4548     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4549             ' LIFE PREMIUM = '.
  4550     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  89
* ECS010.cbl
  4551     12  FILLER              PIC X           VALUE SPACES.
  4552     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4553             'LIFE ALT PREM = '.
  4554     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
  4555     12  FILLER              PIC XX          VALUE SPACES.
  4556     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4557             'A/H PREMIUM = '.
  4558     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4559     12  FILLER              PIC X(39)       VALUE SPACES.
  4560
  4561 01  MISMATCH-DETAIL-3.
  4562     12  FILLER              PIC X           VALUE ' '.
  4563     12  FILLER              PIC X           VALUE SPACES.
  4564     12  FILLER              PIC X(16)       VALUE
  4565             ' LIFE  REFUND = '.
  4566     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4567     12  FILLER              PIC X           VALUE SPACES.
  4568     12  FILLER              PIC X(16)       VALUE
  4569             'A & H  REFUND = '.
  4570     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4571     12  FILLER              PIC X(72)       VALUE SPACES.
  4572
  4573 01  MISMATCH-DETAIL-4.
  4574     12  FILLER              PIC X           VALUE ' '.
  4575     12  FILLER              PIC X           VALUE SPACES.
  4576     12  FILLER              PIC X(16)       VALUE
  4577             ' LIFE  CLAIM  = '.
  4578     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4579     12  FILLER              PIC X           VALUE SPACES.
  4580     12  FILLER              PIC X(16)       VALUE
  4581             'A & H  CLAIM  = '.
  4582     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4583     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  90
* ECS010.cbl
  4585*
  4586*
  4587* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  91
* ECS010.cbl
  4589 01  PB-STARTS-HERE              PIC X(48)
  4590       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4591
* 4592                             COPY ERCPNDB.
  4593******************************************************************
  4594*                                                                *
  4595*                                                                *
  4596*                            ERCPNDB.                            *
  4597*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4598*                            VMOD=2.025                          *
  4599*                                                                *
  4600*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4601*                                                                *
  4602******************************************************************
  4603*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4604*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4605******************************************************************
  4606*                                                                *
  4607*                                                                *
  4608*   FILE TYPE = VSAM,KSDS                                        *
  4609*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4610*                                                                *
  4611*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4612*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4613*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4614*                                                 RKP=13,LEN=36  *
  4615*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4616*                                      AND CHG-SEQ.)             *
  4617*                                                RKP=49,LEN=11   *
  4618*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4619*                                      AND CHG-SEQ.)             *
  4620*                                                RKP=60,LEN=15   *
  4621*                                                                *
  4622*   LOG = NO                                                     *
  4623*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4624******************************************************************
  4625******************************************************************
  4626*                   C H A N G E   L O G
  4627*
  4628* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4629*-----------------------------------------------------------------
  4630*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4631* EFFECTIVE    NUMBER
  4632*-----------------------------------------------------------------
  4633* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4634* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4635* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4636* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4637* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4638* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4639* 032306                   PEMA  ADD BOW LOAN NUMBER
  4640* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4641* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4642* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4643* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4644* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4645* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4646* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  92
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4647* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4648******************************************************************
  4649
  4650 01  PENDING-BUSINESS.
  4651     12  PB-RECORD-ID                     PIC XX.
  4652         88  VALID-PB-ID                        VALUE 'PB'.
  4653
  4654     12  PB-CONTROL-PRIMARY.
  4655         16  PB-COMPANY-CD                PIC X.
  4656         16  PB-ENTRY-BATCH               PIC X(6).
  4657         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4658         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4659
  4660     12  PB-CONTROL-BY-ACCOUNT.
  4661         16  PB-COMPANY-CD-A1             PIC X.
  4662         16  PB-CARRIER                   PIC X.
  4663         16  PB-GROUPING.
  4664             20  PB-GROUPING-PREFIX       PIC XXX.
  4665             20  PB-GROUPING-PRIME        PIC XXX.
  4666         16  PB-STATE                     PIC XX.
  4667         16  PB-ACCOUNT.
  4668             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4669             20  PB-ACCOUNT-PRIME         PIC X(6).
  4670         16  PB-CERT-EFF-DT               PIC XX.
  4671         16  PB-CERT-NO.
  4672             20  PB-CERT-PRIME            PIC X(10).
  4673             20  PB-CERT-SFX              PIC X.
  4674         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4675
  4676         16  PB-RECORD-TYPE               PIC X.
  4677             88  PB-MAILING-DATA                VALUE '0'.
  4678             88  PB-ISSUE                       VALUE '1'.
  4679             88  PB-CANCELLATION                VALUE '2'.
  4680             88  PB-BATCH-TRAILER               VALUE '9'.
  4681
  4682     12  PB-CONTROL-BY-ORIG-BATCH.
  4683         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4684         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4685         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4686         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4687
  4688     12  PB-CONTROL-BY-CSR.
  4689         16  PB-CSR-COMPANY-CD            PIC X.
  4690         16  PB-CSR-ID                    PIC X(4).
  4691         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4692         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4693         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4694******************************************************************
  4695*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4696******************************************************************
  4697
  4698     12  PB-LAST-MAINT-DT                 PIC XX.
  4699     12  PB-LAST-MAINT-BY                 PIC X(4).
  4700     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4701
  4702     12  PB-RECORD-BODY                   PIC X(375).
  4703
  4704     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  93
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4705         16  PB-CERT-ORIGIN               PIC X.
  4706             88  CLASIC-CREATED-CERT         VALUE '1'.
  4707         16  PB-I-NAME.
  4708             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4709             20  PB-I-INSURED-FIRST-NAME.
  4710                 24  PB-I-INSURED-1ST-INIT PIC X.
  4711                 24  FILLER                PIC X(9).
  4712             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4713         16  PB-I-AGE                     PIC S99   COMP-3.
  4714         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4715         16  PB-I-BIRTHDAY                PIC XX.
  4716         16  PB-I-INSURED-SEX             PIC X.
  4717             88  PB-SEX-MALE     VALUE 'M'.
  4718             88  PB-SEX-FEMALE   VALUE 'F'.
  4719
  4720         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4721         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4722         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4723         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4724         16  PB-I-SKIP-CODE               PIC X.
  4725             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4726             88  PB-SKIP-JULY              VALUE '1'.
  4727             88  PB-SKIP-AUGUST            VALUE '2'.
  4728             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4729             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4730             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4731             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4732             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4733             88  PB-SKIP-JUNE              VALUE '8'.
  4734             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4735             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4736             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4737         16  PB-I-TERM-TYPE               PIC X.
  4738             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4739             88  PB-PAID-WEEKLY            VALUE 'W'.
  4740             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4741             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4742             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4743         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4744         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4745         16  PB-I-DATA-ENTRY-SW           PIC X.
  4746             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4747             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4748             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4749             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4750         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4751         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4752*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4753         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4754         16  FILLER                       PIC X.
  4755
  4756         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4757             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4758             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4759                                                   '90' THRU '99'.
  4760         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4761                                          PIC XX.
  4762         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  94
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4763         16  PB-I-AMOUNT-FINANCED REDEFINES
  4764                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4765         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4766         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4767                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4768         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4769         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4770         16  PB-I-CLP-AMOUNT REDEFINES
  4771                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4772         16  PB-I-LF-CALC-FLAG            PIC X.
  4773             88 PB-COMP-LF-PREM               VALUE '?'.
  4774         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4775         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4776         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4777         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4778         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4779         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4780         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4781         16  PB-I-LF-ABBR                 PIC XXX.
  4782         16  PB-I-LF-INPUT-CD             PIC XX.
  4783
  4784         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4785             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4786             88  PB-INVALID-AH               VALUE '  ' '00'
  4787                                                   '90' THRU '99'.
  4788         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4789         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4790         16  PB-I-AH-CALC-FLAG            PIC X.
  4791             88 PB-COMP-AH-PREM                  VALUE '?'.
  4792         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4793         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4794         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4795         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4796         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4797         16  PB-I-AH-ABBR                 PIC XXX.
  4798         16  PB-I-AH-INPUT-CD             PIC XXX.
  4799
  4800         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4801         16  PB-I-REIN-TABLE              PIC XXX.
  4802         16  PB-I-BUSINESS-TYPE           PIC 99.
  4803         16  PB-I-INDV-GRP-CD             PIC X.
  4804         16  PB-I-MORT-CODE.
  4805             20  PB-I-TABLE               PIC X.
  4806             20  PB-I-INTEREST            PIC XX.
  4807             20  PB-I-MORT-TYP            PIC X.
  4808         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4809         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4810         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4811         16  PB-I-INDV-GRP-OVRD           PIC X.
  4812         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4813         16  PB-I-SIG-SW                  PIC X.
  4814             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4815         16  PB-I-RATE-CLASS              PIC XX.
  4816         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4817         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4818         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4819         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4820         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  95
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4821         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4822         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4823         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4824         16  PB-I-OB-FLAG                 PIC X.
  4825             88  PB-I-OB                      VALUE 'B'.
  4826             88  PB-I-SUMMARY                 VALUE 'Z'.
  4827         16  PB-I-ENTRY-STATUS            PIC X.
  4828             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4829                                              'M' '5' '9' '2'.
  4830             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4831             88  PB-I-POLICY-PENDING          VALUE '2'.
  4832             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4833             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4834             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4835             88  PB-I-REIN-ONLY               VALUE '9'.
  4836             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4837             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4838             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4839             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4840         16  PB-I-INT-CODE                PIC X.
  4841             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4842             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4843         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4844         16  PB-I-SOC-SEC-NO              PIC X(11).
  4845         16  PB-I-MEMBER-NO               PIC X(12).
  4846         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4847*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4848         16  PB-I-OLD-LOF                 PIC XXX.
  4849         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4850         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4851         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4852         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4853         16  PB-I-LIFE-INDICATOR          PIC X.
  4854             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4855         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4856         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4857                                          PIC S9(5)V99    COMP-3.
  4858         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4859             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4860             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4861         16  PB-I-1ST-PMT-DT              PIC XX.
  4862         16  PB-I-JOINT-INSURED.
  4863             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4864             20 PB-I-JOINT-FIRST-NAME.
  4865                24  PB-I-JOINT-FIRST-INIT PIC X.
  4866                24  FILLER                PIC X(9).
  4867             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4868*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4869         16  PB-I-BENEFICIARY-NAME.
  4870             20  PB-I-BANK-NUMBER         PIC X(10).
  4871             20  FILLER                   PIC X(15).
  4872         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4873         16  PB-I-REFERENCE               PIC X(12).
  4874         16  FILLER REDEFINES PB-I-REFERENCE.
  4875             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4876             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4877             20  PB-I-CLP-STATE           PIC XX.
  4878         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  96
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4879             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4880             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4881             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4882         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4883         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4884         16  PB-I-RESIDENT-STATE          PIC XX.
  4885         16  PB-I-RATE-CODE               PIC X(4).
  4886         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4887         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4888         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4889         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4890         16  PB-I-BANK-NOCHRGB            PIC 99.
  4891         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4892         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4893
  4894     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4895         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4896             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4897         16  PB-C-CANCEL-ORIGIN           PIC X.
  4898             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4899         16  PB-C-LF-CANCEL-DT            PIC XX.
  4900         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4901         16  PB-C-LF-CALC-REQ             PIC X.
  4902             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4903         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4904         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4905         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4906             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4907         16  PB-C-AH-CANCEL-DT            PIC XX.
  4908         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4909         16  PB-C-AH-CALC-REQ             PIC X.
  4910             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4911         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4912         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4913         16  PB-C-LAST-NAME               PIC X(15).
  4914         16  PB-C-REFUND-SW               PIC X.
  4915             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4916             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4917         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4918         16  PB-C-PAYEE-CODE              PIC X(6).
  4919         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4920         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4921         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4922         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4923         16  PB-C-REFERENCE               PIC X(12).
  4924         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4925         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4926         16  PB-C-POST-CARD-IND           PIC X.
  4927         16  PB-C-CANCEL-REASON           PIC X.
  4928         16  PB-C-REF-INTERFACE-SW        PIC X.
  4929         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4930         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4931         16  FILLER                       PIC X(01).
  4932*        16  FILLER                       PIC X(18).
  4933         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4934*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4935         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4936         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  97
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4937             20  PB-CI-INSURED-NAME.
  4938                 24  PB-CI-LAST-NAME      PIC X(15).
  4939                 24  PB-CI-INITIALS       PIC XX.
  4940             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4941             20  PB-CI-INSURED-SEX        PIC X.
  4942             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4943             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4944             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4945             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4946             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4947             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4948             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4949             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4950             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4951             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4952             20  PB-CI-RATE-CLASS         PIC XX.
  4953             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4954             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4955             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4956             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4957             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4958             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4959             20  PB-CI-LF-ABBR            PIC X(3).
  4960             20  PB-CI-AH-ABBR            PIC X(3).
  4961             20  PB-CI-OB-FLAG            PIC X.
  4962                 88  PB-CI-OB                VALUE 'B'.
  4963             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4964                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4965                                           'M' '4' '5' '9' '2'.
  4966                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4967                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4968                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4969                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4970                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4971                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4972                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4973                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4974                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4975                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4976                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4977                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4978             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4979                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4980                                           'M' '4' '5' '9' '2'.
  4981                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4982                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4983                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4984                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4985                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4986                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4987                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4988                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4989                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4990                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4991                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4992                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4993             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4994             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  98
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4995             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4996             20  PB-CI-MEMBER-NO          PIC X(12).
  4997             20  PB-CI-INT-CODE           PIC X.
  4998                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4999                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5000             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5001             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5002             20  PB-CI-COMP-EXCP-SW       PIC X.
  5003                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5004                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5005             20  PB-CI-ENTRY-STATUS       PIC X.
  5006             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5007             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5008             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5009             20  PB-CI-DEATH-DT           PIC XX.
  5010             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5011             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5012             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5013             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5014             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5015             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5016             20  PB-CI-ENTRY-DT              PIC XX.
  5017             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5018             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5019             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5020             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5021             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5022             20  PB-CI-OLD-LOF               PIC XXX.
  5023*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5024             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5025             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5026             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5027             20  PB-CI-INDV-GRP-CD           PIC X.
  5028             20  PB-CI-BENEFICIARY-NAME.
  5029                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5030                 24  FILLER                  PIC X(15).
  5031             20  PB-CI-NOTE-SW               PIC X.
  5032             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5033             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5034             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5035             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5036             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5037             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5038             20  PB-CI-FIRST-NAME            PIC X(10).
  5039             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5040
  5041         16  FILLER                       PIC X(13).
  5042*032306  16  FILLER                       PIC X(27).
  5043*        16  FILLER                       PIC X(46).
  5044
  5045     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5046         16  FILLER                       PIC X(10).
  5047         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5048         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5049         16  PB-M-INSURED-MID-INIT        PIC X.
  5050         16  PB-M-INSURED-AGE             PIC 99.
  5051         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5052         16  PB-M-INSURED-SEX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page  99
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5053         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5054         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5055         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5056         16  PB-M-INSURED-CITY-STATE.
  5057             20  PB-M-INSURED-CITY        PIC X(28).
  5058             20  PB-M-INSURED-STATE       PIC XX.
  5059         16  PB-M-INSURED-ZIP-CODE.
  5060             20  PB-M-INSURED-ZIP-PRIME.
  5061                 24  PB-M-INSURED-ZIP-1   PIC X.
  5062                     88  PB-M-CANADIAN-POST-CODE
  5063                                             VALUE 'A' THRU 'Z'.
  5064                 24  FILLER               PIC X(4).
  5065             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5066         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5067                                        PB-M-INSURED-ZIP-CODE.
  5068             20  PM-M-INS-CAN-POST1       PIC XXX.
  5069             20  PM-M-INS-CAN-POST2       PIC XXX.
  5070             20  FILLER                   PIC XXX.
  5071         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5072         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5073         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5074         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5075         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5076         16  PB-M-CRED-BENE-CITYST.
  5077             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5078             20  PB-M-CRED-BENE-STATE     PIC XX.
  5079
  5080         16  FILLER                       PIC X(92).
  5081
  5082     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5083         16  FILLER                       PIC X(10).
  5084         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5085         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5086         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5087         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5088         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5089         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5090         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5091         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5092         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5093         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5094         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5095         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5096         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5097         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5098         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5099         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5100         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5101         16  PB-ACCOUNT-NAME              PIC X(30).
  5102         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5103         16  PB-REFERENCE                 PIC X(12).
  5104         16  PB-B-RECEIVED-DT             PIC XX.
  5105         16  FILLER                       PIC X(234).
  5106
  5107     12  PB-RECORD-STATUS.
  5108         16  PB-CREDIT-SELECT-DT          PIC XX.
  5109         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5110         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 100
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5111         16  PB-BILLING-STATUS            PIC X.
  5112             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5113             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5114             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5115         16  PB-RECORD-BILL               PIC X.
  5116             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5117             88  PB-RECORD-RETURNED           VALUE 'R'.
  5118             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5119             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5120             88  PB-OVERRIDE-AH               VALUE 'A'.
  5121             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5122         16  PB-BATCH-ENTRY               PIC X.
  5123             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5124             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5125             88  PB-REISSUED-CERT             VALUE 'E'.
  5126             88  PB-MONTHLY-CERT              VALUE 'M'.
  5127             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5128             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5129             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5130         16  PB-FORCE-CODE                PIC X.
  5131             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5132             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5133             88  PB-CANCEL-FORCE              VALUE '8'.
  5134             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5135             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5136             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5137             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5138             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5139             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5140             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5141         16  PB-FATAL-FLAG                PIC X.
  5142             88  PB-FATAL-ERRORS              VALUE 'X'.
  5143         16  PB-FORCE-ER-CD               PIC X.
  5144             88  PB-FORCE-ERRORS              VALUE 'F'.
  5145             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5146         16  PB-WARN-ER-CD                PIC X.
  5147             88  PB-WARNING-ERRORS            VALUE 'W'.
  5148         16  FILLER                       PIC X.
  5149         16  PB-OUT-BAL-CD                PIC X.
  5150             88  PB-OUT-OF-BAL                VALUE 'O'.
  5151         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5152         16  PB-AH-OVERRIDE-L1            PIC X.
  5153         16  PB-INPUT-DT                  PIC XX.
  5154         16  PB-INPUT-BY                  PIC X(4).
  5155         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5156         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5157         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5158         16  PB-LF-EARNING-METHOD         PIC X.
  5159         16  PB-AH-EARNING-METHOD         PIC X.
  5160         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5161         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5162         16  PB-REIN-CD                   PIC XXX.
  5163         16  PB-LF-REFUND-TYPE            PIC X.
  5164         16  PB-AH-REFUND-TYPE            PIC X.
  5165         16  PB-ACCT-EFF-DT               PIC XX.
  5166         16  PB-ACCT-EXP-DT               PIC XX.
  5167         16  PB-COMPANY-ID                PIC X(3).
  5168         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 101
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5169         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5170         16  PB-SV-CARRIER                PIC X.
  5171         16  PB-SV-GROUPING               PIC X(6).
  5172         16  PB-SV-STATE                  PIC XX.
  5173         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5174         16  PB-GA-BILLING-INFO.
  5175             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5176                                          PIC XX.
  5177         16  PB-SV-REMIT-TO  REDEFINES
  5178             PB-GA-BILLING-INFO           PIC X(10).
  5179         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5180         16  PB-I-LOAN-OFFICER            PIC X(5).
  5181         16  PB-I-VIN                     PIC X(17).
  5182
  5183         16  FILLER                       PIC X(04).
  5184         16  IMNET-BYPASS-SW              PIC X.
  5185
  5186******************************************************************
  5187*                COMMON EDIT ERRORS                              *
  5188******************************************************************
  5189
  5190     12  PB-COMMON-ERRORS.
  5191         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5192                                           PIC S9(4)     COMP.
  5193
  5194******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 102
* ECS010.cbl
  5196 01  PC-STARTS-HERE              PIC X(48)
  5197       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  5198
* 5199                             COPY ERCPNDC.
  5200******************************************************************04/29/98
  5201*                                                                *ERCPNDC
  5202*                                                                *ERCPNDC
  5203*                            ERCPNDC                             *   LV003
  5204*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5205*                            VMOD=2.004                          *   CL**2
  5206*                                                                *ERCPNDC
  5207*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  5208*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  5209*                                                                *ERCPNDC
  5210*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  5211*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  5212*                                                                *ERCPNDC
  5213*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  5214*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  5215*                                                                *ERCPNDC
  5216*   LOG = YES                                                    *ERCPNDC
  5217*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  5218******************************************************************ERCPNDC
  5219                                                                  ERCPNDC
  5220 01  PENDING-CLAIMS.                                              ERCPNDC
  5221     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  5222         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  5223                                                                  ERCPNDC
  5224     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  5225         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  5226         16  PC-CARRIER                   PIC X.                  ERCPNDC
  5227         16  PC-GROUPING.                                         ERCPNDC
  5228             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  5229             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  5230         16  PC-STATE                     PIC XX.                 ERCPNDC
  5231         16  PC-ACCOUNT.                                          ERCPNDC
  5232             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  5233             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  5234         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  5235         16  PC-CERT-NO.                                          ERCPNDC
  5236             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  5237             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  5238         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  5239         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  5240                                                                  ERCPNDC
  5241         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  5242             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  5243             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  5244         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  5245                                                                  ERCPNDC
  5246     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  5247     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  5248     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  5249                                                                  ERCPNDC
  5250     12  PC-CLAIM-RECORD.                                         ERCPNDC
  5251         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  5252             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  5253             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 103
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5254             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  5255             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  5256         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  5257         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  5258         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  5259         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  5260         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  5261         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  5262         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  5263         16  FILLER                       PIC XX.                 ERCPNDC
  5264         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  5265             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  5266             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  5267             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  5268             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  5269             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  5270             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  5271             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  5272                                                                  ERCPNDC
  5273         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5274         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  5275         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  5276         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5277                                                                  ERCPNDC
  5278         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  5279         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  5280         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  5281                                                                  ERCPNDC
  5282         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  5283             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  5284                                                                  ERCPNDC
  5285         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  5286         16  FILLER                       PIC X(48).              ERCPNDC
  5287                                                                  ERCPNDC
  5288         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  5289             20  PC-CC-INSURED-NAME.                              ERCPNDC
  5290                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  5291                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  5292             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  5293             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  5294             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  5295             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  5296             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  5297             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  5298             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  5299             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  5300             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5301             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5302             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  5303             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  5304             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  5305                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  5306             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  5307                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5308                                               '4' '5' '9' '2'.   ERCPNDC
  5309                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5310                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5311                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 104
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5312                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5313                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5314                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5315                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5316                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5317                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  5318             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  5319                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5320                                               '4' '5' '9' '2'.   ERCPNDC
  5321                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5322                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5323                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  5324                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5325                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5326                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5327                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5328                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5329                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  5330             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  5331             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  5332             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  5333             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  5334             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  5335                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  5336                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  5337             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  5338             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  5339             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  5340             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  5341             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  5342             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  5343             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  5344             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  5345         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  5346         16  PC-CC-CLP-STATE              PIC XX.
  5347         16  FILLER                       PIC X(14).              ERCPNDC
  5348         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  5349         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  5350         16  FILLER                       PIC X(34).              ERCPNDC
  5351                                                                  ERCPNDC
  5352     12  PC-RECORD-STATUS.                                        ERCPNDC
  5353         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  5354         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  5355         16  FILLER                       PIC XX.                 ERCPNDC
  5356         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  5357             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  5358         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  5359             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  5360             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  5361                                                     '8'.         ERCPNDC
  5362         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  5363             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  5364             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  5365         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  5366             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  5367         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  5368         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  5369         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 105
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5370         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  5371             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  5372         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  5373         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  5374                                                                  ERCPNDC
  5375     12  PC-ERROR-FLAGS.                                          ERCPNDC
  5376         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  5377             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  5378         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  5379             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  5380                                                                  ERCPNDC
  5381     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  5382         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  5383                                                                  ERCPNDC
  5384     12  FILLER                           PIC X(25).              ERCPNDC
  5385                                                                  ERCPNDC
  5386******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 106
* ECS010.cbl
  5388 01  CC-STARTS-HERE              PIC X(48)
  5389       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  5390
* 5391                             COPY ERCCRTC.
  5392******************************************************************04/29/98
  5393*                                                                *ERCCRTC
  5394*                                                                *ERCCRTC
  5395*                            ERCCRTC                             *   LV003
  5396*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5397*                            VMOD=2.005                          *   CL**3
  5398*                                                                *ERCCRTC
  5399*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  5400*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  5401*                       ISSUES AND CANCELS)                      *ERCCRTC
  5402*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  5403*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  5404*                                                                *ERCCRTC
  5405*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  5406*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  5407*                                                                *ERCCRTC
  5408*   LOG = YES                                                    *ERCCRTC
  5409*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  5410******************************************************************ERCCRTC
  5411*                   C H A N G E   L O G
  5412*
  5413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5414*-----------------------------------------------------------------
  5415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5416* EFFECTIVE    NUMBER
  5417*-----------------------------------------------------------------
  5418* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5419******************************************************************
  5420 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5421     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5422         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5423                                                                  ERCCRTC
  5424     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5425         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5426         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5427         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5428         16  CC-STATE                     PIC XX.                 ERCCRTC
  5429         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5430         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5431         16  CC-CERT-NO.                                          ERCCRTC
  5432             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5433             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5434                                                                  ERCCRTC
  5435         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5436                                                                  ERCCRTC
  5437     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5438     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5439     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5440                                                                  ERCCRTC
  5441     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5442                                                                  ERCCRTC
  5443     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5444         16  FILLER                       PIC X(10).              ERCCRTC
  5445         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 107
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5446             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5447             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5448                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5449                 24  FILLER               PIC X(9).               ERCCRTC
  5450             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5451         16  CC-AGE                       PIC S99.                ERCCRTC
  5452         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5453         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5454         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5455             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5456             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5457         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5458             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5459             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5460                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5461                 24  FILLER               PIC X(9).               ERCCRTC
  5462             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5463         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5464         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5465         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5466         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5467         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5468         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5469         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5470         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5471         16  CC-OLD-LOF                   PIC XXX.
  5472*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5473         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5474         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5475         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5476         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5477         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5478         16  FILLER                       PIC X(3).               ERCCRTC
  5479         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5480         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5481         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5482         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5483         16  CC-LOAN-OFFICER              PIC X(5).
  5484         16  FILLER                       PIC XXX.                ERCCRTC
  5485     12  CC-RECORD-STATUS.                                        ERCCRTC
  5486         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5487         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5488     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5489         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5490         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5491         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5492         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5493     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5494     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5495         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5496             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5497         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5498             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5499     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5500         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5501         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5502         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5503         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 108
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5504                                                                  ERCCRTC
  5505     12  FILLER                           PIC X(05).              ERCCRTC
  5506******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 109
* ECS010.cbl
  5508 01  CR-STARTS-HERE              PIC X(48)
  5509       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5510
* 5511                             COPY ECSCRT01.
  5512******************************************************************
  5513*                                                                *
  5514*                            ECSCRT01                            *
  5515*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5516*                            VMOD=2.016                          *
  5517*                                                                *
  5518*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5519*                                                                *
  5520*   FILE TYPE = SEQUENTIAL
  5521*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5522*                                                                *
  5523*   KEY DATA =                         START=4, LEN=36           *
  5524*                                                                *
  5525*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5526*                                                                *
  5527******************************************************************
  5528******************************************************************
  5529*                   C H A N G E   L O G
  5530*
  5531* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5532*-----------------------------------------------------------------
  5533*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5534* EFFECTIVE    NUMBER
  5535*-----------------------------------------------------------------
  5536* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5537* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5538* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5539* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5540* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5541* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5542* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5543* 032612  CR2011110200001  PEMA  AHL CHANGES
  5544******************************************************************
  5545
  5546 01  CERTIFICATE-RECORD.
  5547     12  CR-RECORD-ID                      PIC XX.
  5548         88  VALID-CR-ID                      VALUE 'CR'.
  5549
  5550     12  CR-COMPANY-CD                     PIC X.
  5551
  5552     12  CR-FULL-CONTROL.
  5553         16  CR-CONTROL-1.
  5554             20  CR-ACCT-CONTROL.
  5555                 24  CR-CARRIER            PIC X.
  5556                 24  CR-GROUPING.
  5557                     28  CR-GROUP-PREFIX   PIC XXX.
  5558                     28  CR-GROUP-PRIME    PIC XXX.
  5559                 24  CR-STATE              PIC XX.
  5560                 24  CR-ACCOUNT.
  5561                     28  CR-ACCT-PREFIX    PIC X(4).
  5562                     28  CR-ACCT-PRIME     PIC X(6).
  5563             20  CR-DT                     PIC 9(11)  COMP-3.
  5564         16  CR-CERT-NO.
  5565             20  CR-CERT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 110
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5566                 24  CR-CERT-PREFIX        PIC X(3).
  5567                 24  CR-CERT-PRIME         PIC X(7).
  5568             20  CR-CERT-SFX               PIC X.
  5569
  5570     12  CR-INSUREDS-PROFILE.
  5571         16  CR-NAME.
  5572             20  CR-LNAME                  PIC X(15).
  5573             20  CR-FNAME.
  5574                 24  CR-1ST-INITIAL        PIC X.
  5575                 24  FILLER                PIC X(9).
  5576             20  CR-INIT                   PIC X.
  5577         16  CR-AGE                        PIC 99.
  5578         16  CR-SEX                        PIC X.
  5579             88  CR-SEX-MALE                  VALUE 'M'.
  5580             88  CR-SEX-FEMALE                VALUE 'F'.
  5581         16  CR-SOC-SEC                    PIC X(11).
  5582         16  CR-JOINT-NAME.
  5583             20  CR-JT-LNAME               PIC X(15).
  5584             20  CR-JT-FNAME.
  5585                 24  CR-JT-1ST-INIT        PIC X.
  5586                 24  FILLER                PIC X(9).
  5587             20  CR-JT-INIT                PIC X.
  5588         16  CR-JOINT-AGE                  PIC 99.
  5589
  5590         16  cr-ahl-ah-claim-no            pic x(9).
  5591         16  cr-ahl-ah-cert-seq            pic x(3).
  5592         16  cr-hst-proc-lf                pic x.
  5593         16  f                             pic x(7).
  5594
  5595     12  CR-LF-COVERAGE-DATA.
  5596         16  CR-LFTYP                      PIC XX.
  5597         16  CR-LF-TERM                    PIC S999       COMP-3.
  5598         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5599         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5600         16  CR-LF-DEV-CODE                PIC XXX.
  5601         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5602
  5603         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5604         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5605         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5606         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5607
  5608         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5609         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5610         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5611         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5612
  5613         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5614         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5615
  5616         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5617         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5618
  5619         16  CR-LF-REFUND-TYPE             PIC X.
  5620         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5621
  5622         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5623             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 111
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5624
  5625         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5626
  5627         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5628         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5629         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5630
  5631         16  cr-ahl-lf-claim-no            pic x(9).
  5632         16  cr-ahl-lf-cert-seq            pic x(3).
  5633         16  FILLER                        PIC XX.
  5634
  5635     12  CR-AH-COVERAGE-DATA.
  5636         16  CR-AHTYP                      PIC XX.
  5637         16  CR-AH-TERM                    PIC S999       COMP-3.
  5638         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5639         16  CR-AH-DEV-CODE                PIC XXX.
  5640         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5641
  5642         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5643         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5644         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5645         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5646
  5647         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5648         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5649
  5650         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5651         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5652
  5653         16  CR-AH-REFUND-TYPE             PIC X.
  5654         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5655
  5656         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5657             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5658
  5659         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5660
  5661         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5662         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5663         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5664
  5665         16  FILLER                        PIC XX.
  5666*        16  FILLER                        PIC X(8).
  5667
  5668     12  CR-LOAN-DATA.
  5669         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5670         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5671                                           PIC S9(5)V99   COMP-3.
  5672         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5673         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5674         16  CR-PMT-FREQ                   PIC 99.
  5675         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5676         16  CR-RATING-CLASS               PIC XX.
  5677         16  CR-POLICY-FORM-NO             PIC X(12).
  5678         16  CR-GRPTYP                     PIC XX.
  5679         16  CR-IND-GRP                    PIC X.
  5680             88  CR-INDIVIDUAL                VALUE '1'.
  5681             88  CR-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 112
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5682         16  CR-SKIP                       PIC 99.
  5683             88  NO-MONTHS-SKIPPED            VALUE 00.
  5684             88  SKIP-JULY                    VALUE 01.
  5685             88  SKIP-AUGUST                  VALUE 02.
  5686             88  SKIP-SEPTEMBER               VALUE 03.
  5687             88  SKIP-JULY-AUG                VALUE 04.
  5688             88  SKIP-AUG-SEPT                VALUE 05.
  5689             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5690             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5691             88  SKIP-JUNE                    VALUE 08.
  5692             88  SKIP-JUNE-JULY               VALUE 09.
  5693             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5694             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5695         16  CR-RESIDENT-STATE             PIC XX.
  5696         16  CR-RATE-CODE.
  5697             20  CR-LF-CLASS-CD            PIC XX.
  5698             20  CR-AH-CLASS-CD            PIC XX.
  5699         16  CR-MORT.
  5700             20  CR-TAB                    PIC X.
  5701             20  CR-INT                    PIC 99.
  5702             20  CR-GRP                    PIC X.
  5703         16  CR-MEMBER-NO                  PIC X(12).
  5704         16  CR-OLD-LOF                    PIC XXX.
  5705*        16  CR-LOAN-OFFICER               PIC XXX.
  5706         16  CR-REIN-TABLE                 PIC XXX.
  5707         16  CR-REIN-SPEC                  PIC X.
  5708         16  CR-LOAN-1ST-PMT-DT.
  5709             20  CR-1ST-PMT-YR             PIC 99.
  5710             20  CR-1ST-PMT-MO             PIC 99.
  5711             20  CR-1ST-PMT-DA             PIC 99.
  5712         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5713         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5714         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5715         16  CR-LAST-ADD-ON-DT             PIC XX.
  5716
  5717         16  CR-UNDERWRITING-CODE          PIC X.
  5718             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5719
  5720         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5721         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5722         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5723         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5724
  5725     12  CR-STATUS-INFORMATION.
  5726         16  CR-ENTRY-STATUS               PIC X.
  5727             88  CR-NORMAL-ENTRY              VALUE '1'.
  5728             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5729             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5730             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5731             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5732             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5733             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5734             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5735             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5736             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  5737                                                    '5' '9' 'P'.
  5738         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5739
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 113
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5740         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5741         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5742         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5743
  5744         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5745         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5746
  5747         16  CR-LF-CURRENT-STATUS          PIC X.
  5748             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5749             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5750             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5751             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5752             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5753             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5754             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5755             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5756             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5757             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5758             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5759             88  CR-LF-IS-VOID                VALUE 'V'.
  5760             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5761                                                    '4' '5' '9'.
  5762
  5763         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5764
  5765         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5766         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5767
  5768         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5769         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5770
  5771         16  CR-AH-CURRENT-STATUS          PIC X.
  5772             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5773             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5774             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5775             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5776             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5777             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5778             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5779             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5780             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5781             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5782             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5783             88  CR-AH-IS-VOID                VALUE 'V'.
  5784             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5785                                                    '4' '5' '9'.
  5786         16  CR-LOAN-OFFICER               PIC X(5).
  5787         16  CR-CANCEL-REASON              PIC X.
  5788         16  cr-xycor-lf-cov-code          pic x(4).
  5789         16  cr-xycor-ah-cov-code          pic x(4).
  5790         16  FILLER                        PIC X(6).
  5791
  5792     12  CR-DEATH-CLAIM-DATA.
  5793         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  5794
  5795         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5796         16  CR-DTH-RPT-DT.
  5797             20  CR-DTH-RPT-YR             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 114
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5798             20  CR-DTH-RPT-MO             PIC 99.
  5799             20  CR-DTH-RPT-DA             PIC 99.
  5800         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5801
  5802         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5803         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5804         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5805         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5806         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5807
  5808         16  CR-DTH-AGE                    PIC 99.
  5809         16  CR-DTH-PAY-CD                 PIC X.
  5810         16  CR-DEATH-CAUSE                PIC X(6).
  5811
  5812         16  FILLER                        PIC X(16).
  5813
  5814     12  CR-DISAB-CLAIM-DATA.
  5815         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5816
  5817         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5818         16  CR-DIS-RPT-DT.
  5819             20  CR-DIS-RPT-YR             PIC 99.
  5820             20  CR-DIS-RPT-MO             PIC 99.
  5821             20  CR-DIS-RPT-DA             PIC 99.
  5822         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5823         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5824
  5825         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5826         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5827         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5828         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5829         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5830
  5831         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5832         16  CR-DIS-PAY-CD                 PIC X.
  5833         16  FILLER                        PIC XX.
  5834
  5835         16  CR-DISAB-INCURRED-DETAIL.
  5836             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5837**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5838                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5839                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5840                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5841
  5842         16  CR-DISAB-CAUSE                PIC X(6).
  5843         16  FILLER                        PIC X(14).
  5844
  5845     12  CR-REMIT-TO                       PIC 99.
  5846
  5847     12  CR-COMPENSATION-LEVELS.
  5848         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5849             20  CR-COM-AGT.
  5850                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5851                 24  CR-COM-AGT-PRIME      PIC X(6).
  5852             20  CR-AGT-TYPE               PIC X.
  5853             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5854             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5855
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 115
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5856     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5857     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5858     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5859     12  CR-CLP-STATE                      PIC XX.
  5860     12  CR-POST-CARD-IND                  PIC X.
  5861     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5862     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5863     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5864     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5865     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5866     12  FILLER                            PIC X(07).
  5867
  5868     12  CR-CSR-CODE                       PIC XXX.
  5869
  5870     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5871     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5872
  5873     12  CR-MICROFILM-NUMBERS.
  5874*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5875         16  FILLER                        PIC X(5).
  5876     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5877
  5878     12  CR-USER-CODE                      PIC X.
  5879     12  CR-USER-FUTURE                    PIC X(9).
  5880
  5881     12  CR-BENEFICIARY.
  5882         16  CR-BANK-NO                    PIC X(10).
  5883         16  FILLER                        PIC X(15).
  5884
  5885     12  CR-ENTRY-BATCH                    PIC X(6).
  5886     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5887     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5888
  5889     12  CR-NOTE-SW                        PIC X.
  5890
  5891     12  CR-ORIGIN-INDICATOR               PIC X.
  5892         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5893         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5894
  5895     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5896     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5897     12  FILLER                            PIC X(33).
  5898
  5899******************************************************************
* 5900                             COPY ELCCRTVR.
  5901***************************************************************** 04/24/98
  5902*                                                                *ELCCRTVR
  5903*                                                                *ELCCRTVR
  5904*                            ELCCRTVR                            *   LV003
  5905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5906*                            VMOD=2.001                          *ELCCRTVR
  5907*                                                                *ELCCRTVR
  5908*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5909*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  5910*                                                                *ELCCRTVR
  5911******************************************************************ELCCRTVR
  5912                                                                  ELCCRTVR
  5913 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 116
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5914     05  WS-CR-DT.                                                ELCCRTVR
  5915         10  FILLER                PIC 999.                       ELCCRTVR
  5916         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5917         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5918             15  CR-CC             PIC 99.                        ELCCRTVR
  5919             15  CR-YR             PIC 99.                        ELCCRTVR
  5920         10  CR-MO                 PIC 99.                        ELCCRTVR
  5921         10  CR-DA                 PIC 99.                        ELCCRTVR
  5922     05  WS-CR-DT-N REDEFINES                                        CL**2
  5923            WS-CR-DT               PIC 9(11).                        CL**2
  5924     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5925         10  FILLER                    PIC 999.                   ELCCRTVR
  5926         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5927         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5928             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5929             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5930         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5931         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5932     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5933            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5934     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5935         10  FILLER                    PIC 999.                   ELCCRTVR
  5936         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5937         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5938             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5939             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5940         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5941         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5942     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5943            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5944     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5945         10  FILLER                    PIC 999.                   ELCCRTVR
  5946         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5947         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5948             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5949             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5950         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5951         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5952     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5953            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5954     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5955         10  FILLER                    PIC 999.                   ELCCRTVR
  5956         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5957         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5958             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5959             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5960         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5961         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5962     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5963            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5964     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5965         10  FILLER                    PIC 999.                   ELCCRTVR
  5966         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5967         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  5968             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5969             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5970         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5971         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 117
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5972     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5973            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5974     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5975         10  FILLER                    PIC 999.                   ELCCRTVR
  5976         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5977         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5978             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  5979             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  5980         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  5981         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  5982     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  5983            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  5984     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  5985         10  FILLER                    PIC 999.                   ELCCRTVR
  5986         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5987         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  5988             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  5989             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  5990         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  5991         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  5992     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  5993            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  5994     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  5995         10  FILLER                    PIC 999.                   ELCCRTVR
  5996         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5997         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  5998             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  5999             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  6000         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  6001         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  6002     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  6003            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  6004     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  6005         10  FILLER                    PIC 999.                   ELCCRTVR
  6006         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  6007         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  6008             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  6009             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  6010         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  6011         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  6012     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  6013          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  6014     05  WS-CR-DTH-DT.                                            ELCCRTVR
  6015         10  FILLER                    PIC 999.                   ELCCRTVR
  6016         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  6017         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  6018             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  6019             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  6020         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  6021         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  6022     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  6023            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  6024     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  6025         10  FILLER                    PIC 999.                   ELCCRTVR
  6026         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6027         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  6028             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  6029             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 118
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  6030         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  6031         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  6032     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  6033            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  6034     05  WS-CR-DIS-DT.                                            ELCCRTVR
  6035         10  FILLER                    PIC 999.                   ELCCRTVR
  6036         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  6037         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  6038             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  6039             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  6040         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  6041         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  6042     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  6043            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  6044     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  6045         10  FILLER                    PIC 999.                   ELCCRTVR
  6046         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6047         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  6048             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  6049             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  6050         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  6051         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  6052     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  6053            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  6054     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  6055         10  FILLER                    PIC 999.                   ELCCRTVR
  6056         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  6057         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  6058             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  6059             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  6060         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  6061         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  6062     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  6063            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  6064     05  COPY-NDX                      PIC 9.                        CL**6
  6065     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  6066         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  6067             15  FILLER                PIC 999.                   ELCCRTVR
  6068             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  6069             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  6070                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  6071                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  6072             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  6073             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  6074         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  6075                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  6076
  6077 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 119
* ECS010.cbl
* 6079                             COPY ELCDATE.
  6080******************************************************************06/11/98
  6081*                                                                *ELCDATE
  6082*                                                                *ELCDATE
  6083*                            ELCDATE.                            *   LV023
  6084*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  6085*                            VMOD=2.003                           ELCDATE
  6086*                                                                *ELCDATE
  6087*                                                                *ELCDATE
  6088*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  6089*                 LENGTH = 200                                   *   CL*19
  6090******************************************************************ELCDATE
  6091                                                                  ELCDATE
  6092 01  DATE-CONVERSION-DATA.                                        ELCDATE
  6093     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  6094     12  DC-OPTION-CODE                PIC X.                        CL*15
  6095         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  6096         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  6097         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  6098         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  6099         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  6100         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  6101         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  6102         88  FIND-CENTURY               VALUE '7'.                   CL*22
  6103         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  6104         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  6105         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  6106         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  6107         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  6108         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  6109         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  6110         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  6111         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  6112         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  6113         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  6114         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  6115         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  6116         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  6117         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  6118         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  6119         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  6120         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  6121         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  6122         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  6123         88  THREE-CHARACTER-BIN                                  ELCDATE
  6124                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  6125         88  GREGORIAN-TO-BIN                                        CL**2
  6126                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  6127         88  BIN-TO-GREGORIAN                                        CL**2
  6128                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  6129         88  JULIAN-TO-BINARY                                        CL**2
  6130                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  6131     12  DC-ERROR-CODE                 PIC X.                        CL*15
  6132         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  6133         88  DATE-CONVERSION-ERROR                                ELCDATE
  6134                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  6135         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  6136         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 120
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6137         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  6138         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  6139         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  6140         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  6141         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  6142         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  6143         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  6144         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  6145     12  DC-END-OF-MONTH               PIC X.                        CL*15
  6146         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  6147     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  6148         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  6149         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  6150         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  6151     12  FILLER                        PIC X.                        CL*15
  6152     12  DC-CONVERSION-DATES.                                        CL*15
  6153         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  6154         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  6155         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  6156         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  6157                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  6158             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  6159             20  SLASH1-1              PIC X.                        CL*15
  6160             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  6161             20  SLASH1-2              PIC X.                        CL*15
  6162             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  6163         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  6164         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  6165                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  6166             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  6167             20  SLASH2-1              PIC X.                        CL*15
  6168             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  6169             20  SLASH2-2              PIC X.                        CL*15
  6170             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  6171         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  6172         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  6173                     DC-GREG-DATE-1-YMD.                          ELCDATE
  6174             20  DC-YMD-YEAR           PIC 99.                       CL*15
  6175             20  DC-YMD-MONTH          PIC 99.                       CL*15
  6176             20  DC-YMD-DAY            PIC 99.                       CL*15
  6177         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  6178         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  6179                      DC-GREG-DATE-1-MDY.                         ELCDATE
  6180             20  DC-MDY-MONTH          PIC 99.                       CL*15
  6181             20  DC-MDY-DAY            PIC 99.                       CL*15
  6182             20  DC-MDY-YEAR           PIC 99.                       CL*15
  6183         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  6184             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  6185             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  6186             20  FILLER                PIC XX.                       CL*15
  6187             20  DC-ALPHA-CENTURY.                                   CL*15
  6188                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  6189             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  6190         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  6191         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  6192         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  6193         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  6194         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 121
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6195                                       PIC 9(05).                    CL*20
  6196         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  6197             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  6198             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  6199         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  6200         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  6201         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  6202     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  6203         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  6204         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  6205             20  FILLER                PIC 9(3).                     CL*15
  6206             20  HOLD-CEN-1-CCYY.                                    CL*15
  6207                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  6208                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  6209             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  6210             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  6211         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  6212             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  6213             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  6214             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  6215                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  6216                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  6217             20  FILLER                PIC 9(3).                     CL*15
  6218         16  HOLD-CENTURY-1-X.                                       CL*15
  6219             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  6220             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  6221                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  6222                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  6223             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  6224             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  6225         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  6226             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  6227             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  6228             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  6229                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  6230                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  6231             20  FILLER                PIC XXX.                      CL*23
  6232         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  6233         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  6234         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  6235         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  6236             20  DC-JULIAN-1-CCYY.                                   CL*15
  6237                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  6238                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  6239             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  6240         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  6241         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  6242             20  DC-JULIAN-2-CCYY.                                   CL*15
  6243                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  6244                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  6245             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  6246         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  6247             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  6248             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  6249             20  DC-EDITA-DAY          PIC 99.                       CL*15
  6250             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  6251             20  DC-EDITA-CCYY.                                      CL*15
  6252                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 122
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6253                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  6254         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  6255             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  6256             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  6257             20  DC-EDITB-DAY          PIC 99.                       CL*15
  6258             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  6259             20  DC-EDITB-CCYY.                                      CL*15
  6260                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  6261                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  6262         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  6263         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  6264                              DC-GREG-DATE-CYMD.                  ELCDATE
  6265             20  DC-CYMD-CEN           PIC 99.                       CL*15
  6266             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  6267             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  6268             20  DC-CYMD-DAY           PIC 99.                       CL*15
  6269         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  6270         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  6271                              DC-GREG-DATE-MDCY.                  ELCDATE
  6272             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  6273             20  DC-MDCY-DAY           PIC 99.                       CL*15
  6274             20  DC-MDCY-CEN           PIC 99.                       CL*15
  6275             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  6276    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  6277        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  6278    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  6279    12  FILLER                         PIC X(28).                    CL*26
* 6280                             COPY ELCFUNDT.
  6281***************************************************************** 12/03/98
  6282*                                                               * ELCFUNDT
  6283*                            ELCFUNDT.                          *    LV004
  6284*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  6285*                            VMOD=2.001                         * ELCFUNDT
  6286*                                                               * ELCFUNDT
  6287*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  6288*                                                               * ELCFUNDT
  6289***************************************************************** ELCFUNDT
  6290                                                                  ELCFUNDT
  6291                                                                  ELCFUNDT
  6292 01  FUNCTION-DATE.                                                  CL**2
  6293     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  6294     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  6295         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  6296         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  6297             15  WS-FN-CC          PIC 99.                           CL**3
  6298             15  WS-FN-YR          PIC 99.                           CL**3
  6299         10  WS-FN-MO              PIC 99.                           CL**3
  6300         10  WS-FN-DA              PIC 99.                           CL**3
  6301     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  6302     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  6303     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  6304     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  6305     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  6306         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  6307         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  6308         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  6309     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  6310     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 123
* ECS010.cbl
  6311
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 124
* ECS010.cbl
  6313 01  CPA-STARTS-HERE             PIC X(48)
  6314       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 6315                             COPY ELCCALC.
  6316******************************************************************04/15/98
  6317*                                                                *ELCCALC
  6318*                           ELCCALC.                            *    LV003
  6319*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6320*                            VMOD=2.025                          *   CL**3
  6321*                                                                *   CL**2
  6322*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  6323*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  6324*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  6325*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  6326*                                                                *   CL**2
  6327*  PASSED TO ELRTRM                                              *   CL**2
  6328*  -----------------                                             *   CL**2
  6329*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  6330*  ORIGINAL TERM                                                 *   CL**2
  6331*  BEGINNING DATE                                                *   CL**2
  6332*  ENDING DATE                                                   *   CL**2
  6333*  COMPANY I.D.                                                  *   CL**2
  6334*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  6335*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  6336*  FREE LOOK DAYS                                                *   CL**2
  6337*                                                                *   CL**2
  6338*  RETURNED FROM ELRTRM                                          *   CL**2
  6339*  ---------------------                                         *   CL**2
  6340*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  6341*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  6342*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  6343*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  6344*----------------------------------------------------------------*   CL**2
  6345*  PASSED TO ELRAMT                                              *   CL**2
  6346*  ----------------                                              *   CL**2
  6347*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  6348*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6349*  ORIGINAL AMOUNT                                               *   CL**2
  6350*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  6351*  A.P.R. - NET PAY ONLY                                         *   CL**2
  6352*  METHOD                                                            CL**2
  6353*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  6354*  COMPANY I.D.                                                  *   CL**2
  6355*  BENEFIT TYPE                                                  *   CL**2
  6356*                                                                *   CL**2
  6357*  RETURNED FROM ELRAMT                                          *   CL**2
  6358*  --------------------                                          *   CL**2
  6359*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  6360*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  6361*  REMAINING AMOUNT FACTOR                                           CL**2
  6362*----------------------------------------------------------------*   CL**2
  6363*  PASSED TO ELRESV                                              *   CL**2
  6364*  -----------------                                             *   CL**2
  6365*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  6366*  VALUATION DATE                                                *   CL**2
  6367*  PAID THRU DATE                                                *   CL**2
  6368*  BENEFIT                                                       *   CL**2
  6369*  INCURRED DATE                                                 *   CL**2
  6370*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 125
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6371*  ISSUE AGE                                                     *   CL**2
  6372*  TERM                                                          *   CL**2
  6373*  CDT PERCENT                                                   *   CL**2
  6374*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  6375* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  6376* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  6377* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  6378*                                                                *   CL**2
  6379*  RETURNED FROM ELRESV                                          *   CL**2
  6380*  --------------------                                          *   CL**2
  6381*  CDT TABLE USED                                                *   CL**2
  6382*  CDT FACTOR USED                                               *   CL**2
  6383*  PAY TO CURRENT RESERVE                                        *   CL**2
  6384*  I.B.N.R. - A/H ONLY                                           *   CL**2
  6385*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  6386*----------------------------------------------------------------*   CL**2
  6387*  PASSED TO ELRATE                                              *   CL**2
  6388*  ----------------                                              *   CL**2
  6389*  CERT ISSUE DATE                                               *   CL**2
  6390*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6391*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6392*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  6393*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6394*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6395*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6396*  DEVIATION CODE                                                *   CL**2
  6397*  ISSUE AGE                                                     *   CL**2
  6398*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6399*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6400*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  6401*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6402*  A.P.R.                                                        *   CL**2
  6403*  METHOD                                                            CL**2
  6404*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6405*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6406*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6407*  BENEFIT CODE                                                  *   CL**2
  6408*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6409*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6410*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6411*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6412*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6413*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6414*                                                                *   CL**2
  6415*  RETURNED FROM ELRATE                                          *   CL**2
  6416*  --------------------                                          *   CL**2
  6417*  CALCULATED PREMIUM                                            *   CL**2
  6418*  PREMIUM RATE                                                  *   CL**2
  6419*  MORTALITY CODE                                                *   CL**2
  6420*  MAX ATTAINED AGE                                              *   CL**2
  6421*  MAX AGE                                                       *   CL**2
  6422*  MAX TERM                                                      *   CL**2
  6423*  MAX MONTHLY BENEFIT                                           *   CL**2
  6424*  MAX TOTAL BENIFIT                                             *   CL**2
  6425*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6426*----------------------------------------------------------------*   CL**2
  6427*  PASSED TO ELRFND                                              *   CL**2
  6428*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 126
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6429*  CERT ISSUE DATE                                               *   CL**2
  6430*  REFUND DATE                                                   *   CL**2
  6431*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6432*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6433*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6434*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6435*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6436*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6437*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6438*  DEVIATION CODE                                                *   CL**2
  6439*  ISSUE AGE                                                     *   CL**2
  6440*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6441*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6442*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6443*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6444*  A.P.R.                                                        *   CL**2
  6445*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6446*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6447*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6448*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6449*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6450*  BENEFIT CODE                                                  *   CL**2
  6451*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6452*                                                                *   CL**2
  6453*  RETURNED FROM ELRFND                                          *   CL**2
  6454*  --------------------                                          *   CL**2
  6455*  CALCULATED REFUND                                             *   CL**2
  6456*----------------------------------------------------------------*   CL**2
  6457*  PASSED TO ELEARN                                              *   CL**2
  6458*  ----------------                                              *   CL**2
  6459*  CERT ISSUE DATE                                               *   CL**2
  6460*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6461*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6462*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6463*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6464*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6465*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6466*  DEVIATION CODE                                                *   CL**2
  6467*  ISSUE AGE                                                     *   CL**2
  6468*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6469*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6470*  A.P.R.                                                        *   CL**2
  6471*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6472*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6473*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6474*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6475*  BENEFIT CODE                                                  *   CL**2
  6476*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6477*                                                                *   CL**2
  6478*  RETURNED FROM ELEARN                                          *   CL**2
  6479*  --------------------                                          *   CL**2
  6480*  INDICATED  EARNINGS                                           *   CL**2
  6481*----------------------------------------------------------------*   CL**2
  6482*                 LENGTH = 450                                   *   CL**2
  6483*                                                                *   CL**2
  6484******************************************************************   CL**2
  6485******************************************************************
  6486*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 127
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6487*
  6488* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6489*-----------------------------------------------------------------
  6490*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6491* EFFECTIVE    NUMBER
  6492*-----------------------------------------------------------------
  6493* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6494* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6495* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6496* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6497* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6498* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6499* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6500* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6501* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6502******************************************************************
  6503                                                                     CL**2
  6504 01  CALCULATION-PASS-AREA.                                          CL**2
  6505     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6506                                     COMP.                           CL**2
  6507                                                                     CL**2
  6508     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6509       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6510       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6511                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6512       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6513       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6514       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6515       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6516       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6517       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6518       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6519       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6520       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6521       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6522       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6523       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6524       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6525       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6526       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6527       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6528       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6529                                                                     CL**2
  6530     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6531       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6532***********************  INPUT AREAS ****************************    CL**2
  6533                                                                     CL**2
  6534     12  CP-CALCULATION-AREA.                                        CL**2
  6535         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6536         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6537         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6538         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6539         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6540           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6541                                                   'I' 'U'.          CL**2
  6542           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6543           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  6544         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 128
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6545         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6546         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6547         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6548         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6549                                     COMP-3.                         CL**2
  6550         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6551                                     COMP-3.                         CL**2
  6552         16  CP-CDT-METHOD         PIC X.                            CL**2
  6553           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6554           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6555           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6556         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6557           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6558           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6559         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6560                                     COMP-3.                         CL**2
  6561         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6562                                     COMP-3.                         CL**2
  6563         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6564                                     COMP-3.                         CL**2
  6565         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6566                                     COMP-3.                         CL**2
  6567         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6568                                     COMP-3.                         CL**2
  6569         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6570                                     COMP-3.                         CL**2
  6571         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6572                                     COMP-3.                         CL**2
  6573         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6574           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6575           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6576           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6577           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6578           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6579           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6580           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6581         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6582           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6583           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6584           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6585           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6586           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6587           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6588           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6589           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6590           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6591           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6592           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6593           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6594           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6595           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6596         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6597           88  CP-CLAIM                            VALUE '1'.        CL**2
  6598           88  CP-CANCEL                           VALUE '2'.        CL**2
  6599           88  CP-ISSUE                            VALUE '3'.        CL**2
  6600         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6601           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  6602           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 129
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6603           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6604           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6605           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6606           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6607           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6608           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6609           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6610           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6611           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6612           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6613           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6614           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6615           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6616           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6617           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6618           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6619                                                     'W' 'X'.        CL**2
  6620           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6621           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6622           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6623           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6624           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6625           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6626           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6627           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6628           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6629           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6630           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6631           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6632           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6633                                                                     CL**2
  6634         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6635                                     COMP-3.                         CL**2
  6636         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6637         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6638         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6639         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6640         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6641           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6642               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6643         16  CP-R78-OPTION         PIC X.                            CL**2
  6644           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6645           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6646                                                                     CL**2
  6647         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6648         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6649         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6650         16  CP-RATE-FILE          PIC X.                            CL**2
  6651         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6652                                     COMP-3.                         CL**2
  6653                                                                     CL**2
  6654         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6655         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6656                                                                     CL**2
  6657         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6658                                     COMP-3.
  6659         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  6660                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 130
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6661         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6662                                     COMP-3.                         CL**2
  6663         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6664                                     COMP-3.                         CL**2
  6665         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6666                                     COMP-3.
  6667         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6668                                  PIC S9(7)V99 COMP-3.
  6669                                                                     CL**2
  6670         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6671         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6672         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6673           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6674           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6675           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6676           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6677         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6678         16  CP-CARRIER            PIC X.                            CL**2
  6679         16  CP-REIN-FLAG          PIC X.                            CL**2
  6680         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6681           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6682                      '2' '3' '4' '5'.                               CL**2
  6683           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6684           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6685           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6686           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6687           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6688           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6689           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6690           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6691         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6692         16  CP-RATING-METHOD      PIC X.                            CL**2
  6693           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6694           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6695           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6696           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6697           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6698           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6699           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6700           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6701           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6702         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6703                                     COMP-3.                         CL**2
  6704         16  CP-BEN-CATEGORY       PIC X.
  6705         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6706         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6707                                   PIC S99V9(5) COMP-3.
  6708         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6709         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6710                                   PIC S99V9(5) COMP-3.
  6711         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6712         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6713         16  CP-EXPIRE-DT          PIC XX.
  6714         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6715         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6716         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6717         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  6718         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 131
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6719             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6720             88  CP-CALC-CLP              VALUE 'C'.
  6721         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6722         16  CP-CANCEL-REASON      PIC X.
  6723         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6724         16  CP-PMT-MODE           PIC X.
  6725         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6726         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6727         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6728         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6729         16  FILLER                PIC X.
  6730                                                                     CL**2
  6731***************    OUTPUT FROM ELRESV   ************************     CL**2
  6732                                                                     CL**2
  6733         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6734                                                                     CL**2
  6735         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6736                                     COMP-3.                         CL**2
  6737         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6738                                     COMP-3.                         CL**2
  6739         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6740                                     COMP-3.                         CL**2
  6741         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6742                                     COMP-3.                         CL**2
  6743         16  FILLER                PIC X(09).                        CL**2
  6744***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6745                                                                     CL**2
  6746         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6747                                     COMP-3.                         CL**2
  6748         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6749                                     COMP-3.                         CL**2
  6750         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6751                                     COMP-3.                         CL**2
  6752         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6753                                     COMP-3.                         CL**2
  6754         16  FILLER                PIC X(12).                        CL**2
  6755                                                                     CL**2
  6756***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6757                                                                     CL**2
  6758         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6759                                     COMP-3.                         CL**2
  6760         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6761                                     COMP-3.                         CL**2
  6762         16  FILLER                PIC X(12).                        CL**2
  6763                                                                     CL**2
  6764***************    OUTPUT FROM ELRATE   *************************    CL**2
  6765                                                                     CL**2
  6766         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6767                                     COMP-3.                         CL**2
  6768         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6769                                     COMP-3.                         CL**2
  6770         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6771         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6772             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6773         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6774                                     COMP-3.                         CL**2
  6775         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  6776         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 132
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6777         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6778                                   PIC S9(7)V99 COMP-3.
  6779         16  FILLER                PIC X(07).                        CL**2
  6780                                                                     CL**2
  6781***************    OUTPUT FROM ELRFND   *************************    CL**2
  6782                                                                     CL**2
  6783         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6784                                     COMP-3.                         CL**2
  6785         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6786           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6787           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6788           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6789           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6790           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6791           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6792           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6793           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6794           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6795           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6796           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6797           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6798           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6799           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6800         16  FILLER                PIC X(12).                        CL**2
  6801                                                                     CL**2
  6802***************    OUTPUT FROM ELEARN   *************************    CL**2
  6803                                                                     CL**2
  6804         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6805                                     COMP-3.                         CL**2
  6806         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6807                                     COMP-3.                         CL**2
  6808         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6809                                     COMP-3.                         CL**2
  6810         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6811                                     COMP-3.                         CL**2
  6812         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6813                                     COMP-3.                         CL**2
  6814         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6815                                     COMP-3.                         CL**2
  6816         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6817           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6818           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6819           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6820           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6821           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6822           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6823           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6824           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6825           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6826         16  FILLER                PIC X(12).                        CL**2
  6827                                                                     CL**2
  6828***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6829                                                                     CL**2
  6830         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6831                                     COMP-3.                         CL**2
  6832         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6833                                     COMP-3.                         CL**2
  6834         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 133
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6835                                                                     CL**2
  6836***************   MISC WORK AREAS    *****************************   CL**2
  6837         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6838                                     COMP-3.                         CL**2
  6839         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6840                                     COMP-3.                         CL**2
  6841         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6842                                     COMP-3.                         CL**2
  6843         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6844                                     COMP-3.                         CL**2
  6845         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6846                                     COMP-3.                         CL**2
  6847         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6848                                     COMP-3.                         CL**2
  6849         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6850             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6851             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6852             88  IO-ERROR                         VALUE 'E'.         CL**2
  6853                                                                     CL**2
  6854         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6855                                                                     CL**2
  6856         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6857                                                                     CL**2
  6858         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6859                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6860                                     COMP-3.                         CL**2
  6861                                                                     CL**2
  6862         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6863                                                                     CL**2
  6864         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6865                                     COMP-3.                         CL**2
  6866                                                                     CL**2
  6867         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6868                                     COMP-3.                         CL**2
  6869                                                                     CL**2
  6870         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6871                                     COMP-3.                         CL**2
  6872                                                                     CL**2
  6873         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6874                                     COMP-3.                         CL**2
  6875                                                                     CL**2
  6876         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6877                                     COMP-3.                         CL**2
  6878                                                                     CL**2
  6879         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6880                                     COMP-3.                         CL**2
  6881                                                                     CL**2
  6882         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6883                                     COMP-3.                         CL**2
  6884                                                                     CL**2
  6885         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6886             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6887                                                                     CL**2
  6888         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6889                                     COMP-3.                         CL**2
  6890         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6891                                     COMP-3.
  6892         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 134
* ECS010.cbl
  6893         16  FILLER                PIC X(15).                        CL**2
  6894******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 135
* ECS010.cbl
* 6896                             COPY ELCDTECX.
  6897******************************************************************06/05/98
  6898*                                                                *ELCDTECX
  6899*                            ELCDTECX.                           *   LV005
  6900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6901*                            VMOD=2.015                          *ELCDTECX
  6902*                                                                *ELCDTECX
  6903*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6904*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6905*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6906*                                                                *ELCDTECX
  6907******************************************************************ELCDTECX
  6908******************************************************************
  6909*                   C H A N G E   L O G
  6910*
  6911* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6912*-----------------------------------------------------------------
  6913*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6914* EFFECTIVE    NUMBER
  6915*-----------------------------------------------------------------
  6916* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6917*                                  BENEFIT CODES FROM 300 TO 900
  6918* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6919* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6920******************************************************************
  6921 01  DATE-CARD.                                                   ELCDTECX
  6922     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6923     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6924     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6925     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6926     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6927     12  EP-SW                       PIC  X.                      ELCDTECX
  6928         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6929     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6930         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6931     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6932     12  RUN-CENTURY.                                             ELCDTECX
  6933         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6934     12  FILLER                      PIC  X.                         CL**4
  6935     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6936     12  FILLER                      PIC  XXX.                    ELCDTECX
  6937     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6938                                                                  ELCDTECX
  6939 01  FILLER                          PIC  X(7)                       CL**6
  6940                                          VALUE 'OPTIONS'.        ELCDTECX
  6941 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6942     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6943     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6944     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6945         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6946         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6947     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6948     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6949     12  FILLER                      PIC  X.                      ELCDTECX
  6950     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6951     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6952     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  6953     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 136
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6954     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6955     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6956     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6957     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6958     12  FILLER                      PIC  X.                      ELCDTECX
  6959     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6960     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6961     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6962     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6963     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6964     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6965     12  FILLER                      PIC  X.                      ELCDTECX
  6966     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6967     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6968     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6969     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6970     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6971     12  DTE-R78                     PIC  X.                      ELCDTECX
  6972     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6973     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6974     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6975     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6976     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6977     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6978     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  6979                                     PIC  X.                      ELCDTECX
  6980         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  6981                                                 ' '.             ELCDTECX
  6982         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  6983         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  6984     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  6985         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  6986         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  6987     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  6988     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  6989                                     PIC  9.                         CL**4
  6990     12  DTE-SYSTEM.                                              ELCDTECX
  6991         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  6992         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  6993         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  6994         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  6995         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  6996         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  6997         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  6998         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  6999         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  7000         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  7001         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  7002         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  7003         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  7004         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  7005         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  7006         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  7007         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  7008         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  7009         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  7010         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  7011         16  DTE-SYS-U               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 137
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7012         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  7013         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  7014         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  7015         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  7016         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  7017     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  7018         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  7019                                     PIC  X.                      ELCDTECX
  7020     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  7021                                                                  ELCDTECX
  7022 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  7023     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  7024     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  7025     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  7026*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  7027     12  FILLER                      PIC  X.                      ELCDTECX
  7028     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  7029     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  7030     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  7031     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  7032     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  7033     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  7034     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  7035                                                                  ELCDTECX
  7036     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  7037     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  7038     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  7039     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  7040                                                                  ELCDTECX
  7041     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  7042     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  7043     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  7044     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  7045                                                                  ELCDTECX
  7046     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  7047     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  7048                                                                  ELCDTECX
  7049     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  7050     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  7051                                                                  ELCDTECX
  7052     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  7053                                                                  ELCDTECX
  7054 01  DATE-CARD-FACTORS.                                           ELCDTECX
  7055     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  7056     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  7057     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  7058     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  7059     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  7060     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  7061     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  7062                                                                  ELCDTECX
  7063 01  FILLER                          PIC  X(12)                   ELCDTECX
  7064                                          VALUE 'COMPANY NAME'.   ELCDTECX
  7065 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  7066     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  7067         16  CNT-ID                  PIC  X.                      ELCDTECX
  7068         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  7069                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 138
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7070 01  FILLER                          PIC  X(11)                   ELCDTECX
  7071                                          VALUE 'STATE NAMES'.    ELCDTECX
  7072 01  STATE-NAMES.                                                 ELCDTECX
  7073     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  7074         16  STATE-SUB               PIC  XX.                     ELCDTECX
  7075         16  STATE-PIC1.                                          ELCDTECX
  7076             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  7077             20  FILLER              PIC  XXX.                    ELCDTECX
  7078             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  7079             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  7080             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  7081             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  7082                                                                  ELCDTECX
  7083 01  FILLER                          PIC  X(13)                   ELCDTECX
  7084                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  7085 01  CARRIER-NAMES.                                               ELCDTECX
  7086     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  7087         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  7088         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  7089         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  7090         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7091         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7092         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7093*        16  FILLER                  PIC  X.                      ELCDTECX
  7094         16  CARRIER-SEC-PAY         PIC  X.
  7095             88  SEC-PAY-CARRIER          VALUE 'Y'.
  7096                                                                  ELCDTECX
  7097 01  FILLER                          PIC  X(9)                       CL**6
  7098                                          VALUE 'INS TYPES'.      ELCDTECX
  7099 01  CLAS-INS-TYPES.                                              ELCDTECX
  7100*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  7101     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  7102         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  7103         16  CLAS-I-AB3.                                          ELCDTECX
  7104             20  FILLER              PIC  X.                      ELCDTECX
  7105             20  CLAS-I-AB2.                                      ELCDTECX
  7106                 24  FILLER          PIC  X.                      ELCDTECX
  7107                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  7108         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  7109             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  7110             20  FILLER              PIC  X.                         CL**4
  7111         16  CLAS-I-AB10.                                         ELCDTECX
  7112             20  FILLER              PIC  X(9).                   ELCDTECX
  7113             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  7114         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  7115         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  7116         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  7117         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  7118             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  7119         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  7120         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  7121         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  7122         16  CLAS-I-BEN-CATEGORY     PIC  X.
  7123         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  7124         16  FILLER                  PIC  X(05).
  7125                                                                  ELCDTECX
  7126 01  FILLER                          PIC  X(16)                   ELCDTECX
  7127                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 139
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7128 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  7129     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  7130                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  7131         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  7132         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  7133         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  7134         16  CLAS-MORT-DESC.                                      ELCDTECX
  7135             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  7136             20  FILLER              PIC  XX.                        CL**5
  7137             20  CLAS-YEAR           PIC  X(4).                      CL**6
  7138             20  FILLER              PIC  X.                         CL**5
  7139             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  7140             20  FILLER              PIC  X.                         CL**5
  7141             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  7142             20  FILLER              PIC  X.                         CL**5
  7143             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  7144             20  FILLER              PIC  X(5).                      CL**6
  7145                                                                  ELCDTECX
  7146 01  FILLER                          PIC  X(15)                   ELCDTECX
  7147                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  7148 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  7149     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  7150         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  7151         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  7152         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  7153         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  7154         16  FILLER                  PIC  X(4).                      CL**6
  7155                                                                  ELCDTECX
  7156 01  FILLER                          PIC  X(7)                       CL**6
  7157                                     VALUE 'INDEXES'.             ELCDTECX
  7158 01  CLAS-INDEX-TBL.                                              ELCDTECX
  7159     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  7160     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  7161     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  7162     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  7163     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  7164     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  7165     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  7166     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  7167     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  7168     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  7169     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  7170     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  7171     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  7172     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  7173     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  7174     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  7175     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  7176                                                                  ELCDTECX
  7177 01  CLAS-TYPE-MISC.                                              ELCDTECX
  7178     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  7179     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  7180     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  7181     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  7182     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  7183     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  7184     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  7185     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 140
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7186     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  7187     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  7188     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  7189                                                                  ELCDTECX
  7190 01  FILLER                          PIC  X(13)                   ELCDTECX
  7191                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  7192 01  CLAS-MISC.                                                   ELCDTECX
  7193     12  DTE-FICH                    PIC  X.                      ELCDTECX
  7194         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  7195         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  7196         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  7197     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  7198     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  7199     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  7200     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  7201     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  7202     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  7203     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  7204     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  7205     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  7206     12  STATE-L                     PIC  XX.                     ELCDTECX
  7207     12  CLAS-CN                     PIC  99.                     ELCDTECX
  7208     12  CLAS-CO                     PIC  99.                     ELCDTECX
  7209     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  7210         16  DTE-F-1                 PIC  X.                      ELCDTECX
  7211         16  DTE-F-2                 PIC  X.                      ELCDTECX
  7212     12  DTE-ABEND-WORK.                                          ELCDTECX
  7213         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  7214         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  7215                                                                  ELCDTECX
  7216 01  FILLER                          PIC  X(12)                   ELCDTECX
  7217                                     VALUE 'WORKING DATE'.        ELCDTECX
  7218 01  WS-DATE-AND-TIME.                                            ELCDTECX
  7219     12  WS-ACCEPT-DATE.                                          ELCDTECX
  7220         16  WS-AD-YY                PIC  99.                     ELCDTECX
  7221         16  WS-AD-MM                PIC  99.                     ELCDTECX
  7222         16  WS-AD-DD                PIC  99.                     ELCDTECX
  7223     12  WS-CURRENT-DATE.                                         ELCDTECX
  7224         16  WS-CD-MM                PIC  99.                     ELCDTECX
  7225         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7226         16  WS-CD-DD                PIC  99.                     ELCDTECX
  7227         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7228         16  WS-CD-YY                PIC  99.                     ELCDTECX
  7229     12  WS-TIME-OF-DAY.                                          ELCDTECX
  7230         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  7231         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  7232                                                                  ELCDTECX
  7233 01  FILLER                          PIC  X(12)                   ELCDTECX
  7234                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  7235 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  7236     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  7237         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  7238         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  7239         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  7240                                                                  ELCDTECX
  7241 01  FILLER                          PIC  X(10)                   ELCDTECX
  7242                                     VALUE 'STATE TLRS'.          ELCDTECX
  7243 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 141
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7244     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  7245         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  7246         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  7247                                                                  ELCDTECX
  7248 01  FILLER                          PIC  X(13)                   ELCDTECX
  7249                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  7250 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  7251     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  7252         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  7253                                                                  ELCDTECX
  7254 01  FILLER                          PIC  X(13)                   ELCDTECX
  7255                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  7256 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  7257     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  7258     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  7259     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  7260                                     PIC  X.                         CL**5
  7261     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  7262     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  7263     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  7264     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  7265     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  7266     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  7267     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  7268     12  FILLER                      PIC  X(75).                  ELCDTECX
  7269******************************************************************ELCDTECX
  7270*01  MISC-CARR-PCT-DATA.                                          00001521
  7271*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7272*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7273*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7274*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7275*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7276*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7277******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 142
* ECS010.cbl
* 7279                             COPY ELCDTEVR.
  7280***************************************************************** 04/15/98
  7281*                                                                *ELCDTEVR
  7282*                                                                *ELCDTEVR
  7283*                            ELCDTEVR.                           *   LV003
  7284*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7285*                            VMOD=2.001                          *   CL**2
  7286*                                                                *ELCDTEVR
  7287*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  7288*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  7289*                                                                *ELCDTEVR
  7290******************************************************************ELCDTEVR
  7291 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  7292     05  WS-RUN-DATE.                                             ELCDTEVR
  7293         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7294         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  7295         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  7296             15  RUN-CC              PIC  99.                     ELCDTEVR
  7297             15  RUN-YR              PIC  99.                     ELCDTEVR
  7298         10  RUN-MO                  PIC  99.                     ELCDTEVR
  7299         10  RUN-DA                  PIC  99.                     ELCDTEVR
  7300     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  7301            WS-RUN-DATE              PIC 9(11).                      CL**2
  7302     05  WS-EP-DT.                                                ELCDTEVR
  7303         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7304         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  7305         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  7306             15  EP-CC               PIC  99.                     ELCDTEVR
  7307             15  EP-YR               PIC  99.                     ELCDTEVR
  7308         10  EP-MO                   PIC  99.                     ELCDTEVR
  7309         10  EP-DA                   PIC  99.                     ELCDTEVR
  7310     05  WS-EP-DT-N REDEFINES                                        CL**2
  7311            WS-EP-DT                 PIC 9(11).                      CL**2
  7312     05  WS-DTE-CONV-DT.                                             CL**4
  7313         10  FILLER                  PIC  9(03).                     CL**4
  7314         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  7315         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  7316             15  DTE-CONV-CC         PIC  99.                        CL**4
  7317             15  DTE-CONV-YR         PIC  99.                        CL**4
  7318         10  DTE-CONV-MO             PIC  99.                        CL**4
  7319         10  DTE-CONV-DA             PIC  99.                        CL**4
  7320     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  7321            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  7322 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  7323     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  7324         10  FILLER                            PIC 999.           ELCDTEVR
  7325         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  7326         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  7327             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  7328             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  7329         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  7330         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  7331     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  7332            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  7333     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  7334         10  FILLER                            PIC 999.           ELCDTEVR
  7335         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  7336         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 143
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  7337         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  7338         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  7339     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  7340            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  7341 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  7342     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  7343         10  FILLER                            PIC 999.           ELCDTEVR
  7344         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  7345         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  7346             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  7347             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  7348         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  7349         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  7350     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  7351            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  7352     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  7353         10  FILLER                            PIC 999.           ELCDTEVR
  7354         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  7355         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  7356             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  7357             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  7358         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  7359         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  7360     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  7361            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  7362     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  7363         10  FILLER                            PIC 999.           ELCDTEVR
  7364         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  7365         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  7366             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  7367             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  7368         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  7369         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  7370     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  7371            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  7372 01  WS-RATE-RECORD.                                              ELCDTEVR
  7373         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  7374             10  FILLER                        PIC 999.           ELCDTEVR
  7375             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  7376             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  7377                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  7378                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  7379             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  7380             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  7381         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  7382                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 144
* ECS010.cbl
* 7384                             COPY ELCACCTV.
  7385******************************************************************04/14/98
  7386*                                                                *ELCACCTV
  7387*                            ELCACCTV                            *   LV002
  7388*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7389*                            VMOD=2.001                          *ELCACCTV
  7390*                                                                *ELCACCTV
  7391*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  7392*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  7393*                                                                *ELCACCTV
  7394*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  7395*                                                                *ELCACCTV
  7396******************************************************************ELCACCTV
  7397                                                                  ELCACCTV
  7398 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  7399                                                                  ELCACCTV
  7400     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  7401         10  FILLER            PIC 999.                           ELCACCTV
  7402         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7403         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7404             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7405             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7406         10  AM-EXP-MO         PIC 99.                               CL**5
  7407         10  AM-EXP-DA         PIC 99.                               CL**5
  7408     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7409            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7410     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7411         10  FILLER                    PIC 999.                   ELCACCTV
  7412         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7413         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7414             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7415             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7416         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7417         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7418     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7419            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7420     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7421         10  FILLER                    PIC 999.                   ELCACCTV
  7422         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7423         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7424             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7425             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7426         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7427         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7428     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7429            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7430     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7431         10 FILLER                     PIC 999.                   ELCACCTV
  7432         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7433         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7434            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7435            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7436         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7437         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7438     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7439            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7440     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7441         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 145
* ECS010.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7442         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7443         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7444            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7445            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7446         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7447         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7448     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7449            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7450     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7451         10  FILLER                    PIC 999.                   ELCACCTV
  7452         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7453         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7454             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7455             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7456         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7457         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7458     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7459            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7460     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7461         10  FILLER                    PIC 999.                   ELCACCTV
  7462         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7463         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7464             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7465             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7466         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7467         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7468     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7469            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7470     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7471         10  FILLER                    PIC 999.                   ELCACCTV
  7472         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7473         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7474             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7475             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7476         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7477         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7478     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7479            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7480     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7481         10  FILLER                    PIC 999.                   ELCACCTV
  7482         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7483         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7484             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7485             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7486         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7487         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7488     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7489            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 146
* ECS010.cbl
* 7491                             COPY ELCEXTVR.
  7492******************************************************************04/15/98
  7493*                                                                *ELCEXTVR
  7494*                                                                *ELCEXTVR
  7495*                             ELCEXTVR                           *   LV002
  7496*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7497*                            VMOD=2.001                          *ELCEXTVR
  7498*                                                                *ELCEXTVR
  7499*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7500*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7501*                                                                *ELCEXTVR
  7502******************************************************************ELCEXTVR
  7503 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7504     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7505         10  FILLER              PIC 999.                         ELCEXTVR
  7506         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7507         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7508             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7509             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7510         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7511         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7512     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7513            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7514 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7515     05  WS-DE-EFF.                                               ELCEXTVR
  7516         10  FILLER              PIC 999.                         ELCEXTVR
  7517         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7518         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7519             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7520             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7521         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7522         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7523     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7524            WS-DE-EFF            PIC 9(11).                          CL**2
  7525     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7526         10  FILLER              PIC 999.                         ELCEXTVR
  7527         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7528         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7529             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7530             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7531         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7532         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7533     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7534            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7535     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7536         10  FILLER                 PIC 999.                      ELCEXTVR
  7537         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7538         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7539             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7540             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7541         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7542         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7543     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7544            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7545     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7546         10  FILLER                 PIC 999.                      ELCEXTVR
  7547         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7548         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 147
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7549             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7550             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7551         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7552         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7553     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7554            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7555     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7556         10  FILLER                 PIC 999.                      ELCEXTVR
  7557         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7558         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7559             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7560             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7561         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7562         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7563     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7564            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7565     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7566         10  FILLER                 PIC 999.                      ELCEXTVR
  7567         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7568         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7569             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7570             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7571         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7572         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7573     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7574            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7575     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7576         10  FILLER                 PIC 999.                      ELCEXTVR
  7577         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7578         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7579             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7580             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7581         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7582         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7583     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7584            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7585     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7586         10  FILLER                 PIC 999.                         CL**5
  7587         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7588         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7589             15  DE-CP-CC           PIC 99.                          CL**5
  7590             15  DE-CP-YR           PIC 99.                          CL**5
  7591         10  DE-CP-MO               PIC 99.                          CL**5
  7592         10  DE-CP-DA               PIC 99.                          CL**5
  7593     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7594            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7595     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7596         10  FILLER                 PIC 999.                         CL**5
  7597         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7598         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7599             15  DE-RP-CC           PIC 99.                          CL**5
  7600             15  DE-RP-YR           PIC 99.                          CL**5
  7601         10  DE-RP-MO                      PIC 99.                   CL**5
  7602         10  DE-RP-DA                      PIC 99.                   CL**5
  7603     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7604            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7605     05  WS-DE-INCUR.                                             ELCEXTVR
  7606         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 148
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7607         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7608         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7609             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7610             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7611         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7612         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7613     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7614            WS-DE-INCUR             PIC 9(11).                       CL**2
  7615     05  WS-DE-PAY.                                               ELCEXTVR
  7616         10  FILLER                 PIC 999.                      ELCEXTVR
  7617         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7618         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7619             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7620             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7621         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7622         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7623     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7624            WS-DE-PAY               PIC 9(11).                       CL**2
  7625     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7626         10  FILLER                 PIC 999.                      ELCEXTVR
  7627         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7628         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7629             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7630             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7631         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7632         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7633     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7634            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7635     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7636         10 FILLER                  PIC 999.                      ELCEXTVR
  7637         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7638         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7639            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7640            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7641         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7642         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7643     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7644            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7645     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7646         10 FILLER                  PIC 999.                      ELCEXTVR
  7647         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7648         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7649            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7650            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7651         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7652         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7653     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7654            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7655     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7656         10  FILLER                 PIC 999.                      ELCEXTVR
  7657         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7658         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7659             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7660             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7661         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7662         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7663     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7664            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 149
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7665     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7666         10  FILLER                 PIC 999.                      ELCEXTVR
  7667         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7668         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7669             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7670             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7671         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7672         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7673     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7674            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7675     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7676         10  FILLER                        PIC 999.               ELCEXTVR
  7677         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7678         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7679                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7680             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7681             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7682         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7683         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7684     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7685            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7686     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7687         10  FILLER                        PIC 999.               ELCEXTVR
  7688         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7689         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7690                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7691             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7692             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7693         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7694         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7695     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7696            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7697                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 150
* ECS010.cbl
  7699 PROCEDURE DIVISION.
  7700
  7701 0000-START.
  7702
  7703******************************************************************
  7704***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7705******************************************************************
  7706
  7707*0003-LOAD-DATE-CARD.
* 7708                             COPY ELCDTERX.
  7709******************************************************************04/15/98
  7710*                                                                *ELCDTERX
  7711*                                                                *ELCDTERX
  7712*                            ELCDTERX.                           *   LV002
  7713*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7714*                            VMOD=2.007                          *ELCDTERX
  7715*                                                                *ELCDTERX
  7716*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7717*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7718*      = ELCDTEFD)                                               *ELCDTERX
  7719*                                                                *ELCDTERX
  7720******************************************************************ELCDTERX
  7721                                                                  ELCDTERX
  7722     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7723                                                                  ELCDTERX
  7724     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7725     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7726     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7727                                                                  ELCDTERX
  7728     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7729                                                                  ELCDTERX
  7730******************************************************************ELCDTERX
  7731*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7732*          WARNING MESSAGES.                                      ELCDTERX
  7733******************************************************************ELCDTERX
  7734     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7735         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7736                                                                  ELCDTERX
  7737     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7738                                                                  ELCDTERX
  7739     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7740                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7741                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7742                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7743                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7744                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7745                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7746                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7747                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7748                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7749                                                                  ELCDTERX
  7750     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7751                                                                  ELCDTERX
  7752     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7753                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7754                                                                  ELCDTERX
  7755     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7756     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 151
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7757     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7758     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7759                                                                  ELCDTERX
  7760     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7761         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7762     ELSE                                                         ELCDTERX
  7763         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7764                                                                  ELCDTERX
  7765     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7766         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7767     ELSE                                                         ELCDTERX
  7768         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7769                                                                  ELCDTERX
  7770 0005-READ--CARD.                                                 ELCDTERX
  7771     READ DISK-DATE                                               ELCDTERX
  7772         AT END CLOSE DISK-DATE                                   ELCDTERX
  7773             GO TO 0060-READ--TEST.                               ELCDTERX
  7774                                                                  ELCDTERX
  7775     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7776                                                                  ELCDTERX
  7777     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7778         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7779         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7780         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7781         GO TO 0005-READ--CARD.                                   ELCDTERX
  7782                                                                  ELCDTERX
  7783     IF DD-ID = 'CLAD'                                            ELCDTERX
  7784         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7785         GO TO 0005-READ--CARD.                                   ELCDTERX
  7786                                                                  ELCDTERX
  7787     IF DD-ID = 'CLAX'                                            ELCDTERX
  7788         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7789         GO TO 0005-READ--CARD.                                   ELCDTERX
  7790                                                                  ELCDTERX
  7791     IF DD-ID = 'CLAF'                                            ELCDTERX
  7792         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7793         GO TO 0005-READ--CARD.                                   ELCDTERX
  7794                                                                  ELCDTERX
  7795     IF DD-ID = 'CLAC'                                            ELCDTERX
  7796         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7797                                                                  ELCDTERX
  7798     IF DD-ID = 'CARR'                                            ELCDTERX
  7799         GO TO 0015-READ--CARR.                                   ELCDTERX
  7800                                                                  ELCDTERX
  7801     IF DD-ID = 'STAT'                                            ELCDTERX
  7802         GO TO 0020-READ--STAT.                                   ELCDTERX
  7803                                                                  ELCDTERX
  7804     IF DD-ID = 'BUSC'                                            ELCDTERX
  7805         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7806                                                                  ELCDTERX
  7807     IF DD-ID = 'MORT'                                            ELCDTERX
  7808         GO TO 0030-READ--MORT.                                   ELCDTERX
  7809                                                                  ELCDTERX
  7810     IF DD-ID = 'CLAI'                                            ELCDTERX
  7811         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7812                                                                  ELCDTERX
  7813     IF DD-ID = 'COLC'                                            ELCDTERX
  7814         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 152
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7815                                                                  ELCDTERX
  7816     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7817        DD-IDA = 'CL'                                             ELCDTERX
  7818         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7819                                                                  ELCDTERX
  7820     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7821        DD-IDA = 'PO'                                             ELCDTERX
  7822         GO TO 0050-READ--POXX.                                   ELCDTERX
  7823                                                                  ELCDTERX
  7824     IF DD-ID = 'OPCA'                                            ELCDTERX
  7825         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7826                                                                  ELCDTERX
  7827     IF DD-ID = 'OPST'                                            ELCDTERX
  7828         GO TO 0072-READ--OPST.                                   ELCDTERX
  7829                                                                  ELCDTERX
  7830     IF DD-ID = 'OPBS'                                            ELCDTERX
  7831         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7832                                                                  ELCDTERX
  7833     IF DD-ID = 'OPMS'                                            ELCDTERX
  7834         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7835                                                                  ELCDTERX
  7836     GO TO 0005-READ--CARD.                                       ELCDTERX
  7837                                                                  ELCDTERX
  7838 0010-READ--CLAC.                                                 ELCDTERX
  7839     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7840     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7841     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7842     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7843     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7844     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7845     GO TO 0005-READ--CARD.                                       ELCDTERX
  7846                                                                  ELCDTERX
  7847 0015-READ--CARR.                                                 ELCDTERX
  7848     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7849     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7850        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7851        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7852        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7853        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7854        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7855        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7856        MOVE DD-CARR1-SECPAY-SW
  7857                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7858     END-IF
  7859                                                                  ELCDTERX
  7860     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7861     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7862        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7863        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7864        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7865        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7866        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7867        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7868        MOVE DD-CARR2-SECPAY-SW
  7869                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7870     END-IF
  7871                                                                  ELCDTERX
  7872                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 153
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7873     GO TO 0005-READ--CARD.                                       ELCDTERX
  7874                                                                  ELCDTERX
  7875 0020-READ--STAT.                                                 ELCDTERX
  7876     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7877     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7878        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7879         GO TO 0005-READ--CARD.                                   ELCDTERX
  7880                                                                  ELCDTERX
  7881     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7882     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7883     GO TO 0020-READ--STAT.                                       ELCDTERX
  7884                                                                  ELCDTERX
  7885 0025-READ--BUSC.                                                 ELCDTERX
  7886     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7887     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7888        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7889         GO TO 0005-READ--CARD.                                   ELCDTERX
  7890                                                                  ELCDTERX
  7891     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7892     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7893     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7894                                                                  ELCDTERX
  7895 0030-READ--MORT.                                                 ELCDTERX
  7896     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7897     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7898        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7899         GO TO 0005-READ--CARD.                                   ELCDTERX
  7900                                                                  ELCDTERX
  7901     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7902     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7903     GO TO 0030-READ--MORT.                                       ELCDTERX
  7904                                                                  ELCDTERX
  7905 0035-READ--CLXX.                                                 ELCDTERX
  7906     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7907          GO TO 0005-READ--CARD.                                  ELCDTERX
  7908                                                                  ELCDTERX
  7909     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7910         DISPLAY '***********************************************'ELCDTERX
  7911         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7912         DISPLAY '***********************************************'ELCDTERX
  7913         GO TO 0055-READ--STOP.                                   ELCDTERX
  7914                                                                  ELCDTERX
  7915     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7916        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7917         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7918                                                                  ELCDTERX
  7919     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7920        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7921         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7922                                                                  ELCDTERX
  7923*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7924     GO TO 0005-READ--CARD.                                       ELCDTERX
  7925                                                                  ELCDTERX
  7926 0040-READ--CLAI.                                                 ELCDTERX
  7927     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7928     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7929        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7930         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 154
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7931                                                                  ELCDTERX
  7932     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7933     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7934     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7935                                                                  ELCDTERX
  7936 0045-READ--DUMP.                                                 ELCDTERX
  7937     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7938     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7939                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7940     PERFORM ABEND-PGM.                                           ELCDTERX
  7941                                                                  ELCDTERX
  7942 0050-READ--POXX.                                                 ELCDTERX
  7943     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7944         GO TO 0005-READ--CARD.                                   ELCDTERX
  7945                                                                  ELCDTERX
  7946     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7947         DISPLAY '***********************************************'ELCDTERX
  7948         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7949         DISPLAY '***********************************************'ELCDTERX
  7950         GO TO 0055-READ--STOP.                                   ELCDTERX
  7951                                                                  ELCDTERX
  7952     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7953     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7954     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7955     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7956                                                                  ELCDTERX
  7957     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7958         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7959     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7960         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7961                                                                  ELCDTERX
  7962     GO TO 0005-READ--CARD.                                       ELCDTERX
  7963                                                                  ELCDTERX
  7964 0055-READ--STOP.                                                 ELCDTERX
  7965     GOBACK.                                                      ELCDTERX
  7966                                                                  ELCDTERX
  7967 0060-READ--TEST.                                                 ELCDTERX
  7968     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7969        CLAX-ID         = SPACE  OR                               ELCDTERX
  7970        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7971         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7972                                                                  ELCDTERX
  7973     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7974     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7975                                                                  ELCDTERX
  7976 0065-READ--COLC.                                                 ELCDTERX
  7977     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7978     GO TO 0005-READ--CARD.                                       ELCDTERX
  7979                                                                  ELCDTERX
  7980 0070-READ--OPCA.                                                 ELCDTERX
  7981                                                                  ELCDTERX
  7982     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7983                                                                  ELCDTERX
  7984     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  7985             OR                                                   ELCDTERX
  7986         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  7987         GO TO 0005-READ--CARD.                                   ELCDTERX
  7988                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 155
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7989     ADD 1                       TO INDEXCA.                      ELCDTERX
  7990     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  7991                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  7992     GO TO 0070-READ--OPCA.                                       ELCDTERX
  7993                                                                  ELCDTERX
  7994 0072-READ--OPST.                                                 ELCDTERX
  7995                                                                  ELCDTERX
  7996     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7997                                                                  ELCDTERX
  7998     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  7999             OR                                                   ELCDTERX
  8000         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8001         GO TO 0005-READ--CARD.                                   ELCDTERX
  8002                                                                  ELCDTERX
  8003     ADD 1                       TO INDEXST.                      ELCDTERX
  8004     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  8005                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  8006     GO TO 0072-READ--OPST.                                       ELCDTERX
  8007                                                                  ELCDTERX
  8008 0074-READ--OPBS.                                                 ELCDTERX
  8009                                                                  ELCDTERX
  8010     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8011                                                                  ELCDTERX
  8012     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  8013             OR                                                   ELCDTERX
  8014         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8015         GO TO 0005-READ--CARD.                                   ELCDTERX
  8016                                                                  ELCDTERX
  8017     ADD 1                       TO INDEXBS.                      ELCDTERX
  8018     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  8019     GO TO 0074-READ--OPBS.                                       ELCDTERX
  8020                                                                  ELCDTERX
  8021 0079-READ--EXIT.                                                 ELCDTERX
  8022*    EXIT.                                                        ELCDTERX
  8023******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 156
* ECS010.cbl
  8025******************************************************************
  8026***           O P E N   F I L E S   R O U T I N E              ***
  8027******************************************************************
  8028
  8029     DISPLAY ' '.
  8030     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  8031         'ECS010 ******'
  8032     DISPLAY ' '.
  8033
  8034     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  8035     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  8036     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  8037     .
  8038 0080-OPEN-FILES.
  8039*    IF DTE-PGM-OPT = '1'
  8040*       open output detail-extr
  8041*    end-if
  8042     OPEN INPUT  PENDING-EXTRACT
  8043                 CERT-MASTER-IN
  8044                 ERACCTT-IN
  8045                 ERAGTC
  8046
  8047          I-O    ERMEBL-INOUT
  8048                 ELCRTT
  8049
  8050          OUTPUT SUMMARY-EXTR
  8051                 ME-ECS010-BALANCE
  8052                 ME50-ECS010-BALANCE
  8053                 DISPLAY-PRT
  8054                 MISMATCH-REPORT
  8055                 PRINT-COPY.
  8056     IF DTE-CLIENT = 'DCC'
  8057        OPEN INPUT ERPDEF
  8058     END-IF
  8059
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 157
* ECS010.cbl
  8061*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  8062     IF DTE-CLIENT NOT = 'DMD'
  8063         NEXT SENTENCE
  8064     ELSE
  8065         OPEN INPUT ERRESC-IN
  8066            IF ERRESC-FILE-STATUS   = '00' OR '97'
  8067                NEXT SENTENCE
  8068            ELSE
  8069                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  8070                MOVE 'ERROR OPENING ERRESC FILE'
  8071                                        TO WS-ABEND-MESSAGE
  8072                GO TO ABEND-PGM.
  8073*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  8074
  8075     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  8076         NEXT SENTENCE
  8077       ELSE
  8078         MOVE '11'                    TO ABEND-CODE-1
  8079         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  8080         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8081         GO TO ABEND-PGM.
  8082
  8083     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  8084        CONTINUE
  8085     ELSE
  8086        DISPLAY ' OPEN ERROR ELCRTT '
  8087        MOVE '31'                TO ABEND-CODE-1
  8088        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  8089        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8090        GO TO ABEND-PGM
  8091     END-IF
  8092
  8093     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  8094        CONTINUE
  8095     ELSE
  8096        DISPLAY ' OPEN ERROR ERAGTC '
  8097        MOVE '41'                TO ABEND-CODE-1
  8098        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  8099        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8100        GO TO ABEND-PGM
  8101     END-IF
  8102
  8103     IF ERPDEF-FILE-STATUS  = '00' OR '97'
  8104        CONTINUE
  8105     ELSE
  8106        DISPLAY ' OPEN ERROR ERPDEF '
  8107        MOVE '61'                TO ABEND-CODE-1
  8108        MOVE ERPDEF-FILE-STATUS  TO ABEND-CODE-2
  8109        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8110        GO TO ABEND-PGM
  8111     END-IF
  8112
  8113     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  8114         NEXT SENTENCE
  8115       ELSE
  8116         MOVE 'N'                     TO ME-UPDATE-FLAG.
  8117
  8118           if (dte-client = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 158
* ECS010.cbl
  8119              and (dte-pgm-opt = '1')
  8120              open output new-detail-extr
  8121           end-if
  8122
  8123     IF DTE-PGM-OPT = '1'
  8124         OPEN OUTPUT  CERT-MASTER-OUT
  8125                      DETAIL-EXTR
  8126     ELSE
  8127         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  8128         MOVE '*'                     TO TRANS-EOF-FLAG.
  8129
  8130     MOVE 'R'                         TO CP-RATE-FILE.
  8131     MOVE 'O'                         TO CP-IO-FUNCTION.
  8132     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  8133     IF IO-ERROR
  8134         MOVE 'ERROR OCCURED OPENING - ELRATE'
  8135                                      TO WS-ABEND-MESSAGE
  8136         MOVE 0302                    TO WS-RETURN-CODE
  8137         GO TO ABEND-PGM.
  8138
  8139******************************************************************
  8140***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  8141******************************************************************
  8142
  8143 0090-INITIALIZATION-ROUTINE.
  8144
  8145     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  8146     MOVE WS-TIME                     TO ME-START-TIME.
  8147     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  8148                                         TR-RN-DT.
  8149     MOVE ME-START-MO                 TO ME-CNDS-MO.
  8150     MOVE ME-START-DA                 TO ME-CNDS-DA.
  8151     MOVE ME-START-YR                 TO ME-CNDS-YR.
  8152     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  8153     MOVE COMPANY-NAME                TO TRHDNM.
  8154     MOVE ALPH-DATE                   TO TR-MODAYR.
  8155     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  8156     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  8157
  8158     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  8159     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8160     COMPUTE LYD-MO = LYD-MO - 1.
  8161     IF LYD-MO = ZERO
  8162         MOVE 12                      TO LYD-MO
  8163         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8164
  8165     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  8166
  8167
  8168     IF DTE-CLIENT = 'CID'
  8169         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  8170         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  8171     ELSE
  8172       IF DTE-CLIENT = 'AHL'
  8173         MOVE 'AHLGM15'          TO  WS-ME-BAL-JOB
  8174         MOVE 'AHLGM15'          TO  WS-ME50-BAL-JOB
  8175       ELSE
  8176         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 159
* ECS010.cbl
  8177         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  8178       END-IF
  8179     END-IF.
  8180
  8181     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  8182         GO TO 0090-CONTINUE.
  8183
  8184     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8185     MOVE -12                    TO DC-ELAPSED-MONTHS.
  8186     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8187     MOVE '6'                    TO DC-OPTION-CODE.
  8188     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8189
  8190     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8191         MOVE '**** WORK DATE CALC ERROR ****'
  8192                                 TO WS-ABEND-MESSAGE
  8193         MOVE '90'               TO ABEND-CODE-1
  8194         MOVE '0'                TO AC2-ONE
  8195         MOVE DC-ERROR-CODE      TO AC2-TWO
  8196         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8197         GO TO ABEND-PGM.
  8198
  8199     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  8200
  8201     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  8202     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  8203
  8204     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  8205             VARYING
  8206         SUBM FROM +2 BY +1
  8207             UNTIL
  8208         SUBM GREATER THAN +12.
  8209
  8210     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  8211
  8212     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  8213             VARYING
  8214         SUBM FROM +1 BY +1
  8215             UNTIL
  8216         SUBM GREATER THAN +13.
  8217
  8218     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8219*    MOVE -90                    TO DC-ELAPSED-DAYS.
  8220     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  8221                                    DC-ELAPSED-MONTHS.
  8222     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  8223     MOVE 1                      TO DC-END-OF-MONTH.
  8224     MOVE '6'                    TO DC-OPTION-CODE.
  8225     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8226
  8227     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8228         MOVE '**** CUT OFF DATE ERROR ****'
  8229                                 TO WS-ABEND-MESSAGE
  8230         MOVE '90'               TO ABEND-CODE-1
  8231         MOVE '0'                TO AC2-ONE
  8232         MOVE DC-ERROR-CODE      TO AC2-TWO
  8233         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8234         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 160
* ECS010.cbl
  8235
  8236     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  8237     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  8238
  8239 0090-CONTINUE.
  8240
  8241     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8242     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8243     MOVE +0                     TO DC-ELAPSED-DAYS.
  8244     MOVE '6'                    TO DC-OPTION-CODE.
  8245     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8246
  8247     IF NO-CONVERSION-ERROR
  8248        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  8249
  8250     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  8251     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8252     MOVE +0                     TO DC-ELAPSED-DAYS.
  8253     MOVE '6'                    TO DC-OPTION-CODE.
  8254     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8255
  8256     IF NO-CONVERSION-ERROR
  8257        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  8258
  8259     MOVE +0                     TO DC-ELAPSED-MONTHS
  8260                                    DC-ELAPSED-DAYS.
  8261
  8262     MOVE SPACES                 TO CERTIFICATE-RECORD.
  8263     MOVE 'CR'                   TO CR-RECORD-ID.
  8264     MOVE ZEROS                  TO
  8265               CR-AGE                  CR-JOINT-AGE
  8266               CR-LFTYP                CR-AHTYP
  8267               CR-LF-TERM              CR-AH-TERM
  8268               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  8269               CR-LF-TERM-IN-DAYS
  8270               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  8271               CR-LFAMT                CR-AHAMT
  8272               CR-LFPRM                CR-AHPRM
  8273               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  8274               CR-LFPRM-CALC           CR-AHPRM-CALC
  8275               CR-LFPRM-RATE           CR-AHPRM-RATE
  8276               CR-LFAMT-ALT
  8277               CR-LFPRM-ALT
  8278               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  8279               CR-LFPRM-RATE-ALT
  8280               CR-LFRFND               CR-AHRFND
  8281               CR-LFRFND-CALC          CR-AHRFND-CALC
  8282               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  8283               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  8284               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  8285               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  8286               CR-LIVES                CR-APR
  8287               CR-BILLED
  8288               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  8289               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  8290               CR-PMT-FREQ             CR-LOAN-TERM
  8291               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  8292               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 161
* ECS010.cbl
  8293               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  8294               CR-LF-CANC-DT           CR-AH-CANC-DT
  8295               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  8296               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  8297               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  8298               CR-DTH-DT               CR-DIS-DT
  8299               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  8300               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  8301                                       CR-DIS-PTO-DT
  8302               CR-DTHAMT               CR-DISAMT
  8303               CR-DTHAMT-YTD           CR-DISAMT-YTD
  8304               CR-DTHAMT-LAST          CR-DISAMT-LAST
  8305               CR-DTHEXP               CR-DISEXP
  8306               CR-DTHEXP-YTD           CR-DISEXP-YTD
  8307               CR-DTH-AGE              CR-DAYS-DISAB
  8308               CR-DIS-INCUR-DT (1)
  8309***            CR-CLAIM-DEDUCT-WITHHELD
  8310               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  8311               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  8312               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  8313               CR-MOB-NET-TOT-FEES
  8314               CR-ADDL-CLP  CR-LF-CLP  CR-AH-CLP
  8315               CR-LF-RFND-CLP CR-AH-RFND-CLP.
  8316
  8317     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  8318                                       CR-DISAB-DETAIL-DATA (3)
  8319                                       CR-DISAB-DETAIL-DATA (4)
  8320                                       CR-DISAB-DETAIL-DATA (5).
  8321
  8322     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  8323
  8324     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  8325     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  8326        IA > +10
  8327        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  8328     END-PERFORM
  8329     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  8330
  8331     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  8332
  8333     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  8334                          EPEC-TOTALS      EPEC-SUBS
  8335                          EPEC-UNDERWRITTEN-TOTALS.
  8336
  8337     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  8338                          EPEC-LEVELS-END-II.
  8339     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  8340                          DUPE-CERT-TABLE.
  8341
  8342     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  8343     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  8344     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  8345                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  8346     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  8347                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  8348
  8349     IF RUN-DATE NOT = EP-DT
  8350         MOVE '*'                     TO TR-YRASK.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 162
* ECS010.cbl
  8351     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  8352     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  8353     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  8354     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  8355
  8356     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  8357         MOVE +1000                   TO DUP-MAX.
  8358
  8359     MOVE DTE-CLIENT                  TO ME-COMPANY.
  8360     MOVE MONTH-END-MOYR              TO ME-MOYR.
  8361     IF ME-DO-UPDATE
  8362         READ ERMEBL-INOUT INVALID KEY
  8363                       CLOSE ERMEBL-INOUT
  8364                       MOVE 'N'       TO ME-UPDATE-FLAG.
  8365
  8366     IF DTE-CLIENT = 'DCC'
  8367        MOVE 0 TO B-SUB
  8368        MOVE DTE-CLASIC-COMPANY-CD
  8369                                 TO PD-CONTROL-PRIMARY
  8370        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  8371        IF ERPDEF-FILE-STATUS = '00'
  8372           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  8373              READ ERPDEF NEXT RECORD
  8374              IF ERPDEF-FILE-STATUS = '00'
  8375                 ADD 1 TO B-SUB
  8376                 IF B-SUB > max-pdef
  8377                    DISPLAY ' DDF UEP TABLE BLEW ' b-sub
  8378                    GO TO ABEND-PGM
  8379                 END-IF
  8380                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  8381                 MOVE PD-PRODUCT-CD
  8382                                 TO DD-PRODUCT-CD (B-SUB)
  8383                 MOVE PD-BEN-TYPE
  8384                                 TO DD-BEN-TYPE (B-SUB)
  8385                 MOVE PD-BEN-CODE
  8386                                 TO DD-BEN-CODE (B-SUB)
  8387                 MOVE PD-PROD-EXP-DT
  8388                                 TO DD-PROD-EXP-DT (B-SUB)
  8389                 MOVE PD-1ST-YR-ADMIN-ALLOW
  8390                                 TO DD-1ST-YR-ALLOW (B-SUB)
  8391                 MOVE PD-TRUNCATED TO DD-TRUNCATED (B-SUB)
  8392                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  8393                    P2 > +8
  8394                    MOVE PD-PROD-CODE (P2)
  8395                                 TO DD-PROD-CODE (B-SUB P2)
  8396                    MOVE PD-MAX-AMT (P2)
  8397                                 TO DD-MAX-BEN-AMT (B-SUB P2)
  8398                 END-PERFORM
  8399                 MOVE PD-EARN-FACTORS
  8400                                 TO DD-EARN-FACTORS (B-SUB)
  8401              END-IF
  8402           END-PERFORM
  8403           display ' pdef table entries ' b-sub
  8404        END-IF
  8405        CLOSE ERPDEF
  8406     END-IF
  8407
  8408     GO TO 0150-READ-ACCOUNT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 163
* ECS010.cbl
  8409
  8410 0090-EXIT.
  8411     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 164
* ECS010.cbl
  8413 0095-GET-EOM-DATES.
  8414
  8415     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  8416     MOVE '6'                    TO DC-OPTION-CODE.
  8417     MOVE 1                      TO DC-ELAPSED-MONTHS
  8418                                    DC-END-OF-MONTH.
  8419     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8420     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8421
  8422     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8423         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  8424                                 TO WS-ABEND-MESSAGE
  8425         MOVE '90'               TO ABEND-CODE-1
  8426         MOVE '0'                TO AC2-ONE
  8427         MOVE DC-ERROR-CODE      TO AC2-TWO
  8428         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8429         GO TO ABEND-PGM.
  8430
  8431     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  8432                                     DC-BIN-DATE-1.
  8433     MOVE SPACES                 TO  DC-BIN-DATE-2.
  8434     MOVE ' '                    TO  DC-OPTION-CODE.
  8435     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8436
  8437     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8438         MOVE '**** YMD EOM DATE CALC ERROR ****'
  8439                                 TO WS-ABEND-MESSAGE
  8440         MOVE '90'               TO ABEND-CODE-1
  8441         MOVE '0'                TO AC2-ONE
  8442         MOVE DC-ERROR-CODE      TO AC2-TWO
  8443         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8444         GO TO ABEND-PGM.
  8445
  8446     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  8447
  8448 0095-EXIT.
  8449     EXIT.
  8450
  8451 0096-DISPLAY-EOM-DATES.
  8452
  8453     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  8454
  8455 0096-EXIT.
  8456     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 165
* ECS010.cbl
  8458******************************************************************
  8459***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  8460******************************************************************
  8461
  8462 0100-ACCT-MASTER-READ-ROUTINE.
  8463
  8464     IF EP-FLG = '1'
  8465        ADD +1                   TO BC-ACT-ACCTS
  8466        IF DTE-OPT-RESERVE-METHOD-AUTH
  8467           PERFORM 4700-CALC-OPT-IBNR
  8468                                 THRU 4700-EXIT
  8469        END-IF
  8470        PERFORM 4500-BUILD-EPEC-EXTRACT
  8471                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8472     END-IF
  8473
  8474     IF TRANSACTION-WAS-PROCESSED
  8475         MOVE '1'                     TO ACCT-FLG
  8476                                         STATE-FLG
  8477                                         COMP-FLG
  8478                                         CARR-FLG
  8479                                         FINAL-FLG.
  8480
  8481 0150-READ-ACCOUNT-MASTER.
  8482
  8483     READ ERACCTT-IN AT END
  8484         GO TO 9930-EOJ-3.
  8485
  8486     ADD +1                            TO ERACCTT-READS.
  8487
* 8488     COPY ELCACCTI.
  8489******************************************************************04/14/98
  8490*                                                                *ELCACCTI
  8491*                            ELCACCTI                            *   LV003
  8492*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8493*                            VMOD=2.001                          *ELCACCTI
  8494*                                                                *ELCACCTI
  8495*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8496*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8497*                                                                *ELCACCTI
  8498*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8499*                                                                *ELCACCTI
  8500******************************************************************ELCACCTI
  8501     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8502     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8503     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8504     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8505     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8506     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8507     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8508     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8509     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8510
  8511     IF FIRST-ACCOUNT EQUAL +1
  8512        MOVE +0                  TO FIRST-ACCOUNT
  8513        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8514
  8515     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 166
* ECS010.cbl
  8516         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8517     ELSE
  8518     IF AM-GROUPING NOT = HLD-GROUPING
  8519         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8520     ELSE
  8521     IF AM-STATE NOT = HLD-STATE
  8522         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8523     ELSE
  8524     IF AM-ACCOUNT NOT = HLD-ACCT
  8525         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8526     ELSE
  8527     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8528
  8529     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8530        (AM-GROUPING NOT = HLD-GROUPING)
  8531         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8532
  8533 0190-PROCESS-NEW-ACCOUNT.
  8534
  8535     IF AM-CARRIER NOT = HLD-CARRIER
  8536         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8537
  8538     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8539     MOVE AM-CARRIER            TO TR-CARR.
  8540     MOVE AM-GROUPING           TO TR-GROUP.
  8541     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8542     MOVE AM-NAME               TO TR-AGCY.
  8543     MOVE AM-EFF-MO             TO TR-CE-MO.
  8544     MOVE AM-EFF-DA             TO TR-CE-DA.
  8545     MOVE AM-EFF-YR             TO TR-CE-YR.
  8546     MOVE AM-STATE              TO TR-ST-NO.
  8547     IF AM-EXPIRE-DT =  99999999999
  8548         MOVE 'CURRENT '        TO TR-CX
  8549     ELSE
  8550         MOVE AM-EXP-MO         TO TR-CX-MO
  8551         MOVE AM-EXP-DA         TO TR-CX-DA
  8552         MOVE AM-EXP-YR         TO TR-CX-YR
  8553         MOVE '-'               TO HSHR1  HSHR2.
  8554
  8555     ADD +1 TO BC-ACCTS.
  8556
  8557     IF AM-RECORD-ID = '**'
  8558         ADD +1 TO BC-NEW-ACCTS.
  8559     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8560         ADD +1 TO BC-ER-ACCTS.
  8561
  8562     MOVE ZEROS                 TO SV-LO-CERT
  8563                                   SV-HI-CERT.
  8564     MOVE SPACE                 TO TRANSACTION-FLAG
  8565                                   LST-TRD-CERT
  8566                                   LST-TRD-ISDT
  8567                                   OB-DATE-1-SWITCH
  8568                                   OB-DATE-2-SWITCH
  8569                                   OB-DATE-3-SWITCH.
  8570     MOVE +81                   TO LN-CNT.
  8571
  8572     IF DTE-CLIENT = 'DCC'
  8573        MOVE 'YYYYYYYYYY'        TO WS-DCC-DDF-CB-LEVELS
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 167
* ECS010.cbl
  8574        PERFORM VARYING SUB FROM +1 BY +1 UNTIL SUB > 10
  8575           IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  8576              MOVE ZEROS         TO AM-COMM-CHARGEBACK (SUB)
  8577           END-IF
  8578           IF AM-COMM-CHARGEBACK (SUB) = 99
  8579              MOVE 'N'           TO WS-DDF-AH-CB (SUB)
  8580           END-IF
  8581        END-PERFORM
  8582     END-IF
  8583     .
  8584 0199-READ-ACCOUNT-X.
  8585     EXIT.
  8586
  8587 0199A-CARRIER-TABLE-LOOKUP.
  8588
  8589     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8590            VARYING CLAS-INDEXCN FROM 1 BY 1
  8591         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8592               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8593
  8594     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8595         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8596         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8597                                 TO WS-ABEND-MESSAGE
  8598         MOVE 4004               TO WS-ABEND-CODE
  8599         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8600         GO TO ABEND-PGM.
  8601
  8602 0199A-LOOKUP-XIT.
  8603     EXIT.
  8604 0199B-SEARCH-CARRIER-TABLE.
  8605     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 168
* ECS010.cbl
  8607******************************************************************
  8608***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8609******************************************************************
  8610
  8611 0200-CERT-MASTER-READ-ROUTINE.
  8612
  8613     IF EOF-ON-CERT
  8614         GO TO 0299-READ-CERT-X.
  8615
  8616     IF FIRST-CERT EQUAL +1
  8617        MOVE +0                  TO FIRST-CERT
  8618        GO TO 0250-READ-CERT-MASTER.
  8619
  8620     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8621
  8622     PERFORM CERT-DATE-LOAD.
  8623
  8624     IF CR-IND-GRP = 'I'  OR  '1'
  8625         MOVE '1'                    TO CR-IND-GRP
  8626     ELSE
  8627         MOVE '2'                    TO CR-IND-GRP.
  8628
  8629     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8630         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8631     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8632         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8633
  8634************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8635     IF DTE-CLIENT NOT = 'NSL'
  8636         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8637                                      CR-AH-REI-RISK-PRM.
  8638******************************************************************
  8639
  8640**** IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8641****     MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8642     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8643         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8644
  8645     MOVE CR-STATE                   TO STATE-L.
  8646     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8647
  8648     IF CR-LFTYP NOT = ZERO
  8649         MOVE CR-LFTYP               TO CLAS-LOOK
  8650         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8651
  8652     IF CR-AHTYP NOT = ZERO
  8653         MOVE CR-AHTYP               TO CLAS-LOOK
  8654         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8655
  8656     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8657     MOVE 'L'                    TO DC-OPTION-CODE
  8658     MOVE +0                     TO DC-ELAPSED-MONTHS
  8659                                    DC-ELAPSED-DAYS
  8660     PERFORM 8000-DATE-CONVERT-ROUTINE
  8661                                 THRU 8099-DATE-CONVERT-X
  8662     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8663
  8664     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 169
* ECS010.cbl
  8665        AND (CR-AHTYP NOT = ZERO AND SPACES)
  8666        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8667        AND (CR-DCC-PRODUCT-CODE NOT = 'DDF')
  8668        PERFORM 0395-GET-CERT-TRLRS
  8669                                 THRU 0395-EXIT
  8670     END-IF
  8671
  8672     IF RUN-MO NOT = 01
  8673         GO TO 0250-READ-CERT-MASTER.
  8674
  8675     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8676                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8677
  8678     IF ((CR-LFTYP NOT = ZERO)  AND
  8679         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8680        ((CR-AHTYP NOT = ZERO)  AND
  8681         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8682           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8683
  8684     .
  8685 0250-READ-CERT-MASTER.
  8686
  8687     READ CERT-MASTER-IN
  8688               AT END GO TO 9920-EOJ-2.
  8689
  8690     ADD +1 TO CMIN-CNT.
  8691
  8692*     DISPLAY ' READ CERT ' CIR-CONTROL
  8693     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8694         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8695         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8696         DISPLAY 'SECOND - '  CIR-CONTROL
  8697         MOVE 0612                    TO WS-ABEND-CODE
  8698         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8699         GO TO ABEND-PGM.
  8700
  8701     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8702         DISPLAY 'DUPLICATE CERT ON FILE'  pcic-first ' '
  8703            pcic-dt ' ' pcic-cert-no
  8704         IF DTE-CLIENT EQUAL 'SEN' OR 'AHL'
  8705            GO TO 0250-READ-CERT-MASTER
  8706         ELSE
  8707            MOVE 'DUPLICATE CERT ON FILE'
  8708                                      TO WS-ABEND-MESSAGE
  8709            MOVE 0302                 TO WS-ABEND-CODE
  8710            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8711            GO TO ABEND-PGM.
  8712
  8713******************************************************
  8714*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8715*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8716*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8717******************************************************
  8718     IF DTE-CLIENT = 'CID'
  8719        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8720           IF (CF-THIRD-AGENT  = '0000713100') OR
  8721              (CF-FOURTH-AGENT = '0000713100')
  8722              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 170
* ECS010.cbl
  8723           ELSE
  8724              GO TO 0250-READ-CERT-MASTER
  8725           END-IF
  8726        ELSE
  8727           IF COMPANY-NAME = '        PEOPLES TRUST'
  8728              IF CI-ACCOUNT = '0000845800'
  8729                 CONTINUE
  8730              ELSE
  8731                 GO TO 0250-READ-CERT-MASTER
  8732              END-IF
  8733           ELSE
  8734              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8735                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8736                    (CF-FOURTH-AGENT = '0000681700')
  8737                    CONTINUE
  8738                 ELSE
  8739                    GO TO 0250-READ-CERT-MASTER
  8740                 END-IF
  8741              ELSE
  8742                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8743                    IF CI-ACCOUNT = '0001107200'
  8744                       CONTINUE
  8745                    ELSE
  8746                       GO TO 0250-READ-CERT-MASTER
  8747                    END-IF
  8748                 END-IF
  8749              END-IF
  8750           END-IF
  8751        END-IF
  8752     END-IF
  8753
  8754******************************************************
  8755     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8756
  8757 0299-READ-CERT-X.
  8758     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 171
* ECS010.cbl
  8760******************************************************************
  8761***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8762******************************************************************
  8763
  8764 0300-READ-PENDING-TRANSACTIONS.
  8765
  8766     READ PENDING-EXTRACT
  8767                   AT END GO TO 9910-EOJ-1.
  8768
  8769     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8770
  8771     IF NOT ED-PENDING-BUSINESS  AND
  8772        NOT ED-PENDING-CLAIMS  AND
  8773        NOT ED-CERT-CHANGES
  8774           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8775                                               ED-RECORD-TYPE
  8776           MOVE 0301                        TO WS-ABEND-CODE
  8777           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8778           GO TO ABEND-PGM.
  8779
  8780     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8781
  8782     IF DTE-CLIENT = 'NCL'
  8783         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8784             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8785                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8786             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8787
  8788     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8789         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8790         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8791         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8792         MOVE 0603                    TO WS-ABEND-CODE
  8793         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8794         GO TO ABEND-PGM.
  8795
  8796     ADD +1 TO TR-CNT.
  8797
  8798     IF ISSUE-TRANSACTION   OR
  8799        CANCEL-TRANSACTION  OR
  8800        CLAIM-TRANSACTION   OR
  8801        RESERVE-TRANSACTION OR
  8802        UPDATE-TRANSACTION
  8803         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8804         GO TO 0330-MATCH-PENDING-TO-CERT.
  8805
  8806     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8807
  8808     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8809     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8810             PENDING-RECORD-TYPE ')'.
  8811
  8812     MOVE 0301                   TO WS-ABEND-CODE.
  8813     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8814     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 172
* ECS010.cbl
  8816 0310-SET-UP-MATCHING-KEY.
  8817
  8818     IF ED-PENDING-BUSINESS
  8819         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8820         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8821         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8822         MOVE PB-STATE           TO PEND-MATCH-STATE
  8823         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8824         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8825         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8826         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8827
  8828     IF ED-PENDING-CLAIMS
  8829         ADD +1                  TO W-PENDING-CLMS
  8830         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8831         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8832         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8833         MOVE PC-STATE           TO PEND-MATCH-STATE
  8834         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8835         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8836         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8837         IF PC-CLAIMS
  8838             MOVE '3'            TO PENDING-RECORD-TYPE
  8839         ELSE
  8840             IF PC-RESERVES
  8841                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8842
  8843     IF ED-CERT-CHANGES
  8844         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8845         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8846         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8847         MOVE CC-STATE           TO PEND-MATCH-STATE
  8848         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8849         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8850         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8851         MOVE '5'                TO PENDING-RECORD-TYPE.
  8852
  8853     MOVE ' '                    TO DC-OPTION-CODE.
  8854     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8855     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8856
  8857 0310-EXIT.
  8858     EXIT.
  8859
  8860******************************************************************
  8861***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8862******************************************************************
  8863
  8864 0330-MATCH-PENDING-TO-CERT.
  8865
  8866     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8867         GO TO 0390-CERT-MISMATCH-ERROR.
  8868
  8869     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8870*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8871       IF CLAIM-TRANSACTION
  8872*         DISPLAY ' CLAIM '
  8873         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 173
* ECS010.cbl
  8874            NOT PC-NON-CHARGEBLE-EXPENSE
  8875             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8876                                      OR
  8877                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8878                  GO TO 0390-CERT-MISMATCH-ERROR.
  8879
  8880     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8881       IF RESERVE-TRANSACTION
  8882*         DISPLAY ' RESV '
  8883         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8884                                  OR
  8885            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8886              GO TO 0390-CERT-MISMATCH-ERROR.
  8887
  8888     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8889         IF ISSUE-TRANSACTION
  8890*           DISPLAY ' ISSUE '
  8891             GO TO 0380-DUPLICATE-CERT-ERROR
  8892         ELSE
  8893             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8894
  8895     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8896         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8897         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8898                                               0299-READ-CERT-X
  8899         GO TO 0330-MATCH-PENDING-TO-CERT.
  8900
  8901     IF ISSUE-TRANSACTION
  8902         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8903     ELSE
  8904         GO TO 0390-CERT-MISMATCH-ERROR.
  8905
  8906 0350-MATCH-PENDING-TO-ACCOUNT.
  8907
  8908     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8909       ADD +1  TO ERROR-COUNT
  8910         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8911           TO  DL-FULL
  8912             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8913         MOVE    ' PENDING CONTROL = '
  8914           TO  DIS-LINE-REASON
  8915         MOVE  PENDING-MATCH-CONTROL
  8916           TO  DIS-LINE-REC
  8917             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8918         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8919           TO  DIS-LINE-REASON
  8920         MOVE  PENDING-MATCH-CONTROL
  8921           TO  DIS-LINE-REC
  8922             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8923         MOVE  SPACES
  8924           TO  DISPLAY-LINE
  8925             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8927         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8928         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8929         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8930         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8931         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8932         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 174
* ECS010.cbl
  8933         AM-MSTR-CNTRL AM-EFFECT-DT
  8934         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID' OR 'AHL'
  8935            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8936            GO TO 0300-READ-PENDING-TRANSACTIONS
  8937         ELSE
  8938            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8939                                      TO WS-ABEND-MESSAGE
  8940            MOVE 0302 TO WS-ABEND-CODE
  8941            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8942            GO TO ABEND-PGM.
  8943
  8944     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8945         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8946                                              0199-READ-ACCOUNT-X
  8947         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8948
  8949     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8950        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8951         GO TO 0500-APPLY-PENDING-BUSINESS.
  8952
  8953     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8954                                       0199-READ-ACCOUNT-X.
  8955     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8956
  8957
  8958 0370-ACCOUNT-MISMATCH-ERROR.
  8959
  8960     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8961     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8962     MOVE 'MISMATCH ACCOUNT ERROR'
  8963                               TO WS-ABEND-MESSAGE.
  8964     MOVE 0302 TO WS-ABEND-CODE.
  8965         DISPLAY '******************************'
  8966         DISPLAY '***** ERROR LOCATION 009 *****'
  8967         DISPLAY '******************************'
  8968     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8969     GO TO ABEND-PGM.
  8970
  8971
  8972 0380-DUPLICATE-CERT-ERROR.
  8973
  8974     IF PB-I-OB  OR  PB-I-SUMMARY
  8975         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8976
  8977     ADD +1 TO DUP-CNT.
  8978
  8979     IF DUP-CNT NOT GREATER THAN DUP-MAX
  8980         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  8981         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  8982                                         PB-I-LF-ALT-PREMIUM-AMT
  8983         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  8984         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  8985         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8986
  8987     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  8988     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8989
  8990*    MOVE 0301 TO WS-ABEND-CODE.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 175
* ECS010.cbl
  8991*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8992*    GO TO ABEND-PGM.
  8993
  8994
  8995 0390-CERT-MISMATCH-ERROR.
  8996
  8997     IF ISSUE-TRANSACTION  OR
  8998        CANCEL-TRANSACTION  OR
  8999        CLAIM-TRANSACTION
  9000         ADD +1                  TO  MISMATCH-COUNT.
  9001
  9002     IF DTE-CLIENT  =  'CID'  OR  'CSO' OR 'AHL'
  9003       ADD  +1  TO  ERROR-COUNT
  9004         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  9005           TO  DL-FULL
  9006             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9007         MOVE    ' TRANS CONTROL = '
  9008           TO  DIS-LINE-REASON
  9009         MOVE  PENDING-MATCH-CONTROL
  9010           TO  DIS-LINE-REC
  9011             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9012         MOVE    ' TRANS TYPE    = '
  9013           TO  DIS-LINE-REASON
  9014         MOVE  PENDING-RECORD-TYPE
  9015           TO  DIS-LINE-REC
  9016             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9017         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  9018           TO  DL-FULL
  9019             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9020         MOVE    ' CERT IN CTL   = '
  9021           TO  DIS-LINE-REASON
  9022         MOVE  CIR-CONTROL
  9023           TO  DIS-LINE-REC
  9024             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9025         MOVE    ' BYPASSED TRANS  = '
  9026           TO  DIS-LINE-REASON
  9027         MOVE  PENDING-MATCH-CONTROL
  9028           TO  DIS-LINE-REC
  9029             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9030         MOVE  SPACES
  9031           TO  DISPLAY-LINE
  9032             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9033         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  9034
  9035     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  9036     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  9037
  9038     IF ISSUE-TRANSACTION
  9039         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  9040     ELSE
  9041         IF CANCEL-TRANSACTION
  9042             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  9043         ELSE
  9044             IF CLAIM-TRANSACTION
  9045                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  9046             ELSE
  9047                 IF RESERVE-TRANSACTION
  9048                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 176
* ECS010.cbl
  9049                 ELSE
  9050                     IF UPDATE-TRANSACTION
  9051                         MOVE 'CHG'
  9052                                 TO  DTL-REC-TYPE-DESC.
  9053
  9054     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  9055     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  9056     MOVE 'DROPPED'              TO  DTL-STATUS.
  9057
  9058     IF ISSUE-TRANSACTION
  9059         MOVE PB-I-LF-PREMIUM-AMT
  9060                                 TO  MD2-LF-PREM
  9061         MOVE PB-I-LF-ALT-PREMIUM-AMT
  9062                                 TO  MD2-LF-ALT-PREM
  9063         MOVE PB-I-AH-PREMIUM-AMT
  9064                                 TO  MD2-AH-PREM
  9065         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  9066         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  9067         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  9068     ELSE
  9069         IF CANCEL-TRANSACTION
  9070             MOVE PB-C-LF-CANCEL-AMT
  9071                                 TO  MD3-LF-REFUND
  9072             MOVE PB-C-AH-CANCEL-AMT
  9073                                 TO  MD3-AH-REFUND
  9074             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  9075             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  9076         ELSE
  9077             IF CLAIM-TRANSACTION
  9078                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9079                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  9080                     MOVE ZEROS             TO MD4-AH-CLAIM
  9081                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  9082                 ELSE
  9083                     MOVE ZEROS             TO MD4-LF-CLAIM
  9084                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  9085                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  9086
  9087     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  9088         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  9089         MOVE MISMATCH-PAGE-NUMBER
  9090                                 TO  TR-PG
  9091         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  9092         MOVE MR-CTL             TO  X
  9093         MOVE X TO LCP-ASA
  9094         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9095             THRU LCP-WRITE-END-MISMATCH-RPT
  9096         MOVE TR-HD-2            TO  MISMATCH-RPT
  9097         MOVE MR-CTL             TO  X
  9098         MOVE X TO LCP-ASA
  9099         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9100             THRU LCP-WRITE-END-MISMATCH-RPT
  9101         MOVE TR-HD-3            TO  MISMATCH-RPT
  9102         MOVE MR-CTL             TO  X
  9103         MOVE X TO LCP-ASA
  9104         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9105             THRU LCP-WRITE-END-MISMATCH-RPT
  9106         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 177
* ECS010.cbl
  9107         MOVE MR-CTL             TO  X
  9108         MOVE X TO LCP-ASA
  9109         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9110             THRU LCP-WRITE-END-MISMATCH-RPT
  9111         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  9112
  9113     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  9114     MOVE MR-CTL                 TO  X.
  9115     ADD +2                      TO  MISMATCH-LINE-COUNT.
  9116
  9117     MOVE X TO LCP-ASA
  9118     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9119         THRU LCP-WRITE-END-MISMATCH-RPT.
  9120
  9121     IF ISSUE-TRANSACTION
  9122         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  9123         MOVE MR-CTL             TO  X
  9124         ADD +1                  TO  MISMATCH-LINE-COUNT
  9125         MOVE X TO LCP-ASA
  9126         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9127             THRU LCP-WRITE-END-MISMATCH-RPT.
  9128
  9129     IF CANCEL-TRANSACTION
  9130         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  9131         MOVE MR-CTL             TO  X
  9132         ADD +1                  TO  MISMATCH-LINE-COUNT
  9133         MOVE X TO LCP-ASA
  9134         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9135             THRU LCP-WRITE-END-MISMATCH-RPT.
  9136
  9137     IF CLAIM-TRANSACTION
  9138         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  9139         MOVE MR-CTL             TO  X
  9140         ADD +1                  TO  MISMATCH-LINE-COUNT
  9141         MOVE X TO LCP-ASA
  9142         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9143             THRU LCP-WRITE-END-MISMATCH-RPT.
  9144
  9145     MOVE SPACES                 TO  MISMATCH-RPT.
  9146
  9147     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9148
  9149 0395-GET-CERT-TRLRS.
  9150
  9151     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  9152     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  9153     MOVE CR-CARRIER             TO CS-CARRIER
  9154     MOVE CR-GROUPING            TO CS-GROUPING
  9155     MOVE CR-STATE               TO CS-STATE
  9156     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  9157     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  9158     MOVE CR-CERT-NO             TO CS-CERT-NO
  9159     MOVE 'A'                    TO CS-TRAILER-TYPE
  9160
  9161     READ ELCRTT
  9162
  9163     IF ELCRTT-FILE-STATUS = '00'
  9164        MOVE CS-BANK-COMMISSION-AREA
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 178
* ECS010.cbl
  9165                                 TO WS-BANK-COMMISSIONS
  9166     ELSE
  9167        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  9168           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  9169           PERFORM ABEND-PGM
  9170        END-IF
  9171     END-IF
  9172
  9173     .
  9174 0395-EXIT.
  9175     EXIT.
  9176
  9177******************************************************************
  9178***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  9179******************************************************************
  9180
  9181 0400-WRITE-CERT-RECORD.
  9182*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  9183
  9184     IF CERTIFICATE-RECORD = LOW-VALUES
  9185         GO TO 0499-WRITE-CERT-X.
  9186
  9187     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  9188         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  9189         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL (1:19)
  9190            ' ' cr-dt ' ' cr-cert-no
  9191         ADD  +1  TO  ERROR-COUNT
  9192         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  9193           TO  DL-FULL
  9194             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9195         MOVE    ' CERT. CONTROL = '
  9196           TO  DIS-LINE-REASON
  9197         MOVE  CR-FULL-CONTROL
  9198           TO  DIS-LINE-REC
  9199             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9200         MOVE  SPACES
  9201           TO  DISPLAY-LINE
  9202             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9203            if dte-pgm-opt = '1'
  9204               WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9205               ADD +1 TO CMOT-CNT
  9206            end-if
  9207            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  9208                                 thru 0299-READ-CERT-X
  9209               GO TO 0400-WRITE-CERT-RECORD.
  9210
  9211*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  9212
  9213     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  9214         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9215                                              0199-READ-ACCOUNT-X
  9216         GO TO 0400-WRITE-CERT-RECORD.
  9217
  9218     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  9219        CR-DT NOT LESS THAN AM-EXPIRE-DT
  9220         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9221                                              0199-READ-ACCOUNT-X
  9222         GO TO 0400-WRITE-CERT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 179
* ECS010.cbl
  9223
  9224*     DISPLAY ' BEFORE REIN '
  9225     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9226*     DISPLAY ' AFTER REIN '
  9227
  9228     IF CR-LFTYP = ZEROS  AND
  9229        CR-DTHEXP NOT = ZEROS
  9230         ADD +1                     TO W-LFTYP-99
  9231         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  9232         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9233
  9234     IF CR-AHTYP = ZEROS  AND
  9235        CR-DISEXP NOT = ZEROS
  9236         ADD +1                     TO W-AHTYP-99
  9237         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  9238         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9239
  9240*     DISPLAY ' BEFORE EP BUMP'
  9241     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  9242*     DISPLAY ' AFTER EP BUMP'
  9243
  9244      if (dte-client = 'DCC')
  9245         and (ws-dcc-cnc-flag = 'Y')
  9246         write new-detail-extract
  9247      end-if
  9248
  9249     IF CR-LFTYP = '99'
  9250         MOVE '00'                  TO CR-LFTYP.
  9251     IF CR-AHTYP = '99'
  9252         MOVE '00'                  TO CR-AHTYP.
  9253
  9254*    IF CR-ISS-MICROFILM-NO NOT NUMERIC
  9255*        MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
  9256
  9257     IF CR-NH-INT-ON-REF NOT NUMERIC
  9258         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  9259     END-IF
  9260
  9261     IF  CR-POLICY-IS-ACTIVE
  9262         ADD +1                  TO W-POLICY-ACTIVE-CTR
  9263         IF  CR-POLICY-IS-REISSUE
  9264             OR CR-POLICY-IS-MONTHLY
  9265             ADD +1              TO W-POLICY-REISSUE-CTR
  9266         ELSE
  9267             IF  CR-POLICY-IS-REIN-ONLY
  9268                 ADD +1          TO W-POLICY-REIN-CTR
  9269             ELSE
  9270                 NEXT SENTENCE
  9271     ELSE
  9272         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  9273
  9274     IF DTE-PGM-OPT = '1'
  9275       IF REIN-IS-RISK-PREMIUM  AND
  9276          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  9277         IF NOT CR-POLICY-IS-REISSUE  AND
  9278            NOT CR-POLICY-IS-DECLINED  AND
  9279            NOT CR-POLICY-IS-VOID
  9280            AND NOT CR-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 180
* ECS010.cbl
  9281             MOVE '*'            TO RISK-PREM-FLAG
  9282             PERFORM 3100-REINSURE-ISSUE THRU
  9283                     3199-REINSURE-ISSUE-X.
  9284
* 9285     COPY ELCCRTM2.
  9286******************************************************************04/16/98
  9287*                                                                *ELCCRTM2
  9288*                                                                *ELCCRTM2
  9289*                            ELCCRTM2                            *   LV004
  9290*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9291*                            VMOD=2.001                          *ELCCRTM2
  9292*                                                                *ELCCRTM2
  9293*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  9294*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  9295*                                                                *ELCCRTM2
  9296******************************************************************ELCCRTM2
  9297     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  9298     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  9299     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  9300     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  9301     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  9302     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  9303                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  9304     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  9305     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  9306     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  9307     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  9308                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  9309     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  9310     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  9311     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  9312     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  9313     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  9314                                                                     CL**4
  9315     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  9316                UNTIL COPY-NDX > 5                                   CL**4
  9317           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  9318                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  9319     END-PERFORM.                                                 ELCCRTM2
  9320                                                                  ELCCRTM2
  9321
  9322     IF DTE-PGM-OPT = '1'
  9323         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9324         ADD +1 TO CMOT-CNT.
  9325
  9326     move zeros                  to ueclp-clp-fact
  9327     MOVE SPACE                  TO REIN-FLG WS-DCC-CNC-FLAG
  9328                                    RISK-REIN-FLAG
  9329                                    RISK-PREM-FLAG
  9330                                    RC-COMM-FLG.
  9331
  9332 0499-WRITE-CERT-X.
  9333     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 181
* ECS010.cbl
  9335******************************************************************
  9336***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  9337******************************************************************
  9338
  9339 0500-APPLY-PENDING-BUSINESS.
  9340
  9341     IF CANCEL-TRANSACTION
  9342*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  9343         GO TO 0600-PROCESS-CANCELLATIONS.
  9344
  9345     IF CLAIM-TRANSACTION
  9346*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  9347         GO TO 0700-PROCESS-CLAIMS.
  9348
  9349     IF RESERVE-TRANSACTION
  9350*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  9351         GO TO 0800-PROCESS-RESERVES.
  9352
  9353     IF UPDATE-TRANSACTION
  9354*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  9355         GO TO 0900-PROCESS-CERT-CHANGES.
  9356
  9357******************************************************************
  9358***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  9359******************************************************************
  9360
  9361 0505-PROCESS-ISSUES.
  9362
  9363     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  9364     PERFORM CERT-DATE-LOAD.
  9365
  9366     ADD +1                      TO  W-POL-ISSUES.
  9367
  9368     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  9369     MOVE PB-CARRIER             TO  CR-CARRIER.
  9370     MOVE PB-GROUPING            TO  CR-GROUPING.
  9371     MOVE PB-STATE               TO  CR-STATE.
  9372     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  9373     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  9374                                     WS-CR-BIN-DATE
  9375     MOVE ' '                    TO  DC-OPTION-CODE.
  9376     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9377     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  9378                                     WS-CR-DT-N.
  9379     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  9380
  9381*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  9382     MOVE PB-I-NAME              TO  CR-NAME.
  9383     MOVE PB-I-AGE               TO  CR-AGE.
  9384     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  9385     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  9386
  9387     IF PB-I-JOINT-COVERAGE
  9388         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  9389         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  9390     ELSE
  9391        IF (DTE-CLIENT EQUAL 'BOA')  AND
  9392           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 182
* ECS010.cbl
  9393             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  9394
  9395     IF PB-I-SUMMARY  OR
  9396        DTE-CLIENT = 'DMD'
  9397         MOVE PB-I-LIVES         TO  CR-LIVES.
  9398
  9399     IF PB-I-NUM-BILLED NOT NUMERIC
  9400        MOVE ZEROS               TO PB-I-NUM-BILLED.
  9401
  9402     IF PB-I-STATE-TAX NOT NUMERIC
  9403        MOVE ZEROS               TO PB-I-STATE-TAX.
  9404
  9405     IF PB-I-MUNI-TAX NOT NUMERIC
  9406        MOVE ZEROS               TO PB-I-MUNI-TAX.
  9407     IF PB-I-TOT-FEES NOT NUMERIC
  9408        MOVE ZEROS               TO PB-I-TOT-FEES
  9409     END-IF
  9410     IF PB-I-ADDL-CLP NOT NUMERIC
  9411        MOVE ZEROS               TO PB-I-ADDL-CLP
  9412     END-IF
  9413
  9414     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  9415     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  9416     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  9417     MOVE PB-I-LF-CLP            TO  CR-LF-CLP
  9418     MOVE PB-I-AH-CLP            TO  CR-AH-CLP
  9419     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  9420     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  9421     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  9422     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  9423     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  9424     MOVE PB-I-LOAN-APR          TO  CR-APR.
  9425     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  9426     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  9427
  9428     IF PB-I-RATE-CLASS-OVRD = SPACES
  9429         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  9430     ELSE
  9431         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  9432
  9433     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  9434     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  9435
  9436     IF PB-I-INDV-GRP-OVRD = SPACES
  9437         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  9438     ELSE
  9439         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  9440
  9441     IF CR-IND-GRP = 'I'  OR  '1'
  9442         MOVE '1'                TO  CR-IND-GRP
  9443     ELSE
  9444         MOVE '2'                TO  CR-IND-GRP.
  9445
  9446     IF PB-I-SKIP-CODE = '1'
  9447         MOVE 01                 TO  CR-SKIP.
  9448     IF PB-I-SKIP-CODE = '2'
  9449         MOVE 02                 TO  CR-SKIP.
  9450     IF PB-I-SKIP-CODE = '3'
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 183
* ECS010.cbl
  9451         MOVE 03                 TO  CR-SKIP.
  9452     IF PB-I-SKIP-CODE = '4'
  9453         MOVE 04                 TO  CR-SKIP.
  9454     IF PB-I-SKIP-CODE = '5'
  9455         MOVE 05                 TO  CR-SKIP.
  9456     IF PB-I-SKIP-CODE = '6'
  9457         MOVE 06                 TO  CR-SKIP.
  9458     IF PB-I-SKIP-CODE = '7'
  9459         MOVE 07                 TO  CR-SKIP.
  9460     IF PB-I-SKIP-CODE = '8'
  9461         MOVE 08                 TO  CR-SKIP.
  9462     IF PB-I-SKIP-CODE = '9'
  9463         MOVE 09                 TO  CR-SKIP.
  9464     IF PB-I-SKIP-CODE = 'A'
  9465         MOVE 10                 TO  CR-SKIP.
  9466     IF PB-I-SKIP-CODE = 'X'
  9467         MOVE 11                 TO  CR-SKIP.
  9468
  9469     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  9470     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  9471     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  9472
  9473     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  9474         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  9475                                        REIN-SPEC-A
  9476                                        REIN-SPEC-B
  9477                                        REIN-SPEC-C
  9478         MOVE REIN-SPEC          TO CR-REIN-TABLE
  9479     ELSE
  9480         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  9481
  9482     IF DTE-CLIENT = 'DCC'
  9483        MOVE AM-DCC-PRODUCT-CODE TO CR-DCC-PRODUCT-CODE
  9484        IF CR-DCC-PRODUCT-CODE = 'DDF'
  9485           MOVE PB-I-DDF-IU-RATE-UP TO CR-DDF-IU-RATE-UP
  9486        END-IF
  9487     END-IF
  9488
  9489     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  9490     MOVE ' '                    TO  DC-OPTION-CODE.
  9491     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9492     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  9493
  9494     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  9495
  9496     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  9497         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  9498     ELSE
  9499         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  9500
  9501     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  9502         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  9503
  9504     IF PB-BATCH-ENTRY = SPACE  OR
  9505        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  9506         MOVE '1'                TO  CR-ENTRY-STATUS
  9507     ELSE
  9508         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 184
* ECS010.cbl
  9509
  9510     IF PB-POLICY-IS-DECLINED
  9511         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9512
  9513     IF PB-POLICY-IS-VOIDED
  9514         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9515
  9516***  IF DTE-CLIENT NOT = 'CRI'
  9517***      IF PB-I-PREM-ACCTNG-ONLY
  9518***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9519
  9520     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9521                                     WS-CR-ENTRY-DATE-N.
  9522
  9523*    IF PB-I-MICROFILM-NO NUMERIC
  9524*        MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
  9525
  9526     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9527        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9528        OR 'AHL'
  9529         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9530     END-IF
  9531
  9532*************************************************
  9533***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9534***  WAS CONVERTED TO 1056 BYTES.             ***
  9535*************************************************
  9536     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9537     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9538
  9539     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9540
  9541     MOVE CR-STATE               TO STATE-L.
  9542
  9543     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9544
  9545     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9546
  9547***************************************************
  9548***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9549***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9550***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9551***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9552***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9553***************************************************
  9554     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9555         IF CR-LF-POLICY-IS-RESTORE
  9556             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9557             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9558         ELSE
  9559         IF CR-LF-POLICY-IS-REISSUE
  9560             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9561             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9562         ELSE
  9563         IF CR-LF-IS-REIN-ONLY
  9564             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9565             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9566         ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 185
* ECS010.cbl
  9567         IF CR-LF-IS-DECLINED
  9568             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9569             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9570         ELSE
  9571         IF CR-LF-IS-VOID
  9572             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9573             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9574         ELSE
  9575         IF CR-LF-POLICY-IS-MONTHLY
  9576            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9577            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9578
  9579
  9580 0510-PROCESS-LIFE-ISSUE.
  9581
  9582     IF PB-INVALID-LIFE
  9583         GO TO 0520-PROCESS-A-H-ISSUE.
  9584
  9585     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9586     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9587     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9588
  9589     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9590     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9591     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9592     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9593     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9594     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9595
  9596     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9597     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9598     IF PB-I-LF-POLICY-FEE  NUMERIC
  9599         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9600     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9601     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9602
  9603     IF PB-I-LF-PREM-TAX NUMERIC
  9604        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9605     END-IF
  9606
  9607
  9608     IF PB-I-LF-REI-RATE NOT = ZEROS
  9609        IF DTE-CLIENT = 'DCC'
  9610           CONTINUE
  9611*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9612        ELSE
  9613           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9614           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9615                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9616        END-IF
  9617     END-IF
  9618
  9619     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9620         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9621         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9622         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9623         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9624         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 186
* ECS010.cbl
  9625             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9626                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9627
  9628     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9629     MOVE ' '                    TO  DC-OPTION-CODE.
  9630     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9631     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9632                                     WS-CR-LF-EXPIRE-DATE-N.
  9633
  9634     IF CR-ENTRY-STATUS = 'P'
  9635         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9636     ELSE
  9637         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9638
  9639     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9640     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9641     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9642     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9643     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9644
  9645     IF CR-LF-POLICY-IS-RESTORE
  9646         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9647     IF CR-LF-POLICY-IS-REISSUE
  9648         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9649     IF CR-LF-IS-REIN-ONLY
  9650         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9651
  9652     IF CR-LF-IS-DECLINED
  9653         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9654
  9655     IF CR-LF-IS-VOID
  9656         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9657     IF CR-LF-POLICY-IS-MONTHLY
  9658         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9659
  9660     ADD +1                      TO  W-LF-ISSUES.
  9661
  9662 0520-PROCESS-A-H-ISSUE.
  9663
  9664     IF PB-INVALID-AH
  9665         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9666
  9667     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9668     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9669     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9670
  9671     IF (NOT PB-I-JOINT-COVERAGE)
  9672        AND (CLAS-I-JOINT (CLAS-INDEXA) = 'J')
  9673        MOVE PB-I-JOINT-INSURED  TO CR-JOINT-NAME
  9674        MOVE PB-I-JOINT-AGE      TO CR-JOINT-AGE
  9675     END-IF
  9676
  9677     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9678     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9679     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9680     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9681     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9682
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 187
* ECS010.cbl
  9683     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9684     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9685     IF PB-I-AH-POLICY-FEE  NUMERIC
  9686         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9687     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9688     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9689
  9690     IF PB-I-AH-PREM-TAX NUMERIC
  9691        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9692     END-IF
  9693
  9694     IF PB-I-AH-REI-RATE NOT = ZEROS
  9695        IF DTE-CLIENT = 'DCC'
  9696           CONTINUE
  9697        ELSE
  9698           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9699           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9700             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9701        END-IF
  9702     END-IF
  9703
  9704     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9705        IF (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9706           MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9707           MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9708        END-IF
  9709        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9710     END-IF
  9711     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9712     MOVE ' '                    TO  DC-OPTION-CODE.
  9713     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9714     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9715                                     WS-CR-AH-EXPIRE-DATE-N.
  9716
  9717     IF CR-ENTRY-STATUS = 'P'
  9718         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9719     ELSE
  9720         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9721
  9722     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9723     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9724     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9725     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9726     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9727
  9728     IF CR-AH-POLICY-IS-RESTORE
  9729         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9730     IF CR-AH-POLICY-IS-REISSUE
  9731         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9732     IF CR-AH-IS-REIN-ONLY
  9733         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9734
  9735     IF CR-AH-IS-DECLINED
  9736         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9737
  9738     IF CR-AH-IS-VOID
  9739         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9740     IF CR-AH-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 188
* ECS010.cbl
  9741         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9742
  9743     ADD +1                      TO  W-AH-ISSUES.
  9744
  9745 0530-PROCESS-ISSUE-CONTINUED.
  9746
  9747     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9748     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9749     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9750     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9751
  9752     IF (DTE-CLIENT = 'DCC')
  9753        AND (CR-AHTYP NOT = '00' AND '  ')
  9754        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9755        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9756           PERFORM 0920-GET-BANK-FEES
  9757                                 THRU 0920-EXIT
  9758           PERFORM 0930-BUILD-CERT-TRLR
  9759                                 THRU 0930-EXIT
  9760           PERFORM 0395-GET-CERT-TRLRS
  9761                                 THRU 0395-EXIT
  9762     END-IF
  9763
  9764     IF DTE-CLIENT = 'DCC'
  9765        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
  9766           MOVE CR-LF-CLP        TO CR-LF-NSP-PRM
  9767        END-IF
  9768        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9769           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9770              (CR-LFPRM + CR-LFPRM-ALT) -
  9771              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9772        END-IF
  9773     END-IF
  9774
  9775     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9776        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9777        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9778     ELSE
  9779        IF DTE-CLIENT = 'DCC'
  9780           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
  9781              OR (AM-DCC-PRODUCT-CODE = 'DDF')
  9782              MOVE CR-AH-CLP        TO CR-AH-NSP-PRM
  9783           END-IF
  9784           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9785              COMPUTE CR-AH-NSP-PRM ROUNDED = CR-AHPRM -
  9786              (CR-AHPRM * CR-LCOM-AH (1))
  9787           END-IF
  9788        END-IF
  9789     END-IF
  9790
  9791     IF DTE-CLIENT = 'DCC'
  9792         IF PB-I-VIN > SPACES
  9793             PERFORM 0950-BUILD-CERT-C-TRLR THRU 0950-EXIT
  9794         END-IF
  9795     END-IF.
  9796
  9797     IF CR-ENTRY-STATUS = 'P'
  9798         MOVE '1'                   TO CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 189
* ECS010.cbl
  9799
  9800     IF CR-POLICY-IS-REISSUE  OR
  9801        CR-POLICY-IS-REIN-ONLY OR
  9802        CR-POLICY-IS-DECLINED OR
  9803        CR-POLICY-IS-VOID
  9804        OR CR-POLICY-IS-MONTHLY
  9805         GO TO 0590-END-ISSUE-PROCESSING.
  9806
  9807     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9808     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9809        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9810     END-IF
  9811     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9812
  9813     IF NOT PB-INVALID-LIFE
  9814         COMPUTE H-LFCM ROUNDED =
  9815                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9816         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9817         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9818
  9819     IF NOT PB-INVALID-AH
  9820        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9821           IF AM-DCC-PRODUCT-CODE NOT = 'DDF'
  9822              COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9823              + CR-ADDL-CLP)
  9824           ELSE
  9825              COMPUTE H-AHCM ROUNDED = CR-AHPRM - CR-AH-CLP
  9826              - CR-ADDL-CLP
  9827           END-IF
  9828        ELSE
  9829           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9830        END-IF
  9831        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9832        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9833     END-IF
  9834
  9835     ADD +1 TO BC-G-ISS.
  9836     ADD +1 TO BC-COMM.
  9837     ADD CR-LFPRM TO BC-NET-WRIT.
  9838     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9839        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9840     END-IF
  9841     ADD CR-AHPRM TO BC-NET-WRIT.
  9842
  9843     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9844        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9845        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9846     ELSE
  9847        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9848        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9849           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9850        END-IF
  9851     END-IF
  9852
  9853     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9854         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9855     ELSE
  9856         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 190
* ECS010.cbl
  9857
  9858 0590-END-ISSUE-PROCESSING.
  9859
  9860     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9861
  9862     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9863
  9864     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9865        NOT CR-POLICY-IS-DECLINED  AND
  9866        NOT CR-POLICY-IS-VOID
  9867         MOVE 'Y' TO BILLED-SWITCH
  9868         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9869         IF DTE-CLIENT = 'DCC'
  9870            move detail-extract  to new-detail-extract
  9871            IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9872               compute dx-a-pc (1) = cr-ahprm - cr-lfprm-alt -
  9873                  cr-addl-clp
  9874            end-if
  9875            write new-detail-extract
  9876         end-if
  9877
  9878     IF NOT CR-POLICY-IS-REISSUE  AND
  9879        NOT CR-POLICY-IS-DECLINED  AND
  9880        NOT CR-POLICY-IS-VOID
  9881        AND NOT CR-POLICY-IS-MONTHLY
  9882         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9883
  9884     MOVE '*'                   TO TRANSACTION-FLAG.
  9885     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 191
* ECS010.cbl
  9887******************************************************************
  9888***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9889******************************************************************
  9890
  9891 0600-PROCESS-CANCELLATIONS.
  9892
  9893*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
  9894     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9895
  9896     IF AM-RECALC-COMM = ('Y' OR '1')
  9897        PERFORM 1600-RECALC-COMM-EXTR
  9898                                 THRU 1899-RECALC-COMM-EXTR-X
  9899        MOVE ' '                 TO RECALC-TYPE
  9900     END-IF
  9901
  9902     MOVE CR-LFRFND               TO LIFE-REFUND.
  9903     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9904     MOVE CR-AHRFND               TO A-H-REFUND.
  9905     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9906     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9907
  9908     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9909     IF CR-LFRFND NOT = ZEROS
  9910        IF CR-LFRFND-CALC = ZEROS
  9911           MOVE PB-C-LF-REF-CALC TO CR-LFRFND-CALC
  9912                                    LIFE-REFUND-CALC
  9913        ELSE
  9914           MOVE PB-C-LF-CANCEL-AMT TO CR-LFRFND-CALC
  9915        END-IF
  9916     END-IF
  9917
  9918     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9919
  9920     IF CR-AHRFND-CALC = ZEROS
  9921        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9922                                    A-H-REFUND-CALC
  9923     ELSE
  9924        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
  9925     END-IF
  9926
  9927     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
  9928        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
  9929     ELSE
  9930        MOVE SPACES              TO CR-POST-CARD-IND
  9931     END-IF
  9932
  9933*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9934*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9935*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9936*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9937
  9938     IF PB-C-NH-INT-ON-REFS NUMERIC
  9939        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
  9940        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
  9941     END-IF
  9942     MOVE PB-C-CANCEL-REASON      TO CR-CANCEL-REASON
  9943
  9944     IF PB-CI-STATE-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 192
* ECS010.cbl
  9945        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9946
  9947     IF PB-CI-MUNI-TAX NOT NUMERIC
  9948        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  9949
  9950     IF CR-CANCEL-STATE-TAX NUMERIC
  9951         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9952       ELSE
  9953         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9954
  9955     IF CR-CANCEL-MUNI-TAX NUMERIC
  9956         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9957       ELSE
  9958         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9959
  9960     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9961                                    MONTHS-DIFF-AH.
  9962
  9963     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9964
  9965 0630-PROCESS-LIFE-CANCEL.
  9966
  9967     IF CR-LFTYP = ZERO  OR
  9968        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9969         MOVE ZEROS               TO H-LFCM
  9970         GO TO 0650-PROCESS-A-H-CANCEL.
  9971
  9972     IF CR-LFRFND = +0
  9973        AND CR-DTHAMT > ZEROS
  9974        AND CR-LF-CLAIM-EXIT-DATE > ZEROS
  9975        MOVE ZEROS               TO H-LFCM
  9976        MOVE 'LFCNC DROP'        TO TRD-LF-ACTION
  9977        MOVE CR-LF-CURRENT-STATUS TO TRD-LF-STATUS
  9978        GO TO 0650-PROCESS-A-H-CANCEL
  9979     END-IF
  9980
  9981     IF DTE-CLIENT = 'DCC'
  9982        IF PB-C-LF-RFND-CLP NUMERIC
  9983           MOVE PB-C-LF-RFND-CLP TO CR-LF-RFND-CLP
  9984        END-IF
  9985     END-IF
  9986
  9987     IF PB-C-LF-PREM-TAX NUMERIC
  9988        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
  9989     END-IF
  9990     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
  9991     MOVE ' '                     TO  DC-OPTION-CODE.
  9992     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9993     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
  9994                                      WS-CR-LF-CANC-DT-N.
  9995
  9996
  9997     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
  9998     MOVE ' '                    TO DC-OPTION-CODE
  9999     PERFORM 8000-DATE-CONVERT-ROUTINE
 10000                                 THRU 8099-DATE-CONVERT-X
 10001     IF CR-LF-CNC-ENT-DT NOT NUMERIC
 10002        MOVE ZEROS TO CR-LF-CNC-ENT-DT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 193
* ECS010.cbl
 10003     END-IF
 10004     IF NO-CONVERSION-ERROR
 10005        IF CR-LF-CNC-ENT-DT = ZEROS
 10006           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
 10007        END-IF
 10008     END-IF
 10009
 10010     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10011     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
 10012     MOVE '1'                     TO  DC-OPTION-CODE.
 10013     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10014     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10015                                      DC-ODD-DAYS-OVER
 10016                                      DC-ELAPSED-DAYS.
 10017     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10018     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 10019
 10020     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 10021         ADD  +1                  TO  MONTHS-DIFF-LF.
 10022
 10023     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 10024
 10025     MOVE  ZEROS                  TO  SUB.
 10026
 10027 0635-LIFE-CHARGEBACK-LOOP.
 10028
 10029     ADD    +1                    TO  SUB.
 10030
 10031     IF  SUB  GREATER THAN  +10
 10032         GO TO  0640-CONTINUE-LIFE-CANCEL.
 10033
 10034*** ON A REPOSSESSION FOR DDF ON LMBA AND CSO ADMIN
 10035*** WE FULLY EARN THE FEE
 10036     IF CR-CANCEL-REASON = 'R'
 10037        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10038           AND (AM-COM-TYP (SUB) = 'L' OR 'N')
 10039           MOVE 'N'              TO WS-LF-CHARGEBACK-SW (SUB)
 10040           GO TO  0635-LIFE-CHARGEBACK-LOOP
 10041        END-IF
 10042     END-IF
 10043
 10044     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10045         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10046         GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10047
 10048     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10049         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 10050
 10051     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 10052         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 10053
 10054     GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10055
 10056
 10057 0640-CONTINUE-LIFE-CANCEL.
 10058
 10059     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10060        SUBTRACT +1 FROM MONTHS-DIFF-LF.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 194
* ECS010.cbl
 10061
 10062     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
 10063
 10064     IF DTE-CLIENT = 'GIC'
 10065         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 10066             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
 10067                                     LIFE-REFUND-CALC.
 10068
 10069*    IF DTE-CLIENT = 'TMS'
 10070     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
 10071
 10072     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 10073         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10074     ELSE
 10075         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
 10076             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
 10077             MOVE '8'                  TO CR-LF-CURRENT-STATUS
 10078             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
 10079             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
 10080                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10081         ELSE
 10082             IF CR-LF-CURRENT-STATUS = '6'
 10083                 MOVE '8'              TO CR-LF-CURRENT-STATUS
 10084                 MOVE PB-C-LF-COMM-CHARGEBACK
 10085                                       TO CR-LF-COMM-CHARGEBACK
 10086                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
 10087                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
 10088
 10089*************************************************
 10090***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10091***  WAS CONVERTED TO 1056 BYTES.             ***
 10092*************************************************
 10093     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
 10094
 10095     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10096     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10097     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
 10098
 10099     COMPUTE H-LFCM ROUNDED =
 10100                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
 10101     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
 10102
 10103     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
 10104     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
 10105     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
 10106     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
 10107
 10108     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
 10109     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10110
 10111 0650-PROCESS-A-H-CANCEL.
 10112
 10113     IF CR-AHTYP = ZERO  OR
 10114        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
 10115         MOVE ZEROS               TO H-AHCM
 10116         GO TO 0660-PROCESS-CANCEL-CONTINUE.
 10117
 10118*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 195
* ECS010.cbl
 10119*    MOVE 'L'                   TO  DC-OPTION-CODE.
 10120*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10121*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 10122
 10123     IF DTE-CLIENT = 'DCC'
 10124        IF PB-C-AH-RFND-CLP NUMERIC
 10125           MOVE PB-C-AH-RFND-CLP TO CR-AH-RFND-CLP
 10126        END-IF
 10127     END-IF
 10128
 10129     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
 10130     MOVE ' '                     TO  DC-OPTION-CODE.
 10131     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10132     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
 10133                                      WS-CR-AH-CANC-DT-N.
 10134
 10135     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10136     MOVE ' '                    TO DC-OPTION-CODE
 10137     PERFORM 8000-DATE-CONVERT-ROUTINE
 10138                                 THRU 8099-DATE-CONVERT-X
 10139     IF CR-AH-CNC-ENT-DT NOT NUMERIC
 10140        MOVE ZEROS TO CR-AH-CNC-ENT-DT
 10141     END-IF
 10142     IF NO-CONVERSION-ERROR
 10143        IF CR-AH-CNC-ENT-DT = ZEROS
 10144           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
 10145        END-IF
 10146     END-IF
 10147
 10148     IF PB-C-AH-PREM-TAX NUMERIC
 10149        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
 10150     END-IF
 10151     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10152     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
 10153     MOVE '1'                     TO  DC-OPTION-CODE.
 10154     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10155     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10156                                      DC-ODD-DAYS-OVER
 10157                                      DC-ELAPSED-DAYS.
 10158     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10159     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 10160
 10161     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
 10162          ADD  +1                 TO  MONTHS-DIFF-AH.
 10163
 10164     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 10165                                      WS-DCC-DDF-CB-LEVELS
 10166     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
 10167        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
 10168     END-IF
 10169*    IF DTE-CLIENT = 'DCC'
 10170*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10171*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
 10172*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 10173*             (CR-BANK-NO = CR-COM-AGT (SUB))
 10174*             OR (SUB > +10)
 10175*          END-PERFORM
 10176*          IF CR-BANK-NO = CR-COM-AGT (SUB)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 196
* ECS010.cbl
 10177*             MOVE CR-BANK-NOCHRGB-MONTHS
 10178*                                TO AM-COMM-CHARGEBACK (SUB)
 10179*          END-IF
 10180*       END-IF
 10181*    END-IF
 10182
 10183
 10184     MOVE 'Y'                     TO WS-FIRST-K
 10185     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
 10186     MOVE  ZEROS                  TO  SUB.
 10187
 10188 0653-A-H-CHARGEBACK-LOOP.
 10189
 10190     ADD    +1                    TO  SUB.
 10191
 10192     IF  SUB  GREATER THAN  +10
 10193         GO TO  0655-CONTINUE-A-H-CANCEL.
 10194
 10195     IF CR-CANCEL-REASON = 'R'
 10196        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10197           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 10198              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 10199              GO TO  0653-A-H-CHARGEBACK-LOOP
 10200           END-IF
 10201           IF AM-COM-TYP (SUB) = 'J'
 10202              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 10203              GO TO  0653-A-H-CHARGEBACK-LOOP
 10204           END-IF
 10205        END-IF
 10206     END-IF
 10207
 10208     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10209         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10210         GO TO  0653-A-H-CHARGEBACK-LOOP.
 10211
 10212     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10213         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 10214
 10215     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 10216         OR ((DTE-CLIENT = 'DCC')
 10217             AND (CR-AHRFND = ZEROS))
 10218         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
 10219
 10220     GO TO  0653-A-H-CHARGEBACK-LOOP.
 10221
 10222
 10223 0655-CONTINUE-A-H-CANCEL.
 10224
 10225     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10226        SUBTRACT +1 FROM MONTHS-DIFF-AH.
 10227
 10228     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
 10229
 10230     IF DTE-CLIENT = 'GIC'
 10231         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 10232             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
 10233                                     A-H-REFUND-CALC.
 10234
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 197
* ECS010.cbl
 10235*    IF DTE-CLIENT = 'TMS'
 10236     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
 10237*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
 10238
 10239
 10240     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 10241         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10242     ELSE
 10243         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
 10244             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
 10245             MOVE '8'                  TO CR-AH-CURRENT-STATUS
 10246             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
 10247             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
 10248                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10249         ELSE
 10250             IF CR-AH-CURRENT-STATUS = '7'
 10251                 MOVE '8'              TO CR-AH-CURRENT-STATUS
 10252                 MOVE PB-C-AH-COMM-CHARGEBACK
 10253                                       TO CR-AH-COMM-CHARGEBACK
 10254                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
 10255                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
 10256
 10257*************************************************
 10258***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10259***  WAS CONVERTED TO 1056 BYTES.             ***
 10260*************************************************
 10261     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
 10262
 10263     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
 10264     MOVE CR-AH-TERM                   TO TRD-AHTRM.
 10265     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
 10266
 10267     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10268        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 10269        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10270           COMPUTE CNC-FACT = CR-AH-RFND-CLP / CR-AH-CLP
 10271           MOVE CNC-FACT TO UECLP-CLP-FACT
 10272        END-IF
 10273        IF CR-CANCEL-REASON = 'R'
 10274           MOVE +1               TO CNC-FACT
 10275        END-IF
 10276        COMPUTE H-AHCM ROUNDED = CNC-FACT *
 10277           (CR-AHPRM - (CR-LFPRM-ALT
 10278           + CR-ADDL-CLP)) * -1
 10279     ELSE
 10280        COMPUTE H-AHCM ROUNDED =
 10281          (CR-AHRFND * ACCT-COMM-AH) * (-1)
 10282     END-IF
 10283
 10284     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
 10285
 10286     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
 10287     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
 10288     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
 10289     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
 10290
 10291     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
 10292     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 198
* ECS010.cbl
 10293
 10294 0660-PROCESS-CANCEL-CONTINUE.
 10295
 10296     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10297
 10298     IF CR-POLICY-IS-REIN-ONLY
 10299        GO TO 0660-CONT.
 10300
 10301     MOVE 'Y'                    TO BILLED-SWITCH.
 10302     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
 10303
 10304     MOVE 'Y' TO WS-DCC-CNC-FLAG
 10305     if dte-client = 'DCC'
 10306        MOVE DETAIL-EXTRACT      TO NEW-DETAIL-EXTRACT
 10307     end-if
 10308
 10309     IF CR-POLICY-IS-MONTHLY
 10310        GO TO 0660-CONT
 10311     END-IF
 10312
 10313     ADD +1                      TO BC-G-CNC.
 10314     ADD +1                      TO BC-COMM.
 10315     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
 10316     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
 10317     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
 10318     ADD H-LFCM                  TO TPL-ACCT-COM (1).
 10319     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
 10320     ADD H-AHCM                  TO TPA-ACCT-COM (1).
 10321
 10322     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 10323         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
 10324     ELSE
 10325         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
 10326
 10327     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
 10328         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
 10329     ELSE
 10330         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
 10331
 10332
 10333 0660-CONT.
 10334
 10335     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
 10336     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
 10337
 10338     IF CR-LFRFND NEGATIVE
 10339       IF CR-LFRFND + LIFE-REFUND = ZEROS
 10340           MOVE '*'                 TO REIN-VOID-LF-SW.
 10341     IF CR-AHRFND NEGATIVE
 10342       IF CR-AHRFND + A-H-REFUND = ZEROS
 10343           MOVE '*'                 TO REIN-VOID-AH-SW.
 10344
 10345     IF CR-LFRFND NOT = ZEROS
 10346       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10347           MOVE '*'                 TO REIN-ADDL-LF-SW.
 10348     IF CR-AHRFND NOT = ZEROS
 10349       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10350           MOVE '*'                 TO REIN-ADDL-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 199
* ECS010.cbl
 10351
 10352     IF CR-DT = CR-LF-CANC-DT
 10353       MOVE '*'                     TO REIN-CANCEL-LF-SW.
 10354     IF CR-DT = CR-AH-CANC-DT
 10355       MOVE '*'                     TO REIN-CANCEL-AH-SW.
 10356
 10357     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 10358
 10359     MOVE SPACES                    TO REIN-VOID-LF-SW
 10360                                       REIN-VOID-AH-SW
 10361                                       REIN-ADDL-LF-SW
 10362                                       REIN-ADDL-AH-SW.
 10363
 10364     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
 10365     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
 10366
 10367     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
 10368     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
 10369
 10370     IF (CR-LFTYP NOT = ZERO  AND
 10371        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 10372        (CR-AHTYP NOT = ZERO  AND
 10373        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 10374         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
 10375         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
 10376
 10377 0670-LIFE-CANCEL-VOID.
 10378
 10379     IF CR-LFTYP NOT = ZERO  AND
 10380        CR-LFRFND = ZERO  AND
 10381        PB-C-LF-CANCEL-AMT NEGATIVE
 10382         NEXT SENTENCE
 10383     ELSE
 10384         GO TO 0680-A-H-CANCEL-VOID.
 10385
 10386     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
 10387                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10388                                          CR-LF-CANC-DT
 10389                                          WS-CR-LF-CANC-DT-N
 10390                                          CR-LFRFND-CALC.
 10391
 10392     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
 10393
 10394     IF CR-LF-CANCEL-APPLIED
 10395         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
 10396         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
 10397     ELSE
 10398         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
 10399         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
 10400
 10401     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10402
 10403     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
 10404     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10405
 10406     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10407
 10408 0680-A-H-CANCEL-VOID.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 200
* ECS010.cbl
 10409
 10410     IF CR-AHTYP NOT = ZERO  AND
 10411        CR-AHRFND = ZERO  AND
 10412        PB-C-AH-CANCEL-AMT NEGATIVE
 10413         NEXT SENTENCE
 10414     ELSE
 10415         GO TO 0690-END-CANCEL-PROCESSING.
 10416
 10417     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
 10418                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10419                                        CR-AH-CANC-DT
 10420                                        WS-CR-AH-CANC-DT-N
 10421                                        CR-AHRFND-CALC.
 10422
 10423     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
 10424
 10425     IF CR-AH-CANCEL-APPLIED
 10426         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10427         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10428     ELSE
 10429         MOVE CR-AH-STATUS-AT-CANCEL
 10430                                    TO CR-AH-STATUS-AT-SETTLEMENT
 10431         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
 10432
 10433     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10434
 10435     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
 10436     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10437
 10438     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10439
 10440 0690-END-CANCEL-PROCESSING.
 10441
 10442     IF CR-LF-CANC-DT = ZEROS  AND
 10443        CR-AH-CANC-DT = ZEROS
 10444         MOVE ZEROS             TO CR-NH-INT-ON-REF
 10445     END-IF
 10446
 10447     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
 10448         NEXT SENTENCE
 10449     ELSE
 10450         MOVE 'X'               TO REIN-RT-SW
 10451         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
 10452         MOVE ' '               TO REIN-RT-SW.
 10453
 10454     MOVE '*'                   TO TRANSACTION-FLAG.
 10455     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10456
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 201
* ECS010.cbl
 10458******************************************************************
 10459***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
 10460******************************************************************
 10461
 10462 0700-PROCESS-CLAIMS.
 10463
 10464     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
 10465        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
 10466         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
 10467             PENDING-MATCH-CONTROL
 10468         MOVE 0301 TO WS-ABEND-CODE
 10469         DISPLAY '******************************'
 10470         DISPLAY '***** ERROR LOCATION 011 *****'
 10471         DISPLAY '******************************'
 10472         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10473         GO TO ABEND-PGM.
 10474
 10475     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10476
 10477     ADD +1                       TO  W-LF-CLAIMS.
 10478
 10479     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10480     MOVE ' '                     TO  DC-OPTION-CODE.
 10481     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10482     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10483
 10484     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10485     MOVE ' '                     TO  DC-OPTION-CODE.
 10486     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10487     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10488
 10489     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
 10490     MOVE ' '                     TO  DC-OPTION-CODE.
 10491     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10492     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
 10493
 10494     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10495     MOVE ' '                     TO  DC-OPTION-CODE.
 10496     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10497     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10498
 10499     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10500
 10501**** IF DTE-CLIENT = 'LAP'  OR  'RMC'
 10502****   MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
 10503****   IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
 10504****     IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
 10505****         MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
 10506****     ELSE
 10507****         ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
 10508
 10509     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10510         GO TO 0750-PROCESS-DISABILITY-CLAIM.
 10511
 10512******************************************************************
 10513***           P R O C E S S   D E A T H   C L A I M            ***
 10514******************************************************************
 10515
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 202
* ECS010.cbl
 10516     IF REIN-IS-RISK-PREMIUM
 10517       IF CR-DTH-DT = ZEROS
 10518           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
 10519           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10520           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
 10521
 10522     MOVE INCURRED-DATE            TO CR-DTH-DT
 10523                                      WS-CR-DTH-DT-N.
 10524
 10525     IF PC-CHARGEBLE-EXPENSE  OR
 10526        PC-NON-CHARGEBLE-EXPENSE
 10527         IF CR-LFTYP = '00'
 10528             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
 10529             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
 10530                     8399-LIFE-LOOKUP-X.
 10531
 10532     IF PC-CHARGEBLE-EXPENSE  OR
 10533        PC-NON-CHARGEBLE-EXPENSE
 10534         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
 10535         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
 10536         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
 10537         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
 10538         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
 10539         GO TO 0780-END-CLAIMS-PROCESSING.
 10540
 10541     ADD +1                       TO  CR-NUM-DTH-CLM.
 10542     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
 10543     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
 10544                                      WS-CR-DTH-PAY-DT-N.
 10545
 10546     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
 10547     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
 10548     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
 10549     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
 10550     IF CR-DTH-PAY-CD NOT = 'F'
 10551         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
 10552     INSPECT CR-DTH-PAY-CD
 10553         CONVERTING '12349' TO 'PFSXV'.
 10554     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
 10555
 10556     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
 10557         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
 10558       AND
 10559       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
 10560       OR
 10561        DTE-CLIENT = 'ACC' OR 'FDL')
 10562        NEXT SENTENCE
 10563     ELSE
 10564     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
 10565         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
 10566             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
 10567             MOVE '7'            TO CR-LF-CURRENT-STATUS
 10568             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
 10569                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
 10570
 10571     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10572     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10573     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 203
* ECS010.cbl
 10574     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
 10575         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
 10576     ELSE
 10577         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
 10578     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
 10579
 10580     IF NOT CR-POLICY-IS-REIN-ONLY
 10581         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
 10582
 10583 0720-CANCEL-AH-COVERAGE.
 10584
 10585     IF CR-AHTYP = ZEROS  OR
 10586        NOT CR-AH-POLICY-IS-ACTIVE
 10587         GO TO 0740-DEATH-CLAIM-VOID.
 10588
 10589     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
 10590     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
 10591     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
 10592                                           WS-CR-AH-CANC-DT-N.
 10593     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
 10594                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
 10595
 10596     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
 10597     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10598     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10599     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10600     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10601     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10602     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10603     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10604
 10605 0740-DEATH-CLAIM-VOID.
 10606
 10607     IF CR-DTHAMT = ZERO  AND
 10608        PC-CLAIM-PAYMENT NEGATIVE
 10609         NEXT SENTENCE
 10610     ELSE
 10611         GO TO 0780-END-CLAIMS-PROCESSING.
 10612
 10613     MOVE '*'                           TO DEATH-VOID-FLAG.
 10614
 10615     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10616                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10617                                           CR-NUM-DTH-CLM
 10618                                           CR-DTH-RPT-DT
 10619                                           CR-DTH-PAY-DT
 10620                                           WS-CR-DTH-PAY-DT-N
 10621*                                          CR-DTHAMT-YTD
 10622*                                          CR-DTHAMT-LAST
 10623                                           CR-DTH-AGE.
 10624     MOVE ' '                           TO CR-DTH-PAY-CD.
 10625
 10626     IF CR-LF-DEATH-CLAIM-APPLIED
 10627         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10628         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10629     ELSE
 10630         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10631         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 204
* ECS010.cbl
 10632
 10633     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10634     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10635
 10636     IF CR-AH-DEATH-CLAIM-APPLIED
 10637         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10638         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10639         MOVE ZEROS                     TO CR-AH-CANC-DT
 10640                                           WS-CR-AH-CANC-DT-N
 10641                                           CR-AH-CANCEL-EXIT-DATE
 10642                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10643         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10644         MOVE CR-AH-TERM                TO TRD-AHTRM
 10645         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10646         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10647
 10648     GO TO 0780-END-CLAIMS-PROCESSING.
 10649
 10650******************************************************************
 10651***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10652******************************************************************
 10653
 10654 0750-PROCESS-DISABILITY-CLAIM.
 10655
 10656     ADD +1                       TO W-AH-CLAIMS.
 10657
 10658     MOVE INCURRED-DATE           TO CR-DIS-DT
 10659                                     WS-CR-DIS-DT-N.
 10660
 10661     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10662
 10663     IF REIN-AH-CLM-MONTHS = +1
 10664         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10665     ELSE
 10666       IF REIN-AH-CLM-MONTHS = +2
 10667           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10668       ELSE
 10669         IF REIN-AH-CLM-MONTHS = +3
 10670             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10671         ELSE
 10672           IF REIN-AH-CLM-MONTHS = +4
 10673               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10674           ELSE
 10675               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10676
 10677     IF PC-CHARGEBLE-EXPENSE  OR
 10678        PC-NON-CHARGEBLE-EXPENSE
 10679         IF CR-AHTYP = '00'
 10680             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10681             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10682                     8499-A-H-LOOKUP-X.
 10683
 10684     IF PC-CHARGEBLE-EXPENSE  OR
 10685        PC-NON-CHARGEBLE-EXPENSE
 10686         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10687         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10688         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10689         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 205
* ECS010.cbl
 10690         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10691         GO TO 0780-END-CLAIMS-PROCESSING.
 10692
 10693     ADD +1                       TO CR-NUM-DIS-CLM.
 10694
 10695     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10696     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10697                                      WS-CR-DIS-PAY-DT-N.
 10698     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10699                                      WS-CR-DIS-PTO-DT-N.
 10700
 10701     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10702     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10703     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10704
 10705     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10706     IF CR-DIS-PAY-CD NOT = 'S'
 10707         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10708     INSPECT CR-DIS-PAY-CD
 10709         CONVERTING '12349' TO 'PFSXV'.
 10710     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10711
 10712     IF PC-LUMP-SUM-PAYMENT
 10713         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10714           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10715           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10716           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10717                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10718
 10719     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10720     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10721     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10722     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10723     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10724
 10725     IF NOT CR-POLICY-IS-REIN-ONLY
 10726         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10727
 10728     IF NOT PC-LUMP-SUM-PAYMENT
 10729         GO TO 0780-END-CLAIMS-PROCESSING.
 10730
 10731 0770-CANCEL-LF-COVERAGE.
 10732
 10733     IF CR-LFTYP = ZEROS  OR
 10734        NOT CR-LF-POLICY-IS-ACTIVE
 10735         GO TO 0780-END-CLAIMS-PROCESSING.
 10736
 10737     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10738     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10739     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10740                                           WS-CR-LF-CANC-DT-N.
 10741     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10742                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10743
 10744     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10745     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10746     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10747     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 206
* ECS010.cbl
 10748     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10749     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10750     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10751     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10752
 10753 0780-END-CLAIMS-PROCESSING.
 10754
 10755     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10756         MOVE DTO-MO               TO TRD-LFACTMO
 10757         MOVE DTO-DA               TO TRD-LFACTDA
 10758         MOVE DTO-YR               TO TRD-LFACTYR
 10759         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10760     ELSE
 10761         MOVE PAY-MO               TO TRD-AHACTMO
 10762         MOVE PAY-DA               TO TRD-AHACTDA
 10763         MOVE PAY-YR               TO TRD-AHACTYR
 10764         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10765
 10766     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10767
 10768     IF NOT CR-POLICY-IS-REIN-ONLY
 10769         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10770         ADD +1                    TO BC-G-CLM.
 10771
 10772     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10773
 10774     IF DEATH-CLAIM-VOIDED
 10775         MOVE ZEROS                TO CR-DTH-DT
 10776                                      WS-CR-DTH-DT-N.
 10777     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10778
 10779     MOVE '*'                      TO TRANSACTION-FLAG.
 10780     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10781
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 207
* ECS010.cbl
 10783 0790-TABLE-DISAB-PERIODS.
 10784
 10785     MOVE +1                       TO SUB14.
 10786     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10787
 10788     MOVE +1                       TO SUB14.
 10789
 10790**************************************************************
 10791**                                                          **
 10792**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10793**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10794**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10795**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10796**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10797**                                                          **
 10798**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10799**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10800**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10801**                                                          **
 10802**************************************************************
 10803
 10804 0791-TABLE-AH-AMOUNT.
 10805
 10806     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10807         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10808
 10809     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10810         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10811                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10812         IF REIN-IS-RISK-PREMIUM
 10813             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10814             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10815             IF SUB14 = +1
 10816               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10817             ELSE
 10818             IF SUB14 = +2
 10819               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10820             ELSE
 10821             IF SUB14 = +3
 10822               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10823             ELSE
 10824             IF SUB14 = +4
 10825               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10826             ELSE
 10827               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10828
 10829
 10830     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10831         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10832         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10833                                        +  CR-INCUR-DISEXP (SUB14)
 10834         IF PC-CHARGEBLE-EXPENSE  OR
 10835            PC-NON-CHARGEBLE-EXPENSE
 10836             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10837             GO TO 0791-TABLE-AH-EXIT
 10838         ELSE
 10839             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10840             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 208
* ECS010.cbl
 10841
 10842     ADD +1                       TO SUB14.
 10843
 10844     GO TO 0791-TABLE-AH-AMOUNT.
 10845
 10846 0791-TABLE-AH-EXIT.
 10847     EXIT.
 10848
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 209
* ECS010.cbl
 10850**************************************************************
 10851**                                                          **
 10852** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10853** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10854**                                                          **
 10855** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10856** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10857** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10858** OCCURRENCE.                                              **
 10859**************************************************************
 10860 0792-MOVE-TABLE.
 10861
 10862     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10863                                  WS-CR-DIS-INCUR-DT-N (1).
 10864     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10865     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10866
 10867     MOVE +2                   TO SUB14.
 10868     MOVE +3                   TO SUB15.
 10869     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10870
 10871     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10872
 10873     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10874                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10875
 10876 0792-MOVE-TABLE-EXIT.
 10877     EXIT.
 10878
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 210
* ECS010.cbl
 10880**************************************************************
 10881**                                                          **
 10882**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10883** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10884** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10885** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10886** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10887**************************************************************
 10888
 10889 0794-REVIEW-TABLE.
 10890
 10891     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10892         GO TO 0794-REVIEW-TABLE-EXIT.
 10893
 10894     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10895         GO TO 0794-REVIEW-TABLE-EXIT.
 10896
 10897     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10898        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10899         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10900         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10901                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10902         MOVE SUB14            TO SUB15
 10903         ADD +1                TO SUB15
 10904         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10905         MOVE +1               TO SUB14
 10906         GO TO 0794-REVIEW-TABLE.
 10907
 10908     ADD +1                    TO SUB14.
 10909
 10910     GO TO 0794-REVIEW-TABLE.
 10911
 10912 0794-REVIEW-TABLE-EXIT.
 10913     EXIT.
 10914
 10915 0794A-BUMP-TBL.
 10916
 10917     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10918         GO TO 0794A-BUMP-TBL-EXIT.
 10919
 10920     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10921                             CR-DISAB-DETAIL-DATA (SUB14).
 10922     MOVE WS-CR-DIS-INCUR-DT-N (SUB15)
 10923                                 TO WS-CR-DIS-INCUR-DT-N (SUB14)
 10924
 10925     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10926                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10927                                  CR-INCUR-DISAMT (SUB15)
 10928                                  CR-INCUR-DISEXP (SUB15).
 10929
 10930     ADD +1                    TO SUB14
 10931                                  SUB15.
 10932     GO TO 0794A-BUMP-TBL.
 10933
 10934 0794A-BUMP-TBL-EXIT.
 10935     EXIT.
 10936
 10937 0795-DCC-NSP-LF.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 211
* ECS010.cbl
 10938
 10939     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 10940     MOVE 'L'                        TO DC-OPTION-CODE.
 10941     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10942     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10943     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10944     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10945     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10946     MOVE CR-APR                     TO CP-LOAN-APR.
 10947     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10948     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10949     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10950     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10951
 10952     MOVE '3'                        TO CP-PROCESS-TYPE.
 10953     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10954     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10955
 10956     IF CR-LFTYP = ZERO
 10957         GO TO 0795-EXIT
 10958     END-IF
 10959
 10960     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10961         GO TO 0795-EXIT
 10962     END-IF
 10963     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10964     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10965     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10966     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10967                                        CP-RATING-BENEFIT-AMT.
 10968     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10969     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10970     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10971     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10972     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10973     MOVE CR-STATE                   TO CP-STATE.
 10974     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 10975
 10976     IF CP-STATE-STD-ABBRV = 'OR'
 10977         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 10978
 10979     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 10980
 10981     IF CP-ERROR-RATE-NOT-FOUND  OR
 10982        CP-ERROR-RATE-IS-ZERO
 10983         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 10984                                     TO WS-ABEND-MESSAGE
 10985         MOVE 0302                   TO WS-ABEND-CODE
 10986         DISPLAY '******************************'
 10987         DISPLAY '***** ERROR LOCATION 018 *****'
 10988         DISPLAY '******************************'
 10989         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10990         GO TO ABEND-PGM.
 10991
 10992     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 10993
 10994*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 10995*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 212
* ECS010.cbl
 10996
 10997     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 10998                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 10999
 11000     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 11001
 11002 0795-exit.
 11003     exit.
 11004
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 213
* ECS010.cbl
 11006******************************************************************
 11007***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 11008******************************************************************
 11009
 11010 0800-PROCESS-RESERVES.
 11011
 11012     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 11013       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 11014           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 11015
 11016     if (dte-client = 'AHL')
 11017        and (PC-AH-CLAIM OR PC-OB-AH-CLAIM)
 11018        and (cr-ahtyp (1:1) = 'M')
 11019        and ((pc-future-reserve-amt > zeros)
 11020            or (pc-ptc-reserve-amt > zeros))
 11021        compute pc-ibnr-reserve-amt =
 11022           (pc-future-reserve-amt + pc-ptc-reserve-amt) * .205
 11023        display ' using 205 of ptc and future ' cr-cert-no
 11024     end-if
 11025
 11026     if (dte-client = 'AHL')
 11027        and (PC-LF-CLAIM OR PC-OB-LF-CLAIM)
 11028        and (cr-lftyp (1:1) = 'M')
 11029        and (pc-ptc-reserve-amt > zeros)
 11030        compute pc-ibnr-reserve-amt = pc-ptc-reserve-amt * .217
 11031        display ' using 217 of ptc ' cr-cert-no
 11032     end-if
 11033
 11034     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 11035
 11036     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 11037     MOVE ' '                     TO  DC-OPTION-CODE.
 11038     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11039     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 11040
 11041     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 11042     MOVE ' '                     TO  DC-OPTION-CODE.
 11043     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11044     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 11045
 11046     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 11047     MOVE ' '                     TO  DC-OPTION-CODE.
 11048     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11049     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 11050
 11051     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11052
 11053     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 11054         ADD +1                     TO W-LF-RESERVES
 11055         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 11056         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 11057         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 11058         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 11059         MOVE INCURRED-DATE         TO CR-DTH-DT
 11060                                       WS-CR-DTH-DT-N
 11061         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 11062
 11063     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 214
* ECS010.cbl
 11064         ADD +1                     TO W-AH-RESERVES
 11065         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 11066         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 11067         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 11068         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 11069         MOVE INCURRED-DATE         TO CR-DIS-DT
 11070                                       WS-CR-DIS-DT-N
 11071         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 11072
 11073     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 11074     MOVE 'IBNR'                    TO TRD-IBNRX.
 11075     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 11076     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 11077     COMPUTE TRD-FUTRSV EQUAL
 11078            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 11079     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 11080     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 11081
 11082 0820-END-RESERVE-PROCESSING.
 11083
 11084     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11085
 11086     IF NOT CR-POLICY-IS-REIN-ONLY
 11087         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 11088                                            2499-BLD-RESERVE-X
 11089         ADD +1 TO BC-G-CRS.
 11090
 11091     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 11092
 11093     MOVE '*'                    TO TRANSACTION-FLAG.
 11094     GO TO 0300-READ-PENDING-TRANSACTIONS.
 11095
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 215
* ECS010.cbl
 11097******************************************************************
 11098***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 11099******************************************************************
 11100
 11101 0900-PROCESS-CERT-CHANGES.
 11102
 11103     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11104
 11105     IF CC-AGE NOT NUMERIC  OR
 11106        CC-AGE = CR-AGE
 11107         MOVE ZEROS TO CC-AGE.
 11108
 11109     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 11110        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 11111         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 11112
 11113     IF CC-INSURED-SEX NOT = 'M'  AND
 11114        CC-INSURED-SEX NOT = 'F'
 11115         MOVE SPACES TO CC-INSURED-SEX.
 11116
 11117     IF CC-LOAN-APR NOT NUMERIC  OR
 11118        CC-LOAN-APR = CR-APR
 11119         MOVE ZEROS TO CC-LOAN-APR.
 11120
 11121     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 11122        CC-PAY-FREQUENCY = CR-PMT-FREQ
 11123         MOVE ZEROS TO CC-PAY-FREQUENCY.
 11124
 11125     IF CC-IND-GRP-TYPE NOT = '1'  AND
 11126        CC-IND-GRP-TYPE NOT = '2'
 11127         MOVE SPACES TO CC-IND-GRP-TYPE.
 11128
 11129     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
 11130****    OR CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 11131         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 11132
 11133     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 11134        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 11135         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 11136
 11137     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 11138        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 11139        CR-LFTYP = ZEROS
 11140         MOVE ZEROS TO CC-LF-ORIG-TERM.
 11141
 11142     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 11143        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 11144        CR-AHTYP = ZEROS
 11145         MOVE ZEROS TO CC-AH-ORIG-TERM.
 11146
 11147     IF CR-BILLED NOT NUMERIC
 11148         MOVE ZEROS TO CR-BILLED.
 11149
 11150     IF CR-LIVES NOT NUMERIC
 11151         MOVE ZEROS TO CR-LIVES.
 11152
 11153     IF CC-LIVES NOT NUMERIC  OR
 11154        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 216
* ECS010.cbl
 11155         MOVE ZEROS TO CC-LIVES.
 11156
 11157     IF CC-BILLED NOT NUMERIC  OR
 11158        CC-BILLED = CR-BILLED
 11159         MOVE ZEROS TO CC-BILLED.
 11160
 11161     IF CC-INSURED-LAST-NAME NOT = SPACES
 11162         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 11163     IF CC-INSURED-FIRST-NAME NOT = SPACES
 11164         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 11165     IF CC-INSURED-INITIAL2 NOT = SPACES
 11166         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 11167     IF CC-JT-LAST-NAME NOT = SPACES
 11168         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 11169     IF CC-JT-FIRST-NAME NOT = SPACES
 11170         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 11171     IF CC-JT-INITIAL NOT = SPACES
 11172         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 11173
 11174     IF CC-AGE NOT = ZEROS
 11175         MOVE CC-AGE                 TO CR-AGE
 11176                                        DET-AGE
 11177     ELSE
 11178         MOVE ZEROS                  TO DET-AGE.
 11179
 11180     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 11181         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 11182                                        DET-JT-AGE
 11183     ELSE
 11184         MOVE ZEROS                  TO DET-JT-AGE.
 11185
 11186     IF CC-INSURED-SEX NOT = SPACES
 11187         MOVE CC-INSURED-SEX         TO CR-SEX
 11188                                        DET-SEX
 11189     ELSE
 11190         MOVE SPACE                  TO DET-SEX.
 11191
 11192     IF CC-MEMBER-NO NOT = SPACES
 11193         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 11194                                        DET-PR-MEM
 11195     ELSE
 11196         MOVE SPACES                 TO DET-PR-MEM.
 11197
 11198     IF CC-SOC-SEC-NO NOT = SPACES
 11199         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 11200                                        DET-PR-SS
 11201     ELSE
 11202         MOVE SPACES                 TO DET-PR-SS.
 11203
 11204     IF CC-LOAN-APR NOT = ZEROS
 11205         MOVE CC-LOAN-APR            TO CR-APR
 11206                                        DET-PR-APR
 11207     ELSE
 11208         MOVE ZEROS                  TO DET-PR-APR.
 11209
 11210     IF CC-AGE NOT = ZERO  OR
 11211        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 11212        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 217
* ECS010.cbl
 11213        CC-MEMBER-NO NOT = SPACES  OR
 11214        CC-SOC-SEC-NO NOT = SPACES  OR
 11215        CC-LOAN-APR NOT = ZERO
 11216         MOVE DET-PR-UREC            TO TR-DTL2
 11217         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11218         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11219
 11220     IF CC-LF-ORIG-TERM NOT = ZEROS
 11221         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 11222         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 11223                                        DET-N-LF-TERM
 11224     ELSE
 11225         MOVE ZEROS                  TO DET-O-LF-TERM
 11226                                        DET-N-LF-TERM.
 11227
 11228     IF CC-AH-ORIG-TERM NOT = ZEROS
 11229         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 11230         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 11231                                        DET-N-AH-TERM
 11232     ELSE
 11233         MOVE ZEROS                  TO DET-O-AH-TERM
 11234                                        DET-N-AH-TERM.
 11235
 11236     IF CC-LIVES NOT = ZEROS
 11237         MOVE CR-LIVES               TO DET-O-LIVES
 11238         MOVE CC-LIVES               TO CR-LIVES
 11239                                        DET-N-LIVES
 11240     ELSE
 11241         MOVE ZEROS                  TO DET-O-LIVES
 11242                                        DET-N-LIVES.
 11243
 11244     IF CC-BILLED NOT  = ZEROES
 11245         MOVE CC-BILLED              TO CR-BILLED.
 11246
 11247     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 11248        CC-AH-ORIG-TERM NOT = ZERO  OR
 11249        CC-LIVES NOT = ZERO
 11250         MOVE DET-PR-UREC-2          TO TR-DTL2
 11251         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11252         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11253
 11254     IF CC-IND-GRP-TYPE NOT = SPACES
 11255         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 11256                                        DET-IND-GRP
 11257     ELSE
 11258         MOVE SPACE                  TO DET-IND-GRP.
 11259
 11260     IF CC-PAY-FREQUENCY NOT = ZEROS
 11261         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 11262                                        DET-PMT-FREQ
 11263     ELSE
 11264         MOVE ZEROS                  TO DET-PMT-FREQ.
 11265
 11266     IF CC-POLICY-FORM-NO NOT = SPACES
 11267         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 11268                                        DET-POL-FORM
 11269     ELSE
 11270         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 218
* ECS010.cbl
 11271
 11272     IF CC-LOAN-OFFICER NOT = SPACES
 11273         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 11274                                        DET-LOAN-OFFICER
 11275     ELSE
 11276         MOVE SPACES                 TO DET-LOAN-OFFICER.
 11277
 11278     IF CC-USER-FIELD NOT = SPACES
 11279         MOVE CC-USER-FIELD          TO CR-USER-CODE
 11280                                        DET-USER-CODE
 11281     ELSE
 11282         MOVE SPACE                  TO DET-USER-CODE.
 11283
 11284     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 11285        CC-PAY-FREQUENCY NOT = ZEROS  OR
 11286        CC-POLICY-FORM-NO NOT = SPACES  OR
 11287        CC-LOAN-OFFICER NOT = SPACES  OR
 11288        CC-USER-FIELD NOT = SPACES
 11289         MOVE DET-PR-UREC-3          TO TR-DTL2
 11290         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11291         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11292
 11293**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 11294****     MOVE CC-CLAIM-DEDUCT-WITHHELD
 11295****                                 TO CR-CLAIM-DEDUCT-WITHHELD
 11296****                                    DET-CLM-DEDUCT
 11297**** ELSE
 11298****     MOVE ZEROS                  TO DET-CLM-DEDUCT.
 11299
 11300     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11301         MOVE CC-CANCEL-DEDUCT-WITHHELD
 11302                                     TO CR-CANCEL-DEDUCT-WITHHELD
 11303                                        DET-CAN-DEDUCT
 11304     ELSE
 11305         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 11306
 11307**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 11308     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11309         MOVE DET-PR-UREC-4          TO TR-DTL2
 11310         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11311         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11312
 11313     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 11314         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 11315
 11316     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 11317         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 11318
 11319     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 11320         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 11321
 11322     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 11323         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 11324
 11325     IF CC-LF-BENEFIT-CD NOT = SPACES
 11326         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 11327                                     DET-LF-BEN-CD
 11328     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 219
* ECS010.cbl
 11329         MOVE SPACES             TO DET-LF-BEN-CD.
 11330
 11331     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 11332         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 11333                                     DET-LF-PREM
 11334     ELSE
 11335         MOVE ZEROS              TO DET-LF-PREM.
 11336
 11337     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 11338         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 11339                                     DET-LF-BEN
 11340     ELSE
 11341         MOVE ZEROS              TO DET-LF-BEN.
 11342
 11343     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 11344        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 11345        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 11346         MOVE DET-PR-UREC-5          TO TR-DTL2
 11347         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11348         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11349
 11350     IF CC-AH-BENEFIT-CD NOT = SPACES
 11351         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 11352                                     DET-AH-BEN-CD
 11353     ELSE
 11354         MOVE SPACES             TO DET-AH-BEN-CD.
 11355
 11356     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 11357         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 11358                                     DET-AH-PREM
 11359     ELSE
 11360         MOVE ZEROS              TO DET-AH-PREM.
 11361
 11362     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 11363         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 11364                                     DET-AH-BEN
 11365     ELSE
 11366         MOVE ZEROS              TO DET-AH-BEN.
 11367
 11368     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 11369        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 11370        CC-AH-BENEFIT-AMT NOT = ZEROS
 11371         MOVE DET-PR-UREC-6          TO TR-DTL2
 11372         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11373         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11374
 11375 0910-END-CHANGE-PROCESSING.
 11376
 11377     IF CR-LNAME = ALL '*'
 11378         MOVE SPACES                 TO CR-LNAME.
 11379     IF CR-FNAME = ALL '*'
 11380         MOVE SPACES                 TO CR-FNAME.
 11381     IF CR-INIT = '*'
 11382         MOVE SPACES                 TO CR-INIT.
 11383     IF CR-SOC-SEC = ALL '*'
 11384         MOVE SPACES                 TO CR-SOC-SEC.
 11385     IF CR-JT-LNAME = ALL '*'
 11386         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 220
* ECS010.cbl
 11387     IF CR-JT-FNAME = ALL '*'
 11388         MOVE SPACES                 TO CR-JT-FNAME.
 11389     IF CR-JT-INIT = '*'
 11390         MOVE SPACES                 TO CR-JT-INIT.
 11391     IF CR-POLICY-FORM-NO = ALL '*'
 11392         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 11393     IF CR-MEMBER-NO = ALL '*'
 11394         MOVE SPACES                 TO CR-MEMBER-NO.
 11395     IF CR-LOAN-OFFICER = ALL '*'
 11396         MOVE SPACES                 TO CR-LOAN-OFFICER.
 11397     IF CR-USER-CODE = ALL '*'
 11398         MOVE SPACES                 TO CR-USER-CODE.
 11399
 11400     ADD +1 TO BC-G-CTN.
 11401     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 221
* ECS010.cbl
 11403 0920-GET-BANK-FEES.
 11404
 11405     IF CR-CERT-NO = '0008771354 '
 11406        DISPLAY ' MADE IT TO 0920 '
 11407     END-IF
 11408
 11409     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 11410     MOVE CR-CARRIER             TO AG-CARRIER
 11411     MOVE CR-GROUPING            TO AG-GROUPING
 11412     MOVE CR-BANK-NO             TO AG-BANK
 11413     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 11414     MOVE 'B'                    TO AG-TYPE
 11415
 11416*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 11417*       PERFORM 0925-BUILD-WORK-BNK-COMM
 11418*                                THRU 0925-EXIT
 11419*       GO TO 0920-EXIT
 11420*    END-IF
 11421
 11422     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 11423
 11424     IF CR-CERT-NO = '0008771354 '
 11425        DISPLAY ' MADE IT AFTER START '
 11426     END-IF
 11427
 11428     .
 11429 0920-READ-ERAGTC.
 11430
 11431     IF ERAGTC-FILE-STATUS = '00'
 11432        READ ERAGTC NEXT RECORD
 11433     IF CR-CERT-NO = '0008771354 '
 11434        DISPLAY ' MADE ONE READ '
 11435     END-IF
 11436
 11437        IF ERAGTC-FILE-STATUS = '00'
 11438           IF (CR-CARRIER         = AG-CARRIER)
 11439              AND (CR-GROUPING    = AG-GROUPING)
 11440              AND (CR-BANK-NO     = AG-BANK)
 11441              IF WS-CR-BIN-DATE  = AG-EXP-DT
 11442                 GO TO 0920-READ-ERAGTC
 11443              ELSE
 11444                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 11445                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 11446                    PERFORM 0925-BUILD-WORK-BNK-COMM
 11447                                 THRU 0925-EXIT
 11448                    MOVE AG-CONTROL-PRIMARY
 11449                                 TO WS-PREV-BANK-COMM-KEY
 11450                    GO TO 0920-EXIT
 11451                 END-IF
 11452              END-IF
 11453           END-IF
 11454        END-IF
 11455     END-IF
 11456
 11457     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 11458*    PERFORM 0925-BUILD-WORK-BNK-COMM
 11459
 11460     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 222
* ECS010.cbl
 11461        AND (PB-I-BANK-FEE NOT = ZEROS)
 11462        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 11463        MOVE 'B'                 TO WS-BNK-TYPE (1)
 11464        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 11465        MOVE ' '                 TO WS-BNK-RECALC (1)
 11466        MOVE +2                  TO IB
 11467     END-IF
 11468
 11469     .
 11470 0920-EXIT.
 11471     EXIT.
 11472
 11473 0925-BUILD-WORK-BNK-COMM.
 11474
 11475     IF CR-CERT-NO = '0008771354 '
 11476        DISPLAY ' MADE IT TO 0925 '
 11477     END-IF
 11478
 11479     MOVE +1                     TO IA IB
 11480
 11481*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 11482*       AND (PB-I-BANK-FEE NOT = ZEROS)
 11483*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 11484*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 11485*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 11486*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 11487*       ADD +1                   TO IB
 11488*    END-IF
 11489*    .
 11490*0925-BUILD-CONTINUE.
 11491
 11492     IF CR-CERT-NO = '00087735841'
 11493        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 11494        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 11495        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 11496     END-IF
 11497
 11498*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 11499     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 11500        (IA > +10)
 11501        OR (IB > +10)
 11502        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 11503           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 11504           MOVE 'B'              TO WS-BNK-TYPE (IB)
 11505*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 11506           IF AG-SPP-FEES (IA) NOT NUMERIC
 11507              MOVE ZEROS         TO AG-SPP-FEES (IA)
 11508           END-IF
 11509           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 11510           MOVE AG-RECALC-LV-INDIC (IA)
 11511                                 TO WS-BNK-RECALC (IB)
 11512        ELSE
 11513           MOVE SPACES           TO WS-BNK-AGT (IB)
 11514                                    WS-BNK-TYPE (IB)
 11515                                    WS-BNK-RECALC (IB)
 11516           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 11517        END-IF
 11518        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 223
* ECS010.cbl
 11519     END-PERFORM
 11520
 11521     .
 11522 0925-EXIT.
 11523     EXIT.
 11524
 11525 0930-BUILD-CERT-TRLR.
 11526
 11527     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 11528     MOVE 'CS'                   TO CS-RECORD-ID
 11529     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 11530     MOVE CR-CARRIER             TO CS-CARRIER
 11531     MOVE CR-GROUPING            TO CS-GROUPING
 11532     MOVE CR-STATE               TO CS-STATE
 11533     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 11534     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 11535     MOVE CR-CERT-NO             TO CS-CERT-NO
 11536     MOVE 'A'                    TO CS-TRAILER-TYPE
 11537
 11538     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 11539
 11540     IF CS-AGT (1) NOT = SPACES AND ZEROS
 11541        WRITE CERTIFICATE-TRAILERS
 11542        IF ELCRTT-FILE-STATUS = '00'
 11543           CONTINUE
 11544        ELSE
 11545           IF ELCRTT-FILE-STATUS = '22'
 11546              READ ELCRTT
 11547              IF ELCRTT-FILE-STATUS = '00'
 11548                 MOVE WS-BANK-COMMISSIONS
 11549                                 TO CS-BANK-COMMISSION-AREA
 11550                 REWRITE CERTIFICATE-TRAILERS
 11551                 IF ELCRTT-FILE-STATUS NOT = '00'
 11552                    DISPLAY ' BAD REWRITE ELCRTT '
 11553                                 ELCRTT-FILE-STATUS
 11554                    PERFORM ABEND-PGM
 11555                 END-IF
 11556              ELSE
 11557                 DISPLAY ' BAD READ    ELCRTT '
 11558                                  ELCRTT-FILE-STATUS
 11559                 PERFORM ABEND-PGM
 11560              END-IF
 11561           ELSE
 11562              DISPLAY ' BAD WRITE ELCRTT '
 11563                                 ELCRTT-FILE-STATUS
 11564              PERFORM ABEND-PGM
 11565           END-IF
 11566        END-IF
 11567     END-IF
 11568
 11569     .
 11570 0930-EXIT.
 11571     EXIT.
 11572
 11573 0950-BUILD-CERT-C-TRLR.
 11574
 11575     MOVE SPACES                 TO CERTIFICATE-TRAILERS.
 11576     MOVE 'CS'                   TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 224
* ECS010.cbl
 11577     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD.
 11578     MOVE CR-CARRIER             TO CS-CARRIER.
 11579     MOVE CR-GROUPING            TO CS-GROUPING.
 11580     MOVE CR-STATE               TO CS-STATE.
 11581     MOVE CR-ACCOUNT             TO CS-ACCOUNT.
 11582     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT.
 11583     MOVE CR-CERT-NO             TO CS-CERT-NO.
 11584     MOVE 'C'                    TO CS-TRAILER-TYPE.
 11585
 11586     MOVE PB-I-VIN               TO CS-VIN-NUMBER.
 11587
 11588     WRITE CERTIFICATE-TRAILERS.
 11589     IF ELCRTT-FILE-STATUS = '00'
 11590        CONTINUE
 11591     ELSE
 11592        IF ELCRTT-FILE-STATUS = '22'
 11593           READ ELCRTT
 11594           IF ELCRTT-FILE-STATUS = '00'
 11595              MOVE PB-I-VIN      TO CS-VIN-NUMBER
 11596              REWRITE CERTIFICATE-TRAILERS
 11597              IF ELCRTT-FILE-STATUS NOT = '00'
 11598                 DISPLAY ' BAD REWRITE ELCRTT '
 11599                              ELCRTT-FILE-STATUS
 11600                 PERFORM ABEND-PGM
 11601              END-IF
 11602           ELSE
 11603              DISPLAY ' BAD READ    ELCRTT '
 11604                               ELCRTT-FILE-STATUS
 11605              PERFORM ABEND-PGM
 11606           END-IF
 11607        ELSE
 11608           DISPLAY ' BAD WRITE ELCRTT '
 11609                              ELCRTT-FILE-STATUS
 11610           PERFORM ABEND-PGM
 11611        END-IF
 11612     END-IF.
 11613
 11614     .
 11615 0950-EXIT.
 11616     EXIT.
 11617
 11618
 11619******************************************************************
 11620***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 11621******************************************************************
 11622
 11623 1000-SET-COMMISSION-STRUCTURE.
 11624
 11625     MOVE +1                     TO IA
 11626                                    IB.
 11627
 11628 1100-GET-COMMISSION-LEVEL.
 11629
 11630     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 11631
 11632     IF WK-AGT = '0000000000' OR SPACES
 11633         MOVE +0                 TO WK-L-RT
 11634                                    WK-J-RT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 225
* ECS010.cbl
 11635                                    WK-A-RT
 11636         GO TO 1200-SET-COMMISSION-LEVEL.
 11637
 11638 1110-LIFE-COMMISSION.
 11639
 11640     IF CR-LFTYP = ZERO  OR
 11641       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11642         MOVE +0 TO WK-L-RT
 11643                    WK-J-RT
 11644         GO TO 1130-A-H-COMMISSION.
 11645
 11646     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11647         GO TO 1120-JOINT-LIFE-COMMISSION.
 11648
 11649     IF WK-L-RT NUMERIC
 11650        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 11651         MOVE WK-L-RT                TO WS-COMMISSION
 11652         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11653         MOVE WS-COMMISSION          TO WK-L-RT
 11654         GO TO 1130-A-H-COMMISSION.
 11655
 11656     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11657     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11658     MOVE ZEROS                      TO WS-SUB1.
 11659     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11660
 11661     IF WS-SUB1 = ZEROS
 11662         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 11663     ELSE
 11664         MOVE WK-RATE                TO WK-L-RT
 11665         GO TO 1130-A-H-COMMISSION.
 11666
 11667     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11668
 11669     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11670     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11671     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11672     MOVE WK-RATE                    TO WK-L-RT.
 11673
 11674     GO TO 1130-A-H-COMMISSION.
 11675
 11676 1120-JOINT-LIFE-COMMISSION.
 11677
 11678     IF WK-J-RT NUMERIC
 11679        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11680         MOVE WK-J-RT                TO WS-COMMISSION
 11681         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11682         MOVE WS-COMMISSION          TO WK-J-RT
 11683         GO TO 1130-A-H-COMMISSION.
 11684
 11685     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11686     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11687     MOVE ZEROS                      TO WS-SUB1.
 11688     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11689
 11690     IF WS-SUB1 = ZEROS
 11691         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11692     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 226
* ECS010.cbl
 11693         MOVE WK-RATE                TO WK-J-RT
 11694         GO TO 1130-A-H-COMMISSION.
 11695
 11696     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11697
 11698     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11699     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11700     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11701     MOVE WK-RATE                    TO WK-J-RT.
 11702
 11703 1130-A-H-COMMISSION.
 11704
 11705     IF CR-AHTYP = ZERO  OR
 11706       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11707         MOVE +0 TO WK-A-RT
 11708         GO TO 1200-SET-COMMISSION-LEVEL.
 11709
 11710     IF WK-A-RT NUMERIC
 11711        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11712         MOVE WK-A-RT                TO WS-COMMISSION
 11713         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11714         MOVE WS-COMMISSION          TO WK-A-RT
 11715         GO TO 1200-SET-COMMISSION-LEVEL.
 11716
 11717     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11718     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11719     MOVE ZEROS                      TO WS-SUB1.
 11720     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11721
 11722     IF WS-SUB1 = ZEROS
 11723         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11724     ELSE
 11725         MOVE WK-RATE                TO WK-A-RT
 11726         GO TO 1200-SET-COMMISSION-LEVEL.
 11727
 11728     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11729
 11730     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11731     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11732     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11733     MOVE WK-RATE                    TO WK-A-RT.
 11734
 11735 1200-SET-COMMISSION-LEVEL.
 11736
 11737     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11738     IF WK-AGT = '0000000000' OR SPACES
 11739         MOVE SPACE                   TO WK-N-TYPE (IA)
 11740     ELSE
 11741         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11742
 11743     IF CR-LFTYP = ZERO
 11744         MOVE +0                      TO WK-L-RT1  (IA)
 11745     ELSE
 11746         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11747             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11748         ELSE
 11749             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11750
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 227
* ECS010.cbl
 11751     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11752
 11753     IF RC-COMM-FLG = 'X'
 11754        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11755*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11756*             AND (IA = +5))
 11757            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11758            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11759            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11760            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11761
 11762     IF IA LESS THAN +10
 11763         ADD +1 TO IA
 11764         GO TO 1100-GET-COMMISSION-LEVEL.
 11765
 11766     GO TO 1499-SET-COMM-X.
 11767
 11768 1300-READ-ERCTBL-FILE.
 11769
 11770     IF CTBL-SEARCH = LAST-CTBL
 11771         GO TO 1399-READ-ERCTBL-X.
 11772
 11773     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11774
 11775     IF COMM-OPEN-SW = ' '
 11776         MOVE 'X'                        TO COMM-OPEN-SW
 11777         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11778         OPEN INPUT ERCTBL
 11779         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11780             NEXT SENTENCE
 11781            ELSE
 11782             MOVE '41'                   TO ABEND-CODE-1
 11783             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11784             DISPLAY '******************************'
 11785             DISPLAY '***** ERROR LOCATION 012 *****'
 11786             DISPLAY '******************************'
 11787             DISPLAY '******************************'
 11788             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11789             GO TO ABEND-PGM.
 11790
 11791     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11792                                            LAST-CTBL.
 11793     READ ERCTBL.
 11794
 11795     IF ERCTBL-FILE-STATUS = '23'
 11796         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11797                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11798                 ' CTBL: ' CTBL-SEARCH
 11799         MOVE '*'                TO CTBL-ERROR-SWITCH
 11800         MOVE '44'               TO ABEND-CODE-1
 11801         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11802         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11803         DISPLAY '******************************'
 11804         DISPLAY '***** ERROR LOCATION 013 *****'
 11805         DISPLAY '******************************'
 11806         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11807*        IF DTE-CLIENT NOT = 'NCL'
 11808         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 228
* ECS010.cbl
 11809           AND 'AHL'
 11810             GO TO ABEND-PGM
 11811         ELSE
 11812             NEXT SENTENCE
 11813     ELSE
 11814         IF ERCTBL-FILE-STATUS NOT = '00'
 11815             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11816             MOVE '44'               TO ABEND-CODE-1
 11817             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11818             DISPLAY '******************************'
 11819             DISPLAY '***** ERROR LOCATION 014 *****'
 11820             DISPLAY '******************************'
 11821             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11822             GO TO ABEND-PGM.
 11823
 11824     ADD +1                            TO ERCTBL-READS.
 11825
 11826 1399-READ-ERCTBL-X.
 11827     EXIT.
 11828
 11829 1400-GET-COMM-PERCENT.
 11830
 11831     IF CTBL-ERROR
 11832         MOVE ZEROS                      TO WK-RATE
 11833         GO TO 1489-GET-PERCENT-X.
 11834
 11835     MOVE +1 TO IB.
 11836     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11837        (CT-TBF (1) NOT EQUAL +9999999.99)
 11838         ADD +9 TO IB
 11839         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11840            (CT-TBF (2) NOT EQUAL +9999999.99)
 11841             ADD +9 TO IB.
 11842
 11843     IF CR-AGE GREATER CT-AGE (1)
 11844         ADD +3 TO IB
 11845         IF CR-AGE GREATER CT-AGE (2)
 11846             ADD +3 TO IB.
 11847
 11848     IF WS-COMM-TERM GREATER CT-TRM (1)
 11849         ADD +1 TO IB
 11850         IF WS-COMM-TERM GREATER CT-TRM (2)
 11851             ADD +1 TO IB.
 11852
 11853     IF CT-RT (IB) NOT NUMERIC
 11854         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11855         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11856         GO TO 1300-READ-ERCTBL-FILE.
 11857
 11858     MOVE CT-RT (IB) TO WK-RATE.
 11859
 11860 1489-GET-PERCENT-X.
 11861     EXIT.
 11862
 11863 1499-SET-COMM-X.
 11864     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 229
* ECS010.cbl
 11866******************************************************************
 11867***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11868******************************************************************
 11869
 11870 1500-GET-ACCT-LEVEL-LF-COMM.
 11871
 11872     MOVE ZEROS                      TO ACCT-COMM-LF
 11873                                        ACCT-COMM-AH.
 11874
 11875     MOVE +1                         TO IA.
 11876
 11877 1510-ACCT-LEVEL-LOOP.
 11878
 11879     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11880         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11881             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11882             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11883         ELSE
 11884             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11885                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11886
 11887     IF IA LESS THAN +10
 11888         ADD +1 TO IA
 11889         GO TO 1510-ACCT-LEVEL-LOOP.
 11890
 11891 1519-ACCT-LF-COMM-X.
 11892     EXIT.
 11893
 11894
 11895 1550-GET-ACCT-LEVEL-AH-COMM.
 11896
 11897     MOVE ZEROS                      TO ACCT-COMM-AH.
 11898
 11899     MOVE +1                         TO IA.
 11900
 11901 1555-ACCT-LEVEL-LOOP.
 11902
 11903     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11904         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11905             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11906
 11907     IF IA LESS THAN +10
 11908         ADD +1 TO IA
 11909         GO TO 1555-ACCT-LEVEL-LOOP.
 11910
 11911 1599-ACCT-AH-COMM-X.
 11912     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 230
* ECS010.cbl
 11914******************************************************************
 11915***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11916******************************************************************
 11917
 11918 1600-RECALC-COMM-EXTR.
 11919
 11920     IF RC-COMM-FLG = 'X'  OR
 11921        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11922        CR-POLICY-IS-DECLINED  OR
 11923        CR-POLICY-IS-VOID
 11924         GO TO 1899-RECALC-COMM-EXTR-X.
 11925
 11926     MOVE 'X'                           TO RC-COMM-FLG.
 11927
 11928     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11929         GO TO 1899-RECALC-COMM-EXTR-X.
 11930
 11931     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11932
 11933     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11934         GO TO 1899-RECALC-COMM-EXTR-X.
 11935
 11936     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11937
 11938     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11939         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11940             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11941
 11942     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11943         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11944                                           WK-NEW-RATES
 11945         GO TO 1899-RECALC-COMM-EXTR-X.
 11946
 11947     MOVE +1                            TO SUB8.
 11948     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11949
 11950 1610-CK-DUPLICATE-ENTRIES.
 11951     PERFORM 1620-CK-DUPL-ENTR-NEW
 11952         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11953             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11954
 11955 1619-CK-DUPLICATE-ENTRIES-XIT.
 11956     EXIT.
 11957
 11958 1620-CK-DUPL-ENTR-NEW.
 11959     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11960         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11961         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11962         MOVE +0                        TO CR-LCOM-L (SUB11)
 11963                                           CR-LCOM-AH (SUB11)
 11964         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11965         MOVE 11                        TO SUB12.
 11966
 11967 1629-CK-DUPL-ENTR-NEW-XIT.
 11968     EXIT.
 11969
 11970 1700-REVERSE-OLD-COMM-LOOP.
 11971     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 231
* ECS010.cbl
 11972     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11973
 11974     IF SUB8 LESS THAN +10
 11975         ADD +1 TO SUB8
 11976         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11977
 11978     MOVE 'O' TO RECALC-TYPE.
 11979
 11980     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11981
 11982     GO TO 1800-MOVE-NEW-COMM-RATES.
 11983
 11984 1710-DO-R-C-EXTRACTS.
 11985
 11986     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11987
 11988     PERFORM 1720-CHECK-COMM-LEVELS
 11989         THRU 1729-CHECK-COMM-LEVELS-EXIT
 11990             VARYING SUB13 FROM +1 BY +1
 11991                 UNTIL SUB13 GREATER THAN 10.
 11992
 11993     MOVE '8'                           TO DE-TRANS.
 11994     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 11995*****PERFORM EXTRACT-DATE-RELOAD.
 11996     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11997     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11998     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 11999     PERFORM EXTRACT-DATE-LOAD.
 12000     MOVE 'R'                           TO DE-REIN.
 12001     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12002     MOVE +1                            TO SUB1.
 12003     PERFORM 3110-REINSURE-ISSUE-LOOP
 12004         THRU 3119-REINSURE-ISSUE-LOOP-END.
 12005
 12006     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 12007         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 12008                                       2259-END-CANCEL-BUILD
 12009         PERFORM 1720-CHECK-COMM-LEVELS
 12010             THRU 1729-CHECK-COMM-LEVELS-EXIT
 12011                 VARYING SUB13 FROM +1 BY +1
 12012                     UNTIL SUB13 GREATER THAN 10
 12013         MOVE '7'                       TO DE-TRANS
 12014         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 12015*********PERFORM EXTRACT-DATE-RELOAD
 12016         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12017         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 12018         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 12019         PERFORM EXTRACT-DATE-LOAD
 12020         MOVE 'R'                       TO DE-REIN
 12021         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12022         MOVE +1                        TO SUB1
 12023         PERFORM 3210-REINSURE-CANCEL-LOOP
 12024             THRU 3219-REINSURE-CANCEL-LOOP-END.
 12025
 12026 1719-DO-R-C-EXTRACTS-X.
 12027     EXIT.
 12028
 12029 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 232
* ECS010.cbl
 12030
 12031     IF  DE-AGT (SUB13)       =  SPACES  AND
 12032         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 12033         DE-L-PC (SUB13)      =  ZEROS   AND
 12034         DE-A-PC (SUB13)      =  ZEROS
 12035         MOVE '0000000000'        TO  DE-AGT (SUB13).
 12036
 12037 1729-CHECK-COMM-LEVELS-EXIT.
 12038     EXIT.
 12039
 12040 1800-MOVE-NEW-COMM-RATES.
 12041     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 12042     MOVE 'N'                           TO RECALC-TYPE.
 12043     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12044     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 12045                                           CR-COMPENSATION-LEVELS.
 12046     IF DTE-CLIENT = 'DCC'
 12047        IF CR-LF-NSP-PRM NOT = ZEROS
 12048           COMPUTE CR-LF-NSP-PRM ROUNDED =
 12049              (CR-LFPRM + CR-LFPRM-ALT) -
 12050              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12051        END-IF
 12052        IF (CR-AH-NSP-PRM NOT = ZEROS)
 12053           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 12054                                        NOT = 'G' AND 'L')
 12055           COMPUTE CR-AH-NSP-PRM ROUNDED =
 12056           CR-AHPRM -
 12057           (CR-AHPRM * CR-LCOM-AH (1))
 12058        END-IF
 12059     END-IF
 12060     .
 12061
 12062 1899-RECALC-COMM-EXTR-X.
 12063     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 233
* ECS010.cbl
 12065******************************************************************
 12066***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 12067******************************************************************
 12068
 12069 2000-INITIALIZE-DETAIL-EXTRACT.
 12070
 12071     MOVE SPACES                   TO DETAIL-EXTRACT.
 12072
 12073     MOVE 'DE'                     TO DE-RECORD-ID.
 12074     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 12075     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 12076
 12077     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 12078     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 12079
 12080     MOVE CR-NAME                  TO DE-NAME.
 12081     MOVE CR-AGE                   TO DE-AGE.
 12082     MOVE CR-SEX                   TO DE-SEX.
 12083     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 12084
 12085     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 12086     MOVE CR-LF-TERM               TO DE-LF-TERM
 12087     MOVE CR-LOAN-TERM             TO DE-LOAN-TERM.
 12088     MOVE CR-LFAMT                 TO DE-LF-BEN.
 12089     MOVE ZEROS                    TO DE-LF-CNBEN.
 12090     MOVE CR-LFPRM                 TO DE-LF-PRM.
 12091     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 12092     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 12093     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 12094     MOVE ZEROS                    TO DE-LF-RFND.
 12095
 12096     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 12097     MOVE ZEROS                    TO DE-LF-CANC-DTE
 12098                                      DE-LF-CANC-EXIT-DT.
 12099
 12100     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 12101     MOVE CR-AH-TERM               TO DE-AH-TERM.
 12102     MOVE CR-AHAMT                 TO DE-AH-BEN.
 12103     MOVE CR-AHPRM                 TO DE-AH-PRM.
 12104     MOVE ZEROS                    TO DE-AH-RFND.
 12105
 12106     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 12107     MOVE ZEROS                    TO DE-AH-CANC-DTE
 12108                                      DE-AH-CANC-EXIT-DT.
 12109     IF DTE-CLIENT = 'DCC'
 12110        IF CR-ENTRY-STATUS = 'M'
 12111           MOVE CR-MOB-NET-TOT-FEES TO DE-MOB-NET-TOT-FEES
 12112        ELSE
 12113           IF AM-DCC-PRODUCT-CODE = 'DDF'
 12114              MOVE CR-DDF-IU-RATE-UP TO DE-IU-RATE-UP
 12115           END-IF
 12116        END-IF
 12117     END-IF
 12118
 12119     IF DTE-CLIENT = 'DCC'
 12120        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 12121        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 12122     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 234
* ECS010.cbl
 12123        IF (CR-LFTYP NOT = ZERO   AND
 12124           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 12125           (CR-AHTYP NOT = ZERO  AND
 12126           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 12127           MOVE CR-LIVES           TO DE-LIVES
 12128           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 12129                                      DE-CANCEL-CNT-YTD
 12130        END-IF
 12131     END-IF
 12132
 12133     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12134     IF AM-ZIP-PRIME NUMERIC
 12135        MOVE AM-ZIP-PRIME          TO DE-ZIP
 12136      ELSE
 12137        MOVE ZEROS                 TO DE-ZIP.
 12138     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 12139
 12140     MOVE CR-APR                   TO DE-APR.
 12141     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 12142     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 12143     MOVE CR-IND-GRP               TO DE-IG.
 12144     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 12145     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12146
 12147     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 12148     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE
 12149     MOVE CR-CANCEL-REASON         TO DE-CANCEL-REASON
 12150
 12151     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 12152*    MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 12153
 12154     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 12155                                      DE-REI-AHAMT  DE-REI-AHPRM
 12156                                      DE-REI-LFRFND DE-REI-AHRFND
 12157                                      DE-REI-CNAMT.
 12158
 12159     MOVE +1                       TO SUB1.
 12160
 12161* THIS WAS ADDED SO I COULD PASS THE CLP TO ECS017
 12162* FOR DEALER DIRECT OTHERWISE THERE WAS NO WAY TO
 12163* CALC IT IN ECS017.
 12164     IF DTE-CLIENT = 'DCC'
 12165        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 12166           MOVE CR-LF-CLP          TO DE-REI-LFPRM
 12167           IF CR-ACCOUNT = '05500500DD'
 12168              DISPLAY ' LF CLP ' DE-CERT-NO ' ' DE-REI-LFPRM
 12169                ' ' DE-REI-LFRFND
 12170           END-IF
 12171        END-IF
 12172        IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 12173                      OR
 12174           ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 12175            AND (AM-DCC-PRODUCT-CODE = 'DDF'))
 12176           MOVE CR-AH-CLP          TO DE-REI-AHPRM
 12177           MOVE CR-AH-RFND-CLP     TO DE-REI-AHRFND
 12178        END-IF
 12179     END-IF
 12180
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 235
* ECS010.cbl
 12181
 12182     PERFORM EXTRACT-DATE-LOAD.
 12183
 12184     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 12185                                      WS-DE-INCUR-N
 12186                                      WS-DE-PAY-N
 12187                                      WS-DE-PAID-TO-N
 12188                                      WS-DE-ACC-EXP-DTE-N
 12189                                      WS-DE-ACC-EFF-DTE-N
 12190                                      WS-DE-RSV-INCUR-N
 12191                                      WS-DE-RSV-PAYTO-N
 12192                                      WS-DE-ACC-EXP-DTE-RSV-N
 12193                                      WS-DE-ACC-EFF-DTE-RSV-N.
 12194
 12195 2090-GL-CODE-LOOP.
 12196
 12197     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 12198
 12199     IF SUB1 LESS THAN +10
 12200         ADD +1 TO SUB1
 12201         GO TO 2090-GL-CODE-LOOP.
 12202
 12203     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 12204
 12205     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 12206
 12207     IF (DTE-CLIENT = 'DCC')
 12208        AND (CR-AHTYP NOT = SPACES AND ZEROS)
 12209        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 12210        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 12211        AND (RECALC-TYPE = SPACES)
 12212        MOVE +1                  TO IA
 12213*       IF CR-ACCOUNT = '05500500DD'
 12214**      IF CR-CERT-NO = '0008773536 '
 12215*          DISPLAY ' MADE IT TO 2000 '
 12216*          DISPLAY ' CERT AREA  REIN ' DE-REIN ' ' CR-CERT-NO
 12217*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12218*             (IB > +10)
 12219*             IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 12220*                MOVE IB TO DIL-BEN-CODE
 12221*                MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 12222*                MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 12223*                DISPLAY DISPLAY-IBNR-LINE
 12224*             END-IF
 12225*          END-PERFORM
 12226*          DISPLAY ' TRLR AREA  '
 12227*          DISPLAY ' CS CERT NO ' CS-CERT-NO
 12228*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12229*             (IB > +10)
 12230*             IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 12231*                MOVE IB TO DIL-BEN-CODE
 12232*                MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 12233*                MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 12234*                DISPLAY DISPLAY-IBNR-LINE
 12235*             END-IF
 12236*          END-PERFORM
 12237*       END-IF
 12238        PERFORM VARYING IB FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 236
* ECS010.cbl
 12239           IB > +10
 12240           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 12241              CONTINUE
 12242           ELSE
 12243              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 12244                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 12245                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 12246                 COMPUTE DE-A-PC (IB) =
 12247                        WS-BNK-SPP-FEES (IA) / +1000
 12248                 MOVE +0              TO DE-L-PC (IB)
 12249                 ADD +1               TO IA
 12250              END-IF
 12251*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 12252*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 12253*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 12254*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 12255*                MOVE +0              TO DE-L-PC (IB)
 12256*                ADD +1               TO IA
 12257*             END-IF
 12258           END-IF
 12259        END-PERFORM
 12260     END-IF
 12261
 12262
 12263
 12264     .
 12265 2099-INIT-DTL-X.
 12266     EXIT.
 12267
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 237
* ECS010.cbl
 12269******************************************************************
 12270***            B U I L D   I S S U E   E X T R A C T           ***
 12271******************************************************************
 12272
 12273 2100-BUILD-ISSUE-EXTRACT.
 12274
 12275     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12276
 12277     MOVE 'I'                      TO DE-TRANS.
 12278
 12279     IF CHECK-BILLED
 12280         MOVE 'N' TO BILLED-SWITCH
 12281     ELSE
 12282         GO TO 2190-WRITE-ISSUE-EXTRACT.
 12283
 12284     MOVE +1                        TO SUB1.
 12285 2150-GA-BILL-LOOP.
 12286
 12287     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12288         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12289
 12290     IF SUB1 LESS THAN +5
 12291         ADD +1 TO SUB1
 12292         GO TO 2150-GA-BILL-LOOP.
 12293
 12294     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12295     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12296                                       DE-BILLED-LFRFND
 12297                                       DE-BILLED-AHPRM
 12298                                       DE-BILLED-AHRFND.
 12299
 12300     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12301         IF PB-LF-BILLED-AMTS = ZERO  AND
 12302            PB-AH-BILLED-AMTS = ZERO
 12303             MOVE ' '                    TO DE-BILL-STATUS
 12304         ELSE
 12305             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 12306                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 12307                 MOVE 'B'                TO DE-BILL-STATUS
 12308             ELSE
 12309                 MOVE 'R'                TO DE-BILL-STATUS
 12310                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 12311                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 12312     ELSE
 12313         MOVE 'B'                        TO DE-BILL-STATUS.
 12314
 12315 2190-WRITE-ISSUE-EXTRACT.
 12316
 12317     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12318
 12319 2199-BLD-ISSUE-X.
 12320     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 238
* ECS010.cbl
 12322******************************************************************
 12323***           B U I L D   C A N C E L   E X T R A C T          ***
 12324******************************************************************
 12325
 12326 2200-BUILD-CANCEL-EXTRACT.
 12327
 12328     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12329
 12330     MOVE 'C'                           TO DE-TRANS.
 12331
 12332     IF CR-LFTYP = ZERO
 12333         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12334
 12335     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 12336         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 12337             CR-LFRFND = +0
 12338              MOVE +0                   TO TEMP-5
 12339              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12340
 12341     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12342          IF CR-LFRFND = +0
 12343              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12344
 12345     MOVE +1 TO TEMP-5.
 12346     MOVE CR-LF-TERM             TO ORIG-TERM.
 12347     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 12348     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 12349     MOVE '1'                    TO W-VAL-SOURCE.
 12350     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 12351
 12352     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12353         MOVE CR-LFAMT TO DE-LF-CNBEN
 12354         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12355
 12356     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12357         GO TO 2220-BLD-DE-CANCEL-SUM.
 12358
 12359     IF REM-TRM3 = CR-LF-TERM
 12360         MOVE CR-LFAMT TO DE-LF-CNBEN
 12361         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12362
 12363     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 12364         GO TO 2210-BLD-DE-CANCEL-TEX.
 12365
 12366     IF DTE-CLIENT = 'NCL'
 12367         IF CR-DT LESS THAN 19910101
 12368             GO TO 2205-BLD-DE-CANCEL-BEN.
 12369
 12370     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 12371         GO TO 2230-BLD-DE-CANCEL-NP.
 12372
 12373     IF DTE-CLIENT = 'FUL'
 12374         GO TO 2240-BLD-DE-CANCEL-FUL.
 12375
 12376*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 12377     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 12378        (CR-RATING-CLASS NOT = 'L ')
 12379         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 239
* ECS010.cbl
 12380            (CR-LF-TERM GREATER THAN 060)  AND
 12381            (CR-DT GREATER THAN 19831031)
 12382              GO TO 2230-BLD-DE-CANCEL-NP.
 12383
 12384     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 12385         IF (CR-APR GREATER THAN ZERO)  AND
 12386            (CR-LF-TERM GREATER THAN 061)  AND
 12387            (CR-DT GREATER THAN 19830318)
 12388              GO TO 2230-BLD-DE-CANCEL-NP.
 12389
 12390     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 12391         IF (CR-APR GREATER THAN ZERO)  AND
 12392            (CR-LF-TERM GREATER THAN 062)  AND
 12393            (CR-DT GREATER THAN 19810831)  AND
 12394            (CR-DT LESS THAN 19830901)
 12395              GO TO 2230-BLD-DE-CANCEL-NP.
 12396
 12397     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 12398         IF (CR-APR GREATER THAN ZERO)  AND
 12399            (CR-LF-TERM GREATER THAN 060)  AND
 12400            (CR-DT GREATER THAN 19831231)
 12401              GO TO 2230-BLD-DE-CANCEL-NP.
 12402
 12403 2205-BLD-DE-CANCEL-BEN.
 12404
 12405     IF CR-LF-TERM EQUAL +0
 12406         MOVE +0          TO TEMP-5
 12407     ELSE
 12408         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 12409
 12410     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 12411
 12412     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12413
 12414 2210-BLD-DE-CANCEL-TEX.
 12415
 12416     DIVIDE CR-LFAMT BY CR-LF-TERM
 12417         GIVING TEX-FACT-1.
 12418     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 12419         GIVING TEX-FACT-2
 12420             REMAINDER TEX-FACT-3.
 12421     IF TEX-FACT-3 NOT = ZERO
 12422         ADD +1 TO TEX-FACT-2.
 12423     COMPUTE DE-LF-CNBEN =
 12424         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 12425
 12426     IF CR-LFAMT EQUAL +0
 12427         MOVE +0                  TO TEMP-5
 12428     ELSE
 12429         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12430
 12431     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12432
 12433 2220-BLD-DE-CANCEL-SUM.
 12434
 12435     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 12436     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 12437
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 240
* ECS010.cbl
 12438     IF CR-LFRFND NOT LESS CR-LFPRM
 12439         MOVE CR-LFAMT           TO DE-LF-CNBEN
 12440          GO TO 2250-CONTINUE-CANCEL-BUILD.
 12441
 12442     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 12443     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 12444     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12445         MOVE TEMP-7             TO DE-LF-CNBEN
 12446       ELSE
 12447         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 12448         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 12449
 12450     IF CR-LFAMT EQUAL +0
 12451         MOVE +0                  TO TEMP-5
 12452     ELSE
 12453         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 12454
 12455     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 12456         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12457
 12458 2230-BLD-DE-CANCEL-NP.
 12459
 12460     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 12461     MOVE 'L'                        TO  DC-OPTION-CODE.
 12462     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12463     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 12464
 12465     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 12466       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 12467       MOVE '3'                      TO  DC-OPTION-CODE
 12468       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12469       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 12470     ELSE
 12471       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 12472       MOVE '6'                      TO  DC-OPTION-CODE
 12473       MOVE +1                       TO  DC-ELAPSED-MONTHS
 12474       MOVE +0                       TO  DC-ELAPSED-DAYS
 12475       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12476       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 12477
 12478     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 12479     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 12480     MOVE CR-APR                     TO  CP-LOAN-APR.
 12481     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 12482     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 12483     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 12484     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 12485     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 12486     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 12487
 12488     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 12489     IF (DTE-CLIENT = 'DCC')
 12490        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12491        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 12492           ((CR-STATE = DD-STATE (D1))
 12493           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 12494           AND ('A'           = DD-BEN-TYPE   (D1))
 12495           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 241
* ECS010.cbl
 12496           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 12497                           OR
 12498           D1 > max-pdef
 12499        END-PERFORM
 12500        IF D1 <= max-pdef
 12501           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12502              (P1 > +8)
 12503              OR (DD-PROD-CODE (D1 P1) = 'L')
 12504           END-PERFORM
 12505           IF P1 < +9
 12506              MOVE DD-MAX-BEN-AMT (D1 P1)
 12507                                 TO CP-R-MAX-TOT-BEN
 12508           END-IF
 12509        END-IF
 12510     END-IF
 12511
 12512     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 12513
 12514     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12515         COMPUTE DE-LF-CNBEN =
 12516                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 12517      ELSE
 12518          COMPUTE DE-LF-CNBEN ROUNDED =
 12519                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
 12520
 12521     IF CR-LFAMT EQUAL +0
 12522         MOVE +0                  TO TEMP-5
 12523     ELSE
 12524         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12525
 12526     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12527
 12528 2240-BLD-DE-CANCEL-FUL.
 12529
 12530     MOVE CR-APR                  TO NP-APR.
 12531     MOVE CR-LF-TERM              TO NP-ORIG.
 12532     MOVE REM-TRM3                TO NP-REM.
 12533     MOVE '2'                     TO NP-OPT.
 12534     MOVE CR-AHPRM                TO NP-AHPRM.
 12535     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 12536     MOVE CR-LFAMT                TO NP-BENEFIT.
 12537
 12538*    CALL 'FULNETRM'
 12539*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 12540*              NP-ACCOUNT NP-REMAINING.
 12541
 12542     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 12543
 12544     IF CR-LFAMT EQUAL +0
 12545         MOVE +0                  TO TEMP-5
 12546     ELSE
 12547         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12548
 12549 2250-CONTINUE-CANCEL-BUILD.
 12550
 12551     MOVE CR-LFRFND                   TO DE-LF-RFND.
 12552     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 12553     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 242
* ECS010.cbl
 12554                                         WS-DE-LF-CANC-DTE-N.
 12555     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 12556                                         WS-DE-LF-CANC-EXIT-DT-N.
 12557     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 12558
 12559
 12560     MOVE ZEROS                  TO DCC-DDF-REM-TRM3
 12561     IF (DTE-CLIENT = 'DCC')
 12562        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12563        AND (CR-AHTYP NOT = '00' AND '  ')
 12564        MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 12565        MOVE CR-AH-TERM          TO ORIG-TERM
 12566        MOVE CR-AH-CANC-DT       TO VALUATION-DT
 12567        MOVE '1'                 TO W-VAL-SOURCE
 12568        DISPLAY ' 2250 B4 RTRM ' REM-TRM1 ' ' cr-cert-no
 12569        PERFORM 8500-REMAINING-TERM-ROUTINE
 12570                                 THRU 8599-REM-TERM-X
 12571        DISPLAY ' 2250 AFTER RTRM ' REM-TRM1
 12572        MOVE REM-TRM1            TO DE-DCC-DDF-REM-TRM3
 12573     END-IF
 12574
 12575     MOVE CR-AHRFND                   TO DE-AH-RFND.
 12576
 12577     IF DTE-CLIENT = 'DCC'
 12578        IF DE-AH-RFND = ZEROS
 12579           MOVE ZEROS                 TO DE-ADDL-CLP
 12580        END-IF
 12581     END-IF
 12582
 12583     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 12584     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 12585                                         WS-DE-AH-CANC-DTE-N.
 12586     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 12587                                         WS-DE-AH-CANC-EXIT-DT-N.
 12588     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 12589
 12590     IF PB-LAST-MAINT-BY = 'E570'
 12591         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12592
 12593     IF CHECK-BILLED
 12594         MOVE 'N' TO BILLED-SWITCH
 12595     ELSE
 12596         GO TO 2259-END-CANCEL-BUILD.
 12597
 12598     MOVE +1                        TO SUB1.
 12599 2255-GA-BILL-LOOP.
 12600
 12601     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12602         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12603
 12604     IF SUB1 LESS THAN +5
 12605         ADD +1 TO SUB1
 12606         GO TO 2255-GA-BILL-LOOP.
 12607
 12608     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12609     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 12610     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12611                                       DE-BILLED-LFRFND
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 243
* ECS010.cbl
 12612                                       DE-BILLED-AHPRM
 12613                                       DE-BILLED-AHRFND.
 12614
 12615     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12616         IF PB-LF-BILLED-AMTS = ZERO  AND
 12617            PB-AH-BILLED-AMTS = ZERO
 12618             MOVE ' '                    TO DE-BILL-STATUS
 12619         ELSE
 12620             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 12621                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 12622                 MOVE 'B'                TO DE-BILL-STATUS
 12623             ELSE
 12624                 MOVE 'R'                TO DE-BILL-STATUS
 12625                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 12626                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 12627     ELSE
 12628         MOVE 'B'                        TO DE-BILL-STATUS.
 12629
 12630 2259-END-CANCEL-BUILD.
 12631     EXIT.
 12632
 12633 2290-WRITE-CANCEL-EXTRACT.
 12634
 12635     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12636
 12637 2299-BLD-CANCEL-X.
 12638     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 244
* ECS010.cbl
 12640******************************************************************
 12641***            B U I L D   C L A I M   E X T R A C T           ***
 12642******************************************************************
 12643
 12644 2300-BUILD-CLAIM-EXTRACT.
 12645
 12646     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12647
 12648     MOVE 'X'                       TO DE-TRANS.
 12649
 12650     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 12651
 12652     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 12653     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 12654
 12655     MOVE INCURRED-DATE             TO DE-INCUR
 12656                                       WS-DE-INCUR-N.
 12657     MOVE REPORTED-DATE             TO DE-REPORTED.
 12658     MOVE PAYMENT-DATE              TO DE-PAY
 12659                                       WS-DE-PAY-N.
 12660     MOVE PAY-TO-DATE               TO DE-PAID-TO
 12661                                       WS-DE-PAID-TO-N.
 12662
 12663     MOVE PC-CLAIM-NO               TO DE-CNUM.
 12664     MOVE PC-CHECK-NO               TO DE-CHECK.
 12665     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 12666     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 12667     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 12668     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 12669     INSPECT DE-PAY-CODE
 12670         CONVERTING '1234569' TO 'PFSXEEV'.
 12671
 12672     MOVE AM-NAME                   TO DE-ACC-NAME.
 12673     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 12674                                       WS-DE-ACC-EXP-DTE-N.
 12675     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 12676                                       WS-DE-ACC-EFF-DTE-N.
 12677     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 12678     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 12679
 12680     IF DE-DTH  OR  DE-OB-DTH
 12681         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 12682     ELSE
 12683         IF CR-AH-LUMP-SUM-DISAB
 12684             MOVE CR-AH-STATUS-AT-SETTLEMENT
 12685                                    TO DE-AH-PREV-STAT.
 12686
 12687     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12688         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12689
 12690 2390-WRITE-CLAIM-EXTRACT.
 12691
 12692     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12693
 12694 2399-BLD-CLAIM-X.
 12695     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 245
* ECS010.cbl
 12697******************************************************************
 12698***          B U I L D   R E S E R V E   E X T R A C T         ***
 12699******************************************************************
 12700
 12701 2400-BUILD-RESERVE-EXTRACT.
 12702
 12703     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12704
 12705     MOVE 'Y'                         TO DE-TRANS.
 12706     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 12707
 12708     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 12709     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 12710     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 12711     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 12712     MOVE PC-REMAINING-BENEFIT        TO DE-RSV-REM-BENEFIT
 12713     MOVE PC-REMAINING-TERM           TO DE-RSV-REM-TERM
 12714
 12715     IF DTE-CLIENT  =  'NCL'
 12716        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 12717            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 12718
 12719     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 12720
 12721     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 12722                                         WS-DE-ACC-EXP-DTE-RSV-N.
 12723
 12724     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 12725                                         WS-DE-ACC-EFF-DTE-RSV-N.
 12726
 12727     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 12728                                         WS-DE-RSV-INCUR-N.
 12729     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 12730     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 12731                                         WS-DE-RSV-PAYTO-N.
 12732
 12733     MOVE ZEROS                       TO DE-REI-IBNR
 12734                                         DE-REI-PAYCUR
 12735                                         DE-REI-FUTRSV.
 12736
 12737     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 12738
 12739     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12740         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12741
 12742 2490-WRITE-RESERVE-EXTRACT.
 12743
 12744     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12745
 12746 2499-BLD-RESERVE-X.
 12747     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 246
* ECS010.cbl
 12749******************************************************************
 12750***          W R I T E   D E T A I L   E X T R A C T S         ***
 12751******************************************************************
 12752
 12753 2500-WRITE-DETAIL-EXTRACTS.
 12754
 12755
 12756     MOVE  ZEROS            TO  SUB.
 12757
 12758     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12759         GO TO 2520-WRITE-CONTINUE.
 12760
 12761 2510-ZERO-CHARGEBACK-LOOP.
 12762
 12763     ADD  +1                TO  SUB.
 12764
 12765     IF  SUB    GREATER  THAN     +10
 12766         GO TO  2520-WRITE-CONTINUE.
 12767
 12768*    DISPLAY ' CERT NO ' CR-CERT-NO
 12769*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12770*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12771
 12772
 12773     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12774         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12775
 12776     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12777         OR ((CR-AH-REFUND-TYPE = 'G') AND (CR-AHRFND = ZEROS))
 12778         OR (WS-DDF-AH-CB (SUB) = 'N')
 12779         MOVE  ZEROS             TO DE-A-PC (SUB)
 12780     END-IF
 12781
 12782     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12783
 12784 2520-WRITE-CONTINUE.
 12785
 12786     IF DTE-CLIENT NOT = 'HER'
 12787         GO TO 2590-WRITE-EXTRACTS.
 12788
 12789     IF DE-REINCO NOT = 'LNL'
 12790         GO TO 2590-WRITE-EXTRACTS.
 12791
 12792     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12793         GO TO 2590-WRITE-EXTRACTS.
 12794
 12795     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12796     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12797     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12798     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12799     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12800     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12801     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12802     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12803     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12804     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12805
 12806     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 247
* ECS010.cbl
 12807     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12808     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12809     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12810     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12811     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12812     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12813     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12814     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12815     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12816
 12817
 12818 2590-WRITE-EXTRACTS.
 12819
 12820     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12821                                     WS-DE-PROC-DT-N.
 12822
 12823     IF DTE-PGM-OPT = '1'
 12824         ADD +1                   TO DE-CNT
 12825*********PERFORM EXTRACT-DATE-RELOAD
 12826         WRITE DETAIL-EXTRACT.
 12827
 12828
 12829 2599-WRT-DETAIL-X.
 12830     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 248
* ECS010.cbl
 12832******************************************************************
 12833***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12834******************************************************************
 12835
 12836 3000-REINSURE-ROUTINE.
 12837
 12838     IF (CR-POLICY-IS-DECLINED) OR
 12839        (CR-POLICY-IS-VOID)
 12840        GO TO 3099-REINSURE-ROUTINE-X.
 12841
 12842     IF REIN-FLG = 'X'
 12843         GO TO 3099-REINSURE-ROUTINE-X.
 12844
 12845     MOVE 'X' TO REIN-FLG.
 12846
 12847     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12848
 12849     IF CR-REIN-TABLE = SPACES OR ZEROS
 12850         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12851
 12852******************************************************************
 12853***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12854******************************************************************
 12855
 12856 3010-RR-READ-REIN.
 12857
 12858     IF REIN-OPEN-SW = ' '
 12859         MOVE 'X'                       TO REIN-OPEN-SW
 12860         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12861         MOVE 'A'                       TO REIN-SRCH-CODE
 12862         OPEN INPUT ERRTBL-IN
 12863         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12864             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12865          ELSE
 12866             MOVE '21'                  TO ABEND-CODE-1
 12867             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12868             DISPLAY '******************************'
 12869             DISPLAY '***** ERROR LOCATION 015 *****'
 12870             DISPLAY '******************************'
 12871             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12872             GO TO ABEND-PGM.
 12873
 12874     IF CR-REIN-TABLE = REIN-SRCH
 12875         GO TO 3019-RR-READ-REIN-X.
 12876
 12877     MOVE +0                            TO REIN-SUB-1.
 12878     MOVE 999999                        TO REIN-LOW-TIME.
 12879     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12880
 12881 3011-RR-CHECK-REIN-SAVE-TABLE.
 12882
 12883     ADD +1                             TO REIN-SUB-1.
 12884     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12885        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12886         GO TO 3015-RR-READ-ERRTBL.
 12887
 12888     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12889         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 249
* ECS010.cbl
 12890         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12891         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12892         GO TO 3019-RR-READ-REIN-X.
 12893
 12894     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12895         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12896         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12897
 12898     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12899
 12900 3015-RR-READ-ERRTBL.
 12901
 12902     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12903
 12904     READ ERRTBL-IN.
 12905
 12906     IF ERRTBL-FILE-STATUS  = '23'
 12907         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12908                                           ' ' CR-FULL-CONTROL
 12909         MOVE '24'                      TO ABEND-CODE-1
 12910         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12911         DISPLAY '******************************'
 12912         DISPLAY '***** ERROR LOCATION 016 *****'
 12913         DISPLAY '******************************'
 12914         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12915         GO TO ABEND-PGM.
 12916
 12917     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12918         NEXT SENTENCE
 12919       ELSE
 12920         MOVE '24'                      TO ABEND-CODE-1
 12921         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12922         DISPLAY '******************************'
 12923         DISPLAY '***** ERROR LOCATION 017 *****'
 12924         DISPLAY '******************************'
 12925         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12926         GO TO ABEND-PGM.
 12927
 12928     ADD +1                            TO ERRTBL-READS.
 12929
 12930     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12931         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12932         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12933         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12934     ELSE
 12935         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12936         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12937         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12938         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12939
 12940 3019-RR-READ-REIN-X.
 12941     EXIT.
 12942
 12943 3020-CALCULATE-REINSURANCE.
 12944
 12945*    IF DTE-CLIENT = '???'  AND
 12946*       (CR-REIN-TABLE = 'SE1')
 12947*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 250
* ECS010.cbl
 12948*        IF CR-STATE NOT = STATE-L
 12949*            MOVE CR-STATE             TO STATE-L
 12950*            PERFORM 8200-STATE-CODE-LOOKUP
 12951*                         THRU 8299-STATE-LOOKUP-X.
 12952
 12953
 12954*    IF DTE-CLIENT = 'DCC'
 12955*       IF CR-LF-NSP-PRM NOT = ZEROS
 12956*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12957*             (CR-LFPRM + CR-LFPRM-ALT) -
 12958*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12959*       END-IF
 12960*       IF CR-AH-NSP-PRM NOT = ZEROS
 12961*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12962*          CR-AHPRM -
 12963*          (CR-AHPRM * CR-LCOM-AH (1))
 12964*       END-IF
 12965*    END-IF
 12966
 12967
 12968     IF RE-REMAINING (1) = 'I'
 12969         MOVE '*'                      TO RISK-REIN-FLAG
 12970     ELSE
 12971         GO TO 3029-CONTINUE-REIN-CALC.
 12972
 12973     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 12974                                          REIN-CANCEL-AH-SW.
 12975     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 12976                                          REIN-LCNC-EARN-TERM
 12977                                          REIN-LF-CLM-MONTHS
 12978                                          REIN-EARN-AH-TERM
 12979                                          REIN-ACNC-EARN-TERM
 12980                                          REIN-AH-PRIOR-CLMS-PAID
 12981                                          REIN-AH-CLM-MONTHS
 12982                                          REIN-AH-CLM-MTH-1
 12983                                          REIN-AH-CLM-MTH-2
 12984                                          REIN-AH-CLM-MTH-3
 12985                                          REIN-AH-CLM-MTH-4
 12986                                          REIN-AH-CLM-MTH-5.
 12987
 12988*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 12989*    MOVE 'L'                          TO DC-OPTION-CODE.
 12990*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12991*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 12992
 12993     IF CR-LFTYP = ZEROS  OR  SPACES
 12994         GO TO 3023-CONTINUE.
 12995
 12996     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12997
 12998     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 12999       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13000           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 13001
 13002     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 13003       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 13004           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 13005
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 251
* ECS010.cbl
 13006     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13007     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13008
 13009     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 13010         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 13011     ELSE
 13012         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 13013
 13014     IF CR-LF-CANC-DT NOT = ZEROS
 13015         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 13016         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13017         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 13018         IF CR-DT = CR-LF-CANC-DT
 13019             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 13020
 13021     IF CR-DTH-DT NOT = ZEROS
 13022         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 13023         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13024         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 13025
 13026     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 13027
 13028
 13029 3023-CONTINUE.
 13030
 13031     IF CR-AHTYP = ZEROS  OR  SPACES
 13032        GO TO 3029-CONTINUE-REIN-CALC.
 13033
 13034     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13035
 13036     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 13037       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13038           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 13039
 13040     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 13041       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 13042           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 13043
 13044     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13045     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13046
 13047     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 13048         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 13049     ELSE
 13050         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 13051
 13052     IF CR-AH-CANC-DT NOT = ZEROS
 13053         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 13054         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13055         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 13056         IF CR-DT = CR-AH-CANC-DT
 13057             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 13058
 13059     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 13060         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 13061         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13062         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 13063
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 252
* ECS010.cbl
 13064     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 13065         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 13066         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13067         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 13068
 13069     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 13070         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 13071         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13072         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 13073
 13074     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 13075         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 13076         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13077         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 13078
 13079     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 13080         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 13081         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13082         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 13083
 13084     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 13085
 13086
 13087     GO TO 3029-CONTINUE-REIN-CALC.
 13088
 13089
 13090 3025-CALC-ELAPSED-MONTHS.
 13091
 13092     MOVE 'L'                          TO DC-OPTION-CODE.
 13093     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13094     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 13095     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 13096     MOVE '1'                          TO DC-OPTION-CODE.
 13097     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 13098     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 13099                                          DC-ODD-DAYS-OVER
 13100                                          DC-ELAPSED-DAYS.
 13101     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13102
 13103 3026-CALC-EXIT.
 13104     EXIT.
 13105
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 253
* ECS010.cbl
 13107 3029-CONTINUE-REIN-CALC.
 13108
*13109                             COPY ECSRTPFM.
 13110******************************************************************07/10/97
 13111*                                                                *ECSRTPFM
 13112*                            ECSRTPFM                            *   LV001
 13113*                            VMOD=2.002                          *ECSRTPFM
 13114*                                                                *ECSRTPFM
 13115******************************************************************ECSRTPFM
 13116                                                                  ECSRTPFM
 13117     IF    CR-LFAMT  NUMERIC                                      00000072
 13118           NEXT SENTENCE                                          00000073
 13119        ELSE                                                      00000074
 13120           MOVE ZEROS TO CR-LFAMT.                                00000075
 13121                                                                  00000076
 13122     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 13123           NEXT SENTENCE                                          00000078
 13124        ELSE                                                      00000079
 13125           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 13126                                                                  00000081
 13127                                                                  00000082
 13128     IF    CR-LFPRM  NUMERIC                                      00000083
 13129           NEXT SENTENCE                                          00000084
 13130        ELSE                                                      00000085
 13131           MOVE ZEROS TO CR-LFPRM.                                00000086
 13132                                                                  00000087
 13133     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 13134           NEXT SENTENCE                                          00000089
 13135        ELSE                                                      00000090
 13136           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 13137                                                                  00000092
 13138                                                                  00000093
 13139     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 13140           NEXT SENTENCE                                          00000095
 13141        ELSE                                                      00000096
 13142           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 13143                                                                  00000098
 13144     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 13145           NEXT SENTENCE                                          00000100
 13146        ELSE                                                      00000101
 13147           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 13148                                                                  00000103
 13149     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 13150           NEXT SENTENCE                                          00000105
 13151        ELSE                                                      00000106
 13152           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 13153                                                                  00000108
 13154     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 13155     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 13156     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 13157         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 13158     ELSE                                                         ECSRTPFM
 13159         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 13160     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 13161                                                                  ECSRTPFM
 13162     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 13163     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 13164     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 254
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 13165         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 13166     ELSE                                                         ECSRTPFM
 13167         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 13168     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 13169                                                                  ECSRTPFM
 13170     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 13171         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 13172             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 13173                                                                  ECSRTPFM
 13174
 13175     MOVE 'X'                  TO REIN-RT-SW.
 13176     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 13177     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 13178     MOVE ' '                  TO REIN-RT-SW.
 13179
 13180 3030-RE-CALCULATE-REINSURANCE.
 13181
 13182     IF AM-RECALC-REIN = 'Y'
 13183         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 13184            CR-REIN-SPEC = SPACE  AND
 13185            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 13186             PERFORM 3600-RC-REINSURANCE
 13187                 THRU 3799-RC-REINSURANCE-X.
 13188
 13189     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 13190         VARYING SUB1 FROM 1 BY 1
 13191             UNTIL REIN-COMP (SUB1) = SPACES.
 13192
 13193     GO TO 3099-REINSURE-ROUTINE-X.
 13194
 13195 3040-REIN-REC-CNT.
 13196
 13197     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 13198         GO TO 3049-RRC-XIT.
 13199
 13200     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 13201         VARYING B-SUB FROM 1 BY 1
 13202             UNTIL B-SUB GREATER THAN 50.
 13203
 13204 3049-RRC-XIT.
 13205     EXIT.
 13206
 13207 3050-REIN-COMP-ADD.
 13208
 13209     IF RB-COMPANY (B-SUB) = SPACES
 13210         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 13211     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 13212         MOVE 1   TO RB-COUNT (B-SUB)
 13213         MOVE +50 TO B-SUB.
 13214
 13215 3059-RCA-XIT.
 13216     EXIT.
 13217
 13218 3099-REINSURE-ROUTINE-X.
 13219     EXIT.
 13220
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 255
* ECS010.cbl
 13222******************************************************************
 13223***                R E I N S U R E   I S S U E S               ***
 13224******************************************************************
 13225
 13226 3100-REINSURE-ISSUE.
 13227
 13228     IF  REIN-COMP (1) = SPACES
 13229         GO TO 3199-REINSURE-ISSUE-X.
 13230
 13231     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 13232     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13233     MOVE 'I'      TO DE-TRANS.
 13234     MOVE 'R'      TO DE-REIN.
 13235*****PERFORM EXTRACT-DATE-RELOAD.
 13236     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13237     MOVE +1       TO SUB1.
 13238
 13239 3110-REINSURE-ISSUE-LOOP.
 13240
 13241     IF REIN-COMP (SUB1) = SPACES
 13242         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 13243
 13244     IF UPDATING-RISK-PREMIUMS
 13245       IF REIN-REM-SW (SUB1) NOT = 'I'
 13246         ADD +1 TO SUB1
 13247         GO TO 3110-REINSURE-ISSUE-LOOP.
 13248
 13249     IF REIN-REM-SW (SUB1) = 'Z'
 13250         ADD +1 TO SUB1
 13251         GO TO 3110-REINSURE-ISSUE-LOOP.
 13252
 13253     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13254     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13255     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13256     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13257     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13258     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13259
 13260     IF REIN-REM-SW (SUB1) NOT = 'I'
 13261         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13262
 13263     IF RWF-LFPRM = ZEROS  AND
 13264        RWF-AHPRM = ZEROS
 13265         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13266
 13267     IF RWF-LFPRM NOT = ZEROS
 13268         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 13269         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 13270
 13271     IF RWF-AHPRM NOT = ZEROS
 13272         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 13273         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 13274
 13275 3115-CONTINUE-ISSUE-LOOP.
 13276
 13277     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 13278     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 13279
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 256
* ECS010.cbl
 13280     IF DE-REI-LFAMT NOT = ZERO
 13281        OR DE-REI-LFPRM NOT = ZERO
 13282        OR DE-REI-AHAMT NOT = ZERO
 13283        OR DE-REI-AHPRM NOT = ZERO
 13284         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13285                 2599-WRT-DETAIL-X
 13286         ADD +1 TO BC-R-ISS.
 13287
 13288     ADD +1 TO SUB1.
 13289     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13290     PERFORM EXTRACT-DATE-LOAD.
 13291
 13292     GO TO 3110-REINSURE-ISSUE-LOOP.
 13293
 13294 3119-REINSURE-ISSUE-LOOP-END.
 13295     EXIT.
 13296
 13297 3190-REINSURE-ISSUE-PRINT.
 13298
 13299     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13300     IF RW-ACCUM-LF NOT = ZERO
 13301         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13302         MOVE CR-LF-TERM               TO TRD-LFTRM
 13303         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13304         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 13305     IF RW-ACCUM-AH NOT = ZERO
 13306         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13307         MOVE CR-AH-TERM               TO TRD-AHTRM
 13308         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13309         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 13310     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 13311         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13312
 13313 3199-REINSURE-ISSUE-X.
 13314     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 257
* ECS010.cbl
 13316******************************************************************
 13317***               R E I N S U R E   C A N C E L S              ***
 13318******************************************************************
 13319
 13320 3200-REINSURE-CANCEL.
 13321
 13322     IF REIN-COMP (1) = SPACES
 13323         GO TO 3299-REINSURE-CANCEL-X.
 13324
 13325     IF CR-LFRFND = ZERO
 13326        AND CR-AHRFND = ZERO
 13327         GO TO 3299-REINSURE-CANCEL-X.
 13328
 13329     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 13330             VARYING SUB1 FROM +1 BY +1 UNTIL
 13331                       REIN-COMP (SUB1) = SPACES.
 13332
 13333     IF REIN-RT-SW = 'X'
 13334         GO TO 3299-REINSURE-CANCEL-X.
 13335
 13336     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 13337     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13338     MOVE 'R'      TO DE-REIN.
 13339*****PERFORM EXTRACT-DATE-RELOAD.
 13340     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13341     MOVE +1       TO SUB1.
 13342
 13343 3210-REINSURE-CANCEL-LOOP.
 13344
 13345     IF REIN-COMP (SUB1) = SPACES
 13346         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 13347
 13348     IF REIN-REM-SW (SUB1) = 'Z'
 13349         ADD +1        TO SUB1
 13350         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13351         PERFORM EXTRACT-DATE-LOAD
 13352         GO TO 3210-REINSURE-CANCEL-LOOP.
 13353
 13354     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13355     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13356
 13357     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 13358     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 13359     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13360     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13361     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13362     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13363     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 13364     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 13365     COMPUTE DE-REI-CNAMT ROUNDED = RWF-LFAMT * TEMP-5.
 13366
 13367     IF REIN-REM-SW (SUB1) NOT = 'I'
 13368         GO TO 3215-CONTINUE-CANCEL-LOOP.
 13369
 13370     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13371        VOIDING-LF-CANCEL
 13372         NEXT SENTENCE
 13373     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 258
* ECS010.cbl
 13374         MOVE ZEROS             TO DE-REI-LFRFND.
 13375
 13376     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13377        VOIDING-AH-CANCEL
 13378         NEXT SENTENCE
 13379     ELSE
 13380         MOVE ZEROS             TO DE-REI-AHRFND.
 13381
 13382 3215-CONTINUE-CANCEL-LOOP.
 13383
 13384     IF RWF-LF-RUNOFF-SW = 'N'
 13385         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13386             MOVE ZEROS         TO DE-LF-TYPE
 13387                                   DE-REI-LFAMT
 13388                                   DE-REI-LFPRM
 13389                                   DE-REI-LFRFND
 13390                                   DE-REI-CNAMT.
 13391
 13392     IF RWF-AH-RUNOFF-SW = 'N'
 13393         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13394             MOVE ZEROS         TO DE-AH-TYPE
 13395                                   DE-REI-AHAMT
 13396                                   DE-REI-AHPRM
 13397                                   DE-REI-AHRFND.
 13398
 13399     IF DE-REI-LFAMT NOT = ZERO
 13400        OR DE-REI-LFPRM NOT = ZERO
 13401        OR DE-REI-AHAMT NOT = ZERO
 13402        OR DE-REI-AHPRM NOT = ZERO
 13403        OR DE-REI-LFRFND NOT = ZERO
 13404        OR DE-REI-AHRFND NOT = ZERO
 13405        OR DE-REI-CNAMT NOT = ZERO
 13406         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13407                                            2599-WRT-DETAIL-X
 13408         ADD +1 TO BC-R-CNC.
 13409
 13410     ADD +1 TO SUB1.
 13411     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13412     PERFORM EXTRACT-DATE-LOAD.
 13413     GO TO 3210-REINSURE-CANCEL-LOOP.
 13414
 13415 3219-REINSURE-CANCEL-LOOP-END.
 13416     EXIT.
 13417
 13418 3290-REINSURE-CANCEL-PRINT.
 13419
 13420     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13421     IF RW-ACCUM-LF NOT = ZERO
 13422         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13423         MOVE CR-LF-TERM               TO TRD-LFTRM
 13424         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13425         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 13426     IF RW-ACCUM-AH NOT = ZERO
 13427         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13428         MOVE CR-AH-TERM               TO TRD-AHTRM
 13429         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13430         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 13431     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 259
* ECS010.cbl
 13432         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13433
 13434 3299-REINSURE-CANCEL-X.
 13435     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 260
* ECS010.cbl
 13437******************************************************************
 13438***                R E I N S U R E   C L A I M S               ***
 13439******************************************************************
 13440
 13441 3300-REINSURE-CLAIM.
 13442
 13443*    IF DTE-CLIENT = '???'
 13444*       IF (REIN-RT-SW NOT = 'X')  AND
 13445*          (PC-PAYMENT-TYPE = '5' OR '6')
 13446*        GO TO 3399-REINSURE-CLAIM-X.
 13447
 13448     IF REIN-COMP (1) = SPACES
 13449         GO TO 3399-REINSURE-CLAIM-X.
 13450
 13451     IF REIN-RT-SW = 'X'
 13452         MOVE CR-DTHAMT   TO RW-LFCLMWK
 13453         ADD  CR-DTHEXP   TO RW-LFCLMWK
 13454         MOVE CR-DISAMT   TO RW-AHCLMWK
 13455         ADD  CR-DISEXP   TO RW-AHCLMWK
 13456     ELSE
 13457         IF PC-CLAIM-TYPE  = 1 OR 3
 13458             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 13459             MOVE +0                  TO RW-AHCLMWK
 13460         ELSE
 13461             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 13462             MOVE +0                  TO RW-LFCLMWK.
 13463
 13464     MOVE +0                          TO RW-LFCLM
 13465                                         RW-AHCLM.
 13466     IF RW-LFCLMWK = ZERO
 13467        AND RW-AHCLMWK = ZERO
 13468         GO TO 3399-REINSURE-CLAIM-X.
 13469
 13470     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 13471         VARYING SUB1 FROM +1 BY +1
 13472             UNTIL REIN-COMP (SUB1) = SPACES.
 13473
 13474     IF REIN-RT-SW = 'X'
 13475         GO TO 3399-REINSURE-CLAIM-X.
 13476
 13477     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 13478     MOVE ZEROS                TO RW-ACCUM-CLM.
 13479     MOVE 'R'                  TO DE-REIN.
 13480*****PERFORM EXTRACT-DATE-RELOAD.
 13481     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 13482     MOVE +1                   TO SUB1.
 13483
 13484 3310-REINSURE-CLAIM-LOOP.
 13485
 13486     IF REIN-COMP (SUB1) = SPACES
 13487         GO TO 3390-REINSURE-CLAIM-PRINT.
 13488
 13489     IF REIN-REM-SW (SUB1) = 'Z'
 13490         ADD +1        TO SUB1
 13491         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13492         PERFORM EXTRACT-DATE-LOAD
 13493         GO TO 3310-REINSURE-CLAIM-LOOP.
 13494
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 261
* ECS010.cbl
 13495     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13496     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13497
 13498     IF PC-CLAIM-TYPE  = 1 OR 3
 13499         IF RWF-LF-RUNOFF-SW = 'N'
 13500           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13501               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13502
 13503     IF PC-CLAIM-TYPE  = 2 OR 4
 13504         IF RWF-AH-RUNOFF-SW = 'N'
 13505           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13506               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13507
 13508     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13509     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13510     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13511     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13512
 13513     IF PC-CLAIM-TYPE  = 1 OR 3
 13514         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 13515         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 13516     ELSE
 13517         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 13518         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 13519
 13520     IF PC-CLAIM-TYPE = 1 OR 3
 13521         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 13522            AND DE-REI-CLAIM-AMT
 13523             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13524         ELSE
 13525             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 13526     ELSE
 13527         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 13528            AND DE-REI-CLAIM-AMT
 13529             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13530         ELSE
 13531             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 13532
 13533 3320-REINSURE-CLAIM-LOOP-GO.
 13534
 13535     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 13536     ADD +1                     TO BC-R-CLM.
 13537
 13538 3330-REINSURE-CLAIM-LOOP-ADD.
 13539
 13540     ADD +1                     TO SUB1.
 13541     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 13542     PERFORM EXTRACT-DATE-LOAD.
 13543     GO TO 3310-REINSURE-CLAIM-LOOP.
 13544
 13545 3390-REINSURE-CLAIM-PRINT.
 13546
 13547     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13548     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13549         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13550         MOVE CR-LF-TERM               TO TRD-LFTRM
 13551         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 13552         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 262
* ECS010.cbl
 13553     ELSE
 13554         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13555         MOVE CR-AH-TERM               TO TRD-AHTRM
 13556         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 13557         MOVE CR-DIS-MO        TO TRD-AHACTMO
 13558         MOVE CR-DIS-DA        TO TRD-AHACTDA
 13559         MOVE CR-DIS-YR        TO TRD-AHACTYR
 13560         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 13561         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 13562     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13563
 13564 3399-REINSURE-CLAIM-X.
 13565     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 263
* ECS010.cbl
 13567******************************************************************
 13568***              R E I N S U R E   R E S E R V E S             ***
 13569******************************************************************
 13570
 13571 3400-REINSURE-RESERVE.
 13572
 13573     IF REIN-COMP (1) = SPACES
 13574         GO TO 3499-REINSURE-RESERVE-X.
 13575
 13576     IF PC-CLAIM-TYPE = '1' OR '3'
 13577         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 13578         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 13579         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 13580         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 13581         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 13582     ELSE
 13583         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 13584         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 13585         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 13586         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 13587         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 13588
 13589     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 13590                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 13591     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 13592         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 13593          GO TO 3499-REINSURE-RESERVE-X.
 13594
 13595     IF DTE-CLIENT NOT = 'MIC'
 13596         GO TO 3405-REINSURE-RESERVE-CONT.
 13597
 13598     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13599         GO TO 3405-REINSURE-RESERVE-CONT.
 13600
 13601     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 13602     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 13603     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 13604     MOVE 'A'                        TO CP-BENEFIT-TYPE
 13605                                        CP-CLAIM-TYPE.
 13606     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 13607     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 13608     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 13609     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 13610     MOVE ZEROS                      TO CP-CDT-PERCENT.
 13611     MOVE '3'                        TO CP-CDT-METHOD.
 13612     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 13613     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 13614                                        CP-RATING-BENEFIT-AMT.
 13615     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 13616     MOVE 'O'                        TO CP-CLAIM-STATUS.
 13617
 13618 3405-REINSURE-RESERVE-CONT.
 13619
 13620     PERFORM 3500-REINSURE-CALC-RESERVE
 13621         THRU 3599-REINSURE-CALC-RESERVE-X
 13622             VARYING SUB1 FROM +1 BY +1
 13623                 UNTIL REIN-COMP (SUB1) = SPACES.
 13624
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 264
* ECS010.cbl
 13625     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 13626     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 13627     MOVE 'R'            TO DE-REIN.
 13628*****PERFORM EXTRACT-DATE-RELOAD.
 13629     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13630     MOVE +1             TO SUB1.
 13631
 13632 3410-REINSURE-RESERVE-LOOP.
 13633
 13634     IF REIN-COMP (SUB1) = SPACES
 13635         GO TO 3490-REINSURE-RESERVE-PRINT.
 13636
 13637     IF REIN-REM-SW (SUB1) = 'Z'
 13638         ADD +1 TO SUB1
 13639         GO TO 3410-REINSURE-RESERVE-LOOP.
 13640
 13641     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13642     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13643
 13644     IF PC-CLAIM-TYPE  = 1 OR 3
 13645         IF RWF-LF-RUNOFF-SW = 'N'
 13646           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13647               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13648
 13649     IF PC-CLAIM-TYPE  = 2 OR 4
 13650         IF RWF-AH-RUNOFF-SW = 'N'
 13651           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13652               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13653
 13654     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13655     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13656     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13657     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13658
 13659     IF PC-CLAIM-TYPE = 1 OR 3
 13660         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 13661         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 13662         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 13663     ELSE
 13664         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 13665         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 13666         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 13667
 13668     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 13669     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 13670     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 13671
 13672     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 13673        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 13674        OR DE-REI-FUTRSV
 13675         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13676                                            2599-WRT-DETAIL-X
 13677         ADD +1 TO BC-R-CRS.
 13678
 13679 3415-REINSURE-RESERVE-LOOP-ADD.
 13680
 13681     ADD +1 TO SUB1.
 13682     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 265
* ECS010.cbl
 13683     PERFORM EXTRACT-DATE-LOAD.
 13684     GO TO 3410-REINSURE-RESERVE-LOOP.
 13685
 13686 3490-REINSURE-RESERVE-PRINT.
 13687
 13688     IF RW-ACCUM-IBNR   = ZERO  AND
 13689        RW-ACCUM-PAYCUR = ZERO  AND
 13690        RW-ACCUM-FUTRSV = ZERO
 13691         GO TO 3499-REINSURE-RESERVE-X.
 13692
 13693     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13694     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 13695     MOVE 'IBNR'                    TO TRD-IBNRX.
 13696     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 13697     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 13698     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 13699     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 13700
 13701     IF PC-CLAIM-TYPE = 1
 13702         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 13703     ELSE
 13704         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 13705     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 13706
 13707     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13708
 13709 3499-REINSURE-RESERVE-X.
 13710     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 266
* ECS010.cbl
 13712******************************************************************
 13713***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 13714******************************************************************
 13715
 13716 3500-REINSURE-CALC-RESERVE.
 13717
 13718     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13719     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 13720                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 13721
 13722     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 13723        VARYING CO-SUB FROM 1 BY 1 UNTIL
 13724          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 13725       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 13726
 13727     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 13728        MOVE ZERO TO CO-SUB.
 13729
 13730     IF CO-SUB NOT = ZERO
 13731        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13732           IF PC-CLAIM-TYPE = '1' OR '3'
 13733             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13734                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13735
 13736     IF PC-CLAIM-TYPE  = 1 OR 3
 13737         IF RWF-LF-RUNOFF-SW = 'N'
 13738           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13739               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13740
 13741     IF CO-SUB NOT = ZERO
 13742        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13743           IF PC-CLAIM-TYPE = '2' OR '4'
 13744             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13745                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13746
 13747     IF PC-CLAIM-TYPE  = 2 OR 4
 13748         IF RWF-AH-RUNOFF-SW = 'N'
 13749           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13750               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13751
 13752     IF DTE-CLIENT NOT = 'MIC'
 13753         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13754
 13755     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13756         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13757
 13758     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13759
 13760     IF CR-AHTYP = ZERO  OR
 13761        CO-SUB = ZERO
 13762         GO TO 3505-REIN-CALC-RESERVE-CONT
 13763     ELSE
 13764         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13765             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13766
 13767     COMPUTE MAX-REM-TERM ROUNDED =
 13768                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13769
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 267
* ECS010.cbl
 13770     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13771         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13772
 13773     COMPUTE CP-ORIGINAL-TERM =
 13774                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13775
 13776     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13777
 13778     IF  CP-RETURN-CODE = ZERO
 13779         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13780
 13781 3505-REIN-CALC-RESERVE-CONT.
 13782
 13783     IF SUB1 = RE-100-COMP
 13784         GO TO 3520-REIN-REMAINDER-RSRV.
 13785
 13786     IF CR-LFAMT NOT = ZERO  AND
 13787        RWF-LFAMT NOT = ZERO
 13788         IF DTE-CLIENT NOT = 'MIC'
 13789             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13790                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13791             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13792                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13793             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13794                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13795         ELSE
 13796             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13797             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13798             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13799
 13800     IF CR-AHAMT NOT = ZERO  AND
 13801        RWF-AHAMT NOT = ZERO
 13802         IF DTE-CLIENT NOT = 'MIC'
 13803             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13804                         RWF-AHAMT) / CR-AHAMT
 13805             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13806                         RWF-AHAMT) / CR-AHAMT
 13807             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13808                         RWF-AHAMT) / CR-AHAMT
 13809         ELSE
 13810             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13811             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13812             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13813
 13814 3510-REINSURE-CALC-RESERVE-ADD.
 13815
 13816     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13817     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13818     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13819     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13820     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13821     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13822
 13823     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13824         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13825
 13826     IF CO-SUB = ZERO
 13827         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 268
* ECS010.cbl
 13828
 13829 3513-REIN-CHK-LF-RSRV-LIMIT.
 13830     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13831         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13832
 13833     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13834         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13835
 13836     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13837                                      (RWF-LFCLM +
 13838                                       RWF-DTH-PAYCUR +
 13839                                       RWF-DTH-FUTRSV).
 13840
 13841     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13842         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13843
 13844     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13845
 13846     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13847         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13848         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13849     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13850         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13851
 13852     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13853
 13854     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13855         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13856         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13857     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13858         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13859
 13860 3515-REIN-CHK-AH-RSRV-LIMIT.
 13861     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13862         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13863
 13864     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13865         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13866
 13867     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13868                                      (RWF-AHCLM +
 13869                                       RWF-DIS-PAYCUR +
 13870                                       RWF-DIS-FUTRSV).
 13871
 13872     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13873         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13874
 13875     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13876
 13877     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13878         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13879         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13880     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13881         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13882
 13883     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13884
 13885     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 269
* ECS010.cbl
 13886         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13887         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13888     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13889         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13890
 13891 3519-REINSURE-CALC-RESERVE-END.
 13892
 13893     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13894        OR RWF-DTH-FUTRSV
 13895         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13896
 13897     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13898        OR RWF-DIS-FUTRSV
 13899         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13900
 13901     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13902
 13903 3520-REIN-REMAINDER-RSRV.
 13904
 13905     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13906     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13907     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13908     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13909     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13910     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13911
 13912     PERFORM 3530-REIN-SUB-RSRV
 13913         THRU 3539-REIN-SUB-RSRV-X
 13914             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13915
 13916     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13917
 13918 3530-REIN-SUB-RSRV.
 13919
 13920     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13921     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13922     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13923     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13924     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13925     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13926
 13927 3539-REIN-SUB-RSRV-X.
 13928     EXIT.
 13929
 13930 3540-CONT-REIN-CALC-RESERVE.
 13931
 13932     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13933         MOVE 'X' TO REIN-BUS-FLAG.
 13934     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13935
 13936 3599-REINSURE-CALC-RESERVE-X.
 13937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 270
* ECS010.cbl
 13939******************************************************************
 13940***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13941******************************************************************
 13942
 13943*REINSURANCE-CALCULATIONS.
*13944                             COPY ECSRIRTN.
 13945******************************************************************04/30/98
 13946*                                                                *ECSRIRTN
 13947*                            ECSRIRTN                            *   LV012
 13948*                            VMOD=2.025.                         *ECSRIRTN
 13949*                                                                *ECSRIRTN
 13950******************************************************************ECSRIRTN
 13951******************************************************************
 13952*                   C H A N G E   L O G
 13953*
 13954* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13955*-----------------------------------------------------------------
 13956*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13957* EFFECTIVE    NUMBER
 13958*-----------------------------------------------------------------
 13959* 062703                   PEMA  ADD DCC CLIENT ID TO
 13960*                                SPECIAL CEDED CLAIM CALC
 13961* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13962                                                                  ECSRIRTN
 13963 REINSURE-CALC.                                                   ECSRIRTN
 13964                                                                  ECSRIRTN
 13965     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 13966     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13967     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 13968     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 13969                                   REIN-REM-SW (SUB1).            ECSRIRTN
 13970                                                                  ECSRIRTN
 13971     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 13972                                   WS-RWF-EP-STOP-DATE-N             CL*12
 13973                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 13974                                                                  ECSRIRTN
 13975     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13976                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 13977                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 13978                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13979                                                                  ECSRIRTN
 13980     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 13981        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 13982          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 13983          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 13984          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 13985                                                                  ECSRIRTN
 13986     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 13987        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 13988         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13989                                                                  ECSRIRTN
 13990     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 13991                                          WS-RWF-EP-STOP-DATE-N      CL*12
 13992                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 13993                                                                  ECSRIRTN
 13994     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 13995         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13996                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 271
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13997     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 13998         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13999                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 14000                                                                  ECSRIRTN
 14001     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 14002         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 14003                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14004                                                                  ECSRIRTN
 14005 CALC-CONTINUED.                                                  ECSRIRTN
 14006                                                                  ECSRIRTN
 14007     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 14008     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 14009                                                                  ECSRIRTN
 14010     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 14011         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 14012     ELSE                                                         ECSRIRTN
 14013         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 14014     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 14015                                                                  ECSRIRTN
 14016     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 14017     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 14018     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 14019         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 14020     ELSE                                                         ECSRIRTN
 14021         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 14022     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 14023                                                                  ECSRIRTN
 14024     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 14025         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 14026         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 14027         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 14028         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 14029         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 14030         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 14031                                                                  ECSRIRTN
 14032     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14033         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 14034                                                                  ECSRIRTN
 14035     IF CR-DT LESS WT-LO-DATE                                        CL**2
 14036         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14037                                                                  ECSRIRTN
 14038     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 14039         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14040                                                                  ECSRIRTN
 14041     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 14042     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 14043                                                                  ECSRIRTN
 14044     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 14045         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 14046                                                                  ECSRIRTN
 14047     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 14048       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14049        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 14050        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14051           NEXT SENTENCE                                          ECSRIRTN
 14052       ELSE                                                       ECSRIRTN
 14053           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
 14054                       REIN-AH-FLG (SUB1).                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 272
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14055                                                                  ECSRIRTN
 14056     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14057         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14058            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 14059             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 14060                                                                  ECSRIRTN
 14061     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14062         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14063            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 14064             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 14065                                                                  ECSRIRTN
 14066     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 14067         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 14068             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 14069                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 14070             ELSE                                                 ECSRIRTN
 14071                 NEXT SENTENCE                                    ECSRIRTN
 14072         ELSE                                                     ECSRIRTN
 14073             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14074                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14075                                                                  ECSRIRTN
 14076     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 14077         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 14078             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 14079                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 14080             ELSE                                                 ECSRIRTN
 14081                 NEXT SENTENCE                                    ECSRIRTN
 14082         ELSE                                                     ECSRIRTN
 14083             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14084                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14085                                                                  ECSRIRTN
 14086     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 14087         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 14088                                                                  ECSRIRTN
 14089     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 14090         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 14091         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14092                                                                  ECSRIRTN
 14093     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 14094         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 14095                                                                  ECSRIRTN
 14096     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 14097         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 14098         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 14099                                                                  ECSRIRTN
 14100     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14101         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14102                                                                  ECSRIRTN
 14103     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14104         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14105                                                                  ECSRIRTN
 14106     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 14107                                                                  ECSRIRTN
 14108 REINSURE-CK-LIFE.                                                ECSRIRTN
 14109                                                                  ECSRIRTN
 14110     IF CR-LFTYP = ZERO                                           ECSRIRTN
 14111         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14112                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 273
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14113     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 14114         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14115                                                                  ECSRIRTN
 14116     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14117         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 14118             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14119                                                                  ECSRIRTN
 14120     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14121                                                                  ECSRIRTN
 14122     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 14123         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 14124             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14125         ELSE                                                     ECSRIRTN
 14126             NEXT SENTENCE                                        ECSRIRTN
 14127     ELSE                                                         ECSRIRTN
 14128         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 14129             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14130                                                                  ECSRIRTN
 14131     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 14132         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 14133             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14134         ELSE                                                     ECSRIRTN
 14135             NEXT SENTENCE                                        ECSRIRTN
 14136     ELSE                                                         ECSRIRTN
 14137         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 14138             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14139                                                                  ECSRIRTN
 14140     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14141         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 14142             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14143                                                                  ECSRIRTN
 14144     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14145         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 14146            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14147                                                                  ECSRIRTN
 14148     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 14149         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 14150             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14151                                                                  ECSRIRTN
 14152     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 14153         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 14154            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14155                                                                  ECSRIRTN
 14156     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14157         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14158             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14159                                                                  ECSRIRTN
 14160     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 14161         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14162            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 14163            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 14164             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14165                                                                  ECSRIRTN
 14166     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 14167         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14168            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 14169             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14170                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 274
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14171     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14172         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14173             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14174                                                                  ECSRIRTN
 14175     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14176         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 14177             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14178                                                                  ECSRIRTN
 14179     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 14180        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 14181           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 14182            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14183                                                                  ECSRIRTN
 14184     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14185         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14186            CR-IND-GRP = '1'                                      ECSRIRTN
 14187             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14188                                                                  ECSRIRTN
 14189     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 14190         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14191            CR-IND-GRP = '1'                                      ECSRIRTN
 14192             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14193                                                                  ECSRIRTN
 14194     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 14195         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14196            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 14197            CR-IND-GRP = '1'                                      ECSRIRTN
 14198             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14199                                                                  ECSRIRTN
 14200     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 14201         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14202            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14203            CR-IND-GRP = '1'                                      ECSRIRTN
 14204             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14205                                                                  ECSRIRTN
 14206     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14207         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 14208            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14209                                                                  ECSRIRTN
 14210     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14211        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 14212                                                                  ECSRIRTN
 14213     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 14214         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14215                                                                  ECSRIRTN
 14216     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 14217         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14218                                                                  ECSRIRTN
 14219     IF CR-LF-TERM  NUMERIC                                       00002331
 14220        NEXT SENTENCE                                             00002332
 14221     ELSE                                                         00002333
 14222        MOVE ZEROS               TO CR-LF-TERM                    00002334
 14223     END-IF
 14224                                                                  00002335
 14225     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 14226         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14227                                                                  ECSRIRTN
 14228     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 275
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14229         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14230                                                                  ECSRIRTN
 14231     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14232                                                                  ECSRIRTN
 14233     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 14234         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14235                                                                  ECSRIRTN
 14236     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 14237         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14238                                                                  ECSRIRTN
 14239     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14240                                                                  ECSRIRTN
 14241 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 14242     EXIT.                                                        ECSRIRTN
 14243                                                                  ECSRIRTN
 14244 REINSURE-CK-AH.                                                  ECSRIRTN
 14245                                                                  ECSRIRTN
 14246     IF CR-AHTYP = ZERO                                           ECSRIRTN
 14247         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14248                                                                  ECSRIRTN
 14249     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 14250         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14251                                                                  ECSRIRTN
 14252     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14253         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 14254             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14255                                                                  ECSRIRTN
 14256     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14257                                                                  ECSRIRTN
 14258     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 14259         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 14260             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 14261         ELSE                                                     ECSRIRTN
 14262             NEXT SENTENCE                                        ECSRIRTN
 14263     ELSE                                                         ECSRIRTN
 14264         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 14265             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14266                                                                  ECSRIRTN
 14267     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14268         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 14269             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14270                                                                  ECSRIRTN
 14271     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14272         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 14273             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14274                                                                  ECSRIRTN
 14275     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14276         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 14277             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14278                                                                  ECSRIRTN
 14279     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14280         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14281             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14282                                                                  ECSRIRTN
 14283     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14284         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 14285            CR-IND-GRP = '1'                                      ECSRIRTN
 14286             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 276
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14287                                                                  ECSRIRTN
 14288     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14289         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14290             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14291                                                                  ECSRIRTN
 14292     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14293         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 14294            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14295                                                                  ECSRIRTN
 14296     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 14297         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 14298            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14299                                                                  ECSRIRTN
 14300     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 14301         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 14302             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14303                                                                  ECSRIRTN
 14304     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14305        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 14306                                                                  ECSRIRTN
 14307     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 14308         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14309                                                                  ECSRIRTN
 14310     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 14311         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14312                                                                  ECSRIRTN
 14313     IF CR-AH-TERM  NUMERIC                                       00002331
 14314        NEXT SENTENCE                                             00002332
 14315     ELSE                                                         00002333
 14316        MOVE ZEROS               TO CR-AH-TERM                    00002334
 14317     END-IF
 14318                                                                  00002335
 14319     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 14320         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14321                                                                  ECSRIRTN
 14322     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 14323         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14324                                                                  ECSRIRTN
 14325     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14326                                                                  ECSRIRTN
 14327     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 14328         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 14329             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 14330                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 14331                                                                  ECSRIRTN
 14332     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 14333         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 14334             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 14335                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 14336                                                                  ECSRIRTN
 14337     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 14338     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 14339                                                                  ECSRIRTN
 14340     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 14341         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 14342                                                                  ECSRIRTN
 14343     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
 14344         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 277
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14345                                                                  ECSRIRTN
 14346     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 14347                                                                  ECSRIRTN
 14348     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14349                                                                  ECSRIRTN
 14350     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 14351         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14352                                                                  ECSRIRTN
 14353     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14354         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14355                                                                  ECSRIRTN
 14356     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14357                                                                  ECSRIRTN
 14358 REINSURE-CK-AH-X.                                                ECSRIRTN
 14359     EXIT.                                                        ECSRIRTN
 14360                                                                  ECSRIRTN
 14361 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 14362                                                                  ECSRIRTN
 14363     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 14364        RS-AH-BEN = ZERO                                          ECSRIRTN
 14365         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14366                                                                  ECSRIRTN
 14367     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 14368        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14369         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14370                                                                  ECSRIRTN
 14371     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14372                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 14373                                                                  ECSRIRTN
 14374     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14375         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14376             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 14377                                     WT-AHBEN-HI.                 ECSRIRTN
 14378     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14379         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14380             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 14381                                     WT-AHMOA-HI.                 ECSRIRTN
 14382                                                                  ECSRIRTN
 14383     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14384     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14385                                                                  ECSRIRTN
 14386     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14387         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 14388                                                                  ECSRIRTN
 14389     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14390         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 14391                                                                  ECSRIRTN
 14392     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14393                                                                  ECSRIRTN
 14394     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14395         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 14396                                                                  ECSRIRTN
 14397     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 14398         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 14399                                       / RW-AHWRK                 ECSRIRTN
 14400       ELSE                                                       ECSRIRTN
 14401         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
 14402                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 278
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14403     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 14404         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 14405                                       / RS-LIFE-BEN              ECSRIRTN
 14406       ELSE                                                       ECSRIRTN
 14407         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 14408                                                                  ECSRIRTN
 14409     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 14410        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 14411          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14412          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14413                                      / CR-AH-TERM.               ECSRIRTN
 14414                                                                  ECSRIRTN
 14415     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14416        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 14417          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14418          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14419               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14420            ELSE                                                  ECSRIRTN
 14421                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14422                                                                  ECSRIRTN
 14423     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14424        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 14425        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 14426          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14427          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14428                                      / CR-AH-TERM                ECSRIRTN
 14429         ELSE                                                     ECSRIRTN
 14430          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14431          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14432               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14433            ELSE                                                  ECSRIRTN
 14434                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14435                                                                  ECSRIRTN
 14436 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 14437     EXIT.                                                        ECSRIRTN
 14438                                                                  ECSRIRTN
 14439                                                                  ECSRIRTN
 14440 REIN-CALC-LIFE.                                                  ECSRIRTN
 14441                                                                  ECSRIRTN
 14442     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 14443         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 14444     ELSE                                                         ECSRIRTN
 14445         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 14446                                                                  ECSRIRTN
 14447     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 14448         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 14449     ELSE                                                         ECSRIRTN
 14450         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 14451           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 14452               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 14453           ELSE                                                   ECSRIRTN
 14454               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 14455                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 14456                                                                  ECSRIRTN
 14457 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 14458                                                                  ECSRIRTN
 14459     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
 14460                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 279
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14461     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14462         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 14463                                                                  ECSRIRTN
 14464     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14465         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 14466         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14467                                                                  ECSRIRTN
 14468     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 14469         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 14470                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14471         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 14472                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14473     ELSE                                                         ECSRIRTN
 14474         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14475             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 14476             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 14477                                                                  ECSRIRTN
 14478     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 14479         (WT-LF-QC = '2' AND                                         CL**8
 14480          PGM-SUB = +50  AND                                         CL**8
 14481          DTE-CLIENT = 'LAP'))                                       CL**8
 14482          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 14483     ELSE                                                         ECSRIRTN
 14484         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 14485                                                                  ECSRIRTN
 14486     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14487         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 14488         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 14489         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 14490                                                                  ECSRIRTN
 14491     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 14492                                                                  ECSRIRTN
 14493 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 14494                                                                  ECSRIRTN
 14495     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14496         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 14497         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14498                                                                  ECSRIRTN
 14499     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 14500     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14501     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 14502                                       RW-LFPRM.                  ECSRIRTN
 14503                                                                  ECSRIRTN
 14504 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 14505                                                                  ECSRIRTN
 14506     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 14507                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14508                                                                  ECSRIRTN
 14509     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14510        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14511                                                                  ECSRIRTN
 14512     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 14513        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14514         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 14515     ELSE                                                         ECSRIRTN
 14516         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14517         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
 14518                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 280
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14519                                                                  ECSRIRTN
 14520 REIN-CALC-LIFE-X.                                                ECSRIRTN
 14521     EXIT.                                                        ECSRIRTN
 14522                                                                  ECSRIRTN
 14523 REIN-CALC-AH.                                                    ECSRIRTN
 14524                                                                  ECSRIRTN
 14525     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14526         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14527             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 14528                                 WT-AHBEN-HI.                     ECSRIRTN
 14529                                                                  ECSRIRTN
 14530     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14531         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14532             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 14533                                 WT-AHMOA-HI.                     ECSRIRTN
 14534                                                                  ECSRIRTN
 14535     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14536     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14537                                                                  ECSRIRTN
 14538     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14539         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 14540                                                                  ECSRIRTN
 14541     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14542         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 14543                                                                  ECSRIRTN
 14544     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14545         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 14546                                                                  ECSRIRTN
 14547     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 14548         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 14549     ELSE                                                         ECSRIRTN
 14550         IF WT-REMAINING = 'L'                                    ECSRIRTN
 14551             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 14552         ELSE                                                     ECSRIRTN
 14553             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 14554             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 14555                                                                  ECSRIRTN
 14556 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 14557                                                                  ECSRIRTN
 14558     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14559         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 14560                                                                  ECSRIRTN
 14561     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14562         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 14563         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14564                                                                  ECSRIRTN
 14565     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 14566         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 14567                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14568         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 14569                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14570     ELSE                                                         ECSRIRTN
 14571         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 14572             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 14573             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 14574                                                                  ECSRIRTN
 14575     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
 14576         (WT-AH-QC = '2' AND                                         CL**8
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 281
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14577          PGM-SUB = +50  AND                                         CL**8
 14578          DTE-CLIENT = 'LAP'))                                       CL**8
 14579         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 14580     ELSE                                                         ECSRIRTN
 14581         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 14582                                                                  ECSRIRTN
 14583     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 14584         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 14585            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 14586                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 14587                                                                  ECSRIRTN
 14588     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14589         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 14590         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 14591         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 14592                                                                  ECSRIRTN
 14593     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 14594                                                                  ECSRIRTN
 14595 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 14596                                                                  ECSRIRTN
 14597     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14598         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 14599         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14600                                                                  ECSRIRTN
 14601     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14602     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14603     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14604                                    RW-AHPRM.                     ECSRIRTN
 14605                                                                  ECSRIRTN
 14606 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 14607                                                                  ECSRIRTN
 14608     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 14609                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14610                                                                  ECSRIRTN
 14611     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14612                                                                  ECSRIRTN
 14613     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 14614        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14615         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 14616     ELSE                                                         ECSRIRTN
 14617         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14618         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 14619                                                                  ECSRIRTN
 14620                                                                  ECSRIRTN
 14621 REIN-CALC-AH-X.                                                  ECSRIRTN
 14622     EXIT.                                                        ECSRIRTN
 14623                                                                  ECSRIRTN
 14624 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 14625                                                                  ECSRIRTN
 14626     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 14627     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 14628     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 14629     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 14630                                                                  ECSRIRTN
 14631     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 14632         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 14633                                                                  ECSRIRTN
 14634     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 282
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14635        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 14636           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14637                                                                  ECSRIRTN
 14638     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 14639        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 14640           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14641                                                                  ECSRIRTN
 14642 REINSURE-CALC-X.                                                 ECSRIRTN
 14643                                                                  ECSRIRTN
 14644     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14645         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14646                                                                  ECSRIRTN
 14647     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14648                                                                  ECSRIRTN
 14649 REINSURE-SUBTRACT.                                               ECSRIRTN
 14650                                                                  ECSRIRTN
 14651     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 14652     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 14653     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 14654     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 14655                                                                  ECSRIRTN
 14656 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 14657     EXIT.                                                        ECSRIRTN
 14658                                                                  ECSRIRTN
 14659 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 14660                                                                  ECSRIRTN
 14661     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14662     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14663                                                                  ECSRIRTN
 14664     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14665         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 14666                                                                  ECSRIRTN
 14667     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14668         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14669                                                                  ECSRIRTN
 14670     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14671         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 14672             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 14673                                                                  ECSRIRTN
 14674     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14675         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 14676                                                                  ECSRIRTN
 14677     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14678         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 14679         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14680                                                                  ECSRIRTN
 14681     IF CR-LFPRM = ZERO                                           ECSRIRTN
 14682        MOVE ZERO                TO REIN-FACTOR
 14683     ELSE                                                         ECSRIRTN
 14684        IF DTE-CLIENT = 'GIC'  AND
 14685           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14686           MOVE +1.0             TO REIN-FACTOR
 14687        ELSE
 14688           IF DTE-CLIENT = 'DCC'
 14689              COMPUTE REIN-FACTOR = CR-LFRFND /
 14690                 (CR-LFPRM + CR-LFPRM-ALT)
 14691           ELSE
 14692              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 283
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14693                 (CR-LFPRM + CR-LFPRM-ALT)
 14694            END-IF
 14695         END-IF
 14696     END-IF
 14697                                                                  ECSRIRTN
 14698     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14699         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14700             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14701                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 14702                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14703             ELSE                                                 ECSRIRTN
 14704                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14705                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14706                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 14707                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14708         ELSE                                                     ECSRIRTN
 14709             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14710                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *        ECSRIRTN
 14711                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT))   ECSRIRTN
 14712             ELSE                                                 ECSRIRTN
 14713*                COMPUTE RWF-LFRFND = REIN-FACTOR
 14714*                   * REIN-CALCED-LIFE *
 14715*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 14716                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14717                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14718                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 14719                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 14720                                                                  ECSRIRTN
 14721     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14722         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14723             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14724                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14725                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 14726             ELSE                                                 ECSRIRTN
 14727                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14728                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14729                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14730                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 14731                                                                  ECSRIRTN
 14732     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 14733                                                                  ECSRIRTN
 14734                                                                  ECSRIRTN
 14735 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 14736                                                                  ECSRIRTN
 14737     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14738       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14739         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14740         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14741                                                                  ECSRIRTN
 14742     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14743       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14744           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14745           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14746       ELSE                                                       ECSRIRTN
 14747           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
 14748               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14749                                                                  ECSRIRTN
 14750     IF FLAT-CANCEL-LF                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 284
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14751         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14752         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14753                                                                  ECSRIRTN
 14754     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14755         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14756         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14757                                                                  ECSRIRTN
 14758     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14759     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14760     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14761                                         RW-LFRFND.               ECSRIRTN
 14762                                                                  ECSRIRTN
 14763 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14764                                                                  ECSRIRTN
 14765     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14766                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14767                                                                  ECSRIRTN
 14768     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14769        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14770                                                                  ECSRIRTN
 14771     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14772        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14773         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14774     ELSE                                                         ECSRIRTN
 14775         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14776         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14777                                                                  ECSRIRTN
 14778                                                                  ECSRIRTN
 14779 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14780                                                                  ECSRIRTN
 14781     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14782         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14783                                                                  ECSRIRTN
 14784     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14785         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14786             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14787                                                                  ECSRIRTN
 14788     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14789         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14790         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14791             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14792                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14793         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14794                                                                  ECSRIRTN
 14795     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14796         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14797                                                                  ECSRIRTN
 14798     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14799         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14800         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14801                                                                  ECSRIRTN
 14802     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14803        MOVE ZERO                TO REIN-FACTOR
 14804     ELSE
 14805        IF DTE-CLIENT = 'GIC'  AND
 14806           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14807            MOVE +1.0            TO REIN-FACTOR
 14808        ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 285
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14809           IF DTE-CLIENT = 'DCC'
 14810              COMPUTE REIN-FACTOR =
 14811                 CR-AHRFND / CR-AHPRM
 14812           ELSE
 14813              COMPUTE REIN-FACTOR ROUNDED =
 14814                                CR-AHRFND-CALC / CR-AHPRM
 14815           END-IF
 14816        END-IF
 14817     END-IF
 14818
 14819     IF CR-AHAMT NOT = ZERO
 14820        IF (DTE-CLIENT = 'DCC')
 14821           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14822           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14823        ELSE
 14824           IF WT-AH-QC = ('1' OR '4')
 14825              COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND *
 14826                       RWF-AHAMT) / CR-AHAMT
 14827           ELSE
 14828              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14829              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14830                       RWF-AHAMT) / CR-AHAMT
 14831           END-IF
 14832        END-IF
 14833     ELSE
 14834        IF RWF-AH-LIMIT = ZERO
 14835           IF WT-AH-QC = ('1' OR '4')
 14836              COMPUTE RWF-AHRFND ROUNDED =
 14837                       CR-AHRFND * WT-AH-PCT
 14838           ELSE
 14839              COMPUTE RWF-AHRFND =
 14840                            REIN-FACTOR * REIN-CALCED-AH
 14841              COMPUTE RWF-AHRFND ROUNDED =
 14842                       RWF-AHRFND * WT-AH-PCT
 14843           END-IF
 14844        END-IF
 14845     END-IF
 14846
 14847     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14848                                                                  ECSRIRTN
 14849                                                                  ECSRIRTN
 14850 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14851                                                                  ECSRIRTN
 14852     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14853       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14854         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14855         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14856                                                                  ECSRIRTN
 14857     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14858       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14859           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14860           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14861       ELSE                                                       ECSRIRTN
 14862           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
 14863               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14864                                                                  ECSRIRTN
 14865     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14866         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 286
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14867         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14868                                                                  ECSRIRTN
 14869     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14870         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14871         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14872                                                                  ECSRIRTN
 14873     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14874     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14875     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14876                                    RW-AHRFND.                    ECSRIRTN
 14877                                                                  ECSRIRTN
 14878 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14879                                                                  ECSRIRTN
 14880     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14881                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14882                                                                  ECSRIRTN
 14883     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14884                                                                  ECSRIRTN
 14885     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14886        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14887         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14888     ELSE                                                         ECSRIRTN
 14889         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14890         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14891                                                                  ECSRIRTN
 14892                                                                  ECSRIRTN
 14893 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14894                                                                  ECSRIRTN
 14895     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14896         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14897                                                                  ECSRIRTN
 14898     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14899         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14900                                                                  ECSRIRTN
 14901     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14902                                                                  ECSRIRTN
 14903 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14904                                                                  ECSRIRTN
 14905     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14906     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14907                                                                  ECSRIRTN
 14908     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14909         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14910             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14911                                                                  ECSRIRTN
 14912     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14913         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14914                                                                  ECSRIRTN
 14915     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14916         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14917                                                                  ECSRIRTN
 14918 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14919                                                                  ECSRIRTN
 14920     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14921         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14922                                                                  ECSRIRTN
 14923     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14924                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 287
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14925 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14926                                                                  ECSRIRTN
 14927     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14928     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14929                                                                  ECSRIRTN
 14930 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14931     EXIT.                                                        ECSRIRTN
 14932                                                                  ECSRIRTN
 14933 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14934                                                                  ECSRIRTN
 14935     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14936         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14937                                                                  ECSRIRTN
 14938 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14939     EXIT.                                                        ECSRIRTN
 14940                                                                  ECSRIRTN
 14941 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14942                                                                  ECSRIRTN
 14943     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14944     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14945                                                                  ECSRIRTN
 14946     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14947         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14948                                                                  ECSRIRTN
 14949     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14950        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14951          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14952          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14953          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14954                                                                  ECSRIRTN
 14955     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14956        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14957          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14958                                                                  ECSRIRTN
 14959     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14960                                  RWF-AHCLML.                     ECSRIRTN
 14961                                                                  ECSRIRTN
 14962     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14963         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14964                                                                  ECSRIRTN
 14965     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 14966         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14967                                                                  ECSRIRTN
 14968     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14969         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14970             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 14971                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14972                                                                  ECSRIRTN
 14973     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14974         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14975                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14976                                                                  ECSRIRTN
 14977     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14978         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
 14979                                                                  ECSRIRTN
 14980     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14981         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14982             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 288
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14983                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14984             ELSE                                                 ECSRIRTN
 14985                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 14986         ELSE                                                     ECSRIRTN
 14987             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 14988                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 14989                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14990             ELSE                                                 ECSRIRTN
 14991                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 14992                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 14993                                                                  ECSRIRTN
 14994     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14995         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14996                                                                  ECSRIRTN
 14997     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14998         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14999            OR 'DCC'
 15000             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 15001                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 15002         ELSE                                                     ECSRIRTN
 15003             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 15004                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 15005                                                                  ECSRIRTN
 15006     IF CR-LFAMT = ZERO                                           ECSRIRTN
 15007         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 15008             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15009                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 15010                                                                  ECSRIRTN
 15011     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15012         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15013             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15014                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 15015                                                                  ECSRIRTN
 15016     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15017         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15018             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15019               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 15020                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15021                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15022                  ELSE                                            ECSRIRTN
 15023                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 15024                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15025              ELSE                                                ECSRIRTN
 15026                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 15027                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 15028                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 15029                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 15030                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15031                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 15032                                                                  ECSRIRTN
 15033     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15034                                                                  ECSRIRTN
 15035     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 15036                                                                  ECSRIRTN
 15037                                                                  ECSRIRTN
 15038 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 15039                                                                  ECSRIRTN
 15040     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 289
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15041         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15042                                                                  ECSRIRTN
 15043     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 15044         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 15045     ELSE                                                         ECSRIRTN
 15046         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 15047                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 15048                                                                  ECSRIRTN
 15049     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15050         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15051                                                                  ECSRIRTN
 15052     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15053         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 15054             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15055         ELSE                                                     ECSRIRTN
 15056             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 15057     ELSE                                                         ECSRIRTN
 15058         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 15059             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 15060             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15061         ELSE                                                     ECSRIRTN
 15062             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 15063             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 15064                                                                  ECSRIRTN
 15065                                                                  ECSRIRTN
 15066 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 15067                                                                  ECSRIRTN
 15068     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15069         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 15070                                                                  ECSRIRTN
 15071     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15072         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15073                                                                  ECSRIRTN
 15074     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 15075         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 15076                                                                  ECSRIRTN
 15077     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 15078     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 15079                                                                  ECSRIRTN
 15080     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 15081             VARYING                                              ECSRIRTN
 15082         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 15083             UNTIL                                                ECSRIRTN
 15084         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 15085                                                                  ECSRIRTN
 15086     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15087         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 15088     ELSE                                                         ECSRIRTN
 15089         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 15090                                                                  ECSRIRTN
 15091 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 15092                                                                  ECSRIRTN
 15093     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 15094         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15095                                                                  ECSRIRTN
 15096     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15097       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 15098           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 290
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15099                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 15100               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15101                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15102               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 15103                                                                  ECSRIRTN
 15104     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15105       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 15106           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15107                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15108           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 15109                                                                  ECSRIRTN
 15110     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 15111         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15112                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15113                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 15114         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15115                                                                  ECSRIRTN
 15116     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15117         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15118                                                                  ECSRIRTN
 15119     IF INC-SUB = +1                                              ECSRIRTN
 15120         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15121     IF INC-SUB = +2                                              ECSRIRTN
 15122         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15123     IF INC-SUB = +3                                              ECSRIRTN
 15124         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15125     IF INC-SUB = +4                                              ECSRIRTN
 15126         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15127     IF INC-SUB = +5                                              ECSRIRTN
 15128         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15129                                                                  ECSRIRTN
 15130     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15131                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15132                                                                  ECSRIRTN
 15133     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15134         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15135                                                                  ECSRIRTN
 15136     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 15137              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 15138         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 15139     ELSE                                                         ECSRIRTN
 15140         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15141                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15142                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 15143                                                                  ECSRIRTN
 15144 CHECK-DISABS-EXIT.                                               ECSRIRTN
 15145      EXIT.                                                       ECSRIRTN
 15146                                                                  ECSRIRTN
 15147 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 15148                                                                  ECSRIRTN
 15149     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15150         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15151                                                                  ECSRIRTN
 15152     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15153         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15154             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 15155                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 15156                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 291
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15157     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15158         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15159             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 15160                                                                  ECSRIRTN
 15161 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 15162                                                                  ECSRIRTN
 15163     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 15164         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 15165         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 15166             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 15167                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 15168         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 15169         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15170                                                                  ECSRIRTN
 15171     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15172         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 15173                                                                  ECSRIRTN
 15174     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15175         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15176             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 15177                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15178             ELSE                                                 ECSRIRTN
 15179                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 15180         ELSE                                                     ECSRIRTN
 15181             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 15182                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 15183                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15184             ELSE                                                 ECSRIRTN
 15185                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 15186                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 15187                                                                  ECSRIRTN
 15188     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15189         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15190                                                                  ECSRIRTN
 15191     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15192         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 15193                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 15194     ELSE                                                         ECSRIRTN
 15195         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 15196             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15197                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 15198                                                                  ECSRIRTN
 15199     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15200         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15201             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15202                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 15203                                                                  ECSRIRTN
 15204     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15205         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15206             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15207               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 15208                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15209                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15210                  ELSE                                            ECSRIRTN
 15211                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 15212                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15213              ELSE                                                ECSRIRTN
 15214                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 292
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15215                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 15216                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 15217                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 15218                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15219                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 15220                                                                  ECSRIRTN
 15221                                                                  ECSRIRTN
 15222     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 15223        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 15224                               '220000' OR '230000')              ECSRIRTN
 15225           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 15226               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 15227                                                                  ECSRIRTN
 15228     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15229                                                                  ECSRIRTN
 15230     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 15231                                                                  ECSRIRTN
 15232                                                                  ECSRIRTN
 15233 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 15234                                                                  ECSRIRTN
 15235     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15236         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15237                                                                  ECSRIRTN
 15238     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15239         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 15240         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15241                                                                  ECSRIRTN
 15242     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15243                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15244                                                                  ECSRIRTN
 15245     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15246         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15247                                                                  ECSRIRTN
 15248     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15249         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15250                                                                  ECSRIRTN
 15251     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 15252                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15253         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 15254                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 15255         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 15256     ELSE                                                         ECSRIRTN
 15257         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 15258         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 15259                                                                  ECSRIRTN
 15260                                                                  ECSRIRTN
 15261 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 15262                                                                  ECSRIRTN
 15263     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15264         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15265                                                                  ECSRIRTN
 15266     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15267         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15268                                                                  ECSRIRTN
 15269     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 15270                                                                  ECSRIRTN
 15271 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 15272                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 293
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15273     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 15274     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 15275                                                                  ECSRIRTN
 15276     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 15277         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 15278             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 15279                                                                  ECSRIRTN
 15280     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15281     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15282                                                                  ECSRIRTN
 15283     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15284         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15285                                                                  ECSRIRTN
 15286     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15287         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15288                                                                  ECSRIRTN
 15289 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 15290                                                                  ECSRIRTN
 15291     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 15292         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 15293                                                                  ECSRIRTN
 15294     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 15295                                                                  ECSRIRTN
 15296 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 15297                                                                  ECSRIRTN
 15298     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 15299     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 15300                                                                  ECSRIRTN
 15301 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 15302     EXIT.                                                        ECSRIRTN
 15303                                                                  ECSRIRTN
 15304 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 15305                                                                  ECSRIRTN
 15306     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 15307         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 15308                                                                  ECSRIRTN
 15309 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 15310     EXIT.                                                        ECSRIRTN
 15311                                                                  ECSRIRTN
 15312                                                                  ECSRIRTN
 15313 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 15314                                                                  ECSRIRTN
 15315     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 15316     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 15317     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 15318     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 15319                                                                  ECSRIRTN
 15320     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 15321         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 15322         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 15323         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 15324         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 15325         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 15326         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
 15327         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 15328         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 15329         REIN-AH-LIMIT (1).                                       ECSRIRTN
 15330                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 294
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15331     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 15332         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 15333                                                                  ECSRIRTN
 15334     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 15335                                                                  ECSRIRTN
 15336 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 15337                                                                  ECSRIRTN
 15338     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 15339                                                                  ECSRIRTN
 15340 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 15341     EXIT.                                                        ECSRIRTN
 15342                                                                  ECSRIRTN
 15343 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 15344                                                                  ECSRIRTN
 15345     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 15346                                                                  ECSRIRTN
 15347     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 15348         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 15349                                                                  ECSRIRTN
 15350     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15351         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 15352             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 15353                                                                  ECSRIRTN
 15354     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15355         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 15356         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 15357         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 15358     ELSE                                                         ECSRIRTN
 15359         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 15360         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 15361         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 15362                                                                  ECSRIRTN
 15363     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 15364                                                                  ECSRIRTN
 15365     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 15366        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 15367         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 15368                                                                  ECSRIRTN
 15369     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 15370         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 15371                                                                  ECSRIRTN
 15372 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 15373     EXIT.                                                        ECSRIRTN
 15374                                                                  ECSRIRTN
 15375 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 15376                                                                  ECSRIRTN
 15377     CONTINUE.                                                    ECSRIRTN
 15378*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 15379 FIND-REI-CO-EXIT.                                                ECSRIRTN
 15380     EXIT.                                                        ECSRIRTN
 15381                                                                  ECSRIRTN
 15382 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 15383                                                                  ECSRIRTN
 15384     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
 15385         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15386                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15387                                                                  ECSRIRTN
 15388     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 295
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15389         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15390                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15391                                                                  ECSRIRTN
 15392     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 15393                                                                  ECSRIRTN
 15394     START ERRTBL-IN                                              ECSRIRTN
 15395           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 15396             INVALID KEY                                          ECSRIRTN
 15397               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 15398                                                                  ECSRIRTN
 15399     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 15400     MOVE 0 TO SUB1.                                              ECSRIRTN
 15401 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 15402                                                                  ECSRIRTN
 15403     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 15404                                                                  ECSRIRTN
 15405     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 15406        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 15407                                                                  ECSRIRTN
 15408     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 15409        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 15410        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 15411                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15412        GO TO ABEND-PGM.                                          ECSRIRTN
 15413                                                                  ECSRIRTN
 15414     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 15415        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 15416                                                                  ECSRIRTN
 15417     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 15418        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 15419                                                                  ECSRIRTN
 15420     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 15421        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 15422                                                                  ECSRIRTN
 15423     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 15424        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 15425                                                                  ECSRIRTN
 15426     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 15427        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15428                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 15429        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 295)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15430                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 15431        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 295)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15432                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 15433     END-PERFORM.                                                 ECSRIRTN
 15434     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 15435                                                                  ECSRIRTN
 15436     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15437        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 15438                                                                  ECSRIRTN
 15439     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15440        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 296
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15441                                                                  ECSRIRTN
 15442     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15443        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 15444                                                                  ECSRIRTN
 15445     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15446        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 15447                                                                  ECSRIRTN
 15448     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 15449        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 15450        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 15451        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 15452        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 15453        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 15454        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 15455          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 15456                                                                  ECSRIRTN
 15457     ADD +1 TO CO-SUB.                                            ECSRIRTN
 15458                                                                  ECSRIRTN
 15459     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 15460        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 15461        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 15462        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 15463        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15464                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15465        GO TO ABEND-PGM.                                          ECSRIRTN
 15466                                                                  ECSRIRTN
 15467     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 15468                                                                  ECSRIRTN
 15469     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 15470                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 15471     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 15472                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 15473     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 15474                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 15475                                                                  ECSRIRTN
 15476     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 15477         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 15478     ELSE                                                         ECSRIRTN
 15479         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 15480                                                                  ECSRIRTN
 15481     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 15482     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 15483     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 15484     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 15485                                                                  ECSRIRTN
 15486 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 15487                                                                  ECSRIRTN
 15488     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15489        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 15490                                                                  ECSRIRTN
 15491     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15492        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 15493                                                                  ECSRIRTN
 15494     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15495        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 15496                                                                  ECSRIRTN
 15497     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15498        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 297
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15499                                                                  ECSRIRTN
 15500     ADD +1 TO SUB1.                                              ECSRIRTN
 15501                                                                  ECSRIRTN
 15502     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 15503        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 15504        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15505                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15506        GO TO ABEND-PGM.                                          ECSRIRTN
 15507                                                                  ECSRIRTN
 15508     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 15509     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 15510     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 15511     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 15512     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 15513     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 15514     if re-state-exhibit-opt-f = 'Y'
 15515        move 'Y'         to rc2-ecs152-rpt (sub1)
 15516     else
 15517        move 'N'         to rc2-ecs152-rpt (sub1)
 15518     end-if
 15519                                                                  ECSRIRTN
 15520     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 15521                                                                  ECSRIRTN
 15522 REIN-BUILD-EXIT.                                                 ECSRIRTN
 15523     EXIT.                                                        ECSRIRTN
 15524                                                                  ECSRIRTN
 15525 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 15526                                                                  ECSRIRTN
 15527     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 15528                                                                  ECSRIRTN
 15529     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 15530                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 15531                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 15532                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 15533                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 15534                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 15535                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15536                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15537                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 15538                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 15539                                                                  ECSRIRTN
 15540 ZERO-RCT-EXIT.                                                   ECSRIRTN
 15541     EXIT.                                                        ECSRIRTN
 15542                                                                  ECSRIRTN
 15543 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 15544                                                                  ECSRIRTN
 15545     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 15546                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 15547     move spaces      to rc2-ecs152-rpt (co-sub)
 15548                                                                  ECSRIRTN
 15549     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 15550                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 15551                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 15552                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
 15553                                                                  ECSRIRTN
 15554 ZERO-RC2-EXIT.                                                   ECSRIRTN
 15555     EXIT.                                                        ECSRIRTN
 15556******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 298
* ECS010.cbl
 15558******************************************************************
 15559***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 15560******************************************************************
 15561
 15562 3600-RC-REINSURANCE.
 15563
 15564     IF DTE-PGM-OPT NOT = '1'
 15565         GO TO 3799-RC-REINSURANCE-X.
 15566
 15567     IF DTE-CLIENT = 'WSL'
 15568         IF CR-REIN-TABLE = '00A'
 15569             GO TO 3799-RC-REINSURANCE-X.
 15570
 15571     IF CR-REIN-TABLE = SPACES OR ZEROS
 15572         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15573
 15574 3610-CLEAR-RC-REIN.
 15575
 15576     MOVE SPACES TO RC-REIN-LEVELS (1).
 15577     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 15578                    RC-REIN-LFPRM (1)
 15579                    RC-REIN-AHAMT (1)
 15580                    RC-REIN-AHPRM (1)
 15581                    RC-REIN-LFRFND (1)
 15582                    RC-REIN-AHRFND (1)
 15583                    RC-REIN-LFCLM (1)
 15584                    RC-REIN-AHCLM (1).
 15585
 15586     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 15587         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 15588
 15589     MOVE +1 TO SUB1.
 15590     MOVE +0 TO SUB2.
 15591
 15592     GO TO 3630-RC-REIN-LOOP-1.
 15593
 15594 3620-CLEAR-RC-LEVELS.
 15595
 15596     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 15597
 15598
 15599 3630-RC-REIN-LOOP-1.
 15600
 15601     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 15602         ADD +1 TO SUB2
 15603         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 15604         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 15605         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 15606         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 15607         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 15608         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 15609         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 15610         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 15611         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 15612         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 15613
 15614     ADD +1 TO SUB1.
 15615     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 299
* ECS010.cbl
 15616         GO TO 3630-RC-REIN-LOOP-1.
 15617
 15618     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15619
 15620     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 15621     IF CR-REIN-TABLE = SPACES OR ZEROS
 15622         MOVE +1                     TO SUB1
 15623         GO TO 3710-RC-REIN-LOOP-2.
 15624
 15625     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 15626
 15627 3640-NSP-REIN-RATING-ROUTINE.
 15628
 15629     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 15630     MOVE 'L'                        TO DC-OPTION-CODE.
 15631     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15632     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 15633     MOVE SPACES                     TO CP-ACCT-FLD-5.
 15634     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 15635     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 15636     MOVE CR-APR                     TO CP-LOAN-APR.
 15637     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 15638     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 15639     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 15640     MOVE ZEROS                      TO CP-CLASS-CODE.
 15641
 15642     IF DTE-CLIENT = 'TIC'
 15643        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 15644            MOVE ZERO                TO CP-CLASS-CODE
 15645        ELSE
 15646            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 15647
 15648     MOVE '3'                        TO CP-PROCESS-TYPE.
 15649     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 15650     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 15651
 15652 3650-NSP-REIN-LIFE.
 15653
 15654     IF CR-LFTYP = ZERO
 15655         GO TO 3660-NSP-REIN-AH.
 15656     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 15657        OR (DTE-CLIENT = 'DCC')
 15658         GO TO 3660-NSP-REIN-AH.
 15659     IF DTE-CLIENT NOT = 'LBL'
 15660         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 15661             GO TO 3660-NSP-REIN-AH.
 15662
 15663     IF RE-NSP-ST-CD-LF NOT = STATE-L
 15664         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 15665         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15666
 15667     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 15668     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 15669     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 15670                                        CP-RATING-BENEFIT-AMT.
 15671     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 15672     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 15673     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 300
* ECS010.cbl
 15674     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 15675     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15676     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 15677     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15678
 15679     IF CP-STATE-STD-ABBRV = 'OR'
 15680         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 15681
 15682     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15683
 15684     IF CP-ERROR-RATE-NOT-FOUND  OR
 15685        CP-ERROR-RATE-IS-ZERO
 15686         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 15687                                     TO WS-ABEND-MESSAGE
 15688         MOVE 0302                   TO WS-ABEND-CODE
 15689         DISPLAY '******************************'
 15690         DISPLAY '***** ERROR LOCATION 018 *****'
 15691         DISPLAY '******************************'
 15692         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15693         GO TO ABEND-PGM.
 15694
 15695     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 15696
 15697*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 15698*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 15699
 15700     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 15701                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 15702
 15703     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 15704
 15705 3660-NSP-REIN-AH.
 15706
 15707     IF CR-AHTYP = ZERO
 15708         GO TO 3669-NSP-REIN-X.
 15709     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 15710        OR (DTE-CLIENT = 'DCC')
 15711         GO TO 3669-NSP-REIN-X.
 15712     IF DTE-CLIENT NOT = 'LBL'
 15713         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 15714             GO TO 3669-NSP-REIN-X.
 15715
 15716     IF RE-NSP-ST-CD-AH NOT = STATE-L
 15717         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 15718         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15719
 15720     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 15721     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 15722     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 15723                                        CP-RATING-BENEFIT-AMT.
 15724     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 15725     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 15726     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 15727     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 15728     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15729     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 15730     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15731
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 301
* ECS010.cbl
 15732     IF CP-STATE-STD-ABBRV = 'OR'
 15733         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 15734
 15735     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15736
 15737     IF CP-ERROR-RATE-NOT-FOUND  OR
 15738        CP-ERROR-RATE-IS-ZERO
 15739         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15740                                     TO WS-ABEND-MESSAGE
 15741         MOVE 0302                   TO WS-ABEND-CODE
 15742         DISPLAY '******************************'
 15743         DISPLAY '***** ERROR LOCATION 019 *****'
 15744         DISPLAY '******************************'
 15745         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15746         GO TO ABEND-PGM.
 15747
 15748     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15749             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15750
 15751     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15752
 15753 3669-NSP-REIN-X.
 15754     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 302
* ECS010.cbl
 15756******************************************************************
 15757***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15758******************************************************************
 15759
 15760 3700-RC-REIN-PERF-CALC.
 15761
*15762                             COPY ECSRTPFM.
 15763******************************************************************07/10/97
 15764*                                                                *ECSRTPFM
 15765*                            ECSRTPFM                            *   LV001
 15766*                            VMOD=2.002                          *ECSRTPFM
 15767*                                                                *ECSRTPFM
 15768******************************************************************ECSRTPFM
 15769                                                                  ECSRTPFM
 15770     IF    CR-LFAMT  NUMERIC                                      00000072
 15771           NEXT SENTENCE                                          00000073
 15772        ELSE                                                      00000074
 15773           MOVE ZEROS TO CR-LFAMT.                                00000075
 15774                                                                  00000076
 15775     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15776           NEXT SENTENCE                                          00000078
 15777        ELSE                                                      00000079
 15778           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15779                                                                  00000081
 15780                                                                  00000082
 15781     IF    CR-LFPRM  NUMERIC                                      00000083
 15782           NEXT SENTENCE                                          00000084
 15783        ELSE                                                      00000085
 15784           MOVE ZEROS TO CR-LFPRM.                                00000086
 15785                                                                  00000087
 15786     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15787           NEXT SENTENCE                                          00000089
 15788        ELSE                                                      00000090
 15789           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15790                                                                  00000092
 15791                                                                  00000093
 15792     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15793           NEXT SENTENCE                                          00000095
 15794        ELSE                                                      00000096
 15795           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15796                                                                  00000098
 15797     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15798           NEXT SENTENCE                                          00000100
 15799        ELSE                                                      00000101
 15800           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15801                                                                  00000103
 15802     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15803           NEXT SENTENCE                                          00000105
 15804        ELSE                                                      00000106
 15805           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15806                                                                  00000108
 15807     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15808     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15809     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15810         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15811     ELSE                                                         ECSRTPFM
 15812         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15813     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 303
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15814                                                                  ECSRTPFM
 15815     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15816     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15817     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15818         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15819     ELSE                                                         ECSRTPFM
 15820         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15821     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15822                                                                  ECSRTPFM
 15823     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15824         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15825             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15826                                                                  ECSRTPFM
 15827
 15828     IF CR-STATE NOT = STATE-L
 15829         MOVE CR-STATE               TO STATE-L
 15830         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15831
 15832     MOVE 'X'                     TO REIN-RT-SW.
 15833     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15834     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15835     MOVE ' '                     TO REIN-RT-SW.
 15836
 15837 3710-RC-REIN-LOOP-2.
 15838
 15839     IF REIN-COMP (SUB1) = SPACES
 15840         GO TO 3730-RC-REIN-EXTRACTS.
 15841
 15842     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15843        ADD +1 TO SUB1
 15844         GO TO 3710-RC-REIN-LOOP-2.
 15845
 15846     MOVE +1 TO SUB2.
 15847
 15848 3720-RC-REIN-LOOP-3.
 15849
 15850     IF RC-REIN-COMP (SUB2) = SPACES
 15851         ADD +1 TO SUB1
 15852         GO TO 3710-RC-REIN-LOOP-2.
 15853
 15854     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15855         ADD +1 TO SUB2
 15856         GO TO 3720-RC-REIN-LOOP-3.
 15857
 15858     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15859        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15860        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15861        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15862         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15863         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15864
 15865     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15866        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15867         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15868         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15869
 15870     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15871         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 304
* ECS010.cbl
 15872         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15873
 15874     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15875         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15876         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15877
 15878     ADD +1 TO SUB2.
 15879     GO TO 3720-RC-REIN-LOOP-3.
 15880
 15881 3730-RC-REIN-EXTRACTS.
 15882
 15883     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15884     MOVE 'R' TO DE-REIN.
 15885     MOVE 'J' TO DE-TRANS.
 15886*****PERFORM EXTRACT-DATE-RELOAD.
 15887     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15888     MOVE +1 TO SUB1.
 15889
 15890 3740-RC-REIN-OLD-ISSUE.
 15891
 15892     IF RC-REIN-COMP (SUB1) = SPACES
 15893         MOVE +1 TO SUB1
 15894         GO TO 3745-RC-REIN-NEW-ISSUE.
 15895
 15896     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15897         ADD +1 TO SUB1
 15898         GO TO 3740-RC-REIN-OLD-ISSUE.
 15899
 15900     IF RC-OLD-ISS (SUB1) = 'X'
 15901         ADD +1 TO SUB1
 15902         GO TO 3740-RC-REIN-OLD-ISSUE.
 15903
 15904     IF RC-REIN-LFAMT (SUB1) = ZERO
 15905        AND RC-REIN-LFPRM (SUB1) = ZERO
 15906        AND RC-REIN-AHAMT (SUB1) = ZERO
 15907        AND RC-REIN-AHPRM (SUB1) = ZERO
 15908         ADD +1 TO SUB1
 15909         GO TO 3740-RC-REIN-OLD-ISSUE.
 15910
 15911     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15912     PERFORM EXTRACT-DATE-LOAD.
 15913     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15914     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15915     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15916     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15917     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15918     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15919
 15920     ADD +1 TO BC-R-ISS.
 15921     ADD +1 TO SUB1.
 15922     GO TO 3740-RC-REIN-OLD-ISSUE.
 15923
 15924 3745-RC-REIN-NEW-ISSUE.
 15925
 15926     IF REIN-COMP (SUB1) = SPACES
 15927         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15928                                         2259-END-CANCEL-BUILD
 15929         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 305
* ECS010.cbl
 15930         MOVE 'K'      TO DE-TRANS
 15931*********PERFORM EXTRACT-DATE-RELOAD
 15932         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15933         MOVE +1       TO SUB1
 15934         GO TO 3750-RC-REIN-OLD-CANCEL.
 15935
 15936     IF REIN-REM-SW (SUB1) = 'Z'
 15937         ADD +1 TO SUB1
 15938         GO TO 3745-RC-REIN-NEW-ISSUE.
 15939
 15940     IF RC-NEW-ISS (SUB1) = 'X'
 15941         ADD +1 TO SUB1
 15942         GO TO 3745-RC-REIN-NEW-ISSUE.
 15943
 15944     IF REIN-LFAMT (SUB1) = ZERO
 15945        AND REIN-LFPRM (SUB1) = ZERO
 15946        AND REIN-AHAMT (SUB1) = ZERO
 15947        AND REIN-AHPRM (SUB1) = ZERO
 15948         ADD +1 TO SUB1
 15949         GO TO 3745-RC-REIN-NEW-ISSUE.
 15950
 15951     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15952     PERFORM EXTRACT-DATE-LOAD.
 15953     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15954     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15955     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15956     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15957     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15958     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15959
 15960     ADD +1 TO BC-R-ISS.
 15961     ADD +1 TO SUB1.
 15962     GO TO 3745-RC-REIN-NEW-ISSUE.
 15963
 15964 3750-RC-REIN-OLD-CANCEL.
 15965
 15966     IF RC-REIN-COMP (SUB1) = SPACES
 15967         MOVE +1 TO SUB1
 15968         GO TO 3755-RC-REIN-NEW-CANCEL.
 15969
 15970     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15971         ADD +1 TO SUB1
 15972         GO TO 3750-RC-REIN-OLD-CANCEL.
 15973
 15974     IF RC-OLD-CNC (SUB1) = 'X'
 15975         ADD +1 TO SUB1
 15976         GO TO 3750-RC-REIN-OLD-CANCEL.
 15977
 15978     IF RC-REIN-LFRFND (SUB1) = ZERO
 15979        AND RC-REIN-AHRFND (SUB1) = ZERO
 15980         ADD +1 TO SUB1
 15981         GO TO 3750-RC-REIN-OLD-CANCEL.
 15982
 15983     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 15984     PERFORM EXTRACT-DATE-LOAD.
 15985     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15986     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 15987     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 306
* ECS010.cbl
 15988     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15989
 15990     ADD +1 TO BC-R-CNC.
 15991     ADD +1 TO SUB1.
 15992     GO TO 3750-RC-REIN-OLD-CANCEL.
 15993
 15994 3755-RC-REIN-NEW-CANCEL.
 15995
 15996     IF REIN-COMP (SUB1) = SPACES
 15997         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 15998         MOVE 'R' TO DE-REIN
 15999         MOVE 'L' TO DE-TRANS
 16000*********PERFORM EXTRACT-DATE-RELOAD
 16001         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 16002         MOVE +1 TO SUB1
 16003         GO TO 3760-RC-REIN-OLD-CLAIM.
 16004
 16005     IF REIN-REM-SW (SUB1) = 'Z'
 16006         ADD +1 TO SUB1
 16007         GO TO 3755-RC-REIN-NEW-CANCEL.
 16008
 16009     IF RC-NEW-CNC (SUB1) = 'X'
 16010         ADD +1 TO SUB1
 16011         GO TO 3755-RC-REIN-NEW-CANCEL.
 16012
 16013     IF REIN-LFRFND (SUB1) = ZERO
 16014        AND REIN-AHRFND (SUB1) = ZERO
 16015         ADD +1 TO SUB1
 16016         GO TO 3755-RC-REIN-NEW-CANCEL.
 16017
 16018     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 16019     PERFORM EXTRACT-DATE-LOAD.
 16020     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 16021     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 16022     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 16023     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16024
 16025     ADD +1 TO BC-R-CNC.
 16026     ADD +1 TO SUB1.
 16027     GO TO 3755-RC-REIN-NEW-CANCEL.
 16028
 16029 3760-RC-REIN-OLD-CLAIM.
 16030
 16031     IF RC-REIN-COMP (SUB1) = SPACES
 16032         MOVE +1 TO SUB1
 16033         GO TO 3780-RC-REIN-NEW-CLAIM.
 16034
 16035     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16036         ADD +1 TO SUB1
 16037         GO TO 3760-RC-REIN-OLD-CLAIM.
 16038
 16039     IF RC-OLD-LF-CLM (SUB1) = 'X'
 16040         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16041
 16042     IF RC-REIN-LFCLM (SUB1) = ZERO
 16043         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16044
 16045     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 307
* ECS010.cbl
 16046     PERFORM EXTRACT-DATE-LOAD.
 16047     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16048     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16049     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16050     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16051     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16052     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16053     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 16054     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 16055     MOVE CR-DTH-PAY-DT TO DE-PAY
 16056                           WS-DE-PAY-N.
 16057
 16058     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16059         MOVE '3' TO DE-TYPE
 16060     ELSE
 16061         MOVE '1' TO DE-TYPE.
 16062
 16063     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16064
 16065     ADD +1 TO BC-R-CLM.
 16066
 16067 3770-RC-REIN-OLD-AH-CLM.
 16068
 16069     IF RC-OLD-AH-CLM (SUB1) = 'X'
 16070         ADD +1 TO SUB1
 16071         GO TO 3760-RC-REIN-OLD-CLAIM.
 16072
 16073     IF RC-REIN-AHCLM (SUB1) = ZERO
 16074         ADD +1 TO SUB1
 16075         GO TO 3760-RC-REIN-OLD-CLAIM.
 16076
 16077     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 16078     PERFORM EXTRACT-DATE-LOAD.
 16079     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16080     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16081     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16082     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16083     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16084     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16085     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 16086     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 16087     MOVE CR-DIS-PAY-DT TO DE-PAY
 16088                           WS-DE-PAY-N.
 16089
 16090     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16091         MOVE '4' TO DE-TYPE
 16092     ELSE
 16093         MOVE '2' TO DE-TYPE.
 16094
 16095     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16096
 16097     ADD +1 TO BC-R-CLM.
 16098     ADD +1 TO SUB1.
 16099
 16100     GO TO 3760-RC-REIN-OLD-CLAIM.
 16101
 16102 3780-RC-REIN-NEW-CLAIM.
 16103
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 308
* ECS010.cbl
 16104     IF REIN-COMP (SUB1) = SPACES
 16105         GO TO 3799-RC-REINSURANCE-X.
 16106
 16107     IF REIN-REM-SW (SUB1) = 'Z'
 16108         ADD +1 TO SUB1
 16109         GO TO 3780-RC-REIN-NEW-CLAIM.
 16110
 16111     IF RC-NEW-LF-CLM (SUB1) = 'X'
 16112         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16113
 16114     IF REIN-LFCLM (SUB1) = ZERO
 16115         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16116
 16117     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16118     PERFORM EXTRACT-DATE-LOAD.
 16119     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16120     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16121     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16122     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16123     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16124     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16125     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 16126     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 16127     MOVE CR-DTH-PAY-DT     TO DE-PAY
 16128                               WS-DE-PAY-N.
 16129
 16130     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16131         MOVE '3' TO DE-TYPE
 16132     ELSE
 16133         MOVE '1' TO DE-TYPE.
 16134
 16135     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16136
 16137     ADD +1 TO BC-R-CLM.
 16138
 16139 3790-RC-REIN-NEW-AH-CLM.
 16140
 16141     IF RC-NEW-AH-CLM (SUB1) = 'X'
 16142         ADD +1 TO SUB1
 16143         GO TO 3780-RC-REIN-NEW-CLAIM.
 16144
 16145     IF REIN-AHCLM (SUB1) = ZERO
 16146         ADD +1 TO SUB1
 16147         GO TO 3780-RC-REIN-NEW-CLAIM.
 16148
 16149     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16150     PERFORM EXTRACT-DATE-LOAD.
 16151     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16152     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16153     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16154     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16155     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16156     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16157     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 16158     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 16159     MOVE CR-DIS-PAY-DT     TO DE-PAY
 16160                               WS-DE-PAY-N.
 16161
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 309
* ECS010.cbl
 16162     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16163         MOVE '4' TO DE-TYPE
 16164     ELSE
 16165         MOVE '2' TO DE-TYPE.
 16166
 16167     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16168
 16169     ADD +1 TO BC-R-CLM.
 16170     ADD +1 TO SUB1.
 16171
 16172     GO TO 3780-RC-REIN-NEW-CLAIM.
 16173
 16174 3799-RC-REINSURANCE-X.
 16175     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 310
* ECS010.cbl
 16177******************************************************************
 16178***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 16179******************************************************************
 16180
 16181 4000-EP-BUMP-RTN.
 16182
 16183     IF AM-RECALC-COMM = ('Y' OR '1')
 16184        PERFORM 1600-RECALC-COMM-EXTR
 16185                                 THRU 1899-RECALC-COMM-EXTR-X
 16186        MOVE ' '                 TO RECALC-TYPE
 16187     END-IF
 16188
 16189     MOVE '1'    TO EP-FLG.
 16190     ADD +1      TO BC-G-CERTS.
 16191
 16192     MOVE CR-DT               TO HIGH-CERT.
 16193     IF CR-ACCT-CONTROL NOT = LOW-CTL
 16194         MOVE CR-DT           TO LOW-CERT
 16195         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 16196
 16197     IF CR-POLICY-IS-REIN-ONLY
 16198         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16199                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16200                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16201                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16202                              DTH-IBNR           DIS-IBNR
 16203                              DTH-PAYCUR         DIS-PAYCUR
 16204                              DTH-FUTRSV         DIS-FUTRSV
 16205         GO TO 4050-EP-DO-REINSURE.
 16206
 16207     MOVE CR-LFAMT       TO WE-LFAMT.
 16208     MOVE CR-LFPRM       TO WE-LFPRM.
 16209     IF CR-LFTYP NOT = ZEROS
 16210         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16211             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 16212             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 16213         ELSE
 16214             MOVE ZEROS               TO WE-LFAMT-ALT
 16215                                         WE-LFPRM-ALT.
 16216
 16217     MOVE SPACES         TO REIN-EP-FLG
 16218                            WE-REIN-CO.
 16219     MOVE CR-LFRFND      TO WE-LFRFND.
 16220     MOVE CR-DTHAMT      TO WE-DTHAMT.
 16221     ADD  CR-DTHEXP      TO WE-DTHAMT.
 16222     MOVE CR-DTHEXP      TO WE-DTHEXP.
 16223     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 16224     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 16225     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 16226     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 16227
 16228     MOVE CR-AHPRM       TO WE-AHPRM.
 16229     MOVE CR-AHAMT       TO WE-AHAMT.
 16230     MOVE CR-AHRFND      TO WE-AHRFND.
 16231     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 16232     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 16233     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 16234     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 311
* ECS010.cbl
 16235     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 16236     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 16237     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 16238
 16239     IF CR-POLICY-IS-RESTORE  OR
 16240        CR-POLICY-IS-REISSUE
 16241        OR CR-POLICY-IS-MONTHLY
 16242         MOVE ZEROS      TO WE-LFPRM
 16243                            WE-LFPRM-ALT
 16244                            WE-AHPRM.
 16245
 16246     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16247                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16248                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16249                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16250                              DTH-IBNR           DIS-IBNR
 16251                              DTH-PAYCUR         DIS-PAYCUR
 16252                              DTH-FUTRSV         DIS-FUTRSV.
 16253
 16254*     DISPLAY ' B4 4100 '
 16255     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16256*     DISPLAY ' AFTER 4100 '
 16257
 16258     IF CR-POLICY-IS-DECLINED  OR
 16259        CR-POLICY-IS-VOID
 16260         GO TO 4099-EP-BUMP-RTN-X.
 16261
 16262 4050-EP-DO-REINSURE.
 16263
 16264     MOVE 'R' TO REIN-EP-FLG.
 16265     MOVE +1  TO SUB5.
 16266
 16267 4090-EP-DO-REINSURE-LOOP.
 16268
 16269*     DISPLAY ' 4090 '
 16270     IF REIN-COMP (SUB5) = SPACES
 16271         MOVE SPACE TO REIN-EP-FLG
 16272         GO TO 4099-EP-BUMP-RTN-X.
 16273
 16274     IF REIN-REM-SW (SUB5) = 'Z'  OR
 16275        REIN-LF-AH-FLGS (SUB5) = SPACES
 16276         ADD +1 TO SUB5
 16277         GO TO 4090-EP-DO-REINSURE-LOOP.
 16278
 16279     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 16280        VARYING CO-SUB FROM 1 BY 1 UNTIL
 16281          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 16282          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 16283          (RCT-REIN-CO (CO-SUB) = SPACES).
 16284
 16285     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 16286        (RCT-REIN-CO (CO-SUB) = SPACES)
 16287        MOVE ZERO TO CO-SUB.
 16288
 16289*     DISPLAY ' 4090 A '
 16290*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 16291     ADD +1 TO BC-R-CERTS.
 16292     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 312
* ECS010.cbl
 16293     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 16294     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 16295
 16296     IF (DTE-CLIENT = 'DCC')
 16297        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 16298*        DISPLAY ' B4 CEDE FACT '
 16299*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 16300*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 16301*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 16302        COMPUTE WS-CEDE-FACT =
 16303           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16304*        DISPLAY ' AFTER CEDE FACT '
 16305        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16306           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16307                                     NOT = 'G' AND 'L')
 16308           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16309*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 16310*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 16311           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 16312           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 16313        END-IF
 16314     END-IF
 16315
 16316     MOVE RWF-LFPRM      TO WE-LFPRM.
 16317     MOVE RWF-LFAMT      TO WE-LFAMT.
 16318     MOVE RWF-LFRFND     TO WE-LFRFND.
 16319     MOVE RWF-LFCLM      TO WE-DTHAMT.
 16320     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 16321     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 16322     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 16323     MOVE +0             TO WE-LFAMT-ALT
 16324                            WE-LFPRM-ALT
 16325                            WE-DTHEXP
 16326                            WE-NUM-DTH-CLM.
 16327
 16328*     DISPLAY ' 4090 B '
 16329     IF (DTE-CLIENT EQUAL 'NSL') AND
 16330        (CR-REIN-TABLE EQUAL 'NAR')
 16331        CONTINUE
 16332     ELSE
 16333      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 16334       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 16335        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 16336            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16337        COMPUTE WE-LFAMT ROUNDED EQUAL
 16338                           CR-LFAMT * WS-CEDE-FACT
 16339        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 16340                           CR-LFAMT-ALT * WS-CEDE-FACT
 16341        IF (DTE-CLIENT = 'CID')
 16342           AND (CR-LF-NSP-PRM > +0)
 16343           AND (CR-ENTRY-DATE > 20031130)
 16344           AND (WT-LF-QC NOT = '1' AND '3')
 16345           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 16346              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16347           MOVE +0            TO WE-LFPRM-ALT
 16348        ELSE
 16349          IF (DTE-CLIENT = 'CID')
 16350             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 313
* ECS010.cbl
 16351             AND (CR-ENTRY-DATE > 20030430)
 16352             AND (WT-LF-QC NOT = '1' AND '3')
 16353             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16354             MOVE +0            TO WE-LFPRM-ALT
 16355          ELSE
 16356             COMPUTE WE-LFPRM ROUNDED EQUAL
 16357                           CR-LFPRM * WS-CEDE-FACT
 16358             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 16359                           CR-LFPRM-ALT * WS-CEDE-FACT
 16360          END-IF
 16361        END-IF
 16362        IF (DTE-CLIENT = 'CID')
 16363           AND (CR-LF-NSP-PRM > +0)
 16364           AND (CR-LFRFND-CALC > +0)
 16365           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 16366           AND (WT-LF-QC NOT = '1' AND '4')
 16367           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 16368              (CR-LFPRM + CR-LFPRM-ALT)
 16369           COMPUTE WE-LFRFND =
 16370              REIN-FACTOR * REIN-CALCED-LIFE
 16371           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 16372              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16373*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 16374*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 16375*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16376        ELSE
 16377
 16378          IF (DTE-CLIENT = 'CID')
 16379           AND (CR-LF-NSP-PRM > +0)
 16380           AND (CR-LFRFND-CALC > +0)
 16381           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 16382           AND (WT-LF-QC NOT = '1' AND '4')
 16383           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16384           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 16385              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 16386
 16387          END-IF
 16388        END-IF
 16389       ELSE
 16390         MOVE +0 TO WS-CEDE-FACT
 16391       END-IF
 16392      END-IF
 16393     END-IF
 16394
 16395*     DISPLAY ' 4090 C '
 16396     IF DTE-CLIENT = 'DCC'
 16397        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16398           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16399                                   NOT = 'G' AND 'L')
 16400           AND (CR-AHAMT NOT = ZEROS)
 16401*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 16402           COMPUTE WS-CEDE-FACT =
 16403               RWF-AHAMT / CR-AHAMT
 16404           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 16405*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 16406*          / CR-AHPRM * CR-AHRFND
 16407           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 16408           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 314
* ECS010.cbl
 16409        END-IF
 16410     END-IF
 16411
 16412     MOVE RWF-AHPRM      TO WE-AHPRM.
 16413
 16414     MOVE RWF-AHAMT      TO WE-AHAMT
 16415     MOVE RWF-AHRFND     TO WE-AHRFND.
 16416     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 16417     MOVE +0             TO WE-DSPY-EXP
 16418                            WE-NUM-DIS-CLM.
 16419     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 16420     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 16421     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 16422
 16423     IF  RWF-LF-RUNOFF-SW = 'N'
 16424             OR
 16425         RWF-AH-RUNOFF-SW = 'N'
 16426         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 16427
 16428     IF  RWF-LF-RUNOFF-SW = 'N'
 16429         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 16430     ELSE
 16431         MOVE 99999999             TO STOP-LF-DATE.
 16432
 16433     IF  RWF-AH-RUNOFF-SW = 'N'
 16434         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 16435     ELSE
 16436         MOVE 99999999             TO STOP-AH-DATE.
 16437
 16438     IF CR-POLICY-IS-RESTORE  OR
 16439        CR-POLICY-IS-REISSUE
 16440        OR CR-POLICY-IS-MONTHLY
 16441         MOVE ZEROS      TO WE-LFPRM
 16442                            WE-LFPRM-ALT
 16443                            WE-AHPRM.
 16444
 16445*     DISPLAY ' B4 4100-EP-DO-LF '
 16446     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16447*     DISPLAY ' AFTER 4100-EP-DO-LF '
 16448
 16449     IF CO-SUB NOT = ZERO
 16450       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 16451         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 16452             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 16453
 16454     ADD +1 TO SUB5.
 16455     GO TO 4090-EP-DO-REINSURE-LOOP.
 16456
 16457 4099-EP-BUMP-RTN-X.
 16458     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 315
* ECS010.cbl
 16460******************************************************************
 16461***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 16462******************************************************************
 16463
 16464 4100-EP-DO-LF.
 16465
 16466     MOVE +0                         TO ISS-BEN  EPR-R78
 16467                                        CNC-BEN  EPR-PRO
 16468                                        ISS-PRM  EPR-ST
 16469                                        ISS-PRMTAX
 16470                                        CNC-PRM  ACTIVE-COUNT.
 16471     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 16472
 16473     IF CR-LFTYP = ZERO
 16474         GO TO 4200-EP-DO-AH.
 16475
 16476     IF REIN-EP-FLG = 'R'
 16477         IF REIN-LF-FLG (SUB5) = SPACE
 16478             GO TO 4200-EP-DO-AH.
 16479
 16480     IF CR-APR NOT NUMERIC
 16481         MOVE ZERO TO CR-APR.
 16482
 16483     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 16484     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 16485     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16486
 16487     IF CR-POLICY-IS-DECLINED  OR
 16488        CR-POLICY-IS-VOID
 16489         GO TO 4191-CONTINUE.
 16490
 16491     MOVE CR-LF-TERM             TO ORIG-TERM.
 16492     MOVE CLAS-INDEXL            TO W-NDX.
 16493
 16494     IF CR-DT GREATER EW-COV-DTE
 16495         MOVE CR-DT              TO EW-COV-DTE.
 16496
 16497     IF (NOT CR-POLICY-IS-RESTORE) AND
 16498        (NOT CR-POLICY-IS-REISSUE)
 16499        AND (NOT CR-POLICY-IS-MONTHLY)
 16500         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 16501         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16502             ADD CR-LIVES TO EW-ISS-CNT
 16503             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16504                                    (ORIG-TERM * CR-LIVES)
 16505             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16506             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16507             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16508                                   (ORIG-TERM * ISS-BEN)
 16509         ELSE
 16510             IF (DTE-CLIENT = 'DCC')
 16511                AND (CR-LFTYP = 'DD')
 16512                CONTINUE
 16513             ELSE
 16514                ADD +1 TO EW-ISS-CNT
 16515             END-IF
 16516             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16517             COMPUTE EW-AGE = EW-AGE + CR-AGE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 316
* ECS010.cbl
 16518             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16519             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16520                                   (ORIG-TERM * ISS-BEN).
 16521
 16522     MOVE RUN-DATE        TO VALUATION-DT.
 16523     MOVE '2'             TO W-VAL-SOURCE.
 16524
 16525     IF REIN-EP-FLG = 'R'
 16526         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 16527            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16528             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16529             MOVE '10'              TO W-VAL-SOURCE.
 16530
 16531     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16532
 16533     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 16534        (REM-TRM3 GREATER ZERO)
 16535        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16536            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16537                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16538            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16539                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16540          ELSE
 16541            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16542            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16543
 16544     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 16545
 16546     IF DTE-CLIENT = 'GIC'
 16547         IF REIN-EP-FLG NOT = 'R'  AND
 16548            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 16549            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 16550            MOVE CR-LFPRM-CALC TO ISS-PRM.
 16551
 16552     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16553         GO TO 4105-EP-DO-LF-REIN-CHK.
 16554
 16555     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16556             AND
 16557         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16558             AND
 16559         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 16560                 OR
 16561             CR-LF-CANC-DT EQUAL ZEROS)
 16562             AND
 16563         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 16564                 OR
 16565             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16566         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 16567         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 16568                 VARYING
 16569             SUBM FROM +1 BY +1
 16570                 UNTIL
 16571             SUBM GREATER THAN +13.
 16572
 16573     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16574     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16575
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 317
* ECS010.cbl
 16576 4105-EP-DO-LF-REIN-CHK.
 16577
 16578     IF REIN-EP-FLG = 'R'  AND
 16579        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 16580         NEXT SENTENCE
 16581     ELSE
 16582         GO TO 4110-EP-DO-LF-CLM.
 16583
 16584     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 16585         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 16586             GO TO 4130-EP-DO-LF-EP.
 16587
 16588     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16589         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 16590             GO TO 4130-EP-DO-LF-EP.
 16591
 16592 4110-EP-DO-LF-CLM.
 16593
 16594     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 16595         NEXT  SENTENCE
 16596       ELSE
 16597         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16598
 16599     ADD WE-DTHAMT      TO EW-CLM-AMT.
 16600     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 16601
 16602     IF CR-LF-STATUS-AT-DEATH = ' '
 16603         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 16604             GO TO 4115-EP-DO-LF-CLM-EPR.
 16605
 16606     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 16607     ADD +1             TO EW-CLM-CRT.
 16608
 16609 4115-EP-DO-LF-CLM-EPR.
 16610
 16611     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16612         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16613         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16614     END-IF
 16615     .
 16616 4120-EP-DO-LF-CNCL.
 16617
 16618     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 16619        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 16620         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16621             GO TO 4190-EP-DO-LF-COMM
 16622         ELSE
 16623             GO TO 4130-EP-DO-LF-EP.
 16624
 16625     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16626         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 16627         GO TO 4124-EP-DO-LF-CNCL-SUM.
 16628
 16629     IF CR-LFTYP NOT = 'DD'
 16630        ADD +1                    TO EW-CNC-CNT
 16631     END-IF
 16632
 16633     MOVE WE-LFRFND               TO CNC-PRM.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 318
* ECS010.cbl
 16634
 16635     IF DTE-CLIENT = 'GIC'
 16636         IF REIN-EP-FLG NOT = 'R'  AND
 16637            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16638             MOVE CR-LFRFND-CALC TO CNC-PRM.
 16639
 16640*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 16641*    MOVE 'L'                   TO  DC-OPTION-CODE.
 16642*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16643*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 16644
 16645     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 16646     MOVE 'L'                   TO  DC-OPTION-CODE.
 16647     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16648     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 16649
 16650     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 16651     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 16652     MOVE '1'                     TO  DC-OPTION-CODE.
 16653     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 16654     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 16655     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 16656                                      DC-ODD-DAYS-OVER
 16657                                      DC-ELAPSED-DAYS.
 16658     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16659     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 16660
 16661     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 16662         ADD  +1                  TO  MONTHS-DIFF-LF.
 16663
 16664     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16665
 16666     if (dte-client = 'AHL')
 16667        and (cr-lf-cancel-exit-date < 20120401)
 16668        go to 4120-continue-life-cancel
 16669     end-if
 16670
 16671     IF DTE-CLIENT = 'ACE'
 16672         GO TO 4120-CONTINUE-LIFE-CANCEL.
 16673
 16674     MOVE  ZEROS                  TO  SUB.
 16675
 16676 4120-LIFE-CHARGEBACK-LOOP.
 16677
 16678     ADD    +1                    TO  SUB.
 16679
 16680     IF  SUB  GREATER THAN  +10
 16681         GO TO  4120-CONTINUE-LIFE-CANCEL.
 16682
 16683     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 16684         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 16685         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16686
 16687     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 16688         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 16689
 16690     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 16691         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 319
* ECS010.cbl
 16692
 16693     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16694
 16695
 16696 4120-CONTINUE-LIFE-CANCEL.
 16697
 16698     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16699     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 16700
 16701     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 16702         GO TO 4190-EP-DO-LF-COMM.
 16703
 16704     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16705         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16706         GO TO 4190-EP-DO-LF-COMM.
 16707
 16708     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16709     MOVE '3'           TO W-VAL-SOURCE.
 16710     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16711
 16712     IF REM-TRM3 = CR-LF-TERM
 16713         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16714         GO TO 4190-EP-DO-LF-COMM.
 16715
 16716     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16717         GO TO 4122-EP-DO-LF-CNCL-TEX.
 16718
 16719     IF DTE-CLIENT = 'NCL'
 16720         IF CR-DT LESS THAN 19910101
 16721             GO TO 4121-EP-DO-LF-CNC-BEN.
 16722
 16723     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16724         GO TO 4126-EP-DO-LF-CNCL-NP.
 16725
 16726     IF DTE-CLIENT = 'FUL'
 16727         GO TO 4128-EP-DO-LF-CNCL-FUL.
 16728
 16729*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16730     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16731        (CR-RATING-CLASS NOT = 'L ')
 16732         IF (CR-APR GREATER THAN ZERO)  AND
 16733            (CR-LF-TERM GREATER THAN 060)  AND
 16734            (CR-DT GREATER THAN 19831031)
 16735              GO TO 4126-EP-DO-LF-CNCL-NP.
 16736
 16737     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16738         IF (CR-APR GREATER THAN ZERO)  AND
 16739            (CR-LF-TERM GREATER THAN 061)  AND
 16740            (CR-DT GREATER THAN 19830318)
 16741              GO TO 4126-EP-DO-LF-CNCL-NP.
 16742
 16743     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16744         IF (CR-APR GREATER THAN ZERO)  AND
 16745            (CR-LF-TERM GREATER THAN 062)  AND
 16746            (CR-DT GREATER THAN 19810831)  AND
 16747            (CR-DT LESS THAN 19830901)
 16748              GO TO 4126-EP-DO-LF-CNCL-NP.
 16749
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 320
* ECS010.cbl
 16750     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16751         IF (CR-APR GREATER THAN ZERO)  AND
 16752            (CR-LF-TERM GREATER THAN 060)  AND
 16753            (CR-DT GREATER THAN 19831231)
 16754              GO TO 4126-EP-DO-LF-CNCL-NP.
 16755
 16756 4121-EP-DO-LF-CNC-BEN.
 16757
 16758     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16759
 16760     COMPUTE TEMP-3 ROUNDED EQUAL
 16761         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
 16762
 16763     MOVE TEMP-3                 TO CNC-BEN.
 16764
 16765     GO TO 4190-EP-DO-LF-COMM.
 16766
 16767 4122-EP-DO-LF-CNCL-TEX.
 16768
 16769     DIVIDE WE-LFAMT BY CR-LF-TERM
 16770         GIVING TEX-FACT-1.
 16771     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16772         GIVING TEX-FACT-2
 16773             REMAINDER TEX-FACT-3.
 16774     IF TEX-FACT-3 NOT = ZERO
 16775         ADD +1 TO TEX-FACT-2.
 16776
 16777     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16778
 16779     GO TO 4190-EP-DO-LF-COMM.
 16780
 16781 4124-EP-DO-LF-CNCL-SUM.
 16782
 16783     IF WE-LFRFND = ZERO
 16784         GO TO 4130-EP-DO-LF-EP.
 16785
 16786     MOVE WE-LFRFND TO CNC-PRM.
 16787
 16788     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16789
 16790     IF WE-LFRFND NOT LESS WE-LFPRM
 16791         MOVE WE-LFAMT TO CNC-BEN
 16792          GO TO 4130-EP-DO-LF-EP.
 16793
 16794
 16795     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16796
 16797     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16798         MOVE TEMP-7 TO CNC-BEN
 16799          GO TO 4130-EP-DO-LF-EP.
 16800
 16801     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16802     MOVE '4'           TO W-VAL-SOURCE.
 16803     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16804
 16805     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16806         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16807         GO TO 4130-EP-DO-LF-EP.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 321
* ECS010.cbl
 16808
 16809 4126-EP-DO-LF-CNCL-NP.
 16810
 16811     IF WE-LFAMT = ZERO
 16812        GO TO 4190-EP-DO-LF-COMM.
 16813
 16814     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16815     MOVE 'L'                        TO  DC-OPTION-CODE.
 16816     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16817     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16818
 16819     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 16820       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16821       MOVE '3'                      TO  DC-OPTION-CODE
 16822       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16823       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16824     ELSE
 16825       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16826       MOVE '6'                      TO  DC-OPTION-CODE
 16827       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16828       MOVE +0                       TO  DC-ELAPSED-DAYS
 16829       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16830       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16831
 16832     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16833     MOVE CR-APR                     TO  CP-LOAN-APR.
 16834     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16835     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16836     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16837     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16838     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16839     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16840
 16841
 16842     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 16843     IF (DTE-CLIENT = 'DCC')
 16844        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16845        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 16846           ((CR-STATE = DD-STATE (D1))
 16847           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 16848           AND ('A'           = DD-BEN-TYPE   (D1))
 16849           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 16850           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 16851                           OR
 16852           D1 > max-pdef
 16853        END-PERFORM
 16854        IF D1 <= max-pdef
 16855           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 16856              (P1 > +8)
 16857              OR (DD-PROD-CODE (D1 P1) = 'L')
 16858           END-PERFORM
 16859           IF P1 < +9
 16860              MOVE DD-MAX-BEN-AMT (D1 P1)
 16861                                 TO CP-R-MAX-TOT-BEN
 16862           END-IF
 16863        END-IF
 16864     END-IF
 16865
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 322
* ECS010.cbl
 16866     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16867
 16868     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16869       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16870       GO TO 4130-EP-DO-LF-EP
 16871     ELSE
 16872       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16873
 16874     GO TO 4190-EP-DO-LF-COMM.
 16875
 16876 4128-EP-DO-LF-CNCL-FUL.
 16877
 16878     IF WE-LFAMT = ZERO
 16879        GO TO 4190-EP-DO-LF-COMM.
 16880
 16881     MOVE CR-APR              TO NP-APR.
 16882     MOVE CR-LF-TERM          TO NP-ORIG.
 16883     MOVE REM-TRM3            TO NP-REM.
 16884     MOVE '2'                 TO NP-OPT.
 16885     MOVE CR-AHPRM            TO NP-AHPRM.
 16886     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16887     MOVE CR-LFAMT            TO NP-BENEFIT.
 16888
 16889*    CALL 'FULNETRM'
 16890*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16891*              NP-ACCOUNT NP-REMAINING.
 16892
 16893     MOVE NP-REMAINING TO CNC-BEN.
 16894
 16895     GO TO 4190-EP-DO-LF-COMM.
 16896
 16897 4130-EP-DO-LF-EP.
 16898
 16899     MOVE SPACE                  TO STATUTORY-SWITCH.
 16900
 16901     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16902     MOVE '5'           TO W-VAL-SOURCE.
 16903
 16904     IF REIN-EP-FLG = 'R'
 16905       IF REIN-REM-SW (SUB5) = 'I'
 16906           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16907           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16908           GO TO 4190-EP-DO-LF-COMM.
 16909
 16910     IF REIN-EP-FLG = 'R'
 16911         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16912            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16913             MOVE '*'               TO LIFE-EARNED-SWITCH
 16914             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16915             MOVE '10'              TO W-VAL-SOURCE.
 16916
 16917     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16918
 16919     IF REM-TRM2 GREATER CR-LF-TERM
 16920         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16921         GO TO 4190-EP-DO-LF-COMM.
 16922
 16923     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 323
* ECS010.cbl
 16924         GO TO 4180-EP-DO-LF-EP-SUM.
 16925
 16926     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16927         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16928             IF REM-TRM2 NOT GREATER THAN +0
 16929                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16930                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16931                 GO TO 4190-EP-DO-LF-COMM
 16932             ELSE
 16933                 NEXT SENTENCE
 16934         ELSE
 16935             IF W-BAL-REMTRM NOT GREATER +0
 16936                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16937                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16938                 GO TO 4190-EP-DO-LF-COMM
 16939             ELSE
 16940                 NEXT SENTENCE
 16941     ELSE
 16942        IF DTE-CLIENT = 'NCL'  AND
 16943           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16944            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16945        ELSE
 16946         IF REM-TRM2 NOT GREATER +0  OR
 16947            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16948             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16949             GO TO 4190-EP-DO-LF-COMM.
 16950
 16951     MOVE +1 TO ACTIVE-COUNT.
 16952
 16953     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16954         GO TO 4140-EP-DO-LF-EP-TEX.
 16955
 16956     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16957         GO TO 4150-EP-DO-LF-EP-NP.
 16958
 16959*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16960     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16961        (CR-RATING-CLASS NOT = 'L ')
 16962         IF (CR-APR GREATER THAN ZERO)  AND
 16963            (CR-LF-TERM GREATER THAN 060)  AND
 16964            (CR-DT GREATER THAN 19831031)
 16965             MOVE '*'             TO STATUTORY-SWITCH
 16966              GO TO 4150-EP-DO-LF-EP-NP.
 16967
 16968     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16969         IF (CR-APR GREATER THAN ZERO)  AND
 16970            (CR-LF-TERM GREATER THAN 061)  AND
 16971            (CR-DT GREATER THAN 19830318)
 16972             MOVE '*'             TO STATUTORY-SWITCH
 16973              GO TO 4150-EP-DO-LF-EP-NP.
 16974
 16975     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16976         IF (CR-APR GREATER THAN ZERO)  AND
 16977            (CR-LF-TERM GREATER THAN 062)  AND
 16978            (CR-DT GREATER THAN 19810831)  AND
 16979            (CR-DT LESS THAN 19830901)
 16980             MOVE '*'             TO STATUTORY-SWITCH
 16981              GO TO 4150-EP-DO-LF-EP-NP.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 324
* ECS010.cbl
 16982
 16983     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16984         IF (CR-APR GREATER THAN ZERO)  AND
 16985            (CR-LF-TERM GREATER THAN 060)  AND
 16986            (CR-DT GREATER THAN 19831231)
 16987             MOVE '*'             TO STATUTORY-SWITCH
 16988              GO TO 4150-EP-DO-LF-EP-NP.
 16989
 16990     GO TO 4160-EP-DO-LF-EP-R78.
 16991
 16992 4140-EP-DO-LF-EP-TEX.
 16993
 16994     IF CR-PMT-FREQ = 0
 16995       DISPLAY '*************************************'
 16996       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 16997       DISPLAY '*************************************'
 16998       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 16999       DISPLAY '*************************************'
 17000       COMPUTE TEX-FACT-4 =
 17001          (CR-LF-TERM * CR-LF-TERM) +
 17002                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 17003     ELSE
 17004        COMPUTE TEX-FACT-4 =
 17005         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17006
 17007     IF CR-PMT-FREQ = 0
 17008       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 17009           GIVING TEX-FACT-5
 17010               REMAINDER TEX-FACT-6
 17011     ELSE
 17012        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17013            GIVING TEX-FACT-5
 17014                REMAINDER TEX-FACT-6.
 17015
 17016     IF CR-PMT-FREQ > 0
 17017        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 17018
 17019     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17020     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17021         (TEX-FACT-5 * CR-PMT-FREQ) +
 17022         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17023     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17024
 17025     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17026
 17027     GO TO 4170-EP-DO-LF-EP-PRO.
 17028
 17029 4150-EP-DO-LF-EP-NP.
 17030
 17031     IF WE-LFPRM = ZERO
 17032         GO TO 4160-EP-DO-LF-EP-R78.
 17033
 17034     IF DTE-CLIENT = 'CRI'
 17035       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17036             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17037           GO TO 4160-EP-DO-LF-EP-R78.
 17038
 17039     IF DTE-CLIENT = 'AHL'
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 325
* ECS010.cbl
 17040        GO TO 4160-EP-DO-LF-EP-R78
 17041     END-IF
 17042
 17043     IF DTE-CLIENT = 'NCL'
 17044       IF CR-DT LESS THAN 19910101
 17045           GO TO 4160-EP-DO-LF-EP-R78.
 17046
 17047     IF REM-TRM1 = CR-LF-TERM
 17048         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17049         GO TO 4190-EP-DO-LF-COMM.
 17050
 17051     MOVE CR-APR TO NP-APR.
 17052     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17053     MOVE REM-TRM1 TO NP-REM.
 17054     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17055     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17056         MOVE CR-LOAN-TERM TO NP-ORIG.
 17057
 17058     MOVE 'R' TO NP-OPT.
 17059     CALL 'ECSNETRM'
 17060         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17061
 17062     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17063
 17064     IF STATUTORY-REQUIREMENT
 17065         MOVE EPR-R78                TO EPR-ST.
 17066
 17067 4160-EP-DO-LF-EP-R78.
 17068
 17069     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17070        (DTE-CLIENT EQUAL 'NCL')
 17071        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17072           (CR-MO EQUAL EOM-MO)
 17073           MOVE '*'            TO OB-DATE-1-SWITCH
 17074           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17075           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17076           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17077           COMPUTE WS-EPR-R78 (SUB3 1) =
 17078                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 17079           GO TO 4190-EP-DO-LF-COMM
 17080        ELSE
 17081        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17082           (CR-MO EQUAL OB-MO (1))
 17083           MOVE '*'            TO OB-DATE-2-SWITCH
 17084           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17085           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17086           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17087           COMPUTE WS-EPR-R78 (SUB3 2) =
 17088                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 17089           GO TO 4190-EP-DO-LF-COMM
 17090        ELSE
 17091        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17092           (CR-MO EQUAL OB-MO (2))
 17093           MOVE '*'            TO OB-DATE-3-SWITCH
 17094           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17095           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17096           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17097           COMPUTE WS-EPR-R78 (SUB3 3) =
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 326
* ECS010.cbl
 17098                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 17099           GO TO 4190-EP-DO-LF-COMM
 17100        ELSE
 17101           GO TO 4190-EP-DO-LF-COMM.
 17102
 17103     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17104
 17105     IF DTE-R78 = '1'
 17106         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17107     ELSE
 17108         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17109
 17110     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17111
 17112     IF REM-TRM1 GREATER THAN +0
 17113         COMPUTE TEMP-7 ROUNDED EQUAL
 17114             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17115     ELSE
 17116         MOVE WE-LFPRM                TO TEMP-7.
 17117
 17118     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17119         MOVE TEMP-7                 TO EPR-ST.
 17120
 17121     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17122         MOVE ZEROS                  TO TEMP-8
 17123         GO TO 4165-END-LF-EP-R78.
 17124
 17125     IF EPR-ST = ZEROS
 17126         MOVE TEMP-7                 TO EPR-ST.
 17127
 17128     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17129         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17130         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17131         IF DTE-R78 = '1'
 17132             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17133
 17134     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17135
 17136     COMPUTE TEMP-8 ROUNDED =
 17137               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17138
 17139 4165-END-LF-EP-R78.
 17140
 17141     IF EPR-R78 = ZEROS
 17142         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17143     ELSE
 17144         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17145
 17146 4170-EP-DO-LF-EP-PRO.
 17147
 17148     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17149         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17150     ELSE
 17151         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17152
 17153     IF REM-TRM1 GREATER THAN +0
 17154         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17155     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 327
* ECS010.cbl
 17156         MOVE WE-LFPRM                  TO TEMP-7.
 17157
 17158     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17159         MOVE ZEROS                     TO TEMP-8
 17160         GO TO 4175-END-LF-EP-PRO.
 17161
 17162     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17163         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17164             COMPUTE TEMP-5 ROUNDED =
 17165                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17166         ELSE
 17167             COMPUTE TEMP-5 ROUNDED =
 17168                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17169
 17170     COMPUTE TEMP-8 ROUNDED =
 17171                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17172
 17173     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17174
 17175 4175-END-LF-EP-PRO.
 17176
 17177     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17178
 17179     GO TO 4185-EP-DO-LF-STATUTORY.
 17180
 17181 4180-EP-DO-LF-EP-SUM.
 17182
 17183     IF REM-TRM1 NOT GREATER +0
 17184         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17185         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17186         GO TO 4190-EP-DO-LF-COMM.
 17187
 17188     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 17189
 17190     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17191         MOVE ZEROS                 TO TEMP-7
 17192     ELSE
 17193         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17194                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17195
 17196     IF TEMP-7 NOT GREATER ZERO
 17197         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17198             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17199             GO TO 4190-EP-DO-LF-COMM
 17200         ELSE
 17201             MOVE ZEROS             TO TEMP-7.
 17202
 17203     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17204     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17205     IF DTE-R78 = '1'
 17206         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17207
 17208     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17209     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17210
 17211     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17212
 17213     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 328
* ECS010.cbl
 17214
 17215     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17216         GO TO 4185-EP-DO-LF-STATUTORY.
 17217
 17218     MOVE EPR-R78                  TO EPR-ST.
 17219
 17220     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17221         MOVE ZEROS                 TO TEMP-8
 17222     ELSE
 17223         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17224                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17225
 17226     IF TEMP-8 NOT GREATER ZERO
 17227         GO TO 4185-EP-DO-LF-STATUTORY.
 17228
 17229     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17230                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17231
 17232     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17233                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17234
 17235     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17236                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17237
 17238 4185-EP-DO-LF-STATUTORY.
 17239
 17240*07635      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17241*07636          MOVE EPR-R78                TO EPR-ST.
 17242     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17243         MOVE EPR-PRO                TO EPR-ST.
 17244
 17245     IF DTE-CLIENT = 'AHL'
 17246        IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17247           MOVE EPR-R78          TO EPR-ST
 17248        ELSE
 17249           MOVE EPR-PRO          TO EPR-ST
 17250        END-IF
 17251     END-IF
 17252
 17253     IF (DTE-CLIENT = 'CID')
 17254        AND ((STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX')
 17255                   OR
 17256            ((STATE-ABBR (CLAS-INDEXS) = 'MN')
 17257            AND (CR-DT > 20091231)))
 17258        AND (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L')
 17259        AND (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 17260           GO TO 4187-EP-DO-LF-STAT-ROA
 17261     END-IF.
 17262
 17263     IF EPR-ST NOT = ZEROS
 17264         GO TO 4190-EP-DO-LF-COMM.
 17265
 17266     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17267         MOVE EPR-R78                TO EPR-ST
 17268     ELSE
 17269         MOVE EPR-PRO                TO EPR-ST.
 17270
 17271     GO TO 4190-EP-DO-LF-COMM.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 329
* ECS010.cbl
 17272
 17273 4187-EP-DO-LF-STAT-ROA.
 17274     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 17275     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17276     MOVE 'L'                        TO DC-OPTION-CODE.
 17277     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17278     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17279     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17280        MOVE CR-LOAN-1ST-PMT-DT      TO  DC-GREG-DATE-1-YMD
 17281        MOVE '3'                     TO  DC-OPTION-CODE
 17282        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17283                              8099-DATE-CONVERT-X
 17284        MOVE DC-BIN-DATE-1           TO  CP-FIRST-PAY-DATE
 17285     ELSE
 17286        MOVE CP-CERT-EFF-DT          TO  DC-BIN-DATE-1
 17287        MOVE +1                      TO  DC-ELAPSED-MONTHS
 17288        MOVE +0                      TO  DC-ELAPSED-DAYS
 17289        MOVE '6'                     TO  DC-OPTION-CODE
 17290        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17291                              8099-DATE-CONVERT-X
 17292        MOVE DC-BIN-DATE-2           TO  CP-FIRST-PAY-DATE
 17293     END-IF.
 17294     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 17295     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 17296     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17297     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17298     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17299     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17300     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17301     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 17302     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 17303     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 17304                                        CP-LOAN-TERM.
 17305     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 17306                                        CP-RATING-BENEFIT-AMT.
 17307     MOVE WS-REM-AMT                 TO CP-REMAINING-BENEFIT
 17308     MOVE CR-APR                     TO CP-LOAN-APR.
 17309     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17310     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 17311     MOVE '6'                        TO CP-EARNING-METHOD.
 17312     MOVE '3'                        TO CP-PROCESS-TYPE.
 17313     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 17314     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17315         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 17316     ELSE
 17317         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17318     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 17319     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 17320     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 17321     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17322     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17323     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 17324
 17325     IF CP-STATE-STD-ABBRV = 'OR'
 17326        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 17327     END-IF
 17328
 17329     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 330
* ECS010.cbl
 17330        COMPUTE CP-ORIGINAL-BENEFIT =
 17331         (CR-LFAMT - CR-LFPRM)
 17332     END-IF
 17333
 17334     IF CP-TRUNCATED-LIFE
 17335        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 17336     END-IF
 17337
 17338     IF CP-TERM-IS-DAYS
 17339        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 17340     ELSE
 17341        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 17342     END-IF
 17343
 17344     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 17345
 17346     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 17347
 17348 4190-EP-DO-LF-COMM.
 17349
 17350     MOVE +0 TO SUB1.
 17351     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17352         10 TIMES.
 17353
 17354     IF REIN-EP-FLG NOT = 'R'  OR
 17355        CR-POLICY-IS-REIN-ONLY
 17356         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 17357         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 17358         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 17359         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 17360
 17361     ADD ISS-BEN TO EW-ISS-BEN.
 17362     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 17363     ADD CNC-BEN TO EW-CNC-BEN.
 17364     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 17365     ADD ISS-PRM TO EW-ISS-PRM.
 17366     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 17367     ADD CNC-PRM TO EW-CNC-PRM.
 17368     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 17369
 17370     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17371     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17372     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17373
 17374     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 17375        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 17376     END-IF
 17377     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 17378        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 17379     END-IF
 17380
 17381     COMPUTE ISS-PRMTAX =
 17382        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 17383        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 17384
 17385     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17386
 17387     IF LIFE-FULLY-EARNED
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 331
* ECS010.cbl
 17388         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17389                                            (ISS-PRM - EPR-R78)
 17390         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17391                                            (ISS-PRM - EPR-PRO)
 17392         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17393                                            (ISS-PRM - EPR-ST).
 17394
 17395     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17396         IF  REIN-EP-FLG NOT = 'R'
 17397                 OR
 17398             CR-POLICY-IS-REIN-ONLY
 17399             MOVE 'L'      TO W-CLAIM-TYPE
 17400             MOVE EPR-R78  TO W-OPT-R78
 17401             MOVE EPR-PRO  TO W-OPT-PRO
 17402             MOVE EPR-ST   TO W-OPT-ST
 17403             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17404             MOVE ZEROS    TO EW-CLM-IBNR
 17405         ELSE
 17406             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 17407                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 17408                 MOVE ZEROS      TO EW-CLM-IBNR
 17409             ELSE
 17410                 MOVE ZEROS      TO EW-CLM-IBNR
 17411     ELSE
 17412         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17413             ADD WE-DTH-IBNR
 17414                       TO EW-CLM-IBNR
 17415         ELSE
 17416             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 17417                     AND
 17418                 CR-DT GREATER THAN LAST-YRS-DATE
 17419                 COMPUTE  EW-CLM-IBNR
 17420                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 17421
 17422     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 17423     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 17424
 17425 4191-CONTINUE.
 17426
 17427     MOVE 'Y'          TO EW-LEVEL-USED.
 17428
 17429     IF CR-POLICY-UNDERWRITTEN
 17430         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17431         MOVE EPEC-OPT-WORK-TABLE
 17432                              TO EPEC-UNDW-OPT-DATA-TABLE
 17433     ELSE
 17434         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17435         MOVE EPEC-OPT-WORK-TABLE
 17436                              TO EPEC-OPT-DATA-TABLE.
 17437
 17438     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 332
* ECS010.cbl
 17440 4194-SLOT-INTO-EFFECTED-MONTHS.
 17441
 17442     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17443             AND
 17444         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17445             AND
 17446         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17447                 OR
 17448          CR-LF-CANC-DT EQUAL ZEROS)
 17449             AND
 17450         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 17451                 OR
 17452          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 17453         MOVE 'Y'                 TO W-TABLE-USED-SW
 17454         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17455             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17456                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17457                 + CR-LIVES
 17458         ELSE
 17459             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17460                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17461
 17462 4194-EXIT.
 17463     EXIT.
 17464
 17465 4196-CALC-REM-AMT.
 17466
 17467     IF CR-LFTYP = 'QD'
 17468        MOVE +15.0               TO CR-APR
 17469     END-IF
 17470
 17471     MOVE +0                     TO WS-REM-AMT
 17472     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 17473        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17474           COMPUTE WS-REM-AMT =
 17475             CR-LFAMT + CR-LFAMT-ALT
 17476        ELSE
 17477           MOVE CR-LFAMT         TO WS-REM-AMT
 17478        END-IF
 17479        GO TO 4199-EXIT
 17480     END-IF
 17481
 17482     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
 17483
 17484     IF REM-TRM1 = CR-LF-TERM
 17485        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17486           COMPUTE WS-REM-AMT =
 17487             CR-LFAMT + CR-LFAMT-ALT
 17488        ELSE
 17489           MOVE CR-LFAMT         TO WS-REM-AMT
 17490        END-IF
 17491        GO TO 4199-EXIT
 17492     END-IF
 17493
 17494     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17495        GO TO 4198-ORDINARY-REM
 17496     END-IF
 17497
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 333
* ECS010.cbl
 17498     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17499        GO TO 4198-CALC-TEXAS-REM
 17500     END-IF
 17501
 17502     IF CR-LFTYP = 'QD'
 17503        MOVE +15.0               TO CR-APR
 17504        MOVE 'N'                 TO
 17505                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17506        GO TO 4198-CALC-NET-PAY-REM
 17507     END-IF
 17508
 17509     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17510        GO TO 4198-CALC-NET-PAY-REM
 17511     END-IF
 17512
 17513     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17514        (CR-RATING-CLASS NOT = 'L ')
 17515         IF (CR-LF-TERM GREATER THAN +60) AND
 17516            (CR-DT GREATER THAN 19831031) AND
 17517            (CR-APR GREATER THAN ZERO)
 17518             GO TO 4198-CALC-NET-PAY-REM
 17519        END-IF
 17520     END-IF
 17521
 17522     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17523         IF (CR-LF-TERM GREATER THAN +61) AND
 17524            (CR-DT  GREATER THAN 19830318) AND
 17525            (CR-APR GREATER THAN ZERO)
 17526             GO TO 4198-CALC-NET-PAY-REM
 17527        END-IF
 17528     END-IF
 17529
 17530     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17531         IF (CR-LF-TERM GREATER THAN +62) AND
 17532            (CR-DT  GREATER THAN 19810831) AND
 17533            (CR-DT  LESS THAN 19830901) AND
 17534            (CR-APR GREATER THAN ZERO)
 17535             GO TO 4198-CALC-NET-PAY-REM
 17536        END-IF
 17537     END-IF
 17538
 17539     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17540         IF (CR-LF-TERM GREATER THAN +60) AND
 17541            (CR-DT  GREATER THAN 19831231) AND
 17542            (CR-APR GREATER THAN ZERO)
 17543             GO TO 4198-CALC-NET-PAY-REM
 17544        END-IF
 17545     END-IF
 17546
 17547     .
 17548 4198-ORDINARY-REM.
 17549
 17550     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17551         COMPUTE WS-REM-AMT ROUNDED =
 17552                  (INTERMED * REM-TRM2) + CR-LFAMT-ALT
 17553     ELSE
 17554         COMPUTE WS-REM-AMT ROUNDED = INTERMED * REM-TRM2
 17555     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 334
* ECS010.cbl
 17556
 17557     GO TO 4199-EXIT
 17558
 17559     .
 17560 4198-CALC-TEXAS-REM.
 17561
 17562     DIVIDE CR-LFAMT BY CR-LF-TERM
 17563         GIVING TEX-FACT-1.
 17564     DIVIDE REM-TRM2 BY CR-PMT-FREQ
 17565         GIVING TEX-FACT-2
 17566         REMAINDER TEX-FACT-3.
 17567
 17568     IF TEX-FACT-3 NOT = ZERO
 17569         ADD +1                  TO TEX-FACT-2
 17570     END-IF
 17571
 17572     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
 17573         MOVE CR-LFAMT           TO WS-REM-AMT
 17574     ELSE
 17575         COMPUTE WS-REM-AMT ROUNDED =
 17576             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
 17577     END-IF
 17578
 17579     GO TO 4199-EXIT
 17580
 17581     .
 17582 4198-CALC-NET-PAY-REM.
 17583
 17584     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17585     MOVE 'L'                        TO DC-OPTION-CODE.
 17586     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17587     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17588
 17589     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17590        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 17591        MOVE '3'                 TO  DC-OPTION-CODE
 17592        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17593                                  8099-DATE-CONVERT-X
 17594        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 17595     ELSE
 17596        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 17597        MOVE +1                  TO  DC-ELAPSED-MONTHS
 17598        MOVE +0                  TO  DC-ELAPSED-DAYS
 17599        MOVE '6'                 TO  DC-OPTION-CODE
 17600        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17601                                  8099-DATE-CONVERT-X
 17602        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 17603     END-IF
 17604
 17605     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17606        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
 17607     ELSE
 17608        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
 17609     END-IF
 17610     MOVE CR-APR                 TO  CP-LOAN-APR
 17611     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
 17612     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
 17613     MOVE REM-TRM2               TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 335
* ECS010.cbl
 17614     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17615                                 TO CP-SPECIAL-CALC-CD
 17616     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
 17617                                 TO  CP-BENEFIT-TYPE
 17618     MOVE CLAS-I-EP (CLAS-INDEXL)
 17619                                 TO  CP-EARNING-METHOD
 17620
 17621     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 17622     IF (DTE-CLIENT = 'DCC')
 17623        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17624        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 17625           ((CR-STATE = DD-STATE (D1))
 17626           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 17627           AND ('A'           = DD-BEN-TYPE   (D1))
 17628           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 17629           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 17630                           OR
 17631           D1 > max-pdef
 17632        END-PERFORM
 17633        IF D1 <= max-pdef
 17634           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17635              (P1 > +8)
 17636              OR (DD-PROD-CODE (D1 P1) = 'L')
 17637           END-PERFORM
 17638           IF P1 < +9
 17639              MOVE DD-MAX-BEN-AMT (D1 P1)
 17640                                 TO CP-R-MAX-TOT-BEN
 17641           END-IF
 17642        END-IF
 17643     END-IF
 17644
 17645     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 17646
 17647     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
 17648
 17649     .
 17650 4199-EXIT.
 17651     EXIT.
 17652
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 336
* ECS010.cbl
 17654******************************************************************
 17655***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 17656******************************************************************
 17657
 17658 4200-EP-DO-AH.
 17659
 17660     MOVE +0                         TO ISS-BEN  EPR-R78
 17661                                        CNC-BEN  EPR-PRO
 17662                                        ISS-PRM  EPR-ST
 17663                                        CNC-PRM
 17664                                        WX-CLM-AMT
 17665                                        WX-CLM-EXP
 17666                                        WX-CLM-CNT
 17667                                        WX-CLM-CRT
 17668                                        WX-ACTIVE-COUNT
 17669                                        ISS-PRMTAX
 17670                                        WX-CNC-CNT.
 17671     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 17672
 17673     IF CR-AHTYP = ZERO
 17674         GO TO 4295-EP-DO-COUNT.
 17675
 17676     IF REIN-EP-FLG = 'R'
 17677         IF REIN-AH-FLG (SUB5) = SPACE
 17678             GO TO 4295-EP-DO-COUNT.
 17679
 17680     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17681     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17682     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17683
 17684     IF CR-POLICY-IS-DECLINED  OR
 17685        CR-POLICY-IS-VOID
 17686         GO TO 4290-CONTINUE.
 17687
 17688     MOVE CR-AH-TERM           TO ORIG-TERM.
 17689
 17690     IF CR-DT GREATER EW-COV-DTE
 17691         MOVE CR-DT            TO EW-COV-DTE.
 17692
 17693     IF NOT CR-POLICY-IS-RESTORE  AND
 17694        NOT CR-POLICY-IS-REISSUE
 17695        AND NOT CR-POLICY-IS-MONTHLY
 17696         MOVE WE-AHAMT         TO ISS-BEN
 17697         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 17698         COMPUTE EW-AGE = EW-AGE + CR-AGE
 17699         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17700         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17701                                   (ORIG-TERM * ISS-BEN).
 17702
 17703     MOVE CLAS-INDEXA     TO W-NDX.
 17704     MOVE RUN-DATE        TO VALUATION-DT
 17705     MOVE '6'             TO W-VAL-SOURCE.
 17706
 17707     IF REIN-EP-FLG = 'R'
 17708         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 17709            EARNING-STOP-DATE LESS THAN VALUATION-DT
 17710             MOVE EARNING-STOP-DATE TO VALUATION-DT
 17711             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 337
* ECS010.cbl
 17712
 17713     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17714
 17715     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 17716        (REM-TRM3 GREATER ZERO)
 17717        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17718            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 17719                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 17720            COMPUTE EW-REM-TERM = EW-REM-TERM +
 17721                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 17722          ELSE
 17723            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 17724            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 17725
 17726     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17727         GO TO 4210-BY-OPT-LOGIC.
 17728
 17729     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 17730             AND
 17731         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 17732             AND
 17733         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 17734                 OR
 17735          CR-AH-CANC-DT EQUAL ZEROS)
 17736         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 17737         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 17738                 VARYING
 17739             SUBM FROM +1 BY +1
 17740                 UNTIL
 17741             SUBM GREATER THAN +13.
 17742
 17743     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 17744     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 17745
 17746 4210-BY-OPT-LOGIC.
 17747
 17748     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17749         ADD CR-LIVES TO EW-ISS-CNT
 17750         MOVE WE-AHPRM TO ISS-PRM
 17751         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 17752                                (ORIG-TERM * CR-LIVES)
 17753         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 17754         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17755         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17756                                   (ORIG-TERM * ISS-BEN)
 17757         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 17758         GO TO 4225-CONTINUE.
 17759
 17760     IF (NOT CR-POLICY-IS-RESTORE) AND
 17761        (NOT CR-POLICY-IS-REISSUE)
 17762        AND (NOT CR-POLICY-IS-MONTHLY)
 17763        ADD +1 TO EW-ISS-CNT.
 17764
 17765     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 17766
 17767     .
 17768 4225-CONTINUE.
 17769
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 338
* ECS010.cbl
 17770     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 17771         NEXT  SENTENCE
 17772       ELSE
 17773         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 17774
 17775     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 17776     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 17777     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 17778     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 17779     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 17780     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 17781
 17782     MOVE +0           TO SUB1.
 17783
 17784     IF DTE-CLIENT = 'DCC'
 17785        IF CR-AH-CANC-DT NOT = ZEROS
 17786           MOVE CR-AH-TERM       TO ORIG-TERM
 17787           MOVE CR-AH-CANC-DT    TO VALUATION-DT
 17788           MOVE AH-OVERRIDE-L1   TO WE-LF-AH
 17789           MOVE '1'              TO W-VAL-SOURCE
 17790           PERFORM 8500-REMAINING-TERM-ROUTINE
 17791                                 THRU 8599-REM-TERM-X
 17792           DISPLAY ' 4225 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 17793        END-IF
 17794     END-IF
 17795
 17796     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17797         10 TIMES.
 17798     MOVE +0                     TO SUB16
 17799     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 17800        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 17801
 17802     IF REIN-EP-FLG NOT = 'R'  OR
 17803        CR-POLICY-IS-REIN-ONLY
 17804         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 17805         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 17806         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 17807         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 17808
 17809     ADD ISS-BEN TO EW-ISS-BEN.
 17810     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 17811     ADD CNC-BEN TO EW-CNC-BEN.
 17812     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 17813     ADD ISS-PRM TO EW-ISS-PRM.
 17814     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 17815     ADD CNC-PRM TO EW-CNC-PRM.
 17816     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 17817
 17818     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17819     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17820     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17821
 17822     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 17823        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 17824     END-IF
 17825     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 17826        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 17827     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 339
* ECS010.cbl
 17828     COMPUTE ISS-PRMTAX =
 17829        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 17830        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 17831     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17832
 17833     IF A-H-FULLY-EARNED
 17834         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17835                                            (ISS-PRM - EPR-R78)
 17836         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17837                                            (ISS-PRM - EPR-PRO)
 17838         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17839                                            (ISS-PRM - EPR-ST).
 17840
 17841     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17842         IF  REIN-EP-FLG NOT = 'R'
 17843                 OR
 17844             CR-POLICY-IS-REIN-ONLY
 17845             MOVE 'A'      TO W-CLAIM-TYPE
 17846             MOVE EPR-R78  TO W-OPT-R78
 17847             MOVE EPR-PRO  TO W-OPT-PRO
 17848             MOVE EPR-ST   TO W-OPT-ST
 17849             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17850             MOVE ZEROS    TO EW-CLM-IBNR
 17851         ELSE
 17852             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 17853                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 17854                 MOVE ZEROS TO EW-CLM-IBNR
 17855             ELSE
 17856                 MOVE ZEROS TO EW-CLM-IBNR
 17857     ELSE
 17858         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17859             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 17860         ELSE
 17861             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 17862                 IF  CR-AH-POLICY-IS-ACTIVE
 17863                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 17864                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 17865                 ELSE
 17866                     NEXT SENTENCE
 17867             ELSE
 17868                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 17869                     COMPUTE  EW-CLM-IBNR
 17870                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 17871
 17872     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 17873     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 17874
 17875 4290-CONTINUE.
 17876*     DISPLAY ' 4290 '
 17877
 17878     MOVE 'Y'          TO EW-LEVEL-USED.
 17879
 17880     IF CR-POLICY-UNDERWRITTEN
 17881         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17882         MOVE EPEC-OPT-WORK-TABLE
 17883                              TO EPEC-UNDW-OPT-DATA-TABLE
 17884     ELSE
 17885         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 340
* ECS010.cbl
 17886         MOVE EPEC-OPT-WORK-TABLE
 17887                              TO EPEC-OPT-DATA-TABLE.
 17888
 17889
 17890 4295-EP-DO-COUNT.
 17891
 17892     IF REIN-EP-FLG = 'R'
 17893         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 17894     ELSE
 17895         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 17896
 17897     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 341
* ECS010.cbl
 17899 4296-SLOT-INTO-EFFECTED-MONTHS.
 17900
 17901     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17902             AND
 17903         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17904             AND
 17905         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17906                 OR
 17907          CR-AH-CANC-DT EQUAL ZEROS)
 17908         MOVE 'Y'                 TO W-TABLE-USED-SW
 17909         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17910             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17911                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17912                 + CR-LIVES
 17913         ELSE
 17914             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17915                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17916
 17917 4296-EXIT.
 17918     EXIT.
 17919
 17920 4299-EPBX.
 17921     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 342
* ECS010.cbl
 17923******************************************************************
 17924***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 17925******************************************************************
 17926
 17927 4300-EP-COMM-LOOP.
 17928
 17929     IF DTE-CLIENT = 'DMD'
 17930         GO TO 4350-EP-COMM-LOOP-X.
 17931
 17932     ADD +1                         TO SUB1.
 17933     MOVE ZEROS                     TO SUB16.
 17934
 17935     IF CR-ADDL-CLP NOT NUMERIC
 17936        MOVE ZEROS               TO CR-ADDL-CLP
 17937     END-IF
 17938     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17939         GO TO 4350-EP-COMM-LOOP-X.
 17940
 17941 4300-AGENT-LOOP.
 17942
 17943     ADD +1                         TO SUB16.
 17944
 17945     IF SUB16 GREATER THAN WS-LOOP-MAX
 17946         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17947         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 17948         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17949                                     TO WS-ABEND-MESSAGE
 17950         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17951         MOVE 4001                   TO WS-ABEND-CODE
 17952         GO TO ABEND-PGM.
 17953
 17954     IF EW-AGT-NO (SUB16) = SPACES
 17955         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 17956         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 17957     ELSE
 17958         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 17959            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 17960             NEXT SENTENCE
 17961         ELSE
 17962             GO TO 4300-AGENT-LOOP.
 17963
 17964     IF EW-LF-AH = AH-OVERRIDE-L1
 17965         GO TO 4350-EP-COMM-LOOP-A.
 17966
 17967     IF (DTE-CLIENT = 'DCC')
 17968        AND (REIN-EP-FLG = 'R')
 17969        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17970        AND (WE-LFPRM NOT = ZEROS)
 17971        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 17972           COMPUTE ISS-WK ROUNDED =
 17973              CR-LF-NSP-PRM * CR-LCOM-L (SUB1)
 17974        ELSE
 17975           COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 17976               (CR-LFAMT + CR-LFAMT-ALT)
 17977           COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 17978              * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 17979        END-IF
 17980     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 343
* ECS010.cbl
 17981        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 17982                             OR 'J' OR 'N'
 17983           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 17984        ELSE
 17985           IF CR-AGT-TYPE (SUB1) = 'A'
 17986              COMPUTE ISS-WK ROUNDED =
 17987                   CR-LF-CLP * CR-LCOM-L (SUB1)
 17988           ELSE
 17989              IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 17990                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
 17991                 COMPUTE ISS-WK ROUNDED =
 17992                      CR-LF-CLP * CR-LCOM-L (SUB1)
 17993              ELSE
 17994                 COMPUTE ISS-WK  ROUNDED = ISS-PRM
 17995                    * CR-LCOM-L (SUB1)
 17996              END-IF
 17997           END-IF
 17998        END-IF
 17999     END-IF
 18000
 18001     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18002
 18003     MOVE ZEROS                  TO CNC-WK
 18004                                    CNC-FACT
 18005     IF DTE-CLIENT EQUAL 'XXX'
 18006         IF NOT CR-NO-LF-CHARGEBACK
 18007            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 18008            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 18009                                + CNC-WK
 18010            GO TO 4300-CONTINUE-LOOP.
 18011
 18012     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18013        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18014
 18015      IF (DTE-CLIENT = 'DCC')
 18016         AND (REIN-EP-FLG = 'R')
 18017         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18018         AND (WE-LFRFND NOT = ZEROS)
 18019         IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18020            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18021            COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18022               CR-LCOM-L (SUB1)
 18023            IF CR-ACCOUNT = '05500500DD'
 18024               DISPLAY ' REIN P D ' CNC-FACT ' ' CNC-WK
 18025            END-IF
 18026         ELSE
 18027            COMPUTE WS-CEDE-FACT = RWF-LFAMT / CR-LFAMT
 18028            COMPUTE CNC-WK ROUNDED = (CR-LFRFND * WS-CEDE-FACT)
 18029               * CR-LCOM-L (SUB1)
 18030         END-IF
 18031      ELSE
 18032        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18033                              OR 'L' OR 'J' OR 'K')
 18034           AND (CNC-PRM > +0)
 18035           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18036           IF CR-CANCEL-REASON = 'R'
 18037              MOVE 1             TO CNC-FACT
 18038           END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 344
* ECS010.cbl
 18039           COMPUTE CNC-WK = CNC-FACT *
 18040              (CR-LCOM-L (SUB1) * +1000)
 18041*       ELSE
 18042*        IF (CR-AGT-TYPE (SUB1) = 'N')
 18043*          AND (CNC-PRM > +0)
 18044*          PERFORM 4380-REF-CSO-ADMIN-FEE
 18045*                                THRU 4380-EXIT
 18046*          COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18047*          COMPUTE CNC-WK = CNC-FACT *
 18048*             ((CR-LCOM-L (SUB1) * +1000) - 30)
 18049*       ELSE
 18050*          IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 18051*              AND (CR-AHTYP NOT = '00' AND '  ')
 18052*             AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 18053*             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18054*             COMPUTE CNC-WK = CNC-FACT *
 18055*                (CR-AHPRM - (CR-LFPRM-ALT
 18056*                + CR-ADDL-CLP))
 18057         ELSE
 18058            IF (CR-AGT-TYPE (SUB1) = 'A')
 18059                      OR
 18060              ((CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18061                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'))
 18062              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18063              COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18064                CR-LCOM-L (SUB1)
 18065            ELSE
 18066               COMPUTE CNC-WK  ROUNDED =
 18067                 CNC-PRM * CR-LCOM-L (SUB1)
 18068            END-IF
 18069         END-IF
 18070*       END-IF
 18071      END-IF
 18072        COMPUTE EW-CNC-COM (SUB16) =
 18073                                  EW-CNC-COM (SUB16) + CNC-WK
 18074     END-IF
 18075
 18076     if (ws-dcc-cnc-flag = 'Y')
 18077        and (rein-ep-flg not = 'R')
 18078        move cnc-wk              to dx-l-pc (sub1)
 18079     end-if
 18080
 18081     .
 18082 4300-CONTINUE-LOOP.
 18083
 18084*     DISPLAY ' 4300 CONTINUE '
 18085     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18086               OR
 18087        ((ISS-WK - CNC-WK) = ZEROS)
 18088        MOVE ZEROS              TO COMM-WK
 18089     ELSE
 18090        COMPUTE EC-FACT ROUNDED =
 18091           EPR-R78 / (ISS-PRM - CNC-PRM)
 18092        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18093     END-IF
 18094
 18095     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18096
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 345
* ECS010.cbl
 18097     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18098               OR
 18099        ((ISS-WK - CNC-WK) = ZEROS)
 18100        MOVE ZEROS              TO COMM-WK
 18101     ELSE
 18102        COMPUTE EC-FACT ROUNDED =
 18103           EPR-PRO / (ISS-PRM - CNC-PRM)
 18104        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18105     END-IF
 18106     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18107
 18108     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18109               OR
 18110        ((ISS-WK - CNC-WK) = ZEROS)
 18111        MOVE ZEROS              TO COMM-WK
 18112     ELSE
 18113        COMPUTE EC-FACT ROUNDED =
 18114           EPR-ST / (ISS-PRM - CNC-PRM)
 18115        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18116     END-IF
 18117
 18118     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18119
 18120     IF LIFE-FULLY-EARNED
 18121         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18122                                                CR-LCOM-L (SUB1)
 18123         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18124                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18125         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18126                                                CR-LCOM-L (SUB1)
 18127         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18128                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18129
 18130     GO TO 4350-EP-COMM-LOOP-X.
 18131
 18132 4350-EP-COMM-LOOP-A.
 18133
 18134     IF (DTE-CLIENT = 'DCC')
 18135        AND (REIN-EP-FLG = 'R')
 18136        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18137        AND (WE-AHPRM NOT = ZEROS)
 18138
 18139        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 18140           COMPUTE ISS-WK ROUNDED =
 18141              CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18142        ELSE
 18143           COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18144           COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 18145              * CR-LCOM-AH (SUB1)
 18146        END-IF
 18147     ELSE
 18148        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18149                                    OR 'J' OR 'N'
 18150           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 18151        ELSE
 18152           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 18153             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 18154              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 346
* ECS010.cbl
 18155              + CR-ADDL-CLP)
 18156           ELSE
 18157              IF (CR-AGT-TYPE (SUB1) = 'M')
 18158                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18159                              = 'G' OR 'L')
 18160                 COMPUTE ISS-WK ROUNDED =
 18161                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
 18162              ELSE
 18163                 IF CR-AGT-TYPE (SUB1) = 'A'
 18164                    COMPUTE ISS-WK ROUNDED =
 18165                      CR-AH-CLP * CR-LCOM-AH (SUB1)
 18166                 ELSE
 18167                    IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18168                       AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) =
 18169                                     'D')
 18170                       COMPUTE ISS-WK ROUNDED =
 18171                         CR-AH-CLP * CR-LCOM-AH (SUB1)
 18172                    ELSE
 18173                       COMPUTE ISS-WK  ROUNDED =
 18174                         ISS-PRM * CR-LCOM-AH (SUB1)
 18175                    END-IF
 18176                 END-IF
 18177              END-IF
 18178           END-IF
 18179        END-IF
 18180     END-IF
 18181
 18182     COMPUTE EW-ISS-COM (SUB16) =
 18183             EW-ISS-COM (SUB16) + ISS-WK.
 18184
 18185     MOVE ZEROS                  TO CNC-WK
 18186     IF DTE-CLIENT EQUAL 'XXX'
 18187         IF NOT CR-NO-LF-CHARGEBACK
 18188           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 18189           COMPUTE EW-CNC-COM (SUB16) =
 18190                   EW-CNC-COM (SUB16) + CNC-WK
 18191           GO TO 4300-CONTINUE-LOOP-AH.
 18192
 18193     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18194        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18195        EVALUATE TRUE
 18196           WHEN DTE-CLIENT = 'DCC'
 18197             AND (REIN-EP-FLG = 'R')
 18198             AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18199             AND (WE-AHRFND NOT = ZEROS)
 18200             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18201                COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18202                COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18203                           CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18204             ELSE
 18205                COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18206                COMPUTE CNC-WK ROUNDED = (CR-AHRFND
 18207                * WS-CEDE-FACT) * CR-LCOM-AH (SUB1)
 18208             END-IF
 18209           WHEN (CR-AGT-TYPE (SUB1) = 'C')
 18210             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18211             AND (CNC-PRM > +0)
 18212             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 347
* ECS010.cbl
 18213           WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18214             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18215             AND (CNC-PRM > +0)
 18216             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18217           WHEN (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18218                              OR 'L' OR 'J' OR 'K')
 18219             AND (CNC-PRM > +0)
 18220             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18221             IF CR-CANCEL-REASON = 'R'
 18222                MOVE 1             TO CNC-FACT
 18223             END-IF
 18224             COMPUTE CNC-WK = CNC-FACT *
 18225                (CR-LCOM-AH (SUB1) * +1000)
 18226
 18227           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18228             AND (CNC-PRM > +0)
 18229             AND (CNC-PRM = ISS-PRM)
 18230             COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000)
 18231
 18232           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18233             AND (CNC-PRM > +0)
 18234             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18235           WHEN (CR-AGT-TYPE (SUB1) = 'M')
 18236              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18237                              = 'G' OR 'L')
 18238              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18239              COMPUTE CNC-WK = CNC-FACT *
 18240                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18241           WHEN CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18242              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18243              IF (CR-CANCEL-REASON = 'R')
 18244                 AND (CNC-PRM > +0)
 18245                 MOVE +1      TO CNC-FACT
 18246              END-IF
 18247              COMPUTE CNC-WK = CNC-FACT *
 18248              (CR-AHPRM - (CR-LFPRM-ALT
 18249                 + CR-ADDL-CLP))
 18250           WHEN (CR-AGT-TYPE (SUB1) = 'A')
 18251                      OR
 18252              ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18253               AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18254               COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18255               COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18256                  CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18257            WHEN OTHER COMPUTE CNC-WK  ROUNDED =
 18258                      CNC-PRM * CR-LCOM-AH (SUB1)
 18259        END-EVALUATE
 18260        COMPUTE EW-CNC-COM (SUB16) =
 18261           EW-CNC-COM (SUB16) + CNC-WK
 18262     END-IF
 18263
 18264     if (ws-dcc-cnc-flag = 'Y')
 18265        and (rein-ep-flg not = 'R')
 18266        move cnc-wk              to dx-a-pc (sub1)
 18267     end-if
 18268
 18269*      IF (DTE-CLIENT = 'DCC')
 18270*         AND (REIN-EP-FLG = 'R')
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 348
* ECS010.cbl
 18271*         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18272*         AND (WE-AHRFND NOT = ZEROS)
 18273*         IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18274*            COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18275*            COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18276*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18277*         ELSE
 18278*            COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18279*            COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 18280*            * CR-LCOM-AH (SUB1)
 18281*         END-IF
 18282*      ELSE
 18283*        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18284*                              OR 'L' OR 'J' OR 'K')
 18285*           AND (CNC-PRM > +0)
 18286*           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18287*           IF CR-CANCEL-REASON = 'R'
 18288*              MOVE 1             TO CNC-FACT
 18289*           END-IF
 18290*           COMPUTE CNC-WK = CNC-FACT *
 18291*              (CR-LCOM-AH (SUB1) * +1000)
 18292*        ELSE
 18293*          IF CR-AGT-TYPE (SUB1) = 'N'
 18294*             PERFORM 4380-REF-CSO-ADMIN-FEE
 18295*                                 THRU 4380-EXIT
 18296**            MOVE CNC-WK         TO DE-A-PC (SUB1)
 18297**            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18298**            IF CNC-PRM NOT = ISS-PRM
 18299**               COMPUTE CNC-WK = CNC-FACT *
 18300**               ((CR-LCOM-AH (SUB1) * +1000) - 30)
 18301**            ELSE
 18302**               COMPUTE CNC-WK = CNC-FACT *
 18303**               (CR-LCOM-AH (SUB1) * +1000)
 18304**            END-IF
 18305*          ELSE
 18306*           IF (CR-AGT-TYPE (SUB1) = 'M')
 18307*              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18308*                              = 'G' OR 'L')
 18309*              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18310*              COMPUTE CNC-WK = CNC-FACT *
 18311*                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18312*           ELSE
 18313*              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18314*                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18315*                 IF CR-CANCEL-REASON = 'R'
 18316*                    MOVE +1      TO CNC-FACT
 18317*                 END-IF
 18318*                 COMPUTE CNC-WK = CNC-FACT *
 18319*                 (CR-AHPRM - (CR-LFPRM-ALT
 18320*                    + CR-ADDL-CLP))
 18321*              ELSE
 18322*                 IF (CR-AGT-TYPE (SUB1) = 'A')
 18323*                           OR
 18324*                    ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18325*                    AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18326*                    COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18327*                    COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18328*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 349
* ECS010.cbl
 18329*                 ELSE
 18330*                    COMPUTE CNC-WK  ROUNDED =
 18331*                      CNC-PRM * CR-LCOM-AH (SUB1)
 18332*                 END-IF
 18333*              END-IF
 18334*           END-IF
 18335*          END-IF
 18336*        END-IF
 18337**       END-IF
 18338*      END-IF
 18339*        COMPUTE EW-CNC-COM (SUB16) =
 18340*           EW-CNC-COM (SUB16) + CNC-WK
 18341*     END-IF
 18342
 18343     .
 18344 4300-CONTINUE-LOOP-AH.
 18345
 18346     IF (AM-DCC-PRODUCT-CODE = 'DDF')
 18347        AND (WS-DDF-AH-CB (SUB1) = 'Y')
 18348        AND (AM-COMM-CHARGEBACK (SUB1) NUMERIC)
 18349        AND (AM-COMM-CHARGEBACK (SUB1) NOT = 0)
 18350        IF (ORIG-TERM - REM-TRM1) > AM-COMM-CHARGEBACK (SUB1)
 18351           MOVE 'N'              TO WS-DDF-AH-CB (SUB1)
 18352        END-IF
 18353     END-IF
 18354
 18355*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 18356     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18357                OR
 18358        ((ISS-WK - CNC-WK) = ZEROS)
 18359        MOVE ZEROS          TO COMM-WK
 18360     ELSE
 18361        COMPUTE EC-FACT ROUNDED =
 18362           EPR-R78 / (ISS-PRM - CNC-PRM)
 18363        IF WS-DDF-AH-CB (SUB1) = 'N'
 18364           MOVE ISS-WK           TO COMM-WK
 18365        ELSE
 18366           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18367        END-IF
 18368     END-IF
 18369
 18370     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18371
 18372     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18373                OR
 18374        ((ISS-WK - CNC-WK) = ZEROS)
 18375        MOVE ZEROS          TO COMM-WK
 18376     ELSE
 18377        COMPUTE EC-FACT ROUNDED =
 18378           EPR-PRO / (ISS-PRM - CNC-PRM)
 18379        IF WS-DDF-AH-CB (SUB1) = 'N'
 18380           MOVE ISS-WK           TO COMM-WK
 18381        ELSE
 18382           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18383        END-IF
 18384     END-IF
 18385
 18386     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 350
* ECS010.cbl
 18387
 18388     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18389                OR
 18390        ((ISS-WK - CNC-WK) = ZEROS)
 18391        MOVE ZEROS          TO COMM-WK
 18392     ELSE
 18393        EVALUATE TRUE
 18394           WHEN (CR-AGT-TYPE (SUB1) = 'I' OR 'C')
 18395              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18396                 PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18397                 COMPUTE COMM-WK = ISS-WK - CNC-WK
 18398           WHEN CR-AGT-TYPE (SUB1) = 'N'
 18399             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18400              COMPUTE COMM-WK = ISS-WK - CNC-WK
 18401           WHEN (AM-DCC-PRODUCT-CODE = 'DDF')
 18402              AND (WS-DDF-AH-CB  (SUB1) = 'N')
 18403              MOVE ISS-WK TO COMM-WK
 18404           WHEN OTHER
 18405              COMPUTE EC-FACT ROUNDED =
 18406                EPR-ST / (ISS-PRM - CNC-PRM)
 18407              COMPUTE COMM-WK ROUNDED = EC-FACT
 18408                 * (ISS-WK - CNC-WK)
 18409        END-EVALUATE
 18410     END-IF
 18411
 18412     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18413
 18414     IF A-H-FULLY-EARNED
 18415         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18416                                                CR-LCOM-AH (SUB1)
 18417         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18418                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18419         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18420                                                CR-LCOM-AH (SUB1)
 18421         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18422                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18423
 18424 4350-EP-COMM-LOOP-X.
 18425     EXIT.
 18426
 18427******************************************************************
 18428***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 18429******************************************************************
 18430
 18431 4375-EP-BANK-COMM.
 18432*     DISPLAY ' 4375 '
 18433
 18434     IF CS-AGT (SUB1) = SPACES OR ZEROS
 18435        GO TO 4375-EXIT
 18436     END-IF
 18437     .
 18438 4375-BANK-LOOP.
 18439
 18440     ADD +1                      TO SUB16
 18441
 18442     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 18443        GO TO 4375-EXIT
 18444     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 351
* ECS010.cbl
 18445
 18446     IF SUB16 GREATER THAN WS-LOOP-MAX
 18447         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 18448         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18449         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18450                                     TO WS-ABEND-MESSAGE
 18451         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18452         MOVE 4001                   TO WS-ABEND-CODE
 18453         PERFORM ABEND-PGM
 18454     END-IF
 18455
 18456     IF EW-AGT-NO (SUB16) = SPACES
 18457        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 18458        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 18459     ELSE
 18460        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 18461           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 18462           CONTINUE
 18463        ELSE
 18464           GO TO 4375-BANK-LOOP
 18465        END-IF
 18466     END-IF
 18467
 18468     IF CS-COM-TYP  (SUB1) = 'B'
 18469        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 18470     END-IF
 18471
 18472     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18473
 18474     MOVE ZEROS                  TO CNC-WK
 18475                                    CNC-FACT
 18476
 18477     IF (CS-COM-TYP (SUB1) = 'B')
 18478        AND (CNC-PRM > +0)
 18479        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18480        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 18481     END-IF
 18482
 18483     COMPUTE EW-CNC-COM (SUB16) =
 18484                  EW-CNC-COM (SUB16) + CNC-WK
 18485
 18486     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18487                OR
 18488        ((ISS-WK - CNC-WK) = ZEROS)
 18489        MOVE ZEROS          TO COMM-WK
 18490     ELSE
 18491        COMPUTE EC-FACT ROUNDED =
 18492           EPR-R78 / (ISS-PRM - CNC-PRM)
 18493        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18494     END-IF
 18495
 18496     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18497
 18498     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18499                OR
 18500        ((ISS-WK - CNC-WK) = ZEROS)
 18501        MOVE ZEROS          TO COMM-WK
 18502     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 352
* ECS010.cbl
 18503        COMPUTE EC-FACT ROUNDED =
 18504           EPR-PRO / (ISS-PRM - CNC-PRM)
 18505        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18506     END-IF
 18507
 18508     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18509
 18510     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18511                OR
 18512        ((ISS-WK - CNC-WK) = ZEROS)
 18513        MOVE ZEROS          TO COMM-WK
 18514     ELSE
 18515        COMPUTE EC-FACT ROUNDED =
 18516           EPR-ST / (ISS-PRM - CNC-PRM)
 18517        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18518     END-IF
 18519
 18520     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18521
 18522     IF A-H-FULLY-EARNED
 18523        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 18524        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18525                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18526        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18527                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 18528     END-IF
 18529
 18530     .
 18531 4375-EXIT.
 18532     EXIT.
 18533
 18534
 18535 4376-DCC-DDF-SPEC.
 18536
 18537     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18538                                 THRU 4910-EXIT
 18539
 18540     display ' acct - cert ' cr-account ' ' cr-cert-no
 18541     display ' orig term rem term ' orig-term ' ' rem-trm1
 18542     display ' agt type ' cr-agt-type (sub1)
 18543     COMPUTE CP-MONTH =
 18544        FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18545     IF CP-MONTH = 0
 18546        MOVE 12 TO CP-MONTH
 18547     END-IF
 18548
 18549     EVALUATE TRUE
 18550        WHEN CR-AGT-TYPE (SUB1) = 'N'
 18551           PERFORM 4380-REF-CSO-ADMIN-FEE
 18552                                 THRU 4380-EXIT
 18553        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18554           AND (CR-CANCEL-REASON = 'R')
 18555              COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 18556        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18557           EVALUATE TRUE
 18558              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18559                 OR (NOT DD-IU-PRESENT)
 18560                 if ueclp-clp-fact = zeros
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 353
* ECS010.cbl
 18561                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18562                       / CR-AH-CLP
 18563                 end-if
 18564                 COMPUTE CNC-WK = UECLP-CLP-FACT *
 18565                    (CR-LCOM-AH (SUB1) * +1000)
 18566               WHEN ((ORIG-TERM - REM-TRM1) < 13)
 18567                  AND (DD-IU-PRESENT)
 18568                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18569                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18570                     WS-LO-UEF) * 3/12
 18571                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18572                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18573                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18574                    (CR-LCOM-AH (SUB1) * +1000)
 18575                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
 18576                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18577                    (CR-LCOM-AH (SUB1) * +1000) * WS-HI-UEF)
 18578                     * (CP-MONTH - 3) / 9
 18579              WHEN (ORIG-TERM - REM-TRM1) > 12
 18580                 COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000) *
 18581                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
 18582                    CP-MONTH / 12)
 18583           END-EVALUATE
 18584        WHEN CR-AGT-TYPE (SUB1) = 'C'
 18585           EVALUATE TRUE
 18586              WHEN CR-CANCEL-REASON = 'R'
 18587                 COMPUTE CNC-WK =  (CR-AHPRM - (CR-AH-CLP
 18588                    + CR-ADDL-CLP))
 18589              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18590                 OR (NOT DD-IU-PRESENT)
 18591                   if ueclp-clp-fact = zeros
 18592                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18593                       / CR-AH-CLP
 18594                   end-if
 18595                    COMPUTE CNC-WK = UECLP-CLP-FACT *
 18596                       (CR-AHPRM - (CR-AH-CLP
 18597                       + CR-ADDL-CLP))
 18598              WHEN (ORIG-TERM - REM-TRM1) < 13
 18599                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18600                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18601                     WS-LO-UEF) * 3/12
 18602                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18603                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18604                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18605                       (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 18606                  DISPLAY ' UECOMMO3 ' WS-COMM-MO3
 18607                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18608                    (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) *
 18609                    WS-HI-UEF) * (CP-MONTH - 3) / 9
 18610              WHEN (ORIG-TERM - REM-TRM1) > 12
 18611                 COMPUTE CNC-WK = (CR-AHPRM - CR-AH-CLP -
 18612                    CR-ADDL-CLP) * (WS-HI-UEF - (WS-HI-UEF -
 18613                    WS-LO-UEF) * CP-MONTH / 12)
 18614           END-EVALUATE
 18615     END-EVALUATE
 18616
 18617     .
 18618 4376-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 354
* ECS010.cbl
 18619     EXIT.
 18620
 18621
 18622
 18623 4380-REF-CSO-ADMIN-FEE.
 18624
 18625*    IF CR-AH-CANC-DT NOT = ZEROS
 18626*       DISPLAY ' DDF 4380 REMTRM1 B4 ' CR-CERT-NO ' ' REM-TRM1
 18627*       MOVE CR-AH-TERM          TO ORIG-TERM
 18628*       MOVE CR-AH-CANC-DT       TO VALUATION-DT
 18629*       MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 18630*       MOVE '1'                 TO W-VAL-SOURCE
 18631*       PERFORM 8500-REMAINING-TERM-ROUTINE
 18632*                                THRU 8599-REM-TERM-X
 18633*       DISPLAY ' DDF 4380 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 18634*    END-IF
 18635
 18636     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18637                                 THRU 4910-EXIT
 18638
 18639     DISPLAY ' MADE IT TO 4380 ' CR-CERT-NO ' ' CR-AH-TERM ' '
 18640        REM-TRM1 ' ' ISS-WK ' ' WS-HI-UEF ' ' WS-LO-UEF
 18641
 18642     MOVE ZEROS                  TO CNC-WK
 18643
 18644     EVALUATE TRUE
 18645        WHEN (REM-TRM1 = 0)
 18646           OR (CR-CANCEL-REASON = 'R')
 18647           DISPLAY ' REM TERM = 0 OR REPO'
 18648           MOVE 0                TO CNC-WK
 18649
 18650        WHEN REM-TRM1 = ORIG-TERM
 18651           DISPLAY ' REM TERM  = ORIG TERM '
 18652           MOVE ISS-WK           TO CNC-WK
 18653
 18654        WHEN (ORIG-TERM - REM-TRM1) < 4
 18655           DISPLAY ' ORIG TERM - REM TRM < 4 '
 18656           COMPUTE CP-MONTH =
 18657              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18658           IF CP-MONTH = 0
 18659              MOVE 12 TO CP-MONTH
 18660           END-IF
 18661           DISPLAY ' CP MONTH ' CP-MONTH
 18662           COMPUTE W-FACTOR ROUNDED = ISS-WK -
 18663              (DD-1ST-YR-ALLOW (D1)
 18664              * CP-MONTH / 3) - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18665              * (1 - WS-HI-UEF) * CP-MONTH / 12
 18666           COMPUTE CNC-WK = W-FACTOR * 1
 18667
 18668**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
 18669
 18670        WHEN (ORIG-TERM - REM-TRM1) < 13
 18671           DISPLAY ' ORIG TERM - REM TRM < 13 '
 18672           COMPUTE CP-MONTH =
 18673              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18674           IF CP-MONTH = 0
 18675              MOVE 12 TO CP-MONTH
 18676           END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 355
* ECS010.cbl
 18677           DISPLAY ' CP MONTH ' CP-MONTH
 18678           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18679              DD-1ST-YR-ALLOW (D1))
 18680              - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18681              * (1 - WS-hi-UEF) * CP-MONTH / 12
 18682           COMPUTE CNC-WK = W-FACTOR * 1
 18683
 18684****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
 18685
 18686        WHEN OTHER
 18687           DISPLAY ' OTHER '
 18688           COMPUTE CP-MONTH =
 18689              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18690           IF CP-MONTH = 0
 18691              MOVE 12 TO CP-MONTH
 18692           END-IF
 18693           DISPLAY ' CP MONTH ' CP-MONTH
 18694           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18695              DD-1ST-YR-ALLOW (D1))
 18696              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
 18697              * CP-MONTH / 12)
 18698           COMPUTE CNC-WK = W-FACTOR * 1
 18699     END-EVALUATE
 18700
 18701     DISPLAY ' UE ADMIN FEE ' CR-ACCOUNT ' ' CR-CERT-NO
 18702        ' ' CNC-WK
 18703
 18704     .
 18705 4380-EXIT.
 18706     EXIT.
 18707
 18708******************************************************************
 18709******************************************************************
 18710******************************************************************
 18711******************************************************************
 18712******************************************************************
 18713******************************************************************
 18714******************************************************************
 18715******************************************************************
 18716******************************************************************
 18717******************************************************************
 18718***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 18719******************************************************************
 18720
 18721 S-4100-EP-DO-LF.
 18722
 18723     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 18724                                        EPR-PRO
 18725                                        EPR-ST.
 18726
 18727     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 18728     MOVE 'L'                    TO DC-OPTION-CODE.
 18729     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18730
 18731     MOVE +0                     TO DC-ELAPSED-MONTHS.
 18732     MOVE -1                     TO DC-ELAPSED-DAYS.
 18733     MOVE '6'                    TO DC-OPTION-CODE.
 18734     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 356
* ECS010.cbl
 18735
 18736     MOVE +0                     TO DC-ELAPSED-MONTHS
 18737                                    DC-ELAPSED-DAYS.
 18738
 18739     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 18740     MOVE ' '                    TO DC-OPTION-CODE.
 18741     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18742
 18743     IF NO-CONVERSION-ERROR
 18744        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 18745     ELSE
 18746         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 18747                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 18748                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 18749         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 18750                                     TO WS-ABEND-MESSAGE
 18751         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18752         MOVE 4001                   TO WS-ABEND-CODE
 18753         GO TO ABEND-PGM.
 18754
 18755     IF CR-LFTYP = ZERO
 18756         GO TO S-4200-EP-DO-AH.
 18757
 18758     IF REIN-LF-FLG (SUB5) = SPACE
 18759         GO TO S-4200-EP-DO-AH.
 18760
 18761     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 18762     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 18763     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 18764
 18765     MOVE CR-LF-TERM             TO ORIG-TERM.
 18766     MOVE CLAS-INDEXL            TO W-NDX.
 18767
 18768 S-4120-EP-DO-LF-CNCL.
 18769
 18770     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 18771        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 18772         GO TO S-4130-EP-DO-LF-EP.
 18773
 18774     COMPUTE EARNED-BY-CANCEL =
 18775                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 18776
 18777 S-4130-EP-DO-LF-EP.
 18778
 18779     MOVE SPACE                  TO STATUTORY-SWITCH.
 18780
 18781     MOVE EARNING-START-DATE     TO VALUATION-DT.
 18782     MOVE '9'                    TO W-VAL-SOURCE.
 18783     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18784
 18785     IF REM-TRM2 GREATER CR-LF-TERM
 18786         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18787         GO TO S-4190-EP-DO-LF-COMM.
 18788
 18789     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 18790         GO TO S-4180-EP-DO-LF-EP-SUM.
 18791
 18792     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 357
* ECS010.cbl
 18793         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18794             IF REM-TRM2 NOT GREATER THAN +0
 18795                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18796                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18797                 GO TO S-4190-EP-DO-LF-COMM
 18798             ELSE
 18799                 NEXT SENTENCE
 18800         ELSE
 18801             IF W-BAL-REMTRM NOT GREATER +0
 18802                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18803                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18804                 GO TO S-4190-EP-DO-LF-COMM
 18805             ELSE
 18806                 NEXT SENTENCE
 18807     ELSE
 18808        IF (DTE-CLIENT EQUAL 'NCL') AND
 18809           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 18810             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18811        ELSE
 18812         IF REM-TRM2 NOT GREATER +0  OR
 18813            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 18814             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18815             GO TO S-4190-EP-DO-LF-COMM.
 18816
 18817     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 18818         GO TO S-4140-EP-DO-LF-EP-TEX.
 18819
 18820     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 18821         GO TO S-4150-EP-DO-LF-EP-NP.
 18822
 18823*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 18824     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 18825        (CR-RATING-CLASS NOT = 'L ')
 18826         IF (CR-APR GREATER THAN ZERO)  AND
 18827            (CR-LF-TERM GREATER THAN 060)  AND
 18828            (CR-DT GREATER THAN 19831031)
 18829             MOVE '*'             TO STATUTORY-SWITCH
 18830              GO TO S-4150-EP-DO-LF-EP-NP.
 18831
 18832     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 18833         IF (CR-APR GREATER THAN ZERO)  AND
 18834            (CR-LF-TERM GREATER THAN 061)  AND
 18835            (CR-DT GREATER THAN 19830318)
 18836             MOVE '*'             TO STATUTORY-SWITCH
 18837              GO TO S-4150-EP-DO-LF-EP-NP.
 18838
 18839     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 18840         IF (CR-APR GREATER THAN ZERO)  AND
 18841            (CR-LF-TERM GREATER THAN 062)  AND
 18842            (CR-DT GREATER THAN 19810831)  AND
 18843            (CR-DT LESS THAN 19830901)
 18844             MOVE '*'             TO STATUTORY-SWITCH
 18845              GO TO S-4150-EP-DO-LF-EP-NP.
 18846
 18847     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 18848         IF (CR-APR GREATER THAN ZERO)  AND
 18849            (CR-LF-TERM GREATER THAN 060)  AND
 18850            (CR-DT GREATER THAN 19831231)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 358
* ECS010.cbl
 18851             MOVE '*'             TO STATUTORY-SWITCH
 18852              GO TO S-4150-EP-DO-LF-EP-NP.
 18853
 18854     GO TO S-4160-EP-DO-LF-EP-R78.
 18855
 18856 S-4140-EP-DO-LF-EP-TEX.
 18857
 18858     COMPUTE TEX-FACT-4 =
 18859         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 18860     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 18861         GIVING TEX-FACT-5
 18862             REMAINDER TEX-FACT-6.
 18863     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 18864     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 18865         (TEX-FACT-5 * CR-PMT-FREQ) +
 18866         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 18867     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 18868
 18869     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 18870
 18871     GO TO S-4170-EP-DO-LF-EP-PRO.
 18872
 18873 S-4150-EP-DO-LF-EP-NP.
 18874
 18875     IF WE-LFPRM = ZERO
 18876         GO TO S-4160-EP-DO-LF-EP-R78.
 18877
 18878     IF DTE-CLIENT = 'CRI'
 18879       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 18880             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 18881           GO TO S-4160-EP-DO-LF-EP-R78.
 18882
 18883     IF DTE-CLIENT = 'NCL'
 18884       IF CR-DT LESS THAN 19910101
 18885           GO TO S-4160-EP-DO-LF-EP-R78.
 18886
 18887     IF REM-TRM1 = CR-LF-TERM
 18888         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18889         GO TO S-4190-EP-DO-LF-COMM.
 18890
 18891     MOVE CR-APR TO NP-APR.
 18892     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 18893     MOVE REM-TRM1 TO NP-REM.
 18894     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 18895     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18896         MOVE CR-LOAN-TERM TO NP-ORIG.
 18897     MOVE 'R' TO NP-OPT.
 18898     CALL 'ECSNETRM'
 18899         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 18900
 18901     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 18902
 18903     IF STATUTORY-REQUIREMENT
 18904         MOVE EPR-R78                TO EPR-ST.
 18905
 18906 S-4160-EP-DO-LF-EP-R78.
 18907
 18908     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 359
* ECS010.cbl
 18909        (DTE-CLIENT EQUAL 'NCL')
 18910        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18911           (CR-MO EQUAL EOM-MO)
 18912           MOVE '*'            TO OB-DATE-1-SWITCH
 18913           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18914           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18915           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18916           COMPUTE WS-EPR-R78 (SUB3 1) =
 18917                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 18918           GO TO S-4190-EP-DO-LF-COMM
 18919        ELSE
 18920        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 18921           (CR-MO EQUAL OB-MO (1))
 18922           MOVE '*'            TO OB-DATE-2-SWITCH
 18923           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18924           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18925           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18926           COMPUTE WS-EPR-R78 (SUB3 2) =
 18927                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 18928           GO TO S-4190-EP-DO-LF-COMM
 18929        ELSE
 18930        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 18931           (CR-MO EQUAL OB-MO (2))
 18932           MOVE '*'            TO OB-DATE-3-SWITCH
 18933           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18934           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18935           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18936           COMPUTE WS-EPR-R78 (SUB3 3) =
 18937                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 18938           GO TO S-4190-EP-DO-LF-COMM
 18939        ELSE
 18940           GO TO S-4190-EP-DO-LF-COMM.
 18941
 18942     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 18943
 18944     IF DTE-R78 = '1'
 18945         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 18946     ELSE
 18947         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 18948
 18949     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 18950
 18951     IF REM-TRM1 GREATER THAN +0
 18952         COMPUTE TEMP-7 ROUNDED EQUAL
 18953             WE-LFPRM - (WE-LFPRM * TEMP-4)
 18954     ELSE
 18955         MOVE WE-LFPRM                TO TEMP-7.
 18956
 18957     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 18958         MOVE TEMP-7                 TO EPR-ST.
 18959
 18960     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18961         MOVE ZEROS                  TO TEMP-8
 18962         GO TO S-4165-END-LF-EP-R78.
 18963
 18964     IF EPR-ST NOT = ZEROS
 18965         MOVE TEMP-7                 TO EPR-ST.
 18966
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 360
* ECS010.cbl
 18967     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 18968         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 18969         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 18970         IF DTE-R78 = '1'
 18971             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 18972
 18973     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 18974
 18975     COMPUTE TEMP-8 ROUNDED =
 18976               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 18977
 18978 S-4165-END-LF-EP-R78.
 18979
 18980     IF EPR-R78 = ZEROS
 18981         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 18982     ELSE
 18983         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 18984
 18985 S-4170-EP-DO-LF-EP-PRO.
 18986
 18987     IF DTE-CLIENT = 'MIC' OR 'MCC'
 18988         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 18989     ELSE
 18990         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 18991
 18992     IF REM-TRM1 GREATER THAN +0
 18993         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 18994     ELSE
 18995         MOVE WE-LFPRM                  TO TEMP-7.
 18996
 18997     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18998         MOVE ZEROS                     TO TEMP-8
 18999         GO TO S-4175-END-LF-EP-PRO.
 19000
 19001     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19002         IF DTE-CLIENT = 'MIC' OR 'MCC'
 19003             COMPUTE TEMP-5 ROUNDED =
 19004                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 19005         ELSE
 19006             COMPUTE TEMP-5 ROUNDED =
 19007                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 19008
 19009     COMPUTE TEMP-8 ROUNDED =
 19010                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 19011
 19012     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 19013
 19014 S-4175-END-LF-EP-PRO.
 19015
 19016     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 19017
 19018     GO TO S-4185-EP-DO-LF-STATUTORY.
 19019
 19020 S-4180-EP-DO-LF-EP-SUM.
 19021
 19022     IF REM-TRM1 NOT GREATER +0
 19023         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 19024         MOVE EPR-R78 TO EPR-PRO  EPR-ST
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 361
* ECS010.cbl
 19025         GO TO S-4190-EP-DO-LF-COMM.
 19026
 19027     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19028         MOVE ZEROS                 TO TEMP-7
 19029     ELSE
 19030         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 19031                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 19032
 19033     IF TEMP-7 NOT GREATER ZERO
 19034         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19035             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 19036             GO TO S-4190-EP-DO-LF-COMM
 19037         ELSE
 19038             MOVE ZEROS             TO TEMP-7.
 19039
 19040     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19041     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19042     IF DTE-R78 = '1'
 19043         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19044
 19045     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19046     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19047
 19048     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 19049
 19050     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 19051
 19052     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19053         GO TO S-4185-EP-DO-LF-STATUTORY.
 19054
 19055     MOVE EPR-R78                  TO EPR-ST.
 19056
 19057     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19058         MOVE ZEROS                 TO TEMP-8
 19059     ELSE
 19060         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 19061                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 19062
 19063     IF TEMP-8 NOT GREATER ZERO
 19064         GO TO S-4185-EP-DO-LF-STATUTORY.
 19065
 19066     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 19067                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 19068
 19069     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 19070                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 19071
 19072     COMPUTE EPR-ST ROUNDED = EPR-ST +
 19073                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 19074
 19075 S-4185-EP-DO-LF-STATUTORY.
 19076
 19077*08472      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19078*08473          MOVE EPR-R78                TO EPR-ST.
 19079
 19080     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 19081         MOVE EPR-PRO                TO EPR-ST.
 19082
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 362
* ECS010.cbl
 19083     IF (DTE-CLIENT = 'CID') AND
 19084        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 19085        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 19086        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 19087           GO TO S-4187-EP-DO-LF-STAT-ROA
 19088     END-IF.
 19089
 19090     IF EPR-ST NOT = ZEROS
 19091         GO TO S-4190-EP-DO-LF-COMM.
 19092
 19093     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 19094         MOVE EPR-R78                TO EPR-ST
 19095     ELSE
 19096         MOVE EPR-PRO                TO EPR-ST.
 19097
 19098     GO TO S-4190-EP-DO-LF-COMM.
 19099
 19100 S-4187-EP-DO-LF-STAT-ROA.
 19101     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 19102     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19103     MOVE 'L'                        TO DC-OPTION-CODE.
 19104     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19105     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19106     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 19107        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 19108        MOVE '3'                 TO  DC-OPTION-CODE
 19109        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19110                              8099-DATE-CONVERT-X
 19111        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 19112     ELSE
 19113        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 19114        MOVE +1                  TO  DC-ELAPSED-MONTHS
 19115        MOVE +0                  TO  DC-ELAPSED-DAYS
 19116        MOVE '6'                 TO  DC-OPTION-CODE
 19117        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19118                              8099-DATE-CONVERT-X
 19119        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 19120     END-IF
 19121     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 19122     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 19123     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19124     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19125     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19126     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19127     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19128     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 19129     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 19130     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 19131                                        CP-LOAN-TERM.
 19132     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 19133                                        CP-RATING-BENEFIT-AMT.
 19134     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 19135         MOVE ZEROS                  TO CP-REMAINING-BENEFIT
 19136     ELSE
 19137         MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
 19138     END-IF.
 19139     MOVE CR-APR                     TO CP-LOAN-APR.
 19140     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 363
* ECS010.cbl
 19141     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 19142     MOVE '6'                        TO CP-EARNING-METHOD.
 19143     MOVE '3'                        TO CP-PROCESS-TYPE.
 19144     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 19145     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19146         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19147     ELSE
 19148         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19149     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 19150     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 19151     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 19152     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19153     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19154     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 19155
 19156
 19157     IF CP-STATE-STD-ABBRV = 'OR'
 19158        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 19159     END-IF
 19160
 19161     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 19162        COMPUTE CP-ORIGINAL-BENEFIT =
 19163         (CR-LFAMT - CR-LFPRM)
 19164     END-IF
 19165
 19166     IF CP-TRUNCATED-LIFE
 19167        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 19168     END-IF
 19169
 19170     IF CP-TERM-IS-DAYS
 19171        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 19172     ELSE
 19173        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 19174     END-IF
 19175
 19176     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 19177
 19178     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 19179
 19180 S-4190-EP-DO-LF-COMM.
 19181
 19182     IF EARNED-BY-CANCEL = ZEROS
 19183         GO TO S-4195-LF-COMM-CONTINUE.
 19184
 19185     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19186         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19187
 19188     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19189         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19190
 19191     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19192         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19193
 19194 S-4195-LF-COMM-CONTINUE.
 19195
 19196     MOVE +0 TO SUB1.
 19197     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19198         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 364
* ECS010.cbl
 19199
 19200     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19201     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19202     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19203
 19204     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19205     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19206     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19207
 19208     MOVE 'Y'          TO EW-LEVEL-USED.
 19209
 19210     IF CR-POLICY-UNDERWRITTEN
 19211         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19212
 19213     ELSE
 19214         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19215
 19216     GO TO S-4200-EP-DO-AH.
 19217
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 365
* ECS010.cbl
 19219******************************************************************
 19220***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 19221******************************************************************
 19222
 19223 S-4200-EP-DO-AH.
 19224
 19225     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 19226                                        EPR-PRO
 19227                                        EPR-ST.
 19228
 19229     IF CR-AHTYP = ZERO
 19230         GO TO S-4299-EPBX.
 19231
 19232     IF REIN-AH-FLG (SUB5) = SPACE
 19233         GO TO S-4299-EPBX.
 19234
 19235     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 19236     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 19237     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 19238
 19239     MOVE CR-AH-TERM           TO ORIG-TERM.
 19240     MOVE CLAS-INDEXA          TO W-NDX.
 19241
 19242     MOVE EARNING-START-DATE     TO VALUATION-DT.
 19243     MOVE '9'                    TO W-VAL-SOURCE.
 19244     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19245
 19246 S-4220-EP-DO-AH-CNCL.
 19247
 19248     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19249         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 19250
 19251 S-4230-EP-DO-AH-EP.
 19252
 19253     IF REM-TRM2 GREATER CR-AH-TERM
 19254         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19255         GO TO S-4290-EP-DO-AH-COMM.
 19256
 19257     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19258         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19259
 19260 S-4235-CHECK-OB-AH-NCL.
 19261
 19262     IF (DTE-CLIENT EQUAL 'NCL') AND
 19263        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19264           MOVE WE-AHPRM         TO EPR-R78
 19265                                    EPR-PRO
 19266                                    EPR-ST
 19267        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19268           (CR-MO EQUAL EOM-MO)
 19269           MOVE '*'            TO OB-DATE-1-SWITCH
 19270           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19271           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19272           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19273           COMPUTE WS-EPR-R78 (SUB3 1) =
 19274                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 19275            GO TO S-4290-EP-DO-AH-COMM
 19276        ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 366
* ECS010.cbl
 19277        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19278           (CR-MO EQUAL OB-MO (1))
 19279           MOVE '*'            TO OB-DATE-2-SWITCH
 19280           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19281           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19282           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19283           COMPUTE WS-EPR-R78 (SUB3 2) =
 19284                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 19285            GO TO S-4290-EP-DO-AH-COMM
 19286        ELSE
 19287        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19288           (CR-MO EQUAL OB-MO (2))
 19289           MOVE '*'            TO OB-DATE-3-SWITCH
 19290           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19291           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19292           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19293           COMPUTE WS-EPR-R78 (SUB3 3) =
 19294                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 19295            GO TO S-4290-EP-DO-AH-COMM
 19296        ELSE
 19297            GO TO S-4290-EP-DO-AH-COMM.
 19298
 19299     IF REM-TRM2 NOT GREATER +0
 19300         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19301         GO TO S-4290-EP-DO-AH-COMM.
 19302
 19303     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19304         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19305         GO TO S-4290-EP-DO-AH-COMM.
 19306
 19307     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19308     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19309     IF DTE-R78 = '1'
 19310         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19311     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19312
 19313     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19314         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19315     ELSE
 19316         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19317
 19318     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19319     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19320
 19321     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19322     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19323
 19324     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19325
 19326*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19327*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19328
 19329     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19330
 19331     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19332        (CR-DT GREATER THAN  19921231)
 19333         IF CR-AH-TERM GREATER THAN  +61
 19334             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 367
* ECS010.cbl
 19335             MOVE '*' TO STATUTORY-SWITCH-AH
 19336             GO TO S-4245-EP-DO-AH-EP-AN
 19337         ELSE
 19338             GO TO S-4250-EP-DO-AH-STATUTORY.
 19339
 19340     IF AH-EARN-METHOD EQUAL 'N'
 19341         GO TO S-4240-EP-DO-AH-EP-NP.
 19342
 19343     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19344         MOVE 'A' TO AH-EARN-METHOD
 19345         GO TO S-4245-EP-DO-AH-EP-AN.
 19346
 19347     GO TO S-4250-EP-DO-AH-STATUTORY.
 19348
 19349 S-4240-EP-DO-AH-EP-NP.
 19350
 19351     IF WE-AHPRM = ZERO
 19352         GO TO S-4250-EP-DO-AH-STATUTORY.
 19353
 19354     IF CR-APR GREATER THAN +0
 19355         NEXT SENTENCE
 19356     ELSE
 19357         GO TO S-4250-EP-DO-AH-STATUTORY.
 19358
 19359     IF DTE-CLIENT = 'NCL'
 19360       IF CR-DT LESS THAN 19910101
 19361           GO TO S-4250-EP-DO-AH-STATUTORY.
 19362
 19363     IF REM-TRM1 = CR-AH-TERM
 19364         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19365         GO TO S-4290-EP-DO-AH-COMM.
 19366
 19367     MOVE CR-APR TO NP-APR.
 19368     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19369     MOVE REM-TRM1 TO NP-REM.
 19370     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19371     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19372         MOVE CR-LOAN-TERM TO NP-ORIG.
 19373     MOVE 'R' TO NP-OPT.
 19374     CALL 'ECSNETRM'
 19375         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19376
 19377     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 19378
 19379     GO TO S-4250-EP-DO-AH-STATUTORY.
 19380
 19381 S-4245-EP-DO-AH-EP-AN.
 19382     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19383     MOVE 'L'                        TO DC-OPTION-CODE.
 19384     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19385     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19386     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19387     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19388     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19389     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19390     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19391     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19392     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 368
* ECS010.cbl
 19393     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19394                                        CP-RATING-BENEFIT-AMT.
 19395     IF CP-STATE-STD-ABBRV = 'OR'
 19396         COMPUTE CP-RATING-BENEFIT-AMT =
 19397                                  CR-AHAMT * REM-TRM1.
 19398     MOVE CR-APR                     TO CP-LOAN-APR.
 19399     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19400     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19401     MOVE '3'                        TO CP-PROCESS-TYPE.
 19402     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19403     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19404
 19405     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19406         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19407     ELSE
 19408         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19409
 19410     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19411     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19412     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19413     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19414     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19415     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19416
 19417     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19418
 19419     IF CP-ERROR-RATE-NOT-FOUND  OR
 19420        CP-ERROR-RATE-IS-ZERO  OR
 19421        CP-ERROR-IN-DATES
 19422         GO TO S-4250-EP-DO-AH-STATUTORY.
 19423
 19424     COMPUTE EPR-R78 ROUNDED =
 19425             (REM-TRM1 * WE-AHAMT / +100 *
 19426               CP-PREMIUM-RATE)
 19427              / CR-AHPRM-CALC * CR-AHPRM
 19428
 19429     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19430
 19431     IF STATUTORY-REQUIREMENT-AH
 19432         MOVE EPR-R78                TO EPR-ST
 19433         GO TO S-4290-EP-DO-AH-COMM.
 19434
 19435 S-4250-EP-DO-AH-STATUTORY.
 19436     IF (DTE-CLIENT EQUAL 'CID') AND
 19437        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 19438         GO TO S-4267-EP-DO-AH-STAT-ROA
 19439     END-IF.
 19440
 19441 S-4250-EP-DO-AH-STATUTORY-VA.
 19442
 19443     MOVE EPR-R78                    TO EPR-ST.
 19444
 19445     MOVE +0                         TO SUB1.
 19446
 19447 S-4255-EP-AH-STAT-LOOP.
 19448     ADD +1 TO SUB1.
 19449
 19450     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 369
* ECS010.cbl
 19451         MOVE EPR-PRO                TO EPR-ST
 19452     ELSE
 19453         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19454             GO TO S-4255-EP-AH-STAT-LOOP.
 19455
 19456     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19457         CR-DT GREATER THAN 19831031)
 19458                    OR
 19459        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19460         CR-DT GREATER THAN 19820629)
 19461                    OR
 19462        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19463         CR-DT GREATER THAN 19830831)
 19464             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19465
 19466     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19467       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19468         IF CR-DT LESS THAN 19970101
 19469             MOVE EPR-R78            TO EPR-ST
 19470         ELSE
 19471             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19472
 19473     GO TO S-4290-EP-DO-AH-COMM.
 19474
 19475 S-4267-EP-DO-AH-STAT-ROA.
 19476     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19477     MOVE 'L'                        TO DC-OPTION-CODE.
 19478     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19479     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19480     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19481     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19482     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19483     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19484     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19485     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19486     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19487     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19488                                        CP-RATING-BENEFIT-AMT.
 19489     IF CP-STATE-STD-ABBRV = 'OR'
 19490         COMPUTE CP-RATING-BENEFIT-AMT =
 19491                                  CR-AHAMT * REM-TRM1.
 19492     MOVE CR-APR                     TO CP-LOAN-APR.
 19493     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19494     MOVE 'A'                        TO CP-EARNING-METHOD.
 19495     MOVE '3'                        TO CP-PROCESS-TYPE.
 19496     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19497     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19498     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19499         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19500     ELSE
 19501         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19502     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19503     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19504     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19505     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19506     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19507     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19508
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 370
* ECS010.cbl
 19509     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19510
 19511     IF CP-ERROR-RATE-NOT-FOUND  OR
 19512        CP-ERROR-RATE-IS-ZERO  OR
 19513        CP-ERROR-IN-DATES
 19514         GO TO S-4250-EP-DO-AH-STATUTORY-VA.
 19515
 19516     COMPUTE EPR-ST ROUNDED =
 19517             (REM-TRM1 * WE-AHAMT / +100 *
 19518               CP-PREMIUM-RATE)
 19519              / CR-AHPRM-CALC * CR-AHPRM
 19520
 19521     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 19522
 19523     GO TO S-4290-EP-DO-AH-COMM.
 19524
 19525 S-4290-EP-DO-AH-COMM.
 19526
 19527     IF EARNED-BY-CANCEL = ZEROS
 19528         GO TO S-4295-AH-COMM-CONTINUE.
 19529
 19530     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19531         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19532
 19533     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19534         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19535
 19536     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19537         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19538
 19539 S-4295-AH-COMM-CONTINUE.
 19540
 19541     MOVE +0           TO SUB1.
 19542     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19543         10 TIMES.
 19544
 19545     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19546     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19547     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19548
 19549     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19550     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19551     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19552
 19553     MOVE 'Y'          TO EW-LEVEL-USED.
 19554
 19555     IF CR-POLICY-UNDERWRITTEN
 19556         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19557     ELSE
 19558         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19559
 19560
 19561 S-4299-EPBX.
 19562     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 371
* ECS010.cbl
 19564******************************************************************
 19565***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 19566******************************************************************
 19567
 19568 S-4300-EP-COMM-LOOP.
 19569
 19570     ADD +1 TO SUB1.
 19571     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 19572         GO TO S-4399-EP-COMM-LOOP-X.
 19573
 19574     IF EW-LF-AH = AH-OVERRIDE-L1
 19575         GO TO S-4350-EP-COMM-LOOP-A.
 19576
 19577*    IF CR-AGT-TYPE (SUB1) = 'K'
 19578*       COMPUTE COMM-WK =
 19579     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 19580     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19581     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19582                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19583
 19584     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 19585     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19586     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19587                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19588
 19589     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 19590     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19591
 19592     GO TO S-4399-EP-COMM-LOOP-X.
 19593
 19594 S-4350-EP-COMM-LOOP-A.
 19595
 19596     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 19597     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19598     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19599                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19600
 19601     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 19602     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19603     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19604                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19605
 19606     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 19607     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19608
 19609 S-4399-EP-COMM-LOOP-X.
 19610     EXIT.
 19611
 19612******************************************************************
 19613******************************************************************
 19614******************************************************************
 19615******************************************************************
 19616******************************************************************
 19617******************************************************************
 19618******************************************************************
 19619******************************************************************
 19620******************************************************************
 19621******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 372
* ECS010.cbl
 19623******************************************************************
 19624***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 19625******************************************************************
 19626
 19627 4400-EP-FIND-TAB-ENT.
 19628
 19629     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19630         GO TO 4490-EP-FIND-TAB-SUB.
 19631     MOVE +1 TO SUB9.
 19632
 19633 4450-EP-FIND-TAB-LOOP.
 19634
 19635     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19636         GO TO 4490-EP-FIND-TAB-SUB.
 19637     IF EPEC-SUB-REIN (SUB9) = ZEROS
 19638         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 19639         GO TO 4490-EP-FIND-TAB-SUB.
 19640
 19641     ADD +1 TO SUB9.
 19642     IF SUB9 GREATER THAN +31
 19643         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 19644         MOVE 0201 TO WS-ABEND-CODE
 19645         DISPLAY '******************************'
 19646         DISPLAY '***** ERROR LOCATION 020 *****'
 19647         DISPLAY '******************************'
 19648         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19649         GO TO ABEND-PGM.
 19650
 19651     GO TO 4450-EP-FIND-TAB-LOOP.
 19652
 19653 4490-EP-FIND-TAB-SUB.
 19654
 19655     IF WE-LF-AH = LIFE-OVERRIDE-L1
 19656         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 19657             ADD +1 TO SUB10
 19658             MOVE SUB10 TO SUB3
 19659             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 19660         ELSE
 19661             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 19662
 19663     IF WE-LF-AH = AH-OVERRIDE-L1
 19664         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 19665             ADD +1 TO SUB10
 19666             MOVE SUB10 TO SUB3
 19667             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 19668         ELSE
 19669             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 19670
 19671*    IF SUB3 GREATER THAN +220
 19672*    IF SUB3 GREATER THAN +300
 19673     IF SUB3 GREATER THAN +900
 19674         DISPLAY 'SUB3 VALUE IS - ' SUB3
 19675         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 19676         MOVE 0202 TO WS-ABEND-CODE
 19677         DISPLAY '******************************'
 19678         DISPLAY '***** ERROR LOCATION 021 *****'
 19679         DISPLAY '******************************'
 19680         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 373
* ECS010.cbl
 19681         GO TO ABEND-PGM.
 19682
 19683     IF CR-POLICY-UNDERWRITTEN
 19684         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 19685         MOVE EPEC-UNDW-OPT-DATA-TABLE
 19686                                     TO EPEC-OPT-WORK-TABLE
 19687     ELSE
 19688         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 19689         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19690
 19691     MOVE WE-REIN-CO         TO EW-REIN-CO
 19692                                EPEC-REIN-CO (SUB3)
 19693                                EPEC-REIN-CO-II (SUB3).
 19694     MOVE WE-LF-AH           TO EW-LF-AH
 19695                                EPEC-LF-AH (SUB3)
 19696                                EPEC-LF-AH-II (SUB3).
 19697     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 19698                                EPEC-BEN-TYPE (SUB3)
 19699                                EPEC-BEN-TYPE-II (SUB3).
 19700
 19701 4499-EP-FIND-TAB-ENT-X.
 19702     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 374
* ECS010.cbl
 19704******************************************************************
 19705***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 19706******************************************************************
 19707
 19708 4500-BUILD-EPEC-EXTRACT.
 19709
 19710     IF (DTE-CLIENT = 'DCC')
 19711*       AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 19712        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 19713     END-IF
 19714
 19715     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 19716         VARYING SUB2 FROM +1 BY +1
 19717             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 19718
 19719     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 19720
 19721     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 19722
 19723
 19724 4510-BUILD-EPEC-EXT.
 19725
 19726     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 19727     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 19728     IF EW-LEVEL-USED = 'Y'
 19729         MOVE SPACE                     TO W-UNDERWRITING-SW
 19730         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19731                 4518-BUILD-EPEC-RCD-X.
 19732
 19733     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 19734     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 19735     IF EW-LEVEL-USED = 'Y'
 19736         MOVE '*'                       TO W-UNDERWRITING-SW
 19737         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19738                 4518-BUILD-EPEC-RCD-X.
 19739
 19740     GO TO 4519-BUILD-EPEC-EXT-X.
 19741
 19742 4511-BUILD-EPEC-RECORD.
 19743
 19744     MOVE SPACES                        TO EP-RECORD.
 19745     MOVE 'EP'                          TO EP-RECORD-ID.
 19746     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 19747     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 19748     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 19749     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 19750                                           WS-EP-EFF-DTE-N.
 19751     MOVE EW-REIN-CO                    TO EP-REI-CO.
 19752     IF EP-REI-CO NOT = SPACES
 19753         MOVE 'R'                       TO EP-REIN.
 19754     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 19755     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 19756
 19757     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 19758     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 19759     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 19760
 19761     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 375
* ECS010.cbl
 19762     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
 19763     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 19764
 19765     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 19766     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 19767     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 19768     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 19769
 19770     IF DTE-CLIENT NOT = 'NCL'
 19771         GO TO 4512-BUILD-EPEC-CONTINUE.
 19772
 19773     IF W-UNDERWRITTEN-DATA
 19774         GO TO 4512-BUILD-EPEC-CONTINUE.
 19775
 19776     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 19777         GO TO 4512-BUILD-EPEC-CONTINUE.
 19778
 19779     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 19780        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 19781        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 19782         NEXT SENTENCE
 19783     ELSE
 19784         GO TO 4512-BUILD-EPEC-CONTINUE.
 19785
 19786     IF OB-DATE-1-USED  OR
 19787        OB-DATE-2-USED  OR
 19788        OB-DATE-3-USED
 19789         NEXT SENTENCE
 19790     ELSE
 19791         GO TO 4512-BUILD-EPEC-CONTINUE.
 19792
 19793     IF OB-DATE-1-USED
 19794         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 19795             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19796                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 19797             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19798                                   EW-EPR-ST
 19799             GO TO 4512-BUILD-EPEC-CONTINUE
 19800         ELSE
 19801             GO TO 4512-BUILD-EPEC-CONTINUE.
 19802
 19803     IF OB-DATE-2-USED
 19804         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 19805             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19806                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 19807             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19808                                   EW-EPR-ST
 19809             GO TO 4512-BUILD-EPEC-CONTINUE
 19810         ELSE
 19811             GO TO 4512-BUILD-EPEC-CONTINUE.
 19812
 19813     IF OB-DATE-3-USED
 19814         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 19815             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19816                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 19817             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19818                                   EW-EPR-ST
 19819             GO TO 4512-BUILD-EPEC-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 376
* ECS010.cbl
 19820         ELSE
 19821             GO TO 4512-BUILD-EPEC-CONTINUE.
 19822
 19823 4512-BUILD-EPEC-CONTINUE.
 19824
 19825     MOVE EW-EPR-R78                    TO EP-PRM-78.
 19826     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 19827     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 19828
 19829     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 19830     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 19831     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 19832
 19833     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 19834
 19835     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 19836     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 19837     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 19838
 19839     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 19840     MOVE ZEROS                         TO EP-CLM-PV.
 19841
 19842     if (dte-client = 'AHL')
 19843        and (ep-rcd-type = 'A')
 19844        and (ep-ben-code (1:1) = 'M')
 19845*       display ' Using spec calc ' ep-account ' ' ew-clm-ibnr
 19846        continue
 19847     else
 19848        IF EP-RCD-TYPE = 'A' OR 'U'
 19849           IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 19850              PERFORM 4599A-CALC-IBNR
 19851                                 THRU 4599A-CALC-EXIT
 19852           end-if
 19853        end-if
 19854     end-if
 19855
 19856     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 19857
 19858     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 19859     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 19860
 19861     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 19862
 19863     IF EW-ISS-CNT = ZERO
 19864         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 19865                                           EP-AVG-AGE
 19866       ELSE
 19867         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 19868                                EW-ORIG-TERM / EW-ISS-CNT
 19869         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 19870
 19871     IF EW-INFORCE-CNT = ZERO
 19872         MOVE ZERO                      TO EP-AVG-REM-TERM
 19873       ELSE
 19874         COMPUTE EP-AVG-REM-TERM ROUNDED =
 19875                             EW-REM-TERM / EW-INFORCE-CNT.
 19876
 19877     IF EW-ISS-BEN = ZERO
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 377
* ECS010.cbl
 19878         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 19879                                           EP-WEIGHTED-AGE
 19880       ELSE
 19881         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 19882                                  EW-TERM-BEN / EW-ISS-BEN
 19883         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 19884                                   EW-AGE-BEN / EW-ISS-BEN.
 19885
 19886     MOVE ZEROS                         TO
 19887         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 19888         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
 19889
 19890     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 19891                                           WS-EP-HI-COV-DT-N.
 19892     MOVE HIGH-CERT                     TO EP-HI-CERT
 19893                                           WS-EP-HI-CERT-N.
 19894     MOVE LOW-CERT                      TO EP-LO-CERT
 19895                                           WS-EP-LO-CERT-N.
 19896     IF DTE-PGM-OPT = '3'
 19897         MOVE 'P'                       TO EP-PURGE.
 19898
 19899     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 19900         GO TO 4514-CONTINUE.
 19901
 19902     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 19903
 19904     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 19905         MOVE +1                 TO EP-LIFE-YEARS
 19906     ELSE
 19907         MOVE ZEROS              TO W-LIFE-YEARS
 19908         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 19909                 VARYING
 19910             SUBM FROM +1 BY +1
 19911                 UNTIL
 19912             SUBM GREATER THAN +13
 19913         COMPUTE W-LIFE-YEARS-INT ROUNDED
 19914             = W-LIFE-YEARS / 12
 19915             - (EPEC-LIFE-CTR (SUB2 1)
 19916             + EPEC-LIFE-CTR (SUB2 13)) / 24
 19917         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 19918         IF  EP-LIFE-YEARS LESS THAN +1
 19919             MOVE +1             TO EP-LIFE-YEARS.
 19920
 19921 4514-CONTINUE.
 19922
 19923     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4900-WRT-SUMMARY-X.
 19924
 19925     MOVE SPACES                        TO EC-RECORD.
 19926     MOVE '1'                           TO WS-SEQ-NBR.
 19927     MOVE +0                            TO SUB3.
 19928     MOVE +0                            TO SUB4.
 19929     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 19930         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 19931         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 19932
 19933     GO TO 4518-BUILD-EPEC-RCD-X.
 19934
 19935 4515-DETERMINE-LIFE-YEARS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 378
* ECS010.cbl
 19936
 19937     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 19938
 19939 4515-EXIT.
 19940     EXIT.
 19941
 19942 4518-BUILD-EPEC-RCD-X.
 19943     EXIT.
 19944
 19945 4519-BUILD-EPEC-EXT-X.
 19946     EXIT.
 19947
 19948 4520-BUILD-EPEC-LOAD-COMM.
 19949
 19950     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 19951
 19952     ADD +1 TO SUB3  SUB4.
 19953     MOVE ZEROS                  TO LEVELS-BUILT.
 19954
 19955 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 19956
 19957     IF SUB4 GREATER THAN WS-LOOP-MAX
 19958         IF AGT-SW = 'X'
 19959             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19960                 THRU 4900-WRT-SUMMARY-X
 19961             MOVE ' '            TO AGT-SW
 19962             MOVE WS-LOOP-MAX    TO  SUB4
 19963             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 19964         ELSE
 19965             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 19966
 19967     IF LEVELS-BUILT EQUAL +5
 19968         IF AGT-SW = 'X'
 19969             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19970                 THRU 4900-WRT-SUMMARY-X
 19971             MOVE ' '            TO AGT-SW
 19972             MOVE ZEROS          TO LEVELS-BUILT
 19973             ADD 1 TO WS-SEQ-NBR
 19974             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 19975             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 19976                     4540-BUILD-CLEAR-X
 19977                 VARYING SUB3 FROM +1 BY +1
 19978                 UNTIL SUB3 GREATER THAN +5
 19979             MOVE +1             TO SUB3
 19980             GO TO 4531-BUILD-EPEC-LOAD-COMM
 19981         ELSE
 19982             MOVE +1             TO SUB3
 19983             MOVE ZEROS          TO LEVELS-BUILT
 19984             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 19985
 19986     IF SUB4 GREATER THAN WS-LOOP-MAX
 19987         IF AGT-SW = 'X'
 19988             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19989                 THRU 4900-WRT-SUMMARY-X
 19990             MOVE ' '                   TO AGT-SW
 19991             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 19992         ELSE
 19993             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 379
* ECS010.cbl
 19994
 19995 4531-BUILD-EPEC-LOAD-COMM.
 19996
 19997     IF (EW-AGT-NO (SUB4) = SPACES)
 19998                  OR
 19999        ((EW-ISS-COM (SUB4) = ZEROS) AND
 20000         (EW-CNC-COM (SUB4) = ZEROS) AND
 20001         (EW-ECR-R78 (SUB4) = ZEROS) AND
 20002         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 20003         (EW-ECR-PRO (SUB4) = ZEROS) AND
 20004         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
 20005         (EW-ECR-ST (SUB4) = ZEROS))
 20006         PERFORM 4540-BUILD-EPEC-CLEAR
 20007             THRU 4540-BUILD-CLEAR-X
 20008         ADD +1 TO SUB4
 20009         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20010
 20011     MOVE 'X'                           TO AGT-SW.
 20012     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 20013     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 20014     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 20015     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 20016     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 20017     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 20018     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 20019     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 20020     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 20021
 20022     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 20023
 20024     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20025
 20026 4539-BUILD-EPEC-LOAD-COMM-X.
 20027     EXIT.
 20028
 20029 4540-BUILD-EPEC-CLEAR.
 20030
 20031     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 20032     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 20033     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 20034                                           EC-CNC-COMM (SUB3)
 20035                                           EC-COMM-78 (SUB3)
 20036                                           EC-COMM-PR (SUB3)
 20037                                           EC-COMM-ST (SUB3)
 20038                                           EC-COMM-78-ADJ (SUB3)
 20039                                           EC-COMM-PR-ADJ (SUB3).
 20040
 20041 4540-BUILD-CLEAR-X.
 20042     EXIT.
 20043
 20044 4541-CALC-IBNR.
 20045
 20046     MOVE +0                    TO TOT-AH-IBNR
 20047                                   TOT-AH-PRM
 20048                                   TOT-AH-PD-CLMS
 20049                                   TOT-AH-CLMRSV
 20050                                   TOT-LF-IBNR
 20051                                   TOT-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 380
* ECS010.cbl
 20052                                   TOT-LF-PD-CLMS
 20053                                   TOT-LF-CLMRSV
 20054
 20055     MOVE +0                    TO RTOT-AH-IBNR
 20056                                   RTOT-AH-PRM
 20057                                   RTOT-AH-PRMB
 20058                                   RTOT-AH-PD-CLMS
 20059                                   RTOT-AH-CLMRSV
 20060                                   RTOT-LF-IBNR
 20061                                   RTOT-LF-PRM
 20062                                   RTOT-LF-PD-CLMS
 20063                                   RTOT-LF-CLMRSV
 20064
 20065     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20066        (SUB2 > +900)
 20067        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20068*       IF W-UNDERWRITTEN-DATA
 20069*          MOVE EPEC-LEVELS-II (SUB2)
 20070*                                TO EPEC-WORK
 20071*       ELSE
 20072           MOVE EPEC-LEVELS (SUB2)
 20073                                 TO EPEC-WORK
 20074*       END-IF
 20075*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20076           IF EW-REIN-CO = SPACES
 20077              CONTINUE
 20078*             IF EW-LF-AH = 'L'
 20079*                COMPUTE TOT-LF-PRM = TOT-LF-PRM
 20080*                   + EW-EPR-ST
 20081*                COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 20082*                   + EW-CLM-AMT
 20083*                COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 20084*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20085*             ELSE
 20086*                COMPUTE TOT-AH-PRM = TOT-AH-PRM
 20087*                   + EW-EPR-ST
 20088*                COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 20089*                   + EW-CLM-AMT
 20090*                COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 20091*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20092           ELSE
 20093              DISPLAY ' ACCUM IBNR STUFF ' EW-REIN-CO ' '
 20094                 EW-LF-AH ' ' EW-BEN-TYPE
 20095              IF EW-LF-AH = 'L'
 20096                 COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 20097                    + EW-EPR-ST
 20098                 COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 20099                    + EW-CLM-AMT
 20100                 COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 20101                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20102              ELSE
 20103                 COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 20104                    + EW-EPR-ST
 20105                 IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20106                    COMPUTE RTOT-AH-PRMB = RTOT-AH-PRMB
 20107                       + EW-EPR-ST
 20108                 END-IF
 20109                 COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 381
* ECS010.cbl
 20110                    + EW-CLM-AMT
 20111                 COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 20112                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20113              END-IF
 20114           END-IF
 20115*       END-IF
 20116     END-PERFORM
 20117
 20118*    COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 20119*       - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 20120*    IF TOT-AH-IBNR < ZEROS
 20121*       COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 20122*    END-IF
 20123*    COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 20124*       - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 20125*    IF TOT-LF-IBNR < ZEROS
 20126*       COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 20127*    END-IF
 20128
 20129     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 20130        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
 20131     IF RTOT-AH-IBNR < ZEROS
 20132        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 20133     END-IF
 20134     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 20135        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 20136     IF RTOT-LF-IBNR < ZEROS
 20137        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 20138     END-IF
 20139
 20140     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20141        (SUB2 > +900)
 20142        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20143*       IF W-UNDERWRITTEN-DATA
 20144*          MOVE EPEC-LEVELS-II (SUB2)
 20145*                                TO EPEC-WORK
 20146*       ELSE
 20147           MOVE EPEC-LEVELS (SUB2)
 20148                                 TO EPEC-WORK
 20149*       END-IF
 20150*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20151           IF EW-REIN-CO = SPACES
 20152              CONTINUE
 20153*             IF EW-LF-AH = 'L'
 20154*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20155*                   / TOT-LF-PRM
 20156*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20157*                   * RTOT-LF-IBNR
 20158**                  * TOT-LF-IBNR
 20159*             ELSE
 20160*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20161*                   / TOT-AH-PRM
 20162*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20163*                   * RTOT-AH-IBNR
 20164**                  * TOT-AH-IBNR
 20165*             END-IF
 20166           ELSE
 20167              DISPLAY ' AFTER ACCUM IBNR STUFF ' EW-REIN-CO ' '
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 382
* ECS010.cbl
 20168                 EW-LF-AH ' ' EW-BEN-TYPE ' '
 20169                    EW-EPR-ST ' ' RTOT-AH-PRM
 20170              IF EW-LF-AH = 'L'
 20171                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20172                    / RTOT-LF-PRM
 20173                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20174                    * RTOT-LF-IBNR
 20175              ELSE
 20176                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20177                    / RTOT-AH-PRMB
 20178                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20179                    * RTOT-AH-IBNR
 20180              END-IF
 20181              IF (EW-ISS-PRM - EW-CNC-PRM) = EW-EPR-ST
 20182                 move zeros to ew-clm-ibnr
 20183              end-if
 20184           END-IF
 20185*       END-IF
 20186*       IF W-UNDERWRITTEN-DATA
 20187*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 20188*       ELSE
 20189           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 20190*       END-IF
 20191     END-PERFORM
 20192
 20193     .
 20194 4541-EXIT.
 20195     EXIT.
 20196
 20197 4545-BUILD-BASE.
 20198
 20199     MOVE 'EC'                   TO EC-RECORD-ID.
 20200     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 20201     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 20202     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 20203     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 20204                                    WS-EC-EFF-DTE.
 20205     MOVE EW-REIN-CO             TO EC-REI-CO.
 20206     IF EC-REI-CO NOT = SPACES
 20207         MOVE 'R'                TO EC-REIN.
 20208     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 20209     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 20210     IF DTE-PGM-OPT = '3'
 20211         MOVE 'P'                TO EC-PURGE.
 20212     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 20213
 20214 4545-BUILD-BASE-X.
 20215     EXIT.
 20216
 20217******************************************************************
 20218***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 20219******************************************************************
 20220
 20221 4550-CLEAR-EPEC-TOTALS.
 20222
 20223     MOVE LOW-CERT             TO SV-LO-CERT.
 20224     MOVE HIGH-CERT            TO SV-HI-CERT.
 20225     MOVE SPACES               TO LOW-CTL.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 383
* ECS010.cbl
 20226     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 20227
 20228     MOVE +1                   TO SUB9.
 20229     MOVE +0                   TO SUB10.
 20230     MOVE ZERO                 TO EW-REIN-CO
 20231                                  EW-BEN-TYPE.
 20232     MOVE SPACE                TO EP-FLG
 20233                                  EW-LF-AH
 20234                                  EW-LEVEL-USED
 20235                                  W-TABLE-USED-SW.
 20236
 20237     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 20238                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 20239                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 20240                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 20241                                  EW-EPR-R78     EW-EPR-R78-ADJ
 20242                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 20243                                  EW-EPR-ST      EW-EPR-ST-ADJ
 20244                                  EW-CLM-AMT     EW-COV-DTE
 20245                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 20246                                  EW-CLM-FUTRSV  EW-CLM-CNT
 20247                                  EW-CLM-CRT     EW-ISS-CNT
 20248                                  EW-CNC-CNT     EW-AGE
 20249                                  EW-ORIG-TERM   EW-INFORCE-CNT
 20250                                  EW-AGE-BEN     EW-TERM-BEN
 20251                                  EW-ISS-PRM-TAX
 20252                                  EW-REM-TERM.
 20253
 20254     MOVE +1 TO SUB1.
 20255     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
 20256     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 20257         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 20258     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 20259                                    EPEC-UNDW-OPT-DATA-TABLE.
 20260     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 20261         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 20262
 20263     PERFORM 4590-INIT-OB THRU 4590-EXIT
 20264         VARYING SUB3 FROM +1 BY +1
 20265*        UNTIL SUB3 GREATER THAN +300.
 20266*        UNTIL SUB3 GREATER THAN +220.
 20267         UNTIL SUB3 GREATER THAN +900.
 20268
 20269     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 20270
 20271 4555-CLEAR-EPEC-COMM.
 20272
 20273     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 20274                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 20275                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 20276                EW-ECR-ST  (SUB1).
 20277     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 20278                                    EW-AGT-TYPE (SUB1).
 20279
 20280     ADD +1 TO SUB1.
 20281
 20282 4560-CLEAR-EPEC-ALL.
 20283
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 384
* ECS010.cbl
 20284     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 20285                                    EPEC-LEVELS-II (SUB1).
 20286     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 20287
 20288 4570-CLEAR-EPEC-SUB-A.
 20289
 20290     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 20291     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 20292*        UNTIL SUB2 GREATER +300.
 20293         UNTIL SUB2 GREATER +900.
 20294
 20295 4580-CLEAR-EPEC-SUB-B.
 20296
 20297     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 20298     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 20299
 20300 4589-CLEAR-EPEC-TOTALS-X.
 20301     EXIT.
 20302
 20303 4590-INIT-OB.
 20304
 20305     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 20306     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 20307     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 20308
 20309 4590-EXIT.
 20310     EXIT.
 20311
 20312 4599-BUILD-EPEC-EXTRACT-X.
 20313     EXIT.
 20314
 20315*********************************************************
 20316*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 20317*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 20318*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 20319*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 20320*  IN THE DATE CARD.                                    *
 20321*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 20322*********************************************************
 20323
 20324 4599A-CALC-IBNR.
 20325
 20326     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 20327        (((EP-PRM-78 + EP-PRM-78-ADJ)
 20328                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 20329         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 20330                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 20331                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 20332
 20333     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 20334         MOVE ZEROS                 TO EW-CLM-IBNR
 20335         GO TO 4599A-CALC-EXIT.
 20336
 20337     IF EP-REIN = 'R'
 20338         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 20339
 20340     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20341
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 385
* ECS010.cbl
 20342 4599A-CALC-EXIT.
 20343      EXIT.
 20344 4599B-SEARCH.
 20345      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 386
* ECS010.cbl
 20347******************************************************************
 20348***         CALCULATE OPTIONAL METHOD I B N R                  ***
 20349******************************************************************
 20350
 20351 4600-GET-OPT-IBNR.
 20352
 20353     IF  CR-POLICY-IS-ACTIVE
 20354         IF  CR-POLICY-IS-REISSUE
 20355             OR CR-POLICY-IS-MONTHLY
 20356             IF  W-LIFE
 20357                 GO TO 4600-EXIT
 20358             ELSE
 20359                 NEXT SENTENCE
 20360         ELSE
 20361             NEXT SENTENCE
 20362     ELSE
 20363         IF  W-LIFE
 20364             GO TO 4600-EXIT.
 20365
 20366     IF  W-LIFE
 20367         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 20368     ELSE
 20369         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 20370
 20371 4600-EXIT.
 20372     EXIT.
 20373
 20374 4620-DETERMINE-LIFE-IBNR.
 20375
 20376     IF  CR-LF-POLICY-IS-ACTIVE
 20377         ADD +1                  TO W-LF-ACTIVE
 20378         IF  CR-LF-POLICY-IS-REISSUE
 20379             OR CR-LF-POLICY-IS-MONTHLY
 20380             MOVE ZEROS          TO W-WK-IBNR
 20381             ADD +1              TO W-LF-REISSUE
 20382             GO TO 4620-EXIT
 20383         ELSE
 20384             NEXT SENTENCE
 20385     ELSE
 20386         ADD +1                  TO W-LF-INACTIVE
 20387         MOVE ZEROS              TO W-WK-IBNR
 20388         GO TO 4620-EXIT.
 20389
 20390     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 20391         MOVE ZEROS              TO W-WK-IBNR
 20392         ADD +1                  TO W-LF-CALC-B
 20393         GO TO 4620-EXIT.
 20394
 20395     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20396                 AND
 20397             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 20398                 AND
 20399             W-BAL-REMTRM NOT GREATER THAN ZERO)
 20400             OR
 20401         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20402                 AND
 20403             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 20404                 AND
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 387
* ECS010.cbl
 20405             REM-TRM2 NOT GREATER THAN ZERO)
 20406         MOVE ZEROS              TO W-WK-IBNR
 20407         ADD +1                  TO W-LF-BALLOON
 20408         GO TO 4620-EXIT
 20409     ELSE
 20410         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 20411                 AND
 20412             REM-TRM2 NOT GREATER THAN ZERO)
 20413             ADD +1              TO W-LF-REMTERM-0
 20414             MOVE ZEROS          TO W-WK-IBNR
 20415             GO TO 4620-EXIT.
 20416
 20417     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 20418
 20419     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 20420         ADD +1                  TO W-LF-REMAMT-0
 20421         MOVE ZEROS              TO W-WK-IBNR
 20422         GO TO 4620-EXIT.
 20423
 20424     IF  AM-LIFE-IBNR-PCT NUMERIC
 20425             AND
 20426         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 20427         COMPUTE W-WK-IBNR ROUNDED
 20428             = CP-REMAINING-AMT
 20429             / 1000
 20430             * AM-LIFE-IBNR-PCT
 20431     ELSE
 20432         COMPUTE W-WK-IBNR ROUNDED
 20433             = CP-REMAINING-AMT
 20434             / 1000
 20435             * COMPANY-IBNR-LIFE-FACTOR.
 20436
 20437     IF  CR-LF-IS-REIN-ONLY
 20438         ADD +1                  TO W-LF-REIN
 20439     ELSE
 20440         ADD +1                  TO W-LF-DATA-USED
 20441         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 20442         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 20443         IF  CR-LFTYP = '01'
 20444             ADD CP-REMAINING-AMT
 20445                                 TO W-01-REMAMT
 20446             ADD +1              TO W-01-DATA-USED
 20447         ELSE
 20448         IF  CR-LFTYP = '02'
 20449             ADD CP-REMAINING-AMT
 20450                                 TO W-02-REMAMT
 20451             ADD +1              TO W-02-DATA-USED
 20452         ELSE
 20453         IF  CR-LFTYP = '03'
 20454             ADD CP-REMAINING-AMT
 20455                                 TO W-03-REMAMT
 20456             ADD +1              TO W-03-DATA-USED
 20457         ELSE
 20458         IF  CR-LFTYP = '04'
 20459             ADD CP-REMAINING-AMT
 20460                                 TO W-04-REMAMT
 20461             ADD +1              TO W-04-DATA-USED
 20462         ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 388
* ECS010.cbl
 20463         IF  CR-LFTYP = '05'
 20464             ADD CP-REMAINING-AMT
 20465                                 TO W-05-REMAMT
 20466             ADD +1              TO W-05-DATA-USED
 20467         ELSE
 20468         IF  CR-LFTYP = '06'
 20469             ADD CP-REMAINING-AMT
 20470                                 TO W-06-REMAMT
 20471             ADD +1              TO W-06-DATA-USED
 20472         ELSE
 20473         IF  CR-LFTYP = '30'
 20474             ADD CP-REMAINING-AMT
 20475                                 TO W-30-REMAMT
 20476             ADD +1              TO W-30-DATA-USED
 20477         ELSE
 20478         IF  CR-LFTYP = '31'
 20479             ADD CP-REMAINING-AMT
 20480                                 TO W-31-REMAMT
 20481             ADD +1              TO W-31-DATA-USED
 20482         ELSE
 20483             ADD CP-REMAINING-AMT
 20484                                 TO W-XX-REMAMT
 20485             ADD +1              TO W-XX-DATA-USED.
 20486
 20487     IF  CR-POLICY-IS-REIN-ONLY
 20488             OR
 20489         CR-LF-IS-REIN-ONLY
 20490         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20491         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20492         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 20493     ELSE
 20494         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 20495
 20496 4620-EXIT.
 20497     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 389
* ECS010.cbl
 20499 4640-GET-A-H-EARNED-PREMIUM.
 20500
 20501     IF  CR-AH-POLICY-IS-ACTIVE
 20502         ADD +1                  TO W-AH-ACTIVE
 20503         IF  CR-AH-POLICY-IS-REISSUE
 20504             OR CR-AH-POLICY-IS-MONTHLY
 20505             ADD +1              TO W-AH-REISSUE
 20506         ELSE
 20507             NEXT SENTENCE
 20508     ELSE
 20509         ADD +1                  TO W-AH-INACTIVE.
 20510
 20511     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20512         ADD +1                  TO W-AH-CALC-B
 20513         GO TO 4640-EXIT.
 20514
 20515     IF  REM-TRM2 NOT GREATER THAN ZEROS
 20516         MOVE 'Y'                TO W-RTRM-0-SW
 20517     ELSE
 20518         MOVE SPACES             TO W-RTRM-0-SW.
 20519
 20520     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 20521
 20522****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 20523******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 20524******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 20525******        THAT CLAIM.
 20526
 20527     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 20528
 20529     IF  CR-POLICY-IS-REIN-ONLY
 20530              OR
 20531         CR-AH-IS-REIN-ONLY
 20532         ADD +1                  TO W-AH-REIN
 20533         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20534         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20535         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20536         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20537         GO TO 4640-EXIT.
 20538
 20539     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20540                                    W-EPEC-EP-IN.
 20541     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20542                                    W-CLAIMS-MADE-PAID-IN.
 20543     ADD +1                      TO W-AH-DATA-USED.
 20544     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 20545     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 20546
 20547     IF  W-CLMAMT GREATER THAN ZEROS
 20548         ADD +1                  TO W-AH-CLAIM-CTR
 20549         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 20550
 20551     IF  W-RTRM-0
 20552             AND
 20553         NOT CR-POLICY-IS-REIN-ONLY
 20554             AND
 20555         NOT CR-AH-IS-REIN-ONLY
 20556         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 390
* ECS010.cbl
 20557         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 20558         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 20559         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 20560         ADD +1                  TO W-AH-REMTERM-0.
 20561
 20562 4640-EXIT.
 20563     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 391
* ECS010.cbl
 20565 4650-DETERMINE-CLM-AMT-AH.
 20566
 20567     MOVE ZEROS                  TO W-CLMAMT.
 20568
 20569     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 20570             OR
 20571         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 20572         GO TO 4650-EXIT.
 20573
 20574     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 20575             AND
 20576         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 20577         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 20578         MOVE 'L'                    TO DC-OPTION-CODE
 20579         PERFORM 8000-DATE-CONVERT-ROUTINE
 20580             THRU 8099-DATE-CONVERT-X
 20581         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 20582         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 20583         MOVE 'L'                    TO DC-OPTION-CODE
 20584         PERFORM 8000-DATE-CONVERT-ROUTINE
 20585             THRU 8099-DATE-CONVERT-X
 20586         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 20587         IF  DATE-CONVERSION-ERROR
 20588             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 20589             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 20590             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20591             MOVE 0303               TO WS-ABEND-CODE
 20592             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 20593             GO TO ABEND-PGM
 20594         ELSE
 20595             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 20596             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 20597             MOVE '1'                TO DC-OPTION-CODE
 20598             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 20599                                        DC-ELAPSED-DAYS
 20600             PERFORM 8000-DATE-CONVERT-ROUTINE
 20601                 THRU 8099-DATE-CONVERT-X
 20602             IF  DATE-CONVERSION-ERROR
 20603                 DISPLAY 'DIS TO PTO DATE ERROR '
 20604                     CR-FULL-CONTROL
 20605                 MOVE 'DIS TO PTO DATE ERROR '
 20606                                     TO WS-ABEND-MESSAGE
 20607                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 20608                 MOVE 0303           TO WS-ABEND-CODE
 20609                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 20610                 GO TO ABEND-PGM
 20611             ELSE
 20612                 COMPUTE W-CLMAMT ROUNDED
 20613                     = CR-AHAMT
 20614                     * (DC-ELAPSED-DAYS / 30)
 20615                 GO TO 4650-EXIT.
 20616
 20617     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 20618             OR
 20619         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 20620         GO TO 4650-EXIT.
 20621
 20622     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 392
* ECS010.cbl
 20623         = CR-AHAMT * 3.
 20624
 20625     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 20626         MOVE CR-DISAMT          TO W-CLMAMT
 20627     ELSE
 20628         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 20629
 20630     IF  NOT CR-POLICY-IS-REIN-ONLY
 20631              AND
 20632         NOT CR-AH-IS-REIN-ONLY
 20633         ADD +1          TO W-CLM-EXCEPT-CNT
 20634         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 20635
 20636 4650-EXIT.
 20637     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 393
* ECS010.cbl
 20639 4660-DETERMINE-EARNED-PREMIUM.
 20640
 20641     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 20642
 20643     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 20644
 20645     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 20646
 20647     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 20648         MOVE ZEROS              TO W-EARNED-PREMIUM
 20649         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 20650         MOVE '7'                TO W-VAL-SOURCE
 20651         PERFORM 8500-REMAINING-TERM-ROUTINE
 20652             THRU 8599-REM-TERM-X
 20653         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 20654         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 20655         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 20656         MOVE EPR-R78            TO W-OPT-R78
 20657         MOVE EPR-PRO            TO W-OPT-PRO
 20658         MOVE EPR-ST             TO W-OPT-ST
 20659         PERFORM 4670-CALC-EP THRU 4670-EXIT
 20660         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 20661     ELSE
 20662         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 20663
 20664     COMPUTE W-EARNED-PREMIUM ROUNDED
 20665         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 20666
 20667     IF  W-EARNED-PREMIUM LESS THAN ZERO
 20668         ADD +1                  TO W-EP-LESS-THAN-0
 20669         MOVE ZERO               TO W-EARNED-PREMIUM.
 20670
 20671 4660-EXIT.
 20672     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 394
* ECS010.cbl
 20674 4666-SAVE-AHCR-DATA.
 20675
 20676     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 20677                                    WX-STATUS-AT-SETTLEMENT.
 20678
 20679     MOVE ZEROS                  TO WX-CANC-DT
 20680                                    WX-EOM-RUN-DATE
 20681                                    WX-SETTLEMENT-EXIT-DATE.
 20682
 20683     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 20684         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 20685         MOVE CR-AH-STATUS-AT-CANCEL
 20686                                 TO WX-STATUS-AT-CANCEL
 20687         MOVE ZEROS              TO CR-AH-CANC-DT
 20688                                    WS-CR-AH-CANC-DT-N
 20689         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 20690
 20691     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20692         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 20693                                 TO WX-SETTLEMENT-EXIT-DATE
 20694         MOVE CR-AH-STATUS-AT-SETTLEMENT
 20695                                 TO WX-STATUS-AT-SETTLEMENT
 20696         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 20697                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20698         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 20699
 20700     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 20701     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 20702
 20703 4666-EXIT.
 20704     EXIT.
 20705
 20706 4668-RESTORE-AHCR-DATA.
 20707
 20708     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 20709         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 20710                                    WS-CR-AH-CANC-DT-N
 20711         MOVE WX-STATUS-AT-CANCEL
 20712                                 TO CR-AH-STATUS-AT-CANCEL.
 20713
 20714     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20715         MOVE WX-SETTLEMENT-EXIT-DATE
 20716                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 20717                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20718         MOVE WX-STATUS-AT-SETTLEMENT
 20719                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 20720
 20721     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 20722
 20723 4668-EXIT.
 20724     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 395
* ECS010.cbl
 20726 4670-CALC-EP.
 20727
 20728     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 20729         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 20730         ADD W-EARNED-PREMIUM    TO W-WY-EP
 20731         GO TO 4670-EXIT.
 20732
 20733     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 20734         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 20735         ADD W-EARNED-PREMIUM    TO W-VA-EP
 20736         GO TO 4670-EXIT.
 20737
 20738***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 20739
 20740     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 20741         COMPUTE W-EARNED-PREMIUM
 20742             = (W-OPT-PRO + W-OPT-R78) / +2
 20743         ADD W-EARNED-PREMIUM    TO W-M-EP
 20744     ELSE
 20745         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 20746             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 20747             ADD W-EARNED-PREMIUM
 20748                                 TO W-R-EP
 20749         ELSE
 20750             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 20751                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 20752                 ADD W-EARNED-PREMIUM
 20753                                 TO W-P-EP
 20754             ELSE
 20755                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 20756                     COMPUTE W-EARNED-PREMIUM ROUNDED
 20757                         = (W-OPT-PRO * +.6667)
 20758                         + (W-OPT-R78 * +.3333)
 20759                     ADD W-EARNED-PREMIUM
 20760                                 TO W-1-EP
 20761                 ELSE
 20762                     ADD +1      TO W-OTHERS-COUNT
 20763                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 20764
 20765 4670-EXIT.
 20766     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 396
* ECS010.cbl
 20768 4680-CALC-REMAINING-AMT-LF.
 20769
 20770     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 20771     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 20772     MOVE CR-APR                 TO CP-LOAN-APR.
 20773     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 20774
 20775     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 20776         MOVE +1                 TO CR-PMT-FREQ.
 20777
 20778     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 20779
 20780     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 20781     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 20782                                    CP-RATING-BENEFIT-AMT.
 20783     IF CP-STATE-STD-ABBRV = 'OR'
 20784         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 20785     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 20786     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 20787     MOVE ZEROS                  TO CP-REMAINING-AMT
 20788                                    CP-REMAINING-AMT-PRV
 20789                                    CP-RETURN-CODE
 20790                                    CP-RETURN-CODE-2.
 20791
 20792     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 20793     IF (DTE-CLIENT = 'DCC')
 20794        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 20795        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 20796           ((CR-STATE = DD-STATE (D1))
 20797           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 20798           AND ('A'           = DD-BEN-TYPE   (D1))
 20799           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 20800           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 20801                           OR
 20802           D1 > max-pdef
 20803        END-PERFORM
 20804        IF D1 <= max-pdef
 20805           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 20806              (P1 > +8)
 20807              OR (DD-PROD-CODE (D1 P1) = 'L')
 20808           END-PERFORM
 20809           IF P1 < +9
 20810              MOVE DD-MAX-BEN-AMT (D1 P1)
 20811                                 TO CP-R-MAX-TOT-BEN
 20812           END-IF
 20813        END-IF
 20814     END-IF
 20815
 20816     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 20817
 20818     IF  CP-RETURN-CODE NOT = ZERO
 20819         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 20820                             TO WS-ABEND-MESSAGE
 20821         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 20822         MOVE 2001           TO WS-ABEND-CODE
 20823         GO TO ABEND-PGM.
 20824
 20825 4680-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 397
* ECS010.cbl
 20826     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 398
* ECS010.cbl
 20828******************************************************************
 20829***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 20830******************************************************************
 20831
 20832 4700-CALC-OPT-IBNR.
 20833
 20834     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 20835     MOVE SPACE                  TO W-UNDERWRITING-SW.
 20836
 20837     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20838             VARYING
 20839         SUB2 FROM +1 BY +1
 20840             UNTIL
 20841*        SUB2 GREATER THAN 300.
 20842*        SUB2 GREATER THAN 220.
 20843         SUB2 GREATER THAN 900.
 20844
 20845     MOVE EPEC-UNDW-OPT-DATA-TABLE
 20846                                 TO EPEC-OPT-WORK-TABLE.
 20847     MOVE '*'                    TO W-UNDERWRITING-SW.
 20848
 20849     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20850             VARYING
 20851         SUB2 FROM +1 BY +1
 20852             UNTIL
 20853*        SUB2 GREATER THAN 300.
 20854*        SUB2 GREATER THAN 220.
 20855         SUB2 GREATER THAN 900.
 20856
 20857 4700-EXIT.
 20858     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 399
* ECS010.cbl
 20860 4710-PROCESS-THRU-EPEC-TABLE.
 20861
 20862     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 20863         GO TO 4710-EXIT.
 20864
 20865     IF  W-UNDERWRITTEN-DATA
 20866         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 20867     ELSE
 20868         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 20869
 20870     IF EW-LEVEL-USED NOT = 'Y'
 20871         GO TO 4710-EXIT.
 20872
 20873     IF  EW-REIN-CO GREATER THAN SPACES
 20874         MOVE 'Y'                TO W-REIN-PROCESS-SW
 20875         IF  EPEC-REIN-ONLY-DATA (SUB2)
 20876             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 20877             IF  W-WK-IBNR GREATER THAN ZEROS
 20878                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20879                 GO TO 4710-EXIT
 20880             ELSE
 20881                 GO TO 4710-EXIT
 20882         ELSE
 20883             IF  EW-CLM-IBNR GREATER THAN ZEROS
 20884                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20885                 GO TO 4710-EXIT
 20886             ELSE
 20887                 GO TO 4710-EXIT.
 20888
 20889     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 20890
 20891     IF  EW-LF-AH EQUAL 'L'
 20892         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 20893             GO TO 4710-EXIT
 20894         ELSE
 20895             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 20896             ADD W-WK-IBNR       TO W-LIFE-IBNR
 20897     ELSE
 20898         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 20899                 GREATER THAN ZEROS
 20900             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 20901             ADD W-WK-IBNR       TO W-AH-IBNR
 20902         ELSE
 20903             GO TO 4710-EXIT.
 20904
 20905     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 20906     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 20907     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 20908
 20909     IF  W-UNDERWRITTEN-DATA
 20910         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 20911     ELSE
 20912         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 20913
 20914
 20915     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20916     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 20917
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 400
* ECS010.cbl
 20918 4710-EXIT.
 20919     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 401
* ECS010.cbl
 20921 4720-PROCESS-LIFE.
 20922
 20923     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 20924
 20925 4720-EXIT.
 20926     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 402
* ECS010.cbl
 20928 4730-PROCESS-A-H.
 20929
 20930     IF  AM-TARGET-LOSS-RATIO NUMERIC
 20931             AND
 20932         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 20933         MOVE AM-TARGET-LOSS-RATIO
 20934                                 TO W-TARGET-LOSS-RATIO
 20935     ELSE
 20936         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 20937             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 20938                                 TO W-TARGET-LOSS-RATIO
 20939             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 20940
 20941     IF  W-NOT-REIN-PROCESS
 20942         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 20943         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 20944
 20945     COMPUTE W-IBNR-1 ROUNDED
 20946         = EPEC-EARNED-PREMIUM-AH (SUB2)
 20947         * COMPANY-IBNR-AH-FACTOR
 20948         * W-TARGET-LOSS-RATIO.
 20949
 20950     COMPUTE W-IBNR-2 ROUNDED
 20951         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 20952         * W-TARGET-LOSS-RATIO)
 20953         - EPEC-CLAIMS-MADE-PAID (SUB2).
 20954
 20955     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 20956         MOVE W-IBNR-1           TO W-WK-IBNR
 20957         IF  W-NOT-REIN-PROCESS
 20958             ADD +1              TO W-AH-IBNR-1-CNT
 20959             ADD W-IBNR-1        TO W-AH-IBNR-1
 20960         ELSE
 20961             NEXT SENTENCE
 20962     ELSE
 20963         MOVE W-IBNR-2           TO W-WK-IBNR
 20964         IF  W-NOT-REIN-PROCESS
 20965             ADD +1              TO W-AH-IBNR-2-CNT
 20966             ADD W-IBNR-2        TO W-AH-IBNR-2.
 20967
 20968 4730-EXIT.
 20969     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 403
* ECS010.cbl
 20971 4735-GET-BUSINESS-ADJUSTMENT.
 20972
 20973     IF  CR-GRPTYP NOT NUMERIC
 20974         MOVE '99'               TO INDEXBS
 20975     ELSE
 20976         MOVE CR-GRPTYP          TO INDEXBS.
 20977
 20978     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 20979             AND
 20980         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 20981             NOT EQUAL ZEROS
 20982             AND
 20983         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 20984             NOT EQUAL +1.0000
 20985         MOVE INDEXBS           TO W-EDIT-7
 20986         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 20987             = W-TARGET-LOSS-RATIO
 20988             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 20989
 20990 4735-EXIT.
 20991     EXIT.
 20992
 20993 4740-CREATE-DETAIL-EXTR.
 20994
 20995     IF DTE-PGM-OPT NOT = '1'
 20996         GO TO 4740-EXIT.
 20997
 20998     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 20999         GO TO 4740-EXIT.
 21000
 21001     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 21002     MOVE ZEROS                  TO REPORTED-DATE
 21003                                    PAY-TO-DATE.
 21004
 21005     MOVE SPACES                 TO TR-DTL2.
 21006     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 21007
 21008     MOVE EOM-YR                 TO TRD-ISYR.
 21009     MOVE EOM-MO                 TO TRD-ISMO.
 21010     MOVE EOM-DA                 TO TRD-ISDA.
 21011     MOVE ZERO                   TO TRD-AGE.
 21012
 21013     IF  EW-LF-AH EQUAL 'L'
 21014         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 21015     ELSE
 21016         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 21017
 21018     MOVE SPACES                 TO TRD-PAYCURX
 21019                                    TRD-PAYCUR-SPACE
 21020                                    TRD-FUTRSV-SPACE
 21021                                    TRD-FUTRSVX.
 21022
 21023     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 21024     MOVE 'IBNR'                 TO TRD-IBNRX.
 21025     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 21026     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 21027
 21028     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 404
* ECS010.cbl
 21029         IF  W-REIN-IN-PROCESS
 21030             MOVE ' ACCT/BEN REIN RSV UW'
 21031                                 TO TRD-RSV-ACTION
 21032         ELSE
 21033             MOVE ' ACCT/BEN RESERVES UW'
 21034                                 TO TRD-RSV-ACTION
 21035     ELSE
 21036         IF  W-REIN-IN-PROCESS
 21037             MOVE ' ACCT/BEN REIN RSV'
 21038                                 TO TRD-RSV-ACTION
 21039         ELSE
 21040             MOVE ' ACCT/BEN RESERVES'
 21041                                 TO TRD-RSV-ACTION.
 21042
 21043     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 21044
 21045     MOVE SPACES                 TO DETAIL-EXTRACT.
 21046
 21047     IF  W-REIN-IN-PROCESS
 21048         MOVE EW-REIN-CO         TO DE-REI-COMP
 21049         MOVE 'R'                TO DE-REIN
 21050         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 21051         MOVE ZEROS              TO DE-IBNR
 21052     ELSE
 21053         MOVE EW-CLM-IBNR        TO DE-IBNR
 21054         MOVE ZEROS              TO DE-REI-IBNR.
 21055
 21056     MOVE 'DE'                   TO DE-RECORD-ID.
 21057     MOVE 'Y'                    TO DE-TRANS.
 21058     MOVE 'IBNRRSV'              TO DE-CLMNO.
 21059     MOVE '1'                    TO DE-ENTRY-STATUS.
 21060     MOVE 'ACTBENIBNR'           TO DE-CERT.
 21061
 21062     MOVE EOM-RUN-DATE           TO DE-EFF
 21063                                    WS-DE-EFF-N
 21064                                    DE-ENTRY-DTE
 21065                                    WS-DE-ENTRY-DTE-N.
 21066     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 21067                                    WS-DE-RSV-INCUR-N.
 21068
 21069     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 21070     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 21071     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 21072                                    WS-DE-ACC-EXP-DTE-RSV-N.
 21073     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 21074                                    WS-DE-ACC-EFF-DTE-RSV-N.
 21075
 21076     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 21077     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 21078     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 21079     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 21080     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 21081*    MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 21082     MOVE AM-IG                  TO DE-IG.
 21083
 21084     IF W-UNDERWRITTEN-DATA
 21085         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 21086     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 405
* ECS010.cbl
 21087         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 21088
 21089     IF  EW-LF-AH EQUAL 'L'
 21090         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 21091         MOVE '1'                TO DE-RESERVE-TYPE
 21092         MOVE ZEROS              TO DE-AH-TYPE
 21093     ELSE
 21094         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 21095         MOVE '2'                TO DE-RESERVE-TYPE
 21096         MOVE ZEROS              TO DE-LF-TYPE.
 21097
 21098     MOVE SPACES                 TO DE-NAME
 21099                                    DE-ACC-GPCD
 21100                                    DE-AH-STAT-CDE
 21101                                    DE-LF-STAT-CDE
 21102                                    DE-MEMBER-NO
 21103                                    DE-NAME
 21104                                    DE-SEX.
 21105     MOVE ZEROS                  TO DE-AGE
 21106                                    DE-AH-BEN
 21107                                    DE-AH-CANC-DTE
 21108                                    WS-DE-AH-CANC-DTE-N
 21109                                    DE-AH-CANC-EXIT-DT
 21110                                    WS-DE-AH-CANC-EXIT-DT-N
 21111                                    DE-AH-PRM
 21112                                    DE-AH-RFND
 21113                                    DE-AH-TERM
 21114                                    DE-APR
 21115                                    DE-CANCEL-CNT-ITD
 21116                                    DE-CANCEL-CNT-YTD
 21117                                    DE-FUTRSV
 21118                                    DE-LF-BEN
 21119                                    DE-LF-BEN-ALT
 21120                                    DE-LF-CANC-DTE
 21121                                    WS-DE-LF-CANC-DTE-N
 21122                                    DE-LF-CANC-EXIT-DT
 21123                                    WS-DE-LF-CANC-EXIT-DT-N
 21124                                    DE-LF-CNBEN
 21125                                    DE-LF-CNBEN-ALT
 21126                                    DE-LF-PRM
 21127                                    DE-LF-PRM-ALT
 21128                                    DE-LF-RFND
 21129                                    DE-LF-TERM
 21130                                    DE-LOAN-TERM
 21131                                    DE-LIVES
 21132                                    DE-PAYCUR
 21133                                    DE-PMT-FREQ
 21134                                    DE-REI-AHAMT
 21135                                    DE-REI-AHPRM
 21136                                    DE-REI-AHRFND
 21137                                    DE-REI-CNAMT
 21138                                    DE-REI-FUTRSV
 21139                                    DE-REI-LFAMT
 21140                                    DE-REI-LFPRM
 21141                                    DE-REI-LFRFND
 21142                                    DE-REI-PAYCUR
 21143                                    DE-RSV-REPORTED
 21144                                    DE-RSV-PAYTO
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 406
* ECS010.cbl
 21145                                    WS-DE-RSV-PAYTO-N
 21146                                    DE-MOB-NET-TOT-FEES
 21147                                    DE-SOC-SEC-NO.
 21148
 21149     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 21150
 21151     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 21152         THRU 2599-WRT-DETAIL-X.
 21153     ADD +1                      TO BC-G-CRS.
 21154
 21155 4740-EXIT.
 21156     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 407
* ECS010.cbl
 21158 4750-UPDATE-REIN.
 21159
 21160     COMPUTE SUB3 = SUB2 + 1.
 21161
 21162     IF  W-UNDERWRITTEN-DATA
 21163         MOVE EPEC-SUB-KEY-II (SUB2)
 21164                                 TO W-SUB-KEY
 21165     ELSE
 21166         MOVE EPEC-SUB-KEY (SUB2)
 21167                                 TO W-SUB-KEY.
 21168
 21169     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 21170             VARYING
 21171         SUB3 FROM SUB3 BY +1
 21172             UNTIL
 21173         SUB3 GREATER THAN +900
 21174*        SUB3 GREATER THAN +220
 21175*        SUB3 GREATER THAN +300
 21176             OR
 21177         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 21178
 21179 4750-EXIT.
 21180     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 408
* ECS010.cbl
 21182 4755-MATCH-REIN-EPEC.
 21183
 21184     IF  W-UNDERWRITTEN-DATA
 21185         MOVE EPEC-LEVELS-II (SUB3)
 21186                                 TO EPEC-WORK
 21187     ELSE
 21188         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 21189
 21190     IF  EPEC-LINE-NOT-USED (SUB3)
 21191         GO TO 4755-EXIT.
 21192
 21193     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 21194             OR
 21195         EW-REIN-CO EQUAL SPACES
 21196         GO TO 4755-EXIT.
 21197
 21198     IF  W-ISS-BEN GREATER THAN ZEROS
 21199         IF  EPEC-REIN-ONLY-DATA (SUB3)
 21200             COMPUTE W-FACTOR ROUNDED
 21201                 = (EW-ISS-BEN
 21202                 - EPEC-REIN-ISS-BEN (SUB3))
 21203                 / W-ISS-BEN
 21204         ELSE
 21205             COMPUTE W-FACTOR ROUNDED
 21206                 = EW-ISS-BEN
 21207                 / W-ISS-BEN.
 21208
 21209     COMPUTE EW-CLM-IBNR ROUNDED
 21210         = EW-CLM-IBNR
 21211         + (W-WK-IBNR * W-FACTOR).
 21212
 21213     IF  W-UNDERWRITTEN-DATA
 21214         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 21215     ELSE
 21216         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 21217
 21218 4755-EXIT.
 21219     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 409
* ECS010.cbl
 21221 4760-PROCESS-REIN-ONLY.
 21222
 21223     MOVE ZEROS                  TO W-WK-IBNR.
 21224
 21225     IF  EPEC-LINE-NOT-USED (SUB2)
 21226         GO TO 4760-EXIT.
 21227
 21228     IF  EW-LF-AH EQUAL 'L'
 21229         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 21230             GO TO 4760-EXIT
 21231         ELSE
 21232             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 21233             ADD W-WK-IBNR       TO EW-CLM-IBNR
 21234     ELSE
 21235         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 21236             GO TO 4760-EXIT
 21237         ELSE
 21238             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 21239             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 21240
 21241 4760-EXIT.
 21242     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 410
* ECS010.cbl
 21244 4770-CREATE-REIN-DETAIL.
 21245
 21246     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 21247     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 21248
 21249 4770-EXIT.
 21250     EXIT.
 21251
 21252 4799-EXIT.
 21253     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 411
* ECS010.cbl
 21255 4800-CALC-EARNED-PREMIUM-AH.
 21256
 21257     MOVE +0                         TO CNC-BEN  EPR-R78
 21258                                        ISS-PRM  EPR-PRO
 21259                                        CNC-PRM  EPR-ST
 21260                                        WX-CLM-AMT
 21261                                        WX-CLM-EXP
 21262                                        WX-CLM-CNT
 21263                                        WX-CLM-CRT
 21264                                        WX-CNC-CNT
 21265                                        ISS-PRMTAX
 21266                                        WX-ACTIVE-COUNT.
 21267     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 21268
 21269     MOVE WE-AHPRM TO ISS-PRM.
 21270
 21271     IF DTE-CLIENT = 'GIC'
 21272         IF REIN-EP-FLG NOT = 'R'  AND
 21273            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 21274            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 21275            MOVE CR-AHPRM-CALC TO ISS-PRM.
 21276
 21277     IF REIN-EP-FLG = 'R'  AND
 21278        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 21279         NEXT SENTENCE
 21280     ELSE
 21281         GO TO 4810-EP-DO-AH-CLM.
 21282
 21283     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 21284         IF WE-DSPY-AMT NOT = +0
 21285             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21286             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21287             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21288             ADD +1             TO WX-CLM-CNT.
 21289
 21290     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21291         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 21292             GO TO 4830-EP-DO-AH-EP.
 21293
 21294     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 21295         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 21296             GO TO 4830-EP-DO-AH-EP.
 21297
 21298     GO TO 4815-EP-DO-AH-CLM-EPR.
 21299
 21300 4810-EP-DO-AH-CLM.
 21301
 21302     IF WE-DSPY-AMT NOT = +0
 21303         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21304         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21305         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21306         ADD +1             TO WX-CLM-CNT.
 21307
 21308 4815-EP-DO-AH-CLM-EPR.
 21309
 21310     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21311         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 21312
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 412
* ECS010.cbl
 21313 4820-EP-DO-AH-CNCL.
 21314
 21315     IF CR-AH-STATUS-AT-CANCEL = ' '
 21316         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 21317            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21318             GO TO 4899-EXIT
 21319         ELSE
 21320             GO TO 4830-EP-DO-AH-EP.
 21321
 21322     IF (DTE-CLIENT = 'DCC')
 21323        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21324        IF CR-AHRFND NOT = ZEROS
 21325           ADD +1                TO WX-CNC-CNT
 21326        END-IF
 21327     ELSE
 21328        ADD +1                   TO WX-CNC-CNT
 21329     END-IF
 21330
 21331     MOVE WE-AHRFND TO CNC-PRM.
 21332
 21333*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 21334*    MOVE 'L'                   TO  DC-OPTION-CODE.
 21335*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21336*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 21337
 21338     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 21339     MOVE 'L'                   TO  DC-OPTION-CODE.
 21340     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21341     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 21342
 21343     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 21344     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 21345     MOVE '1'                     TO  DC-OPTION-CODE.
 21346     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 21347     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 21348                                      DC-ODD-DAYS-OVER
 21349                                      DC-ELAPSED-DAYS.
 21350     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21351     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 21352
 21353     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 21354         ADD  +1                  TO  MONTHS-DIFF-AH.
 21355
 21356     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21357                                      WS-DCC-DDF-CB-LEVELS
 21358
 21359     if (dte-client = 'AHL')
 21360        and (cr-ah-cancel-exit-date < 20120401)
 21361        go to 4820-continue-ah-cancel
 21362     end-if
 21363
 21364     IF DTE-CLIENT = 'ACE'
 21365         GO TO 4820-CONTINUE-AH-CANCEL.
 21366
 21367     MOVE  ZEROS                  TO  SUB.
 21368
 21369 4820-AH-CHARGEBACK-LOOP.
 21370
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 413
* ECS010.cbl
 21371     ADD    +1                    TO  SUB.
 21372
 21373     IF  SUB  GREATER THAN  +10
 21374         GO TO  4820-CONTINUE-AH-CANCEL.
 21375
 21376     IF CR-CANCEL-REASON = 'R'
 21377        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 21378           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 21379              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 21380              GO TO  4820-AH-CHARGEBACK-LOOP
 21381           END-IF
 21382           IF AM-COM-TYP (SUB) = 'J'
 21383              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 21384              GO TO  4820-AH-CHARGEBACK-LOOP
 21385           END-IF
 21386        END-IF
 21387     END-IF
 21388
 21389     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 21390         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 21391         GO TO  4820-AH-CHARGEBACK-LOOP.
 21392
 21393     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 21394         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 21395
 21396     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 21397         OR (CR-AHRFND = ZEROS)
 21398         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 21399     END-IF
 21400
 21401     GO TO  4820-AH-CHARGEBACK-LOOP.
 21402
 21403
 21404 4820-CONTINUE-AH-CANCEL.
 21405
 21406     IF DTE-CLIENT = 'GIC'
 21407         IF REIN-EP-FLG NOT = 'R'  AND
 21408            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21409            MOVE CR-AHRFND-CALC TO CNC-PRM.
 21410
 21411     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 21412     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 21413
 21414     IF CR-AH-LUMP-SUM-DISAB
 21415         GO TO 4899-EXIT.
 21416
 21417     MOVE WE-AHAMT TO CNC-BEN.
 21418
 21419     GO TO 4899-EXIT.
 21420
 21421 4825-EP-DO-AH-CNCL-SUM.
 21422
 21423     IF WE-DSPY-AMT NOT = +0
 21424         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21425         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21426         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21427         ADD +1             TO WX-CLM-CNT.
 21428
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 414
* ECS010.cbl
 21429     IF WE-AHRFND = ZERO
 21430        GO TO 4830-EP-DO-AH-EP.
 21431
 21432     MOVE WE-AHRFND TO CNC-PRM.
 21433
 21434     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 21435
 21436     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21437                                      WS-DCC-DDF-CB-LEVELS
 21438
 21439     IF WE-AHRFND NOT LESS WE-AHPRM
 21440         MOVE WE-AHAMT TO CNC-BEN
 21441          GO TO 4830-EP-DO-AH-EP.
 21442
 21443     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 21444     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 21445     MOVE TEMP-7 TO CNC-BEN.
 21446
 21447 4830-EP-DO-AH-EP.
 21448
 21449     MOVE EOM-RUN-DATE TO VALUATION-DT.
 21450     MOVE '8'           TO W-VAL-SOURCE.
 21451
 21452     IF REIN-EP-FLG = 'R'
 21453       IF REIN-REM-SW (SUB5) = 'I'
 21454           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 21455           GO TO 4899-EXIT.
 21456
 21457     IF REIN-EP-FLG = 'R'
 21458         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 21459            EARNING-STOP-DATE LESS THAN VALUATION-DT
 21460             MOVE '*'               TO A-H-EARNED-SWITCH
 21461             MOVE EARNING-STOP-DATE TO VALUATION-DT
 21462             MOVE '10'              TO W-VAL-SOURCE.
 21463
 21464     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 21465
 21466     IF REM-TRM2 GREATER CR-AH-TERM
 21467         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21468         GO TO 4899-EXIT.
 21469
 21470     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 21471         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 21472*
 21473 4835-CHECK-OB-AH-NCL.
 21474
 21475     IF (DTE-CLIENT EQUAL 'NCL') AND
 21476        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 21477           MOVE WE-AHPRM         TO EPR-R78
 21478                                    EPR-PRO
 21479                                    EPR-ST
 21480        IF (CR-CCYY EQUAL EOM-CCYY) AND
 21481           (CR-MO EQUAL EOM-MO)
 21482           MOVE '*'            TO OB-DATE-1-SWITCH
 21483           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21484           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21485           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21486           COMPUTE WS-EPR-R78 (SUB3 1) =
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 415
* ECS010.cbl
 21487                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 21488           GO TO 4899-EXIT
 21489        ELSE
 21490        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 21491           (CR-MO EQUAL OB-MO (1))
 21492           MOVE '*'            TO OB-DATE-2-SWITCH
 21493           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21494           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21495           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21496           COMPUTE WS-EPR-R78 (SUB3 2) =
 21497                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 21498           GO TO 4899-EXIT
 21499        ELSE
 21500        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 21501           (CR-MO EQUAL OB-MO (2))
 21502           MOVE '*'            TO OB-DATE-3-SWITCH
 21503           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21504           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21505           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21506           COMPUTE WS-EPR-R78 (SUB3 3) =
 21507                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 21508           GO TO 4899-EXIT
 21509        ELSE
 21510           GO TO 4899-EXIT.
 21511
 21512     IF REM-TRM2 NOT GREATER +0
 21513         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21514         GO TO 4899-EXIT.
 21515
 21516     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21517         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21518         GO TO 4899-EXIT.
 21519
 21520     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21521         MOVE +1 TO WX-ACTIVE-COUNT
 21522     ELSE
 21523         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 21524
 21525     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 21526     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 21527     IF DTE-R78 = '1'
 21528         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 21529     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 21530
 21531     IF DTE-CLIENT = 'MIC' OR 'MCC'
 21532         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 21533     ELSE
 21534         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 21535
 21536     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 21537     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21538
 21539     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 21540     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 21541
 21542     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 21543
 21544*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 416
* ECS010.cbl
 21545*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 21546
 21547     MOVE SPACES TO STATUTORY-SWITCH-AH.
 21548
 21549     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 21550        (CR-DT GREATER THAN  19921231)
 21551        AND (DTE-CLIENT NOT = 'DCC' AND 'AHL')
 21552         IF CR-AH-TERM GREATER THAN  +61
 21553             MOVE 'A' TO AH-EARN-METHOD
 21554             MOVE '*' TO STATUTORY-SWITCH-AH
 21555             GO TO 4845-EP-DO-AH-EP-AN
 21556         ELSE
 21557             GO TO 4860-EP-DO-AH-STATUTORY.
 21558
 21559     IF (AH-EARN-METHOD EQUAL 'N')
 21560                  OR
 21561        ((DTE-CLIENT = 'DCC')
 21562         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21563         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA)
 21564                                    NOT = 'G' AND 'D'))
 21565         GO TO 4840-EP-DO-AH-EP-NP
 21566     END-IF
 21567
 21568     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 21569         MOVE 'A' TO AH-EARN-METHOD
 21570         GO TO 4845-EP-DO-AH-EP-AN.
 21571
 21572     GO TO 4860-EP-DO-AH-STATUTORY.
 21573
 21574 4840-EP-DO-AH-EP-NP.
 21575
 21576     IF WE-AHPRM = ZERO
 21577         GO TO 4860-EP-DO-AH-STATUTORY.
 21578
 21579     IF CR-APR GREATER THAN +0
 21580         NEXT SENTENCE
 21581     ELSE
 21582         GO TO 4860-EP-DO-AH-STATUTORY.
 21583
 21584     IF DTE-CLIENT = 'NCL'
 21585       IF CR-DT LESS THAN 19910101
 21586           GO TO 4860-EP-DO-AH-STATUTORY.
 21587
 21588     IF REM-TRM1 = CR-AH-TERM
 21589         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21590         GO TO 4899-EXIT.
 21591
 21592     MOVE CR-APR TO NP-APR.
 21593     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 21594     MOVE REM-TRM1 TO NP-REM.
 21595     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 21596     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 21597         MOVE CR-LOAN-TERM TO NP-ORIG.
 21598
 21599     IF (DTE-CLIENT = 'DCC')
 21600        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21601        MOVE 'S'                 TO NP-OPT
 21602     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 417
* ECS010.cbl
 21603        MOVE 'R'                 TO NP-OPT
 21604     END-IF
 21605
 21606
 21607*    MOVE 'R' TO NP-OPT.
 21608     CALL 'ECSNETRM'
 21609         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 21610
 21611     IF (DTE-CLIENT = 'DCC')
 21612        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21613        COMPUTE EPR-ST ROUNDED =
 21614           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21615        GO TO 4899-EXIT
 21616     ELSE
 21617        COMPUTE EPR-R78 ROUNDED =
 21618           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21619     END-IF
 21620
 21621     GO TO 4860-EP-DO-AH-STATUTORY.
 21622
 21623 4845-EP-DO-AH-EP-AN.
 21624     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21625     MOVE 'L'                        TO DC-OPTION-CODE.
 21626     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21627     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21628     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21629     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21630     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21631     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21632     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21633     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21634     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21635     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21636                                        CP-RATING-BENEFIT-AMT.
 21637     IF CP-STATE-STD-ABBRV = 'OR'
 21638         COMPUTE CP-RATING-BENEFIT-AMT =
 21639                                  CR-AHAMT * REM-TRM1.
 21640     MOVE CR-APR                     TO CP-LOAN-APR.
 21641     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21642     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 21643     MOVE '3'                        TO CP-PROCESS-TYPE.
 21644     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21645     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21646     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21647         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21648     ELSE
 21649         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21650     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21651     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21652     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21653     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21654     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21655     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21656
 21657     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21658
 21659     IF CP-ERROR-RATE-NOT-FOUND  OR
 21660        CP-ERROR-RATE-IS-ZERO  OR
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 418
* ECS010.cbl
 21661        CP-ERROR-IN-DATES
 21662         GO TO 4860-EP-DO-AH-STATUTORY.
 21663
 21664     COMPUTE EPR-R78 ROUNDED =
 21665             (REM-TRM1 * WE-AHAMT / +100 *
 21666               CP-PREMIUM-RATE)
 21667              / CR-AHPRM-CALC * CR-AHPRM
 21668
 21669     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21670
 21671     IF STATUTORY-REQUIREMENT-AH
 21672         MOVE EPR-R78                TO EPR-ST
 21673         GO TO 4899-EXIT.
 21674
 21675 4860-EP-DO-AH-STATUTORY.
 21676     IF (DTE-CLIENT EQUAL 'CID') AND
 21677        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 21678         GO TO 4867-EP-DO-AH-STAT-ROA
 21679     END-IF.
 21680
 21681 4860-EP-DO-AH-STATUTORY-VA.
 21682
 21683     IF (DTE-CLIENT = 'DCC')
 21684        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21685        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21686        AND (CLAS-I-BEN (CLAS-INDEXA) NOT = '55' AND '56')
 21687        MOVE EPR-R78             TO EPR-ST
 21688        GO TO 4899-EXIT
 21689     END-IF
 21690
 21691     IF (DTE-CLIENT = 'DCC')
 21692        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21693        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21694        AND (CLAS-I-BEN (CLAS-INDEXA) = '55' OR '56')
 21695        MOVE +1.0000                TO TEMP-6
 21696        IF REM-TRM1 < +9
 21697           COMPUTE TEMP-6 =
 21698              ((9 - (9 - REM-TRM1)) - 1)
 21699              * +.125
 21700        END-IF
 21701        COMPUTE EPR-ST ROUNDED = WE-AHPRM - (WE-AHPRM * TEMP-6)
 21702        MOVE EPR-ST              TO EPR-R78
 21703                                    EPR-PRO
 21704        GO TO 4899-EXIT
 21705     END-IF
 21706
 21707     MOVE EPR-R78                    TO EPR-ST.
 21708
 21709***  WE WANT R78 IN AH STAT FOR AHL
 21710
 21711     IF DTE-CLIENT = 'AHL'
 21712        GO TO 4899-EXIT
 21713     END-IF
 21714
 21715     MOVE +0                         TO SUB1.
 21716
 21717 4865-EP-AH-STAT-LOOP.
 21718     ADD +1 TO SUB1.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 419
* ECS010.cbl
 21719
 21720     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 21721         MOVE EPR-PRO                TO EPR-ST
 21722     ELSE
 21723         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 21724             GO TO 4865-EP-AH-STAT-LOOP.
 21725
 21726     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 21727         CR-DT GREATER THAN 19831031)  OR
 21728
 21729        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 21730         CR-DT GREATER THAN 19820629)  OR
 21731
 21732        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 21733         CR-DT GREATER THAN 19830831)  OR
 21734
 21735        (STATE-ABBR (CLAS-INDEXS) = 'MN'  AND
 21736         CR-DT GREATER THAN 20091231)
 21737
 21738         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21739
 21740     IF DTE-CLIENT = 'CSO'  OR  'CID'
 21741       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 21742         IF CR-DT LESS THAN 19970101
 21743             MOVE EPR-R78            TO EPR-ST
 21744         ELSE
 21745             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21746
 21747     IF DTE-CLIENT = 'DCC'
 21748        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 21749           MOVE EPR-PRO          TO EPR-ST
 21750        ELSE
 21751           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 21752        END-IF
 21753     END-IF
 21754
 21755     IF (DTE-CLIENT = 'DCC')
 21756        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 21757        CONTINUE
 21758     ELSE
 21759        GO TO 4899-EXIT
 21760     END-IF
 21761
 21762*    MOVE ' '                    TO DD-IU-SW
 21763
 21764     MOVE +0                     TO WS-DDF-ADMIN-FEES
 21765                                    WS-DDF-CSO-ADMIN-FEE
 21766                                    WS-DDF-1ST-YR-TOT-EXP
 21767                                    WS-COMM-AND-MFEE
 21768
 21769     PERFORM VARYING D1 FROM +2 BY +1 UNTIL
 21770        D1 > +10
 21771        IF (CR-AGT-TYPE (D1) = 'L' OR 'N')
 21772           AND (CR-LCOM-AH (D1) NUMERIC)
 21773           COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
 21774              + (CR-LCOM-AH (D1) * +1000)
 21775        END-IF
 21776        IF (CR-AGT-TYPE (D1) = 'N')
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 420
* ECS010.cbl
 21777           AND (CR-LCOM-AH (D1) NUMERIC)
 21778           COMPUTE WS-DDF-CSO-ADMIN-FEE = WS-DDF-CSO-ADMIN-FEE
 21779              + (CR-LCOM-AH (D1) * +1000)
 21780        END-IF
 21781        IF (CR-AGT-TYPE (D1) = 'I' )
 21782           AND (CR-LCOM-AH (D1) NUMERIC)
 21783           COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 21784              + (CR-LCOM-AH (D1) * +1000)
 21785        END-IF
 21786        IF (CR-AGT-TYPE (D1) = 'J' OR 'L')
 21787           AND (CR-LCOM-AH (D1) NUMERIC)
 21788           COMPUTE WS-DDF-1ST-YR-TOT-EXP = WS-DDF-1ST-YR-TOT-EXP
 21789              + (CR-LCOM-AH (D1) * +1000)
 21790        END-IF
 21791     END-PERFORM
 21792
 21793     MOVE WS-DDF-ADMIN-FEES      TO CP-DDF-ADMIN-FEES
 21794     MOVE WS-DDF-CSO-ADMIN-FEE   TO CP-DDF-CSO-ADMIN-FEE
 21795
 21796     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 21797                                 THRU 4910-EXIT
 21798
 21799     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21800        + WS-DDF-1ST-YR-TOT-EXP
 21801
 21802     COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 21803        (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 21804     MOVE WS-LO-UEF              TO CP-DDF-LO-FACT
 21805     MOVE WS-HI-UEF              TO CP-DDF-HI-FACT
 21806
 21807     MOVE 'D'                    TO CP-EARNING-METHOD
 21808     MOVE 'G'                    TO CP-DDF-SPEC-CALC
 21809     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
 21810     MOVE CR-AH-CLP              TO CP-DDF-CLP
 21811     MOVE WS-COMM-AND-MFEE       TO CP-DDF-COMM-AND-MFEE
 21812     MOVE DD-1ST-YR-ALLOW (D1)   TO CP-DDF-YR1AF
 21813
 21814     IF REIN-EP-FLG = 'R'
 21815        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21816        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21817        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21818     END-IF
 21819
 21820     IF DD-IU-PRESENT
 21821        MOVE 'I'              TO CP-EARNING-METHOD
 21822     END-IF
 21823
 21824     MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21825                                 CP-CLP-RATE-UP
 21826
 21827
 21828     display ' cert no ' cr-cert-no
 21829     display ' rate up ' cp-iu-rate-up
 21830     display ' addl clp ' cr-addl-clp
 21831     display ' ah clp  ' cr-ah-clp
 21832     display ' orig prem ' cp-original-premium
 21833
 21834     IF (CP-CALC-GROSS-FEE)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 421
* ECS010.cbl
 21835        AND (CP-IU-RATE-UP NOT = ZEROS)
 21836        COMPUTE CP-IU-RATE-UP =
 21837           CP-IU-RATE-UP / (1 - ((CR-ADDL-CLP + CR-AH-CLP)
 21838           / CP-ORIGINAL-PREMIUM))
 21839     END-IF
 21840
 21841     display ' here 4 '
 21842     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 21843     MOVE REM-TRM1                   TO CP-REMAINING-TERM
 21844
 21845     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21846        + WS-DDF-1ST-YR-TOT-EXP
 21847
 21848     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 21849
 21850     COMPUTE EPR-ST = WE-AHPRM - CP-CALC-REFUND
 21851
 21852     IF CP-DDF-SPEC-CALC = 'C'
 21853        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21854     ELSE
 21855        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21856        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21857        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21858        MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21859        CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 21860        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21861     END-IF
 21862
 21863     display ' here 6 '
 21864     GO TO 4899-EXIT
 21865
 21866     .
 21867 4867-EP-DO-AH-STAT-ROA.
 21868     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21869     MOVE 'L'                        TO DC-OPTION-CODE.
 21870     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21871     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21872     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21873     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21874     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21875     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21876     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21877     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21878     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21879     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21880                                        CP-RATING-BENEFIT-AMT.
 21881     IF CP-STATE-STD-ABBRV = 'OR'
 21882         COMPUTE CP-RATING-BENEFIT-AMT =
 21883                                  CR-AHAMT * REM-TRM1.
 21884     MOVE CR-APR                     TO CP-LOAN-APR.
 21885     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21886     MOVE 'A'                        TO CP-EARNING-METHOD.
 21887     MOVE '3'                        TO CP-PROCESS-TYPE.
 21888     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21889     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21890     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21891         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21892     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 422
* ECS010.cbl
 21893         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21894     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21895     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21896     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21897     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21898     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21899     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21900
 21901     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21902
 21903     IF CP-ERROR-RATE-NOT-FOUND  OR
 21904        CP-ERROR-RATE-IS-ZERO  OR
 21905        CP-ERROR-IN-DATES
 21906         GO TO 4860-EP-DO-AH-STATUTORY-VA.
 21907
 21908     COMPUTE EPR-ST ROUNDED =
 21909             (REM-TRM1 * WE-AHAMT / +100 *
 21910               CP-PREMIUM-RATE)
 21911              / CR-AHPRM-CALC * CR-AHPRM
 21912
 21913     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 21914
 21915     GO TO 4899-EXIT.
 21916
 21917 4899-EXIT.
 21918     EXIT.
 21919******************************************************************
 21920***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 21921******************************************************************
 21922
 21923 4900-WRITE-SUMMARY-EXTRACTS.
 21924
 21925     IF DTE-CLIENT = 'HER'
 21926         IF EP-RECORD-ID = 'EC'  AND
 21927            EP-REINCO = 'LNL'
 21928             GO TO 4900-WRT-SUMMARY-X.
 21929
 21930     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 21931                                     WS-EP-RUN-DTE-N.
 21932
 21933     IF W-UNDERWRITTEN-DATA
 21934         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 21935     ELSE
 21936         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 21937
 21938     IF  DTE-OPT-RESERVE-METHOD-AUTH
 21939         IF VALID-EP-ID
 21940             MOVE 'Y'             TO EP-NEW-DATA-IND.
 21941
 21942     WRITE EP-RECORD.
 21943
 21944     ADD +1                       TO EP-CNT.
 21945
 21946 4900-WRT-SUMMARY-X.
 21947     EXIT.
 21948
 21949 4910-DCC-DFF-FACT-LOOKUP.
 21950
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 423
* ECS010.cbl
 21951     IF CR-CERT-NO = WS-FACT-CERT
 21952        go to 4910-exit
 21953     end-if
 21954
 21955     MOVE ' ' TO DD-IU-SW
 21956     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 21957        ((CR-STATE = DD-STATE (D1))
 21958        AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 21959        AND ('A'           = DD-BEN-TYPE   (D1))
 21960        AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 21961        AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 21962                        OR
 21963        D1 > max-pdef
 21964     END-PERFORM
 21965     IF D1 > max-pdef
 21966        DISPLAY ' COULD NOT FIND REFUND FACTORS '
 21967           CR-ACCOUNT ' ' CR-CERT-NO ' ' CR-AHTYP
 21968        GO TO 4910-EXIT
 21969     END-IF
 21970
 21971     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 21972        (P1 > +8)
 21973        OR (DD-PROD-CODE (D1 P1) = 'I')
 21974     END-PERFORM
 21975     IF P1 < +9
 21976        display ' setting iu present to true '
 21977        SET DD-IU-PRESENT        TO TRUE
 21978     END-IF
 21979
 21980     MOVE CR-AH-TERM             TO WS-DDF-TERM
 21981     IF (CR-LOAN-TERM > WS-DDF-TERM)
 21982        AND (DD-TRUNCATED (D1) = 'Y')
 21983        MOVE CR-LOAN-TERM        TO WS-DDF-TERM
 21984        DISPLAY ' FOUND TRUNCATED ' CR-CERT-NO
 21985     END-IF
 21986
 21987     EVALUATE TRUE
 21988        WHEN WS-DDF-TERM > +168
 21989           MOVE 15               TO P1
 21990        WHEN WS-DDF-TERM > +156
 21991           MOVE 14               TO P1
 21992        WHEN WS-DDF-TERM > +144
 21993           MOVE 13               TO P1
 21994        WHEN WS-DDF-TERM > +132
 21995           MOVE 12               TO P1
 21996        WHEN WS-DDF-TERM > +120
 21997           MOVE 11               TO P1
 21998        WHEN WS-DDF-TERM > +108
 21999           MOVE 10               TO P1
 22000        WHEN WS-DDF-TERM > +96
 22001           MOVE 9                TO P1
 22002        WHEN WS-DDF-TERM > +84
 22003           MOVE 8                TO P1
 22004        WHEN WS-DDF-TERM > +72
 22005           MOVE 7                TO P1
 22006        WHEN WS-DDF-TERM > +60
 22007           MOVE 6                TO P1
 22008        WHEN WS-DDF-TERM > +48
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 424
* ECS010.cbl
 22009           MOVE 5                TO P1
 22010        WHEN WS-DDF-TERM > +36
 22011           MOVE 4                TO P1
 22012        WHEN WS-DDF-TERM > +24
 22013           MOVE 3                TO P1
 22014        WHEN WS-DDF-TERM > +12
 22015           MOVE 2                TO P1
 22016        WHEN OTHER
 22017           MOVE 1                TO P1
 22018     END-EVALUATE
 22019
 22020     EVALUATE TRUE
 22021*       WHEN ((CR-AH-TERM - REM-TRM1) < +13)
 22022*          AND (DD-IU-PRESENT)
 22023*          MOVE 2                TO P2
 22024*       WHEN (CR-AH-TERM - REM-TRM1) < +13
 22025*          MOVE 1                TO P2
 22026        WHEN (CR-AH-TERM - REM-TRM1) < +25
 22027           MOVE 2                TO P2
 22028        WHEN (CR-AH-TERM - REM-TRM1) < +37
 22029           MOVE 3                TO P2
 22030        WHEN (CR-AH-TERM - REM-TRM1) < +49
 22031           MOVE 4                TO P2
 22032        WHEN (CR-AH-TERM - REM-TRM1) < +61
 22033           MOVE 5                TO P2
 22034        WHEN (CR-AH-TERM - REM-TRM1) < +73
 22035           MOVE 6                TO P2
 22036        WHEN (CR-AH-TERM - REM-TRM1) < +85
 22037           MOVE 7                TO P2
 22038        WHEN (CR-AH-TERM - REM-TRM1) < +97
 22039           MOVE 8                TO P2
 22040        WHEN (CR-AH-TERM - REM-TRM1) < +109
 22041           MOVE 9                TO P2
 22042        WHEN (CR-AH-TERM - REM-TRM1) < +121
 22043           MOVE 10               TO P2
 22044        WHEN (CR-AH-TERM - REM-TRM1) < +133
 22045           MOVE 11               TO P2
 22046        WHEN (CR-AH-TERM - REM-TRM1) < +145
 22047           MOVE 12               TO P2
 22048        WHEN (CR-AH-TERM - REM-TRM1) < +157
 22049           MOVE 13               TO P2
 22050        WHEN (CR-AH-TERM - REM-TRM1) < +169
 22051           MOVE 14               TO P2
 22052        WHEN OTHER
 22053           DISPLAY ' COULD BE TROUBLE ' CR-CERT-NO
 22054           MOVE 15               TO P2
 22055     END-EVALUATE
 22056
 22057     MOVE CR-CERT-NO             TO WS-FACT-CERT
 22058     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
 22059                                 TO WS-LO-UEF
 22060     MOVE DD-UEP-FACTOR (D1 P1 P2)
 22061                                 TO WS-HI-UEF
 22062
 22063     .
 22064 4910-EXIT.
 22065     EXIT.
 22066
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 425
* ECS010.cbl
 22067******************************************************************
 22068***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 22069******************************************************************
 22070
 22071 5000-DATE-RANGE-BREAK.
 22072
 22073     IF NO-TRANSACTION-WAS-PROCESSED
 22074         GO TO 5099-DATE-RANGE-BREAK-X.
 22075
 22076     ADD +1  TO RANGE-CNT.
 22077     MOVE +1 TO SUB6.
 22078     MOVE +2 TO SUB7.
 22079     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22080     IF LN-CNT GREATER +50
 22081         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22082                 8750-PRT-RANGE-HEADING.
 22083
 22084     MOVE SPACES                     TO PRT.
 22085     PERFORM 8800-PRINT-ROUTINE.
 22086     MOVE 'DATE RANGE'               TO TPH2-DESC.
 22087     MOVE '  TOTALS'                 TO TPH3-DESC.
 22088     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22089     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22090     PERFORM 5900-CLEAR-TOTAL-PAGES
 22091         THRU 5999-CLEAR-TOTAL-PAGES-X
 22092             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22093
 22094 5099-DATE-RANGE-BREAK-X.
 22095     EXIT.
 22096
 22097 5100-ACCOUNT-BREAK.
 22098
 22099     IF RANGE-CNT NOT = +0
 22100         PERFORM 5000-DATE-RANGE-BREAK
 22101             THRU 5099-DATE-RANGE-BREAK-X
 22102     ELSE
 22103         MOVE +1 TO SUB6
 22104         MOVE +2 TO SUB7
 22105         PERFORM 5800-ADD-PAGES-LEVELS
 22106             THRU 5899-ADD-PAGES-LEVELS-X
 22107         PERFORM 5900-CLEAR-TOTAL-PAGES
 22108             THRU 5999-CLEAR-TOTAL-PAGES-X
 22109                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22110
 22111     MOVE +0 TO RANGE-CNT.
 22112     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 22113         VARYING B-SUB FROM 1 BY 1
 22114             UNTIL B-SUB GREATER THAN 50  OR
 22115                   RB-COMPANY (B-SUB) = SPACES.
 22116     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 22117         VARYING B-SUB FROM 1 BY 1
 22118             UNTIL B-SUB GREATER THAN 50.
 22119
 22120     IF ACCT-FLG = SPACE
 22121         GO TO 5199-ACCOUNT-BREAK-X.
 22122
 22123     MOVE SPACE TO ACCT-FLG.
 22124     MOVE +2 TO SUB6.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 426
* ECS010.cbl
 22125     MOVE +3 TO SUB7.
 22126     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22127     IF LN-CNT GREATER +50
 22128         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22129                 8725-PRT-ACCT-HEADING.
 22130
 22131     MOVE SPACES                     TO PRT.
 22132     PERFORM 8800-PRINT-ROUTINE.
 22133     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 22134     MOVE ' TOTALS'                  TO TPH3-DESC.
 22135     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22136     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22137     PERFORM 5900-CLEAR-TOTAL-PAGES
 22138         THRU 5999-CLEAR-TOTAL-PAGES-X
 22139             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 22140
 22141 5199-ACCOUNT-BREAK-X.
 22142     EXIT.
 22143
 22144 5200-STATE-BREAK.
 22145
 22146     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 22147     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22148     MOVE +3 TO SUB6.
 22149     MOVE +4 TO SUB7.
 22150     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22151
 22152     IF STATE-FLG = SPACE
 22153         GO TO 5299-STATE-BREAK-X.
 22154
 22155     MOVE SPACE         TO STATE-FLG.
 22156     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22157     MOVE 'STATE'       TO TPH1-TYPE.
 22158     MOVE HLD-STATE     TO STATE-L.
 22159
 22160     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 22161
 22162     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 22163         MOVE SPACES          TO TPH1-DESC
 22164         MOVE HLD-STATE       TO TPH1-ST-CODE
 22165         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 22166     ELSE
 22167         MOVE SPACES TO TPH1-DESC
 22168         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 22169         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 22170
 22171     MOVE 'STATE'  TO TPH2-DESC.
 22172     MOVE 'TOTALS' TO TPH3-DESC.
 22173     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22174     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22175     PERFORM 5900-CLEAR-TOTAL-PAGES
 22176         THRU 5999-CLEAR-TOTAL-PAGES-X
 22177             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 22178
 22179 5299-STATE-BREAK-X.
 22180     EXIT.
 22181
 22182 5300-COMP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 427
* ECS010.cbl
 22183
 22184     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 22185     MOVE +4 TO SUB6.
 22186     MOVE +5 TO SUB7.
 22187     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22188
 22189     IF COMP-FLG = SPACE
 22190         GO TO 5399-COMP-BREAK-X.
 22191
 22192     MOVE ' ' TO COMP-FLG.
 22193     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22194     MOVE 'COMPANY'                   TO TPH1-TYPE.
 22195     MOVE HLD-GROUPING                TO TPH1-DESC.
 22196     MOVE 'COMPANY'                   TO TPH2-DESC.
 22197     MOVE ' TOTALS'                   TO TPH3-DESC.
 22198     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22199     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22200     PERFORM 5900-CLEAR-TOTAL-PAGES
 22201         THRU 5999-CLEAR-TOTAL-PAGES-X
 22202             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 22203
 22204 5399-COMP-BREAK-X.
 22205     EXIT.
 22206
 22207 5400-CARR-BREAK.
 22208
 22209     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 22210     MOVE +5 TO SUB6.
 22211     MOVE +6 TO SUB7.
 22212     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22213
 22214     IF CARR-FLG = SPACE
 22215         GO TO 5499-CARR-BREAK-X.
 22216
 22217     MOVE ' ' TO CARR-FLG.
 22218     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22219     MOVE 'CARRIER'               TO TPH1-TYPE.
 22220     MOVE HLD-CARRIER             TO TPH1-DESC.
 22221     MOVE 'CARRIER'               TO TPH2-DESC.
 22222     MOVE ' TOTALS'               TO TPH3-DESC.
 22223     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22224     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22225     PERFORM 5900-CLEAR-TOTAL-PAGES
 22226         THRU 5999-CLEAR-TOTAL-PAGES-X
 22227             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 22228
 22229 5499-CARR-BREAK-X.
 22230     EXIT.
 22231
 22232 5500-FINAL-BREAK.
 22233
 22234     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 22235
 22236     IF FINAL-FLG = SPACE
 22237         GO TO 5599-FINAL-BREAK-X.
 22238
 22239     IF DTE-FICH = '1'
 22240         MOVE '2'  TO  DTE-FICH.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 428
* ECS010.cbl
 22241     MOVE +6 TO SUB6.
 22242     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22243     MOVE SPACES   TO TPH1-TYPE.
 22244     MOVE SPACES   TO TPH1-DESC.
 22245     MOVE 'FINAL'  TO TPH2-DESC.
 22246     MOVE 'TOTALS' TO TPH3-DESC.
 22247     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22248     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22249
 22250 5599-FINAL-BREAK-X.
 22251     EXIT.
 22252
 22253 5800-ADD-PAGES-LEVELS.
 22254
 22255     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 22256     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 22257     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 22258     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 22259     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 22260     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 22261     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 22262     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 22263
 22264 5899-ADD-PAGES-LEVELS-X.
 22265     EXIT.
 22266
 22267 5900-CLEAR-TOTAL-PAGES.
 22268
 22269     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 22270             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 22271             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 22272             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 22273
 22274 5999-CLEAR-TOTAL-PAGES-X.
 22275     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 429
* ECS010.cbl
 22277******************************************************************
 22278***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 22279******************************************************************
 22280
 22281 6000-TOTAL-PAGE-HEADINGS.
 22282
 22283     MOVE TOTAL-PAGE-HD1 TO PRT.
 22284     PERFORM 8800-PRINT-ROUTINE.
 22285
 22286 6100-ACCT-TOTAL-HEADINGS.
 22287
 22288     MOVE TOTAL-PAGE-HD2 TO PRT.
 22289     MOVE '0' TO P-CTL.
 22290     PERFORM 8800-PRINT-ROUTINE.
 22291     MOVE TOTAL-PAGE-HD3 TO PRT.
 22292     MOVE ' ' TO P-CTL.
 22293     PERFORM 8800-PRINT-ROUTINE.
 22294     PERFORM 8800-PRINT-ROUTINE.
 22295     MOVE +81 TO LN-CNT.
 22296
 22297 6199-PAGE-HEADINGS-X.
 22298     EXIT.
 22299
 22300 6500-PRINT-TOTAL-PAGE.
 22301
 22302     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22303     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 22304     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22305
 22306     IF SUB6 = 6 AND ME-DO-UPDATE
 22307         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 22308
 22309     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22310
 22311     IF SUB6 = 6 AND ME-DO-UPDATE
 22312         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 22313
 22314     COMPUTE TPD-NET-PRM =
 22315         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 22316
 22317     IF SUB6 = 6 AND ME-DO-UPDATE
 22318         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 22319         GIVING ME-010-NET-L.
 22320
 22321     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22322
 22323     IF SUB6 = 6 AND ME-DO-UPDATE
 22324         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 22325
 22326     COMPUTE TPD-PREM-COMP =
 22327         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 22328                            - TPL-ACCT-COM (SUB6).
 22329     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22330
 22331     IF SUB6 = 6 AND ME-DO-UPDATE
 22332         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 22333
 22334     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 430
* ECS010.cbl
 22335         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 22336         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 22337         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22338     END-IF.
 22339
 22340     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22341     PERFORM 8800-PRINT-ROUTINE.
 22342     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22343     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 22344     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22345     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22346
 22347     IF SUB6 = 6 AND ME-DO-UPDATE
 22348         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 22349         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 22350
 22351     COMPUTE TPD-NET-PRM =
 22352         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22353
 22354     IF SUB6 = 6 AND ME-DO-UPDATE
 22355         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 22356         GIVING ME-010-NET-AH.
 22357
 22358     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22359
 22360     IF SUB6 = 6 AND ME-DO-UPDATE
 22361         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 22362
 22363     COMPUTE TPD-PREM-COMP =
 22364         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22365                            - TPA-ACCT-COM (SUB6).
 22366     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22367
 22368     IF SUB6 = 6 AND ME-DO-UPDATE
 22369         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 22370
 22371     IF SUB6 = 6
 22372         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 22373         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 22374         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22375     END-IF.
 22376
 22377     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22378     PERFORM 8800-PRINT-ROUTINE.
 22379
 22380     MOVE 'TOTAL' TO TPD-DESC.
 22381
 22382     COMPUTE TPD-ISS-PRM =
 22383         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 22384
 22385     COMPUTE TPD-CNC-PRM =
 22386         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 22387
 22388     COMPUTE TPD-NET-PRM =
 22389         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22390         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22391
 22392     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 431
* ECS010.cbl
 22393         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 22394
 22395     COMPUTE TPD-PREM-COMP =
 22396         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22397         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22398         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 22399
 22400     COMPUTE TPD-CLAIMS =
 22401         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 22402
 22403     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 22404         NEXT SENTENCE
 22405     ELSE
 22406         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 22407         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 22408         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22409*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 22410*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 22411*        MOVE ZEROS               TO SV-LO-CERT
 22412*                                    SV-HI-CERT.
 22413
 22414     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 22415     MOVE '0'                     TO P-CTL.
 22416     PERFORM 8800-PRINT-ROUTINE.
 22417     PERFORM 8800-PRINT-ROUTINE.
 22418
 22419 6599-TOTAL-PAGE-PRINT-X.
 22420     EXIT.
 22421*
 22422*
 22423*
 22424**START***********************************************************
 22425*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 22426*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 22427******************************************************************
 22428*
 22429 6650-GET-RES-STATE-COMM.
 22430*6650-BROWSE-FORWARD.
 22431
 22432     IF DTE-CLIENT NOT = 'DMD'
 22433         GO TO 6700-COMM-EXIT.
 22434
 22435     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 22436     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 22437     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 22438     MOVE CR-STATE            TO WS-ERRESC-STATE.
 22439     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 22440     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 22441     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 22442     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 22443
 22444     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 22445
 22446*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 22447*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 22448*VALUE OF PB-CERT-EFF-DT
 22449*
 22450     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 432
* ECS010.cbl
 22451
 22452     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 22453
 22454     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22455         GO TO 6700-COMM-EXIT.
 22456
 22457*GET RECORD WHERE POSITIONED
 22458
 22459 6650-READ-ERRESC-NEXT.
 22460     READ ERRESC-IN NEXT RECORD.
 22461
 22462     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22463         GO TO 6700-COMM-EXIT.
 22464
 22465*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 22466
 22467     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 22468        NEXT SENTENCE
 22469     ELSE
 22470         GO TO 6700-COMM-EXIT.
 22471
 22472     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 22473         NEXT SENTENCE
 22474     ELSE
 22475         GO TO 6650-READ-ERRESC-NEXT.
 22476
 22477*  CR-DT  = WS-YYYYMMDD-DT
 22478*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 22479*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 22480
 22481     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 22482         GO TO 6700-COMM-EXIT.
 22483
 22484* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 22485
 22486     MOVE ZEROS               TO WS-SUB WS-SUB1.
 22487
 22488     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 22489
 22490     IF WS-SUB1 IS GREATER THAN ZERO
 22491         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 22492             PERFORM 6680-SET-TABLE-CODE
 22493         ELSE
 22494             PERFORM 6680-SET-COMMISSION.
 22495
 22496     GO TO 6700-COMM-EXIT.
 22497
 22498 6680-SET-TABLE-CODE.
 22499     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 22500        MOVE ZEROS             TO WS-SUB1
 22501     ELSE
 22502* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 22503* TO COMPUTE AH COMMISSION.
 22504        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 22505        MOVE CR-AH-TERM        TO WS-COMM-TERM
 22506        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 22507        MOVE RESC-COMMISSION-TAB (WS-SUB)
 22508                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 433
* ECS010.cbl
 22509        PERFORM 6680-READ-CTBL-TABLE
 22510        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 22511           MOVE ZEROS          TO WS-SUB1.
 22512
 22513 6680-READ-CTBL-TABLE.
 22514*
 22515* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 22516* TO COMPUTE LIFE COMMISSION
 22517
 22518     IF CR-AHTYP = ZERO
 22519        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 22520        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 22521        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 22522
 22523     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 22524
 22525     IF ERCTBL-FILE-STATUS EQUAL '00'
 22526* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 22527        IF CR-AHTYP NOT = ZERO
 22528             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 22529             MOVE CR-AH-TERM        TO WS-COMM-TERM
 22530             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22531             MOVE WK-RATE           TO WS-COMMISSION
 22532                                       PB-I-AH-COMMISSION
 22533        ELSE
 22534* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 22535             MOVE CR-LFAMT    TO COMM-CK-AMT
 22536             MOVE CR-LF-TERM  TO WS-COMM-TERM
 22537             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22538             MOVE WK-RATE     TO WS-COMMISSION
 22539                                 PB-I-LIFE-COMMISSION.
 22540
 22541 6680-SET-COMMISSION.
 22542     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 22543           MOVE ZEROS         TO WS-SUB1
 22544       ELSE
 22545           MOVE RESC-COMMISSION-PER (WS-SUB)
 22546                              TO WS-COMMISSION WK-RATE
 22547           IF CR-AHTYP NOT = ZERO
 22548                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 22549           ELSE
 22550                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 22551
 22552 6680-SEARCH-CATEGORY.
 22553     ADD +1 TO WS-SUB.
 22554
 22555     IF WS-SUB IS GREATER THAN +12
 22556         GO TO 6680-EXIT.
 22557
 22558     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 22559          MOVE WS-SUB         TO WS-SUB1
 22560          GO TO 6680-EXIT.
 22561
 22562     GO TO 6680-SEARCH-CATEGORY.
 22563
 22564 6680-EXIT.
 22565     EXIT.
 22566
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 434
* ECS010.cbl
 22567 6700-COMM-EXIT.
 22568     EXIT.
 22569*
 22570*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22571
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 435
* ECS010.cbl
 22573******************************************************************
 22574***         C L I E N T   B I L L I N G   R O U T I N E        ***
 22575******************************************************************
 22576
 22577 7000-CLIENT-BILLING-ROUTINE.
 22578*
 22579*
 22580* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 22581
 22582     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 22583                BC-G-ISS      BC-G-CNC   BC-G-CLM
 22584                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 22585                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 22586                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 22587                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 22588                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 22589
 22590 7099-BILL-X.
 22591     EXIT.
 22592
 22593
 22594 7500-ADD-UP-REIN-CO.
 22595
 22596     IF RB-COMPANY (B-SUB) NOT = SPACES
 22597         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 22598
 22599 7599-ADD-UP-REIN-X.
 22600     EXIT.
 22601
 22602 7900-CLEAR-BILLING-TABLE.
 22603
 22604     MOVE SPACES TO RB-COMPANY (B-SUB).
 22605     MOVE 0      TO RB-COUNT (B-SUB).
 22606
 22607 7999-CLEAR-BILLING-X.
 22608     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 436
* ECS010.cbl
 22610******************************************************************
 22611***         M I S C E L L A N E O U S   R O U T I N E S        ***
 22612******************************************************************
 22613
 22614 8000-DATE-CONVERT-ROUTINE.
 22615
 22616     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 22617
 22618 8099-DATE-CONVERT-X.
 22619     EXIT.
 22620
 22621 8000R-CONVERT-STOP-DATE.
 22622
 22623     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 22624     MOVE 'L'                     TO DC-OPTION-CODE.
 22625     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22626     MOVE +0                      TO DC-ELAPSED-MONTHS.
 22627     MOVE -1                      TO DC-ELAPSED-DAYS.
 22628     MOVE '6'                     TO DC-OPTION-CODE.
 22629     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22630     MOVE +0                      TO DC-ELAPSED-MONTHS
 22631                                     DC-ELAPSED-DAYS.
 22632     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 22633     MOVE ' '                     TO DC-OPTION-CODE.
 22634     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22635
 22636     IF NO-CONVERSION-ERROR
 22637         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 22638     ELSE
 22639         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 22640                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 22641                 '  STOP DATE: ' RWF-EP-STOP-DATE
 22642         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 22643                                  TO WS-ABEND-MESSAGE
 22644         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 22645         MOVE 4002                TO WS-ABEND-CODE
 22646         GO TO ABEND-PGM.
 22647
 22648 8099R-STOP-DATE-X.
 22649     EXIT.
 22650
 22651
 22652 8100-GET-RATE.
 22653
 22654     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22655
 22656 8199-GET-RATE-X.
 22657     EXIT.
 22658
 22659
 22660 8200-STATE-CODE-LOOKUP.
 22661
 22662     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 22663        CLAS-INDEXS NOT = ZERO
 22664         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 22665             GO TO 8299-STATE-LOOKUP-X.
 22666
 22667     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 437
* ECS010.cbl
 22668
 22669 8250-STATE-LOOKUP-LOOP.
 22670
 22671     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 22672         MOVE 0302 TO WS-ABEND-CODE
 22673         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 22674         DISPLAY '******************************'
 22675         DISPLAY '***** ERROR LOCATION 022 *****'
 22676         DISPLAY '******************************'
 22677         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22678         GO TO ABEND-PGM.
 22679
 22680     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 22681         ADD +1 TO CLAS-INDEXS
 22682         GO TO 8250-STATE-LOOKUP-LOOP.
 22683
 22684 8299-STATE-LOOKUP-X.
 22685     EXIT.
 22686
 22687
 22688 8300-LIFE-TYPE-LOOKUP.
 22689
 22690     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 22691        CLAS-INDEXL NOT = ZERO
 22692         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 22693             GO TO 8399-LIFE-LOOKUP-X.
 22694
 22695     MOVE CLAS-STARTL TO CLAS-INDEXL.
 22696
 22697 8350-LIFE-LOOKUP-LOOP.
 22698
 22699     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 22700         MOVE 0401 TO WS-ABEND-CODE
 22701         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22702         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22703         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22704         DISPLAY '******************************'
 22705         DISPLAY '***** ERROR LOCATION 023 *****'
 22706         DISPLAY '******************************'
 22707         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22708         IF DTE-CLIENT = 'NCL'
 22709                      OR 'CID' OR 'AHL'
 22710             MOVE CLAS-STARTL      TO CLAS-INDEXL
 22711             MOVE '05'             TO CLAS-LOOK
 22712             GO TO 8350-LIFE-LOOKUP-LOOP
 22713         ELSE
 22714             GO TO ABEND-PGM.
 22715
 22716     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 22717         ADD +1 TO CLAS-INDEXL
 22718         GO TO 8350-LIFE-LOOKUP-LOOP.
 22719
 22720     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 22721         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 22722
 22723 8399-LIFE-LOOKUP-X.
 22724     EXIT.
 22725
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 438
* ECS010.cbl
 22726
 22727 8400-A-H-TYPE-LOOKUP.
 22728
 22729     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 22730        CLAS-INDEXA NOT = ZERO
 22731         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 22732             GO TO 8499-A-H-LOOKUP-X.
 22733
 22734     MOVE CLAS-STARTA TO CLAS-INDEXA.
 22735
 22736 8450-A-H-LOOKUP-LOOP.
 22737
 22738     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 22739         MOVE 0402 TO WS-ABEND-CODE
 22740         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22741         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22742         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22743         DISPLAY '******************************'
 22744         DISPLAY '***** ERROR LOCATION 024 *****'
 22745         DISPLAY '******************************'
 22746         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22747         IF DTE-CLIENT = 'NCL'
 22748             MOVE CLAS-STARTA      TO CLAS-INDEXA
 22749             MOVE '05'             TO CLAS-LOOK
 22750             GO TO 8450-A-H-LOOKUP-LOOP
 22751         ELSE
 22752             GO TO ABEND-PGM.
 22753
 22754     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 22755         ADD +1 TO CLAS-INDEXA
 22756         GO TO 8450-A-H-LOOKUP-LOOP.
 22757
 22758 8499-A-H-LOOKUP-X.
 22759     EXIT.
 22760
 22761 8500-REMAINING-TERM-ROUTINE.
 22762
 22763     MOVE ZEROS                      TO CP-REMAINING-TERM
 22764                                        CP-REMAINING-TERM-1
 22765                                        CP-REMAINING-TERM-2
 22766                                        CP-REMAINING-TERM-3
 22767                                        CP-RETURN-CODE
 22768                                        CP-RETURN-CODE-2
 22769                                        REM-TRM1
 22770                                        REM-TRM2
 22771                                        REM-TRM3
 22772                                        TEM-TRM1.
 22773     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 22774
 22775     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 22776     MOVE 'L'                        TO DC-OPTION-CODE.
 22777     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22778
 22779     IF  NO-CONVERSION-ERROR
 22780         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 22781     ELSE
 22782         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 22783                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 439
* ECS010.cbl
 22784         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22785         MOVE 3001                   TO WS-ABEND-CODE
 22786         GO TO ABEND-PGM.
 22787
 22788     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 22789
 22790     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 22791         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22792
 22793     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 22794         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 22795         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 22796                                        DC-ELAPSED-DAYS
 22797         MOVE '3'                    TO DC-OPTION-CODE
 22798         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22799                 8099-DATE-CONVERT-X
 22800         IF  NO-CONVERSION-ERROR
 22801             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 22802         ELSE
 22803             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 22804
 22805     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 22806         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22807
 22808     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 22809         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 22810         MOVE +1                     TO DC-ELAPSED-MONTHS
 22811         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 22812         MOVE '6'                    TO DC-OPTION-CODE
 22813         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22814                 8099-DATE-CONVERT-X
 22815         IF  NO-CONVERSION-ERROR
 22816             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 22817             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 22818         ELSE
 22819             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 22820                                     TO WS-ABEND-MESSAGE
 22821             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 22822             MOVE 3002               TO WS-ABEND-CODE
 22823             GO TO ABEND-PGM.
 22824
 22825     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 22826     MOVE 'L'                        TO DC-OPTION-CODE.
 22827     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22828
 22829     IF  NO-CONVERSION-ERROR
 22830         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 22831     ELSE
 22832         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 22833             W-VAL-ERROR (W-VAL-SOURCE)
 22834         DISPLAY '   KEY - ' CR-FULL-CONTROL
 22835             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 22836             DC-ERROR-CODE
 22837         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 22838         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 22839             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 22840             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 22841             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 440
* ECS010.cbl
 22842*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 22843*                                    TO WS-ABEND-MESSAGE
 22844*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22845*        MOVE 3003                   TO WS-ABEND-CODE
 22846*        GO TO ABEND-PGM.
 22847
 22848     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 22849     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 22850     MOVE '3'                        TO CP-PROCESS-TYPE.
 22851     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 22852     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 22853     MOVE SPACES                     TO CP-ACCT-FLD-5.
 22854
 22855*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 22856*                                    TO CP-REM-TERM-METHOD.
 22857
 22858     IF  DTE-CLIENT = 'FIM'
 22859         MOVE '5'                    TO CP-REM-TERM-METHOD.
 22860
 22861     IF DTE-CLIENT = 'FLI' OR 'FLU'
 22862         IF WE-LF-AH = AH-OVERRIDE-L1
 22863             MOVE '2'                TO CP-REM-TERM-METHOD
 22864         ELSE
 22865             IF CR-LFTYP = '01' OR '03'
 22866                 MOVE '4'            TO CP-REM-TERM-METHOD
 22867             ELSE
 22868                 IF CR-LFTYP = '02' OR '04'
 22869                     MOVE '2'        TO CP-REM-TERM-METHOD.
 22870
 22871     IF  DTE-CLIENT = 'CSL'
 22872         IF  CR-CARRIER = '2'
 22873             IF  CR-LFTYP = '07' OR  '08'
 22874                 MOVE '4'            TO CP-REM-TERM-METHOD.
 22875
 22876     IF  DTE-CLIENT = 'POS'
 22877         IF  CR-CARRIER = '1'
 22878             MOVE '1'                TO CP-REM-TERM-METHOD
 22879         ELSE
 22880             MOVE '2'                TO CP-REM-TERM-METHOD.
 22881
 22882     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 22883         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 22884
 22885     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 22886         GO TO 8540-CALC-REM-TERM-AH.
 22887
 22888 8520-CALC-REM-TERM-LIFE.
 22889
 22890     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 22891     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 22892     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 22893*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 22894     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 22895                                        CP-LOAN-TERM.
 22896
 22897     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22898             AND
 22899         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 441
* ECS010.cbl
 22900         ADD +1                      TO CP-ORIGINAL-TERM
 22901                                        CP-LOAN-TERM.
 22902
 22903     IF  CP-TERM-IS-DAYS
 22904         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 22905     ELSE
 22906         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 22907
 22908     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22909
 22910     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22911         ADD +1                      TO W-ORGTRM-0-LF
 22912         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 22913             CR-FULL-CONTROL
 22914         GO TO 8599-REM-TERM-X.
 22915
 22916     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22917
 22918     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22919         ADD +1                      TO W-RET-CODE-LF
 22920         GO TO 8599-REM-TERM-X.
 22921*
 22922*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 22923*                                    TO WS-ABEND-MESSAGE
 22924*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 22925*        MOVE 2002                   TO WS-ABEND-CODE
 22926*        GO TO ABEND-PGM.
 22927
 22928     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22929             AND
 22930         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 22931         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 22932         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 22933         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 22934
 22935     IF  CP-REMAINING-TERM-1 NEGATIVE
 22936         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 22937
 22938     IF  CP-REMAINING-TERM-2 NEGATIVE
 22939         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 22940
 22941     IF DTE-CLIENT = 'NCL'
 22942         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 22943                                        CP-REMAINING-TERM-3.
 22944
 22945     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 22946     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 22947     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 22948     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 22949
 22950     GO TO 8599-REM-TERM-X.
 22951
 22952 8520-EXIT.
 22953     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 442
* ECS010.cbl
 22955 8540-CALC-REM-TERM-AH.
 22956
 22957     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 22958     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 22959     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 22960     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 22961                                        CP-LOAN-TERM.
 22962     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 22963
 22964     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22965
 22966     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22967         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 22968             CR-FULL-CONTROL
 22969         ADD +1                      TO W-ORGTRM-0-AH
 22970         GO TO 8599-REM-TERM-X.
 22971
 22972     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22973
 22974     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22975         ADD +1                      TO W-RET-CODE-AH
 22976         GO TO 8599-REM-TERM-X.
 22977*
 22978*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 22979*                                    TO WS-ABEND-MESSAGE
 22980*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 22981*        MOVE 2001                   TO WS-ABEND-CODE
 22982*        GO TO ABEND-PGM.
 22983
 22984     IF DTE-CLIENT = 'NCL'
 22985         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 22986                                        CP-REMAINING-TERM-3.
 22987
 22988     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 22989     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 22990     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 22991     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 22992
 22993 8599-REM-TERM-X.
 22994     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 443
* ECS010.cbl
 22996
 22997******************************************************************
 22998***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 22999******************************************************************
 23000
 23001 8600-DISPLAY-PRT.
 23002
 23003     IF  DIS-LINE-CNT GREATER THAN 59
 23004         PERFORM 8600-DISPLAY-HD THRU
 23005             8600-HD-EXIT.
 23006
 23007     ADD  1  TO DIS-LINE-CNT.
 23008     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 23009     MOVE  SPACES TO DISPLAY-REC
 23010                     DISPLAY-LINE.
 23011
 23012 8600-DISPLAY-EXIT.
 23013     EXIT.
 23014
 23015
 23016 8600-DISPLAY-HD.
 23017
 23018     MOVE '1'  TO  DISPLAY-CC.
 23019     MOVE ZEROS TO DIS-LINE-CNT.
 23020     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 23021     ADD +1 TO DIS-LINE-CNT.
 23022     MOVE ' '  TO  DISPLAY-CC.
 23023     MOVE SPACES TO DISPLAY-REC.
 23024     WRITE DISPLAY-REC.
 23025     ADD +1 TO DIS-LINE-CNT.
 23026     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 23027     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 23028     ADD +1 TO DIS-LINE-CNT.
 23029     MOVE SPACES TO DISPLAY-REC.
 23030     ADD +1 TO DIS-LINE-CNT.
 23031     WRITE DISPLAY-REC.
 23032
 23033 8600-HD-EXIT.
 23034     EXIT.
 23035
 23036******************************************************************
 23037***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 23038******************************************************************
 23039
 23040 8600-SETUP-DETAIL-LINE.
 23041
 23042     MOVE SPACES                TO TR-DTL2.
 23043
 23044     MOVE CR-CERT-NO            TO TRD-CERT.
 23045     MOVE CR-YR                 TO TRD-ISYR.
 23046     MOVE CR-MO                 TO TRD-ISMO.
 23047     MOVE CR-DA                 TO TRD-ISDA.
 23048     MOVE CR-AGE                TO TRD-AGE.
 23049
 23050 8689-SETUP-DETAIL-X.
 23051     EXIT.
 23052
 23053 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 444
* ECS010.cbl
 23054
 23055     IF LN-CNT GREATER THAN LN-MX
 23056         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 23057                 8799-PRT-HEADINGS-X.
 23058     MOVE TRD-CERT TO SV-TRD-CERT.
 23059     MOVE TRD-ISDT TO SV-TRD-ISDT.
 23060
 23061     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 23062         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 23063
 23064     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 23065     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 23066     MOVE TR-DTL TO PRT.
 23067
 23068     IF NOT WS-CHANGE-REC
 23069         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 23070     ELSE
 23071         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 23072
 23073     PERFORM 8800-PRINT-ROUTINE.
 23074
 23075 8699-PRT-DETAIL-X.
 23076     EXIT.
 23077
 23078 8700-PRINT-REPORT-HEADINGS.
 23079     ADD +1 TO PG-CNT.
 23080     MOVE PG-CNT TO TR-PG.
 23081     MOVE +0 TO LN-CNT.
 23082     MOVE TR-HD-1 TO PRT.
 23083     PERFORM 8800-PRINT-ROUTINE.
 23084     MOVE TR-HD-2 TO PRT.
 23085     PERFORM 8800-PRINT-ROUTINE.
 23086     MOVE TR-HD-3 TO PRT.
 23087     PERFORM 8800-PRINT-ROUTINE.
 23088     ADD +1 TO LN-CNT.
 23089
 23090 8725-PRT-ACCT-HEADING.
 23091     MOVE TR-HD-4 TO PRT.
 23092     PERFORM 8800-PRINT-ROUTINE.
 23093     MOVE TR-HD-5 TO PRT.
 23094     PERFORM 8800-PRINT-ROUTINE.
 23095
 23096 8750-PRT-RANGE-HEADING.
 23097     MOVE TR-HD-6 TO PRT.
 23098     PERFORM 8800-PRINT-ROUTINE.
 23099
 23100 8775-PRT-COLUMN-HEADINGS.
 23101     MOVE TR-HD-7 TO PRT.
 23102     PERFORM 8800-PRINT-ROUTINE.
 23103     MOVE TR-HD-8 TO PRT.
 23104     PERFORM 8800-PRINT-ROUTINE.
 23105     MOVE TR-HD-9 TO PRT.
 23106     PERFORM 8800-PRINT-ROUTINE.
 23107     PERFORM 8800-PRINT-ROUTINE.
 23108
 23109 8799-PRT-HEADINGS-X.
 23110     EXIT.
 23111
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 445
* ECS010.cbl
 23112 8800-PRINT-ROUTINE.
 23113     MOVE P-CTL TO X.
 23114     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 23115     ADD +1 TO LN-CNT.
 23116     MOVE SPACES TO PRT.
 23117
 23118 8900-PRINT-A-LINE.
*23119                             COPY ELCPRT2.
 23120******************************************************************04/15/98
 23121*                                                                *ELCPRT2
 23122*                                                                *ELCPRT2
 23123*                            ELCPRT2                             *   LV005
 23124*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 23125*                            VMOD=2.002                          *   CL**5
 23126*                                                                *   CL**4
 23127******************************************************************   CL**4
 23128                                                                     CL**4
 23129     IF DTE-FICH NOT = SPACE AND                                     CL**4
 23130        FICH-OPEN    = SPACE                                         CL**4
 23131         MOVE 'X'                TO  FICH-OPEN                       CL**4
 23132         OPEN OUTPUT FICH.                                           CL**4
 23133                                                                     CL**4
 23134     IF DTE-FICH NOT = SPACE                                         CL**4
 23135         MOVE X                  TO  P-CTL                           CL**4
 23136         WRITE FICH-REC FROM PRT.                                    CL**4
 23137                                                                     CL**4
 23138     IF DTE-FICH = SPACE OR '2'                                      CL**4
 23139       MOVE X                    TO  P-CTL                           CL**4
 23140       IF P-CTL = ' '                                                CL**4
 23141         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 23142       ELSE                                                          CL**4
 23143         IF P-CTL = '0'                                              CL**4
 23144           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 23145         ELSE                                                        CL**4
 23146           IF P-CTL = '-'                                            CL**4
 23147             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 23148           ELSE                                                      CL**4
 23149             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 23150                                                                     CL**4
 23151******************************************************************   CL**4
 23152
 23153 8999-PRT-LINE-X.
 23154     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 446
* ECS010.cbl
 23156******************************************************************
 23157***          E N D   O F   J O B   P R O C E S S I N G         ***
 23158******************************************************************
 23159
 23160 9910-EOJ-1.
 23161     IF TR-CNT = ZERO
 23162         IF (DTE-PGM-OPT = '2' OR '3') OR
 23163            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 23164                          'ITY' OR 'DAC' OR 'FLC')
 23165             NEXT SENTENCE
 23166         ELSE
 23167             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 23168             MOVE 0703                    TO WS-ABEND-CODE
 23169             DISPLAY '******************************'
 23170             DISPLAY '***** ERROR LOCATION 025 *****'
 23171             DISPLAY '******************************'
 23172             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 23173             GO TO ABEND-PGM.
 23174
 23175     MOVE '*'         TO TRANS-EOF-FLAG.
 23176     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 23177
 23178     IF EOF-ON-CERT
 23179         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23180         GO TO 9940-EOJ-FIN.
 23181
 23182     GO TO 0330-MATCH-PENDING-TO-CERT.
 23183
 23184 9920-EOJ-2.
 23185     MOVE '*'         TO CERT-EOF-FLAG.
 23186     MOVE HIGH-VALUES TO CIR-CONTROL.
 23187
 23188     IF EOF-ON-TRANS
 23189         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23190         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 23191         GO TO 9940-EOJ-FIN.
 23192
 23193     GO TO 0299-READ-CERT-X.
 23194
 23195 9930-EOJ-3.
 23196     IF PROCESSING-COMPLETED
 23197         GO TO 9950-EOJ-FIN-GO.
 23198
 23199     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 23200     MOVE 'MISSING ACCOUNT MASTER'
 23201                               TO WS-ABEND-MESSAGE.
 23202     MOVE 0302                 TO WS-ABEND-CODE.
 23203     DISPLAY '******************************'
 23204     DISPLAY '***** ERROR LOCATION 026 *****'
 23205     DISPLAY '******************************'
 23206     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 23207     GO TO ABEND-PGM.
 23208
 23209 9940-EOJ-FIN.
 23210     MOVE '*'        TO PROCESSING-FLAG.
 23211     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 23212
 23213     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 447
* ECS010.cbl
 23214             0199-READ-ACCOUNT-X.
 23215     GO TO 9940-EOJ-FIN.
 23216
 23217 9950-EOJ-FIN-GO.
 23218     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 23219     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 23220*
 23221*
 23222* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 23223     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 23224
 23225 9960-NO-TOTS.
 23226
 23227     MOVE +15                    TO LN-CNT.
 23228     MOVE CMIN-CNT               TO TTL-PT-CNT.
 23229     IF ME-DO-UPDATE
 23230         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 23231
 23232     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 23233     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 23234     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 23235
 23236
 23237     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23238     MOVE TR-TTL-HD              TO PRT.
 23239     PERFORM 8800-PRINT-ROUTINE.
 23240     ADD +1 TO LN-CNT.
 23241     MOVE TR-CNT                TO TTL-PT-CNT.
 23242     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 23243     MOVE TR-TTL-HD             TO PRT.
 23244     PERFORM 8800-PRINT-ROUTINE.
 23245     ADD +1 TO LN-CNT.
 23246
 23247     IF DUP-CNT = ZERO
 23248         GO TO 9969-CHECK-MISMATCHED-TOTS.
 23249
 23250     MOVE DUP-CNT                 TO TTL-PT-CNT.
 23251
 23252     IF ME-DO-UPDATE
 23253         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 23254
 23255     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 23256     MOVE TR-TTL-HD               TO PRT.
 23257     PERFORM 8800-PRINT-ROUTINE.
 23258     PERFORM 8800-PRINT-ROUTINE.
 23259     ADD +1 TO LN-CNT.
 23260
 23261     MOVE '1'                           TO  DTL-REC-TYPE.
 23262     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 23263     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 23264     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 23265                                        TO  DTL-CERT-OUT-CONTROL.
 23266     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 23267     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 23268     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 23269
 23270     MOVE +1 TO SUB3.
 23271 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 448
* ECS010.cbl
 23272
 23273     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 23274         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 23275         MOVE MISMATCH-PAGE-NUMBER
 23276                                 TO  TR-PG
 23277         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 23278         MOVE MR-CTL             TO  X
 23279         MOVE X TO LCP-ASA
 23280         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23281             THRU LCP-WRITE-END-MISMATCH-RPT
 23282         MOVE TR-HD-2            TO  MISMATCH-RPT
 23283         MOVE MR-CTL             TO  X
 23284         MOVE X TO LCP-ASA
 23285         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23286             THRU LCP-WRITE-END-MISMATCH-RPT
 23287         MOVE TR-HD-3            TO  MISMATCH-RPT
 23288         MOVE MR-CTL             TO  X
 23289         MOVE X TO LCP-ASA
 23290         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23291             THRU LCP-WRITE-END-MISMATCH-RPT
 23292         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 23293         MOVE MR-CTL             TO  X
 23294         MOVE X TO LCP-ASA
 23295         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23296             THRU LCP-WRITE-END-MISMATCH-RPT
 23297         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 23298
 23299     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 23300
 23301     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 23302     MOVE MR-CTL                        TO  X.
 23303     ADD +2                             TO  MISMATCH-LINE-COUNT.
 23304
 23305     MOVE X TO LCP-ASA
 23306     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23307         THRU LCP-WRITE-END-MISMATCH-RPT.
 23308
 23309     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 23310     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 23311
 23312     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 23313     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 23314
 23315     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 23316     IF  DUPE-STATUS (SUB3)  =  '2'
 23317         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 23318     IF  DUPE-STATUS (SUB3)  =  '5'
 23319         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 23320     IF  DUPE-STATUS (SUB3)  =  'M'
 23321         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 23322     IF  DUPE-STATUS (SUB3)  =  '9'
 23323         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 23324     IF  DUPE-STATUS (SUB3)  =  'D'
 23325         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 23326     IF  DUPE-STATUS (SUB3)  =  'V'
 23327         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 23328     IF  DUPE-STATUS (SUB3)  =  'P'
 23329         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 449
* ECS010.cbl
 23330
 23331     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23332     MOVE MR-CTL                        TO  X.
 23333     ADD +1                             TO  MISMATCH-LINE-COUNT.
 23334
 23335     MOVE X TO LCP-ASA
 23336     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23337         THRU LCP-WRITE-END-MISMATCH-RPT.
 23338
 23339     IF SUB3 LESS THAN DUP-CNT
 23340         ADD +1 TO SUB3
 23341         GO TO 9965-PRT-DUPES.
 23342
 23343 9969-CHECK-MISMATCHED-TOTS.
 23344
 23345     IF W-MM-LF-PRM = ZEROS  AND
 23346        W-MM-AH-PRM = ZEROS  AND
 23347        W-MM-LF-RFD = ZEROS  AND
 23348        W-MM-AH-RFD = ZEROS  AND
 23349        W-MM-LF-CLM = ZEROS  AND
 23350        W-MM-AH-CLM = ZEROS
 23351         GO TO 9970-FIN-TOTS.
 23352
 23353     MOVE SPACES                        TO  MISMATCH-RPT.
 23354     MOVE '0'                           TO  MR-CTL  X.
 23355     MOVE X TO LCP-ASA
 23356     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23357         THRU LCP-WRITE-END-MISMATCH-RPT.
 23358
 23359     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 23360     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23361     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 23362
 23363     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 23364     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 23365     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 23366
 23367     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23368     MOVE '0'                           TO  MR-CTL  X.
 23369     MOVE X TO LCP-ASA
 23370     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23371         THRU LCP-WRITE-END-MISMATCH-RPT.
 23372
 23373     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 23374     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23375     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 23376
 23377     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 23378     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 23379     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 23380
 23381     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23382     MOVE '0'                           TO  MR-CTL  X.
 23383     MOVE X TO LCP-ASA
 23384     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23385         THRU LCP-WRITE-END-MISMATCH-RPT.
 23386
 23387     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 450
* ECS010.cbl
 23388     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 23389     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 23390
 23391     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 23392     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 23393     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 23394
 23395     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23396     MOVE '0'                           TO  MR-CTL  X.
 23397     MOVE X TO LCP-ASA
 23398     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23399         THRU LCP-WRITE-END-MISMATCH-RPT.
 23400
 23401 9970-FIN-TOTS.
 23402
 23403     MOVE CMOT-CNT                TO TTL-PT-CNT.
 23404
 23405     IF ME-DO-UPDATE
 23406         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 23407
 23408     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23409     MOVE TR-TTL-HD               TO PRT.
 23410     PERFORM 8800-PRINT-ROUTINE.
 23411
 23412     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 23413     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 23414     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 23415     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 23416
 23417     MOVE DE-CNT                  TO TTL-PT-CNT.
 23418     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 23419     MOVE TR-TTL-HD               TO PRT.
 23420     PERFORM 8800-PRINT-ROUTINE.
 23421
 23422     MOVE EP-CNT                  TO TTL-PT-CNT.
 23423     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 23424     MOVE TR-TTL-HD               TO PRT.
 23425     PERFORM 8800-PRINT-ROUTINE.
 23426     PERFORM 8800-PRINT-ROUTINE.
 23427
 23428     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 23429     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 23430     MOVE TR-TTL-HD               TO PRT.
 23431     PERFORM 8800-PRINT-ROUTINE.
 23432
 23433     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 23434     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 23435     MOVE TR-TTL-HD               TO PRT.
 23436     PERFORM 8800-PRINT-ROUTINE.
 23437
 23438     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 23439     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 23440     MOVE TR-TTL-HD               TO PRT.
 23441     PERFORM 8800-PRINT-ROUTINE.
 23442
 23443     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 23444         GO TO 9990-FINAL-CLOSE.
 23445
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 451
* ECS010.cbl
 23446**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 23447**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 23448**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 23449**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 23450
 23451     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 23452     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 23453     MOVE TR-TTL-HD               TO PRT.
 23454     PERFORM 8800-PRINT-ROUTINE.
 23455
 23456     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 23457     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 23458     MOVE TR-TTL-HD               TO PRT.
 23459     PERFORM 8800-PRINT-ROUTINE.
 23460
 23461     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 23462     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 23463     MOVE TR-TTL-HD               TO PRT.
 23464     PERFORM 8800-PRINT-ROUTINE.
 23465
 23466     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 23467     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 23468     MOVE TR-TTL-HD               TO PRT.
 23469     PERFORM 8800-PRINT-ROUTINE.
 23470
 23471     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 23472     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 23473     MOVE TR-TTL-HD               TO PRT.
 23474     PERFORM 8800-PRINT-ROUTINE.
 23475
 23476     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 23477     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23478     MOVE TR-TTL-HD               TO PRT.
 23479     PERFORM 8800-PRINT-ROUTINE.
 23480
 23481     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 23482     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23483     MOVE TR-TTL-HD               TO PRT.
 23484     PERFORM 8800-PRINT-ROUTINE.
 23485
 23486     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 23487     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 23488     MOVE TR-TTL-HD               TO PRT.
 23489     PERFORM 8800-PRINT-ROUTINE.
 23490
 23491     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 23492     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23493     MOVE TR-TTL-HD               TO PRT.
 23494     PERFORM 8800-PRINT-ROUTINE.
 23495
 23496     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 23497     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23498     MOVE TR-TTL-HD               TO PRT.
 23499     PERFORM 8800-PRINT-ROUTINE.
 23500
 23501     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 23502     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23503     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 452
* ECS010.cbl
 23504     PERFORM 8800-PRINT-ROUTINE.
 23505
 23506     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 23507     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23508     MOVE TR-TTL-HD               TO PRT.
 23509     PERFORM 8800-PRINT-ROUTINE.
 23510
 23511     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 23512     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 23513     MOVE TR-TTL-HD               TO PRT.
 23514     PERFORM 8800-PRINT-ROUTINE.
 23515
 23516     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 23517     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 23518     MOVE TR-TTL-HD               TO PRT.
 23519     PERFORM 8800-PRINT-ROUTINE.
 23520
 23521     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 23522     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 23523     MOVE TR-TTL-HD               TO PRT.
 23524     PERFORM 8800-PRINT-ROUTINE.
 23525
 23526     MOVE W-AH-REIN               TO TTL-PT-CNT.
 23527     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 23528     MOVE TR-TTL-HD               TO PRT.
 23529     PERFORM 8800-PRINT-ROUTINE.
 23530
 23531     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 23532     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 23533     MOVE TR-TTL-HD               TO PRT.
 23534     PERFORM 8800-PRINT-ROUTINE.
 23535
 23536     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 23537     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 23538     MOVE TR-TTL-HD               TO PRT.
 23539     PERFORM 8800-PRINT-ROUTINE.
 23540
 23541     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 23542     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23543     MOVE TR-TTL-HD               TO PRT.
 23544     PERFORM 8800-PRINT-ROUTINE.
 23545
 23546     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 23547     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 23548     MOVE TR-TTL-HD               TO PRT.
 23549     PERFORM 8800-PRINT-ROUTINE.
 23550
 23551     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 23552     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 23553     MOVE TR-TTL-HD               TO PRT.
 23554     PERFORM 8800-PRINT-ROUTINE.
 23555
 23556     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 23557     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23558     MOVE TR-TTL-HD               TO PRT.
 23559     PERFORM 8800-PRINT-ROUTINE.
 23560
 23561     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 453
* ECS010.cbl
 23562     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 23563     MOVE TR-TTL-HD               TO PRT.
 23564     PERFORM 8800-PRINT-ROUTINE.
 23565
 23566     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 23567     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 23568     MOVE TR-TTL-HD               TO PRT.
 23569     PERFORM 8800-PRINT-ROUTINE.
 23570
 23571     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 23572     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 23573     MOVE TR-TTL-HD               TO PRT.
 23574     PERFORM 8800-PRINT-ROUTINE.
 23575
 23576     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 23577     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 23578     MOVE TR-TTL-HD               TO PRT.
 23579     PERFORM 8800-PRINT-ROUTINE.
 23580
 23581     MOVE W-LF-REIN               TO TTL-PT-CNT.
 23582     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 23583     MOVE TR-TTL-HD               TO PRT.
 23584     PERFORM 8800-PRINT-ROUTINE.
 23585
 23586     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 23587     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 23588     MOVE TR-TTL-HD               TO PRT.
 23589     PERFORM 8800-PRINT-ROUTINE.
 23590
 23591     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 23592     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23593     MOVE TR-TTL-HD               TO PRT.
 23594     PERFORM 8800-PRINT-ROUTINE.
 23595
 23596     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 23597     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 23598     MOVE TR-TTL-HD               TO PRT.
 23599     PERFORM 8800-PRINT-ROUTINE.
 23600
 23601     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 23602     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 23603     MOVE TR-TTL-HD               TO PRT.
 23604     PERFORM 8800-PRINT-ROUTINE.
 23605
 23606     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 23607     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 23608     MOVE TR-TTL-HD               TO PRT.
 23609     PERFORM 8800-PRINT-ROUTINE.
 23610
 23611     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 23612     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 23613     MOVE TR-TTL-HD               TO PRT.
 23614     PERFORM 8800-PRINT-ROUTINE.
 23615
 23616     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 23617     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23618     MOVE TR-TTL-HD               TO PRT.
 23619     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 454
* ECS010.cbl
 23620
 23621     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 23622     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 23623     MOVE TR-TTL-HD               TO PRT.
 23624     PERFORM 8800-PRINT-ROUTINE.
 23625
 23626     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 23627     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 23628     MOVE TR-TTL-HD               TO PRT.
 23629     PERFORM 8800-PRINT-ROUTINE.
 23630
 23631     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 23632     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 23633     MOVE TR-TTL-HD               TO PRT.
 23634     PERFORM 8800-PRINT-ROUTINE.
 23635
 23636     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 23637     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 23638     MOVE TR-TTL-HD               TO PRT.
 23639     PERFORM 8800-PRINT-ROUTINE.
 23640
 23641     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 23642     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 23643     MOVE TR-TTL-HD               TO PRT.
 23644     PERFORM 8800-PRINT-ROUTINE.
 23645
 23646     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 23647     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 23648                                  TO TTL-HD-DS.
 23649     MOVE TR-TTL-HD               TO PRT.
 23650     PERFORM 8800-PRINT-ROUTINE.
 23651
 23652     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 23653     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 23654                                  TO TTL-HD-DS.
 23655     MOVE TR-TTL-HD               TO PRT.
 23656     PERFORM 8800-PRINT-ROUTINE.
 23657
 23658     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 23659     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 23660                                  TO TTL-HD-DS.
 23661     MOVE TR-TTL-HD               TO PRT.
 23662     PERFORM 8800-PRINT-ROUTINE.
 23663
 23664     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 23665     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 23666                                  TO TTL-HD-DS.
 23667     MOVE TR-TTL-HD               TO PRT.
 23668     PERFORM 8800-PRINT-ROUTINE.
 23669
 23670     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 23671     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 23672                                  TO TTL-HD-DS.
 23673     MOVE TR-TTL-HD               TO PRT.
 23674     PERFORM 8800-PRINT-ROUTINE.
 23675
 23676     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 23677     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 455
* ECS010.cbl
 23678                                  TO TTL-HD-DS.
 23679     MOVE TR-TTL-HD               TO PRT.
 23680     PERFORM 8800-PRINT-ROUTINE.
 23681
 23682     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23683     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 23684     MOVE TR-TTL-HD               TO PRT.
 23685     PERFORM 8800-PRINT-ROUTINE.
 23686
 23687     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23688     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 23689     MOVE TR-TTL-HD               TO PRT.
 23690     PERFORM 8800-PRINT-ROUTINE.
 23691
 23692     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 23693     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 23694     MOVE TR-TTL-HD               TO PRT.
 23695     PERFORM 8800-PRINT-ROUTINE.
 23696
 23697     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 23698     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 23699     MOVE TR-TTL-HD               TO PRT.
 23700     PERFORM 8800-PRINT-ROUTINE.
 23701
 23702     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 23703     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 23704     MOVE TR-TTL-HD               TO PRT.
 23705     PERFORM 8800-PRINT-ROUTINE.
 23706
 23707     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 23708     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 23709     MOVE TR-TTL-HD               TO PRT.
 23710     PERFORM 8800-PRINT-ROUTINE.
 23711
 23712     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 23713     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 23714     MOVE TR-TTL-HD               TO PRT.
 23715     PERFORM 8800-PRINT-ROUTINE.
 23716
 23717     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 23718     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 23719     MOVE TR-TTL-HD               TO PRT.
 23720     PERFORM 8800-PRINT-ROUTINE.
 23721
 23722     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 23723     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 23724     MOVE TR-TTL-HD               TO PRT.
 23725     PERFORM 8800-PRINT-ROUTINE.
 23726
 23727     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 23728     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 23729     MOVE TR-TTL-HD               TO PRT.
 23730     PERFORM 8800-PRINT-ROUTINE.
 23731
 23732     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 23733     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 23734     MOVE TR-TTL-HD               TO PRT.
 23735     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 456
* ECS010.cbl
 23736
 23737     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 23738     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 23739     MOVE TR-TTL-HD               TO PRT.
 23740     PERFORM 8800-PRINT-ROUTINE.
 23741
 23742     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 23743     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 23744     MOVE TR-TTL-HD               TO PRT.
 23745     PERFORM 8800-PRINT-ROUTINE.
 23746
 23747     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 23748     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 23749     MOVE TR-TTL-HD               TO PRT.
 23750     PERFORM 8800-PRINT-ROUTINE.
 23751
 23752     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 23753     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 23754     MOVE TR-TTL-HD               TO PRT.
 23755     PERFORM 8800-PRINT-ROUTINE.
 23756
 23757     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 23758     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 23759     MOVE TR-TTL-HD               TO PRT.
 23760     PERFORM 8800-PRINT-ROUTINE.
 23761
 23762     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 23763     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 23764     MOVE TR-TTL-HD               TO PRT.
 23765     PERFORM 8800-PRINT-ROUTINE.
 23766
 23767     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 23768     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 23769     MOVE TR-TTL-HD               TO PRT.
 23770     PERFORM 8800-PRINT-ROUTINE.
 23771
 23772     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 23773     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 23774     MOVE TR-TTL-HD               TO PRT.
 23775     PERFORM 8800-PRINT-ROUTINE.
 23776
 23777     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 23778     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 23779     MOVE TR-TTL-HD               TO PRT.
 23780     PERFORM 8800-PRINT-ROUTINE.
 23781
 23782     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 23783     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 23784     MOVE TR-TTL-HD               TO PRT.
 23785     PERFORM 8800-PRINT-ROUTINE.
 23786
 23787     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 23788     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 23789     MOVE TR-TTL-HD               TO PRT.
 23790     PERFORM 8800-PRINT-ROUTINE.
 23791
 23792     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 23793     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 457
* ECS010.cbl
 23794     MOVE TR-TTL-HD               TO PRT.
 23795     PERFORM 8800-PRINT-ROUTINE.
 23796
 23797     MOVE W-1-EP                  TO TTL-PT-CNT.
 23798     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 23799     MOVE TR-TTL-HD               TO PRT.
 23800     PERFORM 8800-PRINT-ROUTINE.
 23801
 23802     MOVE W-P-EP                  TO TTL-PT-CNT.
 23803     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 23804     MOVE TR-TTL-HD               TO PRT.
 23805     PERFORM 8800-PRINT-ROUTINE.
 23806
 23807     MOVE W-M-EP                  TO TTL-PT-CNT.
 23808     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 23809     MOVE TR-TTL-HD               TO PRT.
 23810     PERFORM 8800-PRINT-ROUTINE.
 23811
 23812     MOVE W-R-EP                  TO TTL-PT-CNT.
 23813     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 23814     MOVE TR-TTL-HD               TO PRT.
 23815     PERFORM 8800-PRINT-ROUTINE.
 23816
 23817     MOVE W-WY-EP                 TO TTL-PT-CNT.
 23818     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 23819     MOVE TR-TTL-HD               TO PRT.
 23820     PERFORM 8800-PRINT-ROUTINE.
 23821
 23822     MOVE W-VA-EP                 TO TTL-PT-CNT.
 23823     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 23824     MOVE TR-TTL-HD               TO PRT.
 23825     PERFORM 8800-PRINT-ROUTINE.
 23826
 23827     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 23828     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 23829     MOVE TR-TTL-HD               TO PRT.
 23830     PERFORM 8800-PRINT-ROUTINE.
 23831
 23832     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 23833     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23834     MOVE TR-TTL-HD               TO PRT.
 23835     PERFORM 8800-PRINT-ROUTINE.
 23836
 23837     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 23838     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23839     MOVE TR-TTL-HD               TO PRT.
 23840     PERFORM 8800-PRINT-ROUTINE.
 23841
 23842     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 23843     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23844     MOVE TR-TTL-HD               TO PRT.
 23845     PERFORM 8800-PRINT-ROUTINE.
 23846
 23847     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 23848     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23849     MOVE TR-TTL-HD               TO PRT.
 23850     PERFORM 8800-PRINT-ROUTINE.
 23851
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 458
* ECS010.cbl
 23852     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23853     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 23854     MOVE TR-TTL-HD               TO PRT.
 23855     PERFORM 8800-PRINT-ROUTINE.
 23856
 23857     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 23858     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 23859     MOVE TR-TTL-HD               TO PRT.
 23860     PERFORM 8800-PRINT-ROUTINE.
 23861
 23862     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23863     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 23864     MOVE TR-TTL-HD               TO PRT.
 23865     PERFORM 8800-PRINT-ROUTINE.
 23866
 23867     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 23868     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 23869     MOVE TR-TTL-HD               TO PRT.
 23870     PERFORM 8800-PRINT-ROUTINE.
 23871
 23872 9990-FINAL-CLOSE.
*23873                             COPY ELCPRTC.
 23874******************************************************************04/15/98
 23875*                                                                *ELCPRTC
 23876*                                                                *ELCPRTC
 23877*                            ELCPRTC.                            *   LV003
 23878*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23879*                            VMOD=2.002                          *   CL**2
 23880*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 23881*                                                                *ELCPRTC
 23882* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 23883******************************************************************ELCPRTC
 23884                                                                  ELCPRTC
 23885      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 23886          CLOSE FICH.                                             ELCPRTC
 23887                                                                  ELCPRTC
 23888******************************************************************ELCPRTC
 23889
 23890     IF DTE-CLIENT = 'DMD'
 23891         CLOSE ERRESC-IN.
 23892
 23893     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 23894
 23895     DISPLAY ' '.
 23896     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23897     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 23898     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23899     DISPLAY ' '.
 23900
 23901     MOVE    ' DISPLAY ERROR COUNT = '
 23902       TO  DIS-LINE-REASON.
 23903     MOVE  ERROR-COUNT
 23904       TO  DIS-LINE-REC.
 23905         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 23906
 23907     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 23908           DISPLAY-PRT
 23909           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 459
* ECS010.cbl
 23910           ME50-ECS010-BALANCE
 23911           PENDING-EXTRACT  SUMMARY-EXTR.
 23912
 23913     if (dte-client = 'DCC')
 23914        and (dte-pgm-opt = '1')
 23915        close new-detail-extr
 23916     end-if
 23917
 23918     IF DTE-PGM-OPT = '1'
 23919         CLOSE CERT-MASTER-OUT
 23920               DETAIL-EXTR
 23921     end-if
 23922
 23923     IF ERACCTT-FILE-STATUS NOT = '00'
 23924         MOVE '12'                TO ABEND-CODE-1
 23925         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 23926         DISPLAY '******************************'
 23927         DISPLAY '***** ERROR LOCATION 027 *****'
 23928         DISPLAY '******************************'
 23929         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23930           GO TO ABEND-PGM.
 23931
 23932     IF COMM-OPEN-SW = 'X'
 23933         CLOSE ERCTBL
 23934         IF ERCTBL-FILE-STATUS NOT = '00'
 23935             MOVE '42'               TO ABEND-CODE-1
 23936             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 23937             DISPLAY '******************************'
 23938             DISPLAY '***** ERROR LOCATION 028 *****'
 23939             DISPLAY '******************************'
 23940             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23941             GO TO ABEND-PGM.
 23942
 23943     IF REIN-OPEN-SW = 'X'
 23944         CLOSE ERRTBL-IN
 23945         IF ERRTBL-FILE-STATUS NOT = '00'
 23946             MOVE '22'               TO ABEND-CODE-1
 23947             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 23948             DISPLAY '******************************'
 23949             DISPLAY '***** ERROR LOCATION 029 *****'
 23950             DISPLAY '******************************'
 23951             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23952             GO TO ABEND-PGM.
 23953
 23954     MOVE 'C'                         TO CP-IO-FUNCTION.
 23955     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 23956     IF IO-ERROR
 23957         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 23958                                      TO WS-ABEND-MESSAGE
 23959         MOVE 0302                    TO WS-RETURN-CODE
 23960         DISPLAY '******************************'
 23961         DISPLAY '***** ERROR LOCATION 030 *****'
 23962         DISPLAY '******************************'
 23963         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23964         GO TO ABEND-PGM.
 23965
 23966     IF ME-DO-UPDATE
 23967           MOVE ME-START-TIME        TO ME-010-START
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 460
* ECS010.cbl
 23968           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 23969           ACCEPT WS-TIME-OF-DAY   FROM TIME
 23970           MOVE WS-TIME              TO ME-010-END
 23971           ADD 1 TO ME-010-RUN-CT
 23972           REWRITE MONTH-END-BALANCES
 23973           DISPLAY 'MONTH-END BALANCES POSTED'
 23974           CLOSE ERMEBL-INOUT
 23975     ELSE
 23976         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 23977
 23978     GO TO 9999-END-THE-JOB.
 23979
 23980 CERT-DATE-LOAD.
*23981     COPY ELCCRTM1.
 23982******************************************************************04/15/98
 23983*                                                                *ELCCRTM1
 23984*                                                                *ELCCRTM1
 23985*                            ELCCRTM1                            *   LV003
 23986*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23987*                            VMOD=2.001                          *ELCCRTM1
 23988*                                                                *ELCCRTM1
 23989*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 23990*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 23991*                                                                *ELCCRTM1
 23992******************************************************************ELCCRTM1
 23993     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 23994     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 23995     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 23996     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 23997     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 23998     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 23999     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 24000     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 24001     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 24002                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 24003     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 24004                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 24005     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 24006     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 24007     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 24008     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 24009     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 24010     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 24011           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 24012                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 24013     END-PERFORM.                                                 ELCCRTM1
 24014                                                                  ELCCRTM1
 24015
 24016 EXTRACT-DATE-LOAD.
*24017     COPY ELCEXTM1.
 24018******************************************************************04/15/98
 24019*                                                                *ELCEXTM1
 24020*                                                                *ELCEXTM1
 24021*                            ELCEXTM1                            *   LV010
 24022*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 24023*                            VMOD=2.001                          *ELCEXTM1
 24024*                                                                *ELCEXTM1
 24025*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 461
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 24026*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 24027*                                                                *ELCEXTM1
 24028******************************************************************ELCEXTM1
 24029                                                                  ELCEXTM1
 24030     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 24031     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 24032     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 24033     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 24034     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 24035     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 24036                                                                     CL**9
 24037     EVALUATE TRUE                                                   CL**5
 24038        WHEN DE-ISSUE      OR                                        CL**8
 24039             DE-RC-ISSUE   OR                                        CL**8
 24040             DE-RR-RC-ISS  OR                                        CL**8
 24041             DE-CANCEL     OR                                        CL**8
 24042             DE-RC-CANCEL  OR                                        CL**8
 24043             DE-RR-RC-CNC                                            CL**8
 24044           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 24045                                                                     CL**9
 24046        WHEN DE-CLAIM      OR                                        CL**8
 24047             DE-RR-RC-CLM                                            CL**6
 24048           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 24049           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 24050           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 24051           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 24052           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 24053           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 24054                                                                     CL**9
 24055        WHEN DE-RESERVE                                              CL**9
 24056           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 24057           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 24058           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 24059                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 24060           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 24061                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 24062           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 24063     END-EVALUATE.                                                   CL**9
 24064                                                                     CL**9
 24065
 24066 EXTRACT-DATE-RELOAD.
*24067     COPY ELCEXTM2.
 24068******************************************************************04/15/98
 24069*                                                                *ELCEXTM2
 24070*                                                                *ELCEXTM2
 24071*                            ELCEXTM2                            *   LV011
 24072*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 24073*                            VMOD=2.001                          *ELCEXTM2
 24074*                                                                *ELCEXTM2
 24075*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 24076*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 24077*                                                                *   CL**9
 24078******************************************************************ELCEXTM2
 24079                                                                  ELCEXTM2
 24080     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 24081     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 24082     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 24083     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 462
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 24084     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 24085     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
 24086                                                                     CL*10
 24087     EVALUATE TRUE                                                   CL*10
 24088        WHEN DE-ISSUE      OR                                        CL*10
 24089             DE-RC-ISSUE   OR                                        CL*10
 24090             DE-RR-RC-ISS  OR                                        CL*10
 24091             DE-CANCEL     OR                                        CL*10
 24092             DE-RC-CANCEL  OR                                        CL*10
 24093             DE-RR-RC-CNC                                            CL*10
 24094           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 24095                                                                     CL*10
 24096        WHEN DE-CLAIM      OR                                        CL*10
 24097             DE-RR-RC-CLM                                            CL**7
 24098           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 24099           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 24100           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 24101           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 24102           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 24103           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 24104                                                                     CL*10
 24105        WHEN DE-RESERVE                                              CL**7
 24106            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 24107            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 24108            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 24109                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 24110            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 24111                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 24112            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 24113     END-EVALUATE.                                                   CL**5
 24114                                                                  ELCEXTM2
 24115
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 463
* ECS010.cbl
 24117 ABEND-PGM.
 24118     DISPLAY '******************************'
 24119     DISPLAY '***** ABEND PGM **************'
 24120     DISPLAY '******************************'
*24121                             COPY ELCABEND.
 24122***************************************************************** 04/14/98
 24123*                                                               * ELCABEND
 24124*                            ELCABEND.                          *    LV003
 24125*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24126*                            VMOD 2.002                              CL**2
 24127*                                                               * ELCABEND
 24128*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 24129*            AND THEN ABENDS.                                   * ELCABEND
 24130*                                                               * ELCABEND
 24131*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 24132*                                                               * ELCABEND
 24133***************************************************************** ELCABEND
 24134*APS-010.                                                         ELCABEND
 24135     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 24136     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 24137                                                                  ELCABEND
 24138     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 24139         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24140         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24141                                 UPON CONSOLE.                    ELCABEND
 24142                                                                  ELCABEND
 24143     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 24144         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24145         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24146                                 UPON CONSOLE.                    ELCABEND
 24147                                                                  ELCABEND
 24148     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24149     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24150                                 UPON CONSOLE.                    ELCABEND
 24151                                                                  ELCABEND
 24152     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 24153     CALL 'ABORTME'.
 24154                                                                  ELCABEND
 24155 APS-EXIT.                                                        ELCABEND
 24156     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 464
* ECS010.cbl
 24158 9999-END-THE-JOB.
 24159
 24160     DISPLAY ' '.
 24161     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 24162         'ECS010 ******'
 24163     DISPLAY ' '.
 24164     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 465
* ECS010.cbl
 24165/
 24166 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 24167     IF LCP-ASA = '+'
 24168         WRITE MISMATCH-RPT AFTER 0 LINE
 24169     ELSE
 24170     IF LCP-ASA = ' '
 24171         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 24172     ELSE
 24173     IF LCP-ASA = '0'
 24174         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 24175     ELSE
 24176     IF LCP-ASA = '-'
 24177         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 24178     ELSE
 24179     IF LCP-ASA = '1'
 24180         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 24181     ELSE
 24182     IF LCP-ASA = '2'
 24183         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 24184     ELSE
 24185     IF LCP-ASA = '3'
 24186         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 24187     ELSE
 24188     IF LCP-ASA = '4'
 24189         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 24190     ELSE
 24191     IF LCP-ASA = '5'
 24192         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 24193     ELSE
 24194     IF LCP-ASA = '6'
 24195         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 24196     ELSE
 24197     IF LCP-ASA = '7'
 24198         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 24199     ELSE
 24200     IF LCP-ASA = '8'
 24201         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 24202     ELSE
 24203     IF LCP-ASA = '9'
 24204         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 24205     ELSE
 24206     IF LCP-ASA = 'A'
 24207         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 24208     ELSE
 24209     IF LCP-ASA = 'B'
 24210         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 24211     ELSE
 24212     IF LCP-ASA = 'C'
 24213         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 24214     ELSE
 24215     IF LCP-ASA = 'V'
 24216         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 24217     ELSE
 24218     IF LCP-ASA = 'W'
 24219         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 24220     ELSE
 24221     DISPLAY 'ASA CODE ERROR'.
 24222 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 08:52 Page 466
* ECS010.cbl
 24223     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  295
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     3652340     Code:      138485
