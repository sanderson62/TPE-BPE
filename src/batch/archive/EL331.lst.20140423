* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* EL331.cbl
* Options: int("EL331.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL331.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL331.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL331.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL331 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:30:06.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.037.
     9
    10*AUTHOR.     LOGIC INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* EL331.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*         THIS PROGRAM UPDATES THE ONLINE INFORCE FILE USING
    27*       AN EXTRACT FILE FROM ECS CREDIT SYSTEM- AN AUDIT
    28*       REPORT IS PRODUCED SHOWING THE CHANGE IN STATUS OF
    29*       THE CERTIFICATE HAVING ASSOCIATED CLAIMS.
    30*
    31*         THE PROGRAM ALSO LOADS AND MAINTAINS THE COMMISSION
    32*       EXCEPTION FILE (ERCOMM).
    33*
    34**** NOTE FOLLOWING FILES MUST BE CLOSED TO RUN THIS PROG
    35*            ERCOMM, ELCERT, ERMAIL
    36*
    37*       INPUT FILES-             CLAIM MASTER
    38*                                ACCOUNT MASTER (IF SYSTEM D)
    39*                                DATE CARD FILE
    40*                                CERTIFICATE MASTER
    41*                                ECS CERTIFICATE MASTER
    42*                                DISK DATE
    43*                                MAIL DATA
    44*
    45*       OUTPUT-                  CERT LOAD CONTROL PAGE
    46*                                ERCOMM FILE (IF SYSTEM D)
    47*                                CERTIFICATE MASTER
    48*                                (FICH FILE)
    49*                                MAIL DATA
    50*
    51******************************************************************
    52*                   C H A N G E   L O G
    53*
    54* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    55*-----------------------------------------------------------------
    56*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    57* EFFECTIVE    NUMBER
    58*-----------------------------------------------------------------
    59* 062104    2004050700001  SMVA  ADD NEW FILE TO AUTOMATE ME BALANCING
    60* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
    61* 020906                   PEMA  INCREASE SIZE OF LOAN OFFICER
    62* 042607    2007032700002  PEMA  KEEP SPEC VA STUFF ON LINE
    63* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    64* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    65* 032612  CR2011110200001  PEMA  AHL CHANGES
    66******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* EL331.cbl
    68 ENVIRONMENT DIVISION.
    69
    70 INPUT-OUTPUT SECTION.
    71
    72 FILE-CONTROL.
    73
    74     SELECT PRNTR            ASSIGN TO SYS008.
    75
    76     SELECT DISK-DATE        ASSIGN TO SYS019.
    77
    78     SELECT FICH             ASSIGN TO SYS020.
    79
    80     SELECT ME50-EL331-BALANCE
    81                             ASSIGN TO SYS015
    82                             ORGANIZATION IS LINE SEQUENTIAL.
    83
    84     SELECT ECSCRT01         ASSIGN TO SYS010.
    85
    86     SELECT ELMSTR5          ASSIGN TO SYS011-3380-ELMSTR5
    87                             ORGANIZATION IS INDEXED
    88                             ACCESS IS DYNAMIC
    89                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
    90                             FILE STATUS IS CL-STATUS.
    91
    92     SELECT ELRETR5          ASSIGN TO SYS011-3380-ELRETR5
    93                             ORGANIZATION IS INDEXED
    94                             ACCESS IS DYNAMIC
    95                             RECORD KEY IS RL-CONTROL-BY-CERT-NO
    96                             FILE STATUS IS ELRETR5-FILE-STATUS.
    97
    98     SELECT ELCERTF          ASSIGN TO SYS012-3380-ELCERT
    99                             ORGANIZATION IS INDEXED
   100                             ACCESS IS DYNAMIC
   101                             RECORD KEY IS CM-CONTROL-PRIMARY
   102                             FILE STATUS IS CM-STATUS.
   103
   104     SELECT ERCOMM           ASSIGN TO SYS013-3380-ERCOMM
   105                             ORGANIZATION IS INDEXED
   106                             ACCESS IS DYNAMIC
   107                             RECORD KEY IS CE-CONTROL-PRIMARY
   108                             FILE STATUS IS CE-STATUS.
   109
   110     SELECT ERACCT           ASSIGN TO SYS014-3380-ERACCT
   111                             ORGANIZATION IS INDEXED
   112                             ACCESS IS DYNAMIC
   113                             RECORD KEY IS AM-CONTROL-PRIMARY
   114                             FILE STATUS IS AM-STATUSF.
   115
   116     SELECT ELREPT           ASSIGN TO SYS018-3380-ELREPT
   117                             ORGANIZATION IS INDEXED
   118                             ACCESS IS DYNAMIC
   119                             RECORD KEY IS RF-CONTROL-PRIMARY
   120                             FILE STATUS IS DTE-VSAM-FLAGS.
   121
   122     SELECT ERMEBL           ASSIGN SYS024-3380-ERMEBL
   123                             ORGANIZATION INDEXED
   124                             ACCESS DYNAMIC
   125                             RECORD KEY ME-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* EL331.cbl
   126                             FILE STATUS ERMEBL-FILE-STATUS.
   127
   128     SELECT ERMAIL           ASSIGN TO SYS021-3380-ERMAIL
   129                             ORGANIZATION IS INDEXED
   130                             ACCESS IS RANDOM
   131                             RECORD KEY IS MA-CONTROL-PRIMARY
   132                             FILE STATUS IS ERMAIL-FILE-STATUS.
   133
   134     SELECT ERCTBL           ASSIGN TO ERCTBLT
   135                             ORGANIZATION IS INDEXED
   136                             ACCESS IS RANDOM
   137                             RECORD KEY IS CT-CONTROL-PRIMARY
   138                             FILE STATUS IS ERCTBL-FILE-STATUS.
   139
   140     SELECT  DISPLAY-PRT     ASSIGN TO SYS022-UR-1403-S-SYS022.
   141
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* EL331.cbl
   143
   144 DATA DIVISION.
   145
   146 FILE SECTION.
   147
   148 FD  PRNTR
*                                      COPY ELCPRTFD.
   149******************************************************************04/15/98
   150*                                                                *ELCPRTFD
   151*                                                                *ELCPRTFD
   152*                            ELCPRTFD.                           *   LV003
   153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   154*                            VMOD=2.006                          *ELCPRTFD
   155******************************************************************ELCPRTFD
   156     RECORDING MODE F                                             ELCPRTFD
   157     LABEL RECORDS OMITTED                                        ELCPRTFD
   158     BLOCK CONTAINS 0 RECORDS
   159     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   160 01  PRT.                                                         ELCPRTFD
   161     12  P-CTL               PIC  X.                                 CL**2
   162     12  P-DATA              PIC  X(132).                         ELCPRTFD
   163******************************************************************ELCPRTFD
   164
   165 FD  ME50-EL331-BALANCE
   166     RECORDING MODE IS F
   167     BLOCK CONTAINS 0 RECORDS.
   168 01  ME50-EL331-BALANCE-REC    PIC X(95).
   169
   171 FD  ECSCRT01
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* EL331.cbl
*                                      COPY ECSCRIFD.
   172******************************************************************07/10/97
   173*                                                                *ECSCRIFD
   174*                            ECSCRIFD                            *   LV001
   175*                            VMOD 2.005                          *ECSCRIFD
   176*                                                                *ECSCRIFD
   177*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   178*                                                                *ECSCRIFD
   179******************************************************************ECSCRIFD
   180     BLOCK CONTAINS 0 RECORDS
   181     RECORDING MODE F.                                            ECSCRIFD
   182                                                                  ECSCRIFD
   183 01  CERT-IN-RECORD.                                              ECSCRIFD
   184                                                                  ECSCRIFD
   185     12  FILLER                            PIC XXX.               ECSCRIFD
   186     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   187     12  FILLER                            PIC X(66).             ECSCRIFD
   188     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   189     12  FILLER                            PIC X(20).             ECSCRIFD
   190     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   191     12  FILLER                            PIC X(14).             ECSCRIFD
   192     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   193     12  FILLER                            PIC X(39).             ECSCRIFD
   194     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   195     12  FILLER                            PIC X(45).             ECSCRIFD
   196     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   197     12  FILLER                            PIC X(35).             ECSCRIFD
   198     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   199     12  FILLER                            PIC X(41).             ECSCRIFD
   200     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   201     12  FILLER                            PIC X(48).             ECSCRIFD
   202     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   203     12  FILLER                            PIC X(9).              ECSCRIFD
   204     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   205     12  FILLER                            PIC X(120).            ECSCRIFD
   206     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   207     12  FILLER                            PIC X(73).             ECSCRIFD
   208     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   209     12  FILLER                            PIC X(464).            ECSCRIFD
   210                                                                  ECSCRIFD
   211******************************************************************ECSCRIFD
   212
*  213             COPY ECSCRT01 REPLACING CERTIFICATE-MASTER
*  214                                  BY ECS-CERT-RECORD.
   215******************************************************************
   216*                                                                *
   217*                            ECSCRT01                            *
   218*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   219*                            VMOD=2.016                          *
   220*                                                                *
   221*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   222*                                                                *
   223*   FILE TYPE = SEQUENTIAL
   224*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   225*                                                                *
   226*   KEY DATA =                         START=4, LEN=36           *
   227*                                                                *
   228*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   229*                                                                *
   230******************************************************************
   231******************************************************************
   232*                   C H A N G E   L O G
   233*
   234* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   235*-----------------------------------------------------------------
   236*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   237* EFFECTIVE    NUMBER
   238*-----------------------------------------------------------------
   239* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   240* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   241* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   242* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   243* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   244* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   245* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   246* 032612  CR2011110200001  PEMA  AHL CHANGES
   247******************************************************************
   248
   249 01  CERTIFICATE-RECORD.
   250     12  CR-RECORD-ID                      PIC XX.
   251         88  VALID-CR-ID                      VALUE 'CR'.
   252
   253     12  CR-COMPANY-CD                     PIC X.
   254
   255     12  CR-FULL-CONTROL.
   256         16  CR-CONTROL-1.
   257             20  CR-ACCT-CONTROL.
   258                 24  CR-CARRIER            PIC X.
   259                 24  CR-GROUPING.
   260                     28  CR-GROUP-PREFIX   PIC XXX.
   261                     28  CR-GROUP-PRIME    PIC XXX.
   262                 24  CR-STATE              PIC XX.
   263                 24  CR-ACCOUNT.
   264                     28  CR-ACCT-PREFIX    PIC X(4).
   265                     28  CR-ACCT-PRIME     PIC X(6).
   266             20  CR-DT                     PIC 9(11)  COMP-3.
   267         16  CR-CERT-NO.
   268             20  CR-CERT.
   269                 24  CR-CERT-PREFIX        PIC X(3).
   270                 24  CR-CERT-PRIME         PIC X(7).
   271             20  CR-CERT-SFX               PIC X.
   272
   273     12  CR-INSUREDS-PROFILE.
   274         16  CR-NAME.
   275             20  CR-LNAME                  PIC X(15).
   276             20  CR-FNAME.
   277                 24  CR-1ST-INITIAL        PIC X.
   278                 24  FILLER                PIC X(9).
   279             20  CR-INIT                   PIC X.
   280         16  CR-AGE                        PIC 99.
   281         16  CR-SEX                        PIC X.
   282             88  CR-SEX-MALE                  VALUE 'M'.
   283             88  CR-SEX-FEMALE                VALUE 'F'.
   284         16  CR-SOC-SEC                    PIC X(11).
   285         16  CR-JOINT-NAME.
   286             20  CR-JT-LNAME               PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   287             20  CR-JT-FNAME.
   288                 24  CR-JT-1ST-INIT        PIC X.
   289                 24  FILLER                PIC X(9).
   290             20  CR-JT-INIT                PIC X.
   291         16  CR-JOINT-AGE                  PIC 99.
   292
   293         16  cr-ahl-ah-claim-no            pic x(9).
   294         16  cr-ahl-ah-cert-seq            pic x(3).
   295         16  cr-hst-proc-lf                pic x.
   296         16  f                             pic x(7).
   297
   298     12  CR-LF-COVERAGE-DATA.
   299         16  CR-LFTYP                      PIC XX.
   300         16  CR-LF-TERM                    PIC S999       COMP-3.
   301         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   302         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   303         16  CR-LF-DEV-CODE                PIC XXX.
   304         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   305
   306         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   307         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   308         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   309         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   310
   311         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   312         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   313         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   314         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   315
   316         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   317         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   318
   319         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   320         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   321
   322         16  CR-LF-REFUND-TYPE             PIC X.
   323         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   324
   325         16  CR-LF-COMM-CHARGEBACK         PIC X.
   326             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   327
   328         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   329
   330         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   331         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   332         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   333
   334         16  cr-ahl-lf-claim-no            pic x(9).
   335         16  cr-ahl-lf-cert-seq            pic x(3).
   336         16  FILLER                        PIC XX.
   337
   338     12  CR-AH-COVERAGE-DATA.
   339         16  CR-AHTYP                      PIC XX.
   340         16  CR-AH-TERM                    PIC S999       COMP-3.
   341         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   342         16  CR-AH-DEV-CODE                PIC XXX.
   343         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   344
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   345         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   346         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   347         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   348         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   349
   350         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   351         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   352
   353         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   354         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   355
   356         16  CR-AH-REFUND-TYPE             PIC X.
   357         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   358
   359         16  CR-AH-COMM-CHARGEBACK         PIC X.
   360             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   361
   362         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   363
   364         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   365         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   366         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   367
   368         16  FILLER                        PIC XX.
   369*        16  FILLER                        PIC X(8).
   370
   371     12  CR-LOAN-DATA.
   372         16  CR-LIVES                      PIC S9(7)      COMP-3.
   373         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   374                                           PIC S9(5)V99   COMP-3.
   375         16  CR-BILLED                     PIC S9(7)      COMP-3.
   376         16  CR-APR                        PIC S999V9(4)  COMP-3.
   377         16  CR-PMT-FREQ                   PIC 99.
   378         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   379         16  CR-RATING-CLASS               PIC XX.
   380         16  CR-POLICY-FORM-NO             PIC X(12).
   381         16  CR-GRPTYP                     PIC XX.
   382         16  CR-IND-GRP                    PIC X.
   383             88  CR-INDIVIDUAL                VALUE '1'.
   384             88  CR-GROUP                     VALUE '2'.
   385         16  CR-SKIP                       PIC 99.
   386             88  NO-MONTHS-SKIPPED            VALUE 00.
   387             88  SKIP-JULY                    VALUE 01.
   388             88  SKIP-AUGUST                  VALUE 02.
   389             88  SKIP-SEPTEMBER               VALUE 03.
   390             88  SKIP-JULY-AUG                VALUE 04.
   391             88  SKIP-AUG-SEPT                VALUE 05.
   392             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   393             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   394             88  SKIP-JUNE                    VALUE 08.
   395             88  SKIP-JUNE-JULY               VALUE 09.
   396             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   397             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   398         16  CR-RESIDENT-STATE             PIC XX.
   399         16  CR-RATE-CODE.
   400             20  CR-LF-CLASS-CD            PIC XX.
   401             20  CR-AH-CLASS-CD            PIC XX.
   402         16  CR-MORT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   403             20  CR-TAB                    PIC X.
   404             20  CR-INT                    PIC 99.
   405             20  CR-GRP                    PIC X.
   406         16  CR-MEMBER-NO                  PIC X(12).
   407         16  CR-OLD-LOF                    PIC XXX.
   408*        16  CR-LOAN-OFFICER               PIC XXX.
   409         16  CR-REIN-TABLE                 PIC XXX.
   410         16  CR-REIN-SPEC                  PIC X.
   411         16  CR-LOAN-1ST-PMT-DT.
   412             20  CR-1ST-PMT-YR             PIC 99.
   413             20  CR-1ST-PMT-MO             PIC 99.
   414             20  CR-1ST-PMT-DA             PIC 99.
   415         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   416         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   417         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   418         16  CR-LAST-ADD-ON-DT             PIC XX.
   419
   420         16  CR-UNDERWRITING-CODE          PIC X.
   421             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   422
   423         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   424         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   425         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   426         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   427
   428     12  CR-STATUS-INFORMATION.
   429         16  CR-ENTRY-STATUS               PIC X.
   430             88  CR-NORMAL-ENTRY              VALUE '1'.
   431             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   432             88  CR-CONVERSION-ENTRY          VALUE '4'.
   433             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   434             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   435             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   436             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   437             88  CR-POLICY-IS-VOID            VALUE 'V'.
   438             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   439             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   440                                                    '5' '9' 'P'.
   441         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   442
   443         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   444         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   445         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   446
   447         16  CR-LF-STATUS-AT-DEATH         PIC X.
   448         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   449
   450         16  CR-LF-CURRENT-STATUS          PIC X.
   451             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   452             88  CR-LF-POLICY-PENDING         VALUE '2'.
   453             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   454             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   455             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   456             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   457             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   458             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   459             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   460             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   461             88  CR-LF-IS-DECLINED            VALUE 'D'.
   462             88  CR-LF-IS-VOID                VALUE 'V'.
   463             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   464                                                    '4' '5' '9'.
   465
   466         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   467
   468         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   469         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   470
   471         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   472         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   473
   474         16  CR-AH-CURRENT-STATUS          PIC X.
   475             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   476             88  CR-AH-POLICY-PENDING         VALUE '2'.
   477             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   478             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   479             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   480             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   481             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   482             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   483             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   484             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   485             88  CR-AH-IS-DECLINED            VALUE 'D'.
   486             88  CR-AH-IS-VOID                VALUE 'V'.
   487             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   488                                                    '4' '5' '9'.
   489         16  CR-LOAN-OFFICER               PIC X(5).
   490         16  CR-CANCEL-REASON              PIC X.
   491         16  cr-xycor-lf-cov-code          pic x(4).
   492         16  cr-xycor-ah-cov-code          pic x(4).
   493         16  FILLER                        PIC X(6).
   494
   495     12  CR-DEATH-CLAIM-DATA.
   496         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   497
   498         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   499         16  CR-DTH-RPT-DT.
   500             20  CR-DTH-RPT-YR             PIC 99.
   501             20  CR-DTH-RPT-MO             PIC 99.
   502             20  CR-DTH-RPT-DA             PIC 99.
   503         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   504
   505         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   506         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   507         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   508         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   509         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   510
   511         16  CR-DTH-AGE                    PIC 99.
   512         16  CR-DTH-PAY-CD                 PIC X.
   513         16  CR-DEATH-CAUSE                PIC X(6).
   514
   515         16  FILLER                        PIC X(16).
   516
   517     12  CR-DISAB-CLAIM-DATA.
   518         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   519
   520         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   521         16  CR-DIS-RPT-DT.
   522             20  CR-DIS-RPT-YR             PIC 99.
   523             20  CR-DIS-RPT-MO             PIC 99.
   524             20  CR-DIS-RPT-DA             PIC 99.
   525         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   526         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   527
   528         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   529         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   530         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   531         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   532         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   533
   534         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   535         16  CR-DIS-PAY-CD                 PIC X.
   536         16  FILLER                        PIC XX.
   537
   538         16  CR-DISAB-INCURRED-DETAIL.
   539             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   540**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   541                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   542                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   543                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   544
   545         16  CR-DISAB-CAUSE                PIC X(6).
   546         16  FILLER                        PIC X(14).
   547
   548     12  CR-REMIT-TO                       PIC 99.
   549
   550     12  CR-COMPENSATION-LEVELS.
   551         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   552             20  CR-COM-AGT.
   553                 24  CR-COM-AGT-PREFIX     PIC X(4).
   554                 24  CR-COM-AGT-PRIME      PIC X(6).
   555             20  CR-AGT-TYPE               PIC X.
   556             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   557             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   558
   559     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   560     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   561     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   562     12  CR-CLP-STATE                      PIC XX.
   563     12  CR-POST-CARD-IND                  PIC X.
   564     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   565     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   566     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   567     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   568     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   569     12  FILLER                            PIC X(07).
   570
   571     12  CR-CSR-CODE                       PIC XXX.
   572
   573     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   574     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   575
   576     12  CR-MICROFILM-NUMBERS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   577*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   578         16  FILLER                        PIC X(5).
   579     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   580
   581     12  CR-USER-CODE                      PIC X.
   582     12  CR-USER-FUTURE                    PIC X(9).
   583
   584     12  CR-BENEFICIARY.
   585         16  CR-BANK-NO                    PIC X(10).
   586         16  FILLER                        PIC X(15).
   587
   588     12  CR-ENTRY-BATCH                    PIC X(6).
   589     12  CR-LF-EXIT-BATCH                  PIC X(6).
   590     12  CR-AH-EXIT-BATCH                  PIC X(6).
   591
   592     12  CR-NOTE-SW                        PIC X.
   593
   594     12  CR-ORIGIN-INDICATOR               PIC X.
   595         88  CR-ENTERED-MANUALLY              VALUE '1'.
   596         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   597
   598     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   599     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   600     12  FILLER                            PIC X(33).
   601
   602******************************************************************
   603
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* EL331.cbl
   605 FD  ELCERTF.
*  606                                 COPY ELCCERT.
   607******************************************************************04/15/98
   608*                                                                *ELCCERT
   609*                            ELCCERT.                            *   LV002
   610*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   611*                            VMOD=2.013                          *   CL**2
   612*                                                                *ELCCERT
   613*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
   614*                                                                *ELCCERT
   615*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
   616*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
   617*                                                                *ELCCERT
   618*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
   619*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
   620*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
   621*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
   622*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
   623*                                                                *ELCCERT
   624*   LOG = YES                                                    *ELCCERT
   625*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
   626******************************************************************
   627*                   C H A N G E   L O G
   628*
   629* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   630*-----------------------------------------------------------------
   631*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   632* EFFECTIVE    NUMBER
   633*-----------------------------------------------------------------
   634* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   635* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   636* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   637* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   638* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   639* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   640* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   641* 032612  CR2011110200001  PEMA  AHL CHANGES
   642******************************************************************
   643                                                                  ELCCERT
   644 01  CERTIFICATE-MASTER.                                          ELCCERT
   645     12  CM-RECORD-ID                      PIC XX.                ELCCERT
   646         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
   647                                                                  ELCCERT
   648     12  CM-CONTROL-PRIMARY.                                      ELCCERT
   649         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
   650         16  CM-CARRIER                    PIC X.                 ELCCERT
   651         16  CM-GROUPING.                                         ELCCERT
   652             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
   653             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
   654         16  CM-STATE                      PIC XX.                ELCCERT
   655         16  CM-ACCOUNT.                                          ELCCERT
   656             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
   657             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
   658         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
   659         16  CM-CERT-NO.                                          ELCCERT
   660             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
   661             20  CM-CERT-SFX               PIC X.                 ELCCERT
   662                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   663     12  CM-CONTROL-BY-NAME.                                      ELCCERT
   664         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
   665         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
   666         16  CM-INSURED-INITIALS.                                 ELCCERT
   667             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
   668             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
   669                                                                  ELCCERT
   670     12  CM-CONTROL-BY-SSN.                                       ELCCERT
   671         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
   672         16  CM-SOC-SEC-NO.                                       ELCCERT
   673             20  CM-SSN-STATE              PIC XX.                ELCCERT
   674             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
   675             20  CM-SSN-LN3.                                      ELCCERT
   676                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
   677                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
   678                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
   679                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
   680                                                                  ELCCERT
   681     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
   682         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
   683         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
   684                                                                  ELCCERT
   685     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
   686         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
   687         16  CM-MEMBER-NO.                                        ELCCERT
   688             20  CM-MEMB-STATE             PIC XX.                ELCCERT
   689             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
   690             20  CM-MEMB-LN4.                                     ELCCERT
   691                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
   692                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
   693                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
   694                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
   695                                                                  ELCCERT
   696     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
   697         16  CM-INSURED-FIRST-NAME.                               ELCCERT
   698             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
   699             20  FILLER                    PIC X(9).              ELCCERT
   700         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
   701         16  CM-INSURED-SEX                PIC X.                 ELCCERT
   702             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
   703             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
   704         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
   705         16  CM-JOINT-INSURED-NAME.                               ELCCERT
   706             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
   707             20  CM-JT-FIRST-NAME.                                ELCCERT
   708                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
   709                 24  FILLER                PIC X(9).              ELCCERT
   710             20  CM-JT-INITIAL             PIC X.                 ELCCERT
   711                                                                  ELCCERT
   712     12  CM-LIFE-DATA.                                            ELCCERT
   713         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
   714         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
   715         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
   716         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
   717         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
   718         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
   719         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
   720         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   721         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
   722         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   723         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   724         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
   725         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
   726         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
   727         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
   728         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
   729         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
   730         16  FILLER                        PIC XX.                ELCCERT
   731                                                                  ELCCERT
   732     12  CM-AH-DATA.                                              ELCCERT
   733         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
   734         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
   735         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
   736         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
   737         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
   738         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   739         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   740         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   741         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
   742         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
   743         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
   744         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
   745             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
   746         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
   747         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
   748         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
   749         16  FILLER                        PIC X.                 ELCCERT
   750                                                                  ELCCERT
   751     12  CM-LOAN-INFORMATION.                                     ELCCERT
   752         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
   753         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   754                                           PIC S9(5)V99  COMP-3.
   755         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
   756         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
   757         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
   758         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
   759         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
   760         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
   761         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
   762         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
   763         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
   764         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
   765             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
   766             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
   767         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
   768             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
   769             20  CM-RATE-CODE              PIC X(4).              ELCCERT
   770             20  FILLER                    PIC XX.                ELCCERT
   771         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
   772             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
   773             20  FILLER                    PIC XXX.               ELCCERT
   774         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
   775         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
   776             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
   777         16  CM-POST-CARD-IND              PIC X.
   778         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   779         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
   780             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
   781             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
   782             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
   783         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
   784             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
   785             88  CM-GROUP                     VALUE 'G'.          ELCCERT
   786         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
   787             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
   788             88  SKIP-JULY                    VALUE '1'.          ELCCERT
   789             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
   790             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
   791             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
   792             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
   793             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
   794             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
   795             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
   796             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
   797             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
   798             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
   799         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
   800             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
   801             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
   802             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
   803             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
   804             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
   805         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
   806         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
   807         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
   808*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
   809         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
   810         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
   811         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
   812         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
   813         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
   814                                                                  ELCCERT
   815     12  CM-STATUS-DATA.                                          ELCCERT
   816         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
   817         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
   818                                                                  ELCCERT
   819         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
   820         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
   821         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
   822                                                                  ELCCERT
   823         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
   824         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
   825         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
   826                                                                  ELCCERT
   827         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
   828             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
   829                                                'M' '4' '5' '9'.  ELCCERT
   830             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
   831             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
   832             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
   833             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
   834             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
   835             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
   836             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   837             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
   838             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
   839             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
   840             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
   841             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
   842                                                                  ELCCERT
   843         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
   844         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
   845         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
   846                                                                  ELCCERT
   847         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
   848         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
   849         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
   850                                                                  ELCCERT
   851         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
   852             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
   853                                                'M' '4' '5' '9'.  ELCCERT
   854             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
   855             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
   856             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
   857             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
   858             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
   859             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
   860             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
   861             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
   862             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
   863             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
   864             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
   865             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
   866                                                                  ELCCERT
   867         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
   868             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
   869             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
   870             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
   871         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
   872                                                                  ELCCERT
   873         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
   874         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
   875         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
   876         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
   877                                                                  ELCCERT
   878     12  CM-NOTE-SW                        PIC X.                 ELCCERT
   879         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
   880         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
   881         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
   882         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
   883         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   884         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   885         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   886         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   887     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
   888         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
   889         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
   890     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
   891         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
   892         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
   893                                                                  ELCCERT
   894*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   895     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   896     12  FILLER                            PIC X.
   897                                                                  ELCCERT
   898*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
   899     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   900     12  FILLER                            PIC X.
   901*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
   902     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
   903                                                                  ELCCERT
   904     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
   905         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
   906         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
   907         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
   908         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
   909         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
   910     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
   911         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
   912         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
   913         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
   914         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
   915         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
   916         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
   917         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
   918         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
   919                                                                  ELCCERT
   920     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
   921         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
   922         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
   923                                                                  ELCCERT
   924     12  CM-USER-FIELD                     PIC X.                 ELCCERT
   925     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   926     12  CM-CLP-STATE                      PIC XX.
   927     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   928     12  CM-USER-RESERVED                  PIC XXX.
   929     12  FILLER REDEFINES CM-USER-RESERVED.
   930         16  CM-AH-CLASS-CD                PIC XX.
   931         16  F                             PIC X.
   932******************************************************************ELCCERT
   933
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* EL331.cbl
   935 FD  ERCOMM.
   936
*  937                                 COPY ERCCOMM.
   938******************************************************************04/29/98
   939*                                                                *ERCCOMM
   940*                                                                *ERCCOMM
   941*                            ERCCOMM                             *   LV002
   942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   943*                            VMOD=2.003                          *   CL**2
   944*                                                                *ERCCOMM
   945*        FILE DESCRIPTION = COMPENSATION RATES WHEN DIFFERENT    *ERCCOMM
   946*                             FROM THOSE IN ACCOUNT MASTER       *ERCCOMM
   947*                                                                *ERCCOMM
   948*        FILE TYPE= VSAM,KSDS                                    *ERCCOMM
   949*        RECORD SIZE = 250    RECFORM = FIXED                    *ERCCOMM
   950*                                                                *ERCCOMM
   951*        BASE CLUSTER = CRCOMM        RKP=2,LEN=33               *ERCCOMM
   952*                                                                *ERCCOMM
   953*        LOG = YES                                               *ERCCOMM
   954*        SERVREQ = DELETE,UPDATE,NEWREC                          *ERCCOMM
   955*                                                                *ERCCOMM
   956******************************************************************ERCCOMM
   957                                                                  ERCCOMM
   958 01  COMMISSION-EXCEPTIONS.                                       ERCCOMM
   959     12  CE-RECORD-ID                PIC  XX.                     ERCCOMM
   960         88  VALID-CE-ID         VALUE 'CE'.                      ERCCOMM
   961                                                                  ERCCOMM
   962     12  CE-CONTROL-PRIMARY.                                      ERCCOMM
   963         16  CE-COMPANY-CD           PIC  X.                      ERCCOMM
   964         16  CE-CARRIER              PIC  X.                      ERCCOMM
   965         16  CE-GROUPING             PIC  X(6).                   ERCCOMM
   966         16  CE-STATE                PIC  XX.                     ERCCOMM
   967         16  CE-ACCOUNT              PIC  X(10).                  ERCCOMM
   968         16  CE-CERT-EFF-DT          PIC  XX.                     ERCCOMM
   969         16  CE-CERT-NO.                                          ERCCOMM
   970             20  CE-CERT-PRIME       PIC  X(10).                  ERCCOMM
   971             20  CE-CERT-SFX         PIC  X.                      ERCCOMM
   972                                                                  ERCCOMM
   973     12  CE-CERT-EXPIRATION-DT       PIC  XX.                     ERCCOMM
   974                                                                  ERCCOMM
   975     12  CE-COMP-STRUCTURE.                                       ERCCOMM
   976         16  CE-DEFN-1.                                           ERCCOMM
   977             20  CE-AGT-COMMS       OCCURS 10 TIMES.              ERCCOMM
   978                 24  CE-AGENT-NO    PIC  X(10).                   ERCCOMM
   979                 24  CE-COMP-TYPE   PIC  X.                       ERCCOMM
   980                 24  CE-LF-COMP     PIC SV9(5)      COMP-3.       ERCCOMM
   981                 24  CE-AH-COMP     PIC SV9(5)      COMP-3.       ERCCOMM
   982         16  CE-DEFN-2              REDEFINES CE-DEFN-1.          ERCCOMM
   983             20  CE-COMP-TABLES     OCCURS 10 TIMES.              ERCCOMM
   984                 24  FILLER         PIC  X(11).                   ERCCOMM
   985                 24  CE-LF-COMPT    PIC  X(3).                    ERCCOMM
   986                 24  CE-AH-COMPT    PIC  X(3).                    ERCCOMM
   987                                                                  ERCCOMM
   988     12  FILLER                     PIC  X(43).                   ERCCOMM
   989******************************************************************ERCCOMM
   990
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* EL331.cbl
   992 FD  ERACCT.
   993
*  994                                 COPY ERCACCT.
   995******************************************************************04/19/98
   996*                                                                *ERCACCT
   997*                                                                *ERCACCT
   998*                            ERCACCT                             *   LV031
   999*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  1000*                            VMOD=2.031                          *ERCACCT
  1001*                                                                *ERCACCT
  1002*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  1003*                                                                *ERCACCT
  1004*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  1005*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  1006*                                                                *ERCACCT
  1007*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  1008*                                                                *ERCACCT
  1009*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  1010*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  1011*                                                                *ERCACCT
  1012*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  1013*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  1014*                                                                *ERCACCT
  1015*   LOG = NO                                                     *ERCACCT
  1016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  1017*                                                                *ERCACCT
  1018*                                                                *ERCACCT
  1019******************************************************************ERCACCT
  1020*                   C H A N G E   L O G
  1021*
  1022* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1023*-----------------------------------------------------------------
  1024*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1025* EFFECTIVE    NUMBER
  1026*-----------------------------------------------------------------
  1027* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1028* 092705    2005050300006  PEMA  ADD SPP LEASES
  1029* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1030* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1031* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1032* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1033* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1034******************************************************************
  1035                                                                  ERCACCT
  1036 01  ACCOUNT-MASTER.                                              ERCACCT
  1037     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  1038         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  1039                                                                  ERCACCT
  1040     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  1041         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  1042         16  AM-MSTR-CNTRL.                                       ERCACCT
  1043             20  AM-CONTROL-A.                                    ERCACCT
  1044                 24  AM-CARRIER            PIC X.                 ERCACCT
  1045                 24  AM-GROUPING.                                 ERCACCT
  1046                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  1047                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  1048                 24  AM-STATE              PIC XX.                ERCACCT
  1049                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1050                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  1051                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  1052             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  1053                                           PIC X(19).             ERCACCT
  1054             20  AM-CNTRL-B.                                      ERCACCT
  1055                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  1056                 24  FILLER                PIC X(4).              ERCACCT
  1057             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  1058                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  1059                                                                  ERCACCT
  1060     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  1061         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  1062         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  1063         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  1064         16  AM-VG-STATE                   PIC XX.                ERCACCT
  1065         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  1066         16  AM-VG-DATE.                                          ERCACCT
  1067             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  1068             20  FILLER                    PIC X(4).              ERCACCT
  1069         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  1070                                           PIC 9(11)      COMP-3. ERCACCT
  1071     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1072         16  FILLER                        PIC X(10).
  1073         16  AM-VG-KEY3.
  1074             20  AM-VG3-ACCOUNT            PIC X(10).
  1075             20  AM-VG3-EXP-DT             PIC XX.
  1076         16  FILLER                        PIC X(4).
  1077     12  AM-MAINT-INFORMATION.                                    ERCACCT
  1078         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  1079         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  1080         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  1081         16  FILLER                        PIC XX.                ERCACCT
  1082                                                                  ERCACCT
  1083     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  1084     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  1085                                                                  ERCACCT
  1086     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  1087         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  1088         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  1089                                                                  ERCACCT
  1090     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  1091     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  1092                                                                  ERCACCT
  1093     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  1094     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  1095                                                                  ERCACCT
  1096     12  AM-NAME                           PIC X(30).             ERCACCT
  1097     12  AM-PERSON                         PIC X(30).             ERCACCT
  1098     12  AM-ADDRS                          PIC X(30).             ERCACCT
  1099     12  AM-CITY.
  1100         16  AM-ADDR-CITY                  PIC X(28).
  1101         16  AM-ADDR-STATE                 PIC XX.
  1102     12  AM-ZIP.                                                  ERCACCT
  1103         16  AM-ZIP-PRIME.                                        ERCACCT
  1104             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  1105                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  1106             20  FILLER                    PIC X(4).              ERCACCT
  1107         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1108     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  1109         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  1110         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  1111         16  FILLER                        PIC XXX.               ERCACCT
  1112     12  AM-TEL-NO.                                               ERCACCT
  1113         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  1114         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  1115         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  1116     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  1117         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  1118         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  1119                                                                  ERCACCT
  1120     12  AM-COMM-STRUCTURE.                                       ERCACCT
  1121         16  AM-DEFN-1.                                           ERCACCT
  1122             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  1123                 24  AM-AGT.                                      ERCACCT
  1124                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  1125                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  1126                 24  AM-COM-TYP            PIC X.                 ERCACCT
  1127                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  1128                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  1129                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  1130                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  1131                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  1132                 24  AM-GL-CODES           PIC X.                 ERCACCT
  1133                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  1134                 24  FILLER                PIC X(01).             ERCACCT
  1135         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  1136             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  1137                 24  FILLER                PIC X(11).             ERCACCT
  1138                 24  AM-L-COMA             PIC XXX.               ERCACCT
  1139                 24  AM-J-COMA             PIC XXX.               ERCACCT
  1140                 24  AM-A-COMA             PIC XXX.               ERCACCT
  1141                 24  FILLER                PIC X(6).              ERCACCT
  1142                                                                  ERCACCT
  1143     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  1144         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  1145                                                                  ERCACCT
  1146     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  1147                                                                  ERCACCT
  1148     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  1149         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  1150         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  1151     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  1152         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  1153         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  1154     12  AM-GPCD                           PIC 99.                ERCACCT
  1155     12  AM-IG                             PIC X.                 ERCACCT
  1156         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  1157         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  1158     12  AM-STATUS                         PIC X.                 ERCACCT
  1159         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  1160         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  1161         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  1162         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1163         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1164         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1165     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1166     12  AM-ID-NO                          PIC X(11).             ERCACCT
  1167                                                                  ERCACCT
  1168     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  1169     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  1170     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  1171     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  1172     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  1173     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  1174     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  1175     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  1176     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  1177                                                                  ERCACCT
  1178     12  AM-USER-FIELDS.                                          ERCACCT
  1179         16  AM-FLD-1                      PIC XX.                ERCACCT
  1180         16  AM-FLD-2                      PIC XX.                ERCACCT
  1181         16  AM-FLD-3                      PIC XX.                ERCACCT
  1182         16  AM-FLD-4                      PIC XX.                ERCACCT
  1183         16  AM-FLD-5                      PIC XX.                ERCACCT
  1184                                                                  ERCACCT
  1185     12  AM-1ST-PROD-DATE.                                        ERCACCT
  1186         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  1187         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  1188         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  1189     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  1190     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  1191         16  AM-PUR-YR                     PIC XX.                ERCACCT
  1192         16  AM-PUR-MO                     PIC XX.                ERCACCT
  1193         16  AM-PUR-DA                     PIC XX.                ERCACCT
  1194     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  1195     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  1196     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  1197     12  AM-INACTIVE-DATE.                                        ERCACCT
  1198         16  AM-INA-MO                     PIC 99.                ERCACCT
  1199         16  AM-INA-DA                     PIC 99.                ERCACCT
  1200         16  AM-INA-YR                     PIC 99.                ERCACCT
  1201     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  1202                                                                  ERCACCT
  1203     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  1204     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  1205                                                                  ERCACCT
  1206     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  1207         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  1208         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  1209         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  1210         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  1211                                                                  ERCACCT
  1212     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  1213         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  1214         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  1215                                                                  ERCACCT
  1216     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  1217                                                                  ERCACCT
  1218     12  AM-OVER-SHORT.                                           ERCACCT
  1219         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  1220         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  1221                                                                  ERCACCT
  1222     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1223     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1224                                                                  ERCACCT
  1225     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  1226     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  1227                                                                  ERCACCT
  1228     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  1229     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  1230     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  1231     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  1232     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  1233     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  1234     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  1235     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  1236     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  1237     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  1238     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  1239     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  1240     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  1241     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  1242     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  1243     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  1244                                                                  ERCACCT
  1245     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  1246                                                                  ERCACCT
  1247     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  1248     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  1249                                                                  ERCACCT
  1250     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  1251     12  AM-EARN-METHODS.                                         ERCACCT
  1252         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  1253             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  1254             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  1255             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  1256             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  1257         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  1258             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  1259             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  1260             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  1261             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  1262         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  1263             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  1264             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  1265             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  1266             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  1267             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  1268             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  1269                                                                  ERCACCT
  1270     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  1271     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  1272     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  1273                                                                  ERCACCT
  1274     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  1275     12  AM-RET-P-E                        PIC X.                 ERCACCT
  1276     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  1277     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  1278     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  1279     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  1280         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  1281         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1282     12  AM-RETRO-EARNINGS.                                       ERCACCT
  1283         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  1284         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  1285         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  1286     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  1287         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  1288         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  1289     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  1290         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  1291         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  1292         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  1293     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  1294     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  1295                                                                  ERCACCT
  1296     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  1297         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  1298         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  1299         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  1300         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  1301         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  1302                                                                  ERCACCT
  1303     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  1304                                                                  ERCACCT
  1305     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  1306                                                                  ERCACCT
  1307     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  1308         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  1309                                                                  ERCACCT
  1310     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  1311         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  1312         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  1313                                                                  ERCACCT
  1314     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  1315         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  1316                                                                  ERCACCT
  1317     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  1318         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  1319         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  1320                                                                  ERCACCT
  1321     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  1322                                                                  ERCACCT
  1323     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  1324     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1325     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1326     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1327     12  AM-DCC-UEF-STATE                  PIC XX.
  1328     12  FILLER                            PIC XXX.
  1329     12  AM-REPORT-CODE-3                  PIC X(10).
  1330*    12  FILLER                            PIC X(22).             ERCACCT
  1331                                                                  ERCACCT
  1332     12  AM-RESERVE-DATE.                                         ERCACCT
  1333         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  1334         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  1335         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  1336                                                                  ERCACCT
  1337     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  1338     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  1339         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1340         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  1341         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  1342         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  1343                                                                  ERCACCT
  1344     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  1345         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  1346         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  1347         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  1348         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  1349                                                                  ERCACCT
  1350     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  1351         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  1352             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  1353             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  1354             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  1355             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  1356             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  1357             20  FILLER                    PIC XX.                ERCACCT
  1358         16  FILLER                        PIC X(80).             ERCACCT
  1359                                                                  ERCACCT
  1360     12  AM-TRANSFER-DATA.                                        ERCACCT
  1361         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  1362             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  1363             20  AM-TRNFROM-GROUPING.                             ERCACCT
  1364                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  1365                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  1366             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  1367             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  1368                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  1369                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  1370             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  1371         16  AM-TRANSFERRED-TO.                                   ERCACCT
  1372             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  1373             20  AM-TRNTO-GROUPING.                               ERCACCT
  1374                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  1375                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  1376             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  1377             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  1378                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  1379                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  1380             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  1381         16  FILLER                        PIC X(10).             ERCACCT
  1382                                                                  ERCACCT
  1383     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  1384                                                                  ERCACCT
  1385     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  1386         16  AM-DEFN-1-SAVED.                                     ERCACCT
  1387             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  1388                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  1389                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  1390                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1391                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1392                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1393                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  1394                 24  FILLER                PIC X.                 ERCACCT
  1395                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  1396                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  1397                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1398         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  1399             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  1400                 24  FILLER                PIC X(11).             ERCACCT
  1401                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  1402                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  1403                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  1404                 24  FILLER                PIC X(6).              ERCACCT
  1405                                                                  ERCACCT
  1406     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  1407         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  1408            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  1409            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  1410            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  1411                                                                  ERCACCT
  1412     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  1413     12  FILLER                            PIC X(120).            ERCACCT
  1414                                                                  ERCACCT
  1415     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  1416         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  1417         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  1418             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  1419             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  1420                                                          COMP-3. ERCACCT
  1421             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  1422                                                          COMP-3. ERCACCT
  1423         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  1424             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  1425             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  1426                                                          COMP-3. ERCACCT
  1427             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  1428                                                          COMP-3. ERCACCT
  1429                                                                  ERCACCT
  1430     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  1431         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  1432         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  1433         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  1434         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  1435             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  1436                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  1437                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  1438             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  1439                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  1440                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  1441             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  1442                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  1443                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  1444         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  1445             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  1446                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  1447                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  1448                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  1449             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  1450                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  1451                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  1452             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  1453                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  1454                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  1455                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1456     12  AM-COMMENTS.                                             ERCACCT
  1457         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  1458                                                                  ERCACCT
  1459     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  1460         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  1461         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  1462         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  1463         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  1464         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  1465             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  1466             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  1467             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  1468             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  1469         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  1470             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  1471             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  1472             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  1473         16  FILLER                        PIC X(102).            ERCACCT
  1474                                                                  ERCACCT
  1475     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  1476         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  1477             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  1478             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  1479             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  1480             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  1481             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  1482         16  FILLER                          PIC X(10).           ERCACCT
  1483******************************************************************ERCACCT
  1484
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* EL331.cbl
  1486 FD  ELMSTR5.
  1487
* 1488                                 COPY ELCMSTR.
  1489******************************************************************04/15/98
  1490*                                                                *ELCMSTR
  1491*                            ELCMSTR.                            *   LV002
  1492*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1493*                            VMOD=2.012                          *   CL**2
  1494*                                                                *ELCMSTR
  1495*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  1496*                                                                *ELCMSTR
  1497*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  1498*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  1499*                                                                *ELCMSTR
  1500*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  1501*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  1502*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  1503*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  1504*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  1505*                                                 RKP=75,LEN=21  *ELCMSTR
  1506*                                                                *ELCMSTR
  1507*   **** NOTE ****                                               *ELCMSTR
  1508*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  1509*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  1510*                                                                *ELCMSTR
  1511*   LOG = YES                                                    *ELCMSTR
  1512*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  1513******************************************************************
  1514*                   C H A N G E   L O G
  1515*
  1516* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1517*-----------------------------------------------------------------
  1518*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1519* EFFECTIVE    NUMBER
  1520*-----------------------------------------------------------------
  1521* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1522* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1523******************************************************************ELCMSTR
  1524 01  CLAIM-MASTER.                                                ELCMSTR
  1525     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  1526         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  1527                                                                  ELCMSTR
  1528     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  1529         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  1530         16  CL-CARRIER              PIC X.                       ELCMSTR
  1531         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  1532         16  CL-CERT-NO.                                          ELCMSTR
  1533             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  1534             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  1535                                                                  ELCMSTR
  1536     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  1537         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  1538         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  1539         16  CL-INSURED-NAME.                                     ELCMSTR
  1540             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  1541             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  1542                                                                  ELCMSTR
  1543     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1544         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
  1545         16  CL-SOC-SEC-NO.                                       ELCMSTR
  1546             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  1547             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  1548             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  1549                                                                  ELCMSTR
  1550     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  1551         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  1552         16  CL-CERT-NO-A4.                                       ELCMSTR
  1553             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  1554             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  1555                                                                  ELCMSTR
  1556     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  1557         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  1558         16  CL-CCN-A5.                                           ELCMSTR
  1559             20  CL-CCN.                                          ELCMSTR
  1560                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  1561                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  1562             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  1563                                                                  ELCMSTR
  1564     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  1565         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  1566         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  1567             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  1568             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  1569             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  1570         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  1571         16  FILLER                  PIC X(5).                    ELCMSTR
  1572                                                                  ELCMSTR
  1573     12  CL-PROCESSING-INFO.                                      ELCMSTR
  1574         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  1575         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  1576             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  1577             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  1578         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  1579*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  1580*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  1581*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  1582*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  1583*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  1584         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  1585             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  1586             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  1587             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  1588         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  1589         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  1590         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  1591         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  1592         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  1593         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  1594         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  1595         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  1596         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  1597         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  1598         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  1599             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  1600             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
  1601             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1602         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
  1603                                                                  ELCMSTR
  1604         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  1605             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  1606             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  1607                                                                  ELCMSTR
  1608         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  1609             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  1610             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  1611                                                                  ELCMSTR
  1612         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  1613         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  1614         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  1615                                                                  ELCMSTR
  1616         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  1617         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  1618         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  1619             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  1620             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  1621             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  1622             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  1623             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  1624             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  1625         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  1626         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  1627         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  1628             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  1629         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1630         16  FILLER                  PIC X.
  1631                                                                  ELCMSTR
  1632     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  1633         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  1634             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  1635             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  1636             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  1637         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  1638             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  1639             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  1640             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  1641             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  1642                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  1643                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  1644             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  1645                                                                  ELCMSTR
  1646     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  1647         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  1648             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  1649             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  1650         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  1651             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  1652             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  1653         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  1654         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  1655         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
  1656         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  1657         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  1658         16  FILLER                  PIC XX.                      ELCMSTR
  1659         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1660         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
  1661         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  1662         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  1663             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  1664             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  1665             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  1666             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  1667             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  1668             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  1669             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  1670             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  1671             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  1672         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  1673         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  1674         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  1675         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  1676         16  CL-DENIAL-TYPE          PIC X.
  1677             88  CL-TYPE-DENIAL          VALUE '1'.
  1678             88  CL-TYPE-RESCISSION      VALUE '2'.
  1679             88  CL-TYPE-REFORMATION     VALUE '3'.
  1680             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1681             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1682         16  FILLER                  PIC X(5).                    ELCMSTR
  1683                                                                  ELCMSTR
  1684     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  1685         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  1686             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  1687             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  1688             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  1689         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  1690         16  FILLER                  PIC XX.                      ELCMSTR
  1691         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  1692         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  1693             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1694                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  1695             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1696                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  1697             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  1698                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  1699             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  1700                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  1701             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  1702                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  1703             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1704                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  1705             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1706                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  1707                                                                  ELCMSTR
  1708     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  1709         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
  1710         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  1711                                                                  ELCMSTR
  1712     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  1713                                                                  ELCMSTR
  1714     12  CL-PROCESS-ERRORS.                                       ELCMSTR
  1715         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  1716             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  1717         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1718             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
  1719                                                                  ELCMSTR
  1720     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  1721                                                                  ELCMSTR
  1722     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  1723         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  1724         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  1725         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  1726         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  1727                                                                  ELCMSTR
  1728     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  1729         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  1730         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  1731         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  1732         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  1733                                                                  ELCMSTR
  1734     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  1735     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  1736     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  1737                                                                  ELCMSTR
  1738     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  1739     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  1740     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  1741     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  1742                                                                  ELCMSTR
  1743*    12  FILLER                      PIC X(5).                    ELCMSTR
  1744     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  1745     12  FILLER                      PIC X(4).                    ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* EL331.cbl
  1747 FD  ELRETR5.
  1748
* 1749                                 COPY ELCRETR.
  1750******************************************************************04/16/98
  1751*                                                                *ELCRETR
  1752*                                                                *ELCRETR
  1753*                            ELCRETR.                            *   LV002
  1754*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1755*                            VMOD=2.002                          *   CL**2
  1756*                                                                *ELCRETR
  1757*   FILE DESCRIPTION = CLAIM MASTER RETRIEVE FILE                *ELCRETR
  1758*                                                                *ELCRETR
  1759*   **** NOTE -- THIS FILE IS IDENTICAL TO CLAIM MASTER (ELMSTR) *ELCRETR
  1760*   ****      ANY CHANGES TO THIS COPYBOOK OR ELCMSTR MUST BE    *ELCRETR
  1761*   ****      DUPLICATED IN THE OTHER.                           *ELCRETR
  1762*                                                                *ELCRETR
  1763*   FILE TYPE = VSAM,KSDS                                        *ELCRETR
  1764*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCRETR
  1765*                                                                *ELCRETR
  1766*   BASE CLUSTER = ELRETR                         RKP=2,LEN=20   *ELCRETR
  1767*       ALTERNATE PATH1 = ELRETR2 (BY NAME)       RKP=22,LEN=29  *ELCRETR
  1768*       ALTERNATE PATH2 = ELRETR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCRETR
  1769*       ALTERNATE PATH3 = ELRETR5 (BY CERT NO)    RKP=63,LEN=12  *ELCRETR
  1770*       ALTERNATE PATH4 = ELRETR6 (BY CREDIT CARD NO)             ELCRETR
  1771*                                                 RKP=75,LEN=21  *ELCRETR
  1772*                                                                *ELCRETR
  1773*   LOG = YES                                                    *ELCRETR
  1774*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCRETR
  1775******************************************************************ELCRETR
  1776 01  RETRIEVE-MASTER.                                             ELCRETR
  1777     12  RL-RECORD-ID                PIC XX.                      ELCRETR
  1778         88  VALID-RL-ID         VALUE 'RL'.                      ELCRETR
  1779                                                                  ELCRETR
  1780     12  RL-CONTROL-PRIMARY.                                      ELCRETR
  1781         16  RL-COMPANY-CD           PIC X.                       ELCRETR
  1782         16  RL-CARRIER              PIC X.                       ELCRETR
  1783         16  RL-CLAIM-NO             PIC X(7).                    ELCRETR
  1784         16  RL-CERT-NO.                                          ELCRETR
  1785             20  RL-CERT-PRIME       PIC X(10).                   ELCRETR
  1786             20  RL-CERT-SFX         PIC X.                       ELCRETR
  1787                                                                  ELCRETR
  1788     12  RL-CONTROL-BY-NAME.                                      ELCRETR
  1789         16  RL-COMPANY-CD-A1        PIC X.                       ELCRETR
  1790         16  RL-INSURED-LAST-NAME    PIC X(15).                   ELCRETR
  1791         16  RL-INSURED-NAME.                                     ELCRETR
  1792             20  RL-INSURED-1ST-NAME PIC X(12).                   ELCRETR
  1793             20  RL-INSURED-MID-INIT PIC X.                       ELCRETR
  1794                                                                  ELCRETR
  1795     12  RL-CONTROL-BY-SSN.                                       ELCRETR
  1796         16  RL-COMPANY-CD-A2        PIC X.                       ELCRETR
  1797         16  RL-SOC-SEC-NO.                                       ELCRETR
  1798             20  RL-SSN-STATE        PIC XX.                      ELCRETR
  1799             20  RL-SSN-ACCOUNT      PIC X(6).                    ELCRETR
  1800             20  RL-SSN-LN3          PIC X(3).                    ELCRETR
  1801                                                                  ELCRETR
  1802     12  RL-CONTROL-BY-CERT-NO.                                   ELCRETR
  1803         16  RL-COMPANY-CD-A4        PIC X.                       ELCRETR
  1804         16  RL-CERT-NO-A4.                                       ELCRETR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1805             20  RL-CERT-A4-PRIME    PIC X(10).                   ELCRETR
  1806             20  RL-CERT-A4-SFX      PIC X.                       ELCRETR
  1807                                                                  ELCRETR
  1808     12  RL-CONTROL-BY-CCN.                                       ELCRETR
  1809         16  RL-COMPANY-CD-A5        PIC X.                       ELCRETR
  1810         16  RL-CCN-A5.                                           ELCRETR
  1811             20  RL-CCN-NO.                                       ELCRETR
  1812                 24  RL-CCN-PREFIX-A5 PIC X(4).                   ELCRETR
  1813                 24  RL-CCN-PRIME-A5 PIC X(12).                   ELCRETR
  1814             20  RL-CCN-FILLER-A5    PIC X(4).                    ELCRETR
  1815                                                                  ELCRETR
  1816     12  RL-INSURED-PROFILE-DATA.                                 ELCRETR
  1817         16  RL-INSURED-BIRTH-DT     PIC XX.                      ELCRETR
  1818         16  RL-INSURED-SEX-CD       PIC X.                       ELCRETR
  1819             88  RL-INSURED-IS-MALE     VALUE 'M'.                ELCRETR
  1820             88  RL-INSURED-IS-FEMALE   VALUE 'F'.                ELCRETR
  1821             88  RL-INSURED-SEX-UNKNOWN VALUE ' '.                ELCRETR
  1822         16  RL-INSURED-OCC-CD       PIC X(6).                    ELCRETR
  1823         16  FILLER                  PIC X(5).                    ELCRETR
  1824                                                                  ELCRETR
  1825     12  RL-PROCESSING-INFO.                                      ELCRETR
  1826         16  RL-PROCESSOR-ID         PIC X(4).                    ELCRETR
  1827         16  RL-CLAIM-STATUS         PIC X.                       ELCRETR
  1828             88  RL-CLAIM-IS-OPEN       VALUE 'O'.                ELCRETR
  1829             88  RL-CLAIM-IS-CLOSED     VALUE 'C'.                ELCRETR
  1830         16  RL-CLAIM-TYPE           PIC X.                       ELCRETR
  1831*            88  RL-AH-CLAIM            VALUE 'A'.                ELCRETR
  1832*            88  RL-LIFE-CLAIM          VALUE 'L'.                ELCRETR
  1833*            88  RL-PROPERTY-CLAIM      VALUE 'P'.                ELCRETR
  1834*            88  RL-UNEMPLOYMENT-CLAIM  VALUE 'U'.                ELCRETR
  1835         16  RL-CLAIM-PREM-TYPE      PIC X.                       ELCRETR
  1836             88  RL-SINGLE-PREMIUM         VALUE '1'.             ELCRETR
  1837             88  RL-O-B-COVERAGE           VALUE '2'.             ELCRETR
  1838             88  RL-OPEN-END-COVERAGE      VALUE '3'.             ELCRETR
  1839         16  RL-INCURRED-DT          PIC XX.                      ELCRETR
  1840         16  RL-REPORTED-DT          PIC XX.                      ELCRETR
  1841         16  RL-FILE-ESTABLISH-DT    PIC XX.                      ELCRETR
  1842         16  RL-EST-END-OF-DISAB-DT  PIC XX.                      ELCRETR
  1843         16  RL-LAST-PMT-DT          PIC XX.                      ELCRETR
  1844         16  RL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCRETR
  1845         16  RL-PAID-THRU-DT         PIC XX.                      ELCRETR
  1846         16  RL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCRETR
  1847         16  RL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCRETR
  1848         16  RL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCRETR
  1849         16  RL-PMT-CALC-METHOD      PIC X.                       ELCRETR
  1850             88  RL-360-DAY-YR          VALUE '1'.                ELCRETR
  1851             88  RL-365-DAY-YR          VALUE '2'.                ELCRETR
  1852             88  RL-FULL-MONTHS         VALUE '3'.                ELCRETR
  1853         16  RL-CAUSE-CD             PIC X(6).                    ELCRETR
  1854                                                                  ELCRETR
  1855         16  RL-PRIME-CERT-NO.                                    ELCRETR
  1856             20  RL-PRIME-CERT-PRIME PIC X(10).                   ELCRETR
  1857             20  RL-PRIME-CERT-SFX   PIC X.                       ELCRETR
  1858                                                                  ELCRETR
  1859         16  RL-SYSTEM-IDENTIFIER    PIC XX.                      ELCRETR
  1860             88  RL-CREDIT-CLAIM        VALUE 'CR'.               ELCRETR
  1861             88  RL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCRETR
  1862                                                                  ELCRETR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1863         16  RL-MICROFILM-NO         PIC X(10).                   ELCRETR
  1864         16  RL-PROG-FORM-TYPE       PIC X.                       ELCRETR
  1865         16  RL-LAST-ADD-ON-DT       PIC XX.                      ELCRETR
  1866                                                                  ELCRETR
  1867         16  RL-LAST-REOPEN-DT       PIC XX.                      ELCRETR
  1868         16  RL-LAST-CLOSE-DT        PIC XX.                      ELCRETR
  1869         16  RL-LAST-CLOSE-REASON    PIC X.                       ELCRETR
  1870             88  RL-FINAL-PAID          VALUE '1'.                ELCRETR
  1871             88  RL-CLAIM-DENIED        VALUE '2'.                ELCRETR
  1872             88  RL-AUTO-CLOSE          VALUE '3'.                ELCRETR
  1873             88  RL-MANUAL-CLOSE        VALUE '4'.                ELCRETR
  1874         16  RL-ASSOC-CERT-SEQU      PIC S99.                     ELCRETR
  1875         16  RL-ASSOC-CERT-TOTAL     PIC S99.                     ELCRETR
  1876         16  RL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCRETR
  1877             88  RL-PAYMENT-IN-PREP     VALUE 1 THRU 9.           ELCRETR
  1878         16  FILLER                  PIC X(5).                    ELCRETR
  1879                                                                  ELCRETR
  1880     12  RL-CERTIFICATE-DATA.                                     ELCRETR
  1881         16  RL-CERT-ORIGIN          PIC X.                       ELCRETR
  1882             88  RL-CERT-WAS-ONLINE     VALUE '1'.                ELCRETR
  1883             88  RL-CERT-WAS-CREATED    VALUE '2'.                ELCRETR
  1884             88  RL-COVERAGE-WAS-ADDED  VALUE '3'.                ELCRETR
  1885         16  RL-CERT-KEY-DATA.                                    ELCRETR
  1886             20  RL-CERT-CARRIER     PIC X.                       ELCRETR
  1887             20  RL-CERT-GROUPING    PIC X(6).                    ELCRETR
  1888             20  RL-CERT-STATE       PIC XX.                      ELCRETR
  1889             20  RL-CERT-ACCOUNT.                                 ELCRETR
  1890                 24  RL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCRETR
  1891                 24  RL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCRETR
  1892             20  RL-CERT-EFF-DT      PIC XX.                      ELCRETR
  1893                                                                  ELCRETR
  1894     12  RL-STATUS-CONTROLS.                                      ELCRETR
  1895         16  RL-PRIORITY-CD          PIC X.                       ELCRETR
  1896             88  RL-HIGHEST-PRIORITY    VALUE '9'.                ELCRETR
  1897         16  RL-SUPV-ATTN-CD         PIC X.                       ELCRETR
  1898             88  RL-SUPV-NOT-REQUIRED   VALUE ' ' 'N'.            ELCRETR
  1899             88  RL-SUPV-IS-REQUIRED    VALUE 'Y'.                ELCRETR
  1900         16  RL-PURGED-DT            PIC XX.                      ELCRETR
  1901         16  RL-RESTORED-DT          PIC XX.                      ELCRETR
  1902         16  RL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCRETR
  1903         16  RL-NEXT-RESEND-DT       PIC XX.                      ELCRETR
  1904         16  RL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCRETR
  1905         16  FILLER                  PIC XX.                      ELCRETR
  1906         16  RL-LAST-MAINT-DT        PIC XX.                      ELCRETR
  1907         16  RL-LAST-MAINT-USER      PIC X(4).                    ELCRETR
  1908         16  RL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCRETR
  1909         16  RL-LAST-MAINT-TYPE      PIC X.                       ELCRETR
  1910             88  RL-CLAIM-SET-UP           VALUE ' '.             ELCRETR
  1911             88  RL-PAYMENT-MADE           VALUE '1'.             ELCRETR
  1912             88  RL-LETTER-SENT            VALUE '2'.             ELCRETR
  1913             88  RL-MASTER-WAS-ALTERED     VALUE '3'.             ELCRETR
  1914             88  RL-MASTER-WAS-RESTORED    VALUE '4'.             ELCRETR
  1915             88  RL-INCURRED-DATE-CHANGED  VALUE '5'.             ELCRETR
  1916             88  RL-FILE-CONVERTED         VALUE '6'.             ELCRETR
  1917         16  RL-RELATED-CLAIM-NO     PIC X(7).                    ELCRETR
  1918         16  RL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCRETR
  1919         16  RL-BENEFICIARY          PIC X(10).                   ELCRETR
  1920         16  RL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCRETR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1921         16  FILLER                  PIC X(6).                    ELCRETR
  1922                                                                  ELCRETR
  1923     12  RL-TRAILER-CONTROLS.                                     ELCRETR
  1924         16  RL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCRETR
  1925             88  RL-1ST-TRL-AVAIL       VALUE +4095.              ELCRETR
  1926             88  RL-LAST-TRL-AVAIL      VALUE +100.               ELCRETR
  1927             88  RL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCRETR
  1928         16  RL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCRETR
  1929         16  FILLER                  PIC XX.                      ELCRETR
  1930         16  RL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCRETR
  1931         16  RL-ADDRESS-TRAILER-CNT.                              ELCRETR
  1932             20  RL-INSURED-ADDR-CNT  PIC S9.                     ELCRETR
  1933                 88  RL-NO-INSURED-AVAILABLE VALUE ZERO.          ELCRETR
  1934             20  RL-ACCOUNT-ADDR-CNT  PIC S9.                     ELCRETR
  1935                 88  RL-ACCOUNT-IS-ONLINE    VALUE ZERO.          ELCRETR
  1936             20  RL-BENIF-ADDR-CNT    PIC S9.                     ELCRETR
  1937                 88  RL-BENEFICIARY-IS-ONLINE VALUE ZERO.         ELCRETR
  1938             20  RL-EMPLOYER-ADDR-CNT PIC S9.                     ELCRETR
  1939                 88  RL-NO-EMPLOY-AVAILABLE   VALUE ZERO.         ELCRETR
  1940             20  RL-DOCTOR-ADDR-CNT   PIC S9.                     ELCRETR
  1941                 88  RL-NO-DOCTOR-AVAILABLE   VALUE ZERO.         ELCRETR
  1942             20  RL-OTHER-1-ADDR-CNT  PIC S9.                     ELCRETR
  1943                 88  RL-NO-OTHER-1-ADDRESSES  VALUE ZERO.         ELCRETR
  1944             20  RL-OTHER-2-ADDR-CNT  PIC S9.                     ELCRETR
  1945                 88  RL-NO-OTHER-2-ADDRESSES  VALUE ZERO.         ELCRETR
  1946                                                                  ELCRETR
  1947     12  RL-CV-REFERENCE-NO.                                      ELCRETR
  1948         16  RL-CV-REFNO-PRIME       PIC X(18).                   ELCRETR
  1949         16  RL-CV-REFNO-SFX         PIC XX.                      ELCRETR
  1950                                                                  ELCRETR
  1951     12  RL-FILE-LOCATION            PIC X(4).                    ELCRETR
  1952                                                                  ELCRETR
  1953     12  RL-PROCESS-ERRORS.                                       ELCRETR
  1954         16  RL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCRETR
  1955             88  RL-NO-FATAL-ERRORS     VALUE ZERO.               ELCRETR
  1956         16  RL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCRETR
  1957             88  RL-NO-FORCABLE-ERRORS  VALUE ZERO.               ELCRETR
  1958                                                                  ELCRETR
  1959     12  RL-PRODUCT-CD               PIC X.                       ELCRETR
  1960                                                                  ELCRETR
  1961     12  RL-CURRENT-KEY-DATA.                                     ELCRETR
  1962         16  RL-CURRENT-CARRIER      PIC X.                       ELCRETR
  1963         16  RL-CURRENT-GROUPING     PIC X(6).                    ELCRETR
  1964         16  RL-CURRENT-STATE        PIC XX.                      ELCRETR
  1965         16  RL-CURRENT-ACCOUNT      PIC X(10).                   ELCRETR
  1966                                                                  ELCRETR
  1967     12  RL-ASSOCIATES               PIC X.                       ELCRETR
  1968         88  RL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCRETR
  1969         88  RL-ASSOC-INTERFACE         VALUE 'I'.                ELCRETR
  1970         88  RL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCRETR
  1971         88  RL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCRETR
  1972                                                                  ELCRETR
  1973     12  RL-ACTIVITY-CODE            PIC 99.                      ELCRETR
  1974     12  RL-ACTIVITY-MAINT-DT        PIC XX.                      ELCRETR
  1975     12  RL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCRETR
  1976                                                                  ELCRETR
  1977     12  RL-LAPSE-REPORT-CODE        PIC 9.                       ELCRETR
  1978     12  RL-LAG-REPORT-CODE          PIC 9.                       ELCRETR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1979     12  RL-LOAN-TYPE                PIC XX.                      ELCRETR
  1980     12  RL-LEGAL-STATE              PIC XX.                      ELCRETR
  1981                                                                  ELCRETR
  1982     12  FILLER                      PIC X(5).                    ELCRETR
  1983
  1985 FD  DISK-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* EL331.cbl
*                                      COPY ELCDTEFD.
  1986******************************************************************04/15/98
  1987*                                                                *ELCDTEFD
  1988*                                                                *ELCDTEFD
  1989*                            ELCDTEFD.                           *   LV002
  1990*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1991*                            VMOD=2.007                          *   CL**2
  1992*                                                                *ELCDTEFD
  1993******************************************************************ELCDTEFD
  1994     BLOCK CONTAINS 0 RECORDS
  1995     RECORDING MODE F.                                            ELCDTEFD
  1996                                                                  ELCDTEFD
  1997 01  DATE-DISK.                                                   ELCDTEFD
  1998     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1999     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2000     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2001     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2002     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2003     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2004     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2005                                                                  ELCDTEFD
  2006 01  DATE-DISK-R.                                                 ELCDTEFD
  2007     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2008     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2009                                     PIC  X(32).                  ELCDTEFD
  2010                                                                  ELCDTEFD
  2011 01  DATE-DISK-T.                                                 ELCDTEFD
  2012     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2013     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2014                                     PIC  X(48).                  ELCDTEFD
  2015                                                                  ELCDTEFD
  2016 01  DATE-DISK-M.                                                 ELCDTEFD
  2017     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2018     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2019                                     PIC  X(48).                  ELCDTEFD
  2020                                                                  ELCDTEFD
  2021 01  DATE-DISK-P.                                                 ELCDTEFD
  2022     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2023     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2024     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2025     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2026         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2027                                     PIC  X.                      ELCDTEFD
  2028         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2029     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2030         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2031             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2032             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2033             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2034             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2035         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2036                                                                  ELCDTEFD
  2037 01  DATE-DISK-E.                                                 ELCDTEFD
  2038     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2039     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2040                                     PIC  X(4).                   ELCDTEFD
  2041                                                                  ELCDTEFD
  2042 01  DATE-DISK-C.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2043     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2044     12  DD-CARR1-SECPAY-SW          PIC  X.
  2045     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2046     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2047     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2048     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2049     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2050     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2051     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2052     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2053     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2054     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2055     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2056     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2057     12  DD-CARR2-SECPAY-SW          PIC  X.
  2058     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2059                                                                  ELCDTEFD
  2060 01  DATE-DISK-OPT.                                               ELCDTEFD
  2061     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2062     12  DD-TLR-DATA.                                             ELCDTEFD
  2063         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2064                                     PIC  X(03).                  ELCDTEFD
  2065     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2066         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2067                                     PIC  X(06).                  ELCDTEFD
  2068     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2069         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2070                                     PIC  X(07).                  ELCDTEFD
  2071         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2072     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2073                                     PIC  X(96).                  ELCDTEFD
  2074******************************************************************ELCDTEFD
  2075
  2077 FD  FICH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* EL331.cbl
*                                      COPY ELCFCHFD.
  2078******************************************************************04/15/98
  2079*                                                                *ELCFCHFD
  2080*                            ELCFCHFD.                           *   LV003
  2081*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2082*                            VMOD=2.004                          *   CL**3
  2083*                                                                *ELCFCHFD
  2084******************************************************************ELCFCHFD
  2085     BLOCK CONTAINS 0 RECORDS
  2086     RECORDING MODE F.                                            ELCFCHFD
  2087                                                                  ELCFCHFD
  2088 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2089******************************************************************ELCFCHFD
  2090
  2092 FD  ELREPT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* EL331.cbl
*                                      COPY ELCRPTFD.
  2093******************************************************************04/16/98
  2094*                                                                *ELCRPTFD
  2095*                            ELCRPTFD.                           *   LV002
  2096*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2097*                            VMOD=2.001                          *ELCRPTFD
  2098*                                                                *ELCRPTFD
  2099* NOTE- USE ELCREPT AS COPY FOR 01 LEVEL                         *ELCRPTFD
  2100*                                                                *ELCRPTFD
  2101******************************************************************ELCRPTFD
  2102      LABEL RECORDS ARE STANDARD.                                 ELCRPTFD
  2103******************************************************************ELCRPTFD
* 2104                                 COPY ELCREPT.
  2105******************************************************************04/15/98
  2106*                                                                *ELCREPT
  2107*                                                                *ELCREPT
  2108*                            ELCREPT.                            *   LV002
  2109*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2110*                            VMOD=2.002                          *   CL**2
  2111*                                                                *ELCREPT
  2112*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  2113*                                                                *ELCREPT
  2114*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  2115*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  2116*                                                                *ELCREPT
  2117*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  2118*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  2119*                                                                *ELCREPT
  2120*   LOG = NO                                                     *ELCREPT
  2121*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  2122******************************************************************ELCREPT
  2123 01  REPORT-SAVE-FILE.                                            ELCREPT
  2124     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  2125         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  2126                                                                  ELCREPT
  2127     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  2128         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  2129         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  2130             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  2131             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  2132         16  RF-REPORT-ID.                                        ELCREPT
  2133             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  2134                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  2135                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  2136             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  2137         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  2138     12  RF-REPORT-LINE-133.                                      ELCREPT
  2139         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
  2140         16  RF-DATA-133             PIC X(132).                  ELCREPT
  2141         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  2142             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  2143             20  FILLER              PIC X(52).                   ELCREPT
  2144         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  2145             20  FILLER              PIC X(53).                   ELCREPT
  2146             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  2147     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  2148         16  FILLER                  PIC X.                       ELCREPT
  2149         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* EL331.cbl (/apps/prod/cid1p/copy/ELCREPT)
  2150         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  2151         16  FILLER                  PIC X(115).                  ELCREPT
  2152         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  2153******************************************************************ELCREPT
  2154
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* EL331.cbl
  2156 FD  ERMEBL.
  2157
* 2158                                 COPY ERCMEBL.
  2159******************************************************************04/29/98
  2160*                                                                 ERCMEBL
  2161*                                                                 ERCMEBL
  2162*                            ERCMEBL                             *   LV004
  2163*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  2164*                            VMOD 2.004                          *   CL**2
  2165*                                                                *ERCMEBL
  2166*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  2167*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  2168*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  2169*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  2170*                                                                *ERCMEBL
  2171*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  2172*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  2173*                                                                *ERCMEBL
  2174*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  2175*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  2176*                                                                *ERCMEBL
  2177******************************************************************ERCMEBL
  2178                                                                  ERCMEBL
  2179 01  MONTH-END-BALANCES.                                          ERCMEBL
  2180     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  2181     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  2182         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  2183         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  2184     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2185     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2186     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2187     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2188     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2189     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2190     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2191     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2192     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2193     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2194     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  2195     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  2196     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  2197     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2198     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  2199     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  2200     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2201     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2202     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2203     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  2204     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  2205     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2206     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  2207     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  2208     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2209     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2210     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2211     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2212     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2213     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* EL331.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  2214     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2215     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  2216     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  2217     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2218     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  2219     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  2220     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2221     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2222     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2223     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2224     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  2225     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  2226     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2227     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2228     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2229     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2230     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  2231     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  2232     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2233     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2234     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2235     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  2236     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  2237     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  2238     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2239     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  2240     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  2241     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2242     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  2243     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  2244     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2245     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  2246     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2247     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  2248     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  2249     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2250     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  2251     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  2252     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  2253     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2254     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  2255     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2256     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  2257     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  2258     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  2259     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  2260     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  2261     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  2262     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  2263     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2264     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  2265     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  2266     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2267     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  2268     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2269     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  2270     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  2271     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* EL331.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  2272     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2273     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2274     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2275     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  2276     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  2277     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2278     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  2279     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2280     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  2281     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  2282     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2283     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  2284     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2285     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  2286     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  2287     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2288     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  2289     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2290     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  2291     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  2292     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2293     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  2294     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2295     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  2296     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  2297     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2298     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  2299     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  2300     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  2301     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  2302     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  2303     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  2304     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  2305     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  2306     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  2307     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  2308     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2309     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2310     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2311     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2312     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2313     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  2314     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  2315     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2316     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2317     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2318     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2319     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2320     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2321     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  2322     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  2323     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2324     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  2325     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2326     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  2327     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  2328     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2329     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* EL331.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  2330     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  2331     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2332     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  2333     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  2334     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2335     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  2336     12  FILLER                  PIC  X(88).                         CL**2
  2337******************************************************************ERCMEBL
  2338
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* EL331.cbl
  2340 FD  ERMAIL.
  2341
* 2342                                 COPY ERCMAIL.
  2343******************************************************************
  2344*                                                                *
  2345*                                                                *
  2346*                            ERCMAIL                             *
  2347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2348*                            VMOD=2.003                          *
  2349*                                                                *
  2350*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2351*                                                                *
  2352*   FILE TYPE = VSAM,KSDS                                        *
  2353*   RECORD SIZE = 374   RECFORM = FIX                            *
  2354*                                                                *
  2355*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2356*   ALTERNATE PATH    = NOT USED                                 *
  2357*                                                                *
  2358*   LOG = YES                                                    *
  2359*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2360******************************************************************
  2361*                   C H A N G E   L O G
  2362*
  2363* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2364*-----------------------------------------------------------------
  2365*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2366* EFFECTIVE    NUMBER
  2367*-----------------------------------------------------------------
  2368* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2369* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2370* 111108                   PEMA  ADD CRED BENE ADDR2
  2371******************************************************************
  2372
  2373 01  MAILING-DATA.
  2374     12  MA-RECORD-ID                      PIC XX.
  2375         88  VALID-MA-ID                       VALUE 'MA'.
  2376
  2377     12  MA-CONTROL-PRIMARY.
  2378         16  MA-COMPANY-CD                 PIC X.
  2379         16  MA-CARRIER                    PIC X.
  2380         16  MA-GROUPING.
  2381             20  MA-GROUPING-PREFIX        PIC XXX.
  2382             20  MA-GROUPING-PRIME         PIC XXX.
  2383         16  MA-STATE                      PIC XX.
  2384         16  MA-ACCOUNT.
  2385             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2386             20  MA-ACCOUNT-PRIME          PIC X(6).
  2387         16  MA-CERT-EFF-DT                PIC XX.
  2388         16  MA-CERT-NO.
  2389             20  MA-CERT-PRIME             PIC X(10).
  2390             20  MA-CERT-SFX               PIC X.
  2391
  2392     12  FILLER                            PIC XX.
  2393
  2394     12  MA-ACCESS-CONTROL.
  2395         16  MA-SOURCE-SYSTEM              PIC XX.
  2396             88  MA-FROM-CREDIT                VALUE 'CR'.
  2397             88  MA-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* EL331.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  2398             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2399             88  MA-FROM-OTHER                 VALUE 'OT'.
  2400         16  MA-RECORD-ADD-DT              PIC XX.
  2401         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2402         16  MA-LAST-MAINT-DT              PIC XX.
  2403         16  MA-LAST-MAINT-BY              PIC XXXX.
  2404         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2405
  2406     12  MA-PROFILE-INFO.
  2407         16  MA-QUALIFY-CODE-1             PIC XX.
  2408         16  MA-QUALIFY-CODE-2             PIC XX.
  2409         16  MA-QUALIFY-CODE-3             PIC XX.
  2410         16  MA-QUALIFY-CODE-4             PIC XX.
  2411         16  MA-QUALIFY-CODE-5             PIC XX.
  2412
  2413         16  MA-INSURED-LAST-NAME          PIC X(15).
  2414         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2415         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2416         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2417         16  MA-INSURED-BIRTH-DT           PIC XX.
  2418         16  MA-INSURED-SEX                PIC X.
  2419             88  MA-SEX-MALE                   VALUE 'M'.
  2420             88  MA-SEX-FEMALE                 VALUE 'F'.
  2421         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2422
  2423         16  MA-ADDRESS-CORRECTED          PIC X.
  2424         16  MA-JOINT-BIRTH-DT             PIC XX.
  2425*        16  FILLER                        PIC X(12).
  2426
  2427         16  MA-ADDRESS-LINE-1             PIC X(30).
  2428         16  MA-ADDRESS-LINE-2             PIC X(30).
  2429         16  MA-CITY-STATE.
  2430             20  MA-CITY                   PIC X(28).
  2431             20  MA-ADDR-STATE             PIC XX.
  2432         16  MA-ZIP.
  2433             20  MA-ZIP-CODE.
  2434                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2435                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2436                 24  FILLER                PIC X(4).
  2437             20  MA-ZIP-PLUS4              PIC X(4).
  2438         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2439             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2440             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2441             20  FILLER                    PIC X(3).
  2442
  2443         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2444
  2445         16  FILLER                        PIC XXX.
  2446*        16  FILLER                        PIC X(10).
  2447
  2448
  2449     12  MA-CRED-BENE-INFO.
  2450         16  MA-CRED-BENE-NAME                 PIC X(25).
  2451         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2452         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2453         16  MA-CRED-BENE-CTYST.
  2454             20  MA-CRED-BENE-CITY             PIC X(28).
  2455             20  MA-CRED-BENE-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  51
* EL331.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  2456         16  MA-CRED-BENE-ZIP.
  2457             20  MA-CB-ZIP-CODE.
  2458                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  2459                     88  MA-CB-CANADIAN-POST-CODE
  2460                                           VALUE 'A' THRU 'Z'.
  2461                 24  FILLER                    PIC X(4).
  2462             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2463         16  MA-CB-CANADIAN-POSTAL-CODE
  2464                            REDEFINES MA-CRED-BENE-ZIP.
  2465             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2466             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2467             20  FILLER                        PIC X(3).
  2468     12  MA-POST-CARD-MAIL-DATA.
  2469         16  MA-MAIL-DATA OCCURS 7.
  2470             20  MA-MAIL-TYPE              PIC X.
  2471                 88  MA-12MO-MAILING           VALUE '1'.
  2472                 88  MA-EXP-MAILING            VALUE '2'.
  2473             20  MA-MAIL-STATUS            PIC X.
  2474                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2475                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2476                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2477             20  MA-MAIL-DATE              PIC XX.
  2478     12  FILLER                            PIC XX.
  2479     12  FILLER                            PIC XX.
  2480*    12  FILLER                            PIC X(30).
  2481******************************************************************
  2482
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  52
* EL331.cbl
  2484 FD  ERCTBL.
  2485
* 2486                                 COPY ERCCTBL.
  2487******************************************************************04/29/98
  2488*                                                                *ERCCTBL
  2489*                                                                *ERCCTBL
  2490*                            ERCCTBL                             *   LV002
  2491*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2492*                            VMOD=2.003                              CL**2
  2493*                                                                *ERCCTBL
  2494*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  2495*                                                                *ERCCTBL
  2496*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  2497*                                                                *ERCCTBL
  2498*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  2499*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  2500*                                                                *ERCCTBL
  2501*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  2502*       ALTERNATE PATH = NONE                                    *ERCCTBL
  2503*                                                                *ERCCTBL
  2504*   LOG = NO                                                     *ERCCTBL
  2505*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  2506*                                                                *ERCCTBL
  2507*                                                                *ERCCTBL
  2508******************************************************************ERCCTBL
  2509                                                                  ERCCTBL
  2510 01  COMM-TABLE-RECORD.                                           ERCCTBL
  2511     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  2512         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  2513                                                                  ERCCTBL
  2514     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  2515         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  2516         16  CT-TABLE                      PIC XXX.               ERCCTBL
  2517         16  CT-CNTRL-2.                                          ERCCTBL
  2518             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  2519             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  2520                                                                  ERCCTBL
  2521     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  2522         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  2523         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  2524         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  2525         16  FILLER                        PIC X(31).             ERCCTBL
  2526                                                                  ERCCTBL
  2527     12  CT-LIMITS.                                               ERCCTBL
  2528         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  2529                                                                  ERCCTBL
  2530         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  2531                                                                  ERCCTBL
  2532         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  2533                                                                  ERCCTBL
  2534     12  CT-RATES.                                                ERCCTBL
  2535         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  2536             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  2537             20  CT-RT-R   REDEFINES                              ERCCTBL
  2538                 CT-RT                     PIC XXX.               ERCCTBL
  2539                                                                  ERCCTBL
  2540     12  FILLER                            PIC  X(42).            ERCCTBL
  2541                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  53
* EL331.cbl
  2542******************************************************************ERCCTBL
  2543
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  54
* EL331.cbl
  2545 FD  DISPLAY-PRT
  2546     RECORDING MODE F
  2547     LABEL RECORDS ARE STANDARD
  2548     RECORD CONTAINS 133 CHARACTERS
  2549     BLOCK CONTAINS 0 RECORDS
  2550     DATA RECORD IS DISPLAY-REC.
  2551
  2552 01  DISPLAY-REC.
  2553     12  DISPLAY-CC              PIC X.
  2554     12  DISPLAY-INFO            PIC X(132).
  2555
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  55
* EL331.cbl
  2557 WORKING-STORAGE SECTION.
  2558 77  FILLER  PIC X(32) VALUE '********************************'.
  2559 77  FILLER  PIC X(32) VALUE '*    EL331  WORKING-STORAGE    *'.
  2560 77  FILLER  PIC X(32) VALUE '********** VMOD=2.037 **********'.
  2561
  2562 77  DIS-HEAD-SW             PIC X       VALUE 'Y'.
  2563 77  ERROR-COUNT             PIC 9(7)    VALUE ZEROS.
  2564 77  DIS-LINE-CNT            PIC 99      VALUE ZEROS.
  2565
  2566 77  NDX                         PIC S9(4) COMP     VALUE ZERO.
  2567 77  CINDX                       PIC S9(4) COMP     VALUE ZERO.
  2568
  2569 77  WS-ACT-END-SW               PIC X              VALUE SPACE.
  2570     88  NO-MORE-ACT-RECORDS         VALUE 'X'.
  2571     88  MORE-ACT-RECORDS            VALUE ' '.
  2572
  2573 77  WS-FIRST-TIME-SW            PIC X              VALUE '1'.
  2574     88  FIRST-TIME                  VALUE '1'.
  2575
  2576 77  WS-PRT-FULL-LINE-SW         PIC X              VALUE SPACE.
  2577     88  LINE-FULL                   VALUE 'X'.
  2578
  2579 77  WS-ONL-GE-SW                PIC X              VALUE SPACE.
  2580     88  ONL-KEY-EQUAL-OR-GREATER    VALUE 'X'.
  2581
  2582 77  WS-B-END-SW                 PIC X              VALUE SPACE.
  2583     88  END-O-FILE                  VALUE 'E'.
  2584
  2585 77  WS-CLM-END-SW               PIC X              VALUE SPACE.
  2586     88  NO-MORE-CLAIM-MATCH         VALUE 'X'.
  2587
  2588 77  WS-ONL-END-SW               PIC X              VALUE SPACE.
  2589     88  NO-MORE-ONL-RECORDS         VALUE 'X'.
  2590     88  MORE-ONL-RECORDS            VALUE ' '.
  2591
  2592 77  WS-ALL-END-SW               PIC X              VALUE SPACE.
  2593     88  NO-MORE-RECORDS             VALUE 'X'.
  2594
  2595 77  WS-ECS-END-SW               PIC X              VALUE SPACE.
  2596     88  NO-MORE-ECS-RECORDS         VALUE 'X'.
  2597     88  MORE-ECS-RECORDS            VALUE ' '.
  2598
  2599 77  ERROR-SW                    PIC X              VALUE SPACE.
  2600     88  ERROR-OCCURRED              VALUE 'E'.
  2601     88  NO-ERRORS                   VALUE ' '.
  2602
  2603 77  WS-O-MATCH-SW               PIC X              VALUE 'M'.
  2604     88  MATCHED-REC                 VALUE 'M'.
  2605     88  NO-MATCH-FOUND              VALUE ' '.
  2606
  2607 77  WS-IO-ERROR-SW              PIC X              VALUE SPACE.
  2608     88  IO-ERROR                    VALUE 'E'.
  2609     88  IO-ERROR-OCCURRED           VALUE 'E'.
  2610
  2611 77  NO-PREM-CT                  PIC 9(07)          VALUE ZEROS.
  2612 77  NO-PLAN-CODE-CT             PIC 9(07)          VALUE ZEROS.
  2613 77  WS-LINE-CNT                 PIC S999  COMP-3   VALUE ZEROS.
  2614 77  WS-PAGE-CNT                 PIC S999  COMP-3   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  56
* EL331.cbl
  2615 77  WS-MAX-LINES                PIC S999  COMP-3   VALUE +60.
  2616 77  X                           PIC X              VALUE SPACE.
  2617 77  WS-ZERO                     PIC S9    COMP-3   VALUE ZERO.
  2618 77  WS-RETURN-CODE              PIC S9(4) COMP     VALUE ZERO.
  2619 77  WS-LEVEL-INDEX              PIC S9(4) COMP     VALUE ZERO.
  2620
  2621 77  WS-ABEND-MESSAGE            PIC X(80)          VALUE SPACES.
  2622 77  WS-ABEND-FILE-STATUS        PIC XX             VALUE ZERO.
  2623
  2624 77  WS-CLAIM-SW                 PIC X              VALUE SPACE.
  2625     88  NO-ASSOCIATED-CLAIM         VALUE 'N'.
  2626     88  ASSOCIATED-CLAIM            VALUE 'A'.
  2627
  2628 77  WS-ERCOMM-SW                PIC X              VALUE SPACE.
  2629     88  ASSOCIATED-ERCOMM           VALUE '1'.
  2630
  2631 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2632     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2633
  2634 01  WS-ME50-BALANCE-REC.
  2635     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2636     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2637     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'EL331   '.
  2638     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2639     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2640     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2641     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2642     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2643     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2644
  2645 01  DISPLAY-HD-1.
  2646     12  FILLER      PIC X     VALUE SPACES.
  2647     12  FILLER      PIC X(51) VALUE SPACES.
  2648     12  FILLER      PIC X(23) VALUE 'PROCESSING ERROR REPORT'.
  2649     12  FILLER      PIC X(51) VALUE SPACES.
  2650     12  FILLER      PIC X(07) VALUE ' EL-331'.
  2651
  2652 01  DISPLAY-HD-2.
  2653     12  FILLER      PIC X     VALUE SPACES.
  2654     12  FILLER      PIC X     VALUE SPACES.
  2655     12  FILLER      PIC X(56) VALUE SPACES.
  2656     12  DIS-DATE    PIC X(8)  VALUE SPACES.
  2657     12  FILLER      PIC X(67) VALUE SPACES.
  2658
  2659 01  DISPLAY-LINE.
  2660     05  DISPLAY-LINE-05.
  2661        10  DIS-CC              PIC X.
  2662        10  DIS-LINE-REASON     PIC X(32).
  2663        10  DIS-LINE-REC        PIC X(100).
  2664
  2665     05  DISPLAY-LINE-ALT  REDEFINES  DISPLAY-LINE-05.
  2666        10  DIS-CC-ALT          PIC X.
  2667        10  DIS-FLD-1           PIC X(52).
  2668        10  DIS-FLD-2           PIC X(80).
  2669
  2670 01  WK-MEMB-ACCT.
  2671     12  WK-MEMB-ACCT-CHAR       PIC X   OCCURS 6.
  2672 01  WK-LAST-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  57
* EL331.cbl
  2673     12  WK-LAST-NAME-CHAR       PIC X   OCCURS 12.
  2674
  2675 01  WORK-AREA.
  2676     12  LST-NM-SUB              PIC S9(4) COMP  VALUE +0.
  2677     12  ACCT-SUB                PIC S9(4) COMP  VALUE +0.
  2678     12  BIN-CR-DT               PIC XX    VALUE SPACES.
  2679     12  ERROR-FLAG              PIC X           VALUE ' '.
  2680        88 NO-ERRORS                    VALUE ' '.
  2681        88 NON-ALPHA                    VALUE 'A'.
  2682        88 BLANK-NAME                   VALUE 'B'.
  2683
  2684 01  MONTH-END-DATA.
  2685     12  ME-START-DATE.
  2686         16  ME-START-MO         PIC 99.
  2687         16  FILLER              PIC X.
  2688         16  ME-START-DA         PIC 99.
  2689         16  FILLER              PIC X.
  2690         16  ME-START-YR         PIC 99.
  2691     12  ME-CNDS-DATE            PIC 9(6).
  2692     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2693         16  ME-CNDS-MO          PIC 99.
  2694         16  ME-CNDS-DA          PIC 99.
  2695         16  ME-CNDS-YR          PIC 99.
  2696     12  ME-START-TIME           PIC 9(6).
  2697     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2698         88  ME-DO-UPDATE        VALUE 'Y'.
  2699         88  ME-NO-UPDATE        VALUE 'N'.
  2700     12  ERMEBL-FILE-STATUS      PIC XX.
  2701     12  ERCTBL-FILE-STATUS      PIC XX.
  2702     12  MONTH-END-MOYR          PIC S9(5)    COMP-3.
  2703
  2704 01  DTE-INTERFACE-AREAS.
  2705     12  PGM-SUB                 PIC S9(4)    COMP VALUE +331.
  2706     12  ABEND-CODE              PIC XXXX          VALUE SPACE.
  2707     12  ABEND-OPTION            PIC X.
  2708     12  OLC-REPORT-NAME         PIC X(5)          VALUE 'EL331'.
  2709
  2710 01  WS-SAVE-AREAS.
  2711     12  FILLER   PIC X(27)  VALUE '---------------------------'.
  2712     12  FILLER   PIC X(27)  VALUE '---- EL331 SAVED AREAS ----'.
  2713     12  FILLER   PIC X(27)  VALUE '---------------------------'.
  2714
  2715     12  WS-ECS-READ       COMP-3     PIC S9(9)   VALUE ZEROS.
  2716     12  WS-ACT-READ       COMP-3     PIC S9(9)   VALUE ZEROS.
  2717     12  WS-ACCT-READS     COMP-3     PIC S9(9)   VALUE ZEROS.
  2718     12  WS-ACCT-MATCH     COMP-3     PIC S9(9)   VALUE ZEROS.
  2719     12  WS-EXCP-ADD       COMP-3     PIC S9(9)   VALUE ZEROS.
  2720     12  WS-EXCP-TBL       COMP-3     PIC S9(9)   VALUE ZEROS.
  2721     12  WS-EXCP-DEL       COMP-3     PIC S9(9)   VALUE ZEROS.
  2722     12  WS-MAIL-DEL       COMP-3     PIC S9(9)   VALUE ZEROS.
  2723     12  WS-MATCHED-ONL    COMP-3     PIC S9(9)   VALUE ZEROS.
  2724     12  WS-ONL-READ       COMP-3     PIC S9(9)   VALUE ZEROS.
  2725     12  WS-LOADED-ECS     COMP-3     PIC S9(9)   VALUE ZEROS.
  2726     12  WS-ONL-DELETED    COMP-3     PIC S9(9)   VALUE ZEROS.
  2727     12  WS-ONL-EXIST      COMP-3     PIC S9(9)   VALUE ZEROS.
  2728     12  WS-CLAIM-MATCH    COMP-3     PIC S9(9)   VALUE ZEROS.
  2729     12  WS-INACTIVE-CERTS COMP-3     PIC S9(9)   VALUE ZEROS.
  2730     12  WS-EXPIRE-MOS     COMP-3     PIC S9(9)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  58
* EL331.cbl
  2731     12  WS-WORK-TERM      COMP-3     PIC S9(3)   VALUE ZEROS.
  2732     12  WS-CURRENT-MOS           PIC S9(9) COMP-3  VALUE ZEROS.
  2733     12  WS-UPDATE-SW             PIC S9  COMP-3    VALUE ZERO.
  2734     12  WS-ONL-RECORD            PIC  X(450)       VALUE SPACES.
  2735     12  WS-BEFORE-CERT           PIC  X(450)       VALUE SPACES.
  2736     12  WS-LAST-CLAIM-MATCHED    PIC  X(450)       VALUE SPACES.
  2737     12  WS-CLM-CNT               PIC  S9(4)  COMP  VALUE ZEROS.
  2738     12  WS-CM-ORIG               PIC  X            VALUE SPACE.
  2739     12  WS-CL-ORIG               PIC  X            VALUE SPACE.
  2740     12  WS-CM-INSURED-ADDRESS-SW PIC  X            VALUE SPACE.
  2741     12  WS-CM-ENTRY-BATCH        PIC  X(6)         VALUE SPACES.
  2742     12  WS-CM-LF-EXIT-BATCH      PIC  X(6)         VALUE SPACES.
  2743     12  WS-CM-AH-EXIT-BATCH      PIC  X(6)         VALUE SPACES.
  2744     12  WS-CM-BENEFICIARY        PIC  X(25)        VALUE SPACES.
  2745     12  WS-LST-ADD-ON-DT         PIC  XX           VALUE SPACES.
  2746     12  WS-LN-NUMBER             PIC  X(8)         VALUE SPACES.
  2747     12  WS-LN-BALANCE            PIC S9(7)V99 COMP-3 VALUE ZERO.
  2748     12  WS-CLAIM-DEDUCT-WITHHELD PIC S9(5)V99 COMP-3 VALUE ZERO.
  2749     12  WS-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99 COMP-3 VALUE ZERO.
  2750     12  WS-LF-DEATH-EXIT-DT      PIC X(02)      VALUE LOW-VALUES.
  2751     12  WS-LF-CURRENT-STATUS     PIC X(01)      VALUE SPACE.
  2752     12  WS-LF-STATUS-AT-DEATH    PIC X(01)      VALUE SPACE.
  2753     12  WS-EOM-DT                PIC X(02)      VALUE LOW-VALUES.
  2754
  2755     12  WS-NAME-WORK.
  2756         16  WS-NAME-14           PIC X(14)          VALUE SPACE.
  2757         16  WS-NAME-15           PIC X              VALUE '|'.
  2758
  2759     12  WS-EFF-ACT-NAME.
  2760         16  WS-NAME-EFF-DT      PIC X(6)  VALUE SPACES.
  2761         16  WS-NAME-FILL        PIC XX    VALUE SPACES.
  2762         16  WS-NAME-ACCT        PIC X(7)  VALUE SPACES.
  2763
  2764     12  WS-HAN-ACCOUNT.
  2765         16  FILLER              PIC XXX   VALUE SPACES.
  2766         16  WS-HAN-ACCT-4-10    PIC X(7)  VALUE SPACES.
  2767
  2768     12  WS-HI-LAST-NAME.
  2769         16  FILLER              PIC X(8)  VALUE SPACES.
  2770         16  WS-HI-CERT-4-10     PIC X(7)  VALUE SPACES.
  2771
  2772     12  WS-CLAS-I-CALC-TYPE     PIC X              VALUE SPACE.
  2773     12  WS-CLAS-I-BEN           PIC XX             VALUE SPACES.
  2774
  2775     12  CL-STATUS.
  2776         16  CL-STAT-1           PIC X              VALUE ZERO.
  2777         16  CL-STAT-2           PIC X              VALUE ZERO.
  2778
  2779     12  ELRETR5-FILE-STATUS.
  2780         16  ELRETR5-STAT-1      PIC X              VALUE ZERO.
  2781         16  ELRETR5-STAT-2      PIC X              VALUE ZERO.
  2782
  2783     12  ERMAIL-FILE-STATUS.
  2784         16  CFS-STAT-1          PIC X              VALUE ZERO.
  2785         16  CFS-STAT-2          PIC X              VALUE ZERO.
  2786
  2787     12  CM-STATUS.
  2788         16  CM-STAT-1           PIC X              VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  59
* EL331.cbl
  2789         16  CM-STAT-2           PIC X              VALUE ZERO.
  2790
  2791     12  CE-STATUS.
  2792         16  CE-STAT-1           PIC X              VALUE ZERO.
  2793         16  CE-STAT-2           PIC X              VALUE ZERO.
  2794
  2795     12  AM-STATUSF.
  2796         16  AM-STAT-1           PIC X              VALUE ZERO.
  2797         16  AM-STAT-2           PIC X              VALUE ZERO.
  2798
  2799     12  WS-CM-CONTROL-PRIMARY   PIC X(33)  VALUE LOW-VALUES.
  2800
  2801     12  WS-SAVED-ECS-KEY.
  2802         16  WS-SAVED-B-COMP     PIC X     VALUE LOW-VALUE.
  2803         16  WS-SAVED-B-CARR     PIC X     VALUE SPACE.
  2804         16  WS-SAVED-B-GRPG     PIC X(6)  VALUE SPACES.
  2805         16  WS-SAVED-B-STAT     PIC XX    VALUE SPACES.
  2806         16  WS-SAVED-B-ACCT     PIC X(10) VALUE SPACES.
  2807         16  WS-SAVED-B-DATE     PIC 9(11) COMP-3 VALUE ZEROS.
  2808         16  WS-SAVED-B-CERT     PIC X(11) VALUE SPACES.
  2809
  2810     12  WS-SAVED-ONL-KEY.
  2811         16  WS-SAVED-O-COMP     PIC X     VALUE LOW-VALUE.
  2812         16  WS-SAVED-O-CARR     PIC X     VALUE SPACE.
  2813         16  WS-SAVED-O-GRPG     PIC X(6)  VALUE SPACES.
  2814         16  WS-SAVED-O-STAT     PIC XX    VALUE SPACES.
  2815         16  WS-SAVED-O-ACCT     PIC X(10) VALUE SPACES.
  2816         16  WS-SAVED-O-DATE     PIC 9(11) COMP-3 VALUE ZEROS.
  2817         16  WS-SAVED-O-CERT     PIC X(11) VALUE SPACES.
  2818
  2819     12  WS-CLAIM-MATCH-KEY.
  2820         16  WS-CL-CARR          PIC X     VALUE SPACES.
  2821         16  WS-CL-GRPG          PIC X(6)  VALUE SPACES.
  2822         16  WS-CL-STAT          PIC XX    VALUE SPACES.
  2823         16  WS-CL-ACCT          PIC X(10) VALUE SPACES.
  2824         16  WS-CL-EFDT          PIC XX    VALUE LOW-VALUES.
  2825
  2826     12  WS-SEC-CLAIM-INDEX.
  2827         16  WS-S-CL-COMP        PIC X     VALUE LOW-VALUES.
  2828         16  WS-S-CL-PRIM        PIC X(10) VALUE SPACES.
  2829         16  WS-S-CL-SFX         PIC X     VALUE SPACE.
  2830
  2831     12  WS-CM-CANCEL-DATE.
  2832         16  WS-CM-CANC-MO       PIC XX   VALUE SPACES.
  2833         16  WS-CM-CANC-DA       PIC XX   VALUE SPACES.
  2834         16  WS-CM-CANC-YR       PIC XX   VALUE SPACES.
  2835
  2836     12  WS-CURRENT-DATE-MDY.
  2837         16  WS-CURR-MO          PIC XX   VALUE SPACES.
  2838         16  WS-CURR-DA          PIC XX   VALUE SPACES.
  2839         16  WS-CURR-YR          PIC XX   VALUE SPACES.
  2840
  2841     12  WS-CTBL-KEY.
  2842         16  WS-CTBL-COMP-CD     PIC X    VALUE LOW-VALUES.
  2843         16  WS-CTBL-TABLE       PIC XXX  VALUE SPACES.
  2844         16  WS-CTBL-BEN-TYPE    PIC X    VALUE SPACE.
  2845         16  WS-CTBL-BEN-CODE    PIC XX   VALUE '  '.
  2846     12  WS-LAST-CTBL-KEY        PIC X(7) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  60
* EL331.cbl
  2847
  2848 01  COMM-MATCH-AREA.
  2849     12  WS-L-COM                PIC SV9(5) COMP-3 VALUE +0.
  2850     12  WS-J-COM                PIC SV9(5) COMP-3 VALUE +0.
  2851     12  WS-A-COM                PIC SV9(5) COMP-3 VALUE +0.
  2852     12  WS-COMM-CK-AMT          PIC S9(9)V99 COMP-3 VALUE +0.
  2853     12  WS-CK-AGE               PIC S999    VALUE ZEROS.
  2854     12  WS-CK-TERM              PIC S99     VALUE ZEROS.
  2855
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  61
* EL331.cbl
* 2857                                 COPY ELCDATE.
  2858******************************************************************06/11/98
  2859*                                                                *ELCDATE
  2860*                                                                *ELCDATE
  2861*                            ELCDATE.                            *   LV023
  2862*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  2863*                            VMOD=2.003                           ELCDATE
  2864*                                                                *ELCDATE
  2865*                                                                *ELCDATE
  2866*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  2867*                 LENGTH = 200                                   *   CL*19
  2868******************************************************************ELCDATE
  2869                                                                  ELCDATE
  2870 01  DATE-CONVERSION-DATA.                                        ELCDATE
  2871     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  2872     12  DC-OPTION-CODE                PIC X.                        CL*15
  2873         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  2874         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  2875         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  2876         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  2877         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  2878         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  2879         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  2880         88  FIND-CENTURY               VALUE '7'.                   CL*22
  2881         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  2882         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  2883         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  2884         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  2885         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  2886         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  2887         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  2888         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  2889         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  2890         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  2891         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  2892         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  2893         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  2894         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  2895         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  2896         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  2897         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  2898         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  2899         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  2900         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  2901         88  THREE-CHARACTER-BIN                                  ELCDATE
  2902                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  2903         88  GREGORIAN-TO-BIN                                        CL**2
  2904                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  2905         88  BIN-TO-GREGORIAN                                        CL**2
  2906                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  2907         88  JULIAN-TO-BINARY                                        CL**2
  2908                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  2909     12  DC-ERROR-CODE                 PIC X.                        CL*15
  2910         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  2911         88  DATE-CONVERSION-ERROR                                ELCDATE
  2912                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  2913         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  2914         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  62
* EL331.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2915         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  2916         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  2917         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  2918         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  2919         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  2920         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  2921         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  2922         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  2923     12  DC-END-OF-MONTH               PIC X.                        CL*15
  2924         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  2925     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  2926         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  2927         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  2928         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  2929     12  FILLER                        PIC X.                        CL*15
  2930     12  DC-CONVERSION-DATES.                                        CL*15
  2931         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  2932         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  2933         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  2934         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  2935                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  2936             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  2937             20  SLASH1-1              PIC X.                        CL*15
  2938             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  2939             20  SLASH1-2              PIC X.                        CL*15
  2940             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  2941         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  2942         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  2943                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  2944             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  2945             20  SLASH2-1              PIC X.                        CL*15
  2946             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  2947             20  SLASH2-2              PIC X.                        CL*15
  2948             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  2949         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  2950         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  2951                     DC-GREG-DATE-1-YMD.                          ELCDATE
  2952             20  DC-YMD-YEAR           PIC 99.                       CL*15
  2953             20  DC-YMD-MONTH          PIC 99.                       CL*15
  2954             20  DC-YMD-DAY            PIC 99.                       CL*15
  2955         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  2956         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  2957                      DC-GREG-DATE-1-MDY.                         ELCDATE
  2958             20  DC-MDY-MONTH          PIC 99.                       CL*15
  2959             20  DC-MDY-DAY            PIC 99.                       CL*15
  2960             20  DC-MDY-YEAR           PIC 99.                       CL*15
  2961         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  2962             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  2963             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  2964             20  FILLER                PIC XX.                       CL*15
  2965             20  DC-ALPHA-CENTURY.                                   CL*15
  2966                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  2967             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  2968         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  2969         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  2970         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  2971         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  2972         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  63
* EL331.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2973                                       PIC 9(05).                    CL*20
  2974         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  2975             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  2976             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  2977         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  2978         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  2979         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  2980     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  2981         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  2982         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  2983             20  FILLER                PIC 9(3).                     CL*15
  2984             20  HOLD-CEN-1-CCYY.                                    CL*15
  2985                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  2986                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  2987             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  2988             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  2989         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  2990             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  2991             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  2992             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  2993                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  2994                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  2995             20  FILLER                PIC 9(3).                     CL*15
  2996         16  HOLD-CENTURY-1-X.                                       CL*15
  2997             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  2998             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  2999                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  3000                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  3001             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  3002             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  3003         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  3004             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  3005             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  3006             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  3007                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  3008                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  3009             20  FILLER                PIC XXX.                      CL*23
  3010         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  3011         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  3012         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  3013         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  3014             20  DC-JULIAN-1-CCYY.                                   CL*15
  3015                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  3016                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  3017             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  3018         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  3019         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  3020             20  DC-JULIAN-2-CCYY.                                   CL*15
  3021                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  3022                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  3023             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  3024         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  3025             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  3026             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  3027             20  DC-EDITA-DAY          PIC 99.                       CL*15
  3028             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  3029             20  DC-EDITA-CCYY.                                      CL*15
  3030                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  64
* EL331.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3031                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  3032         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  3033             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  3034             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  3035             20  DC-EDITB-DAY          PIC 99.                       CL*15
  3036             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  3037             20  DC-EDITB-CCYY.                                      CL*15
  3038                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  3039                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  3040         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  3041         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  3042                              DC-GREG-DATE-CYMD.                  ELCDATE
  3043             20  DC-CYMD-CEN           PIC 99.                       CL*15
  3044             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  3045             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  3046             20  DC-CYMD-DAY           PIC 99.                       CL*15
  3047         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  3048         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  3049                              DC-GREG-DATE-MDCY.                  ELCDATE
  3050             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  3051             20  DC-MDCY-DAY           PIC 99.                       CL*15
  3052             20  DC-MDCY-CEN           PIC 99.                       CL*15
  3053             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  3054    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  3055        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  3056    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  3057    12  FILLER                         PIC X(28).                    CL*26
  3058
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  65
* EL331.cbl
  3060 01  PRINTER-WORK-AREAS.
  3061     12  HEADING-1.
  3062         16  FILLER      PIC X(50) VALUE SPACE.
  3063         16  FILLER      PIC X(21) VALUE '  CERTIFICATE AUDIT  '.
  3064         16  FILLER      PIC X(60) VALUE SPACES.
  3065
  3066     12  HEADING-2.
  3067         16  FILLER      PIC X(47) VALUE SPACE.
  3068         16  HD-COMP-NM  PIC X(30) VALUE SPACE.
  3069         16  FILLER      PIC X(42) VALUE SPACES.
  3070         16  FILLER      PIC X(08) VALUE 'EL331  '.
  3071
  3072     12  HEADING-3.
  3073         16  FILLER      PIC X(50) VALUE SPACE.
  3074         16  FILLER      PIC X(3)  VALUE '** '.
  3075         16  HD-DATE-FULL PIC X(18).
  3076         16  FILLER      PIC X(3)  VALUE ' **'.
  3077         16  FILLER      PIC X(45)  VALUE SPACES.
  3078         16  HD-RUN-DATE PIC X(8).
  3079
  3080     12  HEADING-4.
  3081         16  FILLER      PIC X(119) VALUE SPACE.
  3082         16  FILLER      PIC X(4)   VALUE 'PAGE'.
  3083         16  HD-PAGE-NO  PIC ZZZ9.
  3084
  3085     12  HEADING-5.
  3086         16  FILLER      PIC X(44)  VALUE
  3087         ' *---------- CERTIFICATE CONTROLS ---------*'.
  3088         16  FILLER      PIC X(44)  VALUE
  3089         '  *------------ ASSOCIATED CLAIM -----------'.
  3090         16  FILLER      PIC X(45)  VALUE
  3091         '---* *------- EXCEPTION CONDITION ----------*'.
  3092
  3093     12  HEADING-6.
  3094         16  FILLER      PIC X(46)  VALUE
  3095             '   NUMBER   EFFECTIVE C GROUP  ST  ACCOUNT    '.
  3096         16  FILLER      PIC X(46)  VALUE
  3097             'NUMBER  TYPE STATUS LN KIND INCURRED PROCESSOR'.
  3098         16  FILLER      PIC X(41)  VALUE  SPACES.
  3099
  3100     12  DTL-1.
  3101         16  FILLER              PIC X              VALUE SPACE.
  3102         16  DTL-CERT-NO         PIC X(11).
  3103         16  FILLER              PIC X              VALUE SPACE.
  3104         16  DTL-EFFECTIVE-DT.
  3105             20  DTL-EFF-MO      PIC XX.
  3106             20  FILLER          PIC X              VALUE '/'.
  3107             20  DTL-EFF-DA      PIC XX.
  3108             20  FILLER          PIC X              VALUE '/'.
  3109             20  DTL-EFF-YR      PIC XX.
  3110         16  FILLER              PIC X              VALUE SPACE.
  3111         16  DTL-CARR            PIC X.
  3112         16  FILLER              PIC X             VALUE SPACE.
  3113         16  DTL-GRPG            PIC X(6).
  3114         16  FILLER              PIC X             VALUE SPACE.
  3115         16  DTL-STAT            PIC XX.
  3116         16  FILLER              PIC X             VALUE SPACE.
  3117         16  DTL-ACCT            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  66
* EL331.cbl
  3118         16  FILLER              PIC X             VALUE SPACE.
  3119         16  DTL-CL-NO           PIC X(7).
  3120         16  FILLER              PIC X             VALUE SPACE.
  3121         16  DTL-CL-TYPE         PIC XXXX.
  3122         16  FILLER              PIC X             VALUE SPACE.
  3123         16  DTL-CL-STATUS       PIC X(6).
  3124         16  FILLER              PIC X              VALUE SPACE.
  3125         16  DTL-CL-LN-KIND      PIC X(7).
  3126         16  FILLER              PIC X              VALUE SPACE.
  3127         16  DTL-CL-INCURRED     PIC X(8).
  3128         16  FILLER              PIC XXX            VALUE SPACE.
  3129         16  DTL-CL-PROCESSOR    PIC XXXX.
  3130         16  FILLER              PIC X(4)           VALUE SPACE.
  3131         16  DTL-EXC-MSG         PIC X(40).
  3132         16  FILLER              PIC XX             VALUE SPACE.
  3133
  3134     12  WS-EXC-MSG-CANCEL.
  3135         16  WS-EXC-MSG-DESC    PIC X(26)
  3136               VALUE ' XXXX COV CANCELLED AS OF '.
  3137         16  WS-EXC-MSG-CANCEL-DATE.
  3138             25  WS-EXC-C-MO    PIC XX.
  3139             25  FILLER         PIC X                VALUE '/'.
  3140             25  WS-EXC-C-DA    PIC XX.
  3141             25  FILLER         PIC X                VALUE '/'.
  3142             25  WS-EXC-C-YR    PIC XX.
  3143
  3144     12  WS-EXC-MSG-NO-NOTES.
  3145         16  WS-EXC-MSG-NO-DE    PIC X(21)
  3146               VALUE ' CERTIFICATE PENDING-'.
  3147         16  WS-EXC-MSG-NO-COPY  PIC X(15)
  3148               VALUE 'NOTES ATTACHED.'.
  3149
  3150     12  WS-EXC-MSG-CO-DELETE   PIC X(40)
  3151               VALUE ' COVERAGE DELETED - SEE CREDIT DEPT.    '.
  3152
  3153     12  WS-EXC-MSG-CE-DELETE.
  3154         16  WS-EXC-MSG-CE-DE    PIC X(21)
  3155               VALUE ' CERTIFICATE DELETED '.
  3156         16  WS-EXC-MSG-CE-COPY  PIC X(15)
  3157               VALUE SPACES.
  3158
  3159     12  WS-EXC-MSG-EE-EXPIRED.
  3160         16  WS-EXC-MSG-EE-DE    PIC X(21)
  3161               VALUE ' CERTIFICATE EXPIRED '.
  3162         16  WS-EXC-MSG-EE-COPY  PIC X(15)
  3163               VALUE SPACES.
  3164
  3165     12  WS-EXC-MSG-ADDED.
  3166         16  FILLER             PIC X(22) VALUE
  3167                     ' COVERAGE ADDED - AMT '.
  3168         16  WS-EXC-MSG-ADDED-AMT     PIC ZZZZZZ9.99.
  3169         16  FILLER             PIC X(6) VALUE ' TYPE-'.
  3170         16  WS-EXC-MSG-ADDED-TYPE    PIC XX.
  3171
  3172     12  WS-EXC-MSG-CHANGED-NEW.
  3173         16  FILLER            PIC X(22) VALUE
  3174                     ' COVERAGE CHANGED-NEW '.
  3175         16  WS-EXC-MSG-CHGD-AMT-NEW  PIC ZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  67
* EL331.cbl
  3176         16  FILLER            PIC X(6) VALUE ' TYPE-'.
  3177         16  WS-EXC-MSG-CHGD-TYPE-NEW PIC XX.
  3178
  3179     12  WS-EXC-MSG-CHANGED-OLD.
  3180         16  FILLER              PIC X(18) VALUE   SPACES.
  3181         16  FILLER              PIC X(04) VALUE
  3182                                       'OLD '.
  3183         16  WS-EXC-MSG-CHGD-AMT-OLD  PIC ZZZZZZ9.99.
  3184         16  FILLER                   PIC X(6) VALUE ' TYPE-'.
  3185         16  WS-EXC-MSG-CHGD-TYPE-OLD PIC XX.
  3186
  3187     12  WS-EXC-MSG-COPY.
  3188         16  FILLER              PIC X(20) VALUE
  3189                                       'CERT COPIED FROM ECS'.
  3190
  3191     12  FTG-1.
  3192         16  P-MATCHED-ONL       PIC ZZZ,ZZZ,ZZ9-.
  3193         16  FILLER              PIC X(35)
  3194                   VALUE  ' MATCHED / UPDATED (+)   '.
  3195
  3196     12  FTG-2.
  3197         16  P-LOADED-ECS        PIC ZZZ,ZZZ,ZZ9-.
  3198         16  FILLER              PIC X(35)
  3199                   VALUE  ' LOADED FROM OFFLINE (+) '.
  3200
  3201     12  FTG-3.
  3202         16  P-ONL-DELETED       PIC ZZZ,ZZZ,ZZ9-.
  3203         16  FILLER              PIC X(35)
  3204                   VALUE  ' ONLINE DELETED    (-)   '.
  3205         16  FILLER              PIC X(30)
  3206                   VALUE  ' CURRENT ELCERT RECORD COUNT--'.
  3207         16  P-ONL-EXIST         PIC ZZZ,ZZZ,ZZ9-.
  3208
  3209     12  FTG-4.
  3210         16  P-CLAIM-MATCH       PIC ZZZ,ZZZ,ZZ9-.
  3211         16  FILLER              PIC X(35)
  3212                   VALUE  ' HAVE ATTACHED CLAIMS    '.
  3213
  3214     12  FTG-5.
  3215         16  P-INACTIVE-CERTS    PIC ZZZ,ZZZ,ZZ9-.
  3216         16  FILLER              PIC X(35)
  3217                   VALUE  ' INACTIVE AND BYPASSED   '.
  3218
  3219     12  FTG-6.
  3220         16  P-ONL-READ          PIC ZZZ,ZZZ,ZZ9-.
  3221         16  FILLER              PIC X(35)
  3222                   VALUE  ' ONLINE CERTS READ       '.
  3223
  3224     12  FTG-7.
  3225         16  P-ECS-READ          PIC ZZZ,ZZZ,ZZ9-.
  3226         16  FILLER              PIC X(35)
  3227                   VALUE  ' OFFLINE CERTS READ      '.
  3228
  3229     12  FTG-8.
  3230         16  P-EXCP-ADD          PIC ZZZ,ZZZ,ZZ9-.
  3231         16  FILLER              PIC X(35)
  3232                   VALUE  ' COMP EXCEPTIONS ADDED'.
  3233
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  68
* EL331.cbl
  3234     12  FTG-9.
  3235         16  P-EXCP-DEL          PIC ZZZ,ZZZ,ZZ9-.
  3236         16  FILLER              PIC X(35)
  3237                   VALUE  ' COMP EXCEPTIONS DELETED'.
  3238
  3239     12  FTG-10.
  3240         16  P-EXCP-TBL          PIC ZZZ,ZZZ,ZZ9-.
  3241         16  FILLER              PIC X(35)
  3242                   VALUE  ' ACCTS WITH COMM TABLES '.
  3243
  3244     12  FTG-11.
  3245         16  P-MAIL-DEL          PIC ZZZ,ZZZ,ZZ9-.
  3246         16  FILLER              PIC X(35)
  3247                   VALUE  ' INSURED ADDRESS MAIL RECS DELETED '.
  3248
  3249     12  FTG-12.
  3250         16  P-ACCT-READS        PIC ZZZ,ZZZ,ZZ9-.
  3251         16  FILLER              PIC X(35)
  3252                   VALUE  ' ACCOUNT MASTER MATCH ATTEMPTS '.
  3253
  3254     12  FTG-13.
  3255         16  P-ACT-READ          PIC ZZZ,ZZZ,ZZ9-.
  3256         16  FILLER              PIC X(35)
  3257                   VALUE  ' ERACCT RECORDS READ '.
  3258
  3259     12  FTG-14.
  3260         16  P-ACCT-MATCH        PIC ZZZ,ZZZ,ZZ9-.
  3261         16  FILLER              PIC X(35)
  3262                   VALUE  ' CERTS MATCHED TO ACCOUNT MASTER '.
  3263
  3264
* 3265                                 COPY ELCDTECX.
  3266******************************************************************06/05/98
  3267*                                                                *ELCDTECX
  3268*                            ELCDTECX.                           *   LV005
  3269*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3270*                            VMOD=2.015                          *ELCDTECX
  3271*                                                                *ELCDTECX
  3272*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  3273*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  3274*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  3275*                                                                *ELCDTECX
  3276******************************************************************ELCDTECX
  3277******************************************************************
  3278*                   C H A N G E   L O G
  3279*
  3280* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3281*-----------------------------------------------------------------
  3282*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3283* EFFECTIVE    NUMBER
  3284*-----------------------------------------------------------------
  3285* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  3286*                                  BENEFIT CODES FROM 300 TO 900
  3287* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  3288* 051304    2003080800002  SMVA  ADD REFUND METHOD
  3289******************************************************************
  3290 01  DATE-CARD.                                                   ELCDTECX
  3291     12  DATX-COD                    PIC  X(4).                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  69
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3292     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  3293     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  3294     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  3295     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  3296     12  EP-SW                       PIC  X.                      ELCDTECX
  3297         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  3298     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  3299         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  3300     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  3301     12  RUN-CENTURY.                                             ELCDTECX
  3302         16 RUN-CENTURY-N            PIC  99.                        CL**4
  3303     12  FILLER                      PIC  X.                         CL**4
  3304     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  3305     12  FILLER                      PIC  XXX.                    ELCDTECX
  3306     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  3307                                                                  ELCDTECX
  3308 01  FILLER                          PIC  X(7)                       CL**6
  3309                                          VALUE 'OPTIONS'.        ELCDTECX
  3310 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  3311     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  3312     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  3313     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  3314         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  3315         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  3316     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  3317     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  3318     12  FILLER                      PIC  X.                      ELCDTECX
  3319     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  3320     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  3321     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  3322     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  3323     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  3324     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  3325     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  3326     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  3327     12  FILLER                      PIC  X.                      ELCDTECX
  3328     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  3329     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  3330     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  3331     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  3332     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  3333     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  3334     12  FILLER                      PIC  X.                      ELCDTECX
  3335     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  3336     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  3337     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  3338     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  3339     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  3340     12  DTE-R78                     PIC  X.                      ELCDTECX
  3341     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  3342     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  3343     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  3344     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  3345     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  3346     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  3347     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  3348                                     PIC  X.                      ELCDTECX
  3349         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  70
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3350                                                 ' '.             ELCDTECX
  3351         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  3352         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  3353     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  3354         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  3355         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  3356     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  3357     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  3358                                     PIC  9.                         CL**4
  3359     12  DTE-SYSTEM.                                              ELCDTECX
  3360         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  3361         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  3362         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  3363         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  3364         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  3365         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  3366         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  3367         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  3368         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  3369         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  3370         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  3371         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  3372         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  3373         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  3374         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  3375         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  3376         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  3377         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  3378         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  3379         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  3380         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  3381         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  3382         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  3383         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  3384         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  3385         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  3386     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  3387         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  3388                                     PIC  X.                      ELCDTECX
  3389     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  3390                                                                  ELCDTECX
  3391 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  3392     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  3393     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  3394     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  3395*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  3396     12  FILLER                      PIC  X.                      ELCDTECX
  3397     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  3398     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  3399     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  3400     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  3401     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  3402     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  3403     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  3404                                                                  ELCDTECX
  3405     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  3406     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  3407     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  71
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3408     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  3409                                                                  ELCDTECX
  3410     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  3411     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  3412     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  3413     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  3414                                                                  ELCDTECX
  3415     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  3416     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  3417                                                                  ELCDTECX
  3418     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  3419     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  3420                                                                  ELCDTECX
  3421     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  3422                                                                  ELCDTECX
  3423 01  DATE-CARD-FACTORS.                                           ELCDTECX
  3424     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  3425     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  3426     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  3427     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  3428     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  3429     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  3430     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  3431                                                                  ELCDTECX
  3432 01  FILLER                          PIC  X(12)                   ELCDTECX
  3433                                          VALUE 'COMPANY NAME'.   ELCDTECX
  3434 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  3435     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  3436         16  CNT-ID                  PIC  X.                      ELCDTECX
  3437         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  3438                                                                  ELCDTECX
  3439 01  FILLER                          PIC  X(11)                   ELCDTECX
  3440                                          VALUE 'STATE NAMES'.    ELCDTECX
  3441 01  STATE-NAMES.                                                 ELCDTECX
  3442     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  3443         16  STATE-SUB               PIC  XX.                     ELCDTECX
  3444         16  STATE-PIC1.                                          ELCDTECX
  3445             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  3446             20  FILLER              PIC  XXX.                    ELCDTECX
  3447             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  3448             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  3449             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  3450             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  3451                                                                  ELCDTECX
  3452 01  FILLER                          PIC  X(13)                   ELCDTECX
  3453                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  3454 01  CARRIER-NAMES.                                               ELCDTECX
  3455     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  3456         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  3457         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  3458         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  3459         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3460         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3461         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3462*        16  FILLER                  PIC  X.                      ELCDTECX
  3463         16  CARRIER-SEC-PAY         PIC  X.
  3464             88  SEC-PAY-CARRIER          VALUE 'Y'.
  3465                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  72
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3466 01  FILLER                          PIC  X(9)                       CL**6
  3467                                          VALUE 'INS TYPES'.      ELCDTECX
  3468 01  CLAS-INS-TYPES.                                              ELCDTECX
  3469*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  3470     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  3471         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  3472         16  CLAS-I-AB3.                                          ELCDTECX
  3473             20  FILLER              PIC  X.                      ELCDTECX
  3474             20  CLAS-I-AB2.                                      ELCDTECX
  3475                 24  FILLER          PIC  X.                      ELCDTECX
  3476                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  3477         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  3478             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  3479             20  FILLER              PIC  X.                         CL**4
  3480         16  CLAS-I-AB10.                                         ELCDTECX
  3481             20  FILLER              PIC  X(9).                   ELCDTECX
  3482             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  3483         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  3484         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  3485         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  3486         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  3487             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  3488         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  3489         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  3490         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  3491         16  CLAS-I-BEN-CATEGORY     PIC  X.
  3492         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  3493         16  FILLER                  PIC  X(05).
  3494                                                                  ELCDTECX
  3495 01  FILLER                          PIC  X(16)                   ELCDTECX
  3496                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  3497 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  3498     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  3499                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  3500         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  3501         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  3502         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  3503         16  CLAS-MORT-DESC.                                      ELCDTECX
  3504             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  3505             20  FILLER              PIC  XX.                        CL**5
  3506             20  CLAS-YEAR           PIC  X(4).                      CL**6
  3507             20  FILLER              PIC  X.                         CL**5
  3508             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  3509             20  FILLER              PIC  X.                         CL**5
  3510             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  3511             20  FILLER              PIC  X.                         CL**5
  3512             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  3513             20  FILLER              PIC  X(5).                      CL**6
  3514                                                                  ELCDTECX
  3515 01  FILLER                          PIC  X(15)                   ELCDTECX
  3516                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  3517 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  3518     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  3519         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  3520         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  3521         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  3522         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  3523         16  FILLER                  PIC  X(4).                      CL**6
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  73
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3524                                                                  ELCDTECX
  3525 01  FILLER                          PIC  X(7)                       CL**6
  3526                                     VALUE 'INDEXES'.             ELCDTECX
  3527 01  CLAS-INDEX-TBL.                                              ELCDTECX
  3528     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  3529     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  3530     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  3531     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  3532     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  3533     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  3534     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  3535     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  3536     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  3537     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  3538     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  3539     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  3540     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  3541     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  3542     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  3543     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  3544     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  3545                                                                  ELCDTECX
  3546 01  CLAS-TYPE-MISC.                                              ELCDTECX
  3547     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  3548     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  3549     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  3550     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  3551     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  3552     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  3553     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  3554     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  3555     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  3556     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  3557     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  3558                                                                  ELCDTECX
  3559 01  FILLER                          PIC  X(13)                   ELCDTECX
  3560                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  3561 01  CLAS-MISC.                                                   ELCDTECX
  3562     12  DTE-FICH                    PIC  X.                      ELCDTECX
  3563         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  3564         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  3565         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  3566     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  3567     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  3568     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  3569     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  3570     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  3571     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  3572     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  3573     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  3574     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  3575     12  STATE-L                     PIC  XX.                     ELCDTECX
  3576     12  CLAS-CN                     PIC  99.                     ELCDTECX
  3577     12  CLAS-CO                     PIC  99.                     ELCDTECX
  3578     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  3579         16  DTE-F-1                 PIC  X.                      ELCDTECX
  3580         16  DTE-F-2                 PIC  X.                      ELCDTECX
  3581     12  DTE-ABEND-WORK.                                          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  74
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3582         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  3583         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  3584                                                                  ELCDTECX
  3585 01  FILLER                          PIC  X(12)                   ELCDTECX
  3586                                     VALUE 'WORKING DATE'.        ELCDTECX
  3587 01  WS-DATE-AND-TIME.                                            ELCDTECX
  3588     12  WS-ACCEPT-DATE.                                          ELCDTECX
  3589         16  WS-AD-YY                PIC  99.                     ELCDTECX
  3590         16  WS-AD-MM                PIC  99.                     ELCDTECX
  3591         16  WS-AD-DD                PIC  99.                     ELCDTECX
  3592     12  WS-CURRENT-DATE.                                         ELCDTECX
  3593         16  WS-CD-MM                PIC  99.                     ELCDTECX
  3594         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3595         16  WS-CD-DD                PIC  99.                     ELCDTECX
  3596         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3597         16  WS-CD-YY                PIC  99.                     ELCDTECX
  3598     12  WS-TIME-OF-DAY.                                          ELCDTECX
  3599         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  3600         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  3601                                                                  ELCDTECX
  3602 01  FILLER                          PIC  X(12)                   ELCDTECX
  3603                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  3604 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  3605     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  3606         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  3607         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  3608         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  3609                                                                  ELCDTECX
  3610 01  FILLER                          PIC  X(10)                   ELCDTECX
  3611                                     VALUE 'STATE TLRS'.          ELCDTECX
  3612 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  3613     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  3614         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  3615         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  3616                                                                  ELCDTECX
  3617 01  FILLER                          PIC  X(13)                   ELCDTECX
  3618                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  3619 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  3620     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  3621         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  3622                                                                  ELCDTECX
  3623 01  FILLER                          PIC  X(13)                   ELCDTECX
  3624                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  3625 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  3626     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  3627     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  3628     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  3629                                     PIC  X.                         CL**5
  3630     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  3631     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  3632     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  3633     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  3634     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  3635     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  3636     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  3637     12  FILLER                      PIC  X(75).                  ELCDTECX
  3638******************************************************************ELCDTECX
  3639*01  MISC-CARR-PCT-DATA.                                          00001521
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  75
* EL331.cbl
  3640*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3641*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3642*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3643*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3644*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3645*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3646******************************************************************ELCDTECX
  3647
* 3648                                 COPY ELCDTEVR.
  3649***************************************************************** 04/15/98
  3650*                                                                *ELCDTEVR
  3651*                                                                *ELCDTEVR
  3652*                            ELCDTEVR.                           *   LV003
  3653*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3654*                            VMOD=2.001                          *   CL**2
  3655*                                                                *ELCDTEVR
  3656*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  3657*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  3658*                                                                *ELCDTEVR
  3659******************************************************************ELCDTEVR
  3660 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  3661     05  WS-RUN-DATE.                                             ELCDTEVR
  3662         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3663         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  3664         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  3665             15  RUN-CC              PIC  99.                     ELCDTEVR
  3666             15  RUN-YR              PIC  99.                     ELCDTEVR
  3667         10  RUN-MO                  PIC  99.                     ELCDTEVR
  3668         10  RUN-DA                  PIC  99.                     ELCDTEVR
  3669     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  3670            WS-RUN-DATE              PIC 9(11).                      CL**2
  3671     05  WS-EP-DT.                                                ELCDTEVR
  3672         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3673         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  3674         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  3675             15  EP-CC               PIC  99.                     ELCDTEVR
  3676             15  EP-YR               PIC  99.                     ELCDTEVR
  3677         10  EP-MO                   PIC  99.                     ELCDTEVR
  3678         10  EP-DA                   PIC  99.                     ELCDTEVR
  3679     05  WS-EP-DT-N REDEFINES                                        CL**2
  3680            WS-EP-DT                 PIC 9(11).                      CL**2
  3681     05  WS-DTE-CONV-DT.                                             CL**4
  3682         10  FILLER                  PIC  9(03).                     CL**4
  3683         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  3684         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  3685             15  DTE-CONV-CC         PIC  99.                        CL**4
  3686             15  DTE-CONV-YR         PIC  99.                        CL**4
  3687         10  DTE-CONV-MO             PIC  99.                        CL**4
  3688         10  DTE-CONV-DA             PIC  99.                        CL**4
  3689     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  3690            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  3691 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  3692     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  3693         10  FILLER                            PIC 999.           ELCDTEVR
  3694         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  3695         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  3696             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  3697             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  76
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3698         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  3699         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  3700     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  3701            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  3702     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  3703         10  FILLER                            PIC 999.           ELCDTEVR
  3704         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  3705         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  3706         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  3707         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  3708     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  3709            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  3710 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  3711     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  3712         10  FILLER                            PIC 999.           ELCDTEVR
  3713         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  3714         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  3715             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  3716             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  3717         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  3718         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  3719     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  3720            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  3721     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  3722         10  FILLER                            PIC 999.           ELCDTEVR
  3723         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  3724         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  3725             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  3726             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  3727         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  3728         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  3729     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  3730            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  3731     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  3732         10  FILLER                            PIC 999.           ELCDTEVR
  3733         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  3734         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  3735             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  3736             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  3737         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  3738         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  3739     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  3740            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  3741 01  WS-RATE-RECORD.                                              ELCDTEVR
  3742         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  3743             10  FILLER                        PIC 999.           ELCDTEVR
  3744             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  3745             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  3746                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  3747                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  3748             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  3749             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  3750         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  3751                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  3752
* 3753                                 COPY ELCCRTVR.
  3754***************************************************************** 04/24/98
  3755*                                                                *ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  77
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3756*                                                                *ELCCRTVR
  3757*                            ELCCRTVR                            *   LV003
  3758*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3759*                            VMOD=2.001                          *ELCCRTVR
  3760*                                                                *ELCCRTVR
  3761*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  3762*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  3763*                                                                *ELCCRTVR
  3764******************************************************************ELCCRTVR
  3765                                                                  ELCCRTVR
  3766 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  3767     05  WS-CR-DT.                                                ELCCRTVR
  3768         10  FILLER                PIC 999.                       ELCCRTVR
  3769         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  3770         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  3771             15  CR-CC             PIC 99.                        ELCCRTVR
  3772             15  CR-YR             PIC 99.                        ELCCRTVR
  3773         10  CR-MO                 PIC 99.                        ELCCRTVR
  3774         10  CR-DA                 PIC 99.                        ELCCRTVR
  3775     05  WS-CR-DT-N REDEFINES                                        CL**2
  3776            WS-CR-DT               PIC 9(11).                        CL**2
  3777     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  3778         10  FILLER                    PIC 999.                   ELCCRTVR
  3779         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3780         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  3781             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3782             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3783         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3784         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3785     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  3786            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  3787     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  3788         10  FILLER                    PIC 999.                   ELCCRTVR
  3789         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3790         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  3791             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3792             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3793         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3794         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3795     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  3796            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  3797     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  3798         10  FILLER                    PIC 999.                   ELCCRTVR
  3799         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  3800         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  3801             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  3802             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  3803         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  3804         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  3805     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  3806            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  3807     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  3808         10  FILLER                    PIC 999.                   ELCCRTVR
  3809         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3810         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  3811             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  3812             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  3813         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  78
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3814         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  3815     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  3816            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  3817     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  3818         10  FILLER                    PIC 999.                   ELCCRTVR
  3819         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3820         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  3821             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  3822             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  3823         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  3824         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  3825     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3826            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3827     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  3828         10  FILLER                    PIC 999.                   ELCCRTVR
  3829         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3830         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  3831             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  3832             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  3833         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  3834         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  3835     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  3836            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  3837     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  3838         10  FILLER                    PIC 999.                   ELCCRTVR
  3839         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3840         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  3841             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  3842             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  3843         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  3844         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  3845     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  3846            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  3847     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  3848         10  FILLER                    PIC 999.                   ELCCRTVR
  3849         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3850         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  3851             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  3852             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  3853         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  3854         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  3855     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3856            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3857     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  3858         10  FILLER                    PIC 999.                   ELCCRTVR
  3859         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3860         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  3861             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  3862             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  3863         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  3864         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  3865     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  3866          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  3867     05  WS-CR-DTH-DT.                                            ELCCRTVR
  3868         10  FILLER                    PIC 999.                   ELCCRTVR
  3869         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  3870         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  3871             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  79
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3872             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  3873         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  3874         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  3875     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  3876            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  3877     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  3878         10  FILLER                    PIC 999.                   ELCCRTVR
  3879         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3880         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  3881             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  3882             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  3883         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  3884         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  3885     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  3886            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  3887     05  WS-CR-DIS-DT.                                            ELCCRTVR
  3888         10  FILLER                    PIC 999.                   ELCCRTVR
  3889         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  3890         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  3891             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  3892             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  3893         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  3894         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  3895     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  3896            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  3897     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  3898         10  FILLER                    PIC 999.                   ELCCRTVR
  3899         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3900         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  3901             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  3902             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  3903         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  3904         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  3905     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  3906            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  3907     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  3908         10  FILLER                    PIC 999.                   ELCCRTVR
  3909         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  3910         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  3911             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  3912             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  3913         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  3914         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  3915     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  3916            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  3917     05  COPY-NDX                      PIC 9.                        CL**6
  3918     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  3919         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  3920             15  FILLER                PIC 999.                   ELCCRTVR
  3921             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  3922             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  3923                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  3924                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  3925             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  3926             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  3927         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  3928                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  3929
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  80
* EL331.cbl
  3931 PROCEDURE DIVISION.
  3932
  3933 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  3934******************************************************************04/15/98
  3935*                                                                *ELCDTERX
  3936*                                                                *ELCDTERX
  3937*                            ELCDTERX.                           *   LV002
  3938*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3939*                            VMOD=2.007                          *ELCDTERX
  3940*                                                                *ELCDTERX
  3941*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  3942*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  3943*      = ELCDTEFD)                                               *ELCDTERX
  3944*                                                                *ELCDTERX
  3945******************************************************************ELCDTERX
  3946                                                                  ELCDTERX
  3947     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  3948                                                                  ELCDTERX
  3949     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  3950     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  3951     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  3952                                                                  ELCDTERX
  3953     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  3954                                                                  ELCDTERX
  3955******************************************************************ELCDTERX
  3956*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  3957*          WARNING MESSAGES.                                      ELCDTERX
  3958******************************************************************ELCDTERX
  3959     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  3960         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  3961                                                                  ELCDTERX
  3962     OPEN INPUT DISK-DATE.                                        ELCDTERX
  3963                                                                  ELCDTERX
  3964     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  3965                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  3966                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  3967                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  3968                   CLAX-ID           CLAS-MISC                    ELCDTERX
  3969                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  3970                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  3971                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  3972                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  3973                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  3974                                                                  ELCDTERX
  3975     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  3976                                                                  ELCDTERX
  3977     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  3978                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  3979                                                                  ELCDTERX
  3980     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  3981     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  3982     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  3983     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  3984                                                                  ELCDTERX
  3985     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  3986         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  3987     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  81
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  3988         ADD +1                 TO CLAS-CN.                       ELCDTERX
  3989                                                                  ELCDTERX
  3990     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  3991         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  3992     ELSE                                                         ELCDTERX
  3993         ADD +1                 TO CLAS-CO.                       ELCDTERX
  3994                                                                  ELCDTERX
  3995 0005-READ--CARD.                                                 ELCDTERX
  3996     READ DISK-DATE                                               ELCDTERX
  3997         AT END CLOSE DISK-DATE                                   ELCDTERX
  3998             GO TO 0060-READ--TEST.                               ELCDTERX
  3999                                                                  ELCDTERX
  4000     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  4001                                                                  ELCDTERX
  4002     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  4003         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  4004         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  4005         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  4006         GO TO 0005-READ--CARD.                                   ELCDTERX
  4007                                                                  ELCDTERX
  4008     IF DD-ID = 'CLAD'                                            ELCDTERX
  4009         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  4010         GO TO 0005-READ--CARD.                                   ELCDTERX
  4011                                                                  ELCDTERX
  4012     IF DD-ID = 'CLAX'                                            ELCDTERX
  4013         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  4014         GO TO 0005-READ--CARD.                                   ELCDTERX
  4015                                                                  ELCDTERX
  4016     IF DD-ID = 'CLAF'                                            ELCDTERX
  4017         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  4018         GO TO 0005-READ--CARD.                                   ELCDTERX
  4019                                                                  ELCDTERX
  4020     IF DD-ID = 'CLAC'                                            ELCDTERX
  4021         GO TO 0010-READ--CLAC.                                   ELCDTERX
  4022                                                                  ELCDTERX
  4023     IF DD-ID = 'CARR'                                            ELCDTERX
  4024         GO TO 0015-READ--CARR.                                   ELCDTERX
  4025                                                                  ELCDTERX
  4026     IF DD-ID = 'STAT'                                            ELCDTERX
  4027         GO TO 0020-READ--STAT.                                   ELCDTERX
  4028                                                                  ELCDTERX
  4029     IF DD-ID = 'BUSC'                                            ELCDTERX
  4030         GO TO 0025-READ--BUSC.                                   ELCDTERX
  4031                                                                  ELCDTERX
  4032     IF DD-ID = 'MORT'                                            ELCDTERX
  4033         GO TO 0030-READ--MORT.                                   ELCDTERX
  4034                                                                  ELCDTERX
  4035     IF DD-ID = 'CLAI'                                            ELCDTERX
  4036         GO TO 0040-READ--CLAI.                                   ELCDTERX
  4037                                                                  ELCDTERX
  4038     IF DD-ID = 'COLC'                                            ELCDTERX
  4039         GO TO 0065-READ--COLC.                                   ELCDTERX
  4040                                                                  ELCDTERX
  4041     IF DD-IDX NUMERIC AND                                        ELCDTERX
  4042        DD-IDA = 'CL'                                             ELCDTERX
  4043         GO TO 0035-READ--CLXX.                                   ELCDTERX
  4044                                                                  ELCDTERX
  4045     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  82
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4046        DD-IDA = 'PO'                                             ELCDTERX
  4047         GO TO 0050-READ--POXX.                                   ELCDTERX
  4048                                                                  ELCDTERX
  4049     IF DD-ID = 'OPCA'                                            ELCDTERX
  4050         GO TO 0070-READ--OPCA.                                   ELCDTERX
  4051                                                                  ELCDTERX
  4052     IF DD-ID = 'OPST'                                            ELCDTERX
  4053         GO TO 0072-READ--OPST.                                   ELCDTERX
  4054                                                                  ELCDTERX
  4055     IF DD-ID = 'OPBS'                                            ELCDTERX
  4056         GO TO 0074-READ--OPBS.                                   ELCDTERX
  4057                                                                  ELCDTERX
  4058     IF DD-ID = 'OPMS'                                            ELCDTERX
  4059         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  4060                                                                  ELCDTERX
  4061     GO TO 0005-READ--CARD.                                       ELCDTERX
  4062                                                                  ELCDTERX
  4063 0010-READ--CLAC.                                                 ELCDTERX
  4064     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4065     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4066     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4067     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4068     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4069     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4070     GO TO 0005-READ--CARD.                                       ELCDTERX
  4071                                                                  ELCDTERX
  4072 0015-READ--CARR.                                                 ELCDTERX
  4073     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4074     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4075        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  4076        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4077        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  4078        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4079        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4080        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4081        MOVE DD-CARR1-SECPAY-SW
  4082                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4083     END-IF
  4084                                                                  ELCDTERX
  4085     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4086     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4087        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  4088        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4089        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  4090        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4091        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4092        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4093        MOVE DD-CARR2-SECPAY-SW
  4094                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4095     END-IF
  4096                                                                  ELCDTERX
  4097                                                                  ELCDTERX
  4098     GO TO 0005-READ--CARD.                                       ELCDTERX
  4099                                                                  ELCDTERX
  4100 0020-READ--STAT.                                                 ELCDTERX
  4101     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4102     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4103        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  83
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4104         GO TO 0005-READ--CARD.                                   ELCDTERX
  4105                                                                  ELCDTERX
  4106     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  4107     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  4108     GO TO 0020-READ--STAT.                                       ELCDTERX
  4109                                                                  ELCDTERX
  4110 0025-READ--BUSC.                                                 ELCDTERX
  4111     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4112     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4113        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  4114         GO TO 0005-READ--CARD.                                   ELCDTERX
  4115                                                                  ELCDTERX
  4116     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  4117     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  4118     GO TO 0025-READ--BUSC.                                       ELCDTERX
  4119                                                                  ELCDTERX
  4120 0030-READ--MORT.                                                 ELCDTERX
  4121     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4122     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4123        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  4124         GO TO 0005-READ--CARD.                                   ELCDTERX
  4125                                                                  ELCDTERX
  4126     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  4127     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  4128     GO TO 0030-READ--MORT.                                       ELCDTERX
  4129                                                                  ELCDTERX
  4130 0035-READ--CLXX.                                                 ELCDTERX
  4131     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  4132          GO TO 0005-READ--CARD.                                  ELCDTERX
  4133                                                                  ELCDTERX
  4134     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  4135         DISPLAY '***********************************************'ELCDTERX
  4136         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  4137         DISPLAY '***********************************************'ELCDTERX
  4138         GO TO 0055-READ--STOP.                                   ELCDTERX
  4139                                                                  ELCDTERX
  4140     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  4141        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  4142         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  4143                                                                  ELCDTERX
  4144     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  4145        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  4146         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  4147                                                                  ELCDTERX
  4148*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  4149     GO TO 0005-READ--CARD.                                       ELCDTERX
  4150                                                                  ELCDTERX
  4151 0040-READ--CLAI.                                                 ELCDTERX
  4152     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4153     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4154        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  4155         GO TO 0005-READ--CARD.                                   ELCDTERX
  4156                                                                  ELCDTERX
  4157     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  4158     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  4159     GO TO 0040-READ--CLAI.                                       ELCDTERX
  4160                                                                  ELCDTERX
  4161 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  84
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4162     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  4163     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  4164                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  4165     PERFORM ABEND-PGM.                                           ELCDTERX
  4166                                                                  ELCDTERX
  4167 0050-READ--POXX.                                                 ELCDTERX
  4168     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  4169         GO TO 0005-READ--CARD.                                   ELCDTERX
  4170                                                                  ELCDTERX
  4171     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  4172         DISPLAY '***********************************************'ELCDTERX
  4173         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  4174         DISPLAY '***********************************************'ELCDTERX
  4175         GO TO 0055-READ--STOP.                                   ELCDTERX
  4176                                                                  ELCDTERX
  4177     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  4178     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  4179     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  4180     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  4181                                                                  ELCDTERX
  4182     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  4183         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  4184     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  4185         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  4186                                                                  ELCDTERX
  4187     GO TO 0005-READ--CARD.                                       ELCDTERX
  4188                                                                  ELCDTERX
  4189 0055-READ--STOP.                                                 ELCDTERX
  4190     GOBACK.                                                      ELCDTERX
  4191                                                                  ELCDTERX
  4192 0060-READ--TEST.                                                 ELCDTERX
  4193     IF DATX-COD        = SPACE  OR                               ELCDTERX
  4194        CLAX-ID         = SPACE  OR                               ELCDTERX
  4195        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  4196         GO TO 0045-READ--DUMP.                                   ELCDTERX
  4197                                                                  ELCDTERX
  4198     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  4199     GO TO 0079-READ--EXIT.                                       ELCDTERX
  4200                                                                  ELCDTERX
  4201 0065-READ--COLC.                                                 ELCDTERX
  4202     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  4203     GO TO 0005-READ--CARD.                                       ELCDTERX
  4204                                                                  ELCDTERX
  4205 0070-READ--OPCA.                                                 ELCDTERX
  4206                                                                  ELCDTERX
  4207     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4208                                                                  ELCDTERX
  4209     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  4210             OR                                                   ELCDTERX
  4211         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  4212         GO TO 0005-READ--CARD.                                   ELCDTERX
  4213                                                                  ELCDTERX
  4214     ADD 1                       TO INDEXCA.                      ELCDTERX
  4215     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  4216                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  4217     GO TO 0070-READ--OPCA.                                       ELCDTERX
  4218                                                                  ELCDTERX
  4219 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  85
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4220                                                                  ELCDTERX
  4221     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4222                                                                  ELCDTERX
  4223     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  4224             OR                                                   ELCDTERX
  4225         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4226         GO TO 0005-READ--CARD.                                   ELCDTERX
  4227                                                                  ELCDTERX
  4228     ADD 1                       TO INDEXST.                      ELCDTERX
  4229     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  4230                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  4231     GO TO 0072-READ--OPST.                                       ELCDTERX
  4232                                                                  ELCDTERX
  4233 0074-READ--OPBS.                                                 ELCDTERX
  4234                                                                  ELCDTERX
  4235     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4236                                                                  ELCDTERX
  4237     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  4238             OR                                                   ELCDTERX
  4239         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4240         GO TO 0005-READ--CARD.                                   ELCDTERX
  4241                                                                  ELCDTERX
  4242     ADD 1                       TO INDEXBS.                      ELCDTERX
  4243     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  4244     GO TO 0074-READ--OPBS.                                       ELCDTERX
  4245                                                                  ELCDTERX
  4246 0079-READ--EXIT.                                                 ELCDTERX
  4247*    EXIT.                                                        ELCDTERX
  4248******************************************************************ELCDTERX
  4249
  4250     MOVE BIN-RUN-DATE           TO  WS-EOM-DT.
  4251
  4252     MOVE WS-TIME                TO ME-START-TIME.
  4253     MOVE WS-CURRENT-DATE        TO ME-START-DATE.
  4254     MOVE ME-START-MO            TO ME-CNDS-MO.
  4255     MOVE ME-START-DA            TO ME-CNDS-DA.
  4256     MOVE ME-START-YR            TO ME-CNDS-YR.
  4257
  4258     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  4259
  4260     IF DTE-CLIENT = 'CID'
  4261         MOVE 'CILG331'          TO  WS-ME50-BAL-JOB
  4262     ELSE
  4263       IF DTE-CLIENT = 'AHL'
  4264         MOVE 'AHLG331'          TO  WS-ME50-BAL-JOB
  4265       ELSE
  4266         MOVE 'CIDCLG331'        TO  WS-ME50-BAL-JOB
  4267       END-IF
  4268     END-IF.
  4269
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  86
* EL331.cbl
  4271
  4272 0000-MAINLINE.
  4273
  4274     PERFORM 7000-INITIALIZE    THRU 7000-EXIT.
  4275
  4276     PERFORM 2000-PROCESS-CERT  THRU 2000-EXIT
  4277         UNTIL NO-MORE-RECORDS OR
  4278               IO-ERROR-OCCURRED.
  4279
  4280     PERFORM 8000-FINALIZE THRU 8000-EXIT.
  4281
  4282     IF DTE-CLIENT EQUAL 'JAL' OR 'JAI'
  4283        DISPLAY ' CERTS WITHOUT PREM ...' NO-PREM-CT
  4284        DISPLAY ' CERTS WITHOUT PLANS ..' NO-PLAN-CODE-CT.
  4285
  4286 0000-EXIT.
  4287
  4288****************************************************************
  4289*     OPEN I/O (ERMEBL)   MONTH END BALANCE FILE ACCESSED      *
  4290*     THRU ME-CONTROL-PRIMARY.  STATISTICS FOR EL331 UPDATED   *
  4291*     IN MONTH-END RECORD EACH TIME RUN.                       *
  4292****************************************************************
  4293
  4294     OPEN I-O ERMEBL.
  4295
  4296     IF ERMEBL-FILE-STATUS NOT = ZERO AND '97'
  4297         MOVE 'N'                TO ME-UPDATE-FLAG.
  4298
  4299     MOVE DTE-CLIENT             TO ME-COMPANY.
  4300     MOVE MONTH-END-MOYR         TO ME-MOYR.
  4301
  4302     IF ME-DO-UPDATE
  4303         READ ERMEBL INVALID KEY
  4304         MOVE 'N'                TO ME-UPDATE-FLAG
  4305         CLOSE ERMEBL.
  4306
  4307     IF ME-DO-UPDATE
  4308         MOVE ME-START-TIME      TO ME-331-START
  4309         MOVE ME-CNDS-DATE       TO ME-331-RUN-DT
  4310         ACCEPT WS-TIME-OF-DAY   FROM  TIME
  4311         MOVE WS-TIME            TO ME-331-END
  4312         ADD 1                   TO ME-331-RUN-CT
  4313         MOVE 1                  TO ME-331-FLAG
  4314         REWRITE MONTH-END-BALANCES
  4315         CLOSE ERMEBL.
  4316
  4317     GOBACK.
  4318
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  87
* EL331.cbl
  4320******************************************************************
  4321*  PROCESSING FLOW BASED UPON CERT CONTROL COMPARISON:           *
  4322*                                                                *
  4323* 1) ECS (BATCH CERT CONTROL) GREATER  ONL (ONLINE CERT CONTROL) *
  4324*    2300-PROCESS-N-READ-ONL                                     *
  4325*        2330-FIND-ASSOCIATED-CLAIM                              *
  4326*                                                                *
  4327*            -NO CLAIMS  7320-BLD-ONL-PRT-LINE                   *
  4328*                        7350-BLD-CLM-INFO                       *
  4329*                        7370-PRINT-DETAIL                       *
  4330*                        2280-DELETE-ERMAIL                      *
  4331*                        2270-DELETE-ERCOMM                      *
  4332*                        DELETE ONLINE CERT MASTER               *
  4333*                                                                *
  4334*            -CLAIMS     REWRITE ONLINE CERT MASTER              *
  4335*                        7320-BLD-ONL-PRT-LINE                   *
  4336*                        7350-BLD-CLM-INFO                       *
  4337*                        7370-PRINT-DETAIL                       *
  4338*                                                                *
  4339* 2) ECS (BATCH CERT CONTROL) EQUAL  ONL (ONLINE CERT CONTROL)   *
  4340*    2500-PROCESS-MATCHING                                       *
  4341*        2330-FIND-ASSOCIATED-CLAIM                              *
  4342*                                                                *
  4343*            -NO CLAIMS  2600-REWRITE-CERT                       *
  4344*                        REBUILDS ONLINE CERT FROM BATCH CERT    *
  4345*                                                                *
  4346*            -CLAIMS     2510-BUILD-PRINT (REFLECTS ACTIVITY)    *
  4347*                        2600-REWRITE-CERT                       *
  4348*                        REBUILDS ONLINE CERT FROM BATCH CERT    *
  4349*                                                                *
  4350* 3) ONL (ONLINE CERT CONTROL) GREATER  ECS (BATCH CERT CONTROL) *
  4351*    2800-ADD-NEW-CERT                                           *
  4352*        2830-MOVE-DATA                                          *
  4353*        2820-BUILD-NEW-KEY                                      *
  4354*        2200-MATCH-ACCT                                         *
  4355*        WRITE ONLINE CERT MASTER                                *
  4356******************************************************************
  4357
  4358 2000-PROCESS-CERT.
  4359
  4360     PERFORM 2100-READ-ECS-RECORDS   THRU 2100-EXIT.
  4361
  4362     IF WS-SAVED-ECS-KEY GREATER WS-SAVED-ONL-KEY
  4363         MOVE SPACES             TO WS-ONL-GE-SW
  4364         PERFORM 2300-PROCESS-N-READ-ONL THRU 2300-EXIT
  4365         UNTIL ONL-KEY-EQUAL-OR-GREATER.
  4366
  4367     IF NO-MORE-ECS-RECORDS  AND  NO-MORE-ONL-RECORDS
  4368          MOVE  'X'              TO WS-ALL-END-SW
  4369          GO TO 2000-EXIT.
  4370
  4371     IF WS-SAVED-ONL-KEY EQUAL WS-SAVED-ECS-KEY
  4372        PERFORM 2500-PROCESS-MATCHING  THRU 2500-EXIT.
  4373
  4374     IF WS-SAVED-ONL-KEY GREATER WS-SAVED-ECS-KEY
  4375        ADD +1                   TO WS-LOADED-ECS
  4376        PERFORM 2800-ADD-NEW-CERT  THRU 2800-EXIT.
  4377
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  88
* EL331.cbl
  4378 2000-EXIT.
  4379      EXIT.
  4380
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  89
* EL331.cbl
  4382*****************************************************************
  4383*  2100-READ-ECS-RECORDS                                        *
  4384*****************************************************************
  4385*  READ BATCH CERTIFICATE MASTER RECORD AND CALCULATE AN EXPIRY *
  4386*  DATE BASED UPON ISSUE DATE, COVERAGE TERM, CERTIFICATE TYPE, *
  4387*  AND ANY CLAIM ACTIVITY. THIS COMPUTED DATE IS COMPARED WITH  *
  4388*  THE RUN DATE PROVIDED THRU THE DATE CARD LOAD TO DETERMINE   *
  4389*  IF THE CERTIFICATE WILL BE LOADED BACK TO ONLINE. BENEFIT    *
  4390*  TYPES OF UNEXPIRED CERTS ARE VALIDATED AGAINST THE BENEFIT   *
  4391*  TABLE.                                                       *
  4392*  EXPIRY DATE EQUAL :                                          *
  4393*      1) CLAIMS PAID (EFFECTIVE DATE + LONGEST TERM + 36)      *
  4394*      2) NO CLAIMS   (EFFECTIVE DATE + LONGEST TERM + 12)      *
  4395*      3) O.B. CERTS  (EFFECTIVE DATE + LONGEST TERM + 36)      *
  4396*****************************************************************
  4397
  4398 2100-READ-ECS-RECORDS.
  4399
  4400     IF NO-MORE-ECS-RECORDS
  4401         GO TO 2100-EXIT.
  4402
  4403     READ ECSCRT01  AT END
  4404         MOVE 'X'                TO WS-ECS-END-SW
  4405         MOVE HIGH-VALUES        TO WS-SAVED-ECS-KEY
  4406         GO TO 2100-EXIT.
  4407
  4408     ADD  1                      TO WS-ECS-READ.
  4409
  4410     IF  CR-LF-CANCEL-EXIT-DATE  NOT NUMERIC
  4411          MOVE ZEROS             TO CR-LF-CANCEL-EXIT-DATE.
  4412
  4413     IF  CR-AH-CANCEL-EXIT-DATE  NOT NUMERIC
  4414          MOVE ZEROS             TO CR-AH-CANCEL-EXIT-DATE.
  4415
  4416     IF  CR-LF-CLAIM-EXIT-DATE  NOT NUMERIC
  4417          MOVE ZEROS             TO CR-LF-CLAIM-EXIT-DATE.
  4418
  4419     IF  CR-AH-SETTLEMENT-EXIT-DATE  NOT NUMERIC
  4420          MOVE ZEROS             TO CR-AH-SETTLEMENT-EXIT-DATE.
  4421
* 4422     COPY ELCCRTM1.
  4423******************************************************************04/15/98
  4424*                                                                *ELCCRTM1
  4425*                                                                *ELCCRTM1
  4426*                            ELCCRTM1                            *   LV003
  4427*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4428*                            VMOD=2.001                          *ELCCRTM1
  4429*                                                                *ELCCRTM1
  4430*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4431*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4432*                                                                *ELCCRTM1
  4433******************************************************************ELCCRTM1
  4434     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4435     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4436     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4437     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4438     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4439     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  90
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  4440     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4441     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4442     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4443                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4444     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  4445                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4446     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4447     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4448     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4449     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4450     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4451     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4452           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4453                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4454     END-PERFORM.                                                 ELCCRTM1
  4455                                                                  ELCCRTM1
  4456
  4457     IF DTE-CLIENT EQUAL 'HAN'
  4458        IF CR-GROUPING NOT EQUAL '010184'
  4459           MOVE CR-LNAME            TO WS-EFF-ACT-NAME
  4460           MOVE CR-ACCOUNT          TO WS-HAN-ACCOUNT
  4461           IF WS-NAME-EFF-DT NUMERIC
  4462              MOVE WS-HAN-ACCT-4-10 TO WS-NAME-ACCT
  4463*             MOVE CR-ACCOUNT       TO WS-NAME-ACCT
  4464              MOVE SPACES           TO WS-NAME-FILL
  4465              MOVE WS-EFF-ACT-NAME  TO CR-LNAME.
  4466
  4467     IF DTE-CLIENT EQUAL 'HAN'
  4468        IF CR-GROUPING EQUAL '010184'
  4469           MOVE CR-LNAME            TO WS-HI-LAST-NAME
  4470           MOVE CR-CERT-PRIME       TO WS-HI-CERT-4-10
  4471           MOVE WS-HI-LAST-NAME     TO CR-LNAME.
  4472
  4473     IF CR-LF-TERM NOT EQUAL ZERO
  4474         MOVE CR-LF-TERM         TO WS-WORK-TERM.
  4475
  4476     IF (CR-AH-TERM NOT EQUAL ZERO) AND
  4477        ((CR-AH-TERM GREATER CR-LF-TERM) OR
  4478         (WS-WORK-TERM EQUAL ZERO))
  4479           MOVE CR-AH-TERM       TO WS-WORK-TERM.
  4480
  4481     IF CR-DTH-DT NOT EQUAL ZERO OR
  4482        CR-DIS-DT NOT EQUAL ZERO
  4483            COMPUTE WS-EXPIRE-MOS EQUAL
  4484                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 36
  4485       ELSE
  4486            COMPUTE WS-EXPIRE-MOS EQUAL
  4487                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 12.
  4488
  4489     IF WS-WORK-TERM EQUAL +1
  4490            COMPUTE WS-EXPIRE-MOS EQUAL
  4491                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 36.
  4492
  4493     IF DTE-CLIENT = 'LAP'  OR  'RMC'
  4494            COMPUTE WS-EXPIRE-MOS EQUAL
  4495                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 36.
  4496
  4497     IF DTE-CLIENT = 'CID'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  91
* EL331.cbl
  4498        IF (CR-ENTRY-BATCH (1:2) = 'BL' OR 'VA')
  4499           OR (CR-LF-EXIT-BATCH (1:2) = 'BL' OR 'VA')
  4500           OR (CR-AH-EXIT-BATCH (1:2) = 'BL' OR 'VA')
  4501           COMPUTE WS-EXPIRE-MOS =
  4502              (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 300
  4503        END-IF
  4504     END-IF
  4505
  4506     IF DTE-CLIENT = 'AHL'
  4507        COMPUTE WS-EXPIRE-MOS =
  4508           (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 300
  4509     END-IF
  4510
  4511     IF WS-EXPIRE-MOS LESS WS-CURRENT-MOS
  4512       IF DTE-CLIENT NOT = 'LGX'
  4513           IF CR-ENTRY-CCYY = RUN-CCYY AND
  4514              CR-ENTRY-MO = RUN-MO
  4515               NEXT SENTENCE
  4516           ELSE
  4517               ADD 1 TO WS-INACTIVE-CERTS
  4518               GO TO 2100-READ-ECS-RECORDS.
  4519
  4520     PERFORM 2120-SAVE-ECS-KEY  THRU 2120-EXIT.
  4521
  4522     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  4523     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  4524
  4525 2100-LF-TYPE.
  4526
  4527     IF CR-LFTYP EQUAL ZERO
  4528         GO TO 2100-AH-TYPE.
  4529
  4530     IF CLAS-INDEXL GREATER CLAS-MAXL
  4531         DISPLAY LIFE-OVERRIDE-L6
  4532                 ' BENEFIT TYPE NOT FOUND IN TABLE EQUAL ',
  4533                 CR-LFTYP
  4534         MOVE 'BENEFIT TYPE NOT FOUND (SEE DISPLAY)'
  4535                                 TO WS-ABEND-MESSAGE
  4536         GO TO ABEND-PGM.
  4537
  4538     IF CR-LFTYP EQUAL CLAS-I-BEN (CLAS-INDEXL)
  4539         GO TO 2100-AH-TYPE.
  4540
  4541     ADD +1                      TO CLAS-INDEXL.
  4542     GO TO 2100-LF-TYPE.
  4543
  4544 2100-AH-TYPE.
  4545
  4546     IF CR-AHTYP EQUAL ZERO
  4547        GO TO 2100-EXIT.
  4548
  4549     IF CLAS-INDEXA GREATER CLAS-MAXA
  4550         DISPLAY AH-OVERRIDE-L6
  4551                 ' BENEFIT TYPE NOT FOUND IN TABLE EQUAL ',
  4552                 CR-AHTYP
  4553         MOVE 'BENEFIT TYPE NOT FOUND (SEE DISPLAY)'
  4554                                 TO WS-ABEND-MESSAGE
  4555         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  92
* EL331.cbl
  4556
  4557     IF CR-AHTYP EQUAL CLAS-I-BEN (CLAS-INDEXA)
  4558            GO TO 2100-EXIT.
  4559
  4560     ADD +1                      TO CLAS-INDEXA.
  4561     GO TO 2100-AH-TYPE.
  4562
  4563 2100-EXIT.
  4564      EXIT.
  4565
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  93
* EL331.cbl
  4567****************************************************
  4568*  2120-SAVE-ECS-KEY                               *
  4569****************************************************
  4570*  SAVE BATCH CERT MASTER KEY IN WS-SAVED-ECS-KEY  *
  4571****************************************************
  4572
  4573 2120-SAVE-ECS-KEY.
  4574
  4575     MOVE DTE-CLASIC-COMPANY-CD  TO WS-SAVED-B-COMP.
  4576     MOVE CR-CARRIER             TO WS-SAVED-B-CARR.
  4577     MOVE CR-GROUPING            TO WS-SAVED-B-GRPG.
  4578     MOVE CR-STATE               TO WS-SAVED-B-STAT.
  4579     MOVE CR-ACCOUNT             TO WS-SAVED-B-ACCT.
  4580     MOVE CR-CERT-NO             TO WS-SAVED-B-CERT.
  4581     MOVE CR-DT                  TO WS-SAVED-B-DATE
  4582                                    DC-GREG-DATE-CYMD.
  4583
  4584     MOVE 'L'                    TO DC-OPTION-CODE.
  4585     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  4586     MOVE DC-BIN-DATE-1          TO BIN-CR-DT.
  4587
  4588 2120-EXIT.
  4589      EXIT.
  4590
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  94
* EL331.cbl
  4592****************************************************
  4593*  2200-MATCH-ACCT                                 *
  4594****************************************************
  4595*  IF ONLINE BILLING OPTION IS USED RETRIEVE THE   *
  4596*  ACCOUNT MASTER FILE RECORD ASSOCIATED WITH THE  *
  4597*  CERTIFICATE BEING PROCESSED. IF A MATCH OCCURS, *
  4598*  THE COMPENSATION STRUCTURES BETWEEN THE TWO     *
  4599*  RECORDS ARE COMPARED, IF ANY DIFFERENCES ARE    *
  4600*  DETECTED A COMPENSATION EXCEPTION RECORD IS     *
  4601*  CREATED. THIS RECORD WILL CONTAIN THE ORIGINAL  *
  4602*  COMPENSATION STRUCTURE THE CERTIFICATE WAS      *
  4603*  ISSUED UNDER.                                   *
  4604****************************************************
  4605
  4606 2200-MATCH-ACCT.
  4607     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  4608        DTE-SYS-G-AR-USED     EQUAL '1'
  4609         NEXT SENTENCE
  4610     ELSE
  4611         GO TO 2200-EXIT.
  4612
  4613     IF NO-MORE-ACT-RECORDS
  4614         GO TO 2200-EXIT.
  4615
  4616     IF CR-ACCT-CONTROL GREATER AM-CONTROL-A
  4617        PERFORM 2260-READ-ACCT THRU 2260-EXIT
  4618        GO TO 2200-MATCH-ACCT.
  4619
  4620     IF CR-ACCT-CONTROL LESS AM-CONTROL-A
  4621        GO TO 2200-EXIT.
  4622
  4623     IF BIN-CR-DT LESS AM-EFFECTIVE-DT  OR
  4624        BIN-CR-DT NOT LESS AM-EXPIRATION-DT
  4625           PERFORM 2260-READ-ACCT THRU 2260-EXIT
  4626           GO TO 2200-MATCH-ACCT.
  4627
  4628****************************************************
  4629*  MATCHED  *  CHECK COMPENSATION STRUCTURE        *
  4630****************************************************
  4631
  4632     IF NOT CR-POLICY-IS-DECLINED  AND
  4633        NOT CR-POLICY-IS-VOID      AND
  4634        NOT CR-POLICY-IS-REIN-ONLY
  4635         ADD 1 TO WS-ACCT-MATCH
  4636         PERFORM 2210-MATCH-LEVELS THRU 2250-EXIT.
  4637
  4638 2200-EXIT.
  4639      EXIT.
  4640
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  95
* EL331.cbl
  4642****************************************************
  4643*  2210-MATCH-LEVELS.                              *
  4644****************************************************
  4645*  THE COMPENSATION STRUCTURES BETWEEN THE TWO     *
  4646*  RECORDS ARE COMPARED, IF ANY DIFFERENCES ARE    *
  4647*  DETECTED A COMPENSATION EXCEPTION RECORD        *
  4648*  IS CREATED. THIS RECORD WILL CONTAIN THE ORIG-  *
  4649*  INAL COMPENSATION STRUCTURE THE CERTIFICATE WAS *
  4650*  ISSUED UNDER.                                   *
  4651*                                                  *
  4652*  AM-COM-TYP =   O (OVERWRITE COMMISSION ON GROSS *
  4653*                  BUSINESS ONLY)                  *
  4654*                                                  *
  4655*  AM-COM-TYP =   P (OVERWRITE COMMISSION ON GROSS *
  4656*                  AND REINSURANCE BUSINESS)       *
  4657****************************************************
  4658
  4659 2210-MATCH-LEVELS.
  4660
  4661     MOVE 1                      TO NDX.
  4662     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  4663     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  4664     PERFORM 2100-LF-TYPE  THRU  2100-EXIT.
  4665
  4666 2220-GET-NEXT-LEVEL.
  4667
  4668     IF CR-AGT-TYPE (NDX)  =  AM-COM-TYP (NDX)
  4669         IF (AM-COM-TYP (NDX) NOT EQUAL 'O' AND 'P'
  4670              AND 'G' AND 'B')
  4671             GO TO 2230-GET-NEXT.
  4672
  4673     IF (AM-J-COM (NDX) NOT NUMERIC)   OR
  4674        (AM-L-COM (NDX) NOT NUMERIC)   OR
  4675        (AM-A-COM (NDX) NOT NUMERIC)
  4676          NEXT SENTENCE
  4677     ELSE
  4678          MOVE AM-L-COM (NDX)    TO  WS-L-COM
  4679          MOVE AM-J-COM (NDX)    TO  WS-J-COM
  4680          MOVE AM-A-COM (NDX)    TO  WS-A-COM
  4681          GO TO 2225-CHECK-NUMERIC.
  4682
  4683     IF CR-LFTYP = ZERO
  4684         GO TO 2224-CHECK-AH-TABLE.
  4685
  4686     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
  4687         GO TO 2221-JOINT-LIFE-COMM.
  4688
  4689     IF AM-L-COM (NDX) NUMERIC
  4690         MOVE AM-L-COM (NDX)    TO  WS-L-COM
  4691         GO TO 2224-CHECK-AH-TABLE.
  4692
  4693     MOVE AM-L-COMA (NDX)        TO  WS-CTBL-TABLE.
  4694     MOVE LIFE-OVERRIDE-L1       TO  WS-CTBL-BEN-TYPE.
  4695     MOVE CR-LFTYP               TO  WS-CTBL-BEN-CODE.
  4696     MOVE CR-LFAMT               TO  WS-COMM-CK-AMT.
  4697     MOVE CR-LF-TERM             TO  WS-CK-TERM.
  4698     MOVE CR-AGE                 TO  WS-CK-AGE.
  4699     PERFORM  2249-CTBL-PROCESS  THRU  2249-READ-CTBL-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  96
* EL331.cbl
  4700     MOVE CT-RT (CINDX)          TO  WS-L-COM.
  4701     GO TO 2224-CHECK-AH-TABLE.
  4702
  4703 2221-JOINT-LIFE-COMM.
  4704
  4705     IF AM-J-COM (NDX) NUMERIC
  4706         MOVE AM-J-COM (NDX)    TO  WS-J-COM
  4707         GO TO 2224-CHECK-AH-TABLE.
  4708
  4709     MOVE AM-J-COMA (NDX)        TO  WS-CTBL-TABLE.
  4710     MOVE LIFE-OVERRIDE-L1       TO  WS-CTBL-BEN-TYPE.
  4711     MOVE CR-LFTYP               TO  WS-CTBL-BEN-CODE.
  4712     MOVE CR-LFAMT               TO  WS-COMM-CK-AMT.
  4713     MOVE CR-LF-TERM             TO  WS-CK-TERM.
  4714     MOVE CR-AGE                 TO  WS-CK-AGE.
  4715     PERFORM  2249-CTBL-PROCESS  THRU  2249-READ-CTBL-EXIT.
  4716     MOVE CT-RT (CINDX)          TO  WS-J-COM.
  4717
  4718 2224-CHECK-AH-TABLE.
  4719
  4720     IF CR-AHTYP = ZERO
  4721         GO TO 2225-CHECK-NUMERIC.
  4722
  4723     IF AM-A-COM (NDX) NUMERIC
  4724         MOVE AM-A-COM (NDX)     TO  WS-A-COM
  4725         GO TO 2225-CHECK-NUMERIC.
  4726
  4727     MOVE AM-A-COMA (NDX)        TO  WS-CTBL-TABLE.
  4728     MOVE AH-OVERRIDE-L1         TO  WS-CTBL-BEN-TYPE.
  4729     MOVE CR-AHTYP               TO  WS-CTBL-BEN-CODE.
  4730     MOVE CR-AHAMT               TO  WS-COMM-CK-AMT.
  4731     MOVE CR-AH-TERM             TO  WS-CK-TERM.
  4732     MOVE CR-AGE                 TO  WS-CK-AGE.
  4733     PERFORM  2249-CTBL-PROCESS  THRU  2249-READ-CTBL-EXIT.
  4734     MOVE CT-RT (CINDX)          TO  WS-A-COM.
  4735
  4736 2225-CHECK-NUMERIC.
  4737
  4738     IF DTE-CLIENT EQUAL 'WDS'
  4739        IF CR-COM-AGT (NDX) EQUAL '0000000001'
  4740           GO TO 2230-GET-NEXT.
  4741
  4742     IF (CR-COM-AGT  (NDX) NOT EQUAL AM-AGT (NDX)) OR
  4743        (CR-AGT-TYPE (NDX) NOT EQUAL AM-COM-TYP (NDX))
  4744           GO TO 2235-NO-MATCH.
  4745
  4746     IF CR-LFTYP EQUAL ZERO
  4747         NEXT SENTENCE
  4748     ELSE
  4749         IF ((CLAS-I-JOINT (CLAS-INDEXL) EQUAL 'J') AND
  4750             (CR-LCOM-L  (NDX) NOT EQUAL WS-J-COM ))
  4751         OR
  4752            ((CLAS-I-JOINT (CLAS-INDEXL) NOT EQUAL 'J') AND
  4753             (CR-LCOM-L  (NDX) NOT EQUAL WS-L-COM ))
  4754                 GO TO 2235-NO-MATCH.
  4755
  4756     IF CR-AHTYP EQUAL ZERO
  4757         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  97
* EL331.cbl
  4758     ELSE
  4759         IF CR-LCOM-AH (NDX) NOT EQUAL WS-A-COM
  4760               GO TO 2235-NO-MATCH.
  4761
  4762 2230-GET-NEXT.
  4763
  4764     ADD 1                       TO NDX.
  4765
  4766     IF NDX GREATER 10
  4767        GO TO 2250-EXIT.
  4768
  4769     GO TO 2220-GET-NEXT-LEVEL.
  4770
  4771 2235-NO-MATCH.
  4772
  4773     MOVE SPACES                 TO COMMISSION-EXCEPTIONS.
  4774     MOVE 'CE'                   TO CE-RECORD-ID.
  4775     MOVE DTE-CLASIC-COMPANY-CD  TO CE-COMPANY-CD.
  4776     MOVE CR-CARRIER             TO CE-CARRIER.
  4777     MOVE CR-GROUPING            TO CE-GROUPING.
  4778     MOVE CR-STATE               TO CE-STATE.
  4779     MOVE CR-ACCOUNT             TO CE-ACCOUNT.
  4780
  4781     MOVE BIN-CR-DT              TO CE-CERT-EFF-DT.
  4782
  4783     MOVE CR-CERT-NO             TO CE-CERT-NO.
  4784     MOVE CR-COMPENSATION-LEVELS TO CE-COMP-STRUCTURE.
  4785
  4786     MOVE CR-LF-EXPIRE-DATE      TO DC-GREG-DATE-CYMD.
  4787
  4788     IF CR-LF-EXPIRE-DATE EQUAL ZERO
  4789          MOVE CR-AH-EXPIRE-DATE TO DC-GREG-DATE-CYMD.
  4790
  4791     MOVE 'L'                    TO DC-OPTION-CODE.
  4792     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  4793     MOVE DC-BIN-DATE-1          TO CE-CERT-EXPIRATION-DT.
  4794
  4795     WRITE COMMISSION-EXCEPTIONS.
  4796
  4797     IF CE-STATUS EQUAL '22'
  4798         GO TO 2245-SKIP-DUP.
  4799
  4800     IF CE-STAT-1  NOT EQUAL ZERO
  4801         MOVE CE-STATUS          TO  WS-ABEND-FILE-STATUS
  4802         MOVE 'ERROR OCCURED WRITE - ERCOMM'
  4803                                 TO  WS-ABEND-MESSAGE
  4804         GO TO ABEND-PGM.
  4805
  4806 2245-SKIP-DUP.
  4807
  4808     MOVE '1'                    TO CM-COMP-EXCP-SW.
  4809     ADD 1                       TO WS-EXCP-ADD.
  4810     GO TO 2250-EXIT.
  4811
  4812 2249-CTBL-PROCESS.
  4813
  4814     IF WS-CTBL-KEY = WS-LAST-CTBL-KEY
  4815         GO TO 2249-SEARCH-TABLE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  98
* EL331.cbl
  4816
  4817     MOVE DTE-CLASIC-COMPANY-CD  TO  WS-CTBL-COMP-CD.
  4818
  4819 2249-READ-CTBL.
  4820
  4821     MOVE WS-CTBL-KEY            TO  CT-CONTROL-PRIMARY
  4822                                     WS-LAST-CTBL-KEY.
  4823
  4824     READ ERCTBL.
  4825
  4826     IF ERCTBL-FILE-STATUS     = '97'
  4827        MOVE '00' TO ERCTBL-FILE-STATUS.
  4828
  4829     IF ERCTBL-FILE-STATUS NOT = '00'
  4830        ADD  +1  TO  ERROR-COUNT
  4831***1**
  4832        MOVE 'ERCTBL-FILE-STATUS IS = ' TO DIS-LINE-REASON
  4833        MOVE ERCTBL-FILE-STATUS         TO DIS-LINE-REC
  4834        PERFORM 8600-DISPLAY-PRT THRU
  4835              8600-DISPLAY-EXIT
  4836***2**
  4837        MOVE 'WS-CTBL-KEY        IS = ' TO DIS-LINE-REASON
  4838        MOVE  WS-CTBL-KEY               TO DIS-LINE-REC
  4839        PERFORM 8600-DISPLAY-PRT THRU
  4840              8600-DISPLAY-EXIT
  4841***3**
  4842        MOVE 'CM-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4843        MOVE  CM-CONTROL-PRIMARY        TO DIS-LINE-REC
  4844        PERFORM 8600-DISPLAY-PRT THRU
  4845              8600-DISPLAY-EXIT
  4846***4**
  4847        MOVE 'CE-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4848        MOVE  CE-CONTROL-PRIMARY        TO DIS-LINE-REC
  4849        PERFORM 8600-DISPLAY-PRT THRU
  4850              8600-DISPLAY-EXIT
  4851***5**
  4852        MOVE 'AM-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4853        MOVE  AM-CONTROL-PRIMARY        TO DIS-LINE-REC
  4854        PERFORM 8600-DISPLAY-PRT THRU
  4855              8600-DISPLAY-EXIT
  4856***6**
  4857        MOVE 'CL-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4858        MOVE  CL-CONTROL-PRIMARY        TO DIS-LINE-REC
  4859        PERFORM 8600-DISPLAY-PRT THRU
  4860              8600-DISPLAY-EXIT
  4861***7**
  4862        MOVE  SPACES                    TO DIS-LINE-REASON
  4863        MOVE  SPACES                    TO DIS-LINE-REC
  4864        PERFORM 8600-DISPLAY-PRT THRU
  4865              8600-DISPLAY-EXIT
  4866
  4867         MOVE 'ERROR OCCURRED READ - ERCTBL'
  4868                                 TO  WS-ABEND-MESSAGE
  4869         MOVE ERCTBL-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  4870         DISPLAY 'WS-CTBL-KEY = ' WS-CTBL-KEY
  4871         GO TO 2100-READ-ECS-RECORDS.
  4872*        GO TO ABEND-PGM.
  4873
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  99
* EL331.cbl
  4874 2249-SEARCH-TABLE.
  4875
  4876      MOVE +1                    TO  CINDX.
  4877
  4878      IF  WS-COMM-CK-AMT GREATER THAN CT-TBF (1)
  4879          ADD +9 TO CINDX
  4880          IF WS-COMM-CK-AMT GREATER THAN CT-TBF (2)
  4881              ADD +9 TO CINDX.
  4882
  4883      IF WS-CK-AGE GREATER THAN CT-AGE (1)
  4884          ADD +3 TO CINDX
  4885          IF WS-CK-AGE GREATER THAN CT-AGE (2)
  4886              ADD +3 TO CINDX.
  4887
  4888      IF WS-CK-TERM GREATER THAN CT-TRM (1)
  4889          ADD +1 TO CINDX
  4890          IF WS-CK-TERM GREATER THAN CT-TRM (2)
  4891              ADD +1 TO CINDX.
  4892
  4893      IF CT-RT (CINDX) NOT NUMERIC
  4894          MOVE WS-LAST-CTBL-KEY  TO  CT-CONTROL-PRIMARY
  4895          MOVE CT-RT-R (CINDX)   TO  WS-CTBL-TABLE
  4896          GO TO 2249-READ-CTBL.
  4897
  4898 2249-READ-CTBL-EXIT.
  4899      EXIT.
  4900
  4901 2250-EXIT.
  4902      EXIT.
  4903
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 100
* EL331.cbl
  4905****************************************************
  4906*  2260-READ-ACCT                                  *
  4907****************************************************
  4908*  READ ACCOUNT MASTER FILE RECORD MATCHING THE    *
  4909*  ECS CERTIFICATE RECORD BEING PROCESSED.         *
  4910****************************************************
  4911
  4912 2260-READ-ACCT.
  4913
  4914     IF NO-MORE-ACT-RECORDS
  4915         GO TO 2260-EXIT.
  4916
  4917     READ ERACCT NEXT RECORD.
  4918
  4919     ADD 1 TO WS-ACT-READ.
  4920
  4921***  DISPLAY '*** ERACCT READ: ' AM-CARRIER '-' AM-GROUPING '-'
  4922***      AM-STATE '-' AM-ACCOUNT ' EXP: ' AM-EXPIRE-DT ' EFF: '
  4923***      AM-EFFECTIVE-DT '-' AM-EFFECT-DT '  CERT: ' CR-CARRIER
  4924***      '-' CR-GROUPING '-' CR-STATE '-' CR-ACCOUNT ' EFF: '
  4925***      CR-DT.
  4926
  4927     IF AM-STAT-1 EQUAL '1'
  4928         MOVE 'X'   TO WS-ACT-END-SW
  4929         GO TO 2260-EXIT.
  4930
  4931     IF AM-STAT-1 NOT EQUAL ZERO
  4932         MOVE 'ERROR OCCURED READ  - ERACCT'
  4933                                TO  WS-ABEND-MESSAGE
  4934         MOVE AM-STATUSF        TO  WS-ABEND-FILE-STATUS
  4935         GO TO ABEND-PGM.
  4936
  4937     IF AM-COMPANY-CD NOT EQUAL DTE-CLASIC-COMPANY-CD
  4938         MOVE 'X'               TO WS-ACT-END-SW
  4939         GO TO 2260-EXIT.
  4940
  4941 2260-EXIT.
  4942      EXIT.
  4943
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 101
* EL331.cbl
  4945****************************************************
  4946*  2270-DELETE-ERCOMM                              *
  4947****************************************************
  4948*  DELETE COMPENSATION EXCEPTION RECORDS FOR CERT- *
  4949*  IFICATE MASTER RECORDS THAT HAVE EXPIRED.       *
  4950****************************************************
  4951
  4952 2270-DELETE-ERCOMM.
  4953
  4954     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  4955        DTE-SYS-G-AR-USED     EQUAL '1'
  4956          NEXT SENTENCE
  4957     ELSE
  4958        GO TO 2270-EXIT.
  4959
  4960     IF THIS-CERT-HAS-ERCOMM-ENTRY
  4961         MOVE CM-CONTROL-PRIMARY TO CE-CONTROL-PRIMARY
  4962     ELSE
  4963         GO TO 2270-EXIT.
  4964
  4965     READ ERCOMM.
  4966
  4967     IF CE-STATUS  EQUAL '23'
  4968         GO TO 2270-EXIT.
  4969
  4970     IF CE-STAT-1  NOT EQUAL ZERO
  4971        MOVE CE-STATUS           TO  WS-ABEND-FILE-STATUS
  4972        MOVE 'ERROR OCCURED READ - ERCOMM'
  4973                                 TO  WS-ABEND-MESSAGE
  4974        GO TO ABEND-PGM.
  4975
  4976     DELETE ERCOMM.
  4977
  4978     IF CE-STAT-1  NOT EQUAL ZERO
  4979        MOVE CE-STATUS           TO  WS-ABEND-FILE-STATUS
  4980        MOVE 'ERROR OCCURED DELETE - ERCOMM'
  4981                                 TO  WS-ABEND-MESSAGE
  4982        GO TO ABEND-PGM.
  4983
  4984     ADD 1                       TO WS-EXCP-DEL.
  4985
  4986 2270-EXIT.
  4987     EXIT.
  4988
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 102
* EL331.cbl
  4990*****************************************************
  4991*  2280-DELETE-ERMAIL                               *
  4992*****************************************************
  4993*  DELETE NAME AND ADDRESS RECORDS FOR CERTIFICATE  *
  4994*  MASTER RECORDS THAT HAVE EXPIRED.                *
  4995*****************************************************
  4996
  4997 2280-DELETE-ERMAIL.
  4998
  4999     IF INSURED-ADDR-PRESENT
  5000         MOVE CM-CONTROL-PRIMARY TO MA-CONTROL-PRIMARY
  5001     ELSE
  5002         GO TO 2280-EXIT.
  5003
  5004     READ ERMAIL.
  5005
  5006     IF ERMAIL-FILE-STATUS EQUAL '23'
  5007         GO TO 2280-EXIT.
  5008
  5009     IF CFS-STAT-1 NOT EQUAL ZERO
  5010        MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  5011        MOVE 'ERROR OCCURED READ - ERMAIL'
  5012                                 TO  WS-ABEND-MESSAGE
  5013        GO TO ABEND-PGM.
  5014
  5015     DELETE ERMAIL.
  5016
  5017     IF CFS-STAT-1 NOT EQUAL ZERO
  5018        MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  5019        MOVE 'ERROR OCCURED DELETE - ERMAIL'
  5020                                 TO  WS-ABEND-MESSAGE
  5021        GO TO ABEND-PGM.
  5022
  5023     ADD 1                       TO WS-MAIL-DEL.
  5024
  5025 2280-EXIT.
  5026     EXIT.
  5027
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 103
* EL331.cbl
  5029*****************************************************
  5030*  2300-PROCESS-N-READ-ONL.                         *
  5031*****************************************************
  5032*  THIS ROUTINE IS EXECUTED WHEN THE BATCH CERT     *
  5033*  MASTER CONTROL IS GREATER THAN THE ONLINE CERT   *
  5034*  MASTER CONTROL. THE ONLINE CERT MASTER WILL BE   *
  5035*  DELETED UNLESS IT IS AN OPEN-END CERT OR CLAIM   *
  5036*  PAYMENT ACTIVITY IS ASSOCIATED WITH THE CERT.    *
  5037*  DELETE ANY ASSOCIATED COMPENSATION EXCEPTION     *
  5038*  RECORDS(ERCOMM) AND NAME AND ADDRESS RECORDS     *
  5039*  (ERMAIL) ASSOCIATED WITH THE EXPIRED CERT MASTER *
  5040*  RECORD.                                          *
  5041*****************************************************
  5042
  5043 2300-PROCESS-N-READ-ONL.
  5044
  5045     MOVE ZEROS                  TO CM-STATUS.
  5046
  5047     IF DTE-CLIENT = 'MON'
  5048         GO TO 2300-PROCESS-N-READ-MON.
  5049
  5050*****COPY ELCCRTM2.
  5051
  5052     IF (NO-MATCH-FOUND)
  5053        IF (CERT-PEND-ISSUE-ERROR)
  5054            IF CM-NOTE-SW NOT EQUAL ' '
  5055                 MOVE WS-EXC-MSG-NO-NOTES   TO DTL-EXC-MSG
  5056                 MOVE WS-CURRENT-DATE       TO DC-GREG-DATE-1-EDIT
  5057                 MOVE '2'                   TO DC-OPTION-CODE
  5058                 PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5059                 MOVE DC-BIN-DATE-1         TO CM-LAST-MONTH-END
  5060                 PERFORM 4000-EXPIRE-DATE   THRU  4099-EXIT
  5061
  5062                 REWRITE CERTIFICATE-MASTER
  5063
  5064                 PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5065                 PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5066                 IF CM-STAT-1 NOT EQUAL ZERO
  5067                    MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5068                                    TO  WS-ABEND-MESSAGE
  5069                    MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5070                    GO TO ABEND-PGM
  5071                 ELSE
  5072                    GO TO 2301-READ-ONL-CERT.
  5073
  5074     IF (NO-MATCH-FOUND) AND
  5075        (NOT CM-OPEN-END)
  5076         PERFORM 2330-FIND-ASSOCIATED-CLAIM  THRU 2330-EXIT
  5077         IF (NO-ASSOCIATED-CLAIM) AND
  5078            (CM-CLAIM-ATTACHED-COUNT = 0)
  5079              MOVE SPACES                TO WS-EXC-MSG-CE-COPY
  5080              MOVE WS-EXC-MSG-CE-DELETE  TO DTL-EXC-MSG
  5081              PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5082              PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5083              PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5084              ADD +1                     TO WS-ONL-DELETED
  5085*             PERFORM 2280-DELETE-ERMAIL THRU 2280-EXIT
  5086              PERFORM 2270-DELETE-ERCOMM THRU 2270-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 104
* EL331.cbl
  5087
  5088              DELETE ELCERTF
  5089
  5090              IF CM-STAT-1 NOT EQUAL ZERO
  5091                 MOVE 'ERROR OCCURED DELETE  - ELCERT'
  5092                                 TO  WS-ABEND-MESSAGE
  5093                 MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5094                 GO TO ABEND-PGM
  5095              ELSE
  5096                 NEXT SENTENCE
  5097         ELSE
  5098             MOVE '- COPY RETAINED'     TO WS-EXC-MSG-EE-COPY
  5099             MOVE WS-EXC-MSG-EE-EXPIRED TO DTL-EXC-MSG
  5100             IF (CM-CREDIT-INTERFACE-SW-1 EQUAL '3') AND
  5101                (CM-CLAIM-INTERFACE-SW    EQUAL '2') AND
  5102                (CM-CLAIM-ATTACHED-COUNT  EQUAL WS-CLM-CNT)
  5103                  NEXT SENTENCE
  5104               ELSE
  5105                  MOVE WS-CLM-CNT TO CM-CLAIM-ATTACHED-COUNT
  5106                  MOVE WS-CURRENT-DATE   TO DC-GREG-DATE-1-EDIT
  5107                  MOVE '2'               TO DC-OPTION-CODE
  5108                  PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5109                  MOVE DC-BIN-DATE-1     TO CM-LAST-MONTH-END
  5110                  PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT
  5111                  REWRITE CERTIFICATE-MASTER
  5112                  PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5113                  PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5114                  PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5115                  IF CM-STAT-1 NOT EQUAL ZERO
  5116                     MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5117                                     TO  WS-ABEND-MESSAGE
  5118                     MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5119                     GO TO ABEND-PGM.
  5120
  5121     GO TO 2301-READ-ONL-CERT.
  5122
  5123 2300-PROCESS-N-READ-MON.
  5124
  5125*****COPY ELCCRTM2.
  5126
  5127     IF (NO-MATCH-FOUND)
  5128        IF (CERT-PEND-ISSUE-ERROR)
  5129            IF CM-NOTE-SW NOT EQUAL ' '
  5130                 MOVE WS-EXC-MSG-NO-NOTES   TO DTL-EXC-MSG
  5131                 MOVE WS-CURRENT-DATE       TO DC-GREG-DATE-1-EDIT
  5132                 MOVE '2'                   TO DC-OPTION-CODE
  5133                 PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5134                 MOVE DC-BIN-DATE-1         TO CM-LAST-MONTH-END
  5135                 PERFORM 4000-EXPIRE-DATE   THRU  4099-EXIT
  5136
  5137                 REWRITE CERTIFICATE-MASTER
  5138
  5139                 PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5140                 PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5141                 IF CM-STAT-1 NOT EQUAL ZERO
  5142                    MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5143                                    TO  WS-ABEND-MESSAGE
  5144                    MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 105
* EL331.cbl
  5145                    GO TO ABEND-PGM
  5146                 ELSE
  5147                    GO TO 2301-READ-ONL-CERT.
  5148
  5149     IF (NO-MATCH-FOUND) AND
  5150        (NOT CM-OPEN-END)
  5151         PERFORM 2330-FIND-ASSOCIATED-CLAIM  THRU 2330-EXIT
  5152         IF (NO-ASSOCIATED-CLAIM) AND
  5153            ((CM-CLAIM-ATTACHED-COUNT = 0) OR
  5154            (CM-GROUPING NOT NUMERIC))
  5155              MOVE SPACES                TO WS-EXC-MSG-CE-COPY
  5156              MOVE WS-EXC-MSG-CE-DELETE  TO DTL-EXC-MSG
  5157              PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5158              PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5159              PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5160              ADD +1                     TO WS-ONL-DELETED
  5161*             PERFORM 2280-DELETE-ERMAIL THRU 2280-EXIT
  5162              PERFORM 2270-DELETE-ERCOMM THRU 2270-EXIT
  5163
  5164              DELETE ELCERTF
  5165
  5166              IF CM-STAT-1 NOT EQUAL ZERO
  5167                 MOVE 'ERROR OCCURED DELETE  - ELCERT'
  5168                                 TO  WS-ABEND-MESSAGE
  5169                 MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5170                 GO TO ABEND-PGM
  5171              ELSE
  5172                 NEXT SENTENCE
  5173         ELSE
  5174             MOVE '- COPY RETAINED'     TO WS-EXC-MSG-EE-COPY
  5175             MOVE WS-EXC-MSG-EE-EXPIRED TO DTL-EXC-MSG
  5176             IF (CM-CREDIT-INTERFACE-SW-1 EQUAL '3') AND
  5177                (CM-CLAIM-INTERFACE-SW    EQUAL '2') AND
  5178                (CM-CLAIM-ATTACHED-COUNT  EQUAL WS-CLM-CNT)
  5179                  NEXT SENTENCE
  5180               ELSE
  5181                  MOVE WS-CLM-CNT TO CM-CLAIM-ATTACHED-COUNT
  5182                  MOVE WS-CURRENT-DATE   TO DC-GREG-DATE-1-EDIT
  5183                  MOVE '2'               TO DC-OPTION-CODE
  5184                  PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5185                  MOVE DC-BIN-DATE-1     TO CM-LAST-MONTH-END
  5186                  PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT
  5187                  REWRITE CERTIFICATE-MASTER
  5188                  PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5189                  PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5190                  PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5191                  IF CM-STAT-1 NOT EQUAL ZERO
  5192                     MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5193                                     TO  WS-ABEND-MESSAGE
  5194                     MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5195                     GO TO ABEND-PGM.
  5196
  5197 2301-READ-ONL-CERT.
  5198
  5199     READ ELCERTF  NEXT RECORD.
  5200
  5201     IF CM-STAT-1 EQUAL '1'
  5202         MOVE 'X'                TO WS-ONL-END-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 106
* EL331.cbl
  5203                                    WS-ONL-GE-SW
  5204         MOVE HIGH-VALUES        TO WS-SAVED-ONL-KEY
  5205         MOVE SPACE              TO WS-O-MATCH-SW
  5206         GO TO 2300-EXIT.
  5207
  5208     IF CM-STAT-1 NOT EQUAL ZERO
  5209         MOVE 'ERROR OCCURED READ NEXT - ELCERT'
  5210                                 TO  WS-ABEND-MESSAGE
  5211         MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  5212         GO TO ABEND-PGM.
  5213
  5214     IF CM-COMPANY-CD NOT EQUAL DTE-CLASIC-COMPANY-CD
  5215         MOVE 'X'                TO WS-ONL-END-SW
  5216                                    WS-ONL-GE-SW
  5217         MOVE HIGH-VALUES        TO WS-SAVED-ONL-KEY
  5218         MOVE SPACE              TO WS-O-MATCH-SW
  5219         GO TO 2300-EXIT.
  5220
  5221     IF CM-OPEN-END
  5222         GO TO 2301-READ-ONL-CERT.
  5223
  5224     MOVE SPACE                  TO WS-O-MATCH-SW.
  5225
  5226 2302-PROC-ONL-CERT.
  5227     ADD 1                        TO WS-ONL-READ.
  5228
  5229
  5230     IF CM-ADDL-CLP NOT NUMERIC
  5231        MOVE ZEROS                TO CM-ADDL-CLP
  5232     END-IF
  5233     IF CM-LF-CLP NOT NUMERIC
  5234        MOVE ZEROS               TO CM-LF-CLP
  5235     END-IF
  5236     IF CM-AH-CLP NOT NUMERIC
  5237        MOVE ZEROS               TO CM-AH-CLP
  5238     END-IF
  5239     IF CM-DDF-IU-RATE-UP NOT NUMERIC
  5240        MOVE ZEROS               TO CM-DDF-IU-RATE-UP
  5241     END-IF
  5242
  5243     IF CM-NH-INT-ON-REFS NOT NUMERIC
  5244         MOVE ZEROS               TO CM-NH-INT-ON-REFS.
  5245
  5246*****COPY ELCCRTM2.
  5247
  5248     MOVE CERTIFICATE-MASTER      TO WS-ONL-RECORD.
  5249
  5250     MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLM-CNT.
  5251     MOVE CM-CLAIM-INTERFACE-SW   TO WS-CM-ORIG.
  5252     MOVE CM-LOAN-NUMBER          TO WS-LN-NUMBER.
  5253     MOVE CM-LOAN-BALANCE         TO WS-LN-BALANCE.
  5254     MOVE CM-BENEFICIARY          TO WS-CM-BENEFICIARY.
  5255     MOVE CM-LAST-ADD-ON-DT       TO WS-LST-ADD-ON-DT.
  5256     MOVE CM-ENTRY-BATCH          TO WS-CM-ENTRY-BATCH.
  5257     MOVE CM-LF-EXIT-BATCH        TO WS-CM-LF-EXIT-BATCH.
  5258     MOVE CM-AH-EXIT-BATCH        TO WS-CM-AH-EXIT-BATCH.
  5259     MOVE CM-COMP-EXCP-SW         TO WS-ERCOMM-SW.
  5260     MOVE CM-INSURED-ADDRESS-SW   TO WS-CM-INSURED-ADDRESS-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 107
* EL331.cbl
  5261*    MOVE CM-CLAIM-DEDUCT-WITHHELD
  5262*                                 TO WS-CLAIM-DEDUCT-WITHHELD.
  5263*    MOVE CM-CANCEL-DEDUCT-WITHHELD
  5264*                                 TO WS-CANCEL-DEDUCT-WITHHELD.
  5265     MOVE CM-LF-DEATH-EXIT-DT     TO WS-LF-DEATH-EXIT-DT.
  5266     MOVE CM-LF-CURRENT-STATUS    TO WS-LF-CURRENT-STATUS.
  5267     MOVE CM-LF-STATUS-AT-DEATH   TO WS-LF-STATUS-AT-DEATH.
  5268     PERFORM 2370-SAVE-ONL-KEY    THRU 2370-EXIT.
  5269
  5270     IF WS-SAVED-ONL-KEY NOT LESS WS-SAVED-ECS-KEY
  5271         MOVE 'X'                 TO WS-ONL-GE-SW.
  5272
  5273 2300-EXIT.
  5274      EXIT.
  5275
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 108
* EL331.cbl
  5277*****************************************************
  5278*  2330-FIND-ASSOCIATED-CLAIM                       *
  5279*****************************************************
  5280*  THIS ROUTINE WILL BROWSE THE CLAIM MASTER FILE   *
  5281*  THRU THE CERTIFICATE ALTERNATE INDEX AND ACCUM-  *
  5282*  ULATE A COUNT OF CLAIMS ASSOCIATED WITH THE CURR-*
  5283*  ENT CLAIM MASTER. THE LAST CLAIM MASTER FOUND IS *
  5284*  SAVED IN CLAIM-MASTER.                           *
  5285*****************************************************
  5286
  5287 2330-FIND-ASSOCIATED-CLAIM.
  5288
  5289     MOVE 'N'                   TO WS-CLAIM-SW.
  5290
  5291     IF DTE-SYS-E-CLASIC-CLAIMS EQUAL ZERO OR 'N'
  5292         GO TO 2330-EXIT.
  5293
  5294********************************************************
  5295*  BUILD CL-CONTROL-BY-CERT-NO AND WS-SEC-CLAIM-INDEX  *
  5296*  FROM THE CURRENT ONLINE CERT MASTER RECORD.         *
  5297********************************************************
  5298
  5299     MOVE CM-COMPANY-CD         TO CL-COMPANY-CD-A4
  5300                                   WS-S-CL-COMP.
  5301     MOVE CM-CERT-PRIME         TO CL-CERT-A4-PRIME
  5302                                   WS-S-CL-PRIM.
  5303     MOVE CM-CERT-SFX           TO CL-CERT-A4-SFX
  5304                                   WS-S-CL-SFX.
  5305     MOVE CM-GROUPING           TO WS-CL-GRPG.
  5306     MOVE CM-STATE              TO WS-CL-STAT.
  5307     MOVE CM-ACCOUNT            TO WS-CL-ACCT.
  5308     MOVE CM-CARRIER            TO WS-CL-CARR.
  5309     MOVE CM-CERT-EFF-DT        TO WS-CL-EFDT.
  5310
  5311     MOVE ZERO                  TO  WS-CLM-CNT.
  5312
  5313     START ELMSTR5
  5314                KEY EQUAL CL-CONTROL-BY-CERT-NO.
  5315***
  5316     IF CL-STATUS EQUAL '23'
  5317         GO TO 2350-CHECK-ELRETR.
  5318
  5319     IF CL-STAT-1 EQUAL ZERO
  5320         MOVE SPACE              TO WS-CLM-END-SW
  5321         PERFORM 2335-READNEXT-CLAIM  THRU 2335-EXIT
  5322             UNTIL NO-MORE-CLAIM-MATCH
  5323     ELSE
  5324         MOVE 'ERROR OCCURED START - ELMSTR'
  5325                                 TO  WS-ABEND-MESSAGE
  5326         MOVE CL-STATUS          TO  WS-ABEND-FILE-STATUS
  5327         GO TO ABEND-PGM.
  5328
  5329     IF ASSOCIATED-CLAIM
  5330         MOVE WS-LAST-CLAIM-MATCHED TO CLAIM-MASTER.
  5331
  5332 2330-EXIT.
  5333      EXIT.
  5334
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 109
* EL331.cbl
  5336*****************************************************
  5337*  2335-READNEXT-CLAIM                              *
  5338*****************************************************
  5339*  READ CLAIM MASTER FILE AND CHECK KEYS FOR MATCH  *
  5340*****************************************************
  5341
  5342 2335-READNEXT-CLAIM.
  5343
  5344     READ ELMSTR5  NEXT  RECORD.
  5345
  5346     IF CL-STAT-1  EQUAL '1'
  5347         MOVE 'X'                TO WS-CLM-END-SW
  5348         GO TO 2335-EXIT.
  5349
  5350     IF CL-STAT-1  NOT  EQUAL '0'
  5351         MOVE 'ERROR OCCURED READNEXT - ELMSTR'
  5352                                 TO  WS-ABEND-MESSAGE
  5353         MOVE CL-STATUS          TO  WS-ABEND-FILE-STATUS
  5354         GO TO ABEND-PGM.
  5355
  5356     IF CL-CONTROL-BY-CERT-NO  NOT EQUAL WS-SEC-CLAIM-INDEX
  5357         MOVE  'X'               TO WS-CLM-END-SW
  5358     ELSE
  5359         IF CL-CERT-KEY-DATA EQUAL WS-CLAIM-MATCH-KEY
  5360             ADD +1              TO  WS-CLM-CNT
  5361             MOVE CLAIM-MASTER   TO WS-LAST-CLAIM-MATCHED
  5362             MOVE 'A'            TO WS-CLAIM-SW.
  5363
  5364 2335-EXIT.
  5365      EXIT.
  5366
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 110
* EL331.cbl
  5368
  5369********************************************************
  5370*  BUILD RL-CONTROL-BY-CERT-NO AND WS-SEC-CLAIM-INDEX  *
  5371*  FROM THE CURRENT ONLINE CERT MASTER RECORD.         *
  5372********************************************************
  5373
  5374 2350-CHECK-ELRETR.
  5375     MOVE CM-COMPANY-CD         TO RL-COMPANY-CD-A4
  5376                                   WS-S-CL-COMP.
  5377     MOVE CM-CERT-PRIME         TO RL-CERT-A4-PRIME
  5378                                   WS-S-CL-PRIM.
  5379     MOVE CM-CERT-SFX           TO RL-CERT-A4-SFX
  5380                                   WS-S-CL-SFX.
  5381     MOVE CM-GROUPING           TO WS-CL-GRPG.
  5382     MOVE CM-STATE              TO WS-CL-STAT.
  5383     MOVE CM-ACCOUNT            TO WS-CL-ACCT.
  5384     MOVE CM-CARRIER            TO WS-CL-CARR.
  5385     MOVE CM-CERT-EFF-DT        TO WS-CL-EFDT.
  5386
  5387     MOVE ZERO                  TO WS-CLM-CNT.
  5388
  5389     START ELRETR5
  5390                KEY EQUAL RL-CONTROL-BY-CERT-NO.
  5391
  5392     IF ELRETR5-FILE-STATUS = '23'
  5393         GO TO 2330-EXIT.
  5394
  5395     IF ELRETR5-FILE-STATUS = ZERO
  5396         MOVE SPACE              TO WS-CLM-END-SW
  5397         PERFORM 2355-READNEXT-CLAIM  THRU 2355-EXIT
  5398             UNTIL NO-MORE-CLAIM-MATCH
  5399     ELSE
  5400         MOVE 'ERROR OCCURRED START - ELRETR'
  5401                                  TO WS-ABEND-MESSAGE
  5402         MOVE ELRETR5-FILE-STATUS TO WS-ABEND-FILE-STATUS
  5403         GO TO ABEND-PGM.
  5404
  5405     IF ASSOCIATED-CLAIM
  5406         MOVE WS-LAST-CLAIM-MATCHED TO CLAIM-MASTER.
  5407
  5408     GO TO 2330-EXIT.
  5409
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 111
* EL331.cbl
  5411*****************************************************
  5412*  2355-READNEXT-CLAIM (ELRETR)                     *
  5413*****************************************************
  5414*  READ RETRIEVE FILE AND CHECK KEYS FOR MATCH      *
  5415*****************************************************
  5416
  5417 2355-READNEXT-CLAIM.
  5418
  5419     READ ELRETR5  NEXT  RECORD.
  5420
  5421     IF ELRETR5-STAT-1 = '1'
  5422         MOVE 'X'                TO WS-CLM-END-SW
  5423         GO TO 2355-EXIT.
  5424
  5425     IF ELRETR5-STAT-1 NOT = ZERO
  5426         MOVE 'ERROR OCCURRED READNEXT - ELMSTR'
  5427                                  TO WS-ABEND-MESSAGE
  5428         MOVE ELRETR5-FILE-STATUS TO WS-ABEND-FILE-STATUS
  5429         GO TO ABEND-PGM.
  5430
  5431     IF RL-CONTROL-BY-CERT-NO NOT = WS-SEC-CLAIM-INDEX
  5432         MOVE  'X'               TO WS-CLM-END-SW
  5433     ELSE
  5434         IF RL-CERT-KEY-DATA = WS-CLAIM-MATCH-KEY
  5435             ADD +1 TO WS-CLM-CNT
  5436             MOVE RETRIEVE-MASTER  TO WS-LAST-CLAIM-MATCHED
  5437             MOVE 'A'              TO WS-CLAIM-SW.
  5438
  5439 2355-EXIT.
  5440      EXIT.
  5441
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 112
* EL331.cbl
  5443***********************************************************
  5444*  2370-SAVE-ONL-KEY                                      *
  5445***********************************************************
  5446*  STORE ONLINE CERT MASTER KEY IN WS-CM-CONTROL-PRIMARY  *
  5447*  AND BUILD WS-SAVED-ONL-KEY FOR COMPARISON.             *
  5448***********************************************************
  5449
  5450 2370-SAVE-ONL-KEY.
  5451
  5452     MOVE CM-CONTROL-PRIMARY     TO WS-CM-CONTROL-PRIMARY.
  5453     MOVE DTE-CLASIC-COMPANY-CD  TO WS-SAVED-O-COMP.
  5454     MOVE CM-CARRIER             TO WS-SAVED-O-CARR.
  5455     MOVE CM-GROUPING            TO WS-SAVED-O-GRPG.
  5456     MOVE CM-STATE               TO WS-SAVED-O-STAT.
  5457     MOVE CM-ACCOUNT             TO WS-SAVED-O-ACCT.
  5458     MOVE CM-CERT-NO             TO WS-SAVED-O-CERT.
  5459
  5460     MOVE SPACES                 TO DC-OPTION-CODE.
  5461     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
  5462     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  5463     MOVE DC-GREG-DATE-CYMD      TO WS-SAVED-O-DATE.
  5464
  5465 2370-EXIT.
  5466      EXIT.
  5467
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 113
* EL331.cbl
  5469***********************************************************
  5470*  2500-PROCESS-MATCHING                                  *
  5471***********************************************************
  5472*  A MATCH HAS OCCURRED BETWEEN THE ONLINE AND BATCH      *
  5473*  CERT MASTER FILES. DETERMINE THE TYPE OF ACTIVITY IF   *
  5474*  ANY THAT HAS OCCURRED SINCE LAST MONTH-END AND REPORT  *
  5475*  IT.                                                    *
  5476***********************************************************
  5477
  5478 2500-PROCESS-MATCHING.
  5479     ADD 1                       TO WS-MATCHED-ONL.
  5480     MOVE 'M'                    TO WS-O-MATCH-SW.
  5481     MOVE SPACES                 TO WS-FIRST-TIME-SW.
  5482     MOVE SPACES                 TO WS-PRT-FULL-LINE-SW.
  5483
  5484*****************************************************************
  5485*****************************************************************
  5486*****    SPECIAL CODE FOR JAL AND JAI TO INFORM THEM OF     *****
  5487*****    ZERO CERTIFICATES COMING FROM THE BLAZER LOAN      *****
  5488*****    SYSTEM.                                            *****
  5489*****************************************************************
  5490*****************************************************************
  5491
  5492     IF DTE-CLIENT EQUAL 'JAL' OR 'JAI'
  5493        IF (CR-AHPRM + CR-LFPRM) LESS THAN +.05
  5494           ADD 1 TO NO-PREM-CT
  5495           DISPLAY 'NO PREMIUMS FOR CERT ' CR-FULL-CONTROL
  5496           IF ((CR-AHTYP EQUAL ZERO) AND (CR-LFTYP EQUAL ZERO))
  5497              DISPLAY 'NO PLAN CODES FOR CERT ' CR-FULL-CONTROL
  5498              ADD 1 TO NO-PLAN-CODE-CT
  5499              MOVE +1 TO CR-AHPRM CR-LFPRM
  5500           ELSE
  5501              IF CR-LFTYP EQUAL ZEROS
  5502                 MOVE +1 TO CR-AHPRM
  5503              ELSE
  5504                 IF CR-AHTYP EQUAL ZEROS
  5505                    MOVE +1 TO CR-LFPRM
  5506                 ELSE
  5507                    MOVE +1 TO CR-AHPRM CR-LFPRM.
  5508
  5509*****************************************************************
  5510*****************************************************************
  5511*****    SPECIAL CODE FOR JAL AND JAI TO INFORM THEM OF     *****
  5512*****    ZERO CERTIFICATES COMING FROM THE BLAZER LOAN      *****
  5513*****    SYSTEM.                                            *****
  5514*****************************************************************
  5515*****************************************************************
  5516
  5517*****************************************************************
  5518*  PREMIUM TOTAL LESS THAN (.05) EXIT ROUTINE (RE-ISSUED CERT)  *
  5519*****************************************************************
  5520
  5521*    IF (CR-AHPRM + CR-LFPRM) LESS +.05
  5522*        GO TO 2500-EXIT.
  5523
  5524*****************************************************************
  5525*  PROCESS OPTION (2) RE-ATTACHES CERT MASTER TO CLAIMS MASTER  *
  5526*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 114
* EL331.cbl
  5527
  5528     IF DTE-CLIENT = 'MON'
  5529         NEXT SENTENCE
  5530     ELSE
  5531         IF DTE-PRC-OPT NOT EQUAL '2'
  5532             IF NO-CLAIM-ATTACHED
  5533                 PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5534                 GO TO 2500-EXIT.
  5535
  5536     PERFORM 2330-FIND-ASSOCIATED-CLAIM  THRU 2330-EXIT.
  5537
  5538     IF NO-ASSOCIATED-CLAIM
  5539         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5540         GO TO 2500-EXIT.
  5541
  5542     ADD 1                       TO WS-CLAIM-MATCH.
  5543
  5544*********************************************************
  5545*****  LIFE COVERAGE CANCELLED BUT NOW REINSTATED   *****
  5546*********************************************************
  5547
  5548     IF CR-LF-STATUS-AT-CANCEL EQUAL SPACE AND
  5549        CM-LF-CANCEL-DT NOT EQUAL LOW-VALUE
  5550           MOVE 'POLICY REINSTATED AFTER CANCEL' TO DTL-EXC-MSG
  5551           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5552           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5553           GO TO 2500-EXIT.
  5554
  5555*********************************************************
  5556*****  AH COVERAGE CANCELLED BUT NOW REINSTATED     *****
  5557*********************************************************
  5558
  5559     IF CR-AH-STATUS-AT-CANCEL EQUAL SPACE AND
  5560        CM-AH-CANCEL-DT NOT EQUAL LOW-VALUE
  5561           MOVE 'POLICY REINSTATED AFTER CANCEL' TO DTL-EXC-MSG
  5562           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5563           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5564           GO TO 2500-EXIT.
  5565
  5566*************************************
  5567*****  LIFE COVERAGE CANCELLED  *****
  5568*************************************
  5569
  5570     IF CR-LF-STATUS-AT-CANCEL NOT EQUAL SPACE AND
  5571        CM-LF-CANCEL-DT EQUAL LOW-VALUE
  5572           MOVE ' LIFE COV CANCELLED AS OF '
  5573                                   TO WS-EXC-MSG-DESC
  5574           MOVE CR-LF-CNC-MO       TO WS-EXC-C-MO
  5575           MOVE CR-LF-CNC-DA       TO WS-EXC-C-DA
  5576           MOVE CR-LF-CNC-YR       TO WS-EXC-C-YR
  5577           MOVE WS-EXC-MSG-CANCEL  TO DTL-EXC-MSG
  5578           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5579           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5580           GO TO 2500-EXIT.
  5581
  5582*************************************
  5583*****  AH COVERAGE CANCELLED    *****
  5584*************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 115
* EL331.cbl
  5585
  5586     IF CR-AH-STATUS-AT-CANCEL NOT EQUAL SPACE AND
  5587        CM-AH-CANCEL-DT EQUAL LOW-VALUE
  5588           MOVE ' A&H  COV CANCELLED AS OF '
  5589                                   TO WS-EXC-MSG-DESC
  5590           MOVE CR-AH-CNC-MO       TO WS-EXC-C-MO
  5591           MOVE CR-AH-CNC-DA       TO WS-EXC-C-DA
  5592           MOVE CR-AH-CNC-YR       TO WS-EXC-C-YR
  5593           MOVE WS-EXC-MSG-CANCEL  TO DTL-EXC-MSG
  5594           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5595           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5596           GO TO 2500-EXIT.
  5597
  5598*************************************
  5599*****  LIFE COVERAGE DELETED    *****
  5600*************************************
  5601
  5602     IF CR-LFTYP EQUAL ZEROS AND
  5603        CM-LF-BENEFIT-CD NOT EQUAL ZERO
  5604         MOVE WS-EXC-MSG-CO-DELETE TO DTL-EXC-MSG
  5605         PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5606         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5607         GO TO 2500-EXIT.
  5608
  5609*************************************
  5610*****  AH COVERAGE DELETED      *****
  5611*************************************
  5612
  5613     IF CR-AHTYP EQUAL ZEROS AND
  5614        CM-AH-BENEFIT-CD NOT EQUAL ZERO
  5615         MOVE WS-EXC-MSG-CO-DELETE TO DTL-EXC-MSG
  5616         PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5617         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5618         GO TO 2500-EXIT.
  5619
  5620*************************************
  5621*****  COVERAGE ADDED FOR LIFE  *****
  5622*************************************
  5623
  5624     IF CERT-WAS-CREATED-FOR-CLAIM
  5625         IF CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1
  5626            MOVE CR-LFTYP         TO WS-EXC-MSG-ADDED-TYPE
  5627            MOVE CR-LFAMT         TO WS-EXC-MSG-ADDED-AMT
  5628            MOVE WS-EXC-MSG-ADDED TO DTL-EXC-MSG
  5629            PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5630            PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5631            GO TO 2500-EXIT.
  5632
  5633*************************************
  5634*****  COVERAGE ADDED FOR AH   *****
  5635*************************************
  5636
  5637     IF CERT-WAS-CREATED-FOR-CLAIM
  5638         IF CL-CLAIM-TYPE EQUAL AH-OVERRIDE-L1
  5639            MOVE CR-AHTYP         TO WS-EXC-MSG-ADDED-TYPE
  5640            MOVE CR-AHAMT         TO WS-EXC-MSG-ADDED-AMT
  5641            MOVE WS-EXC-MSG-ADDED TO DTL-EXC-MSG
  5642            PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 116
* EL331.cbl
  5643            PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5644            GO TO 2500-EXIT.
  5645
  5646     IF (CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1) AND
  5647        (CR-LFTYP EQUAL CM-LF-BENEFIT-CD) AND
  5648        (CR-LFAMT EQUAL CM-LF-BENEFIT-AMT)
  5649          PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5650          GO TO 2500-EXIT.
  5651
  5652     IF (CL-CLAIM-TYPE EQUAL AH-OVERRIDE-L1) AND
  5653        (CR-AHTYP  EQUAL CM-AH-BENEFIT-CD) AND
  5654        (CR-AHAMT  EQUAL CM-AH-BENEFIT-AMT)
  5655          PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5656          GO TO 2500-EXIT.
  5657
  5658     IF CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1
  5659         MOVE CM-LF-BENEFIT-AMT      TO WS-EXC-MSG-CHGD-AMT-NEW
  5660         MOVE CM-LF-BENEFIT-CD       TO WS-EXC-MSG-CHGD-TYPE-NEW
  5661         MOVE WS-EXC-MSG-CHANGED-NEW TO DTL-EXC-MSG
  5662         PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5663         MOVE CR-LFTYP               TO WS-EXC-MSG-CHGD-TYPE-OLD
  5664         MOVE CR-LFAMT               TO WS-EXC-MSG-CHGD-AMT-OLD
  5665         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT.
  5666
  5667     IF CL-CLAIM-TYPE EQUAL AH-OVERRIDE-L1
  5668         MOVE CM-AH-BENEFIT-AMT      TO WS-EXC-MSG-CHGD-AMT-NEW
  5669         MOVE CM-AH-BENEFIT-CD       TO WS-EXC-MSG-CHGD-TYPE-NEW
  5670         MOVE WS-EXC-MSG-CHANGED-NEW TO DTL-EXC-MSG
  5671         PERFORM 2510-BUILD-PRINT THRU 2510-EXIT
  5672         MOVE CR-AHTYP               TO WS-EXC-MSG-CHGD-TYPE-OLD
  5673         MOVE CR-AHAMT               TO WS-EXC-MSG-CHGD-AMT-OLD
  5674         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT.
  5675
  5676     PERFORM 2530-PRINT-OLD THRU 2530-EXIT.
  5677
  5678 2500-EXIT.
  5679      EXIT.
  5680
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 117
* EL331.cbl
  5682 2510-BUILD-PRINT.
  5683     IF NOT LINE-FULL
  5684         PERFORM 7300-BLD-ECS-PRT-LINE  THRU 7300-EXIT
  5685         PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT.
  5686
  5687     PERFORM 7370-PRINT-DETAIL THRU 7370-EXIT.
  5688
  5689 2510-EXIT.
  5690      EXIT.
  5691
  5692 2530-PRINT-OLD.
  5693
  5694     MOVE SPACES                 TO DTL-1.
  5695     MOVE WS-EXC-MSG-CHANGED-OLD TO DTL-EXC-MSG.
  5696     MOVE DTL-1                  TO P-DATA.
  5697     MOVE ' '                    TO X.
  5698     ADD  1                      TO WS-LINE-CNT.
  5699     PERFORM 7600-PRT-RTN   THRU 7600-EXIT.
  5700
  5701 2530-EXIT.
  5702      EXIT.
  5703
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 118
* EL331.cbl
  5705***********************************************************
  5706*  2600-REWRITE-CERT                                      *
  5707***********************************************************
  5708*  REWRITE THE UPDATED ONLINE CERTIFICATE MASTER RECORD   *
  5709***********************************************************
  5710
  5711 2600-REWRITE-CERT.
  5712
  5713*****COPY ELCCRTM1.
  5714
  5715     MOVE CERTIFICATE-MASTER TO WS-BEFORE-CERT.
  5716
  5717     PERFORM 2830-MOVE-DATA  THRU 2830-EXIT.
  5718
  5719     IF MATCHED-REC
  5720         MOVE WS-LN-NUMBER        TO CM-LOAN-NUMBER
  5721         MOVE WS-LN-BALANCE       TO CM-LOAN-BALANCE
  5722         MOVE WS-CM-BENEFICIARY   TO CM-BENEFICIARY
  5723         MOVE WS-LST-ADD-ON-DT    TO CM-LAST-ADD-ON-DT
  5724         MOVE WS-CM-ENTRY-BATCH   TO CM-ENTRY-BATCH
  5725         MOVE WS-CM-LF-EXIT-BATCH TO CM-LF-EXIT-BATCH
  5726         MOVE WS-CM-AH-EXIT-BATCH TO CM-AH-EXIT-BATCH
  5727         MOVE WS-CLM-CNT          TO CM-CLAIM-ATTACHED-COUNT
  5728         MOVE WS-CM-INSURED-ADDRESS-SW
  5729                                  TO CM-INSURED-ADDRESS-SW
  5730*        MOVE WS-CLAIM-DEDUCT-WITHHELD
  5731*                                 TO CM-CLAIM-DEDUCT-WITHHELD
  5732*        MOVE WS-CANCEL-DEDUCT-WITHHELD
  5733*                                 TO CM-CANCEL-DEDUCT-WITHHELD
  5734         IF CM-CLAIM-ATTACHED-COUNT EQUAL ZERO
  5735               MOVE SPACE         TO CM-CLAIM-INTERFACE-SW
  5736           ELSE
  5737               MOVE '1'           TO CM-CLAIM-INTERFACE-SW.
  5738
  5739     IF MATCHED-REC
  5740         IF WS-LF-DEATH-EXIT-DT NOT LESS THAN WS-EOM-DT
  5741             MOVE WS-LF-DEATH-EXIT-DT
  5742                                  TO  CM-LF-DEATH-EXIT-DT
  5743             MOVE WS-LF-CURRENT-STATUS
  5744                                  TO  CM-LF-CURRENT-STATUS
  5745             MOVE WS-LF-STATUS-AT-DEATH
  5746                                  TO  CM-LF-STATUS-AT-DEATH.
  5747
  5748     IF ASSOCIATED-ERCOMM
  5749        MOVE ' '                  TO CM-COMP-EXCP-SW
  5750        PERFORM 2270-DELETE-ERCOMM THRU 2270-EXIT.
  5751
  5752     ADD 1 TO WS-ACCT-READS.
  5753     PERFORM 2200-MATCH-ACCT THRU 2200-EXIT.
  5754
  5755     PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT.
  5756
  5757     MOVE WS-CURRENT-DATE         TO DC-GREG-DATE-1-EDIT.
  5758     MOVE '2'                     TO DC-OPTION-CODE.
  5759     PERFORM 7100-DATE-RTN THRU 7100-EXIT.
  5760
  5761*****COPY ELCCRTM2.
  5762
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 119
* EL331.cbl
  5763     IF WS-BEFORE-CERT NOT EQUAL CERTIFICATE-MASTER
  5764        MOVE DC-BIN-DATE-1        TO CM-LAST-MONTH-END
  5765        REWRITE CERTIFICATE-MASTER.
  5766
  5767     IF CM-STAT-1 NOT EQUAL ZERO
  5768          MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  5769          MOVE 'ERROR OCCURED REWRITE - ELCERT'
  5770                                  TO  WS-ABEND-MESSAGE
  5771         GO TO ABEND-PGM.
  5772
  5773     MOVE ZERO                    TO  WS-UPDATE-SW.
  5774
  5775 2600-EXIT.
  5776      EXIT.
  5777
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 120
* EL331.cbl
  5779***********************************************************
  5780*  2800-ADD-NEW-CERT                                      *
  5781***********************************************************
  5782*  REWRITE THE UPDATED ONLINE CERTIFICATE MASTER RECORD   *
  5783***********************************************************
  5784
  5785 2800-ADD-NEW-CERT.
  5786
  5787     MOVE SPACES                 TO CERTIFICATE-MASTER.
  5788
  5789*****COPY ELCCRTM1.
  5790
  5791     PERFORM 2830-MOVE-DATA      THRU 2830-EXIT.
  5792     PERFORM 2820-BUILD-NEW-KEY  THRU 2820-EXIT.
  5793
  5794     ADD 1 TO WS-ACCT-READS.
  5795     PERFORM 2200-MATCH-ACCT THRU 2200-EXIT.
  5796
  5797     MOVE WS-CURRENT-DATE         TO DC-GREG-DATE-1-EDIT.
  5798     MOVE '2'                     TO DC-OPTION-CODE.
  5799     PERFORM 7100-DATE-RTN THRU 7100-EXIT.
  5800     MOVE DC-BIN-DATE-1           TO CM-LAST-MONTH-END
  5801     PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT.
  5802
  5803     WRITE CERTIFICATE-MASTER.
  5804
  5805     IF CM-STATUS EQUAL '22'
  5806         NEXT SENTENCE
  5807      ELSE
  5808       IF CM-STAT-1  NOT EQUAL ZERO
  5809         MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  5810         MOVE 'ERROR OCCURED WRITE - ELCERT'
  5811                                 TO  WS-ABEND-MESSAGE
  5812         GO TO ABEND-PGM.
  5813
  5814     MOVE  WS-ONL-RECORD         TO CERTIFICATE-MASTER.
  5815
  5816 2800-EXIT.
  5817      EXIT.
  5818
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 121
* EL331.cbl
  5820***********************************************************
  5821*  2820-BUILD-NEW-KEY                                     *
  5822***********************************************************
  5823*  BUILD PRIMARY AND ALL ALTERNATE KEY FIELDS IN ONLINE   *
  5824*  CERT MASTER FROM BATCH CERT MASTER.                    *
  5825***********************************************************
  5826
  5827 2820-BUILD-NEW-KEY.
  5828
  5829     MOVE DTE-CLASIC-COMPANY-CD  TO CM-COMPANY-CD
  5830                                    CM-COMPANY-CD-A1
  5831                                    CM-COMPANY-CD-A2
  5832                                    CM-COMPANY-CD-A4
  5833                                    CM-COMPANY-CD-A5.
  5834
  5835     MOVE CR-CARRIER             TO CM-CARRIER.
  5836     MOVE CR-GROUPING            TO CM-GROUPING.
  5837     MOVE CR-STATE               TO CM-STATE.
  5838     MOVE CR-ACCOUNT             TO CM-ACCOUNT.
  5839     MOVE CR-CERT-NO             TO CM-CERT-NO
  5840                                    CM-CERT-NO-A4.
  5841
  5842     MOVE BIN-CR-DT              TO CM-CERT-EFF-DT.
  5843
  5844     IF CR-LNAME EQUAL SPACES
  5845         MOVE CR-CERT-NO         TO CR-LNAME.
  5846
  5847     MOVE CR-INIT                TO CM-INSURED-INITIAL2.
  5848     MOVE CR-1ST-INITIAL         TO CM-INSURED-INITIAL1.
  5849     MOVE CR-LNAME               TO CM-INSURED-LAST-NAME.
  5850
  5851     IF CR-MEMBER-NO NOT = SPACES
  5852         MOVE CR-MEMBER-NO       TO CM-MEMBER-NO.
  5853
  5854     INSPECT CR-MEMBER-NO
  5855         REPLACING ALL ' ' BY '0'.
  5856
  5857     IF CR-MEMBER-NO = ZEROS
  5858       IF DTE-CLIENT = 'MON'
  5859           MOVE CR-LNAME            TO WK-LAST-NAME
  5860           MOVE SPACES              TO WK-MEMB-ACCT
  5861                                       ERROR-FLAG
  5862           MOVE 1                   TO ACCT-SUB
  5863           PERFORM 2825-FILL-ACCT THRU 2825-EXIT
  5864               VARYING LST-NM-SUB FROM 1 BY 1
  5865                 UNTIL LST-NM-SUB GREATER 12
  5866           MOVE WK-MEMB-ACCT        TO CM-MEMB-ACCOUNT
  5867           MOVE CR-YR               TO CM-INSURED-INITIALS-A5
  5868           MOVE CR-MO               TO CM-PART-LAST-NAME-A5
  5869        ELSE
  5870           MOVE CR-STATE            TO CM-MEMB-STATE
  5871           MOVE CR-ACCT-PRIME       TO CM-MEMB-ACCOUNT
  5872           MOVE CR-LNAME            TO CM-PART-LAST-NAME-A5
  5873           MOVE CM-INSURED-INITIALS TO CM-INSURED-INITIALS-A5.
  5874
  5875     IF CR-SOC-SEC NOT = SPACES
  5876         MOVE CR-SOC-SEC         TO CM-SOC-SEC-NO.
  5877
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 122
* EL331.cbl
  5878     INSPECT CR-SOC-SEC
  5879         REPLACING ALL ' ' BY '0'.
  5880
  5881     IF CR-SOC-SEC = ZEROS
  5882         MOVE CR-STATE           TO CM-SSN-STATE
  5883         MOVE CR-ACCT-PRIME      TO CM-SSN-ACCOUNT
  5884         MOVE CR-LNAME           TO CM-PART-LAST-NAME-A2
  5885         MOVE CM-INSURED-INITIALS TO CM-INSURED-INITIALS-A2.
  5886
  5887 2820-EXIT.
  5888      EXIT.
  5889
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 123
* EL331.cbl
  5891 2825-FILL-ACCT.
  5892     IF ACCT-SUB GREATER 6
  5893         MOVE 12            TO LST-NM-SUB
  5894         GO TO 2825-EXIT.
  5895     IF WK-LAST-NAME-CHAR (LST-NM-SUB) NUMERIC
  5896         MOVE 'A'           TO ERROR-FLAG
  5897         GO TO 2825-EXIT.
  5898     IF WK-LAST-NAME-CHAR (LST-NM-SUB) ALPHABETIC AND
  5899        WK-LAST-NAME-CHAR (LST-NM-SUB) NOT = SPACE
  5900         MOVE WK-LAST-NAME-CHAR (LST-NM-SUB)
  5901                            TO WK-MEMB-ACCT-CHAR (ACCT-SUB)
  5902         ADD 1 TO ACCT-SUB.
  5903
  5904 2825-EXIT.
  5905      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 124
* EL331.cbl
  5907***********************************************************
  5908*  2830-MOVE-DATA                                         *
  5909***********************************************************
  5910*                                                         *
  5911*  BUILD ONLINE CERT MASTER RECORD FROM THE BATCH CERT    *
  5912*  MASTER RECORD.                                         *
  5913*                                                         *
  5914***********************************************************
  5915****  STRAIGHT MOVES FROM BATCH CERT TO ONLINE CERT    ****
  5916***********************************************************
  5917
  5918 2830-MOVE-DATA.
  5919
  5920     MOVE 'CM'                   TO CM-RECORD-ID.
  5921     MOVE LOW-VALUES             TO CM-STATUS-DATA.
  5922     MOVE SPACE                  TO CM-CLAIM-INTERFACE-SW.
  5923     MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
  5924                                    CM-CREDIT-INTERFACE-SW-2.
  5925     MOVE ZERO                   TO CM-CLAIM-ATTACHED-COUNT
  5926                                    CM-LOAN-BALANCE
  5927                                    CM-LF-REMAINING-AMT.
  5928
  5929     MOVE CR-LFRFND              TO CM-LF-ITD-CANCEL-AMT.
  5930     MOVE CR-DTHAMT              TO CM-LF-ITD-DEATH-AMT.
  5931     MOVE CR-AHRFND              TO CM-AH-ITD-CANCEL-AMT.
  5932     MOVE CR-RATING-CLASS        TO CM-RATE-CLASS.
  5933     if dte-client = 'AHL'
  5934        move cr-lf-class-cd      to cm-lf-class-cd
  5935        move cr-ah-class-cd      to cm-ah-class-cd
  5936     end-if
  5937     MOVE CR-AH-DEV-CODE         TO CM-AH-DEV-CODE.
  5938     MOVE CR-LF-DEV-CODE         TO CM-LF-DEV-CODE.
  5939     MOVE CR-AH-DEV-PCT          TO CM-AH-DEV-PCT.
  5940     MOVE CR-LF-DEV-PCT          TO CM-LF-DEV-PCT.
  5941     MOVE CR-APR                 TO CM-LOAN-APR.
  5942     MOVE CR-PMT-EXTENSION-DAYS  TO CM-PMT-EXTENSION-DAYS
  5943     MOVE CR-PMT-FREQ            TO CM-PAY-FREQUENCY.
  5944     MOVE CR-LOAN-TERM           TO CM-LOAN-TERM
  5945     MOVE CR-LF-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
  5946     MOVE CR-LOAN-OFFICER        TO CM-LOAN-OFFICER.
  5947     MOVE CR-JOINT-NAME          TO CM-JOINT-INSURED-NAME.
  5948     MOVE CR-FNAME               TO CM-INSURED-FIRST-NAME.
  5949     MOVE CR-CLP-STATE           TO CM-CLP-STATE
  5950     if dte-client not = 'AHL'
  5951        MOVE CR-USER-FUTURE         TO CM-USER-RESERVED
  5952     end-if
  5953
  5954*    IF CR-CLAIM-DEDUCT-WITHHELD NUMERIC
  5955*        MOVE CR-CLAIM-DEDUCT-WITHHELD
  5956*                                 TO CM-CLAIM-DEDUCT-WITHHELD
  5957*    ELSE
  5958*        MOVE ZEROS               TO CM-CLAIM-DEDUCT-WITHHELD.
  5959*    IF CR-CANCEL-DEDUCT-WITHHELD NUMERIC
  5960*        MOVE CR-CANCEL-DEDUCT-WITHHELD
  5961*                                 TO CM-CANCEL-DEDUCT-WITHHELD
  5962*    ELSE
  5963*        MOVE ZEROS               TO CM-CANCEL-DEDUCT-WITHHELD.
  5964
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 125
* EL331.cbl
  5965     MOVE CR-CSR-CODE             TO CM-CSR-CODE.
  5966     MOVE CR-USER-CODE            TO CM-USER-FIELD.
  5967     MOVE CR-UNDERWRITING-CODE    TO CM-UNDERWRITING-CODE.
  5968
  5969     IF CR-ADDL-CLP NOT NUMERIC
  5970        MOVE ZEROS                TO CR-ADDL-CLP
  5971     END-IF
  5972     IF CR-LF-CLP NOT NUMERIC
  5973        MOVE ZEROS                TO CR-LF-CLP
  5974     END-IF
  5975     IF CR-AH-CLP NOT NUMERIC
  5976        MOVE ZEROS                TO CR-AH-CLP
  5977     END-IF
  5978     IF DTE-CLIENT = 'DCC'
  5979        MOVE CR-ADDL-CLP         TO CM-ADDL-CLP
  5980        MOVE CR-LF-CLP           TO CM-LF-CLP
  5981        MOVE CR-AH-CLP           TO CM-AH-CLP
  5982        MOVE CR-DDF-IU-RATE-UP   TO CM-DDF-IU-RATE-UP
  5983     END-IF
  5984
  5985     IF CR-NH-INT-ON-REF     NUMERIC
  5986         MOVE CR-NH-INT-ON-REF    TO CM-NH-INT-ON-REFS
  5987     ELSE
  5988         MOVE ZEROS               TO CM-NH-INT-ON-REFS.
  5989
  5990     IF DTE-CLIENT EQUAL 'FIA'
  5991         INSPECT CR-LNAME REPLACING ALL '0' BY ' '
  5992         INSPECT CR-LNAME REPLACING ALL '{' BY ' '.
  5993
  5994     IF CR-LNAME IS EQUAL TO SPACES
  5995         NEXT SENTENCE
  5996     ELSE
  5997         MOVE CR-LNAME          TO CM-INSURED-LAST-NAME.
  5998
  5999     IF CR-MEMBER-NO IS EQUAL TO SPACES
  6000         MOVE CR-STATE          TO CM-MEMB-STATE
  6001         MOVE CR-ACCT-PRIME     TO CM-MEMB-ACCOUNT
  6002         MOVE CR-LNAME          TO CM-PART-LAST-NAME-A5
  6003         MOVE CM-INSURED-INITIALS TO CM-INSURED-INITIALS-A5
  6004     ELSE
  6005         MOVE CR-MEMBER-NO      TO CM-MEMBER-NO.
  6006
  6007     IF CM-POLICY-FORM-NO EQUAL SPACES
  6008         MOVE CR-POLICY-FORM-NO  TO CM-POLICY-FORM-NO.
  6009
  6010     IF CR-IND-GRP EQUAL '1' OR 'I'
  6011         MOVE 'I'                TO CM-IND-GRP-TYPE
  6012      ELSE
  6013         MOVE 'G'                TO CM-IND-GRP-TYPE.
  6014
  6015     MOVE SPACE                  TO CM-PAYMENT-MODE.
  6016     MOVE WS-CM-ENTRY-BATCH      TO CM-ENTRY-BATCH.
  6017     MOVE CR-REIN-TABLE          TO CM-REIN-TABLE.
  6018     MOVE CR-REIN-SPEC           TO CM-SPECIAL-REIN-CODE.
  6019
  6020     MOVE SPACE                  TO CM-SKIP-CODE.
  6021     IF CR-SKIP = 01
  6022        MOVE '1'                 TO CM-SKIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 126
* EL331.cbl
  6023     IF CR-SKIP = 02
  6024        MOVE '2'                 TO CM-SKIP-CODE.
  6025     IF CR-SKIP = 03
  6026        MOVE '3'                 TO CM-SKIP-CODE.
  6027     IF CR-SKIP = 04
  6028        MOVE '4'                 TO CM-SKIP-CODE.
  6029     IF CR-SKIP = 05
  6030        MOVE '5'                 TO CM-SKIP-CODE.
  6031     IF CR-SKIP = 06
  6032        MOVE '6'                 TO CM-SKIP-CODE.
  6033     IF CR-SKIP = 07
  6034        MOVE '7'                 TO CM-SKIP-CODE.
  6035     IF CR-SKIP = 08
  6036        MOVE '8'                 TO CM-SKIP-CODE.
  6037     IF CR-SKIP = 09
  6038        MOVE '9'                 TO CM-SKIP-CODE.
  6039     IF CR-SKIP = 10
  6040        MOVE 'A'                 TO CM-SKIP-CODE.
  6041     IF CR-SKIP = 11
  6042        MOVE 'X'                 TO CM-SKIP-CODE.
  6043
  6044     MOVE ZERO                   TO CM-LIFE-COMM-PCT
  6045                                    CM-AH-COMM-PCT.
  6046
  6047     MOVE +1                     TO WS-LEVEL-INDEX.
  6048
  6049 2830-LOAD-COMM-PCTS.
  6050
  6051     IF (CR-AGT-TYPE (WS-LEVEL-INDEX) EQUAL 'C' OR 'D'
  6052                  OR 'F' OR 'S')
  6053         MOVE CR-LCOM-L (WS-LEVEL-INDEX)  TO CM-LIFE-COMM-PCT
  6054         MOVE CR-LCOM-AH (WS-LEVEL-INDEX) TO CM-AH-COMM-PCT
  6055         GO TO 2830-COMM-LOAD-END
  6056     ELSE
  6057         ADD +1 TO WS-LEVEL-INDEX
  6058         IF WS-LEVEL-INDEX GREATER +10
  6059             NEXT SENTENCE
  6060         ELSE
  6061              GO TO 2830-LOAD-COMM-PCTS.
  6062
  6063 2830-COMM-LOAD-END.
  6064
  6065**************************************
  6066*  PREMIUM TYPE (2) EQUAL O.B. COVERAGE *
  6067*  PREMIUM TYPE (3) EQUAL OPEN END   *
  6068**************************************
  6069***********************************************************
  6070****  MOVES FROM BATCH CERT TO ONLINE CERT ONLY FOR    ****
  6071****  SINGLE PREMIUM CERTS.                            ****
  6072***********************************************************
  6073
  6074     IF MATCHED-REC
  6075       AND CM-PREMIUM-TYPE EQUAL ('2' OR '3')
  6076          GO TO 2830-OB-ADJUST-END.
  6077
  6078     IF MATCHED-REC   AND
  6079       (CR-LFPRM + CR-AHPRM) LESS +.05
  6080          GO TO 2830-OB-ADJUST-END.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 127
* EL331.cbl
  6081
  6082     MOVE CR-AGE                 TO CM-INSURED-ISSUE-AGE.
  6083     MOVE CR-JOINT-AGE           TO CM-INSURED-JOINT-AGE
  6084     MOVE CR-SEX                 TO CM-INSURED-SEX.
  6085     MOVE CR-LFTYP               TO CM-LF-BENEFIT-CD.
  6086     MOVE CR-LF-TERM             TO CM-LF-ORIG-TERM.
  6087     MOVE CR-LFAMT               TO CM-LF-BENEFIT-AMT.
  6088     MOVE CR-LFAMT-ALT           TO CM-LF-ALT-BENEFIT-AMT.
  6089     MOVE CR-LFPRM               TO CM-LF-PREMIUM-AMT.
  6090     MOVE CR-LFPRM-ALT           TO CM-LF-ALT-PREMIUM-AMT.
  6091     MOVE CR-LF-NSP-PRM          TO CM-LF-NSP-PREMIUM-AMT.
  6092     MOVE CR-AH-NSP-PRM          TO CM-AH-NSP-PREMIUM-AMT.
  6093     MOVE CR-LFPRM-RATE          TO CM-LF-PREMIUM-RATE.
  6094     MOVE CR-LFPRM-RATE-ALT      TO CM-LF-ALT-PREMIUM-RATE.
  6095     MOVE CR-LF-CRIT-PERIOD      TO CM-LF-CRITICAL-PERIOD.
  6096     MOVE CR-AH-CRIT-PERIOD      TO CM-AH-CRITICAL-PERIOD.
  6097     MOVE CR-AHTYP               TO CM-AH-BENEFIT-CD.
  6098     MOVE CR-AH-TERM             TO CM-AH-ORIG-TERM.
  6099     MOVE CR-AHAMT               TO CM-AH-BENEFIT-AMT.
  6100     MOVE CR-AHPRM               TO CM-AH-PREMIUM-AMT.
  6101     MOVE CR-AHPRM-RATE          TO CM-AH-PREMIUM-RATE.
  6102     MOVE CR-DISAMT              TO CM-AH-ITD-AH-PMT.
  6103     MOVE '1'                    TO CM-PREMIUM-TYPE.
  6104
  6105     IF DTE-CLIENT NOT = 'DCC'
  6106        MOVE ZERO                TO CM-LIVES
  6107     END-IF
  6108     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  6109     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  6110
  6111 2830-LF-OB-ADJUST.
  6112
  6113******************************************************************
  6114****  SEARCH BENEFIT TABLE TO DETERMINE BENEFITS PREMIUM TYPE  ***
  6115******************************************************************
  6116
  6117     IF CM-LF-BENEFIT-CD EQUAL ZERO
  6118        GO TO 2830-AH-OB-ADJUST.
  6119
  6120     IF CLAS-INDEXL GREATER CLAS-MAXL
  6121         GO TO 2830-AH-OB-ADJUST.
  6122
  6123     IF CM-LF-BENEFIT-CD EQUAL CLAS-I-BEN (CLAS-INDEXL)
  6124         PERFORM  4100-REVIEW-LIFE     THRU 4100-LF-EXIT
  6125            GO TO 2830-AH-OB-ADJUST.
  6126
  6127     ADD +1                      TO CLAS-INDEXL.
  6128     GO TO 2830-LF-OB-ADJUST.
  6129
  6130 2830-AH-OB-ADJUST.
  6131
  6132******************************************************************
  6133****  SEARCH BENEFIT TABLE TO DETERMINE BENEFITS PREMIUM TYPE  ***
  6134******************************************************************
  6135
  6136     IF CM-AH-BENEFIT-CD EQUAL ZERO
  6137        GO TO 2830-OB-ADJUST-END.
  6138
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 128
* EL331.cbl
  6139     IF CLAS-INDEXA GREATER CLAS-MAXA
  6140         GO TO 2830-OB-ADJUST-END.
  6141
  6142     IF CM-AH-BENEFIT-CD EQUAL CLAS-I-BEN (CLAS-INDEXA)
  6143         PERFORM 4100-REVIEW-AH  THRU 4100-AH-EXIT
  6144            GO TO 2830-OB-ADJUST-END.
  6145
  6146     ADD +1                      TO CLAS-INDEXA.
  6147     GO TO 2830-AH-OB-ADJUST.
  6148
  6149 2830-OB-ADJUST-END.
  6150
  6151
  6152 2830-SUM-ADJUST-END.
  6153
  6154     IF CR-AH-LUMP-SUM-DISAB
  6155         MOVE CR-DTHAMT         TO CM-AH-ITD-LUMP-PMT
  6156     ELSE
  6157         MOVE ZEROS             TO CM-AH-ITD-LUMP-PMT.
  6158
  6159     MOVE 'L'                   TO DC-OPTION-CODE.
  6160     MOVE LOW-VALUE             TO CM-AH-PAID-THRU-DT.
  6161     MOVE CR-DIS-PTO-DT         TO DC-GREG-DATE-CYMD.
  6162
  6163     IF CR-DIS-PTO-DT NOT EQUAL ZERO
  6164         PERFORM 7100-DATE-RTN THRU 7100-EXIT
  6165         IF NO-CONVERSION-ERROR
  6166            MOVE DC-BIN-DATE-1  TO CM-AH-PAID-THRU-DT.
  6167
  6168     MOVE LOW-VALUE             TO CM-AH-CANCEL-DT
  6169                                   CM-LF-CANCEL-DT.
  6170
  6171     MOVE 'L'                   TO DC-OPTION-CODE.
  6172     MOVE CR-LF-CANC-DT         TO DC-GREG-DATE-CYMD.
  6173
  6174     IF CR-LF-CANC-DT NOT EQUAL ZERO
  6175         PERFORM 7100-DATE-RTN  THRU   7100-EXIT
  6176         IF NO-CONVERSION-ERROR
  6177            MOVE DC-BIN-DATE-1   TO CM-LF-CANCEL-DT.
  6178
  6179     MOVE 'L'                    TO DC-OPTION-CODE.
  6180     MOVE CR-AH-CANC-DT          TO DC-GREG-DATE-CYMD.
  6181
  6182     IF CR-AH-CANC-DT NOT EQUAL ZERO
  6183         PERFORM 7100-DATE-RTN  THRU   7100-EXIT
  6184         IF NO-CONVERSION-ERROR
  6185            MOVE DC-BIN-DATE-1   TO CM-AH-CANCEL-DT.
  6186
  6187     MOVE LOW-VALUE              TO CM-AH-SETTLEMENT-DT.
  6188
  6189     IF CR-AH-LUMP-SUM-DISAB   OR
  6190        CR-AH-STATUS-AT-CANCEL EQUAL 6
  6191          IF CR-DIS-DT NOT EQUAL ZERO
  6192             MOVE CR-DIS-DT      TO DC-GREG-DATE-CYMD
  6193             MOVE 'L'            TO DC-OPTION-CODE
  6194             PERFORM 7100-DATE-RTN  THRU   7100-EXIT
  6195              IF NO-CONVERSION-ERROR
  6196                  MOVE DC-BIN-DATE-1 TO CM-AH-SETTLEMENT-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 129
* EL331.cbl
  6197
  6198     MOVE CR-ENTRY-STATUS        TO CM-ENTRY-STATUS.
  6199
  6200     MOVE CR-LF-CURRENT-STATUS   TO  CM-LF-CURRENT-STATUS.
  6201     MOVE CR-LF-STATUS-AT-DEATH  TO  CM-LF-STATUS-AT-DEATH.
  6202     MOVE CR-LF-STATUS-AT-CANCEL TO  CM-LF-STATUS-AT-CANCEL.
  6203
  6204     MOVE CR-AH-CURRENT-STATUS   TO CM-AH-CURRENT-STATUS.
  6205     MOVE CR-AH-STATUS-AT-SETTLEMENT
  6206                                 TO CM-AH-STATUS-AT-SETTLEMENT.
  6207     MOVE CR-AH-STATUS-AT-CANCEL TO CM-AH-STATUS-AT-CANCEL.
  6208
  6209     MOVE 'L'                    TO DC-OPTION-CODE.
  6210     MOVE LOW-VALUES             TO CM-LF-DEATH-DT.
  6211     MOVE CR-DTH-DT              TO DC-GREG-DATE-CYMD.
  6212     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6213     IF NO-CONVERSION-ERROR
  6214         MOVE DC-BIN-DATE-1      TO CM-LF-DEATH-DT
  6215     ELSE
  6216         MOVE LOW-VALUES         TO CM-LF-DEATH-DT.
  6217
  6218     IF CR-LF-EXPIRE-DATE NOT NUMERIC
  6219         MOVE ZERO               TO CR-LF-EXPIRE-DATE.
  6220
  6221     MOVE 'L'                    TO DC-OPTION-CODE.
  6222     MOVE CR-LF-EXPIRE-DATE      TO DC-GREG-DATE-CYMD.
  6223
  6224     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6225     IF NO-CONVERSION-ERROR
  6226         MOVE DC-BIN-DATE-1      TO CM-LF-LOAN-EXPIRE-DT
  6227     ELSE
  6228         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
  6229
  6230     IF CR-AH-EXPIRE-DATE NOT NUMERIC
  6231         MOVE ZERO               TO CR-AH-EXPIRE-DATE.
  6232
  6233     MOVE 'L'                    TO DC-OPTION-CODE.
  6234     MOVE CR-AH-EXPIRE-DATE      TO DC-GREG-DATE-CYMD
  6235     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6236     IF NO-CONVERSION-ERROR
  6237         MOVE DC-BIN-DATE-1      TO CM-AH-LOAN-EXPIRE-DT
  6238     ELSE
  6239         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
  6240
  6241     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  6242         MOVE ZERO               TO CR-LOAN-1ST-PMT-DT.
  6243
  6244     MOVE '3'                    TO DC-OPTION-CODE.
  6245     MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD.
  6246     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6247     IF NO-CONVERSION-ERROR
  6248         MOVE DC-BIN-DATE-1      TO CM-LOAN-1ST-PMT-DT
  6249     ELSE
  6250         MOVE LOW-VALUES         TO CM-LOAN-1ST-PMT-DT.
  6251
  6252     MOVE CR-LAST-ADD-ON-DT      TO CM-LAST-ADD-ON-DT.
  6253
  6254     MOVE 'L'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 130
* EL331.cbl
  6255     MOVE CR-ENTRY-DATE          TO DC-GREG-DATE-CYMD.
  6256     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6257     IF NO-CONVERSION-ERROR
  6258         MOVE DC-BIN-DATE-1      TO CM-ENTRY-DT
  6259     ELSE
  6260         MOVE LOW-VALUES         TO CM-ENTRY-DT.
  6261
  6262     IF CR-LF-CANCEL-EXIT-DATE NOT EQUAL ZEROS
  6263         MOVE CR-LF-CANCEL-EXIT-DATE TO DC-GREG-DATE-CYMD
  6264         MOVE  'L'                   TO DC-OPTION-CODE
  6265         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6266         IF NO-CONVERSION-ERROR
  6267             MOVE DC-BIN-DATE-1      TO CM-LF-CANCEL-EXIT-DT.
  6268
  6269     IF CR-AH-CANCEL-EXIT-DATE NOT EQUAL ZEROS
  6270         MOVE CR-AH-CANCEL-EXIT-DATE TO DC-GREG-DATE-CYMD
  6271         MOVE  'L'                   TO DC-OPTION-CODE
  6272         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6273         IF NO-CONVERSION-ERROR
  6274             MOVE DC-BIN-DATE-1      TO CM-AH-CANCEL-EXIT-DT.
  6275
  6276     IF CR-LF-CLAIM-EXIT-DATE NOT EQUAL ZEROS
  6277         MOVE CR-LF-CLAIM-EXIT-DATE  TO DC-GREG-DATE-CYMD
  6278         MOVE  'L'                  TO DC-OPTION-CODE
  6279         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6280         IF NO-CONVERSION-ERROR
  6281             MOVE DC-BIN-DATE-1     TO CM-LF-DEATH-EXIT-DT.
  6282
  6283     IF CR-AH-SETTLEMENT-EXIT-DATE NOT EQUAL ZEROS
  6284         MOVE CR-AH-SETTLEMENT-EXIT-DATE TO DC-GREG-DATE-CYMD
  6285         MOVE  'L'                  TO DC-OPTION-CODE
  6286         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6287         IF NO-CONVERSION-ERROR
  6288             MOVE DC-BIN-DATE-1     TO CM-AH-SETTLEMENT-EXIT-DT.
  6289
  6290 2830-EXIT.
  6291      EXIT.
  6292
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 131
* EL331.cbl
  6294 4000-EXPIRE-DATE.
  6295
  6296     IF CM-PREMIUM-TYPE  EQUAL '1'
  6297         GO TO 4099-EXIT.
  6298
  6299     IF CM-LF-ORIG-TERM  NOT NUMERIC
  6300         GO TO 4020-CHECK-AH.
  6301
  6302     IF CM-LF-ORIG-TERM  GREATER  +1
  6303         NEXT SENTENCE
  6304     ELSE
  6305         GO TO 4020-CHECK-AH.
  6306
  6307     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6308     MOVE CM-LF-ORIG-TERM        TO  DC-ELAPSED-MONTHS.
  6309     MOVE ZEROS                  TO  DC-ODD-DAYS-OVER.
  6310     MOVE ZEROS                  TO  DC-ELAPSED-DAYS.
  6311     MOVE '6'                    TO  DC-OPTION-CODE.
  6312
  6313     PERFORM 7100-DATE-RTN  THRU  7100-EXIT.
  6314
  6315     IF NO-CONVERSION-ERROR
  6316         MOVE DC-BIN-DATE-2      TO  CM-LF-LOAN-EXPIRE-DT
  6317     ELSE
  6318         MOVE LOW-VALUES         TO  CM-LF-LOAN-EXPIRE-DT.
  6319
  6320 4020-CHECK-AH.
  6321
  6322     IF CM-AH-ORIG-TERM  NOT NUMERIC
  6323         GO TO 4099-EXIT.
  6324
  6325     IF CM-AH-ORIG-TERM  GREATER  +1
  6326         NEXT SENTENCE
  6327     ELSE
  6328         GO TO 4099-EXIT.
  6329
  6330     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6331     MOVE CM-AH-ORIG-TERM        TO  DC-ELAPSED-MONTHS.
  6332     MOVE ZEROS                  TO  DC-ODD-DAYS-OVER.
  6333     MOVE ZEROS                  TO  DC-ELAPSED-DAYS.
  6334     MOVE '6'                    TO  DC-OPTION-CODE.
  6335
  6336     PERFORM 7100-DATE-RTN  THRU  7100-EXIT.
  6337
  6338     IF NO-CONVERSION-ERROR
  6339         MOVE DC-BIN-DATE-2      TO  CM-AH-LOAN-EXPIRE-DT
  6340     ELSE
  6341         MOVE LOW-VALUES         TO  CM-AH-LOAN-EXPIRE-DT.
  6342
  6343 4099-EXIT.
  6344     EXIT.
  6345******************************************************************
  6346****  SEARCH BENEFIT TABLE TO DETERMINE IF SUMMARY COVERAGE    ***
  6347******************************************************************
  6348
  6349 4100-REVIEW-LIFE.
  6350
  6351     IF CLAS-I-BAL (CLAS-INDEXL) EQUAL 'B'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 132
* EL331.cbl
  6352        MOVE '2'                 TO CM-PREMIUM-TYPE
  6353        GO TO 4100-LF-EXIT.
  6354
  6355     IF ((CR-LFTYP NOT EQUAL ZERO) AND
  6356         (CLAS-I-BAL (CLAS-INDEXL) EQUAL 'Z'))
  6357         NEXT SENTENCE
  6358      ELSE
  6359         GO TO 4100-LF-EXIT.
  6360
  6361     IF CR-LIVES NOT NUMERIC
  6362         MOVE ZERO               TO CR-LIVES.
  6363     IF CR-SUM-CAN-CNT-ITD NOT NUMERIC
  6364         MOVE ZERO               TO CR-SUM-CAN-CNT-ITD.
  6365
  6366     COMPUTE CM-LIVES EQUAL
  6367           CR-LIVES - CR-SUM-CAN-CNT-ITD.
  6368
  6369 4100-LF-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 133
* EL331.cbl
  6371 4100-REVIEW-AH.
  6372     IF CLAS-I-BAL (CLAS-INDEXA) EQUAL 'B'
  6373        MOVE '2'             TO CM-PREMIUM-TYPE
  6374        GO TO 4100-AH-EXIT.
  6375
  6376     IF ((CR-AHTYP NOT EQUAL ZERO) AND
  6377         (CLAS-I-BAL (CLAS-INDEXA) EQUAL 'Z'))
  6378         NEXT SENTENCE
  6379      ELSE
  6380         GO TO 4100-AH-EXIT.
  6381
  6382     IF CR-LIVES NOT NUMERIC
  6383         MOVE ZERO               TO CR-LIVES.
  6384     IF CR-SUM-CAN-CNT-ITD NOT NUMERIC
  6385         MOVE ZERO               TO CR-SUM-CAN-CNT-ITD.
  6386
  6387     COMPUTE CM-LIVES EQUAL
  6388           CR-LIVES - CR-SUM-CAN-CNT-ITD.
  6389
  6390 4100-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 134
* EL331.cbl
  6393****************************************************************
  6394*  7000-INITIALIZE                                             *
  6395****************************************************************
  6396*                                                              *
  6397*  1) IF CLASIC CLAIMS SYSTEM PRESENT   OPEN INPUT (ELMSTR5)   *
  6398*     ALTERNATE PATH (5) OF CLAIM MASTER FILE ACCESSED THRU    *
  6399*     CL-CONTROL-BY-CERT-NO.                                   *
  6400*                                                              *
  6401*  1A) IF CLASIC CLAIMS SYSTEM PRESENT  OPEN INPUT (ELRETR5)   *
  6402*     ALTERNATE PATH (5) OF RETRIEVE MSTR FILE ACCESSED THRU   *
  6403*     RL-CONTROL-BY-CERT-NO.                                   *
  6404*                                                              *
  6405*  2) OPEN I/O (ELCERTF)   ONLINE CERTIFICATE MASTER FILE      *
  6406*     ACCESSED THRU CM-CONTROL-PRIMARY AND ISSUE START TO SET  *
  6407*     VSAM POINTER.                                            *
  6408*                                                              *
  6409*  3) OPEN I/O (ERMAIL)   CERTIFICATE MASTER NAME AND ADDRESS  *
  6410*     FILE ACCESSED THRU MA-CONTROL-PRIMARY.                   *
  6411*                                                              *
  6412*  4) OPEN INPUT (ECSCRT01)   BATCH CERTIFICATE MASTER FILE.   *
  6413*                                                              *
  6414*  5) OPEN OUTPUT (PRNTR)   PRINT FILE.                        *
  6415*                                                              *
  6416*  6) OPEN INPUT (ERACCT)   ACCOUNT MASTER FILE ACCESSED THRU  *
  6417*     AM-CONTROL-PRIMARY AND ISSUE START TO SET VSAM POINTER.  *
  6418*                                                              *
  6419*  7) OPEN I/O (ERCOMM)   CERTIFICATE MASTER COMMISSION STRUC- *
  6420*     TURE ACCESSED THRU CE-CONTROL-PRIMARY. THE COMMISSION    *
  6421*     STRUCTURE OF THE CERTIFICATE VARIES FROM THE COMMISSION  *
  6422*     STRUCTURE FOR THE ASSOCIATED ACCOUNT MASTER.             *
  6423*                                                              *
  6424****************************************************************
  6425
  6426 7000-INITIALIZE.
  6427
  6428     IF DTE-SYS-E-CLASIC-CLAIMS EQUAL 'Y'
  6429         OPEN INPUT  ELMSTR5
  6430         IF (CL-STAT-1  NOT EQUAL '0') AND
  6431            (CL-STATUS NOT EQUAL '97')
  6432             MOVE 'ERROR OCCURED OPEN - ELMSTR'
  6433                                 TO  WS-ABEND-MESSAGE
  6434             MOVE CL-STATUS      TO  WS-ABEND-FILE-STATUS
  6435             GO TO ABEND-PGM
  6436         END-IF
  6437         OPEN INPUT  ELRETR5
  6438         IF ELRETR5-FILE-STATUS NOT = '00' AND '97'
  6439             MOVE 'ERROR OCCURRED OPEN - ELRETR'
  6440                                      TO WS-ABEND-MESSAGE
  6441             MOVE ELRETR5-FILE-STATUS TO WS-ABEND-FILE-STATUS
  6442             GO TO ABEND-PGM.
  6443
  6444     OPEN I-O    ELCERTF.
  6445
  6446     IF (CM-STAT-1  NOT EQUAL '0') AND
  6447        (CM-STATUS NOT EQUAL '97')
  6448         MOVE 'ERROR OCCURED OPEN - ELCERT'
  6449                                TO  WS-ABEND-MESSAGE
  6450         MOVE CM-STATUS         TO  WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 135
* EL331.cbl
  6451         GO TO ABEND-PGM.
  6452
  6453     MOVE LOW-VALUE             TO CM-CONTROL-PRIMARY.
  6454     MOVE DTE-CLASIC-COMPANY-CD TO CM-COMPANY-CD.
  6455
  6456     START ELCERTF
  6457            KEY NOT LESS CM-CONTROL-PRIMARY.
  6458
  6459     IF CM-STAT-1  NOT EQUAL '0'
  6460         MOVE 'ERROR OCCURED START - ELCERT'
  6461                                 TO  WS-ABEND-MESSAGE
  6462         MOVE CM-STATUS      TO  WS-ABEND-FILE-STATUS
  6463         GO TO ABEND-PGM.
  6464
  6465     OPEN I-O ERMAIL.
  6466
  6467     IF (CFS-STAT-1  NOT EQUAL '0') AND
  6468        (ERMAIL-FILE-STATUS NOT EQUAL '97')
  6469         MOVE 'ERROR OCCURED OPEN - ERMAIL'
  6470                                  TO  WS-ABEND-MESSAGE
  6471         MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  6472         GO TO ABEND-PGM.
  6473
  6474     OPEN INPUT ECSCRT01
  6475                ERCTBL.
  6476
  6477     IF ERCTBL-FILE-STATUS NOT = '00' AND '97'
  6478         MOVE 'ERROR OCCURED OPEN - ERCTBL'
  6479                                  TO  WS-ABEND-MESSAGE
  6480         MOVE ERCTBL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  6481         GO TO ABEND-PGM.
  6482
  6483     OPEN OUTPUT PRNTR
  6484                 ME50-EL331-BALANCE
  6485                 DISPLAY-PRT.
  6486
  6487     MOVE 1  TO WS-PAGE-CNT.
  6488
  6489     MOVE WS-CURRENT-DATE TO DIS-DATE.
  6490
  6491     PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
  6492
  6493     MOVE LOW-VALUES TO WS-SAVED-ECS-KEY
  6494                        WS-SAVED-ONL-KEY
  6495                        WS-CLAIM-MATCH-KEY
  6496                        WS-SEC-CLAIM-INDEX.
  6497
  6498     MOVE WS-CURRENT-DATE TO HD-RUN-DATE.
  6499
  6500     MOVE WS-CD-MM        TO WS-CURR-MO.
  6501     MOVE WS-CD-DD        TO WS-CURR-DA.
  6502     MOVE WS-CD-YY        TO WS-CURR-YR.
  6503
  6504     COMPUTE WS-CURRENT-MOS EQUAL (RUN-CCYY * 12) + RUN-MO.
  6505
  6506     MOVE ALPH-DATE     TO HD-DATE-FULL.
  6507     MOVE COMPANY-NAME  TO HD-COMP-NM.
  6508
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 136
* EL331.cbl
  6509     PERFORM 7500-HEADING-RTN  THRU 7500-EXIT.
  6510
  6511     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  6512        DTE-SYS-G-AR-USED     EQUAL '1'
  6513          NEXT SENTENCE
  6514     ELSE
  6515         GO TO 7000-EXIT.
  6516
  6517     OPEN INPUT ERACCT.
  6518
  6519     IF (AM-STAT-1  NOT EQUAL '0') AND
  6520        (AM-STATUSF NOT EQUAL '97')
  6521         MOVE 'ERROR OCCURED OPEN - ERACCT'
  6522                             TO  WS-ABEND-MESSAGE
  6523         MOVE AM-STATUSF     TO  WS-ABEND-FILE-STATUS
  6524         GO TO ABEND-PGM.
  6525
  6526     MOVE LOW-VALUES            TO AM-CONTROL-PRIMARY.
  6527     MOVE DTE-CLASIC-COMPANY-CD TO AM-COMPANY-CD.
  6528     START ERACCT
  6529            KEY NOT LESS AM-CONTROL-PRIMARY.
  6530
  6531     IF AM-STAT-1  NOT EQUAL '0'
  6532         MOVE 'ERROR OCCURED START - ERACCT'
  6533                                 TO  WS-ABEND-MESSAGE
  6534         MOVE AM-STATUSF     TO  WS-ABEND-FILE-STATUS
  6535         GO TO ABEND-PGM.
  6536
  6537     OPEN I-O ERCOMM.
  6538
  6539     IF (CE-STAT-1  NOT EQUAL '0') AND
  6540        (CE-STATUS NOT EQUAL '97')
  6541         MOVE 'ERROR OCCURED OPEN - ERCOMM'
  6542                                 TO  WS-ABEND-MESSAGE
  6543         MOVE CE-STATUS          TO  WS-ABEND-FILE-STATUS
  6544         GO TO ABEND-PGM.
  6545
  6546 7000-EXIT.
  6547      EXIT.
  6548
  6549 7100-DATE-RTN.
  6550     CALL 'ELDATCX'  USING DATE-CONVERSION-DATA.
  6551
  6552     IF DC-ERROR-CODE NOT EQUAL SPACE
  6553         MOVE  ZEROS             TO DC-CONVERSION-DATES.
  6554
  6555 7100-EXIT.
  6556      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 137
* EL331.cbl
  6558 7300-BLD-ECS-PRT-LINE.
  6559     MOVE CR-CERT-NO             TO DTL-CERT-NO.
  6560     MOVE CR-YR                  TO DTL-EFF-YR.
  6561     MOVE CR-MO                  TO DTL-EFF-MO.
  6562     MOVE CR-DA                  TO DTL-EFF-DA.
  6563     MOVE CR-CARRIER             TO DTL-CARR.
  6564     MOVE CR-GROUPING            TO DTL-GRPG.
  6565     MOVE CR-STATE               TO DTL-STAT.
  6566     MOVE CR-ACCOUNT             TO DTL-ACCT.
  6567     MOVE 'X'                    TO WS-PRT-FULL-LINE-SW.
  6568
  6569 7300-EXIT.
  6570      EXIT.
  6571
  6572 7320-BLD-ONL-PRT-LINE.
  6573     MOVE CM-CERT-NO             TO DTL-CERT-NO.
  6574
  6575     MOVE ' '                    TO DC-OPTION-CODE.
  6576     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
  6577     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6578     MOVE DC-GREG-DATE-1-EDIT    TO DTL-EFFECTIVE-DT.
  6579     MOVE CM-CARRIER             TO DTL-CARR.
  6580     MOVE CM-GROUPING            TO DTL-GRPG.
  6581     MOVE CM-STATE               TO DTL-STAT.
  6582     MOVE CM-ACCOUNT             TO DTL-ACCT.
  6583
  6584 7320-EXIT.
  6585      EXIT.
  6586
  6587 7350-BLD-CLM-INFO.
  6588     IF NO-ASSOCIATED-CLAIM
  6589        MOVE SPACES              TO  DTL-CL-NO
  6590                                     DTL-CL-TYPE
  6591                                     DTL-CL-STATUS
  6592                                     DTL-CL-LN-KIND
  6593                                     DTL-CL-INCURRED
  6594                                     DTL-CL-PROCESSOR
  6595        GO TO 7350-EXIT.
  6596
  6597     MOVE SPACES                 TO  DTL-CL-TYPE
  6598                                     DTL-CL-STATUS
  6599                                     DTL-CL-LN-KIND.
  6600
  6601     MOVE CL-CLAIM-NO            TO DTL-CL-NO.
  6602
  6603     IF CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1
  6604         MOVE LIFE-OVERRIDE-L2   TO DTL-CL-TYPE
  6605      ELSE
  6606        IF CL-CLAIM-TYPE EQUAL AH-OVERRIDE-L1
  6607             MOVE AH-OVERRIDE-L2 TO DTL-CL-TYPE.
  6608
  6609     IF CLAIM-IS-OPEN
  6610        MOVE ' OPEN '            TO DTL-CL-STATUS
  6611      ELSE
  6612        IF CLAIM-IS-CLOSED
  6613            MOVE 'CLOSED'        TO DTL-CL-STATUS.
  6614
  6615     IF SINGLE-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 138
* EL331.cbl
  6616        MOVE 'SNG PRM'           TO DTL-CL-LN-KIND
  6617       ELSE
  6618        IF O-B-COVERAGE
  6619            MOVE '  O.B. '       TO DTL-CL-LN-KIND
  6620         ELSE
  6621          IF OPEN-END-COVERAGE
  6622              MOVE 'OPN END'     TO DTL-CL-LN-KIND.
  6623
  6624     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  6625     MOVE ' '                    TO DC-OPTION-CODE.
  6626     PERFORM 7100-DATE-RTN   THRU 7100-EXIT.
  6627     MOVE DC-GREG-DATE-1-EDIT    TO DTL-CL-INCURRED.
  6628     MOVE CL-PROCESSOR-ID        TO DTL-CL-PROCESSOR.
  6629
  6630 7350-EXIT.
  6631      EXIT.
  6632
  6633 7370-PRINT-DETAIL.
  6634     MOVE DTL-1                  TO P-DATA.
  6635     MOVE '0'                    TO X.
  6636     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6637     ADD  2                      TO WS-LINE-CNT.
  6638
  6639     IF WS-LINE-CNT GREATER WS-MAX-LINES
  6640          PERFORM 7500-HEADING-RTN  THRU 7500-EXIT.
  6641
  6642     MOVE SPACES                 TO DTL-1.
  6643
  6644 7370-EXIT.
  6645      EXIT.
  6646
  6647 7500-HEADING-RTN.
  6648     MOVE  WS-PAGE-CNT           TO HD-PAGE-NO.
  6649     MOVE '1'                    TO X.
  6650     MOVE HEADING-1              TO P-DATA.
  6651     PERFORM 7600-PRT-RTN   THRU 7600-EXIT.
  6652
  6653     MOVE SPACES                 TO X.
  6654     MOVE HEADING-2              TO P-DATA.
  6655     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6656
  6657     MOVE SPACES                 TO X.
  6658     MOVE HEADING-3              TO P-DATA.
  6659     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6660
  6661     MOVE SPACES                 TO X.
  6662     MOVE HEADING-4              TO P-DATA.
  6663     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6664
  6665     MOVE SPACES                 TO  X.
  6666     MOVE HEADING-5              TO P-DATA.
  6667     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6668
  6669     MOVE SPACES                 TO  X.
  6670     MOVE HEADING-6              TO P-DATA.
  6671     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6672
  6673     MOVE 16                     TO WS-LINE-CNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 139
* EL331.cbl
  6674     ADD 1 TO WS-PAGE-CNT.
  6675
  6676 7500-EXIT.
  6677      EXIT.
  6678
  6679 7600-PRT-RTN.
*                                      COPY ELCPRT2X.
  6680******************************************************************04/15/98
  6681*                                                                *ELCPRT2X
  6682*                                                                *ELCPRT2X
  6683*                            ELCPRT2X.                           *   LV002
  6684*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6685*                            VMOD=2.002                          *   CL**2
  6686*                                                                *ELCPRT2X
  6687*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
  6688*                                                                *ELCPRT2X
  6689*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
  6690*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
  6691*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
  6692*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
  6693*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
  6694*                                                                *ELCPRT2X
  6695*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
  6696*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
  6697******************************************************************ELCPRT2X
  6698                                                                  ELCPRT2X
  6699     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
  6700         FICH-OPEN   = SPACE                                      ELCPRT2X
  6701         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
  6702         OPEN OUTPUT FICH.                                        ELCPRT2X
  6703                                                                  ELCPRT2X
  6704     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
  6705         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
  6706             OPEN I-O ELREPT                                      ELCPRT2X
  6707             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
  6708                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
  6709                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
  6710                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
  6711                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
  6712                 GO TO ABEND-PGM                                  ELCPRT2X
  6713             ELSE                                                 ELCPRT2X
  6714                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
  6715                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  6716                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
  6717                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  6718                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
  6719                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
  6720                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
  6721                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  6722                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
  6723                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  6724                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
  6725                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
  6726                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
  6727                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  6728                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
  6729                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  6730                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 140
* EL331.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
  6731                                                                  ELCPRT2X
  6732     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
  6733        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
  6734         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
  6735         GO TO ABEND-PGM.                                         ELCPRT2X
  6736                                                                  ELCPRT2X
  6737     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
  6738         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
  6739         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
  6740             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
  6741                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
  6742                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
  6743                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
  6744                     INVALID KEY                                  ELCPRT2X
  6745                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
  6746                         CLOSE ELREPT                             ELCPRT2X
  6747                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
  6748                                                                  ELCPRT2X
  6749     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
  6750         MOVE X                      TO  P-CTL                    ELCPRT2X
  6751         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
  6752                                                                  ELCPRT2X
  6753     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
  6754       MOVE X                        TO  P-CTL                    ELCPRT2X
  6755       IF P-CTL = ' '                                             ELCPRT2X
  6756         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
  6757       ELSE                                                       ELCPRT2X
  6758         IF P-CTL = '0'                                           ELCPRT2X
  6759           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
  6760         ELSE                                                     ELCPRT2X
  6761           IF P-CTL = '-'                                         ELCPRT2X
  6762             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
  6763           ELSE                                                   ELCPRT2X
  6764             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
  6765                                                                  ELCPRT2X
  6766     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
  6767                                                                  ELCPRT2X
  6768 DTE-REPORT-DELETE.                                               ELCPRT2X
  6769     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
  6770         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
  6771         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
  6772                                                                  ELCPRT2X
  6773     READ ELREPT   NEXT RECORD                                    ELCPRT2X
  6774           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
  6775                                                                  ELCPRT2X
  6776     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
  6777        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
  6778         DELETE ELREPT RECORD                                     ELCPRT2X
  6779         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
  6780                                                                  ELCPRT2X
  6781 DTE-DELETE-EXIT.                                                 ELCPRT2X
  6782     EXIT.                                                        ELCPRT2X
  6783                                                                  ELCPRT2X
  6784 DTE-PRINT-EXIT.                                                  ELCPRT2X
  6785     EXIT.                                                        ELCPRT2X
  6786******************************************************************ELCPRT2X
  6787 7600-PRT-CLEAR.
  6788     MOVE SPACES                 TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 141
* EL331.cbl
  6789     MOVE SPACES                 TO DTL-1.
  6790
  6791 7600-EXIT.
  6792      EXIT.
  6793
  6794 8000-FINALIZE.
  6795
  6796     DISPLAY ' '.
  6797     DISPLAY '* * * * * * * * * * * * * * * * * *'.
  6798     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
  6799     DISPLAY '* * * * * * * * * * * * * * * * * *'.
  6800     DISPLAY ' '.
  6801
  6802     PERFORM 8600-DISPLAY-HD  THRU
  6803               8600-HD-EXIT.
  6804
  6805     MOVE ' DISPLAY ERROR COUNT = '    TO DIS-LINE-REASON
  6806     MOVE ERROR-COUNT                TO  DIS-LINE-REC
  6807     PERFORM 8600-DISPLAY-PRT THRU
  6808               8600-DISPLAY-EXIT.
  6809
  6810     CLOSE  DISPLAY-PRT.
  6811
  6812
  6813     MOVE ALL '*'                TO  P-DATA.
  6814     PERFORM  7600-PRT-RTN   THRU 7600-EXIT.
  6815
  6816     MOVE WS-MATCHED-ONL         TO  P-MATCHED-ONL.
  6817     MOVE WS-LOADED-ECS          TO  P-LOADED-ECS.
  6818     MOVE WS-ONL-DELETED         TO  P-ONL-DELETED.
  6819     MOVE WS-CLAIM-MATCH         TO  P-CLAIM-MATCH.
  6820     MOVE WS-INACTIVE-CERTS      TO  P-INACTIVE-CERTS.
  6821     MOVE WS-ECS-READ            TO  P-ECS-READ.
  6822
  6823     MOVE WS-ECS-READ            TO  WS-ME50-BAL-AMT-LOW.
  6824     MOVE WS-ECS-READ            TO  WS-ME50-BAL-AMT-HIGH.
  6825     MOVE WS-BAL50-DESCRIPTION   TO WS-ME50-BAL-DESCRIP.
  6826     WRITE ME50-EL331-BALANCE-REC FROM WS-ME50-BALANCE-REC.
  6827
  6828     MOVE WS-ONL-READ            TO  P-ONL-READ.
  6829     MOVE WS-EXCP-ADD            TO  P-EXCP-ADD.
  6830     MOVE WS-EXCP-DEL            TO  P-EXCP-DEL.
  6831     MOVE WS-EXCP-TBL            TO  P-EXCP-TBL.
  6832     MOVE WS-MAIL-DEL            TO  P-MAIL-DEL.
  6833     MOVE WS-ACCT-READS          TO  P-ACCT-READS.
  6834     MOVE WS-ACT-READ            TO  P-ACT-READ.
  6835     MOVE WS-ACCT-MATCH          TO  P-ACCT-MATCH.
  6836
  6837     COMPUTE WS-ONL-EXIST EQUAL
  6838             WS-ONL-READ - WS-ONL-DELETED + WS-LOADED-ECS.
  6839
  6840     MOVE  WS-ONL-EXIST          TO  P-ONL-EXIST.
  6841
  6842     MOVE '0'                    TO X.
  6843     MOVE FTG-1                  TO P-DATA.
  6844     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6845
  6846     MOVE '0'                    TO X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 142
* EL331.cbl
  6847     MOVE FTG-2                  TO P-DATA.
  6848     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6849
  6850     MOVE '0'                    TO X.
  6851     MOVE FTG-3                  TO P-DATA.
  6852     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6853
  6854     MOVE '0'                    TO X.
  6855     MOVE FTG-4                  TO P-DATA.
  6856     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6857
  6858     MOVE '0'                    TO X.
  6859     MOVE FTG-5                  TO P-DATA.
  6860     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6861
  6862     MOVE '0'                    TO X.
  6863     MOVE FTG-6                  TO P-DATA.
  6864     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6865
  6866     MOVE '0'                     TO X.
  6867     MOVE FTG-7                   TO P-DATA.
  6868     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6869
  6870     MOVE '0'                    TO X.
  6871     MOVE FTG-8                  TO P-DATA.
  6872     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6873
  6874     MOVE '0'                    TO X.
  6875     MOVE FTG-9                  TO P-DATA.
  6876     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6877
  6878     MOVE '0'                    TO X.
  6879     MOVE FTG-10                 TO P-DATA.
  6880     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6881
  6882     MOVE '0'                    TO X.
  6883     MOVE FTG-11                 TO P-DATA.
  6884     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6885
  6886     MOVE '0'                    TO X.
  6887     MOVE FTG-12                 TO P-DATA.
  6888     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6889
  6890     MOVE '0'                    TO X.
  6891     MOVE FTG-13                 TO P-DATA.
  6892     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6893
  6894     MOVE '0'                    TO X.
  6895     MOVE FTG-14                 TO P-DATA.
  6896     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6897
  6898     IF DTE-SYS-E-CLASIC-CLAIMS EQUAL 'Y'
  6899         CLOSE ELMSTR5
  6900         IF CL-STAT-1 NOT EQUAL ZERO
  6901             MOVE 'ERROR OCCURED OPEN - ELMSTR'
  6902                                 TO  WS-ABEND-MESSAGE
  6903             MOVE CL-STATUS      TO  WS-ABEND-FILE-STATUS
  6904             GO TO ABEND-PGM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 143
* EL331.cbl
  6905         END-IF
  6906         CLOSE ELRETR5
  6907         IF ELRETR5-FILE-STATUS NOT = ZERO
  6908             MOVE 'ERROR OCCURRED CLOSE - ELRETR'
  6909                                 TO  WS-ABEND-MESSAGE
  6910             MOVE ELRETR5-FILE-STATUS
  6911                                 TO  WS-ABEND-FILE-STATUS
  6912             GO TO ABEND-PGM.
  6913
  6914     CLOSE PRNTR
  6915           ME50-EL331-BALANCE
  6916           ECSCRT01
  6917           ELCERTF
  6918           ERCTBL.
  6919
  6920     IF CM-STAT-1  NOT EQUAL ZERO
  6921         MOVE 'ERROR OCCURED CLOSE - ELCERT'
  6922                                 TO  WS-ABEND-MESSAGE
  6923         MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  6924         GO TO ABEND-PGM.
  6925
  6926     CLOSE ERMAIL.
  6927
  6928     IF CFS-STAT-1 NOT EQUAL '0'
  6929         MOVE 'ERROR OCCURED CLOSE - ERMAIL'
  6930                                  TO  WS-ABEND-MESSAGE
  6931         MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  6932         GO TO ABEND-PGM.
  6933
  6934     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  6935        DTE-SYS-G-AR-USED     EQUAL '1'
  6936          NEXT SENTENCE
  6937     ELSE
  6938        GO TO 8000-CLOSE-OTHER.
  6939
  6940     CLOSE ERACCT.
  6941
  6942     IF AM-STAT-1  NOT EQUAL ZERO
  6943         MOVE 'ERROR OCCURED CLOSE - ERACCT'
  6944                             TO  WS-ABEND-MESSAGE
  6945         MOVE AM-STATUSF     TO  WS-ABEND-FILE-STATUS
  6946         GO TO ABEND-PGM.
  6947
  6948     CLOSE ERCOMM.
  6949
  6950     IF CE-STAT-1  NOT EQUAL ZERO
  6951         MOVE 'ERROR OCCURED CLOSE - ERCOMM'
  6952                             TO  WS-ABEND-MESSAGE
  6953         MOVE CE-STATUS      TO  WS-ABEND-FILE-STATUS
  6954         GO TO ABEND-PGM.
  6955
  6956 8000-CLOSE-OTHER.
*                               COPY ELCPRTCX.
  6957******************************************************************04/15/98
  6958*                                                                *ELCPRTCX
  6959*                                                                *ELCPRTCX
  6960*                            ELCPRTCX.                           *   LV003
  6961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 144
* EL331.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
  6962*                            VMOD=2.003                          *   CL**3
  6963*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
  6964*                                                                *ELCPRTCX
  6965* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  6966******************************************************************ELCPRTCX
  6967                                                                  ELCPRTCX
  6968      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
  6969          CLOSE FICH.                                             ELCPRTCX
  6970                                                                  ELCPRTCX
  6971      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
  6972          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
  6973          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
  6974          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
  6975          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
  6976          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
  6977          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
  6978          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
  6979          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
  6980              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  6981              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  6982              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  6983                  UPON CONSOLE                                    ELCPRTCX
  6984              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  6985                  UPON CONSOLE                                    ELCPRTCX
  6986            ELSE                                                  ELCPRTCX
  6987              DISPLAY '***************************************'   ELCPRTCX
  6988              DISPLAY '***************************************'   ELCPRTCX
  6989              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
  6990              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
  6991              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
  6992              DISPLAY '**                                   **'   ELCPRTCX
  6993              DISPLAY '***************************************'   ELCPRTCX
  6994              DISPLAY '***************************************'   ELCPRTCX
  6995              CLOSE ELREPT.                                       ELCPRTCX
  6996                                                                  ELCPRTCX
  6997      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
  6998          DISPLAY '***************************************'       ELCPRTCX
  6999          DISPLAY '***************************************'       ELCPRTCX
  7000          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  7001          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
  7002          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
  7003          DISPLAY '**                                   **'       ELCPRTCX
  7004          DISPLAY '***************************************'       ELCPRTCX
  7005          DISPLAY '***************************************'       ELCPRTCX
  7006          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  7007                                                                  ELCPRTCX
  7008      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
  7009          DISPLAY '***************************************'       ELCPRTCX
  7010          DISPLAY '***************************************'       ELCPRTCX
  7011          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  7012          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
  7013          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
  7014          DISPLAY '**                                   **'       ELCPRTCX
  7015          DISPLAY '***************************************'       ELCPRTCX
  7016          DISPLAY '***************************************'       ELCPRTCX
  7017          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  7018                                                                  ELCPRTCX
  7019                                                                  ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 145
* EL331.cbl
  7020******************************************************************ELCPRTCX
  7021
  7022 8000-EXIT.
  7023      EXIT.
  7024
  7025 8600-DIS-PRINT SECTION.
  7026
  7027 8600-DISPLAY-PRT.
  7028
  7029     IF  DIS-HEAD-SW =  'Y'
  7030       MOVE 'N' TO  DIS-HEAD-SW
  7031         PERFORM 8600-DISPLAY-HD THRU
  7032             8600-HD-EXIT
  7033           GO TO 8600-DISPLAY-EXIT.
  7034
  7035     IF  DIS-LINE-CNT GREATER THAN 59
  7036         PERFORM 8600-DISPLAY-HD THRU
  7037             8600-HD-EXIT.
  7038
  7039     MOVE   SPACES TO DIS-CC.
  7040     ADD +1 TO DIS-LINE-CNT.
  7041     WRITE  DISPLAY-REC FROM DISPLAY-LINE.
  7042     MOVE   SPACES TO DISPLAY-REC.
  7043     MOVE   SPACES TO DISPLAY-LINE.
  7044
  7045
  7046 8600-DISPLAY-EXIT.
  7047     EXIT.
  7048
  7049 8600-DIS-HEAD SECTION.
  7050
  7051 8600-DISPLAY-HD.
  7052
  7053     MOVE '1' TO  DISPLAY-CC.
  7054     MOVE ZEROS TO DIS-LINE-CNT.
  7055     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
  7056     ADD  +1  TO DIS-LINE-CNT.
  7057     MOVE ' ' TO  DISPLAY-CC.
  7058     MOVE   SPACES TO DISPLAY-REC.
  7059*    WRITE  DISPLAY-REC.
  7060     ADD +1 TO DIS-LINE-CNT.
  7061     WRITE  DISPLAY-REC FROM DISPLAY-HD-2.
  7062     ADD +1 TO DIS-LINE-CNT.
  7063     MOVE   SPACES TO DISPLAY-REC.
  7064     WRITE  DISPLAY-REC.
  7065
  7066
  7067
  7068 8600-HD-EXIT.
  7069     EXIT.
  7070 9999-PROGRAM-END.
  7071
  7072     GOBACK.
  7073
  7075 ABEND-PGM SECTION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 146
* EL331.cbl
*                         COPY ELCABEND.
  7076***************************************************************** 04/14/98
  7077*                                                               * ELCABEND
  7078*                            ELCABEND.                          *    LV003
  7079*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7080*                            VMOD 2.002                              CL**2
  7081*                                                               * ELCABEND
  7082*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  7083*            AND THEN ABENDS.                                   * ELCABEND
  7084*                                                               * ELCABEND
  7085*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  7086*                                                               * ELCABEND
  7087***************************************************************** ELCABEND
  7088*APS-010.                                                         ELCABEND
  7089     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  7090     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  7091                                                                  ELCABEND
  7092     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  7093         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  7094         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  7095                                 UPON CONSOLE.                    ELCABEND
  7096                                                                  ELCABEND
  7097     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  7098         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  7099         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  7100                                 UPON CONSOLE.                    ELCABEND
  7101                                                                  ELCABEND
  7102     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  7103     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  7104                                 UPON CONSOLE.                    ELCABEND
  7105                                                                  ELCABEND
  7106     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  7107     CALL 'ABORTME'.
  7108                                                                  ELCABEND
  7109 APS-EXIT.                                                        ELCABEND
  7110     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       63712     Code:       22038
