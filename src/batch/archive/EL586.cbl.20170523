       IDENTIFICATION DIVISION.

       PROGRAM-ID.                 EL586.


      *AUTHOR.     SUZAN VUKOV.
      *DATE-COMPILED.
      ******************************************************************
      *REMARKS.
      *        THIS PROGRAM CREATES THREE REPORTS:
      *            1) CLAIMS ACTIVITY BY AUDITOR (WITH SUMMARY)
      *            2) MONTH-TO-DATE CLAIM SERVICE TIME EXCEPTION
      *            3) CLAIMS SERVICE TIME DISTRIBUTION
      *
      *        THIS PROGRAM REPLACES MAINFRAME CULPRIT REPORTS
      *        CLACTAUD  CLACTPR  CLSTEXP  CLACTDIST
      *        PREVIOUSLY GENERATED BY JOB CICLDLY, PROGRAM CICLDLYC
      *
      *     INPUT:   MONTH-TO-DATE ELMSTR CREATED BY EL585
      *              ELTRLR
      ******************************************************************
      *                   C H A N G E   L O G
      *
      * CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
      *-----------------------------------------------------------------
      *  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
      * EFFECTIVE    NUMBER
      *-----------------------------------------------------------------
      * 110101    2001100100006  SMVA  INITIAL IMPL FOR UNIKIX
      *                                REWRITE OF MAINFRAME CULPRIT
122002* 122002    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
122002*                                AND DCC
093003* 093003                   SMVA  CHG REC TYPE FOR REOPENS FROM O TO X
121603* 121603    2003080800002  SMVA  ADD PROCESSING FOR NEW CLM TYP G
010704* 010704                   SMVA  ADD NO ACTIVITY MSG IF 0 TO REPORT
021706* 021706    2006013000002  AJRA  CHANGE 11-20 SPLIT TO 11-15,16-20
      ******************************************************************

       ENVIRONMENT DIVISION.

       INPUT-OUTPUT SECTION.

       FILE-CONTROL.
           SELECT DISK-DATE          ASSIGN TO SYS019-FBA1-S-SYS019.

           SELECT MTD-ELMSTR-INFILE  ASSIGN TO MTDCLMS
                                     ORGANIZATION IS LINE SEQUENTIAL.

           SELECT ELTRLR-INFILE      ASSIGN TO ELTRLR
                                     ORGANIZATION IS INDEXED
                                     ACCESS IS DYNAMIC
                                     RECORD KEY IS AT-CONTROL-PRIMARY
                                     FILE STATUS IS
                                       WS-ELTRLR-FILE-STATUS.

           SELECT PRNTR              ASSIGN TO SYS008-UR-1403-S-SYS008.

           SELECT SORT-FILE          ASSIGN TO SYS001-UT-3380-S-SORTWK1.

           SELECT SEQ-FILE-ARCHIVE   ASSIGN TO SYS020-UT-2400-S-SYS020.

           SELECT ELREPT             ASSIGN TO SYS018-FBA1-ELREPT
                                     ORGANIZATION IS INDEXED
                                     ACCESS IS DYNAMIC
                                     RECORD KEY IS RF-CONTROL-PRIMARY
                                     FILE STATUS IS DTE-VSAM-FLAGS.

       DATA DIVISION.

       FILE SECTION.

       FD  DISK-DATE
                                COPY ELCDTEFD.

       FD  MTD-ELMSTR-INFILE.
                                COPY ELCMSTR.

       FD  ELTRLR-INFILE.
                                COPY ELCTRLR.


       FD  PRNTR
                                COPY ELCPRTFD.


       SD  SORT-FILE.
       01  SORT-RECORD.
           05  SORT-CLAIM-TYPE             PIC X(01).
           05  SORT-AUDITOR                PIC X(04).
           05  SORT-MTD-OR-DAILY           PIC X(01).
           05  SORT-REC-TYPE               PIC X(01).
           05  SORT-HANDLE-TIME            PIC S9(07)V99.


      *********** OLD FICHE PROCESSING USED FOR SEQUENTIAL FILE ARCHIVE
      *               IF DTE-PRT-OPT = 'B'
       FD  SEQ-FILE-ARCHIVE
           BLOCK CONTAINS 0 RECORDS
           RECORDING MODE F.

       01  SEQ-ARCHIVE-REC                 PIC X(133).



       FD  ELREPT
                                COPY ELCRPTFD.
                                COPY ELCREPT.

       WORKING-STORAGE SECTION.
       01  LCP-ABND-CODE                   PIC S999 COMP   VALUE +519.

       77  FILLER  PIC X(32)   VALUE '********************************'.
       77  FILLER  PIC X(32)   VALUE '*     EL586  WORKING STORAGE   *'.
       77  FILLER  PIC X(32)   VALUE '********** V/M 2.008 ***********'.

       01  FILLER                          COMP-3.
           05  WS-LINE-COUNT               PIC S9(03)    VALUE +55.
           05  WS-LINE-COUNT-MAX           PIC S9(03)    VALUE +55.
           05  WS-PAGE                     PIC S9(05)    VALUE +0.
           05  WS-SORT-RET-CNT             PIC S9(05)    VALUE +0.
           05  WS-ACCEPTABLE-SVC-TIME      PIC S9(07)    VALUE +30.
           05  WS-MAX-SVC-TIME-FOR-AVG     PIC S9(07)    VALUE +61.


      ******* DAILY COUNT BUCKETS PER AUDITOR
122002     03  WS-DLY-COUNTS               COMP-3.
122002         05  WS-DLY-NEW-CLM-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-DLY-PD-CLM-CNT       PIC S9(05)    VALUE +0.
122002         05  WS-DLY-DRAFT-CNT        PIC S9(05)    VALUE +0.
122002         05  WS-DLY-VOID-CNT         PIC S9(05)    VALUE +0.
122002         05  WS-DLY-STOPPAY-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-DLY-LETTER-CNT       PIC S9(05)    VALUE +0.
122002         05  WS-DLY-CALLIN-CNT       PIC S9(05)    VALUE +0.
122002         05  WS-DLY-CALLOUT-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-DLY-NOTE-CNT         PIC S9(05)    VALUE +0.
122002         05  WS-DLY-DENIAL-CNT       PIC S9(05)    VALUE +0.
122002         05  WS-DLY-DROP-CNT         PIC S9(05)    VALUE +0.
122002         05  WS-DLY-REOPEN-CNT       PIC S9(05)    VALUE +0.

      ******* MONTH-TO-DATE COUNT BUCKETS PER AUDITOR
122002     03  WS-MTD-COUNTS               COMP-3.
122002         05  WS-MTD-NEW-CLM-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-MTD-PD-CLM-CNT       PIC S9(05)    VALUE +0.
122002         05  WS-MTD-DRAFT-CNT        PIC S9(05)    VALUE +0.
122002         05  WS-MTD-VOID-CNT         PIC S9(05)    VALUE +0.
122002         05  WS-MTD-STOPPAY-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-MTD-LETTER-CNT       PIC S9(05)    VALUE +0.
122002         05  WS-MTD-CALLIN-CNT       PIC S9(05)    VALUE +0.
122002         05  WS-MTD-CALLOUT-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-MTD-NOTE-CNT         PIC S9(05)    VALUE +0.
122002         05  WS-MTD-DENIAL-CNT       PIC S9(05)    VALUE +0.
122002         05  WS-MTD-DROP-CNT         PIC S9(05)    VALUE +0.
122002         05  WS-MTD-REOPEN-CNT       PIC S9(05)    VALUE +0.

122002******* TOTAL BUCKETS PER CLAIM TYPE
      ******* TOTD = DAILY TOTAL   TOTM = MONTH-TO-DATE TOTAL
       01  FILLER                          COMP-3.
122002     03  WS-TOTD-COUNTS              COMP-3.
122002         05  WS-TOTD-NEW-CLM-CNT     PIC S9(05)    VALUE +0.
122002         05  WS-TOTD-PD-CLM-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-TOTD-DRAFT-CNT       PIC S9(05)    VALUE +0.
122002         05  WS-TOTD-VOID-CNT        PIC S9(05)    VALUE +0.
122002         05  WS-TOTD-STOPPAY-CNT     PIC S9(05)    VALUE +0.
122002         05  WS-TOTD-LETTER-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-TOTD-CALLIN-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-TOTD-CALLOUT-CNT     PIC S9(05)    VALUE +0.
122002         05  WS-TOTD-NOTE-CNT        PIC S9(05)    VALUE +0.
122002         05  WS-TOTD-DENIAL-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-TOTD-DROP-CNT        PIC S9(05)    VALUE +0.
122002         05  WS-TOTD-REOPEN-CNT      PIC S9(05)    VALUE +0.

122002     03  WS-TOTM-COUNTS              COMP-3.    
122002         05  WS-TOTM-NEW-CLM-CNT     PIC S9(05)    VALUE +0.
122002         05  WS-TOTM-PD-CLM-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-TOTM-DRAFT-CNT       PIC S9(05)    VALUE +0.
122002         05  WS-TOTM-VOID-CNT        PIC S9(05)    VALUE +0.
122002         05  WS-TOTM-STOPPAY-CNT     PIC S9(05)    VALUE +0.
122002         05  WS-TOTM-LETTER-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-TOTM-CALLIN-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-TOTM-CALLOUT-CNT     PIC S9(05)    VALUE +0.
122002         05  WS-TOTM-NOTE-CNT        PIC S9(05)    VALUE +0.
122002         05  WS-TOTM-DENIAL-CNT      PIC S9(05)    VALUE +0.
122002         05  WS-TOTM-DROP-CNT        PIC S9(05)    VALUE +0.
122002         05  WS-TOTM-REOPEN-CNT      PIC S9(05)    VALUE +0.

       01  FILLER                          COMP-3.
           05  WS-GRAND-TOT-NEW-CLM-CNT    PIC S9(05)    VALUE +0.
           05  WS-GRAND-TOT-PD-CLM-CNT     PIC S9(05)    VALUE +0.
           05  WS-GRAND-TOT-DRAFT-CNT      PIC S9(05)    VALUE +0.
           05  WS-GRAND-TOT-VOID-CNT       PIC S9(05)    VALUE +0.
           05  WS-GRAND-TOT-STOPPAY-CNT    PIC S9(05)    VALUE +0.
           05  WS-GRAND-TOT-LETTER-CNT     PIC S9(05)    VALUE +0.
           05  WS-GRAND-TOT-CALLIN-CNT     PIC S9(05)    VALUE +0.
           05  WS-GRAND-TOT-CALLOUT-CNT    PIC S9(05)    VALUE +0.
           05  WS-GRAND-TOT-NOTE-CNT       PIC S9(05)    VALUE +0.
           05  WS-GRAND-TOT-DENIAL-CNT     PIC S9(05)    VALUE +0.
           05  WS-GRAND-TOT-DROP-CNT       PIC S9(05)    VALUE +0.
           05  WS-GRAND-TOT-REOPEN-CNT     PIC S9(05)    VALUE +0.



      ******* OVERALL HANDLE TIME BUCKETS
           05  WS-DLY-DIS-SVC-HANDLES      PIC S9(07)    VALUE +0.
           05  WS-DLY-DIS-HANDLE-TIME      PIC S9(07)    VALUE +0.
           05  WS-AVG-DLY-DIS-HANDLE-TIME  PIC S9(07)V99 VALUE +0.

           05  WS-DLY-DIS-UNW-HANDLES      PIC S9(07)    VALUE +0.
           05  WS-DLY-DIS-UNW-HTIME        PIC S9(07)    VALUE +0.
           05  WS-AVG-DLY-DIS-UNW-HTIME    PIC S9(07)V99 VALUE +0.

           05  WS-MTD-DIS-SVC-HANDLES      PIC S9(07)    VALUE +0.
           05  WS-MTD-DIS-HANDLE-TIME      PIC S9(07)    VALUE +0.
           05  WS-AVG-MTD-DIS-HANDLE-TIME  PIC S9(07)V99 VALUE +0.

           05  WS-MTD-DIS-UNW-HANDLES      PIC S9(07)    VALUE +0.
           05  WS-MTD-DIS-UNW-HTIME        PIC S9(07)    VALUE +0.
           05  WS-AVG-MTD-DIS-UNW-HTIME    PIC S9(07)V99 VALUE +0.

121603     05  WS-DLY-GP-SVC-HANDLES       PIC S9(07)    VALUE +0.
121603     05  WS-DLY-GP-HANDLE-TIME       PIC S9(07)    VALUE +0.
121603     05  WS-AVG-DLY-GP-HANDLE-TIME   PIC S9(07)V99 VALUE +0.

121603     05  WS-DLY-GP-UNW-HANDLES       PIC S9(07)    VALUE +0.
121603     05  WS-DLY-GP-UNW-HTIME         PIC S9(07)    VALUE +0.
121603     05  WS-AVG-DLY-GP-UNW-HTIME     PIC S9(07)V99 VALUE +0.

121603     05  WS-MTD-GP-SVC-HANDLES       PIC S9(07)    VALUE +0.
121603     05  WS-MTD-GP-HANDLE-TIME       PIC S9(07)    VALUE +0.
121603     05  WS-AVG-MTD-GP-HANDLE-TIME   PIC S9(07)V99 VALUE +0.

121603     05  WS-MTD-GP-UNW-HANDLES       PIC S9(07)    VALUE +0.
121603     05  WS-MTD-GP-UNW-HTIME         PIC S9(07)    VALUE +0.
121603     05  WS-AVG-MTD-GP-UNW-HTIME     PIC S9(07)V99 VALUE +0.

           05  WS-DLY-IU-SVC-HANDLES       PIC S9(07)    VALUE +0.
           05  WS-DLY-IU-HANDLE-TIME       PIC S9(07)    VALUE +0.
           05  WS-AVG-DLY-IU-HANDLE-TIME   PIC S9(07)V99 VALUE +0.

           05  WS-DLY-IU-UNW-HANDLES       PIC S9(07)    VALUE +0.
           05  WS-DLY-IU-UNW-HTIME         PIC S9(07)    VALUE +0.
           05  WS-AVG-DLY-IU-UNW-HTIME     PIC S9(07)V99 VALUE +0.

           05  WS-MTD-IU-SVC-HANDLES       PIC S9(07)    VALUE +0.
           05  WS-MTD-IU-HANDLE-TIME       PIC S9(07)    VALUE +0.
           05  WS-AVG-MTD-IU-HANDLE-TIME   PIC S9(07)V99 VALUE +0.

           05  WS-MTD-IU-UNW-HANDLES       PIC S9(07)    VALUE +0.
           05  WS-MTD-IU-UNW-HTIME         PIC S9(07)    VALUE +0.
           05  WS-AVG-MTD-IU-UNW-HTIME     PIC S9(07)V99 VALUE +0.

           05  WS-DLY-LIF-SVC-HANDLES      PIC S9(07)    VALUE +0.
           05  WS-DLY-LIF-HANDLE-TIME      PIC S9(07)    VALUE +0.
           05  WS-AVG-DLY-LIF-HANDLE-TIME  PIC S9(07)V99 VALUE +0.

           05  WS-DLY-LIF-UNW-HANDLES      PIC S9(07)    VALUE +0.
           05  WS-DLY-LIF-UNW-HTIME        PIC S9(07)    VALUE +0.
           05  WS-AVG-DLY-LIF-UNW-HTIME    PIC S9(07)V99 VALUE +0.

           05  WS-MTD-LIF-SVC-HANDLES      PIC S9(07)    VALUE +0.
           05  WS-MTD-LIF-HANDLE-TIME      PIC S9(07)    VALUE +0.
           05  WS-AVG-MTD-LIF-HANDLE-TIME  PIC S9(07)V99 VALUE +0.

           05  WS-MTD-LIF-UNW-HANDLES      PIC S9(07)    VALUE +0.
           05  WS-MTD-LIF-UNW-HTIME        PIC S9(07)    VALUE +0.
           05  WS-AVG-MTD-LIF-UNW-HTIME    PIC S9(07)V99 VALUE +0.

           05  WS-GTOT-SVC-HANDLES         PIC S9(07)    VALUE +0.
           05  WS-GTOT-HANDLE-TIME         PIC S9(07)    VALUE +0.
           05  WS-GTOT-AVG-HANDLE-TIME     PIC S9(07)V99 VALUE +0.

           05  WS-GTOT-UNW-HANDLES         PIC S9(07)    VALUE +0.
           05  WS-GTOT-UNW-HTIME           PIC S9(07)    VALUE +0.
           05  WS-GTOT-AVG-UNW-HTIME       PIC S9(07)V99 VALUE +0.


      ******* SERVICE TIME BUCKETS
           05  WS-DIS-PAID-DENIED-CNT      PIC S9(05)    VALUE +0.
           05  WS-IU-PAID-DENIED-CNT       PIC S9(05)    VALUE +0.
           05  WS-LIF-PAID-DENIED-CNT      PIC S9(05)    VALUE +0.
           05  WS-TOT-PAID-DENIED-CNT      PIC S9(05)    VALUE +0.

           05  WS-MTD-DIS-SERVICE-TIME     PIC S9(07)    VALUE +0.
           05  WS-AVG-DIS-SERVICE-TIME     PIC S9(07)V99 VALUE +0.

           05  WS-MTD-IU-SERVICE-TIME      PIC S9(07)    VALUE +0.
           05  WS-AVG-IU-SERVICE-TIME      PIC S9(07)V99 VALUE +0.

           05  WS-MTD-LIF-SERVICE-TIME     PIC S9(07)    VALUE +0.
           05  WS-AVG-LIF-SERVICE-TIME     PIC S9(07)V99 VALUE +0.

           05  WS-TOT-SERVICE-TIME         PIC S9(07)V99 VALUE +0.
           05  WS-AVG-SERVICE-TIME         PIC S9(07)V99 VALUE +0.
121603     05  WS-GP-PAID-DENIED-CNT       PIC S9(05)    VALUE +0.
121603     05  WS-MTD-GP-SERVICE-TIME      PIC S9(07)    VALUE +0.
121603     05  WS-AVG-GP-SERVICE-TIME      PIC S9(07)V99 VALUE +0.


      ******* SERVICE TIME DISTRIBUTION BUCKETS
           05  WS-DIS-DISTR1-CNT           PIC S9(05)    VALUE +0.
           05  WS-DIS-DISTR2-CNT           PIC S9(05)    VALUE +0.
           05  WS-DIS-DISTR3-CNT           PIC S9(05)    VALUE +0.
021706     05  WS-DIS-DISTR3A-CNT          PIC S9(05)    VALUE +0.
           05  WS-DIS-DISTR4-CNT           PIC S9(05)    VALUE +0.
           05  WS-DIS-DISTR5-CNT           PIC S9(05)    VALUE +0.
           05  WS-DIS-DISTR6-CNT           PIC S9(05)    VALUE +0.
           05  WS-DIS-DISTR7-CNT           PIC S9(05)    VALUE +0.
           05  WS-DIS-DISTR8-CNT           PIC S9(05)    VALUE +0.
           05  WS-DIS-DISTR9-CNT           PIC S9(05)    VALUE +0.
           05  WS-DIS-DISTR10-CNT          PIC S9(05)    VALUE +0.

121603     05  WS-GP-DISTR1-CNT            PIC S9(05)    VALUE +0.
121603     05  WS-GP-DISTR2-CNT            PIC S9(05)    VALUE +0.
121603     05  WS-GP-DISTR3-CNT            PIC S9(05)    VALUE +0.
021706     05  WS-GP-DISTR3A-CNT           PIC S9(05)    VALUE +0.
121603     05  WS-GP-DISTR4-CNT            PIC S9(05)    VALUE +0.
121603     05  WS-GP-DISTR5-CNT            PIC S9(05)    VALUE +0.
121603     05  WS-GP-DISTR6-CNT            PIC S9(05)    VALUE +0.
121603     05  WS-GP-DISTR7-CNT            PIC S9(05)    VALUE +0.
121603     05  WS-GP-DISTR8-CNT            PIC S9(05)    VALUE +0.
121603     05  WS-GP-DISTR9-CNT            PIC S9(05)    VALUE +0.
121603     05  WS-GP-DISTR10-CNT           PIC S9(05)    VALUE +0.

           05  WS-IU-DISTR1-CNT            PIC S9(05)    VALUE +0.
           05  WS-IU-DISTR2-CNT            PIC S9(05)    VALUE +0.
           05  WS-IU-DISTR3-CNT            PIC S9(05)    VALUE +0.
021706     05  WS-IU-DISTR3A-CNT           PIC S9(05)    VALUE +0.
           05  WS-IU-DISTR4-CNT            PIC S9(05)    VALUE +0.
           05  WS-IU-DISTR5-CNT            PIC S9(05)    VALUE +0.
           05  WS-IU-DISTR6-CNT            PIC S9(05)    VALUE +0.
           05  WS-IU-DISTR7-CNT            PIC S9(05)    VALUE +0.
           05  WS-IU-DISTR8-CNT            PIC S9(05)    VALUE +0.
           05  WS-IU-DISTR9-CNT            PIC S9(05)    VALUE +0.
           05  WS-IU-DISTR10-CNT           PIC S9(05)    VALUE +0.

           05  WS-LIF-DISTR1-CNT           PIC S9(05)    VALUE +0.
           05  WS-LIF-DISTR2-CNT           PIC S9(05)    VALUE +0.
           05  WS-LIF-DISTR3-CNT           PIC S9(05)    VALUE +0.
021706     05  WS-LIF-DISTR3A-CNT          PIC S9(05)    VALUE +0.
           05  WS-LIF-DISTR4-CNT           PIC S9(05)    VALUE +0.
           05  WS-LIF-DISTR5-CNT           PIC S9(05)    VALUE +0.
           05  WS-LIF-DISTR6-CNT           PIC S9(05)    VALUE +0.
           05  WS-LIF-DISTR7-CNT           PIC S9(05)    VALUE +0.
           05  WS-LIF-DISTR8-CNT           PIC S9(05)    VALUE +0.
           05  WS-LIF-DISTR9-CNT           PIC S9(05)    VALUE +0.
           05  WS-LIF-DISTR10-CNT          PIC S9(05)    VALUE +0.

           05  WS-TOT-DISTR1-CNT           PIC S9(05)    VALUE +0.
           05  WS-TOT-DISTR2-CNT           PIC S9(05)    VALUE +0.
           05  WS-TOT-DISTR3-CNT           PIC S9(05)    VALUE +0.
021706     05  WS-TOT-DISTR3A-CNT          PIC S9(05)    VALUE +0.
           05  WS-TOT-DISTR4-CNT           PIC S9(05)    VALUE +0.
           05  WS-TOT-DISTR5-CNT           PIC S9(05)    VALUE +0.
           05  WS-TOT-DISTR6-CNT           PIC S9(05)    VALUE +0.
           05  WS-TOT-DISTR7-CNT           PIC S9(05)    VALUE +0.
           05  WS-TOT-DISTR8-CNT           PIC S9(05)    VALUE +0.
           05  WS-TOT-DISTR9-CNT           PIC S9(05)    VALUE +0.
           05  WS-TOT-DISTR10-CNT          PIC S9(05)    VALUE +0.


           05  WS-RETURN-CODE              PIC S9(03)    VALUE +0.
           05  WS-ZERO                     PIC S9(01)    VALUE +0.

       01  FILLER                          COMP SYNC.
           05  PGM-SUB                     PIC S9(04)    VALUE +586.
           05  WS-SUB                      PIC S9(04)    VALUE +0.
           05  WS-SAVE-SUB                 PIC S9(04)    VALUE +0.

       01  FILLER.
           05  OLC-REPORT-NAME             PIC X(05)     VALUE 'EL586'.

           05  WS-CYCLE-DT-BINARY          PIC X(02)     VALUE SPACES.

           05  WS-PREV-CYCLE-DT-BINARY     PIC X(02)     VALUE SPACES.

           05  WS-CURR-MNTH-STRT-DT-BIN    PIC X(02)     VALUE SPACES.

           05  WS-HOLD-CLM-RECV-DT         PIC X(02)     VALUE SPACES.
           05  WS-HOLD-PP-RECV-DT          PIC X(02)     VALUE SPACES.
           05  WS-HOLD-1ST-PAY-DT          PIC X(02)     VALUE SPACES.
           05  WS-HOLD-PP-PAY-DT           PIC X(02)     VALUE SPACES.
           05  WS-HOLD-CLM-DENY-DT         PIC X(02)     VALUE SPACES.
           05  WS-HOLD-UNDW-RETURN-DT      PIC X(02)     VALUE SPACES.

           05  WS-CYCLE-DT.
               10  WS-CYCLE-DT-CC          PIC 9(02)     VALUE ZEROS.
               10  WS-CYCLE-DT-YY          PIC 9(02)     VALUE ZEROS.
               10  WS-CYCLE-DT-MM          PIC 9(02)     VALUE ZEROS.
               10  WS-CYCLE-DT-DD          PIC 9(02)     VALUE ZEROS.

           05  WS-EDITED-CYCLE-DT.
               10  WS-EDITED-CYCLE-DT-MM   PIC X(02)     VALUE SPACES.
               10  FILLER                  PIC X(01)     VALUE '/'.
               10  WS-EDITED-CYCLE-DT-DD   PIC X(02)     VALUE SPACES.
               10  FILLER                  PIC X(01)     VALUE '/'.
               10  WS-EDITED-CYCLE-DT-YY   PIC X(02)     VALUE SPACES.

           05  WS-CURR-MNTH-STRT-DT.
               10  FILLER                  PIC X(06)     VALUE SPACES.
               10  WS-CURR-MNTH-DAY01      PIC X(02)     VALUE SPACES.

           05  WS-EOF1-SW                  PIC X(01)     VALUE SPACE.
               88  END-OF-MTD-ELMSTR                     VALUE 'Y'.

           05  WS-EOF2-SW                  PIC X(01)     VALUE SPACE.
               88  END-OF-ELTRLR                         VALUE 'Y'.
010704         88  END-OF-ELTRLR-ON-START                VALUE '1'.

           05  WS-EOF3-SW                  PIC X(01)     VALUE SPACE.
               88  END-OF-SORTFILE                       VALUE 'Y'.

           05  WS-ELTRLR-FILE-STATUS       PIC X(02)     VALUE ZERO.

           05  WS-ELTRLR-KEY-SW            PIC X(01)     VALUE SPACE.
               88  NEW-ELTRLR-KEY                        VALUE 'N'.
               88  ELTRLR-KEY-CHANGE                     VALUE 'C'.

           05  WS-TRAILER-TYPE             PIC X(01)     VALUE SPACE.
               88  COUNTABLE-ACTIVITY                    VALUE
                   '2' '4' '6' '8'.

           05  WS-LEVEL88-CLAIM-TYPE       PIC X(01)     VALUE SPACE.
               88  DISABILITY-CLAIM-TYPE                 VALUE 'A'.
121603         88  GP-CLAIM-TYPE                         VALUE 'G'.
122002         88  IU-CLAIM-TYPE                         VALUE 'I'.
               88  LIFE-CLAIM-TYPE                       VALUE 'L'.

           05  WS-PAID-DENY-SW             PIC X(01)     VALUE SPACE.
               88 1ST-PAYMENT-SENT-THIS-MO               VALUE '1'.
               88 CLAIM-DENIED-THIS-MO                   VALUE 'D'.
               88 PPFORM-PROCESSED-THIS-MO               VALUE 'P'.

           05  WS-CLAIM-RECV-DT-SW         PIC X(01)     VALUE 'Y'.
               88  LOOKING-FOR-CLM-RECV-DT               VALUE 'Y'.
               88  ALREADY-HAVE-CLM-RECV-DT              VALUE 'F'.

           05  WS-FORM-PP-RECV-DT-SW       PIC X(01)     VALUE 'Y'.
               88  LOOKING-FOR-PP-RECV-DT                VALUE 'Y'.
               88  ALREADY-HAVE-PP-RECV-DT               VALUE 'F'.

           05  WS-CLAIM-COUNTED-SW         PIC X(01)     VALUE SPACE.
               88  CLAIM-NOT-COUNTED                     VALUE 'N'.
               88  CLAIM-COUNTED                         VALUE 'C'.

           05  WS-MTD-OR-DAILY-SW          PIC X(01)     VALUE SPACE.
               88  DAILY                                 VALUE 'D'.
               88  MONTH-TO-DATE                         VALUE 'M'.

           05  WS-FIRST-TIME-SW            PIC X(01)     VALUE 'Y'.
               88  FIRST-SORT-RECORD                     VALUE 'Y'.
               88  NOT-FIRST-RECORD                      VALUE 'N'.

           05  WS-REPORT-DELETE-SW         PIC X(01)     VALUE 'B'.
               88  BEGIN-REPORT-DELETE                   VALUE 'B'.
               88  REPORT-DELETE-DONE                    VALUE 'D'.


           05  WS-ELAPSED-DAYS             PIC X(04)    VALUE SPACES.
               88  DISTR-1                              VALUES ARE
                   '0001', '0002', '0003', '0004', '0005'.
               88  DISTR-2                              VALUES ARE
                   '0006', '0007', '0008', '0009', '0010'.
               88  DISTR-3                              VALUES ARE
021706*            '0011'  THRU  '0020'.
021706             '0011'  THRU  '0015'.
021706         88  DISTR-3A                             VALUES ARE
021706             '0016'  THRU  '0020'.
               88  DISTR-4                              VALUES ARE
                   '0021'  THRU  '0030'.
               88  DISTR-5                              VALUES ARE
                   '0031'  THRU  '0045'.
               88  DISTR-6                              VALUES ARE
                   '0046'  THRU  '0060'.
               88  DISTR-7                              VALUES ARE
                   '0061'  THRU  '0075'.
               88  DISTR-8                              VALUES ARE
                   '0076'  THRU  '0099'.
               88  DISTR-9                              VALUES ARE
                   '0100'  THRU  '0500'.


           05  WS-HOLD-CLAIM-TYPE          PIC X(01)     VALUE SPACE.
           05  WS-HOLD-AUDITOR             PIC X(04)     VALUE SPACES.
           05  WS-HOLD-M-OR-D              PIC X(01)     VALUE SPACES.


           05  WS-ABEND-MESSAGE            PIC X(80)     VALUE SPACES.
           05  WS-ABEND-FILE-STATUS        PIC X(02)     VALUE ZERO.

           05  WS-AUDITOR-RPT-TITLE        PIC X(44)     VALUE
               '        CLAIMS ACTIVITY BY AUDITOR         '.

122002     05  WS-AUD-RPT-DIS-SUBT-HDR.
122002         10  FILLER                  PIC X(28)     VALUE        
122002             '-*** TOTAL CREDIT DISABILITY'. 

121603     05  WS-AUD-RPT-GP-SUBT-HDR.
121603         10  FILLER                  PIC X(28)     VALUE
121603             '-*** TOTAL DCC  GAP         '. 

122002     05  WS-AUD-RPT-IU-SUBT-HDR.
122002         10  FILLER                  PIC X(28)     VALUE
122002             '-*** TOTAL DCC UNEMPLOYMENT '. 

122002     05  WS-AUD-RPT-LIF-SUBT-HDR.
122002         10  FILLER                  PIC X(28)     VALUE        
122002             '-*** TOTAL CREDIT LIFE      '. 

122002     05  WS-HANDLE-TIME-RPT-TITLE.
122002         10  FILLER                  PIC X(41)     VALUE
122002             ' OVERALL AVERAGE HANDLE TIME IN DAYS FOR '.
122002         10  WS-HT-RPT-CO-ID         PIC X(03)     VALUE
122002             'CID'.

122002     05  WS-SERVICE-TIME-RPT-TITLE.
122002         10  FILLER                  PIC X(41)     VALUE
122002             'OVERALL AVERAGE SERVICE TIME IN DAYS FOR '.
122002         10  WS-ST-RPT-CO-ID         PIC X(03)     VALUE
122002             'CID'.

122002     05  WS-EXCEPTION-RPT-TITLE.
122002         10  FILLER                  PIC X(37)     VALUE
                   '   CLAIM SERVICE TIME EXCEPTIONS FOR '.
122002         10  WS-EXC-RPT-CO-ID        PIC X(03)     VALUE
122002             'CID'.
122002         10  FILLER                  PIC X(04)     VALUE SPACES.

122002     05  WS-DISTRIBUTION-RPT-TITLE.
122002         10  FILLER                  PIC X(38)     VALUE
122002             '  CLAIM SERVICE TIME DISTRIBUTION FOR '.
122002         10  WS-DIST-RPT-CO-ID       PIC X(03)     VALUE
122002             'CID'.
122002         10  FILLER                  PIC X(03)     VALUE SPACES.

           05  WS-MTD-LITERAL              PIC X(19)     VALUE
               'MONTH-TO-DATE      '.

           05  WS-DIS-LABEL                PIC X(19)     VALUE
               'CREDIT DISABILITY  '.

121603     05  WS-GP-LABEL                 PIC X(19)     VALUE
121603         'DCC   GAP          '.

           05  WS-IU-LABEL                 PIC X(19)     VALUE
               'DCC UNEMPLOYMENT   '.

           05  WS-LIFE-LABEL               PIC X(19)     VALUE
               'CREDIT LIFE        '.

122002     05  WS-DLY-GRANDTOT-LABEL.
122002         10  WS-DLY-GT-CO-ID         PIC X(03)     VALUE
122002             'CID'.
122002         10  FILLER                  PIC X(16)     VALUE
122002             ' GRAND TOTALS   '.

           05  WS-MTD-GRANDTOT-LABEL       PIC X(19)     VALUE
               'MTD GRAND TOTALS   '.

           05  WS-REPORT-LABEL.
               10  WS-LABEL-VARIABLE-1     PIC X(10)     VALUE SPACES.
               10  WS-LABEL-VARIABLE-2     PIC X(19)     VALUE SPACES.

           05  WS-GRAND-TOTALS-LABEL.
122002         10  FILLER                  PIC X(03)     VALUE
122002             '** '.
122002         10  WS-GT-CO-ID             PIC X(03)     VALUE
122002             'CID'.
122002         10  FILLER                  PIC X(23)     VALUE
122002             ' GRAND TOTALS ****     '.



       01  WS-HEADING1.
           05  FILLER                      PIC X(01)     VALUE '1'.
           05  FILLER                      PIC X(40)     VALUE SPACES.
           05  WS-H1-TITLE                 PIC X(44)     VALUE SPACES.
           05  FILLER                      PIC X(36)     VALUE SPACES.
           05  WS-H1-REPORT-ID             PIC X(05)     VALUE 'EL586'.
           05  FILLER                      PIC X(07)     VALUE SPACES.


       01  WS-HEADING2.
           05  FILLER                      PIC X(01)     VALUE SPACE.
           05  FILLER                      PIC X(48)     VALUE SPACES.
           05  WS-H2-COMPANY-NAME          PIC X(30)     VALUE SPACES.
           05  FILLER                      PIC X(42)     VALUE SPACES.
           05  WS-H2-DATE                  PIC X(08)     VALUE SPACES.
           05  FILLER                      PIC X(04)     VALUE SPACES.


       01  WS-HEADING3.
           05  FILLER                      PIC X(01)     VALUE SPACE.
           05  FILLER                      PIC X(44)     VALUE SPACES.
           05  FILLER                      PIC X(31)     VALUE
               'MONTH-TO-DATE ACTIVITY THROUGH '.
           05  WS-H3-THROUGH-DT            PIC X(10)     VALUE SPACES.
           05  FILLER                      PIC X(35)     VALUE SPACES.
           05  FILLER                      PIC X(04)     VALUE 'PAGE'.
           05  FILLER                      PIC X(01)     VALUE SPACES.
           05  WS-H3-PAGE                  PIC ZZ,ZZ9.
           05  FILLER                      PIC X(01)     VALUE SPACE.


      *** HEADING4 FOR CLAIM ACTIVITY BY AUDITOR
       01  WS-HEADING4.
           05  FILLER                      PIC X(01)     VALUE '-'.
           05  FILLER                      PIC X(28)     VALUE SPACES.
           05  FILLER                      PIC X(06)     VALUE
               ' NEW  '.
           05  FILLER                      PIC X(02)     VALUE SPACES.
           05  FILLER                      PIC X(06)     VALUE
               ' PAID '.
           05  FILLER                      PIC X(02)     VALUE SPACES.
           05  FILLER                      PIC X(06)     VALUE
               'DRAFTS'.
           05  FILLER                      PIC X(10)     VALUE SPACES.
           05  FILLER                      PIC X(04)     VALUE
               'STOP'.
           05  FILLER                      PIC X(22)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'CALLS'.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'CALLS'.
           05  FILLER                      PIC X(33)     VALUE SPACES.



      *** HEADING4 FOR MONTH-TO-DATE AVERAGE HANDLE TIME FOR CID
       01  WS-HEADING4-HANDLE-TIME.
           05  FILLER                      PIC X(01)     VALUE '-'.
           05  FILLER                      PIC X(36)     VALUE SPACES.
           05  FILLER                      PIC X(15)     VALUE
               '  DEPARTMENT   '.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               ' DEPARTMENT '.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(18)     VALUE
               'DEPARTMENT AVERAGE'.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               'UNDERWRITING'.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               'UNDERWRITING'.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               'UNDERWRITING'.



      *** HEADING4 FOR MONTH-TO-DATE AVERAGE SERVICE TIME FOR CID
       01  WS-HEADING4-SERVICE-TIME.
           05  FILLER                      PIC X(01)     VALUE '-'.
           05  FILLER                      PIC X(19)     VALUE SPACES.
           05  FILLER                      PIC X(19)     VALUE SPACES.
           05  FILLER                      PIC X(11)     VALUE SPACES.
           05  FILLER                      PIC X(14)     VALUE
               'TOTAL PAID AND'.
           05  FILLER                      PIC X(12)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               '   TOTAL    '.
           05  FILLER                      PIC X(12)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               'SERVICE TIME'.
           05  FILLER                      PIC X(21)     VALUE SPACES.



      *** HEADING4 FOR CLAIM SERVICE TIME EXCEPTIONS
       01  WS-HEADING4-EXCEPTIONS.
           05  FILLER                      PIC X(01)     VALUE '-'.
           05  FILLER                      PIC X(07)     VALUE
               'CLAIM #'.
           05  FILLER                      PIC X(09)     VALUE SPACES.
           05  FILLER                      PIC X(10)     VALUE
               ' POLICY # '.
           05  FILLER                      PIC X(09)     VALUE SPACES.
           05  FILLER                      PIC X(17)     VALUE
               '   CLAIM TYPE    '.
           05  FILLER                      PIC X(09)     VALUE SPACES.
           05  FILLER                      PIC X(11)     VALUE
               '  ACTION   '.
           05  FILLER                      PIC X(09)     VALUE SPACES.
           05  FILLER                      PIC X(14)     VALUE
               'FORM RECEIVED '.
           05  FILLER                      PIC X(09)     VALUE SPACES.
           05  FILLER                      PIC X(11)     VALUE
               'ACTION DATE'.
           05  FILLER                      PIC X(05)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               'SERVICE TIME'.



      *** HEADING4 FOR CLAIM SERVICE TIME DISTRIBUTION
       01  WS-HEADING4-DISTRIBUTION.
           05  FILLER                      PIC X(01)     VALUE '-'.
           05  FILLER                      PIC X(19)     VALUE SPACES.
           05  FILLER                      PIC X(07)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               '1-5  '.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               '6-10 '.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
021706*        '11-20'.
021706         '11-15'.
021706     05  FILLER                      PIC X(06)     VALUE SPACES.
021706     05  FILLER                      PIC X(05)     VALUE
021706         '16-20'.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               '21-30'.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               '31-45'.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               '46-60'.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               '61-75'.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               '76-99'.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               '100+ '.
021706*    05  FILLER                      PIC X(13)     VALUE SPACES.
021706     05  FILLER                      PIC X(02)     VALUE SPACES.


      *** HEADING5 FOR CLAIM ACTIVITY BY AUDITOR
       01  WS-HEADING5.
           05  FILLER                      PIC X(01)     VALUE SPACE.
           05  FILLER                      PIC X(18)     VALUE SPACES.
           05  FILLER                      PIC X(07)     VALUE
               'AUDITOR'.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(06)     VALUE
               'CLAIMS'.
           05  FILLER                      PIC X(02)     VALUE SPACES.
           05  FILLER                      PIC X(06)     VALUE
               'CLAIMS'.
           05  FILLER                      PIC X(02)     VALUE SPACES.
           05  FILLER                      PIC X(06)     VALUE
               'ISSUED'.
           05  FILLER                      PIC X(02)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'VOIDS'.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(04)     VALUE
               'PAYS'.
           05  FILLER                      PIC X(04)     VALUE SPACES.
           05  FILLER                      PIC X(07)     VALUE
               'LETTERS'.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'NOTES'.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               ' IN  '.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               ' OUT '.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(07)     VALUE
               'DENIALS'.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(06)     VALUE
               'CLOSES'.
           05  FILLER                      PIC X(02)     VALUE SPACES.
           05  FILLER                      PIC X(07)     VALUE
               'REOPENS'.
           05  FILLER                      PIC X(05)     VALUE SPACES.


      *** HEADING5 FOR MONTH-TO-DATE AVERAGE HANDLE TIME
       01  WS-HEADING5-HANDLE-TIME.
           05  FILLER                      PIC X(01)     VALUE SPACE.
           05  FILLER                      PIC X(36)     VALUE SPACES.
           05  FILLER                      PIC X(15)     VALUE
               'SERVICE HANDLES'.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               'SERVICE TIME'.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(18)     VALUE
               '    PER HANDLE    '.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               '  HANDLES   '.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               'SERVICE TIME'.
           05  FILLER                      PIC X(03)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               '  AVERAGE   '.


      *** HEADING5 FOR MONTH-TO-DATE AVERAGE SERVICE TIME
       01  WS-HEADING5-SERVICE-TIME.
           05  FILLER                      PIC X(01)     VALUE SPACE.
           05  FILLER                      PIC X(19)     VALUE SPACES.
           05  FILLER                      PIC X(19)     VALUE SPACES.
           05  FILLER                      PIC X(11)     VALUE SPACES.
           05  FILLER                      PIC X(14)     VALUE
               'DENIED CLAIMS '.
           05  FILLER                      PIC X(12)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               'SERVICE TIME'.
           05  FILLER                      PIC X(12)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE
               '  AVERAGE   '.
           05  FILLER                      PIC X(21)     VALUE SPACES.



      *** HEADING5 FOR CLAIM SERVICE TIME DISTRIBUTION
       01  WS-HEADING5-DISTRIBUTION.
           05  FILLER                      PIC X(01)     VALUE SPACE.
           05  FILLER                      PIC X(19)     VALUE SPACES.
           05  FILLER                      PIC X(07)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'DAYS '.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'DAYS '.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'DAYS '.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'DAYS '.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'DAYS '.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'DAYS '.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'DAYS '.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'DAYS '.
           05  FILLER                      PIC X(06)     VALUE SPACES.
           05  FILLER                      PIC X(05)     VALUE
               'DAYS '.
021706     05  FILLER                      PIC X(06)     VALUE SPACES.
021606     05  FILLER                      PIC X(05)     VALUE
021706         'DAYS '.
021706*    05  FILLER                      PIC X(13)     VALUE SPACES.
021706     05  FILLER                      PIC X(02)     VALUE SPACES.


      *** DETAIL FOR CLAIM ACTIVITY BY AUDITOR
       01  WS-DETAIL1.
           03  WS-DETAIL1-A.
               05  FILLER                  PIC X(01)     VALUE SPACE.
               05  WS-TOTALS-LABEL.
                   10  WS-D1-COL1-VARIABLE PIC X(19)     VALUE SPACES.

                   10  WS-D1-AUDITOR       PIC X(04)     VALUE SPACES.
                   10  FILLER              PIC X(06)     VALUE SPACES.
               05  WS-D1-NEW-CLM-CNT       PIC ZZZ9.
               05  FILLER                  PIC X(04)     VALUE SPACES.
               05  WS-D1-PD-CLM-CNT        PIC ZZZ9.
               05  FILLER                  PIC X(04)     VALUE SPACES.
               05  WS-D1-DRAFT-CNT         PIC ZZZ9.
               05  FILLER                  PIC X(04)     VALUE SPACES.
               05  WS-D1-VOID-CNT          PIC ZZZ9.
               05  FILLER                  PIC X(03)     VALUE SPACES.
               05  WS-D1-STOPPAY-CNT       PIC ZZZ9.
               05  FILLER                  PIC X(06)     VALUE SPACES.
               05  WS-D1-LETTER-CNT        PIC ZZZ9.
               05  FILLER                  PIC X(05)     VALUE SPACES.
               05  WS-D1-NOTE-CNT          PIC ZZZ9.
               05  FILLER                  PIC X(04)     VALUE SPACES.
               05  WS-D1-CALLIN-CNT        PIC ZZZ9.
               05  FILLER                  PIC X(04)     VALUE SPACES.
               05  WS-D1-CALLOUT-CNT       PIC ZZZ9.
               05  FILLER                  PIC X(05)     VALUE SPACES.
               05  WS-D1-DENIAL-CNT        PIC ZZZ9.
               05  FILLER                  PIC X(05)     VALUE SPACES.
           03  WS-D1-DROP-CNT              PIC ZZZ9.
           03  FILLER                      PIC X(05)     VALUE SPACES.
           03  WS-D1-REOPEN-CNT            PIC ZZZ9.
           03  FILLER                      PIC X(05)     VALUE SPACES.


      *** DETAIL FOR MONTH-TO-DATE AVERAGE HANDLE TIME
       01  WS-DETAIL2-HANDLE-TIME.
           05  FILLER                      PIC X(01)     VALUE SPACE.
           05  WS-D2-COL1-LABEL            PIC X(29)     VALUE SPACES.
           05  FILLER                      PIC X(11)     VALUE SPACES.
           05  WS-D2-TOT-SVC-HANDLES       PIC ZZ,ZZ9.
           05  FILLER                      PIC X(11)     VALUE SPACES.
           05  WS-D2-TOT-HANDLE-TIME       PIC ZZ,ZZ9.
           05  FILLER                      PIC X(12)     VALUE SPACES.
           05  WS-D2-AVERAGE-HANDLE-TIME   PIC Z9.99.
           05  FILLER                      PIC X(13)     VALUE SPACES.
           05  WS-D2-UNDWRITG-HANDLES      PIC ZZ,ZZ9.
           05  FILLER                      PIC X(09)     VALUE SPACES.
           05  WS-D2-UNDWRITG-HTIME        PIC ZZ,ZZ9.
           05  FILLER                      PIC X(09)     VALUE SPACES.
           05  WS-D2-UNDWRITG-AVG-HTIME    PIC Z9.99.
           05  FILLER                      PIC X(04)     VALUE SPACES.


      *** DETAIL FOR MONTH-TO-DATE AVERAGE SERVICE TIME
       01  WS-DETAIL3-SERVICE-TIME.
           05  FILLER                      PIC X(01)     VALUE '0'.
           05  FILLER                      PIC X(19)     VALUE SPACES.
           05  WS-D3-COL1-LABEL            PIC X(19)     VALUE SPACES.
           05  FILLER                      PIC X(15)     VALUE SPACES.
           05  WS-D3-PAID-DENIED-CNT       PIC ZZ,ZZ9.
           05  FILLER                      PIC X(19)     VALUE SPACES.
           05  WS-D3-TOT-SVC-TIME          PIC ZZ,ZZ9.
           05  FILLER                      PIC X(19)     VALUE SPACES.
           05  WS-D3-AVG-SVC-TIME          PIC Z9.99.
           05  FILLER                      PIC X(24)     VALUE SPACES.



      *** DETAIL FOR SERVICE TIME EXCEPTIONS
       01  WS-DETAIL4-EXCEPTIONS.
           05  FILLER                      PIC X(01)     VALUE SPACE.
           05  WS-D4-CLAIM-NO              PIC X(07)     VALUE SPACES.
           05  FILLER                      PIC X(09)     VALUE SPACES.
           05  WS-D4-POLICY-NO             PIC X(10)     VALUE SPACES.
           05  FILLER                      PIC X(09)     VALUE SPACES.
           05  WS-D4-CLAIM-TYPE            PIC X(19)     VALUE SPACES.
           05  FILLER                      PIC X(07)     VALUE SPACES.
           05  WS-D4-ACTION                PIC X(11)     VALUE SPACES.
           05  FILLER                      PIC X(12)     VALUE SPACES.
           05  WS-D4-FORM-RCVD-DT          PIC X(08)     VALUE SPACES.
           05  FILLER                      PIC X(13)     VALUE SPACES.
           05  WS-D4-CLM-ACTION-DT         PIC X(08)     VALUE SPACES.
           05  FILLER                      PIC X(11)     VALUE SPACES.
           05  WS-D4-CLM-SVC-TIME          PIC ZZ9.
           05  FILLER                      PIC X(05)     VALUE SPACES.



      *** DETAIL FOR SERVICE TIME DISTRIBUTION
       01  WS-DETAIL5-DISTRIBUTION.
           05  FILLER                      PIC X(01)     VALUE SPACE.
           05  WS-D5-COL1-LABEL            PIC X(19)     VALUE SPACES.
           05  FILLER                      PIC X(07)     VALUE SPACES.
           05  WS-D5-DISTR-1               PIC ZZZ9.
           05  FILLER                      PIC X(07)     VALUE SPACES.
           05  WS-D5-DISTR-2               PIC ZZZ9.
           05  FILLER                      PIC X(07)     VALUE SPACES.
           05  WS-D5-DISTR-3               PIC ZZZ9.
           05  FILLER                      PIC X(07)     VALUE SPACES.
021706     05  WS-D5-DISTR-3A              PIC ZZZ9.
021706     05  FILLER                      PIC X(07)     VALUE SPACES.
           05  WS-D5-DISTR-4               PIC ZZZ9.
           05  FILLER                      PIC X(07)     VALUE SPACES.
           05  WS-D5-DISTR-5               PIC ZZZ9.
           05  FILLER                      PIC X(07)     VALUE SPACES.
           05  WS-D5-DISTR-6               PIC ZZZ9.
           05  FILLER                      PIC X(07)     VALUE SPACES.
           05  WS-D5-DISTR-7               PIC ZZZ9.
           05  FILLER                      PIC X(07)     VALUE SPACES.
           05  WS-D5-DISTR-8               PIC ZZZ9.
           05  FILLER                      PIC X(07)     VALUE SPACES.
           05  WS-D5-DISTR-9               PIC ZZZ9.
           05  FILLER                      PIC X(14)     VALUE SPACES.


      *              *************
      *              ELCDTECX: LAYOUT FOR DISK-DATE FILE
                     COPY ELCDTECX.


                     COPY ELCDTEVR.

      *              *************
      *              ELCDATE: LAYOUT OF DATA PASSED TO DATE CONV RTN
                     COPY ELCDATE.


       LINKAGE SECTION.

       01  PARM.
           05  PARM-LENGTH        COMP     PIC S9(04)    VALUE ZEROS.
           05  PARM-PREV-CYCLE-DT          PIC X(08)     VALUE SPACES.
           05  PARM-CYCLE-DT               PIC X(08)     VALUE SPACES.

      ******************************************************************
      ********************************
       PROCEDURE DIVISION USING PARM.

      ****************READ DISK-DATE FILE
       0000-DATE-CARD-READ. COPY ELCDTERX.

       1000-MAIN-LOGIC.

           PERFORM 1500-EDIT-CYCLE-DATE       THRU 1500-EXIT

           PERFORM OPEN-FILES

           MOVE COMPANY-NAME                  TO WS-H2-COMPANY-NAME
           MOVE WS-CURRENT-DATE               TO WS-H2-DATE
           MOVE WS-EDITED-CYCLE-DT            TO WS-H3-THROUGH-DT

122002     IF DTE-CLIENT = 'DCC'
122002         MOVE 'DCC'                     TO WS-GT-CO-ID
122002         MOVE 'DCC'                     TO WS-DLY-GT-CO-ID
122002         MOVE 'DCC'                     TO WS-HT-RPT-CO-ID
122002         MOVE 'DCC'                     TO WS-ST-RPT-CO-ID
122002         MOVE 'DCC'                     TO WS-EXC-RPT-CO-ID 
122002         MOVE 'DCC'                     TO WS-DIST-RPT-CO-ID
122002         MOVE 'DCC DISABILITY     '     TO WS-DIS-LABEL
122002         MOVE 'DCC LIFE           '     TO WS-LIFE-LABEL
122002         MOVE '-*** TOTAL DCC DISABILITY   '
122002                                        TO WS-AUD-RPT-DIS-SUBT-HDR
122002         MOVE '-*** TOTAL DCC LIFE         '
122002                                        TO WS-AUD-RPT-LIF-SUBT-HDR
122002     END-IF
 

           SORT SORT-FILE  ASCENDING KEY SORT-CLAIM-TYPE SORT-AUDITOR
              INPUT  PROCEDURE 2000-INPUT-PROCEDURE  THRU 2000-EXIT
              OUTPUT PROCEDURE 3000-OUTPUT-PROCEDURE THRU 3000-EXIT


           PERFORM CLOSE-FILES


           GOBACK.


       1500-EDIT-CYCLE-DATE.

           IF PARM-LENGTH = +0
               DISPLAY 'CYCLE DATE INPUT PARMS MISSING'
               PERFORM ABEND-PGM            THRU APS-EXIT
           END-IF

           MOVE PARM-CYCLE-DT               TO DC-GREG-DATE-CYMD
           MOVE 'L'                         TO DC-OPTION-CODE
           PERFORM 8500-DATE-CONVERSION     THRU 8500-EXIT

           IF NO-CONVERSION-ERROR
               MOVE DC-BIN-DATE-1           TO WS-CYCLE-DT-BINARY
               MOVE PARM-CYCLE-DT           TO WS-CYCLE-DT
               MOVE WS-CYCLE-DT-MM          TO WS-EDITED-CYCLE-DT-MM
               MOVE WS-CYCLE-DT-DD          TO WS-EDITED-CYCLE-DT-DD
               MOVE WS-CYCLE-DT-YY          TO WS-EDITED-CYCLE-DT-YY
           ELSE
               DISPLAY 'INVALID CYCLE DATE ' PARM-CYCLE-DT
               PERFORM ABEND-PGM            THRU APS-EXIT
           END-IF


      ************* CREATE BEGINNING OF MONTH DATE FOR MTD PROCESSING
           MOVE PARM-CYCLE-DT               TO WS-CURR-MNTH-STRT-DT
           MOVE '01'                        TO WS-CURR-MNTH-DAY01
           MOVE WS-CURR-MNTH-STRT-DT        TO DC-GREG-DATE-CYMD
           MOVE 'L'                         TO DC-OPTION-CODE
           PERFORM 8500-DATE-CONVERSION     THRU 8500-EXIT

           IF NO-CONVERSION-ERROR
               MOVE DC-BIN-DATE-1           TO WS-CURR-MNTH-STRT-DT-BIN
           ELSE
               DISPLAY 'CONVERSION ERROR ON MNTH-STRT-DT'
                                         WS-CURR-MNTH-STRT-DT
               PERFORM ABEND-PGM            THRU APS-EXIT
           END-IF
      *************

           MOVE PARM-PREV-CYCLE-DT          TO DC-GREG-DATE-CYMD
           MOVE 'L'                         TO DC-OPTION-CODE
           PERFORM 8500-DATE-CONVERSION     THRU 8500-EXIT

           IF NO-CONVERSION-ERROR
               MOVE DC-BIN-DATE-1           TO WS-PREV-CYCLE-DT-BINARY
           ELSE
               DISPLAY 'INVALID PREVIOUS CYCLE DATE ' PARM-PREV-CYCLE-DT
               PERFORM ABEND-PGM            THRU APS-EXIT
           END-IF


           IF NO-CONVERSION-ERROR
               MOVE DC-BIN-DATE-1           TO WS-PREV-CYCLE-DT-BINARY
           ELSE
               DISPLAY 'INVALID PREVIOUS CYCLE DATE ' PARM-PREV-CYCLE-DT
               PERFORM ABEND-PGM            THRU APS-EXIT
           END-IF

           .
       1500-EXIT.
           EXIT.


       2000-INPUT-PROCEDURE.

           PERFORM 2010-GET-RECS-FOR-SORT   THRU 2010-EXIT
               UNTIL END-OF-MTD-ELMSTR

           IF SORT-RETURN  NOT = ZEROS
              MOVE 'INTERNAL SORT ABORTED'  TO  WS-ABEND-MESSAGE
              MOVE '0101'                   TO  WS-RETURN-CODE
              PERFORM ABEND-PGM             THRU APS-EXIT
           END-IF

           .
       2000-EXIT.
           EXIT.


       2010-GET-RECS-FOR-SORT.

           MOVE SPACES                      TO WS-HOLD-CLM-RECV-DT
           MOVE SPACES                      TO WS-HOLD-1ST-PAY-DT
           MOVE SPACES                      TO WS-HOLD-PP-PAY-DT
           MOVE SPACES                      TO WS-HOLD-CLM-DENY-DT
           MOVE SPACE                       TO WS-PAID-DENY-SW

           READ MTD-ELMSTR-INFILE
               AT END
                   SET END-OF-MTD-ELMSTR    TO TRUE
                   GO TO 2010-EXIT
           END-READ

           IF CL-CLAIM-TYPE = SPACE OR LOW-VALUE
      ********* THIS SITUATION HAS BEEN CORRECTED MOVING FORWARD 
               DISPLAY 'NO CLM TYP FOR CNTL PRI ' CL-CONTROL-PRIMARY
               GO TO 2010-EXIT
           END-IF

           MOVE CL-CLAIM-TYPE               TO SORT-CLAIM-TYPE
           MOVE CL-CLAIM-TYPE               TO WS-LEVEL88-CLAIM-TYPE
           MOVE +0                          TO SORT-HANDLE-TIME

      ******* PICKING UP NEW CLAIMS
           IF (CL-FILE-ESTABLISH-DT >= WS-CURR-MNTH-STRT-DT-BIN  AND
               CL-FILE-ESTABLISH-DT <= WS-PREV-CYCLE-DT-BINARY)
               MOVE CL-PROCESSOR-ID          TO SORT-AUDITOR
               MOVE 'M'                      TO SORT-MTD-OR-DAILY
               MOVE 'N'                      TO SORT-REC-TYPE
               PERFORM 2900-RELEASE-SORT     THRU 2900-EXIT
           ELSE
               IF (CL-FILE-ESTABLISH-DT  > WS-PREV-CYCLE-DT-BINARY  AND
                   CL-FILE-ESTABLISH-DT <= WS-CYCLE-DT-BINARY)
                   MOVE CL-PROCESSOR-ID      TO SORT-AUDITOR
                   MOVE 'D'                  TO SORT-MTD-OR-DAILY
                   MOVE 'N'                  TO SORT-REC-TYPE
                   PERFORM 2900-RELEASE-SORT THRU 2900-EXIT
               END-IF
           END-IF


           MOVE SPACE                        TO SORT-MTD-OR-DAILY
      ******* PICKING UP DROPPED CLAIMS (CLOSES)
           IF CL-LAST-CLOSE-REASON = '1' OR '2' OR '4'

               IF CL-LAST-CLOSE-REASON = '1' OR '2'
                   MOVE 'AUTO'               TO SORT-AUDITOR
               ELSE
      *************** CANNOT TIE CLOSE ACTION TO SPECIFIC AUDITOR WITH
      *************** INTEGRITY
                   MOVE 'ZZZZ'               TO SORT-AUDITOR
               END-IF


               IF (CL-LAST-CLOSE-DT >= WS-CURR-MNTH-STRT-DT-BIN  AND
                   CL-LAST-CLOSE-DT <= WS-PREV-CYCLE-DT-BINARY)
                   MOVE 'M'                  TO SORT-MTD-OR-DAILY
                   MOVE 'D'                  TO SORT-REC-TYPE
                   PERFORM 2900-RELEASE-SORT THRU 2900-EXIT
               ELSE
                   IF (CL-LAST-CLOSE-DT  > WS-PREV-CYCLE-DT-BINARY  AND
                       CL-LAST-CLOSE-DT <= WS-CYCLE-DT-BINARY)
                       MOVE 'D'              TO SORT-MTD-OR-DAILY
                       MOVE 'D'              TO SORT-REC-TYPE
                       PERFORM 2900-RELEASE-SORT THRU 2900-EXIT
                   END-IF
               END-IF

               IF (CL-LAST-CLOSE-REASON = '2' AND
                   SORT-MTD-OR-DAILY NOT= SPACE)
                   SET CLAIM-DENIED-THIS-MO  TO TRUE
                   MOVE CL-LAST-CLOSE-DT     TO WS-HOLD-CLM-DENY-DT
               END-IF

           END-IF


      ******* PICKING UP CLAIMS THAT HAVE BEEN REOPENED
           IF (CL-LAST-REOPEN-DT >= WS-CURR-MNTH-STRT-DT-BIN  AND
               CL-LAST-REOPEN-DT <= WS-PREV-CYCLE-DT-BINARY)
               MOVE 'ZZZZ'                   TO SORT-AUDITOR
               MOVE 'M'                      TO SORT-MTD-OR-DAILY
093003         MOVE 'X'                      TO SORT-REC-TYPE
               PERFORM 2900-RELEASE-SORT     THRU 2900-EXIT
           ELSE
               IF (CL-LAST-REOPEN-DT  > WS-PREV-CYCLE-DT-BINARY  AND
                   CL-LAST-REOPEN-DT <= WS-CYCLE-DT-BINARY)
                   MOVE 'ZZZZ'               TO SORT-AUDITOR
                   MOVE 'D'                  TO SORT-MTD-OR-DAILY
093003             MOVE 'X'                  TO SORT-REC-TYPE
                   PERFORM 2900-RELEASE-SORT THRU 2900-EXIT
               END-IF
           END-IF

           SET CLAIM-NOT-COUNTED             TO TRUE
           PERFORM 2075-START-ELTRLR         THRU 2075-EXIT
 
010704     IF END-OF-ELTRLR-ON-START
010704         GO TO 2010-EXIT
010704     END-IF

           IF (WS-HOLD-CLM-RECV-DT = SPACES AND
               WS-HOLD-PP-RECV-DT  = SPACES)
               GO TO 2010-EXIT
           END-IF


           IF (WS-HOLD-PP-PAY-DT >= WS-CURR-MNTH-STRT-DT-BIN AND
               WS-HOLD-PP-PAY-DT <= WS-CYCLE-DT-BINARY)
               SET PPFORM-PROCESSED-THIS-MO      TO TRUE
           ELSE
               IF (WS-HOLD-1ST-PAY-DT >= WS-CURR-MNTH-STRT-DT-BIN AND
                   WS-HOLD-1ST-PAY-DT <= WS-CYCLE-DT-BINARY)
                   SET 1ST-PAYMENT-SENT-THIS-MO  TO TRUE
               END-IF
           END-IF


           IF PPFORM-PROCESSED-THIS-MO
               IF WS-HOLD-PP-RECV-DT = SPACES
                   GO TO 2010-EXIT
               END-IF

               MOVE WS-HOLD-PP-RECV-DT           TO DC-BIN-DATE-1
               MOVE WS-HOLD-PP-PAY-DT            TO DC-BIN-DATE-2
               MOVE 'PAYMENT    '                TO WS-D4-ACTION
           ELSE
               IF WS-HOLD-CLM-RECV-DT = SPACES
                   GO TO 2010-EXIT
               END-IF

               IF 1ST-PAYMENT-SENT-THIS-MO
                   MOVE WS-HOLD-CLM-RECV-DT      TO DC-BIN-DATE-1
                   MOVE WS-HOLD-1ST-PAY-DT       TO DC-BIN-DATE-2
                   MOVE '1ST PAYMENT'            TO WS-D4-ACTION
               ELSE
                   IF CLAIM-DENIED-THIS-MO
                       MOVE WS-HOLD-CLM-RECV-DT  TO DC-BIN-DATE-1
                       MOVE WS-HOLD-CLM-DENY-DT  TO DC-BIN-DATE-2
                       MOVE 'DENIAL     '        TO WS-D4-ACTION
                   ELSE
                       GO TO 2010-EXIT
                   END-IF
               END-IF
           END-IF

           IF  DC-BIN-DATE-1 < DC-BIN-DATE-2
               MOVE '1'                          TO DC-OPTION-CODE
               PERFORM 8500-DATE-CONVERSION      THRU 8500-EXIT
           ELSE
               GO TO 2010-EXIT
           END-IF


           IF NO-CONVERSION-ERROR
               CONTINUE
           ELSE
               DISPLAY 'CONVERSION ERROR IN PARA 2010- ERROR '
                                             DC-ERROR-CODE
               DISPLAY 'CLAIM KEY IS ' CL-CONTROL-PRIMARY
               PERFORM ABEND-PGM             THRU APS-EXIT
           END-IF

122002     EVALUATE TRUE
122002     WHEN (CL-CLAIM-TYPE = 'A' AND
               DC-ELAPSED-DAYS < WS-MAX-SVC-TIME-FOR-AVG)
               ADD DC-ELAPSED-DAYS           TO WS-MTD-DIS-SERVICE-TIME
               ADD +1                        TO WS-DIS-PAID-DENIED-CNT

121603     WHEN (CL-CLAIM-TYPE = 'G' AND
121603         DC-ELAPSED-DAYS < WS-MAX-SVC-TIME-FOR-AVG)
121603         ADD DC-ELAPSED-DAYS           TO WS-MTD-GP-SERVICE-TIME
121603         ADD +1                        TO WS-GP-PAID-DENIED-CNT

122002     WHEN (CL-CLAIM-TYPE = 'I' AND
122002         DC-ELAPSED-DAYS < WS-MAX-SVC-TIME-FOR-AVG)
122002         ADD DC-ELAPSED-DAYS           TO WS-MTD-IU-SERVICE-TIME
122002         ADD +1                        TO WS-IU-PAID-DENIED-CNT

122002     WHEN (CL-CLAIM-TYPE = 'L' AND
               DC-ELAPSED-DAYS < WS-MAX-SVC-TIME-FOR-AVG)
               ADD DC-ELAPSED-DAYS           TO WS-MTD-LIF-SERVICE-TIME
               ADD +1                        TO WS-LIF-PAID-DENIED-CNT
122002     END-EVALUATE

           MOVE DC-ELAPSED-DAYS              TO WS-ELAPSED-DAYS


      ******* ACCUMULATION OF TOTALS FOR SERVICE TIME DISTRIBUTION RPT
           EVALUATE TRUE
           WHEN (DISTR-1 AND
                 DISABILITY-CLAIM-TYPE)
               ADD +1                        TO WS-DIS-DISTR1-CNT

           WHEN (DISTR-2 AND
                 DISABILITY-CLAIM-TYPE)
               ADD +1                        TO WS-DIS-DISTR2-CNT

           WHEN (DISTR-3 AND
                 DISABILITY-CLAIM-TYPE)
               ADD +1                        TO WS-DIS-DISTR3-CNT

021706     WHEN (DISTR-3A AND
021706           DISABILITY-CLAIM-TYPE)
021706         ADD +1                        TO WS-DIS-DISTR3A-CNT
021706
           WHEN (DISTR-4 AND
                DISABILITY-CLAIM-TYPE)
               ADD +1                        TO WS-DIS-DISTR4-CNT

           WHEN (DISTR-5 AND
                 DISABILITY-CLAIM-TYPE)
               ADD +1                        TO WS-DIS-DISTR5-CNT

           WHEN (DISTR-6 AND
                 DISABILITY-CLAIM-TYPE)
               ADD +1                        TO WS-DIS-DISTR6-CNT

           WHEN (DISTR-7 AND
                 DISABILITY-CLAIM-TYPE)
               ADD +1                        TO WS-DIS-DISTR7-CNT

           WHEN (DISTR-8 AND
                 DISABILITY-CLAIM-TYPE)
               ADD +1                        TO WS-DIS-DISTR8-CNT

           WHEN (DISTR-9 AND
                 DISABILITY-CLAIM-TYPE)
               ADD +1                        TO WS-DIS-DISTR9-CNT


121603********* GAP BUCKETS
121603     WHEN (DISTR-1 AND
121603           GP-CLAIM-TYPE)
121603         ADD +1                        TO WS-GP-DISTR1-CNT
121603
121603     WHEN (DISTR-2 AND
121603           GP-CLAIM-TYPE)
121603         ADD +1                        TO WS-GP-DISTR2-CNT
121603
121603     WHEN (DISTR-3 AND
121603           GP-CLAIM-TYPE)
121603         ADD +1                        TO WS-GP-DISTR3-CNT
121603
021706     WHEN (DISTR-3A AND
021706           GP-CLAIM-TYPE)
021706         ADD +1                        TO WS-GP-DISTR3A-CNT
021706
121603     WHEN (DISTR-4 AND
121603           GP-CLAIM-TYPE)
121603         ADD +1                        TO WS-GP-DISTR4-CNT
121603
121603     WHEN (DISTR-5 AND
121603           GP-CLAIM-TYPE)
121603         ADD +1                        TO WS-GP-DISTR5-CNT
121603
121603     WHEN (DISTR-6 AND
121603           GP-CLAIM-TYPE)
121603         ADD +1                        TO WS-GP-DISTR6-CNT
121603
121603     WHEN (DISTR-7 AND
121603           GP-CLAIM-TYPE)
121603         ADD +1                        TO WS-GP-DISTR7-CNT
121603
121603     WHEN (DISTR-8 AND
121603           GP-CLAIM-TYPE)
121603         ADD +1                        TO WS-GP-DISTR8-CNT
121603
121603     WHEN (DISTR-9 AND
121603           GP-CLAIM-TYPE)
121603         ADD +1                        TO WS-GP-DISTR9-CNT

122002********* IU BUCKETS
122002     WHEN (DISTR-1 AND
122002           IU-CLAIM-TYPE)
122002         ADD +1                        TO WS-IU-DISTR1-CNT
122002
122002     WHEN (DISTR-2 AND
122002           IU-CLAIM-TYPE)
122002         ADD +1                        TO WS-IU-DISTR2-CNT
122002
122002     WHEN (DISTR-3 AND
122002           IU-CLAIM-TYPE)
122002         ADD +1                        TO WS-IU-DISTR3-CNT
122002
021706     WHEN (DISTR-3A AND
021706           IU-CLAIM-TYPE)
021706         ADD +1                        TO WS-IU-DISTR3A-CNT
021706
122002     WHEN (DISTR-4 AND
122002          IU-CLAIM-TYPE)
122002         ADD +1                        TO WS-IU-DISTR4-CNT
122002
122002     WHEN (DISTR-5 AND
122002           IU-CLAIM-TYPE)
122002         ADD +1                        TO WS-IU-DISTR5-CNT
122002
122002     WHEN (DISTR-6 AND
122002           IU-CLAIM-TYPE)
122002         ADD +1                        TO WS-IU-DISTR6-CNT
122002
122002     WHEN (DISTR-7 AND
122002           IU-CLAIM-TYPE)
122002         ADD +1                        TO WS-IU-DISTR7-CNT
122002
122002     WHEN (DISTR-8 AND
122002           IU-CLAIM-TYPE)
122002         ADD +1                        TO WS-IU-DISTR8-CNT
122002
122002     WHEN (DISTR-9 AND
122002           IU-CLAIM-TYPE)
122002         ADD +1                        TO WS-IU-DISTR9-CNT


      ********* LIFE BUCKETS
           WHEN (DISTR-1 AND
                 LIFE-CLAIM-TYPE)
               ADD +1                        TO WS-LIF-DISTR1-CNT

           WHEN (DISTR-2 AND
                 LIFE-CLAIM-TYPE)
               ADD +1                        TO WS-LIF-DISTR2-CNT

           WHEN (DISTR-3 AND
                 LIFE-CLAIM-TYPE)
               ADD +1                        TO WS-LIF-DISTR3-CNT

021706     WHEN (DISTR-3A AND
021706           LIFE-CLAIM-TYPE)
021706         ADD +1                        TO WS-LIF-DISTR3A-CNT
021706
           WHEN (DISTR-4 AND
                 LIFE-CLAIM-TYPE)
               ADD +1                        TO WS-LIF-DISTR4-CNT

           WHEN (DISTR-5 AND
                 LIFE-CLAIM-TYPE)
               ADD +1                        TO WS-LIF-DISTR5-CNT

           WHEN (DISTR-6 AND
                 LIFE-CLAIM-TYPE)
               ADD +1                        TO WS-LIF-DISTR6-CNT

           WHEN (DISTR-7 AND
                 LIFE-CLAIM-TYPE)
               ADD +1                        TO WS-LIF-DISTR7-CNT

           WHEN (DISTR-8 AND
                 LIFE-CLAIM-TYPE)
               ADD +1                        TO WS-LIF-DISTR8-CNT

           WHEN (DISTR-9 AND
                 LIFE-CLAIM-TYPE)
               ADD +1                        TO WS-LIF-DISTR9-CNT
           END-EVALUATE



      ******* SERVICE TIME EXCEPTION REPORT
           IF DC-ELAPSED-DAYS > WS-ACCEPTABLE-SVC-TIME

               MOVE DC-ELAPSED-DAYS          TO WS-D4-CLM-SVC-TIME
               MOVE CL-CLAIM-NO              TO WS-D4-CLAIM-NO
               MOVE CL-CERT-NO               TO WS-D4-POLICY-NO

122002         EVALUATE TRUE
122002         WHEN CL-CLAIM-TYPE = 'A'
                   MOVE WS-DIS-LABEL         TO WS-D4-CLAIM-TYPE

121603         WHEN CL-CLAIM-TYPE = 'G'
121603             MOVE WS-GP-LABEL          TO WS-D4-CLAIM-TYPE

122002         WHEN CL-CLAIM-TYPE = 'I'
122002             MOVE WS-IU-LABEL          TO WS-D4-CLAIM-TYPE

122002         WHEN CL-CLAIM-TYPE = 'L'
                   MOVE WS-LIFE-LABEL        TO WS-D4-CLAIM-TYPE
122002         END-EVALUATE

               IF PPFORM-PROCESSED-THIS-MO
                   MOVE WS-HOLD-PP-RECV-DT   TO DC-BIN-DATE-1
               ELSE
                   MOVE WS-HOLD-CLM-RECV-DT  TO DC-BIN-DATE-1
               END-IF

               MOVE SPACE                    TO DC-OPTION-CODE
               PERFORM 8500-DATE-CONVERSION  THRU 8500-EXIT

               IF NO-CONVERSION-ERROR
                   MOVE DC-GREG-DATE-1-EDIT  TO WS-D4-FORM-RCVD-DT
               ELSE
                   DISPLAY 'CONVERSION #2  ERROR IN PARA 2010- ERROR '
                                             DC-ERROR-CODE
                   PERFORM ABEND-PGM         THRU APS-EXIT
               END-IF


               IF WS-D4-ACTION = 'PAYMENT    '
                   MOVE WS-HOLD-PP-PAY-DT       TO DC-BIN-DATE-1
               ELSE
                   IF WS-D4-ACTION = '1ST PAYMENT'
                       MOVE WS-HOLD-1ST-PAY-DT  TO DC-BIN-DATE-1
                   ELSE
                       MOVE WS-HOLD-CLM-DENY-DT TO DC-BIN-DATE-1
                   END-IF
               END-IF


               MOVE SPACE                       TO DC-OPTION-CODE
               PERFORM 8500-DATE-CONVERSION     THRU 8500-EXIT

               IF NO-CONVERSION-ERROR
                   MOVE DC-GREG-DATE-1-EDIT     TO WS-D4-CLM-ACTION-DT
               ELSE
                   DISPLAY 'CONVERSION #3  ERROR IN PARA 2010- ERROR '
                                                DC-ERROR-CODE
                   PERFORM ABEND-PGM            THRU APS-EXIT
               END-IF

               IF WS-LINE-COUNT >= WS-LINE-COUNT-MAX
                   MOVE WS-EXCEPTION-RPT-TITLE  TO WS-H1-TITLE
                   MOVE WS-HEADING1             TO PRT
                   PERFORM 2800-WRITE           THRU 2800-EXIT

                   MOVE WS-HEADING2             TO PRT
                   PERFORM 2800-WRITE           THRU 2800-EXIT

                   ADD +1                       TO WS-PAGE
                   MOVE WS-PAGE                 TO WS-H3-PAGE
                   MOVE WS-HEADING3             TO PRT
                   PERFORM 2800-WRITE           THRU 2800-EXIT

                   MOVE WS-HEADING4-EXCEPTIONS  TO PRT
                   PERFORM 2800-WRITE           THRU 2800-EXIT

                   MOVE SPACES                  TO PRT
                   MOVE '-'                     TO P-CTL
                   PERFORM 2800-WRITE           THRU 2800-EXIT
               END-IF

               MOVE WS-DETAIL4-EXCEPTIONS       TO PRT
               PERFORM 2800-WRITE               THRU 2800-EXIT

           END-IF

           .
       2010-EXIT.
           EXIT.

       2075-START-ELTRLR.

           MOVE LOW-VALUES                  TO AT-CONTROL-PRIMARY
           MOVE CL-CONTROL-PRIMARY          TO AT-CONTROL-PRIMARY (1:20)
           START ELTRLR-INFILE KEY NOT < AT-CONTROL-PRIMARY
           END-START

010704     EVALUATE TRUE
010704     WHEN WS-ELTRLR-FILE-STATUS = '00'
010704         CONTINUE

010704     WHEN WS-ELTRLR-FILE-STATUS = '23'
010704         SET END-OF-ELTRLR-ON-START TO TRUE
010704         GO TO 2075-EXIT

010704     WHEN OTHER
010704        DISPLAY ' ELTRLR START ' WS-ELTRLR-FILE-STATUS
              PERFORM ABEND-PGM             THRU APS-EXIT
010704     END-EVALUATE

           SET NEW-ELTRLR-KEY               TO TRUE
           SET LOOKING-FOR-CLM-RECV-DT      TO TRUE
           SET LOOKING-FOR-PP-RECV-DT       TO TRUE
           MOVE SPACES                      TO WS-HOLD-UNDW-RETURN-DT
           PERFORM 2100-READ-ELTRLR         THRU 2100-EXIT
               UNTIL ELTRLR-KEY-CHANGE  OR
                     END-OF-ELTRLR

           .
       2075-EXIT.
           EXIT.


       2100-READ-ELTRLR.

           MOVE SPACE                       TO SORT-MTD-OR-DAILY
           READ ELTRLR-INFILE NEXT RECORD
               AT END
                   SET END-OF-ELTRLR        TO TRUE
                   GO TO 2100-EXIT
           END-READ


           IF AT-CONTROL-PRIMARY (1:20) = CL-CONTROL-PRIMARY
               CONTINUE
           ELSE
               SET ELTRLR-KEY-CHANGE        TO TRUE
               GO TO 2100-EXIT
           END-IF

           MOVE AT-TRAILER-TYPE             TO WS-TRAILER-TYPE
           IF COUNTABLE-ACTIVITY
               CONTINUE
           ELSE
               GO TO 2100-EXIT
           END-IF

           IF (AT-RECORDED-DT >= WS-CURR-MNTH-STRT-DT-BIN AND
               AT-RECORDED-DT <= WS-PREV-CYCLE-DT-BINARY)
               MOVE 'M'                     TO SORT-MTD-OR-DAILY
           ELSE
               IF (AT-RECORDED-DT  > WS-PREV-CYCLE-DT-BINARY AND
                   AT-RECORDED-DT <= WS-CYCLE-DT-BINARY)
                   MOVE 'D'                 TO SORT-MTD-OR-DAILY
               END-IF
           END-IF

           MOVE AT-RECORDED-BY              TO SORT-AUDITOR
           MOVE +0                          TO SORT-HANDLE-TIME

           EVALUATE TRUE
           WHEN CORRESPONDENCE-TR
               IF SORT-MTD-OR-DAILY = SPACE
                   PERFORM 2102-CHK-OTHER-CORR-DATES THRU 2102-EXIT
               END-IF

               IF (AT-STD-LETTER-FORM = 'PP  ' AND
                   LOOKING-FOR-PP-RECV-DT)
                   MOVE AT-LETTER-ANSWERED-DT   TO WS-HOLD-PP-RECV-DT
                   SET ALREADY-HAVE-PP-RECV-DT  TO TRUE
               END-IF

               IF (AT-STD-LETTER-FORM = 'NC  ' AND
                   LOOKING-FOR-CLM-RECV-DT)
                   MOVE AT-LETTER-ANSWERED-DT   TO WS-HOLD-CLM-RECV-DT
                   SET ALREADY-HAVE-CLM-RECV-DT TO TRUE
               END-IF

               IF (AT-STD-LETTER-FORM = 'DC  ' AND
                   LOOKING-FOR-CLM-RECV-DT)
                   MOVE AT-LETTER-ANSWERED-DT   TO WS-HOLD-CLM-RECV-DT
                   SET ALREADY-HAVE-CLM-RECV-DT TO TRUE
               END-IF

               IF SORT-MTD-OR-DAILY = SPACE
                   GO TO 2100-EXIT
               END-IF

               PERFORM 2125-LETTERS-FORMS   THRU 2125-EXIT


           WHEN GENERAL-INFO-TR
               IF SORT-MTD-OR-DAILY = SPACE
                   GO TO 2100-EXIT
               END-IF

               PERFORM 2135-NOTES-CALLS     THRU 2135-EXIT


           WHEN PAYMENT-TR
               IF (AT-CHECK-WRITTEN-DT >= WS-CURR-MNTH-STRT-DT-BIN AND
                   AT-CHECK-WRITTEN-DT <= WS-PREV-CYCLE-DT-BINARY)
                   MOVE 'M'                 TO SORT-MTD-OR-DAILY
               ELSE
                   IF (AT-CHECK-WRITTEN-DT  > WS-PREV-CYCLE-DT-BINARY
                       AND
                       AT-CHECK-WRITTEN-DT <= WS-CYCLE-DT-BINARY)
                       MOVE 'D'             TO SORT-MTD-OR-DAILY
                   END-IF
               END-IF

               IF ((AT-VOID-DT = SPACES OR
                   AT-VOID-DT = LOW-VALUES) AND
                   LOOKING-FOR-CLM-RECV-DT)
                   MOVE AT-CHECK-WRITTEN-DT TO WS-HOLD-1ST-PAY-DT
               END-IF


               IF ((AT-VOID-DT = SPACES OR
                   AT-VOID-DT = LOW-VALUES) AND
                   LOOKING-FOR-PP-RECV-DT)
                   MOVE AT-CHECK-WRITTEN-DT TO WS-HOLD-PP-PAY-DT
               END-IF


               IF SORT-MTD-OR-DAILY = SPACE
                   PERFORM 2105-CHK-OTHER-PAY-DATES  THRU 2105-EXIT
               END-IF

               IF SORT-MTD-OR-DAILY = SPACE
                   GO TO 2100-EXIT
               END-IF

               PERFORM 2145-PAYMENTS        THRU 2145-EXIT


           WHEN DENIAL-TR
               IF SORT-MTD-OR-DAILY = SPACE
                   PERFORM 2108-CHK-OTHER-DENY-DATES THRU 2108-EXIT
               END-IF

               IF SORT-MTD-OR-DAILY = SPACE
                   GO TO 2100-EXIT
               END-IF

               PERFORM 2155-DENIALS         THRU 2155-EXIT
           END-EVALUATE

           .
       2100-EXIT.
           EXIT.


       2102-CHK-OTHER-CORR-DATES.

           IF (AT-LETTER-ANSWERED-DT >= WS-CURR-MNTH-STRT-DT-BIN AND
               AT-LETTER-ANSWERED-DT <= WS-PREV-CYCLE-DT-BINARY)
               MOVE 'M'                     TO SORT-MTD-OR-DAILY
           ELSE
               IF (AT-LETTER-ANSWERED-DT  > WS-PREV-CYCLE-DT-BINARY AND
                   AT-LETTER-ANSWERED-DT <= WS-CYCLE-DT-BINARY)
                   MOVE 'D'                 TO SORT-MTD-OR-DAILY
               END-IF
           END-IF

           .
       2102-EXIT.
           EXIT.


       2105-CHK-OTHER-PAY-DATES.

           IF (AT-VOID-DT >= WS-CURR-MNTH-STRT-DT-BIN AND
               AT-VOID-DT <= WS-PREV-CYCLE-DT-BINARY)
               MOVE 'M'                     TO SORT-MTD-OR-DAILY
           ELSE
               IF (AT-VOID-DT  > WS-PREV-CYCLE-DT-BINARY AND
                   AT-VOID-DT <= WS-CYCLE-DT-BINARY)
                   MOVE 'D'                 TO SORT-MTD-OR-DAILY
               END-IF
           END-IF

           .
       2105-EXIT.
           EXIT.



       2108-CHK-OTHER-DENY-DATES.

           IF (AT-DENIAL-LAST-MAINT-DT >= WS-CURR-MNTH-STRT-DT-BIN AND
               AT-DENIAL-LAST-MAINT-DT <= WS-PREV-CYCLE-DT-BINARY)
               MOVE 'M'                     TO SORT-MTD-OR-DAILY
           ELSE
               IF (AT-DENIAL-LAST-MAINT-DT  > WS-PREV-CYCLE-DT-BINARY
                   AND
                   AT-DENIAL-LAST-MAINT-DT <= WS-CYCLE-DT-BINARY)
                   MOVE 'D'                 TO SORT-MTD-OR-DAILY
               END-IF
           END-IF

           .
       2108-EXIT.
           EXIT.


       2125-LETTERS-FORMS.


           MOVE 'L'                            TO SORT-REC-TYPE

      ******* THIS IS UNSOLICITED INCOMING MAIL
           IF (AT-LETTER-ANSWERED-DT < AT-RECORDED-DT AND
               AT-LETTER-ANSWERED-DT > SPACES)
               MOVE AT-RECORDED-DT             TO DC-BIN-DATE-2
               PERFORM 2200-CALC-HANDLE-TIME   THRU 2200-EXIT
               PERFORM 2900-RELEASE-SORT       THRU 2900-EXIT
               GO TO 2125-EXIT
           END-IF

      ******* RESPONSE TO A PREVIOUSLY SENT LETTER IS RECEIVED
      ******* CREATE 2 RECS 1 FOR LTR SENT ACTN, 1 FOR LTR RECEIVED ACTN
           IF AT-LETTER-ANSWERED-DT > AT-RECORDED-DT
               PERFORM 2900-RELEASE-SORT       THRU 2900-EXIT

               MOVE AT-CORR-LAST-MAINT-DT      TO DC-BIN-DATE-2
               PERFORM 2200-CALC-HANDLE-TIME   THRU 2200-EXIT

               MOVE AT-CORR-LAST-UPDATED-BY    TO SORT-AUDITOR
               PERFORM 2900-RELEASE-SORT       THRU 2900-EXIT

               GO TO 2125-EXIT
           END-IF

           PERFORM 2900-RELEASE-SORT           THRU 2900-EXIT

           .
       2125-EXIT.
           EXIT.


       2135-NOTES-CALLS.

           IF AT-CALL-NOTE
               IF AT-PHONE-CALL-IN
                   MOVE 'I'                  TO SORT-REC-TYPE
               ELSE
                   MOVE 'O'                  TO SORT-REC-TYPE
               END-IF

               PERFORM 2900-RELEASE-SORT     THRU 2900-EXIT
               GO TO 2135-EXIT
           END-IF

      ************* SERVICE TIME IS TRACKED FOR UNDERWRITING ACTIVITY
      *************   NOTES PREFIXED BY 'UNWS' = SENT TO UNDERWRITING
      *************   AND 'UNWR' = RETURNED FROM UNDERWRITING
           IF AT-INFO-LINE-1(1:4) = 'UNWR'
               MOVE AT-RECORDED-DT           TO WS-HOLD-UNDW-RETURN-DT
           END-IF

           IF (AT-INFO-LINE-1(1:4) = 'UNWS' AND
               WS-HOLD-UNDW-RETURN-DT > SPACES)

               MOVE AT-RECORDED-DT           TO DC-BIN-DATE-1
               MOVE WS-HOLD-UNDW-RETURN-DT   TO DC-BIN-DATE-2
               MOVE '1'                      TO DC-OPTION-CODE
               PERFORM 8500-DATE-CONVERSION  THRU 8500-EXIT

               IF NO-CONVERSION-ERROR
                   MOVE DC-ELAPSED-DAYS      TO SORT-HANDLE-TIME
                   MOVE 'U'                  TO SORT-REC-TYPE
      ************* REC TYPE 'U' IS FOR THE SVC TIME REPORT ONLY
      ************* THIS NOTE TRAILER WILL BE COUNTED AS A REC TYPE 'G'
                   PERFORM 2900-RELEASE-SORT THRU 2900-EXIT
                   MOVE +0                   TO SORT-HANDLE-TIME
                   MOVE SPACES               TO WS-HOLD-UNDW-RETURN-DT
               ELSE
                   DISPLAY 'CONVERSION ERROR IN PARA 2135- ERROR '
                                             DC-ERROR-CODE
                   PERFORM ABEND-PGM         THRU APS-EXIT
               END-IF
           END-IF

           MOVE 'G'                          TO SORT-REC-TYPE
           PERFORM 2900-RELEASE-SORT         THRU 2900-EXIT

           .
       2135-EXIT.
           EXIT.


       2145-PAYMENTS.

           IF CLAIM-COUNTED
               CONTINUE
           ELSE
               IF (AT-CHECK-WRITTEN-DT > SPACES AND
                   (AT-VOID-DT = SPACES OR
                    AT-VOID-DT = LOW-VALUES))
                   MOVE 'C'                  TO SORT-REC-TYPE
                   PERFORM 2900-RELEASE-SORT THRU 2900-EXIT
                   SET CLAIM-COUNTED         TO TRUE
               END-IF
           END-IF


           IF AT-CHECK-WRITTEN-DT > SPACES
               MOVE 'P'                      TO SORT-REC-TYPE
               PERFORM 2900-RELEASE-SORT     THRU 2900-EXIT
           END-IF

           IF (AT-VOID-DT = LOW-VALUES OR
               AT-VOID-DT = SPACES)
               GO TO 2145-EXIT
           ELSE
               IF (AT-CHECK-WRITTEN-DT = SPACES OR
                   AT-CHECK-WRITTEN-DT = LOW-VALUES)
      ************* VOID - CHECK NEVER ISSUED
                   MOVE 'V'                  TO SORT-REC-TYPE
               ELSE
      ************* STOP-PAY
                   MOVE 'S'                  TO SORT-REC-TYPE
               END-IF

               IF (AT-VOID-DT >= WS-CURR-MNTH-STRT-DT-BIN AND
                   AT-VOID-DT <= WS-PREV-CYCLE-DT-BINARY)
                   MOVE AT-PAYMENT-LAST-UPDATED-BY TO SORT-AUDITOR
                   MOVE 'M'                        TO SORT-MTD-OR-DAILY
                   PERFORM 2900-RELEASE-SORT       THRU 2900-EXIT
               ELSE
                   IF (AT-VOID-DT  > WS-PREV-CYCLE-DT-BINARY AND
                       AT-VOID-DT <= WS-CYCLE-DT-BINARY)
                       MOVE AT-PAYMENT-LAST-UPDATED-BY TO SORT-AUDITOR
                       MOVE 'D'                    TO SORT-MTD-OR-DAILY
                       PERFORM 2900-RELEASE-SORT   THRU 2900-EXIT
                   END-IF
               END-IF
           END-IF

           .
       2145-EXIT.
           EXIT.


       2155-DENIALS.

           IF (AT-RETRACTION-DT = SPACES OR
               AT-RETRACTION-DT = LOW-VALUES)
               MOVE 'R'                     TO SORT-REC-TYPE
               PERFORM 2900-RELEASE-SORT    THRU 2900-EXIT
           END-IF

           .
       2155-EXIT.
           EXIT.


       2200-CALC-HANDLE-TIME.

           MOVE AT-LETTER-ANSWERED-DT       TO DC-BIN-DATE-1
           MOVE '1'                         TO DC-OPTION-CODE
           PERFORM 8500-DATE-CONVERSION     THRU 8500-EXIT

           IF NO-CONVERSION-ERROR
               MOVE DC-ELAPSED-DAYS         TO SORT-HANDLE-TIME
           ELSE
               DISPLAY 'CONVERSION ERROR IN PARA 2200- ERROR '
                                            DC-ERROR-CODE
082302*        PERFORM ABEND-PGM            THRU APS-EXIT
082302         GO TO 2200-EXIT
           END-IF

           .
       2200-EXIT.
           EXIT.


       2800-WRITE.

           EVALUATE TRUE
           WHEN P-CTL = '1'
               MOVE +1                      TO WS-LINE-COUNT

           WHEN P-CTL = SPACE
               ADD +1                       TO WS-LINE-COUNT

           WHEN P-CTL = '0'
               ADD +2                       TO WS-LINE-COUNT

           WHEN OTHER
               ADD +3                       TO WS-LINE-COUNT
           END-EVALUATE


           WRITE PRT

           .
       2800-EXIT.
           EXIT.


       2900-RELEASE-SORT.

           IF SORT-AUDITOR(3:1) = SPACE
               DISPLAY "2 CHAR AUDITOR ID" AT-CONTROL-PRIMARY
           END-IF

           RELEASE SORT-RECORD

           .
       2900-EXIT.
           EXIT.




       3000-OUTPUT-PROCEDURE.

           MOVE ZERO                           TO WS-PAGE
           MOVE +55                            TO WS-LINE-COUNT
           MOVE WS-AUDITOR-RPT-TITLE           TO WS-H1-TITLE

           PERFORM 3020-RETURN-SORT            THRU 3020-EXIT
               UNTIL END-OF-SORTFILE

010704     IF WS-SORT-RET-CNT >= +1
122002         PERFORM 3050-MOVE-DLY-FLDS          THRU 3050-EXIT
122002         PERFORM 3100-PRINT-DETAIL1          THRU 3100-EXIT
122002         PERFORM 3055-MOVE-MTD-FLDS          THRU 3055-EXIT
122002         PERFORM 3105-PRINT-DETAIL2          THRU 3105-EXIT
               PERFORM 3200-TOTALS                 THRU 3200-EXIT
               PERFORM 3275-GRAND-TOTALS           THRU 3275-EXIT


               PERFORM 3300-PRINT-HANDLE-TIME-RPT  THRU 3300-EXIT
               PERFORM 3400-PRINT-SERVICE-TIME-RPT THRU 3400-EXIT
               PERFORM 3600-PRINT-DISTRIBUTION-RPT THRU 3600-EXIT
010704     ELSE
010704         PERFORM 3800-PRINT-HEADINGS         THRU 3800-EXIT
010704         MOVE '0NO ACTIVITY FOR EL586 REPORT SERIES' TO PRT
010704         PERFORM 3900-WRITE                  THRU 3900-EXIT
010704     END-IF

           .
       3000-EXIT.
           EXIT.


       3020-RETURN-SORT.

           RETURN SORT-FILE AT END
               SET END-OF-SORTFILE          TO TRUE
               GO TO 3020-EXIT
           END-RETURN

010704     ADD +1                           TO WS-SORT-RET-CNT
      ***** TEMPORARY FIX - NEED TO FORCE VALID USER ID (IE. PGM EL162)
           IF SORT-AUDITOR(3:1) = SPACE
               GO TO 3020-EXIT
           END-IF

           IF FIRST-SORT-RECORD
               MOVE SORT-CLAIM-TYPE         TO WS-HOLD-CLAIM-TYPE
               MOVE SORT-AUDITOR            TO WS-HOLD-AUDITOR
               SET NOT-FIRST-RECORD         TO TRUE
           END-IF

           IF SORT-CLAIM-TYPE = WS-HOLD-CLAIM-TYPE
               IF SORT-AUDITOR(1:3) = WS-HOLD-AUDITOR(1:3)
                   CONTINUE
               ELSE
122002             PERFORM 3050-MOVE-DLY-FLDS THRU 3050-EXIT
122002             PERFORM 3100-PRINT-DETAIL1 THRU 3100-EXIT
122002             PERFORM 3055-MOVE-MTD-FLDS THRU 3055-EXIT
122002             PERFORM 3105-PRINT-DETAIL2 THRU 3105-EXIT
                   MOVE SORT-AUDITOR          TO WS-HOLD-AUDITOR
               END-IF
           ELSE
122002         PERFORM 3050-MOVE-DLY-FLDS     THRU 3050-EXIT
122002         PERFORM 3100-PRINT-DETAIL1     THRU 3100-EXIT
122002         PERFORM 3055-MOVE-MTD-FLDS     THRU 3055-EXIT
122002         PERFORM 3105-PRINT-DETAIL2     THRU 3105-EXIT
122002         PERFORM 3200-TOTALS            THRU 3200-EXIT

               MOVE SORT-CLAIM-TYPE           TO WS-HOLD-CLAIM-TYPE
               MOVE SORT-AUDITOR              TO WS-HOLD-AUDITOR
           END-IF


           EVALUATE TRUE
      ***** LETTERS/FORMS
           WHEN SORT-REC-TYPE = 'L'
               IF SORT-MTD-OR-DAILY = 'D'
122002             ADD +1                   TO WS-DLY-LETTER-CNT
               END-IF
122002         ADD +1                       TO WS-MTD-LETTER-CNT

      ***** PAYMENTS/DRAFTS ISSUED
           WHEN SORT-REC-TYPE = 'P'
               IF SORT-MTD-OR-DAILY = 'D'
122002             ADD +1                   TO WS-DLY-DRAFT-CNT
               END-IF
               ADD +1                       TO WS-MTD-DRAFT-CNT

      ***** CLAIMS PAID - NOT COUNTING MULTIPLE DRAFTS
           WHEN SORT-REC-TYPE = 'C'
               IF SORT-MTD-OR-DAILY = 'D'
                   ADD +1                   TO WS-DLY-PD-CLM-CNT
               END-IF
               ADD +1                       TO WS-MTD-PD-CLM-CNT

      ***** NOTES (INTERNAL)
           WHEN SORT-REC-TYPE = 'G'
               IF SORT-MTD-OR-DAILY = 'D'
                   ADD +1                   TO WS-DLY-NOTE-CNT
               END-IF
               ADD +1                       TO WS-MTD-NOTE-CNT

      ***** NOTES (UNDERWRITING)
           WHEN SORT-REC-TYPE = 'U'
122002         EVALUATE TRUE
122002         WHEN SORT-MTD-OR-DAILY = 'D' AND
122002              SORT-CLAIM-TYPE = 'A' 
                   ADD +1                   TO WS-DLY-DIS-UNW-HANDLES
                   ADD SORT-HANDLE-TIME     TO WS-DLY-DIS-UNW-HTIME
                   ADD +1                   TO WS-MTD-DIS-UNW-HANDLES
                   ADD SORT-HANDLE-TIME     TO WS-MTD-DIS-UNW-HTIME

122002         WHEN SORT-MTD-OR-DAILY = 'M' AND
122002              SORT-CLAIM-TYPE = 'A'
122002             ADD +1                   TO WS-MTD-DIS-UNW-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-MTD-DIS-UNW-HTIME

121603         WHEN SORT-MTD-OR-DAILY = 'D' AND
121603              SORT-CLAIM-TYPE = 'G' 
121603             ADD +1                   TO WS-DLY-GP-UNW-HANDLES
121603             ADD SORT-HANDLE-TIME     TO WS-DLY-GP-UNW-HTIME
121603             ADD +1                   TO WS-MTD-GP-UNW-HANDLES
121603             ADD SORT-HANDLE-TIME     TO WS-MTD-GP-UNW-HTIME

121603         WHEN SORT-MTD-OR-DAILY = 'M' AND
121603              SORT-CLAIM-TYPE = 'G'
121603             ADD +1                   TO WS-MTD-GP-UNW-HANDLES
121603             ADD SORT-HANDLE-TIME     TO WS-MTD-GP-UNW-HTIME

122002         WHEN SORT-MTD-OR-DAILY = 'D' AND
122002              SORT-CLAIM-TYPE = 'I' 
122002             ADD +1                   TO WS-DLY-IU-UNW-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-DLY-IU-UNW-HTIME
122002             ADD +1                   TO WS-MTD-IU-UNW-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-MTD-IU-UNW-HTIME

122002         WHEN SORT-MTD-OR-DAILY = 'M' AND
122002              SORT-CLAIM-TYPE = 'I'
122002             ADD +1                   TO WS-MTD-IU-UNW-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-MTD-IU-UNW-HTIME

122002         WHEN SORT-MTD-OR-DAILY = 'D' AND
122002              SORT-CLAIM-TYPE = 'L' 
122002             ADD +1                   TO WS-DLY-LIF-UNW-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-DLY-LIF-UNW-HTIME
122002             ADD +1                   TO WS-MTD-LIF-UNW-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-MTD-LIF-UNW-HTIME

122002         WHEN SORT-MTD-OR-DAILY = 'M' AND
122002              SORT-CLAIM-TYPE = 'L'
122002             ADD +1                   TO WS-MTD-LIF-UNW-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-MTD-LIF-UNW-HTIME
122002         END-EVALUATE

      ***** VOIDS - CHECKS NEVER PRINTED
           WHEN SORT-REC-TYPE = 'V'
               IF SORT-MTD-OR-DAILY = 'D'
                   ADD +1                   TO WS-DLY-VOID-CNT
               END-IF
               ADD +1                       TO WS-MTD-VOID-CNT

      ***** STOP-PAYS - DRAFTS ALREADY ISSUED
           WHEN SORT-REC-TYPE = 'S'
               IF SORT-MTD-OR-DAILY = 'D'
                   ADD +1                   TO WS-DLY-STOPPAY-CNT
               END-IF
               ADD +1                       TO WS-MTD-STOPPAY-CNT

      ***** NEW CLAIM ENTRIES
           WHEN SORT-REC-TYPE = 'N'
               IF SORT-MTD-OR-DAILY = 'D'
                   ADD +1                   TO WS-DLY-NEW-CLM-CNT
               END-IF
               ADD +1                       TO WS-MTD-NEW-CLM-CNT

      ***** INCOMING CALLS
           WHEN SORT-REC-TYPE = 'I'
               IF SORT-MTD-OR-DAILY = 'D'
                   ADD +1                   TO WS-DLY-CALLIN-CNT
               END-IF
               ADD +1                       TO WS-MTD-CALLIN-CNT

      ***** OUTGOING CALLS
           WHEN SORT-REC-TYPE = 'O'
               IF SORT-MTD-OR-DAILY = 'D'
                   ADD +1                   TO WS-DLY-CALLOUT-CNT
               END-IF
               ADD +1                       TO WS-MTD-CALLOUT-CNT

      ***** DENIALS
           WHEN SORT-REC-TYPE = 'R'
               IF SORT-MTD-OR-DAILY = 'D'
                   ADD +1                   TO WS-DLY-DENIAL-CNT
               END-IF
               ADD +1                       TO WS-MTD-DENIAL-CNT

      ***** DROPS/AUTO OR MANUAL CLOSINGS
           WHEN SORT-REC-TYPE = 'D'
               IF SORT-MTD-OR-DAILY = 'D'
                   ADD +1                   TO WS-DLY-DROP-CNT
               END-IF
               ADD +1                       TO WS-MTD-DROP-CNT

      ***** REOPENS
           WHEN SORT-REC-TYPE = 'X'
               IF SORT-MTD-OR-DAILY = 'D'
                   ADD +1                   TO WS-DLY-REOPEN-CNT
               END-IF
               ADD +1                       TO WS-MTD-REOPEN-CNT

           END-EVALUATE

      ******* REC TYPE 'U' (UNDERWRITING) SERVICE TIME IS INCLUDED IN
      ******* THE DEPARTMENT TOTAL

           IF SORT-HANDLE-TIME > +0
122002         EVALUATE TRUE
122002         WHEN SORT-MTD-OR-DAILY = 'D' AND
122002              SORT-CLAIM-TYPE = 'A'
                   ADD +1                   TO WS-DLY-DIS-SVC-HANDLES
                   ADD SORT-HANDLE-TIME     TO WS-DLY-DIS-HANDLE-TIME
                   ADD +1                   TO WS-MTD-DIS-SVC-HANDLES
                   ADD SORT-HANDLE-TIME     TO WS-MTD-DIS-HANDLE-TIME

122002         WHEN SORT-MTD-OR-DAILY = 'M' AND
122002              SORT-CLAIM-TYPE = 'A'
122002             ADD +1                   TO WS-MTD-DIS-SVC-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-MTD-DIS-HANDLE-TIME

121603         WHEN SORT-MTD-OR-DAILY = 'D' AND
121603              SORT-CLAIM-TYPE = 'G'
121603             ADD +1                   TO WS-DLY-GP-SVC-HANDLES
121603             ADD SORT-HANDLE-TIME     TO WS-DLY-GP-HANDLE-TIME
121603             ADD +1                   TO WS-MTD-GP-SVC-HANDLES
121603             ADD SORT-HANDLE-TIME     TO WS-MTD-GP-HANDLE-TIME

121603         WHEN SORT-MTD-OR-DAILY = 'M' AND
121603              SORT-CLAIM-TYPE = 'G'
121603             ADD +1                   TO WS-MTD-GP-SVC-HANDLES
121603             ADD SORT-HANDLE-TIME     TO WS-MTD-GP-HANDLE-TIME

122002         WHEN SORT-MTD-OR-DAILY = 'D' AND
122002              SORT-CLAIM-TYPE = 'I'
122002             ADD +1                   TO WS-DLY-IU-SVC-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-DLY-IU-HANDLE-TIME
122002             ADD +1                   TO WS-MTD-IU-SVC-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-MTD-IU-HANDLE-TIME

122002         WHEN SORT-MTD-OR-DAILY = 'M' AND
122002              SORT-CLAIM-TYPE = 'I'
122002             ADD +1                   TO WS-MTD-IU-SVC-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-MTD-IU-HANDLE-TIME

122002         WHEN SORT-MTD-OR-DAILY = 'D' AND
122002              SORT-CLAIM-TYPE = 'L'
122002             ADD +1                   TO WS-DLY-LIF-SVC-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-DLY-LIF-HANDLE-TIME
122002             ADD +1                   TO WS-MTD-LIF-SVC-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-MTD-LIF-HANDLE-TIME

122002         WHEN SORT-MTD-OR-DAILY = 'M' AND
122002              SORT-CLAIM-TYPE = 'L'
122002             ADD +1                   TO WS-MTD-LIF-SVC-HANDLES
122002             ADD SORT-HANDLE-TIME     TO WS-MTD-LIF-HANDLE-TIME
122002         END-EVALUATE
122002     END-IF

           .
       3020-EXIT.
           EXIT.


       3050-MOVE-DLY-FLDS.

           INITIALIZE WS-DETAIL1
           MOVE WS-EDITED-CYCLE-DT          TO WS-D1-COL1-VARIABLE
           MOVE WS-HOLD-AUDITOR             TO WS-D1-AUDITOR

           MOVE WS-DLY-NEW-CLM-CNT          TO WS-D1-NEW-CLM-CNT
           MOVE WS-DLY-PD-CLM-CNT           TO WS-D1-PD-CLM-CNT
           MOVE WS-DLY-DRAFT-CNT            TO WS-D1-DRAFT-CNT
           MOVE WS-DLY-VOID-CNT             TO WS-D1-VOID-CNT
           MOVE WS-DLY-STOPPAY-CNT          TO WS-D1-STOPPAY-CNT
           MOVE WS-DLY-LETTER-CNT           TO WS-D1-LETTER-CNT
           MOVE WS-DLY-NOTE-CNT             TO WS-D1-NOTE-CNT
           MOVE WS-DLY-CALLIN-CNT           TO WS-D1-CALLIN-CNT
           MOVE WS-DLY-CALLOUT-CNT          TO WS-D1-CALLOUT-CNT
           MOVE WS-DLY-DENIAL-CNT           TO WS-D1-DENIAL-CNT

           ADD WS-DLY-NEW-CLM-CNT           TO WS-TOTD-NEW-CLM-CNT
           ADD WS-DLY-PD-CLM-CNT            TO WS-TOTD-PD-CLM-CNT
           ADD WS-DLY-DRAFT-CNT             TO WS-TOTD-DRAFT-CNT
           ADD WS-DLY-VOID-CNT              TO WS-TOTD-VOID-CNT
           ADD WS-DLY-STOPPAY-CNT           TO WS-TOTD-STOPPAY-CNT
           ADD WS-DLY-LETTER-CNT            TO WS-TOTD-LETTER-CNT
           ADD WS-DLY-NOTE-CNT              TO WS-TOTD-NOTE-CNT
           ADD WS-DLY-CALLIN-CNT            TO WS-TOTD-CALLIN-CNT
           ADD WS-DLY-CALLOUT-CNT           TO WS-TOTD-CALLOUT-CNT
           ADD WS-DLY-DENIAL-CNT            TO WS-TOTD-DENIAL-CNT
           ADD WS-DLY-DROP-CNT              TO WS-TOTD-DROP-CNT
           ADD WS-DLY-REOPEN-CNT            TO WS-TOTD-REOPEN-CNT

           INITIALIZE WS-DLY-COUNTS

           .
       3050-EXIT.
           EXIT.


       3055-MOVE-MTD-FLDS.

           INITIALIZE WS-DETAIL1
           MOVE WS-MTD-LITERAL              TO WS-D1-COL1-VARIABLE
           MOVE WS-HOLD-AUDITOR             TO WS-D1-AUDITOR

           MOVE WS-MTD-NEW-CLM-CNT          TO WS-D1-NEW-CLM-CNT
           MOVE WS-MTD-PD-CLM-CNT           TO WS-D1-PD-CLM-CNT
           MOVE WS-MTD-DRAFT-CNT            TO WS-D1-DRAFT-CNT
           MOVE WS-MTD-VOID-CNT             TO WS-D1-VOID-CNT
           MOVE WS-MTD-STOPPAY-CNT          TO WS-D1-STOPPAY-CNT
           MOVE WS-MTD-LETTER-CNT           TO WS-D1-LETTER-CNT
           MOVE WS-MTD-NOTE-CNT             TO WS-D1-NOTE-CNT
           MOVE WS-MTD-CALLIN-CNT           TO WS-D1-CALLIN-CNT
           MOVE WS-MTD-CALLOUT-CNT          TO WS-D1-CALLOUT-CNT
           MOVE WS-MTD-DENIAL-CNT           TO WS-D1-DENIAL-CNT

           ADD WS-MTD-NEW-CLM-CNT           TO WS-TOTM-NEW-CLM-CNT
           ADD WS-MTD-PD-CLM-CNT            TO WS-TOTM-PD-CLM-CNT
           ADD WS-MTD-DRAFT-CNT             TO WS-TOTM-DRAFT-CNT
           ADD WS-MTD-VOID-CNT              TO WS-TOTM-VOID-CNT
           ADD WS-MTD-STOPPAY-CNT           TO WS-TOTM-STOPPAY-CNT
           ADD WS-MTD-LETTER-CNT            TO WS-TOTM-LETTER-CNT
           ADD WS-MTD-NOTE-CNT              TO WS-TOTM-NOTE-CNT
           ADD WS-MTD-CALLIN-CNT            TO WS-TOTM-CALLIN-CNT
           ADD WS-MTD-CALLOUT-CNT           TO WS-TOTM-CALLOUT-CNT
           ADD WS-MTD-DENIAL-CNT            TO WS-TOTM-DENIAL-CNT
           ADD WS-MTD-DROP-CNT              TO WS-TOTM-DROP-CNT
           ADD WS-MTD-REOPEN-CNT            TO WS-TOTM-REOPEN-CNT

           INITIALIZE WS-MTD-COUNTS

           .
       3055-EXIT.
           EXIT.


       3100-PRINT-DETAIL1.

           IF WS-LINE-COUNT >= WS-LINE-COUNT-MAX
               PERFORM 3800-PRINT-HEADINGS  THRU 3800-EXIT
               MOVE WS-HEADING4             TO PRT
               PERFORM 3900-WRITE           THRU 3900-EXIT
               MOVE WS-HEADING5             TO PRT
               PERFORM 3900-WRITE           THRU 3900-EXIT
           END-IF

           MOVE WS-DETAIL1-A                TO PRT
           MOVE '0'                         TO P-CTL
           PERFORM 3900-WRITE               THRU 3900-EXIT

           .
       3100-EXIT.
           EXIT.


       3105-PRINT-DETAIL2.

           MOVE WS-DETAIL1-A                TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           .
       3105-EXIT.
           EXIT.


122002 3200-TOTALS.

122002     EVALUATE TRUE
122002     WHEN WS-HOLD-CLAIM-TYPE = 'A'
122002         MOVE WS-AUD-RPT-DIS-SUBT-HDR TO PRT

121603     WHEN WS-HOLD-CLAIM-TYPE = 'G'
121603         MOVE WS-AUD-RPT-GP-SUBT-HDR TO PRT

122002     WHEN WS-HOLD-CLAIM-TYPE = 'I'
122002         MOVE WS-AUD-RPT-IU-SUBT-HDR TO PRT

122002     WHEN WS-HOLD-CLAIM-TYPE = 'L'
122002         MOVE WS-AUD-RPT-LIF-SUBT-HDR TO PRT
122002     END-EVALUATE

           PERFORM 3900-WRITE               THRU 3900-EXIT

           INITIALIZE WS-DETAIL1
           MOVE WS-EDITED-CYCLE-DT          TO WS-LABEL-VARIABLE-2
           MOVE WS-REPORT-LABEL             TO WS-TOTALS-LABEL

           MOVE WS-TOTD-NEW-CLM-CNT         TO WS-D1-NEW-CLM-CNT
           MOVE WS-TOTD-PD-CLM-CNT          TO WS-D1-PD-CLM-CNT
           MOVE WS-TOTD-DRAFT-CNT           TO WS-D1-DRAFT-CNT
           MOVE WS-TOTD-VOID-CNT            TO WS-D1-VOID-CNT
           MOVE WS-TOTD-STOPPAY-CNT         TO WS-D1-STOPPAY-CNT
           MOVE WS-TOTD-LETTER-CNT          TO WS-D1-LETTER-CNT
           MOVE WS-TOTD-NOTE-CNT            TO WS-D1-NOTE-CNT
           MOVE WS-TOTD-CALLIN-CNT          TO WS-D1-CALLIN-CNT
           MOVE WS-TOTD-CALLOUT-CNT         TO WS-D1-CALLOUT-CNT
           MOVE WS-TOTD-DENIAL-CNT          TO WS-D1-DENIAL-CNT
           MOVE WS-TOTD-DROP-CNT            TO WS-D1-DROP-CNT
           MOVE WS-TOTD-REOPEN-CNT          TO WS-D1-REOPEN-CNT
           MOVE WS-DETAIL1                  TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT


           INITIALIZE WS-DETAIL1
           MOVE WS-TOTM-NEW-CLM-CNT         TO WS-D1-NEW-CLM-CNT
           ADD WS-TOTM-NEW-CLM-CNT          TO WS-GRAND-TOT-NEW-CLM-CNT

           MOVE WS-TOTM-PD-CLM-CNT          TO WS-D1-PD-CLM-CNT
           ADD WS-TOTM-PD-CLM-CNT           TO WS-GRAND-TOT-PD-CLM-CNT

           MOVE WS-TOTM-DRAFT-CNT           TO WS-D1-DRAFT-CNT
           ADD WS-TOTM-DRAFT-CNT            TO WS-GRAND-TOT-DRAFT-CNT

           MOVE WS-TOTM-VOID-CNT            TO WS-D1-VOID-CNT
           ADD WS-TOTM-VOID-CNT             TO WS-GRAND-TOT-VOID-CNT

           MOVE WS-TOTM-STOPPAY-CNT         TO WS-D1-STOPPAY-CNT
           ADD WS-TOTM-STOPPAY-CNT          TO WS-GRAND-TOT-STOPPAY-CNT

           MOVE WS-TOTM-LETTER-CNT          TO WS-D1-LETTER-CNT
           ADD WS-TOTM-LETTER-CNT           TO WS-GRAND-TOT-LETTER-CNT

           MOVE WS-TOTM-NOTE-CNT            TO WS-D1-NOTE-CNT
           ADD WS-TOTM-NOTE-CNT             TO WS-GRAND-TOT-NOTE-CNT

           MOVE WS-TOTM-CALLIN-CNT          TO WS-D1-CALLIN-CNT
           ADD WS-TOTM-CALLIN-CNT           TO WS-GRAND-TOT-CALLIN-CNT

           MOVE WS-TOTM-CALLOUT-CNT         TO WS-D1-CALLOUT-CNT
           ADD WS-TOTM-CALLOUT-CNT          TO WS-GRAND-TOT-CALLOUT-CNT

           MOVE WS-TOTM-DENIAL-CNT          TO WS-D1-DENIAL-CNT
           ADD WS-TOTM-DENIAL-CNT           TO WS-GRAND-TOT-DENIAL-CNT

           MOVE WS-TOTM-DROP-CNT            TO WS-D1-DROP-CNT
           ADD WS-TOTM-DROP-CNT             TO WS-GRAND-TOT-DROP-CNT

           MOVE WS-TOTM-REOPEN-CNT          TO WS-D1-REOPEN-CNT
           ADD WS-TOTM-REOPEN-CNT           TO WS-GRAND-TOT-REOPEN-CNT

           MOVE WS-MTD-LITERAL              TO WS-LABEL-VARIABLE-2
           MOVE WS-REPORT-LABEL             TO WS-TOTALS-LABEL
           MOVE WS-DETAIL1                  TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           MOVE SPACES                      TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

122002     INITIALIZE WS-TOTD-COUNTS
122002     INITIALIZE WS-TOTM-COUNTS

           .
       3200-EXIT.
           EXIT.


       3275-GRAND-TOTALS.

           INITIALIZE WS-DETAIL1
           MOVE WS-GRAND-TOTALS-LABEL       TO WS-TOTALS-LABEL

           MOVE WS-GRAND-TOT-NEW-CLM-CNT    TO WS-D1-NEW-CLM-CNT
           MOVE WS-GRAND-TOT-PD-CLM-CNT     TO WS-D1-PD-CLM-CNT
           MOVE WS-GRAND-TOT-DRAFT-CNT      TO WS-D1-DRAFT-CNT
           MOVE WS-GRAND-TOT-VOID-CNT       TO WS-D1-VOID-CNT
           MOVE WS-GRAND-TOT-STOPPAY-CNT    TO WS-D1-STOPPAY-CNT
           MOVE WS-GRAND-TOT-LETTER-CNT     TO WS-D1-LETTER-CNT
           MOVE WS-GRAND-TOT-NOTE-CNT       TO WS-D1-NOTE-CNT
           MOVE WS-GRAND-TOT-CALLIN-CNT     TO WS-D1-CALLIN-CNT
           MOVE WS-GRAND-TOT-CALLOUT-CNT    TO WS-D1-CALLOUT-CNT
           MOVE WS-GRAND-TOT-DENIAL-CNT     TO WS-D1-DENIAL-CNT
           MOVE WS-GRAND-TOT-DROP-CNT       TO WS-D1-DROP-CNT
           MOVE WS-GRAND-TOT-REOPEN-CNT     TO WS-D1-REOPEN-CNT
           MOVE WS-DETAIL1                  TO PRT
           MOVE '-'                         TO P-CTL
           PERFORM 3900-WRITE               THRU 3900-EXIT

           .
       3275-EXIT.
           EXIT.


       3300-PRINT-HANDLE-TIME-RPT.


           MOVE WS-HANDLE-TIME-RPT-TITLE    TO WS-H1-TITLE
           MOVE ZERO                        TO WS-PAGE
           PERFORM 3800-PRINT-HEADINGS      THRU 3800-EXIT

           MOVE WS-HEADING4-HANDLE-TIME     TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           MOVE WS-HEADING5-HANDLE-TIME     TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           MOVE SPACES                      TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT


      ***** DISABILITY - LINE 1  DAILY FIGURES
           MOVE WS-EDITED-CYCLE-DT          TO WS-LABEL-VARIABLE-1
           MOVE WS-DIS-LABEL                TO WS-LABEL-VARIABLE-2
           MOVE WS-REPORT-LABEL             TO WS-D2-COL1-LABEL
           MOVE WS-DLY-DIS-SVC-HANDLES      TO WS-D2-TOT-SVC-HANDLES
           MOVE WS-DLY-DIS-HANDLE-TIME      TO WS-D2-TOT-HANDLE-TIME

           IF WS-DLY-DIS-SVC-HANDLES NOT= +0
               DIVIDE WS-DLY-DIS-HANDLE-TIME
                   BY WS-DLY-DIS-SVC-HANDLES
                   GIVING WS-AVG-DLY-DIS-HANDLE-TIME
               MOVE WS-AVG-DLY-DIS-HANDLE-TIME
                                            TO WS-D2-AVERAGE-HANDLE-TIME
           END-IF

           MOVE WS-DLY-DIS-UNW-HANDLES      TO WS-D2-UNDWRITG-HANDLES
           MOVE WS-DLY-DIS-UNW-HTIME        TO WS-D2-UNDWRITG-HTIME

           IF WS-DLY-DIS-UNW-HANDLES NOT= +0
               DIVIDE WS-DLY-DIS-UNW-HTIME
                   BY WS-DLY-DIS-UNW-HANDLES
                   GIVING WS-AVG-DLY-DIS-UNW-HTIME
               MOVE WS-AVG-DLY-DIS-UNW-HTIME
                                            TO WS-D2-UNDWRITG-AVG-HTIME
           END-IF

           MOVE WS-DETAIL2-HANDLE-TIME      TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT


      ***** DISABILITY - LINE 2  MONTH-TO-DATE FIGURES
           INITIALIZE WS-DETAIL2-HANDLE-TIME
           MOVE SPACES                      TO WS-LABEL-VARIABLE-1
           MOVE WS-MTD-LITERAL              TO WS-LABEL-VARIABLE-2
           MOVE WS-REPORT-LABEL             TO WS-D2-COL1-LABEL
           MOVE WS-MTD-DIS-SVC-HANDLES      TO WS-D2-TOT-SVC-HANDLES
           MOVE WS-MTD-DIS-HANDLE-TIME      TO WS-D2-TOT-HANDLE-TIME
           IF WS-MTD-DIS-SVC-HANDLES NOT= +0
               DIVIDE WS-MTD-DIS-HANDLE-TIME
                   BY WS-MTD-DIS-SVC-HANDLES
                   GIVING WS-AVG-MTD-DIS-HANDLE-TIME
               MOVE WS-AVG-MTD-DIS-HANDLE-TIME
                                            TO WS-D2-AVERAGE-HANDLE-TIME
           END-IF

           MOVE WS-MTD-DIS-UNW-HANDLES      TO WS-D2-UNDWRITG-HANDLES
           MOVE WS-MTD-DIS-UNW-HTIME        TO WS-D2-UNDWRITG-HTIME
           IF WS-MTD-DIS-UNW-HANDLES NOT= +0
               DIVIDE WS-MTD-DIS-UNW-HTIME
                   BY WS-MTD-DIS-UNW-HANDLES
                   GIVING WS-AVG-MTD-DIS-UNW-HTIME
               MOVE WS-AVG-MTD-DIS-UNW-HTIME
                                            TO WS-D2-UNDWRITG-AVG-HTIME
           END-IF

           MOVE WS-DETAIL2-HANDLE-TIME      TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT


122002     IF DTE-CLIENT = 'DCC'
121603***** SECURE PAY (GAP) - DAILY FIGURES
121603         MOVE WS-EDITED-CYCLE-DT      TO WS-LABEL-VARIABLE-1
121603         MOVE WS-GP-LABEL             TO WS-LABEL-VARIABLE-2
121603         MOVE WS-REPORT-LABEL         TO WS-D2-COL1-LABEL
121603         MOVE WS-DLY-GP-SVC-HANDLES   TO WS-D2-TOT-SVC-HANDLES
121603         MOVE WS-DLY-GP-HANDLE-TIME   TO WS-D2-TOT-HANDLE-TIME
121603
121603         IF WS-DLY-GP-SVC-HANDLES NOT= +0
121603             DIVIDE WS-DLY-GP-HANDLE-TIME
121603                 BY WS-DLY-GP-SVC-HANDLES
121603                 GIVING WS-AVG-DLY-GP-HANDLE-TIME
121603             MOVE WS-AVG-DLY-GP-HANDLE-TIME
121603                                      TO WS-D2-AVERAGE-HANDLE-TIME
121603         END-IF
121603
121603         MOVE WS-DLY-GP-UNW-HANDLES   TO WS-D2-UNDWRITG-HANDLES
121603         MOVE WS-DLY-GP-UNW-HTIME     TO WS-D2-UNDWRITG-HTIME
121603  
121603         IF WS-DLY-GP-UNW-HANDLES NOT= +0
121603             DIVIDE WS-DLY-GP-UNW-HTIME
121603                 BY WS-DLY-GP-UNW-HANDLES
121603                 GIVING WS-AVG-DLY-GP-UNW-HTIME
121603             MOVE WS-AVG-DLY-GP-UNW-HTIME
121603                                      TO WS-D2-UNDWRITG-AVG-HTIME
121603         END-IF
121603
121603         MOVE WS-DETAIL2-HANDLE-TIME  TO PRT
121603         MOVE '-'                     TO P-CTL
121603         PERFORM 3900-WRITE           THRU 3900-EXIT
121603
121603
121603***** SECURE PAY (GAP) - MONTH-TO-DATE FIGURES
121603         INITIALIZE WS-DETAIL2-HANDLE-TIME
121603         MOVE SPACES                  TO WS-LABEL-VARIABLE-1
121603         MOVE WS-MTD-LITERAL          TO WS-LABEL-VARIABLE-2
121603         MOVE WS-REPORT-LABEL         TO WS-D2-COL1-LABEL
121603         MOVE WS-MTD-GP-SVC-HANDLES   TO WS-D2-TOT-SVC-HANDLES 
121603         MOVE WS-MTD-GP-HANDLE-TIME   TO WS-D2-TOT-HANDLE-TIME
121603         IF WS-MTD-GP-SVC-HANDLES NOT= +0
121603             DIVIDE WS-MTD-GP-HANDLE-TIME
121603                 BY WS-MTD-GP-SVC-HANDLES
121603                 GIVING WS-AVG-MTD-GP-HANDLE-TIME
121603             MOVE WS-AVG-MTD-GP-HANDLE-TIME
121603                                      TO WS-D2-AVERAGE-HANDLE-TIME
121603         END-IF
121603
121603         MOVE WS-MTD-GP-UNW-HANDLES   TO WS-D2-UNDWRITG-HANDLES
121603         MOVE WS-MTD-GP-UNW-HTIME     TO WS-D2-UNDWRITG-HTIME
121603         IF WS-MTD-GP-UNW-HANDLES NOT= +0
121603             DIVIDE WS-MTD-GP-UNW-HTIME
121603                 BY WS-MTD-GP-UNW-HANDLES
121603                 GIVING WS-AVG-MTD-GP-UNW-HTIME
121603             MOVE WS-AVG-MTD-GP-UNW-HTIME
121603                                      TO WS-D2-UNDWRITG-AVG-HTIME
121603         END-IF
121603
121603         MOVE WS-DETAIL2-HANDLE-TIME  TO PRT
121603         PERFORM 3900-WRITE           THRU 3900-EXIT

122002***** UNEMPLOYMENT - DAILY FIGURES
122002         MOVE WS-EDITED-CYCLE-DT      TO WS-LABEL-VARIABLE-1
122002         MOVE WS-IU-LABEL             TO WS-LABEL-VARIABLE-2
122002         MOVE WS-REPORT-LABEL         TO WS-D2-COL1-LABEL
122002         MOVE WS-DLY-IU-SVC-HANDLES   TO WS-D2-TOT-SVC-HANDLES
122002         MOVE WS-DLY-IU-HANDLE-TIME   TO WS-D2-TOT-HANDLE-TIME
122002
122002         IF WS-DLY-IU-SVC-HANDLES NOT= +0
122002             DIVIDE WS-DLY-IU-HANDLE-TIME
122002                 BY WS-DLY-IU-SVC-HANDLES
122002                 GIVING WS-AVG-DLY-IU-HANDLE-TIME
122002             MOVE WS-AVG-DLY-IU-HANDLE-TIME
122002                                      TO WS-D2-AVERAGE-HANDLE-TIME
122002         END-IF
122002
122002         MOVE WS-DLY-IU-UNW-HANDLES   TO WS-D2-UNDWRITG-HANDLES
122002         MOVE WS-DLY-IU-UNW-HTIME     TO WS-D2-UNDWRITG-HTIME
122002
122002         IF WS-DLY-IU-UNW-HANDLES NOT= +0
122002             DIVIDE WS-DLY-IU-UNW-HTIME
122002                 BY WS-DLY-IU-UNW-HANDLES
122002                 GIVING WS-AVG-DLY-IU-UNW-HTIME
122002             MOVE WS-AVG-DLY-IU-UNW-HTIME
122002                                      TO WS-D2-UNDWRITG-AVG-HTIME
122002         END-IF
122002
122002         MOVE WS-DETAIL2-HANDLE-TIME  TO PRT
122002         MOVE '-'                     TO P-CTL
122002         PERFORM 3900-WRITE           THRU 3900-EXIT
122002
122002
122002***** UNEMPLOYMENT - MONTH-TO-DATE FIGURES
122002         INITIALIZE WS-DETAIL2-HANDLE-TIME
122002         MOVE SPACES                  TO WS-LABEL-VARIABLE-1
122002         MOVE WS-MTD-LITERAL          TO WS-LABEL-VARIABLE-2
122002         MOVE WS-REPORT-LABEL         TO WS-D2-COL1-LABEL
122002         MOVE WS-MTD-IU-SVC-HANDLES   TO WS-D2-TOT-SVC-HANDLES 
122002         MOVE WS-MTD-IU-HANDLE-TIME   TO WS-D2-TOT-HANDLE-TIME
122002         IF WS-MTD-IU-SVC-HANDLES NOT= +0
122002             DIVIDE WS-MTD-IU-HANDLE-TIME
122002                 BY WS-MTD-IU-SVC-HANDLES
122002                 GIVING WS-AVG-MTD-IU-HANDLE-TIME
122002             MOVE WS-AVG-MTD-IU-HANDLE-TIME
122002                                      TO WS-D2-AVERAGE-HANDLE-TIME
122002         END-IF
122002
122002         MOVE WS-MTD-IU-UNW-HANDLES   TO WS-D2-UNDWRITG-HANDLES
122002         MOVE WS-MTD-IU-UNW-HTIME     TO WS-D2-UNDWRITG-HTIME
122002         IF WS-MTD-IU-UNW-HANDLES NOT= +0
122002             DIVIDE WS-MTD-IU-UNW-HTIME
122002                 BY WS-MTD-IU-UNW-HANDLES
122002                 GIVING WS-AVG-MTD-IU-UNW-HTIME
122002             MOVE WS-AVG-MTD-IU-UNW-HTIME
122002                                      TO WS-D2-UNDWRITG-AVG-HTIME
122002         END-IF
122002
122002         MOVE WS-DETAIL2-HANDLE-TIME  TO PRT
122002         PERFORM 3900-WRITE           THRU 3900-EXIT
122002     END-IF


      ***** LIFE - LINE 3        DAILY FIGURES
           INITIALIZE WS-DETAIL2-HANDLE-TIME
           MOVE WS-EDITED-CYCLE-DT          TO WS-LABEL-VARIABLE-1
           MOVE WS-LIFE-LABEL               TO WS-LABEL-VARIABLE-2
           MOVE WS-REPORT-LABEL             TO WS-D2-COL1-LABEL
           MOVE WS-DLY-LIF-SVC-HANDLES      TO WS-D2-TOT-SVC-HANDLES
           MOVE WS-DLY-LIF-HANDLE-TIME      TO WS-D2-TOT-HANDLE-TIME

           IF WS-DLY-LIF-SVC-HANDLES NOT= +0
               DIVIDE WS-DLY-LIF-HANDLE-TIME
                   BY WS-DLY-LIF-SVC-HANDLES
                   GIVING WS-AVG-DLY-LIF-HANDLE-TIME
               MOVE WS-AVG-DLY-LIF-HANDLE-TIME
                                            TO WS-D2-AVERAGE-HANDLE-TIME
           END-IF

           MOVE WS-DLY-LIF-UNW-HANDLES      TO WS-D2-UNDWRITG-HANDLES
           MOVE WS-DLY-LIF-UNW-HTIME        TO WS-D2-UNDWRITG-HTIME

           IF WS-DLY-LIF-UNW-HANDLES NOT= +0
               DIVIDE WS-DLY-LIF-UNW-HTIME
                   BY WS-DLY-LIF-UNW-HANDLES
                   GIVING WS-AVG-DLY-LIF-UNW-HTIME
               MOVE WS-AVG-DLY-LIF-UNW-HTIME
                                            TO WS-D2-UNDWRITG-AVG-HTIME
           END-IF

           MOVE WS-DETAIL2-HANDLE-TIME      TO PRT
           MOVE '-'                         TO P-CTL
           PERFORM 3900-WRITE               THRU 3900-EXIT


      ***** LIFE - LINE 4        MONTH-TO-DATE FIGURES
           INITIALIZE WS-DETAIL2-HANDLE-TIME
           MOVE SPACES                      TO WS-LABEL-VARIABLE-1
           MOVE WS-MTD-LITERAL              TO WS-LABEL-VARIABLE-2
           MOVE WS-REPORT-LABEL             TO WS-D2-COL1-LABEL
           MOVE WS-MTD-LIF-SVC-HANDLES      TO WS-D2-TOT-SVC-HANDLES
           MOVE WS-MTD-LIF-HANDLE-TIME      TO WS-D2-TOT-HANDLE-TIME

           IF WS-MTD-LIF-SVC-HANDLES NOT= +0
               DIVIDE WS-MTD-LIF-HANDLE-TIME
                   BY WS-MTD-LIF-SVC-HANDLES
                   GIVING WS-AVG-MTD-LIF-HANDLE-TIME
               MOVE WS-AVG-MTD-LIF-HANDLE-TIME
                                            TO WS-D2-AVERAGE-HANDLE-TIME
           END-IF

           MOVE WS-MTD-LIF-UNW-HANDLES      TO WS-D2-UNDWRITG-HANDLES
           MOVE WS-MTD-LIF-UNW-HTIME        TO WS-D2-UNDWRITG-HTIME

           IF WS-MTD-LIF-UNW-HANDLES NOT= +0
               DIVIDE WS-MTD-LIF-UNW-HTIME
                   BY WS-MTD-LIF-UNW-HANDLES
                   GIVING WS-AVG-MTD-LIF-UNW-HTIME
               MOVE WS-AVG-MTD-LIF-UNW-HTIME
                                            TO WS-D2-UNDWRITG-AVG-HTIME
           END-IF

           MOVE WS-DETAIL2-HANDLE-TIME      TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT



      ***** DAILY GRAND TOTALS - LINE 5
           INITIALIZE WS-DETAIL2-HANDLE-TIME
           MOVE WS-EDITED-CYCLE-DT          TO WS-LABEL-VARIABLE-1
           MOVE WS-DLY-GRANDTOT-LABEL       TO WS-LABEL-VARIABLE-2
           MOVE WS-REPORT-LABEL             TO WS-D2-COL1-LABEL

122002     ADD WS-DLY-LIF-SVC-HANDLES, WS-DLY-DIS-SVC-HANDLES,
121603         WS-DLY-IU-SVC-HANDLES, WS-DLY-GP-SVC-HANDLES
                   GIVING WS-GTOT-SVC-HANDLES

122002     ADD WS-DLY-LIF-HANDLE-TIME, WS-DLY-DIS-HANDLE-TIME,
121603         WS-DLY-IU-HANDLE-TIME, WS-DLY-GP-HANDLE-TIME
                   GIVING WS-GTOT-HANDLE-TIME

           MOVE WS-GTOT-SVC-HANDLES         TO WS-D2-TOT-SVC-HANDLES
           MOVE WS-GTOT-HANDLE-TIME         TO WS-D2-TOT-HANDLE-TIME

           IF WS-GTOT-SVC-HANDLES NOT= +0
               DIVIDE WS-GTOT-HANDLE-TIME
                   BY WS-GTOT-SVC-HANDLES
                   GIVING WS-GTOT-AVG-HANDLE-TIME
               MOVE WS-GTOT-AVG-HANDLE-TIME TO WS-D2-AVERAGE-HANDLE-TIME
           END-IF

122002     ADD WS-DLY-LIF-UNW-HANDLES, WS-DLY-DIS-UNW-HANDLES,
121603         WS-DLY-IU-UNW-HANDLES, WS-DLY-GP-UNW-HANDLES
                   GIVING WS-GTOT-UNW-HANDLES

122002     ADD WS-DLY-LIF-UNW-HTIME, WS-DLY-DIS-UNW-HTIME,
121603         WS-DLY-IU-UNW-HTIME, WS-DLY-GP-UNW-HTIME
                   GIVING WS-GTOT-UNW-HTIME

           MOVE WS-GTOT-UNW-HANDLES         TO WS-D2-UNDWRITG-HANDLES
           MOVE WS-GTOT-UNW-HTIME           TO WS-D2-UNDWRITG-HTIME

           IF WS-GTOT-UNW-HANDLES NOT= +0
               DIVIDE WS-GTOT-UNW-HTIME
                   BY WS-GTOT-UNW-HANDLES
                   GIVING WS-GTOT-AVG-UNW-HTIME
               MOVE WS-GTOT-AVG-UNW-HTIME   TO WS-D2-UNDWRITG-AVG-HTIME
           END-IF

           MOVE SPACES                      TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           MOVE WS-DETAIL2-HANDLE-TIME      TO PRT
           MOVE '-'                         TO P-CTL
           PERFORM 3900-WRITE               THRU 3900-EXIT



      ***** MONTH-TO-DATE GRAND TOTALS - LINE 6
           INITIALIZE WS-DETAIL2-HANDLE-TIME
           MOVE SPACES                      TO WS-LABEL-VARIABLE-1
           MOVE WS-MTD-GRANDTOT-LABEL       TO WS-LABEL-VARIABLE-2
           MOVE WS-REPORT-LABEL             TO WS-D2-COL1-LABEL

122002     ADD WS-MTD-LIF-SVC-HANDLES, WS-MTD-DIS-SVC-HANDLES,
121603         WS-MTD-IU-SVC-HANDLES, WS-MTD-GP-SVC-HANDLES
                   GIVING WS-GTOT-SVC-HANDLES

122002     ADD WS-MTD-LIF-HANDLE-TIME, WS-MTD-DIS-HANDLE-TIME,
121603         WS-MTD-IU-HANDLE-TIME, WS-MTD-GP-HANDLE-TIME
                   GIVING WS-GTOT-HANDLE-TIME

           MOVE WS-GTOT-SVC-HANDLES         TO WS-D2-TOT-SVC-HANDLES
           MOVE WS-GTOT-HANDLE-TIME         TO WS-D2-TOT-HANDLE-TIME

           IF WS-GTOT-SVC-HANDLES NOT= +0
               DIVIDE WS-GTOT-HANDLE-TIME
                   BY WS-GTOT-SVC-HANDLES
                   GIVING WS-GTOT-AVG-HANDLE-TIME
               MOVE WS-GTOT-AVG-HANDLE-TIME TO WS-D2-AVERAGE-HANDLE-TIME
           END-IF

122002     ADD WS-MTD-LIF-UNW-HANDLES, WS-MTD-DIS-UNW-HANDLES,
121603         WS-MTD-IU-UNW-HANDLES, WS-MTD-GP-UNW-HANDLES
                   GIVING WS-GTOT-UNW-HANDLES

122002     ADD WS-MTD-LIF-UNW-HTIME, WS-MTD-DIS-UNW-HTIME,
121603         WS-MTD-IU-UNW-HTIME, WS-MTD-GP-UNW-HTIME
                   GIVING WS-GTOT-UNW-HTIME

           MOVE WS-GTOT-UNW-HANDLES         TO WS-D2-UNDWRITG-HANDLES
           MOVE WS-GTOT-UNW-HTIME           TO WS-D2-UNDWRITG-HTIME

           IF WS-GTOT-UNW-HANDLES NOT= +0
               DIVIDE WS-GTOT-UNW-HTIME
                   BY WS-GTOT-UNW-HANDLES
                   GIVING WS-GTOT-AVG-UNW-HTIME
               MOVE WS-GTOT-AVG-UNW-HTIME   TO WS-D2-UNDWRITG-AVG-HTIME
           END-IF

           MOVE WS-DETAIL2-HANDLE-TIME      TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           .
       3300-EXIT.
           EXIT.


       3400-PRINT-SERVICE-TIME-RPT.

           MOVE WS-SERVICE-TIME-RPT-TITLE   TO WS-H1-TITLE
           MOVE ZERO                        TO WS-PAGE
           PERFORM 3800-PRINT-HEADINGS      THRU 3800-EXIT

           MOVE WS-HEADING4-SERVICE-TIME    TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           MOVE WS-HEADING5-SERVICE-TIME    TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           MOVE SPACE                       TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           MOVE WS-DIS-LABEL                TO WS-D3-COL1-LABEL
           MOVE WS-DIS-PAID-DENIED-CNT      TO WS-D3-PAID-DENIED-CNT
           MOVE WS-MTD-DIS-SERVICE-TIME     TO WS-D3-TOT-SVC-TIME

           IF WS-DIS-PAID-DENIED-CNT NOT= +0
               DIVIDE WS-MTD-DIS-SERVICE-TIME
                   BY WS-DIS-PAID-DENIED-CNT
                   GIVING WS-AVG-DIS-SERVICE-TIME
               MOVE WS-AVG-DIS-SERVICE-TIME
                                            TO WS-D3-AVG-SVC-TIME
           END-IF

           MOVE WS-DETAIL3-SERVICE-TIME     TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT


122002     IF DTE-CLIENT = 'DCC'
121603         MOVE WS-GP-LABEL             TO WS-D3-COL1-LABEL
121603         MOVE WS-GP-PAID-DENIED-CNT   TO WS-D3-PAID-DENIED-CNT
121603         MOVE WS-MTD-GP-SERVICE-TIME  TO WS-D3-TOT-SVC-TIME
121603
121603         IF WS-GP-PAID-DENIED-CNT NOT= +0
121603             DIVIDE WS-MTD-GP-SERVICE-TIME
121603                 BY WS-GP-PAID-DENIED-CNT
121603                 GIVING WS-AVG-GP-SERVICE-TIME
121603             MOVE WS-AVG-GP-SERVICE-TIME
121603                                      TO WS-D3-AVG-SVC-TIME
121603         END-IF
121603
121603         MOVE WS-DETAIL3-SERVICE-TIME TO PRT
121603         MOVE '0'                     TO P-CTL
121603         PERFORM 3900-WRITE           THRU 3900-EXIT

122002         MOVE WS-IU-LABEL             TO WS-D3-COL1-LABEL
122002         MOVE WS-IU-PAID-DENIED-CNT   TO WS-D3-PAID-DENIED-CNT
122002         MOVE WS-MTD-IU-SERVICE-TIME  TO WS-D3-TOT-SVC-TIME
122002
122002         IF WS-IU-PAID-DENIED-CNT NOT= +0
122002             DIVIDE WS-MTD-IU-SERVICE-TIME
122002                 BY WS-IU-PAID-DENIED-CNT
122002                 GIVING WS-AVG-IU-SERVICE-TIME
122002             MOVE WS-AVG-IU-SERVICE-TIME
122002                                      TO WS-D3-AVG-SVC-TIME
122002         END-IF
122002
122002         MOVE WS-DETAIL3-SERVICE-TIME TO PRT
122002         MOVE '0'                     TO P-CTL
122002         PERFORM 3900-WRITE           THRU 3900-EXIT
122002     END-IF


           INITIALIZE WS-DETAIL3-SERVICE-TIME
           MOVE WS-LIFE-LABEL               TO WS-D3-COL1-LABEL
           MOVE WS-LIF-PAID-DENIED-CNT      TO WS-D3-PAID-DENIED-CNT
           MOVE WS-MTD-LIF-SERVICE-TIME     TO WS-D3-TOT-SVC-TIME

           IF WS-LIF-PAID-DENIED-CNT NOT= +0
               DIVIDE WS-MTD-LIF-SERVICE-TIME
                   BY WS-LIF-PAID-DENIED-CNT
                   GIVING WS-AVG-LIF-SERVICE-TIME
               MOVE WS-AVG-LIF-SERVICE-TIME
                                            TO WS-D3-AVG-SVC-TIME
           END-IF

           MOVE WS-DETAIL3-SERVICE-TIME     TO PRT
           MOVE '0'                         TO P-CTL
           PERFORM 3900-WRITE               THRU 3900-EXIT


           INITIALIZE WS-DETAIL3-SERVICE-TIME
           MOVE WS-GRAND-TOTALS-LABEL(1:19) TO WS-D3-COL1-LABEL
           ADD WS-DIS-PAID-DENIED-CNT
               TO WS-LIF-PAID-DENIED-CNT
               GIVING WS-TOT-PAID-DENIED-CNT
           MOVE WS-TOT-PAID-DENIED-CNT      TO WS-D3-PAID-DENIED-CNT

           ADD WS-MTD-DIS-SERVICE-TIME
               TO WS-MTD-LIF-SERVICE-TIME
               GIVING WS-TOT-SERVICE-TIME
           MOVE WS-TOT-SERVICE-TIME         TO WS-D3-TOT-SVC-TIME

           IF WS-TOT-PAID-DENIED-CNT NOT= +0
               DIVIDE WS-TOT-SERVICE-TIME
                   BY WS-TOT-PAID-DENIED-CNT
                   GIVING WS-AVG-SERVICE-TIME
               MOVE WS-AVG-SERVICE-TIME
                                            TO WS-D3-AVG-SVC-TIME
           END-IF

           MOVE WS-DETAIL3-SERVICE-TIME     TO PRT
           MOVE '-'                         TO P-CTL
           PERFORM 3900-WRITE               THRU 3900-EXIT

           .
       3400-EXIT.
           EXIT.


       3600-PRINT-DISTRIBUTION-RPT.

122002     ADD WS-DIS-DISTR1-CNT, WS-LIF-DISTR1-CNT, WS-IU-DISTR1-CNT,
121603         WS-GP-DISTR1-CNT
               GIVING WS-TOT-DISTR1-CNT
122002     ADD WS-DIS-DISTR2-CNT, WS-LIF-DISTR2-CNT, WS-IU-DISTR2-CNT,
121603         WS-GP-DISTR2-CNT
               GIVING WS-TOT-DISTR2-CNT
122002     ADD WS-DIS-DISTR3-CNT, WS-LIF-DISTR3-CNT, WS-IU-DISTR3-CNT,
121603         WS-GP-DISTR3-CNT
               GIVING WS-TOT-DISTR3-CNT
021706     ADD WS-DIS-DISTR3A-CNT, WS-LIF-DISTR3A-CNT,
021706         WS-IU-DISTR3A-CNT, WS-GP-DISTR3A-CNT
021706         GIVING WS-TOT-DISTR3A-CNT
122002     ADD WS-DIS-DISTR4-CNT, WS-LIF-DISTR4-CNT, WS-IU-DISTR4-CNT,
121603         WS-GP-DISTR4-CNT
               GIVING WS-TOT-DISTR4-CNT
122002     ADD WS-DIS-DISTR5-CNT, WS-LIF-DISTR5-CNT, WS-IU-DISTR5-CNT,  
121603         WS-GP-DISTR5-CNT
               GIVING WS-TOT-DISTR5-CNT
122002     ADD WS-DIS-DISTR6-CNT, WS-LIF-DISTR6-CNT, WS-IU-DISTR6-CNT,
121603         WS-GP-DISTR6-CNT
               GIVING WS-TOT-DISTR6-CNT
122002     ADD WS-DIS-DISTR7-CNT, WS-LIF-DISTR7-CNT, WS-IU-DISTR7-CNT,
121603         WS-GP-DISTR7-CNT
               GIVING WS-TOT-DISTR7-CNT
122002     ADD WS-DIS-DISTR8-CNT, WS-LIF-DISTR8-CNT, WS-IU-DISTR8-CNT,
121603         WS-GP-DISTR8-CNT
               GIVING WS-TOT-DISTR8-CNT
122002     ADD WS-DIS-DISTR9-CNT, WS-LIF-DISTR9-CNT, WS-IU-DISTR9-CNT,
121603         WS-GP-DISTR9-CNT
               GIVING WS-TOT-DISTR9-CNT
122002     ADD WS-DIS-DISTR10-CNT, WS-LIF-DISTR10-CNT, 
121603         WS-IU-DISTR10-CNT, WS-GP-DISTR10-CNT
               GIVING WS-TOT-DISTR10-CNT

           MOVE WS-DISTRIBUTION-RPT-TITLE   TO WS-H1-TITLE
           MOVE ZERO                        TO WS-PAGE
           PERFORM 3800-PRINT-HEADINGS      THRU 3800-EXIT

           MOVE WS-HEADING4-DISTRIBUTION    TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           MOVE WS-HEADING5-DISTRIBUTION    TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           MOVE SPACE                       TO PRT
           MOVE '-'                         TO P-CTL
           PERFORM 3900-WRITE               THRU 3900-EXIT

           MOVE WS-DIS-LABEL                TO WS-D5-COL1-LABEL
           MOVE WS-DIS-DISTR1-CNT           TO WS-D5-DISTR-1
           MOVE WS-DIS-DISTR2-CNT           TO WS-D5-DISTR-2
           MOVE WS-DIS-DISTR3-CNT           TO WS-D5-DISTR-3
021706     MOVE WS-DIS-DISTR3A-CNT          TO WS-D5-DISTR-3A
           MOVE WS-DIS-DISTR4-CNT           TO WS-D5-DISTR-4
           MOVE WS-DIS-DISTR5-CNT           TO WS-D5-DISTR-5
           MOVE WS-DIS-DISTR6-CNT           TO WS-D5-DISTR-6
           MOVE WS-DIS-DISTR7-CNT           TO WS-D5-DISTR-7
           MOVE WS-DIS-DISTR8-CNT           TO WS-D5-DISTR-8
           MOVE WS-DIS-DISTR9-CNT           TO WS-D5-DISTR-9

           MOVE WS-DETAIL5-DISTRIBUTION     TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

122002     IF DTE-CLIENT = 'DCC'
121603         MOVE WS-GP-LABEL             TO WS-D5-COL1-LABEL
121603         MOVE WS-GP-DISTR1-CNT        TO WS-D5-DISTR-1
121603         MOVE WS-GP-DISTR2-CNT        TO WS-D5-DISTR-2
121603         MOVE WS-GP-DISTR3-CNT        TO WS-D5-DISTR-3
021706         MOVE WS-GP-DISTR3A-CNT       TO WS-D5-DISTR-3A
121603         MOVE WS-GP-DISTR4-CNT        TO WS-D5-DISTR-4
121603         MOVE WS-GP-DISTR5-CNT        TO WS-D5-DISTR-5
121603         MOVE WS-GP-DISTR6-CNT        TO WS-D5-DISTR-6
121603         MOVE WS-GP-DISTR7-CNT        TO WS-D5-DISTR-7
121603         MOVE WS-GP-DISTR8-CNT        TO WS-D5-DISTR-8
121603         MOVE WS-GP-DISTR9-CNT        TO WS-D5-DISTR-9
121603
121603         MOVE WS-DETAIL5-DISTRIBUTION TO PRT
121603         MOVE '0'                     TO P-CTL
121603         PERFORM 3900-WRITE           THRU 3900-EXIT

122002         MOVE WS-IU-LABEL             TO WS-D5-COL1-LABEL
122002         MOVE WS-IU-DISTR1-CNT        TO WS-D5-DISTR-1
122002         MOVE WS-IU-DISTR2-CNT        TO WS-D5-DISTR-2
122002         MOVE WS-IU-DISTR3-CNT        TO WS-D5-DISTR-3
021706         MOVE WS-IU-DISTR3A-CNT       TO WS-D5-DISTR-3A
122002         MOVE WS-IU-DISTR4-CNT        TO WS-D5-DISTR-4
122002         MOVE WS-IU-DISTR5-CNT        TO WS-D5-DISTR-5
122002         MOVE WS-IU-DISTR6-CNT        TO WS-D5-DISTR-6
122002         MOVE WS-IU-DISTR7-CNT        TO WS-D5-DISTR-7
122002         MOVE WS-IU-DISTR8-CNT        TO WS-D5-DISTR-8
122002         MOVE WS-IU-DISTR9-CNT        TO WS-D5-DISTR-9
122002
122002         MOVE WS-DETAIL5-DISTRIBUTION TO PRT
122002         MOVE '0'                     TO P-CTL
122002         PERFORM 3900-WRITE           THRU 3900-EXIT
122002     END-IF

           MOVE WS-LIFE-LABEL               TO WS-D5-COL1-LABEL
           MOVE WS-LIF-DISTR1-CNT           TO WS-D5-DISTR-1
           MOVE WS-LIF-DISTR2-CNT           TO WS-D5-DISTR-2
           MOVE WS-LIF-DISTR3-CNT           TO WS-D5-DISTR-3
021706     MOVE WS-LIF-DISTR3A-CNT          TO WS-D5-DISTR-3A
           MOVE WS-LIF-DISTR4-CNT           TO WS-D5-DISTR-4
           MOVE WS-LIF-DISTR5-CNT           TO WS-D5-DISTR-5
           MOVE WS-LIF-DISTR6-CNT           TO WS-D5-DISTR-6
           MOVE WS-LIF-DISTR7-CNT           TO WS-D5-DISTR-7
           MOVE WS-LIF-DISTR8-CNT           TO WS-D5-DISTR-8
           MOVE WS-LIF-DISTR9-CNT           TO WS-D5-DISTR-9

           MOVE WS-DETAIL5-DISTRIBUTION     TO PRT
           MOVE '0'                         TO P-CTL
           PERFORM 3900-WRITE               THRU 3900-EXIT

           MOVE WS-GRAND-TOTALS-LABEL       TO WS-D5-COL1-LABEL
           MOVE WS-TOT-DISTR1-CNT           TO WS-D5-DISTR-1
           MOVE WS-TOT-DISTR2-CNT           TO WS-D5-DISTR-2
           MOVE WS-TOT-DISTR3-CNT           TO WS-D5-DISTR-3
021706     MOVE WS-TOT-DISTR3A-CNT          TO WS-D5-DISTR-3A
           MOVE WS-TOT-DISTR4-CNT           TO WS-D5-DISTR-4
           MOVE WS-TOT-DISTR5-CNT           TO WS-D5-DISTR-5
           MOVE WS-TOT-DISTR6-CNT           TO WS-D5-DISTR-6
           MOVE WS-TOT-DISTR7-CNT           TO WS-D5-DISTR-7
           MOVE WS-TOT-DISTR8-CNT           TO WS-D5-DISTR-8
           MOVE WS-TOT-DISTR9-CNT           TO WS-D5-DISTR-9

           MOVE WS-DETAIL5-DISTRIBUTION     TO PRT
           MOVE '-'                         TO P-CTL
           PERFORM 3900-WRITE               THRU 3900-EXIT

           .
       3600-EXIT.
           EXIT.


       3800-PRINT-HEADINGS.

           MOVE WS-HEADING1                 TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           MOVE WS-HEADING2                 TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           ADD +1                           TO WS-PAGE
           MOVE WS-PAGE                     TO WS-H3-PAGE
           MOVE WS-HEADING3                 TO PRT
           PERFORM 3900-WRITE               THRU 3900-EXIT

           .
       3800-EXIT.
           EXIT.



       3900-WRITE.

           EVALUATE TRUE
           WHEN P-CTL = '1'
               MOVE +1                      TO WS-LINE-COUNT

           WHEN P-CTL = SPACE
               ADD +1                       TO WS-LINE-COUNT

           WHEN P-CTL = '0'
               ADD +2                       TO WS-LINE-COUNT

           WHEN OTHER
               ADD +3                       TO WS-LINE-COUNT
           END-EVALUATE



           EVALUATE TRUE

      **************************** P = HARDCOPY ONLY
           WHEN DTE-PRT-OPT = 'P'
               WRITE PRT

      **************************** B = SEQUENTIAL FILE ARCHIVE (USED TO
      *                                 BE FICHE) AND HARDCOPY
           WHEN DTE-PRT-OPT = 'B'
               PERFORM 4000-SEQ-FILE-ARCHIVE THRU 4000-EXIT
               WRITE PRT

      **************************** S = ONLINE REPORT FILE ONLY (ELREPT)
           WHEN DTE-PRT-OPT = 'S'
               PERFORM 4300-ONLINE-REPORT    THRU 4300-EXIT

      **************************** T = ONLINE REPORT FILE AND HARDCOPY
           WHEN DTE-PRT-OPT = 'T'
               PERFORM 4300-ONLINE-REPORT    THRU 4300-EXIT
               WRITE PRT

           END-EVALUATE

           .
       3900-EXIT.
           EXIT.


       4000-SEQ-FILE-ARCHIVE.
      ******************************************************************
      * WHILE FICHE IS NO LONGER BEING PRODUCED, THE FICHE LOGIC IS
      * BEING USED TO CREATE A SEQUENTIAL FILE REPORT ARCHIVE WHEN
      * THE DTE-PRT-OPT IS SET TO 'B'
      ******************************************************************
           IF FICH-NO
               GO TO 4000-EXIT
           ELSE
               IF FICH-OPEN = SPACE
                   MOVE 'X'                 TO FICH-OPEN
                   OPEN OUTPUT SEQ-FILE-ARCHIVE
               END-IF
           END-IF

           MOVE SPACE                       TO P-CTL
           WRITE SEQ-ARCHIVE-REC            FROM PRT

           .
       4000-EXIT.
           EXIT.


       4300-ONLINE-REPORT.

           IF (REPT-OPEN      = SPACE) AND
              (DTE-ABEND-CD-1 = SPACE)
               OPEN I-O ELREPT

               IF (DTE-F-1        NOT = ZERO)  AND
                  (DTE-VSAM-FLAGS NOT = '97')
                   MOVE DTE-VSAM-FLAGS        TO WS-ABEND-FILE-STATUS
                   MOVE 'ERROR OPENING ELREPT'
                                              TO WS-ABEND-MESSAGE
                   PERFORM ABEND-PGM          THRU APS-EXIT
               ELSE
                   MOVE '1'                   TO REPT-OPEN
                   MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD
                   MOVE '1'                   TO RF-RECORD-TYPE
                   MOVE OLC-REPORT-NAME       TO RF-REPORT-ID
                   MOVE ZERO                  TO RF-LINE-NUMBER
                   START ELREPT KEY NOT LESS RF-CONTROL-PRIMARY
                   SET BEGIN-REPORT-DELETE    TO TRUE
                   PERFORM 4500-REPORT-DELETE THRU 4500-EXIT
                       UNTIL REPORT-DELETE-DONE

                   MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD
                   MOVE '2'                   TO RF-RECORD-TYPE
                   MOVE OLC-REPORT-NAME       TO RF-REPORT-ID
                   MOVE ZERO                  TO RF-LINE-NUMBER
                   START ELREPT KEY NOT LESS RF-CONTROL-PRIMARY
                   SET BEGIN-REPORT-DELETE    TO TRUE
                   PERFORM 4500-REPORT-DELETE THRU 4500-EXIT
                       UNTIL REPORT-DELETE-DONE

                   MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD
                   MOVE '1'                   TO RF-RECORD-TYPE
                   MOVE OLC-REPORT-NAME       TO RF-REPORT-ID
                   MOVE SPACES                TO RF-REPORT-LINE-133
               END-IF
           END-IF


           IF DTE-ABEND-CD-1 = '81' AND
              DTE-PRT-OPT    = 'S'
               MOVE +0302                     TO WS-RETURN-CODE
               PERFORM ABEND-PGM              THRU APS-EXIT
           END-IF


           MOVE P-CTL                         TO RF-CTL-CHAR-133
           MOVE P-DATA                        TO RF-DATA-133

           IF DTE-ABEND-CD-1 = SPACES
               ADD +1                         TO DTE-TOT-LINES
               MOVE DTE-TOT-LINES             TO RF-LINE-NUMBER
               WRITE REPORT-SAVE-FILE
                   INVALID KEY
                       MOVE '88'              TO DTE-ABEND-CD-1
                       CLOSE ELREPT
                       MOVE SPACE             TO REPT-OPEN
           END-IF

           .
       4300-EXIT.
           EXIT.

       4500-REPORT-DELETE.

           IF DTE-F-1 NOT = ZERO
               MOVE ZERO                      TO DTE-VSAM-FLAGS
               SET REPORT-DELETE-DONE         TO TRUE
               GO TO 4500-EXIT
           END-IF

           READ ELREPT NEXT RECORD
               AT END
                   SET REPORT-DELETE-DONE     TO TRUE
                   GO TO 4500-EXIT
           END-READ

           IF (DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD)  AND
              (OLC-REPORT-NAME       = RF-REPORT-ID)
               DELETE ELREPT RECORD
           END-IF

           .
       4500-EXIT.
           EXIT.


       8500-DATE-CONVERSION.

           CALL 'ELDATCX' USING DATE-CONVERSION-DATA

           .
       8500-EXIT.
           EXIT.


       OPEN-FILES.

           OPEN INPUT  MTD-ELMSTR-INFILE
                       ELTRLR-INFILE
                OUTPUT PRNTR


           IF WS-ELTRLR-FILE-STATUS  = '00' OR '97'
              CONTINUE
           ELSE
              MOVE 'OPEN ERROR OCCURRED ON ELTRLR'
                                              TO WS-ABEND-MESSAGE
              MOVE WS-ELTRLR-FILE-STATUS      TO WS-ABEND-FILE-STATUS
              PERFORM ABEND-PGM               THRU APS-EXIT
           END-IF

           .
       OPEN-FILES-EXIT.
           EXIT.


       CLOSE-FILES.

           IF FICH-OPEN NOT = SPACE
               CLOSE SEQ-FILE-ARCHIVE
           END-IF 

           IF REPT-OPEN NOT = SPACE
               MOVE '2'                       TO RF-RECORD-TYPE
               ADD +1                         TO DTE-TOT-LINES
               MOVE DTE-TOT-LINES             TO RF-LINE-NUMBER
               MOVE SPACES                    TO RF-TRAILER-RECORD
               MOVE WS-TIME                   TO RF-PRINT-HH-MM-SS
               MOVE WS-CURRENT-DATE           TO RF-CURRENT-DATE
               WRITE REPORT-SAVE-FILE
               IF DTE-VSAM-FLAGS NOT = ZEROS
                   DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'
                   DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS
                   DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'
                       UPON CONSOLE
                   DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS
                       UPON CONSOLE
               ELSE
                   DISPLAY '***************************************'
                   DISPLAY '***************************************'
                   DISPLAY '**               ' OLC-REPORT-NAME
                   DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'
                   DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'
                   DISPLAY '**                                   **'
                   DISPLAY '***************************************'
                   DISPLAY '***************************************'
                   CLOSE ELREPT
               END-IF
           END-IF

           IF DTE-ABEND-CD-1 = '81'
               DISPLAY '***************************************'
               DISPLAY '***************************************'
               DISPLAY '**               ' OLC-REPORT-NAME
               DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'
               DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'
               DISPLAY '**                                   **'
               DISPLAY '***************************************'
               DISPLAY '***************************************'
               DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS
           END-IF

           IF DTE-ABEND-CD-1 = '88'
               DISPLAY '***************************************'
               DISPLAY '***************************************'
               DISPLAY '**               ' OLC-REPORT-NAME
               DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'
               DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'
               DISPLAY '**                                   **'
               DISPLAY '***************************************'
               DISPLAY '***************************************'
               DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS
           END-IF


           CLOSE MTD-ELMSTR-INFILE
                 ELTRLR-INFILE
                 PRNTR

            .
       CLOSE-FILES-EXIT.
           EXIT.

       ABEND-PGM. COPY ELCABEND.
