* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page   1
* ELRATEX.cbl
* Options: int("ELRATEX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK VERBOSE
*          directives(cobopt.bth) endp list("ELRATEX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATEX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATEX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ELRATEX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/11/95 14:39:14.
     7*                           VMOD=2.009
     8*
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page   2
* ELRATEX.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *    (BATCH VERSION OF ELRATE)                      *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    28*            *    AND RATES.                                     *
    29*            *****************************************************
    30
    31
    32******************************************************************
    33*                                                                *
    34*              INPUT FIELDS USED                                 *
    35*                                                                *
    36******************************************************************
    37*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    38*  CLASS CODE       - CP-CLASS-CODE                              *
    39*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    40*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    41*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    42*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    43*  STATE CODE (NUM) - CP-STATE                                   *
    44*  STATE CODE       - CP-STATE-STD-ABBV                          *
    45*  COMPANY I.D.     - CP-COMPANY-ID                              *
    46*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    47*  INSURED AGE      - CP-ISSUE-AGE                               *
    48*  RATING METHOD    - CP-EARNING-METHOD                          *
    49*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    50*  A.P.R.           - CP-LOAN-APR                                *
    51*  A/H RATING TERM  - CP-CAPPED-TERM  (ONLY FOR SKIP CODE A/H)   *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54******************************************************************
    55******************************************************************
    56*                   C H A N G E   L O G
    57*
    58* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    59*-----------------------------------------------------------------
    60*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    61* EFFECTIVE    NUMBER
    62*-----------------------------------------------------------------
    63* 010716  CR2015082500001  PEMA  VPP CHANGES
    64******************************************************************
    65 ENVIRONMENT DIVISION.
    66
    67 INPUT-OUTPUT SECTION.
    68 FILE-CONTROL.
    69
    70     SELECT ERRATEF ASSIGN TO SYS001-FBA1-ERRATE
    71             ORGANIZATION IS INDEXED
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page   3
* ELRATEX.cbl
    72             ACCESS IS SEQUENTIAL
    73             RECORD KEY IS ER-RATE-KEY
    74             FILE STATUS IS ER-STATUS.
    75
    76     SELECT OERATEF ASSIGN TO SYS001-FBA1-OERATE
    77             ORGANIZATION IS INDEXED
    78             ACCESS IS SEQUENTIAL
    79             RECORD KEY IS OE-RATE-KEY
    80             FILE STATUS IS ER-STATUS.
    81
    82 DATA DIVISION.
    83 FILE SECTION.
    84 FD  ERRATEF.
    85 01  ER-RATE-REC.
    86     03  FILLER       PIC XX.
    87     03  ER-RATE-KEY  PIC X(28).
    88     03  FILLER       PIC X(1735).
    89
    90 FD  OERATEF.
    91 01  OE-RATE-REC.
    92     03  FILLER       PIC XX.
    93     03  OE-RATE-KEY  PIC X(28).
    94     03  FILLER       PIC X(1735).
    95
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page   4
* ELRATEX.cbl
    97 WORKING-STORAGE SECTION.
    98 77  FILLER   PIC X(32) VALUE '********************************'.
    99 77  FILLER   PIC X(32) VALUE '**  ELRATEX  WORKING STORAGE  **'.
   100 77  FILLER   PIC X(32) VALUE '***********VMOD 2.009 **********'.
   101
*  102                             COPY ELCRATWS.
   103******************************************************************04/15/98
   104*                                                                *ELCRATWS
   105*                                                                *ELCRATWS
   106*                            ELCRATWS.                           *   LV006
   107*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
   108*                            VMOD=2.010                          *   CL**6
   109*                                                                *ELCRATWS
   110******************************************************************ELCRATWS
   111                                                                  ELCRATWS
   112 01  STANDARD-AREAS.                                              ELCRATWS
   113     12  ER-STATUS               PIC XX.                          ELCRATWS
   114     12  WS-BROWSE-SW            PIC X       VALUE SPACE.         ELCRATWS
   115         88 WS-BROWSE-STARTED                VALUE 'Y'.           ELCRATWS
   116     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.  ELCRATWS
   117     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.  ELCRATWS
   118     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.      ELCRATWS
   119     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.      ELCRATWS
   120     12  ERRATE-KEY.                                              ELCRATWS
   121         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.        ELCRATWS
   122         16  RATE-STATE-CODE.                                     ELCRATWS
   123             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.       ELCRATWS
   124             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.       ELCRATWS
   125             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.       ELCRATWS
   126         16  RATE-L-AH-CODE.                                      ELCRATWS
   127             20  RATE-L-AH       PIC  X       VALUE SPACE.        ELCRATWS
   128             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.        ELCRATWS
   129         16  RATE-LIMITS.                                         ELCRATWS
   130             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.        ELCRATWS
   131             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.        ELCRATWS
   132             20  RATE-FUTURE     PIC  XX      VALUE SPACES.       ELCRATWS
   133             20  RATE-SEX        PIC  X       VALUE '9'.          ELCRATWS
   134         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.                CL**3
   135                                                                  ELCRATWS
   136     12  SAVE-ERRATE-KEY.                                         ELCRATWS
   137         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.        ELCRATWS
   138         16  SVRT-STATE-CODE.                                     ELCRATWS
   139             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.       ELCRATWS
   140             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.       ELCRATWS
   141             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.       ELCRATWS
   142         16  SVRT-L-AH-CODE.                                      ELCRATWS
   143             20  SVRT-L-AH       PIC  X       VALUE SPACE.        ELCRATWS
   144             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.        ELCRATWS
   145         16  SVRT-LIMITS.                                         ELCRATWS
   146             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.        ELCRATWS
   147             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.        ELCRATWS
   148             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.       ELCRATWS
   149             20  SVRT-SEX        PIC  X       VALUE '9'.          ELCRATWS
   150         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.                CL**2
   151                                                                  ELCRATWS
   152     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.          ELCRATWS
   153     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.    ELCRATWS
   154                                                                  ELCRATWS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page   5
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATWS)
   155 01  CSL-WORK-AREAS          COMP-3.                              ELCRATWS
   156     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.      ELCRATWS
   157     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.      ELCRATWS
   158     12  WK-J                PIC S999           VALUE ZEROS.      ELCRATWS
   159     12  WK-K                PIC S999           VALUE ZEROS.      ELCRATWS
   160     12  WK-L                PIC S99V9(9)       VALUE ZEROS.      ELCRATWS
   161     12  WK-S                PIC S999V9(4)      VALUE ZEROS.      ELCRATWS
   162     12  WK-T                PIC S999           VALUE ZEROS.      ELCRATWS
   163     12  WK-T1               PIC S999           VALUE ZEROS.      ELCRATWS
   164     12  WK-U                PIC S99V9(9)       VALUE ZEROS.      ELCRATWS
   165     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.      ELCRATWS
   166     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.      ELCRATWS
   167     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   168     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   169     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   170     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   171     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   172     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   173     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.      ELCRATWS
   174     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.      ELCRATWS
   175     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.      ELCRATWS
   176     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.      ELCRATWS
   177                                                                  ELCRATWS
   178 01  TEXAS-REG-WORK-AREAS.                                        ELCRATWS
   179     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.              ELCRATWS
   180     12  TEX-FACT-2          PIC S9(3)       COMP-3.              ELCRATWS
   181     12  TEX-FACT-3          PIC S9(3)       COMP-3.              ELCRATWS
   182     12  TEX-FACT-4          PIC S9(7)       COMP-3.              ELCRATWS
   183     12  TEX-FACT-5          PIC S9(3)       COMP-3.              ELCRATWS
   184     12  TEX-FACT-6          PIC S9(3)       COMP-3.              ELCRATWS
   185     12  TEX-FACT-7          PIC S9(7)       COMP-3.              ELCRATWS
   186     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.              ELCRATWS
   187     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.              ELCRATWS
   188                                                                  ELCRATWS
   189 01  NET-PAY-INTERFACE.                                           ELCRATWS
   190     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.              ELCRATWS
   191     12  N-P-ORIG            PIC S9(3)       COMP-3.              ELCRATWS
   192     12  N-P-REM             PIC S9(3)       COMP-3.              ELCRATWS
   193     12  N-P-OPT             PIC X.                               ELCRATWS
   194     12  N-P-LOAN            PIC S9(3)       COMP-3.              ELCRATWS
   195     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.              ELCRATWS
   196                                                                  ELCRATWS
   197
*  198                             COPY ERCNETWS.
   199***************************************************************** 04/29/98
   200*                                                               * ERCNETWS
   201*                                                               * ERCNETWS
   202*                            ERCNETWS                           *    LV004
   203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
   204*                            VMOD=2.014                         *    CL**3
   205*                                                               * ERCNETWS
   206*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS * ERCNETWS
   207*                                                               * ERCNETWS
   208*****************************************************************.ERCNETWS
   209*                   C H A N G E   L O G
   210*
   211* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   212*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page   6
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   213*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   214* EFFECTIVE    NUMBER
   215*-----------------------------------------------------------------
   216* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   217* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   218* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   219* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   220* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   221******************************************************************
   222                                                                  ERCNETWS
   223 01  NET-PAY-WORK-AREA.                                           ERCNETWS
   224     12  OPTION-SW               PIC X   VALUE 'X'.               ERCNETWS
   225        88  NPO-STD         VALUE SPACE.                          ERCNETWS
   226        88  NPO-ALT         VALUE 'A'.                            ERCNETWS
   227        88  NPO-SIMPLE      VALUE 'S'.                            ERCNETWS
   228        88  NPO-2MO         VALUE 'I'.                            ERCNETWS
   229        88  NPO-3MO         VALUE 'J'.                            ERCNETWS
   230        88  NPO-4MO         VALUE 'K'.                            ERCNETWS
   231        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.            ERCNETWS
   232        88  NPO-TRUNC-0     VALUE 'T'.                            ERCNETWS
   233        88  NPO-TRUNC-1     VALUE 'U'.                            ERCNETWS
   234        88  NPO-TRUNC-2     VALUE 'V'.                            ERCNETWS
   235        88  NPO-TRUNC-3     VALUE 'W'.                            ERCNETWS
   236        88  NPO-TRUNC-4     VALUE 'X'.                            ERCNETWS
   237        88  NPO-REFUND      VALUE 'R'.                            ERCNETWS
   238        88  NPO-PRUDENTIAL  VALUE 'P'.                            ERCNETWS
   239                                                                  ERCNETWS
   240     12  TYPE-SW             PIC X   VALUE 'N'.                   ERCNETWS
   241        88  NET-STD             VALUE 'N'.                        ERCNETWS
   242        88  NET-SMP             VALUE 'S'.                        ERCNETWS
   243                                                                  ERCNETWS
   244     12  NP-PROCESS-SW       PIC X   VALUE '1'.                   ERCNETWS
   245        88  NP-RATING           VALUE '1'.                        ERCNETWS
   246        88  NP-REFUND           VALUE '2'.                        ERCNETWS
   247        88  NP-REMAIN-AMT       VALUE '3'.                        ERCNETWS
   248                                                                  ERCNETWS
   249     12  COMP-3-WORK-AREA         COMP-3.                         ERCNETWS
   250         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.          ERCNETWS
   251         16  V               PIC SV9(13)       VALUE +.0.         ERCNETWS
   252         16  J               PIC SV9(9)        VALUE +0.
   253         16  K               PIC SV9(9)        VALUE +0.
   254         16  I               PIC SV9(10)       VALUE +.0.         ERCNETWS
   255         16  D               PIC S9(5)         VALUE +.0.
   256         16  APR100          PIC SV9(9)        VALUE +.0.         ERCNETWS
   257         16  RA              PIC S9(6)V9(9)    VALUE +.0.         ERCNETWS
   258         16  WK1             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   259         16  WK2             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   260         16  pema            pic s9(2)v9(15)   value +0.
   261         16  WK3             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   262         16  WK4             PIC S9(7)V9(8)    VALUE +.0.         ERCNETWS
   263         16  WK5             PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   264         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.         ERCNETWS
   265         16  WK6             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   266         16  WK7             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   267         16  WK8             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   268         16  WK9             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   269         16  GR              PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   270         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page   7
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   271         16  ODF             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   272         16  OD              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   273         16  FM              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   274         16  FN              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   275         16  FNM             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   276         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   277         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   278         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   279         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   280         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   281         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   282         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   283         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   284         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   285         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   286         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   287         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   288         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   289         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   290         16  K1              PIC S999          VALUE +1.          ERCNETWS
   291         16  K12             PIC S999          VALUE +12.         ERCNETWS
   292         16  K100            PIC S999          VALUE +100.        ERCNETWS
   293         16  K1000           PIC S9(7)         VALUE +1000.       ERCNETWS
   294         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.         ERCNETWS
   295         16  Y REDEFINES NC-LR
   296                             PIC S99V9(5).
   297         16  TI              PIC S999V9(5)     VALUE +0.
   298         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   299         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   300         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   301         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   302         16  NC-BIG-D        PIC S9(3)         VALUE +030.        ERCNETWS
   303         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.         ERCNETWS
   304         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   305         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   306                                                                  ERCNETWS
   307         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   308         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   309         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   310         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   311         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   312         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.    ERCNETWS
   313         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   314         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   315         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   316         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   317         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.         ERCNETWS
   318         16  GTL-IA-SGN      PIC S9            VALUE +.0.         ERCNETWS
   319         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.       ERCNETWS
   320                                                                  ERCNETWS
   321         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.         ERCNETWS
   322                                                                  ERCNETWS
   323         16  ORIGINAL-TERM   PIC S999.                            ERCNETWS
   324         16  M              REDEFINES ORIGINAL-TERM               ERCNETWS
   325                             PIC S999.                            ERCNETWS
   326                                                                  ERCNETWS
   327         16  REMAINING-TERM  PIC S999.                            ERCNETWS
   328         16  R              REDEFINES REMAINING-TERM              ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page   8
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   329                             PIC S999.                            ERCNETWS
   330                                                                  ERCNETWS
   331         16  LOAN-TERM       PIC S999.                            ERCNETWS
   332         16  N              REDEFINES LOAN-TERM                   ERCNETWS
   333                             PIC S999.                            ERCNETWS
   334                                                                  ERCNETWS
   335         16  EXPIRED-TERM    PIC S999.                            ERCNETWS
   336         16  E              REDEFINES EXPIRED-TERM                ERCNETWS
   337                             PIC S999.                            ERCNETWS
   338                                                                  ERCNETWS
   339         16  PRUDENTIAL-WORK-AMT                                  ERCNETWS
   340                             PIC S9(7)V9(8).                      ERCNETWS
   341         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT         ERCNETWS
   342                             PIC S9(7)V9(8).                      ERCNETWS
   343                                                                  ERCNETWS
   344         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.        ERCNETWS
   345         16  VX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   346         16  SV              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   347         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.        ERCNETWS
   348         16  SX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   349         16  SE              PIC S9V9(10)      VALUE +0.0.        ERCNETWS
   350         16  N2              PIC S9(7)         VALUE +0.          ERCNETWS
   351         16  N3              PIC S9(7)         VALUE +0.          ERCNETWS
   352         16  K-I             PIC S9V9(8)       VALUE +0.0.        ERCNETWS
   353                                                                  ERCNETWS
   354     12  BINARY-WORK-AREA        COMP.                            ERCNETWS
   355         16  X1              PIC S999        VALUE +0.            ERCNETWS
   356         16  X2              PIC S999        VALUE +0.            ERCNETWS
   357         16  MAX-X           PIC S9(5)       VALUE +0.            ERCNETWS
   358         16  B1              PIC S9(5)       VALUE +1.            ERCNETWS
   359         16  LINDX           PIC S999        VALUE ZEROS.         ERCNETWS
   360         16  AHNDX           PIC S999        VALUE ZEROS.         ERCNETWS
   361                                                                  ERCNETWS
   362     12  CSO-RATE-WORK-AREAS.
   363         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   364         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   365         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   366
   367     12  WS-WORK-MISC.                                            ERCNETWS
   368         16  ws-extra-pmts       pic s999         comp-3.
   369         16  NET-BEN             PIC S9(9)V9999   COMP-3.         ERCNETWS
   370         16  WS-RATE-TERM        PIC S9(3)        COMP-3.         ERCNETWS
   371*        16  WS-AGE              PIC 99           VALUE ZEROS.    ERCNETWS
   372         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   373         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.         ERCNETWS
   374         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.   ERCNETWS
   375         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.  ERCNETWS
   376         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.              ERCNETWS
   377         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.          CL**2
   378         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.          CL**2
   379         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   380         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   381         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   382         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0. ERCNETWS
   383         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0. ERCNETWS
   384******************************************************************ERCNETWS
   385
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page   9
* ELRATEX.cbl
*  387                             COPY ELCDATE.
   388******************************************************************06/11/98
   389*                                                                *ELCDATE
   390*                                                                *ELCDATE
   391*                            ELCDATE.                            *   LV023
   392*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   393*                            VMOD=2.003                           ELCDATE
   394*                                                                *ELCDATE
   395*                                                                *ELCDATE
   396*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   397*                 LENGTH = 200                                   *   CL*19
   398******************************************************************ELCDATE
   399                                                                  ELCDATE
   400 01  DATE-CONVERSION-DATA.                                        ELCDATE
   401     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   402     12  DC-OPTION-CODE                PIC X.                        CL*15
   403         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   404         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   405         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   406         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   407         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   408         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   409         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   410         88  FIND-CENTURY               VALUE '7'.                   CL*22
   411         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   412         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   413         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   414         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   415         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   416         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   417         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   418         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   419         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   420         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   421         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   422         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   423         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   424         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   425         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   426         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   427         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   428         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   429         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   430         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   431         88  THREE-CHARACTER-BIN                                  ELCDATE
   432                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   433         88  GREGORIAN-TO-BIN                                        CL**2
   434                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   435         88  BIN-TO-GREGORIAN                                        CL**2
   436                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   437         88  JULIAN-TO-BINARY                                        CL**2
   438                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   439     12  DC-ERROR-CODE                 PIC X.                        CL*15
   440         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   441         88  DATE-CONVERSION-ERROR                                ELCDATE
   442                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   443         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   444         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  10
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   445         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   446         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   447         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   448         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   449         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   450         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   451         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   452         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   453     12  DC-END-OF-MONTH               PIC X.                        CL*15
   454         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   455     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   456         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   457         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   458         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   459     12  FILLER                        PIC X.                        CL*15
   460     12  DC-CONVERSION-DATES.                                        CL*15
   461         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   462         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   463         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   464         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   465                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   466             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   467             20  SLASH1-1              PIC X.                        CL*15
   468             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   469             20  SLASH1-2              PIC X.                        CL*15
   470             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   471         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   472         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   473                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   474             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   475             20  SLASH2-1              PIC X.                        CL*15
   476             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   477             20  SLASH2-2              PIC X.                        CL*15
   478             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   479         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   480         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   481                     DC-GREG-DATE-1-YMD.                          ELCDATE
   482             20  DC-YMD-YEAR           PIC 99.                       CL*15
   483             20  DC-YMD-MONTH          PIC 99.                       CL*15
   484             20  DC-YMD-DAY            PIC 99.                       CL*15
   485         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   486         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   487                      DC-GREG-DATE-1-MDY.                         ELCDATE
   488             20  DC-MDY-MONTH          PIC 99.                       CL*15
   489             20  DC-MDY-DAY            PIC 99.                       CL*15
   490             20  DC-MDY-YEAR           PIC 99.                       CL*15
   491         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   492             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   493             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   494             20  FILLER                PIC XX.                       CL*15
   495             20  DC-ALPHA-CENTURY.                                   CL*15
   496                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   497             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   498         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   499         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   500         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   501         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   502         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  11
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   503                                       PIC 9(05).                    CL*20
   504         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   505             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   506             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   507         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   508         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   509         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   510     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   511         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   512         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   513             20  FILLER                PIC 9(3).                     CL*15
   514             20  HOLD-CEN-1-CCYY.                                    CL*15
   515                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   516                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   517             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   518             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   519         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   520             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   521             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   522             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   523                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   524                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   525             20  FILLER                PIC 9(3).                     CL*15
   526         16  HOLD-CENTURY-1-X.                                       CL*15
   527             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   528             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   529                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   530                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   531             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   532             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   533         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   534             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   535             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   536             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   537                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   538                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   539             20  FILLER                PIC XXX.                      CL*23
   540         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   541         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   542         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   543         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   544             20  DC-JULIAN-1-CCYY.                                   CL*15
   545                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   546                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   547             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   548         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   549         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   550             20  DC-JULIAN-2-CCYY.                                   CL*15
   551                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   552                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   553             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   554         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   555             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   556             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   557             20  DC-EDITA-DAY          PIC 99.                       CL*15
   558             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   559             20  DC-EDITA-CCYY.                                      CL*15
   560                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  12
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   561                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   562         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   563             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   564             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   565             20  DC-EDITB-DAY          PIC 99.                       CL*15
   566             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   567             20  DC-EDITB-CCYY.                                      CL*15
   568                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   569                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   570         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   571         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   572                              DC-GREG-DATE-CYMD.                  ELCDATE
   573             20  DC-CYMD-CEN           PIC 99.                       CL*15
   574             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   575             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   576             20  DC-CYMD-DAY           PIC 99.                       CL*15
   577         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   578         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   579                              DC-GREG-DATE-MDCY.                  ELCDATE
   580             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   581             20  DC-MDCY-DAY           PIC 99.                       CL*15
   582             20  DC-MDCY-CEN           PIC 99.                       CL*15
   583             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   584    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   585        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   586    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   587    12  FILLER                         PIC X(28).                    CL*26
   588
*  589                             COPY ERCRATE.
   590******************************************************************01/20/90
   591*                                                                *ERCRATE
   592*                                                                *ERCRATE
   593*                            ERCRATE                             *   LV007
   594*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   595*                            VMOD=2.008                          *   CL**7
   596*                                                                *ERCRATE
   597*   ONLINE CREDIT SYSTEM                                         *ERCRATE
   598*                                                                *ERCRATE
   599*   FILE DESCRIPTION = RATES MASTER FILE                         *ERCRATE
   600*                                                                *ERCRATE
   601*   FILE TYPE = VSAM,KSDS                                        *ERCRATE
   602*   RECORD SIZE = 1765  RECFORM = FIXED                          *ERCRATE
   603*                                                                *ERCRATE
   604*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *ERCRATE
   605*       ALTERNATE PATH = NONE                                    *ERCRATE
   606*                                                                *ERCRATE
   607*   LOG = NO                                                     *ERCRATE
   608*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRATE
   609*                                                                *ERCRATE
   610******************************************************************ERCRATE
   611******************************************************************
   612*                   C H A N G E   L O G
   613*
   614* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   615*-----------------------------------------------------------------
   616*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   617* EFFECTIVE    NUMBER
   618*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  13
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCRATE)
   619* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   620* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
   621******************************************************************
   622                                                                  ERCRATE
   623 01  RATE-RECORD.                                                 ERCRATE
   624     12  RT-RECORD-ID                      PIC XX.                ERCRATE
   625         88  VALID-RT-ID                      VALUE 'RT'.         ERCRATE
   626                                                                  ERCRATE
   627     12  RT-CONTROL-PRIMARY.                                      ERCRATE
   628         16  RT-COMPANY-CD                 PIC X.                 ERCRATE
   629         16  RT-STATE-CODE.                                       ERCRATE
   630             20  RT-ST-CODE                PIC XX.                ERCRATE
   631             20  RT-ST-CLASS               PIC XX.                ERCRATE
   632             20  RT-ST-DEV                 PIC XXX.               ERCRATE
   633         16  RT-L-AH-CODE.                                        ERCRATE
   634             20  RT-L-AH                   PIC X.                 ERCRATE
   635             20  RT-LAH-NUM                PIC XX.                   CL**3
   636         16  RT-LIMITS.                                           ERCRATE
   637             20  RT-HIGH-AGE               PIC 99.                ERCRATE
   638             20  RT-HIGH-AMT               PIC 9(6).              ERCRATE
   639             20  RT-FUTURE                 PIC XX.                ERCRATE
   640             20  RT-SEX                    PIC X.                 ERCRATE
   641         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.     ERCRATE
   642                                                                  ERCRATE
   643     12  RT-MAINT-INFORMATION.                                    ERCRATE
   644         16  RT-LAST-MAINT-DT              PIC XX.                ERCRATE
   645         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCRATE
   646         16  RT-LAST-MAINT-USER            PIC X(4).              ERCRATE
   647         16  FILLER                        PIC X(10).             ERCRATE
   648                                                                  ERCRATE
   649     12  RT-STRUCTURE-COMMENT              PIC X(50).             ERCRATE
   650     12  RT-RATE-COMMENT                   PIC X(50).             ERCRATE
   651                                                                  ERCRATE
   652     12  CSL-RESERVED                      PIC X(10).                CL**7
   653     12  FILLER                            PIC X(12).                CL**7
   654                                                                  ERCRATE
   655     12  RT-MAX-AGE                        PIC 99.                ERCRATE
   656                                                                  ERCRATE
   657     12  RT-LIFE-LIMS-FLDS.                                       ERCRATE
   658         16  RT-LIFE-MORT-CODE             PIC X(4).              ERCRATE
   659         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.                 ERCRATE
   660             20  RT-L-EX-AGE               PIC 99.                ERCRATE
   661             20  RT-L-EX-TERM              PIC S999       COMP-3. ERCRATE
   662             20  RT-L-EX-FACE              PIC S9(7)      COMP-3. ERCRATE
   663         16  RT-LIFE-TERM-MINS OCCURS 8.
   664             20  RT-L-MIN-TERM             PIC S999       COMP-3.
   665         16  FILLER                        PIC X(4).
   666*        16  FILLER                        PIC X(20).             ERCRATE
   667                                                                  ERCRATE
   668     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.         ERCRATE
   669         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.                   ERCRATE
   670             20  RT-AH-AGE                 PIC 99.                ERCRATE
   671             20  RT-AH-TERM                PIC S999       COMP-3. ERCRATE
   672             20  RT-AH-BEN-M               PIC S9(5)      COMP-3. ERCRATE
   673             20  RT-AH-BEN-F               PIC S9(7)      COMP-3. ERCRATE
   674                                                                  ERCRATE
   675     12  RT-LIFE-RATES.                                           ERCRATE
   676         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3. ERCRATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  14
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCRATE)
   677                                                                  ERCRATE
   678     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.                 ERCRATE
   679         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3. ERCRATE
   680                                                                  ERCRATE
   681     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.    CL**2
   682                                                                     CL**2
   683     12  RT-DISCOUNT-OPTION                PIC X.                    CL**5
   684         88  RT-DO-NOT-USE                     VALUE ' '.            CL**5
   685         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.            CL**5
   686         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.            CL**5
   687                                                                     CL**5
   688     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.    CL**5
   689     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.    CL**5
   690                                                                     CL**5
   691     12  RT-COMPOSITE-OPTION               PIC X.                    CL**6
   692         88  RT-NO-COMPOSITE                   VALUE ' '.            CL**6
   693         88  RT-USE-COMPOSITE-RATE             VALUE '1'.            CL**6
   694                                                                     CL**6
   695     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.    CL**6
   696                                                                     CL**6
   697     12  RT-CANCEL-FEE                     PIC S9(3)V99   COMP-3.    CL**7
   698     12  FILLER                            PIC X(13).                CL**7
   699                                                                     CL**4
   700     12  RT-TYPE-RATE                      PIC X.                    CL**4
   701         88  RT-IS-STND                        VALUE ' ' 'S'.        CL**4
   702         88  RT-IS-OB                          VALUE 'O'.            CL**4
   703                                                                  ERCRATE
   704     12  RT-SRT-ALPHA                      PIC X.                 ERCRATE
   705                                                                  ERCRATE
   706     12  RT-CONTROL-2.                                            ERCRATE
   707         16  RTC-1                         PIC X(7).              ERCRATE
   708         16  RTC-3                         PIC X(11).             ERCRATE
   709         16  RTC-4                         PIC 9(11) COMP-3.      ERCRATE
   710         16  RTC-2                         PIC X(3).              ERCRATE
   711******************************************************************ERCRATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  15
* ELRATEX.cbl
   713 LINKAGE SECTION.
   714
*  715                             COPY ELCCALC.
   716******************************************************************04/15/98
   717*                                                                *ELCCALC
   718*                           ELCCALC.                            *    LV003
   719*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   720*                            VMOD=2.025                          *   CL**3
   721*                                                                *   CL**2
   722*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   723*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   724*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   725*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   726*                                                                *   CL**2
   727*  PASSED TO ELRTRM                                              *   CL**2
   728*  -----------------                                             *   CL**2
   729*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   730*  ORIGINAL TERM                                                 *   CL**2
   731*  BEGINNING DATE                                                *   CL**2
   732*  ENDING DATE                                                   *   CL**2
   733*  COMPANY I.D.                                                  *   CL**2
   734*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   735*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   736*  FREE LOOK DAYS                                                *   CL**2
   737*                                                                *   CL**2
   738*  RETURNED FROM ELRTRM                                          *   CL**2
   739*  ---------------------                                         *   CL**2
   740*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   741*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   742*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   743*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   744*----------------------------------------------------------------*   CL**2
   745*  PASSED TO ELRAMT                                              *   CL**2
   746*  ----------------                                              *   CL**2
   747*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   748*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   749*  ORIGINAL AMOUNT                                               *   CL**2
   750*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   751*  A.P.R. - NET PAY ONLY                                         *   CL**2
   752*  METHOD                                                            CL**2
   753*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   754*  COMPANY I.D.                                                  *   CL**2
   755*  BENEFIT TYPE                                                  *   CL**2
   756*                                                                *   CL**2
   757*  RETURNED FROM ELRAMT                                          *   CL**2
   758*  --------------------                                          *   CL**2
   759*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   760*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   761*  REMAINING AMOUNT FACTOR                                           CL**2
   762*----------------------------------------------------------------*   CL**2
   763*  PASSED TO ELRESV                                              *   CL**2
   764*  -----------------                                             *   CL**2
   765*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   766*  VALUATION DATE                                                *   CL**2
   767*  PAID THRU DATE                                                *   CL**2
   768*  BENEFIT                                                       *   CL**2
   769*  INCURRED DATE                                                 *   CL**2
   770*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  16
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCCALC)
   771*  ISSUE AGE                                                     *   CL**2
   772*  TERM                                                          *   CL**2
   773*  CDT PERCENT                                                   *   CL**2
   774*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   775* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   776* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   777* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   778*                                                                *   CL**2
   779*  RETURNED FROM ELRESV                                          *   CL**2
   780*  --------------------                                          *   CL**2
   781*  CDT TABLE USED                                                *   CL**2
   782*  CDT FACTOR USED                                               *   CL**2
   783*  PAY TO CURRENT RESERVE                                        *   CL**2
   784*  I.B.N.R. - A/H ONLY                                           *   CL**2
   785*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   786*----------------------------------------------------------------*   CL**2
   787*  PASSED TO ELRATE                                              *   CL**2
   788*  ----------------                                              *   CL**2
   789*  CERT ISSUE DATE                                               *   CL**2
   790*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   791*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   792*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   793*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   794*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   795*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   796*  DEVIATION CODE                                                *   CL**2
   797*  ISSUE AGE                                                     *   CL**2
   798*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   799*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   800*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   801*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   802*  A.P.R.                                                        *   CL**2
   803*  METHOD                                                            CL**2
   804*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   805*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   806*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   807*  BENEFIT CODE                                                  *   CL**2
   808*  BENEFIT OVERRIDE CODE                                         *   CL**2
   809*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   810*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   811*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   812*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   813*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   814*                                                                *   CL**2
   815*  RETURNED FROM ELRATE                                          *   CL**2
   816*  --------------------                                          *   CL**2
   817*  CALCULATED PREMIUM                                            *   CL**2
   818*  PREMIUM RATE                                                  *   CL**2
   819*  MORTALITY CODE                                                *   CL**2
   820*  MAX ATTAINED AGE                                              *   CL**2
   821*  MAX AGE                                                       *   CL**2
   822*  MAX TERM                                                      *   CL**2
   823*  MAX MONTHLY BENEFIT                                           *   CL**2
   824*  MAX TOTAL BENIFIT                                             *   CL**2
   825*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   826*----------------------------------------------------------------*   CL**2
   827*  PASSED TO ELRFND                                              *   CL**2
   828*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  17
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCCALC)
   829*  CERT ISSUE DATE                                               *   CL**2
   830*  REFUND DATE                                                   *   CL**2
   831*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   832*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   833*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   834*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   835*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   836*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   837*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   838*  DEVIATION CODE                                                *   CL**2
   839*  ISSUE AGE                                                     *   CL**2
   840*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   841*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   842*  PROCESS TYPE (CANCEL)                                         *   CL**2
   843*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   844*  A.P.R.                                                        *   CL**2
   845*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   846*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   847*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   848*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   849*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   850*  BENEFIT CODE                                                  *   CL**2
   851*  BENEFIT OVERRIDE CODE                                         *   CL**2
   852*                                                                *   CL**2
   853*  RETURNED FROM ELRFND                                          *   CL**2
   854*  --------------------                                          *   CL**2
   855*  CALCULATED REFUND                                             *   CL**2
   856*----------------------------------------------------------------*   CL**2
   857*  PASSED TO ELEARN                                              *   CL**2
   858*  ----------------                                              *   CL**2
   859*  CERT ISSUE DATE                                               *   CL**2
   860*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   861*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   862*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   863*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   864*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   865*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   866*  DEVIATION CODE                                                *   CL**2
   867*  ISSUE AGE                                                     *   CL**2
   868*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   869*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   870*  A.P.R.                                                        *   CL**2
   871*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   872*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   873*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   874*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   875*  BENEFIT CODE                                                  *   CL**2
   876*  BENEFIT OVERRIDE CODE                                         *   CL**2
   877*                                                                *   CL**2
   878*  RETURNED FROM ELEARN                                          *   CL**2
   879*  --------------------                                          *   CL**2
   880*  INDICATED  EARNINGS                                           *   CL**2
   881*----------------------------------------------------------------*   CL**2
   882*                 LENGTH = 450                                   *   CL**2
   883*                                                                *   CL**2
   884******************************************************************   CL**2
   885******************************************************************
   886*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  18
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCCALC)
   887*
   888* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   889*-----------------------------------------------------------------
   890*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   891* EFFECTIVE    NUMBER
   892*-----------------------------------------------------------------
   893* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   894* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   895* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   896* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   897* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   898* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   899* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   900* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   901* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   902* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   903* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   904* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
   905******************************************************************
   906                                                                     CL**2
   907 01  CALCULATION-PASS-AREA.                                          CL**2
   908     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   909                                     COMP.                           CL**2
   910                                                                     CL**2
   911     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   912       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   913       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   914                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
   915       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   916       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   917       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   918       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   919       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   920       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   921       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   922       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   923       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   924       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   925       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   926       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   927       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   928       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   929       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   930       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   931       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   932       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
   933                                                                     CL**2
   934     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   935       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   936***********************  INPUT AREAS ****************************    CL**2
   937                                                                     CL**2
   938     12  CP-CALCULATION-AREA.                                        CL**2
   939         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   940         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   941         16  CP-VALUATION-DT       PIC XX.                           CL**2
   942         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   943         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   944           88  CP-AH                               VALUE 'A' 'D'     CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  19
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCCALC)
   945                                                   'I' 'U'.          CL**2
   946           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
   947           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
   948         16  CP-INCURRED-DT        PIC XX.                           CL**2
   949         16  CP-REPORTED-DT        PIC XX.                           CL**2
   950         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   951         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   952         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   953                                     COMP-3.                         CL**2
   954         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   955                                     COMP-3.                         CL**2
   956         16  CP-CDT-METHOD         PIC X.                            CL**2
   957           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   958           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   959           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   960         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   961           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   962           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   963         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   964                                     COMP-3.                         CL**2
   965         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   966                                     COMP-3.                         CL**2
   967         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   968                                     COMP-3.                         CL**2
   969         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   970                                     COMP-3.                         CL**2
   971         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   972                                     COMP-3.                         CL**2
   973         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   974                                     COMP-3.                         CL**2
   975         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   976                                     COMP-3.                         CL**2
   977         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   978           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   979           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   980           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   981           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   982           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   983           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   984           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   985         16  CP-EARNING-METHOD     PIC X.                            CL**2
   986           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   987           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   988           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   989           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   990           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   991           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   992           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   993           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   994           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   995           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   996           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   997           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   998           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   999           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1000         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  1001           88  CP-CLAIM                            VALUE '1'.        CL**2
  1002           88  CP-CANCEL                           VALUE '2'.        CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  20
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCCALC)
  1003           88  CP-ISSUE                            VALUE '3'.        CL**2
  1004         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  1005           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  1006           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  1007           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  1008           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  1009           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  1010           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  1011           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  1012           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  1013           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  1014           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  1015           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  1016           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  1017           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  1018           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  1019           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  1020           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  1021           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  1022           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  1023                                                     'W' 'X'.        CL**2
  1024           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  1025           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  1026           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  1027           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  1028           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  1029           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  1030           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  1031           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  1032           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  1033           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  1034           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  1035           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  1036           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1037                                                                     CL**2
  1038         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1039                                     COMP-3.                         CL**2
  1040         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1041         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1042         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1043         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1044         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1045           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1046               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1047         16  CP-R78-OPTION         PIC X.                            CL**2
  1048           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1049           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1050                                                                     CL**2
  1051         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1052         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1053         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1054         16  CP-RATE-FILE          PIC X.                            CL**2
  1055         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1056                                     COMP-3.                         CL**2
  1057                                                                     CL**2
  1058         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1059         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1060                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  21
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCCALC)
  1061         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1062                                     COMP-3.
  1063         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1064                                   PIC S9(5)V99 COMP-3.
  1065         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  1066                                     COMP-3.                         CL**2
  1067         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1068                                     COMP-3.                         CL**2
  1069         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1070                                     COMP-3.
  1071         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1072                                  PIC S9(7)V99 COMP-3.
  1073                                                                     CL**2
  1074         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1075         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1076         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1077           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1078           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1079           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1080           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1081         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1082         16  CP-CARRIER            PIC X.                            CL**2
  1083         16  CP-REIN-FLAG          PIC X.                            CL**2
  1084         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1085           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1086                      '2' '3' '4' '5'.                               CL**2
  1087           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1088           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1089           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1090           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1091           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1092           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1093           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1094           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1095         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1096         16  CP-RATING-METHOD      PIC X.                            CL**2
  1097           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1098           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1099           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1100           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1101           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1102           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1103           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1104           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1105           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1106         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1107                                     COMP-3.                         CL**2
  1108         16  CP-BEN-CATEGORY       PIC X.
  1109         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1110         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1111                                   PIC S99V9(5) COMP-3.
  1112         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1113         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1114                                   PIC S99V9(5) COMP-3.
  1115         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1116         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1117         16  CP-EXPIRE-DT          PIC XX.
  1118         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  22
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCCALC)
  1119         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1120         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1121         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1122         16  CP-DDF-SPEC-CALC      PIC X.
  1123             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1124             88  CP-CALC-CLP              VALUE 'C'.
  1125         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1126         16  CP-CANCEL-REASON      PIC X.
  1127         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1128         16  CP-PMT-MODE           PIC X.
  1129         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1130         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1131         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1132         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1133         16  FILLER                PIC X.
  1134                                                                     CL**2
  1135***************    OUTPUT FROM ELRESV   ************************     CL**2
  1136                                                                     CL**2
  1137         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  1138                                                                     CL**2
  1139         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  1140                                     COMP-3.                         CL**2
  1141         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  1142                                     COMP-3.                         CL**2
  1143         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  1144                                     COMP-3.                         CL**2
  1145         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  1146                                     COMP-3.                         CL**2
  1147         16  FILLER                PIC X(09).                        CL**2
  1148***************    OUTPUT FROM ELRTRM   *************************    CL**2
  1149                                                                     CL**2
  1150         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  1151                                     COMP-3.                         CL**2
  1152         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  1153                                     COMP-3.                         CL**2
  1154         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  1155                                     COMP-3.                         CL**2
  1156         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  1157                                     COMP-3.                         CL**2
  1158         16  FILLER                PIC X(12).                        CL**2
  1159                                                                     CL**2
  1160***************    OUTPUT FROM ELRAMT   *************************    CL**2
  1161                                                                     CL**2
  1162         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  1163                                     COMP-3.                         CL**2
  1164         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  1165                                     COMP-3.                         CL**2
  1166         16  FILLER                PIC X(12).                        CL**2
  1167                                                                     CL**2
  1168***************    OUTPUT FROM ELRATE   *************************    CL**2
  1169                                                                     CL**2
  1170         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  1171                                     COMP-3.                         CL**2
  1172         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  1173                                     COMP-3.                         CL**2
  1174         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  1175         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  1176             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  23
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCCALC)
  1177         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  1178                                     COMP-3.                         CL**2
  1179         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  1180         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1181         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1182                                   PIC S9(7)V99 COMP-3.
  1183         16  FILLER                PIC X(07).                        CL**2
  1184                                                                     CL**2
  1185***************    OUTPUT FROM ELRFND   *************************    CL**2
  1186                                                                     CL**2
  1187         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  1188                                     COMP-3.                         CL**2
  1189         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  1190           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  1191           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  1192           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  1193           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  1194           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1195           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  1196           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  1197           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  1198           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1199           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1200           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1201           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1202           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1203           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1204         16  FILLER                PIC X(12).                        CL**2
  1205                                                                     CL**2
  1206***************    OUTPUT FROM ELEARN   *************************    CL**2
  1207                                                                     CL**2
  1208         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  1209                                     COMP-3.                         CL**2
  1210         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  1211                                     COMP-3.                         CL**2
  1212         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1213                                     COMP-3.                         CL**2
  1214         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1215                                     COMP-3.                         CL**2
  1216         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1217                                     COMP-3.                         CL**2
  1218         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1219                                     COMP-3.                         CL**2
  1220         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1221           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1222           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1223           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1224           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1225           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1226           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1227           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1228           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1229           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1230         16  FILLER                PIC X(12).                        CL**2
  1231                                                                     CL**2
  1232***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1233                                                                     CL**2
  1234         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  24
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCCALC)
  1235                                     COMP-3.                         CL**2
  1236         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1237                                     COMP-3.                         CL**2
  1238         16  FILLER                PIC X(12).                        CL**2
  1239                                                                     CL**2
  1240***************   MISC WORK AREAS    *****************************   CL**2
  1241         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1242                                     COMP-3.                         CL**2
  1243         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1244                                     COMP-3.                         CL**2
  1245         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1246                                     COMP-3.                         CL**2
  1247         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1248                                     COMP-3.                         CL**2
  1249         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1250                                     COMP-3.                         CL**2
  1251         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1252                                     COMP-3.                         CL**2
  1253         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1254             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1255             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1256             88  IO-ERROR                         VALUE 'E'.         CL**2
  1257                                                                     CL**2
  1258         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1259                                                                     CL**2
  1260         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1261                                                                     CL**2
  1262         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1263                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1264                                     COMP-3.                         CL**2
  1265                                                                     CL**2
  1266         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1267                                                                     CL**2
  1268         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1269                                     COMP-3.                         CL**2
  1270                                                                     CL**2
  1271         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1272                                     COMP-3.                         CL**2
  1273                                                                     CL**2
  1274         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1275                                     COMP-3.                         CL**2
  1276                                                                     CL**2
  1277         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1278                                     COMP-3.                         CL**2
  1279                                                                     CL**2
  1280         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1281                                     COMP-3.                         CL**2
  1282                                                                     CL**2
  1283         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1284                                     COMP-3.                         CL**2
  1285                                                                     CL**2
  1286         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1287                                     COMP-3.                         CL**2
  1288                                                                     CL**2
  1289         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1290             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1291                                                                     CL**2
  1292         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  25
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCCALC)
  1293                                     COMP-3.                         CL**2
  1294         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1295                                     COMP-3.
  1296         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1297         16  cp-extra-periods      pic 9 value zeros.
  1298         16  cp-net-only-state     pic x value spaces.
  1299         16  FILLER                PIC X(13).                        CL**2
  1300******************************************************************   CL**2
  1301
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  26
* ELRATEX.cbl
  1303 PROCEDURE DIVISION USING CALCULATION-PASS-AREA.
  1304
  1305 000-START-PREMIUM-CALC.
  1306
  1307*    IF CP-RATE-FILE = 'O'
  1308*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1309
  1310     IF  OPEN-RATE-FILE
  1311         GO TO 9999-OPEN-RATE-FILE.
  1312
  1313     IF  CLOSE-RATE-FILE
  1314         GO TO 9999-CLOSE-RATE-FILE.
  1315
  1316     MOVE ZERO                   TO CP-RETURN-CODE
  1317                                    CP-CALC-PREMIUM
  1318                                    CP-PREMIUM-RATE
  1319                                    CP-cancel-FEE.
  1320
  1321     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1322     MOVE ALL '9'                TO ERRATE-KEY.
  1323
  1324     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1325     MOVE CP-STATE               TO RATE-ST-CODE.
  1326     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1327     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1328     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1329
  1330     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1331        CP-RATING-BENEFIT-AMT = ZEROS
  1332         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1333     ELSE
  1334         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1335
  1336     IF CP-AH
  1337         MOVE CP-AH-OVERRIDE-CODE    TO RATE-L-AH
  1338     ELSE
  1339         MOVE CP-LIFE-OVERRIDE-CODE  TO RATE-L-AH.
  1340
  1341     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1342     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1343     MOVE SPACE                  TO DC-OPTION-CODE.
  1344
  1345     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1346     IF NO-CONVERSION-ERROR
  1347         MOVE DC-GREG-DATE-CYMD  TO RATE-EXPIRY-DATE
  1348         MOVE  ERRATE-KEY        TO SAVE-ERRATE-KEY
  1349     ELSE
  1350         MOVE '2'                TO CP-RETURN-CODE
  1351         GO TO 9999-CALC-RATE-PREM-X.
  1352
  1353 0050-RATE-START-BROWSE.
  1354     IF ERRATE-FILE-ID = OERATE-FILE-ID
  1355         MOVE ERRATE-KEY TO OE-RATE-KEY
  1356         START OERATEF KEY NOT LESS THAN OE-RATE-KEY
  1357     ELSE
  1358         MOVE ERRATE-KEY TO ER-RATE-KEY
  1359         START ERRATEF KEY NOT LESS THAN ER-RATE-KEY.
  1360
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  27
* ELRATEX.cbl
  1361     IF  ER-STATUS NOT = '00'
  1362         GO TO 9999-RATE-NOTFND.
  1363
  1364 0100-READ-RATE-LOOP.
  1365     IF ERRATE-FILE-ID = OERATE-FILE-ID
  1366         READ OERATEF NEXT RECORD
  1367     ELSE
  1368         READ ERRATEF NEXT RECORD.
  1369
  1370     IF  ER-STATUS NOT = '00'
  1371         GO TO 9999-RATE-NOTFND.
  1372
  1373     IF ERRATE-FILE-ID = OERATE-FILE-ID
  1374         MOVE OE-RATE-REC TO RATE-RECORD
  1375     ELSE
  1376         MOVE ER-RATE-REC TO RATE-RECORD.
  1377
  1378 0110-CHECK-KEYS.
* 1379                      COPY ELCRATPD.
  1380******************************************************************
  1381*                                                                *
  1382*                                                                *
  1383*                            ELCRATPD                            *
  1384*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1385*                            VMOD=2.061                          *
  1386*                                                                *
  1387******************************************************************
  1388******************************************************************
  1389*                   C H A N G E   L O G
  1390*
  1391* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1392*-----------------------------------------------------------------
  1393*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1394* EFFECTIVE    NUMBER
  1395*-----------------------------------------------------------------
  1396* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1397* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1398* 032603                   PEMA  ADD SPECIAL AZ CALC
  1399* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1400* 120403                   PEMA  ADD SPECIAL TX CALC
  1401* 092205                   PEMA  FIX CRIT PER FOR DCC
  1402* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1403* 021207                   PEMA  ADD PA NP
  1404* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1405* 032807                   PEMA  ADD VT NP PLUS 2
  1406* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1407* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1408* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1409* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1410* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1411* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1412* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1413* 071211    2010012700001  PEMA  ADD SPPDD
  1414* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1415* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1416* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1417* 032612  CR2011110200001  PEMA  AHL CHANGES
  1418* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  28
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  1419* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  1420* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  1421* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1422* 021519  CR2019021100001  PEMA  non-monthly al calcs
  1423* 072419  IR2019072400001  PEMA  Initialize pmt mode(AL)
  1424* 012820  CR2020012800001  PEMA  ADD EDIT FOR MINIMUM TERMS
  1425******************************************************************
  1426
  1427 0110-CHECK-KEY.
  1428     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1429        SVRT-ST-CODE    = RT-ST-CODE     AND
  1430        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1431        SVRT-ST-DEV     = RT-ST-DEV      AND
  1432        SVRT-L-AH       = RT-L-AH        AND
  1433        SVRT-LAH-NUM    = RT-LAH-NUM
  1434         NEXT SENTENCE
  1435     ELSE
  1436         GO TO 9999-RATE-NOTFND.
  1437
  1438     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1439         GO TO 9999-RATE-NOTFND.
  1440
  1441     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1442        GO TO 0100-READ-RATE-LOOP.
  1443
  1444     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1445         GO TO 0100-READ-RATE-LOOP.
  1446
  1447     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1448         GO TO 0100-READ-RATE-LOOP.
  1449
  1450     IF RT-MAX-AGE = ZEROS
  1451         NEXT SENTENCE
  1452     ELSE
  1453         COMPUTE WS-AGE =
  1454             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1455         IF WS-AGE >= RT-MAX-AGE
  1456             MOVE 'B'               TO CP-RETURN-CODE.
  1457
  1458     IF CP-LOAN-TERM NOT NUMERIC
  1459         MOVE +0                    TO CP-LOAN-TERM.
  1460
  1461     IF CP-LOAN-TERM = ZERO
  1462         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1463
  1464     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1465         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1466
  1467     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1468     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1469
  1470     IF CP-AH
  1471         GO TO 2000-TYPE-IS-AH.
  1472
  1473*    display ' ben type           ' cp-benefit-type
  1474*    display ' earn meth          ' cp-earning-method
  1475*    display ' process type       ' cp-process-type
  1476*    display ' special            ' cp-special-calc-cd
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  29
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  1477*    display ' ben code           ' cp-benefit-cd
  1478*    display ' ext days calc      ' cp-ext-days-calc
  1479*    display ' rating meth        ' cp-rating-method
  1480*    display ' orig ben           ' cp-original-benefit
  1481
  1482     evaluate true
  1483        when (rt-is-ob)
  1484           and (cp-company-id not = 'CID')
  1485              move cp-loan-term  to ws-rate-term
  1486        when (cp-company-id = 'DCC' OR 'VPP')
  1487           and (cp-benefit-cd (1:1) = 'P')
  1488           move cp-loan-term     to ws-rate-term
  1489        when other
  1490           move cp-original-term to ws-rate-term
  1491     end-evaluate
  1492
  1493*    IF ((RT-IS-OB)
  1494*       AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1495*                     OR
  1496*       ((CP-COMPANY-ID = 'DCC')
  1497*       AND (CP-BENEFIT-CD (1:1) = 'P'))
  1498*       MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1499*    ELSE
  1500*       MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1501*    END-IF
  1502
  1503     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1504     MOVE SPACE                     TO DC-OPTION-CODE.
  1505
  1506     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1507
  1508 1000-TYPE-IS-LIFE.
  1509     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1510
  1511     MOVE ZERO                      TO CP-R-MAX-AGE
  1512                                       CP-R-MAX-TERM
  1513                                       CP-R-MAX-MON-BEN
  1514                                       CP-R-MAX-TOT-BEN.
  1515
  1516     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1517
  1518     IF RT-CANCEL-FEE NUMERIC
  1519        MOVE RT-CANCEL-FEE          TO CP-CANCEL-FEE.
  1520
  1521     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1522
  1523     if rt-discount-ob-rate not numeric
  1524        move zeros               to rt-discount-ob-rate
  1525     end-if
  1526
  1527     IF (RT-DISCOUNT-OPTION EQUAL
  1528                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1529        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1530        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1531         NEXT SENTENCE
  1532     ELSE
  1533         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1534            (CP-STATE-STD-ABBRV EQUAL 'CA')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  30
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  1535             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1536                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1537                 GO TO 1050-REGULAR-RATES
  1538             ELSE
  1539                 GO TO 1050-REGULAR-RATES
  1540         ELSE
  1541             GO TO 1050-REGULAR-RATES.
  1542
  1543*    display ' discount option ' rt-discount-option
  1544     IF RT-DISCOUNT-RATE NOT NUMERIC
  1545        MOVE +0                  TO RT-DISCOUNT-RATE.
  1546
  1547     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1548        NEXT SENTENCE
  1549     ELSE
  1550        MOVE +0                  TO CP-PREMIUM-RATE
  1551                                    CP-COMPOSITE-RATE
  1552                                    CP-CALC-PREMIUM
  1553         MOVE '4'                TO CP-RETURN-CODE
  1554         GO TO 9999-CALC-RATE-PREM-X.
  1555
  1556     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1557        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1558     ELSE
  1559        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1560
  1561*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1562*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1563*       GO TO 1075-BYPASS-REGULAR-RATE.
  1564
  1565     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1566        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1567        COMPUTE WS-WORK-DIS-RATE EQUAL
  1568                WS-WORK-DIS-RATE / +100
  1569        GO TO 1075-BYPASS-REGULAR-RATE.
  1570
  1571     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1572        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1573        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1574        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1575        GO TO 1075-BYPASS-REGULAR-RATE.
  1576
  1577     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1578        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1579        (CP-TRUNCATED-LIFE)
  1580        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1581        GO TO 1075-BYPASS-REGULAR-RATE.
  1582
  1583     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1584        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1585        (CP-EARN-AS-NET-PAY)
  1586*       (CP-TRUNCATED-LIFE)
  1587        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1588        GO TO 1075-BYPASS-REGULAR-RATE.
  1589
  1590     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1591        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1592                   AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  31
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  1593        ((CP-EARN-AS-NET-PAY)
  1594               OR
  1595        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1596        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1597        GO TO 1075-BYPASS-REGULAR-RATE.
  1598
  1599     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1600        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1601        (CP-EARN-AS-NET-PAY) AND
  1602        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1603        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1604        GO TO 1075-BYPASS-REGULAR-RATE.
  1605
  1606     if (cp-company-id = 'CID')
  1607        and (cp-state-std-abbrv = 'WA' or 'AL')
  1608        and (rt-discount-option = '1')
  1609        and (cp-earn-as-farm-plan)
  1610        move rt-discount-ob-rate to cp-premium-rate
  1611        go to 1075-bypass-regular-rate
  1612     end-if
  1613
  1614     IF (CP-COMPANY-ID = 'CID')
  1615        AND (CP-STATE-STD-ABBRV = 'MN')
  1616        AND (RT-DISCOUNT-OPTION = '1')
  1617        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1618                     OR
  1619            (CP-LEVEL-LIFE OR CP-EARN-AS-FARM-PLAN)
  1620            AND (CP-CERT-EFF-DT > X'A4FF'))
  1621        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1622*       display ' made it to MN 1 ' cp-premium-rate
  1623        GO TO 1075-BYPASS-REGULAR-RATE
  1624     END-IF
  1625
  1626     if (cp-company-id = 'CID')
  1627        and (cp-earn-as-reg-balloon)
  1628        and (cp-ben-category = 'P' or 'I')
  1629        and (rt-discount-ob-rate not = zeros)
  1630        go to 1075-bypass-regular-rate
  1631     end-if
  1632
  1633     IF (CP-COMPANY-ID EQUAL 'CID')
  1634        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1635                      OR
  1636            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1637        AND (CP-EARN-AS-NET-PAY)
  1638        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1639        GO TO 1075-BYPASS-REGULAR-RATE
  1640     END-IF
  1641
  1642     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1643        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1644        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1645         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1646         GO TO 1075-BYPASS-REGULAR-RATE.
  1647
  1648     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1649        CONTINUE
  1650     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  32
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  1651        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1652           (CP-EARN-AS-NET-PAY ) AND
  1653           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1654            GO TO 1075-BYPASS-REGULAR-RATE
  1655        END-IF
  1656     END-IF
  1657
  1658     IF (CP-COMPANY-ID = 'CID') AND
  1659        (CP-EARN-AS-NET-PAY) AND
  1660        (CP-LEVEL-LIFE) AND
  1661        (CP-STATE-STD-ABBRV = 'CA') AND
  1662        (CP-STATE-STD-ABBRV = CP-STATE)
  1663        COMPUTE WS-WORK-DIS-RATE =
  1664             RT-DISCOUNT-RATE / +100
  1665        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1666        GO TO 1075-BYPASS-REGULAR-RATE
  1667     END-IF
  1668
  1669     IF (CP-COMPANY-ID = 'CID')
  1670        AND (CP-EARN-AS-NET-PAY)
  1671        AND (CP-STATE-STD-ABBRV = 'ME')
  1672        COMPUTE WS-WORK-DIS-RATE =
  1673             RT-DISCOUNT-RATE / +100
  1674        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1675        GO TO 1075-BYPASS-REGULAR-RATE
  1676     END-IF
  1677
  1678     IF (CP-COMPANY-ID = 'CID')
  1679        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1680           OR 'IN' OR 'AZ')
  1681        AND (CP-FARM-PLAN)
  1682        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1683        GO TO 1075-BYPASS-REGULAR-RATE
  1684     END-IF
  1685
  1686     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  1687        AND (CP-BEN-CATEGORY = 'D')
  1688        AND (CP-EARN-AS-NET-PAY)
  1689        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1690        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1691           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1692*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1693*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1694*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1695*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1696        GO TO 1075-BYPASS-REGULAR-RATE
  1697     END-IF
  1698
  1699     IF (CP-COMPANY-ID = 'CID') AND
  1700        (CP-EARN-AS-NET-PAY) AND
  1701        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1702                            OR 'VT')
  1703                   OR
  1704        ((CP-STATE-STD-ABBRV = 'IN') AND
  1705        (CP-CERT-EFF-DT > X'9A7F'))
  1706                   OR
  1707        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1708        (CP-CERT-EFF-DT > X'9ADF'))) AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  33
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  1709        (CP-STATE-STD-ABBRV = CP-STATE)
  1710        COMPUTE WS-WORK-DIS-RATE =
  1711             RT-DISCOUNT-RATE / +100
  1712        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1713        GO TO 1075-BYPASS-REGULAR-RATE
  1714     END-IF
  1715
  1716     IF (CP-COMPANY-ID = 'CID') AND
  1717        (CP-EARN-AS-NET-PAY) AND
  1718        (CP-STATE-STD-ABBRV = 'TX') AND
  1719        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1720        (WS-DISCOUNT-OPTION NOT = ' ')
  1721        COMPUTE WS-WORK-DIS-RATE =
  1722             RT-DISCOUNT-RATE / +100
  1723        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1724        GO TO 1075-BYPASS-REGULAR-RATE
  1725     END-IF
  1726
  1727     IF (CP-COMPANY-ID = 'CID') AND
  1728        (CP-EARN-AS-NET-PAY) AND
  1729        (CP-TRUNCATED-LIFE) AND
  1730        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1731        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1732        (WS-DISCOUNT-OPTION NOT = ' ')
  1733        COMPUTE WS-WORK-DIS-RATE =
  1734             RT-DISCOUNT-RATE / +100
  1735        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1736        GO TO 1075-BYPASS-REGULAR-RATE
  1737     END-IF
  1738
  1739     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1740        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1741           COMPUTE WS-WORK-DIS-RATE EQUAL
  1742                   WS-WORK-DIS-RATE / +100.
  1743
  1744     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1745        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1746           IF CP-MONTHLY-PAYMENT EQUAL +0
  1747            IF CP-LOAN-APR GREATER THAN +2
  1748              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1749              CP-ORIGINAL-BENEFIT /
  1750               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1751               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1752            ELSE
  1753             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1754               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1755
  1756     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1757        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1758          IF WS-WORK-DIS-RATE GREATER THAN +0
  1759           COMPUTE WK1 ROUNDED EQUAL
  1760           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1761                              (WS-RATE-TERM - +1)) /
  1762                        (WS-WORK-DIS-RATE / +12)
  1763           COMPUTE WK2 ROUNDED EQUAL
  1764           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1765                              (WS-RATE-TERM)) /
  1766                        (WS-WORK-DIS-RATE / +12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  34
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  1767           COMPUTE WK3 EQUAL
  1768                RT-DISCOUNT-OB-RATE *
  1769                (1 + WS-WORK-DIS-RATE / +12)
  1770                MOVE WK3 TO CP-PREMIUM-RATE
  1771                COMPUTE WK5 EQUAL WK3 / +1000
  1772           GO TO 1075-BYPASS-REGULAR-RATE.
  1773*               (RT-DISCOUNT-OB-RATE / +1000) *
  1774*               (1 + WS-WORK-DIS-RATE / +12)
  1775*          GO TO 1075-BYPASS-REGULAR-RATE.
  1776
  1777     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1778        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1779           COMPUTE WK3 EQUAL
  1780           RT-DISCOUNT-OB-RATE *
  1781           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1782           MOVE WK3 TO CP-PREMIUM-RATE
  1783           COMPUTE WK5 EQUAL WK3 / +1000
  1784           GO TO 1075-BYPASS-REGULAR-RATE.
  1785
  1786     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1787        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1788        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1789        GO TO 1075-BYPASS-REGULAR-RATE.
  1790
  1791     COMPUTE WS-SIN-PREM-RATE =
  1792             (RT-DISCOUNT-OB-RATE / +1000) *
  1793             ((WS-RATE-TERM + +1) / +2).
  1794
  1795     COMPUTE CP-PREMIUM-RATE =
  1796             WS-SIN-PREM-RATE /
  1797             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1798             WS-RATE-TERM) / +24)).
  1799
  1800     IF CP-PREMIUM-RATE NOT = +0
  1801        MULTIPLY +100 BY CP-PREMIUM-RATE
  1802        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1803        GO TO 1075-BYPASS-REGULAR-RATE.
  1804
  1805 1050-REGULAR-RATES.
  1806
  1807     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1808        COMPUTE WK5 EQUAL
  1809        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1810        (6 * (WS-RATE-TERM + 1))
  1811        MOVE WK5 TO CP-PREMIUM-RATE
  1812        GO TO 1075-BYPASS-REGULAR-RATE.
  1813
  1814     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1815        (CP-CSL-VALID-NP-BENEFIT-CD)
  1816        IF CP-JOINT-INDICATOR EQUAL 'J'
  1817           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1818           GO TO 1075-BYPASS-REGULAR-RATE
  1819        ELSE
  1820           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1821           GO TO 1075-BYPASS-REGULAR-RATE.
  1822
  1823     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1824        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  35
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  1825        (CP-EARN-AS-NET-PAY )
  1826        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1827        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1828        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1829        MOVE '1'                 TO DC-OPTION-CODE
  1830        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1831        IF DATE-CONVERSION-ERROR
  1832            MOVE '2'                TO CP-RETURN-CODE
  1833            GO TO 9999-CALC-RATE-PREM-X
  1834        ELSE
  1835            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1836                                         DC-ODD-DAYS-OVER
  1837            GO TO 1075-BYPASS-REGULAR-RATE.
  1838
  1839     IF RT-COMPOSITE-RATE NOT NUMERIC
  1840         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1841
  1842*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1843     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1844         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1845                                              WS-PREMIUM-RATE
  1846         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1847     ELSE
  1848         MOVE +0                           TO CP-PREMIUM-RATE
  1849                                              CP-COMPOSITE-RATE
  1850                                              CP-CALC-PREMIUM
  1851         GO TO 9999-CALC-RATE-PREM-X.
  1852
  1853     IF (CP-COMPANY-ID EQUAL 'CID')
  1854        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1855        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1856        AND (CP-EARN-AS-NET-PAY)
  1857        GO TO 1075-BYPASS-REGULAR-RATE
  1858     END-IF
  1859
  1860******************************************************
  1861*    IF CP-COMPANY-ID NOT = 'LBL'
  1862     IF (CP-COMPANY-ID NOT = 'LBL' AND 'CID')
  1863                   or
  1864        ((cp-company-id = 'CID')
  1865        and (cp-earn-as-reg-balloon)
  1866        and (cp-ben-category = 'P' or 'I'))
  1867         GO TO 1075-BYPASS-REGULAR-RATE.
  1868
  1869     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1870     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1871     MOVE '1'                    TO DC-OPTION-CODE.
  1872     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1873     IF DATE-CONVERSION-ERROR
  1874         MOVE '2'                TO CP-RETURN-CODE
  1875         GO TO 9999-CALC-RATE-PREM-X
  1876       ELSE
  1877         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1878         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1879
  1880     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1881        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1882        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  36
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  1883
  1884     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1885        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1886           NEXT SENTENCE
  1887         ELSE
  1888           GO TO 1075-BYPASS-REGULAR-RATE
  1889       ELSE
  1890        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1891           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1892           NEXT SENTENCE
  1893         ELSE
  1894           GO TO 1075-BYPASS-REGULAR-RATE.
  1895
  1896     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1897        COMPUTE CP-PREMIUM-RATE =
  1898        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1899         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1900         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1901
  1902     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1903        COMPUTE CP-PREMIUM-RATE =
  1904        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1905        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1906        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1907        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1908         * (CP-ORIGINAL-TERM - 1)).
  1909******************************************************
  1910
  1911 1075-BYPASS-REGULAR-RATE.
  1912
  1913     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1914
  1915     MOVE +1 TO LINDX.
  1916
  1917     IF CP-COMPANY-ID EQUAL 'CRI'
  1918        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  1919           MOVE +5               TO LINDX
  1920           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  1921              MOVE 'F'           TO CP-RETURN-CODE
  1922              GO TO 1200-CALCULATE-PREMIUMS.
  1923
  1924     IF RT-L-EX-AGE (LINDX) = ZERO
  1925          GO TO 1200-CALCULATE-PREMIUMS.
  1926
  1927 1100-SEARCH-LIFE-LIMITS.
  1928
  1929     IF CP-COMPANY-ID EQUAL 'CRI'
  1930        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  1931           IF LINDX GREATER THAN +4
  1932              MOVE 'A'           TO CP-RETURN-CODE
  1933              GO TO 1200-CALCULATE-PREMIUMS.
  1934
  1935     IF LINDX GREATER +8
  1936         MOVE 'A'                TO CP-RETURN-CODE
  1937         GO TO 1200-CALCULATE-PREMIUMS.
  1938
  1939     if rt-l-min-term(lindx) not numeric
  1940        move +0                  to rt-l-min-term(lindx)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  37
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  1941     end-if
  1942
  1943     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  1944         IF RT-L-EX-AGE (LINDX) = ZEROS
  1945             ADD +1              TO LINDX
  1946             GO TO 1100-SEARCH-LIFE-LIMITS
  1947         ELSE
  1948             MOVE RT-L-EX-AGE (LINDX)
  1949                                 TO CP-R-MAX-AGE
  1950             MOVE RT-L-EX-TERM (LINDX)
  1951                                 TO CP-R-MAX-TERM
  1952             MOVE RT-L-EX-FACE (LINDX)
  1953                                 TO CP-R-MAX-TOT-BEN
  1954             ADD +1              TO LINDX
  1955             GO TO 1100-SEARCH-LIFE-LIMITS
  1956     ELSE
  1957         MOVE RT-L-EX-AGE (LINDX)
  1958                                 TO CP-R-MAX-AGE
  1959         MOVE RT-L-EX-TERM (LINDX)
  1960                                 TO CP-R-MAX-TERM
  1961         MOVE RT-L-EX-FACE (LINDX)
  1962                                 TO CP-R-MAX-TOT-BEN.
  1963
  1964     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  1965         MOVE '9'                TO CP-RETURN-CODE.
  1966
  1967     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  1968         MOVE '8'                TO CP-RETURN-CODE.
  1969
  1970     if rt-l-min-term(lindx) <> zeros
  1971        and CP-loan-term     < RT-L-min-TERM (LINDX)
  1972        MOVE 'I'                 TO CP-RETURN-CODE
  1973     end-if
  1974
  1975     .
  1976 1200-CALCULATE-PREMIUMS.
  1977
  1978     IF CP-COMPANY-ID = 'CSL'
  1979        IF CP-CSL-VALID-NP-BENEFIT-CD
  1980           GO TO 1240-NET-PAY-CONT
  1981        ELSE
  1982           GO TO 1250-CSL-CALC.
  1983
  1984     IF CP-COMPANY-ID = 'WDS'
  1985        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  1986           IF CP-EARN-AS-REG-BALLOON
  1987              GO TO 1240-NET-PAY-CONT.
  1988
  1989     IF (CP-COMPANY-ID = 'CID')
  1990        AND (CP-STATE-STD-ABBRV = 'MN')
  1991        AND (CP-EARN-AS-REG-BALLOON OR CP-EARN-AS-FARM-PLAN)
  1992        AND (CP-CERT-EFF-DT > X'A4FF')
  1993*       display ' made it to mn 2 '
  1994        GO TO 1240-NET-PAY-CONT
  1995     END-IF
  1996
  1997     IF (CP-COMPANY-ID = 'CID')
  1998        AND (CP-STATE-STD-ABBRV = 'WA' or 'AL')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  38
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  1999        AND (CP-FARM-PLAN)
  2000        GO TO 1240-NET-PAY-CONT
  2001     END-IF
  2002
  2003
  2004     if (cp-company-id = 'CID')
  2005        and (cp-earn-as-reg-balloon)
  2006        and (cp-ben-category = 'P' or 'I')
  2007        display ' found balloon p or i ' rt-discount-ob-rate
  2008        evaluate true
  2009           when (cp-net-only-state = 'Y')
  2010              and (rt-discount-ob-rate > zeros)
  2011              compute cp-premium-rate = rt-discount-ob-rate / 10
  2012           when (cp-net-only-state = 'Y')
  2013              and (rt-discount-ob-rate = zeros)
  2014              display ' not ob rate     ' cp-premium-rate
  2015              compute cp-premium-rate =
  2016                 cp-premium-rate / cp-original-term * 12
  2017              display ' new rate ' cp-premium-rate
  2018              display ' net only state ' cp-premium-rate
  2019              compute cp-premium-rate rounded =
  2020                (cp-premium-rate *
  2021                   (cp-original-term + 1) / 12) /
  2022                ((cp-original-term + 2) / 2)
  2023              display ' new OB rate ' cp-premium-rate
  2024           when (cp-net-only-state <> 'Y')
  2025              and (rt-discount-ob-rate = zeros)
  2026              display ' not net only st ' cp-premium-rate
  2027              compute cp-premium-rate =
  2028                 cp-premium-rate / cp-original-term * 12
  2029              display ' new rate ' cp-premium-rate
  2030        end-evaluate
  2031        go to 1240-net-pay-cont
  2032     end-if
  2033
  2034     IF (CP-COMPANY-ID = 'CID')
  2035        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2036           OR 'IN' OR 'AZ')
  2037        AND (CP-FARM-PLAN)
  2038***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  2039***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  2040        MOVE +1.0                TO CP-LOAN-APR
  2041        GO TO 1240-NET-PAY-CONT
  2042     END-IF
  2043
  2044     IF CP-RATE-AS-STANDARD
  2045         GO TO 1210-REGULAR-RATE.
  2046
  2047     IF CP-CRITICAL-PERIOD
  2048         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  2049
  2050     IF CP-EARN-AS-TEXAS
  2051         GO TO 1230-TEXAS-CONT.
  2052
  2053     IF CP-EARN-AS-NET-PAY
  2054        IF CP-STATE-STD-ABBRV = 'MD'
  2055          IF CP-COMPANY-ID = 'MON'
  2056            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  39
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2057                               '14' OR '26' OR '47'
  2058              GO TO 1210-REGULAR-RATE.
  2059
  2060     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2061        IF CP-MONTHLY-PAYMENT EQUAL +0
  2062           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2063                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2064
  2065     IF CP-COMPANY-ID EQUAL 'GTL'
  2066        NEXT SENTENCE
  2067     ELSE
  2068     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2069        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2070           COMPUTE WK3 ROUNDED EQUAL
  2071           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2072           CP-MONTHLY-PAYMENT
  2073           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2074           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2075           CP-ALTERNATE-BENEFIT)
  2076           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2077           WK3 * WK5
  2078           GO TO 9999-CALC-RATE-PREM-X
  2079        ELSE
  2080           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2081           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2082           (WS-WORK-DIS-RATE / +12)
  2083           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2084           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2085                               WK5
  2086           GO TO 9999-CALC-RATE-PREM-X.
  2087
  2088     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2089        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2090        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2091        CP-ORIGINAL-TERM LESS THAN +61
  2092        COMPUTE CP-CALC-PREMIUM EQUAL
  2093                        (CP-ORIGINAL-BENEFIT *
  2094           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2095           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2096        COMPUTE CP-CALC-PREMIUM EQUAL
  2097                CP-CALC-PREMIUM +
  2098              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2099        (CP-ORIGINAL-TERM + 1)) /
  2100        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2101        GO TO 9999-CALC-RATE-PREM-X.
  2102
  2103     IF CP-COMPANY-ID = 'GTL'     AND
  2104        CP-STATE-STD-ABBRV = 'PA' AND
  2105        CP-SPECIAL-CALC-CD = 'H'
  2106         GO TO 1260-GTL-PA-LEASE.
  2107
  2108     IF (CP-EARN-AS-NET-PAY)
  2109*       AND (CP-LOAN-APR > ZEROS)
  2110        GO TO 1240-NET-PAY-CONT
  2111     END-IF
  2112
  2113     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2114         GO TO 1210-REGULAR-RATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  40
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2115
  2116**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2117**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2118****
  2119     IF CP-DEVIATION-CODE = 'LEV' AND
  2120        CP-LOAN-APR = ZEROS
  2121         GO TO 1210-REGULAR-RATE.
  2122
  2123     IF (CP-STATE-STD-ABBRV = 'OH')
  2124        AND (CP-CLASS-CODE NOT = 'L ')
  2125        AND (CP-ORIGINAL-TERM > 60)
  2126        AND (DC-GREG-DATE-CYMD > 19831031)
  2127        AND (CP-LOAN-APR > ZEROS)
  2128        GO TO 1240-NET-PAY-CONT
  2129     END-IF
  2130
  2131     IF (CP-STATE-STD-ABBRV = 'UT')
  2132        AND (CP-ORIGINAL-TERM > 62)
  2133        AND (DC-GREG-DATE-CYMD > 19810831)
  2134        AND (DC-GREG-DATE-CYMD < 19830901)
  2135        AND (CP-LOAN-APR > ZEROS)
  2136        GO TO 1240-NET-PAY-CONT
  2137     END-IF
  2138
  2139     IF (CP-STATE-STD-ABBRV = 'RI')
  2140        AND (CP-ORIGINAL-TERM > 60)
  2141        AND (DC-GREG-DATE-CYMD > 19831231)
  2142        AND (CP-LOAN-APR > ZEROS)
  2143        GO TO 1240-NET-PAY-CONT
  2144     END-IF
  2145
  2146     .
  2147 1210-REGULAR-RATE.
  2148
  2149     IF (CP-COMPANY-ID = 'CID')
  2150        AND (CP-EARN-AS-NET-PAY)
  2151        AND (CP-LOAN-APR = 0)
  2152        IF RT-L-RATE (WS-RATE-TERM) = 0
  2153           COMPUTE WS-SIN-PREM-RATE =
  2154              (RT-DISCOUNT-OB-RATE / +1000) *
  2155              ((WS-RATE-TERM + +1) / +2)
  2156           COMPUTE CP-PREMIUM-RATE =
  2157              WS-SIN-PREM-RATE /
  2158              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2159              WS-RATE-TERM) / +24))
  2160        ELSE
  2161           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2162        END-IF
  2163     END-IF
  2164
  2165*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2166*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2167*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2168*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2169*
  2170*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2171*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2172*          COMPUTE WK3 ROUNDED EQUAL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  41
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2173*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2174*          CP-MONTHLY-PAYMENT
  2175*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2176*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2177*          CP-ALTERNATE-BENEFIT)
  2178*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2179*          WK3 * WK5
  2180*          GO TO 9999-CALC-RATE-PREM-X
  2181*       ELSE
  2182*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2183*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2184*          (WS-WORK-DIS-RATE / +12)
  2185*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2186*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2187*                              WK5
  2188*          GO TO 9999-CALC-RATE-PREM-X.
  2189
  2190     IF CP-TERM-IS-DAYS
  2191         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2192             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2193         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2194             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2195                          * CP-TERM-OR-EXT-DAYS
  2196           GO TO 9999-CALC-RATE-PREM-X.
  2197
  2198     if (cp-company-id = 'AHL')
  2199        and (cp-loan-term > cp-original-term)
  2200        continue
  2201     else
  2202        IF NOT CP-TRUNCATED-LIFE
  2203           GO TO 1212-GROSS-NOT-TRUNCATED
  2204        end-if
  2205     end-if
  2206
  2207****  GROSS TRUNCATED CALCULATION
  2208
  2209     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2210         MOVE 'H'                TO  CP-RETURN-CODE
  2211         GO TO 9999-CALC-RATE-PREM-X.
  2212
  2213     if cp-company-id = 'AHL'
  2214        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2215           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2216           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2217           cp-original-term) * (cp-loan-term - cp-original-term
  2218            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2219            cp-premium-rate / 100 * cp-original-term /
  2220            cp-loan-term * cp-original-benefit
  2221        else
  2222           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2223           cp-original-term) * (cp-loan-term - cp-original-term
  2224            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2225            cp-premium-rate * cp-original-benefit / 100
  2226        end-if
  2227        go to 9999-calc-rate-prem-x
  2228     end-if
  2229
  2230
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  42
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2231     IF CP-COMPANY-ID = 'NCL'
  2232         COMPUTE WK-MONTHLY-RATE =
  2233               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2234                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2235                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2236                                 /
  2237                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2238                                 *
  2239                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2240         COMPUTE CP-CALC-PREMIUM =
  2241                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2242     ELSE
  2243         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2244                                 CP-ORIGINAL-TERM
  2245         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2246                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2247                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2248                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2249     END-IF
  2250
  2251     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2252        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2253           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2254           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2255     END-IF
  2256
  2257     GO TO 9999-CALC-RATE-PREM-X
  2258
  2259     .
  2260 1212-GROSS-NOT-TRUNCATED.
  2261*    DISPLAY ' ELCRATPD '
  2262*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2263*    display ' premium rate ' cp-premium-rate
  2264
  2265     IF (CP-COMPANY-ID = 'CID')
  2266        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2267           OR 'IN')
  2268        AND (CP-BENEFIT-CD = '55' OR '56')
  2269        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2270          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2271          (CP-ORIGINAL-TERM) *
  2272          ((CP-ORIGINAL-TERM) / 12) *
  2273          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2274          GO TO 9999-CALC-RATE-PREM-X
  2275     END-IF
  2276
  2277     IF (CP-COMPANY-ID = 'CID')
  2278        AND (CP-STATE-STD-ABBRV = 'GA')
  2279        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2280        COMPUTE WK3 ROUNDED =
  2281          CP-ORIGINAL-BENEFIT *
  2282          ((CP-ORIGINAL-TERM + 1) / 2) *
  2283          (RT-DISCOUNT-OB-RATE / 1000)
  2284          MOVE WK3 TO CP-CALC-PREMIUM
  2285          GO TO 9999-CALC-RATE-PREM-X
  2286     END-IF
  2287
  2288     IF (CP-COMPANY-ID EQUAL 'CID')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  43
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2289        AND (CP-STATE-STD-ABBRV = 'MN')
  2290        AND (CP-LEVEL-LIFE)
  2291        AND (CP-CERT-EFF-DT > X'A4FF')
  2292*       display ' made it to mn level '
  2293        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2294        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2295        MOVE '1'                 TO DC-OPTION-CODE
  2296        PERFORM 9100-CONVERT-DATE
  2297                                 THRU 9100-EXIT
  2298        IF DATE-CONVERSION-ERROR
  2299           MOVE '2'              TO CP-RETURN-CODE
  2300           MOVE ZEROS            TO FACTOR
  2301                                 CP-CALC-PREMIUM
  2302           GO TO 9999-CALC-RATE-PREM-X
  2303        END-IF
  2304        MOVE DC-ELAPSED-DAYS     TO D
  2305        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2306           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2307           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2308        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2309           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2310        GO TO 9999-CALC-RATE-PREM-X
  2311     END-IF
  2312
  2313     IF (CP-COMPANY-ID = 'CID')
  2314        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2315        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2316           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2317     ELSE
  2318        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2319                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2320     END-IF
  2321*    display ' calc premium ' cp-calc-premium
  2322
  2323*    IF CP-COMPANY-ID = 'LBL'
  2324     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2325        AND (NOT CP-EARN-AS-NET-PAY)
  2326        GO TO 9999-CALC-RATE-PREM-X
  2327     END-IF
  2328
  2329*    display ' fell through to ext days '
  2330     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2331         GO TO 9999-CALC-RATE-PREM-X.
  2332
  2333     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2334         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2335            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2336               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2337
  2338     GO TO 9999-CALC-RATE-PREM-X.
  2339
  2340 1220-CRITICAL-PERIOD-LF-CONT.
  2341     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2342               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2343
  2344     GO TO 9999-CALC-RATE-PREM-X.
  2345
  2346 1230-TEXAS-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  44
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2347     IF CP-FARM-PLAN
  2348         GO TO 1235-TEXAS-FARM-CONT.
  2349
  2350     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2351               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2352
  2353     COMPUTE TEX-FACT-9 =
  2354                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2355                 (CP-ORIGINAL-TERM + 1).
  2356
  2357     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2358                 CP-CALC-PREMIUM * TEX-FACT-9.
  2359
  2360     GO TO 9999-CALC-RATE-PREM-X.
  2361
  2362 1235-TEXAS-FARM-CONT.
  2363     COMPUTE WS-FARM-TERM =
  2364               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2365
  2366     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2367     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2368
  2369
  2370     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2371              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2372
  2373     GO TO 9999-CALC-RATE-PREM-X.
  2374
  2375 1240-NET-PAY-CONT.
  2376
  2377     MOVE CP-LOAN-APR             TO N-P-APR.
  2378     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2379                                     N-P-REM
  2380                                     N-P-LOAN.
  2381
  2382     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2383
  2384     IF CP-TRUNCATED-LIFE
  2385         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2386
  2387     IF CP-COMPANY-ID EQUAL 'NCL'
  2388        NEXT SENTENCE
  2389     ELSE
  2390        GO TO 1241-NET-PAY-CONT.
  2391
  2392     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2393     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2394     MOVE '1'                    TO DC-OPTION-CODE
  2395     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2396     IF DATE-CONVERSION-ERROR
  2397         MOVE '2'                TO CP-RETURN-CODE
  2398         GO TO 9999-CALC-RATE-PREM-X
  2399     ELSE
  2400        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2401        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2402
  2403     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2404        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  45
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2405        NEXT SENTENCE
  2406     ELSE
  2407        MOVE +1                  TO ODF
  2408        GO TO 1241-NET-PAY-CONT.
  2409
  2410     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2411        COMPUTE CP-PREMIUM-RATE EQUAL
  2412        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2413        CP-PREMIUM-RATE) *
  2414        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2415
  2416     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2417        COMPUTE CP-PREMIUM-RATE EQUAL
  2418        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2419        N-P-LOAN * (N-P-LOAN - 1))) *
  2420        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2421        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2422
  2423     COMPUTE ODF EQUAL
  2424     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2425     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2426
  2427 1241-NET-PAY-CONT.
  2428
  2429     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2430
  2431*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2432     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2433        NEXT SENTENCE
  2434     ELSE
  2435        GO TO 9999-CALC-RATE-PREM-X.
  2436
  2437     IF RT-DISCOUNT-OPTION EQUAL '6'
  2438         GO TO 9999-CALC-RATE-PREM-X.
  2439
  2440     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2441        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2442        GO TO 9999-CALC-RATE-PREM-X.
  2443
  2444     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2445
  2446     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2447        GO TO 9999-CALC-RATE-PREM-X.
  2448
  2449     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2450        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2451        (CP-TRUNCATED-LIFE)
  2452        GO TO 9999-CALC-RATE-PREM-X.
  2453
  2454     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2455        (CP-CSL-VALID-NP-BENEFIT-CD)
  2456        GO TO 9999-CALC-RATE-PREM-X.
  2457
  2458     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2459        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2460        (CP-EARN-AS-NET-PAY)
  2461        GO TO 9999-CALC-RATE-PREM-X.
  2462
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  46
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2463*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2464*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2465*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2466*       GO TO 9999-CALC-RATE-PREM-X.
  2467
  2468     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2469        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2470        (CP-EARN-AS-NET-PAY)
  2471        GO TO 9999-CALC-RATE-PREM-X.
  2472
  2473     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2474        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2475        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2476        GO TO 9999-CALC-RATE-PREM-X.
  2477
  2478     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2479        (CP-EARN-AS-NET-PAY)
  2480        GO TO 9999-CALC-RATE-PREM-X.
  2481
  2482     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2483        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2484        (CP-TRUNCATED-LIFE)
  2485        GO TO 9999-CALC-RATE-PREM-X.
  2486
  2487     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2488        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2489        (CP-EARN-AS-NET-PAY)
  2490*       (CP-TRUNCATED-LIFE)
  2491        GO TO 9999-CALC-RATE-PREM-X.
  2492
  2493     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2494        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2495                   AND
  2496        ((CP-EARN-AS-NET-PAY)
  2497               OR
  2498        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2499        GO TO 9999-CALC-RATE-PREM-X.
  2500
  2501     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2502        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2503        (CP-EARN-AS-NET-PAY) AND
  2504        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2505        GO TO 9999-CALC-RATE-PREM-X.
  2506
  2507     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2508        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2509        (CP-EARN-AS-NET-PAY)
  2510        GO TO 9999-CALC-RATE-PREM-X.
  2511
  2512     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2513        CONTINUE
  2514     ELSE
  2515        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2516           (CP-EARN-AS-NET-PAY) AND
  2517           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2518           GO TO 9999-CALC-RATE-PREM-X
  2519        END-IF
  2520     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  47
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2521
  2522     IF (CP-COMPANY-ID = 'CID')
  2523        AND (CP-EARN-AS-NET-PAY)
  2524        AND (CP-STATE-STD-ABBRV = 'ME')
  2525        GO TO 9999-CALC-RATE-PREM-X
  2526     END-IF
  2527
  2528     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2529        AND (CP-BEN-CATEGORY = 'D')
  2530        AND (CP-EARN-AS-NET-PAY)
  2531        GO TO 9999-CALC-RATE-PREM-X
  2532     END-IF
  2533
  2534     IF (CP-COMPANY-ID = 'CID')
  2535        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2536           OR 'IN' OR 'AZ')
  2537        AND (CP-FARM-PLAN)
  2538        GO TO 9999-CALC-RATE-PREM-X
  2539     END-IF
  2540
  2541     IF (CP-COMPANY-ID = 'CID') AND
  2542        (CP-EARN-AS-NET-PAY) AND
  2543        (CP-LEVEL-LIFE) AND
  2544        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2545        (CP-STATE-STD-ABBRV = CP-STATE)
  2546        GO TO 9999-CALC-RATE-PREM-X
  2547     END-IF
  2548
  2549     IF (CP-COMPANY-ID = 'CID') AND
  2550        (CP-EARN-AS-NET-PAY) AND
  2551        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2552                            OR 'VT')
  2553                   OR
  2554        ((CP-STATE-STD-ABBRV = 'IN') AND
  2555        (CP-CERT-EFF-DT > X'9A7F'))
  2556                   OR
  2557        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2558        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2559        (CP-STATE-STD-ABBRV = CP-STATE)
  2560        GO TO 9999-CALC-RATE-PREM-X
  2561     END-IF
  2562
  2563     IF (CP-COMPANY-ID = 'CID') AND
  2564        (CP-EARN-AS-NET-PAY) AND
  2565        (CP-STATE-STD-ABBRV = 'TX') AND
  2566        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2567        (WS-DISCOUNT-OPTION NOT = ' ')
  2568        GO TO 9999-CALC-RATE-PREM-X
  2569     END-IF
  2570
  2571     if (cp-company-id = 'CID')
  2572        and (cp-state-std-abbrv = 'WA' or 'AL')
  2573        and (rt-discount-option = '1')
  2574        and (cp-earn-as-farm-plan)
  2575        go to 9999-calc-rate-prem-x
  2576     end-if
  2577
  2578     if (cp-company-id = 'CID')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  48
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2579        and (cp-earn-as-reg-balloon)
  2580        and (cp-ben-category = 'P' or 'I')
  2581        GO TO 9999-CALC-RATE-PREM-X
  2582     end-if
  2583
  2584     IF (CP-COMPANY-ID = 'CID')
  2585        AND (CP-STATE-STD-ABBRV = 'MN')
  2586        AND (RT-DISCOUNT-OPTION = '1')
  2587        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON OR
  2588           CP-EARN-AS-FARM-PLAN)
  2589*       display ' made it to mn 4 '
  2590        GO TO 9999-CALC-RATE-PREM-X
  2591     END-IF
  2592
  2593     IF (CP-COMPANY-ID = 'CID')
  2594        AND (CP-EARN-AS-NET-PAY)
  2595        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2596                      OR
  2597            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2598        GO TO 9999-CALC-RATE-PREM-X
  2599     END-IF
  2600
  2601     IF (CP-COMPANY-ID = 'CID')
  2602        AND (CP-EARN-AS-NET-PAY)
  2603        AND (CP-STATE-STD-ABBRV = 'SC')
  2604        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2605        GO TO 9999-CALC-RATE-PREM-X
  2606     END-IF
  2607
  2608     IF (CP-COMPANY-ID = 'CID') AND
  2609        (CP-EARN-AS-NET-PAY) AND
  2610        (CP-TRUNCATED-LIFE) AND
  2611        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2612        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2613        (WS-DISCOUNT-OPTION NOT = ' ')
  2614        GO TO 9999-CALC-RATE-PREM-X
  2615     END-IF
  2616
  2617     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP') AND
  2618        (CP-EARN-AS-NET-PAY)
  2619        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2620        GO TO 9999-CALC-RATE-PREM-X
  2621     END-IF
  2622
  2623     IF (CP-COMPANY-ID EQUAL 'CID')
  2624        AND (CP-EARN-AS-NET-PAY)
  2625        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2626        GO TO 9999-CALC-RATE-PREM-X
  2627     END-IF
  2628
  2629     IF (RT-IS-OB) AND
  2630        (CP-COMPANY-ID NOT EQUAL 'CID')
  2631        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2632               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2633      ELSE
  2634         IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2635            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2636            COMPUTE CP-CALC-PREMIUM ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  49
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2637*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2638             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2639               CP-ORIGINAL-TERM
  2640             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2641             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2642        ELSE
  2643           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2644               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2645        END-IF
  2646     END-IF
  2647
  2648     IF CP-ROA-PREM-AT-REFUND
  2649         COMPUTE NET-BEN ROUNDED =
  2650             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2651     ELSE
  2652         COMPUTE NET-BEN ROUNDED =
  2653              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2654
  2655     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2656        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2657          COMPUTE NET-BEN ROUNDED =
  2658              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2659                         (CP-TERM-OR-EXT-DAYS / 30)).
  2660
  2661     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2662*       OR 'DCC'
  2663*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2664     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2665       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2666       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2667                        * CP-ORIGINAL-TERM / 1200))
  2668     ELSE
  2669     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2670       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2671       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2672
  2673****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2674****** INTEREST IS CHARGED ON PREMIUM.
  2675
  2676*    IF CP-STATE-STD-ABBRV = 'MI'
  2677*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2678*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2679
  2680     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2681
  2682     GO TO 9999-CALC-RATE-PREM-X.
  2683
  2684******
  2685****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2686******
  2687
  2688 1250-CSL-CALC.
  2689     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2690     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2691     MOVE '1' TO DC-OPTION-CODE.
  2692     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2693
  2694     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  50
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2695         MOVE '2' TO CP-RETURN-CODE
  2696         GO TO 9999-CALC-RATE-PREM-X.
  2697
  2698     IF CP-JOINT-INDICATOR = 'J'
  2699         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2700     ELSE
  2701         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2702
  2703     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2704     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2705
  2706     IF CP-PAY-FREQUENCY = 12
  2707         MOVE 01               TO WS-PAY-SCH.
  2708     IF CP-PAY-FREQUENCY = 04
  2709         MOVE 03               TO WS-PAY-SCH.
  2710     IF CP-PAY-FREQUENCY = 02
  2711         MOVE 06               TO WS-PAY-SCH.
  2712     IF CP-PAY-FREQUENCY = 01
  2713         MOVE 12               TO WS-PAY-SCH.
  2714
  2715     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2716     IF CP-PAY-FREQUENCY NOT = 12
  2717         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2718                                WS-NUM-PAYMTS.
  2719
  2720     IF CP-STATE = 'SC'  AND
  2721       (CP-BENEFIT-CD = '07'  OR  '08')
  2722         GO TO 1250-CSL-CALC-LIFE-6.
  2723
  2724     IF CP-CSL-METH-1
  2725         GO TO 1250-CSL-CALC-LIFE-1.
  2726
  2727     IF CP-CSL-METH-2
  2728         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2729                          WS-MAX-TOT-BEN
  2730             GO TO 1250-CSL-CALC-LIFE-2
  2731         ELSE
  2732             GO TO 1250-CSL-CALC-LIFE-1.
  2733
  2734     IF CP-CSL-METH-3
  2735         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2736             GO TO 1250-CSL-CALC-LIFE-2
  2737         ELSE
  2738             GO TO 1250-CSL-CALC-LIFE-3.
  2739
  2740     IF CP-CSL-METH-4
  2741         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2742                          WS-MAX-TOT-BEN
  2743             GO TO 1250-CSL-CALC-LIFE-5
  2744         ELSE
  2745             GO TO 1250-CSL-CALC-LIFE-4.
  2746
  2747 1250-CSL-CALC-LIFE-1.
  2748     IF CP-JOINT-INDICATOR = 'J'
  2749         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2750     ELSE
  2751         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2752
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  51
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2753     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2754                    365) - 1) * 365 / 12.
  2755     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2756                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2757                    4380.
  2758     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2759                    WS-NUM-PAYMTS * WK-S.
  2760
  2761     GO TO 9999-CALC-RATE-PREM-X.
  2762
  2763 1250-CSL-CALC-LIFE-2.
  2764     IF CP-JOINT-INDICATOR = 'J'
  2765         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2766     ELSE
  2767         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2768
  2769     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2770     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2771     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2772                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2773                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2774     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2775                    WK-S) + WK-D.
  2776
  2777     GO TO 9999-CALC-RATE-PREM-X.
  2778
  2779 1250-CSL-CALC-LIFE-3.
  2780     IF CP-JOINT-INDICATOR = 'J'
  2781         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2782     ELSE
  2783         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2784
  2785     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2786     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2787     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2788                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2789                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2790     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2791                    WK-S) + WK-D.
  2792
  2793     GO TO 9999-CALC-RATE-PREM-X.
  2794
  2795 1250-CSL-CALC-LIFE-4.
  2796     IF CP-JOINT-INDICATOR = 'J'
  2797         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2798     ELSE
  2799         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2800
  2801     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2802     COMPUTE WK-S ROUNDED =
  2803                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2804                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2805                    CP-PAY-FREQUENCY.
  2806     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2807                    WS-NUM-PAYMTS * WK-S.
  2808
  2809     GO TO 9999-CALC-RATE-PREM-X.
  2810
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  52
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2811 1250-CSL-CALC-LIFE-5.
  2812     IF CP-JOINT-INDICATOR = 'J'
  2813         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2814     ELSE
  2815         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2816
  2817     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2818     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2819                    CP-PAY-FREQUENCY.
  2820     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2821                    - 1) + WS-NUM-PAYMTS) * 12) /
  2822                    CP-PAY-FREQUENCY.
  2823     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2824     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2825                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2826
  2827     GO TO 9999-CALC-RATE-PREM-X.
  2828
  2829 1250-CSL-CALC-LIFE-6.
  2830
  2831     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2832                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2833
  2834     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2835                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2836
  2837     GO TO 9999-CALC-RATE-PREM-X.
  2838
  2839******
  2840****** END OF PREMIUM CALCULATIONS FOR CSL
  2841******
  2842
  2843 1260-GTL-PA-LEASE.
  2844
  2845     IF CP-REDUCING-LIFE
  2846         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2847                                 TO  CP-PREMIUM-RATE
  2848         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2849                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2850     ELSE
  2851         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2852                                 TO  CP-PREMIUM-RATE
  2853         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2854                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2855                 (+1 + CP-SALES-TAX) / +100.
  2856
  2857     GO TO 9999-CALC-RATE-PREM-X.
  2858
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  53
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2860******************************************************************
  2861 2000-TYPE-IS-AH.
  2862     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2863
  2864     MOVE ZERO                      TO CP-R-MAX-AGE
  2865                                       CP-R-MAX-TERM
  2866                                       CP-R-MAX-MON-BEN
  2867                                       CP-R-MAX-TOT-BEN.
  2868
  2869     IF RT-CANCEL-FEE NUMERIC
  2870        MOVE RT-CANCEL-FEE          TO CP-CANCEL-FEE.
  2871
  2872     IF RT-COMPOSITE-RATE NOT NUMERIC
  2873        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2874
  2875
  2876     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2877        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2878                                 TO CP-PREMIUM-RATE
  2879                                    WS-PREMIUM-RATE
  2880        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2881     ELSE
  2882         MOVE +0                 TO CP-PREMIUM-RATE
  2883                                    CP-CALC-PREMIUM
  2884         GO TO 9999-CALC-RATE-PREM-X
  2885     END-IF
  2886
  2887     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2888        AND (CP-DDF-SPEC-CALC = 'T')
  2889        AND (CP-LOAN-TERM > ZERO AND < 361)
  2890        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2891                                 TO CP-PREMIUM-RATE
  2892                                    WS-PREMIUM-RATE
  2893     END-IF
  2894
  2895*    IF (CP-COMPANY-ID = 'DCC')
  2896*       AND ((CP-BENEFIT-CD (1:1) = 'P')
  2897*       OR (CP-DDF-SPEC-CALC = 'T'))
  2898*       AND (CP-LOAN-TERM > ZERO AND < 361)
  2899*       MOVE RT-AH-RATE (CP-LOAN-TERM)
  2900*                                TO CP-PREMIUM-RATE
  2901*                                   WS-PREMIUM-RATE
  2902*    END-IF
  2903
  2904     MOVE +1 TO AHNDX.
  2905
  2906     IF CP-COMPANY-ID EQUAL 'CRI'
  2907        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2908           MOVE +5               TO AHNDX
  2909           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2910              MOVE 'F'           TO CP-RETURN-CODE
  2911              GO TO 2200-CALCULATE-PREMIUMS.
  2912
  2913     IF RT-AH-AGE (AHNDX) = ZERO
  2914          GO TO 2200-CALCULATE-PREMIUMS.
  2915
  2916 2100-SEARCH-AH-LIMITS.
  2917
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  54
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2918     IF CP-COMPANY-ID EQUAL 'CRI'
  2919        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2920           IF AHNDX GREATER THAN +4
  2921              MOVE 'A'             TO CP-RETURN-CODE
  2922              GO TO 2200-CALCULATE-PREMIUMS.
  2923
  2924     IF AHNDX GREATER +8
  2925         MOVE 'A'                TO CP-RETURN-CODE
  2926         GO TO 2200-CALCULATE-PREMIUMS.
  2927
  2928     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2929         IF RT-AH-AGE (AHNDX) = ZEROS
  2930             ADD +1               TO AHNDX
  2931             GO TO 2100-SEARCH-AH-LIMITS
  2932         ELSE
  2933             MOVE RT-AH-AGE (AHNDX)
  2934                                 TO CP-R-MAX-AGE
  2935             MOVE RT-AH-TERM (AHNDX)
  2936                                 TO CP-R-MAX-TERM
  2937             MOVE RT-AH-BEN-M (AHNDX)
  2938                                 TO CP-R-MAX-MON-BEN
  2939             ADD +1               TO AHNDX
  2940             GO TO 2100-SEARCH-AH-LIMITS
  2941     ELSE
  2942         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2943         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2944         MOVE RT-AH-BEN-M (AHNDX)
  2945                                 TO CP-R-MAX-MON-BEN.
  2946
  2947     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2948         MOVE '9'                 TO CP-RETURN-CODE.
  2949
  2950     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2951         MOVE '8'                 TO CP-RETURN-CODE.
  2952
  2953     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  2954         GIVING WS-AH-FACE-BENEFIT.
  2955
  2956     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  2957         MOVE 'C'                 TO CP-RETURN-CODE.
  2958
  2959 2200-CALCULATE-PREMIUMS.
  2960
  2961     IF CP-COMPANY-ID = 'CSL'
  2962         GO TO 2250-CSL-CALC.
  2963
  2964*    IF CP-CRITICAL-PERIOD
  2965*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  2966
  2967     IF CP-CRITICAL-PERIOD
  2968        IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2969           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  2970               OR 'S' OR 'P')
  2971                          OR
  2972                (CP-BEN-CATEGORY = 'G' OR 'L'))
  2973           CONTINUE
  2974        ELSE
  2975           GO TO 2200-CRITICAL-PERIOD-AH-CONT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  55
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  2976        END-IF
  2977     END-IF
  2978
  2979     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2980        AND (CP-BEN-CATEGORY = 'D')
  2981        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  2982           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  2983     END-IF
  2984
  2985     IF (CP-COMPANY-ID = 'CID')
  2986        AND (CP-STATE-STD-ABBRV = 'AL')
  2987        and (cp-pmt-mode <> spaces and low-values)
  2988        continue
  2989     else
  2990        go to 2200-continue
  2991     end-if
  2992
  2993     evaluate true
  2994        when cp-pmt-mode = 'B' *> Bi-Weekly
  2995           move 26               to c-pmts-per-year
  2996           move 14               to c-days-in-pmt-per
  2997        when cp-pmt-mode = 'W' *> Weekly
  2998           move 52               to c-pmts-per-year
  2999           move 07               to c-days-in-pmt-per
  3000        when cp-pmt-mode = 'S' *> Semi-Monthly
  3001           move 24               to c-pmts-per-year
  3002           move 15               to c-days-in-pmt-per
  3003        when cp-pmt-mode = 'A' *> Annual
  3004           move 1                to c-pmts-per-year
  3005           move 360              to c-days-in-pmt-per
  3006        when cp-pmt-mode = 'T' *> Semi-Annual
  3007           move 2                to c-pmts-per-year
  3008           move 180              to c-days-in-pmt-per
  3009        when cp-pmt-mode = 'Q' *> Quarterly
  3010           move 4                to c-pmts-per-year
  3011           move 90               to c-days-in-pmt-per
  3012        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  3013           move 6                to c-pmts-per-year
  3014           move 60               to c-days-in-pmt-per
  3015        when other             *> Assume Monthly
  3016           move 12               to c-pmts-per-year
  3017           move 30               to c-days-in-pmt-per
  3018     end-evaluate
  3019
  3020     compute c-tot-pmts =
  3021        cp-original-term / 12 * c-pmts-per-year
  3022
  3023     compute wk7 rounded =    *> tv3
  3024        (cp-original-benefit * +12) / c-pmts-per-year
  3025
  3026     compute wk6 rounded =
  3027        (wk7 * c-tot-pmts / 100) * cp-premium-rate
  3028
  3029     move wk6                    to cp-calc-premium
  3030
  3031     GO TO 9999-CALC-RATE-PREM-X
  3032
  3033     .
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  56
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  3034 2200-continue.
  3035
  3036     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  3037        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  3038        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
  3039                                     CP-PREMIUM-RATE
  3040        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  3041        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  3042        CP-PREMIUM-RATE) / +100
  3043     ELSE
  3044        IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3045           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  3046           MOVE CP-PREMIUM-RATE  TO WK-S
  3047*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  3048           IF CP-RATE-DEV-PCT NOT = ZEROS
  3049              COMPUTE WK-S ROUNDED =
  3050                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  3051           END-IF
  3052           IF CP-BENEFIT-CD (1:1) = 'M'
  3053              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3054              CP-ORIGINAL-BENEFIT * WK-S / 100
  3055           ELSE
  3056              IF CP-BENEFIT-CD (1:1) = 'H'
  3057                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3058                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3059                    WK-S) / 1000
  3060              ELSE
  3061                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  3062                    GO TO 2300-CALC-DCC-MOB-NET-AH
  3063                 ELSE
  3064                    IF CP-BEN-CATEGORY = 'D'
  3065                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3066                        CP-ORIGINAL-BENEFIT *
  3067                        CP-ORIGINAL-TERM * WK-S / 100
  3068                    ELSE
  3069                      IF CP-BENEFIT-CD (1:1) = 'P'
  3070                         GO TO 2300-CALC-DCC-BEN-P-AH
  3071                      ELSE
  3072                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3073                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3074                        WK-S) / 100
  3075                      END-IF
  3076                    END-IF
  3077                 END-IF
  3078              END-IF
  3079           END-IF
  3080           MOVE ZEROS            TO CP-RATE-DEV-PCT
  3081        ELSE
  3082           IF CP-BENEFIT-CD (1:1) = 'M'
  3083              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3084                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  3085           ELSE
  3086              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  3087                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3088                    (CP-NET-BENEFIT-AMT *
  3089                    CP-PREMIUM-RATE) / 1000
  3090              ELSE
  3091                 IF CP-AH-BALLOON-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  57
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  3092                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  3093                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  3094                      CP-PREMIUM-RATE) / 100
  3095                 ELSE
  3096                   COMPUTE CP-CALC-PREMIUM ROUNDED =
  3097                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  3098                    CP-PREMIUM-RATE) / 100
  3099                 END-IF
  3100              END-IF
  3101           END-IF
  3102        END-IF
  3103     END-IF
  3104
  3105     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3106        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  3107        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  3108     END-IF
  3109
  3110     IF CP-TERM-OR-EXT-DAYS = ZEROS
  3111         GO TO 9999-CALC-RATE-PREM-X.
  3112
  3113     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  3114         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3115             CP-CALC-PREMIUM +
  3116                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  3117                                       * CP-TERM-OR-EXT-DAYS).
  3118
  3119     GO TO 9999-CALC-RATE-PREM-X.
  3120
  3121 2200-CRITICAL-PERIOD-AH-CONT.
  3122
  3123     IF CP-COMPANY-ID = 'WDS'
  3124         IF CP-ORIGINAL-TERM GREATER THAN 60
  3125             MOVE 60              TO CP-LOAN-TERM.
  3126
  3127     IF CP-COMPANY-ID EQUAL 'CVL'
  3128         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3129           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  3130                                       * CP-PREMIUM-RATE
  3131         GO TO 9999-CALC-RATE-PREM-X.
  3132
  3133     COMPUTE CP-CALC-PREMIUM ROUNDED =
  3134           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  3135                                       * CP-PREMIUM-RATE.
  3136
  3137     GO TO 9999-CALC-RATE-PREM-X.
  3138
  3139 2250-CSL-CALC.
  3140
  3141     IF RT-DAILY-RATE NOT NUMERIC OR
  3142        RT-DAILY-RATE = ZEROS
  3143            MOVE ZEROS TO CP-CALC-PREMIUM
  3144            MOVE '7' TO CP-RETURN-CODE
  3145            GO TO 9999-CALC-RATE-PREM-X.
  3146
  3147     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  3148     COMPUTE WK-MONTHLY-RATE =
  3149          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  58
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  3150
  3151     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3152     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3153     MOVE '1' TO DC-OPTION-CODE.
  3154     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3155     IF DATE-CONVERSION-ERROR
  3156         MOVE '2' TO CP-RETURN-CODE
  3157         GO TO 9999-CALC-RATE-PREM-X.
  3158
  3159     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3160     IF CP-CSL-METH-1
  3161         GO TO 2250-CSL-CALC-AH-1.
  3162     IF CP-CSL-METH-2
  3163         GO TO 2250-CSL-CALC-AH-2.
  3164     IF CP-CSL-METH-3
  3165         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3166             GO TO 2250-CSL-CALC-AH-4
  3167         ELSE
  3168             GO TO 2250-CSL-CALC-AH-3.
  3169
  3170 2250-CSL-CALC-AH-1.
  3171
  3172     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3173     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3174                    + WK-MONTHLY-RATE.
  3175     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3176                    CP-ORIGINAL-TERM * WK-D.
  3177
  3178     GO TO 9999-CALC-RATE-PREM-X.
  3179
  3180
  3181 2250-CSL-CALC-AH-2.
  3182     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3183     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3184                    + WK-MONTHLY-RATE.
  3185     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3186                    CP-ORIGINAL-TERM * WK-D.
  3187
  3188     GO TO 9999-CALC-RATE-PREM-X.
  3189
  3190 2250-CSL-CALC-AH-3.
  3191
  3192     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3193     COMPUTE WK-T = WK-K + 1.
  3194     COMPUTE WK-MONTHLY-RATE-T =
  3195          RT-AH-RATE (WK-T) / 100.
  3196     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3197
  3198     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3199     IF WK-T1 EQUAL ZEROS
  3200         MOVE ZEROS TO CP-CALC-PREMIUM
  3201         MOVE 'G' TO CP-RETURN-CODE
  3202         GO TO 9999-CALC-RATE-PREM-X.
  3203
  3204     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3205                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  3206                    - WK-T)).
  3207     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  59
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  3208     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3209                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3210                       WS-MAX-TOT-BEN).
  3211     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3212                    WK-MONTHLY-RATE-T) + WK-PREM.
  3213
  3214     GO TO 9999-CALC-RATE-PREM-X.
  3215
  3216 2250-CSL-CALC-AH-4.
  3217     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3218     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3219     COMPUTE WK-MONTHLY-RATE-J =
  3220          RT-AH-RATE (WK-J) / 100.
  3221     COMPUTE WK-T = WK-J + 1.
  3222     COMPUTE WK-MONTHLY-RATE-T =
  3223          RT-AH-RATE (WK-T) / 100.
  3224     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3225     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3226                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3227                    (CP-ORIGINAL-TERM - WK-T)).
  3228     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3229     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3230                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3231                       WS-MAX-TOT-BEN).
  3232     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3233                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3234
  3235     GO TO 9999-CALC-RATE-PREM-X.
  3236
  3237
  3238 2300-CALC-DCC-BEN-P-AH.
  3239
  3240     IF CP-NO-OF-PMTS NOT NUMERIC
  3241        MOVE +0                  TO CP-NO-OF-PMTS
  3242     END-IF
  3243     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3244        AND ' ' AND 'M'
  3245        MOVE ' '                 TO CP-PMT-MODE
  3246     END-IF
  3247
  3248******************************************************************
  3249***   Default is monthly, use loan term for rate and amort     ***
  3250******************************************************************
  3251     move cp-loan-term         to c-tot-pmts
  3252     MOVE +30                  TO C-DAYS-IN-PMT-PER
  3253     MOVE +12                  TO C-PMTS-PER-YEAR
  3254******************************************************************
  3255
  3256     evaluate true
  3257        when cp-pmt-mode = 'W'
  3258           MOVE +52              TO C-PMTS-PER-YEAR
  3259           compute c-tot-pmts = cp-loan-term /
  3260              12 * c-pmts-per-year
  3261           MOVE +7               TO C-DAYS-IN-PMT-PER
  3262        when cp-pmt-mode = 'B'
  3263           MOVE +26              TO C-PMTS-PER-YEAR
  3264           compute c-tot-pmts = cp-loan-term /
  3265              12 * c-pmts-per-year
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  60
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  3266           MOVE +14              TO C-DAYS-IN-PMT-PER
  3267     end-evaluate
  3268
  3269     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3270
  3271     if i = zeros
  3272        move .0000000001         to i
  3273     end-if
  3274
  3275     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3276        C-DAYS-IN-PMT-PER)) / (1 + I)
  3277
  3278     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  3279     COMPUTE ANGLEN-1 = ANGLEN / Y
  3280     COMPUTE WK3 = (CP-NET-BENEFIT-AMT - CP-ORIGINAL-PREMIUM)
  3281        / ANGLEN-1
  3282
  3283     if cp-net-benefit-amt = zeros
  3284        compute wk3 = cp-original-benefit - cp-original-premium
  3285     end-if
  3286     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3287
  3288     GO TO 9999-CALC-RATE-PREM-X
  3289
  3290     .
  3291 2300-CALC-DCC-MOB-NET-AH.
  3292
  3293     IF CP-ALTERNATE-BENEFIT = ZEROS
  3294        CONTINUE
  3295     ELSE
  3296        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3297     END-IF
  3298
  3299     MOVE CP-ORIGINAL-TERM       TO M
  3300     MOVE CP-LOAN-TERM           TO N
  3301     IF N = ZEROS
  3302        MOVE M                   TO N
  3303     END-IF
  3304     COMPUTE I = CP-LOAN-APR / +1200
  3305
  3306     if i = zeros
  3307        move .0000000001         to i
  3308     end-if
  3309     IF CP-BENEFIT-CD (1:1) = 'S'
  3310        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3311        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3312        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3313          (WK-S / 1000)
  3314          * 1
  3315        MOVE WK3                 TO CP-CALC-PREMIUM
  3316        GO TO 9999-CALC-RATE-PREM-X
  3317     END-IF
  3318
  3319     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3320        / (1 + I)
  3321     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3322          ** ((N - M) * -1))) / I)
  3323     COMPUTE ANGLEN-M = ANGLEN-M / OD
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  61
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  3324     COMPUTE J = I + (WK-S / +1000)
  3325     COMPUTE WK2 = (1 + J) ** (M * -1)
  3326     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3327
  3328
  3329     COMPUTE ANGLEM = ((1 - ((1 + J)
  3330          ** (M * -1))) / J) / OD
  3331     IF CP-NET-BENEFIT-AMT = ZEROS
  3332        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3333           * ANGLEM
  3334     END-IF
  3335     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3336
  3337     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3338          ** ((N - M) * -1))) / I)
  3339
  3340     MOVE +0                     TO WK3
  3341     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3342        (WS-COUNTER > M)
  3343        COMPUTE ANGLEM = (1 - ((1 + J)
  3344          ** ((M - WS-COUNTER + 1) * -1))) / J
  3345        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3346        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3347        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3348     END-PERFORM
  3349
  3350     MOVE WK3                    TO CP-CALC-PREMIUM
  3351
  3352     GO TO 9999-CALC-RATE-PREM-X
  3353     .
  3354
  3355 2300-CALC-DCC-MOB-BAL-AH.
  3356
  3357     IF CP-BENEFIT-CD (1:1) = 'S'
  3358        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3359     END-IF
  3360     MOVE CP-ORIGINAL-TERM       TO M
  3361     MOVE CP-LOAN-TERM           TO N
  3362     IF N = ZEROS
  3363        MOVE M                   TO N
  3364     END-IF
  3365     COMPUTE I = CP-LOAN-APR / +1200
  3366     if i = zeros
  3367        move .0000000001         to i
  3368     end-if
  3369     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3370        / (1 + I)
  3371     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3372     COMPUTE J = I + (WK-S / +1000)
  3373     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3374     MOVE I TO K
  3375     COMPUTE WK2 = (1 + J) ** (M * -1)
  3376     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3377
  3378     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3379          ** ((M - 1) * -1))) / J)
  3380
  3381     COMPUTE ANGLEM = ((1 - ((1 + J)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  62
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  3382          ** (M * -1))) / J) / OD
  3383
  3384     IF CP-NET-BENEFIT-AMT = ZEROS
  3385        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3386           * ANGLEM
  3387     END-IF
  3388     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3389        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3390        / ANGLEM-1
  3391
  3392     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3393          ** ((N - M) * -1))) / I)
  3394
  3395     MOVE +0                     TO WK3
  3396     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3397        (WS-COUNTER > M)
  3398        COMPUTE ANGLEM = (1 - ((1 + J)
  3399          ** ((M - WS-COUNTER) * -1))) / J
  3400        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3401        COMPUTE WK5-CSL = (RA * ANGLEM)
  3402        + (CP-ALTERNATE-BENEFIT * WK2)
  3403        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3404          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3405          (WK-S / 1000)
  3406     END-PERFORM
  3407
  3408     MOVE WK3                    TO CP-CALC-PREMIUM
  3409     GO TO 9999-CALC-RATE-PREM-X
  3410     .
  3411 2300-CALC-DCC-MOB-BAL-AHSUM.
  3412
  3413     MOVE CP-ORIGINAL-TERM       TO M
  3414
  3415     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3416        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3417        * WK-S / 1000
  3418
  3419*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3420*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3421*       * WK-S / 1000
  3422
  3423
  3424
  3425     MOVE WK3                    TO CP-CALC-PREMIUM
  3426
  3427
  3428     GO TO 9999-CALC-RATE-PREM-X
  3429     .
  3430 9999-RATE-NOTFND.
  3431     MOVE '6'                    TO CP-RETURN-CODE.
  3432     GO TO 9999-CALC-RATE-PREM-X.
  3433
  3434 9999-RATE-NOTOPEN.
  3435     MOVE 'D'                    TO CP-RETURN-CODE.
  3436     GO TO 9999-CALC-RATE-PREM-X.
  3437
  3438 9999-CALC-RATE-PREM-X.
  3439     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  63
* ELRATEX.cbl (/apps/test/cid1s/copy/ELCRATPD)
  3440        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3441        CONTINUE
  3442     ELSE
  3443        IF CP-RATE-DEV-PCT NOT = ZERO
  3444           COMPUTE CP-CALC-PREMIUM =
  3445              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3446
  3447
  3448     GOBACK.
  3449
  3450 9100-CONVERT-DATE.
  3451     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  3452
  3453 9100-EXIT.
  3454     EXIT.
  3455
  3456 9999-OPEN-RATE-FILE.
  3457     MOVE SPACE TO CP-RETURN-CODE
  3458                   CP-IO-FUNCTION.
  3459
  3460     IF  ERRATE-FILE-ID = OERATE-FILE-ID
  3461         OPEN INPUT OERATEF
  3462        ELSE
  3463         OPEN INPUT ERRATEF.
  3464
  3465     IF  ER-STATUS NOT = '00' AND '97'
  3466         MOVE 'E'                 TO CP-IO-FUNCTION.
  3467
  3468     GOBACK.
  3469
  3470 9999-CLOSE-RATE-FILE.
  3471     MOVE SPACE TO CP-RETURN-CODE
  3472                   CP-IO-FUNCTION.
  3473
  3474     IF  ERRATE-FILE-ID = OERATE-FILE-ID
  3475         CLOSE OERATEF
  3476        ELSE
  3477         CLOSE ERRATEF.
  3478
  3479     IF  ER-STATUS NOT = '00'
  3480         MOVE 'E'                 TO CP-IO-FUNCTION.
  3481
  3482     GOBACK.
  3483
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  64
* ELRATEX.cbl
  3485 10000-NET-TERM SECTION.
* 3486                          COPY ERCNETP.
  3487***************************************************************** 04/29/98
  3488*                                                               * ERCNETP
  3489*                            ERCNETP                            *    LV006
  3490*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
  3491*                            VMOD=2.029                         *    CL**3
  3492*                                                               * ERCNETP
  3493*****************************************************************.ERCNETP
  3494*                                                                 ERCNETP
  3495*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS    ERCNETP
  3496*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)            ERCNETP
  3497*                                   ORIGINAL TERM (S999)          ERCNETP
  3498*                                   REMAINING TERM (S999)         ERCNETP
  3499*                                   NET PAY OPTION (X)            ERCNETP
  3500*                                   LOAN TERM (S999)              ERCNETP
  3501*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))           ERCNETP
  3502*                                                                 ERCNETP
  3503*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING ERCNETP
  3504*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,   ERCNETP
  3505*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT   ERCNETP
  3506*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE  ERCNETP
  3507*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE  ERCNETP
  3508*    CHARGED.                                                     ERCNETP
  3509*                                                                 ERCNETP
  3510*    OPTIONS - S = NET SIMPLE                                     ERCNETP
  3511*          SPACE = NET PAY  (1 MO. INTEREST)                      ERCNETP
  3512*              A = NET PAY  (0 MO. INTEREST)                      ERCNETP
  3513*              I = NET PAY  (2 MO. INTEREST)                      ERCNETP
  3514*              J = NET PAY  (3 MO. INTEREST)                      ERCNETP
  3515*              K = NET PAY  (4 MO. INTEREST)                      ERCNETP
  3516*              T = TRUNCATED  (0 MO. INTEREST)                    ERCNETP
  3517*              U = TRUNCATED  (1 MO. INTEREST)                    ERCNETP
  3518*              V = TRUNCATED  (2 MO. INTEREST)                    ERCNETP
  3519*              W = TRUNCATED  (3 MO. INTEREST)                    ERCNETP
  3520*              X = TRUNCATED  (4 MO. INTEREST)                    ERCNETP
  3521*              R = REFUNDS (REGULAR OR TRUNCATED)                 ERCNETP
  3522******************************************************************
  3523*                   C H A N G E   L O G
  3524*
  3525* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3526*-----------------------------------------------------------------
  3527*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3528* EFFECTIVE    NUMBER
  3529*-----------------------------------------------------------------
  3530* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3531* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3532* 120403                   PEMA  ADD SPECIAL TX CALC
  3533* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3534* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3535* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3536* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3537* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3538* 021207                   PEMA  ADD PA NP
  3539* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3540* 032807                   PEMA  ADD VT NP PLUS 2
  3541* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3542* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  65
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3543* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3544* 110207      TO 'AL' NET PAY CALC
  3545* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3546* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3547* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3548* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3549* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3550* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3551* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3552* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3553* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3554* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3555* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3556* 032612  CR2011110200001  PEMA  AHL CHANGES
  3557* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  3558* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  3559* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  3560* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  3561* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOONS
  3562* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3563* 021519  CR2019021100001  PEMA  non-monthly AL calcs
  3564* 012820  CR2020010600001  PEMA  MOD TX NP FORMULA TO HANDLE TRUNC
  3565* 012820    CONTINUED   AND TO ADJ AF FOR EXTRA DAYS.
  3566******************************************************************
  3567                                                                  ERCNETP
  3568     MOVE N-P-APR     TO ANNUAL-INT-RATE.                         ERCNETP
  3569     MOVE N-P-ORIG    TO ORIGINAL-TERM.                           ERCNETP
  3570     MOVE N-P-LOAN    TO LOAN-TERM.                               ERCNETP
  3571     MOVE N-P-REM     TO REMAINING-TERM.                          ERCNETP
  3572     MOVE N-P-OPT     TO OPTION-SW.                               ERCNETP
  3573                                                                  ERCNETP
  3574     MOVE +0 TO FACTOR.                                           ERCNETP
  3575
  3576     if cp-company-id = 'CID'
  3577        if annual-int-rate = +99.9999
  3578           go to 99000-error
  3579        end-if
  3580     else
  3581        if annual-int-rate = zero
  3582           go to 99000-error
  3583        end-if
  3584     end-if
  3585
  3586     IF ORIGINAL-TERM = ZERO                                      ERCNETP
  3587         GO TO 99999-RETURN.                                      ERCNETP
  3588     IF REMAINING-TERM = ZERO                                     ERCNETP
  3589         GO TO 99999-RETURN.                                      ERCNETP
  3590     IF REMAINING-TERM GREATER ORIGINAL-TERM                      ERCNETP
  3591         GO TO 99000-ERROR.                                       ERCNETP
  3592     IF LOAN-TERM = ZERO                                          ERCNETP
  3593         GO TO 99999-RETURN.                                      ERCNETP
  3594     IF LOAN-TERM LESS ORIGINAL-TERM                              ERCNETP
  3595         GO TO 99000-ERROR.                                       ERCNETP
  3596                                                                  ERCNETP
  3597*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  3598*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  3599*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  3600*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  66
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3601*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  3602*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  3603                                                                  ERCNETP
  3604     IF NPO-REFUND                                                ERCNETP
  3605         MOVE '2' TO NP-PROCESS-SW                                ERCNETP
  3606       ELSE                                                       ERCNETP
  3607         IF ORIGINAL-TERM = REMAINING-TERM                        ERCNETP
  3608            MOVE '1'   TO NP-PROCESS-SW                           ERCNETP
  3609           ELSE                                                   ERCNETP
  3610            MOVE '3'   TO NP-PROCESS-SW.                          ERCNETP
  3611                                                                  ERCNETP
  3612     IF NPO-SIMPLE                                                ERCNETP
  3613         MOVE 'S' TO TYPE-SW                                      ERCNETP
  3614     ELSE                                                         ERCNETP
  3615         MOVE 'N' TO TYPE-SW.                                     ERCNETP
  3616                                                                  ERCNETP
  3617     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.          ERCNETP
  3618     if i = zeros
  3619        move .0000000001         to i
  3620     end-if
  3621                                                                  ERCNETP
  3622     COMPUTE V ROUNDED = K1 / (K1 + I).                           ERCNETP
  3623                                                                  ERCNETP
  3624     MOVE V     TO VX                                             ERCNETP
  3625                   SV.                                            ERCNETP
  3626                                                                  ERCNETP
  3627     MOVE +1    TO X1                                             ERCNETP
  3628                   SX.                                            ERCNETP
  3629                                                                  ERCNETP
  3630     MOVE LOAN-TERM TO MAX-X.                                     ERCNETP
  3631                                                                  ERCNETP
  3632     COMPUTE X2 = MAX-X - ORIGINAL-TERM.                          ERCNETP
  3633                                                                  ERCNETP
  3634     IF MAX-X = +1                                                ERCNETP
  3635        GO TO 10700-COMPUTE-REMAINING-FACTOR.                     ERCNETP
  3636                                                                  ERCNETP
  3637     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.       ERCNETP
  3638                                                                  ERCNETP
  3639     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'     ERCNETP
  3640         OR 'DCC' or 'VPP' OR 'NCL') AND
  3641        (NOT NP-REFUND)                                           ERCNETP
  3642        NEXT SENTENCE                                             ERCNETP
  3643     ELSE                                                         ERCNETP
  3644     IF LOAN-TERM NOT = ORIGINAL-TERM                             ERCNETP
  3645        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.        ERCNETP
  3646                                                                  ERCNETP
  3647     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.               ERCNETP
  3648                                                                  ERCNETP
  3649 10500-VX-LOOP.                                                   ERCNETP
  3650                                                                  ERCNETP
  3651***  VX = AMORT. LOAN TERM.                                       ERCNETP
  3652***  SV = AMORT. INSURANCE TERM.                                  ERCNETP
  3653***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.                 ERCNETP
  3654***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED. ERCNETP
  3655***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)             ERCNETP
  3656                                                                  ERCNETP
  3657     IF X2 = 1
  3658        MOVE V         TO SX
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  67
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3659     END-IF
  3660     COMPUTE VX ROUNDED = VX * V.                                 ERCNETP
  3661                                                                  ERCNETP
  3662     ADD B1 TO X1.                                                ERCNETP
  3663                                                                  ERCNETP
  3664     IF X1 = REMAINING-TERM                                       ERCNETP
  3665          MOVE VX    TO SV.                                       ERCNETP
  3666                                                                  ERCNETP
  3667     IF X1 EQUAL SV-MINUS-ONE                                     ERCNETP
  3668        MOVE VX      TO SV-MINUS-ONE.                             ERCNETP
  3669                                                                  ERCNETP
  3670     IF X1 = X2                                                   ERCNETP
  3671          MOVE VX    TO SX.                                       ERCNETP
  3672                                                                  ERCNETP
  3673     IF X1 NOT = MAX-X                                            ERCNETP
  3674          GO TO 10500-VX-LOOP.                                    ERCNETP
  3675                                                                  ERCNETP
  3676 10700-COMPUTE-REMAINING-FACTOR.                                  ERCNETP
  3677*****  WK1 = LOAN TERM AMORT
  3678     COMPUTE WK1 = K1 - VX.                                       ERCNETP
  3679*****  WK2 = INS TERM AMORT
  3680     COMPUTE WK2 = K1 - SV.                                       ERCNETP
  3681*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3682     COMPUTE WK5 = K1 - SX.                                       ERCNETP
  3683*****  WK6 = INS TERM - 1
  3684     COMPUTE WK6 = K1 - SV-MINUS-ONE.                             ERCNETP
  3685                                                                  ERCNETP
  3686     IF NP-RATING                                                 ERCNETP
  3687         GO TO 12000-PREMIUM-RATE.                                ERCNETP
  3688                                                                  ERCNETP
  3689     IF NP-REFUND                                                 ERCNETP
  3690         GO TO 11000-REFUND-CALC.                                 ERCNETP
  3691                                                                  ERCNETP
  3692     IF NET-STD                                                   ERCNETP
  3693         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.               ERCNETP
  3694                                                                  ERCNETP
  3695     IF NET-SMP                                                   ERCNETP
  3696         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)      ERCNETP
  3697         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)    ERCNETP
  3698         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)      ERCNETP
  3699         COMPUTE WK3 ROUNDED = WK3 * 1000.                        ERCNETP
  3700                                                                  ERCNETP
  3701     IF REMAINING-TERM LESS THAN X2                               ERCNETP
  3702         MOVE +0 TO WK3.                                          ERCNETP
  3703                                                                  ERCNETP
  3704     MOVE WK3 TO FACTOR.                                          ERCNETP
  3705                                                                  ERCNETP
  3706     GO TO 99999-RETURN.                                          ERCNETP
  3707                                                                  ERCNETP
  3708 11000-REFUND-CALC.                                               ERCNETP
  3709     IF REMAINING-TERM NOT LESS MAX-X                             ERCNETP
  3710        MOVE +1 TO FACTOR                                         ERCNETP
  3711        GO TO 99999-RETURN.                                       ERCNETP
  3712                                                                  ERCNETP
  3713     IF REMAINING-TERM LESS +1                                    ERCNETP
  3714        MOVE 0 TO FACTOR                                          ERCNETP
  3715        GO TO 99999-RETURN.                                       ERCNETP
  3716                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  68
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3717     COMPUTE WK2 ROUNDED = WK2 / I.                               ERCNETP
  3718     COMPUTE WK5 ROUNDED = WK5 / I.                               ERCNETP
  3719     COMPUTE WK1 ROUNDED = WK1 / I.                               ERCNETP
  3720                                                                  ERCNETP
  3721     IF (CP-COMPANY-ID EQUAL 'CID')
  3722        AND (CP-STATE-STD-ABBRV = 'MN')
  3723        AND (CP-CERT-EFF-DT > X'A4FF')
  3724        AND (CP-RATE-AS-REG-BALLOON)
  3725        AND (CP-EARN-AS-NET-PAY)
  3726        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3727        CONTINUE
  3728     ELSE
  3729        GO TO 11000-CHECK-MN-LEV-BALLOON
  3730     END-IF
  3731
  3732     COMPUTE R = M - E
  3733     COMPUTE FACTOR = (R - WK2 + WK5) /
  3734        (M - WK1 + WK5)
  3735
  3736     GO TO 99999-RETURN
  3737
  3738      .
  3739 11000-CHECK-MN-LEV-BALLOON.
  3740
  3741     IF (CP-COMPANY-ID EQUAL 'CID')
  3742        AND (CP-STATE-STD-ABBRV = 'MN')
  3743        AND (CP-CERT-EFF-DT > X'A4FF')
  3744        AND (CP-RATE-AS-REG-BALLOON)
  3745        AND (CP-EARN-AS-NET-PAY)
  3746        AND (CP-DEVIATION-CODE = 'LEV')
  3747        CONTINUE
  3748     ELSE
  3749        GO TO 11000-CONTINUE-REFUND
  3750     END-IF
  3751
  3752     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3753     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3754        ** (M - E)) / I
  3755
  3756     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3757
  3758     GO TO 99999-RETURN
  3759
  3760     .
  3761 11000-CONTINUE-REFUND.
  3762
  3763*    IF CP-GAP-ACTUARIAL
  3764*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3765*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3766*       COMPUTE WK3 = WK2 / ANGLEN
  3767*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3768
  3769     IF CP-GAP-ACTUARIAL
  3770        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3771           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3772        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3773     ELSE
  3774        COMPUTE WK3 ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  69
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3775          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3776     END-IF
  3777                                                                  ERCNETP
  3778     MOVE WK3  TO FACTOR.                                         ERCNETP
  3779                                                                  ERCNETP
  3780     GO TO 99999-RETURN.                                          ERCNETP
  3781                                                                  ERCNETP
  3782 12000-PREMIUM-RATE.                                              ERCNETP
  3783*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST      ERCNETP
  3784*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I          ERCNETP
  3785*      OPTION - A OR T           = 0 MO,  SO K-I = 1              ERCNETP
  3786*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I         ERCNETP
  3787*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I         ERCNETP
  3788*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I         ERCNETP
  3789                                                                  ERCNETP
  3790     COMPUTE K-I = K1 + I.                                        ERCNETP
  3791     MOVE K-I TO ONE-PLUS-I.                                      ERCNETP
  3792                                                                  ERCNETP
  3793     IF NPO-ALT OR NPO-TRUNC-0                                    ERCNETP
  3794         MOVE K1 TO K-I.                                          ERCNETP
  3795                                                                  ERCNETP
  3796     IF NPO-2MO OR NPO-TRUNC-2                                    ERCNETP
  3797         COMPUTE K-I = K1 + (2 * I).                              ERCNETP
  3798                                                                  ERCNETP
  3799     IF NPO-3MO OR NPO-TRUNC-3                                    ERCNETP
  3800         COMPUTE K-I = K1 + (3 * I).                              ERCNETP
  3801                                                                  ERCNETP
  3802     IF NPO-4MO OR NPO-TRUNC-4                                    ERCNETP
  3803         COMPUTE K-I = K1 + (4 * I).                              ERCNETP
  3804                                                                  ERCNETP
  3805     COMPUTE RA ROUNDED = 1 -                                     ERCNETP
  3806             ((X2 * (X2 + 1)) /                                   ERCNETP
  3807              (N *  (N  + 1))).                                   ERCNETP
  3808                                                                  ERCNETP
  3809     IF (CP-COMPANY-ID EQUAL 'CSL') AND                           ERCNETP
  3810        (CP-CSL-VALID-NP-BENEFIT-CD)                              ERCNETP
  3811        NEXT SENTENCE                                             ERCNETP
  3812     ELSE                                                         ERCNETP
  3813        GO TO XXXX-CHECK-DISCOUNT-5.                              ERCNETP
  3814                                                                  ERCNETP
  3815     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  3816     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  3817     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  3818                                                                  ERCNETP
  3819     IF DATE-CONVERSION-ERROR                                     ERCNETP
  3820        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  3821        MOVE ZEROS               TO FACTOR                        ERCNETP
  3822                                    CP-CALC-PREMIUM               ERCNETP
  3823         GO TO 99999-RETURN.                                      ERCNETP
  3824                                                                  ERCNETP
  3825     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE                      CL**2
  3826     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1                      ERCNETP
  3827     MOVE ' ' TO DC-OPTION-CODE                                   ERCNETP
  3828     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  3829                                                                  ERCNETP
  3830     IF DATE-CONVERSION-ERROR                                     ERCNETP
  3831        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  3832        MOVE ZEROS               TO FACTOR                        ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  70
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3833                                    CP-CALC-PREMIUM               ERCNETP
  3834         GO TO 99999-RETURN.                                      ERCNETP
  3835                                                                  ERCNETP
  3836     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.                           CL**2
  3837                                                                  ERCNETP
  3838     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).                        ERCNETP
  3839                                                                  ERCNETP
  3840     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30         ERCNETP
  3841        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *       ERCNETP
  3842        CP-PAY-FREQUENCY / 365) * I                               ERCNETP
  3843     ELSE                                                         ERCNETP
  3844        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *       ERCNETP
  3845        CP-PAY-FREQUENCY / 365) * I.                              ERCNETP
  3846                                                                  ERCNETP
  3847     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /          ERCNETP
  3848     13).                                                         ERCNETP
  3849                                                                  ERCNETP
  3850     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *         ERCNETP
  3851     (N - ( ANGLEN-1 / WK3)).                                     ERCNETP
  3852                                                                  ERCNETP
  3853     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.                   ERCNETP
  3854                                                                  ERCNETP
  3855     COMPUTE WS-CALC-FREQ-RATE EQUAL                              ERCNETP
  3856       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.                    ERCNETP
  3857                                                                  ERCNETP
  3858     COMPUTE WS-Y-X-FACTOR EQUAL                                  ERCNETP
  3859       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /           ERCNETP
  3860       WS-CALC-FREQ-RATE).                                        ERCNETP
  3861                                                                  ERCNETP
  3862     COMPUTE WS-ODD-DAY-UNITS EQUAL                               ERCNETP
  3863       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.ERCNETP
  3864                                                                  ERCNETP
  3865     COMPUTE WS-X-Y-FACTOR EQUAL                                  ERCNETP
  3866       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).                ERCNETP
  3867                                                                  ERCNETP
  3868     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *                    ERCNETP
  3869       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *            ERCNETP
  3870       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).                     ERCNETP
  3871                                                                  ERCNETP
  3872     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.  ERCNETP
  3873                                                                  ERCNETP
  3874     GO TO 99999-RETURN.                                          ERCNETP
  3875                                                                  ERCNETP
  3876 XXXX-CHECK-DISCOUNT-5.                                           ERCNETP
  3877                                                                  ERCNETP
  3878     IF WS-DISCOUNT-OPTION EQUAL '5'                              ERCNETP
  3879        NEXT SENTENCE                                             ERCNETP
  3880     ELSE                                                         ERCNETP
  3881        GO TO 12000-CHECK-CLIENT.                                 ERCNETP
  3882                                                                  ERCNETP
  3883      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3884                                                                  ERCNETP
  3885      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  3886                                                                  ERCNETP
  3887      COMPUTE WK3 EQUAL                                           ERCNETP
  3888        (12 *                                                     ERCNETP
  3889        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -                   ERCNETP
  3890        CP-ORIGINAL-BENEFIT)) /                                   ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  71
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3891        APR100.                                                   ERCNETP
  3892                                                                  ERCNETP
  3893     COMPUTE WK3 EQUAL                                            ERCNETP
  3894        (WK3 * CP-PREMIUM-RATE) / +1000.                          ERCNETP
  3895                                                                  ERCNETP
  3896     COMPUTE WK3 EQUAL                                            ERCNETP
  3897        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).               ERCNETP
  3898                                                                  ERCNETP
  3899      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3900                                                                  ERCNETP
  3901     GO TO 99999-RETURN.                                          ERCNETP
  3902                                                                  ERCNETP
  3903 12000-CHECK-CLIENT.                                              ERCNETP
  3904                                                                  ERCNETP
  3905     IF (CP-COMPANY-ID EQUAL 'MON') AND                           ERCNETP
  3906        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  3907        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3908        NEXT SENTENCE                                             ERCNETP
  3909     ELSE                                                         ERCNETP
  3910        GO TO 12000-CHECK-NEXT.                                   ERCNETP
  3911                                                                  ERCNETP
  3912     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3913                                                                  ERCNETP
  3914     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3915     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  3916                                                                  ERCNETP
  3917     COMPUTE FM EQUAL                                             ERCNETP
  3918                    (((ONE-PLUS-I ** M) * I * M) /                ERCNETP
  3919                    ((ONE-PLUS-I ** M) - 1))                      ERCNETP
  3920                    - 1.                                          ERCNETP
  3921                                                                  ERCNETP
  3922     COMPUTE FN EQUAL                                             ERCNETP
  3923                    (((ONE-PLUS-I ** N) * I * N) /                ERCNETP
  3924                    ((ONE-PLUS-I ** N) - 1))                      ERCNETP
  3925                    - 1.                                          ERCNETP
  3926                                                                  ERCNETP
  3927     COMPUTE FNM EQUAL                                            ERCNETP
  3928                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /    ERCNETP
  3929                    ((ONE-PLUS-I ** (N - M)) - 1))                ERCNETP
  3930                    - 1.                                          ERCNETP
  3931                                                                  ERCNETP
  3932     COMPUTE GR EQUAL                                             ERCNETP
  3933                    (WS-WORK-RATE * ANGLEM * I) /                 ERCNETP
  3934                    (M - ANGLEM).                                 ERCNETP
  3935                                                                  ERCNETP
  3936     COMPUTE ODF EQUAL                                            ERCNETP
  3937                     (1 +                                         ERCNETP
  3938                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /     ERCNETP
  3939                     360)) /                                      ERCNETP
  3940                     ONE-PLUS-I.                                  ERCNETP
  3941                                                                  ERCNETP
  3942     COMPUTE OD EQUAL                                             ERCNETP
  3943                    (1 + (ODF * (FN / I - 1))) +                  ERCNETP
  3944                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).          ERCNETP
  3945                                                                  ERCNETP
  3946     COMPUTE WK3 EQUAL                                            ERCNETP
  3947*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /      ERCNETP
  3948                    ((1 + FN) * ODF *                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  72
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3949                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /ERCNETP
  3950                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *    ERCNETP
  3951                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).         ERCNETP
  3952                                                                  ERCNETP
  3953     COMPUTE TRUNC-PMT EQUAL WK3 / N.                             ERCNETP
  3954     COMPUTE WK3 EQUAL TRUNC-PMT * N.                             ERCNETP
  3955                                                                  ERCNETP
  3956     COMPUTE WK3 EQUAL                                            ERCNETP
  3957                    (WK3 / (ODF * (1 + FN))) -                    ERCNETP
  3958*                   CP-ORIGINAL-BENEFIT.                          ERCNETP
  3959                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).  ERCNETP
  3960                                                                  ERCNETP
  3961      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3962                                                                  ERCNETP
  3963     GO TO 99999-RETURN.                                          ERCNETP
  3964                                                                  ERCNETP
  3965 12000-CHECK-NEXT.                                                ERCNETP
  3966                                                                  ERCNETP
  3967     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'                       ERCNETP
  3968        NEXT SENTENCE                                             ERCNETP
  3969     ELSE                                                         ERCNETP
  3970        GO TO 12000-CHECK-PA-TRUNC.                               ERCNETP
  3971                                                                  ERCNETP
  3972      IF WS-WORK-DIS-RATE EQUAL +0                                ERCNETP
  3973         MOVE '7'                TO CP-RETURN-CODE                ERCNETP
  3974         MOVE ZEROS              TO FACTOR                        ERCNETP
  3975                                    CP-CALC-PREMIUM               ERCNETP
  3976         GO TO 99999-RETURN.                                      ERCNETP
  3977                                                                  ERCNETP
  3978      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3979                                                                  ERCNETP
  3980      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  3981                                                                  ERCNETP
  3982      IF WS-WORK-DIS-RATE EQUAL APR100                            ERCNETP
  3983         ADD .00001 TO APR100.                                    ERCNETP
  3984                                                                  ERCNETP
  3985      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).             ERCNETP
  3986      COMPUTE WK9 EQUAL 12 / (12 + APR100).                       ERCNETP
  3987                                                                  ERCNETP
  3988
  3989
  3990     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3991        / (1 + I)
  3992     COMPUTE ANGLEN-1 = ANGLEN / Y
  3993
  3994      IF CP-COMPANY-ID EQUAL 'CDL'                                ERCNETP
  3995         COMPUTE WK3 EQUAL                                        ERCNETP
  3996                                                                  ERCNETP
  3997          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *                  ERCNETP
  3998          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *                   ERCNETP
  3999                                                                  ERCNETP
  4000          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  4001                                                                  ERCNETP
  4002          ((WK8 ** N) /                                           ERCNETP
  4003          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  4004                                                                  ERCNETP
  4005          ((WK9 ** N) /                                           ERCNETP
  4006          (APR100 * (APR100 - WS-WORK-DIS-RATE))))                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  73
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4007                                                                  ERCNETP
  4008      ELSE                                                        ERCNETP
  4009         COMPUTE WK3 EQUAL                                        ERCNETP
  4010                                                                  ERCNETP
  4011          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  4012          (12 + WS-WORK-DIS-RATE) * 12) *                         ERCNETP
  4013                                                                  ERCNETP
  4014          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  4015                                                                  ERCNETP
  4016          ((WK8 ** N) /                                           ERCNETP
  4017          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  4018                                                                  ERCNETP
  4019          ((WK9 ** N) /                                           ERCNETP
  4020          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).               ERCNETP
  4021                                                                  ERCNETP
  4022      COMPUTE WK3 EQUAL                                           ERCNETP
  4023          (WK3 * CP-PREMIUM-RATE) / +1000.                        ERCNETP
  4024                                                                  ERCNETP
  4025      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4026                                                                  ERCNETP
  4027     GO TO 99999-RETURN.                                          ERCNETP
  4028                                                                  ERCNETP
  4029 12000-CHECK-PA-TRUNC.                                            ERCNETP
  4030                                                                  ERCNETP
  4031     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4032        (CP-STATE-STD-ABBRV EQUAL 'PA') AND                          CL**3
  4033        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4034        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4035        NEXT SENTENCE                                             ERCNETP
  4036     ELSE                                                         ERCNETP
  4037        GO TO 12000-CHECK-MD-TRUNC.                               ERCNETP
  4038                                                                  ERCNETP
  4039     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  4040                                                                  ERCNETP
  4041     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4042     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4043                                                                  ERCNETP
  4044     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  4045                                                                  ERCNETP
  4046     COMPUTE WK3 EQUAL                                            ERCNETP
  4047        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *    ERCNETP
  4048        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).                 ERCNETP
  4049                                                                  ERCNETP
  4050     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4051                                                                  ERCNETP
  4052     GO TO 99999-RETURN.                                          ERCNETP
  4053                                                                  ERCNETP
  4054 12000-CHECK-MD-TRUNC.                                            ERCNETP
  4055                                                                  ERCNETP
  4056     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4057        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  4058        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4059        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4060        NEXT SENTENCE                                             ERCNETP
  4061     ELSE                                                         ERCNETP
  4062        GO TO 12000-CHECK-MD.                                     ERCNETP
  4063                                                                  ERCNETP
  4064     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  74
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4065                                                                  ERCNETP
  4066     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4067     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4068     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4069                                                                  ERCNETP
  4070     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  4071                                                                  ERCNETP
  4072     COMPUTE WK3 EQUAL                                            ERCNETP
  4073        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *                      ERCNETP
  4074        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /                   ERCNETP
  4075        (ANGLEN-1 * (M - ANGLEM))).                               ERCNETP
  4076                                                                  ERCNETP
  4077     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4078                                                                  ERCNETP
  4079     GO TO 99999-RETURN.                                          ERCNETP
  4080                                                                  ERCNETP
  4081 12000-CHECK-MD.                                                  ERCNETP
  4082                                                                  ERCNETP
  4083     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4084        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  4085        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4086        NEXT SENTENCE                                             ERCNETP
  4087     ELSE                                                         ERCNETP
  4088        GO TO 12000-CHECK-ME-TRUNC.                               ERCNETP
  4089                                                                  ERCNETP
  4090     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  4091                                                                  ERCNETP
  4092     COMPUTE WK3 EQUAL                                            ERCNETP
  4093        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.                       ERCNETP
  4094                                                                  ERCNETP
  4095     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4096                                                                  ERCNETP
  4097     GO TO 99999-RETURN.                                          ERCNETP
  4098                                                                  ERCNETP
  4099 12000-CHECK-ME-TRUNC.                                            ERCNETP
  4100                                                                  ERCNETP
  4101     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  4102        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4103        AND (CP-EARN-AS-NET-PAY)
  4104        AND (CP-TRUNCATED-LIFE)
  4105        CONTINUE
  4106     ELSE
  4107        GO TO 12000-CHECK-CID-WA-FARMPLAN
  4108     END-IF
  4109                                                                  ERCNETP
  4110     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4111
  4112     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4113
  4114     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4115
  4116     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4117
  4118     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4119     COMPUTE ANGLEN-1 = ANGLEN / Y
  4120
  4121     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4122
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  75
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4123     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4124
  4125     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  4126
  4127     COMPUTE WK3
  4128        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  4129        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  4130            * (1 / (1.0635 ** (M / 12))))
  4131
  4132*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).                 ERCNETP
  4133*    COMPUTE WK9 EQUAL                                            ERCNETP
  4134*       1 / (1 + (.045 * (N - M) / 24))                           ERCNETP
  4135*    COMPUTE WK7 EQUAL                                            ERCNETP
  4136*       WS-WORK-RATE * 20 / (M + 1).                              ERCNETP
  4137*    COMPUTE WK3 EQUAL                                            ERCNETP
  4138*       ((( N - ANGLEN) * WK7 * WK8) /                            ERCNETP
  4139*       (10 * ANGLEN-1 * I)) -                                    ERCNETP
  4140*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /                   ERCNETP
  4141*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).              ERCNETP
  4142*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.                 ERCNETP
  4143*                                                                 ERCNETP
  4144     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4145                                                                  ERCNETP
  4146     GO TO 99999-RETURN
  4147
  4148      .
  4149 12000-CHECK-CID-WA-FARMPLAN.
  4150
  4151     IF (CP-COMPANY-ID EQUAL 'CID')
  4152        AND (CP-STATE-STD-ABBRV = 'WA')
  4153        AND (CP-FARM-PLAN)
  4154        CONTINUE
  4155     ELSE
  4156        GO TO 12000-CHECK-CID-FARMPLAN
  4157     END-IF
  4158
  4159**  This was removed due to IR 2015022300001
  4160    GO TO 12000-CHECK-CID-FARMPLAN
  4161
  4162     move cp-original-term       to n
  4163     move cp-no-of-pmts          TO C-TOT-PMTS
  4164     compute c-pmts-per-year = 12 / cp-pay-frequency
  4165     move cp-pay-frequency       to m
  4166     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  4167     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4168     if i = zeros
  4169        move .0000000001         to i
  4170     end-if
  4171     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4172
  4173     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4174        (m * 30))) / (1 + I)
  4175     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4176        ** CP-PAY-FREQUENCY) - 1
  4177     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  4178     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4179        ** TI) / WS-WORK-DIS-RATE
  4180     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  76
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4181     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  4182     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4183        ** m) / WS-WORK-DIS-RATE
  4184     COMPUTE WK2 = WK2 * (1 + J)
  4185     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4186     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4187     COMPUTE WK3 = WK3 * (1 + J)
  4188     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  4189        ** (c-tot-pmts - 1))) / J
  4190     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4191        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  4192        (CP-PREMIUM-RATE / 1000)
  4193     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  4194     COMPUTE WK6 = (WK7 * GR)
  4195
  4196     MOVE WK6 TO CP-CALC-PREMIUM
  4197
  4198     GO TO 99999-RETURN
  4199
  4200     .
  4201 12000-CHECK-CID-FARMPLAN.
  4202
  4203     IF (CP-COMPANY-ID EQUAL 'CID')
  4204        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  4205           OR 'IN' OR 'AZ')
  4206        AND (CP-FARM-PLAN)
  4207        CONTINUE
  4208     ELSE
  4209        GO TO 12000-CHECK-CID-AL-FARMPLAN
  4210     END-IF
  4211
  4212     COMPUTE N = M / CP-PAY-FREQUENCY
  4213     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4214     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4215        ** CP-PAY-FREQUENCY) - 1
  4216     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  4217     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4218        ** TI) / WS-WORK-DIS-RATE
  4219     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  4220     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  4221     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4222        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  4223     COMPUTE WK2 = WK2 * (1 + J)
  4224     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4225     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4226     COMPUTE WK3 = WK3 * (1 + J)
  4227     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  4228        ** (N - 1))) / J
  4229     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4230        ((N * WK2) - WK5)) + (N * WK1)) *
  4231        (CP-PREMIUM-RATE / 1000)
  4232     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  4233     COMPUTE WK6 = (WK7 * GR)
  4234
  4235     MOVE WK6 TO CP-CALC-PREMIUM
  4236
  4237     GO TO 99999-RETURN
  4238
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  77
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4239     .
  4240 12000-CHECK-CID-AL-FARMPLAN.
  4241
  4242     IF (CP-COMPANY-ID EQUAL 'CID')
  4243        AND (CP-STATE-STD-ABBRV = 'AL')
  4244        AND (CP-FARM-PLAN)
  4245        CONTINUE
  4246     ELSE
  4247        GO TO 12000-CHECK-SC-CID
  4248     END-IF
  4249
  4250     display ' made AL Farm Plan calc '
  4251
  4252     evaluate true
  4253        when cp-pmt-mode = 'B'
  4254           move 26               to c-pmts-per-year
  4255           move 14               to c-days-in-pmt-per
  4256        when cp-pmt-mode = 'W'
  4257           move 52               to c-pmts-per-year
  4258           move 07               to c-days-in-pmt-per
  4259        when cp-pmt-mode = 'S'
  4260           move 24               to c-pmts-per-year
  4261           move 15               to c-days-in-pmt-per
  4262        when cp-pmt-mode = 'A'
  4263           move 1                to c-pmts-per-year
  4264           move 360              to c-days-in-pmt-per
  4265        when cp-pmt-mode = 'T'
  4266           move 2                to c-pmts-per-year
  4267           move 180              to c-days-in-pmt-per
  4268        when cp-pmt-mode = 'Q'
  4269           move 4                to c-pmts-per-year
  4270           move 90               to c-days-in-pmt-per
  4271        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  4272           move 6                to c-pmts-per-year
  4273           move 60               to c-days-in-pmt-per
  4274        when other
  4275           move 12               to c-pmts-per-year
  4276           move 30               to c-days-in-pmt-per
  4277     end-evaluate
  4278
  4279     compute c-tot-pmts = n / 12 * c-pmts-per-year
  4280     compute i = cp-loan-apr / c-pmts-per-year / 100
  4281     if i = zeros
  4282        move .0000000001         to i
  4283     end-if
  4284     compute anglen  =
  4285        (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4286
  4287     compute y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4288        c-days-in-pmt-per)) / (1 + I)
  4289
  4290     compute angleny = anglen / y
  4291
  4292     compute wk3 rounded =   *> tv1
  4293        ((c-tot-pmts - anglen + (i * c-tot-pmts))) / i
  4294
  4295     compute wk6 =           *> tv2
  4296        cp-premium-rate / 10 * 12 / c-pmts-per-year / 100
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  78
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4297
  4298     compute wk7 =    *> tv3
  4299        (cp-original-benefit / anglen)
  4300
  4301     compute wk5 rounded = wk7 *wk3 * wk6
  4302
  4303     move wk5                    to cp-calc-premium
  4304     GO TO 99999-RETURN
  4305
  4306     .
  4307 12000-CHECK-SC-CID.
  4308
  4309     IF (CP-COMPANY-ID = 'CID')
  4310        AND (CP-STATE-STD-ABBRV = 'SC')
  4311        AND (CP-EARN-AS-NET-PAY)
  4312        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4313        move 6                   to ws-extra-pmts
  4314     ELSE
  4315        GO TO 12000-CHECK-AL-CID
  4316     END-IF
  4317
  4318     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4319     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4320     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4321        / 12)) / ((M + 1) / 2)
  4322
  4323     if i = .0000000001
  4324        compute wk4 = cp-original-benefit / n
  4325        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  4326            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  4327        display ' hit sc wo apr - wk2 ' wk2
  4328     else
  4329        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  4330        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4331        COMPUTE ANGLEN-1 = ANGLEN / Y
  4332        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4333        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4334           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4335     end-if
  4336
  4337*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4338*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4339*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4340*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4341*    COMPUTE ANGLEN-1 = ANGLEN / Y
  4342*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4343*       / 12)) / ((M + 1) / 2)
  4344*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4345*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4346*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4347
  4348     MOVE WK3 TO CP-CALC-PREMIUM
  4349
  4350     GO TO 99999-RETURN
  4351
  4352     .
  4353 12000-CHECK-AL-CID.
  4354
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  79
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4355     IF (CP-COMPANY-ID EQUAL 'CID')
  4356        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4357        AND (CP-EARN-AS-NET-PAY)
  4358        CONTINUE
  4359     ELSE
  4360        GO TO 12000-CHECK-NH-CID
  4361     END-IF
  4362
  4363     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4364     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4365     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4366
  4367     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4368                   / (1 + I)
  4369
  4370     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4371
  4372     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4373
  4374     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4375        (CP-PREMIUM-RATE / 1000)
  4376
  4377     MOVE WK3 TO CP-CALC-PREMIUM
  4378
  4379     GO TO 99999-RETURN
  4380
  4381     .
  4382 12000-CHECK-NH-CID.
  4383
  4384     IF (CP-COMPANY-ID EQUAL 'CID')
  4385        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4386        AND (CP-EARN-AS-NET-PAY)
  4387        CONTINUE
  4388     ELSE
  4389        GO TO 12000-CHECK-PA-CID
  4390     END-IF
  4391
  4392     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4393     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4394
  4395     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4396                   / (1 + I)
  4397
  4398     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4399
  4400     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4401
  4402     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4403        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4404
  4405     MOVE WK3 TO CP-CALC-PREMIUM
  4406
  4407     GO TO 99999-RETURN
  4408
  4409     .
  4410 12000-CHECK-PA-CID.
  4411
  4412     IF (CP-COMPANY-ID EQUAL 'CID')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  80
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4413        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4414        AND (CP-EARN-AS-NET-PAY)
  4415        CONTINUE
  4416     ELSE
  4417        GO TO 12000-CHECK-ME-CID
  4418     END-IF
  4419
  4420
  4421     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4422     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4423     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4424     COMPUTE ANGLEN-1 = ANGLEN / Y
  4425     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4426     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4427     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4428     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4429        * WK5
  4430
  4431     MOVE WK3 TO CP-CALC-PREMIUM
  4432
  4433     GO TO 99999-RETURN
  4434
  4435     .
  4436 12000-CHECK-ME-CID.
  4437
  4438     IF (CP-COMPANY-ID EQUAL 'CID')
  4439        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4440        AND (CP-EARN-AS-NET-PAY)
  4441        CONTINUE
  4442     ELSE
  4443        GO TO 12000-CHECK-VT-TRUNC
  4444     END-IF
  4445
  4446     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4447
  4448     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4449
  4450     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4451     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4452     COMPUTE ANGLEN-1 = ANGLEN / Y
  4453
  4454     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4455
  4456     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4457
  4458     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4459        * WK5
  4460
  4461     MOVE WK3 TO CP-CALC-PREMIUM
  4462
  4463     GO TO 99999-RETURN
  4464
  4465     .
  4466 12000-CHECK-VT-TRUNC.                                            ERCNETP
  4467                                                                  ERCNETP
  4468     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4469        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  4470        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  81
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4471        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4472        NEXT SENTENCE                                             ERCNETP
  4473     ELSE                                                         ERCNETP
  4474        GO TO 12000-CHECK-VT.                                     ERCNETP
  4475                                                                  ERCNETP
  4476      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  4477                                                                  ERCNETP
  4478      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4479                                                                  ERCNETP
  4480      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4481                                                                  ERCNETP
  4482      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.                       ERCNETP
  4483      COMPUTE WK9 EQUAL                                           ERCNETP
  4484        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /  ERCNETP
  4485        ((.0054 - I) / (1 + I)).                                  ERCNETP
  4486      COMPUTE WK7 EQUAL                                           ERCNETP
  4487        (1 - (1 / 1.0054) ** (M - 1)) / .0054.                    ERCNETP
  4488      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *     ERCNETP
  4489        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).         ERCNETP
  4490                                                                  ERCNETP
  4491      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4492                                                                  ERCNETP
  4493     GO TO 99999-RETURN.                                          ERCNETP
  4494                                                                  ERCNETP
  4495 12000-CHECK-VT.                                                  ERCNETP
  4496                                                                  ERCNETP
  4497     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4498        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  4499        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4500        NEXT SENTENCE                                             ERCNETP
  4501     ELSE                                                         ERCNETP
  4502        GO TO 12000-CHECK-MINN-WDS.                               ERCNETP
  4503                                                                  ERCNETP
  4504      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  4505                                                                  ERCNETP
  4506      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4507                                                                  ERCNETP
  4508      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4509                                                                  ERCNETP
  4510      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /   ERCNETP
  4511                        (ANGLEN-1 * I)) *                         ERCNETP
  4512                                                                  ERCNETP
  4513                        (((1.0054 ** N - 1) /                     ERCNETP
  4514                        (1.0054 ** (N - 1) * .0054)) -            ERCNETP
  4515                                                                  ERCNETP
  4516                        ((V * (1 - 1.0054 ** N * VX)) /           ERCNETP
  4517                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))). ERCNETP
  4518                                                                  ERCNETP
  4519      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4520                                                                  ERCNETP
  4521     GO TO 99999-RETURN.                                          ERCNETP
  4522                                                                  ERCNETP
  4523 12000-CHECK-MINN-WDS.                                            ERCNETP
  4524                                                                  ERCNETP
  4525     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4526        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4527        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4528        NEXT SENTENCE                                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  82
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4529     ELSE                                                         ERCNETP
  4530        GO TO 12000-CHECK-MINN-BALL-LEV.                          ERCNETP
  4531                                                                  ERCNETP
  4532     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4533     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *                 ERCNETP
  4534              (N / +12) * (2 / (N + 1)).                          ERCNETP
  4535     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *           ERCNETP
  4536         WK3 * ((N - ANGLEN) / I).                                ERCNETP
  4537                                                                  ERCNETP
  4538      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4539                                                                  ERCNETP
  4540     GO TO 99999-RETURN.                                          ERCNETP
  4541                                                                  ERCNETP
  4542 12000-CHECK-MINN-BALL-LEV.                                       ERCNETP
  4543                                                                  ERCNETP
  4544     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4545        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4546        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  4547        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4548        NEXT SENTENCE                                             ERCNETP
  4549     ELSE                                                         ERCNETP
  4550        GO TO 12000-CHECK-MINN-BALL.                              ERCNETP
  4551                                                                  ERCNETP
  4552     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4553                                                                  ERCNETP
  4554     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.                          ERCNETP
  4555                                                                  ERCNETP
  4556     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  4557        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).             ERCNETP
  4558                                                                  ERCNETP
  4559     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4560                                                                  ERCNETP
  4561     GO TO 99999-RETURN.                                          ERCNETP
  4562                                                                  ERCNETP
  4563 12000-CHECK-MINN-BALL.                                           ERCNETP
  4564                                                                  ERCNETP
  4565     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4566        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4567        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4568        NEXT SENTENCE                                             ERCNETP
  4569     ELSE                                                         ERCNETP
  4570        GO TO 12000-CHECK-CID-MN-BALL.                            ERCNETP
  4571                                                                  ERCNETP
  4572     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4573     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  4574                                                                  ERCNETP
  4575     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  4576     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  4577     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).                     ERCNETP
  4578                                                                  ERCNETP
  4579      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4580                                                                  ERCNETP
  4581     GO TO 99999-RETURN.                                          ERCNETP
  4582                                                                  ERCNETP
  4583 12000-CHECK-CID-MN-BALL.                                         ERCNETP
  4584                                                                  ERCNETP
  4585     IF (CP-COMPANY-ID EQUAL 'CID')
  4586        AND (CP-STATE-STD-ABBRV = 'MN')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  83
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4587        AND (CP-CERT-EFF-DT > X'A4FF')
  4588        AND (CP-EARN-AS-REG-BALLOON)
  4589        CONTINUE
  4590     ELSE
  4591        GO TO 12000-CHECK-CID-MN-FARM
  4592     END-IF
  4593                                                                  ERCNETP
  4594     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4595     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4596     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4597     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4598     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4599     COMPUTE V = 1 / (1 + I)
  4600     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4601     COMPUTE Y = (1 + (D * I) / +30)
  4602        / (1 + I)
  4603
  4604
  4605     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4606        * CP-PREMIUM-RATE / 1000
  4607
  4608*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4609*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4610*    ELSE
  4611*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4612*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4613*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4614*       DISPLAY ' BALLOON TOP ' WK6
  4615*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4616*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4617*          / 100
  4618*       DISPLAY ' BALLOON BOTTOM ' WK7
  4619*       COMPUTE GR = WK6 / WK7
  4620*       DISPLAY ' BALLOON PAYMENT ' GR
  4621*    END-IF
  4622
  4623     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4624     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4625        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4626     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4627
  4628     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4629        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4630           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4631           * CP-PREMIUM-RATE / 1000
  4632
  4633     MOVE WK3                    TO CP-CALC-PREMIUM
  4634                                                                  ERCNETP
  4635     GO TO 99999-RETURN.                                          ERCNETP
  4636
  4637     .
  4638 12000-CHECK-CID-MN-FARM.
  4639
  4640     IF (CP-COMPANY-ID EQUAL 'CID')
  4641        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  4642        AND (CP-CERT-EFF-DT > X'A4FF')
  4643        AND (CP-EARN-AS-FARM-PLAN)
  4644        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  84
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4645     ELSE
  4646        GO TO 12000-CHECK-CID-NET-BALLoons
  4647     END-IF
  4648
  4649     EVALUATE CP-PMT-MODE
  4650        WHEN 'B'
  4651           MOVE +14              TO C-DAYS-IN-PMT-PER
  4652           MOVE +26              TO C-PMTS-PER-YEAR
  4653           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4654        WHEN 'S'
  4655           MOVE +15              TO C-DAYS-IN-PMT-PER
  4656           MOVE +24              TO C-PMTS-PER-YEAR
  4657           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4658        WHEN 'T'
  4659           MOVE +360             TO C-DAYS-IN-PMT-PER
  4660           MOVE +1               TO C-PMTS-PER-YEAR
  4661           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4662        WHEN 'W'
  4663           MOVE +7               TO C-DAYS-IN-PMT-PER
  4664           MOVE +52              TO C-PMTS-PER-YEAR
  4665           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4666        WHEN OTHER
  4667           move cp-no-of-pmts    to c-tot-pmts
  4668           if cp-pay-frequency > zeros
  4669              compute c-pmts-per-year =
  4670                 12 / cp-pay-frequency
  4671              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  4672           else
  4673              MOVE +30           TO C-DAYS-IN-PMT-PER
  4674              MOVE +12           TO C-PMTS-PER-YEAR
  4675              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  4676           end-if
  4677     END-EVALUATE
  4678
  4679     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4680     if i = zeros
  4681        move .0000000001         to i
  4682     end-if
  4683
  4684     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4685        C-DAYS-IN-PMT-PER)) / (1 + I)
  4686
  4687     compute cp-premium-rate =
  4688        cp-premium-rate * 12 / c-pmts-per-year / 10
  4689     move c-tot-pmts to n m
  4690     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4691     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4692     COMPUTE ANGLEN-1 = ANGLEN / Y
  4693     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4694
  4695     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  4696        (cp-premium-rate / 100)
  4697
  4698
  4699     MOVE WK3                    TO CP-CALC-PREMIUM
  4700
  4701     GO TO 99999-RETURN.
  4702
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  85
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4703     .
  4704 12000-check-cid-net-balloons.
  4705
  4706     IF (CP-COMPANY-ID EQUAL 'CID')
  4707        AND (CP-EARN-AS-REG-BALLOON)
  4708        and (CP-NET-ONLY-STATE not = 'Y')
  4709        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4710        CONTINUE
  4711     ELSE
  4712        GO TO 12000-check-cid-net-only-balls
  4713     END-IF
  4714
  4715     display ' *** NOT NET ONLY STATE BALLOONS *** '
  4716     COMPUTE Y =
  4717        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4718
  4719     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4720     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  4721     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4722     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4723     COMPUTE ANGLEMY = ANGLEM / Y
  4724     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4725     COMPUTE ANGLENY = ANGLEN / Y
  4726     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4727
  4728     compute cp-original-benefit =
  4729        cp-original-benefit + cp-alternate-benefit
  4730     COMPUTE PVBALLOON rounded =
  4731        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4732     compute wk4 rounded =
  4733        cp-original-benefit - pvballoon
  4734     compute wk6 rounded =
  4735        (cp-original-benefit - cp-alternate-benefit)
  4736
  4737***  compute ra = wk4 / anglem-1y
  4738     compute ra = wk4 / anglemy
  4739     compute wk6 rounded = wk6 / anglemy
  4740     display ' rate before ' cp-premium-rate
  4741
  4742
  4743     compute cp-premium-rate =
  4744        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  4745            / 30) / 12))     /
  4746           ((m + 1) / 2)
  4747
  4748     display '************************************'
  4749     display ' orign ben    ' cp-original-benefit
  4750     display ' balloon      ' cp-alternate-benefit
  4751     display ' ra           ' ra
  4752     display ' wk6          ' wk6
  4753     display ' m            ' m
  4754     display ' anglemy      ' anglemy
  4755     display ' anglem-1     ' anglem-1y
  4756     display ' i            ' i
  4757     display ' extra per    ' cp-extra-periods
  4758     display ' prem rate    ' cp-premium-rate
  4759
  4760
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  86
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4761***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4762***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4763
  4764     compute wk3 = wk6 * (m - anglem) / i * (1 +
  4765        (cp-extra-periods * i)) * cp-premium-rate / 100
  4766
  4767     move wk3                    to cp-calc-premium
  4768     display ' wk3          ' wk3
  4769     display '************************************'
  4770*    compute wk3 rounded =
  4771*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4772*    move wk3                    to cp-lf-balloon-prem
  4773
  4774     GO TO 99999-RETURN.
  4775
  4776     .
  4777 12000-check-cid-net-only-balls.
  4778
  4779     IF (CP-COMPANY-ID EQUAL 'CID')
  4780        AND (CP-EARN-AS-REG-BALLOON)
  4781        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4782        CONTINUE
  4783     ELSE
  4784        GO TO 12000-CHECK-NC-WDS
  4785     END-IF
  4786
  4787     display ' *** NET ONLY STATE BALLOONS *** '
  4788
  4789     COMPUTE Y =
  4790        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4791
  4792     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4793     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  4794     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4795     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4796     COMPUTE ANGLEMY = ANGLEM / Y
  4797     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4798     COMPUTE ANGLENY = ANGLEN / Y
  4799     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4800
  4801
  4802     COMPUTE PVBALLOON rounded =
  4803        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4804     compute wk4 rounded =
  4805        cp-original-benefit - pvballoon
  4806
  4807
  4808*    compute cp-premium-rate =
  4809*       (cp-premium-rate * (m + 1) / 12)  /
  4810*          ((m + 2) / 2)
  4811
  4812
  4813***  compute ra = wk4 / anglem-1y
  4814     compute ra = (cp-original-benefit + cp-alternate-benefit -
  4815        pvballoon) / anglemy
  4816
  4817     display '************************************'
  4818     display ' ra           ' ra
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  87
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4819     display ' m            ' m
  4820     display ' anglemy      ' anglemy
  4821     display ' anglem-1     ' anglem-1y
  4822     display ' i            ' i
  4823     display ' extra per    ' cp-extra-periods
  4824     display ' prem rate    ' cp-premium-rate
  4825     display '************************************'
  4826
  4827***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4828***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4829
  4830     compute wk3 = ra * (m - anglemy) / i * (1 +
  4831        (cp-extra-periods * i)) * cp-premium-rate / 100
  4832
  4833     move wk3                    to cp-calc-premium
  4834     compute wk3 rounded =
  4835        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4836     move wk3                    to cp-lf-balloon-prem
  4837
  4838     GO TO 99999-RETURN.
  4839
  4840     .
  4841 12000-CHECK-NC-WDS.                                              ERCNETP
  4842                                                                  ERCNETP
  4843     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4844        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4845        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4846        NEXT SENTENCE                                             ERCNETP
  4847     ELSE                                                         ERCNETP
  4848        GO TO 12000-CHECK-NC-BALL-LEV.                            ERCNETP
  4849                                                                  ERCNETP
  4850     COMPUTE WK4 EQUAL N * (1 + I * 2).                           ERCNETP
  4851     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4852     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                      ERCNETP
  4853              CP-PREMIUM-RATE / +100 *                            ERCNETP
  4854              N / +12 * 2 / (N + 1) *                             ERCNETP
  4855              (WK4 - ANGLEN) / (I * ANGLEN).                      ERCNETP
  4856                                                                  ERCNETP
  4857      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4858                                                                  ERCNETP
  4859     GO TO 99999-RETURN.                                          ERCNETP
  4860                                                                  ERCNETP
  4861 12000-CHECK-NC-BALL-LEV.                                         ERCNETP
  4862                                                                  ERCNETP
  4863     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4864        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4865        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  4866        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4867        NEXT SENTENCE                                             ERCNETP
  4868     ELSE                                                         ERCNETP
  4869        GO TO 12000-CHECK-NC-BALL.                                ERCNETP
  4870                                                                  ERCNETP
  4871     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4872                                                                  ERCNETP
  4873**** VX = 1 / (1 + I)**N.                                         ERCNETP
  4874                                                                  ERCNETP
  4875     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  4876        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).              ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  88
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4877                                                                  ERCNETP
  4878     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4879                                                                  ERCNETP
  4880     GO TO 99999-RETURN.                                          ERCNETP
  4881                                                                  ERCNETP
  4882 12000-CHECK-NC-BALL.                                             ERCNETP
  4883                                                                  ERCNETP
  4884     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4885        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4886        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4887        NEXT SENTENCE                                             ERCNETP
  4888     ELSE                                                         ERCNETP
  4889        GO TO 12000-CHECK-MINN-TRUNC.                             ERCNETP
  4890                                                                  ERCNETP
  4891     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).                     ERCNETP
  4892     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4893     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  4894**** VX = 1 / (1 + I)**N.                                         ERCNETP
  4895                                                                  ERCNETP
  4896     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  4897     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  4898     (WK4 - ANGLEN-1) / (I * ANGLEN-1).                           ERCNETP
  4899                                                                  ERCNETP
  4900      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4901                                                                  ERCNETP
  4902     GO TO 99999-RETURN.                                          ERCNETP
  4903                                                                  ERCNETP
  4904 12000-CHECK-MINN-TRUNC.                                          ERCNETP
  4905                                                                  ERCNETP
  4906     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4907        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4908        (M GREATER THAN +63) AND                                  ERCNETP
  4909        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4910        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4911        NEXT SENTENCE                                             ERCNETP
  4912     ELSE                                                         ERCNETP
  4913        GO TO 12000-CHECK-MINN.                                   ERCNETP
  4914                                                                  ERCNETP
  4915      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4916      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4917                                                                  ERCNETP
  4918      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4919                                                                  ERCNETP
  4920      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4921       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4922       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).                 ERCNETP
  4923                                                                  ERCNETP
  4924      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4925                                                                  ERCNETP
  4926     GO TO 99999-RETURN.                                          ERCNETP
  4927                                                                  ERCNETP
  4928 12000-CHECK-MINN.                                                ERCNETP
  4929                                                                  ERCNETP
  4930     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4931        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4932        (M GREATER THAN +63) AND                                  ERCNETP
  4933        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4934        NEXT SENTENCE                                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  89
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4935     ELSE                                                         ERCNETP
  4936        GO TO 12000-CHECK-MONTANA-TRUNC.                          ERCNETP
  4937                                                                  ERCNETP
  4938      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4939                                                                  ERCNETP
  4940      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4941                                                                  ERCNETP
  4942      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4943       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4944       (((N - ANGLEN) / I) + (2 * N)).                            ERCNETP
  4945                                                                  ERCNETP
  4946      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4947                                                                  ERCNETP
  4948     GO TO 99999-RETURN.                                          ERCNETP
  4949                                                                  ERCNETP
  4950 12000-CHECK-MONTANA-TRUNC.                                       ERCNETP
  4951                                                                  ERCNETP
  4952     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4953        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  4954        (M GREATER THAN +63) AND                                  ERCNETP
  4955        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4956        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4957        NEXT SENTENCE                                             ERCNETP
  4958     ELSE                                                         ERCNETP
  4959        GO TO 12000-CHECK-MONTANA.                                ERCNETP
  4960                                                                  ERCNETP
  4961      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4962      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4963                                                                  ERCNETP
  4964      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4965                                                                  ERCNETP
  4966      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                     ERCNETP
  4967      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4968       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).                 ERCNETP
  4969                                                                  ERCNETP
  4970      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4971                                                                  ERCNETP
  4972     GO TO 99999-RETURN.                                          ERCNETP
  4973                                                                  ERCNETP
  4974 12000-CHECK-MONTANA.                                             ERCNETP
  4975                                                                  ERCNETP
  4976     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4977        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  4978        (M GREATER THAN +63) AND                                  ERCNETP
  4979        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4980        NEXT SENTENCE                                             ERCNETP
  4981     ELSE                                                         ERCNETP
  4982        GO TO 12001-CONTINUE-NCL-TRUNC.                           ERCNETP
  4983                                                                  ERCNETP
  4984      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4985                                                                  ERCNETP
  4986      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4987                                                                  ERCNETP
  4988      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4989       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4990       (((N - ANGLEN) / I) + (4 * N)).                            ERCNETP
  4991                                                                  ERCNETP
  4992      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  90
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4993                                                                  ERCNETP
  4994     GO TO 99999-RETURN.                                          ERCNETP
  4995                                                                  ERCNETP
  4996 12001-CONTINUE-NCL-TRUNC.                                        ERCNETP
  4997                                                                  ERCNETP
  4998     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4999        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5000        (CP-TRUNCATED-LIFE)                                       ERCNETP
  5001        NEXT SENTENCE                                             ERCNETP
  5002     ELSE                                                         ERCNETP
  5003        GO TO 12001-CONTINUE-NCL.                                 ERCNETP
  5004                                                                  ERCNETP
  5005      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  5006      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  5007                                                                  ERCNETP
  5008      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  5009                                                                  ERCNETP
  5010      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *                ERCNETP
  5011      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /     ERCNETP
  5012      (ANGLEN-1 * (N + 1) * I).                                   ERCNETP
  5013                                                                  ERCNETP
  5014      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  5015                                                                  ERCNETP
  5016     GO TO 99999-RETURN.                                          ERCNETP
  5017                                                                  ERCNETP
  5018 12001-CONTINUE-NCL.                                              ERCNETP
  5019                                                                  ERCNETP
  5020     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  5021        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  5022        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5023        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  5024                                                                  ERCNETP
  5025     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  5026        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  5027        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5028        GO TO 12001-CHECK-CA.                                     ERCNETP
  5029                                                                  ERCNETP
  5030     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  5031        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5032        NEXT SENTENCE                                             ERCNETP
  5033     ELSE                                                         ERCNETP
  5034        GO TO 12000-CONTINUE-NET.                                 ERCNETP
  5035                                                                  ERCNETP
  5036      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  5037      MOVE ANGLEN                TO ANGLEN-1.                     ERCNETP
  5038                                                                  ERCNETP
  5039      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  5040                                                                  ERCNETP
  5041      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  5042       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  5043       ((N - ANGLEN) / I).                                        ERCNETP
  5044                                                                  ERCNETP
  5045      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  5046                                                                  ERCNETP
  5047     GO TO 99999-RETURN.                                          ERCNETP
  5048                                                                  ERCNETP
  5049 12000-CONTINUE-NET.                                              ERCNETP
  5050                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  91
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5051     IF (CP-COMPANY-ID EQUAL 'TMS') AND                           ERCNETP
  5052        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND       ERCNETP
  5053        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5054        NEXT SENTENCE                                             ERCNETP
  5055     ELSE                                                         ERCNETP
  5056        GO TO 12001-CONTINUE-MINN.                                ERCNETP
  5057                                                                  ERCNETP
  5058      COMPUTE ANGLEN EQUAL WK6 / I.                               ERCNETP
  5059      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).    ERCNETP
  5060                                                                  ERCNETP
  5061      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).             ERCNETP
  5062      COMPUTE WK3 EQUAL (M  * WK7) - 1.                           ERCNETP
  5063      COMPUTE WK3 EQUAL (WK3 / I) *                               ERCNETP
  5064       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).         ERCNETP
  5065                                                                  ERCNETP
  5066      IF CP-R-MAX-TOT-BEN NOT NUMERIC                             ERCNETP
  5067         MOVE +0 TO CP-R-MAX-TOT-BEN.                             ERCNETP
  5068                                                                  ERCNETP
  5069      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)               ERCNETP
  5070                                                                  ERCNETP
  5071      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND  ERCNETP
  5072         (CP-R-MAX-TOT-BEN NOT EQUAL +0)                          ERCNETP
  5073         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).              ERCNETP
  5074                                                                  ERCNETP
  5075      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  5076                                                                  ERCNETP
  5077     GO TO 99999-RETURN.                                          ERCNETP
  5078                                                                  ERCNETP
  5079 12001-CONTINUE-MINN.                                             ERCNETP
  5080                                                                  ERCNETP
  5081     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  5082        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND                       ERCNETP
  5083        (CP-TRUNCATED-LIFE)                                       ERCNETP
  5084        NEXT SENTENCE                                             ERCNETP
  5085     ELSE                                                         ERCNETP
  5086        GO TO 12001-CHECK-RI-GTL.                                 ERCNETP
  5087                                                                  ERCNETP
  5088      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  5089      COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  5090                                                                  ERCNETP
  5091      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /                      ERCNETP
  5092       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE     ERCNETP
  5093       * M / 2400) * 1000 + .5) / 1000000.                        ERCNETP
  5094                                                                  ERCNETP
  5095      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT    ERCNETP
  5096       - CP-ORIGINAL-PREMIUM) / (1 - WK3).                        ERCNETP
  5097                                                                  ERCNETP
  5098     GO TO 99999-RETURN.                                          ERCNETP
  5099                                                                  ERCNETP
  5100 12001-CHECK-RI-GTL.                                              ERCNETP
  5101                                                                  ERCNETP
  5102     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  5103        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  5104        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5105        NEXT SENTENCE                                             ERCNETP
  5106     ELSE                                                         ERCNETP
  5107        GO TO 12001-CHECK-RI-LEASE-GTL.                           ERCNETP
  5108                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  92
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5109      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  5110*     COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  5111                                                                  ERCNETP
  5112      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *                     ERCNETP
  5113               (1 + WS-WORK-DIS-RATE * N).                        ERCNETP
  5114      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *         ERCNETP
  5115         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.    ERCNETP
  5116                                                                  ERCNETP
  5117                                                                  ERCNETP
  5118     GO TO 99999-RETURN.                                          ERCNETP
  5119                                                                  ERCNETP
  5120 12001-CHECK-RI-LEASE-GTL.                                        ERCNETP
  5121                                                                  ERCNETP
  5122     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  5123        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  5124        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  5125        NEXT SENTENCE                                             ERCNETP
  5126     ELSE                                                         ERCNETP
  5127        GO TO 12001-CHECK-OR-GTL.                                 ERCNETP
  5128                                                                  ERCNETP
  5129     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5130                                                                  ERCNETP
  5131     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *            ERCNETP
  5132        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))             ERCNETP
  5133                        /                                         ERCNETP
  5134        (1000 * I * (1 + .0021 * N)).                             ERCNETP
  5135     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +                          ERCNETP
  5136       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))         ERCNETP
  5137                            /                                     ERCNETP
  5138       (1000 * (1 + .0027 * (N + 1))).                            ERCNETP
  5139                                                                  ERCNETP
  5140     GO TO 99999-RETURN.                                          ERCNETP
  5141                                                                  ERCNETP
  5142 12001-CHECK-OR-GTL.                                              ERCNETP
  5143                                                                  ERCNETP
  5144     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  5145        (CP-STATE-STD-ABBRV EQUAL 'OR') AND                       ERCNETP
  5146        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5147        NEXT SENTENCE                                             ERCNETP
  5148     ELSE                                                         ERCNETP
  5149        GO TO 12001-CHECK-GA-GTL.                                 ERCNETP
  5150                                                                  ERCNETP
  5151     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5152     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5153                                                                  ERCNETP
  5154     IF M LESS THAN +64                                           ERCNETP
  5155        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  5156         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))               ERCNETP
  5157                   /                                              ERCNETP
  5158         (I * ANGLEN * (N - (N - M) + 1) * 600)                   ERCNETP
  5159        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT   ERCNETP
  5160     ELSE                                                         ERCNETP
  5161        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  5162        CP-PREMIUM-RATE * (1 + I))                                ERCNETP
  5163                  /                                               ERCNETP
  5164        (+1000 * I * ANGLEN)                                      ERCNETP
  5165        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.  ERCNETP
  5166*    MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  93
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5167     GO TO 99999-RETURN.                                          ERCNETP
  5168                                                                  ERCNETP
  5169 12001-CHECK-GA-GTL.                                              ERCNETP
  5170                                                                  ERCNETP
  5171     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  5172        (CP-STATE-STD-ABBRV EQUAL 'GA') AND                       ERCNETP
  5173        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5174*       (CP-TRUNCATED-LIFE)                                       ERCNETP
  5175        NEXT SENTENCE                                             ERCNETP
  5176     ELSE                                                         ERCNETP
  5177        GO TO 12001-CHECK-MA-GTL.                                 ERCNETP
  5178                                                                  ERCNETP
  5179     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5180     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5181                                                                  ERCNETP
  5182     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.              ERCNETP
  5183     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *          ERCNETP
  5184      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).              ERCNETP
  5185     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  5186                                                                  ERCNETP
  5187     GO TO 99999-RETURN.                                          ERCNETP
  5188                                                                  ERCNETP
  5189 12001-CHECK-MA-GTL.                                              ERCNETP
  5190                                                                  ERCNETP
  5191     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  5192        (CP-STATE-STD-ABBRV EQUAL 'MA') AND                       ERCNETP
  5193        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5194        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  5195        NEXT SENTENCE                                             ERCNETP
  5196     ELSE                                                         ERCNETP
  5197        GO TO 12001-CHECK-NV-NET.                                 ERCNETP
  5198                                                                  ERCNETP
  5199     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5200                                                                  ERCNETP
  5201     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *                ERCNETP
  5202      CP-ALTERNATE-BENEFIT * N.                                   ERCNETP
  5203                                                                  ERCNETP
  5204     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /              ERCNETP
  5205     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).     ERCNETP
  5206                                                                  ERCNETP
  5207     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *          ERCNETP
  5208     WK7 * (N - ANGLEN) / I.                                      ERCNETP
  5209     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  5210                                                                  ERCNETP
  5211     GO TO 99999-RETURN.                                          ERCNETP
  5212                                                                  ERCNETP
  5213 12001-CHECK-NV-NET.                                              ERCNETP
  5214
  5215     IF (CP-COMPANY-ID EQUAL 'CID')
  5216        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  5217        AND (CP-EARN-AS-NET-PAY)
  5218        CONTINUE
  5219     ELSE
  5220        GO TO 12001-CHECK-MN-NET
  5221     END-IF
  5222
  5223     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5224     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  94
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5225
  5226     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5227                   / (1 + I)
  5228
  5229     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5230
  5231     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5232
  5233     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5234        (CP-PREMIUM-RATE * K-I / 1000)
  5235
  5236     MOVE WK3                    TO CP-CALC-PREMIUM
  5237
  5238     GO TO 99999-RETURN
  5239
  5240      .
  5241 12001-CHECK-MN-NET.
  5242
  5243     IF (CP-COMPANY-ID EQUAL 'CID')
  5244        AND (CP-STATE-STD-ABBRV = 'MN')
  5245        AND (CP-EARN-AS-NET-PAY)
  5246        AND (NOT CP-LEVEL-LIFE)
  5247        AND (WS-DISCOUNT-OPTION = '1')
  5248        CONTINUE
  5249     ELSE
  5250        GO TO 12001-CHECK-NC-NET
  5251     END-IF
  5252
  5253     if i = .0000000001
  5254        compute wk4 = cp-original-benefit / n
  5255        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  5256           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  5257        move wk3 to cp-calc-premium
  5258        go to 99999-return
  5259     end-if
  5260
  5261     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5262     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5263
  5264     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5265                   / (1 + I)
  5266
  5267     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5268
  5269     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5270
  5271     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5272        (CP-PREMIUM-RATE / 1000) * (1 + I)
  5273
  5274     MOVE WK3                    TO CP-CALC-PREMIUM
  5275
  5276     GO TO 99999-RETURN
  5277
  5278      .
  5279 12001-CHECK-NC-NET.                                              ERCNETP
  5280                                                                  ERCNETP
  5281     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND                          ERCNETP
  5282        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  95
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5283        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5284        NEXT SENTENCE                                             ERCNETP
  5285     ELSE                                                         ERCNETP
  5286        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  5287                                                                  ERCNETP
  5288      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  5289      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  5290                                                                  ERCNETP
  5291      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /                 ERCNETP
  5292          (ANGLEN - (CP-PREMIUM-RATE / 1000) *                    ERCNETP
  5293          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -               ERCNETP
  5294          N * (CP-PREMIUM-RATE / 1000)).                          ERCNETP
  5295                                                                  ERCNETP
  5296      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *      ERCNETP
  5297          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).                ERCNETP
  5298                                                                  ERCNETP
  5299      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *       ERCNETP
  5300          ((N - ANGLEN) / I + 3) / ANGLEN) /                      ERCNETP
  5301          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /           ERCNETP
  5302          (ANGLEN * 2))                                           ERCNETP
  5303                                                                  ERCNETP
  5304      COMPUTE WK7 ROUNDED = WK7 * N - 3.                          ERCNETP
  5305                                                                  ERCNETP
  5306      IF ANGLEN IS NOT LESS THAN WK7                              ERCNETP
  5307          COMPUTE CP-PREMIUM-RATE ROUNDED =                       ERCNETP
  5308              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)          ERCNETP
  5309          COMPUTE WK3 ROUNDED =                                   ERCNETP
  5310              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).            ERCNETP
  5311                                                                  ERCNETP
  5312     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  5313                                                                  ERCNETP
  5314     GO TO 99999-RETURN.                                          ERCNETP
  5315                                                                  ERCNETP
  5316 12001-CHECK-NC-NET-PLUS3.                                        ERCNETP
  5317                                                                  ERCNETP
  5318     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5319        (CP-EARN-AS-NET-PAY) AND
  5320        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL' AND 'VPP')
  5321        NEXT SENTENCE
  5322     ELSE
  5323        GO TO 12001-CHECK-CA.
  5324                                                                  ERCNETP
  5325     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  5326     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  5327     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  5328                                                                  ERCNETP
  5329     IF DATE-CONVERSION-ERROR                                     ERCNETP
  5330        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  5331        MOVE ZEROS               TO FACTOR                        ERCNETP
  5332                                    CP-CALC-PREMIUM               ERCNETP
  5333         GO TO 99999-RETURN.                                      ERCNETP
  5334                                                                  ERCNETP
  5335     IF DC-GREG-DATE-CYMD GREATER THAN 19931231                      CL**4
  5336        NEXT SENTENCE                                             ERCNETP
  5337     ELSE                                                         ERCNETP
  5338        GO TO 12001-CONTINUE-NET.                                 ERCNETP
  5339                                                                  ERCNETP
  5340     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  96
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5341     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5342                                                                  ERCNETP
  5343     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).     ERCNETP
  5344                                                                  ERCNETP
  5345     COMPUTE NC-R = 20 *                                          ERCNETP
  5346                    ((NC-LR * ORIGINAL-TERM) / 12)                ERCNETP
  5347                          / (ORIGINAL-TERM + 1).                  ERCNETP
  5348                                                                  ERCNETP
  5349     COMPUTE NC-OB = NC-R / 1000.                                 ERCNETP
  5350                                                                  ERCNETP
  5351     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +    ERCNETP
  5352                    (NC-OB * ORIGINAL-TERM * 3).                  ERCNETP
  5353                                                                  ERCNETP
  5354     IF CP-EXT-CHG-LF                                             ERCNETP
  5355         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30              ERCNETP
  5356     ELSE                                                         ERCNETP
  5357         MOVE 30                 TO  NC-BIG-D.                    ERCNETP
  5358                                                                  ERCNETP
  5359     COMPUTE NC-LITTLE-D = (1 + I) /                              ERCNETP
  5360             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).            ERCNETP
  5361                                                                  ERCNETP
  5362     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /               ERCNETP
  5363             (ANGLEN * NC-LITTLE-D ).                             ERCNETP
  5364                                                                  ERCNETP
  5365     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.              ERCNETP
  5366                                                                  ERCNETP
  5367     GO TO 99999-RETURN.                                          ERCNETP
  5368                                                                  ERCNETP
  5369 12001-CHECK-CA.                                                  ERCNETP
  5370                                                                  ERCNETP
  5371     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  5372        (WS-DISCOUNT-OPTION = '6')                                ERCNETP
  5373        NEXT SENTENCE                                             ERCNETP
  5374     ELSE                                                         ERCNETP
  5375        GO TO 12001-CHECK-GTL-IA.                                 ERCNETP
  5376                                                                  ERCNETP
  5377     COMPUTE CA-J = CA-DISCOUNT / 12.                             ERCNETP
  5378     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5379     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.               ERCNETP
  5380     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.        ERCNETP
  5381     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.  ERCNETP
  5382     COMPUTE CA-VI = (1 + I)** -1.                                ERCNETP
  5383     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  5384         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *   ERCNETP
  5385         ((1 + CA-J) / I) *                                       ERCNETP
  5386         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *                 ERCNETP
  5387         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /                ERCNETP
  5388         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).    ERCNETP
  5389                                                                  ERCNETP
  5390     GO TO 99999-RETURN.                                          ERCNETP
  5391                                                                  ERCNETP
  5392 12001-CHECK-GTL-IA.                                              ERCNETP
  5393                                                                  ERCNETP
  5394     IF (CP-COMPANY-ID EQUAL 'GTL')     AND                       ERCNETP
  5395        (CP-STATE-STD-ABBRV EQUAL 'IA') AND                       ERCNETP
  5396        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5397        NEXT SENTENCE                                             ERCNETP
  5398     ELSE                                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  97
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5399        GO TO 12001-CHECK-CID-TRN-VA.                             ERCNETP
  5400                                                                  ERCNETP
  5401***************************************************************   ERCNETP
  5402                                                                  ERCNETP
  5403     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.           ERCNETP
  5404                                                                  ERCNETP
  5405     IF GTL-IA-ODD-DAYS = ZEROS                                   ERCNETP
  5406         MOVE ZERO               TO  GTL-IA-SGN                   ERCNETP
  5407     ELSE                                                         ERCNETP
  5408         IF GTL-IA-ODD-DAYS GREATER THAN ZERO                     ERCNETP
  5409             MOVE +1             TO  GTL-IA-SGN                   ERCNETP
  5410         ELSE                                                     ERCNETP
  5411             MOVE -1             TO  GTL-IA-SGN.                  ERCNETP
  5412                                                                  ERCNETP
  5413     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.                  ERCNETP
  5414     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.                        ERCNETP
  5415                                                                  ERCNETP
  5416     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **            ERCNETP
  5417                          GTL-IA-SGN.                             ERCNETP
  5418                                                                  ERCNETP
  5419     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5420     COMPUTE ANGLEN-M EQUAL WK5 / I.                                 CL**3
  5421                                                                  ERCNETP
  5422     IF GTL-IA-ODF NOT = ZERO                                     ERCNETP
  5423         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF                    CL**3
  5424         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.               CL**3
  5425                                                                  ERCNETP
  5426     COMPUTE GTL-IA-DIVIDEND =                                       CL**3
  5427           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -                    CL**3
  5428                             (ANGLEN - ANGLEN-M))) *                 CL**3
  5429           ((K1 + I) * CP-PREMIUM-RATE *                             CL**3
  5430                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).            CL**3
  5431                                                                     CL**3
  5432     COMPUTE GTL-IA-DIVISOR =                                     ERCNETP
  5433      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.    CL**3
  5434                                                                     CL**3
  5435     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.    ERCNETP
  5436                                                                     CL**3
  5437     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  5438                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.   ERCNETP
  5439     GO TO 99999-RETURN.                                          ERCNETP
  5440                                                                  ERCNETP
  5441                                                                  ERCNETP
  5442 12001-CHECK-CID-TRN-VA.                                          ERCNETP
  5443                                                                  ERCNETP
  5444     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5445        (CP-STATE-STD-ABBRV EQUAL 'VA') AND                       ERCNETP
  5446        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5447        (CP-TRUNCATED-LIFE) AND
  5448        (CP-STATE-STD-ABBRV = CP-STATE)
  5449        CONTINUE                                                  ERCNETP
  5450     ELSE                                                         ERCNETP
  5451        GO TO 12001-CHECK-CID-TX
  5452     END-IF
  5453
  5454     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5455     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5456     IF WS-WORK-DIS-RATE = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  98
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5457        CONTINUE
  5458     ELSE
  5459        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5460        COMPUTE WK7 = (1 / I) *
  5461              (((WK4 ** M - 1) / (WK4 - 1)) -
  5462              ((WK4 ** M * SX - VX) /
  5463              (WK4 * (1 + I) - 1))) *
  5464              (CP-PREMIUM-RATE / 1000)
  5465        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5466        COMPUTE WK8 = WK7 * 100 / ANGLEN
  5467        COMPUTE CP-CALC-PREMIUM =
  5468           WK8 *  ((WK4 * ANGLEN) / 100)
  5469     END-IF
  5470
  5471     GO TO 99999-RETURN                                           ERCNETP
  5472
  5473     .                                                            ERCNETP
  5474                                                                  ERCNETP
  5475 12001-CHECK-CID-TX.
  5476
  5477     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5478        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  5479        (CP-EARN-AS-NET-PAY) AND
  5480        (WS-WORK-DIS-RATE > ZEROS) AND
  5481        (CP-STATE-STD-ABBRV = CP-STATE)
  5482        CONTINUE
  5483     ELSE
  5484        GO TO 12001-CHECK-CID-LEV-MN-NEW
  5485     END-IF
  5486* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  5487     COMPUTE K-I = 1 + (1 * I)
  5488     COMPUTE ANGLEm EQUAL WK1 / I   *>   Loan term
  5489     COMPUTE ANGLEn EQUAL WK2 / I   *>   Ins  term
  5490
  5491     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  5492
  5493     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  5494     COMPUTE ANGLEmy = ANGLEm / Y
  5495
  5496     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5497     IF WS-WORK-DIS-RATE = ZEROS
  5498        CONTINUE
  5499     ELSE
  5500        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5501        COMPUTE WK7 = (K-I / I) *
  5502              (((WK4 ** M - 1) / (WK4 - 1)) -
  5503*             ((WK4 ** M * SX - VX) /
  5504              ((WK4 ** M * SX) - VX) /
  5505*             (WK4 * (1 + I) - 1))) *
  5506              (WK4 * (1 + I) - 1)) *
  5507              (CP-PREMIUM-RATE / 1000)
  5508        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEmy
  5509        COMPUTE WK8 = (WK7 * 100) / (ANGLEmy * K-I)
  5510        COMPUTE CP-CALC-PREMIUM =
  5511           WK8 *  ((WK4 * ANGLEmy * K-I) / 100)
  5512     END-IF
  5513
  5514     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page  99
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5515
  5516     .
  5517 12001-CHECK-CID-LEV-MN-NEW.
  5518
  5519*    IF (CP-COMPANY-ID EQUAL 'CID')
  5520*       AND (CP-STATE-STD-ABBRV = 'MN')
  5521*       AND (CP-EARN-AS-NET-PAY)
  5522*       AND (CP-LEVEL-LIFE)
  5523*       AND (CP-CERT-EFF-DT > X'A4FF')
  5524*       CONTINUE
  5525*    ELSE
  5526*       GO TO 12001-CHECK-CID-LEV-MN
  5527*    END-IF
  5528*
  5529*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5530*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  5531*    MOVE '1'                    TO DC-OPTION-CODE
  5532*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  5533*
  5534*    IF DATE-CONVERSION-ERROR
  5535*       MOVE '2'                 TO CP-RETURN-CODE
  5536*       MOVE ZEROS               TO FACTOR
  5537*                                   CP-CALC-PREMIUM
  5538*       GO TO 99999-RETURN
  5539*    END-IF
  5540*
  5541*    COMPUTE I = CP-LOAN-APR / 100
  5542*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  5543*
  5544*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  5545*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  5546*      * 12 / 360 * D)
  5547*
  5548*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  5549*       * 12 / 360 * D
  5550*
  5551*    GO TO 99999-RETURN
  5552
  5553      .
  5554 12001-CHECK-CID-LEV-MN.                                          ERCNETP
  5555                                                                  ERCNETP
  5556     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5557        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  5558        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5559        (CP-LEVEL-LIFE) AND
  5560        (CP-STATE-STD-ABBRV = CP-STATE)
  5561        CONTINUE                                                  ERCNETP
  5562     ELSE                                                         ERCNETP
  5563        GO TO 12001-CHECK-CID-LEV-CA                              ERCNETP
  5564     END-IF
  5565
  5566     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  5567         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  5568         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  5569
  5570     GO TO 99999-RETURN                                           ERCNETP
  5571
  5572      .
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 100
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5573 12001-CHECK-CID-LEV-CA.                                          ERCNETP
  5574                                                                  ERCNETP
  5575     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5576        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  5577        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5578        (CP-LEVEL-LIFE) AND
  5579        (CP-STATE-STD-ABBRV = CP-STATE)
  5580        CONTINUE                                                  ERCNETP
  5581     ELSE                                                         ERCNETP
  5582        GO TO 12001-CHECK-CID-TRN-CA                              ERCNETP
  5583     END-IF
  5584
  5585     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  5586     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  5587     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  5588     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  5589     COMPUTE CP-CALC-PREMIUM =
  5590          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  5591          (CP-PREMIUM-RATE / 1000)) /
  5592          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  5593
  5594     GO TO 99999-RETURN                                           ERCNETP
  5595
  5596      .
  5597 12001-CHECK-CID-TRN-CA.                                          ERCNETP
  5598                                                                  ERCNETP
  5599     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5600        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  5601        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5602        (CP-TRUNCATED-LIFE) AND
  5603        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5604        (WS-DISCOUNT-OPTION NOT = ' ')
  5605        CONTINUE                                                  ERCNETP
  5606     ELSE                                                         ERCNETP
  5607        GO TO 12001-CHECK-CID-TRN-MT                              ERCNETP
  5608     END-IF
  5609
  5610     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5611     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5612     IF WS-WORK-DIS-RATE = ZEROS
  5613        CONTINUE
  5614     ELSE
  5615        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5616        COMPUTE WK7 = (1 / I) *
  5617              (((WK4 ** M - 1) / (WK4 - 1)) -
  5618              ((WK4 ** M * SX - VX) /
  5619              (WK4 * (1 + I) - 1))) *
  5620              (CP-PREMIUM-RATE / 1000)
  5621        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5622        COMPUTE CP-CALC-PREMIUM =
  5623           WK4 *  WK7
  5624     END-IF
  5625
  5626     GO TO 99999-RETURN                                           ERCNETP
  5627
  5628      .
  5629 12001-CHECK-CID-TRN-MT.                                          ERCNETP
  5630                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 101
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5631     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5632        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  5633                   OR
  5634        ((CP-STATE-STD-ABBRV = 'IN') AND
  5635        (CP-CERT-EFF-DT > X'9A7F'))
  5636                   OR
  5637        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5638        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5639        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5640        (CP-TRUNCATED-LIFE) AND
  5641        (CP-STATE-STD-ABBRV = CP-STATE)
  5642        CONTINUE                                                  ERCNETP
  5643     ELSE                                                         ERCNETP
  5644        GO TO 12001-CHECK-CID-MT                                  ERCNETP
  5645     END-IF
  5646
  5647* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5648     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5649        MOVE 0                   TO K-I
  5650     ELSE
  5651        MOVE 2                   TO K-I
  5652     END-IF
  5653     COMPUTE CP-TERM-OR-EXT-DAYS =
  5654           CP-TERM-OR-EXT-DAYS + 30
  5655
  5656     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5657     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5658     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5659                   / (1 + I)
  5660     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5661     IF WS-WORK-DIS-RATE = ZEROS
  5662        CONTINUE
  5663     ELSE
  5664        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5665*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5666        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5667              (((WK4 ** M - 1) / (WK4 - 1)) -
  5668              ((WK4 ** M * SX - VX) /
  5669              (WK4 * (1 + I) - 1))) *
  5670              (CP-PREMIUM-RATE / 1000)
  5671        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5672*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5673        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5674        COMPUTE CP-CALC-PREMIUM =
  5675           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5676*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5677     END-IF
  5678
  5679     GO TO 99999-RETURN                                           ERCNETP
  5680
  5681     .                                                            ERCNETP
  5682 12001-CHECK-CID-MT.                                              ERCNETP
  5683                                                                  ERCNETP
  5684     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5685        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5686                                OR 'VT')
  5687                   OR
  5688        ((CP-STATE-STD-ABBRV = 'IN') AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 102
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5689        (CP-CERT-EFF-DT > X'9A7F'))
  5690                   OR
  5691        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5692        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5693        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5694        (CP-STATE-STD-ABBRV = CP-STATE)
  5695        CONTINUE                                                  ERCNETP
  5696     ELSE                                                         ERCNETP
  5697        GO TO 12001-CHECK-DCC-DD
  5698     END-IF
  5699
  5700     COMPUTE CP-TERM-OR-EXT-DAYS =
  5701           CP-TERM-OR-EXT-DAYS + 30
  5702
  5703* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5704     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5705        MOVE 0                   TO K-I
  5706     ELSE
  5707        IF CP-STATE-STD-ABBRV = 'NJ'
  5708           MOVE 1                TO K-I
  5709        ELSE
  5710           MOVE 2                TO K-I
  5711        END-IF
  5712     END-IF
  5713     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5714     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5715     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5716                   / (1 + I)
  5717     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5718     IF WS-WORK-DIS-RATE = ZEROS
  5719        CONTINUE
  5720     ELSE
  5721        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5722*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5723        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5724              (((WK4 ** N - 1) / (WK4 - 1)) -
  5725              ((WK4 ** N - SV) /
  5726              (WK4 * (1 + I) - 1))) *
  5727              (CP-PREMIUM-RATE / 1000)
  5728        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5729*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5730        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5731        COMPUTE CP-CALC-PREMIUM =
  5732           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5733*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5734     END-IF
  5735
  5736     GO TO 99999-RETURN                                           ERCNETP
  5737
  5738     .                                                            ERCNETP
  5739
  5740 12001-CHECK-DCC-DD.
  5741
  5742     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5743        AND (CP-EARN-AS-NET-PAY)
  5744        AND (CP-BEN-CATEGORY = 'D')
  5745        CONTINUE
  5746     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 103
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5747        GO TO 12001-CHECK-DCC-NET
  5748     END-IF
  5749
  5750     COMPUTE CP-TERM-OR-EXT-DAYS =
  5751           CP-TERM-OR-EXT-DAYS + 30
  5752
  5753     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5754     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  5755     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5756                                                                  ERCNETP
  5757     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5758           / (1 + I)
  5759
  5760     COMPUTE GR     = ANGLEN / ODF
  5761*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5762*      CP-RATE-DEV-PCT
  5763
  5764     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5765
  5766     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5767       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5768     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5769     MOVE WK3                    TO CP-CALC-PREMIUM
  5770
  5771     GO TO 99999-RETURN                                           ERCNETP
  5772
  5773     .                                                            ERCNETP
  5774
  5775 12001-CHECK-DCC-NET.                                             ERCNETP
  5776                                                                  ERCNETP
  5777     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5778        AND (CP-EARN-AS-NET-PAY)
  5779        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5780             AND 'H' AND 'S' AND 'P')
  5781        CONTINUE                                                  ERCNETP
  5782     ELSE                                                         ERCNETP
  5783        GO TO 12001-CHECK-DCC-PNET                                ERCNETP
  5784     END-IF
  5785
  5786     COMPUTE CP-TERM-OR-EXT-DAYS =
  5787           CP-TERM-OR-EXT-DAYS + 30
  5788
  5789     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5790     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  5791     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5792                                                                  ERCNETP
  5793     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5794           / (1 + I)
  5795
  5796     COMPUTE GR     = ANGLEN / ODF
  5797     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5798     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5799       CP-RATE-DEV-PCT
  5800     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5801*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5802
  5803     COMPUTE WK8 = CP-PREMIUM-RATE *
  5804        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 104
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5805     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5806     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5807     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5808       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5809     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5810     MOVE WK3                    TO CP-CALC-PREMIUM
  5811
  5812     GO TO 99999-RETURN                                           ERCNETP
  5813
  5814     .                                                            ERCNETP
  5815 12001-CHECK-DCC-PNET.                                            ERCNETP
  5816
  5817     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5818        AND (CP-EARN-AS-NET-PAY)
  5819        AND (CP-BENEFIT-CD (1:1) = 'P')
  5820        CONTINUE                                                  ERCNETP
  5821     ELSE                                                         ERCNETP
  5822        GO TO 12001-CHECK-DCC-MNET                                ERCNETP
  5823     END-IF
  5824
  5825     IF CP-NO-OF-PMTS NOT NUMERIC
  5826        MOVE +0                  TO CP-NO-OF-PMTS
  5827     END-IF
  5828     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5829        AND ' ' AND 'M'
  5830        MOVE ' '                 TO CP-PMT-MODE
  5831     END-IF
  5832
  5833******************************************************************
  5834***   Default is monthly, use loan term for rate and amort     ***
  5835******************************************************************
  5836     move cp-loan-term         to c-tot-pmts
  5837     MOVE +30                  TO C-DAYS-IN-PMT-PER
  5838     MOVE +12                  TO C-PMTS-PER-YEAR
  5839******************************************************************
  5840
  5841     evaluate true
  5842        when cp-pmt-mode = 'W'
  5843           MOVE +52              TO C-PMTS-PER-YEAR
  5844           compute c-tot-pmts = cp-loan-term /
  5845              12 * c-pmts-per-year
  5846           MOVE +7               TO C-DAYS-IN-PMT-PER
  5847        when cp-pmt-mode = 'B'
  5848           MOVE +26              TO C-PMTS-PER-YEAR
  5849           compute c-tot-pmts = cp-loan-term /
  5850              12 * c-pmts-per-year
  5851           MOVE +14              TO C-DAYS-IN-PMT-PER
  5852     end-evaluate
  5853
  5854     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5855
  5856     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5857        C-DAYS-IN-PMT-PER)) / (1 + I)
  5858
  5859     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  5860*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5861     COMPUTE ANGLEN-1 = ANGLEN / Y
  5862
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 105
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5863     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5864
  5865     IF CP-RATE-DEV-PCT NOT = ZEROS
  5866        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5867           CP-PREMIUM-RATE
  5868     END-IF
  5869
  5870     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5871
  5872     GO TO 99999-RETURN
  5873
  5874     .                                                            ERCNETP
  5875 12001-CHECK-DCC-MNET.                                            ERCNETP
  5876                                                                  ERCNETP
  5877     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5878        AND (CP-EARN-AS-NET-PAY)
  5879        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5880        CONTINUE                                                  ERCNETP
  5881     ELSE                                                         ERCNETP
  5882        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5883     END-IF
  5884
  5885*    COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5886*    COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  5887*    COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5888                                                                  ERCNETP
  5889     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5890     MOVE WK3                    TO CP-CALC-PREMIUM
  5891
  5892     GO TO 99999-RETURN                                           ERCNETP
  5893
  5894     .                                                            ERCNETP
  5895 12001-CHECK-DCC-MNET-LF-BAL.
  5896                                                                  ERCNETP
  5897     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5898        AND (CP-EARN-AS-NET-PAY)
  5899        AND (CP-BENEFIT-CD (1:1) = 'N')
  5900        AND (CP-BEN-CATEGORY NOT = 'N')
  5901        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5902        CONTINUE                                                  ERCNETP
  5903     ELSE                                                         ERCNETP
  5904        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5905     END-IF
  5906
  5907     IF CP-RATE-DEV-PCT NOT = ZEROS
  5908        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5909           CP-PREMIUM-RATE
  5910     END-IF
  5911
  5912*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5913     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5914        / (1 + I)
  5915     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5916     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5917     COMPUTE WK2 = (1 + J) ** (M * -1)
  5918     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5919
  5920     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 106
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5921          ** ((M - 1) * -1))) / J)
  5922
  5923     COMPUTE ANGLEM = ((1 - ((1 + J)
  5924          ** (M * -1))) / J) / OD
  5925
  5926     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5927        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5928        / ANGLEM-1
  5929
  5930     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5931          ** ((N - M) * -1))) / I)
  5932
  5933     MOVE +0                     TO WK3
  5934     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5935        (WS-COUNTER > M)
  5936        COMPUTE ANGLEM = (1 - ((1 + J)
  5937          ** ((M - WS-COUNTER) * -1))) / J
  5938        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5939        COMPUTE WK5-CSL = (RA * ANGLEM)
  5940        + (CP-ALTERNATE-BENEFIT * WK2)
  5941        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5942     END-PERFORM
  5943
  5944     MOVE WK3                    TO CP-CALC-PREMIUM
  5945
  5946     GO TO 99999-RETURN                                           ERCNETP
  5947
  5948     .                                                            ERCNETP
  5949 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5950                                                                  ERCNETP
  5951     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5952        AND (CP-EARN-AS-NET-PAY)
  5953        AND (CP-BENEFIT-CD (1:1) = 'S')
  5954        AND (CP-BEN-CATEGORY NOT = 'N')
  5955        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5956        CONTINUE                                                  ERCNETP
  5957     ELSE                                                         ERCNETP
  5958        GO TO 12001-CHECK-DCC-MNET-LF
  5959     END-IF
  5960
  5961     IF CP-RATE-DEV-PCT NOT = ZEROS
  5962        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5963           CP-PREMIUM-RATE
  5964     END-IF
  5965
  5966     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5967
  5968     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5969          ** ((M - 1) * -1))) / K)
  5970
  5971     COMPUTE ANGLEM = ((1 - ((1 + K)
  5972          ** (M * -1))) / K)
  5973
  5974     MOVE CP-MONTHLY-PAYMENT     TO RA
  5975
  5976     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5977        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5978        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 107
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5979        CP-PREMIUM-RATE / 1000
  5980
  5981     MOVE WK3                    TO CP-CALC-PREMIUM
  5982
  5983
  5984     GO TO 99999-RETURN                                           ERCNETP
  5985
  5986     .                                                            ERCNETP
  5987 12001-CHECK-DCC-MNET-LF.
  5988                                                                  ERCNETP
  5989     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5990        AND (CP-EARN-AS-NET-PAY)
  5991        AND (CP-BENEFIT-CD (1:1) = 'N')
  5992        AND (CP-BEN-CATEGORY NOT = 'N')
  5993        CONTINUE                                                  ERCNETP
  5994     ELSE                                                         ERCNETP
  5995        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5996     END-IF
  5997
  5998     IF CP-RATE-DEV-PCT NOT = ZEROS
  5999        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  6000           CP-PREMIUM-RATE
  6001     END-IF
  6002
  6003*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  6004     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  6005        / (1 + I)
  6006     COMPUTE ANGLEN-M = (WK5 / I) / OD
  6007     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  6008     COMPUTE WK2 = (1 + J) ** (M * -1)
  6009     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6010
  6011
  6012     COMPUTE ANGLEM = ((1 - ((1 + J)
  6013          ** (M * -1))) / J) / OD
  6014     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6015
  6016     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6017          ** ((N - M) * -1))) / I)
  6018
  6019     MOVE +0                     TO WK3
  6020     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  6021        (WS-COUNTER > M)
  6022        COMPUTE ANGLEM = (1 - ((1 + J)
  6023          ** ((M - WS-COUNTER + 1) * -1))) / J
  6024        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  6025        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  6026        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  6027     END-PERFORM
  6028
  6029     MOVE WK3                    TO CP-CALC-PREMIUM
  6030
  6031     GO TO 99999-RETURN                                           ERCNETP
  6032
  6033     .                                                            ERCNETP
  6034 12001-CHECK-DCC-MNET-SUMLF.
  6035                                                                  ERCNETP
  6036     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 108
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  6037        AND (CP-EARN-AS-NET-PAY)
  6038        AND (CP-BENEFIT-CD (1:1) = 'S')
  6039        AND (CP-BEN-CATEGORY NOT = 'N')
  6040        CONTINUE                                                  ERCNETP
  6041     ELSE                                                         ERCNETP
  6042        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  6043     END-IF
  6044
  6045     IF CP-RATE-DEV-PCT NOT = ZEROS
  6046        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  6047           CP-PREMIUM-RATE
  6048     END-IF
  6049
  6050     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  6051     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  6052        / (1 + K)
  6053
  6054     COMPUTE ANGLEN-M = (WK5 / I)
  6055     COMPUTE WK2 = (1 + K) ** (M * -1)
  6056     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6057     COMPUTE ANGLEN-M = ANGLEN-M / Y
  6058
  6059
  6060     COMPUTE ANGLEM = ((1 - ((1 + K)
  6061          ** (M * -1))) / K) / Y
  6062     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6063
  6064     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  6065        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  6066        - 1)) / K) * RA
  6067     COMPUTE WK7 = (((((M * (M + 1) / 2)
  6068        + (CP-DAYS-TO-1ST-PMT - +30)
  6069        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  6070        +0 / 1000 * 12 / 12)
  6071     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  6072        * (12 / 12)
  6073
  6074
  6075     MOVE WK3                    TO CP-CALC-PREMIUM
  6076
  6077     GO TO 99999-RETURN                                           ERCNETP
  6078
  6079     .                                                            ERCNETP
  6080 12001-CHECK-DCC-MNET-TOT-BAL-N.
  6081                                                                  ERCNETP
  6082     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6083        AND (CP-EARN-AS-NET-PAY)
  6084        AND (CP-BENEFIT-CD (1:1) = 'N')
  6085        AND (CP-BEN-CATEGORY = 'N')
  6086        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  6087        CONTINUE                                                  ERCNETP
  6088     ELSE                                                         ERCNETP
  6089        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  6090     END-IF
  6091
  6092*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  6093     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  6094        / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 109
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  6095     COMPUTE ANGLEN-M = (WK5 / I) / OD
  6096     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  6097     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  6098     COMPUTE WK2 = (1 + J) ** (M * -1)
  6099     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6100
  6101     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  6102          ** ((M - 1) * -1))) / J)
  6103
  6104     COMPUTE ANGLEM = ((1 - ((1 + J)
  6105          ** (M * -1))) / J) / OD
  6106
  6107     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  6108        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  6109        / ANGLEM-1
  6110
  6111     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6112          ** ((N - M) * -1))) / I)
  6113
  6114     MOVE +0                     TO WK3
  6115     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  6116        (WS-COUNTER > M)
  6117        COMPUTE ANGLEM = (1 - ((1 + J)
  6118          ** ((M - WS-COUNTER) * -1))) / J
  6119        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  6120        COMPUTE WK5-CSL = (RA * ANGLEM)
  6121        + (CP-ALTERNATE-BENEFIT * WK2)
  6122        COMPUTE WK3 = WK3 +
  6123         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  6124        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  6125          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  6126          (CP-DCC-AH-RATE / 1000)
  6127     END-PERFORM
  6128
  6129     MOVE WK3                    TO CP-CALC-PREMIUM
  6130
  6131     GO TO 99999-RETURN                                           ERCNETP
  6132
  6133     .                                                            ERCNETP
  6134 12001-CHECK-DCC-MNET-TOT-BAL-S.
  6135                                                                  ERCNETP
  6136     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6137        AND (CP-EARN-AS-NET-PAY)
  6138        AND (CP-BENEFIT-CD (1:1) = 'S')
  6139        AND (CP-BEN-CATEGORY = 'N')
  6140        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  6141        CONTINUE                                                  ERCNETP
  6142     ELSE                                                         ERCNETP
  6143        GO TO 12001-CHECK-DCC-MNET-TOT-N
  6144     END-IF
  6145
  6146
  6147     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  6148
  6149     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  6150          ** ((M - 1) * -1))) / K)
  6151
  6152     COMPUTE ANGLEM = ((1 - ((1 + K)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 110
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  6153          ** (M * -1))) / K)
  6154
  6155     MOVE CP-MONTHLY-PAYMENT     TO RA
  6156
  6157     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  6158        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  6159        * CP-DCC-AH-RATE / 1000))
  6160        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  6161        CP-DCC-LF-RATE / 1000
  6162
  6163     MOVE WK3                    TO CP-LF-PREM
  6164
  6165     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  6166        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  6167        * CP-DCC-AH-RATE / 1000
  6168
  6169     COMPUTE WK3 = WK3 + WK5-CSL
  6170
  6171
  6172     MOVE WK3                    TO CP-CALC-PREMIUM
  6173
  6174     GO TO 99999-RETURN                                           ERCNETP
  6175
  6176      .
  6177 12001-CHECK-DCC-MNET-TOT-N.
  6178                                                                  ERCNETP
  6179     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6180        AND (CP-EARN-AS-NET-PAY)
  6181        AND (CP-BENEFIT-CD (1:1) = 'N')
  6182        AND (CP-BEN-CATEGORY = 'N')
  6183        CONTINUE                                                  ERCNETP
  6184     ELSE                                                         ERCNETP
  6185        GO TO 12001-CHECK-DCC-MNET-TOT-S
  6186     END-IF
  6187
  6188*    I = APR/1200
  6189*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  6190*    RA = PAYMENT AMOUNT
  6191*    WK5-CSL = THE BALANCE (PAY OFF )
  6192*    WK3 = THE ACCUMULATED PREMIUM
  6193*    WK2 = (1 + I) ^ (m * -1)
  6194*    OD  = GAMMA
  6195*
  6196*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  6197     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  6198        / (1 + I)
  6199     COMPUTE ANGLEN-M = (WK5 / I) / OD
  6200     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  6201        (CP-DCC-AH-RATE / +1000)
  6202     COMPUTE WK2 = (1 + J) ** (M * -1)
  6203     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6204
  6205
  6206     COMPUTE ANGLEM = ((1 - ((1 + J)
  6207          ** (M * -1))) / J) / OD
  6208     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6209
  6210     COMPUTE ANGLEN-M = ((1 - ((1 + I)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 111
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  6211          ** ((N - M) * -1))) / I)
  6212
  6213     MOVE +0                     TO WK3
  6214     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  6215        (WS-COUNTER > M)
  6216        COMPUTE ANGLEM = (1 - ((1 + J)
  6217          ** ((M - WS-COUNTER + 1) * -1))) / J
  6218        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  6219        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  6220        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  6221           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  6222     END-PERFORM
  6223
  6224     MOVE WK3                    TO CP-CALC-PREMIUM
  6225
  6226     GO TO 99999-RETURN                                           ERCNETP
  6227
  6228     .                                                            ERCNETP
  6229 12001-CHECK-DCC-MNET-TOT-S.
  6230                                                                  ERCNETP
  6231     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6232        AND (CP-EARN-AS-NET-PAY)
  6233        AND (CP-BENEFIT-CD (1:1) = 'S')
  6234        AND (CP-BEN-CATEGORY = 'N')
  6235        CONTINUE                                                  ERCNETP
  6236     ELSE                                                         ERCNETP
  6237        GO TO 12001-CONTINUE-NET
  6238     END-IF
  6239
  6240*    I = APR/1200
  6241*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  6242*    RA = PAYMENT AMOUNT
  6243*    WK5-CSL = THE BALANCE (PAY OFF )
  6244*    WK3 = THE ACCUMULATED PREMIUM
  6245*    WK2 = (1 + I) ^ (m * -1)
  6246*    OD  = GAMMA
  6247*
  6248     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  6249
  6250     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  6251        / (1 + J)
  6252
  6253     COMPUTE ANGLEM = ((1 - ((1 + J)
  6254          ** (M * -1))) / J) / OD
  6255
  6256     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6257          ** ((N - M) * -1))) / I)
  6258          * (1 + J) ** (-1 * M)
  6259
  6260     COMPUTE ANGLEN-M = ANGLEN-M / OD
  6261
  6262     MOVE CP-MONTHLY-PAYMENT     TO RA
  6263
  6264     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  6265        / +30)
  6266     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  6267        ** (WK1) - 1)) / J) * RA
  6268
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 112
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  6269     COMPUTE WK5 = (((((M * (M + 1) / 2)
  6270        + (CP-DAYS-TO-1ST-PMT - +30)
  6271        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  6272        CP-DCC-AH-RATE / +1000 * 12 / 12)
  6273
  6274     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  6275        (12 / 12)
  6276
  6277     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  6278        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  6279        (CP-DCC-AH-RATE / +1000) * 12 / 12
  6280
  6281     COMPUTE WK3 = WK3 + WK5-CSL
  6282     MOVE WK3                    TO CP-CALC-PREMIUM
  6283
  6284     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  6285     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  6286        / (1 + K)
  6287
  6288     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6289          ** ((N - M) * -1))) / I)
  6290     COMPUTE WK2 = (1 + K) ** (M * -1)
  6291     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6292     COMPUTE ANGLEN-M = ANGLEN-M / Y
  6293
  6294
  6295     COMPUTE ANGLEM = ((1 - ((1 + K)
  6296          ** (M * -1))) / K) / Y
  6297
  6298*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6299
  6300     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  6301        ((1 + K) ** (M + 1 / Y
  6302        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  6303        - 1)) / K) * RA
  6304     COMPUTE WK7 = (((((M * (M + 1) / 2)
  6305        + (CP-DAYS-TO-1ST-PMT - +30)
  6306        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  6307        CP-DCC-AH-RATE / 1000 * 12 / 12)
  6308     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  6309        * (12 / 12)
  6310
  6311
  6312     MOVE WK3                    TO CP-LF-PREM
  6313
  6314
  6315
  6316     GO TO 99999-RETURN                                           ERCNETP
  6317
  6318     .                                                            ERCNETP
  6319 12001-CONTINUE-NET.                                              ERCNETP
  6320                                                                  ERCNETP
  6321     IF NET-STD                                                   ERCNETP
  6322        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'   ERCNETP
  6323*          OR 'DCC'
  6324         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6325         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6326         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 113
* ELRATEX.cbl (/apps/test/cid1s/copy/ERCNETP)
  6327         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  6328                               * ((1 + N) / (1 + M))
  6329         if (i = .0000000001)
  6330            and (wk3 = zeros)
  6331            move 1               to wk3
  6332         end-if
  6333        ELSE                                                      ERCNETP
  6334         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N        ERCNETP
  6335         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)           ERCNETP
  6336         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)            ERCNETP
  6337         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.                    ERCNETP
  6338                                                                  ERCNETP
  6339     IF NET-SMP                                                   ERCNETP
  6340         COMPUTE N2 = N * N                                       ERCNETP
  6341         COMPUTE N3 = N2 * N                                      ERCNETP
  6342         COMPUTE WK3 ROUNDED = 2 * N2 * WK1                       ERCNETP
  6343         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)          ERCNETP
  6344         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)                ERCNETP
  6345         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10                 ERCNETP
  6346         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).        ERCNETP
  6347                                                                  ERCNETP
  6348     IF NPO-PRUDENTIAL                                            ERCNETP
  6349       PERFORM 12100-PRU-CALC THRU 12199-EXIT                     ERCNETP
  6350           VARYING WS-COUNTER FROM 1 BY 1                         ERCNETP
  6351               UNTIL WS-COUNTER = N                               ERCNETP
  6352       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1      ERCNETP
  6353       COMPUTE WK3 ROUNDED = WK3 / (I * 12).                      ERCNETP
  6354                                                                  ERCNETP
  6355     MOVE WK3 TO FACTOR.                                          ERCNETP
  6356
  6357                                                                  ERCNETP
  6358     GO TO 99999-RETURN.                                          ERCNETP
  6359                                                                  ERCNETP
  6360 12100-PRU-CALC.                                                  ERCNETP
  6361     IF WS-COUNTER = 1                                            ERCNETP
  6362         COMPUTE PWK = (I + 1)                                    ERCNETP
  6363     ELSE                                                         ERCNETP
  6364         COMPUTE PWK = PWK * (I + 1).                             ERCNETP
  6365                                                                  ERCNETP
  6366 12199-EXIT.                                                      ERCNETP
  6367      EXIT.                                                       ERCNETP
  6368                                                                  ERCNETP
  6369 99000-ERROR.                                                     ERCNETP
  6370     MOVE +9999.999999999 TO N-P-FACTOR.                          ERCNETP
  6371     MOVE '4'             TO CP-RETURN-CODE.                      ERCNETP
  6372                                                                  ERCNETP
  6373     GO TO 99999-EXIT.                                            ERCNETP
  6374                                                                  ERCNETP
  6375 99999-RETURN.                                                    ERCNETP
  6376     MOVE FACTOR          TO N-P-FACTOR.                          ERCNETP
  6377                                                                  ERCNETP
  6378 99999-EXIT.                                                      ERCNETP
  6379      EXIT.                                                       ERCNETP
  6380
  6381 99999-DUMMY-STOP-RUN.
  6382     GOBACK.
  6383
*
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 114
* ELRATEX.cbl
* Program-Id : ELRATEX
* Line   Data Name                       Address    Size      Attributes
* 000085 ER-RATE-REC . . . . . . . . . . 0000001248 00001765  FD G    AlphNum
* 000086 Filler. . . . . . . . . . . . . 0000001248 00000002  FD E    AlphNum
* 000087 ER-RATE-KEY . . . . . . . . . . 0000001250 00000028  FD E    AlphNum
* 000088 Filler. . . . . . . . . . . . . 0000001278 00001735  FD E    AlphNum
* 000091 OE-RATE-REC . . . . . . . . . . 0000003024 00001765  FD G    AlphNum
* 000092 Filler. . . . . . . . . . . . . 0000003024 00000002  FD E    AlphNum
* 000093 OE-RATE-KEY . . . . . . . . . . 0000003026 00000028  FD E    AlphNum
* 000094 Filler. . . . . . . . . . . . . 0000003054 00001735  FD E    AlphNum
* 000098 Filler. . . . . . . . . . . . . 0000004800 00000032  WS E    AlphNum
* 000099 Filler. . . . . . . . . . . . . 0000004832 00000032  WS E    AlphNum
* 000100 Filler. . . . . . . . . . . . . 0000004864 00000032  WS E    AlphNum
* 000112 STANDARD-AREAS. . . . . . . . . 0000004896 00000093  WS G    AlphNum
* 000113 ER-STATUS . . . . . . . . . . . 0000004896 00000002  WS E    AlphNum
* 000114 WS-BROWSE-SW. . . . . . . . . . 0000004898 00000001  WS E    AlphNum
* 000116 WS-PREMIUM-RATE . . . . . . . . 0000004899 00000004  WS E    Comp-3
* 000117 WS-FARM-TERM. . . . . . . . . . 0000004903 00000002  WS E    Comp-3
* 000118 OERATE-FILE-ID. . . . . . . . . 0000004905 00000008  WS E    AlphNum
* 000119 ERRATE-FILE-ID. . . . . . . . . 0000004913 00000008  WS E    AlphNum
* 000120 ERRATE-KEY. . . . . . . . . . . 0000004921 00000028  WS G    AlphNum
* 000121 RATE-COMPANY-CD . . . . . . . . 0000004921 00000001  WS E    AlphNum
* 000122 RATE-STATE-CODE . . . . . . . . 0000004922 00000007  WS G    AlphNum
* 000123 RATE-ST-CODE. . . . . . . . . . 0000004922 00000002  WS E    AlphNum
* 000124 RATE-ST-CLASS . . . . . . . . . 0000004924 00000002  WS E    AlphNum
* 000125 RATE-ST-DEV . . . . . . . . . . 0000004926 00000003  WS E    AlphNum
* 000126 RATE-L-AH-CODE. . . . . . . . . 0000004929 00000003  WS G    AlphNum
* 000127 RATE-L-AH . . . . . . . . . . . 0000004929 00000001  WS E    AlphNum
* 000128 RATE-LAH-NUM. . . . . . . . . . 0000004930 00000002  WS E    AlphNum
* 000129 RATE-LIMITS . . . . . . . . . . 0000004932 00000011  WS G    AlphNum
* 000130 RATE-HIGH-AGE . . . . . . . . . 0000004932 00000002  WS E    Display
* 000131 RATE-HIGH-AMT . . . . . . . . . 0000004934 00000006  WS E    Display
* 000132 RATE-FUTURE . . . . . . . . . . 0000004940 00000002  WS E    AlphNum
* 000133 RATE-SEX. . . . . . . . . . . . 0000004942 00000001  WS E    AlphNum
* 000134 RATE-EXPIRY-DATE. . . . . . . . 0000004943 00000006  WS E    Comp-3
* 000136 SAVE-ERRATE-KEY . . . . . . . . 0000004949 00000028  WS G    AlphNum
* 000137 SVRT-COMPANY-CD . . . . . . . . 0000004949 00000001  WS E    AlphNum
* 000138 SVRT-STATE-CODE . . . . . . . . 0000004950 00000007  WS G    AlphNum
* 000139 SVRT-ST-CODE. . . . . . . . . . 0000004950 00000002  WS E    AlphNum
* 000140 SVRT-ST-CLASS . . . . . . . . . 0000004952 00000002  WS E    AlphNum
* 000141 SVRT-ST-DEV . . . . . . . . . . 0000004954 00000003  WS E    AlphNum
* 000142 SVRT-L-AH-CODE. . . . . . . . . 0000004957 00000003  WS G    AlphNum
* 000143 SVRT-L-AH . . . . . . . . . . . 0000004957 00000001  WS E    AlphNum
* 000144 SVRT-LAH-NUM. . . . . . . . . . 0000004958 00000002  WS E    AlphNum
* 000145 SVRT-LIMITS . . . . . . . . . . 0000004960 00000011  WS G    AlphNum
* 000146 SVRT-HIGH-AGE . . . . . . . . . 0000004960 00000002  WS E    Display
* 000147 SVRT-HIGH-AMT . . . . . . . . . 0000004962 00000006  WS E    Display
* 000148 SVRT-FUTURE . . . . . . . . . . 0000004968 00000002  WS E    AlphNum
* 000149 SVRT-SEX. . . . . . . . . . . . 0000004970 00000001  WS E    AlphNum
* 000150 SVRT-EXPIRY-DATE. . . . . . . . 0000004971 00000006  WS E    Comp-3
* 000152 WS-SIN-PREM-RATE. . . . . . . . 0000004977 00000009  WS E    Display
* 000153 WS-TERM-MINUS-ONE . . . . . . . 0000004986 00000003  WS E    Comp-3
* 000155 CSL-WORK-AREAS. . . . . . . . . 0000004992 00000093  WS G    AlphNum
* 000156 WK-C. . . . . . . . . . . . . . 0000004992 00000007  WS E    Comp-3
* 000157 WK-D. . . . . . . . . . . . . . 0000004999 00000007  WS E    Comp-3
* 000158 WK-J. . . . . . . . . . . . . . 0000005006 00000002  WS E    Comp-3
* 000159 WK-K. . . . . . . . . . . . . . 0000005008 00000002  WS E    Comp-3
* 000160 WK-L. . . . . . . . . . . . . . 0000005010 00000006  WS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 115
* ELRATEX.cbl
* 000161 WK-S. . . . . . . . . . . . . . 0000005016 00000004  WS E    Comp-3
* 000162 WK-T. . . . . . . . . . . . . . 0000005020 00000002  WS E    Comp-3
* 000163 WK-T1 . . . . . . . . . . . . . 0000005022 00000002  WS E    Comp-3
* 000164 WK-U. . . . . . . . . . . . . . 0000005024 00000006  WS E    Comp-3
* 000165 WK-PREM . . . . . . . . . . . . 0000005030 00000005  WS E    Comp-3
* 000166 WK-PAY-AMT. . . . . . . . . . . 0000005035 00000005  WS E    Comp-3
* 000167 WK-LEV-RATE . . . . . . . . . . 0000005040 00000005  WS E    Comp-3
* 000168 WK-RED-RATE . . . . . . . . . . 0000005045 00000005  WS E    Comp-3
* 000169 WK-DAILY-RATE . . . . . . . . . 0000005050 00000005  WS E    Comp-3
* 000170 WK-MONTHLY-RATE . . . . . . . . 0000005055 00000005  WS E    Comp-3
* 000171 WK-MONTHLY-RATE-T . . . . . . . 0000005060 00000005  WS E    Comp-3
* 000172 WK-MONTHLY-RATE-J . . . . . . . 0000005065 00000005  WS E    Comp-3
* 000173 WS-MAX-TOT-BEN. . . . . . . . . 0000005070 00000005  WS E    Comp-3
* 000174 WS-MAX-MON-BEN. . . . . . . . . 0000005075 00000005  WS E    Comp-3
* 000175 WS-NUM-PAYMTS . . . . . . . . . 0000005080 00000003  WS E    Comp-3
* 000176 WS-PAY-SCH. . . . . . . . . . . 0000005083 00000002  WS E    Comp-3
* 000178 TEXAS-REG-WORK-AREAS. . . . . . 0000005088 00000033  WS G    AlphNum
* 000179 TEX-FACT-1. . . . . . . . . . . 0000005088 00000005  WS E    Comp-3
* 000180 TEX-FACT-2. . . . . . . . . . . 0000005093 00000002  WS E    Comp-3
* 000181 TEX-FACT-3. . . . . . . . . . . 0000005095 00000002  WS E    Comp-3
* 000182 TEX-FACT-4. . . . . . . . . . . 0000005097 00000004  WS E    Comp-3
* 000183 TEX-FACT-5. . . . . . . . . . . 0000005101 00000002  WS E    Comp-3
* 000184 TEX-FACT-6. . . . . . . . . . . 0000005103 00000002  WS E    Comp-3
* 000185 TEX-FACT-7. . . . . . . . . . . 0000005105 00000004  WS E    Comp-3
* 000186 TEX-FACT-8. . . . . . . . . . . 0000005109 00000004  WS E    Comp-3
* 000187 TEX-FACT-9. . . . . . . . . . . 0000005113 00000008  WS E    Comp-3
* 000189 NET-PAY-INTERFACE . . . . . . . 0000005128 00000018  WS G    AlphNum
* 000190 N-P-APR . . . . . . . . . . . . 0000005128 00000004  WS E    Comp-3
* 000191 N-P-ORIG. . . . . . . . . . . . 0000005132 00000002  WS E    Comp-3
* 000192 N-P-REM . . . . . . . . . . . . 0000005134 00000002  WS E    Comp-3
* 000193 N-P-OPT . . . . . . . . . . . . 0000005136 00000001  WS E    AlphNum
* 000194 N-P-LOAN. . . . . . . . . . . . 0000005137 00000002  WS E    Comp-3
* 000195 N-P-FACTOR. . . . . . . . . . . 0000005139 00000007  WS E    Comp-3
* 000223 NET-PAY-WORK-AREA . . . . . . . 0000005152 00000638  WS G    AlphNum
* 000224 OPTION-SW . . . . . . . . . . . 0000005152 00000001  WS E    AlphNum
* 000240 TYPE-SW . . . . . . . . . . . . 0000005153 00000001  WS E    AlphNum
* 000244 NP-PROCESS-SW . . . . . . . . . 0000005154 00000001  WS E    AlphNum
* 000249 COMP-3-WORK-AREA. . . . . . . . 0000005155 00000530  WS G    AlphNum
* 000250 WS-WORK-DIS-RATE. . . . . . . . 0000005155 00000005  WS E    Comp-3
* 000251 V . . . . . . . . . . . . . . . 0000005160 00000007  WS E    Comp-3
* 000252 J . . . . . . . . . . . . . . . 0000005167 00000005  WS E    Comp-3
* 000253 K . . . . . . . . . . . . . . . 0000005172 00000005  WS E    Comp-3
* 000254 I . . . . . . . . . . . . . . . 0000005177 00000006  WS E    Comp-3
* 000255 D . . . . . . . . . . . . . . . 0000005183 00000003  WS E    Comp-3
* 000256 APR100. . . . . . . . . . . . . 0000005186 00000005  WS E    Comp-3
* 000257 RA. . . . . . . . . . . . . . . 0000005191 00000008  WS E    Comp-3
* 000258 WK1 . . . . . . . . . . . . . . 0000005199 00000009  WS E    Comp-3
* 000259 WK2 . . . . . . . . . . . . . . 0000005208 00000009  WS E    Comp-3
* 000260 PEMA. . . . . . . . . . . . . . 0000005217 00000009  WS E    Comp-3
* 000261 WK3 . . . . . . . . . . . . . . 0000005226 00000009  WS E    Comp-3
* 000262 WK4 . . . . . . . . . . . . . . 0000005235 00000008  WS E    Comp-3
* 000263 WK5 . . . . . . . . . . . . . . 0000005243 00000010  WS E    Comp-3
* 000264 WK5-CSL . . . . . . . . . . . . 0000005253 00000008  WS E    Comp-3
* 000265 WK6 . . . . . . . . . . . . . . 0000005261 00000009  WS E    Comp-3
* 000266 WK7 . . . . . . . . . . . . . . 0000005270 00000009  WS E    Comp-3
* 000267 WK8 . . . . . . . . . . . . . . 0000005279 00000007  WS E    Comp-3
* 000268 WK9 . . . . . . . . . . . . . . 0000005286 00000007  WS E    Comp-3
* 000269 GR. . . . . . . . . . . . . . . 0000005293 00000009  WS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 116
* ELRATEX.cbl
* 000270 ONE-PLUS-I. . . . . . . . . . . 0000005302 00000007  WS E    Comp-3
* 000271 ODF . . . . . . . . . . . . . . 0000005309 00000007  WS E    Comp-3
* 000272 OD. . . . . . . . . . . . . . . 0000005316 00000007  WS E    Comp-3
* 000273 FM. . . . . . . . . . . . . . . 0000005323 00000007  WS E    Comp-3
* 000274 FN. . . . . . . . . . . . . . . 0000005330 00000007  WS E    Comp-3
* 000275 FNM . . . . . . . . . . . . . . 0000005337 00000007  WS E    Comp-3
* 000276 ANGLEM. . . . . . . . . . . . . 0000005344 00000010  WS E    Comp-3
* 000277 ANGLEMY . . . . . . . . . . . . 0000005354 00000010  WS E    Comp-3
* 000278 ANGLEMP1. . . . . . . . . . . . 0000005364 00000010  WS E    Comp-3
* 000279 ANGLEN. . . . . . . . . . . . . 0000005374 00000010  WS E    Comp-3
* 000280 ANGLENY . . . . . . . . . . . . 0000005384 00000010  WS E    Comp-3
* 000281 ANGLEN-M. . . . . . . . . . . . 0000005394 00000010  WS E    Comp-3
* 000282 ANGLEN-MP1. . . . . . . . . . . 0000005404 00000010  WS E    Comp-3
* 000283 ANGLEN-MP1Y . . . . . . . . . . 0000005414 00000010  WS E    Comp-3
* 000284 ANGLEN-1. . . . . . . . . . . . 0000005424 00000009  WS E    Comp-3
* 000285 ANGLEM-1. . . . . . . . . . . . 0000005433 00000009  WS E    Comp-3
* 000286 ANGLEM-1Y . . . . . . . . . . . 0000005442 00000009  WS E    Comp-3
* 000287 ANGLEM-T. . . . . . . . . . . . 0000005451 00000010  WS E    Comp-3
* 000288 PVBALLOON . . . . . . . . . . . 0000005461 00000005  WS E    Comp-3
* 000289 TRUNC-PMT . . . . . . . . . . . 0000005466 00000005  WS E    Comp-3
* 000290 K1. . . . . . . . . . . . . . . 0000005471 00000002  WS E    Comp-3
* 000291 K12 . . . . . . . . . . . . . . 0000005473 00000002  WS E    Comp-3
* 000292 K100. . . . . . . . . . . . . . 0000005475 00000002  WS E    Comp-3
* 000293 K1000 . . . . . . . . . . . . . 0000005477 00000004  WS E    Comp-3
* 000294 NC-LR . . . . . . . . . . . . . 0000005481 00000004  WS E    Comp-3
* 000295 Y . . . . . . . . . . . . . . . 0000005481 00000004  WS E    Comp-3     R
* 000297 TI. . . . . . . . . . . . . . . 0000005485 00000005  WS E    Comp-3
* 000298 NC-R. . . . . . . . . . . . . . 0000005490 00000009  WS E    Comp-3
* 000299 NC-OB . . . . . . . . . . . . . 0000005499 00000009  WS E    Comp-3
* 000300 NC-P. . . . . . . . . . . . . . 0000005508 00000009  WS E    Comp-3
* 000301 NC-D. . . . . . . . . . . . . . 0000005517 00000009  WS E    Comp-3
* 000302 NC-BIG-D. . . . . . . . . . . . 0000005526 00000002  WS E    Comp-3
* 000303 NC-LITTLE-D . . . . . . . . . . 0000005528 00000005  WS E    Comp-3
* 000304 NC-MP . . . . . . . . . . . . . 0000005533 00000004  WS E    Comp-3
* 000305 NC-LP . . . . . . . . . . . . . 0000005537 00000004  WS E    Comp-3
* 000307 CA-MP . . . . . . . . . . . . . 0000005541 00000004  WS E    Comp-3
* 000308 CA-API. . . . . . . . . . . . . 0000005545 00000006  WS E    Comp-3
* 000309 CA-APJ. . . . . . . . . . . . . 0000005551 00000006  WS E    Comp-3
* 000310 CA-VI . . . . . . . . . . . . . 0000005557 00000006  WS E    Comp-3
* 000311 CA-J. . . . . . . . . . . . . . 0000005563 00000006  WS E    Comp-3
* 000312 CA-DISCOUNT . . . . . . . . . . 0000005569 00000006  WS E    Comp-3
* 000313 GTL-IA-DIVIDEND . . . . . . . . 0000005575 00000007  WS E    Comp-3
* 000314 GTL-IA-DIVISOR. . . . . . . . . 0000005582 00000007  WS E    Comp-3
* 000315 GTL-IA-FACTOR . . . . . . . . . 0000005589 00000007  WS E    Comp-3
* 000316 GTL-IA-ODF. . . . . . . . . . . 0000005596 00000007  WS E    Comp-3
* 000317 GTL-IA-ODD-DAYS . . . . . . . . 0000005603 00000002  WS E    Comp-3
* 000318 GTL-IA-SGN. . . . . . . . . . . 0000005605 00000001  WS E    Comp-3
* 000319 GTL-IA-ABS. . . . . . . . . . . 0000005606 00000002  WS E    Comp-3
* 000321 ANNUAL-INT-RATE . . . . . . . . 0000005608 00000004  WS E    Comp-3
* 000323 ORIGINAL-TERM . . . . . . . . . 0000005612 00000002  WS E    Comp-3
* 000324 M . . . . . . . . . . . . . . . 0000005612 00000002  WS E    Comp-3     R
* 000327 REMAINING-TERM. . . . . . . . . 0000005614 00000002  WS E    Comp-3
* 000328 R . . . . . . . . . . . . . . . 0000005614 00000002  WS E    Comp-3     R
* 000331 LOAN-TERM . . . . . . . . . . . 0000005616 00000002  WS E    Comp-3
* 000332 N . . . . . . . . . . . . . . . 0000005616 00000002  WS E    Comp-3     R
* 000335 EXPIRED-TERM. . . . . . . . . . 0000005618 00000002  WS E    Comp-3
* 000336 E . . . . . . . . . . . . . . . 0000005618 00000002  WS E    Comp-3     R
* 000339 PRUDENTIAL-WORK-AMT . . . . . . 0000005620 00000008  WS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 117
* ELRATEX.cbl
* 000341 PWK . . . . . . . . . . . . . . 0000005620 00000008  WS E    Comp-3     R
* 000344 FACTOR. . . . . . . . . . . . . 0000005628 00000007  WS E    Comp-3
* 000345 VX. . . . . . . . . . . . . . . 0000005635 00000008  WS E    Comp-3
* 000346 SV. . . . . . . . . . . . . . . 0000005643 00000008  WS E    Comp-3
* 000347 SV-MINUS-ONE. . . . . . . . . . 0000005651 00000007  WS E    Comp-3
* 000348 SX. . . . . . . . . . . . . . . 0000005658 00000008  WS E    Comp-3
* 000349 SE. . . . . . . . . . . . . . . 0000005666 00000006  WS E    Comp-3
* 000350 N2. . . . . . . . . . . . . . . 0000005672 00000004  WS E    Comp-3
* 000351 N3. . . . . . . . . . . . . . . 0000005676 00000004  WS E    Comp-3
* 000352 K-I . . . . . . . . . . . . . . 0000005680 00000005  WS E    Comp-3
* 000354 BINARY-WORK-AREA. . . . . . . . 0000005685 00000016  WS G    AlphNum
* 000355 X1. . . . . . . . . . . . . . . 0000005685 00000002  WS E    Comp
* 000356 X2. . . . . . . . . . . . . . . 0000005687 00000002  WS E    Comp
* 000357 MAX-X . . . . . . . . . . . . . 0000005689 00000004  WS E    Comp
* 000358 B1. . . . . . . . . . . . . . . 0000005693 00000004  WS E    Comp
* 000359 LINDX . . . . . . . . . . . . . 0000005697 00000002  WS E    Comp
* 000360 AHNDX . . . . . . . . . . . . . 0000005699 00000002  WS E    Comp
* 000362 CSO-RATE-WORK-AREAS . . . . . . 0000005701 00000007  WS G    AlphNum
* 000363 C-PMTS-PER-YEAR . . . . . . . . 0000005701 00000003  WS E    Comp-3
* 000364 C-DAYS-IN-PMT-PER . . . . . . . 0000005704 00000002  WS E    Comp-3
* 000365 C-TOT-PMTS. . . . . . . . . . . 0000005706 00000002  WS E    Comp-3
* 000367 WS-WORK-MISC. . . . . . . . . . 0000005708 00000082  WS G    AlphNum
* 000368 WS-EXTRA-PMTS . . . . . . . . . 0000005708 00000002  WS E    Comp-3
* 000369 NET-BEN . . . . . . . . . . . . 0000005710 00000007  WS E    Comp-3
* 000370 WS-RATE-TERM. . . . . . . . . . 0000005717 00000002  WS E    Comp-3
* 000372 WS-AGE. . . . . . . . . . . . . 0000005719 00000003  WS E    Comp-3
* 000373 WS-AH-FACE-BENEFIT. . . . . . . 0000005722 00000004  WS E    Comp-3
* 000374 WS-COUNTER. . . . . . . . . . . 0000005726 00000002  WS E    Comp-3
* 000375 WS-WORK-RATE. . . . . . . . . . 0000005728 00000006  WS E    Comp-3
* 000376 WS-DISCOUNT-OPTION. . . . . . . 0000005734 00000001  WS E    AlphNum
* 000377 WS-DUE-DATE . . . . . . . . . . 0000005735 00000004  WS E    Comp-3
* 000378 WS-INT-BEGIN-DATE . . . . . . . 0000005739 00000004  WS E    Comp-3
* 000379 WS-X-Y-FACTOR . . . . . . . . . 0000005743 00000010  WS E    Comp-3
* 000380 WS-Y-X-FACTOR . . . . . . . . . 0000005753 00000010  WS E    Comp-3
* 000381 WS-ODD-DAY-UNITS. . . . . . . . 0000005763 00000010  WS E    Comp-3
* 000382 WS-CALC-FREQ-RATE . . . . . . . 0000005773 00000009  WS E    Comp-3
* 000383 WS-NP-FACTOR. . . . . . . . . . 0000005782 00000008  WS E    Comp-3
* 000400 DATE-CONVERSION-DATA. . . . . . 0000005792 00000200  WS G    AlphNum
* 000401 DC-COMM-LENGTH. . . . . . . . . 0000005792 00000002  WS E    Comp
* 000402 DC-OPTION-CODE. . . . . . . . . 0000005794 00000001  WS E    AlphNum
* 000439 DC-ERROR-CODE . . . . . . . . . 0000005795 00000001  WS E    AlphNum
* 000453 DC-END-OF-MONTH . . . . . . . . 0000005796 00000001  WS E    AlphNum
* 000455 DC-CENTURY-ADJUSTMENT . . . . . 0000005797 00000001  WS E    AlphNum
* 000459 Filler. . . . . . . . . . . . . 0000005798 00000001  WS E    AlphNum
* 000460 DC-CONVERSION-DATES . . . . . . 0000005799 00000065  WS G    AlphNum
* 000461 DC-BIN-DATE-1 . . . . . . . . . 0000005799 00000002  WS E    AlphNum
* 000462 DC-BIN-DATE-2 . . . . . . . . . 0000005801 00000002  WS E    AlphNum
* 000463 DC-GREG-DATE-1-EDIT . . . . . . 0000005803 00000008  WS E    AlphNum
* 000464 DC-GREG-DATE-1-EDIT-R . . . . . 0000005803 00000008  WS G    AlphNum    R
* 000466 DC-EDIT1-MONTH. . . . . . . . . 0000005803 00000002  WS E    Display
* 000467 SLASH1-1. . . . . . . . . . . . 0000005805 00000001  WS E    AlphNum
* 000468 DC-EDIT1-DAY. . . . . . . . . . 0000005806 00000002  WS E    Display
* 000469 SLASH1-2. . . . . . . . . . . . 0000005808 00000001  WS E    AlphNum
* 000470 DC-EDIT1-YEAR . . . . . . . . . 0000005809 00000002  WS E    Display
* 000471 DC-GREG-DATE-2-EDIT . . . . . . 0000005811 00000008  WS E    AlphNum
* 000472 DC-GREG-DATE-2-EDIT-R . . . . . 0000005811 00000008  WS G    AlphNum    R
* 000474 DC-EDIT2-MONTH. . . . . . . . . 0000005811 00000002  WS E    Display
* 000475 SLASH2-1. . . . . . . . . . . . 0000005813 00000001  WS E    AlphNum
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 118
* ELRATEX.cbl
* 000476 DC-EDIT2-DAY. . . . . . . . . . 0000005814 00000002  WS E    Display
* 000477 SLASH2-2. . . . . . . . . . . . 0000005816 00000001  WS E    AlphNum
* 000478 DC-EDIT2-YEAR . . . . . . . . . 0000005817 00000002  WS E    Display
* 000479 DC-GREG-DATE-1-YMD. . . . . . . 0000005819 00000006  WS E    Display
* 000480 DC-GREG-DATE-1-YMD-R. . . . . . 0000005819 00000006  WS G    AlphNum    R
* 000482 DC-YMD-YEAR . . . . . . . . . . 0000005819 00000002  WS E    Display
* 000483 DC-YMD-MONTH. . . . . . . . . . 0000005821 00000002  WS E    Display
* 000484 DC-YMD-DAY. . . . . . . . . . . 0000005823 00000002  WS E    Display
* 000485 DC-GREG-DATE-1-MDY. . . . . . . 0000005825 00000006  WS E    Display
* 000486 DC-GREG-DATE-1-MDY-R. . . . . . 0000005825 00000006  WS G    AlphNum    R
* 000488 DC-MDY-MONTH. . . . . . . . . . 0000005825 00000002  WS E    Display
* 000489 DC-MDY-DAY. . . . . . . . . . . 0000005827 00000002  WS E    Display
* 000490 DC-MDY-YEAR . . . . . . . . . . 0000005829 00000002  WS E    Display
* 000491 DC-GREG-DATE-1-ALPHA. . . . . . 0000005831 00000018  WS G    AlphNum
* 000492 DC-ALPHA-MONTH. . . . . . . . . 0000005831 00000010  WS E    AlphNum
* 000493 DC-ALPHA-DAY. . . . . . . . . . 0000005841 00000002  WS E    Display
* 000494 Filler. . . . . . . . . . . . . 0000005843 00000002  WS E    AlphNum
* 000495 DC-ALPHA-CENTURY. . . . . . . . 0000005845 00000002  WS G    AlphNum
* 000496 DC-ALPHA-CEN-N. . . . . . . . . 0000005845 00000002  WS E    Display
* 000497 DC-ALPHA-YEAR . . . . . . . . . 0000005847 00000002  WS E    Display
* 000498 DC-ELAPSED-MONTHS . . . . . . . 0000005849 00000002  WS E    Comp
* 000499 DC-ODD-DAYS-OVER. . . . . . . . 0000005851 00000002  WS E    Comp
* 000500 DC-ELAPSED-DAYS . . . . . . . . 0000005853 00000002  WS E    Comp
* 000501 DC-JULIAN-DATE. . . . . . . . . 0000005855 00000005  WS E    Display
* 000502 DC-JULIAN-YYDDD . . . . . . . . 0000005855 00000005  WS E    Display    R
* 000504 DC-JULIAN-DT. . . . . . . . . . 0000005855 00000005  WS G    AlphNum    R
* 000505 DC-JULIAN-YEAR. . . . . . . . . 0000005855 00000002  WS E    Display
* 000506 DC-JULIAN-DAYS. . . . . . . . . 0000005857 00000003  WS E    Display
* 000507 DC-DAYS-IN-MONTH. . . . . . . . 0000005860 00000002  WS E    Comp-3
* 000508 DC-DAY-OF-WEEK. . . . . . . . . 0000005862 00000001  WS E    Comp-3
* 000509 DC-DAY-OF-WEEK2 . . . . . . . . 0000005863 00000001  WS E    Comp-3
* 000510 DATE-CONVERSION-VARIBLES. . . . 0000005864 00000078  WS G    AlphNum
* 000511 HOLD-CENTURY-1. . . . . . . . . 0000005864 00000011  WS E    Display
* 000512 HOLD-CENTURY-1-SPLIT. . . . . . 0000005864 00000011  WS G    AlphNum    R
* 000513 Filler. . . . . . . . . . . . . 0000005864 00000003  WS E    Display
* 000514 HOLD-CEN-1-CCYY . . . . . . . . 0000005867 00000004  WS G    AlphNum
* 000515 HOLD-CEN-1-CC . . . . . . . . . 0000005867 00000002  WS E    Display
* 000516 HOLD-CEN-1-YY . . . . . . . . . 0000005869 00000002  WS E    Display
* 000517 HOLD-CEN-1-MO . . . . . . . . . 0000005871 00000002  WS E    Display
* 000518 HOLD-CEN-1-DA . . . . . . . . . 0000005873 00000002  WS E    Display
* 000519 HOLD-CENTURY-1-R. . . . . . . . 0000005864 00000011  WS G    AlphNum    R
* 000520 HOLD-CEN-1-R-MO . . . . . . . . 0000005864 00000002  WS E    Display
* 000521 HOLD-CEN-1-R-DA . . . . . . . . 0000005866 00000002  WS E    Display
* 000522 HOLD-CEN-1-R-CCYY . . . . . . . 0000005868 00000004  WS G    AlphNum
* 000523 HOLD-CEN-1-R-CC . . . . . . . . 0000005868 00000002  WS E    Display
* 000524 HOLD-CEN-1-R-YY . . . . . . . . 0000005870 00000002  WS E    Display
* 000525 Filler. . . . . . . . . . . . . 0000005872 00000003  WS E    Display
* 000526 HOLD-CENTURY-1-X. . . . . . . . 0000005875 00000011  WS G    AlphNum
* 000527 Filler. . . . . . . . . . . . . 0000005875 00000003  WS E    AlphNum
* 000528 HOLD-CEN-1-X-CCYY . . . . . . . 0000005878 00000004  WS G    AlphNum
* 000529 HOLD-CEN-1-X-CC . . . . . . . . 0000005878 00000002  WS E    AlphNum
* 000530 HOLD-CEN-1-X-YY . . . . . . . . 0000005880 00000002  WS E    AlphNum
* 000531 HOLD-CEN-1-X-MO . . . . . . . . 0000005882 00000002  WS E    AlphNum
* 000532 HOLD-CEN-1-X-DA . . . . . . . . 0000005884 00000002  WS E    AlphNum
* 000533 HOLD-CENTURY-1-R-X. . . . . . . 0000005875 00000011  WS G    AlphNum    R
* 000534 HOLD-CEN-1-R-X-MO . . . . . . . 0000005875 00000002  WS E    AlphNum
* 000535 HOLD-CEN-1-R-X-DA . . . . . . . 0000005877 00000002  WS E    AlphNum
* 000536 HOLD-CEN-1-R-X-CCYY . . . . . . 0000005879 00000004  WS G    AlphNum
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 119
* ELRATEX.cbl
* 000537 HOLD-CEN-1-R-X-CC . . . . . . . 0000005879 00000002  WS E    AlphNum
* 000538 HOLD-CEN-1-R-X-YY . . . . . . . 0000005881 00000002  WS E    AlphNum
* 000539 Filler. . . . . . . . . . . . . 0000005883 00000003  WS E    AlphNum
* 000540 DC-BIN-DATE-EXPAND-1. . . . . . 0000005886 00000003  WS E    AlphNum
* 000541 DC-BIN-DATE-EXPAND-2. . . . . . 0000005889 00000003  WS E    AlphNum
* 000542 DC-JULIAN-DATE-1. . . . . . . . 0000005892 00000007  WS E    Display
* 000543 DC-JULIAN-DATE-1-R. . . . . . . 0000005892 00000007  WS G    AlphNum    R
* 000544 DC-JULIAN-1-CCYY. . . . . . . . 0000005892 00000004  WS G    AlphNum
* 000545 DC-JULIAN-1-CC. . . . . . . . . 0000005892 00000002  WS E    Display
* 000546 DC-JULIAN-1-YR. . . . . . . . . 0000005894 00000002  WS E    Display
* 000547 DC-JULIAN-DA-1. . . . . . . . . 0000005896 00000003  WS E    Display
* 000548 DC-JULIAN-DATE-2. . . . . . . . 0000005899 00000007  WS E    Display
* 000549 DC-JULIAN-DATE-2-R. . . . . . . 0000005899 00000007  WS G    AlphNum    R
* 000550 DC-JULIAN-2-CCYY. . . . . . . . 0000005899 00000004  WS G    AlphNum
* 000551 DC-JULIAN-2-CC. . . . . . . . . 0000005899 00000002  WS E    Display
* 000552 DC-JULIAN-2-YR. . . . . . . . . 0000005901 00000002  WS E    Display
* 000553 DC-JULIAN-DA-2. . . . . . . . . 0000005903 00000003  WS E    Display
* 000554 DC-GREG-DATE-A-EDIT . . . . . . 0000005906 00000010  WS G    AlphNum
* 000555 DC-EDITA-MONTH. . . . . . . . . 0000005906 00000002  WS E    Display
* 000556 SLASHA-1. . . . . . . . . . . . 0000005908 00000001  WS E    AlphNum
* 000557 DC-EDITA-DAY. . . . . . . . . . 0000005909 00000002  WS E    Display
* 000558 SLASHA-2. . . . . . . . . . . . 0000005911 00000001  WS E    AlphNum
* 000559 DC-EDITA-CCYY . . . . . . . . . 0000005912 00000004  WS G    AlphNum
* 000560 DC-EDITA-CENT . . . . . . . . . 0000005912 00000002  WS E    Display
* 000561 DC-EDITA-YEAR . . . . . . . . . 0000005914 00000002  WS E    Display
* 000562 DC-GREG-DATE-B-EDIT . . . . . . 0000005916 00000010  WS G    AlphNum
* 000563 DC-EDITB-MONTH. . . . . . . . . 0000005916 00000002  WS E    Display
* 000564 SLASHB-1. . . . . . . . . . . . 0000005918 00000001  WS E    AlphNum
* 000565 DC-EDITB-DAY. . . . . . . . . . 0000005919 00000002  WS E    Display
* 000566 SLASHB-2. . . . . . . . . . . . 0000005921 00000001  WS E    AlphNum
* 000567 DC-EDITB-CCYY . . . . . . . . . 0000005922 00000004  WS G    AlphNum
* 000568 DC-EDITB-CENT . . . . . . . . . 0000005922 00000002  WS E    Display
* 000569 DC-EDITB-YEAR . . . . . . . . . 0000005924 00000002  WS E    Display
* 000570 DC-GREG-DATE-CYMD . . . . . . . 0000005926 00000008  WS E    Display
* 000571 DC-GREG-DATE-CYMD-R . . . . . . 0000005926 00000008  WS G    AlphNum    R
* 000573 DC-CYMD-CEN . . . . . . . . . . 0000005926 00000002  WS E    Display
* 000574 DC-CYMD-YEAR. . . . . . . . . . 0000005928 00000002  WS E    Display
* 000575 DC-CYMD-MONTH . . . . . . . . . 0000005930 00000002  WS E    Display
* 000576 DC-CYMD-DAY . . . . . . . . . . 0000005932 00000002  WS E    Display
* 000577 DC-GREG-DATE-MDCY . . . . . . . 0000005934 00000008  WS E    Display
* 000578 DC-GREG-DATE-MDCY-R . . . . . . 0000005934 00000008  WS G    AlphNum    R
* 000580 DC-MDCY-MONTH . . . . . . . . . 0000005934 00000002  WS E    Display
* 000581 DC-MDCY-DAY . . . . . . . . . . 0000005936 00000002  WS E    Display
* 000582 DC-MDCY-CEN . . . . . . . . . . 0000005938 00000002  WS E    Display
* 000583 DC-MDCY-YEAR. . . . . . . . . . 0000005940 00000002  WS E    Display
* 000584 DC-FORCE-EL310-DATE-SW. . . . . 0000005942 00000001  WS E    AlphNum
* 000586 DC-EL310-DATE . . . . . . . . . 0000005943 00000021  WS E    AlphNum
* 000587 Filler. . . . . . . . . . . . . 0000005964 00000028  WS E    AlphNum
* 000623 RATE-RECORD . . . . . . . . . . 0000005992 00001765  WS G    AlphNum
* 000624 RT-RECORD-ID. . . . . . . . . . 0000005992 00000002  WS E    AlphNum
* 000627 RT-CONTROL-PRIMARY. . . . . . . 0000005994 00000028  WS G    AlphNum
* 000628 RT-COMPANY-CD . . . . . . . . . 0000005994 00000001  WS E    AlphNum
* 000629 RT-STATE-CODE . . . . . . . . . 0000005995 00000007  WS G    AlphNum
* 000630 RT-ST-CODE. . . . . . . . . . . 0000005995 00000002  WS E    AlphNum
* 000631 RT-ST-CLASS . . . . . . . . . . 0000005997 00000002  WS E    AlphNum
* 000632 RT-ST-DEV . . . . . . . . . . . 0000005999 00000003  WS E    AlphNum
* 000633 RT-L-AH-CODE. . . . . . . . . . 0000006002 00000003  WS G    AlphNum
* 000634 RT-L-AH . . . . . . . . . . . . 0000006002 00000001  WS E    AlphNum
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 120
* ELRATEX.cbl
* 000635 RT-LAH-NUM. . . . . . . . . . . 0000006003 00000002  WS E    AlphNum
* 000636 RT-LIMITS . . . . . . . . . . . 0000006005 00000011  WS G    AlphNum
* 000637 RT-HIGH-AGE . . . . . . . . . . 0000006005 00000002  WS E    Display
* 000638 RT-HIGH-AMT . . . . . . . . . . 0000006007 00000006  WS E    Display
* 000639 RT-FUTURE . . . . . . . . . . . 0000006013 00000002  WS E    AlphNum
* 000640 RT-SEX. . . . . . . . . . . . . 0000006015 00000001  WS E    AlphNum
* 000641 RT-EXPIRY-DATE. . . . . . . . . 0000006016 00000006  WS E    Comp-3
* 000643 RT-MAINT-INFORMATION. . . . . . 0000006022 00000020  WS G    AlphNum
* 000644 RT-LAST-MAINT-DT. . . . . . . . 0000006022 00000002  WS E    AlphNum
* 000645 RT-LAST-MAINT-HHMMSS. . . . . . 0000006024 00000004  WS E    Comp-3
* 000646 RT-LAST-MAINT-USER. . . . . . . 0000006028 00000004  WS E    AlphNum
* 000647 Filler. . . . . . . . . . . . . 0000006032 00000010  WS E    AlphNum
* 000649 RT-STRUCTURE-COMMENT. . . . . . 0000006042 00000050  WS E    AlphNum
* 000650 RT-RATE-COMMENT . . . . . . . . 0000006092 00000050  WS E    AlphNum
* 000652 CSL-RESERVED. . . . . . . . . . 0000006142 00000010  WS E    AlphNum
* 000653 Filler. . . . . . . . . . . . . 0000006152 00000012  WS E    AlphNum
* 000655 RT-MAX-AGE. . . . . . . . . . . 0000006164 00000002  WS E    Display
* 000657 RT-LIFE-LIMS-FLDS . . . . . . . 0000006166 00000088  WS G    AlphNum
* 000658 RT-LIFE-MORT-CODE . . . . . . . 0000006166 00000004  WS E    AlphNum
* 000659 RT-LIFE-EXCEPTIONS. . . . . . . 0000006170 00000008  WS GO   AlphNum
* 000660 RT-L-EX-AGE . . . . . . . . . . 0000006170 00000002  WS ESO  Display
* 000661 RT-L-EX-TERM. . . . . . . . . . 0000006172 00000002  WS ESO  Comp-3
* 000662 RT-L-EX-FACE. . . . . . . . . . 0000006174 00000004  WS ESO  Comp-3
* 000663 RT-LIFE-TERM-MINS . . . . . . . 0000006234 00000002  WS GO   AlphNum
* 000664 RT-L-MIN-TERM . . . . . . . . . 0000006234 00000002  WS ESO  Comp-3
* 000665 Filler. . . . . . . . . . . . . 0000006250 00000004  WS E    AlphNum
* 000668 RT-AH-LIMS-FLDS . . . . . . . . 0000006166 00000088  WS G    AlphNum    R
* 000669 RT-AH-EXCEPTIONS. . . . . . . . 0000006166 00000011  WS GO   AlphNum
* 000670 RT-AH-AGE . . . . . . . . . . . 0000006166 00000002  WS ESO  Display
* 000671 RT-AH-TERM. . . . . . . . . . . 0000006168 00000002  WS ESO  Comp-3
* 000672 RT-AH-BEN-M . . . . . . . . . . 0000006170 00000003  WS ESO  Comp-3
* 000673 RT-AH-BEN-F . . . . . . . . . . 0000006173 00000004  WS ESO  Comp-3
* 000675 RT-LIFE-RATES . . . . . . . . . 0000006254 00001440  WS G    AlphNum
* 000676 RT-L-RATE . . . . . . . . . . . 0000006254 00000004  WS EO   Comp-3
* 000678 RT-AH-RATES . . . . . . . . . . 0000006254 00001440  WS G    AlphNum    R
* 000679 RT-AH-RATE. . . . . . . . . . . 0000006254 00000004  WS EO   Comp-3
* 000681 RT-DAILY-RATE . . . . . . . . . 0000007694 00000004  WS E    Comp-3
* 000683 RT-DISCOUNT-OPTION. . . . . . . 0000007698 00000001  WS E    AlphNum
* 000688 RT-DISCOUNT-RATE. . . . . . . . 0000007699 00000004  WS E    Comp-3
* 000689 RT-DISCOUNT-OB-RATE . . . . . . 0000007703 00000004  WS E    Comp-3
* 000691 RT-COMPOSITE-OPTION . . . . . . 0000007707 00000001  WS E    AlphNum
* 000695 RT-COMPOSITE-RATE . . . . . . . 0000007708 00000004  WS E    Comp-3
* 000697 RT-CANCEL-FEE . . . . . . . . . 0000007712 00000003  WS E    Comp-3
* 000698 Filler. . . . . . . . . . . . . 0000007715 00000013  WS E    AlphNum
* 000700 RT-TYPE-RATE. . . . . . . . . . 0000007728 00000001  WS E    AlphNum
* 000704 RT-SRT-ALPHA. . . . . . . . . . 0000007729 00000001  WS E    AlphNum
* 000706 RT-CONTROL-2. . . . . . . . . . 0000007730 00000027  WS G    AlphNum
* 000707 RTC-1 . . . . . . . . . . . . . 0000007730 00000007  WS E    AlphNum
* 000708 RTC-3 . . . . . . . . . . . . . 0000007737 00000011  WS E    AlphNum
* 000709 RTC-4 . . . . . . . . . . . . . 0000007748 00000006  WS E    Comp-3
* 000710 RTC-2 . . . . . . . . . . . . . 0000007754 00000003  WS E    AlphNum
* 000907 CALCULATION-PASS-AREA . . . . . 0000000000 00000450  LS G    AlphNum
* 000908 CP-COMM-LENGTH. . . . . . . . . 0000000000 00000002  LS E    Comp
* 000911 CP-RETURN-CODE. . . . . . . . . 0000000002 00000001  LS E    AlphNum
* 000934 CP-RETURN-CODE-2. . . . . . . . 0000000003 00000001  LS E    AlphNum
* 000938 CP-CALCULATION-AREA . . . . . . 0000000004 00000446  LS G    AlphNum
* 000939 CP-ACCOUNT-NUMBER . . . . . . . 0000000004 00000010  LS E    AlphNum
* 000940 CP-CERT-EFF-DT. . . . . . . . . 0000000014 00000002  LS E    AlphNum
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 121
* ELRATEX.cbl
* 000941 CP-VALUATION-DT . . . . . . . . 0000000016 00000002  LS E    AlphNum
* 000942 CP-PAID-THRU-DT . . . . . . . . 0000000018 00000002  LS E    AlphNum
* 000943 CP-BENEFIT-TYPE . . . . . . . . 0000000020 00000001  LS E    AlphNum
* 000948 CP-INCURRED-DT. . . . . . . . . 0000000021 00000002  LS E    AlphNum
* 000949 CP-REPORTED-DT. . . . . . . . . 0000000023 00000002  LS E    AlphNum
* 000950 CP-ACCT-FLD-5 . . . . . . . . . 0000000025 00000002  LS E    AlphNum
* 000951 CP-COMPANY-ID . . . . . . . . . 0000000027 00000003  LS E    AlphNum
* 000952 CP-ISSUE-AGE. . . . . . . . . . 0000000030 00000002  LS E    Comp-3
* 000954 CP-CDT-PERCENT. . . . . . . . . 0000000032 00000003  LS E    Comp-3
* 000956 CP-CDT-METHOD . . . . . . . . . 0000000035 00000001  LS E    AlphNum
* 000960 CP-CLAIM-TYPE . . . . . . . . . 0000000036 00000001  LS E    AlphNum
* 000963 CP-ORIGINAL-TERM. . . . . . . . 0000000037 00000002  LS E    Comp-3
* 000965 CP-ORIGINAL-BENEFIT . . . . . . 0000000039 00000006  LS E    Comp-3
* 000967 CP-ORIGINAL-PREMIUM . . . . . . 0000000045 00000005  LS E    Comp-3
* 000969 CP-REMAINING-TERM . . . . . . . 0000000050 00000003  LS E    Comp-3
* 000971 CP-REMAINING-BENEFIT. . . . . . 0000000053 00000006  LS E    Comp-3
* 000973 CP-LOAN-APR . . . . . . . . . . 0000000059 00000004  LS E    Comp-3
* 000975 CP-PAY-FREQUENCY. . . . . . . . 0000000063 00000002  LS E    Comp-3
* 000977 CP-REM-TERM-METHOD. . . . . . . 0000000065 00000001  LS E    AlphNum
* 000985 CP-EARNING-METHOD . . . . . . . 0000000066 00000001  LS E    AlphNum
* 001000 CP-PROCESS-TYPE . . . . . . . . 0000000067 00000001  LS E    AlphNum
* 001004 CP-SPECIAL-CALC-CD. . . . . . . 0000000068 00000001  LS E    AlphNum
* 001038 CP-LOAN-TERM. . . . . . . . . . 0000000069 00000002  LS E    Comp-3
* 001040 CP-CLASS-CODE . . . . . . . . . 0000000071 00000002  LS E    AlphNum
* 001041 CP-DEVIATION-CODE . . . . . . . 0000000073 00000003  LS E    AlphNum
* 001042 CP-STATE. . . . . . . . . . . . 0000000076 00000002  LS E    AlphNum
* 001043 CP-STATE-STD-ABBRV. . . . . . . 0000000078 00000002  LS E    AlphNum
* 001044 CP-BENEFIT-CD . . . . . . . . . 0000000080 00000002  LS E    AlphNum
* 001047 CP-R78-OPTION . . . . . . . . . 0000000082 00000001  LS E    AlphNum
* 001051 CP-COMPANY-CD . . . . . . . . . 0000000083 00000001  LS E    AlphNum
* 001052 CP-IBNR-RESERVE-SW. . . . . . . 0000000084 00000001  LS E    AlphNum
* 001053 CP-CLAIM-STATUS . . . . . . . . 0000000085 00000001  LS E    AlphNum
* 001054 CP-RATE-FILE. . . . . . . . . . 0000000086 00000001  LS E    AlphNum
* 001055 CP-TERM-OR-EXT-DAYS . . . . . . 0000000087 00000003  LS E    Comp-3
* 001058 CP-LIFE-OVERRIDE-CODE . . . . . 0000000090 00000001  LS E    AlphNum
* 001059 CP-AH-OVERRIDE-CODE . . . . . . 0000000091 00000001  LS E    AlphNum
* 001061 CP-RATE-DEV-PCT . . . . . . . . 0000000092 00000004  LS E    Comp-3
* 001063 CP-CLP-RATE-UP. . . . . . . . . 0000000092 00000004  LS E    Comp-3     R
* 001065 CP-CRITICAL-MONTHS. . . . . . . 0000000096 00000002  LS E    Comp-3
* 001067 CP-ALTERNATE-BENEFIT. . . . . . 0000000098 00000006  LS E    Comp-3
* 001069 CP-ALTERNATE-PREMIUM. . . . . . 0000000104 00000005  LS E    Comp-3
* 001071 CP-DDF-CSO-ADMIN-FEE. . . . . . 0000000104 00000005  LS E    Comp-3     R
* 001074 CP-PAID-FROM-DATE . . . . . . . 0000000109 00000002  LS E    AlphNum
* 001075 CP-CLAIM-CALC-METHOD. . . . . . 0000000111 00000001  LS E    AlphNum
* 001076 CP-EXT-DAYS-CALC. . . . . . . . 0000000112 00000001  LS E    AlphNum
* 001081 CP-DOMICILE-STATE . . . . . . . 0000000113 00000002  LS E    AlphNum
* 001082 CP-CARRIER. . . . . . . . . . . 0000000115 00000001  LS E    AlphNum
* 001083 CP-REIN-FLAG. . . . . . . . . . 0000000116 00000001  LS E    AlphNum
* 001084 CP-REM-TRM-CALC-OPTION. . . . . 0000000117 00000001  LS E    AlphNum
* 001095 CP-SIG-SWITCH . . . . . . . . . 0000000118 00000001  LS E    AlphNum
* 001096 CP-RATING-METHOD. . . . . . . . 0000000119 00000001  LS E    AlphNum
* 001106 CP-SALES-TAX. . . . . . . . . . 0000000120 00000003  LS E    Comp-3
* 001108 CP-BEN-CATEGORY . . . . . . . . 0000000123 00000001  LS E    AlphNum
* 001109 CP-DCC-LF-RATE. . . . . . . . . 0000000124 00000004  LS E    Comp-3
* 001110 CP-DCC-ACT-COMM . . . . . . . . 0000000124 00000004  LS E    Comp-3     R
* 001112 CP-DCC-AH-RATE. . . . . . . . . 0000000128 00000004  LS E    Comp-3
* 001113 CP-DCC-PMF-COMM . . . . . . . . 0000000128 00000004  LS E    Comp-3     R
* 001115 CP-DAYS-TO-1ST-PMT. . . . . . . 0000000132 00000002  LS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 122
* ELRATEX.cbl
* 001116 CP-AH-BALLOON-SW. . . . . . . . 0000000134 00000001  LS E    AlphNum
* 001117 CP-EXPIRE-DT. . . . . . . . . . 0000000135 00000002  LS E    AlphNum
* 001118 CP-LF-CLAIM-CALC-SW . . . . . . 0000000137 00000001  LS E    AlphNum
* 001119 CP-DDF-HI-FACT. . . . . . . . . 0000000138 00000003  LS E    Comp-3
* 001120 CP-DDF-LO-FACT. . . . . . . . . 0000000141 00000003  LS E    Comp-3
* 001121 CP-DDF-CLP. . . . . . . . . . . 0000000144 00000004  LS E    Comp-3
* 001122 CP-DDF-SPEC-CALC. . . . . . . . 0000000148 00000001  LS E    AlphNum
* 001125 CP-IU-RATE-UP . . . . . . . . . 0000000149 00000004  LS E    Comp-3
* 001126 CP-CANCEL-REASON. . . . . . . . 0000000153 00000001  LS E    AlphNum
* 001127 CP-DDF-ADMIN-FEES . . . . . . . 0000000154 00000004  LS E    Comp-3
* 001128 CP-PMT-MODE . . . . . . . . . . 0000000158 00000001  LS E    AlphNum
* 001129 CP-NO-OF-PMTS . . . . . . . . . 0000000159 00000002  LS E    Comp-3
* 001130 CP-1ST-YR-ALLOW . . . . . . . . 0000000161 00000003  LS E    Comp-3
* 001131 CP-DDF-COMM-AND-MFEE. . . . . . 0000000164 00000004  LS E    Comp-3
* 001132 CP-DDF-YR1AF. . . . . . . . . . 0000000168 00000004  LS E    Comp-3
* 001133 Filler. . . . . . . . . . . . . 0000000172 00000001  LS E    AlphNum
* 001137 CP-CDT-TABLE. . . . . . . . . . 0000000173 00000001  LS E    Display
* 001139 CP-CDT-FACTOR . . . . . . . . . 0000000174 00000006  LS E    Comp-3
* 001141 CP-PTC-RESERVE. . . . . . . . . 0000000180 00000005  LS E    Comp-3
* 001143 CP-IBNR-RESERVE . . . . . . . . 0000000185 00000005  LS E    Comp-3
* 001145 CP-FUTURE-RESERVE . . . . . . . 0000000190 00000005  LS E    Comp-3
* 001147 Filler. . . . . . . . . . . . . 0000000195 00000009  LS E    AlphNum
* 001150 CP-REMAINING-TERM-1 . . . . . . 0000000204 00000003  LS E    Comp-3
* 001152 CP-REMAINING-TERM-2 . . . . . . 0000000207 00000003  LS E    Comp-3
* 001154 CP-REMAINING-TERM-3 . . . . . . 0000000210 00000003  LS E    Comp-3
* 001156 CP-ODD-DAYS . . . . . . . . . . 0000000213 00000002  LS E    Comp-3
* 001158 Filler. . . . . . . . . . . . . 0000000215 00000012  LS E    AlphNum
* 001162 CP-REMAINING-AMT. . . . . . . . 0000000227 00000006  LS E    Comp-3
* 001164 CP-REMAINING-AMT-PRV. . . . . . 0000000233 00000006  LS E    Comp-3
* 001166 Filler. . . . . . . . . . . . . 0000000239 00000012  LS E    AlphNum
* 001170 CP-CALC-PREMIUM . . . . . . . . 0000000251 00000005  LS E    Comp-3
* 001172 CP-PREMIUM-RATE . . . . . . . . 0000000256 00000004  LS E    Comp-3
* 001174 CP-MORTALITY-CODE . . . . . . . 0000000260 00000004  LS E    AlphNum
* 001175 CP-RATE-EDIT-FLAG . . . . . . . 0000000264 00000001  LS E    AlphNum
* 001177 CP-COMPOSITE-RATE . . . . . . . 0000000265 00000003  LS E    Comp-3
* 001179 CP-CANCEL-FEE . . . . . . . . . 0000000268 00000003  LS E    Comp-3
* 001180 CP-LF-PREM. . . . . . . . . . . 0000000271 00000005  LS E    Comp-3
* 001181 CP-LF-BALLOON-PREM. . . . . . . 0000000271 00000005  LS E    Comp-3     R
* 001183 Filler. . . . . . . . . . . . . 0000000276 00000007  LS E    AlphNum
* 001187 CP-CALC-REFUND. . . . . . . . . 0000000283 00000005  LS E    Comp-3
* 001189 CP-REFUND-TYPE-USED . . . . . . 0000000288 00000001  LS E    AlphNum
* 001204 Filler. . . . . . . . . . . . . 0000000289 00000012  LS E    AlphNum
* 001208 CP-R78-U-PRM. . . . . . . . . . 0000000301 00000005  LS E    Comp-3
* 001210 CP-R78-U-PRM-ALT. . . . . . . . 0000000306 00000005  LS E    Comp-3
* 001212 CP-PRORATA-U-PRM. . . . . . . . 0000000311 00000005  LS E    Comp-3
* 001214 CP-PRORATA-U-PRM-ALT. . . . . . 0000000316 00000005  LS E    Comp-3
* 001216 CP-STATE-U-PRM. . . . . . . . . 0000000321 00000005  LS E    Comp-3
* 001218 CP-DOMICILE-U-PRM . . . . . . . 0000000326 00000005  LS E    Comp-3
* 001220 CP-EARNING-TYPE-USED. . . . . . 0000000331 00000001  LS E    AlphNum
* 001230 Filler. . . . . . . . . . . . . 0000000332 00000012  LS E    AlphNum
* 001234 CP-ACTUAL-DAYS. . . . . . . . . 0000000344 00000003  LS E    Comp-3
* 001236 CP-CLAIM-PAYMENT. . . . . . . . 0000000347 00000005  LS E    Comp-3
* 001238 Filler. . . . . . . . . . . . . 0000000352 00000012  LS E    AlphNum
* 001241 CP-TOTAL-PAID . . . . . . . . . 0000000364 00000005  LS E    Comp-3
* 001243 CP-R-MAX-ATT-AGE. . . . . . . . 0000000369 00000002  LS E    Comp-3
* 001245 CP-R-MAX-AGE. . . . . . . . . . 0000000371 00000002  LS E    Comp-3
* 001247 CP-R-MAX-TERM . . . . . . . . . 0000000373 00000003  LS E    Comp-3
* 001249 CP-R-MAX-TOT-BEN. . . . . . . . 0000000376 00000005  LS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:11 Page 123
* ELRATEX.cbl
* 001251 CP-R-MAX-MON-BEN. . . . . . . . 0000000381 00000005  LS E    Comp-3
* 001253 CP-IO-FUNCTION. . . . . . . . . 0000000386 00000001  LS E    AlphNum
* 001258 CP-FIRST-PAY-DATE . . . . . . . 0000000387 00000002  LS E    AlphNum
* 001260 CP-JOINT-INDICATOR. . . . . . . 0000000389 00000001  LS E    AlphNum
* 001262 CP-RESERVE-REMAINING-TERM . . . 0000000390 00000003  LS E    Comp-3
* 001266 CP-INSURED-BIRTH-DT . . . . . . 0000000393 00000002  LS E    AlphNum
* 001268 CP-INCURRED-AGE . . . . . . . . 0000000395 00000002  LS E    Comp-3
* 001271 CP-MONTHLY-PAYMENT. . . . . . . 0000000397 00000004  LS E    Comp-3
* 001274 CP-RATING-BENEFIT-AMT . . . . . 0000000401 00000006  LS E    Comp-3
* 001277 CP-ODD-DAYS-TO-PMT. . . . . . . 0000000407 00000002  LS E    Comp-3
* 001280 CP-MNTHS-TO-FIRST-PMT . . . . . 0000000409 00000002  LS E    Comp-3
* 001283 CP-REMAMT-FACTOR. . . . . . . . 0000000411 00000007  LS E    Comp-3
* 001286 CP-FREE-LOOK. . . . . . . . . . 0000000418 00000002  LS E    Comp-3
* 001289 CP-ROA-REFUND . . . . . . . . . 0000000420 00000001  LS E    AlphNum
* 001292 CP-NET-BENEFIT-AMT. . . . . . . 0000000421 00000006  LS E    Comp-3
* 001294 CP-SCNP-6MO-AMT . . . . . . . . 0000000427 00000006  LS E    Comp-3
* 001296 CP-MONTH. . . . . . . . . . . . 0000000433 00000002  LS E    Comp-3
* 001297 CP-EXTRA-PERIODS. . . . . . . . 0000000435 00000001  LS E    Display
* 001298 CP-NET-ONLY-STATE . . . . . . . 0000000436 00000001  LS E    AlphNum
* 001299 Filler. . . . . . . . . . . . . 0000000437 00000013  LS E    AlphNum
* 000000 XML-TEXT. . . . . . . . . . . . 0000000000 00000001  LS E    AlphNum      G
* 000000 XML-NTEXT . . . . . . . . . . . 0000000000 00000002  LS E    AlphNum      G
* 000000 XML-CODE. . . . . . . . . . . . 0000007768 00000004  PG E    Comp         G
* 000000 XML-EVENT . . . . . . . . . . . 0000007772 00000030  PG E    AlphNum      G
* 000000 RETURN-CODE . . . . . . . . . . 0000007804 00000004  PG E    Comp         G
* 000000 SORT-RETURN . . . . . . . . . . 0000007808 00000002  PG E    Comp         G
* 000000 TALLY . . . . . . . . . . . . . 0000007812 00000004  PG E    Comp         G
* 000000 SORT-MESSAGE. . . . . . . . . . 0000007816 00000008  PG E    AlphNum      G
* 000000 SORT-FILE-SIZE. . . . . . . . . 0000007824 00000004  PG E    Comp         G
* 000000 SORT-MODE-SIZE. . . . . . . . . 0000007828 00000004  PG E    Comp         G
* 000000 SORT-CORE-SIZE. . . . . . . . . 0000007832 00000004  PG E    Comp         G
* 000000 SORT-CONTROL. . . . . . . . . . 0000007836 00000008  PG E    AlphNum      G
* 000000 SHIFT-OUT . . . . . . . . . . . 0000007844 00000001  PG E    AlphNum      G
* 000000 SHIFT-IN. . . . . . . . . . . . 0000007848 00000001  PG E    AlphNum      G
*
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        7980     Code:       56926
